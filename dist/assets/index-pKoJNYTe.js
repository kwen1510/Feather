function h4(l,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in l)){const o=Object.getOwnPropertyDescriptor(i,r);o&&Object.defineProperty(l,r,o.get?o:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function pf(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function b2(l){if(Object.prototype.hasOwnProperty.call(l,"__esModule"))return l;var t=l.default;if(typeof t=="function"){var n=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(l).forEach(function(i){var r=Object.getOwnPropertyDescriptor(l,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return l[i]}})}),n}var mp={exports:{}},Kh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ay;function d4(){if(ay)return Kh;ay=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(i,r,o){var f=null;if(o!==void 0&&(f=""+o),r.key!==void 0&&(f=""+r.key),"key"in r){o={};for(var h in r)h!=="key"&&(o[h]=r[h])}else o=r;return r=o.ref,{$$typeof:l,type:i,key:f,ref:r!==void 0?r:null,props:o}}return Kh.Fragment=t,Kh.jsx=n,Kh.jsxs=n,Kh}var ry;function g4(){return ry||(ry=1,mp.exports=d4()),mp.exports}var k=g4(),vp={exports:{}},Me={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sy;function p4(){if(sy)return Me;sy=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),E=Symbol.iterator;function R(Z){return Z===null||typeof Z!="object"?null:(Z=E&&Z[E]||Z["@@iterator"],typeof Z=="function"?Z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,B={};function L(Z,at,rt){this.props=Z,this.context=at,this.refs=B,this.updater=rt||v}L.prototype.isReactComponent={},L.prototype.setState=function(Z,at){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,at,"setState")},L.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function j(){}j.prototype=L.prototype;function M(Z,at,rt){this.props=Z,this.context=at,this.refs=B,this.updater=rt||v}var G=M.prototype=new j;G.constructor=M,N(G,L.prototype),G.isPureReactComponent=!0;var O=Array.isArray;function A(){}var T={H:null,A:null,T:null,S:null},y=Object.prototype.hasOwnProperty;function z(Z,at,rt){var V=rt.ref;return{$$typeof:l,type:Z,key:at,ref:V!==void 0?V:null,props:rt}}function U(Z,at){return z(Z.type,at,Z.props)}function P(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===l}function K(Z){var at={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(rt){return at[rt]})}var Q=/\/+/g;function X(Z,at){return typeof Z=="object"&&Z!==null&&Z.key!=null?K(""+Z.key):at.toString(36)}function Y(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(A,A):(Z.status="pending",Z.then(function(at){Z.status==="pending"&&(Z.status="fulfilled",Z.value=at)},function(at){Z.status==="pending"&&(Z.status="rejected",Z.reason=at)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function D(Z,at,rt,V,J){var $=typeof Z;($==="undefined"||$==="boolean")&&(Z=null);var nt=!1;if(Z===null)nt=!0;else switch($){case"bigint":case"string":case"number":nt=!0;break;case"object":switch(Z.$$typeof){case l:case t:nt=!0;break;case _:return nt=Z._init,D(nt(Z._payload),at,rt,V,J)}}if(nt)return J=J(Z),nt=V===""?"."+X(Z,0):V,O(J)?(rt="",nt!=null&&(rt=nt.replace(Q,"$&/")+"/"),D(J,at,rt,"",function(Ut){return Ut})):J!=null&&(P(J)&&(J=U(J,rt+(J.key==null||Z&&Z.key===J.key?"":(""+J.key).replace(Q,"$&/")+"/")+nt)),at.push(J)),1;nt=0;var dt=V===""?".":V+":";if(O(Z))for(var wt=0;wt<Z.length;wt++)V=Z[wt],$=dt+X(V,wt),nt+=D(V,at,rt,$,J);else if(wt=R(Z),typeof wt=="function")for(Z=wt.call(Z),wt=0;!(V=Z.next()).done;)V=V.value,$=dt+X(V,wt++),nt+=D(V,at,rt,$,J);else if($==="object"){if(typeof Z.then=="function")return D(Y(Z),at,rt,V,J);throw at=String(Z),Error("Objects are not valid as a React child (found: "+(at==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":at)+"). If you meant to render a collection of children, use an array instead.")}return nt}function I(Z,at,rt){if(Z==null)return Z;var V=[],J=0;return D(Z,V,"","",function($){return at.call(rt,$,J++)}),V}function F(Z){if(Z._status===-1){var at=Z._result;at=at(),at.then(function(rt){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=rt)},function(rt){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=rt)}),Z._status===-1&&(Z._status=0,Z._result=at)}if(Z._status===1)return Z._result.default;throw Z._result}var W=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var at=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(at))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},it={map:I,forEach:function(Z,at,rt){I(Z,function(){at.apply(this,arguments)},rt)},count:function(Z){var at=0;return I(Z,function(){at++}),at},toArray:function(Z){return I(Z,function(at){return at})||[]},only:function(Z){if(!P(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return Me.Activity=C,Me.Children=it,Me.Component=L,Me.Fragment=n,Me.Profiler=r,Me.PureComponent=M,Me.StrictMode=i,Me.Suspense=g,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,Me.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return T.H.useMemoCache(Z)}},Me.cache=function(Z){return function(){return Z.apply(null,arguments)}},Me.cacheSignal=function(){return null},Me.cloneElement=function(Z,at,rt){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var V=N({},Z.props),J=Z.key;if(at!=null)for($ in at.key!==void 0&&(J=""+at.key),at)!y.call(at,$)||$==="key"||$==="__self"||$==="__source"||$==="ref"&&at.ref===void 0||(V[$]=at[$]);var $=arguments.length-2;if($===1)V.children=rt;else if(1<$){for(var nt=Array($),dt=0;dt<$;dt++)nt[dt]=arguments[dt+2];V.children=nt}return z(Z.type,J,V)},Me.createContext=function(Z){return Z={$$typeof:f,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:o,_context:Z},Z},Me.createElement=function(Z,at,rt){var V,J={},$=null;if(at!=null)for(V in at.key!==void 0&&($=""+at.key),at)y.call(at,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(J[V]=at[V]);var nt=arguments.length-2;if(nt===1)J.children=rt;else if(1<nt){for(var dt=Array(nt),wt=0;wt<nt;wt++)dt[wt]=arguments[wt+2];J.children=dt}if(Z&&Z.defaultProps)for(V in nt=Z.defaultProps,nt)J[V]===void 0&&(J[V]=nt[V]);return z(Z,$,J)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(Z){return{$$typeof:h,render:Z}},Me.isValidElement=P,Me.lazy=function(Z){return{$$typeof:_,_payload:{_status:-1,_result:Z},_init:F}},Me.memo=function(Z,at){return{$$typeof:m,type:Z,compare:at===void 0?null:at}},Me.startTransition=function(Z){var at=T.T,rt={};T.T=rt;try{var V=Z(),J=T.S;J!==null&&J(rt,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(A,W)}catch($){W($)}finally{at!==null&&rt.types!==null&&(at.types=rt.types),T.T=at}},Me.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},Me.use=function(Z){return T.H.use(Z)},Me.useActionState=function(Z,at,rt){return T.H.useActionState(Z,at,rt)},Me.useCallback=function(Z,at){return T.H.useCallback(Z,at)},Me.useContext=function(Z){return T.H.useContext(Z)},Me.useDebugValue=function(){},Me.useDeferredValue=function(Z,at){return T.H.useDeferredValue(Z,at)},Me.useEffect=function(Z,at){return T.H.useEffect(Z,at)},Me.useEffectEvent=function(Z){return T.H.useEffectEvent(Z)},Me.useId=function(){return T.H.useId()},Me.useImperativeHandle=function(Z,at,rt){return T.H.useImperativeHandle(Z,at,rt)},Me.useInsertionEffect=function(Z,at){return T.H.useInsertionEffect(Z,at)},Me.useLayoutEffect=function(Z,at){return T.H.useLayoutEffect(Z,at)},Me.useMemo=function(Z,at){return T.H.useMemo(Z,at)},Me.useOptimistic=function(Z,at){return T.H.useOptimistic(Z,at)},Me.useReducer=function(Z,at,rt){return T.H.useReducer(Z,at,rt)},Me.useRef=function(Z){return T.H.useRef(Z)},Me.useState=function(Z){return T.H.useState(Z)},Me.useSyncExternalStore=function(Z,at,rt){return T.H.useSyncExternalStore(Z,at,rt)},Me.useTransition=function(){return T.H.useTransition()},Me.version="19.2.0",Me}var ly;function Eg(){return ly||(ly=1,vp.exports=p4()),vp.exports}var st=Eg();const ei=pf(st),m4=h4({__proto__:null,default:ei},[st]);var yp={exports:{}},Qh={},Sp={exports:{}},bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy;function v4(){return oy||(oy=1,(function(l){function t(D,I){var F=D.length;D.push(I);t:for(;0<F;){var W=F-1>>>1,it=D[W];if(0<r(it,I))D[W]=I,D[F]=it,F=W;else break t}}function n(D){return D.length===0?null:D[0]}function i(D){if(D.length===0)return null;var I=D[0],F=D.pop();if(F!==I){D[0]=F;t:for(var W=0,it=D.length,Z=it>>>1;W<Z;){var at=2*(W+1)-1,rt=D[at],V=at+1,J=D[V];if(0>r(rt,F))V<it&&0>r(J,rt)?(D[W]=J,D[V]=F,W=V):(D[W]=rt,D[at]=F,W=at);else if(V<it&&0>r(J,F))D[W]=J,D[V]=F,W=V;else break t}}return I}function r(D,I){var F=D.sortIndex-I.sortIndex;return F!==0?F:D.id-I.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;l.unstable_now=function(){return o.now()}}else{var f=Date,h=f.now();l.unstable_now=function(){return f.now()-h}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,N=!1,B=!1,L=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(D){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=D)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(D){if(N=!1,G(D),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-D)}}var A=!1,T=-1,y=5,z=-1;function U(){return B?!0:!(l.unstable_now()-z<y)}function P(){if(B=!1,A){var D=l.unstable_now();z=D;var I=!0;try{t:{v=!1,N&&(N=!1,j(T),T=-1),R=!0;var F=E;try{e:{for(G(D),C=n(g);C!==null&&!(C.expirationTime>D&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=D);if(D=l.unstable_now(),typeof it=="function"){C.callback=it,G(D),I=!0;break e}C===n(g)&&i(g),G(D)}else i(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-D),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=P,K=function(){X.postMessage(null)}}else K=function(){L(P,0)};function Y(D,I){T=L(function(){D(l.unstable_now())},I)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(D){D.callback=null},l.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<D?Math.floor(1e3/D):5},l.unstable_getCurrentPriorityLevel=function(){return E},l.unstable_next=function(D){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return D()}finally{E=F}},l.unstable_requestPaint=function(){B=!0},l.unstable_runWithPriority=function(D,I){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=E;E=D;try{return I()}finally{E=F}},l.unstable_scheduleCallback=function(D,I,F){var W=l.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,D){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,D={id:_++,callback:I,priorityLevel:D,startTime:F,expirationTime:it,sortIndex:-1},F>W?(D.sortIndex=F,t(m,D),n(g)===null&&D===n(m)&&(N?(j(T),T=-1):N=!0,Y(O,F-W))):(D.sortIndex=it,t(g,D),v||R||(v=!0,A||(A=!0,K()))),D},l.unstable_shouldYield=U,l.unstable_wrapCallback=function(D){var I=E;return function(){var F=E;E=I;try{return D.apply(this,arguments)}finally{E=F}}}})(bp)),bp}var uy;function y4(){return uy||(uy=1,Sp.exports=v4()),Sp.exports}var _p={exports:{}},ta={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy;function S4(){if(cy)return ta;cy=1;var l=Eg();function t(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(g,m,_){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:C==null?null:""+C,children:g,containerInfo:m,implementation:_}}var f=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return ta.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ta.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return o(g,m,null,_)},ta.flushSync=function(g){var m=f.T,_=i.p;try{if(f.T=null,i.p=2,g)return g()}finally{f.T=m,i.p=_,i.d.f()}},ta.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},ta.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ta.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,C=h(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,R=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:C,integrity:E,fetchPriority:R}):_==="script"&&i.d.X(g,{crossOrigin:C,integrity:E,fetchPriority:R,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},ta.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=h(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},ta.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,C=h(_,m.crossOrigin);i.d.L(g,_,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},ta.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=h(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},ta.requestFormReset=function(g){i.d.r(g)},ta.unstable_batchedUpdates=function(g,m){return g(m)},ta.useFormState=function(g,m,_){return f.H.useFormState(g,m,_)},ta.useFormStatus=function(){return f.H.useHostTransitionStatus()},ta.version="19.2.0",ta}var fy;function _2(){if(fy)return _p.exports;fy=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),_p.exports=S4(),_p.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function b4(){if(hy)return Qh;hy=1;var l=y4(),t=Eg(),n=_2();function i(e){var a="https://react.dev/errors/"+e;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+e+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var a=e,c=e;if(e.alternate)for(;a.return;)a=a.return;else{e=a;do a=e,(a.flags&4098)!==0&&(c=a.return),e=a.return;while(e)}return a.tag===3?c:null}function f(e){if(e.tag===13){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function h(e){if(e.tag===31){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function g(e){if(o(e)!==e)throw Error(i(188))}function m(e){var a=e.alternate;if(!a){if(a=o(e),a===null)throw Error(i(188));return a!==e?null:e}for(var c=e,d=a;;){var b=c.return;if(b===null)break;var w=b.alternate;if(w===null){if(d=b.return,d!==null){c=d;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===c)return g(b),e;if(w===d)return g(b),a;w=w.sibling}throw Error(i(188))}if(c.return!==d.return)c=b,d=w;else{for(var q=!1,tt=b.child;tt;){if(tt===c){q=!0,c=b,d=w;break}if(tt===d){q=!0,d=b,c=w;break}tt=tt.sibling}if(!q){for(tt=w.child;tt;){if(tt===c){q=!0,c=w,d=b;break}if(tt===d){q=!0,d=w,c=b;break}tt=tt.sibling}if(!q)throw Error(i(189))}}if(c.alternate!==d)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?e:a}function _(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e;for(e=e.child;e!==null;){if(a=_(e),a!==null)return a;e=e.sibling}return null}var C=Object.assign,E=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),M=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function K(e){return e===null||typeof e!="object"?null:(e=P&&e[P]||e["@@iterator"],typeof e=="function"?e:null)}var Q=Symbol.for("react.client.reference");function X(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case N:return"Fragment";case L:return"Profiler";case B:return"StrictMode";case O:return"Suspense";case A:return"SuspenseList";case z:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case M:return e.displayName||"Context";case j:return(e._context.displayName||"Context")+".Consumer";case G:var a=e.render;return e=e.displayName,e||(e=a.displayName||a.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case T:return a=e.displayName||null,a!==null?a:X(e.type)||"Memo";case y:a=e._payload,e=e._init;try{return X(e(a))}catch{}}return null}var Y=Array.isArray,D=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},W=[],it=-1;function Z(e){return{current:e}}function at(e){0>it||(e.current=W[it],W[it]=null,it--)}function rt(e,a){it++,W[it]=e.current,e.current=a}var V=Z(null),J=Z(null),$=Z(null),nt=Z(null);function dt(e,a){switch(rt($,a),rt(J,e),rt(V,null),a.nodeType){case 9:case 11:e=(e=a.documentElement)&&(e=e.namespaceURI)?Rv(e):0;break;default:if(e=a.tagName,a=a.namespaceURI)a=Rv(a),e=Ov(a,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}at(V),rt(V,e)}function wt(){at(V),at(J),at($)}function Ut(e){e.memoizedState!==null&&rt(nt,e);var a=V.current,c=Ov(a,e.type);a!==c&&(rt(J,e),rt(V,c))}function It(e){J.current===e&&(at(V),at(J)),nt.current===e&&(at(nt),kh._currentValue=F)}var ne,ae;function Lt(e){if(ne===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);ne=a&&a[1]||"",ae=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ne+e+ae}var _e=!1;function we(e,a){if(!e||_e)return"";_e=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(a){var jt=function(){throw Error()};if(Object.defineProperty(jt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(jt,[])}catch(Tt){var Et=Tt}Reflect.construct(e,[],jt)}else{try{jt.call()}catch(Tt){Et=Tt}e.call(jt.prototype)}}else{try{throw Error()}catch(Tt){Et=Tt}(jt=e())&&typeof jt.catch=="function"&&jt.catch(function(){})}}catch(Tt){if(Tt&&Et&&typeof Tt.stack=="string")return[Tt.stack,Et.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=d.DetermineComponentFrameRoot(),q=w[0],tt=w[1];if(q&&tt){var ot=q.split(`
`),St=tt.split(`
`);for(b=d=0;d<ot.length&&!ot[d].includes("DetermineComponentFrameRoot");)d++;for(;b<St.length&&!St[b].includes("DetermineComponentFrameRoot");)b++;if(d===ot.length||b===St.length)for(d=ot.length-1,b=St.length-1;1<=d&&0<=b&&ot[d]!==St[b];)b--;for(;1<=d&&0<=b;d--,b--)if(ot[d]!==St[b]){if(d!==1||b!==1)do if(d--,b--,0>b||ot[d]!==St[b]){var xt=`
`+ot[d].replace(" at new "," at ");return e.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",e.displayName)),xt}while(1<=d&&0<=b);break}}}finally{_e=!1,Error.prepareStackTrace=c}return(c=e?e.displayName||e.name:"")?Lt(c):""}function Ze(e,a){switch(e.tag){case 26:case 27:case 5:return Lt(e.type);case 16:return Lt("Lazy");case 13:return e.child!==a&&a!==null?Lt("Suspense Fallback"):Lt("Suspense");case 19:return Lt("SuspenseList");case 0:case 15:return we(e.type,!1);case 11:return we(e.type.render,!1);case 1:return we(e.type,!0);case 31:return Lt("Activity");default:return""}}function He(e){try{var a="",c=null;do a+=Ze(e,c),c=e,e=e.return;while(e);return a}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var gn=Object.prototype.hasOwnProperty,Pn=l.unstable_scheduleCallback,Ot=l.unstable_cancelCallback,Kt=l.unstable_shouldYield,je=l.unstable_requestPaint,ye=l.unstable_now,We=l.unstable_getCurrentPriorityLevel,an=l.unstable_ImmediatePriority,ge=l.unstable_UserBlockingPriority,ct=l.unstable_NormalPriority,At=l.unstable_LowPriority,Mt=l.unstable_IdlePriority,qt=l.log,pe=l.unstable_setDisableYieldValue,ht=null,vt=null;function Rt(e){if(typeof qt=="function"&&pe(e),vt&&typeof vt.setStrictMode=="function")try{vt.setStrictMode(ht,e)}catch{}}var ue=Math.clz32?Math.clz32:he,ce=Math.log,Zt=Math.LN2;function he(e){return e>>>=0,e===0?32:31-(ce(e)/Zt|0)|0}var fe=256,Be=262144,$e=4194304;function Fn(e){var a=e&42;if(a!==0)return a;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function na(e,a,c){var d=e.pendingLanes;if(d===0)return 0;var b=0,w=e.suspendedLanes,q=e.pingedLanes;e=e.warmLanes;var tt=d&134217727;return tt!==0?(d=tt&~w,d!==0?b=Fn(d):(q&=tt,q!==0?b=Fn(q):c||(c=tt&~e,c!==0&&(b=Fn(c))))):(tt=d&~w,tt!==0?b=Fn(tt):q!==0?b=Fn(q):c||(c=d&~e,c!==0&&(b=Fn(c)))),b===0?0:a!==0&&a!==b&&(a&w)===0&&(w=b&-b,c=a&-a,w>=c||w===32&&(c&4194048)!==0)?a:b}function Ii(e,a){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&a)===0}function yl(e,a){switch(e){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function So(){var e=$e;return $e<<=1,($e&62914560)===0&&($e=4194304),e}function ki(e){for(var a=[],c=0;31>c;c++)a.push(e);return a}function Aa(e,a){e.pendingLanes|=a,a!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Dt(e,a,c,d,b,w){var q=e.pendingLanes;e.pendingLanes=c,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=c,e.entangledLanes&=c,e.errorRecoveryDisabledLanes&=c,e.shellSuspendCounter=0;var tt=e.entanglements,ot=e.expirationTimes,St=e.hiddenUpdates;for(c=q&~c;0<c;){var xt=31-ue(c),jt=1<<xt;tt[xt]=0,ot[xt]=-1;var Et=St[xt];if(Et!==null)for(St[xt]=null,xt=0;xt<Et.length;xt++){var Tt=Et[xt];Tt!==null&&(Tt.lane&=-536870913)}c&=~jt}d!==0&&Bt(e,d,0),w!==0&&b===0&&e.tag!==0&&(e.suspendedLanes|=w&~(q&~a))}function Bt(e,a,c){e.pendingLanes|=a,e.suspendedLanes&=~a;var d=31-ue(a);e.entangledLanes|=a,e.entanglements[d]=e.entanglements[d]|1073741824|c&261930}function Wt(e,a){var c=e.entangledLanes|=a;for(e=e.entanglements;c;){var d=31-ue(c),b=1<<d;b&a|e[d]&a&&(e[d]|=a),c&=~b}}function $t(e,a){var c=a&-a;return c=(c&42)!==0?1:Yt(c),(c&(e.suspendedLanes|a))!==0?0:c}function Yt(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function pn(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function xn(){var e=I.p;return e!==0?e:(e=window.event,e===void 0?32:Zv(e.type))}function mn(e,a){var c=I.p;try{return I.p=e,a()}finally{I.p=c}}var Xt=Math.random().toString(36).slice(2),te="__reactFiber$"+Xt,re="__reactProps$"+Xt,oe="__reactContainer$"+Xt,Re="__reactEvents$"+Xt,tn="__reactListeners$"+Xt,Hn="__reactHandles$"+Xt,Bn="__reactResources$"+Xt,wa="__reactMarker$"+Xt;function on(e){delete e[te],delete e[re],delete e[Re],delete e[tn],delete e[Hn]}function Ra(e){var a=e[te];if(a)return a;for(var c=e.parentNode;c;){if(a=c[oe]||c[te]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(e=Bv(e);e!==null;){if(c=e[te])return c;e=Bv(e)}return a}e=c,c=e.parentNode}return null}function Oa(e){if(e=e[te]||e[oe]){var a=e.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return e}return null}function yr(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e.stateNode;throw Error(i(33))}function Ya(e){var a=e[Bn];return a||(a=e[Bn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function ri(e){e[wa]=!0}var xu=new Set,Mu={};function Sr(e,a){ni(e,a),ni(e+"Capture",a)}function ni(e,a){for(Mu[e]=a,e=0;e<a.length;e++)xu.add(a[e])}var Jn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nu={},Sl={};function ju(e){return gn.call(Sl,e)?!0:gn.call(Nu,e)?!1:Jn.test(e)?Sl[e]=!0:(Nu[e]=!0,!1)}function bl(e,a,c){if(ju(a))if(c===null)e.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":e.removeAttribute(a);return;case"boolean":var d=a.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){e.removeAttribute(a);return}}e.setAttribute(a,""+c)}}function ma(e,a,c){if(c===null)e.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttribute(a,""+c)}}function va(e,a,c,d){if(d===null)e.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(c);return}e.setAttributeNS(a,c,""+d)}}function qi(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Du(e){var a=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function bd(e,a,c){var d=Object.getOwnPropertyDescriptor(e.constructor.prototype,a);if(!e.hasOwnProperty(a)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var b=d.get,w=d.set;return Object.defineProperty(e,a,{configurable:!0,get:function(){return b.call(this)},set:function(q){c=""+q,w.call(this,q)}}),Object.defineProperty(e,a,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(q){c=""+q},stopTracking:function(){e._valueTracker=null,delete e[a]}}}}function Uu(e){if(!e._valueTracker){var a=Du(e)?"checked":"value";e._valueTracker=bd(e,a,""+e[a])}}function Cf(e){if(!e)return!1;var a=e._valueTracker;if(!a)return!0;var c=a.getValue(),d="";return e&&(d=Du(e)?e.checked?"true":"false":e.value),e=d,e!==c?(a.setValue(e),!0):!1}function bo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var _d=/[\n"\\]/g;function ia(e){return e.replace(_d,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function _o(e,a,c,d,b,w,q,tt){e.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?e.type=q:e.removeAttribute("type"),a!=null?q==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+qi(a)):e.value!==""+qi(a)&&(e.value=""+qi(a)):q!=="submit"&&q!=="reset"||e.removeAttribute("value"),a!=null?Af(e,q,qi(a)):c!=null?Af(e,q,qi(c)):d!=null&&e.removeAttribute("value"),b==null&&w!=null&&(e.defaultChecked=!!w),b!=null&&(e.checked=b&&typeof b!="function"&&typeof b!="symbol"),tt!=null&&typeof tt!="function"&&typeof tt!="symbol"&&typeof tt!="boolean"?e.name=""+qi(tt):e.removeAttribute("name")}function Tf(e,a,c,d,b,w,q,tt){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.type=w),a!=null||c!=null){if(!(w!=="submit"&&w!=="reset"||a!=null)){Uu(e);return}c=c!=null?""+qi(c):"",a=a!=null?""+qi(a):c,tt||a===e.value||(e.value=a),e.defaultValue=a}d=d??b,d=typeof d!="function"&&typeof d!="symbol"&&!!d,e.checked=tt?e.checked:!!d,e.defaultChecked=!!d,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(e.name=q),Uu(e)}function Af(e,a,c){a==="number"&&bo(e.ownerDocument)===e||e.defaultValue===""+c||(e.defaultValue=""+c)}function Cs(e,a,c,d){if(e=e.options,a){a={};for(var b=0;b<c.length;b++)a["$"+c[b]]=!0;for(c=0;c<e.length;c++)b=a.hasOwnProperty("$"+e[c].value),e[c].selected!==b&&(e[c].selected=b),b&&d&&(e[c].defaultSelected=!0)}else{for(c=""+qi(c),a=null,b=0;b<e.length;b++){if(e[b].value===c){e[b].selected=!0,d&&(e[b].defaultSelected=!0);return}a!==null||e[b].disabled||(a=e[b])}a!==null&&(a.selected=!0)}}function wf(e,a,c){if(a!=null&&(a=""+qi(a),a!==e.value&&(e.value=a),c==null)){e.defaultValue!==a&&(e.defaultValue=a);return}e.defaultValue=c!=null?""+qi(c):""}function Rf(e,a,c,d){if(a==null){if(d!=null){if(c!=null)throw Error(i(92));if(Y(d)){if(1<d.length)throw Error(i(93));d=d[0]}c=d}c==null&&(c=""),a=c}c=qi(a),e.defaultValue=c,d=e.textContent,d===c&&d!==""&&d!==null&&(e.value=d),Uu(e)}function Xr(e,a){if(a){var c=e.firstChild;if(c&&c===e.lastChild&&c.nodeType===3){c.nodeValue=a;return}}e.textContent=a}var Ed=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Of(e,a,c){var d=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="":d?e.setProperty(a,c):typeof c!="number"||c===0||Ed.has(a)?a==="float"?e.cssFloat=c:e[a]=(""+c).trim():e[a]=c+"px"}function xf(e,a,c){if(a!=null&&typeof a!="object")throw Error(i(62));if(e=e.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||a!=null&&a.hasOwnProperty(d)||(d.indexOf("--")===0?e.setProperty(d,""):d==="float"?e.cssFloat="":e[d]="");for(var b in a)d=a[b],a.hasOwnProperty(b)&&c[b]!==d&&Of(e,b,d)}else for(var w in a)a.hasOwnProperty(w)&&Of(e,w,a[w])}function Bu(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ug=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Eo(e){return Ug.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Vi(){}var _l=null;function zu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var br=null,Ka=null;function Mf(e){var a=Oa(e);if(a&&(e=a.stateNode)){var c=e[re]||null;t:switch(e=a.stateNode,a.type){case"input":if(_o(e,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=e;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ia(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var d=c[a];if(d!==e&&d.form===e.form){var b=d[re]||null;if(!b)throw Error(i(90));_o(d,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(a=0;a<c.length;a++)d=c[a],d.form===e.form&&Cf(d)}break t;case"textarea":wf(e,c.value,c.defaultValue);break t;case"select":a=c.value,a!=null&&Cs(e,!!c.multiple,a,!1)}}}var Lu=!1;function Nf(e,a,c){if(Lu)return e(a,c);Lu=!0;try{var d=e(a);return d}finally{if(Lu=!1,(br!==null||Ka!==null)&&(Xl(),br&&(a=br,e=Ka,Ka=br=null,Mf(a),e)))for(a=0;a<e.length;a++)Mf(e[a])}}function El(e,a){var c=e.stateNode;if(c===null)return null;var d=c[re]||null;if(d===null)return null;c=d[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(e=e.type,d=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!d;break t;default:e=!1}if(e)return null;if(c&&typeof c!="function")throw Error(i(231,a,typeof c));return c}var Qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gu=!1;if(Qa)try{var Ts={};Object.defineProperty(Ts,"passive",{get:function(){Gu=!0}}),window.addEventListener("test",Ts,Ts),window.removeEventListener("test",Ts,Ts)}catch{Gu=!1}var _r=null,Pu=null,Cl=null;function jf(){if(Cl)return Cl;var e,a=Pu,c=a.length,d,b="value"in _r?_r.value:_r.textContent,w=b.length;for(e=0;e<c&&a[e]===b[e];e++);var q=c-e;for(d=1;d<=q&&a[c-d]===b[w-d];d++);return Cl=b.slice(e,1<d?1-d:void 0)}function Co(e){var a=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&a===13&&(e=13)):e=a,e===10&&(e=13),32<=e||e===13?e:0}function To(){return!0}function Hu(){return!1}function Mi(e){function a(c,d,b,w,q){this._reactName=c,this._targetInst=b,this.type=d,this.nativeEvent=w,this.target=q,this.currentTarget=null;for(var tt in e)e.hasOwnProperty(tt)&&(c=e[tt],this[tt]=c?c(w):w[tt]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?To:Hu,this.isPropagationStopped=Hu,this}return C(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=To)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=To)},persist:function(){},isPersistent:To}),a}var Fr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Iu=Mi(Fr),Ao=C({},Fr,{view:0,detail:0}),Td=Mi(Ao),As,wo,Jr,Ro=C({},Ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jr&&(Jr&&e.type==="mousemove"?(As=e.screenX-Jr.screenX,wo=e.screenY-Jr.screenY):wo=As=0,Jr=e),As)},movementY:function(e){return"movementY"in e?e.movementY:wo}}),Df=Mi(Ro),ku=C({},Ro,{dataTransfer:0}),Oo=Mi(ku),qu=C({},Ao,{relatedTarget:0}),Vu=Mi(qu),Ad=C({},Fr,{animationName:0,elapsedTime:0,pseudoElement:0}),Zr=Mi(Ad),wd=C({},Fr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Wr=Mi(wd),Er=C({},Fr,{data:0}),xo=Mi(Er),Uf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ws(e){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(e):(e=Od[e])?!!a[e]:!1}function Tl(){return ws}var xd=C({},Ao,{key:function(e){if(e.key){var a=Uf[e.key]||e.key;if(a!=="Unidentified")return a}return e.type==="keypress"?(e=Co(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Rd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tl,charCode:function(e){return e.type==="keypress"?Co(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Co(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Bf=Mi(xd),Md=C({},Ro,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zf=Mi(Md),Bg=C({},Ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tl}),hi=Mi(Bg),Nd=C({},Fr,{propertyName:0,elapsedTime:0,pseudoElement:0}),jd=Mi(Nd),Dd=C({},Ro,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ud=Mi(Dd),Bd=C({},Fr,{newState:0,oldState:0}),Yu=Mi(Bd),Lf=[9,13,27,32],Ku=Qa&&"CompositionEvent"in window,Al=null;Qa&&"documentMode"in document&&(Al=document.documentMode);var zd=Qa&&"TextEvent"in window&&!Al,Qu=Qa&&(!Ku||Al&&8<Al&&11>=Al),Xu=" ",Gf=!1;function Fu(e,a){switch(e){case"keyup":return Lf.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mo(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $r=!1;function Ld(e,a){switch(e){case"compositionend":return Mo(a);case"keypress":return a.which!==32?null:(Gf=!0,Xu);case"textInput":return e=a.data,e===Xu&&Gf?null:e;default:return null}}function Pf(e,a){if($r)return e==="compositionend"||!Ku&&Fu(e,a)?(e=jf(),Cl=Pu=_r=null,$r=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Qu&&a.locale!=="ko"?null:a.data;default:return null}}var Gd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xa(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a==="input"?!!Gd[e.type]:a==="textarea"}function Ju(e,a,c,d){br?Ka?Ka.push(d):Ka=[d]:br=d,a=x0(a,"onChange"),0<a.length&&(c=new Iu("onChange","change",null,c,d),e.push({event:c,listeners:a}))}var No=null,wl=null;function aa(e){_v(e,0)}function jo(e){var a=yr(e);if(Cf(a))return e}function Zu(e,a){if(e==="change")return a}var Hf=!1;if(Qa){var Wu;if(Qa){var Do="oninput"in document;if(!Do){var $u=document.createElement("div");$u.setAttribute("oninput","return;"),Do=typeof $u.oninput=="function"}Wu=Do}else Wu=!1;Hf=Wu&&(!document.documentMode||9<document.documentMode)}function If(){No&&(No.detachEvent("onpropertychange",Uo),wl=No=null)}function Uo(e){if(e.propertyName==="value"&&jo(wl)){var a=[];Ju(a,wl,e,zu(e)),Nf(aa,a)}}function Bo(e,a,c){e==="focusin"?(If(),No=a,wl=c,No.attachEvent("onpropertychange",Uo)):e==="focusout"&&If()}function zn(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return jo(wl)}function zg(e,a){if(e==="click")return jo(a)}function Lg(e,a){if(e==="input"||e==="change")return jo(a)}function Pd(e,a){return e===a&&(e!==0||1/e===1/a)||e!==e&&a!==a}var di=typeof Object.is=="function"?Object.is:Pd;function ya(e,a){if(di(e,a))return!0;if(typeof e!="object"||e===null||typeof a!="object"||a===null)return!1;var c=Object.keys(e),d=Object.keys(a);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var b=c[d];if(!gn.call(a,b)||!di(e[b],a[b]))return!1}return!0}function kf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qf(e,a){var c=kf(e);e=0;for(var d;c;){if(c.nodeType===3){if(d=e+c.textContent.length,e<=a&&d>=a)return{node:c,offset:a-e};e=d}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=kf(c)}}function Rl(e,a){return e&&a?e===a?!0:e&&e.nodeType===3?!1:a&&a.nodeType===3?Rl(e,a.parentNode):"contains"in e?e.contains(a):e.compareDocumentPosition?!!(e.compareDocumentPosition(a)&16):!1:!1}function xa(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var a=bo(e.document);a instanceof e.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)e=a.contentWindow;else break;a=bo(e.document)}return a}function tc(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a&&(a==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||a==="textarea"||e.contentEditable==="true")}var Vf=Qa&&"documentMode"in document&&11>=document.documentMode,Rs=null,zo=null,Os=null,Ol=!1;function Yf(e,a,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Ol||Rs==null||Rs!==bo(d)||(d=Rs,"selectionStart"in d&&tc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Os&&ya(Os,d)||(Os=d,d=x0(zo,"onSelect"),0<d.length&&(a=new Iu("onSelect","select",null,a,c),e.push({event:a,listeners:d}),a.target=Rs)))}function ts(e,a){var c={};return c[e.toLowerCase()]=a.toLowerCase(),c["Webkit"+e]="webkit"+a,c["Moz"+e]="moz"+a,c}var xl={animationend:ts("Animation","AnimationEnd"),animationiteration:ts("Animation","AnimationIteration"),animationstart:ts("Animation","AnimationStart"),transitionrun:ts("Transition","TransitionRun"),transitionstart:ts("Transition","TransitionStart"),transitioncancel:ts("Transition","TransitionCancel"),transitionend:ts("Transition","TransitionEnd")},ec={},Kf={};Qa&&(Kf=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function gi(e){if(ec[e])return ec[e];if(!xl[e])return e;var a=xl[e],c;for(c in a)if(a.hasOwnProperty(c)&&c in Kf)return ec[e]=a[c];return e}var nc=gi("animationend"),Qf=gi("animationiteration"),Hd=gi("animationstart"),Xf=gi("transitionrun"),Ni=gi("transitionstart"),Id=gi("transitioncancel"),ji=gi("transitionend"),Ff=new Map,Fa="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Fa.push("scrollEnd");function pi(e,a){Ff.set(e,a),Sr(a,[e])}var Ma=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Yi=[],es=0,Sa=0;function Lo(){for(var e=es,a=Sa=es=0;a<e;){var c=Yi[a];Yi[a++]=null;var d=Yi[a];Yi[a++]=null;var b=Yi[a];Yi[a++]=null;var w=Yi[a];if(Yi[a++]=null,d!==null&&b!==null){var q=d.pending;q===null?b.next=b:(b.next=q.next,q.next=b),d.pending=b}w!==0&&Jf(c,b,w)}}function Cr(e,a,c,d){Yi[es++]=e,Yi[es++]=a,Yi[es++]=c,Yi[es++]=d,Sa|=d,e.lanes|=d,e=e.alternate,e!==null&&(e.lanes|=d)}function xs(e,a,c,d){return Cr(e,a,c,d),Go(e)}function ra(e,a){return Cr(e,null,null,a),Go(e)}function Jf(e,a,c){e.lanes|=c;var d=e.alternate;d!==null&&(d.lanes|=c);for(var b=!1,w=e.return;w!==null;)w.childLanes|=c,d=w.alternate,d!==null&&(d.childLanes|=c),w.tag===22&&(e=w.stateNode,e===null||e._visibility&1||(b=!0)),e=w,w=w.return;return e.tag===3?(w=e.stateNode,b&&a!==null&&(b=31-ue(c),e=w.hiddenUpdates,d=e[b],d===null?e[b]=[a]:d.push(a),a.lane=c|536870912),w):null}function Go(e){if(50<ol)throw ol=0,ul=null,Error(i(185));for(var a=e.return;a!==null;)e=a,a=e.return;return e.tag===3?e.stateNode:null}var Ja={};function kd(e,a,c,d){this.tag=e,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ai(e,a,c,d){return new kd(e,a,c,d)}function ic(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Na(e,a){var c=e.alternate;return c===null?(c=Ai(e.tag,a,e.key,e.mode),c.elementType=e.elementType,c.type=e.type,c.stateNode=e.stateNode,c.alternate=e,e.alternate=c):(c.pendingProps=a,c.type=e.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=e.flags&65011712,c.childLanes=e.childLanes,c.lanes=e.lanes,c.child=e.child,c.memoizedProps=e.memoizedProps,c.memoizedState=e.memoizedState,c.updateQueue=e.updateQueue,a=e.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=e.sibling,c.index=e.index,c.ref=e.ref,c.refCleanup=e.refCleanup,c}function ac(e,a){e.flags&=65011714;var c=e.alternate;return c===null?(e.childLanes=0,e.lanes=a,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=c.childLanes,e.lanes=c.lanes,e.child=c.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=c.memoizedProps,e.memoizedState=c.memoizedState,e.updateQueue=c.updateQueue,e.type=c.type,a=c.dependencies,e.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),e}function Ml(e,a,c,d,b,w){var q=0;if(d=e,typeof e=="function")ic(e)&&(q=1);else if(typeof e=="string")q=t4(e,c,V.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case z:return e=Ai(31,c,a,b),e.elementType=z,e.lanes=w,e;case N:return ns(c.children,b,w,a);case B:q=8,b|=24;break;case L:return e=Ai(12,c,a,b|2),e.elementType=L,e.lanes=w,e;case O:return e=Ai(13,c,a,b),e.elementType=O,e.lanes=w,e;case A:return e=Ai(19,c,a,b),e.elementType=A,e.lanes=w,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:q=10;break t;case j:q=9;break t;case G:q=11;break t;case T:q=14;break t;case y:q=16,d=null;break t}q=29,c=Error(i(130,e===null?"null":typeof e,"")),d=null}return a=Ai(q,c,a,b),a.elementType=e,a.type=d,a.lanes=w,a}function ns(e,a,c,d){return e=Ai(7,e,d,a),e.lanes=c,e}function Po(e,a,c){return e=Ai(6,e,null,a),e.lanes=c,e}function Ki(e){var a=Ai(18,null,null,0);return a.stateNode=e,a}function rc(e,a,c){return a=Ai(4,e.children!==null?e.children:[],e.key,a),a.lanes=c,a.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},a}var Qi=new WeakMap;function sa(e,a){if(typeof e=="object"&&e!==null){var c=Qi.get(e);return c!==void 0?c:(a={value:e,source:a,stack:He(a)},Qi.set(e,a),a)}return{value:e,source:a,stack:He(a)}}var Ms=[],Nl=0,ja=null,jl=0,Xi=[],mi=0,Tr=null,Da=1,Ua="";function Za(e,a){Ms[Nl++]=jl,Ms[Nl++]=ja,ja=e,jl=a}function sc(e,a,c){Xi[mi++]=Da,Xi[mi++]=Ua,Xi[mi++]=Tr,Tr=e;var d=Da;e=Ua;var b=32-ue(d)-1;d&=~(1<<b),c+=1;var w=32-ue(a)+b;if(30<w){var q=b-b%5;w=(d&(1<<q)-1).toString(32),d>>=q,b-=q,Da=1<<32-ue(a)+b|c<<b|d,Ua=w+e}else Da=1<<w|c<<b|d,Ua=e}function Ho(e){e.return!==null&&(Za(e,1),sc(e,1,0))}function Zf(e){for(;e===ja;)ja=Ms[--Nl],Ms[Nl]=null,jl=Ms[--Nl],Ms[Nl]=null;for(;e===Tr;)Tr=Xi[--mi],Xi[mi]=null,Ua=Xi[--mi],Xi[mi]=null,Da=Xi[--mi],Xi[mi]=null}function qd(e,a){Xi[mi++]=Da,Xi[mi++]=Ua,Xi[mi++]=Tr,Da=a.id,Ua=a.overflow,Tr=e}var vi=null,yn=null,Ie=!1,la=null,Di=!1,lc=Error(i(519));function Ar(e){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Dl(sa(a,e)),lc}function Wf(e){var a=e.stateNode,c=e.type,d=e.memoizedProps;switch(a[te]=e,a[re]=d,c){case"dialog":Ve("cancel",a),Ve("close",a);break;case"iframe":case"object":case"embed":Ve("load",a);break;case"video":case"audio":for(c=0;c<Lh.length;c++)Ve(Lh[c],a);break;case"source":Ve("error",a);break;case"img":case"image":case"link":Ve("error",a),Ve("load",a);break;case"details":Ve("toggle",a);break;case"input":Ve("invalid",a),Tf(a,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Ve("invalid",a);break;case"textarea":Ve("invalid",a),Rf(a,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||d.suppressHydrationWarning===!0||Av(a.textContent,c)?(d.popover!=null&&(Ve("beforetoggle",a),Ve("toggle",a)),d.onScroll!=null&&Ve("scroll",a),d.onScrollEnd!=null&&Ve("scrollend",a),d.onClick!=null&&(a.onclick=Vi),a=!0):a=!1,a||Ar(e,!0)}function $f(e){for(vi=e.return;vi;)switch(vi.tag){case 5:case 31:case 13:Di=!1;return;case 27:case 3:Di=!0;return;default:vi=vi.return}}function Ns(e){if(e!==vi)return!1;if(!Ie)return $f(e),Ie=!0,!1;var a=e.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=e.type,c=!(c!=="form"&&c!=="button")||ep(e.type,e.memoizedProps)),c=!c),c&&yn&&Ar(e),$f(e),a===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));yn=Uv(e)}else if(a===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));yn=Uv(e)}else a===27?(a=yn,Zl(e.type)?(e=sp,sp=null,yn=e):yn=a):yn=vi?pr(e.stateNode.nextSibling):null;return!0}function is(){yn=vi=null,Ie=!1}function js(){var e=la;return e!==null&&(_n===null?_n=e:_n.push.apply(_n,e),la=null),e}function Dl(e){la===null?la=[e]:la.push(e)}var oc=Z(null),qe=null,Ba=null;function as(e,a,c){rt(oc,a._currentValue),a._currentValue=c}function Wa(e){e._currentValue=oc.current,at(oc)}function th(e,a,c){for(;e!==null;){var d=e.alternate;if((e.childLanes&a)!==a?(e.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),e===c)break;e=e.return}}function eh(e,a,c,d){var b=e.child;for(b!==null&&(b.return=e);b!==null;){var w=b.dependencies;if(w!==null){var q=b.child;w=w.firstContext;t:for(;w!==null;){var tt=w;w=b;for(var ot=0;ot<a.length;ot++)if(tt.context===a[ot]){w.lanes|=c,tt=w.alternate,tt!==null&&(tt.lanes|=c),th(w.return,c,e),d||(q=null);break t}w=tt.next}}else if(b.tag===18){if(q=b.return,q===null)throw Error(i(341));q.lanes|=c,w=q.alternate,w!==null&&(w.lanes|=c),th(q,c,e),q=null}else q=b.child;if(q!==null)q.return=b;else for(q=b;q!==null;){if(q===e){q=null;break}if(b=q.sibling,b!==null){b.return=q.return,q=b;break}q=q.return}b=q}}function Ul(e,a,c,d){e=null;for(var b=a,w=!1;b!==null;){if(!w){if((b.flags&524288)!==0)w=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var q=b.alternate;if(q===null)throw Error(i(387));if(q=q.memoizedProps,q!==null){var tt=b.type;di(b.pendingProps.value,q.value)||(e!==null?e.push(tt):e=[tt])}}else if(b===nt.current){if(q=b.alternate,q===null)throw Error(i(387));q.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(e!==null?e.push(kh):e=[kh])}b=b.return}e!==null&&eh(a,e,c,d),a.flags|=262144}function uc(e){for(e=e.firstContext;e!==null;){if(!di(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function wr(e){qe=e,Ba=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Tn(e){return ko(qe,e)}function Io(e,a){return qe===null&&wr(e),ko(e,a)}function ko(e,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},Ba===null){if(e===null)throw Error(i(308));Ba=a,e.dependencies={lanes:0,firstContext:a},e.flags|=524288}else Ba=Ba.next=a;return c}var Ds=typeof AbortController<"u"?AbortController:function(){var e=[],a=this.signal={aborted:!1,addEventListener:function(c,d){e.push(d)}};this.abort=function(){a.aborted=!0,e.forEach(function(c){return c()})}},nh=l.unstable_scheduleCallback,ih=l.unstable_NormalPriority,Zn={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function cc(){return{controller:new Ds,data:new Map,refCount:0}}function Bl(e){e.refCount--,e.refCount===0&&nh(ih,function(){e.controller.abort()})}var zl=null,fc=0,Us=0,rs=null;function Pe(e,a){if(zl===null){var c=zl=[];fc=0,Us=Kg(),rs={status:"pending",value:void 0,then:function(d){c.push(d)}}}return fc++,a.then(Vd,Vd),a}function Vd(){if(--fc===0&&zl!==null){rs!==null&&(rs.status="fulfilled");var e=zl;zl=null,Us=0,rs=null;for(var a=0;a<e.length;a++)(0,e[a])()}}function oa(e,a){var c=[],d={status:"pending",value:null,reason:null,then:function(b){c.push(b)}};return e.then(function(){d.status="fulfilled",d.value=a;for(var b=0;b<c.length;b++)(0,c[b])(a)},function(b){for(d.status="rejected",d.reason=b,b=0;b<c.length;b++)(0,c[b])(void 0)}),d}var hc=D.S;D.S=function(e,a){Pc=ye(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Pe(e,a),hc!==null&&hc(e,a)};var Bs=Z(null);function Ll(){var e=Bs.current;return e!==null?e:ze.pooledCache}function Rr(e,a){a===null?rt(Bs,Bs.current):rt(Bs,a.pool)}function zs(){var e=Ll();return e===null?null:{parent:Zn._currentValue,pool:e}}var Ls=Error(i(460)),qo=Error(i(474)),dc=Error(i(542)),Vo={then:function(){}};function Or(e){return e=e.status,e==="fulfilled"||e==="rejected"}function gc(e,a,c){switch(c=e[c],c===void 0?e.push(a):c!==a&&(a.then(Vi,Vi),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,Nr(e),e;default:if(typeof a.status=="string")a.then(Vi,Vi);else{if(e=ze,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=a,e.status="pending",e.then(function(d){if(a.status==="pending"){var b=a;b.status="fulfilled",b.value=d}},function(d){if(a.status==="pending"){var b=a;b.status="rejected",b.reason=d}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,Nr(e),e}throw Mr=a,Ls}}function xr(e){try{var a=e._init;return a(e._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Mr=c,Ls):c}}var Mr=null;function pc(){if(Mr===null)throw Error(i(459));var e=Mr;return Mr=null,e}function Nr(e){if(e===Ls||e===dc)throw Error(i(483))}var ss=null,Yo=0;function Ko(e){var a=Yo;return Yo+=1,ss===null&&(ss=[]),gc(ss,e,a)}function Qo(e,a){a=a.props.ref,e.ref=a!==void 0?a:null}function Gs(e,a){throw a.$$typeof===E?Error(i(525)):(e=Object.prototype.toString.call(a),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":e)))}function me(e){function a(pt,ft){if(e){var yt=pt.deletions;yt===null?(pt.deletions=[ft],pt.flags|=16):yt.push(ft)}}function c(pt,ft){if(!e)return null;for(;ft!==null;)a(pt,ft),ft=ft.sibling;return null}function d(pt){for(var ft=new Map;pt!==null;)pt.key!==null?ft.set(pt.key,pt):ft.set(pt.index,pt),pt=pt.sibling;return ft}function b(pt,ft){return pt=Na(pt,ft),pt.index=0,pt.sibling=null,pt}function w(pt,ft,yt){return pt.index=yt,e?(yt=pt.alternate,yt!==null?(yt=yt.index,yt<ft?(pt.flags|=67108866,ft):yt):(pt.flags|=67108866,ft)):(pt.flags|=1048576,ft)}function q(pt){return e&&pt.alternate===null&&(pt.flags|=67108866),pt}function tt(pt,ft,yt,Nt){return ft===null||ft.tag!==6?(ft=Po(yt,pt.mode,Nt),ft.return=pt,ft):(ft=b(ft,yt),ft.return=pt,ft)}function ot(pt,ft,yt,Nt){var de=yt.type;return de===N?xt(pt,ft,yt.props.children,Nt,yt.key):ft!==null&&(ft.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===y&&xr(de)===ft.type)?(ft=b(ft,yt.props),Qo(ft,yt),ft.return=pt,ft):(ft=Ml(yt.type,yt.key,yt.props,null,pt.mode,Nt),Qo(ft,yt),ft.return=pt,ft)}function St(pt,ft,yt,Nt){return ft===null||ft.tag!==4||ft.stateNode.containerInfo!==yt.containerInfo||ft.stateNode.implementation!==yt.implementation?(ft=rc(yt,pt.mode,Nt),ft.return=pt,ft):(ft=b(ft,yt.children||[]),ft.return=pt,ft)}function xt(pt,ft,yt,Nt,de){return ft===null||ft.tag!==7?(ft=ns(yt,pt.mode,Nt,de),ft.return=pt,ft):(ft=b(ft,yt),ft.return=pt,ft)}function jt(pt,ft,yt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return ft=Po(""+ft,pt.mode,yt),ft.return=pt,ft;if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case R:return yt=Ml(ft.type,ft.key,ft.props,null,pt.mode,yt),Qo(yt,ft),yt.return=pt,yt;case v:return ft=rc(ft,pt.mode,yt),ft.return=pt,ft;case y:return ft=xr(ft),jt(pt,ft,yt)}if(Y(ft)||K(ft))return ft=ns(ft,pt.mode,yt,null),ft.return=pt,ft;if(typeof ft.then=="function")return jt(pt,Ko(ft),yt);if(ft.$$typeof===M)return jt(pt,Io(pt,ft),yt);Gs(pt,ft)}return null}function Et(pt,ft,yt,Nt){var de=ft!==null?ft.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return de!==null?null:tt(pt,ft,""+yt,Nt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case R:return yt.key===de?ot(pt,ft,yt,Nt):null;case v:return yt.key===de?St(pt,ft,yt,Nt):null;case y:return yt=xr(yt),Et(pt,ft,yt,Nt)}if(Y(yt)||K(yt))return de!==null?null:xt(pt,ft,yt,Nt,null);if(typeof yt.then=="function")return Et(pt,ft,Ko(yt),Nt);if(yt.$$typeof===M)return Et(pt,ft,Io(pt,yt),Nt);Gs(pt,yt)}return null}function Tt(pt,ft,yt,Nt,de){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return pt=pt.get(yt)||null,tt(ft,pt,""+Nt,de);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case R:return pt=pt.get(Nt.key===null?yt:Nt.key)||null,ot(ft,pt,Nt,de);case v:return pt=pt.get(Nt.key===null?yt:Nt.key)||null,St(ft,pt,Nt,de);case y:return Nt=xr(Nt),Tt(pt,ft,yt,Nt,de)}if(Y(Nt)||K(Nt))return pt=pt.get(yt)||null,xt(ft,pt,Nt,de,null);if(typeof Nt.then=="function")return Tt(pt,ft,yt,Ko(Nt),de);if(Nt.$$typeof===M)return Tt(pt,ft,yt,Io(ft,Nt),de);Gs(ft,Nt)}return null}function ie(pt,ft,yt,Nt){for(var de=null,sn=null,se=ft,Ge=ft=0,Ye=null;se!==null&&Ge<yt.length;Ge++){se.index>Ge?(Ye=se,se=null):Ye=se.sibling;var ln=Et(pt,se,yt[Ge],Nt);if(ln===null){se===null&&(se=Ye);break}e&&se&&ln.alternate===null&&a(pt,se),ft=w(ln,ft,Ge),sn===null?de=ln:sn.sibling=ln,sn=ln,se=Ye}if(Ge===yt.length)return c(pt,se),Ie&&Za(pt,Ge),de;if(se===null){for(;Ge<yt.length;Ge++)se=jt(pt,yt[Ge],Nt),se!==null&&(ft=w(se,ft,Ge),sn===null?de=se:sn.sibling=se,sn=se);return Ie&&Za(pt,Ge),de}for(se=d(se);Ge<yt.length;Ge++)Ye=Tt(se,pt,Ge,yt[Ge],Nt),Ye!==null&&(e&&Ye.alternate!==null&&se.delete(Ye.key===null?Ge:Ye.key),ft=w(Ye,ft,Ge),sn===null?de=Ye:sn.sibling=Ye,sn=Ye);return e&&se.forEach(function(no){return a(pt,no)}),Ie&&Za(pt,Ge),de}function Ce(pt,ft,yt,Nt){if(yt==null)throw Error(i(151));for(var de=null,sn=null,se=ft,Ge=ft=0,Ye=null,ln=yt.next();se!==null&&!ln.done;Ge++,ln=yt.next()){se.index>Ge?(Ye=se,se=null):Ye=se.sibling;var no=Et(pt,se,ln.value,Nt);if(no===null){se===null&&(se=Ye);break}e&&se&&no.alternate===null&&a(pt,se),ft=w(no,ft,Ge),sn===null?de=no:sn.sibling=no,sn=no,se=Ye}if(ln.done)return c(pt,se),Ie&&Za(pt,Ge),de;if(se===null){for(;!ln.done;Ge++,ln=yt.next())ln=jt(pt,ln.value,Nt),ln!==null&&(ft=w(ln,ft,Ge),sn===null?de=ln:sn.sibling=ln,sn=ln);return Ie&&Za(pt,Ge),de}for(se=d(se);!ln.done;Ge++,ln=yt.next())ln=Tt(se,pt,Ge,ln.value,Nt),ln!==null&&(e&&ln.alternate!==null&&se.delete(ln.key===null?Ge:ln.key),ft=w(ln,ft,Ge),sn===null?de=ln:sn.sibling=ln,sn=ln);return e&&se.forEach(function(f4){return a(pt,f4)}),Ie&&Za(pt,Ge),de}function Cn(pt,ft,yt,Nt){if(typeof yt=="object"&&yt!==null&&yt.type===N&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case R:t:{for(var de=yt.key;ft!==null;){if(ft.key===de){if(de=yt.type,de===N){if(ft.tag===7){c(pt,ft.sibling),Nt=b(ft,yt.props.children),Nt.return=pt,pt=Nt;break t}}else if(ft.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===y&&xr(de)===ft.type){c(pt,ft.sibling),Nt=b(ft,yt.props),Qo(Nt,yt),Nt.return=pt,pt=Nt;break t}c(pt,ft);break}else a(pt,ft);ft=ft.sibling}yt.type===N?(Nt=ns(yt.props.children,pt.mode,Nt,yt.key),Nt.return=pt,pt=Nt):(Nt=Ml(yt.type,yt.key,yt.props,null,pt.mode,Nt),Qo(Nt,yt),Nt.return=pt,pt=Nt)}return q(pt);case v:t:{for(de=yt.key;ft!==null;){if(ft.key===de)if(ft.tag===4&&ft.stateNode.containerInfo===yt.containerInfo&&ft.stateNode.implementation===yt.implementation){c(pt,ft.sibling),Nt=b(ft,yt.children||[]),Nt.return=pt,pt=Nt;break t}else{c(pt,ft);break}else a(pt,ft);ft=ft.sibling}Nt=rc(yt,pt.mode,Nt),Nt.return=pt,pt=Nt}return q(pt);case y:return yt=xr(yt),Cn(pt,ft,yt,Nt)}if(Y(yt))return ie(pt,ft,yt,Nt);if(K(yt)){if(de=K(yt),typeof de!="function")throw Error(i(150));return yt=de.call(yt),Ce(pt,ft,yt,Nt)}if(typeof yt.then=="function")return Cn(pt,ft,Ko(yt),Nt);if(yt.$$typeof===M)return Cn(pt,ft,Io(pt,yt),Nt);Gs(pt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint"?(yt=""+yt,ft!==null&&ft.tag===6?(c(pt,ft.sibling),Nt=b(ft,yt),Nt.return=pt,pt=Nt):(c(pt,ft),Nt=Po(yt,pt.mode,Nt),Nt.return=pt,pt=Nt),q(pt)):c(pt,ft)}return function(pt,ft,yt,Nt){try{Yo=0;var de=Cn(pt,ft,yt,Nt);return ss=null,de}catch(se){if(se===Ls||se===dc)throw se;var sn=Ai(29,se,null,pt.mode);return sn.lanes=Nt,sn.return=pt,sn}finally{}}}var Ps=me(!0),Yd=me(!1),jr=!1;function Hs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ah(e,a){e=e.updateQueue,a.updateQueue===e&&(a.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ls(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function os(e,a,c){var d=e.updateQueue;if(d===null)return null;if(d=d.shared,(Se&2)!==0){var b=d.pending;return b===null?a.next=a:(a.next=b.next,b.next=a),d.pending=a,a=Go(e),Jf(e,null,c),a}return Cr(e,d,a,c),Go(e)}function Xo(e,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var d=a.lanes;d&=e.pendingLanes,c|=d,a.lanes=c,Wt(e,c)}}function rh(e,a){var c=e.updateQueue,d=e.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var b=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var q={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};w===null?b=w=q:w=w.next=q,c=c.next}while(c!==null);w===null?b=w=a:w=w.next=a}else b=w=a;c={baseState:d.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:d.shared,callbacks:d.callbacks},e.updateQueue=c;return}e=c.lastBaseUpdate,e===null?c.firstBaseUpdate=a:e.next=a,c.lastBaseUpdate=a}var Fo=!1;function Gl(){if(Fo){var e=rs;if(e!==null)throw e}}function us(e,a,c,d){Fo=!1;var b=e.updateQueue;jr=!1;var w=b.firstBaseUpdate,q=b.lastBaseUpdate,tt=b.shared.pending;if(tt!==null){b.shared.pending=null;var ot=tt,St=ot.next;ot.next=null,q===null?w=St:q.next=St,q=ot;var xt=e.alternate;xt!==null&&(xt=xt.updateQueue,tt=xt.lastBaseUpdate,tt!==q&&(tt===null?xt.firstBaseUpdate=St:tt.next=St,xt.lastBaseUpdate=ot))}if(w!==null){var jt=b.baseState;q=0,xt=St=ot=null,tt=w;do{var Et=tt.lane&-536870913,Tt=Et!==tt.lane;if(Tt?(De&Et)===Et:(d&Et)===Et){Et!==0&&Et===Us&&(Fo=!0),xt!==null&&(xt=xt.next={lane:0,tag:tt.tag,payload:tt.payload,callback:null,next:null});t:{var ie=e,Ce=tt;Et=a;var Cn=c;switch(Ce.tag){case 1:if(ie=Ce.payload,typeof ie=="function"){jt=ie.call(Cn,jt,Et);break t}jt=ie;break t;case 3:ie.flags=ie.flags&-65537|128;case 0:if(ie=Ce.payload,Et=typeof ie=="function"?ie.call(Cn,jt,Et):ie,Et==null)break t;jt=C({},jt,Et);break t;case 2:jr=!0}}Et=tt.callback,Et!==null&&(e.flags|=64,Tt&&(e.flags|=8192),Tt=b.callbacks,Tt===null?b.callbacks=[Et]:Tt.push(Et))}else Tt={lane:Et,tag:tt.tag,payload:tt.payload,callback:tt.callback,next:null},xt===null?(St=xt=Tt,ot=jt):xt=xt.next=Tt,q|=Et;if(tt=tt.next,tt===null){if(tt=b.shared.pending,tt===null)break;Tt=tt,tt=Tt.next,Tt.next=null,b.lastBaseUpdate=Tt,b.shared.pending=null}}while(!0);xt===null&&(ot=jt),b.baseState=ot,b.firstBaseUpdate=St,b.lastBaseUpdate=xt,w===null&&(b.shared.lanes=0),vs|=q,e.lanes=q,e.memoizedState=jt}}function sh(e,a){if(typeof e!="function")throw Error(i(191,e));e.call(a)}function Kd(e,a){var c=e.callbacks;if(c!==null)for(e.callbacks=null,e=0;e<c.length;e++)sh(c[e],a)}var Pl=Z(null),$a=Z(0);function tr(e,a){e=Ca,rt($a,e),rt(Pl,a),Ca=e|a.baseLanes}function si(){rt($a,Ca),rt(Pl,Pl.current)}function er(){Ca=$a.current,at(Pl),at($a)}var Mn=Z(null),ba=null;function cs(e){var a=e.alternate;rt(kn,kn.current&1),rt(Mn,e),ba===null&&(a===null||Pl.current!==null||a.memoizedState!==null)&&(ba=e)}function Wn(e){rt(kn,kn.current),rt(Mn,e),ba===null&&(ba=e)}function nr(e){e.tag===22?(rt(kn,kn.current),rt(Mn,e),ba===null&&(ba=e)):fs()}function fs(){rt(kn,kn.current),rt(Mn,Mn.current)}function ua(e){at(Mn),ba===e&&(ba=null),at(kn)}var kn=Z(0);function mc(e){for(var a=e;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||ap(c)||rp(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ir=0,Oe=null,un=null,$n=null,Dr=!1,_a=!1,Is=!1,vc=0,Jo=0,ar=null,Gg=0;function In(){throw Error(i(321))}function lh(e,a){if(a===null)return!1;for(var c=0;c<a.length&&c<e.length;c++)if(!di(e[c],a[c]))return!1;return!0}function ks(e,a,c,d,b,w){return ir=w,Oe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,D.H=e===null||e.memoizedState===null?qs:tu,Is=!1,w=c(d,b),Is=!1,_a&&(w=Xd(a,c,d,b)),Qd(e),w}function Qd(e){D.H=Il;var a=un!==null&&un.next!==null;if(ir=0,$n=un=Oe=null,Dr=!1,Jo=0,ar=null,a)throw Error(i(300));e===null||ti||(e=e.dependencies,e!==null&&uc(e)&&(ti=!0))}function Xd(e,a,c,d){Oe=e;var b=0;do{if(_a&&(ar=null),Jo=0,_a=!1,25<=b)throw Error(i(301));if(b+=1,$n=un=null,e.updateQueue!=null){var w=e.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}D.H=Vs,w=a(c,d)}while(_a);return w}function Pg(){var e=D.H,a=e.useState()[0];return a=typeof a.then=="function"?Zo(a):a,e=e.useState()[0],(un!==null?un.memoizedState:null)!==e&&(Oe.flags|=1024),a}function oh(){var e=vc!==0;return vc=0,e}function uh(e,a,c){a.updateQueue=e.updateQueue,a.flags&=-2053,e.lanes&=~c}function ch(e){if(Dr){for(e=e.memoizedState;e!==null;){var a=e.queue;a!==null&&(a.pending=null),e=e.next}Dr=!1}ir=0,$n=un=Oe=null,_a=!1,Jo=vc=0,ar=null}function Ui(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $n===null?Oe.memoizedState=$n=e:$n=$n.next=e,$n}function qn(){if(un===null){var e=Oe.alternate;e=e!==null?e.memoizedState:null}else e=un.next;var a=$n===null?Oe.memoizedState:$n.next;if(a!==null)$n=a,un=e;else{if(e===null)throw Oe.alternate===null?Error(i(467)):Error(i(310));un=e,e={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},$n===null?Oe.memoizedState=$n=e:$n=$n.next=e}return $n}function yc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zo(e){var a=Jo;return Jo+=1,ar===null&&(ar=[]),e=gc(ar,e,a),a=Oe,($n===null?a.memoizedState:$n.next)===null&&(a=a.alternate,D.H=a===null||a.memoizedState===null?qs:tu),e}function Sc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Zo(e);if(e.$$typeof===M)return Tn(e)}throw Error(i(438,String(e)))}function fh(e){var a=null,c=Oe.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var d=Oe.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(a={data:d.data.map(function(b){return b.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=yc(),Oe.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(e),d=0;d<e;d++)c[d]=U;return a.index++,c}function rr(e,a){return typeof a=="function"?a(e):a}function bc(e){var a=qn();return hh(a,un,e)}function hh(e,a,c){var d=e.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=c;var b=e.baseQueue,w=d.pending;if(w!==null){if(b!==null){var q=b.next;b.next=w.next,w.next=q}a.baseQueue=b=w,d.pending=null}if(w=e.baseState,b===null)e.memoizedState=w;else{a=b.next;var tt=q=null,ot=null,St=a,xt=!1;do{var jt=St.lane&-536870913;if(jt!==St.lane?(De&jt)===jt:(ir&jt)===jt){var Et=St.revertLane;if(Et===0)ot!==null&&(ot=ot.next={lane:0,revertLane:0,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),jt===Us&&(xt=!0);else if((ir&Et)===Et){St=St.next,Et===Us&&(xt=!0);continue}else jt={lane:0,revertLane:St.revertLane,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ot===null?(tt=ot=jt,q=w):ot=ot.next=jt,Oe.lanes|=Et,vs|=Et;jt=St.action,Is&&c(w,jt),w=St.hasEagerState?St.eagerState:c(w,jt)}else Et={lane:jt,revertLane:St.revertLane,gesture:St.gesture,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ot===null?(tt=ot=Et,q=w):ot=ot.next=Et,Oe.lanes|=jt,vs|=jt;St=St.next}while(St!==null&&St!==a);if(ot===null?q=w:ot.next=tt,!di(w,e.memoizedState)&&(ti=!0,xt&&(c=rs,c!==null)))throw c;e.memoizedState=w,e.baseState=q,e.baseQueue=ot,d.lastRenderedState=w}return b===null&&(d.lanes=0),[e.memoizedState,d.dispatch]}function dh(e){var a=qn(),c=a.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=e;var d=c.dispatch,b=c.pending,w=a.memoizedState;if(b!==null){c.pending=null;var q=b=b.next;do w=e(w,q.action),q=q.next;while(q!==b);di(w,a.memoizedState)||(ti=!0),a.memoizedState=w,a.baseQueue===null&&(a.baseState=w),c.lastRenderedState=w}return[w,d]}function Fd(e,a,c){var d=Oe,b=qn(),w=Ie;if(w){if(c===void 0)throw Error(i(407));c=c()}else c=a();var q=!di((un||b).memoizedState,c);if(q&&(b.memoizedState=c,ti=!0),b=b.queue,Sh(gh.bind(null,d,b,e),[e]),b.getSnapshot!==a||q||$n!==null&&$n.memoizedState.tag&1){if(d.flags|=2048,Hl(9,{destroy:void 0},Zd.bind(null,d,b,c,a),null),ze===null)throw Error(i(349));w||(ir&127)!==0||Jd(d,a,c)}return c}function Jd(e,a,c){e.flags|=16384,e={getSnapshot:a,value:c},a=Oe.updateQueue,a===null?(a=yc(),Oe.updateQueue=a,a.stores=[e]):(c=a.stores,c===null?a.stores=[e]:c.push(e))}function Zd(e,a,c,d){a.value=c,a.getSnapshot=d,ph(a)&&Wd(e)}function gh(e,a,c){return c(function(){ph(a)&&Wd(e)})}function ph(e){var a=e.getSnapshot;e=e.value;try{var c=a();return!di(e,c)}catch{return!0}}function Wd(e){var a=ra(e,2);a!==null&&rn(a,e,2)}function _c(e){var a=Ui();if(typeof e=="function"){var c=e;if(e=c(),Is){Rt(!0);try{c()}finally{Rt(!1)}}}return a.memoizedState=a.baseState=e,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:e},a}function mh(e,a,c,d){return e.baseState=c,hh(e,un,typeof d=="function"?d:rr)}function $d(e,a,c,d,b){if($o(e))throw Error(i(485));if(e=a.action,e!==null){var w={payload:b,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){w.listeners.push(q)}};D.T!==null?c(!0):w.isTransition=!1,d(w),c=a.pending,c===null?(w.next=a.pending=w,Ec(a,w)):(w.next=c.next,a.pending=c.next=w)}}function Ec(e,a){var c=a.action,d=a.payload,b=e.state;if(a.isTransition){var w=D.T,q={};D.T=q;try{var tt=c(b,d),ot=D.S;ot!==null&&ot(q,tt),Cc(e,a,tt)}catch(St){vh(e,a,St)}finally{w!==null&&q.types!==null&&(w.types=q.types),D.T=w}}else try{w=c(b,d),Cc(e,a,w)}catch(St){vh(e,a,St)}}function Cc(e,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){t0(e,a,d)},function(d){return vh(e,a,d)}):t0(e,a,c)}function t0(e,a,c){a.status="fulfilled",a.value=c,e0(a),e.state=c,a=e.pending,a!==null&&(c=a.next,c===a?e.pending=null:(c=c.next,a.next=c,Ec(e,c)))}function vh(e,a,c){var d=e.pending;if(e.pending=null,d!==null){d=d.next;do a.status="rejected",a.reason=c,e0(a),a=a.next;while(a!==d)}e.action=null}function e0(e){e=e.listeners;for(var a=0;a<e.length;a++)(0,e[a])()}function n0(e,a){return a}function yh(e,a){if(Ie){var c=ze.formState;if(c!==null){t:{var d=Oe;if(Ie){if(yn){e:{for(var b=yn,w=Di;b.nodeType!==8;){if(!w){b=null;break e}if(b=pr(b.nextSibling),b===null){b=null;break e}}w=b.data,b=w==="F!"||w==="F"?b:null}if(b){yn=pr(b.nextSibling),d=b.data==="F!";break t}}Ar(d)}d=!1}d&&(a=c[0])}}return c=Ui(),c.memoizedState=c.baseState=a,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n0,lastRenderedState:a},c.queue=d,c=Ch.bind(null,Oe,d),d.dispatch=c,d=_c(!1),w=Vn.bind(null,Oe,!1,d.queue),d=Ui(),b={state:a,dispatch:null,action:e,pending:null},d.queue=b,c=$d.bind(null,Oe,b,w,c),b.dispatch=c,d.memoizedState=e,[a,c,!1]}function i0(e){var a=qn();return a0(a,un,e)}function a0(e,a,c){if(a=hh(e,a,n0)[0],e=bc(rr)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var d=Zo(a)}catch(q){throw q===Ls?dc:q}else d=a;a=qn();var b=a.queue,w=b.dispatch;return c!==a.memoizedState&&(Oe.flags|=2048,Hl(9,{destroy:void 0},Hg.bind(null,b,c),null)),[d,w,e]}function Hg(e,a){e.action=a}function r0(e){var a=qn(),c=un;if(c!==null)return a0(a,c,e);qn(),a=a.memoizedState,c=qn();var d=c.queue.dispatch;return c.memoizedState=e,[a,d,!1]}function Hl(e,a,c,d){return e={tag:e,create:c,deps:d,inst:a,next:null},a=Oe.updateQueue,a===null&&(a=yc(),Oe.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=e.next=e:(d=c.next,c.next=e,e.next=d,a.lastEffect=e),e}function s0(){return qn().memoizedState}function Tc(e,a,c,d){var b=Ui();Oe.flags|=e,b.memoizedState=Hl(1|a,{destroy:void 0},c,d===void 0?null:d)}function Ac(e,a,c,d){var b=qn();d=d===void 0?null:d;var w=b.memoizedState.inst;un!==null&&d!==null&&lh(d,un.memoizedState.deps)?b.memoizedState=Hl(a,w,c,d):(Oe.flags|=e,b.memoizedState=Hl(1|a,w,c,d))}function l0(e,a){Tc(8390656,8,e,a)}function Sh(e,a){Ac(2048,8,e,a)}function Ig(e){Oe.flags|=4;var a=Oe.updateQueue;if(a===null)a=yc(),Oe.updateQueue=a,a.events=[e];else{var c=a.events;c===null?a.events=[e]:c.push(e)}}function o0(e){var a=qn().memoizedState;return Ig({ref:a,nextImpl:e}),function(){if((Se&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function u0(e,a){return Ac(4,2,e,a)}function c0(e,a){return Ac(4,4,e,a)}function f0(e,a){if(typeof a=="function"){e=e();var c=a(e);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return e=e(),a.current=e,function(){a.current=null}}function h0(e,a,c){c=c!=null?c.concat([e]):null,Ac(4,4,f0.bind(null,a,e),c)}function wc(){}function d0(e,a){var c=qn();a=a===void 0?null:a;var d=c.memoizedState;return a!==null&&lh(a,d[1])?d[0]:(c.memoizedState=[e,a],e)}function g0(e,a){var c=qn();a=a===void 0?null:a;var d=c.memoizedState;if(a!==null&&lh(a,d[1]))return d[0];if(d=e(),Is){Rt(!0);try{e()}finally{Rt(!1)}}return c.memoizedState=[d,a],d}function ca(e,a,c){return c===void 0||(ir&1073741824)!==0&&(De&261930)===0?e.memoizedState=a:(e.memoizedState=c,e=Hr(),Oe.lanes|=e,vs|=e,c)}function bh(e,a,c,d){return di(c,a)?c:Pl.current!==null?(e=ca(e,c,d),di(e,a)||(ti=!0),e):(ir&42)===0||(ir&1073741824)!==0&&(De&261930)===0?(ti=!0,e.memoizedState=c):(e=Hr(),Oe.lanes|=e,vs|=e,a)}function Rc(e,a,c,d,b){var w=I.p;I.p=w!==0&&8>w?w:8;var q=D.T,tt={};D.T=tt,Vn(e,!1,a,c);try{var ot=b(),St=D.S;if(St!==null&&St(tt,ot),ot!==null&&typeof ot=="object"&&typeof ot.then=="function"){var xt=oa(ot,d);Wo(e,a,xt,xi(e))}else Wo(e,a,d,xi(e))}catch(jt){Wo(e,a,{then:function(){},status:"rejected",reason:jt},xi())}finally{I.p=w,q!==null&&tt.types!==null&&(q.types=tt.types),D.T=q}}function p0(){}function Oc(e,a,c,d){if(e.tag!==5)throw Error(i(476));var b=_h(e).queue;Rc(e,b,a,F,c===null?p0:function(){return m0(e),c(d)})}function _h(e){var a=e.memoizedState;if(a!==null)return a;a={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:F},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:c},next:null},e.memoizedState=a,e=e.alternate,e!==null&&(e.memoizedState=a),a}function m0(e){var a=_h(e);a.next===null&&(a=e.alternate.memoizedState),Wo(e,a.next.queue,{},xi())}function xc(){return Tn(kh)}function Eh(){return qn().memoizedState}function v0(){return qn().memoizedState}function kg(e){for(var a=e.return;a!==null;){switch(a.tag){case 24:case 3:var c=xi();e=ls(c);var d=os(a,e,c);d!==null&&(rn(d,a,c),Xo(d,a,c)),a={cache:cc()},e.payload=a;return}a=a.return}}function qg(e,a,c){var d=xi();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},$o(e)?y0(a,c):(c=xs(e,a,c,d),c!==null&&(rn(c,e,d),Th(c,a,d)))}function Ch(e,a,c){var d=xi();Wo(e,a,c,d)}function Wo(e,a,c,d){var b={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if($o(e))y0(a,b);else{var w=e.alternate;if(e.lanes===0&&(w===null||w.lanes===0)&&(w=a.lastRenderedReducer,w!==null))try{var q=a.lastRenderedState,tt=w(q,c);if(b.hasEagerState=!0,b.eagerState=tt,di(tt,q))return Cr(e,a,b,0),ze===null&&Lo(),!1}catch{}finally{}if(c=xs(e,a,b,d),c!==null)return rn(c,e,d),Th(c,a,d),!0}return!1}function Vn(e,a,c,d){if(d={lane:2,revertLane:Kg(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},$o(e)){if(a)throw Error(i(479))}else a=xs(e,c,d,2),a!==null&&rn(a,e,2)}function $o(e){var a=e.alternate;return e===Oe||a!==null&&a===Oe}function y0(e,a){_a=Dr=!0;var c=e.pending;c===null?a.next=a:(a.next=c.next,c.next=a),e.pending=a}function Th(e,a,c){if((c&4194048)!==0){var d=a.lanes;d&=e.pendingLanes,c|=d,a.lanes=c,Wt(e,c)}}var Il={readContext:Tn,use:Sc,useCallback:In,useContext:In,useEffect:In,useImperativeHandle:In,useLayoutEffect:In,useInsertionEffect:In,useMemo:In,useReducer:In,useRef:In,useState:In,useDebugValue:In,useDeferredValue:In,useTransition:In,useSyncExternalStore:In,useId:In,useHostTransitionStatus:In,useFormState:In,useActionState:In,useOptimistic:In,useMemoCache:In,useCacheRefresh:In};Il.useEffectEvent=In;var qs={readContext:Tn,use:Sc,useCallback:function(e,a){return Ui().memoizedState=[e,a===void 0?null:a],e},useContext:Tn,useEffect:l0,useImperativeHandle:function(e,a,c){c=c!=null?c.concat([e]):null,Tc(4194308,4,f0.bind(null,a,e),c)},useLayoutEffect:function(e,a){return Tc(4194308,4,e,a)},useInsertionEffect:function(e,a){Tc(4,2,e,a)},useMemo:function(e,a){var c=Ui();a=a===void 0?null:a;var d=e();if(Is){Rt(!0);try{e()}finally{Rt(!1)}}return c.memoizedState=[d,a],d},useReducer:function(e,a,c){var d=Ui();if(c!==void 0){var b=c(a);if(Is){Rt(!0);try{c(a)}finally{Rt(!1)}}}else b=a;return d.memoizedState=d.baseState=b,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:b},d.queue=e,e=e.dispatch=qg.bind(null,Oe,e),[d.memoizedState,e]},useRef:function(e){var a=Ui();return e={current:e},a.memoizedState=e},useState:function(e){e=_c(e);var a=e.queue,c=Ch.bind(null,Oe,a);return a.dispatch=c,[e.memoizedState,c]},useDebugValue:wc,useDeferredValue:function(e,a){var c=Ui();return ca(c,e,a)},useTransition:function(){var e=_c(!1);return e=Rc.bind(null,Oe,e.queue,!0,!1),Ui().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,a,c){var d=Oe,b=Ui();if(Ie){if(c===void 0)throw Error(i(407));c=c()}else{if(c=a(),ze===null)throw Error(i(349));(De&127)!==0||Jd(d,a,c)}b.memoizedState=c;var w={value:c,getSnapshot:a};return b.queue=w,l0(gh.bind(null,d,w,e),[e]),d.flags|=2048,Hl(9,{destroy:void 0},Zd.bind(null,d,w,c,a),null),c},useId:function(){var e=Ui(),a=ze.identifierPrefix;if(Ie){var c=Ua,d=Da;c=(d&~(1<<32-ue(d)-1)).toString(32)+c,a="_"+a+"R_"+c,c=vc++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=Gg++,a="_"+a+"r_"+c.toString(32)+"_";return e.memoizedState=a},useHostTransitionStatus:xc,useFormState:yh,useActionState:yh,useOptimistic:function(e){var a=Ui();a.memoizedState=a.baseState=e;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=Vn.bind(null,Oe,!0,c),c.dispatch=a,[e,a]},useMemoCache:fh,useCacheRefresh:function(){return Ui().memoizedState=kg.bind(null,Oe)},useEffectEvent:function(e){var a=Ui(),c={impl:e};return a.memoizedState=c,function(){if((Se&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},tu={readContext:Tn,use:Sc,useCallback:d0,useContext:Tn,useEffect:Sh,useImperativeHandle:h0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:g0,useReducer:bc,useRef:s0,useState:function(){return bc(rr)},useDebugValue:wc,useDeferredValue:function(e,a){var c=qn();return bh(c,un.memoizedState,e,a)},useTransition:function(){var e=bc(rr)[0],a=qn().memoizedState;return[typeof e=="boolean"?e:Zo(e),a]},useSyncExternalStore:Fd,useId:Eh,useHostTransitionStatus:xc,useFormState:i0,useActionState:i0,useOptimistic:function(e,a){var c=qn();return mh(c,un,e,a)},useMemoCache:fh,useCacheRefresh:v0};tu.useEffectEvent=o0;var Vs={readContext:Tn,use:Sc,useCallback:d0,useContext:Tn,useEffect:Sh,useImperativeHandle:h0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:g0,useReducer:dh,useRef:s0,useState:function(){return dh(rr)},useDebugValue:wc,useDeferredValue:function(e,a){var c=qn();return un===null?ca(c,e,a):bh(c,un.memoizedState,e,a)},useTransition:function(){var e=dh(rr)[0],a=qn().memoizedState;return[typeof e=="boolean"?e:Zo(e),a]},useSyncExternalStore:Fd,useId:Eh,useHostTransitionStatus:xc,useFormState:r0,useActionState:r0,useOptimistic:function(e,a){var c=qn();return un!==null?mh(c,un,e,a):(c.baseState=e,[e,c.queue.dispatch])},useMemoCache:fh,useCacheRefresh:v0};Vs.useEffectEvent=o0;function hs(e,a,c,d){a=e.memoizedState,c=c(d,a),c=c==null?a:C({},a,c),e.memoizedState=c,e.lanes===0&&(e.updateQueue.baseState=c)}var Bi={enqueueSetState:function(e,a,c){e=e._reactInternals;var d=xi(),b=ls(d);b.payload=a,c!=null&&(b.callback=c),a=os(e,b,d),a!==null&&(rn(a,e,d),Xo(a,e,d))},enqueueReplaceState:function(e,a,c){e=e._reactInternals;var d=xi(),b=ls(d);b.tag=1,b.payload=a,c!=null&&(b.callback=c),a=os(e,b,d),a!==null&&(rn(a,e,d),Xo(a,e,d))},enqueueForceUpdate:function(e,a){e=e._reactInternals;var c=xi(),d=ls(c);d.tag=2,a!=null&&(d.callback=a),a=os(e,d,c),a!==null&&(rn(a,e,c),Xo(a,e,c))}};function S0(e,a,c,d,b,w,q){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(d,w,q):a.prototype&&a.prototype.isPureReactComponent?!ya(c,d)||!ya(b,w):!0}function b0(e,a,c,d){e=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,d),a.state!==e&&Bi.enqueueReplaceState(a,a.state,null)}function sr(e,a){var c=a;if("ref"in a){c={};for(var d in a)d!=="ref"&&(c[d]=a[d])}if(e=e.defaultProps){c===a&&(c=C({},c));for(var b in e)c[b]===void 0&&(c[b]=e[b])}return c}function eu(e){Ma(e)}function nu(e){console.error(e)}function Mc(e){Ma(e)}function Nc(e,a){try{var c=e.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(d){setTimeout(function(){throw d})}}function _0(e,a,c){try{var d=e.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function fa(e,a,c){return c=ls(c),c.tag=3,c.payload={element:null},c.callback=function(){Nc(e,a)},c}function Ah(e){return e=ls(e),e.tag=3,e}function E0(e,a,c,d){var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var w=d.value;e.payload=function(){return b(w)},e.callback=function(){_0(a,c,d)}}var q=c.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(e.callback=function(){_0(a,c,d),typeof b!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var tt=d.stack;this.componentDidCatch(d.value,{componentStack:tt!==null?tt:""})})}function wh(e,a,c,d,b){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(a=c.alternate,a!==null&&Ul(a,c,b,!0),c=Mn.current,c!==null){switch(c.tag){case 31:case 13:return ba===null?S():c.alternate===null&&bn===0&&(bn=3),c.flags&=-257,c.flags|=65536,c.lanes=b,d===Vo?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([d]):a.add(d),vn(e,d,b)),!1;case 22:return c.flags|=65536,d===Vo?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([d]):c.add(d)),vn(e,d,b)),!1}throw Error(i(435,c.tag))}return vn(e,d,b),S(),!1}if(Ie)return a=Mn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=b,d!==lc&&(e=Error(i(422),{cause:d}),Dl(sa(e,c)))):(d!==lc&&(a=Error(i(423),{cause:d}),Dl(sa(a,c))),e=e.current.alternate,e.flags|=65536,b&=-b,e.lanes|=b,d=sa(d,c),b=fa(e.stateNode,d,b),rh(e,b),bn!==4&&(bn=2)),!1;var w=Error(i(520),{cause:d});if(w=sa(w,c),Ke===null?Ke=[w]:Ke.push(w),bn!==4&&(bn=2),a===null)return!0;d=sa(d,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,e=b&-b,c.lanes|=e,e=fa(c.stateNode,d,e),rh(c,e),!1;case 1:if(a=c.type,w=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Pi===null||!Pi.has(w))))return c.flags|=65536,b&=-b,c.lanes|=b,b=Ah(b),E0(b,e,c,d),rh(c,b),!1}c=c.return}while(c!==null);return!1}var Rh=Error(i(461)),ti=!1;function yi(e,a,c,d){a.child=e===null?Yd(a,null,c,d):Ps(a,e.child,c,d)}function kl(e,a,c,d,b){c=c.render;var w=a.ref;if("ref"in d){var q={};for(var tt in d)tt!=="ref"&&(q[tt]=d[tt])}else q=d;return wr(a),d=ks(e,a,c,q,w,b),tt=oh(),e!==null&&!ti?(uh(e,a,b),Ga(e,a,b)):(Ie&&tt&&Ho(a),a.flags|=1,yi(e,a,d,b),a.child)}function Fi(e,a,c,d,b){if(e===null){var w=c.type;return typeof w=="function"&&!ic(w)&&w.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=w,jc(e,a,w,d,b)):(e=Ml(c.type,null,d,a,a.mode,b),e.ref=a.ref,e.return=a,a.child=e)}if(w=e.child,!zi(e,b)){var q=w.memoizedProps;if(c=c.compare,c=c!==null?c:ya,c(q,d)&&e.ref===a.ref)return Ga(e,a,b)}return a.flags|=1,e=Na(w,d),e.ref=a.ref,e.return=a,a.child=e}function jc(e,a,c,d,b){if(e!==null){var w=e.memoizedProps;if(ya(w,d)&&e.ref===a.ref)if(ti=!1,a.pendingProps=d=w,zi(e,b))(e.flags&131072)!==0&&(ti=!0);else return a.lanes=e.lanes,Ga(e,a,b)}return Ji(e,a,c,d,b)}function Oh(e,a,c,d){var b=d.children,w=e!==null?e.memoizedState:null;if(e===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((a.flags&128)!==0){if(w=w!==null?w.baseLanes|c:c,e!==null){for(d=a.child=e.child,b=0;d!==null;)b=b|d.lanes|d.childLanes,d=d.sibling;d=b&~w}else d=0,a.child=null;return xh(e,a,w,c,d)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},e!==null&&Rr(a,w!==null?w.cachePool:null),w!==null?tr(a,w):si(),nr(a);else return d=a.lanes=536870912,xh(e,a,w!==null?w.baseLanes|c:c,c,d)}else w!==null?(Rr(a,w.cachePool),tr(a,w),fs(),a.memoizedState=null):(e!==null&&Rr(a,null),si(),fs());return yi(e,a,b,c),a.child}function Ys(e,a){return e!==null&&e.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function xh(e,a,c,d,b){var w=Ll();return w=w===null?null:{parent:Zn._currentValue,pool:w},a.memoizedState={baseLanes:c,cachePool:w},e!==null&&Rr(a,null),si(),nr(a),e!==null&&Ul(e,a,d,!0),a.childLanes=b,null}function Ur(e,a){return a=li({mode:a.mode,children:a.children},e.mode),a.ref=e.ref,e.child=a,a.return=e,a}function Ks(e,a,c){return Ps(a,e.child,null,c),e=Ur(a,a.pendingProps),e.flags|=2,ua(a),a.memoizedState=null,e}function Dc(e,a,c){var d=a.pendingProps,b=(a.flags&128)!==0;if(a.flags&=-129,e===null){if(Ie){if(d.mode==="hidden")return e=Ur(a,d),a.lanes=536870912,Ys(null,e);if(Wn(a),(e=yn)?(e=Dv(e,Di),e=e!==null&&e.data==="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:Tr!==null?{id:Da,overflow:Ua}:null,retryLane:536870912,hydrationErrors:null},c=Ki(e),c.return=a,a.child=c,vi=a,yn=null)):e=null,e===null)throw Ar(a);return a.lanes=536870912,null}return Ur(a,d)}var w=e.memoizedState;if(w!==null){var q=w.dehydrated;if(Wn(a),b)if(a.flags&256)a.flags&=-257,a=Ks(e,a,c);else if(a.memoizedState!==null)a.child=e.child,a.flags|=128,a=null;else throw Error(i(558));else if(ti||Ul(e,a,c,!1),b=(c&e.childLanes)!==0,ti||b){if(d=ze,d!==null&&(q=$t(d,c),q!==0&&q!==w.retryLane))throw w.retryLane=q,ra(e,q),rn(d,e,q),Rh;S(),a=Ks(e,a,c)}else e=w.treeContext,yn=pr(q.nextSibling),vi=a,Ie=!0,la=null,Di=!1,e!==null&&qd(a,e),a=Ur(a,d),a.flags|=4096;return a}return e=Na(e.child,{mode:d.mode,children:d.children}),e.ref=a.ref,a.child=e,e.return=a,e}function Qs(e,a){var c=a.ref;if(c===null)e!==null&&e.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(e===null||e.ref!==c)&&(a.flags|=4194816)}}function Ji(e,a,c,d,b){return wr(a),c=ks(e,a,c,d,void 0,b),d=oh(),e!==null&&!ti?(uh(e,a,b),Ga(e,a,b)):(Ie&&d&&Ho(a),a.flags|=1,yi(e,a,c,b),a.child)}function ha(e,a,c,d,b,w){return wr(a),a.updateQueue=null,c=Xd(a,d,c,b),Qd(e),d=oh(),e!==null&&!ti?(uh(e,a,w),Ga(e,a,w)):(Ie&&d&&Ho(a),a.flags|=1,yi(e,a,c,w),a.child)}function ds(e,a,c,d,b){if(wr(a),a.stateNode===null){var w=Ja,q=c.contextType;typeof q=="object"&&q!==null&&(w=Tn(q)),w=new c(d,w),a.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Bi,a.stateNode=w,w._reactInternals=a,w=a.stateNode,w.props=d,w.state=a.memoizedState,w.refs={},Hs(a),q=c.contextType,w.context=typeof q=="object"&&q!==null?Tn(q):Ja,w.state=a.memoizedState,q=c.getDerivedStateFromProps,typeof q=="function"&&(hs(a,c,q,d),w.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(q=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),q!==w.state&&Bi.enqueueReplaceState(w,w.state,null),us(a,d,w,b),Gl(),w.state=a.memoizedState),typeof w.componentDidMount=="function"&&(a.flags|=4194308),d=!0}else if(e===null){w=a.stateNode;var tt=a.memoizedProps,ot=sr(c,tt);w.props=ot;var St=w.context,xt=c.contextType;q=Ja,typeof xt=="object"&&xt!==null&&(q=Tn(xt));var jt=c.getDerivedStateFromProps;xt=typeof jt=="function"||typeof w.getSnapshotBeforeUpdate=="function",tt=a.pendingProps!==tt,xt||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(tt||St!==q)&&b0(a,w,d,q),jr=!1;var Et=a.memoizedState;w.state=Et,us(a,d,w,b),Gl(),St=a.memoizedState,tt||Et!==St||jr?(typeof jt=="function"&&(hs(a,c,jt,d),St=a.memoizedState),(ot=jr||S0(a,c,ot,d,Et,St,q))?(xt||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(a.flags|=4194308)):(typeof w.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=St),w.props=d,w.state=St,w.context=q,d=ot):(typeof w.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{w=a.stateNode,ah(e,a),q=a.memoizedProps,xt=sr(c,q),w.props=xt,jt=a.pendingProps,Et=w.context,St=c.contextType,ot=Ja,typeof St=="object"&&St!==null&&(ot=Tn(St)),tt=c.getDerivedStateFromProps,(St=typeof tt=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(q!==jt||Et!==ot)&&b0(a,w,d,ot),jr=!1,Et=a.memoizedState,w.state=Et,us(a,d,w,b),Gl();var Tt=a.memoizedState;q!==jt||Et!==Tt||jr||e!==null&&e.dependencies!==null&&uc(e.dependencies)?(typeof tt=="function"&&(hs(a,c,tt,d),Tt=a.memoizedState),(xt=jr||S0(a,c,xt,d,Et,Tt,ot)||e!==null&&e.dependencies!==null&&uc(e.dependencies))?(St||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(d,Tt,ot),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(d,Tt,ot)),typeof w.componentDidUpdate=="function"&&(a.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(a.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=Tt),w.props=d,w.state=Tt,w.context=ot,d=xt):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(a.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(a.flags|=1024),d=!1)}return w=d,Qs(e,a),d=(a.flags&128)!==0,w||d?(w=a.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:w.render(),a.flags|=1,e!==null&&d?(a.child=Ps(a,e.child,null,b),a.child=Ps(a,null,c,b)):yi(e,a,c,b),a.memoizedState=w.state,e=a.child):e=Ga(e,a,b),e}function lr(e,a,c,d){return is(),a.flags|=256,yi(e,a,c,d),a.child}var za={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ii(e){return{baseLanes:e,cachePool:zs()}}function Xs(e,a,c){return e=e!==null?e.childLanes&~c:0,a&&(e|=Ee),e}function Br(e,a,c){var d=a.pendingProps,b=!1,w=(a.flags&128)!==0,q;if((q=w)||(q=e!==null&&e.memoizedState===null?!1:(kn.current&2)!==0),q&&(b=!0,a.flags&=-129),q=(a.flags&32)!==0,a.flags&=-33,e===null){if(Ie){if(b?cs(a):fs(),(e=yn)?(e=Dv(e,Di),e=e!==null&&e.data!=="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:Tr!==null?{id:Da,overflow:Ua}:null,retryLane:536870912,hydrationErrors:null},c=Ki(e),c.return=a,a.child=c,vi=a,yn=null)):e=null,e===null)throw Ar(a);return rp(e)?a.lanes=32:a.lanes=536870912,null}var tt=d.children;return d=d.fallback,b?(fs(),b=a.mode,tt=li({mode:"hidden",children:tt},b),d=ns(d,b,c,null),tt.return=a,d.return=a,tt.sibling=d,a.child=tt,d=a.child,d.memoizedState=ii(c),d.childLanes=Xs(e,q,c),a.memoizedState=za,Ys(null,d)):(cs(a),ql(a,tt))}var ot=e.memoizedState;if(ot!==null&&(tt=ot.dehydrated,tt!==null)){if(w)a.flags&256?(cs(a),a.flags&=-257,a=Yn(e,a,c)):a.memoizedState!==null?(fs(),a.child=e.child,a.flags|=128,a=null):(fs(),tt=d.fallback,b=a.mode,d=li({mode:"visible",children:d.children},b),tt=ns(tt,b,c,null),tt.flags|=2,d.return=a,tt.return=a,d.sibling=tt,a.child=d,Ps(a,e.child,null,c),d=a.child,d.memoizedState=ii(c),d.childLanes=Xs(e,q,c),a.memoizedState=za,a=Ys(null,d));else if(cs(a),rp(tt)){if(q=tt.nextSibling&&tt.nextSibling.dataset,q)var St=q.dgst;q=St,d=Error(i(419)),d.stack="",d.digest=q,Dl({value:d,source:null,stack:null}),a=Yn(e,a,c)}else if(ti||Ul(e,a,c,!1),q=(c&e.childLanes)!==0,ti||q){if(q=ze,q!==null&&(d=$t(q,c),d!==0&&d!==ot.retryLane))throw ot.retryLane=d,ra(e,d),rn(q,e,d),Rh;ap(tt)||S(),a=Yn(e,a,c)}else ap(tt)?(a.flags|=192,a.child=e.child,a=null):(e=ot.treeContext,yn=pr(tt.nextSibling),vi=a,Ie=!0,la=null,Di=!1,e!==null&&qd(a,e),a=ql(a,d.children),a.flags|=4096);return a}return b?(fs(),tt=d.fallback,b=a.mode,ot=e.child,St=ot.sibling,d=Na(ot,{mode:"hidden",children:d.children}),d.subtreeFlags=ot.subtreeFlags&65011712,St!==null?tt=Na(St,tt):(tt=ns(tt,b,c,null),tt.flags|=2),tt.return=a,d.return=a,d.sibling=tt,a.child=d,Ys(null,d),d=a.child,tt=e.child.memoizedState,tt===null?tt=ii(c):(b=tt.cachePool,b!==null?(ot=Zn._currentValue,b=b.parent!==ot?{parent:ot,pool:ot}:b):b=zs(),tt={baseLanes:tt.baseLanes|c,cachePool:b}),d.memoizedState=tt,d.childLanes=Xs(e,q,c),a.memoizedState=za,Ys(e.child,d)):(cs(a),c=e.child,e=c.sibling,c=Na(c,{mode:"visible",children:d.children}),c.return=a,c.sibling=null,e!==null&&(q=a.deletions,q===null?(a.deletions=[e],a.flags|=16):q.push(e)),a.child=c,a.memoizedState=null,c)}function ql(e,a){return a=li({mode:"visible",children:a},e.mode),a.return=e,e.child=a}function li(e,a){return e=Ai(22,e,null,a),e.lanes=0,e}function Yn(e,a,c){return Ps(a,e.child,null,c),e=ql(a,a.pendingProps.children),e.flags|=2,a.memoizedState=null,e}function Fe(e,a,c){e.lanes|=a;var d=e.alternate;d!==null&&(d.lanes|=a),th(e.return,a,c)}function zr(e,a,c,d,b,w){var q=e.memoizedState;q===null?e.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:b,treeForkCount:w}:(q.isBackwards=a,q.rendering=null,q.renderingStartTime=0,q.last=d,q.tail=c,q.tailMode=b,q.treeForkCount=w)}function La(e,a,c){var d=a.pendingProps,b=d.revealOrder,w=d.tail;d=d.children;var q=kn.current,tt=(q&2)!==0;if(tt?(q=q&1|2,a.flags|=128):q&=1,rt(kn,q),yi(e,a,d,c),d=Ie?jl:0,!tt&&e!==null&&(e.flags&128)!==0)t:for(e=a.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Fe(e,c,a);else if(e.tag===19)Fe(e,c,a);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===a)break t;for(;e.sibling===null;){if(e.return===null||e.return===a)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(b){case"forwards":for(c=a.child,b=null;c!==null;)e=c.alternate,e!==null&&mc(e)===null&&(b=c),c=c.sibling;c=b,c===null?(b=a.child,a.child=null):(b=c.sibling,c.sibling=null),zr(a,!1,b,c,w,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,b=a.child,a.child=null;b!==null;){if(e=b.alternate,e!==null&&mc(e)===null){a.child=b;break}e=b.sibling,b.sibling=c,c=b,b=e}zr(a,!0,c,null,w,d);break;case"together":zr(a,!1,null,null,void 0,d);break;default:a.memoizedState=null}return a.child}function Ga(e,a,c){if(e!==null&&(a.dependencies=e.dependencies),vs|=a.lanes,(c&a.childLanes)===0)if(e!==null){if(Ul(e,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(e!==null&&a.child!==e.child)throw Error(i(153));if(a.child!==null){for(e=a.child,c=Na(e,e.pendingProps),a.child=c,c.return=a;e.sibling!==null;)e=e.sibling,c=c.sibling=Na(e,e.pendingProps),c.return=a;c.sibling=null}return a.child}function zi(e,a){return(e.lanes&a)!==0?!0:(e=e.dependencies,!!(e!==null&&uc(e)))}function Uc(e,a,c){switch(a.tag){case 3:dt(a,a.stateNode.containerInfo),as(a,Zn,e.memoizedState.cache),is();break;case 27:case 5:Ut(a);break;case 4:dt(a,a.stateNode.containerInfo);break;case 10:as(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Wn(a),null;break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(cs(a),a.flags|=128,null):(c&a.child.childLanes)!==0?Br(e,a,c):(cs(a),e=Ga(e,a,c),e!==null?e.sibling:null);cs(a);break;case 19:var b=(e.flags&128)!==0;if(d=(c&a.childLanes)!==0,d||(Ul(e,a,c,!1),d=(c&a.childLanes)!==0),b){if(d)return La(e,a,c);a.flags|=128}if(b=a.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),rt(kn,kn.current),d)break;return null;case 22:return a.lanes=0,Oh(e,a,c,a.pendingProps);case 24:as(a,Zn,e.memoizedState.cache)}return Ga(e,a,c)}function gs(e,a,c){if(e!==null)if(e.memoizedProps!==a.pendingProps)ti=!0;else{if(!zi(e,c)&&(a.flags&128)===0)return ti=!1,Uc(e,a,c);ti=(e.flags&131072)!==0}else ti=!1,Ie&&(a.flags&1048576)!==0&&sc(a,jl,a.index);switch(a.lanes=0,a.tag){case 16:t:{var d=a.pendingProps;if(e=xr(a.elementType),a.type=e,typeof e=="function")ic(e)?(d=sr(e,d),a.tag=1,a=ds(null,a,e,d,c)):(a.tag=0,a=Ji(null,a,e,d,c));else{if(e!=null){var b=e.$$typeof;if(b===G){a.tag=11,a=kl(null,a,e,d,c);break t}else if(b===T){a.tag=14,a=Fi(null,a,e,d,c);break t}}throw a=X(e)||e,Error(i(306,a,""))}}return a;case 0:return Ji(e,a,a.type,a.pendingProps,c);case 1:return d=a.type,b=sr(d,a.pendingProps),ds(e,a,d,b,c);case 3:t:{if(dt(a,a.stateNode.containerInfo),e===null)throw Error(i(387));d=a.pendingProps;var w=a.memoizedState;b=w.element,ah(e,a),us(a,d,null,c);var q=a.memoizedState;if(d=q.cache,as(a,Zn,d),d!==w.cache&&eh(a,[Zn],c,!0),Gl(),d=q.element,w.isDehydrated)if(w={element:d,isDehydrated:!1,cache:q.cache},a.updateQueue.baseState=w,a.memoizedState=w,a.flags&256){a=lr(e,a,d,c);break t}else if(d!==b){b=sa(Error(i(424)),a),Dl(b),a=lr(e,a,d,c);break t}else{switch(e=a.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(yn=pr(e.firstChild),vi=a,Ie=!0,la=null,Di=!0,c=Yd(a,null,d,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(is(),d===b){a=Ga(e,a,c);break t}yi(e,a,d,c)}a=a.child}return a;case 26:return Qs(e,a),e===null?(c=Pv(a.type,null,a.pendingProps,null))?a.memoizedState=c:Ie||(c=a.type,e=a.pendingProps,d=M0($.current).createElement(c),d[te]=a,d[re]=e,Hi(d,c,e),ri(d),a.stateNode=d):a.memoizedState=Pv(a.type,e.memoizedProps,a.pendingProps,e.memoizedState),null;case 27:return Ut(a),e===null&&Ie&&(d=a.stateNode=zv(a.type,a.pendingProps,$.current),vi=a,Di=!0,b=yn,Zl(a.type)?(sp=b,yn=pr(d.firstChild)):yn=b),yi(e,a,a.pendingProps.children,c),Qs(e,a),e===null&&(a.flags|=4194304),a.child;case 5:return e===null&&Ie&&((b=d=yn)&&(d=Ib(d,a.type,a.pendingProps,Di),d!==null?(a.stateNode=d,vi=a,yn=pr(d.firstChild),Di=!1,b=!0):b=!1),b||Ar(a)),Ut(a),b=a.type,w=a.pendingProps,q=e!==null?e.memoizedProps:null,d=w.children,ep(b,w)?d=null:q!==null&&ep(b,q)&&(a.flags|=32),a.memoizedState!==null&&(b=ks(e,a,Pg,null,null,c),kh._currentValue=b),Qs(e,a),yi(e,a,d,c),a.child;case 6:return e===null&&Ie&&((e=c=yn)&&(c=kb(c,a.pendingProps,Di),c!==null?(a.stateNode=c,vi=a,yn=null,e=!0):e=!1),e||Ar(a)),null;case 13:return Br(e,a,c);case 4:return dt(a,a.stateNode.containerInfo),d=a.pendingProps,e===null?a.child=Ps(a,null,d,c):yi(e,a,d,c),a.child;case 11:return kl(e,a,a.type,a.pendingProps,c);case 7:return yi(e,a,a.pendingProps,c),a.child;case 8:return yi(e,a,a.pendingProps.children,c),a.child;case 12:return yi(e,a,a.pendingProps.children,c),a.child;case 10:return d=a.pendingProps,as(a,a.type,d.value),yi(e,a,d.children,c),a.child;case 9:return b=a.type._context,d=a.pendingProps.children,wr(a),b=Tn(b),d=d(b),a.flags|=1,yi(e,a,d,c),a.child;case 14:return Fi(e,a,a.type,a.pendingProps,c);case 15:return jc(e,a,a.type,a.pendingProps,c);case 19:return La(e,a,c);case 31:return Dc(e,a,c);case 22:return Oh(e,a,c,a.pendingProps);case 24:return wr(a),d=Tn(Zn),e===null?(b=Ll(),b===null&&(b=ze,w=cc(),b.pooledCache=w,w.refCount++,w!==null&&(b.pooledCacheLanes|=c),b=w),a.memoizedState={parent:d,cache:b},Hs(a),as(a,Zn,b)):((e.lanes&c)!==0&&(ah(e,a),us(a,null,null,c),Gl()),b=e.memoizedState,w=a.memoizedState,b.parent!==d?(b={parent:d,cache:d},a.memoizedState=b,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=b),as(a,Zn,d)):(d=w.cache,as(a,Zn,d),d!==b.cache&&eh(a,[Zn],c,!0))),yi(e,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Si(e){e.flags|=4}function Mh(e,a,c,d,b){if((a=(e.mode&32)!==0)&&(a=!1),a){if(e.flags|=16777216,(b&335544128)===b)if(e.stateNode.complete)e.flags|=8192;else if(s())e.flags|=8192;else throw Mr=Vo,qo}else e.flags&=-16777217}function C0(e,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Vv(a))if(s())e.flags|=8192;else throw Mr=Vo,qo}function Bc(e,a){a!==null&&(e.flags|=4),e.flags&16384&&(a=e.tag!==22?So():536870912,e.lanes|=a,Le|=a)}function Sn(e,a){if(!Ie)switch(e.tailMode){case"hidden":a=e.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?e.tail=null:c.sibling=null;break;case"collapsed":c=e.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a||e.tail===null?e.tail=null:e.tail.sibling=null:d.sibling=null}}function hn(e){var a=e.alternate!==null&&e.alternate.child===e.child,c=0,d=0;if(a)for(var b=e.child;b!==null;)c|=b.lanes|b.childLanes,d|=b.subtreeFlags&65011712,d|=b.flags&65011712,b.return=e,b=b.sibling;else for(b=e.child;b!==null;)c|=b.lanes|b.childLanes,d|=b.subtreeFlags,d|=b.flags,b.return=e,b=b.sibling;return e.subtreeFlags|=d,e.childLanes=c,a}function Vl(e,a,c){var d=a.pendingProps;switch(Zf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(a),null;case 1:return hn(a),null;case 3:return c=a.stateNode,d=null,e!==null&&(d=e.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),Wa(Zn),wt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(Ns(a)?Si(a):e===null||e.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,js())),hn(a),null;case 26:var b=a.type,w=a.memoizedState;return e===null?(Si(a),w!==null?(hn(a),C0(a,w)):(hn(a),Mh(a,b,null,d,c))):w?w!==e.memoizedState?(Si(a),hn(a),C0(a,w)):(hn(a),a.flags&=-16777217):(e=e.memoizedProps,e!==d&&Si(a),hn(a),Mh(a,b,e,d,c)),null;case 27:if(It(a),c=$.current,b=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==d&&Si(a);else{if(!d){if(a.stateNode===null)throw Error(i(166));return hn(a),null}e=V.current,Ns(a)?Wf(a):(e=zv(b,d,c),a.stateNode=e,Si(a))}return hn(a),null;case 5:if(It(a),b=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==d&&Si(a);else{if(!d){if(a.stateNode===null)throw Error(i(166));return hn(a),null}if(w=V.current,Ns(a))Wf(a);else{var q=M0($.current);switch(w){case 1:w=q.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:w=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":w=q.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":w=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":w=q.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof d.is=="string"?q.createElement("select",{is:d.is}):q.createElement("select"),d.multiple?w.multiple=!0:d.size&&(w.size=d.size);break;default:w=typeof d.is=="string"?q.createElement(b,{is:d.is}):q.createElement(b)}}w[te]=a,w[re]=d;t:for(q=a.child;q!==null;){if(q.tag===5||q.tag===6)w.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===a)break t;for(;q.sibling===null;){if(q.return===null||q.return===a)break t;q=q.return}q.sibling.return=q.return,q=q.sibling}a.stateNode=w;t:switch(Hi(w,b,d),b){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break t;case"img":d=!0;break t;default:d=!1}d&&Si(a)}}return hn(a),Mh(a,a.type,e===null?null:e.memoizedProps,a.pendingProps,c),null;case 6:if(e&&a.stateNode!=null)e.memoizedProps!==d&&Si(a);else{if(typeof d!="string"&&a.stateNode===null)throw Error(i(166));if(e=$.current,Ns(a)){if(e=a.stateNode,c=a.memoizedProps,d=null,b=vi,b!==null)switch(b.tag){case 27:case 5:d=b.memoizedProps}e[te]=a,e=!!(e.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||Av(e.nodeValue,c)),e||Ar(a,!0)}else e=M0(e).createTextNode(d),e[te]=a,a.stateNode=e}return hn(a),null;case 31:if(c=a.memoizedState,e===null||e.memoizedState!==null){if(d=Ns(a),c!==null){if(e===null){if(!d)throw Error(i(318));if(e=a.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[te]=a}else is(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;hn(a),e=!1}else c=js(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),e=!0;if(!e)return a.flags&256?(ua(a),a):(ua(a),null);if((a.flags&128)!==0)throw Error(i(558))}return hn(a),null;case 13:if(d=a.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(b=Ns(a),d!==null&&d.dehydrated!==null){if(e===null){if(!b)throw Error(i(318));if(b=a.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(i(317));b[te]=a}else is(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;hn(a),b=!1}else b=js(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=b),b=!0;if(!b)return a.flags&256?(ua(a),a):(ua(a),null)}return ua(a),(a.flags&128)!==0?(a.lanes=c,a):(c=d!==null,e=e!==null&&e.memoizedState!==null,c&&(d=a.child,b=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(b=d.alternate.memoizedState.cachePool.pool),w=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(w=d.memoizedState.cachePool.pool),w!==b&&(d.flags|=2048)),c!==e&&c&&(a.child.flags|=8192),Bc(a,a.updateQueue),hn(a),null);case 4:return wt(),e===null&&Jg(a.stateNode.containerInfo),hn(a),null;case 10:return Wa(a.type),hn(a),null;case 19:if(at(kn),d=a.memoizedState,d===null)return hn(a),null;if(b=(a.flags&128)!==0,w=d.rendering,w===null)if(b)Sn(d,!1);else{if(bn!==0||e!==null&&(e.flags&128)!==0)for(e=a.child;e!==null;){if(w=mc(e),w!==null){for(a.flags|=128,Sn(d,!1),e=w.updateQueue,a.updateQueue=e,Bc(a,e),a.subtreeFlags=0,e=c,c=a.child;c!==null;)ac(c,e),c=c.sibling;return rt(kn,kn.current&1|2),Ie&&Za(a,d.treeForkCount),a.child}e=e.sibling}d.tail!==null&&ye()>Ta&&(a.flags|=128,b=!0,Sn(d,!1),a.lanes=4194304)}else{if(!b)if(e=mc(w),e!==null){if(a.flags|=128,b=!0,e=e.updateQueue,a.updateQueue=e,Bc(a,e),Sn(d,!0),d.tail===null&&d.tailMode==="hidden"&&!w.alternate&&!Ie)return hn(a),null}else 2*ye()-d.renderingStartTime>Ta&&c!==536870912&&(a.flags|=128,b=!0,Sn(d,!1),a.lanes=4194304);d.isBackwards?(w.sibling=a.child,a.child=w):(e=d.last,e!==null?e.sibling=w:a.child=w,d.last=w)}return d.tail!==null?(e=d.tail,d.rendering=e,d.tail=e.sibling,d.renderingStartTime=ye(),e.sibling=null,c=kn.current,rt(kn,b?c&1|2:c&1),Ie&&Za(a,d.treeForkCount),e):(hn(a),null);case 22:case 23:return ua(a),er(),d=a.memoizedState!==null,e!==null?e.memoizedState!==null!==d&&(a.flags|=8192):d&&(a.flags|=8192),d?(c&536870912)!==0&&(a.flags&128)===0&&(hn(a),a.subtreeFlags&6&&(a.flags|=8192)):hn(a),c=a.updateQueue,c!==null&&Bc(a,c.retryQueue),c=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==c&&(a.flags|=2048),e!==null&&at(Bs),null;case 24:return c=null,e!==null&&(c=e.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Wa(Zn),hn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Nh(e,a){switch(Zf(a),a.tag){case 1:return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 3:return Wa(Zn),wt(),e=a.flags,(e&65536)!==0&&(e&128)===0?(a.flags=e&-65537|128,a):null;case 26:case 27:case 5:return It(a),null;case 31:if(a.memoizedState!==null){if(ua(a),a.alternate===null)throw Error(i(340));is()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 13:if(ua(a),e=a.memoizedState,e!==null&&e.dehydrated!==null){if(a.alternate===null)throw Error(i(340));is()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 19:return at(kn),null;case 4:return wt(),null;case 10:return Wa(a.type),null;case 22:case 23:return ua(a),er(),e!==null&&at(Bs),e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 24:return Wa(Zn),null;case 25:return null;default:return null}}function iu(e,a){switch(Zf(a),a.tag){case 3:Wa(Zn),wt();break;case 26:case 27:case 5:It(a);break;case 4:wt();break;case 31:a.memoizedState!==null&&ua(a);break;case 13:ua(a);break;case 19:at(kn);break;case 10:Wa(a.type);break;case 22:case 23:ua(a),er(),e!==null&&at(Bs);break;case 24:Wa(Zn)}}function Fs(e,a){try{var c=a.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var b=d.next;c=b;do{if((c.tag&e)===e){d=void 0;var w=c.create,q=c.inst;d=w(),q.destroy=d}c=c.next}while(c!==b)}}catch(tt){Qt(a,a.return,tt)}}function da(e,a,c){try{var d=a.updateQueue,b=d!==null?d.lastEffect:null;if(b!==null){var w=b.next;d=w;do{if((d.tag&e)===e){var q=d.inst,tt=q.destroy;if(tt!==void 0){q.destroy=void 0,b=a;var ot=c,St=tt;try{St()}catch(xt){Qt(b,ot,xt)}}}d=d.next}while(d!==w)}}catch(xt){Qt(a,a.return,xt)}}function Yl(e){var a=e.updateQueue;if(a!==null){var c=e.stateNode;try{Kd(a,c)}catch(d){Qt(e,e.return,d)}}}function zc(e,a,c){c.props=sr(e.type,e.memoizedProps),c.state=e.memoizedState;try{c.componentWillUnmount()}catch(d){Qt(e,a,d)}}function or(e,a){try{var c=e.ref;if(c!==null){switch(e.tag){case 26:case 27:case 5:var d=e.stateNode;break;case 30:d=e.stateNode;break;default:d=e.stateNode}typeof c=="function"?e.refCleanup=c(d):c.current=d}}catch(b){Qt(e,a,b)}}function Li(e,a){var c=e.ref,d=e.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(b){Qt(e,a,b)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(b){Qt(e,a,b)}else c.current=null}function jh(e){var a=e.type,c=e.memoizedProps,d=e.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break t;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(b){Qt(e,e.return,b)}}function Lr(e,a,c){try{var d=e.stateNode;Bb(d,e.type,c,a),d[re]=a}catch(b){Qt(e,e.return,b)}}function T0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Zl(e.type)||e.tag===4}function Js(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||T0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Zl(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function au(e,a,c){var d=e.tag;if(d===5||d===6)e=e.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(e,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(e),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Vi));else if(d!==4&&(d===27&&Zl(e.type)&&(c=e.stateNode,a=null),e=e.child,e!==null))for(au(e,a,c),e=e.sibling;e!==null;)au(e,a,c),e=e.sibling}function Zs(e,a,c){var d=e.tag;if(d===5||d===6)e=e.stateNode,a?c.insertBefore(e,a):c.appendChild(e);else if(d!==4&&(d===27&&Zl(e.type)&&(c=e.stateNode),e=e.child,e!==null))for(Zs(e,a,c),e=e.sibling;e!==null;)Zs(e,a,c),e=e.sibling}function ru(e){var a=e.stateNode,c=e.memoizedProps;try{for(var d=e.type,b=a.attributes;b.length;)a.removeAttributeNode(b[0]);Hi(a,d,c),a[te]=e,a[re]=c}catch(w){Qt(e,e.return,w)}}var Zi=!1,en=!1,ps=!1,Lc=typeof WeakSet=="function"?WeakSet:Set,An=null;function Dh(e,a){if(e=e.containerInfo,$g=L0,e=xa(e),tc(e)){if("selectionStart"in e)var c={start:e.selectionStart,end:e.selectionEnd};else t:{c=(c=e.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var b=d.anchorOffset,w=d.focusNode;d=d.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break t}var q=0,tt=-1,ot=-1,St=0,xt=0,jt=e,Et=null;e:for(;;){for(var Tt;jt!==c||b!==0&&jt.nodeType!==3||(tt=q+b),jt!==w||d!==0&&jt.nodeType!==3||(ot=q+d),jt.nodeType===3&&(q+=jt.nodeValue.length),(Tt=jt.firstChild)!==null;)Et=jt,jt=Tt;for(;;){if(jt===e)break e;if(Et===c&&++St===b&&(tt=q),Et===w&&++xt===d&&(ot=q),(Tt=jt.nextSibling)!==null)break;jt=Et,Et=jt.parentNode}jt=Tt}c=tt===-1||ot===-1?null:{start:tt,end:ot}}else c=null}c=c||{start:0,end:0}}else c=null;for(tp={focusedElem:e,selectionRange:c},L0=!1,An=a;An!==null;)if(a=An,e=a.child,(a.subtreeFlags&1028)!==0&&e!==null)e.return=a,An=e;else for(;An!==null;){switch(a=An,w=a.alternate,e=a.flags,a.tag){case 0:if((e&4)!==0&&(e=a.updateQueue,e=e!==null?e.events:null,e!==null))for(c=0;c<e.length;c++)b=e[c],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&w!==null){e=void 0,c=a,b=w.memoizedProps,w=w.memoizedState,d=c.stateNode;try{var ie=sr(c.type,b);e=d.getSnapshotBeforeUpdate(ie,w),d.__reactInternalSnapshotBeforeUpdate=e}catch(Ce){Qt(c,c.return,Ce)}}break;case 3:if((e&1024)!==0){if(e=a.stateNode.containerInfo,c=e.nodeType,c===9)ip(e);else if(c===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ip(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=a.sibling,e!==null){e.return=a.return,An=e;break}An=a.return}}function Ws(e,a,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:ur(e,c),d&4&&Fs(5,c);break;case 1:if(ur(e,c),d&4)if(e=c.stateNode,a===null)try{e.componentDidMount()}catch(q){Qt(c,c.return,q)}else{var b=sr(c.type,a.memoizedProps);a=a.memoizedState;try{e.componentDidUpdate(b,a,e.__reactInternalSnapshotBeforeUpdate)}catch(q){Qt(c,c.return,q)}}d&64&&Yl(c),d&512&&or(c,c.return);break;case 3:if(ur(e,c),d&64&&(e=c.updateQueue,e!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{Kd(e,a)}catch(q){Qt(c,c.return,q)}}break;case 27:a===null&&d&4&&ru(c);case 26:case 5:ur(e,c),a===null&&d&4&&jh(c),d&512&&or(c,c.return);break;case 12:ur(e,c);break;case 31:ur(e,c),d&4&&lu(e,c);break;case 13:ur(e,c),d&4&&$s(e,c),d&64&&(e=c.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(c=ci.bind(null,c),qb(e,c))));break;case 22:if(d=c.memoizedState!==null||Zi,!d){a=a!==null&&a.memoizedState!==null||en,b=Zi;var w=en;Zi=d,(en=a)&&!w?Wi(e,c,(c.subtreeFlags&8772)!==0):ur(e,c),Zi=b,en=w}break;case 30:break;default:ur(e,c)}}function su(e){var a=e.alternate;a!==null&&(e.alternate=null,su(a)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(a=e.stateNode,a!==null&&on(a)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var nn=null,ve=!1;function ke(e,a,c){for(c=c.child;c!==null;)Kn(e,a,c),c=c.sibling}function Kn(e,a,c){if(vt&&typeof vt.onCommitFiberUnmount=="function")try{vt.onCommitFiberUnmount(ht,c)}catch{}switch(c.tag){case 26:en||Li(c,a),ke(e,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:en||Li(c,a);var d=nn,b=ve;Zl(c.type)&&(nn=c.stateNode,ve=!1),ke(e,a,c),Ph(c.stateNode),nn=d,ve=b;break;case 5:en||Li(c,a);case 6:if(d=nn,b=ve,nn=null,ke(e,a,c),nn=d,ve=b,nn!==null)if(ve)try{(nn.nodeType===9?nn.body:nn.nodeName==="HTML"?nn.ownerDocument.body:nn).removeChild(c.stateNode)}catch(w){Qt(c,a,w)}else try{nn.removeChild(c.stateNode)}catch(w){Qt(c,a,w)}break;case 18:nn!==null&&(ve?(e=nn,Nv(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,c.stateNode),Xc(e)):Nv(nn,c.stateNode));break;case 4:d=nn,b=ve,nn=c.stateNode.containerInfo,ve=!0,ke(e,a,c),nn=d,ve=b;break;case 0:case 11:case 14:case 15:da(2,c,a),en||da(4,c,a),ke(e,a,c);break;case 1:en||(Li(c,a),d=c.stateNode,typeof d.componentWillUnmount=="function"&&zc(c,a,d)),ke(e,a,c);break;case 21:ke(e,a,c);break;case 22:en=(d=en)||c.memoizedState!==null,ke(e,a,c),en=d;break;default:ke(e,a,c)}}function lu(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Xc(e)}catch(c){Qt(a,a.return,c)}}}function $s(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Xc(e)}catch(c){Qt(a,a.return,c)}}function tl(e){switch(e.tag){case 31:case 13:case 19:var a=e.stateNode;return a===null&&(a=e.stateNode=new Lc),a;case 22:return e=e.stateNode,a=e._retryCache,a===null&&(a=e._retryCache=new Lc),a;default:throw Error(i(435,e.tag))}}function el(e,a){var c=tl(e);a.forEach(function(d){if(!c.has(d)){c.add(d);var b=Je.bind(null,e,d);d.then(b,b)}})}function oi(e,a){var c=a.deletions;if(c!==null)for(var d=0;d<c.length;d++){var b=c[d],w=e,q=a,tt=q;t:for(;tt!==null;){switch(tt.tag){case 27:if(Zl(tt.type)){nn=tt.stateNode,ve=!1;break t}break;case 5:nn=tt.stateNode,ve=!1;break t;case 3:case 4:nn=tt.stateNode.containerInfo,ve=!0;break t}tt=tt.return}if(nn===null)throw Error(i(160));Kn(w,q,b),nn=null,ve=!1,w=b.alternate,w!==null&&(w.return=null),b.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)A0(a,e),a=a.sibling}var wi=null;function A0(e,a){var c=e.alternate,d=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:oi(a,e),bi(e),d&4&&(da(3,e,e.return),Fs(3,e),da(5,e,e.return));break;case 1:oi(a,e),bi(e),d&512&&(en||c===null||Li(c,c.return)),d&64&&Zi&&(e=e.updateQueue,e!==null&&(d=e.callbacks,d!==null&&(c=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var b=wi;if(oi(a,e),bi(e),d&512&&(en||c===null||Li(c,c.return)),d&4){var w=c!==null?c.memoizedState:null;if(d=e.memoizedState,c===null)if(d===null)if(e.stateNode===null){t:{d=e.type,c=e.memoizedProps,b=b.ownerDocument||b;e:switch(d){case"title":w=b.getElementsByTagName("title")[0],(!w||w[wa]||w[te]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=b.createElement(d),b.head.insertBefore(w,b.querySelector("head > title"))),Hi(w,d,c),w[te]=e,ri(w),d=w;break t;case"link":var q=kv("link","href",b).get(d+(c.href||""));if(q){for(var tt=0;tt<q.length;tt++)if(w=q[tt],w.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&w.getAttribute("rel")===(c.rel==null?null:c.rel)&&w.getAttribute("title")===(c.title==null?null:c.title)&&w.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){q.splice(tt,1);break e}}w=b.createElement(d),Hi(w,d,c),b.head.appendChild(w);break;case"meta":if(q=kv("meta","content",b).get(d+(c.content||""))){for(tt=0;tt<q.length;tt++)if(w=q[tt],w.getAttribute("content")===(c.content==null?null:""+c.content)&&w.getAttribute("name")===(c.name==null?null:c.name)&&w.getAttribute("property")===(c.property==null?null:c.property)&&w.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&w.getAttribute("charset")===(c.charSet==null?null:c.charSet)){q.splice(tt,1);break e}}w=b.createElement(d),Hi(w,d,c),b.head.appendChild(w);break;default:throw Error(i(468,d))}w[te]=e,ri(w),d=w}e.stateNode=d}else qv(b,e.type,e.stateNode);else e.stateNode=Iv(b,d,e.memoizedProps);else w!==d?(w===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):w.count--,d===null?qv(b,e.type,e.stateNode):Iv(b,d,e.memoizedProps)):d===null&&e.stateNode!==null&&Lr(e,e.memoizedProps,c.memoizedProps)}break;case 27:oi(a,e),bi(e),d&512&&(en||c===null||Li(c,c.return)),c!==null&&d&4&&Lr(e,e.memoizedProps,c.memoizedProps);break;case 5:if(oi(a,e),bi(e),d&512&&(en||c===null||Li(c,c.return)),e.flags&32){b=e.stateNode;try{Xr(b,"")}catch(ie){Qt(e,e.return,ie)}}d&4&&e.stateNode!=null&&(b=e.memoizedProps,Lr(e,b,c!==null?c.memoizedProps:b)),d&1024&&(ps=!0);break;case 6:if(oi(a,e),bi(e),d&4){if(e.stateNode===null)throw Error(i(162));d=e.memoizedProps,c=e.stateNode;try{c.nodeValue=d}catch(ie){Qt(e,e.return,ie)}}break;case 3:if(D0=null,b=wi,wi=N0(a.containerInfo),oi(a,e),wi=b,bi(e),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Xc(a.containerInfo)}catch(ie){Qt(e,e.return,ie)}ps&&(ps=!1,Uh(e));break;case 4:d=wi,wi=N0(e.stateNode.containerInfo),oi(a,e),bi(e),wi=d;break;case 12:oi(a,e),bi(e);break;case 31:oi(a,e),bi(e),d&4&&(d=e.updateQueue,d!==null&&(e.updateQueue=null,el(e,d)));break;case 13:oi(a,e),bi(e),e.child.flags&8192&&e.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Pr=ye()),d&4&&(d=e.updateQueue,d!==null&&(e.updateQueue=null,el(e,d)));break;case 22:b=e.memoizedState!==null;var ot=c!==null&&c.memoizedState!==null,St=Zi,xt=en;if(Zi=St||b,en=xt||ot,oi(a,e),en=xt,Zi=St,bi(e),d&8192)t:for(a=e.stateNode,a._visibility=b?a._visibility&-2:a._visibility|1,b&&(c===null||ot||Zi||en||nl(e)),c=null,a=e;;){if(a.tag===5||a.tag===26){if(c===null){ot=c=a;try{if(w=ot.stateNode,b)q=w.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{tt=ot.stateNode;var jt=ot.memoizedProps.style,Et=jt!=null&&jt.hasOwnProperty("display")?jt.display:null;tt.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(ie){Qt(ot,ot.return,ie)}}}else if(a.tag===6){if(c===null){ot=a;try{ot.stateNode.nodeValue=b?"":ot.memoizedProps}catch(ie){Qt(ot,ot.return,ie)}}}else if(a.tag===18){if(c===null){ot=a;try{var Tt=ot.stateNode;b?jv(Tt,!0):jv(ot.stateNode,!1)}catch(ie){Qt(ot,ot.return,ie)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===e)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break t;for(;a.sibling===null;){if(a.return===null||a.return===e)break t;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}d&4&&(d=e.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,el(e,c))));break;case 19:oi(a,e),bi(e),d&4&&(d=e.updateQueue,d!==null&&(e.updateQueue=null,el(e,d)));break;case 30:break;case 21:break;default:oi(a,e),bi(e)}}function bi(e){var a=e.flags;if(a&2){try{for(var c,d=e.return;d!==null;){if(T0(d)){c=d;break}d=d.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var b=c.stateNode,w=Js(e);Zs(e,w,b);break;case 5:var q=c.stateNode;c.flags&32&&(Xr(q,""),c.flags&=-33);var tt=Js(e);Zs(e,tt,q);break;case 3:case 4:var ot=c.stateNode.containerInfo,St=Js(e);au(e,St,ot);break;default:throw Error(i(161))}}catch(xt){Qt(e,e.return,xt)}e.flags&=-3}a&4096&&(e.flags&=-4097)}function Uh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var a=e;Uh(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),e=e.sibling}}function ur(e,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Ws(e,a.alternate,a),a=a.sibling}function nl(e){for(e=e.child;e!==null;){var a=e;switch(a.tag){case 0:case 11:case 14:case 15:da(4,a,a.return),nl(a);break;case 1:Li(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&zc(a,a.return,c),nl(a);break;case 27:Ph(a.stateNode);case 26:case 5:Li(a,a.return),nl(a);break;case 22:a.memoizedState===null&&nl(a);break;case 30:nl(a);break;default:nl(a)}e=e.sibling}}function Wi(e,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var d=a.alternate,b=e,w=a,q=w.flags;switch(w.tag){case 0:case 11:case 15:Wi(b,w,c),Fs(4,w);break;case 1:if(Wi(b,w,c),d=w,b=d.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(St){Qt(d,d.return,St)}if(d=w,b=d.updateQueue,b!==null){var tt=d.stateNode;try{var ot=b.shared.hiddenCallbacks;if(ot!==null)for(b.shared.hiddenCallbacks=null,b=0;b<ot.length;b++)sh(ot[b],tt)}catch(St){Qt(d,d.return,St)}}c&&q&64&&Yl(w),or(w,w.return);break;case 27:ru(w);case 26:case 5:Wi(b,w,c),c&&d===null&&q&4&&jh(w),or(w,w.return);break;case 12:Wi(b,w,c);break;case 31:Wi(b,w,c),c&&q&4&&lu(b,w);break;case 13:Wi(b,w,c),c&&q&4&&$s(b,w);break;case 22:w.memoizedState===null&&Wi(b,w,c),or(w,w.return);break;case 30:break;default:Wi(b,w,c)}a=a.sibling}}function il(e,a){var c=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),e=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(e=a.memoizedState.cachePool.pool),e!==c&&(e!=null&&e.refCount++,c!=null&&Bl(c))}function ms(e,a){e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&Bl(e))}function Ea(e,a,c,d){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ga(e,a,c,d),a=a.sibling}function ga(e,a,c,d){var b=a.flags;switch(a.tag){case 0:case 11:case 15:Ea(e,a,c,d),b&2048&&Fs(9,a);break;case 1:Ea(e,a,c,d);break;case 3:Ea(e,a,c,d),b&2048&&(e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&Bl(e)));break;case 12:if(b&2048){Ea(e,a,c,d),e=a.stateNode;try{var w=a.memoizedProps,q=w.id,tt=w.onPostCommit;typeof tt=="function"&&tt(q,a.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(ot){Qt(a,a.return,ot)}}else Ea(e,a,c,d);break;case 31:Ea(e,a,c,d);break;case 13:Ea(e,a,c,d);break;case 23:break;case 22:w=a.stateNode,q=a.alternate,a.memoizedState!==null?w._visibility&2?Ea(e,a,c,d):Ln(e,a):w._visibility&2?Ea(e,a,c,d):(w._visibility|=2,Gi(e,a,c,d,(a.subtreeFlags&10256)!==0||!1)),b&2048&&il(q,a);break;case 24:Ea(e,a,c,d),b&2048&&ms(a.alternate,a);break;default:Ea(e,a,c,d)}}function Gi(e,a,c,d,b){for(b=b&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var w=e,q=a,tt=c,ot=d,St=q.flags;switch(q.tag){case 0:case 11:case 15:Gi(w,q,tt,ot,b),Fs(8,q);break;case 23:break;case 22:var xt=q.stateNode;q.memoizedState!==null?xt._visibility&2?Gi(w,q,tt,ot,b):Ln(w,q):(xt._visibility|=2,Gi(w,q,tt,ot,b)),b&&St&2048&&il(q.alternate,q);break;case 24:Gi(w,q,tt,ot,b),b&&St&2048&&ms(q.alternate,q);break;default:Gi(w,q,tt,ot,b)}a=a.sibling}}function Ln(e,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=e,d=a,b=d.flags;switch(d.tag){case 22:Ln(c,d),b&2048&&il(d.alternate,d);break;case 24:Ln(c,d),b&2048&&ms(d.alternate,d);break;default:Ln(c,d)}a=a.sibling}}var al=8192;function rl(e,a,c){if(e.subtreeFlags&al)for(e=e.child;e!==null;)Bh(e,a,c),e=e.sibling}function Bh(e,a,c){switch(e.tag){case 26:rl(e,a,c),e.flags&al&&e.memoizedState!==null&&e4(c,wi,e.memoizedState,e.memoizedProps);break;case 5:rl(e,a,c);break;case 3:case 4:var d=wi;wi=N0(e.stateNode.containerInfo),rl(e,a,c),wi=d;break;case 22:e.memoizedState===null&&(d=e.alternate,d!==null&&d.memoizedState!==null?(d=al,al=16777216,rl(e,a,c),al=d):rl(e,a,c));break;default:rl(e,a,c)}}function ai(e){var a=e.alternate;if(a!==null&&(e=a.child,e!==null)){a.child=null;do a=e.sibling,e.sibling=null,e=a;while(e!==null)}}function sl(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];An=d,Gc(d,e)}ai(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)cr(e),e=e.sibling}function cr(e){switch(e.tag){case 0:case 11:case 15:sl(e),e.flags&2048&&da(9,e,e.return);break;case 3:sl(e);break;case 12:sl(e);break;case 22:var a=e.stateNode;e.memoizedState!==null&&a._visibility&2&&(e.return===null||e.return.tag!==13)?(a._visibility&=-3,Nn(e)):sl(e);break;default:sl(e)}}function Nn(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];An=d,Gc(d,e)}ai(e)}for(e=e.child;e!==null;){switch(a=e,a.tag){case 0:case 11:case 15:da(8,a,a.return),Nn(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,Nn(a));break;default:Nn(a)}e=e.sibling}}function Gc(e,a){for(;An!==null;){var c=An;switch(c.tag){case 0:case 11:case 15:da(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Bl(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,An=d;else t:for(c=e;An!==null;){d=An;var b=d.sibling,w=d.return;if(su(d),d===c){An=null;break t}if(b!==null){b.return=w,An=b;break t}An=w}}}var w0={getCacheForType:function(e){var a=Tn(Zn),c=a.data.get(e);return c===void 0&&(c=e(),a.data.set(e,c)),c},cacheSignal:function(){return Tn(Zn).controller.signal}},ui=typeof WeakMap=="function"?WeakMap:Map,Se=0,ze=null,Ae=null,De=0,cn=0,Ri=null,Pa=!1,Gr=!1,Kl=!1,Ca=0,bn=0,vs=0,Ue=0,dn=0,Ee=0,Le=0,Ke=null,_n=null,fr=!1,Pr=0,Pc=0,Ta=1/0,wn=null,Pi=null,Rn=0,hr=null,_i=null,$i=0,ll=0,Oi=null,Hc=null,ol=0,ul=null;function xi(){return(Se&2)!==0&&De!==0?De&-De:D.T!==null?Kg():xn()}function Hr(){if(Ee===0)if((De&536870912)===0||Ie){var e=Be;Be<<=1,(Be&3932160)===0&&(Be=262144),Ee=e}else Ee=536870912;return e=Mn.current,e!==null&&(e.flags|=32),Ee}function rn(e,a,c){(e===ze&&(cn===2||cn===9)||e.cancelPendingCommit!==null)&&(gr(e,0),dr(e,De,Ee,!1)),Aa(e,c),((Se&2)===0||e!==ze)&&(e===ze&&((Se&2)===0&&(Ue|=c),bn===4&&dr(e,De,Ee,!1)),bs(e))}function Ir(e,a,c){if((Se&6)!==0)throw Error(i(327));var d=!c&&(a&127)===0&&(a&e.expiredLanes)===0||Ii(e,a),b=d?et(e,a):x(e,a,!0),w=d;do{if(b===0){Gr&&!d&&dr(e,a,0,!1);break}else{if(c=e.current.alternate,w&&!Ql(c)){b=x(e,a,!1),w=!1;continue}if(b===2){if(w=a,e.errorRecoveryDisabledLanes&w)var q=0;else q=e.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){a=q;t:{var tt=e;b=Ke;var ot=tt.current.memoizedState.isDehydrated;if(ot&&(gr(tt,q).flags|=256),q=x(tt,q,!1),q!==2){if(Kl&&!ot){tt.errorRecoveryDisabledLanes|=w,Ue|=w,b=4;break t}w=_n,_n=b,w!==null&&(_n===null?_n=w:_n.push.apply(_n,w))}b=q}if(w=!1,b!==2)continue}}if(b===1){gr(e,0),dr(e,a,0,!0);break}t:{switch(d=e,w=b,w){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:dr(d,a,Ee,!Pa);break t;case 2:_n=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(b=Pr+300-ye(),10<b)){if(dr(d,a,Ee,!Pa),na(d,0,!0)!==0)break t;$i=a,d.timeoutHandle=xv(cl.bind(null,d,c,_n,wn,fr,a,Ee,Ue,Le,Pa,w,"Throttled",-0,0),b);break t}cl(d,c,_n,wn,fr,a,Ee,Ue,Le,Pa,w,null,-0,0)}}break}while(!0);bs(e)}function cl(e,a,c,d,b,w,q,tt,ot,St,xt,jt,Et,Tt){if(e.timeoutHandle=-1,jt=a.subtreeFlags,jt&8192||(jt&16785408)===16785408){jt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vi},Bh(a,w,jt);var ie=(w&62914560)===w?Pr-ye():(w&4194048)===w?Pc-ye():0;if(ie=n4(jt,ie),ie!==null){$i=w,e.cancelPendingCommit=ie(xe.bind(null,e,a,w,c,d,b,q,tt,ot,xt,jt,null,Et,Tt)),dr(e,w,q,!St);return}}xe(e,a,w,c,d,b,q,tt,ot)}function Ql(e){for(var a=e;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var b=c[d],w=b.getSnapshot;b=b.value;try{if(!di(w(),b))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function dr(e,a,c,d){a&=~dn,a&=~Ue,e.suspendedLanes|=a,e.pingedLanes&=~a,d&&(e.warmLanes|=a),d=e.expirationTimes;for(var b=a;0<b;){var w=31-ue(b),q=1<<w;d[w]=-1,b&=~q}c!==0&&Bt(e,c,a)}function Xl(){return(Se&6)===0?(zh(0),!1):!0}function Ic(){if(Ae!==null){if(cn===0)var e=Ae.return;else e=Ae,Ba=qe=null,ch(e),ss=null,Yo=0,e=Ae;for(;e!==null;)iu(e.alternate,e),e=e.return;Ae=null}}function gr(e,a){var c=e.timeoutHandle;c!==-1&&(e.timeoutHandle=-1,Gb(c)),c=e.cancelPendingCommit,c!==null&&(e.cancelPendingCommit=null,c()),$i=0,Ic(),ze=e,Ae=c=Na(e.current,null),De=a,cn=0,Ri=null,Pa=!1,Gr=Ii(e,a),Kl=!1,Le=Ee=dn=Ue=vs=bn=0,_n=Ke=null,fr=!1,(a&8)!==0&&(a|=a&32);var d=e.entangledLanes;if(d!==0)for(e=e.entanglements,d&=a;0<d;){var b=31-ue(d),w=1<<b;a|=e[b],d&=~w}return Ca=a,Lo(),c}function kc(e,a){Oe=null,D.H=Il,a===Ls||a===dc?(a=pc(),cn=3):a===qo?(a=pc(),cn=4):cn=a===Rh?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ri=a,Ae===null&&(bn=1,Nc(e,sa(a,e.current)))}function s(){var e=Mn.current;return e===null?!0:(De&4194048)===De?ba===null:(De&62914560)===De||(De&536870912)!==0?e===ba:!1}function u(){var e=D.H;return D.H=Il,e===null?Il:e}function p(){var e=D.A;return D.A=w0,e}function S(){bn=4,Pa||(De&4194048)!==De&&Mn.current!==null||(Gr=!0),(vs&134217727)===0&&(Ue&134217727)===0||ze===null||dr(ze,De,Ee,!1)}function x(e,a,c){var d=Se;Se|=2;var b=u(),w=p();(ze!==e||De!==a)&&(wn=null,gr(e,a)),a=!1;var q=bn;t:do try{if(cn!==0&&Ae!==null){var tt=Ae,ot=Ri;switch(cn){case 8:Ic(),q=6;break t;case 3:case 2:case 9:case 6:Mn.current===null&&(a=!0);var St=cn;if(cn=0,Ri=null,Pt(e,tt,ot,St),c&&Gr){q=0;break t}break;default:St=cn,cn=0,Ri=null,Pt(e,tt,ot,St)}}H(),q=bn;break}catch(xt){kc(e,xt)}while(!0);return a&&e.shellSuspendCounter++,Ba=qe=null,Se=d,D.H=b,D.A=w,Ae===null&&(ze=null,De=0,Lo()),q}function H(){for(;Ae!==null;)_t(Ae)}function et(e,a){var c=Se;Se|=2;var d=u(),b=p();ze!==e||De!==a?(wn=null,Ta=ye()+500,gr(e,a)):Gr=Ii(e,a);t:do try{if(cn!==0&&Ae!==null){a=Ae;var w=Ri;e:switch(cn){case 1:cn=0,Ri=null,Pt(e,a,w,1);break;case 2:case 9:if(Or(w)){cn=0,Ri=null,zt(a);break}a=function(){cn!==2&&cn!==9||ze!==e||(cn=7),bs(e)},w.then(a,a);break t;case 3:cn=7;break t;case 4:cn=5;break t;case 7:Or(w)?(cn=0,Ri=null,zt(a)):(cn=0,Ri=null,Pt(e,a,w,7));break;case 5:var q=null;switch(Ae.tag){case 26:q=Ae.memoizedState;case 5:case 27:var tt=Ae;if(q?Vv(q):tt.stateNode.complete){cn=0,Ri=null;var ot=tt.sibling;if(ot!==null)Ae=ot;else{var St=tt.return;St!==null?(Ae=St,Jt(St)):Ae=null}break e}}cn=0,Ri=null,Pt(e,a,w,5);break;case 6:cn=0,Ri=null,Pt(e,a,w,6);break;case 8:Ic(),bn=6;break t;default:throw Error(i(462))}}ut();break}catch(xt){kc(e,xt)}while(!0);return Ba=qe=null,D.H=d,D.A=b,Se=c,Ae!==null?0:(ze=null,De=0,Lo(),bn)}function ut(){for(;Ae!==null&&!Kt();)_t(Ae)}function _t(e){var a=gs(e.alternate,e,Ca);e.memoizedProps=e.pendingProps,a===null?Jt(e):Ae=a}function zt(e){var a=e,c=a.alternate;switch(a.tag){case 15:case 0:a=ha(c,a,a.pendingProps,a.type,void 0,De);break;case 11:a=ha(c,a,a.pendingProps,a.type.render,a.ref,De);break;case 5:ch(a);default:iu(c,a),a=Ae=ac(a,Ca),a=gs(c,a,Ca)}e.memoizedProps=e.pendingProps,a===null?Jt(e):Ae=a}function Pt(e,a,c,d){Ba=qe=null,ch(a),ss=null,Yo=0;var b=a.return;try{if(wh(e,b,a,c,De)){bn=1,Nc(e,sa(c,e.current)),Ae=null;return}}catch(w){if(b!==null)throw Ae=b,w;bn=1,Nc(e,sa(c,e.current)),Ae=null;return}a.flags&32768?(Ie||d===1?e=!0:Gr||(De&536870912)!==0?e=!1:(Pa=e=!0,(d===2||d===9||d===3||d===6)&&(d=Mn.current,d!==null&&d.tag===13&&(d.flags|=16384))),ee(a,e)):Jt(a)}function Jt(e){var a=e;do{if((a.flags&32768)!==0){ee(a,Pa);return}e=a.return;var c=Vl(a.alternate,a,Ca);if(c!==null){Ae=c;return}if(a=a.sibling,a!==null){Ae=a;return}Ae=a=e}while(a!==null);bn===0&&(bn=5)}function ee(e,a){do{var c=Nh(e.alternate,e);if(c!==null){c.flags&=32767,Ae=c;return}if(c=e.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(e=e.sibling,e!==null)){Ae=e;return}Ae=e=c}while(e!==null);bn=6,Ae=null}function xe(e,a,c,d,b,w,q,tt,ot){e.cancelPendingCommit=null;do gt();while(Rn!==0);if((Se&6)!==0)throw Error(i(327));if(a!==null){if(a===e.current)throw Error(i(177));if(w=a.lanes|a.childLanes,w|=Sa,Dt(e,c,w,q,tt,ot),e===ze&&(Ae=ze=null,De=0),_i=a,hr=e,$i=c,ll=w,Oi=b,Hc=d,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ss(ct,function(){return Ct(),null})):(e.callbackNode=null,e.callbackPriority=0),d=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||d){d=D.T,D.T=null,b=I.p,I.p=2,q=Se,Se|=4;try{Dh(e,a,c)}finally{Se=q,I.p=b,D.T=d}}Rn=1,pa(),Fl(),ys()}}function pa(){if(Rn===1){Rn=0;var e=hr,a=_i,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=D.T,D.T=null;var d=I.p;I.p=2;var b=Se;Se|=4;try{A0(a,e);var w=tp,q=xa(e.containerInfo),tt=w.focusedElem,ot=w.selectionRange;if(q!==tt&&tt&&tt.ownerDocument&&Rl(tt.ownerDocument.documentElement,tt)){if(ot!==null&&tc(tt)){var St=ot.start,xt=ot.end;if(xt===void 0&&(xt=St),"selectionStart"in tt)tt.selectionStart=St,tt.selectionEnd=Math.min(xt,tt.value.length);else{var jt=tt.ownerDocument||document,Et=jt&&jt.defaultView||window;if(Et.getSelection){var Tt=Et.getSelection(),ie=tt.textContent.length,Ce=Math.min(ot.start,ie),Cn=ot.end===void 0?Ce:Math.min(ot.end,ie);!Tt.extend&&Ce>Cn&&(q=Cn,Cn=Ce,Ce=q);var pt=qf(tt,Ce),ft=qf(tt,Cn);if(pt&&ft&&(Tt.rangeCount!==1||Tt.anchorNode!==pt.node||Tt.anchorOffset!==pt.offset||Tt.focusNode!==ft.node||Tt.focusOffset!==ft.offset)){var yt=jt.createRange();yt.setStart(pt.node,pt.offset),Tt.removeAllRanges(),Ce>Cn?(Tt.addRange(yt),Tt.extend(ft.node,ft.offset)):(yt.setEnd(ft.node,ft.offset),Tt.addRange(yt))}}}}for(jt=[],Tt=tt;Tt=Tt.parentNode;)Tt.nodeType===1&&jt.push({element:Tt,left:Tt.scrollLeft,top:Tt.scrollTop});for(typeof tt.focus=="function"&&tt.focus(),tt=0;tt<jt.length;tt++){var Nt=jt[tt];Nt.element.scrollLeft=Nt.left,Nt.element.scrollTop=Nt.top}}L0=!!$g,tp=$g=null}finally{Se=b,I.p=d,D.T=c}}e.current=a,Rn=2}}function Fl(){if(Rn===2){Rn=0;var e=hr,a=_i,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=D.T,D.T=null;var d=I.p;I.p=2;var b=Se;Se|=4;try{Ws(e,a.alternate,a)}finally{Se=b,I.p=d,D.T=c}}Rn=3}}function ys(){if(Rn===4||Rn===3){Rn=0,je();var e=hr,a=_i,c=$i,d=Hc;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Rn=5:(Rn=0,_i=hr=null,bt(e,e.pendingLanes));var b=e.pendingLanes;if(b===0&&(Pi=null),pn(c),a=a.stateNode,vt&&typeof vt.onCommitFiberRoot=="function")try{vt.onCommitFiberRoot(ht,a,void 0,(a.current.flags&128)===128)}catch{}if(d!==null){a=D.T,b=I.p,I.p=2,D.T=null;try{for(var w=e.onRecoverableError,q=0;q<d.length;q++){var tt=d[q];w(tt.value,{componentStack:tt.stack})}}finally{D.T=a,I.p=b}}($i&3)!==0&&gt(),bs(e),b=e.pendingLanes,(c&261930)!==0&&(b&42)!==0?e===ul?ol++:(ol=0,ul=e):ol=0,zh(0)}}function bt(e,a){(e.pooledCacheLanes&=a)===0&&(a=e.pooledCache,a!=null&&(e.pooledCache=null,Bl(a)))}function gt(){return pa(),Fl(),ys(),Ct()}function Ct(){if(Rn!==5)return!1;var e=hr,a=ll;ll=0;var c=pn($i),d=D.T,b=I.p;try{I.p=32>c?32:c,D.T=null,c=Oi,Oi=null;var w=hr,q=$i;if(Rn=0,_i=hr=null,$i=0,(Se&6)!==0)throw Error(i(331));var tt=Se;if(Se|=4,cr(w.current),ga(w,w.current,q,c),Se=tt,zh(0,!1),vt&&typeof vt.onPostCommitFiberRoot=="function")try{vt.onPostCommitFiberRoot(ht,w)}catch{}return!0}finally{I.p=b,D.T=d,bt(e,a)}}function Ht(e,a,c){a=sa(c,a),a=fa(e.stateNode,a,2),e=os(e,a,2),e!==null&&(Aa(e,2),bs(e))}function Qt(e,a,c){if(e.tag===3)Ht(e,e,c);else for(;a!==null;){if(a.tag===3){Ht(a,e,c);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Pi===null||!Pi.has(d))){e=sa(c,e),c=Ah(2),d=os(a,c,2),d!==null&&(E0(c,d,a,e),Aa(d,2),bs(d));break}}a=a.return}}function vn(e,a,c){var d=e.pingCache;if(d===null){d=e.pingCache=new ui;var b=new Set;d.set(a,b)}else b=d.get(a),b===void 0&&(b=new Set,d.set(a,b));b.has(c)||(Kl=!0,b.add(c),e=Te.bind(null,e,a,c),a.then(e,e))}function Te(e,a,c){var d=e.pingCache;d!==null&&d.delete(a),e.pingedLanes|=e.suspendedLanes&c,e.warmLanes&=~c,ze===e&&(De&c)===c&&(bn===4||bn===3&&(De&62914560)===De&&300>ye()-Pr?(Se&2)===0&&gr(e,0):dn|=c,Le===De&&(Le=0)),bs(e)}function Qe(e,a){a===0&&(a=So()),e=ra(e,a),e!==null&&(Aa(e,a),bs(e))}function ci(e){var a=e.memoizedState,c=0;a!==null&&(c=a.retryLane),Qe(e,c)}function Je(e,a){var c=0;switch(e.tag){case 31:case 13:var d=e.stateNode,b=e.memoizedState;b!==null&&(c=b.retryLane);break;case 19:d=e.stateNode;break;case 22:d=e.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(a),Qe(e,c)}function Ss(e,a){return Pn(e,a)}var qc=null,Vc=null,Vg=!1,R0=!1,Yg=!1,Jl=0;function bs(e){e!==Vc&&e.next===null&&(Vc===null?qc=Vc=e:Vc=Vc.next=e),R0=!0,Vg||(Vg=!0,Rb())}function zh(e,a){if(!Yg&&R0){Yg=!0;do for(var c=!1,d=qc;d!==null;){if(e!==0){var b=d.pendingLanes;if(b===0)var w=0;else{var q=d.suspendedLanes,tt=d.pingedLanes;w=(1<<31-ue(42|e)+1)-1,w&=b&~(q&~tt),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(c=!0,yv(d,w))}else w=De,w=na(d,d===ze?w:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(w&3)===0||Ii(d,w)||(c=!0,yv(d,w));d=d.next}while(c);Yg=!1}}function wb(){pv()}function pv(){R0=Vg=!1;var e=0;Jl!==0&&Lb()&&(e=Jl);for(var a=ye(),c=null,d=qc;d!==null;){var b=d.next,w=mv(d,a);w===0?(d.next=null,c===null?qc=b:c.next=b,b===null&&(Vc=c)):(c=d,(e!==0||(w&3)!==0)&&(R0=!0)),d=b}Rn!==0&&Rn!==5||zh(e),Jl!==0&&(Jl=0)}function mv(e,a){for(var c=e.suspendedLanes,d=e.pingedLanes,b=e.expirationTimes,w=e.pendingLanes&-62914561;0<w;){var q=31-ue(w),tt=1<<q,ot=b[q];ot===-1?((tt&c)===0||(tt&d)!==0)&&(b[q]=yl(tt,a)):ot<=a&&(e.expiredLanes|=tt),w&=~tt}if(a=ze,c=De,c=na(e,e===a?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),d=e.callbackNode,c===0||e===a&&(cn===2||cn===9)||e.cancelPendingCommit!==null)return d!==null&&d!==null&&Ot(d),e.callbackNode=null,e.callbackPriority=0;if((c&3)===0||Ii(e,c)){if(a=c&-c,a===e.callbackPriority)return a;switch(d!==null&&Ot(d),pn(c)){case 2:case 8:c=ge;break;case 32:c=ct;break;case 268435456:c=Mt;break;default:c=ct}return d=vv.bind(null,e),c=Pn(c,d),e.callbackPriority=a,e.callbackNode=c,a}return d!==null&&d!==null&&Ot(d),e.callbackPriority=2,e.callbackNode=null,2}function vv(e,a){if(Rn!==0&&Rn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var c=e.callbackNode;if(gt()&&e.callbackNode!==c)return null;var d=De;return d=na(e,e===ze?d:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),d===0?null:(Ir(e,d,a),mv(e,ye()),e.callbackNode!=null&&e.callbackNode===c?vv.bind(null,e):null)}function yv(e,a){if(gt())return null;Ir(e,a,!0)}function Rb(){Pb(function(){(Se&6)!==0?Pn(an,wb):pv()})}function Kg(){if(Jl===0){var e=Us;e===0&&(e=fe,fe<<=1,(fe&261888)===0&&(fe=256)),Jl=e}return Jl}function Sv(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Eo(""+e)}function bv(e,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,e.id&&c.setAttribute("form",e.id),a.parentNode.insertBefore(c,a),e=new FormData(e),c.parentNode.removeChild(c),e}function Ob(e,a,c,d,b){if(a==="submit"&&c&&c.stateNode===b){var w=Sv((b[re]||null).action),q=d.submitter;q&&(a=(a=q[re]||null)?Sv(a.formAction):q.getAttribute("formAction"),a!==null&&(w=a,q=null));var tt=new Iu("action","action",null,d,b);e.push({event:tt,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Jl!==0){var ot=q?bv(b,q):new FormData(b);Oc(c,{pending:!0,data:ot,method:b.method,action:w},null,ot)}}else typeof w=="function"&&(tt.preventDefault(),ot=q?bv(b,q):new FormData(b),Oc(c,{pending:!0,data:ot,method:b.method,action:w},w,ot))},currentTarget:b}]})}}for(var Qg=0;Qg<Fa.length;Qg++){var Xg=Fa[Qg],xb=Xg.toLowerCase(),Mb=Xg[0].toUpperCase()+Xg.slice(1);pi(xb,"on"+Mb)}pi(nc,"onAnimationEnd"),pi(Qf,"onAnimationIteration"),pi(Hd,"onAnimationStart"),pi("dblclick","onDoubleClick"),pi("focusin","onFocus"),pi("focusout","onBlur"),pi(Xf,"onTransitionRun"),pi(Ni,"onTransitionStart"),pi(Id,"onTransitionCancel"),pi(ji,"onTransitionEnd"),ni("onMouseEnter",["mouseout","mouseover"]),ni("onMouseLeave",["mouseout","mouseover"]),ni("onPointerEnter",["pointerout","pointerover"]),ni("onPointerLeave",["pointerout","pointerover"]),Sr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Sr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Sr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Sr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Sr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Sr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lh));function _v(e,a){a=(a&4)!==0;for(var c=0;c<e.length;c++){var d=e[c],b=d.event;d=d.listeners;t:{var w=void 0;if(a)for(var q=d.length-1;0<=q;q--){var tt=d[q],ot=tt.instance,St=tt.currentTarget;if(tt=tt.listener,ot!==w&&b.isPropagationStopped())break t;w=tt,b.currentTarget=St;try{w(b)}catch(xt){Ma(xt)}b.currentTarget=null,w=ot}else for(q=0;q<d.length;q++){if(tt=d[q],ot=tt.instance,St=tt.currentTarget,tt=tt.listener,ot!==w&&b.isPropagationStopped())break t;w=tt,b.currentTarget=St;try{w(b)}catch(xt){Ma(xt)}b.currentTarget=null,w=ot}}}}function Ve(e,a){var c=a[Re];c===void 0&&(c=a[Re]=new Set);var d=e+"__bubble";c.has(d)||(Ev(a,e,2,!1),c.add(d))}function Fg(e,a,c){var d=0;a&&(d|=4),Ev(c,e,d,a)}var O0="_reactListening"+Math.random().toString(36).slice(2);function Jg(e){if(!e[O0]){e[O0]=!0,xu.forEach(function(c){c!=="selectionchange"&&(Nb.has(c)||Fg(c,!1,e),Fg(c,!0,e))});var a=e.nodeType===9?e:e.ownerDocument;a===null||a[O0]||(a[O0]=!0,Fg("selectionchange",!1,a))}}function Ev(e,a,c,d){switch(Zv(a)){case 2:var b=r4;break;case 8:b=s4;break;default:b=fp}c=b.bind(null,a,c,e),b=void 0,!Gu||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(b=!0),d?b!==void 0?e.addEventListener(a,c,{capture:!0,passive:b}):e.addEventListener(a,c,!0):b!==void 0?e.addEventListener(a,c,{passive:b}):e.addEventListener(a,c,!1)}function Zg(e,a,c,d,b){var w=d;if((a&1)===0&&(a&2)===0&&d!==null)t:for(;;){if(d===null)return;var q=d.tag;if(q===3||q===4){var tt=d.stateNode.containerInfo;if(tt===b)break;if(q===4)for(q=d.return;q!==null;){var ot=q.tag;if((ot===3||ot===4)&&q.stateNode.containerInfo===b)return;q=q.return}for(;tt!==null;){if(q=Ra(tt),q===null)return;if(ot=q.tag,ot===5||ot===6||ot===26||ot===27){d=w=q;continue t}tt=tt.parentNode}}d=d.return}Nf(function(){var St=w,xt=zu(c),jt=[];t:{var Et=Ff.get(e);if(Et!==void 0){var Tt=Iu,ie=e;switch(e){case"keypress":if(Co(c)===0)break t;case"keydown":case"keyup":Tt=Bf;break;case"focusin":ie="focus",Tt=Vu;break;case"focusout":ie="blur",Tt=Vu;break;case"beforeblur":case"afterblur":Tt=Vu;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Tt=Df;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Tt=Oo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Tt=hi;break;case nc:case Qf:case Hd:Tt=Zr;break;case ji:Tt=jd;break;case"scroll":case"scrollend":Tt=Td;break;case"wheel":Tt=Ud;break;case"copy":case"cut":case"paste":Tt=Wr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Tt=zf;break;case"toggle":case"beforetoggle":Tt=Yu}var Ce=(a&4)!==0,Cn=!Ce&&(e==="scroll"||e==="scrollend"),pt=Ce?Et!==null?Et+"Capture":null:Et;Ce=[];for(var ft=St,yt;ft!==null;){var Nt=ft;if(yt=Nt.stateNode,Nt=Nt.tag,Nt!==5&&Nt!==26&&Nt!==27||yt===null||pt===null||(Nt=El(ft,pt),Nt!=null&&Ce.push(Gh(ft,Nt,yt))),Cn)break;ft=ft.return}0<Ce.length&&(Et=new Tt(Et,ie,null,c,xt),jt.push({event:Et,listeners:Ce}))}}if((a&7)===0){t:{if(Et=e==="mouseover"||e==="pointerover",Tt=e==="mouseout"||e==="pointerout",Et&&c!==_l&&(ie=c.relatedTarget||c.fromElement)&&(Ra(ie)||ie[oe]))break t;if((Tt||Et)&&(Et=xt.window===xt?xt:(Et=xt.ownerDocument)?Et.defaultView||Et.parentWindow:window,Tt?(ie=c.relatedTarget||c.toElement,Tt=St,ie=ie?Ra(ie):null,ie!==null&&(Cn=o(ie),Ce=ie.tag,ie!==Cn||Ce!==5&&Ce!==27&&Ce!==6)&&(ie=null)):(Tt=null,ie=St),Tt!==ie)){if(Ce=Df,Nt="onMouseLeave",pt="onMouseEnter",ft="mouse",(e==="pointerout"||e==="pointerover")&&(Ce=zf,Nt="onPointerLeave",pt="onPointerEnter",ft="pointer"),Cn=Tt==null?Et:yr(Tt),yt=ie==null?Et:yr(ie),Et=new Ce(Nt,ft+"leave",Tt,c,xt),Et.target=Cn,Et.relatedTarget=yt,Nt=null,Ra(xt)===St&&(Ce=new Ce(pt,ft+"enter",ie,c,xt),Ce.target=yt,Ce.relatedTarget=Cn,Nt=Ce),Cn=Nt,Tt&&ie)e:{for(Ce=jb,pt=Tt,ft=ie,yt=0,Nt=pt;Nt;Nt=Ce(Nt))yt++;Nt=0;for(var de=ft;de;de=Ce(de))Nt++;for(;0<yt-Nt;)pt=Ce(pt),yt--;for(;0<Nt-yt;)ft=Ce(ft),Nt--;for(;yt--;){if(pt===ft||ft!==null&&pt===ft.alternate){Ce=pt;break e}pt=Ce(pt),ft=Ce(ft)}Ce=null}else Ce=null;Tt!==null&&Cv(jt,Et,Tt,Ce,!1),ie!==null&&Cn!==null&&Cv(jt,Cn,ie,Ce,!0)}}t:{if(Et=St?yr(St):window,Tt=Et.nodeName&&Et.nodeName.toLowerCase(),Tt==="select"||Tt==="input"&&Et.type==="file")var sn=Zu;else if(Xa(Et))if(Hf)sn=Lg;else{sn=zn;var se=Bo}else Tt=Et.nodeName,!Tt||Tt.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?St&&Bu(St.elementType)&&(sn=Zu):sn=zg;if(sn&&(sn=sn(e,St))){Ju(jt,sn,c,xt);break t}se&&se(e,Et,St),e==="focusout"&&St&&Et.type==="number"&&St.memoizedProps.value!=null&&Af(Et,"number",Et.value)}switch(se=St?yr(St):window,e){case"focusin":(Xa(se)||se.contentEditable==="true")&&(Rs=se,zo=St,Os=null);break;case"focusout":Os=zo=Rs=null;break;case"mousedown":Ol=!0;break;case"contextmenu":case"mouseup":case"dragend":Ol=!1,Yf(jt,c,xt);break;case"selectionchange":if(Vf)break;case"keydown":case"keyup":Yf(jt,c,xt)}var Ge;if(Ku)t:{switch(e){case"compositionstart":var Ye="onCompositionStart";break t;case"compositionend":Ye="onCompositionEnd";break t;case"compositionupdate":Ye="onCompositionUpdate";break t}Ye=void 0}else $r?Fu(e,c)&&(Ye="onCompositionEnd"):e==="keydown"&&c.keyCode===229&&(Ye="onCompositionStart");Ye&&(Qu&&c.locale!=="ko"&&($r||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&$r&&(Ge=jf()):(_r=xt,Pu="value"in _r?_r.value:_r.textContent,$r=!0)),se=x0(St,Ye),0<se.length&&(Ye=new xo(Ye,e,null,c,xt),jt.push({event:Ye,listeners:se}),Ge?Ye.data=Ge:(Ge=Mo(c),Ge!==null&&(Ye.data=Ge)))),(Ge=zd?Ld(e,c):Pf(e,c))&&(Ye=x0(St,"onBeforeInput"),0<Ye.length&&(se=new xo("onBeforeInput","beforeinput",null,c,xt),jt.push({event:se,listeners:Ye}),se.data=Ge)),Ob(jt,e,St,c,xt)}_v(jt,a)})}function Gh(e,a,c){return{instance:e,listener:a,currentTarget:c}}function x0(e,a){for(var c=a+"Capture",d=[];e!==null;){var b=e,w=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||w===null||(b=El(e,c),b!=null&&d.unshift(Gh(e,b,w)),b=El(e,a),b!=null&&d.push(Gh(e,b,w))),e.tag===3)return d;e=e.return}return[]}function jb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Cv(e,a,c,d,b){for(var w=a._reactName,q=[];c!==null&&c!==d;){var tt=c,ot=tt.alternate,St=tt.stateNode;if(tt=tt.tag,ot!==null&&ot===d)break;tt!==5&&tt!==26&&tt!==27||St===null||(ot=St,b?(St=El(c,w),St!=null&&q.unshift(Gh(c,St,ot))):b||(St=El(c,w),St!=null&&q.push(Gh(c,St,ot)))),c=c.return}q.length!==0&&e.push({event:a,listeners:q})}var Db=/\r\n?/g,Ub=/\u0000|\uFFFD/g;function Tv(e){return(typeof e=="string"?e:""+e).replace(Db,`
`).replace(Ub,"")}function Av(e,a){return a=Tv(a),Tv(e)===a}function En(e,a,c,d,b,w){switch(c){case"children":typeof d=="string"?a==="body"||a==="textarea"&&d===""||Xr(e,d):(typeof d=="number"||typeof d=="bigint")&&a!=="body"&&Xr(e,""+d);break;case"className":ma(e,"class",d);break;case"tabIndex":ma(e,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ma(e,c,d);break;case"style":xf(e,d,w);break;case"data":if(a!=="object"){ma(e,"data",d);break}case"src":case"href":if(d===""&&(a!=="a"||c!=="href")){e.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){e.removeAttribute(c);break}d=Eo(""+d),e.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){e.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(c==="formAction"?(a!=="input"&&En(e,a,"name",b.name,b,null),En(e,a,"formEncType",b.formEncType,b,null),En(e,a,"formMethod",b.formMethod,b,null),En(e,a,"formTarget",b.formTarget,b,null)):(En(e,a,"encType",b.encType,b,null),En(e,a,"method",b.method,b,null),En(e,a,"target",b.target,b,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){e.removeAttribute(c);break}d=Eo(""+d),e.setAttribute(c,d);break;case"onClick":d!=null&&(e.onclick=Vi);break;case"onScroll":d!=null&&Ve("scroll",e);break;case"onScrollEnd":d!=null&&Ve("scrollend",e);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(c=d.__html,c!=null){if(b.children!=null)throw Error(i(60));e.innerHTML=c}}break;case"multiple":e.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":e.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){e.removeAttribute("xlink:href");break}c=Eo(""+d),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?e.setAttribute(c,""+d):e.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?e.setAttribute(c,""):e.removeAttribute(c);break;case"capture":case"download":d===!0?e.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?e.setAttribute(c,d):e.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?e.setAttribute(c,d):e.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?e.removeAttribute(c):e.setAttribute(c,d);break;case"popover":Ve("beforetoggle",e),Ve("toggle",e),bl(e,"popover",d);break;case"xlinkActuate":va(e,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":va(e,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":va(e,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":va(e,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":va(e,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":va(e,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":va(e,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":va(e,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":va(e,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":bl(e,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Cd.get(c)||c,bl(e,c,d))}}function Wg(e,a,c,d,b,w){switch(c){case"style":xf(e,d,w);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(c=d.__html,c!=null){if(b.children!=null)throw Error(i(60));e.innerHTML=c}}break;case"children":typeof d=="string"?Xr(e,d):(typeof d=="number"||typeof d=="bigint")&&Xr(e,""+d);break;case"onScroll":d!=null&&Ve("scroll",e);break;case"onScrollEnd":d!=null&&Ve("scrollend",e);break;case"onClick":d!=null&&(e.onclick=Vi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mu.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(b=c.endsWith("Capture"),a=c.slice(2,b?c.length-7:void 0),w=e[re]||null,w=w!=null?w[c]:null,typeof w=="function"&&e.removeEventListener(a,w,b),typeof d=="function")){typeof w!="function"&&w!==null&&(c in e?e[c]=null:e.hasAttribute(c)&&e.removeAttribute(c)),e.addEventListener(a,d,b);break t}c in e?e[c]=d:d===!0?e.setAttribute(c,""):bl(e,c,d)}}}function Hi(e,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ve("error",e),Ve("load",e);var d=!1,b=!1,w;for(w in c)if(c.hasOwnProperty(w)){var q=c[w];if(q!=null)switch(w){case"src":d=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:En(e,a,w,q,c,null)}}b&&En(e,a,"srcSet",c.srcSet,c,null),d&&En(e,a,"src",c.src,c,null);return;case"input":Ve("invalid",e);var tt=w=q=b=null,ot=null,St=null;for(d in c)if(c.hasOwnProperty(d)){var xt=c[d];if(xt!=null)switch(d){case"name":b=xt;break;case"type":q=xt;break;case"checked":ot=xt;break;case"defaultChecked":St=xt;break;case"value":w=xt;break;case"defaultValue":tt=xt;break;case"children":case"dangerouslySetInnerHTML":if(xt!=null)throw Error(i(137,a));break;default:En(e,a,d,xt,c,null)}}Tf(e,w,tt,ot,St,q,b,!1);return;case"select":Ve("invalid",e),d=q=w=null;for(b in c)if(c.hasOwnProperty(b)&&(tt=c[b],tt!=null))switch(b){case"value":w=tt;break;case"defaultValue":q=tt;break;case"multiple":d=tt;default:En(e,a,b,tt,c,null)}a=w,c=q,e.multiple=!!d,a!=null?Cs(e,!!d,a,!1):c!=null&&Cs(e,!!d,c,!0);return;case"textarea":Ve("invalid",e),w=b=d=null;for(q in c)if(c.hasOwnProperty(q)&&(tt=c[q],tt!=null))switch(q){case"value":d=tt;break;case"defaultValue":b=tt;break;case"children":w=tt;break;case"dangerouslySetInnerHTML":if(tt!=null)throw Error(i(91));break;default:En(e,a,q,tt,c,null)}Rf(e,d,b,w);return;case"option":for(ot in c)if(c.hasOwnProperty(ot)&&(d=c[ot],d!=null))switch(ot){case"selected":e.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:En(e,a,ot,d,c,null)}return;case"dialog":Ve("beforetoggle",e),Ve("toggle",e),Ve("cancel",e),Ve("close",e);break;case"iframe":case"object":Ve("load",e);break;case"video":case"audio":for(d=0;d<Lh.length;d++)Ve(Lh[d],e);break;case"image":Ve("error",e),Ve("load",e);break;case"details":Ve("toggle",e);break;case"embed":case"source":case"link":Ve("error",e),Ve("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(St in c)if(c.hasOwnProperty(St)&&(d=c[St],d!=null))switch(St){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:En(e,a,St,d,c,null)}return;default:if(Bu(a)){for(xt in c)c.hasOwnProperty(xt)&&(d=c[xt],d!==void 0&&Wg(e,a,xt,d,c,void 0));return}}for(tt in c)c.hasOwnProperty(tt)&&(d=c[tt],d!=null&&En(e,a,tt,d,c,null))}function Bb(e,a,c,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,w=null,q=null,tt=null,ot=null,St=null,xt=null;for(Tt in c){var jt=c[Tt];if(c.hasOwnProperty(Tt)&&jt!=null)switch(Tt){case"checked":break;case"value":break;case"defaultValue":ot=jt;default:d.hasOwnProperty(Tt)||En(e,a,Tt,null,d,jt)}}for(var Et in d){var Tt=d[Et];if(jt=c[Et],d.hasOwnProperty(Et)&&(Tt!=null||jt!=null))switch(Et){case"type":w=Tt;break;case"name":b=Tt;break;case"checked":St=Tt;break;case"defaultChecked":xt=Tt;break;case"value":q=Tt;break;case"defaultValue":tt=Tt;break;case"children":case"dangerouslySetInnerHTML":if(Tt!=null)throw Error(i(137,a));break;default:Tt!==jt&&En(e,a,Et,Tt,d,jt)}}_o(e,q,tt,ot,St,xt,w,b);return;case"select":Tt=q=tt=Et=null;for(w in c)if(ot=c[w],c.hasOwnProperty(w)&&ot!=null)switch(w){case"value":break;case"multiple":Tt=ot;default:d.hasOwnProperty(w)||En(e,a,w,null,d,ot)}for(b in d)if(w=d[b],ot=c[b],d.hasOwnProperty(b)&&(w!=null||ot!=null))switch(b){case"value":Et=w;break;case"defaultValue":tt=w;break;case"multiple":q=w;default:w!==ot&&En(e,a,b,w,d,ot)}a=tt,c=q,d=Tt,Et!=null?Cs(e,!!c,Et,!1):!!d!=!!c&&(a!=null?Cs(e,!!c,a,!0):Cs(e,!!c,c?[]:"",!1));return;case"textarea":Tt=Et=null;for(tt in c)if(b=c[tt],c.hasOwnProperty(tt)&&b!=null&&!d.hasOwnProperty(tt))switch(tt){case"value":break;case"children":break;default:En(e,a,tt,null,d,b)}for(q in d)if(b=d[q],w=c[q],d.hasOwnProperty(q)&&(b!=null||w!=null))switch(q){case"value":Et=b;break;case"defaultValue":Tt=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(i(91));break;default:b!==w&&En(e,a,q,b,d,w)}wf(e,Et,Tt);return;case"option":for(var ie in c)if(Et=c[ie],c.hasOwnProperty(ie)&&Et!=null&&!d.hasOwnProperty(ie))switch(ie){case"selected":e.selected=!1;break;default:En(e,a,ie,null,d,Et)}for(ot in d)if(Et=d[ot],Tt=c[ot],d.hasOwnProperty(ot)&&Et!==Tt&&(Et!=null||Tt!=null))switch(ot){case"selected":e.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:En(e,a,ot,Et,d,Tt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in c)Et=c[Ce],c.hasOwnProperty(Ce)&&Et!=null&&!d.hasOwnProperty(Ce)&&En(e,a,Ce,null,d,Et);for(St in d)if(Et=d[St],Tt=c[St],d.hasOwnProperty(St)&&Et!==Tt&&(Et!=null||Tt!=null))switch(St){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(i(137,a));break;default:En(e,a,St,Et,d,Tt)}return;default:if(Bu(a)){for(var Cn in c)Et=c[Cn],c.hasOwnProperty(Cn)&&Et!==void 0&&!d.hasOwnProperty(Cn)&&Wg(e,a,Cn,void 0,d,Et);for(xt in d)Et=d[xt],Tt=c[xt],!d.hasOwnProperty(xt)||Et===Tt||Et===void 0&&Tt===void 0||Wg(e,a,xt,Et,d,Tt);return}}for(var pt in c)Et=c[pt],c.hasOwnProperty(pt)&&Et!=null&&!d.hasOwnProperty(pt)&&En(e,a,pt,null,d,Et);for(jt in d)Et=d[jt],Tt=c[jt],!d.hasOwnProperty(jt)||Et===Tt||Et==null&&Tt==null||En(e,a,jt,Et,d,Tt)}function wv(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,a=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var b=c[d],w=b.transferSize,q=b.initiatorType,tt=b.duration;if(w&&tt&&wv(q)){for(q=0,tt=b.responseEnd,d+=1;d<c.length;d++){var ot=c[d],St=ot.startTime;if(St>tt)break;var xt=ot.transferSize,jt=ot.initiatorType;xt&&wv(jt)&&(ot=ot.responseEnd,q+=xt*(ot<tt?1:(tt-St)/(ot-St)))}if(--d,a+=8*(w+q)/(b.duration/1e3),e++,10<e)break}}if(0<e)return a/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var $g=null,tp=null;function M0(e){return e.nodeType===9?e:e.ownerDocument}function Rv(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ov(e,a){if(e===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&a==="foreignObject"?0:e}function ep(e,a){return e==="textarea"||e==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var np=null;function Lb(){var e=window.event;return e&&e.type==="popstate"?e===np?!1:(np=e,!0):(np=null,!1)}var xv=typeof setTimeout=="function"?setTimeout:void 0,Gb=typeof clearTimeout=="function"?clearTimeout:void 0,Mv=typeof Promise=="function"?Promise:void 0,Pb=typeof queueMicrotask=="function"?queueMicrotask:typeof Mv<"u"?function(e){return Mv.resolve(null).then(e).catch(Hb)}:xv;function Hb(e){setTimeout(function(){throw e})}function Zl(e){return e==="head"}function Nv(e,a){var c=a,d=0;do{var b=c.nextSibling;if(e.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"||c==="/&"){if(d===0){e.removeChild(b),Xc(a);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")Ph(e.ownerDocument.documentElement);else if(c==="head"){c=e.ownerDocument.head,Ph(c);for(var w=c.firstChild;w;){var q=w.nextSibling,tt=w.nodeName;w[wa]||tt==="SCRIPT"||tt==="STYLE"||tt==="LINK"&&w.rel.toLowerCase()==="stylesheet"||c.removeChild(w),w=q}}else c==="body"&&Ph(e.ownerDocument.body);c=b}while(c);Xc(a)}function jv(e,a){var c=e;e=0;do{var d=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(e===0)break;e--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||e++;c=d}while(c)}function ip(e){var a=e.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":ip(c),on(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}e.removeChild(c)}}function Ib(e,a,c,d){for(;e.nodeType===1;){var b=c;if(e.nodeName.toLowerCase()!==a.toLowerCase()){if(!d&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(d){if(!e[wa])switch(a){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(w=e.getAttribute("rel"),w==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(w!==b.rel||e.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||e.getAttribute("title")!==(b.title==null?null:b.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(w=e.getAttribute("src"),(w!==(b.src==null?null:b.src)||e.getAttribute("type")!==(b.type==null?null:b.type)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&w&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(a==="input"&&e.type==="hidden"){var w=b.name==null?null:""+b.name;if(b.type==="hidden"&&e.getAttribute("name")===w)return e}else return e;if(e=pr(e.nextSibling),e===null)break}return null}function kb(e,a,c){if(a==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!c||(e=pr(e.nextSibling),e===null))return null;return e}function Dv(e,a){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=pr(e.nextSibling),e===null))return null;return e}function ap(e){return e.data==="$?"||e.data==="$~"}function rp(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function qb(e,a){var c=e.ownerDocument;if(e.data==="$~")e._reactRetry=a;else if(e.data!=="$?"||c.readyState!=="loading")a();else{var d=function(){a(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),e._reactRetry=d}}function pr(e){for(;e!=null;e=e.nextSibling){var a=e.nodeType;if(a===1||a===3)break;if(a===8){if(a=e.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return e}var sp=null;function Uv(e){e=e.nextSibling;for(var a=0;e;){if(e.nodeType===8){var c=e.data;if(c==="/$"||c==="/&"){if(a===0)return pr(e.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}e=e.nextSibling}return null}function Bv(e){e=e.previousSibling;for(var a=0;e;){if(e.nodeType===8){var c=e.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return e;a--}else c!=="/$"&&c!=="/&"||a++}e=e.previousSibling}return null}function zv(e,a,c){switch(a=M0(c),e){case"html":if(e=a.documentElement,!e)throw Error(i(452));return e;case"head":if(e=a.head,!e)throw Error(i(453));return e;case"body":if(e=a.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Ph(e){for(var a=e.attributes;a.length;)e.removeAttributeNode(a[0]);on(e)}var mr=new Map,Lv=new Set;function N0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var fl=I.d;I.d={f:Vb,r:Yb,D:Kb,C:Qb,L:Xb,m:Fb,X:Zb,S:Jb,M:Wb};function Vb(){var e=fl.f(),a=Xl();return e||a}function Yb(e){var a=Oa(e);a!==null&&a.tag===5&&a.type==="form"?m0(a):fl.r(e)}var Yc=typeof document>"u"?null:document;function Gv(e,a,c){var d=Yc;if(d&&typeof a=="string"&&a){var b=ia(a);b='link[rel="'+e+'"][href="'+b+'"]',typeof c=="string"&&(b+='[crossorigin="'+c+'"]'),Lv.has(b)||(Lv.add(b),e={rel:e,crossOrigin:c,href:a},d.querySelector(b)===null&&(a=d.createElement("link"),Hi(a,"link",e),ri(a),d.head.appendChild(a)))}}function Kb(e){fl.D(e),Gv("dns-prefetch",e,null)}function Qb(e,a){fl.C(e,a),Gv("preconnect",e,a)}function Xb(e,a,c){fl.L(e,a,c);var d=Yc;if(d&&e&&a){var b='link[rel="preload"][as="'+ia(a)+'"]';a==="image"&&c&&c.imageSrcSet?(b+='[imagesrcset="'+ia(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(b+='[imagesizes="'+ia(c.imageSizes)+'"]')):b+='[href="'+ia(e)+'"]';var w=b;switch(a){case"style":w=Kc(e);break;case"script":w=Qc(e)}mr.has(w)||(e=C({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:e,as:a},c),mr.set(w,e),d.querySelector(b)!==null||a==="style"&&d.querySelector(Hh(w))||a==="script"&&d.querySelector(Ih(w))||(a=d.createElement("link"),Hi(a,"link",e),ri(a),d.head.appendChild(a)))}}function Fb(e,a){fl.m(e,a);var c=Yc;if(c&&e){var d=a&&typeof a.as=="string"?a.as:"script",b='link[rel="modulepreload"][as="'+ia(d)+'"][href="'+ia(e)+'"]',w=b;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Qc(e)}if(!mr.has(w)&&(e=C({rel:"modulepreload",href:e},a),mr.set(w,e),c.querySelector(b)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Ih(w)))return}d=c.createElement("link"),Hi(d,"link",e),ri(d),c.head.appendChild(d)}}}function Jb(e,a,c){fl.S(e,a,c);var d=Yc;if(d&&e){var b=Ya(d).hoistableStyles,w=Kc(e);a=a||"default";var q=b.get(w);if(!q){var tt={loading:0,preload:null};if(q=d.querySelector(Hh(w)))tt.loading=5;else{e=C({rel:"stylesheet",href:e,"data-precedence":a},c),(c=mr.get(w))&&lp(e,c);var ot=q=d.createElement("link");ri(ot),Hi(ot,"link",e),ot._p=new Promise(function(St,xt){ot.onload=St,ot.onerror=xt}),ot.addEventListener("load",function(){tt.loading|=1}),ot.addEventListener("error",function(){tt.loading|=2}),tt.loading|=4,j0(q,a,d)}q={type:"stylesheet",instance:q,count:1,state:tt},b.set(w,q)}}}function Zb(e,a){fl.X(e,a);var c=Yc;if(c&&e){var d=Ya(c).hoistableScripts,b=Qc(e),w=d.get(b);w||(w=c.querySelector(Ih(b)),w||(e=C({src:e,async:!0},a),(a=mr.get(b))&&op(e,a),w=c.createElement("script"),ri(w),Hi(w,"link",e),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},d.set(b,w))}}function Wb(e,a){fl.M(e,a);var c=Yc;if(c&&e){var d=Ya(c).hoistableScripts,b=Qc(e),w=d.get(b);w||(w=c.querySelector(Ih(b)),w||(e=C({src:e,async:!0,type:"module"},a),(a=mr.get(b))&&op(e,a),w=c.createElement("script"),ri(w),Hi(w,"link",e),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},d.set(b,w))}}function Pv(e,a,c,d){var b=(b=$.current)?N0(b):null;if(!b)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=Kc(c.href),c=Ya(b).hoistableStyles,d=c.get(a),d||(d={type:"style",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){e=Kc(c.href);var w=Ya(b).hoistableStyles,q=w.get(e);if(q||(b=b.ownerDocument||b,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(e,q),(w=b.querySelector(Hh(e)))&&!w._p&&(q.instance=w,q.state.loading=5),mr.has(e)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},mr.set(e,c),w||$b(b,e,c,q.state))),a&&d===null)throw Error(i(528,""));return q}if(a&&d!==null)throw Error(i(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Qc(c),c=Ya(b).hoistableScripts,d=c.get(a),d||(d={type:"script",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Kc(e){return'href="'+ia(e)+'"'}function Hh(e){return'link[rel="stylesheet"]['+e+"]"}function Hv(e){return C({},e,{"data-precedence":e.precedence,precedence:null})}function $b(e,a,c,d){e.querySelector('link[rel="preload"][as="style"]['+a+"]")?d.loading=1:(a=e.createElement("link"),d.preload=a,a.addEventListener("load",function(){return d.loading|=1}),a.addEventListener("error",function(){return d.loading|=2}),Hi(a,"link",c),ri(a),e.head.appendChild(a))}function Qc(e){return'[src="'+ia(e)+'"]'}function Ih(e){return"script[async]"+e}function Iv(e,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var d=e.querySelector('style[data-href~="'+ia(c.href)+'"]');if(d)return a.instance=d,ri(d),d;var b=C({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(e.ownerDocument||e).createElement("style"),ri(d),Hi(d,"style",b),j0(d,c.precedence,e),a.instance=d;case"stylesheet":b=Kc(c.href);var w=e.querySelector(Hh(b));if(w)return a.state.loading|=4,a.instance=w,ri(w),w;d=Hv(c),(b=mr.get(b))&&lp(d,b),w=(e.ownerDocument||e).createElement("link"),ri(w);var q=w;return q._p=new Promise(function(tt,ot){q.onload=tt,q.onerror=ot}),Hi(w,"link",d),a.state.loading|=4,j0(w,c.precedence,e),a.instance=w;case"script":return w=Qc(c.src),(b=e.querySelector(Ih(w)))?(a.instance=b,ri(b),b):(d=c,(b=mr.get(w))&&(d=C({},c),op(d,b)),e=e.ownerDocument||e,b=e.createElement("script"),ri(b),Hi(b,"link",d),e.head.appendChild(b),a.instance=b);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(d=a.instance,a.state.loading|=4,j0(d,c.precedence,e));return a.instance}function j0(e,a,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=d.length?d[d.length-1]:null,w=b,q=0;q<d.length;q++){var tt=d[q];if(tt.dataset.precedence===a)w=tt;else if(w!==b)break}w?w.parentNode.insertBefore(e,w.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(e,a.firstChild))}function lp(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.title==null&&(e.title=a.title)}function op(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.integrity==null&&(e.integrity=a.integrity)}var D0=null;function kv(e,a,c){if(D0===null){var d=new Map,b=D0=new Map;b.set(c,d)}else b=D0,d=b.get(c),d||(d=new Map,b.set(c,d));if(d.has(e))return d;for(d.set(e,null),c=c.getElementsByTagName(e),b=0;b<c.length;b++){var w=c[b];if(!(w[wa]||w[te]||e==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var q=w.getAttribute(a)||"";q=e+q;var tt=d.get(q);tt?tt.push(w):d.set(q,[w])}}return d}function qv(e,a,c){e=e.ownerDocument||e,e.head.insertBefore(c,a==="title"?e.querySelector("head > title"):null)}function t4(e,a,c){if(c===1||a.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return e=a.disabled,typeof a.precedence=="string"&&e==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Vv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function e4(e,a,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var b=Kc(d.href),w=a.querySelector(Hh(b));if(w){a=w._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(e.count++,e=U0.bind(e),a.then(e,e)),c.state.loading|=4,c.instance=w,ri(w);return}w=a.ownerDocument||a,d=Hv(d),(b=mr.get(b))&&lp(d,b),w=w.createElement("link"),ri(w);var q=w;q._p=new Promise(function(tt,ot){q.onload=tt,q.onerror=ot}),Hi(w,"link",d),c.instance=w}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(e.count++,c=U0.bind(e),a.addEventListener("load",c),a.addEventListener("error",c))}}var up=0;function n4(e,a){return e.stylesheets&&e.count===0&&z0(e,e.stylesheets),0<e.count||0<e.imgCount?function(c){var d=setTimeout(function(){if(e.stylesheets&&z0(e,e.stylesheets),e.unsuspend){var w=e.unsuspend;e.unsuspend=null,w()}},6e4+a);0<e.imgBytes&&up===0&&(up=62500*zb());var b=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&z0(e,e.stylesheets),e.unsuspend)){var w=e.unsuspend;e.unsuspend=null,w()}},(e.imgBytes>up?50:800)+a);return e.unsuspend=c,function(){e.unsuspend=null,clearTimeout(d),clearTimeout(b)}}:null}function U0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)z0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var B0=null;function z0(e,a){e.stylesheets=null,e.unsuspend!==null&&(e.count++,B0=new Map,a.forEach(i4,e),B0=null,U0.call(e))}function i4(e,a){if(!(a.state.loading&4)){var c=B0.get(e);if(c)var d=c.get(null);else{c=new Map,B0.set(e,c);for(var b=e.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<b.length;w++){var q=b[w];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(c.set(q.dataset.precedence,q),d=q)}d&&c.set(null,d)}b=a.instance,q=b.getAttribute("data-precedence"),w=c.get(q)||d,w===d&&c.set(null,b),c.set(q,b),this.count++,d=U0.bind(this),b.addEventListener("load",d),b.addEventListener("error",d),w?w.parentNode.insertBefore(b,w.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(b,e.firstChild)),a.state.loading|=4}}var kh={$$typeof:M,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function a4(e,a,c,d,b,w,q,tt,ot){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ki(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ki(0),this.hiddenUpdates=ki(null),this.identifierPrefix=d,this.onUncaughtError=b,this.onCaughtError=w,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ot,this.incompleteTransitions=new Map}function Yv(e,a,c,d,b,w,q,tt,ot,St,xt,jt){return e=new a4(e,a,c,q,ot,St,xt,jt,tt),a=1,w===!0&&(a|=24),w=Ai(3,null,null,a),e.current=w,w.stateNode=e,a=cc(),a.refCount++,e.pooledCache=a,a.refCount++,w.memoizedState={element:d,isDehydrated:c,cache:a},Hs(w),e}function Kv(e){return e?(e=Ja,e):Ja}function Qv(e,a,c,d,b,w){b=Kv(b),d.context===null?d.context=b:d.pendingContext=b,d=ls(a),d.payload={element:c},w=w===void 0?null:w,w!==null&&(d.callback=w),c=os(e,d,a),c!==null&&(rn(c,e,a),Xo(c,e,a))}function Xv(e,a){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var c=e.retryLane;e.retryLane=c!==0&&c<a?c:a}}function cp(e,a){Xv(e,a),(e=e.alternate)&&Xv(e,a)}function Fv(e){if(e.tag===13||e.tag===31){var a=ra(e,67108864);a!==null&&rn(a,e,67108864),cp(e,67108864)}}function Jv(e){if(e.tag===13||e.tag===31){var a=xi();a=Yt(a);var c=ra(e,a);c!==null&&rn(c,e,a),cp(e,a)}}var L0=!0;function r4(e,a,c,d){var b=D.T;D.T=null;var w=I.p;try{I.p=2,fp(e,a,c,d)}finally{I.p=w,D.T=b}}function s4(e,a,c,d){var b=D.T;D.T=null;var w=I.p;try{I.p=8,fp(e,a,c,d)}finally{I.p=w,D.T=b}}function fp(e,a,c,d){if(L0){var b=hp(d);if(b===null)Zg(e,a,d,G0,c),Wv(e,d);else if(o4(b,e,a,c,d))d.stopPropagation();else if(Wv(e,d),a&4&&-1<l4.indexOf(e)){for(;b!==null;){var w=Oa(b);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var q=Fn(w.pendingLanes);if(q!==0){var tt=w;for(tt.pendingLanes|=2,tt.entangledLanes|=2;q;){var ot=1<<31-ue(q);tt.entanglements[1]|=ot,q&=~ot}bs(w),(Se&6)===0&&(Ta=ye()+500,zh(0))}}break;case 31:case 13:tt=ra(w,2),tt!==null&&rn(tt,w,2),Xl(),cp(w,2)}if(w=hp(d),w===null&&Zg(e,a,d,G0,c),w===b)break;b=w}b!==null&&d.stopPropagation()}else Zg(e,a,d,null,c)}}function hp(e){return e=zu(e),dp(e)}var G0=null;function dp(e){if(G0=null,e=Ra(e),e!==null){var a=o(e);if(a===null)e=null;else{var c=a.tag;if(c===13){if(e=f(a),e!==null)return e;e=null}else if(c===31){if(e=h(a),e!==null)return e;e=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;e=null}else a!==e&&(e=null)}}return G0=e,null}function Zv(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(We()){case an:return 2;case ge:return 8;case ct:case At:return 32;case Mt:return 268435456;default:return 32}default:return 32}}var gp=!1,Wl=null,$l=null,to=null,qh=new Map,Vh=new Map,eo=[],l4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Wv(e,a){switch(e){case"focusin":case"focusout":Wl=null;break;case"dragenter":case"dragleave":$l=null;break;case"mouseover":case"mouseout":to=null;break;case"pointerover":case"pointerout":qh.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vh.delete(a.pointerId)}}function Yh(e,a,c,d,b,w){return e===null||e.nativeEvent!==w?(e={blockedOn:a,domEventName:c,eventSystemFlags:d,nativeEvent:w,targetContainers:[b]},a!==null&&(a=Oa(a),a!==null&&Fv(a)),e):(e.eventSystemFlags|=d,a=e.targetContainers,b!==null&&a.indexOf(b)===-1&&a.push(b),e)}function o4(e,a,c,d,b){switch(a){case"focusin":return Wl=Yh(Wl,e,a,c,d,b),!0;case"dragenter":return $l=Yh($l,e,a,c,d,b),!0;case"mouseover":return to=Yh(to,e,a,c,d,b),!0;case"pointerover":var w=b.pointerId;return qh.set(w,Yh(qh.get(w)||null,e,a,c,d,b)),!0;case"gotpointercapture":return w=b.pointerId,Vh.set(w,Yh(Vh.get(w)||null,e,a,c,d,b)),!0}return!1}function $v(e){var a=Ra(e.target);if(a!==null){var c=o(a);if(c!==null){if(a=c.tag,a===13){if(a=f(c),a!==null){e.blockedOn=a,mn(e.priority,function(){Jv(c)});return}}else if(a===31){if(a=h(c),a!==null){e.blockedOn=a,mn(e.priority,function(){Jv(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){e.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}e.blockedOn=null}function P0(e){if(e.blockedOn!==null)return!1;for(var a=e.targetContainers;0<a.length;){var c=hp(e.nativeEvent);if(c===null){c=e.nativeEvent;var d=new c.constructor(c.type,c);_l=d,c.target.dispatchEvent(d),_l=null}else return a=Oa(c),a!==null&&Fv(a),e.blockedOn=c,!1;a.shift()}return!0}function ty(e,a,c){P0(e)&&c.delete(a)}function u4(){gp=!1,Wl!==null&&P0(Wl)&&(Wl=null),$l!==null&&P0($l)&&($l=null),to!==null&&P0(to)&&(to=null),qh.forEach(ty),Vh.forEach(ty)}function H0(e,a){e.blockedOn===a&&(e.blockedOn=null,gp||(gp=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,u4)))}var I0=null;function ey(e){I0!==e&&(I0=e,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){I0===e&&(I0=null);for(var a=0;a<e.length;a+=3){var c=e[a],d=e[a+1],b=e[a+2];if(typeof d!="function"){if(dp(d||c)===null)continue;break}var w=Oa(c);w!==null&&(e.splice(a,3),a-=3,Oc(w,{pending:!0,data:b,method:c.method,action:d},d,b))}}))}function Xc(e){function a(ot){return H0(ot,e)}Wl!==null&&H0(Wl,e),$l!==null&&H0($l,e),to!==null&&H0(to,e),qh.forEach(a),Vh.forEach(a);for(var c=0;c<eo.length;c++){var d=eo[c];d.blockedOn===e&&(d.blockedOn=null)}for(;0<eo.length&&(c=eo[0],c.blockedOn===null);)$v(c),c.blockedOn===null&&eo.shift();if(c=(e.ownerDocument||e).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var b=c[d],w=c[d+1],q=b[re]||null;if(typeof w=="function")q||ey(c);else if(q){var tt=null;if(w&&w.hasAttribute("formAction")){if(b=w,q=w[re]||null)tt=q.formAction;else if(dp(b)!==null)continue}else tt=q.action;typeof tt=="function"?c[d+1]=tt:(c.splice(d,3),d-=3),ey(c)}}}function ny(){function e(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(q){return b=q})},focusReset:"manual",scroll:"manual"})}function a(){b!==null&&(b(),b=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,b=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),b!==null&&(b(),b=null)}}}function pp(e){this._internalRoot=e}k0.prototype.render=pp.prototype.render=function(e){var a=this._internalRoot;if(a===null)throw Error(i(409));var c=a.current,d=xi();Qv(c,d,e,a,null,null)},k0.prototype.unmount=pp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var a=e.containerInfo;Qv(e.current,2,null,e,null,null),Xl(),a[oe]=null}};function k0(e){this._internalRoot=e}k0.prototype.unstable_scheduleHydration=function(e){if(e){var a=xn();e={blockedOn:null,target:e,priority:a};for(var c=0;c<eo.length&&a!==0&&a<eo[c].priority;c++);eo.splice(c,0,e),c===0&&$v(e)}};var iy=t.version;if(iy!=="19.2.0")throw Error(i(527,iy,"19.2.0"));I.findDOMNode=function(e){var a=e._reactInternals;if(a===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(a),e=e!==null?_(e):null,e=e===null?null:e.stateNode,e};var c4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var q0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q0.isDisabled&&q0.supportsFiber)try{ht=q0.inject(c4),vt=q0}catch{}}return Qh.createRoot=function(e,a){if(!r(e))throw Error(i(299));var c=!1,d="",b=eu,w=nu,q=Mc;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(b=a.onUncaughtError),a.onCaughtError!==void 0&&(w=a.onCaughtError),a.onRecoverableError!==void 0&&(q=a.onRecoverableError)),a=Yv(e,1,!1,null,null,c,d,null,b,w,q,ny),e[oe]=a.current,Jg(e),new pp(a)},Qh.hydrateRoot=function(e,a,c){if(!r(e))throw Error(i(299));var d=!1,b="",w=eu,q=nu,tt=Mc,ot=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(b=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(q=c.onCaughtError),c.onRecoverableError!==void 0&&(tt=c.onRecoverableError),c.formState!==void 0&&(ot=c.formState)),a=Yv(e,1,!0,a,c??null,d,b,ot,w,q,tt,ny),a.context=Kv(null),c=a.current,d=xi(),d=Yt(d),b=ls(d),b.callback=null,os(c,b,d),c=d,a.current.lanes=c,Aa(a,c),bs(a),e[oe]=a.current,Jg(e),new k0(a)},Qh.version="19.2.0",Qh}var dy;function _4(){if(dy)return yp.exports;dy=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),yp.exports=b4(),yp.exports}var E4=_4();const C4=pf(E4);_2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fd(){return fd=Object.assign?Object.assign.bind():function(l){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(l[i]=n[i])}return l},fd.apply(this,arguments)}var co;(function(l){l.Pop="POP",l.Push="PUSH",l.Replace="REPLACE"})(co||(co={}));const gy="popstate";function T4(l){l===void 0&&(l={});function t(i,r){let{pathname:o,search:f,hash:h}=i.location;return _m("",{pathname:o,search:f,hash:h},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:C2(r)}return w4(t,n,null,l)}function Ci(l,t){if(l===!1||l===null||typeof l>"u")throw new Error(t)}function E2(l,t){if(!l){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function A4(){return Math.random().toString(36).substr(2,8)}function py(l,t){return{usr:l.state,key:l.key,idx:t}}function _m(l,t,n,i){return n===void 0&&(n=null),fd({pathname:typeof l=="string"?l:l.pathname,search:"",hash:""},typeof t=="string"?mf(t):t,{state:n,key:t&&t.key||i||A4()})}function C2(l){let{pathname:t="/",search:n="",hash:i=""}=l;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function mf(l){let t={};if(l){let n=l.indexOf("#");n>=0&&(t.hash=l.substr(n),l=l.substr(0,n));let i=l.indexOf("?");i>=0&&(t.search=l.substr(i),l=l.substr(0,i)),l&&(t.pathname=l)}return t}function w4(l,t,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:o=!1}=i,f=r.history,h=co.Pop,g=null,m=_();m==null&&(m=0,f.replaceState(fd({},f.state,{idx:m}),""));function _(){return(f.state||{idx:null}).idx}function C(){h=co.Pop;let B=_(),L=B==null?null:B-m;m=B,g&&g({action:h,location:N.location,delta:L})}function E(B,L){h=co.Push;let j=_m(N.location,B,L);m=_()+1;let M=py(j,m),G=N.createHref(j);try{f.pushState(M,"",G)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;r.location.assign(G)}o&&g&&g({action:h,location:N.location,delta:1})}function R(B,L){h=co.Replace;let j=_m(N.location,B,L);m=_();let M=py(j,m),G=N.createHref(j);f.replaceState(M,"",G),o&&g&&g({action:h,location:N.location,delta:0})}function v(B){let L=r.location.origin!=="null"?r.location.origin:r.location.href,j=typeof B=="string"?B:C2(B);return j=j.replace(/ $/,"%20"),Ci(L,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,L)}let N={get action(){return h},get location(){return l(r,f)},listen(B){if(g)throw new Error("A history only accepts one active listener");return r.addEventListener(gy,C),g=B,()=>{r.removeEventListener(gy,C),g=null}},createHref(B){return t(r,B)},createURL:v,encodeLocation(B){let L=v(B);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:E,replace:R,go(B){return f.go(B)}};return N}var my;(function(l){l.data="data",l.deferred="deferred",l.redirect="redirect",l.error="error"})(my||(my={}));function R4(l,t,n){return n===void 0&&(n="/"),O4(l,t,n)}function O4(l,t,n,i){let r=typeof t=="string"?mf(t):t,o=w2(r.pathname||"/",n);if(o==null)return null;let f=T2(l);x4(f);let h=null;for(let g=0;h==null&&g<f.length;++g){let m=I4(o);h=G4(f[g],m)}return h}function T2(l,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(o,f,h)=>{let g={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:f,route:o};g.relativePath.startsWith("/")&&(Ci(g.relativePath.startsWith(i),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(i.length));let m=Su([i,g.relativePath]),_=n.concat(g);o.children&&o.children.length>0&&(Ci(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),T2(o.children,t,_,m)),!(o.path==null&&!o.index)&&t.push({path:m,score:z4(m,o.index),routesMeta:_})};return l.forEach((o,f)=>{var h;if(o.path===""||!((h=o.path)!=null&&h.includes("?")))r(o,f);else for(let g of A2(o.path))r(o,f,g)}),t}function A2(l){let t=l.split("/");if(t.length===0)return[];let[n,...i]=t,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(i.length===0)return r?[o,""]:[o];let f=A2(i.join("/")),h=[];return h.push(...f.map(g=>g===""?o:[o,g].join("/"))),r&&h.push(...f),h.map(g=>l.startsWith("/")&&g===""?"/":g)}function x4(l){l.sort((t,n)=>t.score!==n.score?n.score-t.score:L4(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const M4=/^:[\w-]+$/,N4=3,j4=2,D4=1,U4=10,B4=-2,vy=l=>l==="*";function z4(l,t){let n=l.split("/"),i=n.length;return n.some(vy)&&(i+=B4),t&&(i+=j4),n.filter(r=>!vy(r)).reduce((r,o)=>r+(M4.test(o)?N4:o===""?D4:U4),i)}function L4(l,t){return l.length===t.length&&l.slice(0,-1).every((i,r)=>i===t[r])?l[l.length-1]-t[t.length-1]:0}function G4(l,t,n){let{routesMeta:i}=l,r={},o="/",f=[];for(let h=0;h<i.length;++h){let g=i[h],m=h===i.length-1,_=o==="/"?t:t.slice(o.length)||"/",C=P4({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},_),E=g.route;if(!C)return null;Object.assign(r,C.params),f.push({params:r,pathname:Su([o,C.pathname]),pathnameBase:Q4(Su([o,C.pathnameBase])),route:E}),C.pathnameBase!=="/"&&(o=Su([o,C.pathnameBase]))}return f}function P4(l,t){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[n,i]=H4(l.path,l.caseSensitive,l.end),r=t.match(n);if(!r)return null;let o=r[0],f=o.replace(/(.)\/+$/,"$1"),h=r.slice(1);return{params:i.reduce((m,_,C)=>{let{paramName:E,isOptional:R}=_;if(E==="*"){let N=h[C]||"";f=o.slice(0,o.length-N.length).replace(/(.)\/+$/,"$1")}const v=h[C];return R&&!v?m[E]=void 0:m[E]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:f,pattern:l}}function H4(l,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),E2(l==="*"||!l.endsWith("*")||l.endsWith("/*"),'Route path "'+l+'" will be treated as if it were '+('"'+l.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+l.replace(/\*$/,"/*")+'".'));let i=[],r="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,h,g)=>(i.push({paramName:h,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return l.endsWith("*")?(i.push({paramName:"*"}),r+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":l!==""&&l!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function I4(l){try{return l.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return E2(!1,'The URL path "'+l+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),l}}function w2(l,t){if(t==="/")return l;if(!l.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=l.charAt(n);return i&&i!=="/"?null:l.slice(n)||"/"}function k4(l,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:r=""}=typeof l=="string"?mf(l):l;return{pathname:n?n.startsWith("/")?n:q4(n,t):t,search:X4(i),hash:F4(r)}}function q4(l,t){let n=t.replace(/\/+$/,"").split("/");return l.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Ep(l,t,n,i){return"Cannot include a '"+l+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function V4(l){return l.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Y4(l,t){let n=V4(l);return t?n.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function K4(l,t,n,i){i===void 0&&(i=!1);let r;typeof l=="string"?r=mf(l):(r=fd({},l),Ci(!r.pathname||!r.pathname.includes("?"),Ep("?","pathname","search",r)),Ci(!r.pathname||!r.pathname.includes("#"),Ep("#","pathname","hash",r)),Ci(!r.search||!r.search.includes("#"),Ep("#","search","hash",r)));let o=l===""||r.pathname==="",f=o?"/":r.pathname,h;if(f==null)h=n;else{let C=t.length-1;if(!i&&f.startsWith("..")){let E=f.split("/");for(;E[0]==="..";)E.shift(),C-=1;r.pathname=E.join("/")}h=C>=0?t[C]:"/"}let g=k4(r,h),m=f&&f!=="/"&&f.endsWith("/"),_=(o||f===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(m||_)&&(g.pathname+="/"),g}const Su=l=>l.join("/").replace(/\/\/+/g,"/"),Q4=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),X4=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,F4=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l;function J4(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}const R2=["post","put","patch","delete"];new Set(R2);const Z4=["get",...R2];new Set(Z4);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hd(){return hd=Object.assign?Object.assign.bind():function(l){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(l[i]=n[i])}return l},hd.apply(this,arguments)}const Xm=st.createContext(null),W4=st.createContext(null),Cg=st.createContext(null),Tg=st.createContext(null),vf=st.createContext({outlet:null,matches:[],isDataRoute:!1}),O2=st.createContext(null);function Ag(){return st.useContext(Tg)!=null}function Fm(){return Ag()||Ci(!1),st.useContext(Tg).location}function x2(l){st.useContext(Cg).static||st.useLayoutEffect(l)}function yf(){let{isDataRoute:l}=st.useContext(vf);return l?f3():$4()}function $4(){Ag()||Ci(!1);let l=st.useContext(Xm),{basename:t,future:n,navigator:i}=st.useContext(Cg),{matches:r}=st.useContext(vf),{pathname:o}=Fm(),f=JSON.stringify(Y4(r,n.v7_relativeSplatPath)),h=st.useRef(!1);return x2(()=>{h.current=!0}),st.useCallback(function(m,_){if(_===void 0&&(_={}),!h.current)return;if(typeof m=="number"){i.go(m);return}let C=K4(m,JSON.parse(f),o,_.relative==="path");l==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:Su([t,C.pathname])),(_.replace?i.replace:i.push)(C,_.state,_)},[t,i,f,o,l])}function t3(l,t){return e3(l,t)}function e3(l,t,n,i){Ag()||Ci(!1);let{navigator:r}=st.useContext(Cg),{matches:o}=st.useContext(vf),f=o[o.length-1],h=f?f.params:{};f&&f.pathname;let g=f?f.pathnameBase:"/";f&&f.route;let m=Fm(),_;if(t){var C;let B=typeof t=="string"?mf(t):t;g==="/"||(C=B.pathname)!=null&&C.startsWith(g)||Ci(!1),_=B}else _=m;let E=_.pathname||"/",R=E;if(g!=="/"){let B=g.replace(/^\//,"").split("/");R="/"+E.replace(/^\//,"").split("/").slice(B.length).join("/")}let v=R4(l,{pathname:R}),N=s3(v&&v.map(B=>Object.assign({},B,{params:Object.assign({},h,B.params),pathname:Su([g,r.encodeLocation?r.encodeLocation(B.pathname).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?g:Su([g,r.encodeLocation?r.encodeLocation(B.pathnameBase).pathname:B.pathnameBase])})),o,n,i);return t&&N?st.createElement(Tg.Provider,{value:{location:hd({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:co.Pop}},N):N}function n3(){let l=c3(),t=J4(l)?l.status+" "+l.statusText:l instanceof Error?l.message:JSON.stringify(l),n=l instanceof Error?l.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return st.createElement(st.Fragment,null,st.createElement("h2",null,"Unexpected Application Error!"),st.createElement("h3",{style:{fontStyle:"italic"}},t),n?st.createElement("pre",{style:r},n):null,null)}const i3=st.createElement(n3,null);class a3 extends st.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?st.createElement(vf.Provider,{value:this.props.routeContext},st.createElement(O2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function r3(l){let{routeContext:t,match:n,children:i}=l,r=st.useContext(Xm);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),st.createElement(vf.Provider,{value:t},i)}function s3(l,t,n,i){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),l==null){var o;if(!n)return null;if(n.errors)l=n.matches;else if((o=i)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)l=n.matches;else return null}let f=l,h=(r=n)==null?void 0:r.errors;if(h!=null){let _=f.findIndex(C=>C.route.id&&(h==null?void 0:h[C.route.id])!==void 0);_>=0||Ci(!1),f=f.slice(0,Math.min(f.length,_+1))}let g=!1,m=-1;if(n&&i&&i.v7_partialHydration)for(let _=0;_<f.length;_++){let C=f[_];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(m=_),C.route.id){let{loaderData:E,errors:R}=n,v=C.route.loader&&E[C.route.id]===void 0&&(!R||R[C.route.id]===void 0);if(C.route.lazy||v){g=!0,m>=0?f=f.slice(0,m+1):f=[f[0]];break}}}return f.reduceRight((_,C,E)=>{let R,v=!1,N=null,B=null;n&&(R=h&&C.route.id?h[C.route.id]:void 0,N=C.route.errorElement||i3,g&&(m<0&&E===0?(h3("route-fallback"),v=!0,B=null):m===E&&(v=!0,B=C.route.hydrateFallbackElement||null)));let L=t.concat(f.slice(0,E+1)),j=()=>{let M;return R?M=N:v?M=B:C.route.Component?M=st.createElement(C.route.Component,null):C.route.element?M=C.route.element:M=_,st.createElement(r3,{match:C,routeContext:{outlet:_,matches:L,isDataRoute:n!=null},children:M})};return n&&(C.route.ErrorBoundary||C.route.errorElement||E===0)?st.createElement(a3,{location:n.location,revalidation:n.revalidation,component:N,error:R,children:j(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):j()},null)}var M2=(function(l){return l.UseBlocker="useBlocker",l.UseRevalidator="useRevalidator",l.UseNavigateStable="useNavigate",l})(M2||{}),N2=(function(l){return l.UseBlocker="useBlocker",l.UseLoaderData="useLoaderData",l.UseActionData="useActionData",l.UseRouteError="useRouteError",l.UseNavigation="useNavigation",l.UseRouteLoaderData="useRouteLoaderData",l.UseMatches="useMatches",l.UseRevalidator="useRevalidator",l.UseNavigateStable="useNavigate",l.UseRouteId="useRouteId",l})(N2||{});function l3(l){let t=st.useContext(Xm);return t||Ci(!1),t}function o3(l){let t=st.useContext(W4);return t||Ci(!1),t}function u3(l){let t=st.useContext(vf);return t||Ci(!1),t}function j2(l){let t=u3(),n=t.matches[t.matches.length-1];return n.route.id||Ci(!1),n.route.id}function c3(){var l;let t=st.useContext(O2),n=o3(),i=j2();return t!==void 0?t:(l=n.errors)==null?void 0:l[i]}function f3(){let{router:l}=l3(M2.UseNavigateStable),t=j2(N2.UseNavigateStable),n=st.useRef(!1);return x2(()=>{n.current=!0}),st.useCallback(function(r,o){o===void 0&&(o={}),n.current&&(typeof r=="number"?l.navigate(r):l.navigate(r,hd({fromRouteId:t},o)))},[l,t])}const yy={};function h3(l,t,n){yy[l]||(yy[l]=!0)}function d3(l,t){l==null||l.v7_startTransition,l==null||l.v7_relativeSplatPath}function hu(l){Ci(!1)}function g3(l){let{basename:t="/",children:n=null,location:i,navigationType:r=co.Pop,navigator:o,static:f=!1,future:h}=l;Ag()&&Ci(!1);let g=t.replace(/^\/*/,"/"),m=st.useMemo(()=>({basename:g,navigator:o,static:f,future:hd({v7_relativeSplatPath:!1},h)}),[g,h,o,f]);typeof i=="string"&&(i=mf(i));let{pathname:_="/",search:C="",hash:E="",state:R=null,key:v="default"}=i,N=st.useMemo(()=>{let B=w2(_,g);return B==null?null:{location:{pathname:B,search:C,hash:E,state:R,key:v},navigationType:r}},[g,_,C,E,R,v,r]);return N==null?null:st.createElement(Cg.Provider,{value:m},st.createElement(Tg.Provider,{children:n,value:N}))}function p3(l){let{children:t,location:n}=l;return t3(Em(t),n)}new Promise(()=>{});function Em(l,t){t===void 0&&(t=[]);let n=[];return st.Children.forEach(l,(i,r)=>{if(!st.isValidElement(i))return;let o=[...t,r];if(i.type===st.Fragment){n.push.apply(n,Em(i.props.children,o));return}i.type!==hu&&Ci(!1),!i.props.index||!i.props.children||Ci(!1);let f={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(f.children=Em(i.props.children,o)),n.push(f)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cm(l){return l===void 0&&(l=""),new URLSearchParams(typeof l=="string"||Array.isArray(l)||l instanceof URLSearchParams?l:Object.keys(l).reduce((t,n)=>{let i=l[n];return t.concat(Array.isArray(i)?i.map(r=>[n,r]):[[n,i]])},[]))}function m3(l,t){let n=Cm(l);return t&&t.forEach((i,r)=>{n.has(r)||t.getAll(r).forEach(o=>{n.append(r,o)})}),n}const v3="6";try{window.__reactRouterVersion=v3}catch{}const y3="startTransition",Sy=m4[y3];function S3(l){let{basename:t,children:n,future:i,window:r}=l,o=st.useRef();o.current==null&&(o.current=T4({window:r,v5Compat:!0}));let f=o.current,[h,g]=st.useState({action:f.action,location:f.location}),{v7_startTransition:m}=i||{},_=st.useCallback(C=>{m&&Sy?Sy(()=>g(C)):g(C)},[g,m]);return st.useLayoutEffect(()=>f.listen(_),[f,_]),st.useEffect(()=>d3(i),[i]),st.createElement(g3,{basename:t,children:n,location:h.location,navigationType:h.action,navigator:f,future:i})}var by;(function(l){l.UseScrollRestoration="useScrollRestoration",l.UseSubmit="useSubmit",l.UseSubmitFetcher="useSubmitFetcher",l.UseFetcher="useFetcher",l.useViewTransitionState="useViewTransitionState"})(by||(by={}));var _y;(function(l){l.UseFetcher="useFetcher",l.UseFetchers="useFetchers",l.UseScrollRestoration="useScrollRestoration"})(_y||(_y={}));function vd(l){let t=st.useRef(Cm(l)),n=st.useRef(!1),i=Fm(),r=st.useMemo(()=>m3(i.search,n.current?null:t.current),[i.search]),o=yf(),f=st.useCallback((h,g)=>{const m=Cm(typeof h=="function"?h(r):h);n.current=!0,o("?"+m,g)},[o,r]);return[r,f]}function b3(){const l=yf(),[t,n]=st.useState(!1),[i,r]=st.useState(""),[o,f]=st.useState("demo"),h=g=>{g.preventDefault(),i.trim()&&o.trim()&&l(`/student?room=${o}&name=${encodeURIComponent(i.trim())}`)};return t?k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsx("div",{className:"glass-surface landing-container",style:{maxWidth:"500px"},children:k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",style:{fontSize:"2rem"},children:"Join as Student"}),k.jsx("p",{className:"landing-description",children:"Enter your name and room code to start drawing"})]}),k.jsxs("form",{onSubmit:h,style:{width:"100%",marginTop:"2rem"},children:[k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"studentName",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Your Name"}),k.jsx("input",{id:"studentName",type:"text",value:i,onChange:g=>r(g.target.value),placeholder:"Enter your name",autoFocus:!0,required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"roomCode",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Room Code"}),k.jsx("input",{id:"roomCode",type:"text",value:o,onChange:g=>f(g.target.value.toUpperCase()),placeholder:"Enter room code",required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s",fontFamily:"monospace",letterSpacing:"2px"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[k.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"2px solid #ddd",borderRadius:"8px",background:"white",cursor:"pointer",transition:"all 0.2s"},children:"← Back"}),k.jsx("button",{type:"submit",style:{flex:2,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:g=>g.target.style.transform="translateY(-2px)",onMouseOut:g=>g.target.style.transform="translateY(0)",children:"Join Room →"})]})]})]})})})]}):k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsxs("div",{className:"glass-surface landing-container",children:[k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",children:"Teach visually. Collaborate instantly."}),k.jsx("p",{className:"landing-description",children:"Feather streams pencil-perfect strokes between teachers and students in real time. Instant sync, buttery smooth annotation tools, and delightful classroom-ready controls built for iPad and stylus workflows."})]}),k.jsxs("dl",{className:"features",children:[k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Palm rejection"}),k.jsx("dd",{className:"feature-subtitle",children:"Silky palm drawing"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Frameless logos"}),k.jsx("dd",{className:"feature-subtitle",children:"Delightful annotations"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Realtime sync"}),k.jsx("dd",{className:"feature-subtitle",children:"Sub-second latency"})]})]})]}),k.jsxs("div",{className:"workspace-section",children:[k.jsx("p",{className:"workspace-label",children:"PICK YOUR WORKSPACE"}),k.jsxs("div",{className:"workspace-cards",children:[k.jsxs("a",{onClick:()=>l("/teacher"),className:"glass-button teacher-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Teacher dashboard"}),k.jsx("p",{className:"workspace-description",children:"Monitor your students, sync views, and annotate the board. Assign templates/images, and manage the class."})]}),k.jsx("span",{className:"workspace-emoji",children:"👩‍🏫"})]}),k.jsxs("a",{onClick:()=>l("/student-login"),className:"glass-button student-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Student workspace"}),k.jsx("p",{className:"workspace-description",children:"Sketch on a public or draw alongside the class, with undo/redo, templates, and stylus-first controls."})]}),k.jsx("span",{className:"workspace-emoji",children:"👩‍🎓"})]})]})]})]})})]})}const _3=Math.PI/180;function E3(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const vu=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Ft={_global:vu,version:"10.0.7",isBrowser:E3(),isUnminified:/param/.test((function(l){}).toString()),dblClickWindow:400,getAngle(l){return Ft.angleDeg?l*_3:l},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Ft.DD.isDragging},isTransforming(){var l,t;return(t=(l=Ft.Transformer)===null||l===void 0?void 0:l.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!Ft.DD.node},releaseCanvasOnDestroy:!0,document:vu.document,_injectGlobal(l){typeof vu.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),vu.Konva=l}},Xn=l=>{Ft[l.prototype.getClassName()]=l};Ft._injectGlobal(Ft);const C3=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Ey=()=>{if(typeof document>"u")throw new Error(C3)};class Ia{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Ia(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const n=this.m;return{x:n[0]*t.x+n[2]*t.y+n[4],y:n[1]*t.x+n[3]*t.y+n[5]}}translate(t,n){return this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n,this}scale(t,n){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n,this}rotate(t){const n=Math.cos(t),i=Math.sin(t),r=this.m[0]*n+this.m[2]*i,o=this.m[1]*n+this.m[3]*i,f=this.m[0]*-i+this.m[2]*n,h=this.m[1]*-i+this.m[3]*n;return this.m[0]=r,this.m[1]=o,this.m[2]=f,this.m[3]=h,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,n){const i=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,o=this.m[2]+this.m[0]*t,f=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=r,this.m[2]=o,this.m[3]=f,this}multiply(t){const n=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],o=this.m[1]*t.m[2]+this.m[3]*t.m[3],f=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],h=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=o,this.m[4]=f,this.m[5]=h,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,i=-this.m[1]*t,r=-this.m[2]*t,o=this.m[0]*t,f=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),h=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=o,this.m[4]=f,this.m[5]=h,this}getMatrix(){return this.m}decompose(){const t=this.m[0],n=this.m[1],i=this.m[2],r=this.m[3],o=this.m[4],f=this.m[5],h=t*r-n*i,g={x:o,y:f,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){const m=Math.sqrt(t*t+n*n);g.rotation=n>0?Math.acos(t/m):-Math.acos(t/m),g.scaleX=m,g.scaleY=h/m,g.skewX=(t*i+n*r)/h,g.skewY=0}else if(i!=0||r!=0){const m=Math.sqrt(i*i+r*r);g.rotation=Math.PI/2-(r>0?Math.acos(-i/m):-Math.acos(i/m)),g.scaleX=h/m,g.scaleY=m,g.skewX=0,g.skewY=(t*i+n*r)/h}return g.rotation=mt._getRotation(g.rotation),g}}const T3="[object Array]",A3="[object Number]",w3="[object String]",R3="[object Boolean]",O3=Math.PI/180,x3=180/Math.PI,Cp="#",M3="",N3="0",j3="Konva warning: ",Cy="Konva error: ",D3="rgb(",Tp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},U3=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let V0=[];const B3=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(l){setTimeout(l,60)},mt={_isElement(l){return!!(l&&l.nodeType==1)},_isFunction(l){return!!(l&&l.constructor&&l.call&&l.apply)},_isPlainObject(l){return!!l&&l.constructor===Object},_isArray(l){return Object.prototype.toString.call(l)===T3},_isNumber(l){return Object.prototype.toString.call(l)===A3&&!isNaN(l)&&isFinite(l)},_isString(l){return Object.prototype.toString.call(l)===w3},_isBoolean(l){return Object.prototype.toString.call(l)===R3},isObject(l){return l instanceof Object},isValidSelector(l){if(typeof l!="string")return!1;const t=l[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(l){return l===0||l>0?1:-1},requestAnimFrame(l){V0.push(l),V0.length===1&&B3(function(){const t=V0;V0=[],t.forEach(function(n){n()})})},createCanvasElement(){Ey();const l=document.createElement("canvas");try{l.style=l.style||{}}catch{}return l},createImageElement(){return Ey(),document.createElement("img")},_isInDocument(l){for(;l=l.parentNode;)if(l==document)return!0;return!1},_urlToImage(l,t){const n=mt.createImageElement();n.onload=function(){t(n)},n.src=l},_rgbToHex(l,t,n){return((1<<24)+(l<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(l){l=l.replace(Cp,M3);const t=parseInt(l,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let l=(Math.random()*16777215<<0).toString(16);for(;l.length<6;)l=N3+l;return Cp+l},getRGB(l){let t;return l in Tp?(t=Tp[l],{r:t[0],g:t[1],b:t[2]}):l[0]===Cp?this._hexToRgb(l.substring(1)):l.substr(0,4)===D3?(t=U3.exec(l.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(l){return l=l||"black",mt._namedColorToRBA(l)||mt._hex3ColorToRGBA(l)||mt._hex4ColorToRGBA(l)||mt._hex6ColorToRGBA(l)||mt._hex8ColorToRGBA(l)||mt._rgbColorToRGBA(l)||mt._rgbaColorToRGBA(l)||mt._hslColorToRGBA(l)},_namedColorToRBA(l){const t=Tp[l.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(l){if(l.indexOf("rgb(")===0){l=l.match(/rgb\(([^)]+)\)/)[1];const t=l.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(l){if(l.indexOf("rgba(")===0){l=l.match(/rgba\(([^)]+)\)/)[1];const t=l.split(/ *, */).map((n,i)=>n.slice(-1)==="%"?i===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(l){if(l[0]==="#"&&l.length===9)return{r:parseInt(l.slice(1,3),16),g:parseInt(l.slice(3,5),16),b:parseInt(l.slice(5,7),16),a:parseInt(l.slice(7,9),16)/255}},_hex6ColorToRGBA(l){if(l[0]==="#"&&l.length===7)return{r:parseInt(l.slice(1,3),16),g:parseInt(l.slice(3,5),16),b:parseInt(l.slice(5,7),16),a:1}},_hex4ColorToRGBA(l){if(l[0]==="#"&&l.length===5)return{r:parseInt(l[1]+l[1],16),g:parseInt(l[2]+l[2],16),b:parseInt(l[3]+l[3],16),a:parseInt(l[4]+l[4],16)/255}},_hex3ColorToRGBA(l){if(l[0]==="#"&&l.length===4)return{r:parseInt(l[1]+l[1],16),g:parseInt(l[2]+l[2],16),b:parseInt(l[3]+l[3],16),a:1}},_hslColorToRGBA(l){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(l)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(l),i=Number(n[0])/360,r=Number(n[1])/100,o=Number(n[2])/100;let f,h,g;if(r===0)return g=o*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};o<.5?f=o*(1+r):f=o+r-o*r;const m=2*o-f,_=[0,0,0];for(let C=0;C<3;C++)h=i+1/3*-(C-1),h<0&&h++,h>1&&h--,6*h<1?g=m+(f-m)*6*h:2*h<1?g=f:3*h<2?g=m+(f-m)*(2/3-h)*6:g=m,_[C]=g*255;return{r:Math.round(_[0]),g:Math.round(_[1]),b:Math.round(_[2]),a:1}}},haveIntersection(l,t){return!(t.x>l.x+l.width||t.x+t.width<l.x||t.y>l.y+l.height||t.y+t.height<l.y)},cloneObject(l){const t={};for(const n in l)this._isPlainObject(l[n])?t[n]=this.cloneObject(l[n]):this._isArray(l[n])?t[n]=this.cloneArray(l[n]):t[n]=l[n];return t},cloneArray(l){return l.slice(0)},degToRad(l){return l*O3},radToDeg(l){return l*x3},_degToRad(l){return mt.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),mt.degToRad(l)},_radToDeg(l){return mt.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),mt.radToDeg(l)},_getRotation(l){return Ft.angleDeg?mt.radToDeg(l):l},_capitalize(l){return l.charAt(0).toUpperCase()+l.slice(1)},throw(l){throw new Error(Cy+l)},error(l){console.error(Cy+l)},warn(l){Ft.showWarnings&&console.warn(j3+l)},each(l,t){for(const n in l)t(n,l[n])},_inRange(l,t,n){return t<=l&&l<n},_getProjectionToSegment(l,t,n,i,r,o){let f,h,g;const m=(l-n)*(l-n)+(t-i)*(t-i);if(m==0)f=l,h=t,g=(r-n)*(r-n)+(o-i)*(o-i);else{const _=((r-l)*(n-l)+(o-t)*(i-t))/m;_<0?(f=l,h=t,g=(l-r)*(l-r)+(t-o)*(t-o)):_>1?(f=n,h=i,g=(n-r)*(n-r)+(i-o)*(i-o)):(f=l+_*(n-l),h=t+_*(i-t),g=(f-r)*(f-r)+(h-o)*(h-o))}return[f,h,g]},_getProjectionToLine(l,t,n){const i=mt.cloneObject(l);let r=Number.MAX_VALUE;return t.forEach(function(o,f){if(!n&&f===t.length-1)return;const h=t[(f+1)%t.length],g=mt._getProjectionToSegment(o.x,o.y,h.x,h.y,l.x,l.y),m=g[0],_=g[1],C=g[2];C<r&&(i.x=m,i.y=_,r=C)}),i},_prepareArrayForTween(l,t,n){const i=[],r=[];if(l.length>t.length){const f=t;t=l,l=f}for(let f=0;f<l.length;f+=2)i.push({x:l[f],y:l[f+1]});for(let f=0;f<t.length;f+=2)r.push({x:t[f],y:t[f+1]});const o=[];return r.forEach(function(f){const h=mt._getProjectionToLine(f,i,n);o.push(h.x),o.push(h.y)}),o},_prepareToStringify(l){let t;l.visitedByCircularReferenceRemoval=!0;for(const n in l)if(l.hasOwnProperty(n)&&l[n]&&typeof l[n]=="object"){if(t=Object.getOwnPropertyDescriptor(l,n),l[n].visitedByCircularReferenceRemoval||mt._isElement(l[n]))if(t.configurable)delete l[n];else return null;else if(mt._prepareToStringify(l[n])===null)if(t.configurable)delete l[n];else return null}return delete l.visitedByCircularReferenceRemoval,l},_assign(l,t){for(const n in t)l[n]=t[n];return l},_getFirstPointerId(l){return l.touches?l.changedTouches[0].identifier:l.pointerId||999},releaseCanvas(...l){Ft.releaseCanvasOnDestroy&&l.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(l,t,n,i){let r=t<0?t:0,o=n<0?n:0;t=Math.abs(t),n=Math.abs(n);let f=0,h=0,g=0,m=0;typeof i=="number"?f=h=g=m=Math.min(i,t/2,n/2):(f=Math.min(i[0]||0,t/2,n/2),h=Math.min(i[1]||0,t/2,n/2),m=Math.min(i[2]||0,t/2,n/2),g=Math.min(i[3]||0,t/2,n/2)),l.moveTo(r+f,o),l.lineTo(r+t-h,o),l.arc(r+t-h,o+h,h,Math.PI*3/2,0,!1),l.lineTo(r+t,o+n-m),l.arc(r+t-m,o+n-m,m,0,Math.PI/2,!1),l.lineTo(r+g,o+n),l.arc(r+g,o+n-g,g,Math.PI/2,Math.PI,!1),l.lineTo(r,o+f),l.arc(r+f,o+f,f,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(l,t,n,i,r){i=Math.abs(i);for(let o=0;o<n;o++){const f=t[(o-1+n)%n],h=t[o],g=t[(o+1)%n],m={x:h.x-f.x,y:h.y-f.y},_={x:g.x-h.x,y:g.y-h.y},C=Math.hypot(m.x,m.y),E=Math.hypot(_.x,_.y);let R;typeof r=="number"?R=r:R=o<r.length?r[o]:0,R=i*Math.cos(Math.PI/n)*Math.min(1,R/i*2);const N={x:m.x/C,y:m.y/C},B={x:_.x/E,y:_.y/E},L={x:h.x-N.x*R,y:h.y-N.y*R},j={x:h.x+B.x*R,y:h.y+B.y*R};o===0?l.moveTo(L.x,L.y):l.lineTo(L.x,L.y),l.arcTo(h.x,h.y,j.x,j.y,R)}}};function z3(l){const t=[],n=l.length,i=mt;for(let r=0;r<n;r++){let o=l[r];i._isNumber(o)?o=Math.round(o*1e3)/1e3:i._isString(o)||(o=o+""),t.push(o)}return t}const Ty=",",L3="(",G3=")",P3="([",H3="])",I3=";",k3="()",q3="=",Ay=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],V3=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],Y3=100;let Y0=null;function wy(){if(Y0!==null)return Y0;try{const t=mt.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Y0=!1,!1)}catch{return Y0=!1,!1}}class wg{constructor(t){this.canvas=t,Ft.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,n){let i=this.traceArr,r=i.length,o="",f,h,g,m;for(f=0;f<r;f++)h=i[f],g=h.method,g?(m=h.args,o+=g,t?o+=k3:mt._isArray(m[0])?o+=P3+m.join(Ty)+H3:(n&&(m=m.map(_=>typeof _=="number"?Math.floor(_):_)),o+=L3+m.join(Ty)+G3)):(o+=h.property,t||(o+=q3+h.val)),o+=I3;return o}clearTrace(){this.traceArr=[]}_trace(t){let n=this.traceArr,i;n.push(t),i=n.length,i>=Y3&&n.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const n=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(t){const n=t.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(t){const n=t.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(t){const n=t.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(t){const n=t.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(t,n){this._context[t]=n}arc(t,n,i,r,o,f){this._context.arc(t,n,i,r,o,f)}arcTo(t,n,i,r,o){this._context.arcTo(t,n,i,r,o)}beginPath(){this._context.beginPath()}bezierCurveTo(t,n,i,r,o,f){this._context.bezierCurveTo(t,n,i,r,o,f)}clearRect(t,n,i,r){this._context.clearRect(t,n,i,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,n){const i=arguments;if(i.length===2)return this._context.createImageData(t,n);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,n,i,r){return this._context.createLinearGradient(t,n,i,r)}createPattern(t,n){return this._context.createPattern(t,n)}createRadialGradient(t,n,i,r,o,f){return this._context.createRadialGradient(t,n,i,r,o,f)}drawImage(t,n,i,r,o,f,h,g,m){const _=arguments,C=this._context;_.length===3?C.drawImage(t,n,i):_.length===5?C.drawImage(t,n,i,r,o):_.length===9&&C.drawImage(t,n,i,r,o,f,h,g,m)}ellipse(t,n,i,r,o,f,h,g){this._context.ellipse(t,n,i,r,o,f,h,g)}isPointInPath(t,n,i,r){return i?this._context.isPointInPath(i,t,n,r):this._context.isPointInPath(t,n,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,n,i,r){this._context.fillRect(t,n,i,r)}strokeRect(t,n,i,r){this._context.strokeRect(t,n,i,r)}fillText(t,n,i,r){r?this._context.fillText(t,n,i,r):this._context.fillText(t,n,i)}measureText(t){return this._context.measureText(t)}getImageData(t,n,i,r){return this._context.getImageData(t,n,i,r)}lineTo(t,n){this._context.lineTo(t,n)}moveTo(t,n){this._context.moveTo(t,n)}rect(t,n,i,r){this._context.rect(t,n,i,r)}roundRect(t,n,i,r,o){this._context.roundRect(t,n,i,r,o)}putImageData(t,n,i){this._context.putImageData(t,n,i)}quadraticCurveTo(t,n,i,r){this._context.quadraticCurveTo(t,n,i,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,n){this._context.scale(t,n)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,n,i,r,o,f){this._context.setTransform(t,n,i,r,o,f)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,n,i,r){this._context.strokeText(t,n,i,r)}transform(t,n,i,r,o,f){this._context.transform(t,n,i,r,o,f)}translate(t,n){this._context.translate(t,n)}_enableTrace(){let t=this,n=Ay.length,i=this.setAttr,r,o;const f=function(h){let g=t[h],m;t[h]=function(){return o=z3(Array.prototype.slice.call(arguments,0)),m=g.apply(t,arguments),t._trace({method:h,args:o}),m}};for(r=0;r<n;r++)f(Ay[r]);t.setAttr=function(){i.apply(t,arguments);const h=arguments[0];let g=arguments[1];(h==="shadowOffsetX"||h==="shadowOffsetY"||h==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),t._trace({property:h,val:g})}}_applyGlobalCompositeOperation(t){const n=t.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}V3.forEach(function(l){Object.defineProperty(wg.prototype,l,{get(){return this._context[l]},set(t){this._context[l]=t}})});class K3 extends wg{constructor(t,{willReadFrequently:n=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(t){const n=t.fill();this.setAttr("fillStyle",n),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const n=t._getLinearGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fillRadialGradient(t){const n=t._getRadialGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fill(t){const n=t.fill(),i=t.getFillPriority();if(n&&i==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&i==="pattern"){this._fillPattern(t);return}const o=t.getFillLinearGradientColorStops();if(o&&i==="linear-gradient"){this._fillLinearGradient(t);return}const f=t.getFillRadialGradientColorStops();if(f&&i==="radial-gradient"){this._fillRadialGradient(t);return}n?this._fillColor(t):r?this._fillPattern(t):o?this._fillLinearGradient(t):f&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const n=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(n.x,n.y,i.x,i.y);if(r){for(let f=0;f<r.length;f+=2)o.addColorStop(r[f],r[f+1]);this.setAttr("strokeStyle",o)}}_stroke(t){const n=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();const o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(t),n&&t.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var n,i,r;const o=(n=t.getShadowRGBA())!==null&&n!==void 0?n:"black",f=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,h=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},g=t.getAbsoluteScale(),m=this.canvas.getPixelRatio(),_=g.x*m,C=g.y*m;this.setAttr("shadowColor",o),this.setAttr("shadowBlur",f*Math.min(Math.abs(_),Math.abs(C))),this.setAttr("shadowOffsetX",h.x*_),this.setAttr("shadowOffsetY",h.y*C)}}class Q3 extends wg{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const n=t.getStrokeScaleEnabled();if(!n){this.save();const o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(t);const i=t.hitStrokeWidth(),r=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),n||this.restore()}}}let K0;function X3(){if(K0)return K0;const l=mt.createCanvasElement(),t=l.getContext("2d");return K0=(function(){const n=Ft._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i})(),mt.releaseCanvas(l),K0}class Jm{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const i=(t||{}).pixelRatio||Ft.pixelRatio||X3();this.pixelRatio=i,this._canvas=mt.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const n=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,n){this.setWidth(t||0),this.setHeight(n||0)}toDataURL(t,n){try{return this._canvas.toDataURL(t,n)}catch{try{return this._canvas.toDataURL()}catch(r){return mt.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class oo extends Jm{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new K3(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function Ry(){const l=mt.createCanvasElement();l.width=1,l.height=1;const t=l.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data;return!(n[0]===255&&n[1]===0&&n[2]===255&&n[3]===255)}function Oy(){var l,t;return typeof navigator>"u"?!1:(t=(l=navigator.brave)===null||l===void 0?void 0:l.isBrave())!==null&&t!==void 0?t:!1}let xy=!1;function F3(){return Oy()&&Ry()&&!xy&&(xy=!0,mt.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),Oy()&&Ry()}class Zm extends Jm{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Q3(this),this.setSize(t.width,t.height),F3()}}const fn={get isDragging(){let l=!1;return fn._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(l=!0)}),l},justDragged:!1,get node(){let l;return fn._dragElements.forEach(t=>{l=t.node}),l},_dragElements:new Map,_drag(l){const t=[];fn._dragElements.forEach((n,i)=>{const{node:r}=n,o=r.getStage();o.setPointersPositions(l),n.pointerId===void 0&&(n.pointerId=mt._getFirstPointerId(l));const f=o._changedPointerPositions.find(h=>h.id===n.pointerId);if(f){if(n.dragStatus!=="dragging"){const h=r.dragDistance();if(Math.max(Math.abs(f.x-n.startPointerPos.x),Math.abs(f.y-n.startPointerPos.y))<h||(r.startDrag({evt:l}),!r.isDragging()))return}r._setDragPosition(l,n),t.push(r)}}),t.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:l},!0)})},_endDragBefore(l){const t=[];fn._dragElements.forEach(n=>{const{node:i}=n,r=i.getStage();if(l&&r.setPointersPositions(l),!r._changedPointerPositions.find(h=>h.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(fn.justDragged=!0,Ft._mouseListenClick=!1,Ft._touchListenClick=!1,Ft._pointerListenClick=!1,n.dragStatus="stopped");const f=n.node.getLayer()||n.node instanceof Ft.Stage&&n.node;f&&t.indexOf(f)===-1&&t.push(f)}),t.forEach(n=>{n.draw()})},_endDragAfter(l){fn._dragElements.forEach((t,n)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:l},!0),t.dragStatus!=="dragging"&&fn._dragElements.delete(n)})}};Ft.isBrowser&&(window.addEventListener("mouseup",fn._endDragBefore,!0),window.addEventListener("touchend",fn._endDragBefore,!0),window.addEventListener("touchcancel",fn._endDragBefore,!0),window.addEventListener("mousemove",fn._drag),window.addEventListener("touchmove",fn._drag),window.addEventListener("mouseup",fn._endDragAfter,!1),window.addEventListener("touchend",fn._endDragAfter,!1),window.addEventListener("touchcancel",fn._endDragAfter,!1));function ho(l){return mt._isString(l)?'"'+l+'"':Object.prototype.toString.call(l)==="[object Number]"||mt._isBoolean(l)?l:Object.prototype.toString.call(l)}function D2(l){return l>255?255:l<0?0:Math.round(l)}function Vt(){if(Ft.isUnminified)return function(l,t){return mt._isNumber(l)||mt.warn(ho(l)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),l}}function Rg(l){if(Ft.isUnminified)return function(t,n){let i=mt._isNumber(t),r=mt._isArray(t)&&t.length==l;return!i&&!r&&mt.warn(ho(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+l+")"),t}}function Wm(){if(Ft.isUnminified)return function(l,t){return mt._isNumber(l)||l==="auto"||mt.warn(ho(l)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),l}}function bu(){if(Ft.isUnminified)return function(l,t){return mt._isString(l)||mt.warn(ho(l)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),l}}function U2(){if(Ft.isUnminified)return function(l,t){const n=mt._isString(l),i=Object.prototype.toString.call(l)==="[object CanvasGradient]"||l&&l.addColorStop;return n||i||mt.warn(ho(l)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),l}}function J3(){if(Ft.isUnminified)return function(l,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&l instanceof n||(mt._isArray(l)?l.forEach(function(i){mt._isNumber(i)||mt.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):mt.warn(ho(l)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),l}}function Kr(){if(Ft.isUnminified)return function(l,t){return l===!0||l===!1||mt.warn(ho(l)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),l}}function Z3(l){if(Ft.isUnminified)return function(t,n){return t==null||mt.isObject(t)||mt.warn(ho(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+l),t}}const Xh="get",Fh="set",lt={addGetterSetter(l,t,n,i,r){lt.addGetter(l,t,n),lt.addSetter(l,t,i,r),lt.addOverloadedGetterSetter(l,t)},addGetter(l,t,n){const i=Xh+mt._capitalize(t);l.prototype[i]=l.prototype[i]||function(){const r=this.attrs[t];return r===void 0?n:r}},addSetter(l,t,n,i){const r=Fh+mt._capitalize(t);l.prototype[r]||lt.overWriteSetter(l,t,n,i)},overWriteSetter(l,t,n,i){const r=Fh+mt._capitalize(t);l.prototype[r]=function(o){return n&&o!==void 0&&o!==null&&(o=n.call(this,o,t)),this._setAttr(t,o),i&&i.call(this),this}},addComponentsGetterSetter(l,t,n,i,r){const o=n.length,f=mt._capitalize,h=Xh+f(t),g=Fh+f(t);l.prototype[h]=function(){const _={};for(let C=0;C<o;C++){const E=n[C];_[E]=this.getAttr(t+f(E))}return _};const m=Z3(n);l.prototype[g]=function(_){const C=this.attrs[t];i&&(_=i.call(this,_,t)),m&&m.call(this,_,t);for(const E in _)_.hasOwnProperty(E)&&this._setAttr(t+f(E),_[E]);return _||n.forEach(E=>{this._setAttr(t+f(E),void 0)}),this._fireChangeEvent(t,C,_),r&&r.call(this),this},lt.addOverloadedGetterSetter(l,t)},addOverloadedGetterSetter(l,t){const n=mt._capitalize(t),i=Fh+n,r=Xh+n;l.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(l,t,n,i){mt.error("Adding deprecated "+t);const r=Xh+mt._capitalize(t),o=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";l.prototype[r]=function(){mt.error(o);const f=this.attrs[t];return f===void 0?n:f},lt.addSetter(l,t,i,function(){mt.error(o)}),lt.addOverloadedGetterSetter(l,t)},backCompat(l,t){mt.each(t,function(n,i){const r=l.prototype[i],o=Xh+mt._capitalize(n),f=Fh+mt._capitalize(n);function h(){r.apply(this,arguments),mt.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}l.prototype[n]=h,l.prototype[o]=h,l.prototype[f]=h})},afterSetFilter(){this._filterUpToDate=!1}};function W3(l){const t=/(\w+)\(([^)]+)\)/g;let n;for(;(n=t.exec(l))!==null;){const[,i,r]=n;switch(i){case"blur":{const o=parseFloat(r.replace("px",""));return function(f){this.blurRadius(o*.5);const h=Ft.Filters;h&&h.Blur&&h.Blur.call(this,f)}}case"brightness":{const o=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(f){this.brightness(o);const h=Ft.Filters;h&&h.Brightness&&h.Brightness.call(this,f)}}case"contrast":{const o=parseFloat(r);return function(f){const h=100*(Math.sqrt(o)-1);this.contrast(h);const g=Ft.Filters;g&&g.Contrast&&g.Contrast.call(this,f)}}case"grayscale":return function(o){const f=Ft.Filters;f&&f.Grayscale&&f.Grayscale.call(this,o)};case"sepia":return function(o){const f=Ft.Filters;f&&f.Sepia&&f.Sepia.call(this,o)};case"invert":return function(o){const f=Ft.Filters;f&&f.Invert&&f.Invert.call(this,o)};default:mt.warn(`CSS filter "${i}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const dg="absoluteOpacity",Q0="allEventListeners",dl="absoluteTransform",My="absoluteScale",ou="canvas",$3="Change",t5="children",e5="konva",Tm="listening",n5="mouseenter",i5="mouseleave",a5="pointerenter",r5="pointerleave",s5="touchenter",l5="touchleave",Ny="set",jy="Shape",gg=" ",Dy="stage",ro="transform",o5="Stage",Am="visible",u5=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(gg);let c5=1;class kt{constructor(t){this._id=c5++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===ro||t===dl)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,n){let i=this._cache.get(t);return(i===void 0||(t===ro||t===dl)&&i.dirty===!0)&&(i=n.call(this),this._cache.set(t,i)),i}_calculate(t,n,i){if(!this._attachedDepsListeners.get(t)){const r=n.map(o=>o+"Change.konva").join(gg);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(ou)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===dl&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ou)){const{scene:t,filter:n,hit:i,buffer:r}=this._cache.get(ou);mt.releaseCanvas(t,n,i,r),this._cache.delete(ou)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const n=t||{};let i={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(n.width||i.width),o=Math.ceil(n.height||i.height),f=n.pixelRatio,h=n.x===void 0?Math.floor(i.x):n.x,g=n.y===void 0?Math.floor(i.y):n.y,m=n.offset||0,_=n.drawBorder||!1,C=n.hitCanvasPixelRatio||1;if(!r||!o){mt.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const E=Math.abs(Math.round(i.x)-h)>.5?1:0,R=Math.abs(Math.round(i.y)-g)>.5?1:0;r+=m*2+E,o+=m*2+R,h-=m,g-=m;const v=new oo({pixelRatio:f,width:r,height:o}),N=new oo({pixelRatio:f,width:0,height:0,willReadFrequently:!0}),B=new Zm({pixelRatio:C,width:r,height:o}),L=v.getContext(),j=B.getContext(),M=new oo({width:v.width/v.pixelRatio+Math.abs(h),height:v.height/v.pixelRatio+Math.abs(g),pixelRatio:v.pixelRatio}),G=M.getContext();return B.isCache=!0,v.isCache=!0,this._cache.delete(ou),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,N.getContext()._context.imageSmoothingEnabled=!1),L.save(),j.save(),G.save(),L.translate(-h,-g),j.translate(-h,-g),G.translate(-h,-g),M.x=h,M.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(dg),this._clearSelfAndDescendantCache(My),this.drawScene(v,this,M),this.drawHit(B,this),this._isUnderCache=!1,L.restore(),j.restore(),_&&(L.save(),L.beginPath(),L.rect(0,0,r,o),L.closePath(),L.setAttr("strokeStyle","red"),L.setAttr("lineWidth",5),L.stroke(),L.restore()),this._cache.set(ou,{scene:v,filter:N,hit:B,buffer:M,x:h,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(ou)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,n){const i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,o=1/0,f=-1/0,h=-1/0;const g=this.getAbsoluteTransform(n);return i.forEach(function(m){const _=g.point(m);r===void 0&&(r=f=_.x,o=h=_.y),r=Math.min(r,_.x),o=Math.min(o,_.y),f=Math.max(f,_.x),h=Math.max(h,_.y)}),{x:r,y:o,width:f-r,height:h-o}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();t.translate(n.x,n.y);const i=this._getCachedSceneCanvas(),r=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/r,i.height/r),t.restore()}_drawCachedHitCanvas(t){const n=this._getCanvasCache(),i=n.hit;t.save(),t.translate(n.x,n.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),n=this._getCanvasCache(),i=n.scene,r=n.filter,o=r.getContext(),f,h,g,m;if(!t||t.length===0)return i;if(this._filterUpToDate)return r;let _=!0;for(let E=0;E<t.length;E++)if(typeof t[E]=="string"&&wy(),typeof t[E]!="string"||!wy()){_=!1;break}const C=i.pixelRatio;if(r.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio),_){const E=t.join(" ");return o.save(),o.setAttr("filter",E),o.drawImage(i._canvas,0,0,i.getWidth()/C,i.getHeight()/C),o.restore(),this._filterUpToDate=!0,r}try{for(f=t.length,o.clear(),o.drawImage(i._canvas,0,0,i.getWidth()/C,i.getHeight()/C),h=o.getImageData(0,0,r.getWidth(),r.getHeight()),g=0;g<f;g++)m=t[g],typeof m=="string"&&(m=W3(m)),m.call(this,h),o.putImageData(h,0,0)}catch(E){mt.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,n){if(this._cache&&this._cache.delete(Q0),arguments.length===3)return this._delegate.apply(this,arguments);const i=t.split(gg);for(let r=0;r<i.length;r++){const f=i[r].split("."),h=f[0],g=f[1]||"";this.eventListeners[h]||(this.eventListeners[h]=[]),this.eventListeners[h].push({name:g,handler:n})}return this}off(t,n){let i=(t||"").split(gg),r=i.length,o,f,h,g,m,_;if(this._cache&&this._cache.delete(Q0),!t)for(f in this.eventListeners)this._off(f);for(o=0;o<r;o++)if(h=i[o],g=h.split("."),m=g[0],_=g[1],m)this.eventListeners[m]&&this._off(m,_,n);else for(f in this.eventListeners)this._off(f,_,n);return this}dispatchEvent(t){const n={target:this,type:t.type,evt:t};return this.fire(t.type,n),this}addEventListener(t,n){return this.on(t,function(i){n.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,n,i){const r=this;this.on(t,function(o){const f=o.target.findAncestors(n,!0,r);for(let h=0;h<f.length;h++)o=mt.cloneObject(o),o.currentTarget=f[h],i.call(f[h],o)})}remove(){return this.isDragging()&&this.stopDrag(),fn._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(dl),this._clearSelfAndDescendantCache(dg),this._clearSelfAndDescendantCache(My),this._clearSelfAndDescendantCache(Dy),this._clearSelfAndDescendantCache(Am),this._clearSelfAndDescendantCache(Tm)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const n="get"+mt._capitalize(t);return mt._isFunction(this[n])?this[n]():this.attrs[t]}getAncestors(){let t=this.getParent(),n=[];for(;t;)n.push(t),t=t.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let n,i;if(!t)return this;for(n in t)n!==t5&&(i=Ny+mt._capitalize(n),mt._isFunction(this[i])?this[i](t[n]):this._setAttr(n,t[n]))}),this}isListening(){return this._getCache(Tm,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(Am,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,n=!1){if(t)return this._isVisible(t)&&this._isListening(t);const i=this.getLayer();let r=!1;fn._dragElements.forEach(f=>{f.dragStatus==="dragging"&&(f.node.nodeType==="Stage"||f.node.getLayer()===i)&&(r=!0)});const o=!n&&!Ft.hitOnDragEnabled&&(r||Ft.isTransforming());return this.isListening()&&this.isVisible()&&!o}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),n=this,i=0,r,o,f,h;function g(_){for(r=[],o=_.length,f=0;f<o;f++)h=_[f],i++,h.nodeType!==jy&&(r=r.concat(h.getChildren().slice())),h._id===n._id&&(f=o);r.length>0&&r[0].getDepth()<=t&&g(r)}const m=this.getStage();return n.nodeType!==o5&&m&&g(m.getChildren()),i}getDepth(){let t=0,n=this.parent;for(;n;)t++,n=n.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ro),this._clearSelfAndDescendantCache(dl)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const n=t.getPointerPosition();if(!n)return null;const i=this.getAbsoluteTransform().copy();return i.invert(),i.point(n)}getAbsolutePosition(t){let n=!1,i=this.parent;for(;i;){if(i.isCached()){n=!0;break}i=i.parent}n&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),o=new Ia,f=this.offset();return o.m=r.slice(),o.translate(f.x,f.y),o.getTranslation()}setAbsolutePosition(t){const{x:n,y:i,...r}=this._clearTransform();this.attrs.x=n,this.attrs.y=i,this._clearCache(ro);const o=this._getAbsoluteTransform().copy();return o.invert(),o.translate(t.x,t.y),t={x:this.attrs.x+o.getTranslation().x,y:this.attrs.y+o.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(ro),this._clearSelfAndDescendantCache(dl),this}_setTransform(t){let n;for(n in t)this.attrs[n]=t[n]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let n=t.x,i=t.y,r=this.x(),o=this.y();return n!==void 0&&(r+=n),i!==void 0&&(o+=i),this.setPosition({x:r,y:o}),this}_eachAncestorReverse(t,n){let i=[],r=this.getParent(),o,f;if(!(n&&n._id===this._id)){for(i.unshift(this);r&&(!n||r._id!==n._id);)i.unshift(r),r=r.parent;for(o=i.length,f=0;f<o;f++)t(i[f])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return mt.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return mt.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return mt.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return mt.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return mt.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&mt.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(dg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(t*=n.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),n,i,r,o,f;const h={attrs:{},className:this.getClassName()};for(n in t)i=t[n],f=mt.isObject(i)&&!mt._isPlainObject(i)&&!mt._isArray(i),!f&&(r=typeof this[n]=="function"&&this[n],delete t[n],o=r?r.call(this):null,t[n]=i,o!==i&&(h.attrs[n]=i));return mt._prepareToStringify(h)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,n,i){const r=[];n&&this._isMatch(t)&&r.push(this);let o=this.parent;for(;o;){if(o===i)return r;o._isMatch(t)&&r.push(o),o=o.parent}return r}isAncestorOf(t){return!1}findAncestor(t,n,i){return this.findAncestors(t,n,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let n=t.replace(/ /g,"").split(","),i=n.length,r,o;for(r=0;r<i;r++)if(o=n[r],mt.isValidSelector(o)||(mt.warn('Selector "'+o+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),mt.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),mt.warn("Konva is awesome, right?")),o.charAt(0)==="#"){if(this.id()===o.slice(1))return!0}else if(o.charAt(0)==="."){if(this.hasName(o.slice(1)))return!0}else if(this.className===o||this.nodeType===o)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(Dy,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,n={},i){return n.target=n.target||this,i?this._fireAndBubble(t,n):this._fire(t,n),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(dl,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let n;if(t)return n=new Ia,this._eachAncestorReverse(function(i){const r=i.transformsEnabled();r==="all"?n.multiply(i.getTransform()):r==="position"&&n.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},t),n;{n=this._cache.get(dl)||new Ia,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const i=this.transformsEnabled();if(i==="all")n.multiply(this.getTransform());else if(i==="position"){const r=this.attrs.x||0,o=this.attrs.y||0,f=this.attrs.offsetX||0,h=this.attrs.offsetY||0;n.translate(r-f,o-h)}return n.dirty=!1,n}}getAbsoluteScale(t){let n=this;for(;n;)n._isUnderCache&&(t=n),n=n.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ro,this._getTransform)}_getTransform(){var t,n;const i=this._cache.get(ro)||new Ia;i.reset();const r=this.x(),o=this.y(),f=Ft.getAngle(this.rotation()),h=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,_=this.attrs.skewY||0,C=this.attrs.offsetX||0,E=this.attrs.offsetY||0;return(r!==0||o!==0)&&i.translate(r,o),f!==0&&i.rotate(f),(m!==0||_!==0)&&i.skew(m,_),(h!==1||g!==1)&&i.scale(h,g),(C!==0||E!==0)&&i.translate(-1*C,-1*E),i.dirty=!1,i}clone(t){let n=mt.cloneObject(this.attrs),i,r,o,f,h;for(i in t)n[i]=t[i];const g=new this.constructor(n);for(i in this.eventListeners)for(r=this.eventListeners[i],o=r.length,f=0;f<o;f++)h=r[f],h.name.indexOf(e5)<0&&(g.eventListeners[i]||(g.eventListeners[i]=[]),g.eventListeners[i].push(h));return g}_toKonvaCanvas(t){t=t||{};const n=this.getClientRect(),i=this.getStage(),r=t.x!==void 0?t.x:Math.floor(n.x),o=t.y!==void 0?t.y:Math.floor(n.y),f=t.pixelRatio||1,h=new oo({width:t.width||Math.ceil(n.width)||(i?i.width():0),height:t.height||Math.ceil(n.height)||(i?i.height():0),pixelRatio:f}),g=h.getContext(),m=new oo({width:h.width/h.pixelRatio+Math.abs(r),height:h.height/h.pixelRatio+Math.abs(o),pixelRatio:h.pixelRatio});return t.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(r||o)&&g.translate(-1*r,-1*o),this.drawScene(h,void 0,m),g.restore(),h}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const n=t.mimeType||null,i=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(n,i);return t.callback&&t.callback(r),r}toImage(t){return new Promise((n,i)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,mt._urlToImage(this.toDataURL(t),function(o){n(o),r==null||r(o)})}catch(r){i(r)}})}toBlob(t){return new Promise((n,i)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(o=>{n(o),r==null||r(o)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(r){i(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Ft.dragDistance}_off(t,n,i){let r=this.eventListeners[t],o,f,h;for(o=0;o<r.length;o++)if(f=r[o].name,h=r[o].handler,(f!=="konva"||n==="konva")&&(!n||f===n)&&(!i||i===h)){if(r.splice(o,1),r.length===0){delete this.eventListeners[t];break}o--}}_fireChangeEvent(t,n,i){this._fire(t+$3,{oldVal:n,newVal:i})}addName(t){if(!this.hasName(t)){const n=this.name(),i=n?n+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const n=(this.name()||"").split(/\s/g),i=n.indexOf(t);return i!==-1&&(n.splice(i,1),this.name(n.join(" "))),this}setAttr(t,n){const i=this[Ny+mt._capitalize(t)];return mt._isFunction(i)?i.call(this,n):this._setAttr(t,n),this}_requestDraw(){if(Ft.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,n){const i=this.attrs[t];i===n&&!mt.isObject(n)||(n==null?delete this.attrs[t]:this.attrs[t]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,n),this._requestDraw())}_setComponentAttr(t,n,i){let r;i!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][n]=i,this._fireChangeEvent(t,r,i))}_fireAndBubble(t,n,i){n&&this.nodeType===jy&&(n.target=this);const r=[n5,i5,a5,r5,s5,l5];if(!(r.indexOf(t)!==-1&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i))){this._fire(t,n);const f=r.indexOf(t)!==-1&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!f&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,n,i):this._fireAndBubble.call(this.parent,t,n))}}_getProtoListeners(t){var n,i,r;const o=(n=this._cache.get(Q0))!==null&&n!==void 0?n:{};let f=o==null?void 0:o[t];if(f===void 0){f=[];let h=Object.getPrototypeOf(this);for(;h;){const g=(r=(i=h.eventListeners)===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:[];f.push(...g),h=Object.getPrototypeOf(h)}o[t]=f,this._cache.set(Q0,o)}return f}_fire(t,n){n=n||{},n.currentTarget=this,n.type=t;const i=this._getProtoListeners(t);if(i)for(let o=0;o<i.length;o++)i[o].handler.call(this,n);const r=this.eventListeners[t];if(r)for(let o=0;o<r.length;o++)r[o].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const n=t?t.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition();if(!i)return;const o=i._getPointerById(n)||i._changedPointerPositions[0]||r;fn._dragElements.set(this._id,{node:this,startPointerPos:o,offset:{x:o.x-r.x,y:o.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(t,n=!0){fn._dragElements.has(this._id)||this._createDragElement(t);const i=fn._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},n)}_setDragPosition(t,n){const i=this.getStage()._getPointerById(n.pointerId);if(!i)return;let r={x:i.x-n.offset.x,y:i.y-n.offset.y};const o=this.dragBoundFunc();if(o!==void 0){const f=o.call(this,r,t);f?r=f:mt.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const n=fn._dragElements.get(this._id);n&&(n.dragStatus="stopped"),fn._endDragBefore(t),fn._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=fn._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Ft.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;fn._dragElements.forEach(o=>{this.isAncestorOf(o.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=fn._dragElements.get(this._id),i=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";i?this.stopDrag():r&&fn._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const n=this.getStage();if(!n)return!1;const i={x:-t.x,y:-t.y,width:n.width()+2*t.x,height:n.height()+2*t.y};return mt.haveIntersection(i,this.getClientRect())}static create(t,n){return mt._isString(t)&&(t=JSON.parse(t)),this._createNode(t,n)}static _createNode(t,n){let i=kt.prototype.getClassName.call(t),r=t.children,o,f,h;n&&(t.attrs.container=n),Ft[i]||(mt.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const g=Ft[i];if(o=new g(t.attrs),r)for(f=r.length,h=0;h<f;h++)o.add(kt._createNode(r[h]));return o}}kt.prototype.nodeType="Node";kt.prototype._attrsAffectingSize=[];kt.prototype.eventListeners={};kt.prototype.on.call(kt.prototype,u5,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ro),this._clearSelfAndDescendantCache(dl)});kt.prototype.on.call(kt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Am)});kt.prototype.on.call(kt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Tm)});kt.prototype.on.call(kt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(dg)});const On=lt.addGetterSetter;On(kt,"zIndex");On(kt,"absolutePosition");On(kt,"position");On(kt,"x",0,Vt());On(kt,"y",0,Vt());On(kt,"globalCompositeOperation","source-over",bu());On(kt,"opacity",1,Vt());On(kt,"name","",bu());On(kt,"id","",bu());On(kt,"rotation",0,Vt());lt.addComponentsGetterSetter(kt,"scale",["x","y"]);On(kt,"scaleX",1,Vt());On(kt,"scaleY",1,Vt());lt.addComponentsGetterSetter(kt,"skew",["x","y"]);On(kt,"skewX",0,Vt());On(kt,"skewY",0,Vt());lt.addComponentsGetterSetter(kt,"offset",["x","y"]);On(kt,"offsetX",0,Vt());On(kt,"offsetY",0,Vt());On(kt,"dragDistance",void 0,Vt());On(kt,"width",0,Vt());On(kt,"height",0,Vt());On(kt,"listening",!0,Kr());On(kt,"preventDefault",!0,Kr());On(kt,"filters",void 0,function(l){return this._filterUpToDate=!1,l});On(kt,"visible",!0,Kr());On(kt,"transformsEnabled","all",bu());On(kt,"size");On(kt,"dragBoundFunc");On(kt,"draggable",!1,Kr());lt.backCompat(kt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Va extends kt{constructor(){super(...arguments),this.children=[]}getChildren(t){const n=this.children||[];return t?n.filter(t):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let i=0;i<t.length;i++)this.add(t[i]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const n=this._generalFind(t,!0);return n.length>0?n[0]:void 0}_generalFind(t,n){const i=[];return this._descendants(r=>{const o=r._isMatch(t);return o&&i.push(r),!!(o&&n)}),i}_descendants(t){let n=!1;const i=this.getChildren();for(const r of i){if(n=t(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(t),n))return!0}return!1}toObject(){const t=kt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(n=>{t.children.push(n.toObject())}),t}isAncestorOf(t){let n=t.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(t){const n=kt.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){n.add(i.clone())}),n}getAllIntersections(t){const n=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&n.push(i)}),n}_clearSelfAndDescendantCache(t){var n;super._clearSelfAndDescendantCache(t),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(n,i){n.index=i}),this._requestDraw()}drawScene(t,n,i){const r=this.getLayer(),o=t||r&&r.getCanvas(),f=o&&o.getContext(),h=this._getCanvasCache(),g=h&&h.scene,m=o&&o.isCache;if(!this.isVisible()&&!m)return this;if(g){f.save();const _=this.getAbsoluteTransform(n).getMatrix();f.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",o,n,i);return this}drawHit(t,n){if(!this.shouldDrawHit(n))return this;const i=this.getLayer(),r=t||i&&i.hitCanvas,o=r&&r.getContext(),f=this._getCanvasCache();if(f&&f.hit){o.save();const g=this.getAbsoluteTransform(n).getMatrix();o.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(o),o.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(t,n,i,r){var o;const f=n&&n.getContext(),h=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),_=typeof h=="number"&&typeof g=="number"||m,C=i===this;if(_){f.save();const R=this.getAbsoluteTransform(i);let v=R.getMatrix();f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),f.beginPath();let N;if(m)N=m.call(this,f,this);else{const B=this.clipX(),L=this.clipY();f.rect(B||0,L||0,h,g)}f.clip.apply(f,N),v=R.copy().invert().getMatrix(),f.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const E=!C&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(f.save(),f._applyGlobalCompositeOperation(this)),(o=this.children)===null||o===void 0||o.forEach(function(R){R[t](n,i,r)}),E&&f.restore(),_&&f.restore()}getClientRect(t={}){var n;const i=t.skipTransform,r=t.relativeTo;let o,f,h,g,m={x:1/0,y:1/0,width:0,height:0};const _=this;(n=this.children)===null||n===void 0||n.forEach(function(R){if(!R.visible())return;const v=R.getClientRect({relativeTo:_,skipShadow:t.skipShadow,skipStroke:t.skipStroke});v.width===0&&v.height===0||(o===void 0?(o=v.x,f=v.y,h=v.x+v.width,g=v.y+v.height):(o=Math.min(o,v.x),f=Math.min(f,v.y),h=Math.max(h,v.x+v.width),g=Math.max(g,v.y+v.height)))});const C=this.find("Shape");let E=!1;for(let R=0;R<C.length;R++)if(C[R]._isVisible(this)){E=!0;break}return E&&o!==void 0?m={x:o,y:f,width:h-o,height:g-f}:m={x:0,y:0,width:0,height:0},i?m:this._transformedRect(m,r)}}lt.addComponentsGetterSetter(Va,"clip",["x","y","width","height"]);lt.addGetterSetter(Va,"clipX",void 0,Vt());lt.addGetterSetter(Va,"clipY",void 0,Vt());lt.addGetterSetter(Va,"clipWidth",void 0,Vt());lt.addGetterSetter(Va,"clipHeight",void 0,Vt());lt.addGetterSetter(Va,"clipFunc");const dd=new Map,B2=Ft._global.PointerEvent!==void 0;function Ap(l){return dd.get(l)}function $m(l){return{evt:l,pointerId:l.pointerId}}function z2(l,t){return dd.get(l)===t}function L2(l,t){ad(l),t.getStage()&&(dd.set(l,t),B2&&t._fire("gotpointercapture",$m(new PointerEvent("gotpointercapture"))))}function ad(l,t){const n=dd.get(l);if(!n)return;const i=n.getStage();i&&i.content,dd.delete(l),B2&&n._fire("lostpointercapture",$m(new PointerEvent("lostpointercapture")))}const f5="Stage",h5="string",Uy="px",d5="mouseout",G2="mouseleave",P2="mouseover",H2="mouseenter",I2="mousemove",k2="mousedown",q2="mouseup",Wh="pointermove",$h="pointerdown",uf="pointerup",td="pointercancel",g5="lostpointercapture",X0="pointerout",ed="pointerleave",F0="pointerover",J0="pointerenter",wm="contextmenu",V2="touchstart",Y2="touchend",K2="touchmove",Q2="touchcancel",Rm="wheel",p5=5,m5=[[H2,"_pointerenter"],[k2,"_pointerdown"],[I2,"_pointermove"],[q2,"_pointerup"],[G2,"_pointerleave"],[V2,"_pointerdown"],[K2,"_pointermove"],[Y2,"_pointerup"],[Q2,"_pointercancel"],[P2,"_pointerover"],[Rm,"_wheel"],[wm,"_contextmenu"],[$h,"_pointerdown"],[Wh,"_pointermove"],[uf,"_pointerup"],[td,"_pointercancel"],[ed,"_pointerleave"],[g5,"_lostpointercapture"]],wp={mouse:{[X0]:d5,[ed]:G2,[F0]:P2,[J0]:H2,[Wh]:I2,[$h]:k2,[uf]:q2,[td]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[X0]:"touchout",[ed]:"touchleave",[F0]:"touchover",[J0]:"touchenter",[Wh]:K2,[$h]:V2,[uf]:Y2,[td]:Q2,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[X0]:X0,[ed]:ed,[F0]:F0,[J0]:J0,[Wh]:Wh,[$h]:$h,[uf]:uf,[td]:td,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},nd=l=>l.indexOf("pointer")>=0?"pointer":l.indexOf("touch")>=0?"touch":"mouse",Fc=l=>{const t=nd(l);if(t==="pointer")return Ft.pointerEventsEnabled&&wp.pointer;if(t==="touch")return wp.touch;if(t==="mouse")return wp.mouse};function By(l={}){return(l.clipFunc||l.clipWidth||l.clipHeight)&&mt.warn("Stage does not support clipping. Please use clip for Layers or Groups."),l}const v5="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",rd=[];let Og=class extends Va{constructor(t){super(By(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),rd.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{By(this.attrs)}),this._checkVisibility()}_validateAdd(t){const n=t.getType()==="Layer",i=t.getType()==="FastLayer";n||i||mt.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===h5){let n;if(t.charAt(0)==="."){const i=t.slice(1);t=document.getElementsByClassName(i)[0]}else t.charAt(0)!=="#"?n=t:n=t.slice(1),t=document.getElementById(n);if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,n=t.length;for(let i=0;i<n;i++)t[i].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),Va.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&mt._isInDocument(t)&&this.container().removeChild(t);const n=rd.indexOf(this);return n>-1&&rd.splice(n,1),mt.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(mt.warn(v5),null)}_getPointerById(t){return this._pointerPositions.find(n=>n.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const n=new oo({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=n.getContext()._context,r=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),r.forEach(function(o){if(!o.isVisible())return;const f=o._toKonvaCanvas(t);i.drawImage(f._canvas,t.x,t.y,f.getWidth()/f.getPixelRatio(),f.getHeight()/f.getPixelRatio())}),n}getIntersection(t){if(!t)return null;const n=this.children,i=n.length,r=i-1;for(let o=r;o>=0;o--){const f=n[o].getIntersection(t);if(f)return f}return null}_resizeDOM(){const t=this.width(),n=this.height();this.content&&(this.content.style.width=t+Uy,this.content.style.height=n+Uy),this.bufferCanvas.setSize(t,n),this.bufferHitCanvas.setSize(t,n),this.children.forEach(i=>{i.setSize({width:t,height:n}),i.draw()})}add(t,...n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const i=this.children.length;return i>p5&&mt.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Ft.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return z2(t,this)}setPointerCapture(t){L2(t,this)}releaseCapture(t){ad(t)}getLayers(){return this.children}_bindContentEvents(){Ft.isBrowser&&m5.forEach(([t,n])=>{this.content.addEventListener(t,i=>{this[n](i)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const n=Fc(t.type);n&&this._fire(n.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const n=Fc(t.type);n&&this._fire(n.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let n=this[t+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(t){const n=Fc(t.type),i=nd(t.type);if(!n)return;this.setPointersPositions(t);const r=this._getTargetShape(i),o=!(Ft.isDragging()||Ft.isTransforming())||Ft.hitOnDragEnabled;r&&o?(r._fireAndBubble(n.pointerout,{evt:t}),r._fireAndBubble(n.pointerleave,{evt:t}),this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):o&&(this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const n=Fc(t.type),i=nd(t.type);if(!n)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(o=>{const f=this.getIntersection(o);if(fn.justDragged=!1,Ft["_"+i+"ListenClick"]=!0,!f||!f.isListening()){this[i+"ClickStartShape"]=void 0;return}Ft.capturePointerEventsEnabled&&f.setPointerCapture(o.id),this[i+"ClickStartShape"]=f,f._fireAndBubble(n.pointerdown,{evt:t,pointerId:o.id}),r=!0;const h=t.type.indexOf("touch")>=0;f.preventDefault()&&t.cancelable&&h&&t.preventDefault()}),r||this._fire(n.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const n=Fc(t.type),i=nd(t.type);if(!n)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(Ft.isDragging()&&fn.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(Ft.isDragging()||Ft.isTransforming())||Ft.hitOnDragEnabled))return;const f={};let h=!1;const g=this._getTargetShape(i);this._changedPointerPositions.forEach(m=>{const _=Ap(m.id)||this.getIntersection(m),C=m.id,E={evt:t,pointerId:C},R=g!==_;if(R&&g&&(g._fireAndBubble(n.pointerout,{...E},_),g._fireAndBubble(n.pointerleave,{...E},_)),_){if(f[_._id])return;f[_._id]=!0}_&&_.isListening()?(h=!0,R&&(_._fireAndBubble(n.pointerover,{...E},g),_._fireAndBubble(n.pointerenter,{...E},g),this[i+"targetShape"]=_),_._fireAndBubble(n.pointermove,{...E})):g&&(this._fire(n.pointerover,{evt:t,target:this,currentTarget:this,pointerId:C}),this[i+"targetShape"]=null)}),h||this._fire(n.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const n=Fc(t.type),i=nd(t.type);if(!n)return;this.setPointersPositions(t);const r=this[i+"ClickStartShape"],o=this[i+"ClickEndShape"],f={};let h=!1;this._changedPointerPositions.forEach(g=>{const m=Ap(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),f[m._id])return;f[m._id]=!0}const _=g.id,C={evt:t,pointerId:_};let E=!1;Ft["_"+i+"InDblClickWindow"]?(E=!0,clearTimeout(this[i+"DblTimeout"])):fn.justDragged||(Ft["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){Ft["_"+i+"InDblClickWindow"]=!1},Ft.dblClickWindow),m&&m.isListening()?(h=!0,this[i+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...C}),Ft["_"+i+"ListenClick"]&&r&&r===m&&(m._fireAndBubble(n.pointerclick,{...C}),E&&o&&o===m&&m._fireAndBubble(n.pointerdblclick,{...C}))):(this[i+"ClickEndShape"]=null,h||(this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),h=!0),Ft["_"+i+"ListenClick"]&&this._fire(n.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:_}),E&&this._fire(n.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:_}))}),h||this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Ft["_"+i+"ListenClick"]=!1,t.cancelable&&i!=="touch"&&i!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(wm,{evt:t}):this._fire(wm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Rm,{evt:t}):this._fire(Rm,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const n=Ap(t.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(uf,$m(t)),ad(t.pointerId)}_lostpointercapture(t){ad(t.pointerId)}setPointersPositions(t){const n=this._getContentPosition();let i=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,o=>{this._pointerPositions.push({id:o.identifier,x:(o.clientX-n.left)/n.scaleX,y:(o.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,o=>{this._changedPointerPositions.push({id:o.identifier,x:(o.clientX-n.left)/n.scaleX,y:(o.clientY-n.top)/n.scaleY})})):(i=(t.clientX-n.left)/n.scaleX,r=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:i,y:r},this._pointerPositions=[{x:i,y:r,id:mt._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:r,id:mt._getFirstPointerId(t)}])}_setPointerPosition(t){mt.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new oo({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Zm({pixelRatio:1,width:this.width(),height:this.height()}),!Ft.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return mt.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Og.prototype.nodeType=f5;Xn(Og);lt.addGetterSetter(Og,"container");Ft.isBrowser&&document.addEventListener("visibilitychange",()=>{rd.forEach(l=>{l.batchDraw()})});const X2="hasShadow",F2="shadowRGBA",J2="patternImage",Z2="linearGradient",W2="radialGradient";let Z0;function Rp(){return Z0||(Z0=mt.createCanvasElement().getContext("2d"),Z0)}const sd={};function y5(l){const t=this.attrs.fillRule;t?l.fill(t):l.fill()}function S5(l){l.stroke()}function b5(l){const t=this.attrs.fillRule;t?l.fill(t):l.fill()}function _5(l){l.stroke()}function E5(){this._clearCache(X2)}function C5(){this._clearCache(F2)}function T5(){this._clearCache(J2)}function A5(){this._clearCache(Z2)}function w5(){this._clearCache(W2)}class Gt extends kt{constructor(t){super(t);let n;for(;n=mt.getRandomColor(),!(n&&!(n in sd)););this.colorKey=n,sd[n]=this}getContext(){return mt.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return mt.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(X2,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(J2,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Rp().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const i=new Ia;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(Ft.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=i.getMatrix(),o=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(o)}return n}}_getLinearGradient(){return this._getCache(Z2,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const n=Rp(),i=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),o=n.createLinearGradient(i.x,i.y,r.x,r.y);for(let f=0;f<t.length;f+=2)o.addColorStop(t[f],t[f+1]);return o}}_getRadialGradient(){return this._getCache(W2,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const n=Rp(),i=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),o=n.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let f=0;f<t.length;f+=2)o.addColorStop(t[f],t[f+1]);return o}}getShadowRGBA(){return this._getCache(F2,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=mt.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const n=this.getStage();if(!n)return!1;const i=n.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,void 0,!0),i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return kt.prototype.destroy.call(this),delete sd[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=t||this.hasFill(),o=this.hasStroke(),f=this.getAbsoluteOpacity()!==1;if(r&&o&&f)return!0;const h=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(r&&o&&h&&g)}setStrokeHitEnabled(t){mt.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let n=!1,i=this.getParent();for(;i;){if(i.isCached()){n=!0;break}i=i.getParent()}const r=t.skipTransform,o=t.relativeTo||n&&this.getStage()||void 0,f=this.getSelfRect(),g=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=f.width+g,_=f.height+g,C=!t.skipShadow&&this.hasShadow(),E=C?this.shadowOffsetX():0,R=C?this.shadowOffsetY():0,v=m+Math.abs(E),N=_+Math.abs(R),B=C&&this.shadowBlur()||0,L=v+B*2,j=N+B*2,M={width:L,height:j,x:-(g/2+B)+Math.min(E,0)+f.x,y:-(g/2+B)+Math.min(R,0)+f.y};return r?M:this._transformedRect(M,o)}drawScene(t,n,i){const r=this.getLayer(),o=t||r.getCanvas(),f=o.getContext(),h=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let _;const C=n===this;if(!this.isVisible()&&!C)return this;if(h){f.save();const E=this.getAbsoluteTransform(n).getMatrix();return f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedSceneCanvas(f),f.restore(),this}if(!g)return this;if(f.save(),this._useBufferCanvas()){_=this.getStage();const E=i||_.bufferCanvas,R=E.getContext();R.clear(),R.save(),R._applyLineJoin(this),R._applyMiterLimit(this);const v=this.getAbsoluteTransform(n).getMatrix();R.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.call(this,R,this),R.restore();const N=E.pixelRatio;m&&f._applyShadow(this),f._applyOpacity(this),f._applyGlobalCompositeOperation(this),f.drawImage(E._canvas,E.x||0,E.y||0,E.width/N,E.height/N)}else{if(f._applyLineJoin(this),f._applyMiterLimit(this),!C){const E=this.getAbsoluteTransform(n).getMatrix();f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),f._applyOpacity(this),f._applyGlobalCompositeOperation(this)}m&&f._applyShadow(this),g.call(this,f,this)}return f.restore(),this}drawHit(t,n,i=!1){if(!this.shouldDrawHit(n,i))return this;const r=this.getLayer(),o=t||r.hitCanvas,f=o&&o.getContext(),h=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||mt.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){f.save();const C=this.getAbsoluteTransform(n).getMatrix();return f.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._drawCachedHitCanvas(f),f.restore(),this}if(!h)return this;if(f.save(),f._applyLineJoin(this),f._applyMiterLimit(this),!(this===n)){const C=this.getAbsoluteTransform(n).getMatrix();f.transform(C[0],C[1],C[2],C[3],C[4],C[5])}return h.call(this,f,this),f.restore(),this}drawHitFromCache(t=0){const n=this._getCanvasCache(),i=this._getCachedSceneCanvas(),r=n.hit,o=r.getContext(),f=r.getWidth(),h=r.getHeight();o.clear(),o.drawImage(i._canvas,0,0,f,h);try{const g=o.getImageData(0,0,f,h),m=g.data,_=m.length,C=mt._hexToRgb(this.colorKey);for(let E=0;E<_;E+=4)m[E+3]>t?(m[E]=C.r,m[E+1]=C.g,m[E+2]=C.b,m[E+3]=255):m[E+3]=0;o.putImageData(g,0,0)}catch(g){mt.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return z2(t,this)}setPointerCapture(t){L2(t,this)}releaseCapture(t){ad(t)}}Gt.prototype._fillFunc=y5;Gt.prototype._strokeFunc=S5;Gt.prototype._fillFuncHit=b5;Gt.prototype._strokeFuncHit=_5;Gt.prototype._centroid=!1;Gt.prototype.nodeType="Shape";Xn(Gt);Gt.prototype.eventListeners={};Gt.prototype.on.call(Gt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",E5);Gt.prototype.on.call(Gt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",C5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",T5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",A5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",w5);lt.addGetterSetter(Gt,"stroke",void 0,U2());lt.addGetterSetter(Gt,"strokeWidth",2,Vt());lt.addGetterSetter(Gt,"fillAfterStrokeEnabled",!1);lt.addGetterSetter(Gt,"hitStrokeWidth","auto",Wm());lt.addGetterSetter(Gt,"strokeHitEnabled",!0,Kr());lt.addGetterSetter(Gt,"perfectDrawEnabled",!0,Kr());lt.addGetterSetter(Gt,"shadowForStrokeEnabled",!0,Kr());lt.addGetterSetter(Gt,"lineJoin");lt.addGetterSetter(Gt,"lineCap");lt.addGetterSetter(Gt,"miterLimit");lt.addGetterSetter(Gt,"sceneFunc");lt.addGetterSetter(Gt,"hitFunc");lt.addGetterSetter(Gt,"dash");lt.addGetterSetter(Gt,"dashOffset",0,Vt());lt.addGetterSetter(Gt,"shadowColor",void 0,bu());lt.addGetterSetter(Gt,"shadowBlur",0,Vt());lt.addGetterSetter(Gt,"shadowOpacity",1,Vt());lt.addComponentsGetterSetter(Gt,"shadowOffset",["x","y"]);lt.addGetterSetter(Gt,"shadowOffsetX",0,Vt());lt.addGetterSetter(Gt,"shadowOffsetY",0,Vt());lt.addGetterSetter(Gt,"fillPatternImage");lt.addGetterSetter(Gt,"fill",void 0,U2());lt.addGetterSetter(Gt,"fillPatternX",0,Vt());lt.addGetterSetter(Gt,"fillPatternY",0,Vt());lt.addGetterSetter(Gt,"fillLinearGradientColorStops");lt.addGetterSetter(Gt,"strokeLinearGradientColorStops");lt.addGetterSetter(Gt,"fillRadialGradientStartRadius",0);lt.addGetterSetter(Gt,"fillRadialGradientEndRadius",0);lt.addGetterSetter(Gt,"fillRadialGradientColorStops");lt.addGetterSetter(Gt,"fillPatternRepeat","repeat");lt.addGetterSetter(Gt,"fillEnabled",!0);lt.addGetterSetter(Gt,"strokeEnabled",!0);lt.addGetterSetter(Gt,"shadowEnabled",!0);lt.addGetterSetter(Gt,"dashEnabled",!0);lt.addGetterSetter(Gt,"strokeScaleEnabled",!0);lt.addGetterSetter(Gt,"fillPriority","color");lt.addComponentsGetterSetter(Gt,"fillPatternOffset",["x","y"]);lt.addGetterSetter(Gt,"fillPatternOffsetX",0,Vt());lt.addGetterSetter(Gt,"fillPatternOffsetY",0,Vt());lt.addComponentsGetterSetter(Gt,"fillPatternScale",["x","y"]);lt.addGetterSetter(Gt,"fillPatternScaleX",1,Vt());lt.addGetterSetter(Gt,"fillPatternScaleY",1,Vt());lt.addComponentsGetterSetter(Gt,"fillLinearGradientStartPoint",["x","y"]);lt.addComponentsGetterSetter(Gt,"strokeLinearGradientStartPoint",["x","y"]);lt.addGetterSetter(Gt,"fillLinearGradientStartPointX",0);lt.addGetterSetter(Gt,"strokeLinearGradientStartPointX",0);lt.addGetterSetter(Gt,"fillLinearGradientStartPointY",0);lt.addGetterSetter(Gt,"strokeLinearGradientStartPointY",0);lt.addComponentsGetterSetter(Gt,"fillLinearGradientEndPoint",["x","y"]);lt.addComponentsGetterSetter(Gt,"strokeLinearGradientEndPoint",["x","y"]);lt.addGetterSetter(Gt,"fillLinearGradientEndPointX",0);lt.addGetterSetter(Gt,"strokeLinearGradientEndPointX",0);lt.addGetterSetter(Gt,"fillLinearGradientEndPointY",0);lt.addGetterSetter(Gt,"strokeLinearGradientEndPointY",0);lt.addComponentsGetterSetter(Gt,"fillRadialGradientStartPoint",["x","y"]);lt.addGetterSetter(Gt,"fillRadialGradientStartPointX",0);lt.addGetterSetter(Gt,"fillRadialGradientStartPointY",0);lt.addComponentsGetterSetter(Gt,"fillRadialGradientEndPoint",["x","y"]);lt.addGetterSetter(Gt,"fillRadialGradientEndPointX",0);lt.addGetterSetter(Gt,"fillRadialGradientEndPointY",0);lt.addGetterSetter(Gt,"fillPatternRotation",0);lt.addGetterSetter(Gt,"fillRule",void 0,bu());lt.backCompat(Gt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const R5="#",O5="beforeDraw",x5="draw",$2=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],M5=$2.length;let _u=class extends Va{constructor(t){super(t),this.canvas=new oo,this.hitCanvas=new Zm({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),t<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[t+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){kt.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!kt.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(kt.prototype.moveDown.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(kt.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return kt.prototype.remove.call(this),t&&t.parentNode&&mt._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:n}){return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&mt.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),kt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){mt.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){mt.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,mt.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let n=1,i=!1;for(;;){for(let r=0;r<M5;r++){const o=$2[r],f=this._getIntersection({x:t.x+o.x*n,y:t.y+o.y*n}),h=f.shape;if(h)return h;if(i=!!f.antialiased,!f.antialiased)break}if(i)n+=1;else return null}}_getIntersection(t){const n=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*n),Math.round(t.y*n),1,1).data,r=i[3];if(r===255){const o=mt._rgbToHex(i[0],i[1],i[2]),f=sd[R5+o];return f?{shape:f}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,n,i){const r=this.getLayer(),o=t||r&&r.getCanvas();return this._fire(O5,{node:this}),this.clearBeforeDraw()&&o.getContext().clear(),Va.prototype.drawScene.call(this,o,n,i),this._fire(x5,{node:this}),this}drawHit(t,n){const i=this.getLayer(),r=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),Va.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){mt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return mt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return mt.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};_u.prototype.nodeType="Layer";Xn(_u);lt.addGetterSetter(_u,"imageSmoothingEnabled",!0);lt.addGetterSetter(_u,"clearBeforeDraw",!0);lt.addGetterSetter(_u,"hitGraphEnabled",!0,Kr());class tv extends _u{constructor(t){super(t),this.listening(!1),mt.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}tv.prototype.nodeType="FastLayer";Xn(tv);class ff extends Va{_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&mt.throw("You may only add groups and shapes to groups.")}}ff.prototype.nodeType="Group";Xn(ff);const Op=(function(){return vu.performance&&vu.performance.now?function(){return vu.performance.now()}:function(){return new Date().getTime()}})();class vr{constructor(t,n){this.id=vr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Op(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(t){let n=[];return t&&(n=Array.isArray(t)?t:[t]),this.layers=n,this}getLayers(){return this.layers}addLayer(t){const n=this.layers,i=n.length;for(let r=0;r<i;r++)if(n[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const n=vr.animations,i=n.length;for(let r=0;r<i;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Op(),vr._addAnimation(this),this}stop(){return vr._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const n=t.id,i=this.animations,r=i.length;for(let o=0;o<r;o++)if(i[o].id===n){this.animations.splice(o,1);break}}static _runFrames(){const t={},n=this.animations;for(let i=0;i<n.length;i++){const r=n[i],o=r.layers,f=r.func;r._updateFrameObject(Op());const h=o.length;let g;if(f?g=f.call(r,r.frame)!==!1:g=!0,!!g)for(let m=0;m<h;m++){const _=o[m];_._id!==void 0&&(t[_._id]=_)}}for(const i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=vr;t.animations.length?(t._runFrames(),mt.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,mt.requestAnimFrame(this._animationLoop))}}vr.animations=[];vr.animIdCounter=0;vr.animRunning=!1;const N5={node:1,duration:1,easing:1,onFinish:1,yoyo:1},j5=1,zy=2,Ly=3,Gy=["fill","stroke","shadowColor"];let D5=0;class U5{constructor(t,n,i,r,o,f,h){this.prop=t,this.propFunc=n,this.begin=r,this._pos=r,this.duration=f,this._change=0,this.prevPos=0,this.yoyo=h,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=o-this.begin,this.pause()}fire(t){const n=this[t];n&&n()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=zy,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Ly,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===zy?this.setTime(t):this.state===Ly&&this.setTime(this.duration-t)}pause(){this.state=j5,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Dn{constructor(t){const n=this,i=t.node,r=i._id,o=t.easing||ld.Linear,f=!!t.yoyo;let h,g;typeof t.duration>"u"?h=.3:t.duration===0?h=.001:h=t.duration,this.node=i,this._id=D5++;const m=i.getLayer()||(i instanceof Ft.Stage?i.getLayers():null);m||mt.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new vr(function(){n.tween.onEnterFrame()},m),this.tween=new U5(g,function(_){n._tweenFunc(_)},o,0,1,h*1e3,f),this._addListeners(),Dn.attrs[r]||(Dn.attrs[r]={}),Dn.attrs[r][this._id]||(Dn.attrs[r][this._id]={}),Dn.tweens[r]||(Dn.tweens[r]={});for(g in t)N5[g]===void 0&&this._addAttr(g,t[g]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,n){const i=this.node,r=i._id;let o,f,h,g,m;const _=Dn.tweens[r][t];_&&delete Dn.attrs[r][_][t];let C=i.getAttr(t);if(mt._isArray(n))if(o=[],f=Math.max(n.length,C.length),t==="points"&&n.length!==C.length&&(n.length>C.length?(g=C,C=mt._prepareArrayForTween(C,n,i.closed())):(h=n,n=mt._prepareArrayForTween(n,C,i.closed()))),t.indexOf("fill")===0)for(let E=0;E<f;E++)if(E%2===0)o.push(n[E]-C[E]);else{const R=mt.colorToRGBA(C[E]);m=mt.colorToRGBA(n[E]),C[E]=R,o.push({r:m.r-R.r,g:m.g-R.g,b:m.b-R.b,a:m.a-R.a})}else for(let E=0;E<f;E++)o.push(n[E]-C[E]);else Gy.indexOf(t)!==-1?(C=mt.colorToRGBA(C),m=mt.colorToRGBA(n),o={r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a}):o=n-C;Dn.attrs[r][this._id][t]={start:C,diff:o,end:n,trueEnd:h,trueStart:g},Dn.tweens[r][t]=this._id}_tweenFunc(t){const n=this.node,i=Dn.attrs[n._id][this._id];let r,o,f,h,g,m,_,C;for(r in i){if(o=i[r],f=o.start,h=o.diff,C=o.end,mt._isArray(f))if(g=[],_=Math.max(f.length,C.length),r.indexOf("fill")===0)for(m=0;m<_;m++)m%2===0?g.push((f[m]||0)+h[m]*t):g.push("rgba("+Math.round(f[m].r+h[m].r*t)+","+Math.round(f[m].g+h[m].g*t)+","+Math.round(f[m].b+h[m].b*t)+","+(f[m].a+h[m].a*t)+")");else for(m=0;m<_;m++)g.push((f[m]||0)+h[m]*t);else Gy.indexOf(r)!==-1?g="rgba("+Math.round(f.r+h.r*t)+","+Math.round(f.g+h.g*t)+","+Math.round(f.b+h.b*t)+","+(f.a+h.a*t)+")":g=f+h*t;n.setAttr(r,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,n=Dn.attrs[t._id][this._id];n.points&&n.points.trueEnd&&t.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,n=Dn.attrs[t._id][this._id];n.points&&n.points.trueStart&&t.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,n=this._id,i=Dn.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in i)delete Dn.tweens[t][r];delete Dn.attrs[t][n],Dn.tweens[t]&&(Object.keys(Dn.tweens[t]).length===0&&delete Dn.tweens[t],Object.keys(Dn.attrs[t]).length===0&&delete Dn.attrs[t])}}Dn.attrs={};Dn.tweens={};kt.prototype.to=function(l){const t=l.onFinish;l.node=this,l.onFinish=function(){this.destroy(),t&&t()},new Dn(l).play()};const ld={BackEaseIn(l,t,n,i){return n*(l/=i)*l*((1.70158+1)*l-1.70158)+t},BackEaseOut(l,t,n,i){return n*((l=l/i-1)*l*((1.70158+1)*l+1.70158)+1)+t},BackEaseInOut(l,t,n,i){let r=1.70158;return(l/=i/2)<1?n/2*(l*l*(((r*=1.525)+1)*l-r))+t:n/2*((l-=2)*l*(((r*=1.525)+1)*l+r)+2)+t},ElasticEaseIn(l,t,n,i,r,o){let f=0;return l===0?t:(l/=i)===1?t+n:(o||(o=i*.3),!r||r<Math.abs(n)?(r=n,f=o/4):f=o/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(l-=1))*Math.sin((l*i-f)*(2*Math.PI)/o))+t)},ElasticEaseOut(l,t,n,i,r,o){let f=0;return l===0?t:(l/=i)===1?t+n:(o||(o=i*.3),!r||r<Math.abs(n)?(r=n,f=o/4):f=o/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*l)*Math.sin((l*i-f)*(2*Math.PI)/o)+n+t)},ElasticEaseInOut(l,t,n,i,r,o){let f=0;return l===0?t:(l/=i/2)===2?t+n:(o||(o=i*(.3*1.5)),!r||r<Math.abs(n)?(r=n,f=o/4):f=o/(2*Math.PI)*Math.asin(n/r),l<1?-.5*(r*Math.pow(2,10*(l-=1))*Math.sin((l*i-f)*(2*Math.PI)/o))+t:r*Math.pow(2,-10*(l-=1))*Math.sin((l*i-f)*(2*Math.PI)/o)*.5+n+t)},BounceEaseOut(l,t,n,i){return(l/=i)<1/2.75?n*(7.5625*l*l)+t:l<2/2.75?n*(7.5625*(l-=1.5/2.75)*l+.75)+t:l<2.5/2.75?n*(7.5625*(l-=2.25/2.75)*l+.9375)+t:n*(7.5625*(l-=2.625/2.75)*l+.984375)+t},BounceEaseIn(l,t,n,i){return n-ld.BounceEaseOut(i-l,0,n,i)+t},BounceEaseInOut(l,t,n,i){return l<i/2?ld.BounceEaseIn(l*2,0,n,i)*.5+t:ld.BounceEaseOut(l*2-i,0,n,i)*.5+n*.5+t},EaseIn(l,t,n,i){return n*(l/=i)*l+t},EaseOut(l,t,n,i){return-n*(l/=i)*(l-2)+t},EaseInOut(l,t,n,i){return(l/=i/2)<1?n/2*l*l+t:-n/2*(--l*(l-2)-1)+t},StrongEaseIn(l,t,n,i){return n*(l/=i)*l*l*l*l+t},StrongEaseOut(l,t,n,i){return n*((l=l/i-1)*l*l*l*l+1)+t},StrongEaseInOut(l,t,n,i){return(l/=i/2)<1?n/2*l*l*l*l*l+t:n/2*((l-=2)*l*l*l*l+2)+t},Linear(l,t,n,i){return n*l/i+t}},hf=mt._assign(Ft,{Util:mt,Transform:Ia,Node:kt,Container:Va,Stage:Og,stages:rd,Layer:_u,FastLayer:tv,Group:ff,DD:fn,Shape:Gt,shapes:sd,Animation:vr,Tween:Dn,Easings:ld,Context:wg,Canvas:Jm});class pl extends Gt{_sceneFunc(t){const n=Ft.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,n,i),t.arc(0,0,this.innerRadius(),n,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),n=this.outerRadius(),i=this.clockwise(),r=Ft.getAngle(i?360-this.angle():this.angle()),o=Math.cos(Math.min(r,Math.PI)),f=1,h=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),g=Math.sin(Math.min(r,Math.PI/2)),m=o*(o>0?t:n),_=f*n,C=h*(h>0?t:n),E=g*(g>0?n:t);return{x:m,y:i?-1*E:C,width:_-m,height:E-C}}}pl.prototype._centroid=!0;pl.prototype.className="Arc";pl.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];Xn(pl);lt.addGetterSetter(pl,"innerRadius",0,Vt());lt.addGetterSetter(pl,"outerRadius",0,Vt());lt.addGetterSetter(pl,"angle",0,Vt());lt.addGetterSetter(pl,"clockwise",!1,Kr());function Om(l,t,n,i,r,o,f){const h=Math.sqrt(Math.pow(n-l,2)+Math.pow(i-t,2)),g=Math.sqrt(Math.pow(r-n,2)+Math.pow(o-i,2)),m=f*h/(h+g),_=f*g/(h+g),C=n-m*(r-l),E=i-m*(o-t),R=n+_*(r-l),v=i+_*(o-t);return[C,E,R,v]}function Py(l,t){const n=l.length,i=[];for(let r=2;r<n-2;r+=2){const o=Om(l[r-2],l[r-1],l[r],l[r+1],l[r+2],l[r+3],t);isNaN(o[0])||(i.push(o[0]),i.push(o[1]),i.push(l[r]),i.push(l[r+1]),i.push(o[2]),i.push(o[3]))}return i}let ml=class extends Gt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const n=this.points(),i=n.length,r=this.tension(),o=this.closed(),f=this.bezier();if(!i)return;let h=0;if(t.beginPath(),t.moveTo(n[0],n[1]),r!==0&&i>4){const g=this.getTensionPoints(),m=g.length;for(h=o?0:4,o||t.quadraticCurveTo(g[0],g[1],g[2],g[3]);h<m-2;)t.bezierCurveTo(g[h++],g[h++],g[h++],g[h++],g[h++],g[h++]);o||t.quadraticCurveTo(g[m-2],g[m-1],n[i-2],n[i-1])}else if(f)for(h=2;h<i;)t.bezierCurveTo(n[h++],n[h++],n[h++],n[h++],n[h++],n[h++]);else for(h=2;h<i;h+=2)t.lineTo(n[h],n[h+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Py(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),n=t.length,i=this.tension(),r=Om(t[n-2],t[n-1],t[0],t[1],t[2],t[3],i),o=Om(t[n-4],t[n-3],t[n-2],t[n-1],t[0],t[1],i),f=Py(t,i);return[r[2],r[3]].concat(f).concat([o[0],o[1],t[n-2],t[n-1],o[2],o[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let n=t[0],i=t[0],r=t[1],o=t[1],f,h;for(let g=0;g<t.length/2;g++)f=t[g*2],h=t[g*2+1],n=Math.min(n,f),i=Math.max(i,f),r=Math.min(r,h),o=Math.max(o,h);return{x:n,y:r,width:i-n,height:o-r}}};ml.prototype.className="Line";ml.prototype._attrsAffectingSize=["points","bezier","tension"];Xn(ml);lt.addGetterSetter(ml,"closed",!1);lt.addGetterSetter(ml,"bezier",!1);lt.addGetterSetter(ml,"tension",0,Vt());lt.addGetterSetter(ml,"points",[],J3());const B5=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],z5=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],L5=[[1],[1,1],[1,2,1],[1,3,3,1]],Hy=(l,t,n)=>{let i,r;const f=n/2;i=0;for(let h=0;h<20;h++)r=f*B5[20][h]+f,i+=z5[20][h]*G5(l,t,r);return f*i},Iy=(l,t,n)=>{n===void 0&&(n=1);const i=l[0]-2*l[1]+l[2],r=t[0]-2*t[1]+t[2],o=2*l[1]-2*l[0],f=2*t[1]-2*t[0],h=4*(i*i+r*r),g=4*(i*o+r*f),m=o*o+f*f;if(h===0)return n*Math.sqrt(Math.pow(l[2]-l[0],2)+Math.pow(t[2]-t[0],2));const _=g/(2*h),C=m/h,E=n+_,R=C-_*_,v=E*E+R>0?Math.sqrt(E*E+R):0,N=_*_+R>0?Math.sqrt(_*_+R):0,B=_+Math.sqrt(_*_+R)!==0?R*Math.log(Math.abs((E+v)/(_+N))):0;return Math.sqrt(h)/2*(E*v-_*N+B)};function G5(l,t,n){const i=xm(1,n,l),r=xm(1,n,t),o=i*i+r*r;return Math.sqrt(o)}const xm=(l,t,n)=>{const i=n.length-1;let r,o;if(i===0)return 0;if(l===0){o=0;for(let f=0;f<=i;f++)o+=L5[i][f]*Math.pow(1-t,i-f)*Math.pow(t,f)*n[f];return o}else{r=new Array(i);for(let f=0;f<i;f++)r[f]=i*(n[f+1]-n[f]);return xm(l-1,t,r)}},ky=(l,t,n)=>{let i=1,r=l/t,o=(l-n(r))/t,f=0;for(;i>.001;){const h=n(r+o),g=Math.abs(l-h)/t;if(g<i)i=g,r+=o;else{const m=n(r-o),_=Math.abs(l-m)/t;_<i?(i=_,r-=o):o/=2}if(f++,f>500)break}return r};class Un extends Gt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Un.parsePathData(this.data()),this.pathLength=Un.getPathLength(this.dataArray)}_sceneFunc(t){const n=this.dataArray;t.beginPath();let i=!1;for(let r=0;r<n.length;r++){const o=n[r].command,f=n[r].points;switch(o){case"L":t.lineTo(f[0],f[1]);break;case"M":t.moveTo(f[0],f[1]);break;case"C":t.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":t.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const h=f[0],g=f[1],m=f[2],_=f[3],C=f[4],E=f[5],R=f[6],v=f[7],N=m>_?m:_,B=m>_?1:m/_,L=m>_?_/m:1;t.translate(h,g),t.rotate(R),t.scale(B,L),t.arc(0,0,N,C,C+E,1-v),t.scale(1/B,1/L),t.rotate(-R),t.translate(-h,-g);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],_=g.points[5],C=g.points[4]+_;let E=Math.PI/180;if(Math.abs(m-C)<E&&(E=Math.abs(m-C)),_<0)for(let R=m-E;R>C;R-=E){const v=Un.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}else for(let R=m+E;R<C;R+=E){const v=Un.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const _=Un.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);t.push(_.x,_.y)}else t=t.concat(g.points)});let n=t[0],i=t[0],r=t[1],o=t[1],f,h;for(let g=0;g<t.length/2;g++)f=t[g*2],h=t[g*2+1],isNaN(f)||(n=Math.min(n,f),i=Math.max(i,f)),isNaN(h)||(r=Math.min(r,h),o=Math.max(o,h));return{x:n,y:r,width:i-n,height:o-r}}getLength(){return this.pathLength}getPointAtLength(t){return Un.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,n,i,r){return Math.sqrt((i-t)*(i-t)+(r-n)*(r-n))}static getPathLength(t){let n=0;for(let i=0;i<t.length;++i)n+=t[i].pathLength;return n}static getPointAtLengthOfDataArray(t,n){let i,r=0,o=n.length;if(!o)return null;for(;r<o&&t>n[r].pathLength;)t-=n[r].pathLength,++r;if(r===o)return i=n[r-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return n[r].command==="M"?(i=n[r].points.slice(0,2),{x:i[0],y:i[1]}):{x:n[r].start.x,y:n[r].start.y};const f=n[r],h=f.points;switch(f.command){case"L":return Un.getPointOnLine(t,f.start.x,f.start.y,h[0],h[1]);case"C":return Un.getPointOnCubicBezier(ky(t,Un.getPathLength(n),N=>Hy([f.start.x,h[0],h[2],h[4]],[f.start.y,h[1],h[3],h[5]],N)),f.start.x,f.start.y,h[0],h[1],h[2],h[3],h[4],h[5]);case"Q":return Un.getPointOnQuadraticBezier(ky(t,Un.getPathLength(n),N=>Iy([f.start.x,h[0],h[2]],[f.start.y,h[1],h[3]],N)),f.start.x,f.start.y,h[0],h[1],h[2],h[3]);case"A":const g=h[0],m=h[1],_=h[2],C=h[3],E=h[5],R=h[6];let v=h[4];return v+=E*t/f.pathLength,Un.getPointOnEllipticalArc(g,m,_,C,v,R)}return null}static getPointOnLine(t,n,i,r,o,f,h){f=f??n,h=h??i;const g=this.getLineLength(n,i,r,o);if(g<1e-10)return{x:n,y:i};if(r===n)return{x:f,y:h+(o>i?t:-t)};const m=(o-i)/(r-n),_=Math.sqrt(t*t/(1+m*m))*(r<n?-1:1),C=m*_;if(Math.abs(h-i-m*(f-n))<1e-10)return{x:f+_,y:h+C};const E=((f-n)*(r-n)+(h-i)*(o-i))/(g*g),R=n+E*(r-n),v=i+E*(o-i),N=this.getLineLength(f,h,R,v),B=Math.sqrt(t*t-N*N),L=Math.sqrt(B*B/(1+m*m))*(r<n?-1:1),j=m*L;return{x:R+L,y:v+j}}static getPointOnCubicBezier(t,n,i,r,o,f,h,g,m){function _(B){return B*B*B}function C(B){return 3*B*B*(1-B)}function E(B){return 3*B*(1-B)*(1-B)}function R(B){return(1-B)*(1-B)*(1-B)}const v=g*_(t)+f*C(t)+r*E(t)+n*R(t),N=m*_(t)+h*C(t)+o*E(t)+i*R(t);return{x:v,y:N}}static getPointOnQuadraticBezier(t,n,i,r,o,f,h){function g(R){return R*R}function m(R){return 2*R*(1-R)}function _(R){return(1-R)*(1-R)}const C=f*g(t)+r*m(t)+n*_(t),E=h*g(t)+o*m(t)+i*_(t);return{x:C,y:E}}static getPointOnEllipticalArc(t,n,i,r,o,f){const h=Math.cos(f),g=Math.sin(f),m={x:i*Math.cos(o),y:r*Math.sin(o)};return{x:t+(m.x*h-m.y*g),y:n+(m.x*g+m.y*h)}}static parsePathData(t){if(!t)return[];let n=t;const i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let C=0;C<i.length;C++)n=n.replace(new RegExp(i[C],"g"),"|"+i[C]);const r=n.split("|"),o=[],f=[];let h=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let C=1;C<r.length;C++){let E=r[C],R=E.charAt(0);for(E=E.slice(1),f.length=0;_=m.exec(E);)f.push(_[0]);let v=[],N=R==="A"||R==="a"?0:-1;for(let B=0,L=f.length;B<L;B++){const j=f[B];if(j==="00"){v.push(0,0),N>=0&&(N+=2,N>=7&&(N-=7));continue}if(N>=0){if(N===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(j)){v.push(parseInt(j[0],10)),v.push(parseInt(j[1],10)),v.push(parseFloat(j.slice(2))),N+=3,N>=7&&(N-=7);continue}if(j==="11"||j==="10"||j==="01"){v.push(parseInt(j[0],10)),v.push(parseInt(j[1],10)),N+=2,N>=7&&(N-=7);continue}if(j==="0"||j==="1"){v.push(parseInt(j,10)),N+=1,N>=7&&(N-=7);continue}}else if(N===4){if(/^[01]\d+(?:\.\d+)?$/.test(j)){v.push(parseInt(j[0],10)),v.push(parseFloat(j.slice(1))),N+=2,N>=7&&(N-=7);continue}if(j==="0"||j==="1"){v.push(parseInt(j,10)),N+=1,N>=7&&(N-=7);continue}}const M=parseFloat(j);isNaN(M)?v.push(0):v.push(M),N+=1,N>=7&&(N-=7)}else{const M=parseFloat(j);isNaN(M)?v.push(0):v.push(M)}}for(;v.length>0&&!isNaN(v[0]);){let B="",L=[];const j=h,M=g;let G,O,A,T,y,z,U,P,K,Q;switch(R){case"l":h+=v.shift(),g+=v.shift(),B="L",L.push(h,g);break;case"L":h=v.shift(),g=v.shift(),L.push(h,g);break;case"m":const X=v.shift(),Y=v.shift();if(h+=X,g+=Y,B="M",o.length>2&&o[o.length-1].command==="z"){for(let D=o.length-2;D>=0;D--)if(o[D].command==="M"){h=o[D].points[0]+X,g=o[D].points[1]+Y;break}}L.push(h,g),R="l";break;case"M":h=v.shift(),g=v.shift(),B="M",L.push(h,g),R="L";break;case"h":h+=v.shift(),B="L",L.push(h,g);break;case"H":h=v.shift(),B="L",L.push(h,g);break;case"v":g+=v.shift(),B="L",L.push(h,g);break;case"V":g=v.shift(),B="L",L.push(h,g);break;case"C":L.push(v.shift(),v.shift(),v.shift(),v.shift()),h=v.shift(),g=v.shift(),L.push(h,g);break;case"c":L.push(h+v.shift(),g+v.shift(),h+v.shift(),g+v.shift()),h+=v.shift(),g+=v.shift(),B="C",L.push(h,g);break;case"S":O=h,A=g,G=o[o.length-1],G.command==="C"&&(O=h+(h-G.points[2]),A=g+(g-G.points[3])),L.push(O,A,v.shift(),v.shift()),h=v.shift(),g=v.shift(),B="C",L.push(h,g);break;case"s":O=h,A=g,G=o[o.length-1],G.command==="C"&&(O=h+(h-G.points[2]),A=g+(g-G.points[3])),L.push(O,A,h+v.shift(),g+v.shift()),h+=v.shift(),g+=v.shift(),B="C",L.push(h,g);break;case"Q":L.push(v.shift(),v.shift()),h=v.shift(),g=v.shift(),L.push(h,g);break;case"q":L.push(h+v.shift(),g+v.shift()),h+=v.shift(),g+=v.shift(),B="Q",L.push(h,g);break;case"T":O=h,A=g,G=o[o.length-1],G.command==="Q"&&(O=h+(h-G.points[0]),A=g+(g-G.points[1])),h=v.shift(),g=v.shift(),B="Q",L.push(O,A,h,g);break;case"t":O=h,A=g,G=o[o.length-1],G.command==="Q"&&(O=h+(h-G.points[0]),A=g+(g-G.points[1])),h+=v.shift(),g+=v.shift(),B="Q",L.push(O,A,h,g);break;case"A":T=v.shift(),y=v.shift(),z=v.shift(),U=v.shift(),P=v.shift(),K=h,Q=g,h=v.shift(),g=v.shift(),B="A",L=this.convertEndpointToCenterParameterization(K,Q,h,g,U,P,T,y,z);break;case"a":T=v.shift(),y=v.shift(),z=v.shift(),U=v.shift(),P=v.shift(),K=h,Q=g,h+=v.shift(),g+=v.shift(),B="A",L=this.convertEndpointToCenterParameterization(K,Q,h,g,U,P,T,y,z);break}o.push({command:B||R,points:L,start:{x:j,y:M},pathLength:this.calcLength(j,M,B||R,L)})}(R==="z"||R==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,n,i,r){let o,f,h,g;const m=Un;switch(i){case"L":return m.getLineLength(t,n,r[0],r[1]);case"C":return Hy([t,r[0],r[2],r[4]],[n,r[1],r[3],r[5]],1);case"Q":return Iy([t,r[0],r[2]],[n,r[1],r[3]],1);case"A":o=0;const _=r[4],C=r[5],E=r[4]+C;let R=Math.PI/180;if(Math.abs(_-E)<R&&(R=Math.abs(_-E)),f=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],_,0),C<0)for(g=_-R;g>E;g-=R)h=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),o+=m.getLineLength(f.x,f.y,h.x,h.y),f=h;else for(g=_+R;g<E;g+=R)h=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),o+=m.getLineLength(f.x,f.y,h.x,h.y),f=h;return h=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],E,0),o+=m.getLineLength(f.x,f.y,h.x,h.y),o}return 0}static convertEndpointToCenterParameterization(t,n,i,r,o,f,h,g,m){const _=m*(Math.PI/180),C=Math.cos(_)*(t-i)/2+Math.sin(_)*(n-r)/2,E=-1*Math.sin(_)*(t-i)/2+Math.cos(_)*(n-r)/2,R=C*C/(h*h)+E*E/(g*g);R>1&&(h*=Math.sqrt(R),g*=Math.sqrt(R));let v=Math.sqrt((h*h*(g*g)-h*h*(E*E)-g*g*(C*C))/(h*h*(E*E)+g*g*(C*C)));o===f&&(v*=-1),isNaN(v)&&(v=0);const N=v*h*E/g,B=v*-g*C/h,L=(t+i)/2+Math.cos(_)*N-Math.sin(_)*B,j=(n+r)/2+Math.sin(_)*N+Math.cos(_)*B,M=function(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1])},G=function(U,P){return(U[0]*P[0]+U[1]*P[1])/(M(U)*M(P))},O=function(U,P){return(U[0]*P[1]<U[1]*P[0]?-1:1)*Math.acos(G(U,P))},A=O([1,0],[(C-N)/h,(E-B)/g]),T=[(C-N)/h,(E-B)/g],y=[(-1*C-N)/h,(-1*E-B)/g];let z=O(T,y);return G(T,y)<=-1&&(z=Math.PI),G(T,y)>=1&&(z=0),f===0&&z>0&&(z=z-2*Math.PI),f===1&&z<0&&(z=z+2*Math.PI),[L,j,h,g,A,z,_,f]}}Un.prototype.className="Path";Un.prototype._attrsAffectingSize=["data"];Xn(Un);lt.addGetterSetter(Un,"data");class Eu extends ml{_sceneFunc(t){super._sceneFunc(t);const n=Math.PI*2,i=this.points();let r=i;const o=this.tension()!==0&&i.length>4;o&&(r=this.getTensionPoints());const f=this.pointerLength(),h=i.length;let g,m;if(o){const E=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],i[h-2],i[h-1]],R=Un.calcLength(r[r.length-4],r[r.length-3],"C",E),v=Un.getPointOnQuadraticBezier(Math.min(1,1-f/R),E[0],E[1],E[2],E[3],E[4],E[5]);g=i[h-2]-v.x,m=i[h-1]-v.y}else g=i[h-2]-i[h-4],m=i[h-1]-i[h-3];const _=(Math.atan2(m,g)+n)%n,C=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[h-2],i[h-1]),t.rotate(_),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),o?(g=(r[0]+r[2])/2-i[0],m=(r[1]+r[3])/2-i[1]):(g=i[2]-i[0],m=i[3]-i[1]),t.rotate((Math.atan2(-m,-g)+n)%n),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),n=this.pointerWidth()/2;return{x:t.x,y:t.y-n,width:t.width,height:t.height+n*2}}}Eu.prototype.className="Arrow";Xn(Eu);lt.addGetterSetter(Eu,"pointerLength",10,Vt());lt.addGetterSetter(Eu,"pointerWidth",10,Vt());lt.addGetterSetter(Eu,"pointerAtBeginning",!1);lt.addGetterSetter(Eu,"pointerAtEnding",!0);class Sf extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}Sf.prototype._centroid=!0;Sf.prototype.className="Circle";Sf.prototype._attrsAffectingSize=["radius"];Xn(Sf);lt.addGetterSetter(Sf,"radius",0,Vt());class go extends Gt{_sceneFunc(t){const n=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),n!==i&&t.scale(1,i/n),t.arc(0,0,n,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}go.prototype.className="Ellipse";go.prototype._centroid=!0;go.prototype._attrsAffectingSize=["radiusX","radiusY"];Xn(go);lt.addComponentsGetterSetter(go,"radius",["x","y"]);lt.addGetterSetter(go,"radiusX",0,Vt());lt.addGetterSetter(go,"radiusY",0,Vt());let Qr=class tS extends Gt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),n=this.hasShadow();return t&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const n=this.getWidth(),i=this.getHeight(),r=this.cornerRadius(),o=this.attrs.image;let f;if(o){const h=this.attrs.cropWidth,g=this.attrs.cropHeight;h&&g?f=[o,this.cropX(),this.cropY(),h,g,0,0,n,i]:f=[o,0,0,n,i]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?mt.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)),o&&(r&&t.clip(),t.drawImage.apply(t,f))}_hitFunc(t){const n=this.width(),i=this.height(),r=this.cornerRadius();t.beginPath(),r?mt.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,n,i;return(i=(t=this.attrs.width)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&i!==void 0?i:0}getHeight(){var t,n,i;return(i=(t=this.attrs.height)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&i!==void 0?i:0}static fromURL(t,n,i=null){const r=mt.createImageElement();r.onload=function(){const o=new tS({image:r});n(o)},r.onerror=i,r.crossOrigin="Anonymous",r.src=t}};Qr.prototype.className="Image";Qr.prototype._attrsAffectingSize=["image"];Xn(Qr);lt.addGetterSetter(Qr,"cornerRadius",0,Rg(4));lt.addGetterSetter(Qr,"image");lt.addComponentsGetterSetter(Qr,"crop",["x","y","width","height"]);lt.addGetterSetter(Qr,"cropX",0,Vt());lt.addGetterSetter(Qr,"cropY",0,Vt());lt.addGetterSetter(Qr,"cropWidth",0,Vt());lt.addGetterSetter(Qr,"cropHeight",0,Vt());const eS=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],P5="Change.konva",H5="none",Mm="up",Nm="right",jm="down",Dm="left",I5=eS.length;class ev extends ff{constructor(t){super(t),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let n=this,i;const r=function(){n._sync()};for(i=0;i<I5;i++)t.on(eS[i]+P5,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),n=this.getTag(),i,r,o,f,h,g,m;if(t&&n){switch(i=t.width(),r=t.height(),o=n.pointerDirection(),f=n.pointerWidth(),m=n.pointerHeight(),h=0,g=0,o){case Mm:h=i/2,g=-1*m;break;case Nm:h=i+f,g=r/2;break;case jm:h=i/2,g=r+m;break;case Dm:h=-1*f,g=r/2;break}n.setAttrs({x:-1*h,y:-1*g,width:i,height:r}),t.setAttrs({x:-1*h,y:-1*g})}}}ev.prototype.className="Label";Xn(ev);class Cu extends Gt{_sceneFunc(t){const n=this.width(),i=this.height(),r=this.pointerDirection(),o=this.pointerWidth(),f=this.pointerHeight(),h=this.cornerRadius();let g=0,m=0,_=0,C=0;typeof h=="number"?g=m=_=C=Math.min(h,n/2,i/2):(g=Math.min(h[0]||0,n/2,i/2),m=Math.min(h[1]||0,n/2,i/2),C=Math.min(h[2]||0,n/2,i/2),_=Math.min(h[3]||0,n/2,i/2)),t.beginPath(),t.moveTo(g,0),r===Mm&&(t.lineTo((n-o)/2,0),t.lineTo(n/2,-1*f),t.lineTo((n+o)/2,0)),t.lineTo(n-m,0),t.arc(n-m,m,m,Math.PI*3/2,0,!1),r===Nm&&(t.lineTo(n,(i-f)/2),t.lineTo(n+o,i/2),t.lineTo(n,(i+f)/2)),t.lineTo(n,i-C),t.arc(n-C,i-C,C,0,Math.PI/2,!1),r===jm&&(t.lineTo((n+o)/2,i),t.lineTo(n/2,i+f),t.lineTo((n-o)/2,i)),t.lineTo(_,i),t.arc(_,i-_,_,Math.PI/2,Math.PI,!1),r===Dm&&(t.lineTo(0,(i+f)/2),t.lineTo(-1*o,i/2),t.lineTo(0,(i-f)/2)),t.lineTo(0,g),t.arc(g,g,g,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,n=0,i=this.pointerWidth(),r=this.pointerHeight(),o=this.pointerDirection(),f=this.width(),h=this.height();return o===Mm?(n-=r,h+=r):o===jm?h+=r:o===Dm?(t-=i*1.5,f+=i):o===Nm&&(f+=i*1.5),{x:t,y:n,width:f,height:h}}}Cu.prototype.className="Tag";Xn(Cu);lt.addGetterSetter(Cu,"pointerDirection",H5);lt.addGetterSetter(Cu,"pointerWidth",0,Vt());lt.addGetterSetter(Cu,"pointerHeight",0,Vt());lt.addGetterSetter(Cu,"cornerRadius",0,Rg(4));class yd extends Gt{_sceneFunc(t){const n=this.cornerRadius(),i=this.width(),r=this.height();t.beginPath(),n?mt.drawRoundedRectPath(t,i,r,n):t.rect(0,0,i,r),t.closePath(),t.fillStrokeShape(this)}}yd.prototype.className="Rect";Xn(yd);lt.addGetterSetter(yd,"cornerRadius",0,Rg(4));class po extends Gt{_sceneFunc(t){const n=this._getPoints(),i=this.radius(),r=this.sides(),o=this.cornerRadius();if(t.beginPath(),o)mt.drawRoundedPolygonPath(t,n,r,i,o);else{t.moveTo(n[0].x,n[0].y);for(let f=1;f<n.length;f++)t.lineTo(n[f].x,n[f].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,n=this.attrs.radius||0,i=[];for(let r=0;r<t;r++)i.push({x:n*Math.sin(r*2*Math.PI/t),y:-1*n*Math.cos(r*2*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();let n=t[0].x,i=t[0].y,r=t[0].x,o=t[0].y;return t.forEach(f=>{n=Math.min(n,f.x),i=Math.max(i,f.x),r=Math.min(r,f.y),o=Math.max(o,f.y)}),{x:n,y:r,width:i-n,height:o-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}po.prototype.className="RegularPolygon";po.prototype._centroid=!0;po.prototype._attrsAffectingSize=["radius"];Xn(po);lt.addGetterSetter(po,"radius",0,Vt());lt.addGetterSetter(po,"sides",0,Vt());lt.addGetterSetter(po,"cornerRadius",0,Rg(4));const qy=Math.PI*2;class Tu extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,qy,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),qy,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Tu.prototype.className="Ring";Tu.prototype._centroid=!0;Tu.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Xn(Tu);lt.addGetterSetter(Tu,"innerRadius",0,Vt());lt.addGetterSetter(Tu,"outerRadius",0,Vt());class Es extends Gt{constructor(t){super(t),this._updated=!0,this.anim=new vr(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const n=this.animation(),i=this.frameIndex(),r=i*4,o=this.animations()[n],f=this.frameOffsets(),h=o[r+0],g=o[r+1],m=o[r+2],_=o[r+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,m,_),t.closePath(),t.fillStrokeShape(this)),C)if(f){const E=f[n],R=i*2;t.drawImage(C,h,g,m,_,E[R+0],E[R+1],m,_)}else t.drawImage(C,h,g,m,_,0,0,m,_)}_hitFunc(t){const n=this.animation(),i=this.frameIndex(),r=i*4,o=this.animations()[n],f=this.frameOffsets(),h=o[r+2],g=o[r+3];if(t.beginPath(),f){const m=f[n],_=i*2;t.rect(m[_+0],m[_+1],h,g)}else t.rect(0,0,h,g);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),n=this.animation(),i=this.animations(),r=i[n],o=r.length/4;t<o-1?this.frameIndex(t+1):this.frameIndex(0)}}Es.prototype.className="Sprite";Xn(Es);lt.addGetterSetter(Es,"animation");lt.addGetterSetter(Es,"animations");lt.addGetterSetter(Es,"frameOffsets");lt.addGetterSetter(Es,"image");lt.addGetterSetter(Es,"frameIndex",0,Vt());lt.addGetterSetter(Es,"frameRate",17,Vt());lt.backCompat(Es,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class mo extends Gt{_sceneFunc(t){const n=this.innerRadius(),i=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(let o=1;o<r*2;o++){const f=o%2===0?i:n,h=f*Math.sin(o*Math.PI/r),g=-1*f*Math.cos(o*Math.PI/r);t.lineTo(h,g)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}mo.prototype.className="Star";mo.prototype._centroid=!0;mo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Xn(mo);lt.addGetterSetter(mo,"numPoints",5,Vt());lt.addGetterSetter(mo,"innerRadius",0,Vt());lt.addGetterSetter(mo,"outerRadius",0,Vt());function so(l){return[...l].reduce((t,n,i,r)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const o=r[i+1];o&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(o)?(t.push(n+o),r[i+1]=""):t.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(r[i+1]||""))?t.push(n+r[i+1]):i>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?t[t.length-1]+=n:n&&t.push(n);return t},[])}const Jc="auto",k5="center",nS="inherit",Zc="justify",q5="Change.konva",V5="2d",Vy="-",iS="left",Y5="text",K5="Text",Q5="top",X5="bottom",Yy="middle",aS="normal",F5="px ",W0=" ",J5="right",Ky="rtl",Z5="word",W5="char",Qy="none",xp="…",rS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],$5=rS.length;function t6(l){return l.split(",").map(t=>{t=t.trim();const n=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return n&&!i&&(t=`"${t}"`),t}).join(", ")}let $0;function Mp(){return $0||($0=mt.createCanvasElement().getContext(V5),$0)}function e6(l){l.fillText(this._partialText,this._partialTextX,this._partialTextY)}function n6(l){l.setAttr("miterLimit",2),l.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function i6(l){return l=l||{},!l.fillLinearGradientColorStops&&!l.fillRadialGradientColorStops&&!l.fillPatternImage&&(l.fill=l.fill||"black"),l}class Gn extends Gt{constructor(t){super(i6(t)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<$5;n++)this.on(rS[n]+q5,this._setTextData);this._setTextData()}_sceneFunc(t){var n,i;const r=this.textArr,o=r.length;if(!this.text())return;let f=this.padding(),h=this.fontSize(),g=this.lineHeight()*h,m=this.verticalAlign(),_=this.direction(),C=0,E=this.align(),R=this.getWidth(),v=this.letterSpacing(),N=this.charRenderFunc(),B=this.fill(),L=this.textDecoration(),j=L.indexOf("underline")!==-1,M=L.indexOf("line-through")!==-1,G;_=_===nS?t.direction:_;let O=g/2,A=Yy;if(!Ft.legacyTextRendering){const T=this.measureSize("M");A="alphabetic";const y=(n=T.fontBoundingBoxAscent)!==null&&n!==void 0?n:T.actualBoundingBoxAscent,z=(i=T.fontBoundingBoxDescent)!==null&&i!==void 0?i:T.actualBoundingBoxDescent;O=(y-z)/2+g/2}for(_===Ky&&t.setAttr("direction",_),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",A),t.setAttr("textAlign",iS),m===Yy?C=(this.getHeight()-o*g-f*2)/2:m===X5&&(C=this.getHeight()-o*g-f*2),t.translate(f,C+f),G=0;G<o;G++){let T=0,y=0;const z=r[G],U=z.text,P=z.width,K=z.lastInParagraph;if(t.save(),E===J5?T+=R-P-f*2:E===k5&&(T+=(R-P-f*2)/2),j){t.save(),t.beginPath();const Q=Ft.legacyTextRendering?Math.round(h/2):Math.round(h/4),X=T,Y=O+y+Q;t.moveTo(X,Y);const D=E===Zc&&!K?R-f*2:P;t.lineTo(X+Math.round(D),Y),t.lineWidth=h/15;const I=this._getLinearGradient();t.strokeStyle=I||B,t.stroke(),t.restore()}if(_!==Ky&&(v!==0||E===Zc||N)){const Q=U.split(" ").length-1,X=so(U);for(let Y=0;Y<X.length;Y++){const D=X[Y];if(D===" "&&!K&&E===Zc&&(T+=(R-f*2-P)/Q),this._partialTextX=T,this._partialTextY=O+y,this._partialText=D,N){t.save();const F=r.slice(0,G).reduce((it,Z)=>it+so(Z.text).length,0),W=Y+F;N({char:D,index:W,x:T,y:O+y,lineIndex:G,column:Y,isLastInLine:K,width:this.measureSize(D).width,context:t})}t.fillStrokeShape(this),N&&t.restore(),T+=this.measureSize(D).width+v}}else v!==0&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=T,this._partialTextY=O+y,this._partialText=U,t.fillStrokeShape(this);if(M){t.save(),t.beginPath();const Q=Ft.legacyTextRendering?0:-Math.round(h/4),X=E===Zc?0:T;t.moveTo(X,O+y+Q);const Y=E===Zc&&!K?R-f*2:P;t.lineTo(X+Math.round(Y),O+y+Q),t.lineWidth=h/15;const D=this._getLinearGradient();t.strokeStyle=D||B,t.stroke(),t.restore()}t.restore(),o>1&&(O+=g)}}_hitFunc(t){const n=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}setText(t){const n=mt._isString(t)?t:t==null?"":t+"";return this._setAttr(Y5,n),this}getWidth(){return this.attrs.width===Jc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Jc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return mt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var n,i,r,o,f,h,g,m,_,C,E;let R=Mp(),v=this.fontSize(),N;R.save(),R.font=this._getContextFont(),N=R.measureText(t),R.restore();const B=v/100;return{actualBoundingBoxAscent:(n=N.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*B,actualBoundingBoxDescent:(i=N.actualBoundingBoxDescent)!==null&&i!==void 0?i:0,actualBoundingBoxLeft:(r=N.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*B,actualBoundingBoxRight:(o=N.actualBoundingBoxRight)!==null&&o!==void 0?o:75.732421875*B,alphabeticBaseline:(f=N.alphabeticBaseline)!==null&&f!==void 0?f:0,emHeightAscent:(h=N.emHeightAscent)!==null&&h!==void 0?h:100*B,emHeightDescent:(g=N.emHeightDescent)!==null&&g!==void 0?g:-20*B,fontBoundingBoxAscent:(m=N.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*B,fontBoundingBoxDescent:(_=N.fontBoundingBoxDescent)!==null&&_!==void 0?_:21*B,hangingBaseline:(C=N.hangingBaseline)!==null&&C!==void 0?C:72.80000305175781*B,ideographicBaseline:(E=N.ideographicBaseline)!==null&&E!==void 0?E:-21*B,width:N.width,height:v}}_getContextFont(){return this.fontStyle()+W0+this.fontVariant()+W0+(this.fontSize()+F5)+t6(this.fontFamily())}_addTextLine(t){this.align()===Zc&&(t=t.trim());const i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){const n=this.letterSpacing(),i=t.length;return Mp().measureText(t).width+n*i}_setTextData(){let t=this.text().split(`
`),n=+this.fontSize(),i=0,r=this.lineHeight()*n,o=this.attrs.width,f=this.attrs.height,h=o!==Jc&&o!==void 0,g=f!==Jc&&f!==void 0,m=this.padding(),_=o-m*2,C=f-m*2,E=0,R=this.wrap(),v=R!==Qy,N=R!==W5&&v,B=this.ellipsis();this.textArr=[],Mp().font=this._getContextFont();const L=B?this._getTextWidth(xp):0;for(let j=0,M=t.length;j<M;++j){let G=t[j],O=this._getTextWidth(G);if(h&&O>_)for(;G.length>0;){let A=0,T=so(G).length,y="",z=0;for(;A<T;){const U=A+T>>>1,P=so(G),K=P.slice(0,U+1).join(""),Q=this._getTextWidth(K);(B&&g&&E+r>C?Q+L:Q)<=_?(A=U+1,y=K,z=Q):T=U}if(y){if(N){const K=so(G),Q=so(y),X=K[Q.length],Y=X===W0||X===Vy;let D;if(Y&&z<=_)D=Q.length;else{const I=Q.lastIndexOf(W0),F=Q.lastIndexOf(Vy);D=Math.max(I,F)+1}D>0&&(A=D,y=K.slice(0,A).join(""),z=this._getTextWidth(y))}if(y=y.trimRight(),this._addTextLine(y),i=Math.max(i,z),E+=r,this._shouldHandleEllipsis(E)){this._tryToAddEllipsisToLastLine();break}if(G=so(G).slice(A).join("").trimLeft(),G.length>0&&(O=this._getTextWidth(G),O<=_)){this._addTextLine(G),E+=r,i=Math.max(i,O);break}}else break}else this._addTextLine(G),E+=r,i=Math.max(i,O),this._shouldHandleEllipsis(E)&&j<M-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&E+r>C)break}this.textHeight=n,this.textWidth=i}_shouldHandleEllipsis(t){const n=+this.fontSize(),i=this.lineHeight()*n,r=this.attrs.height,o=r!==Jc&&r!==void 0,f=this.padding(),h=r-f*2;return!(this.wrap()!==Qy)||o&&t+i>h}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,n=t!==Jc&&t!==void 0,i=this.padding(),r=t-i*2,o=this.ellipsis(),f=this.textArr[this.textArr.length-1];!f||!o||(n&&(this._getTextWidth(f.text+xp)<r||(f.text=f.text.slice(0,f.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(f.text+xp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return t&&n?!0:super._useBufferCanvas()}}Gn.prototype._fillFunc=e6;Gn.prototype._strokeFunc=n6;Gn.prototype.className=K5;Gn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Xn(Gn);lt.overWriteSetter(Gn,"width",Wm());lt.overWriteSetter(Gn,"height",Wm());lt.addGetterSetter(Gn,"direction",nS);lt.addGetterSetter(Gn,"fontFamily","Arial");lt.addGetterSetter(Gn,"fontSize",12,Vt());lt.addGetterSetter(Gn,"fontStyle",aS);lt.addGetterSetter(Gn,"fontVariant",aS);lt.addGetterSetter(Gn,"padding",0,Vt());lt.addGetterSetter(Gn,"align",iS);lt.addGetterSetter(Gn,"verticalAlign",Q5);lt.addGetterSetter(Gn,"lineHeight",1,Vt());lt.addGetterSetter(Gn,"wrap",Z5);lt.addGetterSetter(Gn,"ellipsis",!1,Kr());lt.addGetterSetter(Gn,"letterSpacing",0,Vt());lt.addGetterSetter(Gn,"text","",bu());lt.addGetterSetter(Gn,"textDecoration","");lt.addGetterSetter(Gn,"charRenderFunc",void 0);const a6="",sS="normal";function lS(l){l.fillText(this.partialText,0,0)}function oS(l){l.strokeText(this.partialText,0,0)}class Ti extends Gt{constructor(t){super(t),this.dummyCanvas=mt.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Un.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const n=this.pathLength;return t>n?null:Un.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Un.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const n=this.textDecoration(),i=this.fill(),r=this.fontSize(),o=this.glyphInfo,f=n.indexOf("underline")!==-1,h=n.indexOf("line-through")!==-1;f&&t.beginPath();for(let g=0;g<o.length;g++){t.save();const m=o[g].p0;t.translate(m.x,m.y),t.rotate(o[g].rotation),this.partialText=o[g].text,t.fillStrokeShape(this),f&&(g===0&&t.moveTo(0,r/2+1),t.lineTo(o[g].width,r/2+1)),t.restore()}if(f&&(t.strokeStyle=i,t.lineWidth=r/20,t.stroke()),h){t.beginPath();for(let g=0;g<o.length;g++){t.save();const m=o[g].p0;t.translate(m.x,m.y),t.rotate(o[g].rotation),g===0&&t.moveTo(0,0),t.lineTo(o[g].width,0),t.restore()}t.strokeStyle=i,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const n=this.glyphInfo;if(n.length>=1){const i=n[0].p0;t.moveTo(i.x,i.y)}for(let i=0;i<n.length;i++){const r=n[i].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return mt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Gn.prototype.setText.call(this,t)}_getContextFont(){return Gn.prototype._getContextFont.call(this)}_getTextSize(t){const i=this.dummyCanvas.getContext("2d");i.save(),i.font=this._getContextFont();const r=i.measureText(t);return i.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=so(this.text()),n=[];let i=0;for(let C=0;C<t.length;C++)n.push({char:t[C],width:this._getTextSize(t[C]).width}),i+=n[C].width;const{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=i,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const o=this.letterSpacing(),f=this.align(),h=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*o,0);let m=0;f==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),f==="right"&&(m=Math.max(0,this.pathLength-g));let _=m;for(let C=0;C<n.length;C++){const E=this._getPointAtLength(_);if(!E)return;const R=n[C].char;let v=n[C].width+o;if(R===" "&&f==="justify"){const G=this.text().split(" ").length-1;v+=(this.pathLength-g)/G}const N=this._getPointAtLength(_+v);if(!N)return;const B=Un.getLineLength(E.x,E.y,N.x,N.y);let L=0;if(h)try{L=h(n[C-1].char,R)*this.fontSize()}catch{L=0}E.x+=L,N.x+=L,this.textWidth+=L;const j=Un.getPointOnLine(L+B/2,E.x,E.y,N.x,N.y),M=Math.atan2(N.y-E.y,N.x-E.x);this.glyphInfo.push({transposeX:j.x,transposeY:j.y,text:t[C],rotation:M,p0:E,p1:N,width:B}),_+=v}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});let n=t[0]||0,i=t[0]||0,r=t[1]||0,o=t[1]||0,f,h;for(let m=0;m<t.length/2;m++)f=t[m*2],h=t[m*2+1],n=Math.min(n,f),i=Math.max(i,f),r=Math.min(r,h),o=Math.max(o,h);const g=this.fontSize();return{x:n-g/2,y:r-g/2,width:i-n+g,height:o-r+g}}destroy(){return mt.releaseCanvas(this.dummyCanvas),super.destroy()}}Ti.prototype._fillFunc=lS;Ti.prototype._strokeFunc=oS;Ti.prototype._fillFuncHit=lS;Ti.prototype._strokeFuncHit=oS;Ti.prototype.className="TextPath";Ti.prototype._attrsAffectingSize=["text","fontSize","data"];Xn(Ti);lt.addGetterSetter(Ti,"data");lt.addGetterSetter(Ti,"fontFamily","Arial");lt.addGetterSetter(Ti,"fontSize",12,Vt());lt.addGetterSetter(Ti,"fontStyle",sS);lt.addGetterSetter(Ti,"align","left");lt.addGetterSetter(Ti,"letterSpacing",0,Vt());lt.addGetterSetter(Ti,"textBaseline","middle");lt.addGetterSetter(Ti,"fontVariant",sS);lt.addGetterSetter(Ti,"text",a6);lt.addGetterSetter(Ti,"textDecoration","");lt.addGetterSetter(Ti,"kerningFunc",void 0);const uS="tr-konva",r6=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(l=>l+`.${uS}`).join(" "),Xy="nodesRect",s6=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],l6={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},o6="ontouchstart"in Ft._global;function u6(l,t,n){if(l==="rotater")return n;t+=mt.degToRad(l6[l]||0);const i=(mt.radToDeg(t)%360+360)%360;return mt._inRange(i,315+22.5,360)||mt._inRange(i,0,22.5)?"ns-resize":mt._inRange(i,45-22.5,45+22.5)?"nesw-resize":mt._inRange(i,90-22.5,90+22.5)?"ew-resize":mt._inRange(i,135-22.5,135+22.5)?"nwse-resize":mt._inRange(i,180-22.5,180+22.5)?"ns-resize":mt._inRange(i,225-22.5,225+22.5)?"nesw-resize":mt._inRange(i,270-22.5,270+22.5)?"ew-resize":mt._inRange(i,315-22.5,315+22.5)?"nwse-resize":(mt.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}const pg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function c6(l){return{x:l.x+l.width/2*Math.cos(l.rotation)+l.height/2*Math.sin(-l.rotation),y:l.y+l.height/2*Math.cos(l.rotation)+l.width/2*Math.sin(l.rotation)}}function cS(l,t,n){const i=n.x+(l.x-n.x)*Math.cos(t)-(l.y-n.y)*Math.sin(t),r=n.y+(l.x-n.x)*Math.sin(t)+(l.y-n.y)*Math.cos(t);return{...l,rotation:l.rotation+t,x:i,y:r}}function f6(l,t){const n=c6(l);return cS(l,t,n)}function h6(l,t,n){let i=t;for(let r=0;r<l.length;r++){const o=Ft.getAngle(l[r]),f=Math.abs(o-t)%(Math.PI*2);Math.min(f,Math.PI*2-f)<n&&(i=o)}return i}let Um=0;class Xe extends ff{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(r6,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return mt.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return uS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const n=t.filter(r=>r.isAncestorOf(this)?(mt.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=n,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const o=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){const f=r._attrsAffectingSize.map(h=>h+"Change."+this._getEventNamespace()).join(" ");r.on(f,o)}r.on(s6.map(f=>f+`.${this._getEventNamespace()}`).join(" "),o),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,o),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let n;t.on(`dragstart.${this._getEventNamespace()}`,i=>{n=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(i,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!n)return;const r=t.getAbsolutePosition(),o=r.x-n.x,f=r.y-n.y;this.nodes().forEach(h=>{if(h===t||h.isDragging())return;const g=h.getAbsolutePosition();h.setAbsolutePosition({x:g.x+o,y:g.y+f}),h.startDrag(i)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Xy),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Xy,this.__getNodeRect)}__getNodeShape(t,n=this.rotation(),i){const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=t.getAbsoluteScale(i),f=t.getAbsolutePosition(i),h=r.x*o.x-t.offsetX()*o.x,g=r.y*o.y-t.offsetY()*o.y,m=(Ft.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),_={x:f.x+h*Math.cos(m)+g*Math.sin(-m),y:f.y+g*Math.cos(m)+h*Math.sin(m),width:r.width*o.x,height:r.height*o.y,rotation:m};return cS(_,-Ft.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const _=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),C=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}],E=m.getAbsoluteTransform();C.forEach(function(R){const v=E.point(R);n.push(v)})});const i=new Ia;i.rotate(-Ft.getAngle(this.rotation()));let r=1/0,o=1/0,f=-1/0,h=-1/0;n.forEach(function(m){const _=i.point(m);r===void 0&&(r=f=_.x,o=h=_.y),r=Math.min(r,_.x),o=Math.min(o,_.y),f=Math.max(f,_.x),h=Math.max(h,_.y)}),i.invert();const g=i.point({x:r,y:o});return{x:g.x,y:g.y,width:f-r,height:h-o,rotation:Ft.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),pg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const n=new yd({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:o6?10:"auto"}),i=this;n.on("mousedown touchstart",function(r){i._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{const r=Ft.getAngle(this.rotation()),o=this.rotateAnchorCursor(),f=u6(t,r,o);n.getStage().content&&(n.getStage().content.style.cursor=f),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const t=new Gt({name:"back",width:0,height:0,sceneFunc(n,i){const r=i.getParent(),o=r.padding();n.beginPath(),n.rect(-o,-o,i.width()+o*2,i.height()+o*2),n.moveTo(i.width()/2,-o),r.rotateEnabled()&&r.rotateLineVisible()&&n.lineTo(i.width()/2,-r.rotateAnchorOffset()*mt._sign(i.height())-o),n.fillStrokeShape(i)},hitFunc:(n,i)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();n.beginPath(),n.rect(-r,-r,i.width()+r*2,i.height()+r*2),n.fillStrokeShape(i)}});this.add(t),this._proxyDrag(t),t.on("dragstart",n=>{n.cancelBubble=!0}),t.on("dragmove",n=>{n.cancelBubble=!0}),t.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const n=this._getNodeRect(),i=n.width,r=n.height,o=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));this.sin=Math.abs(r/o),this.cos=Math.abs(i/o),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const f=t.target.getAbsolutePosition(),h=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:h.x-f.x,y:h.y-f.y},Um++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:t.evt,target:g})})}_handleMouseMove(t){let n,i,r;const o=this.findOne("."+this._movingAnchorName),f=o.getStage();f.setPointersPositions(t);const h=f.getPointerPosition();let g={x:h.x-this._anchorDragOffset.x,y:h.y-this._anchorDragOffset.y};const m=o.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,t)),o.setAbsolutePosition(g);const _=o.getAbsolutePosition();if(m.x===_.x&&m.y===_.y)return;if(this._movingAnchorName==="rotater"){const j=this._getNodeRect();n=o.x()-j.width/2,i=-o.y()+j.height/2;let M=Math.atan2(-i,n)+Math.PI/2;j.height<0&&(M-=Math.PI);const O=Ft.getAngle(this.rotation())+M,A=Ft.getAngle(this.rotationSnapTolerance()),y=h6(this.rotationSnaps(),O,A)-j.rotation,z=f6(j,y);this._fitNodesInto(z,t);return}const C=this.shiftBehavior();let E;C==="inverted"?E=this.keepRatio()&&!t.shiftKey:C==="none"?E=this.keepRatio():E=this.keepRatio()||t.shiftKey;let R=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(E){const j=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(j.x-o.x(),2)+Math.pow(j.y-o.y(),2));const M=this.findOne(".top-left").x()>j.x?-1:1,G=this.findOne(".top-left").y()>j.y?-1:1;n=r*this.cos*M,i=r*this.sin*G,this.findOne(".top-left").x(j.x-n),this.findOne(".top-left").y(j.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(o.y());else if(this._movingAnchorName==="top-right"){if(E){const j=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(o.x()-j.x,2)+Math.pow(j.y-o.y(),2));const M=this.findOne(".top-right").x()<j.x?-1:1,G=this.findOne(".top-right").y()>j.y?-1:1;n=r*this.cos*M,i=r*this.sin*G,this.findOne(".top-right").x(j.x+n),this.findOne(".top-right").y(j.y-i)}var v=o.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(o.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(o.x());else if(this._movingAnchorName==="bottom-left"){if(E){const j=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(j.x-o.x(),2)+Math.pow(o.y()-j.y,2));const M=j.x<o.x()?-1:1,G=o.y()<j.y?-1:1;n=r*this.cos*M,i=r*this.sin*G,o.x(j.x-n),o.y(j.y+i)}v=o.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(o.y());else if(this._movingAnchorName==="bottom-right"){if(E){const j=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(o.x()-j.x,2)+Math.pow(o.y()-j.y,2));const M=this.findOne(".bottom-right").x()<j.x?-1:1,G=this.findOne(".bottom-right").y()<j.y?-1:1;n=r*this.cos*M,i=r*this.sin*G,this.findOne(".bottom-right").x(j.x+n),this.findOne(".bottom-right").y(j.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(R=this.centeredScaling()||t.altKey,R){const j=this.findOne(".top-left"),M=this.findOne(".bottom-right"),G=j.x(),O=j.y(),A=this.getWidth()-M.x(),T=this.getHeight()-M.y();M.move({x:-G,y:-O}),j.move({x:A,y:T})}const N=this.findOne(".top-left").getAbsolutePosition();n=N.x,i=N.y;const B=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),L=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:i,width:B,height:L,rotation:Ft.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const i=this.getNode();Um--,this._fire("transformend",{evt:t,target:i}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),i&&this._nodes.forEach(r=>{var o;r._fire("transformend",{evt:t,target:r}),(o=r.getLayer())===null||o===void 0||o.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,n){const i=this._getNodeRect(),r=1;if(mt._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(mt._inRange(t.height,-this.padding()*2-r,r)){this.update();return}const o=new Ia;if(o.rotate(Ft.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=o.point({x:-this.padding()*2,y:0});t.x+=E.x,t.y+=E.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=o.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=o.point({x:0,y:-this.padding()*2});t.x+=E.x,t.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=o.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(i,t);E?t=E:mt.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const f=1e7,h=new Ia;h.translate(i.x,i.y),h.rotate(i.rotation),h.scale(i.width/f,i.height/f);const g=new Ia,m=t.width/f,_=t.height/f;this.flipEnabled()===!1?(g.translate(t.x,t.y),g.rotate(t.rotation),g.translate(t.width<0?t.width:0,t.height<0?t.height:0),g.scale(Math.abs(m),Math.abs(_))):(g.translate(t.x,t.y),g.rotate(t.rotation),g.scale(m,_));const C=g.multiply(h.invert());this._nodes.forEach(E=>{var R;if(!E.getStage())return;const v=E.getParent().getAbsoluteTransform(),N=E.getTransform().copy();N.translate(E.offsetX(),E.offsetY());const B=new Ia;B.multiply(v.copy().invert()).multiply(C).multiply(v).multiply(N);const L=B.decompose();E.setAttrs(L),(R=E.getLayer())===null||R===void 0||R.batchDraw()}),this.rotation(mt._getRotation(t.rotation)),this._nodes.forEach(E=>{this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,n){this.findOne(t).setAttrs(n)}update(){var t;const n=this._getNodeRect();this.rotation(mt._getRotation(n.rotation));const i=n.width,r=n.height,o=this.enabledAnchors(),f=this.resizeEnabled(),h=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(C=>{C.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+h,offsetY:g/2+h,visible:f&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:g/2+h,visible:f&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:g/2-h,offsetY:g/2+h,visible:f&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:g/2+h,visible:f&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:r/2,offsetX:g/2-h,visible:f&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:g/2+h,offsetY:g/2-h,visible:f&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:r,offsetY:g/2-h,visible:f&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:r,offsetX:g/2-h,offsetY:g/2-h,visible:f&&o.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*mt._sign(r)-h,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(C=>C.draggable()),x:0,y:0});const _=this.anchorStyleFunc();_&&m.forEach(C=>{_(C)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),ff.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return kt.prototype.toObject.call(this)}clone(t){return kt.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Xe.isTransforming=()=>Um>0;function d6(l){return l instanceof Array||mt.warn("enabledAnchors value should be an array"),l instanceof Array&&l.forEach(function(t){pg.indexOf(t)===-1&&mt.warn("Unknown anchor name: "+t+". Available names are: "+pg.join(", "))}),l||[]}Xe.prototype.className="Transformer";Xn(Xe);lt.addGetterSetter(Xe,"enabledAnchors",pg,d6);lt.addGetterSetter(Xe,"flipEnabled",!0,Kr());lt.addGetterSetter(Xe,"resizeEnabled",!0);lt.addGetterSetter(Xe,"anchorSize",10,Vt());lt.addGetterSetter(Xe,"rotateEnabled",!0);lt.addGetterSetter(Xe,"rotateLineVisible",!0);lt.addGetterSetter(Xe,"rotationSnaps",[]);lt.addGetterSetter(Xe,"rotateAnchorOffset",50,Vt());lt.addGetterSetter(Xe,"rotateAnchorCursor","crosshair");lt.addGetterSetter(Xe,"rotationSnapTolerance",5,Vt());lt.addGetterSetter(Xe,"borderEnabled",!0);lt.addGetterSetter(Xe,"anchorStroke","rgb(0, 161, 255)");lt.addGetterSetter(Xe,"anchorStrokeWidth",1,Vt());lt.addGetterSetter(Xe,"anchorFill","white");lt.addGetterSetter(Xe,"anchorCornerRadius",0,Vt());lt.addGetterSetter(Xe,"borderStroke","rgb(0, 161, 255)");lt.addGetterSetter(Xe,"borderStrokeWidth",1,Vt());lt.addGetterSetter(Xe,"borderDash");lt.addGetterSetter(Xe,"keepRatio",!0);lt.addGetterSetter(Xe,"shiftBehavior","default");lt.addGetterSetter(Xe,"centeredScaling",!1);lt.addGetterSetter(Xe,"ignoreStroke",!1);lt.addGetterSetter(Xe,"padding",0,Vt());lt.addGetterSetter(Xe,"nodes");lt.addGetterSetter(Xe,"node");lt.addGetterSetter(Xe,"boundBoxFunc");lt.addGetterSetter(Xe,"anchorDragBoundFunc");lt.addGetterSetter(Xe,"anchorStyleFunc");lt.addGetterSetter(Xe,"shouldOverdrawWholeArea",!1);lt.addGetterSetter(Xe,"useSingleNodeRotation",!0);lt.backCompat(Xe,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class vl extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Ft.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}vl.prototype.className="Wedge";vl.prototype._centroid=!0;vl.prototype._attrsAffectingSize=["radius"];Xn(vl);lt.addGetterSetter(vl,"radius",0,Vt());lt.addGetterSetter(vl,"angle",0,Vt());lt.addGetterSetter(vl,"clockwise",!1);lt.backCompat(vl,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Fy(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const g6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],p6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function m6(l,t){const n=l.data,i=l.width,r=l.height;let o,f,h,g,m,_,C,E,R,v,N,B,L,j,M,G,O,A,T,y;const z=t+t+1,U=i-1,P=r-1,K=t+1,Q=K*(K+1)/2,X=new Fy,Y=g6[t],D=p6[t];let I=null,F=X,W=null,it=null;for(let Z=1;Z<z;Z++)F=F.next=new Fy,Z===K&&(I=F);F.next=X,h=f=0;for(let Z=0;Z<r;Z++){B=L=j=M=g=m=_=C=0,E=K*(G=n[f]),R=K*(O=n[f+1]),v=K*(A=n[f+2]),N=K*(T=n[f+3]),g+=Q*G,m+=Q*O,_+=Q*A,C+=Q*T,F=X;for(let at=0;at<K;at++)F.r=G,F.g=O,F.b=A,F.a=T,F=F.next;for(let at=1;at<K;at++)o=f+((U<at?U:at)<<2),g+=(F.r=G=n[o])*(y=K-at),m+=(F.g=O=n[o+1])*y,_+=(F.b=A=n[o+2])*y,C+=(F.a=T=n[o+3])*y,B+=G,L+=O,j+=A,M+=T,F=F.next;W=X,it=I;for(let at=0;at<i;at++)n[f+3]=T=C*Y>>D,T!==0?(T=255/T,n[f]=(g*Y>>D)*T,n[f+1]=(m*Y>>D)*T,n[f+2]=(_*Y>>D)*T):n[f]=n[f+1]=n[f+2]=0,g-=E,m-=R,_-=v,C-=N,E-=W.r,R-=W.g,v-=W.b,N-=W.a,o=h+((o=at+t+1)<U?o:U)<<2,B+=W.r=n[o],L+=W.g=n[o+1],j+=W.b=n[o+2],M+=W.a=n[o+3],g+=B,m+=L,_+=j,C+=M,W=W.next,E+=G=it.r,R+=O=it.g,v+=A=it.b,N+=T=it.a,B-=G,L-=O,j-=A,M-=T,it=it.next,f+=4;h+=i}for(let Z=0;Z<i;Z++){L=j=M=B=m=_=C=g=0,f=Z<<2,E=K*(G=n[f]),R=K*(O=n[f+1]),v=K*(A=n[f+2]),N=K*(T=n[f+3]),g+=Q*G,m+=Q*O,_+=Q*A,C+=Q*T,F=X;for(let rt=0;rt<K;rt++)F.r=G,F.g=O,F.b=A,F.a=T,F=F.next;let at=i;for(let rt=1;rt<=t;rt++)f=at+Z<<2,g+=(F.r=G=n[f])*(y=K-rt),m+=(F.g=O=n[f+1])*y,_+=(F.b=A=n[f+2])*y,C+=(F.a=T=n[f+3])*y,B+=G,L+=O,j+=A,M+=T,F=F.next,rt<P&&(at+=i);f=Z,W=X,it=I;for(let rt=0;rt<r;rt++)o=f<<2,n[o+3]=T=C*Y>>D,T>0?(T=255/T,n[o]=(g*Y>>D)*T,n[o+1]=(m*Y>>D)*T,n[o+2]=(_*Y>>D)*T):n[o]=n[o+1]=n[o+2]=0,g-=E,m-=R,_-=v,C-=N,E-=W.r,R-=W.g,v-=W.b,N-=W.a,o=Z+((o=rt+K)<P?o:P)*i<<2,g+=B+=W.r=n[o],m+=L+=W.g=n[o+1],_+=j+=W.b=n[o+2],C+=M+=W.a=n[o+3],W=W.next,E+=G=it.r,R+=O=it.g,v+=A=it.b,N+=T=it.a,B-=G,L-=O,j-=A,M-=T,it=it.next,f+=i}}const v6=function(t){const n=Math.round(this.blurRadius());n>0&&m6(t,n)};lt.addGetterSetter(kt,"blurRadius",0,Vt(),lt.afterSetFilter);const y6=function(l){const t=this.brightness()*255,n=l.data,i=n.length;for(let r=0;r<i;r+=4)n[r]+=t,n[r+1]+=t,n[r+2]+=t};lt.addGetterSetter(kt,"brightness",0,Vt(),lt.afterSetFilter);const S6=function(l){const t=this.brightness(),n=l.data,i=n.length;for(let r=0;r<i;r+=4)n[r]=Math.min(255,n[r]*t),n[r+1]=Math.min(255,n[r+1]*t),n[r+2]=Math.min(255,n[r+2]*t)},b6=function(l){const t=Math.pow((this.contrast()+100)/100,2),n=l.data,i=n.length;let r=150,o=150,f=150;for(let h=0;h<i;h+=4)r=n[h],o=n[h+1],f=n[h+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,f/=255,f-=.5,f*=t,f+=.5,f*=255,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,f=f<0?0:f>255?255:f,n[h]=r,n[h+1]=o,n[h+2]=f};lt.addGetterSetter(kt,"contrast",0,Vt(),lt.afterSetFilter);const _6=function(l){var t,n,i,r,o,f,h,g,m;const _=l.data,C=l.width,E=l.height,R=Math.min(1,Math.max(0,(n=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:.5)),v=Math.min(1,Math.max(0,(r=(i=this.embossWhiteLevel)===null||i===void 0?void 0:i.call(this))!==null&&r!==void 0?r:.5)),B=(h={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(f=(o=this.embossDirection)===null||o===void 0?void 0:o.call(this))!==null&&f!==void 0?f:"top-left"])!==null&&h!==void 0?h:315,L=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),j=R*10,M=v*255,G=B*Math.PI/180,O=Math.cos(G),A=Math.sin(G),T=128/1020*j,y=new Uint8ClampedArray(_),z=new Float32Array(C*E);for(let X=0,Y=0;Y<_.length;Y+=4,X++)z[X]=.2126*y[Y]+.7152*y[Y+1]+.0722*y[Y+2];const U=[-1,0,1,-2,0,2,-1,0,1],P=[-1,-2,-1,0,0,0,1,2,1],K=[-C-1,-C,-C+1,-1,0,1,C-1,C,C+1],Q=X=>X<0?0:X>255?255:X;for(let X=1;X<E-1;X++)for(let Y=1;Y<C-1;Y++){const D=X*C+Y;let I=0,F=0;I+=z[D+K[0]]*U[0],F+=z[D+K[0]]*P[0],I+=z[D+K[1]]*U[1],F+=z[D+K[1]]*P[1],I+=z[D+K[2]]*U[2],F+=z[D+K[2]]*P[2],I+=z[D+K[3]]*U[3],F+=z[D+K[3]]*P[3],I+=z[D+K[5]]*U[5],F+=z[D+K[5]]*P[5],I+=z[D+K[6]]*U[6],F+=z[D+K[6]]*P[6],I+=z[D+K[7]]*U[7],F+=z[D+K[7]]*P[7],I+=z[D+K[8]]*U[8],F+=z[D+K[8]]*P[8];const W=O*I+A*F,it=Q(M+W*T),Z=D*4;if(L){const at=it-M;_[Z]=Q(y[Z]+at),_[Z+1]=Q(y[Z+1]+at),_[Z+2]=Q(y[Z+2]+at),_[Z+3]=y[Z+3]}else _[Z]=_[Z+1]=_[Z+2]=it,_[Z+3]=y[Z+3]}for(let X=0;X<C;X++){let Y=X*4,D=((E-1)*C+X)*4;_[Y]=y[Y],_[Y+1]=y[Y+1],_[Y+2]=y[Y+2],_[Y+3]=y[Y+3],_[D]=y[D],_[D+1]=y[D+1],_[D+2]=y[D+2],_[D+3]=y[D+3]}for(let X=1;X<E-1;X++){let Y=X*C*4,D=(X*C+(C-1))*4;_[Y]=y[Y],_[Y+1]=y[Y+1],_[Y+2]=y[Y+2],_[Y+3]=y[Y+3],_[D]=y[D],_[D+1]=y[D+1],_[D+2]=y[D+2],_[D+3]=y[D+3]}return l};lt.addGetterSetter(kt,"embossStrength",.5,Vt(),lt.afterSetFilter);lt.addGetterSetter(kt,"embossWhiteLevel",.5,Vt(),lt.afterSetFilter);lt.addGetterSetter(kt,"embossDirection","top-left",void 0,lt.afterSetFilter);lt.addGetterSetter(kt,"embossBlend",!1,void 0,lt.afterSetFilter);function Np(l,t,n,i,r){const o=n-t,f=r-i;if(o===0)return i+f/2;if(f===0)return i;let h=(l-t)/o;return h=f*h+i,h}const E6=function(l){const t=l.data,n=t.length;let i=t[0],r=i,o,f=t[1],h=f,g,m=t[2],_=m,C;const E=this.enhance();if(E===0)return;for(let M=0;M<n;M+=4)o=t[M+0],o<i?i=o:o>r&&(r=o),g=t[M+1],g<f?f=g:g>h&&(h=g),C=t[M+2],C<m?m=C:C>_&&(_=C);r===i&&(r=255,i=0),h===f&&(h=255,f=0),_===m&&(_=255,m=0);let R,v,N,B,L,j;if(E>0)R=r+E*(255-r),v=i-E*(i-0),N=h+E*(255-h),B=f-E*(f-0),L=_+E*(255-_),j=m-E*(m-0);else{const M=(r+i)*.5;R=r+E*(r-M),v=i+E*(i-M);const G=(h+f)*.5;N=h+E*(h-G),B=f+E*(f-G);const O=(_+m)*.5;L=_+E*(_-O),j=m+E*(m-O)}for(let M=0;M<n;M+=4)t[M+0]=Np(t[M+0],i,r,v,R),t[M+1]=Np(t[M+1],f,h,B,N),t[M+2]=Np(t[M+2],m,_,j,L)};lt.addGetterSetter(kt,"enhance",0,Vt(),lt.afterSetFilter);const C6=function(l){const t=l.data,n=t.length;for(let i=0;i<n;i+=4){const r=.34*t[i]+.5*t[i+1]+.16*t[i+2];t[i]=r,t[i+1]=r,t[i+2]=r}};lt.addGetterSetter(kt,"hue",0,Vt(),lt.afterSetFilter);lt.addGetterSetter(kt,"saturation",0,Vt(),lt.afterSetFilter);lt.addGetterSetter(kt,"luminance",0,Vt(),lt.afterSetFilter);const T6=function(l){const t=l.data,n=t.length,i=1,r=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,f=this.luminance()*127,h=i*r*Math.cos(o*Math.PI/180),g=i*r*Math.sin(o*Math.PI/180),m=.299*i+.701*h+.167*g,_=.587*i-.587*h+.33*g,C=.114*i-.114*h-.497*g,E=.299*i-.299*h-.328*g,R=.587*i+.413*h+.035*g,v=.114*i-.114*h+.293*g,N=.299*i-.3*h+1.25*g,B=.587*i-.586*h-1.05*g,L=.114*i+.886*h-.2*g;let j,M,G,O;for(let A=0;A<n;A+=4)j=t[A+0],M=t[A+1],G=t[A+2],O=t[A+3],t[A+0]=m*j+_*M+C*G+f,t[A+1]=E*j+R*M+v*G+f,t[A+2]=N*j+B*M+L*G+f,t[A+3]=O},A6=function(l){const t=l.data,n=t.length,i=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,f=i*r*Math.cos(o*Math.PI/180),h=i*r*Math.sin(o*Math.PI/180),g=.299*i+.701*f+.167*h,m=.587*i-.587*f+.33*h,_=.114*i-.114*f-.497*h,C=.299*i-.299*f-.328*h,E=.587*i+.413*f+.035*h,R=.114*i-.114*f+.293*h,v=.299*i-.3*f+1.25*h,N=.587*i-.586*f-1.05*h,B=.114*i+.886*f-.2*h;for(let L=0;L<n;L+=4){const j=t[L+0],M=t[L+1],G=t[L+2],O=t[L+3];t[L+0]=g*j+m*M+_*G,t[L+1]=C*j+E*M+R*G,t[L+2]=v*j+N*M+B*G,t[L+3]=O}};lt.addGetterSetter(kt,"hue",0,Vt(),lt.afterSetFilter);lt.addGetterSetter(kt,"saturation",0,Vt(),lt.afterSetFilter);lt.addGetterSetter(kt,"value",0,Vt(),lt.afterSetFilter);const w6=function(l){const t=l.data,n=t.length;for(let i=0;i<n;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]},R6=function(l,t,n){const i=l.data,r=t.data,o=l.width,f=l.height,h=n.polarCenterX||o/2,g=n.polarCenterY||f/2;let m=Math.sqrt(h*h+g*g),_=o-h,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=o,N=360/v*Math.PI/180;for(let B=0;B<v;B+=1){const L=Math.sin(B*N),j=Math.cos(B*N);for(let M=0;M<R;M+=1){_=Math.floor(h+m*M/R*j),C=Math.floor(g+m*M/R*L);let G=(C*o+_)*4;const O=i[G+0],A=i[G+1],T=i[G+2],y=i[G+3];G=(B+M*o)*4,r[G+0]=O,r[G+1]=A,r[G+2]=T,r[G+3]=y}}},O6=function(l,t,n){const i=l.data,r=t.data,o=l.width,f=l.height,h=n.polarCenterX||o/2,g=n.polarCenterY||f/2;let m=Math.sqrt(h*h+g*g),_=o-h,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=o,N=0;let B,L;for(_=0;_<o;_+=1)for(C=0;C<f;C+=1){const j=_-h,M=C-g,G=Math.sqrt(j*j+M*M)*R/m;let O=(Math.atan2(M,j)*180/Math.PI+360+N)%360;O=O*v/360,B=Math.floor(O),L=Math.floor(G);let A=(L*o+B)*4;const T=i[A+0],y=i[A+1],z=i[A+2],U=i[A+3];A=(C*o+_)*4,r[A+0]=T,r[A+1]=y,r[A+2]=z,r[A+3]=U}},x6=function(l){const t=l.width,n=l.height;let i,r,o,f,h,g,m,_,C,E,R=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),N=Math.floor(t*(v%360)/360);if(R<1)return;const B=mt.createCanvasElement();B.width=t,B.height=n;const L=B.getContext("2d").getImageData(0,0,t,n);mt.releaseCanvas(B),R6(l,L,{polarCenterX:t/2,polarCenterY:n/2});let j=t/Math.pow(2,R);for(;j<=8;)j=j*2,R-=1;j=Math.ceil(j);let M=j,G=0,O=M,A=1;for(N+j>t&&(G=M,O=0,A=-1),r=0;r<n;r+=1)for(i=G;i!==O;i+=A)o=Math.round(i+N)%t,C=(t*r+o)*4,h=L.data[C+0],g=L.data[C+1],m=L.data[C+2],_=L.data[C+3],E=(t*r+i)*4,L.data[E+0]=h,L.data[E+1]=g,L.data[E+2]=m,L.data[E+3]=_;for(r=0;r<n;r+=1)for(M=Math.floor(j),f=0;f<R;f+=1){for(i=0;i<M+1;i+=1)C=(t*r+i)*4,h=L.data[C+0],g=L.data[C+1],m=L.data[C+2],_=L.data[C+3],E=(t*r+M*2-i-1)*4,L.data[E+0]=h,L.data[E+1]=g,L.data[E+2]=m,L.data[E+3]=_;M*=2}O6(L,l,{})};lt.addGetterSetter(kt,"kaleidoscopePower",2,Vt(),lt.afterSetFilter);lt.addGetterSetter(kt,"kaleidoscopeAngle",0,Vt(),lt.afterSetFilter);function tg(l,t,n){let i=(n*l.width+t)*4;const r=[];return r.push(l.data[i++],l.data[i++],l.data[i++],l.data[i++]),r}function Jh(l,t){return Math.sqrt(Math.pow(l[0]-t[0],2)+Math.pow(l[1]-t[1],2)+Math.pow(l[2]-t[2],2))}function M6(l){const t=[0,0,0];for(let n=0;n<l.length;n++)t[0]+=l[n][0],t[1]+=l[n][1],t[2]+=l[n][2];return t[0]/=l.length,t[1]/=l.length,t[2]/=l.length,t}function N6(l,t){const n=tg(l,0,0),i=tg(l,l.width-1,0),r=tg(l,0,l.height-1),o=tg(l,l.width-1,l.height-1),f=t||10;if(Jh(n,i)<f&&Jh(i,o)<f&&Jh(o,r)<f&&Jh(r,n)<f){const h=M6([i,n,o,r]),g=[];for(let m=0;m<l.width*l.height;m++){const _=Jh(h,[l.data[m*4],l.data[m*4+1],l.data[m*4+2]]);g[m]=_<f?0:255}return g}}function j6(l,t){for(let n=0;n<l.width*l.height;n++)l.data[4*n+3]=t[n]}function D6(l,t,n){const i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),f=[];for(let h=0;h<n;h++)for(let g=0;g<t;g++){const m=h*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=h+C-o,v=g+E-o;if(R>=0&&R<n&&v>=0&&v<t){const N=R*t+v,B=i[C*r+E];_+=l[N]*B}}f[m]=_===2040?255:0}return f}function U6(l,t,n){const i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),f=[];for(let h=0;h<n;h++)for(let g=0;g<t;g++){const m=h*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=h+C-o,v=g+E-o;if(R>=0&&R<n&&v>=0&&v<t){const N=R*t+v,B=i[C*r+E];_+=l[N]*B}}f[m]=_>=1020?255:0}return f}function B6(l,t,n){const i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),f=[];for(let h=0;h<n;h++)for(let g=0;g<t;g++){const m=h*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=h+C-o,v=g+E-o;if(R>=0&&R<n&&v>=0&&v<t){const N=R*t+v,B=i[C*r+E];_+=l[N]*B}}f[m]=_}return f}const z6=function(l){const t=this.threshold();let n=N6(l,t);return n&&(n=D6(n,l.width,l.height),n=U6(n,l.width,l.height),n=B6(n,l.width,l.height),j6(l,n)),l};lt.addGetterSetter(kt,"threshold",0,Vt(),lt.afterSetFilter);const L6=function(l){const t=this.noise()*255,n=l.data,i=n.length,r=t/2;for(let o=0;o<i;o+=4)n[o+0]+=r-2*r*Math.random(),n[o+1]+=r-2*r*Math.random(),n[o+2]+=r-2*r*Math.random()};lt.addGetterSetter(kt,"noise",.2,Vt(),lt.afterSetFilter);const G6=function(l){let t=Math.ceil(this.pixelSize()),n=l.width,i=l.height,r=Math.ceil(n/t),o=Math.ceil(i/t),f=l.data;if(t<=0){mt.error("pixelSize value can not be <= 0");return}for(let h=0;h<r;h+=1)for(let g=0;g<o;g+=1){let m=0,_=0,C=0,E=0;const R=h*t,v=R+t,N=g*t,B=N+t;let L=0;for(let j=R;j<v;j+=1)if(!(j>=n))for(let M=N;M<B;M+=1){if(M>=i)continue;const G=(n*M+j)*4;m+=f[G+0],_+=f[G+1],C+=f[G+2],E+=f[G+3],L+=1}m=m/L,_=_/L,C=C/L,E=E/L;for(let j=R;j<v;j+=1)if(!(j>=n))for(let M=N;M<B;M+=1){if(M>=i)continue;const G=(n*M+j)*4;f[G+0]=m,f[G+1]=_,f[G+2]=C,f[G+3]=E}}};lt.addGetterSetter(kt,"pixelSize",8,Vt(),lt.afterSetFilter);const P6=function(l){const t=Math.round(this.levels()*254)+1,n=l.data,i=n.length,r=255/t;for(let o=0;o<i;o+=1)n[o]=Math.floor(n[o]/r)*r};lt.addGetterSetter(kt,"levels",.5,Vt(),lt.afterSetFilter);const H6=function(l){const t=l.data,n=t.length,i=this.red(),r=this.green(),o=this.blue();for(let f=0;f<n;f+=4){const h=(.34*t[f]+.5*t[f+1]+.16*t[f+2])/255;t[f]=h*i,t[f+1]=h*r,t[f+2]=h*o,t[f+3]=t[f+3]}};lt.addGetterSetter(kt,"red",0,function(l){return this._filterUpToDate=!1,l>255?255:l<0?0:Math.round(l)});lt.addGetterSetter(kt,"green",0,function(l){return this._filterUpToDate=!1,l>255?255:l<0?0:Math.round(l)});lt.addGetterSetter(kt,"blue",0,D2,lt.afterSetFilter);const I6=function(l){const t=l.data,n=t.length,i=this.red(),r=this.green(),o=this.blue(),f=this.alpha();for(let h=0;h<n;h+=4){const g=1-f;t[h]=i*f+t[h]*g,t[h+1]=r*f+t[h+1]*g,t[h+2]=o*f+t[h+2]*g}};lt.addGetterSetter(kt,"red",0,function(l){return this._filterUpToDate=!1,l>255?255:l<0?0:Math.round(l)});lt.addGetterSetter(kt,"green",0,function(l){return this._filterUpToDate=!1,l>255?255:l<0?0:Math.round(l)});lt.addGetterSetter(kt,"blue",0,D2,lt.afterSetFilter);lt.addGetterSetter(kt,"alpha",1,function(l){return this._filterUpToDate=!1,l>1?1:l<0?0:l});const k6=function(l){const t=l.data,n=t.length;for(let i=0;i<n;i+=4){const r=t[i+0],o=t[i+1],f=t[i+2];t[i+0]=Math.min(255,r*.393+o*.769+f*.189),t[i+1]=Math.min(255,r*.349+o*.686+f*.168),t[i+2]=Math.min(255,r*.272+o*.534+f*.131)}},q6=function(l){const n=l.data;for(let i=0;i<n.length;i+=4){const r=n[i],o=n[i+1],f=n[i+2];.2126*r+.7152*o+.0722*f>=128&&(n[i]=255-r,n[i+1]=255-o,n[i+2]=255-f)}return l},V6=function(l){const t=this.threshold()*255,n=l.data,i=n.length;for(let r=0;r<i;r+=1)n[r]=n[r]<t?0:255};lt.addGetterSetter(kt,"threshold",.5,Vt(),lt.afterSetFilter);hf.Util._assign(hf,{Arc:pl,Arrow:Eu,Circle:Sf,Ellipse:go,Image:Qr,Label:ev,Tag:Cu,Line:ml,Path:Un,Rect:yd,RegularPolygon:po,Ring:Tu,Sprite:Es,Star:mo,Text:Gn,TextPath:Ti,Transformer:Xe,Wedge:vl,Filters:{Blur:v6,Brightness:S6,Brighten:y6,Contrast:b6,Emboss:_6,Enhance:E6,Grayscale:C6,HSL:T6,HSV:A6,Invert:w6,Kaleidoscope:x6,Mask:z6,Noise:L6,Pixelate:G6,Posterize:P6,RGB:H6,RGBA:I6,Sepia:k6,Solarize:q6,Threshold:V6}});var jp={exports:{}},Dp={exports:{}},Up={exports:{}},Bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy;function Y6(){return Jy||(Jy=1,(function(l){function t(D,I){var F=D.length;D.push(I);t:for(;0<F;){var W=F-1>>>1,it=D[W];if(0<r(it,I))D[W]=I,D[F]=it,F=W;else break t}}function n(D){return D.length===0?null:D[0]}function i(D){if(D.length===0)return null;var I=D[0],F=D.pop();if(F!==I){D[0]=F;t:for(var W=0,it=D.length,Z=it>>>1;W<Z;){var at=2*(W+1)-1,rt=D[at],V=at+1,J=D[V];if(0>r(rt,F))V<it&&0>r(J,rt)?(D[W]=J,D[V]=F,W=V):(D[W]=rt,D[at]=F,W=at);else if(V<it&&0>r(J,F))D[W]=J,D[V]=F,W=V;else break t}}return I}function r(D,I){var F=D.sortIndex-I.sortIndex;return F!==0?F:D.id-I.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;l.unstable_now=function(){return o.now()}}else{var f=Date,h=f.now();l.unstable_now=function(){return f.now()-h}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,N=!1,B=!1,L=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(D){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=D)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(D){if(N=!1,G(D),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-D)}}var A=!1,T=-1,y=5,z=-1;function U(){return B?!0:!(l.unstable_now()-z<y)}function P(){if(B=!1,A){var D=l.unstable_now();z=D;var I=!0;try{t:{v=!1,N&&(N=!1,j(T),T=-1),R=!0;var F=E;try{e:{for(G(D),C=n(g);C!==null&&!(C.expirationTime>D&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=D);if(D=l.unstable_now(),typeof it=="function"){C.callback=it,G(D),I=!0;break e}C===n(g)&&i(g),G(D)}else i(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-D),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=P,K=function(){X.postMessage(null)}}else K=function(){L(P,0)};function Y(D,I){T=L(function(){D(l.unstable_now())},I)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(D){D.callback=null},l.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<D?Math.floor(1e3/D):5},l.unstable_getCurrentPriorityLevel=function(){return E},l.unstable_next=function(D){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return D()}finally{E=F}},l.unstable_requestPaint=function(){B=!0},l.unstable_runWithPriority=function(D,I){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=E;E=D;try{return I()}finally{E=F}},l.unstable_scheduleCallback=function(D,I,F){var W=l.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,D){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,D={id:_++,callback:I,priorityLevel:D,startTime:F,expirationTime:it,sortIndex:-1},F>W?(D.sortIndex=F,t(m,D),n(g)===null&&D===n(m)&&(N?(j(T),T=-1):N=!0,Y(O,F-W))):(D.sortIndex=it,t(g,D),v||R||(v=!0,A||(A=!0,K()))),D},l.unstable_shouldYield=U,l.unstable_wrapCallback=function(D){var I=E;return function(){var F=E;E=I;try{return D.apply(this,arguments)}finally{E=F}}}})(Bp)),Bp}var Zy;function K6(){return Zy||(Zy=1,Up.exports=Y6()),Up.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function Q6(){return Wy||(Wy=1,(function(l){l.exports=function(t){function n(s,u,p,S){return new uc(s,u,p,S)}function i(){}function r(s){var u="https://react.dev/errors/"+s;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){var u=s,p=s;if(s.alternate)for(;u.return;)u=u.return;else{s=u;do u=s,(u.flags&4098)!==0&&(p=u.return),s=u.return;while(s)}return u.tag===3?p:null}function f(s){if(o(s)!==s)throw Error(r(188))}function h(s){var u=s.alternate;if(!u){if(u=o(s),u===null)throw Error(r(188));return u!==s?null:s}for(var p=s,S=u;;){var x=p.return;if(x===null)break;var H=x.alternate;if(H===null){if(S=x.return,S!==null){p=S;continue}break}if(x.child===H.child){for(H=x.child;H;){if(H===p)return f(x),s;if(H===S)return f(x),u;H=H.sibling}throw Error(r(188))}if(p.return!==S.return)p=x,S=H;else{for(var et=!1,ut=x.child;ut;){if(ut===p){et=!0,p=x,S=H;break}if(ut===S){et=!0,S=x,p=H;break}ut=ut.sibling}if(!et){for(ut=H.child;ut;){if(ut===p){et=!0,p=H,S=x;break}if(ut===S){et=!0,S=H,p=x;break}ut=ut.sibling}if(!et)throw Error(r(189))}}if(p.alternate!==S)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:u}function g(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(u=g(s),u!==null)return u;s=s.sibling}return null}function m(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(s.tag!==4&&(u=m(s),u!==null))return u;s=s.sibling}return null}function _(s){return s===null||typeof s!="object"?null:(s=Ko&&s[Ko]||s["@@iterator"],typeof s=="function"?s:null)}function C(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Qo?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case zs:return"Fragment";case qo:return"Profiler";case Ls:return"StrictMode";case xr:return"Suspense";case Mr:return"SuspenseList";case ss:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case Rr:return"Portal";case Or:return(s.displayName||"Context")+".Provider";case Vo:return(s._context.displayName||"Context")+".Consumer";case gc:var u=s.render;return s=s.displayName,s||(s=u.displayName||u.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case pc:return u=s.displayName||null,u!==null?u:C(s.type)||"Memo";case Nr:u=s._payload,s=s._init;try{return C(s(u))}catch{}}return null}function E(s){return{current:s}}function R(s){0>Vs||(s.current=tu[Vs],tu[Vs]=null,Vs--)}function v(s,u){Vs++,tu[Vs]=s.current,s.current=u}function N(s){return s>>>=0,s===0?32:31-(S0(s)/b0|0)|0}function B(s){var u=s&42;if(u!==0)return u;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function L(s,u,p){var S=s.pendingLanes;if(S===0)return 0;var x=0,H=s.suspendedLanes,et=s.pingedLanes;s=s.warmLanes;var ut=S&134217727;return ut!==0?(S=ut&~H,S!==0?x=B(S):(et&=ut,et!==0?x=B(et):p||(p=ut&~s,p!==0&&(x=B(p))))):(ut=S&~H,ut!==0?x=B(ut):et!==0?x=B(et):p||(p=S&~s,p!==0&&(x=B(p)))),x===0?0:u!==0&&u!==x&&(u&H)===0&&(H=x&-x,p=u&-u,H>=p||H===32&&(p&4194048)!==0)?u:x}function j(s,u){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&u)===0}function M(s,u){switch(s){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G(){var s=sr;return sr<<=1,(sr&4194048)===0&&(sr=256),s}function O(){var s=eu;return eu<<=1,(eu&62914560)===0&&(eu=4194304),s}function A(s){for(var u=[],p=0;31>p;p++)u.push(s);return u}function T(s,u){s.pendingLanes|=u,u!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function y(s,u,p,S,x,H){var et=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ut=s.entanglements,_t=s.expirationTimes,zt=s.hiddenUpdates;for(p=et&~p;0<p;){var Pt=31-Bi(p),Jt=1<<Pt;ut[Pt]=0,_t[Pt]=-1;var ee=zt[Pt];if(ee!==null)for(zt[Pt]=null,Pt=0;Pt<ee.length;Pt++){var xe=ee[Pt];xe!==null&&(xe.lane&=-536870913)}p&=~Jt}S!==0&&z(s,S,0),H!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=H&~(et&~u))}function z(s,u,p){s.pendingLanes|=u,s.suspendedLanes&=~u;var S=31-Bi(u);s.entangledLanes|=u,s.entanglements[S]=s.entanglements[S]|1073741824|p&4194090}function U(s,u){var p=s.entangledLanes|=u;for(s=s.entanglements;p;){var S=31-Bi(p),x=1<<S;x&u|s[S]&u&&(s[S]|=u),p&=~x}}function P(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function K(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Q(s){if(typeof ti=="function"&&yi(s),Fi&&typeof Fi.setStrictMode=="function")try{Fi.setStrictMode(kl,s)}catch{}}function X(s){if(jc===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);jc=u&&u[1]||"",Oh=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+jc+s+Oh}function Y(s,u){if(!s||Ys)return"";Ys=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(u){var Jt=function(){throw Error()};if(Object.defineProperty(Jt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Jt,[])}catch(xe){var ee=xe}Reflect.construct(s,[],Jt)}else{try{Jt.call()}catch(xe){ee=xe}s.call(Jt.prototype)}}else{try{throw Error()}catch(xe){ee=xe}(Jt=s())&&typeof Jt.catch=="function"&&Jt.catch(function(){})}}catch(xe){if(xe&&ee&&typeof xe.stack=="string")return[xe.stack,ee.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var H=S.DetermineComponentFrameRoot(),et=H[0],ut=H[1];if(et&&ut){var _t=et.split(`
`),zt=ut.split(`
`);for(x=S=0;S<_t.length&&!_t[S].includes("DetermineComponentFrameRoot");)S++;for(;x<zt.length&&!zt[x].includes("DetermineComponentFrameRoot");)x++;if(S===_t.length||x===zt.length)for(S=_t.length-1,x=zt.length-1;1<=S&&0<=x&&_t[S]!==zt[x];)x--;for(;1<=S&&0<=x;S--,x--)if(_t[S]!==zt[x]){if(S!==1||x!==1)do if(S--,x--,0>x||_t[S]!==zt[x]){var Pt=`
`+_t[S].replace(" at new "," at ");return s.displayName&&Pt.includes("<anonymous>")&&(Pt=Pt.replace("<anonymous>",s.displayName)),Pt}while(1<=S&&0<=x);break}}}finally{Ys=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?X(p):""}function D(s){switch(s.tag){case 26:case 27:case 5:return X(s.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return Y(s.type,!1);case 11:return Y(s.type.render,!1);case 1:return Y(s.type,!0);case 31:return X("Activity");default:return""}}function I(s){try{var u="";do u+=D(s),s=s.return;while(s);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function F(s,u){if(typeof s=="object"&&s!==null){var p=xh.get(s);return p!==void 0?p:(u={value:s,source:u,stack:I(u)},xh.set(s,u),u)}return{value:s,source:u,stack:I(u)}}function W(s,u){Ur[Ks++]=Qs,Ur[Ks++]=Dc,Dc=s,Qs=u}function it(s,u,p){Ji[ha++]=lr,Ji[ha++]=za,Ji[ha++]=ds,ds=s;var S=lr;s=za;var x=32-Bi(S)-1;S&=~(1<<x),p+=1;var H=32-Bi(u)+x;if(30<H){var et=x-x%5;H=(S&(1<<et)-1).toString(32),S>>=et,x-=et,lr=1<<32-Bi(u)+x|p<<x|S,za=H+s}else lr=1<<H|p<<x|S,za=s}function Z(s){s.return!==null&&(W(s,1),it(s,1,0))}function at(s){for(;s===Dc;)Dc=Ur[--Ks],Ur[Ks]=null,Qs=Ur[--Ks],Ur[Ks]=null;for(;s===ds;)ds=Ji[--ha],Ji[ha]=null,za=Ji[--ha],Ji[ha]=null,lr=Ji[--ha],Ji[ha]=null}function rt(s,u){v(Br,u),v(Xs,s),v(ii,null),s=ah(u),R(ii),v(ii,s)}function V(){R(ii),R(Xs),R(Br)}function J(s){s.memoizedState!==null&&v(ql,s);var u=ii.current,p=ls(u,s.type);u!==p&&(v(Xs,s),v(ii,p))}function $(s){Xs.current===s&&(R(ii),R(Xs)),ql.current===s&&(R(ql),tr?_a._currentValue=Dr:_a._currentValue2=Dr)}function nt(s){var u=Error(r(418,""));throw ae(F(u,s)),Ga}function dt(s,u){if(!Mn)throw Error(r(175));l0(s.stateNode,s.type,s.memoizedProps,u,s)||nt(s)}function wt(s){for(li=s.return;li;)switch(li.tag){case 5:case 13:La=!1;return;case 27:case 3:La=!0;return;default:li=li.return}}function Ut(s){if(!Mn||s!==li)return!1;if(!Fe)return wt(s),Fe=!0,!1;var u=s.tag;if(Vn?u!==3&&u!==27&&(u!==5||wc(s.type)&&!us(s.type,s.memoizedProps))&&Yn&&nt(s):u!==3&&(u!==5||wc(s.type)&&!us(s.type,s.memoizedProps))&&Yn&&nt(s),wt(s),u===13){if(!Mn)throw Error(r(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Yn=o0(s)}else Yn=Vn&&u===27?i0(s.type,Yn):li?yh(s.stateNode):null;return!0}function It(){Mn&&(Yn=li=null,Fe=!1)}function ne(){var s=zr;return s!==null&&(Oi===null?Oi=s:Oi.push.apply(Oi,s),zr=null),s}function ae(s){zr===null?zr=[s]:zr.push(s)}function Lt(s,u){return s===u&&(s!==0||1/s===1/u)||s!==s&&u!==u}function _e(s,u,p){tr?(v(Uc,u._currentValue),u._currentValue=p):(v(Uc,u._currentValue2),u._currentValue2=p)}function we(s){var u=Uc.current;tr?s._currentValue=u:s._currentValue2=u,R(Uc)}function Ze(s,u,p){for(;s!==null;){var S=s.alternate;if((s.childLanes&u)!==u?(s.childLanes|=u,S!==null&&(S.childLanes|=u)):S!==null&&(S.childLanes&u)!==u&&(S.childLanes|=u),s===p)break;s=s.return}}function He(s,u,p,S){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var H=x.dependencies;if(H!==null){var et=x.child;H=H.firstContext;t:for(;H!==null;){var ut=H;H=x;for(var _t=0;_t<u.length;_t++)if(ut.context===u[_t]){H.lanes|=p,ut=H.alternate,ut!==null&&(ut.lanes|=p),Ze(H.return,p,s),S||(et=null);break t}H=ut.next}}else if(x.tag===18){if(et=x.return,et===null)throw Error(r(341));et.lanes|=p,H=et.alternate,H!==null&&(H.lanes|=p),Ze(et,p,s),et=null}else et=x.child;if(et!==null)et.return=x;else for(et=x;et!==null;){if(et===s){et=null;break}if(x=et.sibling,x!==null){x.return=et.return,et=x;break}et=et.return}x=et}}function gn(s,u,p,S){s=null;for(var x=u,H=!1;x!==null;){if(!H){if((x.flags&524288)!==0)H=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var et=x.alternate;if(et===null)throw Error(r(387));if(et=et.memoizedProps,et!==null){var ut=x.type;zi(x.pendingProps.value,et.value)||(s!==null?s.push(ut):s=[ut])}}else if(x===ql.current){if(et=x.alternate,et===null)throw Error(r(387));et.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(_a):s=[_a])}x=x.return}s!==null&&He(u,s,p,S),u.flags|=262144}function Pn(s){for(s=s.firstContext;s!==null;){var u=s.context;if(!zi(tr?u._currentValue:u._currentValue2,s.memoizedValue))return!0;s=s.next}return!1}function Ot(s){gs=s,Si=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Kt(s){return ye(gs,s)}function je(s,u){return gs===null&&Ot(s),ye(s,u)}function ye(s,u){var p=tr?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},Si===null){if(s===null)throw Error(r(308));Si=u,s.dependencies={lanes:0,firstContext:u},s.flags|=524288}else Si=Si.next=u;return p}function We(){return{controller:new Mh,data:new Map,refCount:0}}function an(s){s.refCount--,s.refCount===0&&C0(Bc,function(){s.controller.abort()})}function ge(s){s!==Vl&&s.next===null&&(Vl===null?hn=Vl=s:Vl=Vl.next=s),iu=!0,Nh||(Nh=!0,vt())}function ct(s,u){if(!Fs&&iu){Fs=!0;do for(var p=!1,S=hn;S!==null;){if(s!==0){var x=S.pendingLanes;if(x===0)var H=0;else{var et=S.suspendedLanes,ut=S.pingedLanes;H=(1<<31-Bi(42|s)+1)-1,H&=x&~(et&~ut),H=H&201326741?H&201326741|1:H?H|2:0}H!==0&&(p=!0,ht(S,H))}else H=Le,H=L(S,S===dn?H:0,S.cancelPendingCommit!==null||S.timeoutHandle!==$a),(H&3)===0||j(S,H)||(p=!0,ht(S,H));S=S.next}while(p);Fs=!1}}function At(){Mt()}function Mt(){iu=Nh=!1;var s=0;da!==0&&(ua()&&(s=da),da=0);for(var u=fa(),p=null,S=hn;S!==null;){var x=S.next,H=qt(S,u);H===0?(S.next=null,p===null?hn=x:p.next=x,x===null&&(Vl=p)):(p=S,(s!==0||(H&3)!==0)&&(iu=!0)),S=x}ct(s)}function qt(s,u){for(var p=s.suspendedLanes,S=s.pingedLanes,x=s.expirationTimes,H=s.pendingLanes&-62914561;0<H;){var et=31-Bi(H),ut=1<<et,_t=x[et];_t===-1?((ut&p)===0||(ut&S)!==0)&&(x[et]=M(ut,u)):_t<=u&&(s.expiredLanes|=ut),H&=~ut}if(u=dn,p=Le,p=L(s,s===u?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==$a),S=s.callbackNode,p===0||s===u&&(Ke===2||Ke===9)||s.cancelPendingCommit!==null)return S!==null&&S!==null&&Mc(S),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||j(s,p)){if(u=p&-p,u===s.callbackPriority)return u;switch(S!==null&&Mc(S),K(p)){case 2:case 8:p=E0;break;case 32:p=wh;break;case 268435456:p=Rh;break;default:p=wh}return S=pe.bind(null,s),p=nu(p,S),s.callbackPriority=u,s.callbackNode=p,u}return S!==null&&S!==null&&Mc(S),s.callbackPriority=2,s.callbackNode=null,2}function pe(s,u){if(rn!==0&&rn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(js()&&s.callbackNode!==p)return null;var S=Le;return S=L(s,s===dn?S:0,s.cancelPendingCommit!==null||s.timeoutHandle!==$a),S===0?null:(sa(s,S,u),qt(s,fa()),s.callbackNode!=null&&s.callbackNode===p?pe.bind(null,s):null)}function ht(s,u){if(js())return null;sa(s,u,!0)}function vt(){vc?Jo(function(){(Ue&6)!==0?nu(Ah,At):Mt()}):nu(Ah,At)}function Rt(){return da===0&&(da=G()),da}function ue(s,u){if(Yl===null){var p=Yl=[];zc=0,or=Rt(),Li={status:"pending",value:void 0,then:function(S){p.push(S)}}}return zc++,u.then(ce,ce),u}function ce(){if(--zc===0&&Yl!==null){Li!==null&&(Li.status="fulfilled");var s=Yl;Yl=null,or=0,Li=null;for(var u=0;u<s.length;u++)(0,s[u])()}}function Zt(s,u){var p=[],S={status:"pending",value:null,reason:null,then:function(x){p.push(x)}};return s.then(function(){S.status="fulfilled",S.value=u;for(var x=0;x<p.length;x++)(0,p[x])(u)},function(x){for(S.status="rejected",S.reason=x,x=0;x<p.length;x++)(0,p[x])(void 0)}),S}function he(){var s=Lr.current;return s!==null?s:dn.pooledCache}function fe(s,u){u===null?v(Lr,Lr.current):v(Lr,u.pool)}function Be(){var s=he();return s===null?null:{parent:tr?Sn._currentValue:Sn._currentValue2,pool:s}}function $e(s,u){if(zi(s,u))return!0;if(typeof s!="object"||s===null||typeof u!="object"||u===null)return!1;var p=Object.keys(s),S=Object.keys(u);if(p.length!==S.length)return!1;for(S=0;S<p.length;S++){var x=p[S];if(!T0.call(u,x)||!zi(s[x],u[x]))return!1}return!0}function Fn(s){return s=s.status,s==="fulfilled"||s==="rejected"}function na(){}function Ii(s,u,p){switch(p=s[p],p===void 0?s.push(u):p!==u&&(u.then(na,na),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,So(s),s;default:if(typeof u.status=="string")u.then(na,na);else{if(s=dn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=u,s.status="pending",s.then(function(S){if(u.status==="pending"){var x=u;x.status="fulfilled",x.value=S}},function(S){if(u.status==="pending"){var x=u;x.status="rejected",x.reason=S}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,So(s),s}throw Zi=u,Js}}function yl(){if(Zi===null)throw Error(r(459));var s=Zi;return Zi=null,s}function So(s){if(s===Js||s===Zs)throw Error(r(483))}function ki(){for(var s=ps,u=Lc=ps=0;u<s;){var p=en[u];en[u++]=null;var S=en[u];en[u++]=null;var x=en[u];en[u++]=null;var H=en[u];if(en[u++]=null,S!==null&&x!==null){var et=S.pending;et===null?x.next=x:(x.next=et.next,et.next=x),S.pending=x}H!==0&&Wt(p,x,H)}}function Aa(s,u,p,S){en[ps++]=s,en[ps++]=u,en[ps++]=p,en[ps++]=S,Lc|=S,s.lanes|=S,s=s.alternate,s!==null&&(s.lanes|=S)}function Dt(s,u,p,S){return Aa(s,u,p,S),$t(s)}function Bt(s,u){return Aa(s,null,null,u),$t(s)}function Wt(s,u,p){s.lanes|=p;var S=s.alternate;S!==null&&(S.lanes|=p);for(var x=!1,H=s.return;H!==null;)H.childLanes|=p,S=H.alternate,S!==null&&(S.childLanes|=p),H.tag===22&&(s=H.stateNode,s===null||s._visibility&1||(x=!0)),s=H,H=H.return;return s.tag===3?(H=s.stateNode,x&&u!==null&&(x=31-Bi(p),s=H.hiddenUpdates,S=s[x],S===null?s[x]=[u]:S.push(u),u.lane=p|536870912),H):null}function $t(s){if(50<gr)throw gr=0,kc=null,Error(r(185));for(var u=s.return;u!==null;)s=u,u=s.return;return s.tag===3?s.stateNode:null}function Yt(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function pn(s,u){s=s.updateQueue,u.updateQueue===s&&(u.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function xn(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function mn(s,u,p){var S=s.updateQueue;if(S===null)return null;if(S=S.shared,(Ue&2)!==0){var x=S.pending;return x===null?u.next=u:(u.next=x.next,x.next=u),S.pending=u,u=$t(s),Wt(s,null,p),u}return Aa(s,S,u,p),$t(s)}function Xt(s,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function te(s,u){var p=s.updateQueue,S=s.alternate;if(S!==null&&(S=S.updateQueue,p===S)){var x=null,H=null;if(p=p.firstBaseUpdate,p!==null){do{var et={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};H===null?x=H=et:H=H.next=et,p=p.next}while(p!==null);H===null?x=H=u:H=H.next=u}else x=H=u;p={baseState:S.baseState,firstBaseUpdate:x,lastBaseUpdate:H,shared:S.shared,callbacks:S.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=u:s.next=u,p.lastBaseUpdate=u}function re(){if(Dh){var s=Li;if(s!==null)throw s}}function oe(s,u,p,S){Dh=!1;var x=s.updateQueue;An=!1;var H=x.firstBaseUpdate,et=x.lastBaseUpdate,ut=x.shared.pending;if(ut!==null){x.shared.pending=null;var _t=ut,zt=_t.next;_t.next=null,et===null?H=zt:et.next=zt,et=_t;var Pt=s.alternate;Pt!==null&&(Pt=Pt.updateQueue,ut=Pt.lastBaseUpdate,ut!==et&&(ut===null?Pt.firstBaseUpdate=zt:ut.next=zt,Pt.lastBaseUpdate=_t))}if(H!==null){var Jt=x.baseState;et=0,Pt=zt=_t=null,ut=H;do{var ee=ut.lane&-536870913,xe=ee!==ut.lane;if(xe?(Le&ee)===ee:(S&ee)===ee){ee!==0&&ee===or&&(Dh=!0),Pt!==null&&(Pt=Pt.next={lane:0,tag:ut.tag,payload:ut.payload,callback:null,next:null});t:{var pa=s,Fl=ut;ee=u;var ys=p;switch(Fl.tag){case 1:if(pa=Fl.payload,typeof pa=="function"){Jt=pa.call(ys,Jt,ee);break t}Jt=pa;break t;case 3:pa.flags=pa.flags&-65537|128;case 0:if(pa=Fl.payload,ee=typeof pa=="function"?pa.call(ys,Jt,ee):pa,ee==null)break t;Jt=hc({},Jt,ee);break t;case 2:An=!0}}ee=ut.callback,ee!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=x.callbacks,xe===null?x.callbacks=[ee]:xe.push(ee))}else xe={lane:ee,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null},Pt===null?(zt=Pt=xe,_t=Jt):Pt=Pt.next=xe,et|=ee;if(ut=ut.next,ut===null){if(ut=x.shared.pending,ut===null)break;xe=ut,ut=xe.next,xe.next=null,x.lastBaseUpdate=xe,x.shared.pending=null}}while(!0);Pt===null&&(_t=Jt),x.baseState=_t,x.firstBaseUpdate=zt,x.lastBaseUpdate=Pt,H===null&&(x.shared.lanes=0),Pi|=et,s.lanes=et,s.memoizedState=Jt}}function Re(s,u){if(typeof s!="function")throw Error(r(191,s));s.call(u)}function tn(s,u){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Re(p[s],u)}function Hn(s,u){s=Ta,v(su,s),v(Ws,u),Ta=s|u.baseLanes}function Bn(){v(su,Ta),v(Ws,Ws.current)}function wa(){Ta=su.current,R(Ws),R(su)}function on(){throw Error(r(321))}function Ra(s,u){if(u===null)return!1;for(var p=0;p<u.length&&p<s.length;p++)if(!zi(s[p],u[p]))return!1;return!0}function Oa(s,u,p,S,x,H){return nn=H,ve=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,me.H=s===null||s.memoizedState===null?Uh:ur,tl=!1,H=p(S,x),tl=!1,$s&&(H=Ya(u,p,S,x)),yr(s),H}function yr(s){me.H=bi;var u=ke!==null&&ke.next!==null;if(nn=0,Kn=ke=ve=null,lu=!1,oi=0,wi=null,u)throw Error(r(300));s===null||ai||(s=s.dependencies,s!==null&&Pn(s)&&(ai=!0))}function Ya(s,u,p,S){ve=s;var x=0;do{if($s&&(wi=null),oi=0,$s=!1,25<=x)throw Error(r(301));if(x+=1,Kn=ke=null,s.updateQueue!=null){var H=s.updateQueue;H.lastEffect=null,H.events=null,H.stores=null,H.memoCache!=null&&(H.memoCache.index=0)}me.H=nl,H=u(p,S)}while($s);return H}function ri(){var s=me.H,u=s.useState()[0];return u=typeof u.then=="function"?Sl(u):u,s=s.useState()[0],(ke!==null?ke.memoizedState:null)!==s&&(ve.flags|=1024),u}function xu(){var s=el!==0;return el=0,s}function Mu(s,u,p){u.updateQueue=s.updateQueue,u.flags&=-2053,s.lanes&=~p}function Sr(s){if(lu){for(s=s.memoizedState;s!==null;){var u=s.queue;u!==null&&(u.pending=null),s=s.next}lu=!1}nn=0,Kn=ke=ve=null,$s=!1,oi=el=0,wi=null}function ni(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?ve.memoizedState=Kn=s:Kn=Kn.next=s,Kn}function Jn(){if(ke===null){var s=ve.alternate;s=s!==null?s.memoizedState:null}else s=ke.next;var u=Kn===null?ve.memoizedState:Kn.next;if(u!==null)Kn=u,ke=s;else{if(s===null)throw ve.alternate===null?Error(r(467)):Error(r(310));ke=s,s={memoizedState:ke.memoizedState,baseState:ke.baseState,baseQueue:ke.baseQueue,queue:ke.queue,next:null},Kn===null?ve.memoizedState=Kn=s:Kn=Kn.next=s}return Kn}function Nu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sl(s){var u=oi;return oi+=1,wi===null&&(wi=[]),s=Ii(wi,s,u),u=ve,(Kn===null?u.memoizedState:Kn.next)===null&&(u=u.alternate,me.H=u===null||u.memoizedState===null?Uh:ur),s}function ju(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Sl(s);if(s.$$typeof===Or)return Kt(s)}throw Error(r(438,String(s)))}function bl(s){var u=null,p=ve.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var S=ve.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(u={data:S.data.map(function(x){return x.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Nu(),ve.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(s),S=0;S<s;S++)p[S]=Yo;return u.index++,p}function ma(s,u){return typeof u=="function"?u(s):u}function va(s){var u=Jn();return qi(u,ke,s)}function qi(s,u,p){var S=s.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=p;var x=s.baseQueue,H=S.pending;if(H!==null){if(x!==null){var et=x.next;x.next=H.next,H.next=et}u.baseQueue=x=H,S.pending=null}if(H=s.baseState,x===null)s.memoizedState=H;else{u=x.next;var ut=et=null,_t=null,zt=u,Pt=!1;do{var Jt=zt.lane&-536870913;if(Jt!==zt.lane?(Le&Jt)===Jt:(nn&Jt)===Jt){var ee=zt.revertLane;if(ee===0)_t!==null&&(_t=_t.next={lane:0,revertLane:0,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null}),Jt===or&&(Pt=!0);else if((nn&ee)===ee){zt=zt.next,ee===or&&(Pt=!0);continue}else Jt={lane:0,revertLane:zt.revertLane,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},_t===null?(ut=_t=Jt,et=H):_t=_t.next=Jt,ve.lanes|=ee,Pi|=ee;Jt=zt.action,tl&&p(H,Jt),H=zt.hasEagerState?zt.eagerState:p(H,Jt)}else ee={lane:Jt,revertLane:zt.revertLane,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},_t===null?(ut=_t=ee,et=H):_t=_t.next=ee,ve.lanes|=Jt,Pi|=Jt;zt=zt.next}while(zt!==null&&zt!==u);if(_t===null?et=H:_t.next=ut,!zi(H,s.memoizedState)&&(ai=!0,Pt&&(p=Li,p!==null)))throw p;s.memoizedState=H,s.baseState=et,s.baseQueue=_t,S.lastRenderedState=H}return x===null&&(S.lanes=0),[s.memoizedState,S.dispatch]}function Du(s){var u=Jn(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var S=p.dispatch,x=p.pending,H=u.memoizedState;if(x!==null){p.pending=null;var et=x=x.next;do H=s(H,et.action),et=et.next;while(et!==x);zi(H,u.memoizedState)||(ai=!0),u.memoizedState=H,u.baseQueue===null&&(u.baseState=H),p.lastRenderedState=H}return[H,S]}function bd(s,u,p){var S=ve,x=Jn(),H=Fe;if(H){if(p===void 0)throw Error(r(407));p=p()}else p=u();var et=!zi((ke||x).memoizedState,p);et&&(x.memoizedState=p,ai=!0),x=x.queue;var ut=bo.bind(null,S,x,s);if(Ka(2048,8,ut,[s]),x.getSnapshot!==u||et||Kn!==null&&Kn.memoizedState.tag&1){if(S.flags|=2048,Vi(9,_l(),Cf.bind(null,S,x,p,u),null),dn===null)throw Error(r(349));H||(nn&124)!==0||Uu(S,u,p)}return p}function Uu(s,u,p){s.flags|=16384,s={getSnapshot:u,value:p},u=ve.updateQueue,u===null?(u=Nu(),ve.updateQueue=u,u.stores=[s]):(p=u.stores,p===null?u.stores=[s]:p.push(s))}function Cf(s,u,p,S){u.value=p,u.getSnapshot=S,_d(u)&&ia(s)}function bo(s,u,p){return p(function(){_d(u)&&ia(s)})}function _d(s){var u=s.getSnapshot;s=s.value;try{var p=u();return!zi(s,p)}catch{return!0}}function ia(s){var u=Bt(s,2);u!==null&&Qi(u,s,2)}function _o(s){var u=ni();if(typeof s=="function"){var p=s;if(s=p(),tl){Q(!0);try{p()}finally{Q(!1)}}}return u.memoizedState=u.baseState=s,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:s},u}function Tf(s,u,p,S){return s.baseState=p,qi(s,ke,typeof S=="function"?S:ma)}function Af(s,u,p,S,x){if(Jr(s))throw Error(r(485));if(s=u.action,s!==null){var H={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(et){H.listeners.push(et)}};me.T!==null?p(!0):H.isTransition=!1,S(H),p=u.pending,p===null?(H.next=u.pending=H,Cs(u,H)):(H.next=p.next,u.pending=p.next=H)}}function Cs(s,u){var p=u.action,S=u.payload,x=s.state;if(u.isTransition){var H=me.T,et={};me.T=et;try{var ut=p(x,S),_t=me.S;_t!==null&&_t(et,ut),wf(s,u,ut)}catch(zt){Xr(s,u,zt)}finally{me.T=H}}else try{H=p(x,S),wf(s,u,H)}catch(zt){Xr(s,u,zt)}}function wf(s,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(S){Rf(s,u,S)},function(S){return Xr(s,u,S)}):Rf(s,u,p)}function Rf(s,u,p){u.status="fulfilled",u.value=p,Ed(u),s.state=p,u=s.pending,u!==null&&(p=u.next,p===u?s.pending=null:(p=p.next,u.next=p,Cs(s,p)))}function Xr(s,u,p){var S=s.pending;if(s.pending=null,S!==null){S=S.next;do u.status="rejected",u.reason=p,Ed(u),u=u.next;while(u!==S)}s.action=null}function Ed(s){s=s.listeners;for(var u=0;u<s.length;u++)(0,s[u])()}function Of(s,u){return u}function xf(s,u){if(Fe){var p=dn.formState;if(p!==null){t:{var S=ve;if(Fe){if(Yn){var x=e0(Yn,La);if(x){Yn=yh(x),S=n0(x);break t}}nt(S)}S=!1}S&&(u=p[0])}}p=ni(),p.memoizedState=p.baseState=u,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Of,lastRenderedState:u},p.queue=S,p=Td.bind(null,ve,S),S.dispatch=p,S=_o(!1);var H=wo.bind(null,ve,!1,S.queue);return S=ni(),x={state:u,dispatch:null,action:s,pending:null},S.queue=x,p=Af.bind(null,ve,x,H,p),x.dispatch=p,S.memoizedState=s,[u,p,!1]}function Bu(s){var u=Jn();return Cd(u,ke,s)}function Cd(s,u,p){if(u=qi(s,u,Of)[0],s=va(ma)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var S=Sl(u)}catch(et){throw et===Js?Zs:et}else S=u;u=Jn();var x=u.queue,H=x.dispatch;return p!==u.memoizedState&&(ve.flags|=2048,Vi(9,_l(),Ug.bind(null,x,p),null)),[S,H,s]}function Ug(s,u){s.action=u}function Eo(s){var u=Jn(),p=ke;if(p!==null)return Cd(u,p,s);Jn(),u=u.memoizedState,p=Jn();var S=p.queue.dispatch;return p.memoizedState=s,[u,S,!1]}function Vi(s,u,p,S){return s={tag:s,create:p,deps:S,inst:u,next:null},u=ve.updateQueue,u===null&&(u=Nu(),ve.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=s.next=s:(S=p.next,p.next=s,s.next=S,u.lastEffect=s),s}function _l(){return{destroy:void 0,resource:void 0}}function zu(){return Jn().memoizedState}function br(s,u,p,S){var x=ni();S=S===void 0?null:S,ve.flags|=s,x.memoizedState=Vi(1|u,_l(),p,S)}function Ka(s,u,p,S){var x=Jn();S=S===void 0?null:S;var H=x.memoizedState.inst;ke!==null&&S!==null&&Ra(S,ke.memoizedState.deps)?x.memoizedState=Vi(u,H,p,S):(ve.flags|=s,x.memoizedState=Vi(1|u,H,p,S))}function Mf(s,u){br(8390656,8,s,u)}function Lu(s,u){Ka(2048,8,s,u)}function Nf(s,u){return Ka(4,2,s,u)}function El(s,u){return Ka(4,4,s,u)}function Qa(s,u){if(typeof u=="function"){s=s();var p=u(s);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return s=s(),u.current=s,function(){u.current=null}}function Gu(s,u,p){p=p!=null?p.concat([s]):null,Ka(4,4,Qa.bind(null,u,s),p)}function Ts(){}function _r(s,u){var p=Jn();u=u===void 0?null:u;var S=p.memoizedState;return u!==null&&Ra(u,S[1])?S[0]:(p.memoizedState=[s,u],s)}function Pu(s,u){var p=Jn();u=u===void 0?null:u;var S=p.memoizedState;if(u!==null&&Ra(u,S[1]))return S[0];if(S=s(),tl){Q(!0);try{s()}finally{Q(!1)}}return p.memoizedState=[S,u],S}function Cl(s,u,p){return p===void 0||(nn&1073741824)!==0?s.memoizedState=u:(s.memoizedState=p,s=rc(),ve.lanes|=s,Pi|=s,p)}function jf(s,u,p,S){return zi(p,u)?p:Ws.current!==null?(s=Cl(s,p,S),zi(s,u)||(ai=!0),s):(nn&42)===0?(ai=!0,s.memoizedState=p):(s=rc(),ve.lanes|=s,Pi|=s,u)}function Co(s,u,p,S,x){var H=nr();Wn(H!==0&&8>H?H:8);var et=me.T,ut={};me.T=ut,wo(s,!1,u,p);try{var _t=x(),zt=me.S;if(zt!==null&&zt(ut,_t),_t!==null&&typeof _t=="object"&&typeof _t.then=="function"){var Pt=Zt(_t,S);As(s,u,Pt,Ki(s))}else As(s,u,S,Ki(s))}catch(Jt){As(s,u,{then:function(){},status:"rejected",reason:Jt},Ki())}finally{Wn(H),me.T=et}}function To(s){var u=s.memoizedState;if(u!==null)return u;u={memoizedState:Dr,baseState:Dr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:Dr},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:p},next:null},s.memoizedState=u,s=s.alternate,s!==null&&(s.memoizedState=u),u}function Hu(){return Kt(_a)}function Mi(){return Jn().memoizedState}function Fr(){return Jn().memoizedState}function Iu(s){for(var u=s.return;u!==null;){switch(u.tag){case 24:case 3:var p=Ki();s=xn(p);var S=mn(u,s,p);S!==null&&(Qi(S,u,p),Xt(S,u,p)),u={cache:We()},s.payload=u;return}u=u.return}}function Ao(s,u,p){var S=Ki();p={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Jr(s)?Ro(u,p):(p=Dt(s,u,p,S),p!==null&&(Qi(p,s,S),Df(p,u,S)))}function Td(s,u,p){var S=Ki();As(s,u,p,S)}function As(s,u,p,S){var x={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Jr(s))Ro(u,x);else{var H=s.alternate;if(s.lanes===0&&(H===null||H.lanes===0)&&(H=u.lastRenderedReducer,H!==null))try{var et=u.lastRenderedState,ut=H(et,p);if(x.hasEagerState=!0,x.eagerState=ut,zi(ut,et))return Aa(s,u,x,0),dn===null&&ki(),!1}catch{}finally{}if(p=Dt(s,u,x,S),p!==null)return Qi(p,s,S),Df(p,u,S),!0}return!1}function wo(s,u,p,S){if(S={lane:2,revertLane:Rt(),action:S,hasEagerState:!1,eagerState:null,next:null},Jr(s)){if(u)throw Error(r(479))}else u=Dt(s,p,S,2),u!==null&&Qi(u,s,2)}function Jr(s){var u=s.alternate;return s===ve||u!==null&&u===ve}function Ro(s,u){$s=lu=!0;var p=s.pending;p===null?u.next=u:(u.next=p.next,p.next=u),s.pending=u}function Df(s,u,p){if((p&4194048)!==0){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function ku(s){var u=il;return il+=1,Wi===null&&(Wi=[]),Ii(Wi,s,u)}function Oo(s,u){u=u.props.ref,s.ref=u!==void 0?u:null}function qu(s,u){throw u.$$typeof===Bs?Error(r(525)):(s=Object.prototype.toString.call(u),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":s)))}function Vu(s){var u=s._init;return u(s._payload)}function Ad(s){function u(bt,gt){if(s){var Ct=bt.deletions;Ct===null?(bt.deletions=[gt],bt.flags|=16):Ct.push(gt)}}function p(bt,gt){if(!s)return null;for(;gt!==null;)u(bt,gt),gt=gt.sibling;return null}function S(bt){for(var gt=new Map;bt!==null;)bt.key!==null?gt.set(bt.key,bt):gt.set(bt.index,bt),bt=bt.sibling;return gt}function x(bt,gt){return bt=Tn(bt,gt),bt.index=0,bt.sibling=null,bt}function H(bt,gt,Ct){return bt.index=Ct,s?(Ct=bt.alternate,Ct!==null?(Ct=Ct.index,Ct<gt?(bt.flags|=67108866,gt):Ct):(bt.flags|=67108866,gt)):(bt.flags|=1048576,gt)}function et(bt){return s&&bt.alternate===null&&(bt.flags|=67108866),bt}function ut(bt,gt,Ct,Ht){return gt===null||gt.tag!==6?(gt=nh(Ct,bt.mode,Ht),gt.return=bt,gt):(gt=x(gt,Ct),gt.return=bt,gt)}function _t(bt,gt,Ct,Ht){var Qt=Ct.type;return Qt===zs?Pt(bt,gt,Ct.props.children,Ht,Ct.key):gt!==null&&(gt.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===Nr&&Vu(Qt)===gt.type)?(gt=x(gt,Ct.props),Oo(gt,Ct),gt.return=bt,gt):(gt=ko(Ct.type,Ct.key,Ct.props,null,bt.mode,Ht),Oo(gt,Ct),gt.return=bt,gt)}function zt(bt,gt,Ct,Ht){return gt===null||gt.tag!==4||gt.stateNode.containerInfo!==Ct.containerInfo||gt.stateNode.implementation!==Ct.implementation?(gt=ih(Ct,bt.mode,Ht),gt.return=bt,gt):(gt=x(gt,Ct.children||[]),gt.return=bt,gt)}function Pt(bt,gt,Ct,Ht,Qt){return gt===null||gt.tag!==7?(gt=Ds(Ct,bt.mode,Ht,Qt),gt.return=bt,gt):(gt=x(gt,Ct),gt.return=bt,gt)}function Jt(bt,gt,Ct){if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return gt=nh(""+gt,bt.mode,Ct),gt.return=bt,gt;if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case Ll:return Ct=ko(gt.type,gt.key,gt.props,null,bt.mode,Ct),Oo(Ct,gt),Ct.return=bt,Ct;case Rr:return gt=ih(gt,bt.mode,Ct),gt.return=bt,gt;case Nr:var Ht=gt._init;return gt=Ht(gt._payload),Jt(bt,gt,Ct)}if(Gs(gt)||_(gt))return gt=Ds(gt,bt.mode,Ct,null),gt.return=bt,gt;if(typeof gt.then=="function")return Jt(bt,ku(gt),Ct);if(gt.$$typeof===Or)return Jt(bt,je(bt,gt),Ct);qu(bt,gt)}return null}function ee(bt,gt,Ct,Ht){var Qt=gt!==null?gt.key:null;if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return Qt!==null?null:ut(bt,gt,""+Ct,Ht);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case Ll:return Ct.key===Qt?_t(bt,gt,Ct,Ht):null;case Rr:return Ct.key===Qt?zt(bt,gt,Ct,Ht):null;case Nr:return Qt=Ct._init,Ct=Qt(Ct._payload),ee(bt,gt,Ct,Ht)}if(Gs(Ct)||_(Ct))return Qt!==null?null:Pt(bt,gt,Ct,Ht,null);if(typeof Ct.then=="function")return ee(bt,gt,ku(Ct),Ht);if(Ct.$$typeof===Or)return ee(bt,gt,je(bt,Ct),Ht);qu(bt,Ct)}return null}function xe(bt,gt,Ct,Ht,Qt){if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number"||typeof Ht=="bigint")return bt=bt.get(Ct)||null,ut(gt,bt,""+Ht,Qt);if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case Ll:return bt=bt.get(Ht.key===null?Ct:Ht.key)||null,_t(gt,bt,Ht,Qt);case Rr:return bt=bt.get(Ht.key===null?Ct:Ht.key)||null,zt(gt,bt,Ht,Qt);case Nr:var vn=Ht._init;return Ht=vn(Ht._payload),xe(bt,gt,Ct,Ht,Qt)}if(Gs(Ht)||_(Ht))return bt=bt.get(Ct)||null,Pt(gt,bt,Ht,Qt,null);if(typeof Ht.then=="function")return xe(bt,gt,Ct,ku(Ht),Qt);if(Ht.$$typeof===Or)return xe(bt,gt,Ct,je(gt,Ht),Qt);qu(gt,Ht)}return null}function pa(bt,gt,Ct,Ht){for(var Qt=null,vn=null,Te=gt,Qe=gt=0,ci=null;Te!==null&&Qe<Ct.length;Qe++){Te.index>Qe?(ci=Te,Te=null):ci=Te.sibling;var Je=ee(bt,Te,Ct[Qe],Ht);if(Je===null){Te===null&&(Te=ci);break}s&&Te&&Je.alternate===null&&u(bt,Te),gt=H(Je,gt,Qe),vn===null?Qt=Je:vn.sibling=Je,vn=Je,Te=ci}if(Qe===Ct.length)return p(bt,Te),Fe&&W(bt,Qe),Qt;if(Te===null){for(;Qe<Ct.length;Qe++)Te=Jt(bt,Ct[Qe],Ht),Te!==null&&(gt=H(Te,gt,Qe),vn===null?Qt=Te:vn.sibling=Te,vn=Te);return Fe&&W(bt,Qe),Qt}for(Te=S(Te);Qe<Ct.length;Qe++)ci=xe(Te,bt,Qe,Ct[Qe],Ht),ci!==null&&(s&&ci.alternate!==null&&Te.delete(ci.key===null?Qe:ci.key),gt=H(ci,gt,Qe),vn===null?Qt=ci:vn.sibling=ci,vn=ci);return s&&Te.forEach(function(Ss){return u(bt,Ss)}),Fe&&W(bt,Qe),Qt}function Fl(bt,gt,Ct,Ht){if(Ct==null)throw Error(r(151));for(var Qt=null,vn=null,Te=gt,Qe=gt=0,ci=null,Je=Ct.next();Te!==null&&!Je.done;Qe++,Je=Ct.next()){Te.index>Qe?(ci=Te,Te=null):ci=Te.sibling;var Ss=ee(bt,Te,Je.value,Ht);if(Ss===null){Te===null&&(Te=ci);break}s&&Te&&Ss.alternate===null&&u(bt,Te),gt=H(Ss,gt,Qe),vn===null?Qt=Ss:vn.sibling=Ss,vn=Ss,Te=ci}if(Je.done)return p(bt,Te),Fe&&W(bt,Qe),Qt;if(Te===null){for(;!Je.done;Qe++,Je=Ct.next())Je=Jt(bt,Je.value,Ht),Je!==null&&(gt=H(Je,gt,Qe),vn===null?Qt=Je:vn.sibling=Je,vn=Je);return Fe&&W(bt,Qe),Qt}for(Te=S(Te);!Je.done;Qe++,Je=Ct.next())Je=xe(Te,bt,Qe,Je.value,Ht),Je!==null&&(s&&Je.alternate!==null&&Te.delete(Je.key===null?Qe:Je.key),gt=H(Je,gt,Qe),vn===null?Qt=Je:vn.sibling=Je,vn=Je);return s&&Te.forEach(function(qc){return u(bt,qc)}),Fe&&W(bt,Qe),Qt}function ys(bt,gt,Ct,Ht){if(typeof Ct=="object"&&Ct!==null&&Ct.type===zs&&Ct.key===null&&(Ct=Ct.props.children),typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case Ll:t:{for(var Qt=Ct.key;gt!==null;){if(gt.key===Qt){if(Qt=Ct.type,Qt===zs){if(gt.tag===7){p(bt,gt.sibling),Ht=x(gt,Ct.props.children),Ht.return=bt,bt=Ht;break t}}else if(gt.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===Nr&&Vu(Qt)===gt.type){p(bt,gt.sibling),Ht=x(gt,Ct.props),Oo(Ht,Ct),Ht.return=bt,bt=Ht;break t}p(bt,gt);break}else u(bt,gt);gt=gt.sibling}Ct.type===zs?(Ht=Ds(Ct.props.children,bt.mode,Ht,Ct.key),Ht.return=bt,bt=Ht):(Ht=ko(Ct.type,Ct.key,Ct.props,null,bt.mode,Ht),Oo(Ht,Ct),Ht.return=bt,bt=Ht)}return et(bt);case Rr:t:{for(Qt=Ct.key;gt!==null;){if(gt.key===Qt)if(gt.tag===4&&gt.stateNode.containerInfo===Ct.containerInfo&&gt.stateNode.implementation===Ct.implementation){p(bt,gt.sibling),Ht=x(gt,Ct.children||[]),Ht.return=bt,bt=Ht;break t}else{p(bt,gt);break}else u(bt,gt);gt=gt.sibling}Ht=ih(Ct,bt.mode,Ht),Ht.return=bt,bt=Ht}return et(bt);case Nr:return Qt=Ct._init,Ct=Qt(Ct._payload),ys(bt,gt,Ct,Ht)}if(Gs(Ct))return pa(bt,gt,Ct,Ht);if(_(Ct)){if(Qt=_(Ct),typeof Qt!="function")throw Error(r(150));return Ct=Qt.call(Ct),Fl(bt,gt,Ct,Ht)}if(typeof Ct.then=="function")return ys(bt,gt,ku(Ct),Ht);if(Ct.$$typeof===Or)return ys(bt,gt,je(bt,Ct),Ht);qu(bt,Ct)}return typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint"?(Ct=""+Ct,gt!==null&&gt.tag===6?(p(bt,gt.sibling),Ht=x(gt,Ct),Ht.return=bt,bt=Ht):(p(bt,gt),Ht=nh(Ct,bt.mode,Ht),Ht.return=bt,bt=Ht),et(bt)):p(bt,gt)}return function(bt,gt,Ct,Ht){try{il=0;var Qt=ys(bt,gt,Ct,Ht);return Wi=null,Qt}catch(Te){if(Te===Js||Te===Zs)throw Te;var vn=n(29,Te,null,bt.mode);return vn.lanes=Ht,vn.return=bt,vn}finally{}}}function Zr(s){var u=s.alternate;v(Ln,Ln.current&1),v(ga,s),Gi===null&&(u===null||Ws.current!==null||u.memoizedState!==null)&&(Gi=s)}function wd(s){if(s.tag===22){if(v(Ln,Ln.current),v(ga,s),Gi===null){var u=s.alternate;u!==null&&u.memoizedState!==null&&(Gi=s)}}else Wr()}function Wr(){v(Ln,Ln.current),v(ga,ga.current)}function Er(s){R(ga),Gi===s&&(Gi=null),R(Ln)}function xo(s){for(var u=s;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Ec(p)||Cc(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function Uf(s,u,p,S){u=s.memoizedState,p=p(S,u),p=p==null?u:hc({},u,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}function Rd(s,u,p,S,x,H,et){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(S,H,et):u.prototype&&u.prototype.isPureReactComponent?!$e(p,S)||!$e(x,H):!0}function Od(s,u,p,S){s=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,S),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,S),u.state!==s&&al.enqueueReplaceState(u,u.state,null)}function ws(s,u){var p=u;if("ref"in u){p={};for(var S in u)S!=="ref"&&(p[S]=u[S])}if(s=s.defaultProps){p===u&&(p=hc({},p));for(var x in s)p[x]===void 0&&(p[x]=s[x])}return p}function Tl(s,u){try{var p=s.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(S){setTimeout(function(){throw S})}}function xd(s,u,p){try{var S=s.onCaughtError;S(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Bf(s,u,p){return p=xn(p),p.tag=3,p.payload={element:null},p.callback=function(){Tl(s,u)},p}function Md(s){return s=xn(s),s.tag=3,s}function zf(s,u,p,S){var x=p.type.getDerivedStateFromError;if(typeof x=="function"){var H=S.value;s.payload=function(){return x(H)},s.callback=function(){xd(u,p,S)}}var et=p.stateNode;et!==null&&typeof et.componentDidCatch=="function"&&(s.callback=function(){xd(u,p,S),typeof x!="function"&&(Hr===null?Hr=new Set([this]):Hr.add(this));var ut=S.stack;this.componentDidCatch(S.value,{componentStack:ut!==null?ut:""})})}function Bg(s,u,p,S,x){if(p.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(u=p.alternate,u!==null&&gn(u,p,x,!0),p=ga.current,p!==null){switch(p.tag){case 13:return Gi===null?sc():p.alternate===null&&wn===0&&(wn=3),p.flags&=-257,p.flags|=65536,p.lanes=x,S===ru?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([S]):u.add(S),Ba(s,S,x)),!1;case 22:return p.flags|=65536,S===ru?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([S])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([S]):p.add(S)),Ba(s,S,x)),!1}throw Error(r(435,p.tag))}return Ba(s,S,x),sc(),!1}if(Fe)return u=ga.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=x,S!==Ga&&(s=Error(r(422),{cause:S}),ae(F(s,p)))):(S!==Ga&&(u=Error(r(423),{cause:S}),ae(F(u,p))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,S=F(S,p),x=Bf(s.stateNode,S,x),te(s,x),wn!==4&&(wn=2)),!1;var H=Error(r(520),{cause:S});if(H=F(H,p),ll===null?ll=[H]:ll.push(H),wn!==4&&(wn=2),u===null)return!0;S=F(S,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,s=x&-x,p.lanes|=s,s=Bf(p.stateNode,S,s),te(p,s),!1;case 1:if(u=p.type,H=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Hr===null||!Hr.has(H))))return p.flags|=65536,x&=-x,p.lanes|=x,x=Md(x),zf(x,s,p,S),te(p,x),!1}p=p.return}while(p!==null);return!1}function hi(s,u,p,S){u.child=s===null?Ea(u,null,p,S):ms(u,s.child,p,S)}function Nd(s,u,p,S,x){p=p.render;var H=u.ref;if("ref"in S){var et={};for(var ut in S)ut!=="ref"&&(et[ut]=S[ut])}else et=S;return Ot(u),S=Oa(s,u,p,et,H,x),ut=xu(),s!==null&&!ai?(Mu(s,u,x),Xa(s,u,x)):(Fe&&ut&&Z(u),u.flags|=1,hi(s,u,S,x),u.child)}function jd(s,u,p,S,x){if(s===null){var H=p.type;return typeof H=="function"&&!wr(H)&&H.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=H,Dd(s,u,H,S,x)):(s=ko(p.type,null,S,u,u.mode,x),s.ref=u.ref,s.return=u,u.child=s)}if(H=s.child,!Ju(s,x)){var et=H.memoizedProps;if(p=p.compare,p=p!==null?p:$e,p(et,S)&&s.ref===u.ref)return Xa(s,u,x)}return u.flags|=1,s=Tn(H,S),s.ref=u.ref,s.return=u,u.child=s}function Dd(s,u,p,S,x){if(s!==null){var H=s.memoizedProps;if($e(H,S)&&s.ref===u.ref)if(ai=!1,u.pendingProps=S=H,Ju(s,x))(s.flags&131072)!==0&&(ai=!0);else return u.lanes=s.lanes,Xa(s,u,x)}return Lf(s,u,p,S,x)}function Ud(s,u,p){var S=u.pendingProps,x=S.children,H=s!==null?s.memoizedState:null;if(S.mode==="hidden"){if((u.flags&128)!==0){if(S=H!==null?H.baseLanes|p:p,s!==null){for(x=u.child=s.child,H=0;x!==null;)H=H|x.lanes|x.childLanes,x=x.sibling;u.childLanes=H&~S}else u.childLanes=0,u.child=null;return Bd(s,u,S,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},s!==null&&fe(u,H!==null?H.cachePool:null),H!==null?Hn(u,H):Bn(),wd(u);else return u.lanes=u.childLanes=536870912,Bd(s,u,H!==null?H.baseLanes|p:p,p)}else H!==null?(fe(u,H.cachePool),Hn(u,H),Wr(),u.memoizedState=null):(s!==null&&fe(u,null),Bn(),Wr());return hi(s,u,x,p),u.child}function Bd(s,u,p,S){var x=he();return x=x===null?null:{parent:tr?Sn._currentValue:Sn._currentValue2,pool:x},u.memoizedState={baseLanes:p,cachePool:x},s!==null&&fe(u,null),Bn(),wd(u),s!==null&&gn(s,u,S,!0),null}function Yu(s,u){var p=u.ref;if(p===null)s!==null&&s.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(u.flags|=4194816)}}function Lf(s,u,p,S,x){return Ot(u),p=Oa(s,u,p,S,void 0,x),S=xu(),s!==null&&!ai?(Mu(s,u,x),Xa(s,u,x)):(Fe&&S&&Z(u),u.flags|=1,hi(s,u,p,x),u.child)}function Ku(s,u,p,S,x,H){return Ot(u),u.updateQueue=null,p=Ya(u,S,p,x),yr(s),S=xu(),s!==null&&!ai?(Mu(s,u,H),Xa(s,u,H)):(Fe&&S&&Z(u),u.flags|=1,hi(s,u,p,H),u.child)}function Al(s,u,p,S,x){if(Ot(u),u.stateNode===null){var H=hs,et=p.contextType;typeof et=="object"&&et!==null&&(H=Kt(et)),H=new p(S,H),u.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,H.updater=al,u.stateNode=H,H._reactInternals=u,H=u.stateNode,H.props=S,H.state=u.memoizedState,H.refs={},Yt(u),et=p.contextType,H.context=typeof et=="object"&&et!==null?Kt(et):hs,H.state=u.memoizedState,et=p.getDerivedStateFromProps,typeof et=="function"&&(Uf(u,p,et,S),H.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(et=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),et!==H.state&&al.enqueueReplaceState(H,H.state,null),oe(u,S,H,x),re(),H.state=u.memoizedState),typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!0}else if(s===null){H=u.stateNode;var ut=u.memoizedProps,_t=ws(p,ut);H.props=_t;var zt=H.context,Pt=p.contextType;et=hs,typeof Pt=="object"&&Pt!==null&&(et=Kt(Pt));var Jt=p.getDerivedStateFromProps;Pt=typeof Jt=="function"||typeof H.getSnapshotBeforeUpdate=="function",ut=u.pendingProps!==ut,Pt||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ut||zt!==et)&&Od(u,H,S,et),An=!1;var ee=u.memoizedState;H.state=ee,oe(u,S,H,x),re(),zt=u.memoizedState,ut||ee!==zt||An?(typeof Jt=="function"&&(Uf(u,p,Jt,S),zt=u.memoizedState),(_t=An||Rd(u,p,_t,S,ee,zt,et))?(Pt||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(u.flags|=4194308)):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=S,u.memoizedState=zt),H.props=S,H.state=zt,H.context=et,S=_t):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!1)}else{H=u.stateNode,pn(s,u),et=u.memoizedProps,Pt=ws(p,et),H.props=Pt,Jt=u.pendingProps,ee=H.context,zt=p.contextType,_t=hs,typeof zt=="object"&&zt!==null&&(_t=Kt(zt)),ut=p.getDerivedStateFromProps,(zt=typeof ut=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(et!==Jt||ee!==_t)&&Od(u,H,S,_t),An=!1,ee=u.memoizedState,H.state=ee,oe(u,S,H,x),re();var xe=u.memoizedState;et!==Jt||ee!==xe||An||s!==null&&s.dependencies!==null&&Pn(s.dependencies)?(typeof ut=="function"&&(Uf(u,p,ut,S),xe=u.memoizedState),(Pt=An||Rd(u,p,Pt,S,ee,xe,_t)||s!==null&&s.dependencies!==null&&Pn(s.dependencies))?(zt||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(S,xe,_t),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(S,xe,_t)),typeof H.componentDidUpdate=="function"&&(u.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof H.componentDidUpdate!="function"||et===s.memoizedProps&&ee===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&ee===s.memoizedState||(u.flags|=1024),u.memoizedProps=S,u.memoizedState=xe),H.props=S,H.state=xe,H.context=_t,S=Pt):(typeof H.componentDidUpdate!="function"||et===s.memoizedProps&&ee===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&ee===s.memoizedState||(u.flags|=1024),S=!1)}return H=S,Yu(s,u),S=(u.flags&128)!==0,H||S?(H=u.stateNode,p=S&&typeof p.getDerivedStateFromError!="function"?null:H.render(),u.flags|=1,s!==null&&S?(u.child=ms(u,s.child,null,x),u.child=ms(u,null,p,x)):hi(s,u,p,x),u.memoizedState=H.state,s=u.child):s=Xa(s,u,x),s}function zd(s,u,p,S){return It(),u.flags|=256,hi(s,u,p,S),u.child}function Qu(s){return{baseLanes:s,cachePool:Be()}}function Xu(s,u,p){return s=s!==null?s.childLanes&~p:0,u&&(s|=_i),s}function Gf(s,u,p){var S=u.pendingProps,x=!1,H=(u.flags&128)!==0,et;if((et=H)||(et=s!==null&&s.memoizedState===null?!1:(Ln.current&2)!==0),et&&(x=!0,u.flags&=-129),et=(u.flags&32)!==0,u.flags&=-33,s===null){if(Fe){if(x?Zr(u):Wr(),Fe){var ut=Yn,_t;(_t=ut)&&(ut=Ac(ut,La),ut!==null?(u.memoizedState={dehydrated:ut,treeContext:ds!==null?{id:lr,overflow:za}:null,retryLane:536870912,hydrationErrors:null},_t=n(18,null,null,0),_t.stateNode=ut,_t.return=u,u.child=_t,li=u,Yn=null,_t=!0):_t=!1),_t||nt(u)}if(ut=u.memoizedState,ut!==null&&(ut=ut.dehydrated,ut!==null))return Cc(ut)?u.lanes=32:u.lanes=536870912,null;Er(u)}return ut=S.children,S=S.fallback,x?(Wr(),x=u.mode,ut=Mo({mode:"hidden",children:ut},x),S=Ds(S,x,p,null),ut.return=u,S.return=u,ut.sibling=S,u.child=ut,x=u.child,x.memoizedState=Qu(p),x.childLanes=Xu(s,et,p),u.memoizedState=sl,S):(Zr(u),Fu(u,ut))}if(_t=s.memoizedState,_t!==null&&(ut=_t.dehydrated,ut!==null)){if(H)u.flags&256?(Zr(u),u.flags&=-257,u=$r(s,u,p)):u.memoizedState!==null?(Wr(),u.child=s.child,u.flags|=128,u=null):(Wr(),x=S.fallback,ut=u.mode,S=Mo({mode:"visible",children:S.children},ut),x=Ds(x,ut,p,null),x.flags|=2,S.return=u,x.return=u,S.sibling=x,u.child=S,ms(u,s.child,null,p),S=u.child,S.memoizedState=Qu(p),S.childLanes=Xu(s,et,p),u.memoizedState=sl,u=x);else if(Zr(u),Cc(ut))et=t0(ut).digest,S=Error(r(419)),S.stack="",S.digest=et,ae({value:S,source:null,stack:null}),u=$r(s,u,p);else if(ai||gn(s,u,p,!1),et=(p&s.childLanes)!==0,ai||et){if(et=dn,et!==null&&(S=p&-p,S=(S&42)!==0?1:P(S),S=(S&(et.suspendedLanes|p))!==0?0:S,S!==0&&S!==_t.retryLane))throw _t.retryLane=S,Bt(s,S),Qi(et,s,S),Bh;Ec(ut)||sc(),u=$r(s,u,p)}else Ec(ut)?(u.flags|=192,u.child=s.child,u=null):(s=_t.treeContext,Mn&&(Yn=r0(ut),li=u,Fe=!0,zr=null,La=!1,s!==null&&(Ji[ha++]=lr,Ji[ha++]=za,Ji[ha++]=ds,lr=s.id,za=s.overflow,ds=u)),u=Fu(u,S.children),u.flags|=4096);return u}return x?(Wr(),x=S.fallback,ut=u.mode,_t=s.child,H=_t.sibling,S=Tn(_t,{mode:"hidden",children:S.children}),S.subtreeFlags=_t.subtreeFlags&65011712,H!==null?x=Tn(H,x):(x=Ds(x,ut,p,null),x.flags|=2),x.return=u,S.return=u,S.sibling=x,u.child=S,S=x,x=u.child,ut=s.child.memoizedState,ut===null?ut=Qu(p):(_t=ut.cachePool,_t!==null?(H=tr?Sn._currentValue:Sn._currentValue2,_t=_t.parent!==H?{parent:H,pool:H}:_t):_t=Be(),ut={baseLanes:ut.baseLanes|p,cachePool:_t}),x.memoizedState=ut,x.childLanes=Xu(s,et,p),u.memoizedState=sl,S):(Zr(u),p=s.child,s=p.sibling,p=Tn(p,{mode:"visible",children:S.children}),p.return=u,p.sibling=null,s!==null&&(et=u.deletions,et===null?(u.deletions=[s],u.flags|=16):et.push(s)),u.child=p,u.memoizedState=null,p)}function Fu(s,u){return u=Mo({mode:"visible",children:u},s.mode),u.return=s,s.child=u}function Mo(s,u){return s=n(22,s,null,u),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function $r(s,u,p){return ms(u,s.child,null,p),s=Fu(u,u.pendingProps.children),s.flags|=2,u.memoizedState=null,s}function Ld(s,u,p){s.lanes|=u;var S=s.alternate;S!==null&&(S.lanes|=u),Ze(s.return,u,p)}function Pf(s,u,p,S,x){var H=s.memoizedState;H===null?s.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:S,tail:p,tailMode:x}:(H.isBackwards=u,H.rendering=null,H.renderingStartTime=0,H.last=S,H.tail=p,H.tailMode=x)}function Gd(s,u,p){var S=u.pendingProps,x=S.revealOrder,H=S.tail;if(hi(s,u,S.children,p),S=Ln.current,(S&2)!==0)S=S&1|2,u.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=u.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ld(s,p,u);else if(s.tag===19)Ld(s,p,u);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===u)break t;for(;s.sibling===null;){if(s.return===null||s.return===u)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}S&=1}switch(v(Ln,S),x){case"forwards":for(p=u.child,x=null;p!==null;)s=p.alternate,s!==null&&xo(s)===null&&(x=p),p=p.sibling;p=x,p===null?(x=u.child,u.child=null):(x=p.sibling,p.sibling=null),Pf(u,!1,x,p,H);break;case"backwards":for(p=null,x=u.child,u.child=null;x!==null;){if(s=x.alternate,s!==null&&xo(s)===null){u.child=x;break}s=x.sibling,x.sibling=p,p=x,x=s}Pf(u,!0,p,null,H);break;case"together":Pf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Xa(s,u,p){if(s!==null&&(u.dependencies=s.dependencies),Pi|=u.lanes,(p&u.childLanes)===0)if(s!==null){if(gn(s,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(s!==null&&u.child!==s.child)throw Error(r(153));if(u.child!==null){for(s=u.child,p=Tn(s,s.pendingProps),u.child=p,p.return=u;s.sibling!==null;)s=s.sibling,p=p.sibling=Tn(s,s.pendingProps),p.return=u;p.sibling=null}return u.child}function Ju(s,u){return(s.lanes&u)!==0?!0:(s=s.dependencies,!!(s!==null&&Pn(s)))}function No(s,u,p){switch(u.tag){case 3:rt(u,u.stateNode.containerInfo),_e(u,Sn,s.memoizedState.cache),It();break;case 27:case 5:J(u);break;case 4:rt(u,u.stateNode.containerInfo);break;case 10:_e(u,u.type,u.memoizedProps.value);break;case 13:var S=u.memoizedState;if(S!==null)return S.dehydrated!==null?(Zr(u),u.flags|=128,null):(p&u.child.childLanes)!==0?Gf(s,u,p):(Zr(u),s=Xa(s,u,p),s!==null?s.sibling:null);Zr(u);break;case 19:var x=(s.flags&128)!==0;if(S=(p&u.childLanes)!==0,S||(gn(s,u,p,!1),S=(p&u.childLanes)!==0),x){if(S)return Gd(s,u,p);u.flags|=128}if(x=u.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),v(Ln,Ln.current),S)break;return null;case 22:case 23:return u.lanes=0,Ud(s,u,p);case 24:_e(u,Sn,s.memoizedState.cache)}return Xa(s,u,p)}function wl(s,u,p){if(s!==null)if(s.memoizedProps!==u.pendingProps)ai=!0;else{if(!Ju(s,p)&&(u.flags&128)===0)return ai=!1,No(s,u,p);ai=(s.flags&131072)!==0}else ai=!1,Fe&&(u.flags&1048576)!==0&&it(u,Qs,u.index);switch(u.lanes=0,u.tag){case 16:t:{s=u.pendingProps;var S=u.elementType,x=S._init;if(S=x(S._payload),u.type=S,typeof S=="function")wr(S)?(s=ws(S,s),u.tag=1,u=Al(null,u,S,s,p)):(u.tag=0,u=Lf(null,u,S,s,p));else{if(S!=null){if(x=S.$$typeof,x===gc){u.tag=11,u=Nd(null,u,S,s,p);break t}else if(x===pc){u.tag=14,u=jd(null,u,S,s,p);break t}}throw u=C(S)||S,Error(r(306,u,""))}}return u;case 0:return Lf(s,u,u.type,u.pendingProps,p);case 1:return S=u.type,x=ws(S,u.pendingProps),Al(s,u,S,x,p);case 3:t:{if(rt(u,u.stateNode.containerInfo),s===null)throw Error(r(387));var H=u.pendingProps;x=u.memoizedState,S=x.element,pn(s,u),oe(u,H,null,p);var et=u.memoizedState;if(H=et.cache,_e(u,Sn,H),H!==x.cache&&He(u,[Sn],p,!0),re(),H=et.element,Mn&&x.isDehydrated)if(x={element:H,isDehydrated:!1,cache:et.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=zd(s,u,H,p);break t}else if(H!==S){S=F(Error(r(424)),u),ae(S),u=zd(s,u,H,p);break t}else for(Mn&&(Yn=Hg(u.stateNode.containerInfo),li=u,Fe=!0,zr=null,La=!0),p=Ea(u,null,H,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(It(),H===S){u=Xa(s,u,p);break t}hi(s,u,H,p)}u=u.child}return u;case 26:if(ca)return Yu(s,u),s===null?(p=p0(u.type,null,u.pendingProps,null))?u.memoizedState=p:Fe||(u.stateNode=v0(u.type,u.pendingProps,Br.current,u)):u.memoizedState=p0(u.type,s.memoizedProps,u.pendingProps,s.memoizedState),null;case 27:if(Vn)return J(u),s===null&&Vn&&Fe&&(S=u.stateNode=$o(u.type,u.pendingProps,Br.current,ii.current,!1),li=u,La=!0,Yn=Hl(u.type,S,Yn)),hi(s,u,u.pendingProps.children,p),Yu(s,u),s===null&&(u.flags|=4194304),u.child;case 5:return s===null&&Fe&&(d0(u.type,u.pendingProps,ii.current),(x=S=Yn)&&(S=s0(S,u.type,u.pendingProps,La),S!==null?(u.stateNode=S,li=u,Yn=a0(S),La=!1,x=!0):x=!1),x||nt(u)),J(u),x=u.type,H=u.pendingProps,et=s!==null?s.memoizedProps:null,S=H.children,us(x,H)?S=null:et!==null&&us(x,et)&&(u.flags|=32),u.memoizedState!==null&&(x=Oa(s,u,ri,null,null,p),tr?_a._currentValue=x:_a._currentValue2=x),Yu(s,u),hi(s,u,S,p),u.child;case 6:return s===null&&Fe&&(g0(u.pendingProps,ii.current),(s=p=Yn)&&(p=Tc(p,u.pendingProps,La),p!==null?(u.stateNode=p,li=u,Yn=null,s=!0):s=!1),s||nt(u)),null;case 13:return Gf(s,u,p);case 4:return rt(u,u.stateNode.containerInfo),S=u.pendingProps,s===null?u.child=ms(u,null,S,p):hi(s,u,S,p),u.child;case 11:return Nd(s,u,u.type,u.pendingProps,p);case 7:return hi(s,u,u.pendingProps,p),u.child;case 8:return hi(s,u,u.pendingProps.children,p),u.child;case 12:return hi(s,u,u.pendingProps.children,p),u.child;case 10:return S=u.pendingProps,_e(u,u.type,S.value),hi(s,u,S.children,p),u.child;case 9:return x=u.type._context,S=u.pendingProps.children,Ot(u),x=Kt(x),S=S(x),u.flags|=1,hi(s,u,S,p),u.child;case 14:return jd(s,u,u.type,u.pendingProps,p);case 15:return Dd(s,u,u.type,u.pendingProps,p);case 19:return Gd(s,u,p);case 31:return S=u.pendingProps,p=u.mode,S={mode:S.mode,children:S.children},s===null?(p=Mo(S,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=Tn(s.child,S),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return Ud(s,u,p);case 24:return Ot(u),S=Kt(Sn),s===null?(x=he(),x===null&&(x=dn,H=We(),x.pooledCache=H,H.refCount++,H!==null&&(x.pooledCacheLanes|=p),x=H),u.memoizedState={parent:S,cache:x},Yt(u),_e(u,Sn,x)):((s.lanes&p)!==0&&(pn(s,u),oe(u,null,null,p),re()),x=s.memoizedState,H=u.memoizedState,x.parent!==S?(x={parent:S,cache:S},u.memoizedState=x,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=x),_e(u,Sn,S)):(S=H.cache,_e(u,Sn,S),S!==x.cache&&He(u,[Sn],p,!0))),hi(s,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function aa(s){s.flags|=4}function jo(s,u){if(s!==null&&s.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(s=u.child;s!==null;){if((s.flags&13878)!==0||(s.subtreeFlags&13878)!==0)return!0;s=s.sibling}return!1}function Zu(s,u,p,S){if(si)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)Fo(s,p.stateNode);else if(!(p.tag===4||Vn&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(er)for(var x=u.child;x!==null;){if(x.tag===5){var H=x.stateNode;p&&S&&(H=mh(H,x.type,x.memoizedProps)),Fo(s,H)}else if(x.tag===6)H=x.stateNode,p&&S&&(H=$d(H,x.memoizedProps)),Fo(s,H);else if(x.tag!==4){if(x.tag===22&&x.memoizedState!==null)H=x.child,H!==null&&(H.return=x),Zu(s,x,!0,!0);else if(x.child!==null){x.child.return=x,x=x.child;continue}}if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return}x.sibling.return=x.return,x=x.sibling}}function Hf(s,u,p,S){var x=!1;if(er)for(var H=u.child;H!==null;){if(H.tag===5){var et=H.stateNode;p&&S&&(et=mh(et,H.type,H.memoizedProps)),ph(s,et)}else if(H.tag===6)et=H.stateNode,p&&S&&(et=$d(et,H.memoizedProps)),ph(s,et);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)x=H.child,x!==null&&(x.return=H),Hf(s,H,!0,!0),x=!0;else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===u)break;for(;H.sibling===null;){if(H.return===null||H.return===u)return x;H=H.return}H.sibling.return=H.return,H=H.sibling}return x}function Wu(s,u){if(er&&jo(s,u)){s=u.stateNode;var p=s.containerInfo,S=gh();Hf(S,u,!1,!1),s.pendingChildren=S,aa(u),Wd(p,S)}}function Do(s,u,p,S){if(si)s.memoizedProps!==S&&aa(u);else if(er){var x=s.stateNode,H=s.memoizedProps;if((s=jo(s,u))||H!==S){var et=ii.current;H=Zd(x,p,H,S,!s,null),H===x?u.stateNode=x:(Gl(H,p,S,et)&&aa(u),u.stateNode=H,s?Zu(H,u,!1,!1):aa(u))}else u.stateNode=x}}function $u(s,u,p){if(mc(u,p)){if(s.flags|=16777216,!ir(u,p))if(Da())s.flags|=8192;else throw Zi=ru,au}else s.flags&=-16777217}function If(s,u){if(qg(u)){if(s.flags|=16777216,!Ch(u))if(Da())s.flags|=8192;else throw Zi=ru,au}else s.flags&=-16777217}function Uo(s,u){u!==null&&(s.flags|=4),s.flags&16384&&(u=s.tag!==22?O():536870912,s.lanes|=u,$i|=u)}function Bo(s,u){if(!Fe)switch(s.tailMode){case"hidden":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?u||s.tail===null?s.tail=null:s.tail.sibling=null:S.sibling=null}}function zn(s){var u=s.alternate!==null&&s.alternate.child===s.child,p=0,S=0;if(u)for(var x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags&65011712,S|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags,S|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=S,s.childLanes=p,u}function zg(s,u,p){var S=u.pendingProps;switch(at(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(u),null;case 1:return zn(u),null;case 3:return p=u.stateNode,S=null,s!==null&&(S=s.memoizedState.cache),u.memoizedState.cache!==S&&(u.flags|=2048),we(Sn),V(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Ut(u)?aa(u):s===null||s.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,ne())),Wu(s,u),zn(u),null;case 26:if(ca){p=u.type;var x=u.memoizedState;return s===null?(aa(u),x!==null?(zn(u),If(u,x)):(zn(u),$u(u,p,S))):x?x!==s.memoizedState?(aa(u),zn(u),If(u,x)):(zn(u),u.flags&=-16777217):(si?s.memoizedProps!==S&&aa(u):Do(s,u,p,S),zn(u),$u(u,p,S)),null}case 27:if(Vn){if($(u),p=Br.current,x=u.type,s!==null&&u.stateNode!=null)si?s.memoizedProps!==S&&aa(u):Do(s,u,x,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return zn(u),null}s=ii.current,Ut(u)?dt(u,s):(s=$o(x,S,p,s,!0),u.stateNode=s,aa(u))}return zn(u),null}case 5:if($(u),p=u.type,s!==null&&u.stateNode!=null)Do(s,u,p,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return zn(u),null}s=ii.current,Ut(u)?dt(u,s):(x=rh(p,S,Br.current,s,u),Zu(x,u,!1,!1),u.stateNode=x,Gl(x,p,S,s)&&aa(u))}return zn(u),$u(u,u.type,u.pendingProps),null;case 6:if(s&&u.stateNode!=null)p=s.memoizedProps,si?p!==S&&aa(u):er&&(p!==S?(u.stateNode=sh(S,Br.current,ii.current,u),aa(u)):u.stateNode=s.stateNode);else{if(typeof S!="string"&&u.stateNode===null)throw Error(r(166));if(s=Br.current,p=ii.current,Ut(u)){if(!Mn)throw Error(r(176));if(s=u.stateNode,p=u.memoizedProps,S=null,x=li,x!==null)switch(x.tag){case 27:case 5:S=x.memoizedProps}Sh(s,p,u,S)||nt(u)}else u.stateNode=sh(S,s,p,u)}return zn(u),null;case 13:if(S=u.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=Ut(u),S!==null&&S.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(!Mn)throw Error(r(344));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));Ig(x,u)}else It(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;zn(u),x=!1}else x=ne(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return u.flags&256?(Er(u),u):(Er(u),null)}if(Er(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=S!==null,s=s!==null&&s.memoizedState!==null,p){S=u.child,x=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(x=S.alternate.memoizedState.cachePool.pool);var H=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(H=S.memoizedState.cachePool.pool),H!==x&&(S.flags|=2048)}return p!==s&&p&&(u.child.flags|=8192),Uo(u,u.updateQueue),zn(u),null;case 4:return V(),Wu(s,u),s===null&&cs(u.stateNode.containerInfo),zn(u),null;case 10:return we(u.type),zn(u),null;case 19:if(R(Ln),x=u.memoizedState,x===null)return zn(u),null;if(S=(u.flags&128)!==0,H=x.rendering,H===null)if(S)Bo(x,!1);else{if(wn!==0||s!==null&&(s.flags&128)!==0)for(s=u.child;s!==null;){if(H=xo(s),H!==null){for(u.flags|=128,Bo(x,!1),s=H.updateQueue,u.updateQueue=s,Uo(u,s),u.subtreeFlags=0,s=p,p=u.child;p!==null;)Io(p,s),p=p.sibling;return v(Ln,Ln.current&1|2),u.child}s=s.sibling}x.tail!==null&&fa()>ul&&(u.flags|=128,S=!0,Bo(x,!1),u.lanes=4194304)}else{if(!S)if(s=xo(H),s!==null){if(u.flags|=128,S=!0,s=s.updateQueue,u.updateQueue=s,Uo(u,s),Bo(x,!0),x.tail===null&&x.tailMode==="hidden"&&!H.alternate&&!Fe)return zn(u),null}else 2*fa()-x.renderingStartTime>ul&&p!==536870912&&(u.flags|=128,S=!0,Bo(x,!1),u.lanes=4194304);x.isBackwards?(H.sibling=u.child,u.child=H):(s=x.last,s!==null?s.sibling=H:u.child=H,x.last=H)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=fa(),u.sibling=null,s=Ln.current,v(Ln,S?s&1|2:s&1),u):(zn(u),null);case 22:case 23:return Er(u),wa(),S=u.memoizedState!==null,s!==null?s.memoizedState!==null!==S&&(u.flags|=8192):S&&(u.flags|=8192),S?(p&536870912)!==0&&(u.flags&128)===0&&(zn(u),u.subtreeFlags&6&&(u.flags|=8192)):zn(u),p=u.updateQueue,p!==null&&Uo(u,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),S=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(S=u.memoizedState.cachePool.pool),S!==p&&(u.flags|=2048),s!==null&&R(Lr),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),we(Sn),zn(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function Lg(s,u){switch(at(u),u.tag){case 1:return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 3:return we(Sn),V(),s=u.flags,(s&65536)!==0&&(s&128)===0?(u.flags=s&-65537|128,u):null;case 26:case 27:case 5:return $(u),null;case 13:if(Er(u),s=u.memoizedState,s!==null&&s.dehydrated!==null){if(u.alternate===null)throw Error(r(340));It()}return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 19:return R(Ln),null;case 4:return V(),null;case 10:return we(u.type),null;case 22:case 23:return Er(u),wa(),s!==null&&R(Lr),s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 24:return we(Sn),null;case 25:return null;default:return null}}function Pd(s,u){switch(at(u),u.tag){case 3:we(Sn),V();break;case 26:case 27:case 5:$(u);break;case 4:V();break;case 13:Er(u);break;case 19:R(Ln);break;case 10:we(u.type);break;case 22:case 23:Er(u),wa(),s!==null&&R(Lr);break;case 24:we(Sn)}}function di(s,u){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var x=S.next;p=x;do{if((p.tag&s)===s){S=void 0;var H=p.create,et=p.inst;S=H(),et.destroy=S}p=p.next}while(p!==x)}}catch(ut){qe(u,u.return,ut)}}function ya(s,u,p){try{var S=u.updateQueue,x=S!==null?S.lastEffect:null;if(x!==null){var H=x.next;S=H;do{if((S.tag&s)===s){var et=S.inst,ut=et.destroy;if(ut!==void 0){et.destroy=void 0,x=u;var _t=p,zt=ut;try{zt()}catch(Pt){qe(x,_t,Pt)}}}S=S.next}while(S!==H)}}catch(Pt){qe(u,u.return,Pt)}}function kf(s){var u=s.updateQueue;if(u!==null){var p=s.stateNode;try{tn(u,p)}catch(S){qe(s,s.return,S)}}}function qf(s,u,p){p.props=ws(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(S){qe(s,u,S)}}function Rl(s,u){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var S=Hs(s.stateNode);break;case 30:S=s.stateNode;break;default:S=s.stateNode}typeof p=="function"?s.refCleanup=p(S):p.current=S}}catch(x){qe(s,u,x)}}function xa(s,u){var p=s.ref,S=s.refCleanup;if(p!==null)if(typeof S=="function")try{S()}catch(x){qe(s,u,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(x){qe(s,u,x)}else p.current=null}function tc(s){var u=s.type,p=s.memoizedProps,S=s.stateNode;try{Ui(S,u,p,s)}catch(x){qe(s,s.return,x)}}function Vf(s,u,p){try{qn(s.stateNode,s.type,p,u,s)}catch(S){qe(s,s.return,S)}}function Rs(s){return s.tag===5||s.tag===3||(ca?s.tag===26:!1)||(Vn?s.tag===27&&qs(s.type):!1)||s.tag===4}function zo(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||Rs(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(Vn&&s.tag===27&&qs(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Os(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?Zo(p,s,u):uh(p,s);else if(S!==4&&(Vn&&S===27&&qs(s.type)&&(p=s.stateNode,u=null),s=s.child,s!==null))for(Os(s,u,p),s=s.sibling;s!==null;)Os(s,u,p),s=s.sibling}function Ol(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?yc(p,s,u):oh(p,s);else if(S!==4&&(Vn&&S===27&&qs(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(Ol(s,u,p),s=s.sibling;s!==null;)Ol(s,u,p),s=s.sibling}function Yf(s,u,p){s=s.containerInfo;try{_c(s,p)}catch(S){qe(u,u.return,S)}}function ts(s){var u=s.stateNode,p=s.memoizedProps;try{y0(s.type,p,u,s)}catch(S){qe(s,s.return,S)}}function xl(s,u){for(os(s.containerInfo),ui=u;ui!==null;)if(s=ui,u=s.child,(s.subtreeFlags&1024)!==0&&u!==null)u.return=s,ui=u;else for(;ui!==null;){s=ui;var p=s.alternate;switch(u=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0;var S=s,x=p.memoizedProps;p=p.memoizedState;var H=S.stateNode;try{var et=ws(S.type,x,S.elementType===S.type);u=H.getSnapshotBeforeUpdate(et,p),H.__reactInternalSnapshotBeforeUpdate=u}catch(ut){qe(S,S.return,ut)}}break;case 3:(u&1024)!==0&&si&&Jd(s.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=s.sibling,u!==null){u.return=s.return,ui=u;break}ui=s.return}}function ec(s,u,p){var S=p.flags;switch(p.tag){case 0:case 11:case 15:Fa(s,p),S&4&&di(5,p);break;case 1:if(Fa(s,p),S&4)if(s=p.stateNode,u===null)try{s.componentDidMount()}catch(et){qe(p,p.return,et)}else{var x=ws(p.type,u.memoizedProps);u=u.memoizedState;try{s.componentDidUpdate(x,u,s.__reactInternalSnapshotBeforeUpdate)}catch(et){qe(p,p.return,et)}}S&64&&kf(p),S&512&&Rl(p,p.return);break;case 3:if(Fa(s,p),S&64&&(s=p.updateQueue,s!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=Hs(p.child.stateNode);break;case 1:u=p.child.stateNode}try{tn(s,u)}catch(et){qe(p,p.return,et)}}break;case 27:Vn&&u===null&&S&4&&ts(p);case 26:case 5:Fa(s,p),u===null&&S&4&&tc(p),S&512&&Rl(p,p.return);break;case 12:Fa(s,p);break;case 13:Fa(s,p),S&4&&Qf(s,p),S&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=th.bind(null,p),vh(s,p))));break;case 22:if(S=p.memoizedState!==null||cr,!S){u=u!==null&&u.memoizedState!==null||Nn,x=cr;var H=Nn;cr=S,(Nn=u)&&!H?Ma(s,p,(p.subtreeFlags&8772)!==0):Fa(s,p),cr=x,Nn=H}break;case 30:break;default:Fa(s,p)}}function Kf(s){var u=s.alternate;u!==null&&(s.alternate=null,Kf(u)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(u=s.stateNode,u!==null&&kn(u)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function gi(s,u,p){for(p=p.child;p!==null;)nc(s,u,p),p=p.sibling}function nc(s,u,p){if(Fi&&typeof Fi.onCommitFiberUnmount=="function")try{Fi.onCommitFiberUnmount(kl,p)}catch{}switch(p.tag){case 26:if(ca){Nn||xa(p,u),gi(s,u,p),p.memoizedState?_h(p.memoizedState):p.stateNode&&Eh(p.stateNode);break}case 27:if(Vn){Nn||xa(p,u);var S=Se,x=ze;qs(p.type)&&(Se=p.stateNode,ze=!1),gi(s,u,p),Th(p.stateNode),Se=S,ze=x;break}case 5:Nn||xa(p,u);case 6:if(si){if(S=Se,x=ze,Se=null,gi(s,u,p),Se=S,ze=x,Se!==null)if(ze)try{fh(Se,p.stateNode)}catch(H){qe(p,u,H)}else try{Sc(Se,p.stateNode)}catch(H){qe(p,u,H)}}else gi(s,u,p);break;case 18:si&&Se!==null&&(ze?h0(Se,p.stateNode):f0(Se,p.stateNode));break;case 4:si?(S=Se,x=ze,Se=p.stateNode.containerInfo,ze=!0,gi(s,u,p),Se=S,ze=x):(er&&Yf(p.stateNode,p,gh()),gi(s,u,p));break;case 0:case 11:case 14:case 15:Nn||ya(2,p,u),Nn||ya(4,p,u),gi(s,u,p);break;case 1:Nn||(xa(p,u),S=p.stateNode,typeof S.componentWillUnmount=="function"&&qf(p,u,S)),gi(s,u,p);break;case 21:gi(s,u,p);break;case 22:Nn=(S=Nn)||p.memoizedState!==null,gi(s,u,p),Nn=S;break;default:gi(s,u,p)}}function Qf(s,u){if(Mn&&u.memoizedState===null&&(s=u.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{c0(s)}catch(p){qe(u,u.return,p)}}function Hd(s){switch(s.tag){case 13:case 19:var u=s.stateNode;return u===null&&(u=s.stateNode=new w0),u;case 22:return s=s.stateNode,u=s._retryCache,u===null&&(u=s._retryCache=new w0),u;default:throw Error(r(435,s.tag))}}function Xf(s,u){var p=Hd(s);u.forEach(function(S){var x=eh.bind(null,s,S);p.has(S)||(p.add(S),S.then(x,x))})}function Ni(s,u){var p=u.deletions;if(p!==null)for(var S=0;S<p.length;S++){var x=p[S],H=s,et=u;if(si){var ut=et;t:for(;ut!==null;){switch(ut.tag){case 27:if(Vn){if(qs(ut.type)){Se=ut.stateNode,ze=!1;break t}break}case 5:Se=ut.stateNode,ze=!1;break t;case 3:case 4:Se=ut.stateNode.containerInfo,ze=!0;break t}ut=ut.return}if(Se===null)throw Error(r(160));nc(H,et,x),Se=null,ze=!1}else nc(H,et,x);H=x.alternate,H!==null&&(H.return=null),x.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Id(u,s),u=u.sibling}function Id(s,u){var p=s.alternate,S=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ni(u,s),ji(s),S&4&&(ya(3,s,s.return),di(3,s),ya(5,s,s.return));break;case 1:Ni(u,s),ji(s),S&512&&(Nn||p===null||xa(p,p.return)),S&64&&cr&&(s=s.updateQueue,s!==null&&(S=s.callbacks,S!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?S:p.concat(S))));break;case 26:if(ca){var x=Ae;if(Ni(u,s),ji(s),S&512&&(Nn||p===null||xa(p,p.return)),S&4){S=p!==null?p.memoizedState:null;var H=s.memoizedState;p===null?H===null?s.stateNode===null?s.stateNode=m0(x,s.type,s.memoizedProps,s):xc(x,s.type,s.stateNode):s.stateNode=Oc(x,H,s.memoizedProps):S!==H?(S===null?p.stateNode!==null&&Eh(p.stateNode):_h(S),H===null?xc(x,s.type,s.stateNode):Oc(x,H,s.memoizedProps)):H===null&&s.stateNode!==null&&Vf(s,s.memoizedProps,p.memoizedProps)}break}case 27:if(Vn){Ni(u,s),ji(s),S&512&&(Nn||p===null||xa(p,p.return)),p!==null&&S&4&&Vf(s,s.memoizedProps,p.memoizedProps);break}case 5:if(Ni(u,s),ji(s),S&512&&(Nn||p===null||xa(p,p.return)),si){if(s.flags&32){x=s.stateNode;try{rr(x)}catch(Pt){qe(s,s.return,Pt)}}S&4&&s.stateNode!=null&&(x=s.memoizedProps,Vf(s,x,p!==null?p.memoizedProps:x)),S&1024&&(Gc=!0)}break;case 6:if(Ni(u,s),ji(s),S&4&&si){if(s.stateNode===null)throw Error(r(162));S=s.memoizedProps,p=p!==null?p.memoizedProps:S,x=s.stateNode;try{ch(x,p,S)}catch(Pt){qe(s,s.return,Pt)}}break;case 3:if(ca?(kg(),x=Ae,Ae=Rc(u.containerInfo),Ni(u,s),Ae=x):Ni(u,s),ji(s),S&4){if(si&&Mn&&p!==null&&p.memoizedState.isDehydrated)try{u0(u.containerInfo)}catch(Pt){qe(s,s.return,Pt)}if(er){S=u.containerInfo,p=u.pendingChildren;try{_c(S,p)}catch(Pt){qe(s,s.return,Pt)}}}Gc&&(Gc=!1,Ff(s));break;case 4:ca?(p=Ae,Ae=Rc(s.stateNode.containerInfo),Ni(u,s),ji(s),Ae=p):(Ni(u,s),ji(s)),S&4&&er&&Yf(s.stateNode,s,s.stateNode.pendingChildren);break;case 12:Ni(u,s),ji(s);break;case 13:Ni(u,s),ji(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(ol=fa()),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Xf(s,S)));break;case 22:x=s.memoizedState!==null;var et=p!==null&&p.memoizedState!==null,ut=cr,_t=Nn;if(cr=ut||x,Nn=_t||et,Ni(u,s),Nn=_t,cr=ut,ji(s),S&8192&&(u=s.stateNode,u._visibility=x?u._visibility&-2:u._visibility|1,x&&(p===null||et||cr||Nn||pi(s)),si)){t:if(p=null,si)for(u=s;;){if(u.tag===5||ca&&u.tag===26){if(p===null){et=p=u;try{H=et.stateNode,x?bc(H):dh(et.stateNode,et.memoizedProps)}catch(Pt){qe(et,et.return,Pt)}}}else if(u.tag===6){if(p===null){et=u;try{var zt=et.stateNode;x?hh(zt):Fd(zt,et.memoizedProps)}catch(Pt){qe(et,et.return,Pt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===s)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break t;for(;u.sibling===null;){if(u.return===null||u.return===s)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}S&4&&(S=s.updateQueue,S!==null&&(p=S.retryQueue,p!==null&&(S.retryQueue=null,Xf(s,p))));break;case 19:Ni(u,s),ji(s),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Xf(s,S)));break;case 30:break;case 21:break;default:Ni(u,s),ji(s)}}function ji(s){var u=s.flags;if(u&2){try{if(si){for(var p,S=s.return;S!==null;){if(Rs(S)){p=S;break}S=S.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:if(Vn){var x=p.stateNode,H=zo(s);Ol(s,H,x);break}case 5:var et=p.stateNode;p.flags&32&&(rr(et),p.flags&=-33);var ut=zo(s);Ol(s,ut,et);break;case 3:case 4:var _t=p.stateNode.containerInfo,zt=zo(s);Os(s,zt,_t);break;default:throw Error(r(161))}}}catch(Pt){qe(s,s.return,Pt)}s.flags&=-3}u&4096&&(s.flags&=-4097)}function Ff(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var u=s;Ff(u),u.tag===5&&u.flags&1024&&Is(u.stateNode),s=s.sibling}}function Fa(s,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)ec(s,u.alternate,u),u=u.sibling}function pi(s){for(s=s.child;s!==null;){var u=s;switch(u.tag){case 0:case 11:case 14:case 15:ya(4,u,u.return),pi(u);break;case 1:xa(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&qf(u,u.return,p),pi(u);break;case 27:Vn&&Th(u.stateNode);case 26:case 5:xa(u,u.return),pi(u);break;case 22:u.memoizedState===null&&pi(u);break;case 30:pi(u);break;default:pi(u)}s=s.sibling}}function Ma(s,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var S=u.alternate,x=s,H=u,et=H.flags;switch(H.tag){case 0:case 11:case 15:Ma(x,H,p),di(4,H);break;case 1:if(Ma(x,H,p),S=H,x=S.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(zt){qe(S,S.return,zt)}if(S=H,x=S.updateQueue,x!==null){var ut=S.stateNode;try{var _t=x.shared.hiddenCallbacks;if(_t!==null)for(x.shared.hiddenCallbacks=null,x=0;x<_t.length;x++)Re(_t[x],ut)}catch(zt){qe(S,S.return,zt)}}p&&et&64&&kf(H),Rl(H,H.return);break;case 27:Vn&&ts(H);case 26:case 5:Ma(x,H,p),p&&S===null&&et&4&&tc(H),Rl(H,H.return);break;case 12:Ma(x,H,p);break;case 13:Ma(x,H,p),p&&et&4&&Qf(x,H);break;case 22:H.memoizedState===null&&Ma(x,H,p),Rl(H,H.return);break;case 30:break;default:Ma(x,H,p)}u=u.sibling}}function Yi(s,u){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(s=u.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&an(p))}function es(s,u){s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&an(s))}function Sa(s,u,p,S){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Lo(s,u,p,S),u=u.sibling}function Lo(s,u,p,S){var x=u.flags;switch(u.tag){case 0:case 11:case 15:Sa(s,u,p,S),x&2048&&di(9,u);break;case 1:Sa(s,u,p,S);break;case 3:Sa(s,u,p,S),x&2048&&(s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&an(s)));break;case 12:if(x&2048){Sa(s,u,p,S),s=u.stateNode;try{var H=u.memoizedProps,et=H.id,ut=H.onPostCommit;typeof ut=="function"&&ut(et,u.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(_t){qe(u,u.return,_t)}}else Sa(s,u,p,S);break;case 13:Sa(s,u,p,S);break;case 23:break;case 22:H=u.stateNode,et=u.alternate,u.memoizedState!==null?H._visibility&2?Sa(s,u,p,S):xs(s,u):H._visibility&2?Sa(s,u,p,S):(H._visibility|=2,Cr(s,u,p,S,(u.subtreeFlags&10256)!==0)),x&2048&&Yi(et,u);break;case 24:Sa(s,u,p,S),x&2048&&es(u.alternate,u);break;default:Sa(s,u,p,S)}}function Cr(s,u,p,S,x){for(x=x&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var H=s,et=u,ut=p,_t=S,zt=et.flags;switch(et.tag){case 0:case 11:case 15:Cr(H,et,ut,_t,x),di(8,et);break;case 23:break;case 22:var Pt=et.stateNode;et.memoizedState!==null?Pt._visibility&2?Cr(H,et,ut,_t,x):xs(H,et):(Pt._visibility|=2,Cr(H,et,ut,_t,x)),x&&zt&2048&&Yi(et.alternate,et);break;case 24:Cr(H,et,ut,_t,x),x&&zt&2048&&es(et.alternate,et);break;default:Cr(H,et,ut,_t,x)}u=u.sibling}}function xs(s,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=s,S=u,x=S.flags;switch(S.tag){case 22:xs(p,S),x&2048&&Yi(S.alternate,S);break;case 24:xs(p,S),x&2048&&es(S.alternate,S);break;default:xs(p,S)}u=u.sibling}}function ra(s){if(s.subtreeFlags&De)for(s=s.child;s!==null;)Jf(s),s=s.sibling}function Jf(s){switch(s.tag){case 26:ra(s),s.flags&De&&(s.memoizedState!==null?Wo(Ae,s.memoizedState,s.memoizedProps):un(s.type,s.memoizedProps));break;case 5:ra(s),s.flags&De&&un(s.type,s.memoizedProps);break;case 3:case 4:if(ca){var u=Ae;Ae=Rc(s.stateNode.containerInfo),ra(s),Ae=u}else ra(s);break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=De,De=16777216,ra(s),De=u):ra(s));break;default:ra(s)}}function Go(s){var u=s.alternate;if(u!==null&&(s=u.child,s!==null)){u.child=null;do u=s.sibling,s.sibling=null,s=u;while(s!==null)}}function Ja(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];ui=S,ic(S,s)}Go(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)kd(s),s=s.sibling}function kd(s){switch(s.tag){case 0:case 11:case 15:Ja(s),s.flags&2048&&ya(9,s,s.return);break;case 3:Ja(s);break;case 12:Ja(s);break;case 22:var u=s.stateNode;s.memoizedState!==null&&u._visibility&2&&(s.return===null||s.return.tag!==13)?(u._visibility&=-3,Ai(s)):Ja(s);break;default:Ja(s)}}function Ai(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];ui=S,ic(S,s)}Go(s)}for(s=s.child;s!==null;){switch(u=s,u.tag){case 0:case 11:case 15:ya(8,u,u.return),Ai(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,Ai(u));break;default:Ai(u)}s=s.sibling}}function ic(s,u){for(;ui!==null;){var p=ui;switch(p.tag){case 0:case 11:case 15:ya(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var S=p.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:an(p.memoizedState.cache)}if(S=p.child,S!==null)S.return=p,ui=S;else t:for(p=s;ui!==null;){S=ui;var x=S.sibling,H=S.return;if(Kf(S),S===p){ui=null;break t}if(x!==null){x.return=H,ui=x;break t}ui=H}}}function Na(s){var u=ba(s);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(r(364));return u}if(s=Gg(s),s===null)throw Error(r(362));return s.stateNode.current}function ac(s,u){var p=s.tag;switch(u.$$typeof){case Ri:if(s.type===u.value)return!0;break;case Pa:t:{for(u=u.value,s=[s,0],p=0;p<s.length;){var S=s[p++],x=S.tag,H=s[p++],et=u[H];if(x!==5&&x!==26&&x!==27||!ks(S)){for(;et!=null&&ac(S,et);)H++,et=u[H];if(H===u.length){u=!0;break t}else for(S=S.child;S!==null;)s.push(S,H),S=S.sibling}}u=!1}return u;case Gr:if((p===5||p===26||p===27)&&Qd(s.stateNode,u.value))return!0;break;case Ca:if((p===5||p===6||p===26||p===27)&&(s=lh(s),s!==null&&0<=s.indexOf(u.value)))return!0;break;case Kl:if((p===5||p===26||p===27)&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Ml(s){switch(s.$$typeof){case Ri:return"<"+(C(s.value)||"Unknown")+">";case Pa:return":has("+(Ml(s)||"")+")";case Gr:return'[role="'+s.value+'"]';case Ca:return'"'+s.value+'"';case Kl:return'[data-testname="'+s.value+'"]';default:throw Error(r(365))}}function ns(s,u){var p=[];s=[s,0];for(var S=0;S<s.length;){var x=s[S++],H=x.tag,et=s[S++],ut=u[et];if(H!==5&&H!==26&&H!==27||!ks(x)){for(;ut!=null&&ac(x,ut);)et++,ut=u[et];if(et===u.length)p.push(x);else for(x=x.child;x!==null;)s.push(x,et),x=x.sibling}}return p}function Po(s,u){if(!ar)throw Error(r(363));s=Na(s),s=ns(s,u),u=[],s=Array.from(s);for(var p=0;p<s.length;){var S=s[p++],x=S.tag;if(x===5||x===26||x===27)ks(S)||u.push(S.stateNode);else for(S=S.child;S!==null;)s.push(S),S=S.sibling}return u}function Ki(){if((Ue&2)!==0&&Le!==0)return Le&-Le;if(me.T!==null){var s=or;return s!==0?s:Rt()}return fs()}function rc(){_i===0&&(_i=(Le&536870912)===0||Fe?G():536870912);var s=ga.current;return s!==null&&(s.flags|=32),_i}function Qi(s,u,p){(s===dn&&(Ke===2||Ke===9)||s.cancelPendingCommit!==null)&&(mi(s,0),ja(s,Le,_i,!1)),T(s,p),((Ue&2)===0||s!==dn)&&(s===dn&&((Ue&2)===0&&(Rn|=p),wn===4&&ja(s,Le,_i,!1)),ge(s))}function sa(s,u,p){if((Ue&6)!==0)throw Error(r(327));var S=!p&&(u&124)===0&&(u&s.expiredLanes)===0||j(s,u),x=S?qd(s,u):Ho(s,u,!0),H=S;do{if(x===0){Pr&&!S&&ja(s,u,0,!1);break}else{if(p=s.current.alternate,H&&!Nl(p)){x=Ho(s,u,!1),H=!1;continue}if(x===2){if(H=u,s.errorRecoveryDisabledLanes&H)var et=0;else et=s.pendingLanes&-536870913,et=et!==0?et:et&536870912?536870912:0;if(et!==0){u=et;t:{var ut=s;x=ll;var _t=Mn&&ut.current.memoizedState.isDehydrated;if(_t&&(mi(ut,et).flags|=256),et=Ho(ut,et,!1),et!==2){if(Pc&&!_t){ut.errorRecoveryDisabledLanes|=H,Rn|=H,x=4;break t}H=Oi,Oi=x,H!==null&&(Oi===null?Oi=H:Oi.push.apply(Oi,H))}x=et}if(H=!1,x!==2)continue}}if(x===1){mi(s,0),ja(s,u,0,!0);break}t:{switch(S=s,H=x,H){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:ja(S,u,_i,!fr);break t;case 2:Oi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(x=ol+300-fa(),10<x)){if(ja(S,u,_i,!fr),L(S,0,!0)!==0)break t;S.timeoutHandle=Kd(Ms.bind(null,S,p,Oi,xi,Hc,u,_i,Rn,$i,fr,H,2,-0,0),x);break t}Ms(S,p,Oi,xi,Hc,u,_i,Rn,$i,fr,H,0,-0,0)}}break}while(!0);ge(s)}function Ms(s,u,p,S,x,H,et,ut,_t,zt,Pt,Jt,ee,xe){if(s.timeoutHandle=$a,Jt=u.subtreeFlags,(Jt&8192||(Jt&16785408)===16785408)&&(Oe(),Jf(u),Jt=$n(),Jt!==null)){s.cancelPendingCommit=Jt(Ar.bind(null,s,u,H,p,S,x,et,ut,_t,Pt,1,ee,xe)),ja(s,H,et,!zt);return}Ar(s,u,H,p,S,x,et,ut,_t)}function Nl(s){for(var u=s;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var S=0;S<p.length;S++){var x=p[S],H=x.getSnapshot;x=x.value;try{if(!zi(H(),x))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function ja(s,u,p,S){u&=~hr,u&=~Rn,s.suspendedLanes|=u,s.pingedLanes&=~u,S&&(s.warmLanes|=u),S=s.expirationTimes;for(var x=u;0<x;){var H=31-Bi(x),et=1<<H;S[H]=-1,x&=~et}p!==0&&z(s,p,u)}function jl(){return(Ue&6)===0?(ct(0),!1):!0}function Xi(){if(Ee!==null){if(Ke===0)var s=Ee.return;else s=Ee,Si=gs=null,Sr(s),Wi=null,il=0,s=Ee;for(;s!==null;)Pd(s.alternate,s),s=s.return;Ee=null}}function mi(s,u){var p=s.timeoutHandle;p!==$a&&(s.timeoutHandle=$a,Pl(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Xi(),dn=s,Ee=p=Tn(s.current,null),Le=u,Ke=0,_n=null,fr=!1,Pr=j(s,u),Pc=!1,$i=_i=hr=Rn=Pi=wn=0,Oi=ll=null,Hc=!1,(u&8)!==0&&(u|=u&32);var S=s.entangledLanes;if(S!==0)for(s=s.entanglements,S&=u;0<S;){var x=31-Bi(S),H=1<<x;u|=s[x],S&=~H}return Ta=u,ki(),p}function Tr(s,u){ve=null,me.H=bi,u===Js||u===Zs?(u=yl(),Ke=3):u===au?(u=yl(),Ke=4):Ke=u===Bh?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,_n=u,Ee===null&&(wn=1,Tl(s,F(u,s.current)))}function Da(){var s=ga.current;return s===null?!0:(Le&4194048)===Le?Gi===null:(Le&62914560)===Le||(Le&536870912)!==0?s===Gi:!1}function Ua(){var s=me.H;return me.H=bi,s===null?bi:s}function Za(){var s=me.A;return me.A=cn,s}function sc(){wn=4,fr||(Le&4194048)!==Le&&ga.current!==null||(Pr=!0),(Pi&134217727)===0&&(Rn&134217727)===0||dn===null||ja(dn,Le,_i,!1)}function Ho(s,u,p){var S=Ue;Ue|=2;var x=Ua(),H=Za();(dn!==s||Le!==u)&&(xi=null,mi(s,u)),u=!1;var et=wn;t:do try{if(Ke!==0&&Ee!==null){var ut=Ee,_t=_n;switch(Ke){case 8:Xi(),et=6;break t;case 3:case 2:case 9:case 6:ga.current===null&&(u=!0);var zt=Ke;if(Ke=0,_n=null,la(s,ut,_t,zt),p&&Pr){et=0;break t}break;default:zt=Ke,Ke=0,_n=null,la(s,ut,_t,zt)}}Zf(),et=wn;break}catch(Pt){Tr(s,Pt)}while(!0);return u&&s.shellSuspendCounter++,Si=gs=null,Ue=S,me.H=x,me.A=H,Ee===null&&(dn=null,Le=0,ki()),et}function Zf(){for(;Ee!==null;)yn(Ee)}function qd(s,u){var p=Ue;Ue|=2;var S=Ua(),x=Za();dn!==s||Le!==u?(xi=null,ul=fa()+500,mi(s,u)):Pr=j(s,u);t:do try{if(Ke!==0&&Ee!==null){u=Ee;var H=_n;e:switch(Ke){case 1:Ke=0,_n=null,la(s,u,H,1);break;case 2:case 9:if(Fn(H)){Ke=0,_n=null,Ie(u);break}u=function(){Ke!==2&&Ke!==9||dn!==s||(Ke=7),ge(s)},H.then(u,u);break t;case 3:Ke=7;break t;case 4:Ke=5;break t;case 7:Fn(H)?(Ke=0,_n=null,Ie(u)):(Ke=0,_n=null,la(s,u,H,7));break;case 5:var et=null;switch(Ee.tag){case 26:et=Ee.memoizedState;case 5:case 27:var ut=Ee,_t=ut.type,zt=ut.pendingProps;if(et?Ch(et):ir(_t,zt)){Ke=0,_n=null;var Pt=ut.sibling;if(Pt!==null)Ee=Pt;else{var Jt=ut.return;Jt!==null?(Ee=Jt,Di(Jt)):Ee=null}break e}}Ke=0,_n=null,la(s,u,H,5);break;case 6:Ke=0,_n=null,la(s,u,H,6);break;case 8:Xi(),wn=6;break t;default:throw Error(r(462))}}vi();break}catch(ee){Tr(s,ee)}while(!0);return Si=gs=null,me.H=S,me.A=x,Ue=p,Ee!==null?0:(dn=null,Le=0,ki(),wn)}function vi(){for(;Ee!==null&&!Nc();)yn(Ee)}function yn(s){var u=wl(s.alternate,s,Ta);s.memoizedProps=s.pendingProps,u===null?Di(s):Ee=u}function Ie(s){var u=s,p=u.alternate;switch(u.tag){case 15:case 0:u=Ku(p,u,u.pendingProps,u.type,void 0,Le);break;case 11:u=Ku(p,u,u.pendingProps,u.type.render,u.ref,Le);break;case 5:Sr(u);default:Pd(p,u),u=Ee=Io(u,Ta),u=wl(p,u,Ta)}s.memoizedProps=s.pendingProps,u===null?Di(s):Ee=u}function la(s,u,p,S){Si=gs=null,Sr(u),Wi=null,il=0;var x=u.return;try{if(Bg(s,x,u,p,Le)){wn=1,Tl(s,F(p,s.current)),Ee=null;return}}catch(H){if(x!==null)throw Ee=x,H;wn=1,Tl(s,F(p,s.current)),Ee=null;return}u.flags&32768?(Fe||S===1?s=!0:Pr||(Le&536870912)!==0?s=!1:(fr=s=!0,(S===2||S===9||S===3||S===6)&&(S=ga.current,S!==null&&S.tag===13&&(S.flags|=16384))),lc(u,s)):Di(u)}function Di(s){var u=s;do{if((u.flags&32768)!==0){lc(u,fr);return}s=u.return;var p=zg(u.alternate,u,Ta);if(p!==null){Ee=p;return}if(u=u.sibling,u!==null){Ee=u;return}Ee=u=s}while(u!==null);wn===0&&(wn=5)}function lc(s,u){do{var p=Lg(s.alternate,s);if(p!==null){p.flags&=32767,Ee=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(s=s.sibling,s!==null)){Ee=s;return}Ee=s=p}while(s!==null);wn=6,Ee=null}function Ar(s,u,p,S,x,H,et,ut,_t){s.cancelPendingCommit=null;do js();while(rn!==0);if((Ue&6)!==0)throw Error(r(327));if(u!==null){if(u===s.current)throw Error(r(177));if(H=u.lanes|u.childLanes,H|=Lc,y(s,p,H,et,ut,_t),s===dn&&(Ee=dn=null,Le=0),cl=u,Ir=s,Ql=p,dr=H,Xl=x,Ic=S,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ul(wh,function(){return Dl(),null})):(s.callbackNode=null,s.callbackPriority=0),S=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||S){S=me.T,me.T=null,x=nr(),Wn(2),et=Ue,Ue|=4;try{xl(s,u,p)}finally{Ue=et,Wn(x),me.T=S}}rn=1,Wf(),$f(),Ns()}}function Wf(){if(rn===1){rn=0;var s=Ir,u=cl,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=me.T,me.T=null;var S=nr();Wn(2);var x=Ue;Ue|=4;try{Id(u,s),Xo(s.containerInfo)}finally{Ue=x,Wn(S),me.T=p}}s.current=u,rn=2}}function $f(){if(rn===2){rn=0;var s=Ir,u=cl,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=me.T,me.T=null;var S=nr();Wn(2);var x=Ue;Ue|=4;try{ec(s,u.alternate,u)}finally{Ue=x,Wn(S),me.T=p}}rn=3}}function Ns(){if(rn===4||rn===3){rn=0,_0();var s=Ir,u=cl,p=Ql,S=Ic;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?rn=5:(rn=0,cl=Ir=null,is(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(Hr=null),K(p),u=u.stateNode,Fi&&typeof Fi.onCommitFiberRoot=="function")try{Fi.onCommitFiberRoot(kl,u,void 0,(u.current.flags&128)===128)}catch{}if(S!==null){u=me.T,x=nr(),Wn(2),me.T=null;try{for(var H=s.onRecoverableError,et=0;et<S.length;et++){var ut=S[et];H(ut.value,{componentStack:ut.stack})}}finally{me.T=u,Wn(x)}}(Ql&3)!==0&&js(),ge(s),x=s.pendingLanes,(p&4194090)!==0&&(x&42)!==0?s===kc?gr++:(gr=0,kc=s):gr=0,ct(0)}}function is(s,u){(s.pooledCacheLanes&=u)===0&&(u=s.pooledCache,u!=null&&(s.pooledCache=null,an(u)))}function js(s){return Wf(),$f(),Ns(),Dl()}function Dl(){if(rn!==5)return!1;var s=Ir,u=dr;dr=0;var p=K(Ql),S=32>p?32:p;p=me.T;var x=nr();try{Wn(S),me.T=null,S=Xl,Xl=null;var H=Ir,et=Ql;if(rn=0,cl=Ir=null,Ql=0,(Ue&6)!==0)throw Error(r(331));var ut=Ue;if(Ue|=4,kd(H.current),Lo(H,H.current,et,S),Ue=ut,ct(0,!1),Fi&&typeof Fi.onPostCommitFiberRoot=="function")try{Fi.onPostCommitFiberRoot(kl,H)}catch{}return!0}finally{Wn(x),me.T=p,is(s,u)}}function oc(s,u,p){u=F(p,u),u=Bf(s.stateNode,u,2),s=mn(s,u,2),s!==null&&(T(s,2),ge(s))}function qe(s,u,p){if(s.tag===3)oc(s,s,p);else for(;u!==null;){if(u.tag===3){oc(u,s,p);break}else if(u.tag===1){var S=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Hr===null||!Hr.has(S))){s=F(p,s),p=Md(2),S=mn(u,p,2),S!==null&&(zf(p,S,u,s),T(S,2),ge(S));break}}u=u.return}}function Ba(s,u,p){var S=s.pingCache;if(S===null){S=s.pingCache=new vs;var x=new Set;S.set(u,x)}else x=S.get(u),x===void 0&&(x=new Set,S.set(u,x));x.has(p)||(Pc=!0,x.add(p),s=as.bind(null,s,u,p),u.then(s,s))}function as(s,u,p){var S=s.pingCache;S!==null&&S.delete(u),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,dn===s&&(Le&p)===p&&(wn===4||wn===3&&(Le&62914560)===Le&&300>fa()-ol?(Ue&2)===0&&mi(s,0):hr|=p,$i===Le&&($i=0)),ge(s)}function Wa(s,u){u===0&&(u=O()),s=Bt(s,u),s!==null&&(T(s,u),ge(s))}function th(s){var u=s.memoizedState,p=0;u!==null&&(p=u.retryLane),Wa(s,p)}function eh(s,u){var p=0;switch(s.tag){case 13:var S=s.stateNode,x=s.memoizedState;x!==null&&(p=x.retryLane);break;case 19:S=s.stateNode;break;case 22:S=s.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(u),Wa(s,p)}function Ul(s,u){return nu(s,u)}function uc(s,u,p,S){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Tn(s,u){var p=s.alternate;return p===null?(p=n(s.tag,u,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=u,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,u=s.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Io(s,u){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,u=p.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),s}function ko(s,u,p,S,x,H){var et=0;if(S=s,typeof s=="function")wr(s)&&(et=1);else if(typeof s=="string")et=ca&&Vn?bh(s,p,ii.current)?26:Il(s)?27:5:ca?bh(s,p,ii.current)?26:5:Vn&&Il(s)?27:5;else t:switch(s){case ss:return s=n(31,p,u,x),s.elementType=ss,s.lanes=H,s;case zs:return Ds(p.children,x,H,u);case Ls:et=8,x|=24;break;case qo:return s=n(12,p,u,x|2),s.elementType=qo,s.lanes=H,s;case xr:return s=n(13,p,u,x),s.elementType=xr,s.lanes=H,s;case Mr:return s=n(19,p,u,x),s.elementType=Mr,s.lanes=H,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case dc:case Or:et=10;break t;case Vo:et=9;break t;case gc:et=11;break t;case pc:et=14;break t;case Nr:et=16,S=null;break t}et=29,p=Error(r(130,s===null?"null":typeof s,"")),S=null}return u=n(et,p,u,x),u.elementType=s,u.type=S,u.lanes=H,u}function Ds(s,u,p,S){return s=n(7,s,S,u),s.lanes=p,s}function nh(s,u,p){return s=n(6,s,null,u),s.lanes=p,s}function ih(s,u,p){return u=n(4,s.children!==null?s.children:[],s.key,u),u.lanes=p,u.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},u}function Zn(s,u,p,S,x,H,et,ut){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=$a,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=A(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=A(0),this.hiddenUpdates=A(null),this.identifierPrefix=S,this.onUncaughtError=x,this.onCaughtError=H,this.onRecoverableError=et,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ut,this.incompleteTransitions=new Map}function cc(s,u,p,S,x,H,et,ut,_t,zt,Pt,Jt){return s=new Zn(s,u,p,et,ut,_t,zt,Jt),u=1,H===!0&&(u|=24),H=n(3,null,null,u),s.current=H,H.stateNode=s,u=We(),u.refCount++,s.pooledCache=u,u.refCount++,H.memoizedState={element:S,isDehydrated:p,cache:u},Yt(H),s}function Bl(s){return s?(s=hs,s):hs}function zl(s){var u=s._reactInternals;if(u===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=h(u),s=s!==null?g(s):null,s===null?null:Hs(s.stateNode)}function fc(s,u,p,S,x,H){x=Bl(x),S.context===null?S.context=x:S.pendingContext=x,S=xn(u),S.payload={element:p},H=H===void 0?null:H,H!==null&&(S.callback=H),p=mn(s,S,u),p!==null&&(Qi(p,s,u),Xt(p,s,u))}function Us(s,u){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<u?p:u}}function rs(s,u){Us(s,u),(s=s.alternate)&&Us(s,u)}var Pe={},Vd=Eg(),oa=K6(),hc=Object.assign,Bs=Symbol.for("react.element"),Ll=Symbol.for("react.transitional.element"),Rr=Symbol.for("react.portal"),zs=Symbol.for("react.fragment"),Ls=Symbol.for("react.strict_mode"),qo=Symbol.for("react.profiler"),dc=Symbol.for("react.provider"),Vo=Symbol.for("react.consumer"),Or=Symbol.for("react.context"),gc=Symbol.for("react.forward_ref"),xr=Symbol.for("react.suspense"),Mr=Symbol.for("react.suspense_list"),pc=Symbol.for("react.memo"),Nr=Symbol.for("react.lazy"),ss=Symbol.for("react.activity"),Yo=Symbol.for("react.memo_cache_sentinel"),Ko=Symbol.iterator,Qo=Symbol.for("react.client.reference"),Gs=Array.isArray,me=Vd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ps=t.rendererVersion,Yd=t.rendererPackageName,jr=t.extraDevToolsConfig,Hs=t.getPublicInstance,ah=t.getRootHostContext,ls=t.getChildHostContext,os=t.prepareForCommit,Xo=t.resetAfterCommit,rh=t.createInstance;t.cloneMutableInstance;var Fo=t.appendInitialChild,Gl=t.finalizeInitialChildren,us=t.shouldSetTextContent,sh=t.createTextInstance;t.cloneMutableTextInstance;var Kd=t.scheduleTimeout,Pl=t.cancelTimeout,$a=t.noTimeout,tr=t.isPrimaryRenderer;t.warnsIfNotActing;var si=t.supportsMutation,er=t.supportsPersistence,Mn=t.supportsHydration,ba=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var cs=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var Wn=t.setCurrentUpdatePriority,nr=t.getCurrentUpdatePriority,fs=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var ua=t.shouldAttemptEagerTransition,kn=t.detachDeletedInstance;t.requestPostPaintCallback;var mc=t.maySuspendCommit,ir=t.preloadInstance,Oe=t.startSuspendingCommit,un=t.suspendInstance;t.suspendOnActiveViewTransition;var $n=t.waitForCommitToBeReady,Dr=t.NotPendingTransition,_a=t.HostTransitionContext,Is=t.resetFormInstance;t.bindToConsole;var vc=t.supportsMicrotasks,Jo=t.scheduleMicrotask,ar=t.supportsTestSelectors,Gg=t.findFiberRoot,In=t.getBoundingRect,lh=t.getTextContent,ks=t.isHiddenSubtree,Qd=t.matchAccessibilityRole,Xd=t.setFocusIfFocusable,Pg=t.setupIntersectionObserver,oh=t.appendChild,uh=t.appendChildToContainer,ch=t.commitTextUpdate,Ui=t.commitMount,qn=t.commitUpdate,yc=t.insertBefore,Zo=t.insertInContainerBefore,Sc=t.removeChild,fh=t.removeChildFromContainer,rr=t.resetTextContent,bc=t.hideInstance,hh=t.hideTextInstance,dh=t.unhideInstance,Fd=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopGestureTransition,t.getCurrentGestureOffset,t.subscribeToGestureDirection,t.createViewTransitionInstance;var Jd=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var Zd=t.cloneInstance,gh=t.createContainerChildSet,ph=t.appendChildToContainerChildSet,Wd=t.finalizeContainerChildren,_c=t.replaceContainerChildren,mh=t.cloneHiddenInstance,$d=t.cloneHiddenTextInstance,Ec=t.isSuspenseInstancePending,Cc=t.isSuspenseInstanceFallback,t0=t.getSuspenseInstanceFallbackErrorDetails,vh=t.registerSuspenseInstanceRetry,e0=t.canHydrateFormStateMarker,n0=t.isFormStateMarkerMatching,yh=t.getNextHydratableSibling,i0=t.getNextHydratableSiblingAfterSingleton,a0=t.getFirstHydratableChild,Hg=t.getFirstHydratableChildWithinContainer,r0=t.getFirstHydratableChildWithinSuspenseInstance,Hl=t.getFirstHydratableChildWithinSingleton,s0=t.canHydrateInstance,Tc=t.canHydrateTextInstance,Ac=t.canHydrateSuspenseInstance,l0=t.hydrateInstance,Sh=t.hydrateTextInstance,Ig=t.hydrateSuspenseInstance,o0=t.getNextHydratableInstanceAfterSuspenseInstance,u0=t.commitHydratedContainer,c0=t.commitHydratedSuspenseInstance,f0=t.clearSuspenseBoundary,h0=t.clearSuspenseBoundaryFromContainer,wc=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var d0=t.validateHydratableInstance,g0=t.validateHydratableTextInstance,ca=t.supportsResources,bh=t.isHostHoistableType,Rc=t.getHoistableRoot,p0=t.getResource,Oc=t.acquireResource,_h=t.releaseResource,m0=t.hydrateHoistable,xc=t.mountHoistable,Eh=t.unmountHoistable,v0=t.createHoistableInstance,kg=t.prepareToCommitHoistables,qg=t.mayResourceSuspendCommit,Ch=t.preloadResource,Wo=t.suspendResource,Vn=t.supportsSingletons,$o=t.resolveSingletonInstance,y0=t.acquireSingletonInstance,Th=t.releaseSingletonInstance,Il=t.isHostSingletonType,qs=t.isSingletonScope,tu=[],Vs=-1,hs={},Bi=Math.clz32?Math.clz32:N,S0=Math.log,b0=Math.LN2,sr=256,eu=4194304,nu=oa.unstable_scheduleCallback,Mc=oa.unstable_cancelCallback,Nc=oa.unstable_shouldYield,_0=oa.unstable_requestPaint,fa=oa.unstable_now,Ah=oa.unstable_ImmediatePriority,E0=oa.unstable_UserBlockingPriority,wh=oa.unstable_NormalPriority,Rh=oa.unstable_IdlePriority,ti=oa.log,yi=oa.unstable_setDisableYieldValue,kl=null,Fi=null,jc,Oh,Ys=!1,xh=new WeakMap,Ur=[],Ks=0,Dc=null,Qs=0,Ji=[],ha=0,ds=null,lr=1,za="",ii=E(null),Xs=E(null),Br=E(null),ql=E(null),li=null,Yn=null,Fe=!1,zr=null,La=!1,Ga=Error(r(519)),zi=typeof Object.is=="function"?Object.is:Lt,Uc=E(null),gs=null,Si=null,Mh=typeof AbortController<"u"?AbortController:function(){var s=[],u=this.signal={aborted:!1,addEventListener:function(p,S){s.push(S)}};this.abort=function(){u.aborted=!0,s.forEach(function(p){return p()})}},C0=oa.unstable_scheduleCallback,Bc=oa.unstable_NormalPriority,Sn={$$typeof:Or,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},hn=null,Vl=null,Nh=!1,iu=!1,Fs=!1,da=0,Yl=null,zc=0,or=0,Li=null,jh=me.S;me.S=function(s,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&ue(s,u),jh!==null&&jh(s,u)};var Lr=E(null),T0=Object.prototype.hasOwnProperty,Js=Error(r(460)),au=Error(r(474)),Zs=Error(r(542)),ru={then:function(){}},Zi=null,en=[],ps=0,Lc=0,An=!1,Dh=!1,Ws=E(null),su=E(0),nn=0,ve=null,ke=null,Kn=null,lu=!1,$s=!1,tl=!1,el=0,oi=0,wi=null,A0=0,bi={readContext:Kt,use:ju,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useLayoutEffect:on,useInsertionEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useSyncExternalStore:on,useId:on,useHostTransitionStatus:on,useFormState:on,useActionState:on,useOptimistic:on,useMemoCache:on,useCacheRefresh:on},Uh={readContext:Kt,use:ju,useCallback:function(s,u){return ni().memoizedState=[s,u===void 0?null:u],s},useContext:Kt,useEffect:Mf,useImperativeHandle:function(s,u,p){p=p!=null?p.concat([s]):null,br(4194308,4,Qa.bind(null,u,s),p)},useLayoutEffect:function(s,u){return br(4194308,4,s,u)},useInsertionEffect:function(s,u){br(4,2,s,u)},useMemo:function(s,u){var p=ni();u=u===void 0?null:u;var S=s();if(tl){Q(!0);try{s()}finally{Q(!1)}}return p.memoizedState=[S,u],S},useReducer:function(s,u,p){var S=ni();if(p!==void 0){var x=p(u);if(tl){Q(!0);try{p(u)}finally{Q(!1)}}}else x=u;return S.memoizedState=S.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},S.queue=s,s=s.dispatch=Ao.bind(null,ve,s),[S.memoizedState,s]},useRef:function(s){var u=ni();return s={current:s},u.memoizedState=s},useState:function(s){s=_o(s);var u=s.queue,p=Td.bind(null,ve,u);return u.dispatch=p,[s.memoizedState,p]},useDebugValue:Ts,useDeferredValue:function(s,u){var p=ni();return Cl(p,s,u)},useTransition:function(){var s=_o(!1);return s=Co.bind(null,ve,s.queue,!0,!1),ni().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,u,p){var S=ve,x=ni();if(Fe){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),dn===null)throw Error(r(349));(Le&124)!==0||Uu(S,u,p)}x.memoizedState=p;var H={value:p,getSnapshot:u};return x.queue=H,Mf(bo.bind(null,S,H,s),[s]),S.flags|=2048,Vi(9,_l(),Cf.bind(null,S,H,p,u),null),p},useId:function(){var s=ni(),u=dn.identifierPrefix;if(Fe){var p=za,S=lr;p=(S&~(1<<32-Bi(S)-1)).toString(32)+p,u="«"+u+"R"+p,p=el++,0<p&&(u+="H"+p.toString(32)),u+="»"}else p=A0++,u="«"+u+"r"+p.toString(32)+"»";return s.memoizedState=u},useHostTransitionStatus:Hu,useFormState:xf,useActionState:xf,useOptimistic:function(s){var u=ni();u.memoizedState=u.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=wo.bind(null,ve,!0,p),p.dispatch=u,[s,u]},useMemoCache:bl,useCacheRefresh:function(){return ni().memoizedState=Iu.bind(null,ve)}},ur={readContext:Kt,use:ju,useCallback:_r,useContext:Kt,useEffect:Lu,useImperativeHandle:Gu,useInsertionEffect:Nf,useLayoutEffect:El,useMemo:Pu,useReducer:va,useRef:zu,useState:function(){return va(ma)},useDebugValue:Ts,useDeferredValue:function(s,u){var p=Jn();return jf(p,ke.memoizedState,s,u)},useTransition:function(){var s=va(ma)[0],u=Jn().memoizedState;return[typeof s=="boolean"?s:Sl(s),u]},useSyncExternalStore:bd,useId:Mi,useHostTransitionStatus:Hu,useFormState:Bu,useActionState:Bu,useOptimistic:function(s,u){var p=Jn();return Tf(p,ke,s,u)},useMemoCache:bl,useCacheRefresh:Fr},nl={readContext:Kt,use:ju,useCallback:_r,useContext:Kt,useEffect:Lu,useImperativeHandle:Gu,useInsertionEffect:Nf,useLayoutEffect:El,useMemo:Pu,useReducer:Du,useRef:zu,useState:function(){return Du(ma)},useDebugValue:Ts,useDeferredValue:function(s,u){var p=Jn();return ke===null?Cl(p,s,u):jf(p,ke.memoizedState,s,u)},useTransition:function(){var s=Du(ma)[0],u=Jn().memoizedState;return[typeof s=="boolean"?s:Sl(s),u]},useSyncExternalStore:bd,useId:Mi,useHostTransitionStatus:Hu,useFormState:Eo,useActionState:Eo,useOptimistic:function(s,u){var p=Jn();return ke!==null?Tf(p,ke,s,u):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:bl,useCacheRefresh:Fr},Wi=null,il=0,ms=Ad(!0),Ea=Ad(!1),ga=E(null),Gi=null,Ln=E(0),al={enqueueSetState:function(s,u,p){s=s._reactInternals;var S=Ki(),x=xn(S);x.payload=u,p!=null&&(x.callback=p),u=mn(s,x,S),u!==null&&(Qi(u,s,S),Xt(u,s,S))},enqueueReplaceState:function(s,u,p){s=s._reactInternals;var S=Ki(),x=xn(S);x.tag=1,x.payload=u,p!=null&&(x.callback=p),u=mn(s,x,S),u!==null&&(Qi(u,s,S),Xt(u,s,S))},enqueueForceUpdate:function(s,u){s=s._reactInternals;var p=Ki(),S=xn(p);S.tag=2,u!=null&&(S.callback=u),u=mn(s,S,p),u!==null&&(Qi(u,s,p),Xt(u,s,p))}},rl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Bh=Error(r(461)),ai=!1,sl={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},cr=!1,Nn=!1,Gc=!1,w0=typeof WeakSet=="function"?WeakSet:Set,ui=null,Se=null,ze=!1,Ae=null,De=8192,cn={getCacheForType:function(s){var u=Kt(Sn),p=u.data.get(s);return p===void 0&&(p=s(),u.data.set(s,p)),p}},Ri=0,Pa=1,Gr=2,Kl=3,Ca=4;if(typeof Symbol=="function"&&Symbol.for){var bn=Symbol.for;Ri=bn("selector.component"),Pa=bn("selector.has_pseudo_class"),Gr=bn("selector.role"),Kl=bn("selector.test_id"),Ca=bn("selector.text")}var vs=typeof WeakMap=="function"?WeakMap:Map,Ue=0,dn=null,Ee=null,Le=0,Ke=0,_n=null,fr=!1,Pr=!1,Pc=!1,Ta=0,wn=0,Pi=0,Rn=0,hr=0,_i=0,$i=0,ll=null,Oi=null,Hc=!1,ol=0,ul=1/0,xi=null,Hr=null,rn=0,Ir=null,cl=null,Ql=0,dr=0,Xl=null,Ic=null,gr=0,kc=null;return Pe.attemptContinuousHydration=function(s){if(s.tag===13){var u=Bt(s,67108864);u!==null&&Qi(u,s,67108864),rs(s,67108864)}},Pe.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var u=Ki();u=P(u);var p=Bt(s,u);p!==null&&Qi(p,s,u),rs(s,u)}},Pe.attemptSynchronousHydration=function(s){switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var u=B(s.pendingLanes);if(u!==0){for(s.pendingLanes|=2,s.entangledLanes|=2;u;){var p=1<<31-Bi(u);s.entanglements[1]|=p,u&=~p}ge(s),(Ue&6)===0&&(ul=fa()+500,ct(0))}}break;case 13:u=Bt(s,2),u!==null&&Qi(u,s,2),jl(),rs(s,2)}},Pe.batchedUpdates=function(s,u){return s(u)},Pe.createComponentSelector=function(s){return{$$typeof:Ri,value:s}},Pe.createContainer=function(s,u,p,S,x,H,et,ut,_t,zt){return cc(s,u,!1,null,p,S,H,et,ut,_t,zt,null)},Pe.createHasPseudoClassSelector=function(s){return{$$typeof:Pa,value:s}},Pe.createHydrationContainer=function(s,u,p,S,x,H,et,ut,_t,zt,Pt,Jt,ee){return s=cc(p,S,!0,s,x,H,ut,_t,zt,Pt,Jt,ee),s.context=Bl(null),p=s.current,S=Ki(),S=P(S),x=xn(S),x.callback=u??null,mn(p,x,S),u=S,s.current.lanes=u,T(s,u),ge(s),s},Pe.createPortal=function(s,u,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rr,key:S==null?null:""+S,children:s,containerInfo:u,implementation:p}},Pe.createRoleSelector=function(s){return{$$typeof:Gr,value:s}},Pe.createTestNameSelector=function(s){return{$$typeof:Kl,value:s}},Pe.createTextSelector=function(s){return{$$typeof:Ca,value:s}},Pe.defaultOnCaughtError=function(s){console.error(s)},Pe.defaultOnRecoverableError=function(s){rl(s)},Pe.defaultOnUncaughtError=function(s){rl(s)},Pe.deferredUpdates=function(s){var u=me.T,p=nr();try{return Wn(32),me.T=null,s()}finally{Wn(p),me.T=u}},Pe.discreteUpdates=function(s,u,p,S,x){var H=me.T,et=nr();try{return Wn(2),me.T=null,s(u,p,S,x)}finally{Wn(et),me.T=H,Ue===0&&(ul=fa()+500)}},Pe.findAllNodes=Po,Pe.findBoundingRects=function(s,u){if(!ar)throw Error(r(363));u=Po(s,u),s=[];for(var p=0;p<u.length;p++)s.push(In(u[p]));for(u=s.length-1;0<u;u--){p=s[u];for(var S=p.x,x=S+p.width,H=p.y,et=H+p.height,ut=u-1;0<=ut;ut--)if(u!==ut){var _t=s[ut],zt=_t.x,Pt=zt+_t.width,Jt=_t.y,ee=Jt+_t.height;if(S>=zt&&H>=Jt&&x<=Pt&&et<=ee){s.splice(u,1);break}else if(S!==zt||p.width!==_t.width||ee<H||Jt>et){if(!(H!==Jt||p.height!==_t.height||Pt<S||zt>x)){zt>S&&(_t.width+=zt-S,_t.x=S),Pt<x&&(_t.width=x-zt),s.splice(u,1);break}}else{Jt>H&&(_t.height+=Jt-H,_t.y=H),ee<et&&(_t.height=et-Jt),s.splice(u,1);break}}}return s},Pe.findHostInstance=zl,Pe.findHostInstanceWithNoPortals=function(s){return s=h(s),s=s!==null?m(s):null,s===null?null:Hs(s.stateNode)},Pe.findHostInstanceWithWarning=function(s){return zl(s)},Pe.flushPassiveEffects=js,Pe.flushSyncFromReconciler=function(s){var u=Ue;Ue|=1;var p=me.T,S=nr();try{if(Wn(2),me.T=null,s)return s()}finally{Wn(S),me.T=p,Ue=u,(Ue&6)===0&&ct(0)}},Pe.flushSyncWork=jl,Pe.focusWithin=function(s,u){if(!ar)throw Error(r(363));for(s=Na(s),u=ns(s,u),u=Array.from(u),s=0;s<u.length;){var p=u[s++],S=p.tag;if(!ks(p)){if((S===5||S===26||S===27)&&Xd(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},Pe.getFindAllNodesFailureDescription=function(s,u){if(!ar)throw Error(r(363));var p=0,S=[];s=[Na(s),0];for(var x=0;x<s.length;){var H=s[x++],et=H.tag,ut=s[x++],_t=u[ut];if((et!==5&&et!==26&&et!==27||!ks(H))&&(ac(H,_t)&&(S.push(Ml(_t)),ut++,ut>p&&(p=ut)),ut<u.length))for(H=H.child;H!==null;)s.push(H,ut),H=H.sibling}if(p<u.length){for(s=[];p<u.length;p++)s.push(Ml(u[p]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},Pe.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 27:case 5:return Hs(s.child.stateNode);default:return s.child.stateNode}},Pe.injectIntoDevTools=function(){var s={bundleType:0,version:Ps,rendererPackageName:Yd,currentDispatcherRef:me,reconcilerVersion:"19.1.0"};if(jr!==null&&(s.rendererConfig=jr),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)s=!0;else{try{kl=u.inject(s),Fi=u}catch{}s=!!u.checkDCE}}return s},Pe.isAlreadyRendering=function(){return(Ue&6)!==0},Pe.observeVisibleRects=function(s,u,p,S){if(!ar)throw Error(r(363));s=Po(s,u);var x=Pg(s,p,S).disconnect;return{disconnect:function(){x()}}},Pe.shouldError=function(){return null},Pe.shouldSuspend=function(){return!1},Pe.startHostTransition=function(s,u,p,S){if(s.tag!==5)throw Error(r(476));var x=To(s).queue;Co(s,x,u,Dr,p===null?i:function(){var H=To(s).next.queue;return As(s,H,{},Ki()),p(S)})},Pe.updateContainer=function(s,u,p,S){var x=u.current,H=Ki();return fc(x,H,s,u,p,S),H},Pe.updateContainerSync=function(s,u,p,S){return fc(u.current,2,s,u,p,S),2},Pe},l.exports.default=l.exports,Object.defineProperty(l.exports,"__esModule",{value:!0})})(Dp)),Dp.exports}var $y;function X6(){return $y||($y=1,jp.exports=Q6()),jp.exports}var F6=X6();const J6=pf(F6);var zp={exports:{}},hl={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function Z6(){return t1||(t1=1,hl.ConcurrentRoot=1,hl.ContinuousEventPriority=8,hl.DefaultEventPriority=32,hl.DiscreteEventPriority=2,hl.IdleEventPriority=268435456,hl.LegacyRoot=0,hl.NoEventPriority=0),hl}var e1;function W6(){return e1||(e1=1,zp.exports=Z6()),zp.exports}var xg=W6();const n1={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let i1=!1,a1=!1;const mg=".react-konva-event",$6=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,t8=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,e8={};function Mg(l,t,n=e8){if(!i1&&"zIndex"in t&&(console.warn(t8),i1=!0),!a1&&t.draggable){var i=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;i&&!r&&(console.warn($6),a1=!0)}for(var o in n)if(!n1[o]){var f=o.slice(0,2)==="on",h=n[o]!==t[o];if(f&&h){var g=o.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),l.off(g,n[o])}var m=!t.hasOwnProperty(o);m&&l.setAttr(o,void 0)}var _=t._useStrictMode,C={},E=!1;const R={};for(var o in t)if(!n1[o]){var f=o.slice(0,2)==="on",v=n[o]!==t[o];if(f&&v){var g=o.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),t[o]&&(R[g]=t[o])}!f&&(t[o]!==n[o]||_&&t[o]!==l.getAttr(o))&&(E=!0,C[o]=t[o])}E&&(l.setAttrs(C),vo(l));for(var g in R)l.off(g+mg),l.on(g+mg,R[g])}function vo(l){if(!Ft.autoDrawEnabled){var t=l.getLayer()||l.getStage();t&&t.batchDraw()}}var Lp={exports:{}},Gp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function n8(){return r1||(r1=1,(function(l){function t(D,I){var F=D.length;D.push(I);t:for(;0<F;){var W=F-1>>>1,it=D[W];if(0<r(it,I))D[W]=I,D[F]=it,F=W;else break t}}function n(D){return D.length===0?null:D[0]}function i(D){if(D.length===0)return null;var I=D[0],F=D.pop();if(F!==I){D[0]=F;t:for(var W=0,it=D.length,Z=it>>>1;W<Z;){var at=2*(W+1)-1,rt=D[at],V=at+1,J=D[V];if(0>r(rt,F))V<it&&0>r(J,rt)?(D[W]=J,D[V]=F,W=V):(D[W]=rt,D[at]=F,W=at);else if(V<it&&0>r(J,F))D[W]=J,D[V]=F,W=V;else break t}}return I}function r(D,I){var F=D.sortIndex-I.sortIndex;return F!==0?F:D.id-I.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;l.unstable_now=function(){return o.now()}}else{var f=Date,h=f.now();l.unstable_now=function(){return f.now()-h}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,N=!1,B=!1,L=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(D){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=D)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(D){if(N=!1,G(D),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-D)}}var A=!1,T=-1,y=5,z=-1;function U(){return B?!0:!(l.unstable_now()-z<y)}function P(){if(B=!1,A){var D=l.unstable_now();z=D;var I=!0;try{t:{v=!1,N&&(N=!1,j(T),T=-1),R=!0;var F=E;try{e:{for(G(D),C=n(g);C!==null&&!(C.expirationTime>D&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=D);if(D=l.unstable_now(),typeof it=="function"){C.callback=it,G(D),I=!0;break e}C===n(g)&&i(g),G(D)}else i(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-D),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=P,K=function(){X.postMessage(null)}}else K=function(){L(P,0)};function Y(D,I){T=L(function(){D(l.unstable_now())},I)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(D){D.callback=null},l.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<D?Math.floor(1e3/D):5},l.unstable_getCurrentPriorityLevel=function(){return E},l.unstable_next=function(D){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return D()}finally{E=F}},l.unstable_requestPaint=function(){B=!0},l.unstable_runWithPriority=function(D,I){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=E;E=D;try{return I()}finally{E=F}},l.unstable_scheduleCallback=function(D,I,F){var W=l.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,D){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,D={id:_++,callback:I,priorityLevel:D,startTime:F,expirationTime:it,sortIndex:-1},F>W?(D.sortIndex=F,t(m,D),n(g)===null&&D===n(m)&&(N?(j(T),T=-1):N=!0,Y(O,F-W))):(D.sortIndex=it,t(g,D),v||R||(v=!0,A||(A=!0,K()))),D},l.unstable_shouldYield=U,l.unstable_wrapCallback=function(D){var I=E;return function(){var F=E;E=I;try{return D.apply(this,arguments)}finally{E=F}}}})(Gp)),Gp}var s1;function i8(){return s1||(s1=1,Lp.exports=n8()),Lp.exports}var Pp=i8();const fS={},a8={};hf.Node.prototype._applyProps=Mg;let hS=xg.DefaultEventPriority;function r8(l,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}l.add(t),vo(l)}function s8(l,t,n){let i=hf[l];i||(console.error(`Konva has no node with the type ${l}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${l}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),i=hf.Group);const r={},o={};for(var f in t)if(f!=="ref"){var h=f.slice(0,2)==="on";h?o[f]=t[f]:r[f]=t[f]}const g=new i(r);return Mg(g,o),g}function l8(l,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${l}"`)}function o8(l,t,n){return!1}function u8(l){return l}function c8(){return null}function f8(){return null}function h8(l,t,n,i){return a8}function d8(){}function g8(l){}function p8(l,t){return!1}function m8(){return fS}function v8(){return fS}const y8=setTimeout,S8=clearTimeout,b8=!0,_8=l=>{l()},E8=-1;function C8(l,t){return!1}const T8=!1,A8=!1,w8=!0,R8=!1,O8=!1;function x8(l,t){t.parent===l?t.moveToTop():l.add(t),vo(l)}function M8(l,t){t.parent===l?t.moveToTop():l.add(t),vo(l)}function dS(l,t,n){t._remove(),l.add(t),t.setZIndex(n.getZIndex()),vo(l)}function N8(l,t,n){dS(l,t,n)}function j8(l,t){t.destroy(),t.off(mg),vo(l)}function D8(l,t){t.destroy(),t.off(mg),vo(l)}function U8(l,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function B8(l,t,n){}function z8(l,t,n,i){Mg(l,i,n)}function L8(l){l.hide(),vo(l)}function G8(l){}function P8(l,t){(t.visible==null||t.visible)&&l.show()}function H8(l,t){}function I8(l){}function k8(){}function q8(){return xg.DefaultEventPriority}function V8(){}function Y8(){return null}function K8(l){hS=l}function Q8(){return hS}function X8(){return xg.DiscreteEventPriority}function F8(){return!1}function J8(){}function Z8(){return!1}function W8(){return!0}function $8(){}function t_(){}function e_(){return null}const n_=null;function i_(){}const a_=Object.freeze(Object.defineProperty({__proto__:null,NotPendingTransition:n_,appendChild:x8,appendChildToContainer:M8,appendInitialChild:r8,cancelTimeout:S8,clearContainer:I8,commitMount:B8,commitTextUpdate:U8,commitUpdate:z8,createInstance:s8,createTextInstance:l8,detachDeletedInstance:k8,finalizeInitialChildren:o8,getChildHostContext:v8,getCurrentEventPriority:q8,getCurrentUpdatePriority:Q8,getInstanceFromScope:Y8,getPublicInstance:u8,getRootHostContext:m8,hideInstance:L8,hideTextInstance:G8,idlePriority:Pp.unstable_IdlePriority,insertBefore:dS,insertInContainerBefore:N8,isPrimaryRenderer:T8,maySuspendCommit:Z8,noTimeout:E8,now:Pp.unstable_now,preloadInstance:W8,prepareForCommit:c8,preparePortalMount:f8,prepareScopeUpdate:V8,prepareUpdate:h8,removeChild:j8,removeChildFromContainer:D8,requestPostPaintCallback:J8,resetAfterCommit:d8,resetFormInstance:i_,resetTextContent:g8,resolveUpdatePriority:X8,run:Pp.unstable_runWithPriority,scheduleMicrotask:_8,scheduleTimeout:y8,setCurrentUpdatePriority:K8,shouldAttemptEagerTransition:F8,shouldDeprioritizeSubtree:p8,shouldSetTextContent:C8,startSuspendingCommit:$8,supportsHydration:O8,supportsMicrotasks:b8,supportsMutation:w8,supportsPersistence:R8,suspendInstance:t_,unhideInstance:P8,unhideTextInstance:H8,waitForCommitToBeReady:e_,warnsIfNotActing:A8},Symbol.toStringTag,{value:"Module"}));function gS(l,t,n){if(!l)return;if(n(l)===!0)return l;let i=l.child;for(;i;){const r=gS(i,t,n);if(r)return r;i=i.sibling}}function pS(l){try{return Object.defineProperties(l,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return l}}const nv=pS(st.createContext(null));class mS extends st.Component{render(){return st.createElement(nv.Provider,{value:this._reactInternals},this.props.children)}}function r_(){const l=st.useContext(nv);if(l===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=st.useId();return st.useMemo(()=>{for(const n of[l,l==null?void 0:l.alternate]){if(!n)continue;const i=gS(n,!1,r=>{let o=r.memoizedState;for(;o;){if(o.memoizedState===t)return!0;o=o.next}});if(i)return i}},[l,t])}const s_=Symbol.for("react.context"),l_=l=>l!==null&&typeof l=="object"&&"$$typeof"in l&&l.$$typeof===s_;function o_(){const l=r_(),[t]=st.useState(()=>new Map);t.clear();let n=l;for(;n;){const i=n.type;l_(i)&&i!==nv&&!t.has(i)&&t.set(i,st.use(pS(i))),n=n.return}return t}function u_(){const l=o_();return st.useMemo(()=>Array.from(l.keys()).reduce((t,n)=>i=>st.createElement(t,null,st.createElement(n.Provider,{...i,value:l.get(n)})),t=>st.createElement(mS,{...t})),[l])}if(ei.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function c_(l){const t=ei.useRef({});return ei.useLayoutEffect(()=>{t.current=l}),ei.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const f_=()=>{const l=ei.useRef(0);return ei.useMemo(()=>{l.current++},[]),l.current>1},h_=l=>{const t=ei.useRef(null),n=ei.useRef(null),i=ei.useRef(null),r=c_(l),o=u_(),f=ei.useRef(!1),h=m=>{const{forwardedRef:_}=l;_&&(typeof _=="function"?_(m):_.current=m)},g=f_();return ei.useLayoutEffect(()=>f.current&&g?()=>{f.current=!1,h(null),sf.updateContainer(null,i.current,null),n.current.destroy()}:(f.current=!0,n.current=new hf.Stage({width:l.width,height:l.height,container:t.current}),h(n.current),i.current=sf.createContainer(n.current,xg.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),sf.updateContainer(ei.createElement(o,{},l.children),i.current,null,()=>{}),()=>{g||(h(null),sf.updateContainer(null,i.current,null),n.current.destroy())}),[]),ei.useLayoutEffect(()=>{h(n.current),Mg(n.current,l,r),sf.updateContainer(ei.createElement(o,{},l.children),i.current,null)}),ei.createElement("div",{ref:t,id:l.id,accessKey:l.accessKey,className:l.className,role:l.role,style:l.style,tabIndex:l.tabIndex,title:l.title})},Yr="Layer",fo="Line",iv="Image",sf=J6(a_);sf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:ei.version,rendererPackageName:"react-konva"});const Ng=ei.forwardRef((l,t)=>ei.createElement(mS,{},ei.createElement(h_,{...l,forwardedRef:t})));var Hp={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var l1;function vS(){return l1||(l1=1,(function(l,t){(function(i,r){l.exports=r()})(window,function(){return(function(n){var i={};function r(o){if(i[o])return i[o].exports;var f=i[o]={i:o,l:!1,exports:{}};return n[o].call(f.exports,f,f.exports,r),f.l=!0,f.exports}return r.m=n,r.c=i,r.d=function(o,f,h){r.o(o,f)||Object.defineProperty(o,f,{enumerable:!0,get:h})},r.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,f){if(f&1&&(o=r(o)),f&8||f&4&&typeof o=="object"&&o&&o.__esModule)return o;var h=Object.create(null);if(r.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:o}),f&2&&typeof o!="string")for(var g in o)r.d(h,g,(function(m){return o[m]}).bind(null,g));return h},r.n=function(o){var f=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(f,"a",f),f},r.o=function(o,f){return Object.prototype.hasOwnProperty.call(o,f)},r.p="",r(r.s=42)})([(function(n,i,r){r.r(i),r.d(i,"__extends",function(){return f}),r.d(i,"__assign",function(){return h}),r.d(i,"__rest",function(){return g}),r.d(i,"__decorate",function(){return m}),r.d(i,"__param",function(){return _}),r.d(i,"__metadata",function(){return C}),r.d(i,"__awaiter",function(){return E}),r.d(i,"__generator",function(){return R}),r.d(i,"__createBinding",function(){return v}),r.d(i,"__exportStar",function(){return N}),r.d(i,"__values",function(){return B}),r.d(i,"__read",function(){return L}),r.d(i,"__spread",function(){return j}),r.d(i,"__spreadArrays",function(){return M}),r.d(i,"__spreadArray",function(){return G}),r.d(i,"__await",function(){return O}),r.d(i,"__asyncGenerator",function(){return A}),r.d(i,"__asyncDelegator",function(){return T}),r.d(i,"__asyncValues",function(){return y}),r.d(i,"__makeTemplateObject",function(){return z}),r.d(i,"__importStar",function(){return P}),r.d(i,"__importDefault",function(){return K}),r.d(i,"__classPrivateFieldGet",function(){return Q}),r.d(i,"__classPrivateFieldSet",function(){return X});/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */var o=function(Y,D){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var W in F)Object.prototype.hasOwnProperty.call(F,W)&&(I[W]=F[W])},o(Y,D)};function f(Y,D){if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");o(Y,D);function I(){this.constructor=Y}Y.prototype=D===null?Object.create(D):(I.prototype=D.prototype,new I)}var h=function(){return h=Object.assign||function(D){for(var I,F=1,W=arguments.length;F<W;F++){I=arguments[F];for(var it in I)Object.prototype.hasOwnProperty.call(I,it)&&(D[it]=I[it])}return D},h.apply(this,arguments)};function g(Y,D){var I={};for(var F in Y)Object.prototype.hasOwnProperty.call(Y,F)&&D.indexOf(F)<0&&(I[F]=Y[F]);if(Y!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,F=Object.getOwnPropertySymbols(Y);W<F.length;W++)D.indexOf(F[W])<0&&Object.prototype.propertyIsEnumerable.call(Y,F[W])&&(I[F[W]]=Y[F[W]]);return I}function m(Y,D,I,F){var W=arguments.length,it=W<3?D:F===null?F=Object.getOwnPropertyDescriptor(D,I):F,Z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")it=Reflect.decorate(Y,D,I,F);else for(var at=Y.length-1;at>=0;at--)(Z=Y[at])&&(it=(W<3?Z(it):W>3?Z(D,I,it):Z(D,I))||it);return W>3&&it&&Object.defineProperty(D,I,it),it}function _(Y,D){return function(I,F){D(I,F,Y)}}function C(Y,D){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Y,D)}function E(Y,D,I,F){function W(it){return it instanceof I?it:new I(function(Z){Z(it)})}return new(I||(I=Promise))(function(it,Z){function at(J){try{V(F.next(J))}catch($){Z($)}}function rt(J){try{V(F.throw(J))}catch($){Z($)}}function V(J){J.done?it(J.value):W(J.value).then(at,rt)}V((F=F.apply(Y,D||[])).next())})}function R(Y,D){var I={label:0,sent:function(){if(it[0]&1)throw it[1];return it[1]},trys:[],ops:[]},F,W,it,Z;return Z={next:at(0),throw:at(1),return:at(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function at(V){return function(J){return rt([V,J])}}function rt(V){if(F)throw new TypeError("Generator is already executing.");for(;I;)try{if(F=1,W&&(it=V[0]&2?W.return:V[0]?W.throw||((it=W.return)&&it.call(W),0):W.next)&&!(it=it.call(W,V[1])).done)return it;switch(W=0,it&&(V=[V[0]&2,it.value]),V[0]){case 0:case 1:it=V;break;case 4:return I.label++,{value:V[1],done:!1};case 5:I.label++,W=V[1],V=[0];continue;case 7:V=I.ops.pop(),I.trys.pop();continue;default:if(it=I.trys,!(it=it.length>0&&it[it.length-1])&&(V[0]===6||V[0]===2)){I=0;continue}if(V[0]===3&&(!it||V[1]>it[0]&&V[1]<it[3])){I.label=V[1];break}if(V[0]===6&&I.label<it[1]){I.label=it[1],it=V;break}if(it&&I.label<it[2]){I.label=it[2],I.ops.push(V);break}it[2]&&I.ops.pop(),I.trys.pop();continue}V=D.call(Y,I)}catch(J){V=[6,J],W=0}finally{F=it=0}if(V[0]&5)throw V[1];return{value:V[0]?V[1]:void 0,done:!0}}}var v=Object.create?(function(Y,D,I,F){F===void 0&&(F=I),Object.defineProperty(Y,F,{enumerable:!0,get:function(){return D[I]}})}):(function(Y,D,I,F){F===void 0&&(F=I),Y[F]=D[I]});function N(Y,D){for(var I in Y)I!=="default"&&!Object.prototype.hasOwnProperty.call(D,I)&&v(D,Y,I)}function B(Y){var D=typeof Symbol=="function"&&Symbol.iterator,I=D&&Y[D],F=0;if(I)return I.call(Y);if(Y&&typeof Y.length=="number")return{next:function(){return Y&&F>=Y.length&&(Y=void 0),{value:Y&&Y[F++],done:!Y}}};throw new TypeError(D?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(Y,D){var I=typeof Symbol=="function"&&Y[Symbol.iterator];if(!I)return Y;var F=I.call(Y),W,it=[],Z;try{for(;(D===void 0||D-- >0)&&!(W=F.next()).done;)it.push(W.value)}catch(at){Z={error:at}}finally{try{W&&!W.done&&(I=F.return)&&I.call(F)}finally{if(Z)throw Z.error}}return it}function j(){for(var Y=[],D=0;D<arguments.length;D++)Y=Y.concat(L(arguments[D]));return Y}function M(){for(var Y=0,D=0,I=arguments.length;D<I;D++)Y+=arguments[D].length;for(var F=Array(Y),W=0,D=0;D<I;D++)for(var it=arguments[D],Z=0,at=it.length;Z<at;Z++,W++)F[W]=it[Z];return F}function G(Y,D,I){if(I||arguments.length===2)for(var F=0,W=D.length,it;F<W;F++)(it||!(F in D))&&(it||(it=Array.prototype.slice.call(D,0,F)),it[F]=D[F]);return Y.concat(it||Array.prototype.slice.call(D))}function O(Y){return this instanceof O?(this.v=Y,this):new O(Y)}function A(Y,D,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var F=I.apply(Y,D||[]),W,it=[];return W={},Z("next"),Z("throw"),Z("return"),W[Symbol.asyncIterator]=function(){return this},W;function Z(nt){F[nt]&&(W[nt]=function(dt){return new Promise(function(wt,Ut){it.push([nt,dt,wt,Ut])>1||at(nt,dt)})})}function at(nt,dt){try{rt(F[nt](dt))}catch(wt){$(it[0][3],wt)}}function rt(nt){nt.value instanceof O?Promise.resolve(nt.value.v).then(V,J):$(it[0][2],nt)}function V(nt){at("next",nt)}function J(nt){at("throw",nt)}function $(nt,dt){nt(dt),it.shift(),it.length&&at(it[0][0],it[0][1])}}function T(Y){var D,I;return D={},F("next"),F("throw",function(W){throw W}),F("return"),D[Symbol.iterator]=function(){return this},D;function F(W,it){D[W]=Y[W]?function(Z){return(I=!I)?{value:O(Y[W](Z)),done:W==="return"}:it?it(Z):Z}:it}}function y(Y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var D=Y[Symbol.asyncIterator],I;return D?D.call(Y):(Y=typeof B=="function"?B(Y):Y[Symbol.iterator](),I={},F("next"),F("throw"),F("return"),I[Symbol.asyncIterator]=function(){return this},I);function F(it){I[it]=Y[it]&&function(Z){return new Promise(function(at,rt){Z=Y[it](Z),W(at,rt,Z.done,Z.value)})}}function W(it,Z,at,rt){Promise.resolve(rt).then(function(V){it({value:V,done:at})},Z)}}function z(Y,D){return Object.defineProperty?Object.defineProperty(Y,"raw",{value:D}):Y.raw=D,Y}var U=Object.create?(function(Y,D){Object.defineProperty(Y,"default",{enumerable:!0,value:D})}):function(Y,D){Y.default=D};function P(Y){if(Y&&Y.__esModule)return Y;var D={};if(Y!=null)for(var I in Y)I!=="default"&&Object.prototype.hasOwnProperty.call(Y,I)&&v(D,Y,I);return U(D,Y),D}function K(Y){return Y&&Y.__esModule?Y:{default:Y}}function Q(Y,D,I,F){if(I==="a"&&!F)throw new TypeError("Private accessor was defined without a getter");if(typeof D=="function"?Y!==D||!F:!D.has(Y))throw new TypeError("Cannot read private member from an object whose class did not declare it");return I==="m"?F:I==="a"?F.call(Y):F?F.value:D.get(Y)}function X(Y,D,I,F,W){if(F==="m")throw new TypeError("Private method is not writable");if(F==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof D=="function"?Y!==D||!W:!D.has(Y))throw new TypeError("Cannot write private member to an object whose class did not declare it");return F==="a"?W.call(Y,I):W?W.value=I:D.set(Y,I),I}}),(function(n,i,r){(function(o){Object.defineProperty(i,"__esModule",{value:!0}),i.allToUpperCase=i.allToLowerCase=i.encodeBody=i.decodeBody=i.Format=i.promisify=i.trim=i.arrChooseN=i.randomHexString=i.randomString=i.cheapRandStr=i.dataSizeBytes=i.inspectBody=i.inspectError=i.isErrorInfoOrPartialErrorInfo=i.now=i.parseQueryString=i.toQueryString=i.arrPopRandomElement=i.defaultPostHeaders=i.defaultGetHeaders=i.allSame=i.arrEvery=i.arrFilter=i.arrMap=i.safeArrForEach=i.arrForEach=i.forInOwnNonNullProperties=i.valuesArray=i.keysArray=i.arrWithoutValue=i.arrDeleteValue=i.arrIn=i.arrIndexOf=i.arrSubtract=i.arrIntersectOb=i.arrIntersect=i.intersect=i.containsValue=i.inherits=i.prototypicalClone=i.shallowClone=i.isEmptyArg=i.isOnlyPropIn=i.isEmpty=i.isObject=i.ensureArray=i.isArray=i.copy=i.mixin=void 0,i.arrEquals=i.toBase64=i.matchDerivedChannel=i.shallowEquals=i.getGlobalObject=i.getRetryTime=i.getJitterCoefficient=i.getBackoffCoefficient=void 0;var f=r(0),h=f.__importDefault(r(3)),g=f.__importStar(r(8)),m=f.__importDefault(r(4)),_=r(11),C=r(31);function E(ct){return Math.floor(Math.random()*ct.length)}function R(ct){for(var At=[],Mt=1;Mt<arguments.length;Mt++)At[Mt-1]=arguments[Mt];for(var qt=0;qt<At.length;qt++){var pe=At[qt];if(!pe)break;var ht=Object.prototype.hasOwnProperty;for(var vt in pe)(!ht||ht.call(pe,vt))&&(ct[vt]=pe[vt])}return ct}i.mixin=R;function v(ct){return R({},ct)}i.copy=v,i.isArray=Array.isArray||function(ct){return Object.prototype.toString.call(ct)=="[object Array]"};function N(ct){return M(ct)?[]:(0,i.isArray)(ct)?ct:[ct]}i.ensureArray=N;function B(ct){return Object.prototype.toString.call(ct)=="[object Object]"}i.isObject=B;function L(ct){for(var At in ct)return!1;return!0}i.isEmpty=L;function j(ct,At){for(var Mt in ct)if(Mt!==At)return!1;return!0}i.isOnlyPropIn=j;function M(ct){return ct==null}i.isEmptyArg=M;function G(ct){var At=new Object;for(var Mt in ct)At[Mt]=ct[Mt];return At}i.shallowClone=G;function O(ct,At){var Mt=(function(){function pe(){}return pe})();Mt.prototype=ct;var qt=new Mt;return At&&R(qt,At),qt}i.prototypicalClone=O;var A=function(ct,At){if(h.default.Config.inherits){h.default.Config.inherits(ct,At);return}ct.super_=At,ct.prototype=O(At.prototype,{constructor:ct})};i.inherits=A;function T(ct,At){for(var Mt in ct)if(ct[Mt]==At)return!0;return!1}i.containsValue=T;function y(ct,At){return(0,i.isArray)(At)?z(ct,At):U(ct,At)}i.intersect=y;function z(ct,At){for(var Mt=[],qt=0;qt<ct.length;qt++){var pe=ct[qt];(0,i.arrIndexOf)(At,pe)!=-1&&Mt.push(pe)}return Mt}i.arrIntersect=z;function U(ct,At){for(var Mt=[],qt=0;qt<ct.length;qt++){var pe=ct[qt];pe in At&&Mt.push(pe)}return Mt}i.arrIntersectOb=U;function P(ct,At){for(var Mt=[],qt=0;qt<ct.length;qt++){var pe=ct[qt];(0,i.arrIndexOf)(At,pe)==-1&&Mt.push(pe)}return Mt}i.arrSubtract=P,i.arrIndexOf=Array.prototype.indexOf?function(ct,At,Mt){return ct.indexOf(At,Mt)}:function(ct,At,Mt){Mt=Mt||0;for(var qt=ct.length;Mt<qt;Mt++)if(ct[Mt]===At)return Mt;return-1};function K(ct,At){return(0,i.arrIndexOf)(ct,At)!==-1}i.arrIn=K;function Q(ct,At){var Mt=(0,i.arrIndexOf)(ct,At),qt=Mt!=-1;return qt&&ct.splice(Mt,1),qt}i.arrDeleteValue=Q;function X(ct,At){var Mt=ct.slice();return Q(Mt,At),Mt}i.arrWithoutValue=X;function Y(ct,At){var Mt=[];for(var qt in ct)At&&!Object.prototype.hasOwnProperty.call(ct,qt)||Mt.push(qt);return Mt}i.keysArray=Y;function D(ct,At){var Mt=[];for(var qt in ct)At&&!Object.prototype.hasOwnProperty.call(ct,qt)||Mt.push(ct[qt]);return Mt}i.valuesArray=D;function I(ct,At){for(var Mt in ct)Object.prototype.hasOwnProperty.call(ct,Mt)&&ct[Mt]&&At(Mt)}i.forInOwnNonNullProperties=I,i.arrForEach=Array.prototype.forEach?function(ct,At){ct.forEach(At)}:function(ct,At){for(var Mt=ct.length,qt=0;qt<Mt;qt++)At(ct[qt],qt,ct)};function F(ct,At){return(0,i.arrForEach)(ct.slice(),At)}i.safeArrForEach=F,i.arrMap=Array.prototype.map?function(ct,At){return ct.map(At)}:function(ct,At){for(var Mt=[],qt=ct.length,pe=0;pe<qt;pe++)Mt.push(At(ct[pe],pe,ct));return Mt},i.arrFilter=Array.prototype.filter?function(ct,At){return ct.filter(At)}:function(ct,At){for(var Mt=[],qt=ct.length,pe=0;pe<qt;pe++)At(ct[pe])&&Mt.push(ct[pe]);return Mt},i.arrEvery=Array.prototype.every?function(ct,At){return ct.every(At)}:function(ct,At){for(var Mt=ct.length,qt=0;qt<Mt;qt++)if(!At(ct[qt],qt,ct))return!1;return!0};function W(ct,At){if(ct.length===0)return!0;var Mt=ct[0][At];return(0,i.arrEvery)(ct,function(qt){return qt[At]===Mt})}i.allSame=W;var it={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function Z(ct,At){var Mt=it[At||_e.json];return{accept:Mt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ct)}}i.defaultGetHeaders=Z;function at(ct,At){var Mt,qt=Mt=it[At||_e.json];return{accept:qt,"content-type":Mt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ct)}}i.defaultPostHeaders=at;function rt(ct){return ct.splice(E(ct),1)[0]}i.arrPopRandomElement=rt;function V(ct){var At=[];if(ct)for(var Mt in ct)At.push(encodeURIComponent(Mt)+"="+encodeURIComponent(ct[Mt]));return At.length?"?"+At.join("&"):""}i.toQueryString=V;function J(ct){for(var At,Mt=/([^?&=]+)=?([^&]*)/g,qt={};At=Mt.exec(ct);)qt[decodeURIComponent(At[1])]=decodeURIComponent(At[2]);return qt}i.parseQueryString=J,i.now=Date.now||function(){return new Date().getTime()};function $(ct){return typeof ct=="object"&&ct!==null&&(ct.constructor.name=="ErrorInfo"||ct.constructor.name=="PartialErrorInfo")}i.isErrorInfoOrPartialErrorInfo=$;function nt(ct){var At,Mt;return ct instanceof Error||((At=ct==null?void 0:ct.constructor)===null||At===void 0?void 0:At.name)==="ErrorInfo"||((Mt=ct==null?void 0:ct.constructor)===null||Mt===void 0?void 0:Mt.name)==="PartialErrorInfo"?ct.toString():h.default.Config.inspect(ct)}i.inspectError=nt;function dt(ct){return h.default.BufferUtils.isBuffer(ct)?ct.toString():typeof ct=="string"?ct:h.default.Config.inspect(ct)}i.inspectBody=dt;function wt(ct){if(h.default.BufferUtils.isBuffer(ct))return h.default.BufferUtils.byteLength(ct);if(typeof ct=="string")return h.default.Config.stringByteSize(ct);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof ct)}i.dataSizeBytes=wt;function Ut(){return String(Math.random()).substr(2)}i.cheapRandStr=Ut;var It=function(ct){if(h.default.Config.getRandomValues&&typeof Uint8Array<"u"){var At=new Uint8Array(ct);return h.default.Config.getRandomValues(At),h.default.BufferUtils.base64Encode(At)}for(var Mt=h.default.BufferUtils.base64CharSet,qt=Math.round(ct*4/3),pe="",ht=0;ht<qt;ht++)pe+=Mt[E(Mt)];return pe};i.randomString=It;var ne=function(ct){if(h.default.Config.getRandomValues&&typeof Uint8Array<"u"){var At=new Uint8Array(ct);return h.default.Config.getRandomValues(At),h.default.BufferUtils.hexEncode(At)}for(var Mt=h.default.BufferUtils.hexCharSet,qt=ct*2,pe="",ht=0;ht<qt;ht++)pe+=Mt[E(Mt)];return pe};i.randomHexString=ne;function ae(ct,At){for(var Mt=Math.min(At,ct.length),qt=ct.slice(),pe=[],ht=0;ht<Mt;ht++)pe.push(rt(qt));return pe}i.arrChooseN=ae,i.trim=String.prototype.trim?function(ct){return ct.trim()}:function(ct){return ct.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function Lt(ct,At,Mt){return new Promise(function(qt,pe){ct[At].apply(ct,f.__spreadArray(f.__spreadArray([],Mt,!1),[function(ht,vt){ht?pe(ht):qt(vt)}],!1))})}i.promisify=Lt;var _e;(function(ct){ct.msgpack="msgpack",ct.json="json"})(_e=i.Format||(i.Format={}));function we(ct,At){return At=="msgpack"?h.default.Config.msgpack.decode(ct):JSON.parse(String(ct))}i.decodeBody=we;function Ze(ct,At){return At=="msgpack"?h.default.Config.msgpack.encode(ct,!0):JSON.stringify(ct)}i.encodeBody=Ze;function He(ct){return ct.map(function(At){return At&&At.toLowerCase()})}i.allToLowerCase=He;function gn(ct){return ct.map(function(At){return At&&At.toUpperCase()})}i.allToUpperCase=gn;function Pn(ct){return Math.min((ct+2)/3,2)}i.getBackoffCoefficient=Pn;function Ot(){return 1-Math.random()*.2}i.getJitterCoefficient=Ot;function Kt(ct,At){return ct*Pn(At)*Ot()}i.getRetryTime=Kt;function je(){return o||(typeof window<"u"?window:self)}i.getGlobalObject=je;function ye(ct,At){return Object.keys(ct).every(function(Mt){return ct[Mt]===At[Mt]})&&Object.keys(At).every(function(Mt){return At[Mt]===ct[Mt]})}i.shallowEquals=ye;function We(ct){var At=/^(\[([^?]*)(?:(.*))\])?(.+)$/,Mt=ct.match(At);if(!Mt||!Mt.length||Mt.length<5)throw new m.default("regex match failed",400,40010);if(Mt[2])throw new m.default("cannot use a derived option with a ".concat(Mt[2]," channel"),400,40010);return{qualifierParam:Mt[3]||"",channelName:Mt[4]}}i.matchDerivedChannel=We;function an(ct){return h.default.Config.createHmac?Buffer.from(ct,"ascii").toString("base64"):(0,_.stringify)((0,C.parse)(ct))}i.toBase64=an;function ge(ct,At){return ct.length===At.length&&(0,i.arrEvery)(ct,function(Mt,qt){return Mt===At[qt]})}i.arrEquals=ge}).call(this,r(13))}),(function(n,i,r){(function(o){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),h=f.__importDefault(r(3)),g=o||(typeof window<"u"?window:self),m;(function(v){v[v.None=0]="None",v[v.Error=1]="Error",v[v.Major=2]="Major",v[v.Minor=3]="Minor",v[v.Micro=4]="Micro"})(m||(m={}));function _(v,N){return"".concat(v).padStart(N?3:2,"0")}function C(v){return h.default.Config.logTimestamps?function(N){var B=new Date;v(_(B.getHours())+":"+_(B.getMinutes())+":"+_(B.getSeconds())+"."+_(B.getMilliseconds(),1)+" "+N)}:v}var E=function(){var v,N,B,L;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((N=(v=g==null?void 0:g.console)===null||v===void 0?void 0:v.log)===null||N===void 0?void 0:N.apply)=="function"?(B=function(){for(var j=[],M=0;M<arguments.length;M++)j[M]=arguments[M];console.log.apply(console,j)},L=console.warn?function(){for(var j=[],M=0;M<arguments.length;M++)j[M]=arguments[M];console.warn.apply(console,j)}:B):g!=null&&g.console.log?B=L=function(){Function.prototype.apply.call(console.log,console,arguments)}:B=L=function(){},[B,L].map(C)},R=(function(){function v(){v.logLevel=v.LOG_DEFAULT}return v.initLogHandlers=function(){var N=E(),B=N[0],L=N[1];this.logHandler=B,this.logErrorHandler=L},v.renamedClientOption=function(N,B){v.deprecationWarning("The `".concat(N,"` client option has been renamed to `").concat(B,"`. Please update your code to use `").concat(B,"` instead. `").concat(N,"` will be removed in a future version."))},v.renamedMethod=function(N,B,L){v.deprecationWarning("`".concat(N,"`’s `").concat(B,"` method has been renamed to `").concat(L,"`. Please update your code to use `").concat(L,"` instead. `").concat(B,"` will be removed in a future version."))},v.deprecationWarning=function(N){v.shouldLog(m.Error)&&v.logErrorHandler("Ably: Deprecation warning - ".concat(N))},v.logLevel=m.Error,v.LOG_NONE=m.None,v.LOG_ERROR=m.Error,v.LOG_MAJOR=m.Major,v.LOG_MINOR=m.Minor,v.LOG_MICRO=m.Micro,v.LOG_DEFAULT=m.Error,v.LOG_DEBUG=m.Micro,v.logAction=function(N,B,L){v.shouldLog(N)&&(N===m.Error?v.logErrorHandler:v.logHandler)("Ably: "+B+": "+L)},v.deprecated=function(N,B){v.deprecationWarning("".concat(N," is deprecated and will be removed in a future version. ").concat(B))},v.shouldLog=function(N){return N<=v.logLevel},v.setLog=function(N,B){N!==void 0&&(v.logLevel=N),B!==void 0&&(v.logHandler=v.logErrorHandler=B)},v})();i.default=R}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=(function(){function f(){}return f})();i.default=o}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.PartialErrorInfo=void 0;var o=r(0),f=o.__importDefault(r(3)),h=o.__importStar(r(1));function g(C){var E="["+C.constructor.name;return C.message&&(E+=": "+C.message),C.statusCode&&(E+="; statusCode="+C.statusCode),C.code&&(E+="; code="+C.code),C.cause&&(E+="; cause="+h.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(E+="; see "+C.href+" "),E+="]",E}var m=(function(C){o.__extends(E,C);function E(R,v,N,B){var L=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(L,E.prototype),L.code=v,L.statusCode=N,L.cause=B,L}return E.prototype.toString=function(){return g(this)},E.fromValues=function(R){var v=R,N=v.message,B=v.code,L=v.statusCode;if(typeof N!="string"||typeof B!="number"||typeof L!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+f.default.Config.inspect(R));var j=Object.assign(new E(N,B,L),R);return j.code&&!j.href&&(j.href="https://help.ably.io/error/"+j.code),j},E})(Error);i.default=m;var _=(function(C){o.__extends(E,C);function E(R,v,N,B){var L=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(L,E.prototype),L.code=v,L.statusCode=N,L.cause=B,L}return E.prototype.toString=function(){return g(this)},E})(Error);i.PartialErrorInfo=_}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(){if(typeof ArrayBuffer=="function"){var f=o,h=f.lib,g=h.WordArray,m=g.init,_=g.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var E=C.byteLength,R=[],v=0;v<E;v++)R[v>>>2]|=C[v]<<24-v%4*8;m.call(this,R,E)}else m.apply(this,arguments)};_.prototype=g}})(),o.lib.WordArray})}),(function(n,i,r){(function(o){(function(f,h){n.exports=h()})(this,function(){var f=f||(function(h,g){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof o<"u"&&o.crypto&&(m=o.crypto),!m)try{m=r(44)}catch{}var _=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||(function(){function A(){}return function(T){var y;return A.prototype=T,y=new A,A.prototype=null,y}})(),E={},R=E.lib={},v=R.Base=(function(){return{extend:function(A){var T=C(this);return A&&T.mixIn(A),(!T.hasOwnProperty("init")||this.init===T.init)&&(T.init=function(){T.$super.init.apply(this,arguments)}),T.init.prototype=T,T.$super=this,T},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var T in A)A.hasOwnProperty(T)&&(this[T]=A[T]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),N=R.WordArray=v.extend({init:function(A,T){A=this.words=A||[],T!=g?this.sigBytes=T:this.sigBytes=A.length*4},toString:function(A){return(A||L).stringify(this)},concat:function(A){var T=this.words,y=A.words,z=this.sigBytes,U=A.sigBytes;if(this.clamp(),z%4)for(var P=0;P<U;P++){var K=y[P>>>2]>>>24-P%4*8&255;T[z+P>>>2]|=K<<24-(z+P)%4*8}else for(var P=0;P<U;P+=4)T[z+P>>>2]=y[P>>>2];return this.sigBytes+=U,this},clamp:function(){var A=this.words,T=this.sigBytes;A[T>>>2]&=4294967295<<32-T%4*8,A.length=h.ceil(T/4)},clone:function(){var A=v.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var T=[],y=0;y<A;y+=4)T.push(_());return new N.init(T,A)}}),B=E.enc={},L=B.Hex={stringify:function(A){for(var T=A.words,y=A.sigBytes,z=[],U=0;U<y;U++){var P=T[U>>>2]>>>24-U%4*8&255;z.push((P>>>4).toString(16)),z.push((P&15).toString(16))}return z.join("")},parse:function(A){for(var T=A.length,y=[],z=0;z<T;z+=2)y[z>>>3]|=parseInt(A.substr(z,2),16)<<24-z%8*4;return new N.init(y,T/2)}},j=B.Latin1={stringify:function(A){for(var T=A.words,y=A.sigBytes,z=[],U=0;U<y;U++){var P=T[U>>>2]>>>24-U%4*8&255;z.push(String.fromCharCode(P))}return z.join("")},parse:function(A){for(var T=A.length,y=[],z=0;z<T;z++)y[z>>>2]|=(A.charCodeAt(z)&255)<<24-z%4*8;return new N.init(y,T)}},M=B.Utf8={stringify:function(A){try{return decodeURIComponent(escape(j.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return j.parse(unescape(encodeURIComponent(A)))}},G=R.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new N.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=M.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var T,y=this._data,z=y.words,U=y.sigBytes,P=this.blockSize,K=P*4,Q=U/K;A?Q=h.ceil(Q):Q=h.max((Q|0)-this._minBufferSize,0);var X=Q*P,Y=h.min(X*4,U);if(X){for(var D=0;D<X;D+=P)this._doProcessBlock(z,D);T=z.splice(0,X),y.sigBytes-=Y}return new N.init(T,Y)},clone:function(){var A=v.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});R.Hasher=G.extend({cfg:v.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){G.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var T=this._doFinalize();return T},blockSize:16,_createHelper:function(A){return function(T,y){return new A.init(y).finalize(T)}},_createHmacHelper:function(A){return function(T,y){return new O.HMAC.init(A,y).finalize(T)}}});var O=E.algo={};return E})(Math);return f})}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(2)),g=o.__importDefault(r(3));function m(E,R,v){try{R.apply(E,v)}catch(N){h.default.logAction(h.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+N+"; stack = "+(N&&N.stack))}}function _(E,R,v){for(var N,B,L,j=0;j<E.length;j++)if(N=E[j],v&&(N=N[v]),f.isArray(N)){for(;(B=f.arrIndexOf(N,R))!==-1;)N.splice(B,1);v&&N.length===0&&delete E[j][v]}else if(f.isObject(N))for(L in N)Object.prototype.hasOwnProperty.call(N,L)&&f.isArray(N[L])&&_([N],R,L)}var C=(function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var R=this,v=[],N=0;N<arguments.length;N++)v[N]=arguments[N];if(v.length===1){var B=v[0];if(typeof B=="function")this.any.push(B);else throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v))}if(v.length===2){var L=v[0],j=v[1];if(typeof j!="function")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));if(f.isEmptyArg(L))this.any.push(j);else if(f.isArray(L))L.forEach(function(G){R.on(G,j)});else{if(typeof L!="string")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));var M=this.events[L]||(this.events[L]=[]);M.push(j)}}},E.prototype.off=function(){for(var R,v=this,N=[],B=0;B<arguments.length;B++)N[B]=arguments[B];if(N.length==0||f.isEmptyArg(N[0])&&f.isEmptyArg(N[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var L=N[0],j=N[1],M=null,G=null;if(N.length===1||!j)typeof L=="function"?M=L:G=L;else{if(typeof j!="function")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(N));R=[L,j],G=R[0],M=R[1]}if(M&&f.isEmptyArg(G)){_([this.any,this.events,this.anyOnce,this.eventsOnce],M);return}if(f.isArray(G)){G.forEach(function(O){v.off(O,M)});return}if(typeof G!="string")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(N));M?_([this.events,this.eventsOnce],M,G):(delete this.events[G],delete this.eventsOnce[G])},E.prototype.listeners=function(R){if(R){var v=this.events[R]||[];return this.eventsOnce[R]&&Array.prototype.push.apply(v,this.eventsOnce[R]),v.length?v:null}return this.any.length?this.any:null},E.prototype.emit=function(R){for(var v=[],N=1;N<arguments.length;N++)v[N-1]=arguments[N];var B={event:R},L=[];this.anyOnce.length&&(Array.prototype.push.apply(L,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(L,this.any);var j=this.eventsOnce[R];j&&(Array.prototype.push.apply(L,j),delete this.eventsOnce[R]);var M=this.events[R];M&&Array.prototype.push.apply(L,M),f.arrForEach(L,function(G){m(B,G,v)})},E.prototype.once=function(){for(var R=this,v=[],N=0;N<arguments.length;N++)v[N]=arguments[N];var B=v.length;if((B===0||B===1&&typeof v[0]!="function")&&g.default.Config.Promise){var L=v[0];return new g.default.Config.Promise(function(T){R.once(L,T)})}var j=v[0],M=v[1];if(v.length===1&&typeof j=="function")this.anyOnce.push(j);else if(f.isEmptyArg(j)){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));this.anyOnce.push(M)}else if(f.isArray(j)){var G=this,O=function(){var T=Array.prototype.slice.call(arguments);if(f.arrForEach(j,function(y){G.off(y,O)}),typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));M.apply(this,T)};f.arrForEach(j,function(T){G.on(T,O)})}else{if(typeof j!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));var A=this.eventsOnce[j]||(this.eventsOnce[j]=[]);if(M){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));A.push(M)}}},E.prototype.whenState=function(R,v,N){for(var B=this,L=[],j=3;j<arguments.length;j++)L[j-3]=arguments[j];var M={event:R};if(typeof R!="string"||typeof v!="string")throw"whenState requires a valid event String argument";if(typeof N!="function"&&g.default.Config.Promise)return new g.default.Config.Promise(function(G){E.prototype.whenState.apply(B,[R,v,G].concat(L))});R===v?m(M,N,L):this.once(R,N)},E})();i.default=C}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.getDefaults=i.normaliseOptions=i.objectifyOptions=i.getAgentString=i.getHosts=i.getFallbackHosts=i.environmentFallbackHosts=i.getHttpScheme=i.getPort=i.getHost=void 0;var o=r(0),f=o.__importDefault(r(3)),h=o.__importStar(r(1)),g=o.__importDefault(r(2)),m=o.__importDefault(r(4)),_=r(43),C="ably-js/"+_.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:_.version,protocolVersion:2,agent:C,getHost:R,getPort:v,getHttpScheme:N,environmentFallbackHosts:B,getFallbackHosts:L,getHosts:j,checkHost:M,objectifyOptions:T,normaliseOptions:y};function R(U,P,K){return K?P=P==U.restHost&&U.realtimeHost||P||U.realtimeHost:P=P||U.restHost,P}i.getHost=R;function v(U,P){return P||U.tls?U.tlsPort:U.port}i.getPort=v;function N(U){return U.tls?"https://":"http://"}i.getHttpScheme=N;function B(U){return[U+"-a-fallback.ably-realtime.com",U+"-b-fallback.ably-realtime.com",U+"-c-fallback.ably-realtime.com",U+"-d-fallback.ably-realtime.com",U+"-e-fallback.ably-realtime.com"]}i.environmentFallbackHosts=B;function L(U){var P=U.fallbackHosts,K=typeof U.httpMaxRetryCount<"u"?U.httpMaxRetryCount:E.httpMaxRetryCount;return P?h.arrChooseN(P,K):[]}i.getFallbackHosts=L;function j(U){return[U.restHost].concat(L(U))}i.getHosts=j;function M(U){if(typeof U!="string")throw new m.default("host must be a string; was a "+typeof U,4e4,400);if(!U.length)throw new m.default("host must not be zero-length",4e4,400)}function G(U,P,K){return U.realtimeHost?U.realtimeHost:U.restHost?(g.default.logAction(g.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+U.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+U.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),U.restHost):P?E.REALTIME_HOST:K+"-"+E.REALTIME_HOST}function O(U){var P={};for(var K in E.TIMEOUTS)P[K]=U[K]||E.TIMEOUTS[K];return P}function A(U){var P=E.agent;if(U.agents)for(var K in U.agents)P+=" "+K+"/"+U.agents[K];return P}i.getAgentString=A;function T(U){return typeof U=="string"?U.indexOf(":")==-1?{token:U}:{key:U}:U}i.objectifyOptions=T;function y(U){if(U.host&&(g.default.renamedClientOption("host","restHost"),U.restHost=U.host),U.wsHost&&(g.default.renamedClientOption("wsHost","realtimeHost"),U.realtimeHost=U.wsHost),U.queueEvents&&(g.default.renamedClientOption("queueEvents","queueMessages"),U.queueMessages=U.queueEvents),U.headers&&g.default.deprecated("the `headers` client option",""),U.fallbackHostsUseDefault){if(U.fallbackHosts){var P="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}if(U.port||U.tlsPort){var P="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}U.environment?g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),U.fallbackHosts=E.FALLBACK_HOSTS}U.recover===!0&&(g.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),U.recover=function(rt,V){V(!0)}),typeof U.recover=="function"&&U.closeOnUnload===!0&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),U.recover=void 0),"closeOnUnload"in U||(U.closeOnUnload=!U.recover),U.transports&&h.arrIn(U.transports,"xhr")&&(g.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),h.arrDeleteValue(U.transports,"xhr"),U.transports.push("xhr_streaming")),"queueMessages"in U||(U.queueMessages=!0);var K=U.environment&&String(U.environment).toLowerCase()||E.ENVIRONMENT,Q=!K||K==="production";!U.fallbackHosts&&!U.restHost&&!U.realtimeHost&&!U.port&&!U.tlsPort&&(U.fallbackHosts=Q?E.FALLBACK_HOSTS:B(K));var X=U.restHost||(Q?E.REST_HOST:K+"-"+E.REST_HOST),Y=G(U,Q,K);h.arrForEach((U.fallbackHosts||[]).concat(X,Y),M),U.port=U.port||E.PORT,U.tlsPort=U.tlsPort||E.TLS_PORT,"tls"in U||(U.tls=!0);var D=O(U);if("useBinaryProtocol"in U?U.useBinaryProtocol=f.default.Config.supportsBinary&&U.useBinaryProtocol:U.useBinaryProtocol=f.default.Config.preferBinary,U.clientId){var I=U.headers=U.headers||{};I["X-Ably-ClientId"]=f.default.BufferUtils.base64Encode(f.default.BufferUtils.utf8Encode(U.clientId))}"idempotentRestPublishing"in U||(U.idempotentRestPublishing=!0),U.promises&&!f.default.Config.Promise&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),U.promises=!1);var F=null,W=U.connectivityCheckUrl;if(U.connectivityCheckUrl){var it=U.connectivityCheckUrl.split("?"),Z=it[0],at=it[1];F=at?h.parseQueryString(at):{},Z.indexOf("://")===-1&&(Z="https://"+Z),W=Z}return o.__assign(o.__assign({},U),{useBinaryProtocol:"useBinaryProtocol"in U?f.default.Config.supportsBinary&&U.useBinaryProtocol:f.default.Config.preferBinary,realtimeHost:Y,restHost:X,maxMessageSize:U.maxMessageSize||E.maxMessageSize,timeouts:D,connectivityCheckParams:F,connectivityCheckUrl:W})}i.normaliseOptions=y,i.default=E;function z(U){return Object.assign(E,U)}i.getDefaults=z}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(3)),h=o.__importDefault(r(2)),g=o.__importDefault(r(4)),m=o.__importStar(r(1));function _(v){return!v||!v.channelOptions?{channelOptions:v,plugins:{},baseEncodedPreviousPayload:void 0}:v}function C(v){if(v&&v.cipher){if(!f.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var N=f.default.Crypto.getCipher(v.cipher);return{cipher:N.cipherParams,channelCipher:N.cipher}}return v??{}}function E(v){var N=0;return v.name&&(N+=v.name.length),v.clientId&&(N+=v.clientId.length),v.extras&&(N+=JSON.stringify(v.extras).length),v.data&&(N+=m.dataSizeBytes(v.data)),N}var R=(function(){function v(){}return v.prototype.toJSON=function(){var N=this.encoding,B=this.data;return B&&f.default.BufferUtils.isBuffer(B)&&(arguments.length>0?(N=N?N+"/base64":"base64",B=f.default.BufferUtils.base64Encode(B)):B=f.default.BufferUtils.toBuffer(B)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:N,data:B}},v.prototype.toString=function(){var N="[Message";return this.name&&(N+="; name="+this.name),this.id&&(N+="; id="+this.id),this.timestamp&&(N+="; timestamp="+this.timestamp),this.clientId&&(N+="; clientId="+this.clientId),this.connectionId&&(N+="; connectionId="+this.connectionId),this.encoding&&(N+="; encoding="+this.encoding),this.extras&&(N+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?N+="; data="+this.data:f.default.BufferUtils.isBuffer(this.data)?N+="; data (buffer)="+f.default.BufferUtils.base64Encode(this.data):N+="; data (json)="+JSON.stringify(this.data)),this.extras&&(N+="; extras="+JSON.stringify(this.extras)),N+="]",N},v.encrypt=function(N,B,L){var j=N.data,M=N.encoding,G=B.channelCipher;M=M?M+"/":"",f.default.BufferUtils.isBuffer(j)||(j=f.default.BufferUtils.utf8Encode(String(j)),M=M+"utf-8/"),G.encrypt(j,function(O,A){if(O){L(O);return}N.data=A,N.encoding=M+"cipher+"+G.algorithm,L(null,N)})},v.encode=function(N,B,L){var j=N.data,M=typeof j=="string"||f.default.BufferUtils.isBuffer(j)||j===null||j===void 0;if(!M)if(m.isObject(j)||m.isArray(j))N.data=JSON.stringify(j),N.encoding=N.encoding?N.encoding+"/json":"json";else throw new g.default("Data type is unsupported",40013,400);B!=null&&B.cipher?v.encrypt(N,B,L):L(null,N)},v.encodeArray=function(N,B,L){for(var j=0,M=0;M<N.length;M++)v.encode(N[M],B,function(G){if(G){L(G);return}j++,j==N.length&&L(null,N)})},v.decode=function(N,B){var L=_(B),j=N.data,M=N.encoding;if(M){var G=M.split("/"),O=void 0,A=G.length,T=N.data,y="";try{for(;(O=A)>0;){var z=G[--A].match(/([-\w]+)(\+([\w-]+))?/);if(!z)break;switch(y=z[1],y){case"base64":T=f.default.BufferUtils.base64Decode(String(T)),O==G.length&&(j=T);continue;case"utf-8":T=f.default.BufferUtils.utf8Decode(T);continue;case"json":T=JSON.parse(T);continue;case"cipher":if(L.channelOptions!=null&&L.channelOptions.cipher&&L.channelOptions.channelCipher){var U=z[3],P=L.channelOptions.channelCipher;if(U!=P.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");T=P.decrypt(T);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!L.plugins||!L.plugins.vcdiff)throw new g.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new g.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var K=L.baseEncodedPreviousPayload;typeof K=="string"&&(K=f.default.BufferUtils.utf8Encode(K)),K=f.default.BufferUtils.toBuffer(K),T=f.default.BufferUtils.toBuffer(T),T=f.default.BufferUtils.typedArrayToBuffer(L.plugins.vcdiff.decode(T,K)),j=T}catch(X){throw new g.default("Vcdiff delta decode failed with "+X,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(X){var Q=X;throw new g.default("Error processing the "+y+" encoding, decoder returned ‘"+Q.message+"’",Q.code||40013,400)}finally{N.encoding=O<=0?null:G.slice(0,O).join("/"),N.data=T}}L.baseEncodedPreviousPayload=j},v.fromResponseBody=function(N,B,L){L&&(N=m.decodeBody(N,L));for(var j=0;j<N.length;j++){var M=N[j]=v.fromValues(N[j]);try{v.decode(M,B)}catch(G){h.default.logAction(h.default.LOG_ERROR,"Message.fromResponseBody()",G.toString())}}return N},v.fromValues=function(N){return Object.assign(new v,N)},v.fromValuesArray=function(N){for(var B=N.length,L=new Array(B),j=0;j<B;j++)L[j]=v.fromValues(N[j]);return L},v.fromEncoded=function(N,B){var L=v.fromValues(N),j=C(B??null);try{v.decode(L,j)}catch(M){h.default.logAction(h.default.LOG_ERROR,"Message.fromEncoded()",M.toString())}return L},v.fromEncodedArray=function(N,B){return N.map(function(L){return v.fromEncoded(L,B)})},v.getMessagesSize=function(N){for(var B,L=0,j=0;j<N.length;j++)B=N[j],L+=B.size||(B.size=E(B));return L},v.serialize=m.encodeBody,v})();i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(4)),g=o.__importDefault(r(9)),m=o.__importDefault(r(16)),_={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(_).forEach(function(L){C[_[L]]=L});var E={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},R=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function v(L){var j=[];if(L)for(var M=0;M<L.length;M++)j.push(L[M].toString());return"[ "+j.join(", ")+" ]"}var N="id channel channelSerial connectionId count msgSerial timestamp".split(" "),B=(function(){function L(){var j=this;this.hasFlag=function(M){return(j.flags&E[M])>0}}return L.prototype.setFlag=function(j){return this.flags=this.flags|E[j]},L.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},L.prototype.encodeModesToFlags=function(j){var M=this;j.forEach(function(G){return M.setFlag(G)})},L.prototype.decodeModesFromFlags=function(){var j=this,M=[];return L.channelModes.forEach(function(G){j.hasFlag(G)&&M.push(G)}),M.length>0?M:void 0},L.fromValues=function(j){return Object.assign(new L,j)},L.Action=_,L.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],L.ActionName=C,L.serialize=f.encodeBody,L.deserialize=function(j,M){var G=f.decodeBody(j,M);return L.fromDeserialized(G)},L.fromDeserialized=function(j){var M=j.error;M&&(j.error=h.default.fromValues(M));var G=j.messages;if(G)for(var O=0;O<G.length;O++)G[O]=g.default.fromValues(G[O]);var A=j.presence;if(A)for(var O=0;O<A.length;O++)A[O]=m.default.fromValues(A[O],!0);return Object.assign(new L,j)},L.stringify=function(j){var M="[ProtocolMessage";j.action!==void 0&&(M+="; action="+L.ActionName[j.action]||!1);for(var G,O=0;O<N.length;O++)G=N[O],j[G]!==void 0&&(M+="; "+G+"="+j[G]);if(j.messages&&(M+="; messages="+v(g.default.fromValuesArray(j.messages))),j.presence&&(M+="; presence="+v(m.default.fromValuesArray(j.presence))),j.error&&(M+="; error="+h.default.fromValues(j.error).toString()),j.auth&&j.auth.accessToken&&(M+="; token="+j.auth.accessToken),j.flags&&(M+="; flags="+R.filter(j.hasFlag).join(",")),j.params){var A="";f.forInOwnNonNullProperties(j.params,function(T){A.length>0&&(A+="; "),A+=T+"="+j.params[T]}),A.length>0&&(M+="; params=["+A+"]")}return M+="]",M},L})();i.default=B}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.WordArray,m=f.enc;m.Base64={stringify:function(C){var E=C.words,R=C.sigBytes,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var N=[],B=0;B<R;B+=3)for(var L=E[B>>>2]>>>24-B%4*8&255,j=E[B+1>>>2]>>>24-(B+1)%4*8&255,M=E[B+2>>>2]>>>24-(B+2)%4*8&255,G=L<<16|j<<8|M,O=0;O<4&&B+O*.75<R;O++)N.push(v.charAt(G>>>6*(3-O)&63));var A=v.charAt(64);if(A)for(;N.length%4;)N.push(A);return N.join("")},parse:function(C){var E=C.length,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var N=0;N<R.length;N++)v[R.charCodeAt(N)]=N}var B=R.charAt(64);if(B){var L=C.indexOf(B);L!==-1&&(E=L)}return _(C,E,v)}};function _(C,E,R){for(var v=[],N=0,B=0;B<E;B++)if(B%4){var L=R[C.charCodeAt(B-1)]<<B%4*2,j=R[C.charCodeAt(B)]>>>6-B%4*2,M=L|j;v[N>>>2]|=M<<24-N%4*8,N++}return g.create(v,N)}})(),o.enc.Base64})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(10)),g=o.__importDefault(r(26)),m=o.__importDefault(r(2)),_=o.__importDefault(r(8)),C=o.__importDefault(r(21)),E=o.__importDefault(r(18)),R=o.__importDefault(r(4)),v=o.__importDefault(r(22)),N=o.__importDefault(r(3));function B(M){var G=[80015,80017,80030];return M.code?E.default.isTokenErr(M)?!1:f.arrIn(G,M.code)?!0:M.code>=4e4&&M.code<5e4:!1}function L(M){return B(M)?[h.default.fromValues({action:h.default.Action.ERROR,error:M})]:[h.default.fromValues({action:h.default.Action.DISCONNECTED,error:M})]}var j=(function(M){o.__extends(G,M);function G(O,A,T){var y=M.call(this,O,A,T,!0)||this;return y.onAuthUpdated=function(z){y.authParams={access_token:z.token}},y.stream="stream"in T?T.stream:!0,y.sendRequest=null,y.recvRequest=null,y.pendingCallback=null,y.pendingItems=null,y}return G.prototype.connect=function(){var O=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","starting"),g.default.prototype.connect.call(this);var A=this.params,T=A.options,y=_.default.getHost(T,A.host),z=_.default.getPort(T),U=T.tls?"https://":"http://";this.baseUri=U+y+":"+z+"/comet/";var P=this.baseUri+"connect";m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","uri: "+P),this.auth.getAuthParams(function(K,Q){if(K){O.disconnect(K);return}if(!O.isDisposed){O.authParams=Q;var X=O.params.getConnectParams(Q);"stream"in X&&(O.stream=X.stream),m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+f.toQueryString(X));var Y=!1,D=O.recvRequest=O.createRequest(P,null,X,null,O.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV);D.on("data",function(I){O.recvRequest&&(Y||(Y=!0,O.emit("preconnect")),O.onData(I))}),D.on("complete",function(I){if(O.recvRequest||(I=I||new R.default("Request cancelled",80003,400)),O.recvRequest=null,!Y&&!I&&(Y=!0,O.emit("preconnect")),O.onActivity(),I){I.code?O.onData(L(I)):O.disconnect(I);return}N.default.Config.nextTick(function(){O.recv()})}),D.exec()}})},G.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},G.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},G.prototype._requestCloseOrDisconnect=function(O){var A=this,T=O?this.closeUri:this.disconnectUri;if(T){var y=this.createRequest(T,null,this.authParams,null,v.default.REQ_SEND);y.on("complete",function(z){z&&(m.default.logAction(m.default.LOG_ERROR,"CometTransport.request"+(O?"Close()":"Disconnect()"),"request returned err = "+f.inspectError(z)),A.finish("disconnected",z))}),y.exec()}},G.prototype.dispose=function(){var O=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),N.default.Config.nextTick(function(){O.emit("disposed")}))},G.prototype.onConnect=function(O){var A;if(!this.isDisposed){var T=(A=O.connectionDetails)===null||A===void 0?void 0:A.connectionKey;g.default.prototype.onConnect.call(this,O);var y=this.baseUri+T;m.default.logAction(m.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+y),this.sendUri=y+"/send",this.recvUri=y+"/recv",this.closeUri=y+"/close",this.disconnectUri=y+"/disconnect"}},G.prototype.send=function(O){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(O);return}var A=this.pendingItems||[];A.push(O),this.pendingItems=null,this.sendItems(A)},G.prototype.sendAnyPending=function(){var O=this.pendingItems;O&&(this.pendingItems=null,this.sendItems(O))},G.prototype.sendItems=function(O){var A=this,T=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(O),v.default.REQ_SEND);T.on("complete",function(y,z){if(y&&m.default.logAction(m.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+f.inspectError(y)),A.sendRequest=null,y){y.code?A.onData(L(y)):A.disconnect(y);return}z&&A.onData(z),A.pendingItems&&N.default.Config.nextTick(function(){A.sendRequest||A.sendAnyPending()})}),T.exec()},G.prototype.recv=function(){var O=this;if(!this.recvRequest&&this.isConnected){var A=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV_POLL);A.on("data",function(T){O.onData(T)}),A.on("complete",function(T){if(O.recvRequest=null,O.onActivity(),T){T.code?O.onData(L(T)):O.disconnect(T);return}N.default.Config.nextTick(function(){O.recv()})}),A.exec()}},G.prototype.onData=function(O){try{var A=this.decodeResponse(O);if(A&&A.length)for(var T=0;T<A.length;T++)this.onProtocolMessage(h.default.fromDeserialized(A[T]))}catch(y){m.default.logAction(m.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+y.stack)}},G.prototype.encodeRequest=function(O){return JSON.stringify(O)},G.prototype.decodeResponse=function(O){return typeof O=="string"?JSON.parse(O):O},G})(g.default);i.default=j}),(function(n,i){var r;r=(function(){return this})();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.isSuccessCode=void 0;var o;(function(h){h[h.Success=200]="Success",h[h.NoContent=204]="NoContent",h[h.BadRequest=400]="BadRequest",h[h.Unauthorized=401]="Unauthorized",h[h.Forbidden=403]="Forbidden",h[h.RequestTimeout=408]="RequestTimeout",h[h.InternalServerError=500]="InternalServerError"})(o||(o={}));function f(h){return h>=o.Success&&h<o.BadRequest}i.isSuccessCode=f,i.default=o}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(3)),h=o.__importStar(r(1)),g=o.__importDefault(r(2)),m=o.__importDefault(r(18)),_=o.__importDefault(r(19)),C=r(4),E=o.__importDefault(r(14));function R(M,G,O,A,T){M.http.supportsAuthHeaders?M.auth.getAuthHeaders(function(y,z){y?A(y):T(h.mixin(z,G),O)}):M.auth.getAuthParams(function(y,z){y?A(y):T(G,h.mixin(z,O))})}function v(M,G){return function(O,A,T,y,z){if(O&&!A){M(O);return}if(z===E.default.NoContent){M(O,[],T,!0,z);return}if(!y)try{A=h.decodeBody(A,G)}catch(Y){h.isErrorInfoOrPartialErrorInfo(Y)?M(Y):M(new C.PartialErrorInfo(h.inspectError(Y),null));return}if(!A){M(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var U=A,P=U.statusCode,K=U.response,Q=U.headers;if(P===void 0){M(O,A,T,!0,z);return}if(P<200||P>=300){var X=K&&K.error||O;X||(X=new Error("Error in unenveloping "+A),X.statusCode=P),M(X,K,Q,!0,P);return}M(O,K,Q,!0,P)}}function N(M){var G=[];if(M)for(var O in M)G.push(O+"="+M[O]);return G.join("&")}function B(M,G){return M+(G?"?":"")+N(G)}function L(M,G,O,A){return function(T,y,z,U,P){T?g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received Error; "+B(O,A)+"; Error: "+h.inspectError(T)):g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received; "+B(O,A)+"; Headers: "+N(z)+"; StatusCode: "+P+"; Body: "+(f.default.BufferUtils.isBuffer(y)?y.toString():y)),M&&M(T,y,z,U,P)}}var j=(function(){function M(){}return M.get=function(G,O,A,T,y,z){M.do(_.default.Get,G,O,null,A,T,y,z)},M.delete=function(G,O,A,T,y,z){M.do(_.default.Delete,G,O,null,A,T,y,z)},M.post=function(G,O,A,T,y,z,U){M.do(_.default.Post,G,O,A,T,y,z,U)},M.patch=function(G,O,A,T,y,z,U){M.do(_.default.Patch,G,O,A,T,y,z,U)},M.put=function(G,O,A,T,y,z,U){M.do(_.default.Put,G,O,A,T,y,z,U)},M.do=function(G,O,A,T,y,z,U,P){g.default.shouldLog(g.default.LOG_MICRO)&&(P=L(P,G,A,z)),U&&(P=P&&v(P,U),(z=z||{}).envelope=U);function K(Q,X){var Y;if(g.default.shouldLog(g.default.LOG_MICRO)&&g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+B(A,X)),g.default.shouldLog(g.default.LOG_MICRO)){var D=T;if(((Y=Q["content-type"])===null||Y===void 0?void 0:Y.indexOf("msgpack"))>0)try{D=f.default.Config.msgpack.decode(T)}catch(I){g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending MsgPack Decoding Error: "+h.inspectError(I))}g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+B(A,X)+"; Body: "+D)}O.http.do(G,O,A,Q,T,X,function(I,F,W,it,Z){if(I&&m.default.isTokenErr(I)){O.auth.authorize(null,null,function(at){if(at){P(at);return}R(O,Q,X,P,K)});return}P(I,F,W,it,Z)})}R(O,y,z,P,K)},M})();i.default=j}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(2)),h=o.__importDefault(r(3)),g=o.__importDefault(r(9)),m=o.__importStar(r(1));function _(E){return C.Actions.indexOf(E)}var C=(function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var R=this.id.split(":");return{connectionId:R[0],msgSerial:parseInt(R[1],10),index:parseInt(R[2],10)}},E.prototype.toJSON=function(){var R=this.data,v=this.encoding;return R&&h.default.BufferUtils.isBuffer(R)&&(arguments.length>0?(v=v?v+"/base64":"base64",R=h.default.BufferUtils.base64Encode(R)):R=h.default.BufferUtils.toBuffer(R)),{id:this.id,clientId:this.clientId,action:_(this.action),data:R,encoding:v,extras:this.extras}},E.prototype.toString=function(){var R="[PresenceMessage";return R+="; action="+this.action,this.id&&(R+="; id="+this.id),this.timestamp&&(R+="; timestamp="+this.timestamp),this.clientId&&(R+="; clientId="+this.clientId),this.connectionId&&(R+="; connectionId="+this.connectionId),this.encoding&&(R+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?R+="; data="+this.data:h.default.BufferUtils.isBuffer(this.data)?R+="; data (buffer)="+h.default.BufferUtils.base64Encode(this.data):R+="; data (json)="+JSON.stringify(this.data)),this.extras&&(R+="; extras="+JSON.stringify(this.extras)),R+="]",R},E.fromResponseBody=function(R,v,N){var B=[];N&&(R=m.decodeBody(R,N));for(var L=0;L<R.length;L++){var j=B[L]=E.fromValues(R[L],!0);try{E.decode(j,v)}catch(M){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",M.toString())}}return B},E.fromValues=function(R,v){return v&&(R.action=E.Actions[R.action]),Object.assign(new E,R)},E.fromValuesArray=function(R){for(var v=R.length,N=new Array(v),B=0;B<v;B++)N[B]=E.fromValues(R[B]);return N},E.fromEncoded=function(R,v){var N=E.fromValues(R,!0);try{E.decode(N,v??{})}catch(B){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromEncoded()",B.toString())}return N},E.fromEncodedArray=function(R,v){return R.map(function(N){return E.fromEncoded(N,v)})},E.fromData=function(R){return R instanceof E?R:E.fromValues({data:R})},E.Actions=["absent","present","enter","leave","update"],E.encode=g.default.encode,E.decode=g.default.decode,E.getMessagesSize=g.default.getMessagesSize,E})();i.default=C}),(function(n,i,r){(function(o){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),h=f.__importStar(r(1)),g=f.__importDefault(r(7)),m=f.__importStar(r(4)),_=f.__importDefault(r(2)),C=f.__importDefault(r(8)),E=f.__importDefault(r(22)),R=f.__importDefault(r(3));function v(U,P){return h.arrIn(h.allToLowerCase(h.keysArray(P)),"x-ably-errorcode")}function N(U,P){if(v(U,P))return U.error&&m.default.fromValues(U.error)}var B=function(){},L=0,j={},M=typeof o<"u"&&o.XDomainRequest;function G(){var U=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return U&&Number(U[1])}function O(){var U;return M&&(U=G())&&U===10}function A(U,P){return U.getResponseHeader&&U.getResponseHeader(P)}function T(U){return U.getResponseHeader&&(U.getResponseHeader("transfer-encoding")||!U.getResponseHeader("content-length"))}function y(U){for(var P=h.trim(U.getAllResponseHeaders()).split(`\r
`),K={},Q=0;Q<P.length;Q++){var X=P[Q].split(":").map(h.trim);K[X[0].toLowerCase()]=X[1]}return K}var z=(function(U){f.__extends(P,U);function P(K,Q,X,Y,D,I,F){var W=U.call(this)||this;return X=X||{},X.rnd=h.cheapRandStr(),O()&&!X.envelope&&(X.envelope="json"),W.uri=K+h.toQueryString(X),W.headers=Q||{},W.body=Y,W.method=F?F.toUpperCase():h.isEmptyArg(Y)?"GET":"POST",W.requestMode=D,W.timeouts=I,W.timedOut=!1,W.requestComplete=!1,W.id=String(++L),j[W.id]=W,W}return P.createRequest=function(K,Q,X,Y,D,I,F){var W=I||C.default.TIMEOUTS;return new P(K,Q,h.copy(X),Y,D,W,F)},P.prototype.complete=function(K,Q,X,Y,D){this.requestComplete||(this.requestComplete=!0,!K&&Q&&this.emit("data",Q),this.emit("complete",K,Q,X,Y,D),this.dispose())},P.prototype.abort=function(){this.dispose()},P.prototype.exec=function(){var K=this,Q=this.headers,X=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,Y=this.timer=setTimeout(function(){K.timedOut=!0,I.abort()},X),D=this.method,I=this.xhr=new XMLHttpRequest,F=Q.accept,W=this.body,it="text";if(F?F.indexOf("application/x-msgpack")===0&&(it="arraybuffer"):Q.accept="application/json",W){var Z=Q["content-type"]||(Q["content-type"]="application/json");Z.indexOf("application/json")>-1&&typeof W!="string"&&(W=JSON.stringify(W))}I.open(D,this.uri,!0),I.responseType=it,"authorization"in Q&&(I.withCredentials=!0);for(var at in Q)I.setRequestHeader(at,Q[at]);var rt=function(Lt,_e,we,Ze){var He,gn=_e+" (event type: "+Lt.type+")";!((He=K==null?void 0:K.xhr)===null||He===void 0)&&He.statusText&&(gn+=", current statusText is "+K.xhr.statusText),_.default.logAction(_.default.LOG_ERROR,"Request.on"+Lt.type+"()",gn),K.complete(new m.PartialErrorInfo(gn,we,Ze))};I.onerror=function(Lt){rt(Lt,"XHR error occurred",null,400)},I.onabort=function(Lt){K.timedOut?rt(Lt,"Request aborted due to request timeout expiring",null,408):rt(Lt,"Request cancelled",null,400)},I.ontimeout=function(Lt){rt(Lt,"Request timed out",null,408)};var V,J,$,nt=0,dt=!1,wt=function(){if(clearTimeout(Y),$=J<400,J==204){K.complete(null,null,null,null,J);return}V=K.requestMode==E.default.REQ_RECV_STREAM&&$&&T(I)},Ut=function(){var Lt;try{var _e=A(I,"content-type"),we=_e?_e.indexOf("application/json")>=0:I.responseType=="text";if(we){var Ze=I.responseType==="arraybuffer"?R.default.BufferUtils.utf8Decode(I.response):String(I.responseText);Ze.length?Lt=JSON.parse(Ze):Lt=Ze,dt=!0}else Lt=I.response;Lt.response!==void 0?(J=Lt.statusCode,$=J<400,Q=Lt.headers,Lt=Lt.response):Q=y(I)}catch(gn){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+gn.message,null,400));return}if($||h.isArray(Lt)){K.complete(null,Lt,Q,dt,J);return}var He=N(Lt,Q);He||(He=new m.PartialErrorInfo("Error response received from server: "+J+" body was: "+R.default.Config.inspect(Lt),null,J)),K.complete(He,Lt,Q,dt,J)};function It(){for(var Lt=I.responseText,_e=Lt.length-1,we,Ze;nt<_e&&(we=Lt.indexOf(`
`,nt))>-1;)Ze=Lt.slice(nt,we),nt=we+1,ne(Ze)}var ne=function(Lt){try{Lt=JSON.parse(Lt)}catch(_e){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+_e.message,null,400));return}K.emit("data",Lt)},ae=function(){It(),K.streamComplete=!0,R.default.Config.nextTick(function(){K.complete()})};I.onreadystatechange=function(){var Lt=I.readyState;Lt<3||I.status!==0&&(J===void 0&&(J=I.status,J===1223&&(J=204),wt()),Lt==3&&V?It():Lt==4&&(V?ae():Ut()))},I.send(W)},P.prototype.dispose=function(){var K=this.xhr;if(K){K.onreadystatechange=K.onerror=K.onabort=K.ontimeout=B,this.xhr=null;var Q=this.timer;Q&&(clearTimeout(Q),this.timer=null),this.requestComplete||K.abort()}delete j[this.id]},P})(g.default);i.default=z}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(2)),h=o.__importStar(r(1)),g=o.__importDefault(r(24)),m=o.__importDefault(r(4)),_=o.__importDefault(r(45)),C=r(11),E=o.__importDefault(r(19)),R=o.__importDefault(r(14)),v=o.__importDefault(r(3)),N=o.__importDefault(r(15)),B=Math.pow(2,17);function L(){}function j(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function M(X){return!!X.connection}function G(X){return h.isErrorInfoOrPartialErrorInfo(X)?(X.code||(X.statusCode===403?X.code=40300:(X.code=40170,X.statusCode=401)),X):new m.default(h.inspectError(X),X.code||40170,X.statusCode||401)}var O=function(X,Y){if(v.default.Config.createHmac){var D=v.default.Config.createHmac("SHA256",Y);return D.update(X),D.digest("base64")}return(0,C.stringify)((0,_.default)(X,Y))};function A(X){if(!X)return"";typeof X=="string"&&(X=JSON.parse(X));var Y=Object.create(null),D=h.keysArray(X,!0);if(!D)return"";D.sort();for(var I=0;I<D.length;I++)Y[D[I]]=X[D[I]].sort();return JSON.stringify(Y)}function T(X){if(X.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(X.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(X.key)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(X.tokenDetails)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var Y="authOptions must include valid authentication parameters";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",Y),new Error(Y)}}function y(X){return"useTokenAuth"in X&&!X.useTokenAuth}function z(X){return X.useTokenAuth||!y(X)&&(X.authCallback||X.authUrl||X.token||X.tokenDetails)}function U(X){return!X.key&&!X.authCallback&&!X.authUrl}var P=0;function K(){return P++}var Q=(function(){function X(Y,D){if(this.authOptions={},this.client=Y,this.tokenParams=D.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,z(D)){if(D.key&&!O){var I="client-side token request signing not supported";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new Error(I)}U(D)&&f.default.logAction(f.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(D.defaultTokenParams,D),T(this.authOptions)}else{if(!D.key){var I="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new m.default(I,40160,401)}f.default.logAction(f.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(D)}}return X.prototype.authorize=function(Y,D,I){var F=this,W;if(typeof Y=="function"&&!I?(I=Y,W=Y=null):typeof D=="function"&&!I?(I=D,W=null):W=D,!I&&this.client.options.promises)return h.promisify(this,"authorize",arguments);if(W&&W.key&&this.authOptions.key!==W.key)throw new m.default("Unable to update auth options with incompatible key",40102,401);W&&"force"in W&&(f.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),h.isOnlyPropIn(W,"force")&&(W=null)),this._forceNewToken(Y,W,function(it,Z){if(it){F.client.connection&&it.statusCode===R.default.Forbidden&&F.client.connection.connectionManager.actOnErrorFromAuthorize(it),I==null||I(it);return}M(F.client)?F.client.connection.connectionManager.onAuthUpdated(Z,I||L):I==null||I(null,Z)})},X.prototype.authorise=function(Y,D,I){f.default.renamedMethod("Auth","authorise","authorize"),this.authorize(Y,D,I)},X.prototype._forceNewToken=function(Y,D,I){var F=this;this.tokenDetails=null,this._saveTokenOptions(Y,D),T(this.authOptions),this._ensureValidAuthCredentials(!0,function(W,it){delete F.tokenParams.timestamp,delete F.authOptions.queryTime,I(W,it)})},X.prototype.requestToken=function(Y,D,I){var F=this;if(typeof Y=="function"&&!I?(I=Y,D=Y=null):typeof D=="function"&&!I&&(I=D,D=null),!I&&this.client.options.promises)return h.promisify(this,"requestToken",arguments);D=D||this.authOptions,Y=Y||h.copy(this.tokenParams);var W=I||L,it,Z=this.client;if(D.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),it=D.authCallback;else if(D.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),it=function(nt,dt){var wt=h.mixin({accept:"application/json, text/plain"},D.authHeaders),Ut=D.authMethod&&D.authMethod.toLowerCase()==="post",It,ne=D.authUrl.indexOf("?");ne>-1&&(It=h.parseQueryString(D.authUrl.slice(ne)),D.authUrl=D.authUrl.slice(0,ne),Ut||(D.authParams=h.mixin(It,D.authParams)));var ae=h.mixin({},D.authParams||{},nt),Lt=function(Ze,He,gn,Pn){var Ot;if(Ze?f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+h.inspectError(Ze)):(Ot=gn["content-type"],f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+Ot+"; body: "+h.inspectBody(He))),Ze||Pn)return dt(Ze,He);if(v.default.BufferUtils.isBuffer(He)&&(He=He.toString()),!Ot){dt(new m.default("authUrl response is missing a content-type header",40170,401));return}var Kt=Ot.indexOf("application/json")>-1,je=Ot.indexOf("text/plain")>-1||Ot.indexOf("application/jwt")>-1;if(!Kt&&!je){dt(new m.default("authUrl responded with unacceptable content-type "+Ot+", should be either text/plain, application/jwt or application/json",40170,401));return}if(Kt){if(He.length>B){dt(new m.default("authUrl response exceeded max permitted length",40170,401));return}try{He=JSON.parse(He)}catch(ye){dt(new m.default("Unexpected error processing authURL response; err = "+ye.message,40170,401));return}}dt(null,He,Ot)};if(f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+D.authUrl+"; Params: "+JSON.stringify(ae)+"; method: "+(Ut?"POST":"GET")),Ut){var _e=wt||{};_e["content-type"]="application/x-www-form-urlencoded";var we=h.toQueryString(ae).slice(1);F.client.http.doUri(E.default.Post,Z,D.authUrl,_e,we,It,Lt)}else F.client.http.doUri(E.default.Get,Z,D.authUrl,wt||{},null,ae,Lt)};else if(D.key)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),it=function(nt,dt){F.createTokenRequest(nt,D,dt)};else{var at="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";f.default.logAction(f.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),W(new m.default(at,40171,403));return}"capability"in Y&&(Y.capability=A(Y.capability));var rt=function(nt,dt){var wt=nt.keyName,Ut="/keys/"+wt+"/requestToken",It=function(ae){return Z.baseUri(ae)+Ut},ne=h.defaultPostHeaders(F.client.options);D.requestHeaders&&h.mixin(ne,D.requestHeaders),f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+Ut+"; Token params: "+JSON.stringify(nt)),F.client.http.do(E.default.Post,Z,It,ne,JSON.stringify(nt),null,dt)},V=!1,J=this.client.options.timeouts.realtimeRequestTimeout,$=setTimeout(function(){V=!0;var nt="Token request callback timed out after "+J/1e3+" seconds";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",nt),W(new m.default(nt,40170,401))},J);it(Y,function(nt,dt,wt){if(!V){if(clearTimeout($),nt){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+h.inspectError(nt)),W(G(nt));return}if(typeof dt=="string"){dt.length===0?W(new m.default("Token string is empty",40170,401)):dt.length>B?W(new m.default("Token string exceeded max permitted length (was "+dt.length+" bytes)",40170,401)):dt==="undefined"||dt==="null"?W(new m.default("Token string was literal null/undefined",40170,401)):dt[0]==="{"&&!(wt&&wt.indexOf("application/jwt")>-1)?W(new m.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):W(null,{token:dt});return}if(typeof dt!="object"){var Ut="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof dt;f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",Ut),W(new m.default(Ut,40170,401));return}var It=JSON.stringify(dt).length;if(It>B&&!D.suppressMaxLengthCheck){W(new m.default("Token request/details object exceeded max permitted stringified size (was "+It+" bytes)",40170,401));return}if("issued"in dt){W(null,dt);return}if(!("keyName"in dt)){var Ut="Expected token request callback to call back with a token string, token request object, or token details object";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",Ut),W(new m.default(Ut,40170,401));return}rt(dt,function(ne,ae,Lt,_e){if(ne){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+h.inspectError(ne)),W(G(ne));return}_e||(ae=JSON.parse(ae)),f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","token received"),W(null,ae)})}})},X.prototype.createTokenRequest=function(Y,D,I){var F=this;if(typeof Y=="function"&&!I?(I=Y,D=Y=null):typeof D=="function"&&!I&&(I=D,D=null),!I&&this.client.options.promises)return h.promisify(this,"createTokenRequest",arguments);D=D||this.authOptions,Y=Y||h.copy(this.tokenParams);var W=D.key;if(!W){I(new m.default("No key specified",40101,403));return}var it=W.split(":"),Z=it[0],at=it[1];if(!at){I(new m.default("Invalid key specified",40101,403));return}if(Y.clientId===""){I(new m.default("clientId can’t be an empty string",40012,400));return}"capability"in Y&&(Y.capability=A(Y.capability));var rt=h.mixin({keyName:Z},Y),V=Y.clientId||"",J=Y.ttl||"",$=Y.capability||"";(function(nt){if(rt.timestamp){nt();return}F.getTimestamp(D&&D.queryTime,function(dt,wt){if(dt){I(dt);return}rt.timestamp=wt,nt()})})(function(){var nt=rt.nonce||(rt.nonce=j()),dt=rt.timestamp,wt=rt.keyName+`
`+J+`
`+$+`
`+V+`
`+dt+`
`+nt+`
`;rt.mac=rt.mac||O(wt,at),f.default.logAction(f.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),I(null,rt)})},X.prototype.getAuthParams=function(Y){this.method=="basic"?Y(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(D,I){if(D){Y(D);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");Y(null,{access_token:I.token})})},X.prototype.getAuthHeaders=function(Y){this.method=="basic"?Y(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(D,I){if(D){Y(D);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");Y(null,{authorization:"Bearer "+h.toBase64(I.token)})})},X.prototype.getTimestamp=function(Y,D){!this.isTimeOffsetSet()&&(Y||this.authOptions.queryTime)?this.client.time(D):D(null,this.getTimestampUsingOffset())},X.prototype.getTimestampUsingOffset=function(){return h.now()+(this.client.serverTimeOffset||0)},X.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},X.prototype._saveBasicOptions=function(Y){this.method="basic",this.key=Y.key,this.basicKey=h.toBase64(Y.key),this.authOptions=Y||{},"clientId"in Y&&this._userSetClientId(Y.clientId)},X.prototype._saveTokenOptions=function(Y,D){this.method="token",Y&&(this.tokenParams=Y),D&&(D.token&&(D.tokenDetails=typeof D.token=="string"?{token:D.token}:D.token),D.tokenDetails&&(this.tokenDetails=D.tokenDetails),"clientId"in D&&this._userSetClientId(D.clientId),this.authOptions=D)},X.prototype._ensureValidAuthCredentials=function(Y,D){var I=this,F=this.tokenDetails;if(F){if(this._tokenClientIdMismatch(F.clientId)){D(new m.default("Mismatch between clientId in token ("+F.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!F.expires||F.expires>=this.getTimestampUsingOffset()){f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+F.expires),D(null,F);return}f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=g.default.create())).push(D),!(this.currentTokenRequestId!==null&&!Y)){var W=this.currentTokenRequestId=K();this.requestToken(this.tokenParams,this.authOptions,function(it,Z){if(I.currentTokenRequestId>W){f.default.logAction(f.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}I.currentTokenRequestId=null;var at=I.waitingForTokenRequest||L;if(I.waitingForTokenRequest=null,it){at(it);return}at(null,I.tokenDetails=Z)})}},X.prototype._userSetClientId=function(Y){if(typeof Y=="string"||Y===null){if(Y==="*")throw new m.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var D=this._uncheckedSetClientId(Y);if(D)throw D}else throw new m.default("clientId must be either a string or null",40012,400)},X.prototype._uncheckedSetClientId=function(Y){if(this._tokenClientIdMismatch(Y)){var D="Unexpected clientId mismatch: client has "+this.clientId+", requested "+Y,I=new m.default(D,40102,401);return f.default.logAction(f.default.LOG_ERROR,"Auth._uncheckedSetClientId()",D),I}else return this.clientId=this.tokenParams.clientId=Y,null},X.prototype._tokenClientIdMismatch=function(Y){return!!(this.clientId&&this.clientId!=="*"&&Y&&Y!=="*"&&this.clientId!==Y)},X.isTokenErr=function(Y){return Y.code&&Y.code>=40140&&Y.code<40150},X.prototype.revokeTokens=function(Y,D,I){if(z(this.client.options))throw new m.default("Cannot revoke tokens when using token auth",40162,401);var F=this.client.options.keyName,W;if(typeof D=="function"?(I=D,W={}):W=D??{},I===void 0){if(this.client.options.promises)return h.promisify(this,"revokeTokens",[Y,W]);I=L}var it=I,Z=o.__assign({targets:Y.map(function(J){return"".concat(J.type,":").concat(J.value)})},W),at=this.client.options.useBinaryProtocol?h.Format.msgpack:h.Format.json,rt=h.defaultPostHeaders(this.client.options,at);this.client.options.headers&&h.mixin(rt,this.client.options.headers);var V=h.encodeBody(Z,at);N.default.post(this.client,"/keys/".concat(F,"/revokeTokens"),V,rt,{newBatchResponse:"true"},null,function(J,$,nt,dt){if(J){it(J);return}var wt=dt?$:h.decodeBody($,at);it(null,wt)})},X})();i.default=Q}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o;(function(f){f.Get="get",f.Delete="delete",f.Post="post",f.Put="put",f.Patch="patch"})(o||(o={})),i.default=o}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.HttpPaginatedResponse=i.PaginatedResult=void 0;var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(2)),g=o.__importDefault(r(15)),m=o.__importDefault(r(14));function _(B){var L=B.match(/^\.\/(\w+)\?(.*)$/);return L&&L[2]&&f.parseQueryString(L[2])}function C(B){typeof B=="string"&&(B=B.split(","));for(var L={},j=0;j<B.length;j++){var M=B[j].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(M){var G=_(M[1]);G&&(L[M[2]]=G)}}return L}function E(B,L,j){return!(j&&(L||typeof B.code=="number"))}var R=(function(){function B(L,j,M,G,O,A){this.rest=L,this.path=j,this.headers=M,this.envelope=G??null,this.bodyHandler=O,this.useHttpPaginatedResponse=A||!1}return B.prototype.get=function(L,j){var M=this;g.default.get(this.rest,this.path,this.headers,L,this.envelope,function(G,O,A,T,y){M.handlePage(G,O,A,T,y,j)})},B.prototype.delete=function(L,j){var M=this;g.default.delete(this.rest,this.path,this.headers,L,this.envelope,function(G,O,A,T,y){M.handlePage(G,O,A,T,y,j)})},B.prototype.post=function(L,j,M){var G=this;g.default.post(this.rest,this.path,j,this.headers,L,this.envelope,function(O,A,T,y,z){M&&G.handlePage(O,A,T,y,z,M)})},B.prototype.put=function(L,j,M){var G=this;g.default.put(this.rest,this.path,j,this.headers,L,this.envelope,function(O,A,T,y,z){M&&G.handlePage(O,A,T,y,z,M)})},B.prototype.patch=function(L,j,M){var G=this;g.default.patch(this.rest,this.path,j,this.headers,L,this.envelope,function(O,A,T,y,z){M&&G.handlePage(O,A,T,y,z,M)})},B.prototype.handlePage=function(L,j,M,G,O,A){if(L&&E(L,j,this.useHttpPaginatedResponse)){h.default.logAction(h.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+f.inspectError(L)),A==null||A(L);return}var T,y,z;try{T=O==m.default.NoContent?[]:this.bodyHandler(j,M||{},G)}catch(U){A==null||A(L||U);return}M&&(y=M.Link||M.link)&&(z=C(y)),this.useHttpPaginatedResponse?A(null,new N(this,T,M||{},O,z,L)):A(null,new v(this,T,z))},B})(),v=(function(){function B(L,j,M){var G=this;this.resource=L,this.items=j;var O=this;M&&("first"in M&&(this.first=function(A){if(!A&&O.resource.rest.options.promises)return f.promisify(O,"first",[]);O.get(M.first,A)}),"current"in M&&(this.current=function(A){if(!A&&O.resource.rest.options.promises)return f.promisify(O,"current",[]);O.get(M.current,A)}),this.next=function(A){if(!A&&O.resource.rest.options.promises)return f.promisify(O,"next",[]);"next"in M?O.get(M.next,A):A(null,null)},this.hasNext=function(){return"next"in M},this.isLast=function(){var A;return!(!((A=G.hasNext)===null||A===void 0)&&A.call(G))})}return B.prototype.get=function(L,j){var M=this.resource;g.default.get(M.rest,M.path,M.headers,L,M.envelope,function(G,O,A,T,y){M.handlePage(G,O,A,T,y,j)})},B})();i.PaginatedResult=v;var N=(function(B){o.__extends(L,B);function L(j,M,G,O,A,T){var y=B.call(this,j,M,A)||this;return y.statusCode=O,y.success=O<300&&O>=200,y.headers=G,y.errorCode=T&&T.code,y.errorMessage=T&&T.message,y}return L.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},L})(v);i.HttpPaginatedResponse=N,i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.isRetriable=void 0;var o=r(0),f=o.__importDefault(r(4)),h={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},g={disconnected:function(){return f.default.fromValues({statusCode:400,code:h.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return f.default.fromValues({statusCode:400,code:h.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return f.default.fromValues({statusCode:400,code:h.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return f.default.fromValues({statusCode:400,code:h.CLOSING,message:"Connection closing"})},closed:function(){return f.default.fromValues({statusCode:400,code:h.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return f.default.fromValues({statusCode:500,code:h.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return f.default.fromValues({statusCode:500,code:h.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function m(_){return!_.statusCode||!_.code||_.statusCode>=500?!0:Object.values(h).includes(_.code)}i.isRetriable=m,i.default=g}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o;(function(f){f[f.REQ_SEND=0]="REQ_SEND",f[f.REQ_RECV=1]="REQ_RECV",f[f.REQ_RECV_POLL=2]="REQ_RECV_POLL",f[f.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(o||(o={})),i.default=o}),(function(n,i,r){(function(o,f){n.exports=f(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(o){return o})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(2)),h=(function(){function g(m){this.members=m||[]}return g.prototype.call=function(){for(var m=[],_=0;_<arguments.length;_++)m[_]=arguments[_];for(var C=0,E=this.members;C<E.length;C++){var R=E[C];if(R)try{R.apply(void 0,m)}catch(v){f.default.logAction(f.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+v+"; stack = "+v.stack)}}},g.prototype.push=function(){for(var m,_=[],C=0;C<arguments.length;C++)_[C]=arguments[C];(m=this.members).push.apply(m,_)},g.create=function(m){var _=new g(m);return Object.assign(function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];return _.call.apply(_,C)},{push:function(C){return _.push(C)}})},g})();i.default=h}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){(function(){var f=o,h=f.lib,g=h.Base,m=f.enc,_=m.Utf8,C=f.algo;C.HMAC=g.extend({init:function(E,R){E=this._hasher=new E.init,typeof R=="string"&&(R=_.parse(R));var v=E.blockSize,N=v*4;R.sigBytes>N&&(R=E.finalize(R)),R.clamp();for(var B=this._oKey=R.clone(),L=this._iKey=R.clone(),j=B.words,M=L.words,G=0;G<v;G++)j[G]^=1549556828,M[G]^=909522486;B.sigBytes=L.sigBytes=N,this.reset()},reset:function(){var E=this._hasher;E.reset(),E.update(this._iKey)},update:function(E){return this._hasher.update(E),this},finalize:function(E){var R=this._hasher,v=R.finalize(E);R.reset();var N=R.finalize(this._oKey.clone().concat(v));return N}})})()})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(10)),h=o.__importStar(r(1)),g=o.__importDefault(r(7)),m=o.__importDefault(r(2)),_=o.__importDefault(r(21)),C=o.__importDefault(r(4)),E=o.__importDefault(r(3)),R=f.default.Action,v=f.default.fromValues({action:R.CLOSE}),N=f.default.fromValues({action:R.DISCONNECT}),B=(function(L){o.__extends(j,L);function j(M,G,O,A){var T=L.call(this)||this;return A&&(O.format=void 0,O.heartbeats=!0),T.connectionManager=M,M.registerProposedTransport(T),T.auth=G,T.params=O,T.timeouts=O.options.timeouts,T.format=O.format,T.isConnected=!1,T.isFinished=!1,T.isDisposed=!1,T.maxIdleInterval=null,T.idleTimer=null,T.lastActivity=null,T}return j.prototype.connect=function(){},j.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",_.default.closed())},j.prototype.disconnect=function(M){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",M||_.default.disconnected())},j.prototype.fail=function(M){this.isConnected&&this.requestDisconnect(),this.finish("failed",M||_.default.failed())},j.prototype.finish=function(M,G){var O;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((O=this.idleTimer)!==null&&O!==void 0?O:void 0),this.idleTimer=null,this.emit(M,G),this.dispose())},j.prototype.onProtocolMessage=function(M){switch(m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+f.default.stringify(M)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),M.action){case R.HEARTBEAT:m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",M.id);break;case R.CONNECTED:this.onConnect(M),this.emit("connected",M.error,M.connectionId,M.connectionDetails,M);break;case R.CLOSED:this.onClose(M);break;case R.DISCONNECTED:this.onDisconnect(M);break;case R.ACK:this.emit("ack",M.msgSerial,M.count);break;case R.NACK:this.emit("nack",M.msgSerial,M.count,M.error);break;case R.SYNC:this.connectionManager.onChannelMessage(M,this);break;case R.ACTIVATE:break;case R.AUTH:this.auth.authorize(function(G){G&&m.default.logAction(m.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+h.inspectError(G))});break;case R.ERROR:if(m.default.logAction(m.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(M.error)+(M.channel?", channel: "+M.channel:"")),M.channel===void 0){this.onFatalError(M);break}this.connectionManager.onChannelMessage(M,this);break;default:this.connectionManager.onChannelMessage(M,this)}},j.prototype.onConnect=function(M){if(this.isConnected=!0,!M.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var G=M.connectionDetails.maxIdleInterval;G&&(this.maxIdleInterval=G+this.timeouts.realtimeRequestTimeout,this.onActivity())},j.prototype.onDisconnect=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onDisconnect()","err = "+h.inspectError(G)),this.finish("disconnected",G)},j.prototype.onFatalError=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onFatalError()","err = "+h.inspectError(G)),this.finish("failed",G)},j.prototype.onClose=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onClose()","err = "+h.inspectError(G)),this.finish("closed",G)},j.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestClose()",""),this.send(v)},j.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(N)},j.prototype.ping=function(M){var G={action:f.default.Action.HEARTBEAT};M&&(G.id=M),this.send(f.default.fromValues(G))},j.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},j.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=h.now(),this.setIdleTimer(this.maxIdleInterval+100))},j.prototype.setIdleTimer=function(M){var G=this;this.idleTimer||(this.idleTimer=setTimeout(function(){G.onIdleTimerExpire()},M))},j.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var M=h.now()-this.lastActivity,G=this.maxIdleInterval-M;if(G<=0){var O="No activity seen from realtime in "+M+"ms; assuming connection has dropped";m.default.logAction(m.default.LOG_ERROR,"Transport.onIdleTimerExpire()",O),this.disconnect(new C.default(O,80003,408))}else this.setIdleTimer(G+100)},j.tryConnect=function(M,G,O,A,T){var y=new M(G,O,A),z,U=function(K){clearTimeout(z),T({event:this.event,error:K})},P=G.options.timeouts.realtimeRequestTimeout;z=setTimeout(function(){y.off(["preconnect","disconnected","failed"]),y.dispose(),U.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},P),y.on(["failed","disconnected"],U),y.on("preconnect",function(){m.default.logAction(m.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+y),clearTimeout(z),y.off(["failed","disconnected"],U),T(null,y)}),y.connect()},j})(g.default);i.default=B}),(function(n,i,r){(function(o,f){n.exports=f(r(6),r(40),r(25))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.Base,m=h.WordArray,_=f.algo,C=_.MD5,E=_.EvpKDF=g.extend({cfg:g.extend({keySize:128/32,hasher:C,iterations:1}),init:function(R){this.cfg=this.cfg.extend(R)},compute:function(R,v){for(var N,B=this.cfg,L=B.hasher.create(),j=m.create(),M=j.words,G=B.keySize,O=B.iterations;M.length<G;){N&&L.update(N),N=L.update(R).finalize(v),L.reset();for(var A=1;A<O;A++)N=L.finalize(N),L.reset();j.concat(N)}return j.sigBytes=G*4,j}});f.EvpKDF=function(R,v,N){return E.create(N).compute(R,v)}})(),o.EvpKDF})}),(function(n,i,r){(function(o,f){n.exports=f(r(6),r(27))})(this,function(o){o.lib.Cipher||(function(f){var h=o,g=h.lib,m=g.Base,_=g.WordArray,C=g.BufferedBlockAlgorithm,E=h.enc;E.Utf8;var R=E.Base64,v=h.algo,N=v.EvpKDF,B=g.Cipher=C.extend({cfg:m.extend(),createEncryptor:function(Q,X){return this.create(this._ENC_XFORM_MODE,Q,X)},createDecryptor:function(Q,X){return this.create(this._DEC_XFORM_MODE,Q,X)},init:function(Q,X,Y){this.cfg=this.cfg.extend(Y),this._xformMode=Q,this._key=X,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(Q){return this._append(Q),this._process()},finalize:function(Q){Q&&this._append(Q);var X=this._doFinalize();return X},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function Q(X){return typeof X=="string"?K:z}return function(X){return{encrypt:function(Y,D,I){return Q(D).encrypt(X,Y,D,I)},decrypt:function(Y,D,I){return Q(D).decrypt(X,Y,D,I)}}}})()});g.StreamCipher=B.extend({_doFinalize:function(){var Q=this._process(!0);return Q},blockSize:1});var L=h.mode={},j=g.BlockCipherMode=m.extend({createEncryptor:function(Q,X){return this.Encryptor.create(Q,X)},createDecryptor:function(Q,X){return this.Decryptor.create(Q,X)},init:function(Q,X){this._cipher=Q,this._iv=X}}),M=L.CBC=(function(){var Q=j.extend();Q.Encryptor=Q.extend({processBlock:function(Y,D){var I=this._cipher,F=I.blockSize;X.call(this,Y,D,F),I.encryptBlock(Y,D),this._prevBlock=Y.slice(D,D+F)}}),Q.Decryptor=Q.extend({processBlock:function(Y,D){var I=this._cipher,F=I.blockSize,W=Y.slice(D,D+F);I.decryptBlock(Y,D),X.call(this,Y,D,F),this._prevBlock=W}});function X(Y,D,I){var F,W=this._iv;W?(F=W,this._iv=f):F=this._prevBlock;for(var it=0;it<I;it++)Y[D+it]^=F[it]}return Q})(),G=h.pad={},O=G.Pkcs7={pad:function(Q,X){for(var Y=X*4,D=Y-Q.sigBytes%Y,I=D<<24|D<<16|D<<8|D,F=[],W=0;W<D;W+=4)F.push(I);var it=_.create(F,D);Q.concat(it)},unpad:function(Q){var X=Q.words[Q.sigBytes-1>>>2]&255;Q.sigBytes-=X}};g.BlockCipher=B.extend({cfg:B.cfg.extend({mode:M,padding:O}),reset:function(){var Q;B.reset.call(this);var X=this.cfg,Y=X.iv,D=X.mode;this._xformMode==this._ENC_XFORM_MODE?Q=D.createEncryptor:(Q=D.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Q?this._mode.init(this,Y&&Y.words):(this._mode=Q.call(D,this,Y&&Y.words),this._mode.__creator=Q)},_doProcessBlock:function(Q,X){this._mode.processBlock(Q,X)},_doFinalize:function(){var Q,X=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(X.pad(this._data,this.blockSize),Q=this._process(!0)):(Q=this._process(!0),X.unpad(Q)),Q},blockSize:128/32});var A=g.CipherParams=m.extend({init:function(Q){this.mixIn(Q)},toString:function(Q){return(Q||this.formatter).stringify(this)}}),T=h.format={},y=T.OpenSSL={stringify:function(Q){var X,Y=Q.ciphertext,D=Q.salt;return D?X=_.create([1398893684,1701076831]).concat(D).concat(Y):X=Y,X.toString(R)},parse:function(Q){var X,Y=R.parse(Q),D=Y.words;return D[0]==1398893684&&D[1]==1701076831&&(X=_.create(D.slice(2,4)),D.splice(0,4),Y.sigBytes-=16),A.create({ciphertext:Y,salt:X})}},z=g.SerializableCipher=m.extend({cfg:m.extend({format:y}),encrypt:function(Q,X,Y,D){D=this.cfg.extend(D);var I=Q.createEncryptor(Y,D),F=I.finalize(X),W=I.cfg;return A.create({ciphertext:F,key:Y,iv:W.iv,algorithm:Q,mode:W.mode,padding:W.padding,blockSize:Q.blockSize,formatter:D.format})},decrypt:function(Q,X,Y,D){D=this.cfg.extend(D),X=this._parse(X,D.format);var I=Q.createDecryptor(Y,D).finalize(X.ciphertext);return I},_parse:function(Q,X){return typeof Q=="string"?X.parse(Q,this):Q}}),U=h.kdf={},P=U.OpenSSL={execute:function(Q,X,Y,D){D||(D=_.random(64/8));var I=N.create({keySize:X+Y}).compute(Q,D),F=_.create(I.words.slice(X),Y*4);return I.sigBytes=X*4,A.create({key:I,iv:F,salt:D})}},K=g.PasswordBasedCipher=z.extend({cfg:z.cfg.extend({kdf:P}),encrypt:function(Q,X,Y,D){D=this.cfg.extend(D);var I=D.kdf.execute(Y,Q.keySize,Q.ivSize);D.iv=I.iv;var F=z.encrypt.call(this,Q,X,I.key,D);return F.mixIn(I),F},decrypt:function(Q,X,Y,D){D=this.cfg.extend(D),X=this._parse(X,D.format);var I=D.kdf.execute(Y,Q.keySize,Q.ivSize,X.salt);D.iv=I.iv;var F=z.decrypt.call(this,Q,X,I.key,D);return F}})})()})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.Request=i.createRequest=void 0;var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(12)),g=o.__importDefault(r(3)),m=o.__importDefault(r(7)),_=r(4),C=o.__importDefault(r(8)),E=o.__importDefault(r(2)),R=o.__importDefault(r(22)),v=f.getGlobalObject(),N=function(){},B=v._ablyjs_jsonp={};B._=function(T){return B["_"+T]||N};var L=1,j="jsonp";function M(T,y,z,U,P,K,Q){return K=K||C.default.TIMEOUTS,new O(void 0,T,y,f.copy(z),U,P,K,Q)}i.createRequest=M;var G=(function(T){o.__extends(y,T);function y(z,U,P){var K=T.call(this,z,U,P)||this;return K.shortName=j,P.stream=!1,K}return y.isAvailable=function(){return g.default.Config.jsonpSupported&&g.default.Config.allowComet},y.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},y.prototype.createRequest=function(z,U,P,K,Q,X,Y){return X=(this===null||this===void 0?void 0:this.timeouts)||X||C.default.TIMEOUTS,M(z,U,P,K,Q,X,Y)},y})(h.default),O=(function(T){o.__extends(y,T);function y(z,U,P,K,Q,X,Y,D){var I=T.call(this)||this;return z===void 0&&(z=L++),I.id=z,I.uri=U,I.params=K||{},I.params.rnd=f.cheapRandStr(),P&&(P["X-Ably-Version"]&&(I.params.v=P["X-Ably-Version"]),P["X-Ably-Lib"]&&(I.params.lib=P["X-Ably-Lib"])),I.body=Q,I.method=D,I.requestMode=X,I.timeouts=Y,I.requestComplete=!1,I}return y.prototype.exec=function(){var z=this,U=this.id,P=this.body,K=this.method,Q=this.uri,X=this.params;X.callback="_ablyjs_jsonp._("+U+")",X.envelope="jsonp",P&&(X.body=P),K&&K!=="get"&&(X.method=K);var Y=this.script=document.createElement("script"),D=Q+f.toQueryString(X);Y.src=D,Y.src.split("/").slice(-1)[0]!==D.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),Y.async=!0,Y.type="text/javascript",Y.charset="UTF-8",Y.onerror=function(W){z.complete(new _.PartialErrorInfo("JSONP script error (event: "+g.default.Config.inspect(W)+")",null,400))},B["_"+U]=function(W){if(W.statusCode){var it=W.response;if(W.statusCode==204)z.complete(null,null,null,W.statusCode);else if(!it)z.complete(new _.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(W.statusCode<400||f.isArray(it))z.complete(null,it,W.headers,W.statusCode);else{var Z=it.error||new _.PartialErrorInfo("Error response received from server",null,W.statusCode);z.complete(Z)}}else z.complete(null,W)};var I=this.requestMode==R.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),I);var F=document.getElementsByTagName("head")[0];F.insertBefore(Y,F.firstChild)},y.prototype.complete=function(z,U,P,K){if(P=P||{},!this.requestComplete){this.requestComplete=!0;var Q=void 0;U&&(Q=typeof U=="string"?"text/plain":"application/json",P["content-type"]=Q,this.emit("data",U)),this.emit("complete",z,U,P,!0,K),this.dispose()}},y.prototype.abort=function(){this.dispose()},y.prototype.dispose=function(){var z=this.timer;z&&(clearTimeout(z),this.timer=null);var U=this.script;U.parentNode&&U.parentNode.removeChild(U),delete B[this.id],this.emit("disposed")},y})(m.default);i.Request=O;function A(T){return v.JSONPTransport=G,G.isAvailable()&&(T.supportedTransports[j]=G),G}i.default=A}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(2)),g=o.__importDefault(r(8)),m=o.__importDefault(r(18)),_=o.__importDefault(r(46)),C=o.__importDefault(r(20)),E=o.__importDefault(r(33)),R=o.__importDefault(r(4)),v=o.__importDefault(r(49)),N=o.__importDefault(r(19)),B=o.__importDefault(r(3)),L=o.__importDefault(r(9)),j=o.__importDefault(r(16)),M=o.__importDefault(r(15)),G=function(){},O=(function(){function T(y){if(!y){var z="no options provided";throw h.default.logAction(h.default.LOG_ERROR,"Rest()",z),new Error(z)}var U=g.default.objectifyOptions(y);U.log?(h.default.setLog(U.log.level,U.log.handler),h.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):h.default.setLog(U.logLevel,U.logHandler),h.default.logAction(h.default.LOG_MICRO,"Rest()","initialized with clientOptions "+B.default.Config.inspect(y));var P=this.options=g.default.normaliseOptions(U);if(P.key){var K=P.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!K){var z="invalid key parameter";throw h.default.logAction(h.default.LOG_ERROR,"Rest()",z),new R.default(z,40400,404)}P.keyName=K[1],P.keySecret=K[2]}if("clientId"in P)if(typeof P.clientId=="string"||P.clientId===null){if(P.clientId==="*")throw new R.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new R.default("clientId must be either a string or null",40012,400);h.default.logAction(h.default.LOG_MINOR,"Rest()","started; version = "+g.default.version),this.baseUri=this.authority=function(Q){return g.default.getHttpScheme(P)+Q+":"+g.default.getPort(P,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new B.default.Http(P),this.auth=new m.default(this,P),this.channels=new A(this),this.push=new _.default(this)}return T.prototype.stats=function(y,z){if(z===void 0)if(typeof y=="function")z=y,y=null;else{if(this.options.promises)return f.promisify(this,"stats",[y]);z=G}var U=f.defaultGetHeaders(this.options),P=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,K=this.http.supportsLinkHeaders?void 0:P;this.options.headers&&f.mixin(U,this.options.headers),new C.default(this,"/stats",U,K,function(Q,X,Y){for(var D=Y?Q:JSON.parse(Q),I=0;I<D.length;I++)D[I]=v.default.fromValues(D[I]);return D}).get(y,z)},T.prototype.time=function(y,z){var U=this;if(z===void 0){if(typeof y=="function")z=y,y=null;else if(this.options.promises)return f.promisify(this,"time",[y])}var P=z||G,K=f.defaultGetHeaders(this.options);this.options.headers&&f.mixin(K,this.options.headers);var Q=function(X){return U.authority(X)+"/time"};this.http.do(N.default.Get,this,Q,K,null,y,function(X,Y,D,I){if(X){P(X);return}I||(Y=JSON.parse(Y));var F=Y[0];if(!F){P(new R.default("Internal error (unexpected result type from GET /time)",5e4,500));return}U.serverTimeOffset=F-f.now(),P(null,F)})},T.prototype.request=function(y,z,U,P,K,Q){var X=this.options.useBinaryProtocol,Y=X?B.default.Config.msgpack.encode:JSON.stringify,D=X?B.default.Config.msgpack.decode:JSON.parse,I=X?f.Format.msgpack:f.Format.json,F=this.http.supportsLinkHeaders?void 0:I;U=U||{};var W=y.toLowerCase(),it=W=="get"?f.defaultGetHeaders(this.options,I):f.defaultPostHeaders(this.options,I);if(Q===void 0){if(this.options.promises)return f.promisify(this,"request",[y,z,U,P,K]);Q=G}typeof P!="string"&&(P=Y(P)),this.options.headers&&f.mixin(it,this.options.headers),K&&f.mixin(it,K);var Z=new C.default(this,z,it,F,function(at,rt,V){return f.ensureArray(V?at:D(at))},!0);if(!f.arrIn(B.default.Http.methods,W))throw new R.default("Unsupported method "+W,40500,405);f.arrIn(B.default.Http.methodsWithBody,W)?Z[W](U,P,Q):Z[W](U,Q)},T.prototype.batchPublish=function(y,z){if(z===void 0){if(this.options.promises)return f.promisify(this,"batchPublish",[y]);z=G}var U=z,P,K;f.isArray(y)?(P=y,K=!1):(P=[y],K=!0);var Q=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,X=f.defaultPostHeaders(this.options,Q);this.options.headers&&f.mixin(X,this.options.headers);var Y=f.encodeBody(P,Q);M.default.post(this,"/messages",Y,X,{newBatchResponse:"true"},null,function(D,I,F,W){if(D){U(D);return}var it=W?I:f.decodeBody(I,Q);K?U(null,it[0]):U(null,it)})},T.prototype.batchPresence=function(y,z){if(z===void 0){if(this.options.promises)return f.promisify(this,"batchPresence",[y]);z=G}var U=z,P=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,K=f.defaultPostHeaders(this.options,P);this.options.headers&&f.mixin(K,this.options.headers);var Q=y.join(",");M.default.get(this,"/presence",K,{newBatchResponse:"true",channels:Q},null,function(X,Y,D,I){if(X){U(X);return}var F=I?Y:f.decodeBody(Y,P);U(null,F)})},T.prototype.setLog=function(y){h.default.setLog(y.level,y.handler)},T.Promise=function(y){return y=g.default.objectifyOptions(y),y.promises=!0,new T(y)},T.Callbacks=T,T.Platform=B.default,T.Message=L.default,T.PresenceMessage=j.default,T})(),A=(function(){function T(y){this.rest=y,this.all=Object.create(null)}return T.prototype.get=function(y,z){y=String(y);var U=this.all[y];return U?z&&U.setOptions(z):this.all[y]=U=new E.default(this.rest,y,z),U},T.prototype.release=function(y){delete this.all[String(y)]},T})();i.default=O}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return o.enc.Utf8})}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(f){var h=o,g=h.lib,m=g.WordArray,_=g.Hasher,C=h.algo,E=[],R=[];(function(){function B(G){for(var O=f.sqrt(G),A=2;A<=O;A++)if(!(G%A))return!1;return!0}function L(G){return(G-(G|0))*4294967296|0}for(var j=2,M=0;M<64;)B(j)&&(M<8&&(E[M]=L(f.pow(j,1/2))),R[M]=L(f.pow(j,1/3)),M++),j++})();var v=[],N=C.SHA256=_.extend({_doReset:function(){this._hash=new m.init(E.slice(0))},_doProcessBlock:function(B,L){for(var j=this._hash.words,M=j[0],G=j[1],O=j[2],A=j[3],T=j[4],y=j[5],z=j[6],U=j[7],P=0;P<64;P++){if(P<16)v[P]=B[L+P]|0;else{var K=v[P-15],Q=(K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3,X=v[P-2],Y=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;v[P]=Q+v[P-7]+Y+v[P-16]}var D=T&y^~T&z,I=M&G^M&O^G&O,F=(M<<30|M>>>2)^(M<<19|M>>>13)^(M<<10|M>>>22),W=(T<<26|T>>>6)^(T<<21|T>>>11)^(T<<7|T>>>25),it=U+W+D+R[P]+v[P],Z=F+I;U=z,z=y,y=T,T=A+it|0,A=O,O=G,G=M,M=it+Z|0}j[0]=j[0]+M|0,j[1]=j[1]+G|0,j[2]=j[2]+O|0,j[3]=j[3]+A|0,j[4]=j[4]+T|0,j[5]=j[5]+y|0,j[6]=j[6]+z|0,j[7]=j[7]+U|0},_doFinalize:function(){var B=this._data,L=B.words,j=this._nDataBytes*8,M=B.sigBytes*8;return L[M>>>5]|=128<<24-M%32,L[(M+64>>>9<<4)+14]=f.floor(j/4294967296),L[(M+64>>>9<<4)+15]=j,B.sigBytes=L.length*4,this._process(),this._hash},clone:function(){var B=_.clone.call(this);return B._hash=this._hash.clone(),B}});h.SHA256=_._createHelper(N),h.HmacSHA256=_._createHmacHelper(N)})(Math),o.SHA256})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(7)),g=o.__importDefault(r(2)),m=o.__importDefault(r(34)),_=o.__importDefault(r(9)),C=o.__importDefault(r(4)),E=o.__importDefault(r(20)),R=o.__importDefault(r(15)),v=o.__importDefault(r(3));function N(){}var B=9;function L(G){return f.arrEvery(G,function(O){return!O.id})}function j(G){var O=G||{};if(O.cipher){if(!v.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var A=v.default.Crypto.getCipher(O.cipher);O.cipher=A.cipherParams,O.channelCipher=A.cipher}else"cipher"in O&&(O.cipher=void 0,O.channelCipher=null);return O}var M=(function(G){o.__extends(O,G);function O(A,T,y){var z=G.call(this)||this;return g.default.logAction(g.default.LOG_MINOR,"Channel()","started; name = "+T),z.rest=A,z.name=T,z.basePath="/channels/"+encodeURIComponent(T),z.presence=new m.default(z),z.channelOptions=j(y),z}return O.prototype.setOptions=function(A){this.channelOptions=j(A)},O.prototype.history=function(A,T){if(g.default.logAction(g.default.LOG_MICRO,"Channel.history()","channel = "+this.name),T===void 0)if(typeof A=="function")T=A,A=null;else{if(this.rest.options.promises)return f.promisify(this,"history",arguments);T=N}this._history(A,T)},O.prototype._history=function(A,T){var y=this.rest,z=y.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,U=this.rest.http.supportsLinkHeaders?void 0:z,P=f.defaultGetHeaders(y.options,z);y.options.headers&&f.mixin(P,y.options.headers);var K=this.channelOptions;new E.default(y,this.basePath+"/messages",P,U,function(Q,X,Y){return _.default.fromResponseBody(Q,K,Y?void 0:z)}).get(A,T)},O.prototype.publish=function(){var A=this,T=arguments.length,y=arguments[0],z=arguments[1],U=arguments[T-1],P,K;if(typeof U!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);U=N}if(typeof y=="string"||y===null)P=[_.default.fromValues({name:y,data:z})],K=arguments[2];else if(f.isObject(y))P=[_.default.fromValues(y)],K=arguments[1];else if(f.isArray(y))P=_.default.fromValuesArray(y),K=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof K!="object"||!K)&&(K={});var Q=this.rest,X=Q.options,Y=X.useBinaryProtocol?f.Format.msgpack:f.Format.json,D=Q.options.idempotentRestPublishing,I=f.defaultPostHeaders(Q.options,Y);if(X.headers&&f.mixin(I,X.headers),D&&L(P)){var F=f.randomString(B);f.arrForEach(P,function(W,it){W.id=F+":"+it.toString()})}_.default.encodeArray(P,this.channelOptions,function(W){if(W){U(W);return}var it=_.default.getMessagesSize(P),Z=X.maxMessageSize;if(it>Z){U(new C.default("Maximum size of messages that can be published at once exceeded ( was "+it+" bytes; limit is "+Z+" bytes)",40009,400));return}A._publish(_.default.serialize(P,Y),I,K,U)})},O.prototype._publish=function(A,T,y,z){R.default.post(this.rest,this.basePath+"/messages",A,T,y,null,z)},O.prototype.status=function(A){if(typeof A!="function"&&this.rest.options.promises)return f.promisify(this,"status",[]);var T=this.rest.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,y=f.defaultPostHeaders(this.rest.options,T);R.default.get(this.rest,this.basePath,y,{},T,A||N)},O})(h.default);i.default=M}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(7)),g=o.__importDefault(r(2)),m=o.__importDefault(r(20)),_=o.__importDefault(r(16));function C(){}var E=(function(R){o.__extends(v,R);function v(N){var B=R.call(this)||this;return B.channel=N,B.basePath=N.basePath+"/presence",B}return v.prototype.get=function(N,B){if(g.default.logAction(g.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),B===void 0)if(typeof N=="function")B=N,N=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"get",arguments);B=C}var L=this.channel.rest,j=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:j,G=f.defaultGetHeaders(L.options,j);L.options.headers&&f.mixin(G,L.options.headers);var O=this.channel.channelOptions;new m.default(L,this.basePath,G,M,function(A,T,y){return _.default.fromResponseBody(A,O,y?void 0:j)}).get(N,B)},v.prototype.history=function(N,B){return g.default.logAction(g.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(N,B)},v.prototype._history=function(N,B){if(B===void 0)if(typeof N=="function")B=N,N=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"_history",[N]);B=C}var L=this.channel.rest,j=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:j,G=f.defaultGetHeaders(L.options,j);L.options.headers&&f.mixin(G,L.options.headers);var O=this.channel.channelOptions;new m.default(L,this.basePath+"/history",G,M,function(A,T,y){return _.default.fromResponseBody(A,O,y?void 0:j)}).get(N,B)},v})(h.default);i.default=E}),(function(n,i,r){(function(o){Object.defineProperty(i,"__esModule",{value:!0}),i.TransportParams=void 0;var f=r(0),h=f.__importDefault(r(10)),g=f.__importStar(r(1)),m=f.__importStar(r(52)),_=f.__importStar(r(8)),C=f.__importDefault(r(3)),E=f.__importDefault(r(7)),R=f.__importDefault(r(36)),v=f.__importDefault(r(2)),N=f.__importDefault(r(37)),B=f.__importStar(r(21)),L=f.__importStar(r(4)),j=f.__importDefault(r(18)),M=f.__importDefault(r(9)),G=f.__importDefault(r(24)),O=f.__importDefault(r(53)),A=f.__importDefault(r(26)),T=f.__importDefault(r(14)),y=function(){var at;return typeof C.default.WebStorage<"u"&&((at=C.default.WebStorage)===null||at===void 0?void 0:at.localSupported)},z=function(){var at;return typeof C.default.WebStorage<"u"&&((at=C.default.WebStorage)===null||at===void 0?void 0:at.sessionSupported)},U=h.default.Action,P=function(){},K="ably-transport-preference",Q="ably-connection-recovery";function X(){var at,rt;return z()&&((rt=(at=C.default.WebStorage)===null||at===void 0?void 0:at.getSession)===null||rt===void 0?void 0:rt.call(at,Q))}function Y(at){var rt,V;return z()&&((V=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.setSession)===null||V===void 0?void 0:V.call(rt,Q,at))}function D(){var at,rt;return z()&&((rt=(at=C.default.WebStorage)===null||at===void 0?void 0:at.removeSession)===null||rt===void 0?void 0:rt.call(at,Q))}function I(at,rt){return g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,at.shortName)>g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,rt.shortName)}function F(at,rt,V){var J;if(at.channel!==rt.channel||(J=at.action)!==U.PRESENCE&&J!==U.MESSAGE||J!==rt.action)return!1;var $=J===U.PRESENCE?"presence":"messages",nt=at[$].concat(rt[$]),dt=M.default.getMessagesSize(nt);return dt>V||!g.allSame(nt,"clientId")||!g.arrEvery(nt,function(wt){return!wt.id})?!1:(at[$]=nt,!0)}function W(at){try{return JSON.parse(at)}catch{return null}}var it=(function(){function at(rt,V,J,$){this.options=rt,this.host=V,this.mode=J,this.connectionKey=$,this.format=rt.useBinaryProtocol?g.Format.msgpack:g.Format.json}return at.prototype.getConnectParams=function(rt){var V=rt?g.copy(rt):{},J=this.options;switch(this.mode){case"upgrade":V.upgrade=this.connectionKey;break;case"resume":V.resume=this.connectionKey;break;case"recover":{var $=W(J.recover);$&&(V.recover=$.connectionKey);break}}return J.clientId!==void 0&&(V.clientId=J.clientId),J.echoMessages===!1&&(V.echo="false"),this.format!==void 0&&(V.format=this.format),this.stream!==void 0&&(V.stream=this.stream),this.heartbeats!==void 0&&(V.heartbeats=this.heartbeats),V.v=_.default.protocolVersion,V.agent=(0,_.getAgentString)(this.options),J.transportParams!==void 0&&g.mixin(V,J.transportParams),V},at.prototype.toString=function(){var rt="[mode="+this.mode;return this.host&&(rt+=",host="+this.host),this.connectionKey&&(rt+=",connectionKey="+this.connectionKey),this.format&&(rt+=",format="+this.format),rt+="]",rt},at})();i.TransportParams=it;var Z=(function(at){f.__extends(rt,at);function rt(V,J){var $=at.call(this)||this;$.disconnectedRetryCount=0,rt.initTransports(),$.realtime=V,$.options=J;var nt=J.timeouts,dt=nt.preferenceConnectTimeout+nt.realtimeRequestTimeout;if($.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:dt,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:nt.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},$.state=$.states.initialized,$.errorReason=null,$.queuedMessages=new R.default,$.msgSerial=0,$.connectionDetails=void 0,$.connectionId=void 0,$.connectionKey=void 0,$.connectionStateTtl=nt.connectionStateTtl,$.maxIdleInterval=null,$.transports=g.intersect(J.transports||_.default.defaultTransports,rt.supportedTransports),$.baseTransport=g.intersect(_.default.baseTransportOrder,$.transports)[0],$.upgradeTransports=g.intersect($.transports,_.default.upgradeTransports),$.transportPreference=null,$.httpHosts=_.default.getHosts(J),$.activeProtocol=null,$.proposedTransports=[],$.pendingTransports=[],$.host=null,$.lastAutoReconnectAttempt=null,$.lastActivity=null,$.forceFallbackHost=!1,$.connectCounter=0,v.default.logAction(v.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(J.transports||_.default.defaultTransports)+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+$.transports+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+$.httpHosts+"]"),!$.transports.length){var wt="no requested transports available";throw v.default.logAction(v.default.LOG_ERROR,"realtime.ConnectionManager()",wt),new Error(wt)}var Ut=C.default.Config.addEventListener;return Ut&&(z()&&typeof J.recover=="function"&&Ut("beforeunload",$.persistConnection.bind($)),J.closeOnUnload===!0&&Ut("beforeunload",function(){v.default.logAction(v.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),$.requestState({state:"closing"})}),Ut("online",function(){$.state==$.states.disconnected||$.state==$.states.suspended?(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),$.requestState({state:"connecting"})):$.state==$.states.connecting&&($.pendingTransports.forEach(function(It){It.off()}),$.disconnectAllTransports(),$.startConnect())}),Ut("offline",function(){$.state==$.states.connected&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),$.disconnectAllTransports())})),$}return rt.initTransports=function(){(0,O.default)(rt),g.arrForEach(C.default.Transports,function(V){V(rt)})},rt.prototype.createTransportParams=function(V,J){return new it(this.options,V,J,this.connectionKey)},rt.prototype.getTransportParams=function(V){var J=this,$=function(nt){if(J.connectionKey){nt("resume");return}if(typeof J.options.recover=="string"){nt("recover");return}var dt=J.options.recover,wt=X();if(wt&&typeof dt=="function"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),dt(wt,function(Ut){Ut?(J.options.recover=wt.recoveryKey,nt("recover")):nt("clean")});return}nt("clean")};$(function(nt){var dt=J.createTransportParams(null,nt);if(nt==="recover"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+J.options.recover);var wt=W(J.options.recover);wt&&(J.msgSerial=wt.msgSerial)}else v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+dt.toString());V(dt)})},rt.prototype.tryATransport=function(V,J,$){var nt=this;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+J),A.default.tryConnect(rt.supportedTransports[J],this,this.realtime.auth,V,function(dt,wt){var Ut=nt.state;if(Ut==nt.states.closing||Ut==nt.states.closed||Ut==nt.states.failed){wt&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+Ut.state+" while we were attempting the transport; closing "+wt),wt.close()),$(!0);return}if(dt){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+J+" "+dt.event+", err: "+dt.error.toString()),j.default.isTokenErr(dt.error)&&!(nt.errorReason&&j.default.isTokenErr(nt.errorReason))?(nt.errorReason=dt.error,nt.realtime.auth._forceNewToken(null,null,function(It){if(It){nt.actOnErrorFromAuthorize(It);return}nt.tryATransport(V,J,$)})):dt.event==="failed"?(nt.notifyState({state:"failed",error:dt.error}),$(!0)):dt.event==="disconnected"&&((0,B.isRetriable)(dt.error)?$(!1):(nt.notifyState({state:nt.states.connecting.failState,error:dt.error}),$(!0)));return}v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+J+"; setting pending"),nt.setTransportPending(wt,V),$(null,wt)})},rt.prototype.setTransportPending=function(V,J){var $=this,nt=J.mode;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+V+"; mode = "+nt),g.arrDeleteValue(this.proposedTransports,V),this.pendingTransports.push(V);var dt=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];V.once("connected",function(Ut,It,ne){nt=="upgrade"&&$.activeProtocol?V.shortName!==dt&&g.arrIn($.getUpgradePossibilities(),dt)&&$.activeProtocol?setTimeout(function(){$.scheduleTransportActivation(Ut,V,It,ne)},$.options.timeouts.parallelUpgradeDelay):$.scheduleTransportActivation(Ut,V,It,ne):($.activateTransport(Ut,V,It,ne),C.default.Config.nextTick(function(){$.connectImpl(J)})),nt==="recover"&&$.options.recover&&($.options.recover=null,$.unpersistConnection())});var wt=this;V.on(["disconnected","closed","failed"],function(Ut){wt.deactivateTransport(V,this.event,Ut)}),this.emit("transport.pending",V)},rt.prototype.scheduleTransportActivation=function(V,J,$,nt){var dt=this,wt=this.activeProtocol&&this.activeProtocol.getTransport(),Ut=function(){J.disconnect(),g.arrDeleteValue(dt.pendingTransports,J)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),Ut();return}if(wt&&!I(J,wt)){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+" is no better than current active transport "+wt.shortName+" - abandoning upgrade"),Ut();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+J);var It=null;if(!J.isConnected){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+"is no longer connected; abandoning upgrade"),Ut();return}if(this.state===this.states.connected)v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,It=this.activeProtocol;else if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),Ut();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+J);var ne=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+J),J.send(h.default.fromValues({action:U.ACTIVATE})),dt.activateTransport(V,J,$,nt),dt.state===dt.states.synchronizing?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+J),dt.state=dt.states.connected):v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+dt.state.state+", so leaving unchanged"),dt.state.sendEvents&&dt.sendQueuedMessages()};It?It.onceIdle(ne):ne()},rt.prototype.activateTransport=function(V,J,$,nt){var dt=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+J),V&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+V),$&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+$),nt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(nt)),this.persistTransportPreference(J);var wt=this.state,Ut=this.states.connected.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+wt.state),wt.state==this.states.closing.state||wt.state==this.states.closed.state||wt.state==this.states.failed.state)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),J.disconnect(),!1;if(g.arrDeleteValue(this.pendingTransports,J),!J.isConnected)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+J+" since it appears to no longer be connected"),!1;var It=this.activeProtocol;this.activeProtocol=new m.default(J),this.host=J.params.host;var ne=nt.connectionKey;if(ne&&this.connectionKey!=ne&&this.setConnection($,nt,!!V),this.onConnectionDetailsUpdate(nt,J),C.default.Config.nextTick(function(){J.on("connected",function(Lt,_e,we){dt.onConnectionDetailsUpdate(we,J),dt.emit("update",new N.default(Ut,Ut,null,Lt))})}),wt.state===this.states.connected.state?V&&(this.errorReason=this.realtime.connection.errorReason=V,this.emit("update",new N.default(Ut,Ut,null,V))):(this.notifyState({state:"connected",error:V}),this.errorReason=this.realtime.connection.errorReason=V||null),this.emit("transport.active",J),It)if(It.messageQueue.count()>0&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+It.transport.shortName+", new one is "+J.shortName+") finishing with "+It.messageQueue.count()+" messages still pending"),It.transport===J){var ae="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",ae)}else It.finish();return g.safeArrForEach(this.pendingTransports,function(Lt){if(Lt===J){var _e="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",_e),g.arrDeleteValue(dt.pendingTransports,J)}else Lt.disconnect()}),g.safeArrForEach(this.proposedTransports,function(Lt){Lt===J?(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+J.shortName+"; stack = "+new Error().stack),g.arrDeleteValue(dt.proposedTransports,J)):Lt.dispose()}),!0},rt.prototype.deactivateTransport=function(V,J,$){var nt=this.activeProtocol,dt=nt&&nt.getTransport()===V,wt=g.arrDeleteValue(this.pendingTransports,V),Ut=g.arrDeleteValue(this.proposedTransports,V),It=this.noTransportsScheduledForActivation();if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+V),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+J+(dt?"; was active":wt?"; was pending":Ut?"; was proposed":"")+(It?"":"; another transport is scheduled for activation")),$&&$.message&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+$.message),dt&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(nt.getPendingMessages()),C.default.Config.nextTick(function(){nt.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",V),dt&&It||dt&&J==="failed"||J==="closed"||nt===null&&wt&&this.pendingTransports.length===0){if(J==="disconnected"&&$&&$.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:J,error:$,retryImmediately:!0});return}var ne=J==="failed"&&j.default.isTokenErr($)?"disconnected":J;this.notifyState({state:ne,error:$});return}dt&&J==="disconnected"&&this.state!==this.states.synchronizing&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:$}))},rt.prototype.noTransportsScheduledForActivation=function(){return g.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(V){return!V.isConnected})},rt.prototype.setConnection=function(V,J,$){var nt=this.connectionId,dt=nt&&nt!==V,wt=!nt&&$;(dt||wt)&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==V&&v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=V,this.realtime.connection.key=this.connectionKey=J.connectionKey},rt.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},rt.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},rt.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var V=g.now()-this.lastActivity;V>this.connectionStateTtl+this.maxIdleInterval&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+V+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},rt.prototype.persistConnection=function(){if(z()){var V=this.createRecoveryKey();V&&Y({recoveryKey:V,disconnectedAt:g.now(),location:o.location,clientId:this.realtime.auth.clientId})}},rt.prototype.unpersistConnection=function(){D()},rt.prototype.getError=function(){return this.errorReason||this.getStateError()},rt.prototype.getStateError=function(){var V,J;return(J=(V=B.default)[this.state.state])===null||J===void 0?void 0:J.call(V)},rt.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},rt.prototype.enactStateChange=function(V){var J=V.current==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(J,"Connection state",V.current+(V.reason?"; reason: "+V.reason:"")),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+V.current+"; reason = "+(V.reason&&V.reason.message));var $=this.state=this.states[V.current];V.reason&&(this.errorReason=V.reason,this.realtime.connection.errorReason=V.reason),($.terminal||$.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",V)},rt.prototype.startTransitionTimer=function(V){var J=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+V.state),this.transitionTimer&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){J.transitionTimer&&(J.transitionTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager "+V.state+" timer expired","requesting new state: "+V.failState),J.notifyState({state:V.failState}))},V.retryDelay)},rt.prototype.cancelTransitionTimer=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},rt.prototype.startSuspendTimer=function(){var V=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){V.suspendTimer&&(V.suspendTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),V.states.connecting.failState="suspended",V.notifyState({state:"suspended"}))},this.connectionStateTtl))},rt.prototype.checkSuspendTimer=function(V){V!=="disconnected"&&V!=="suspended"&&V!=="connecting"&&this.cancelSuspendTimer()},rt.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},rt.prototype.startRetryTimer=function(V){var J=this;this.retryTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),J.retryTimer=null,J.requestState({state:"connecting"})},V)},rt.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},rt.prototype.notifyState=function(V){var J=this,$,nt,dt=V.state,wt=dt==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||V.retryImmediately||this.state===this.states.connecting&&V.error&&j.default.isTokenErr(V.error)&&!(this.errorReason&&j.default.isTokenErr(this.errorReason)));if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+dt+(wt?"; will retry connection immediately":"")),dt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(V.state),(dt==="suspended"||dt==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var Ut=this.states[V.state],It=Ut.retryDelay;Ut.state==="disconnected"&&(this.disconnectedRetryCount++,It=g.getRetryTime(Ut.retryDelay,this.disconnectedRetryCount));var ne=new N.default(this.state.state,Ut.state,It,V.error||((nt=($=B.default)[Ut.state])===null||nt===void 0?void 0:nt.call($)));if(wt){var ae=function(){J.state===J.states.disconnected&&(J.lastAutoReconnectAttempt=g.now(),J.requestState({state:"connecting"}))},Lt=this.lastAutoReconnectAttempt&&g.now()-this.lastAutoReconnectAttempt+1;Lt&&Lt<1e3?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+Lt+"ms ago, waiting another "+(1e3-Lt)+"ms before trying again"),setTimeout(ae,1e3-Lt)):C.default.Config.nextTick(ae)}else(dt==="disconnected"||dt==="suspended")&&this.startRetryTimer(It);(dt==="disconnected"&&!wt||dt==="suspended"||Ut.terminal)&&C.default.Config.nextTick(function(){J.disconnectAllTransports()}),dt=="connected"&&!this.activeProtocol&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(ne),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(dt,ne.reason),this.failQueuedMessages(ne.reason))}},rt.prototype.requestState=function(V){var J=this,$,nt,dt=V.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+dt+"; current state: "+this.state.state),dt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(dt),!(dt=="connecting"&&this.state.state=="connected")&&!(dt=="closing"&&this.state.state=="closed"))){var wt=this.states[dt],Ut=new N.default(this.state.state,wt.state,null,V.error||((nt=($=B.default)[wt.state])===null||nt===void 0?void 0:nt.call($)));this.enactStateChange(Ut),dt=="connecting"&&C.default.Config.nextTick(function(){J.startConnect()}),dt=="closing"&&this.closeImpl()}},rt.prototype.startConnect=function(){var V=this;if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var J=this.realtime.auth,$=++this.connectCounter,nt=function(){V.checkConnectionStateFreshness(),V.getTransportParams(function(wt){if(wt.mode==="recover"&&wt.options.recover){var Ut=W(wt.options.recover);Ut&&V.realtime.channels.recoverChannels(Ut.channelSerials)}$===V.connectCounter&&V.connectImpl(wt,$)})};if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),J.method==="basic")nt();else{var dt=function(wt){$===V.connectCounter&&(wt?V.actOnErrorFromAuthorize(wt):nt())};this.errorReason&&j.default.isTokenErr(this.errorReason)?J._forceNewToken(null,null,dt):J._ensureValidAuthCredentials(!1,dt)}},rt.prototype.connectImpl=function(V,J){var $=this.state.state;$!==this.states.connecting.state&&$!==this.states.connected.state?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+$):this.pendingTransports.length?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):$==this.states.connected.state?this.upgradeIfNeeded(V):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(V,J):this.connectBase(V,J)},rt.prototype.connectPreference=function(V,J){var $=this,nt=this.getTransportPreference(),dt=!1;g.arrIn(this.transports,nt)||(this.unpersistTransportPreference(),this.connectImpl(V,J)),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+nt);var wt=setTimeout(function(){dt=!0,$.state.state!==$.states.connected.state&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+nt+" failed; clearing preference and trying from scratch"),$.disconnectAllTransports(),$.unpersistTransportPreference()),$.connectImpl(V,J)},this.options.timeouts.preferenceConnectTimeout);V.host=this.httpHosts[0],this.tryATransport(V,nt,function(Ut,It){clearTimeout(wt),dt&&It?(It.off(),It.disconnect(),g.arrDeleteValue($.pendingTransports,It)):!It&&!Ut&&($.unpersistTransportPreference(),$.connectImpl(V,J))})},rt.prototype.connectBase=function(V,J){var $=this,nt=function(ne){$.notifyState({state:$.states.connecting.failState,error:ne})},dt=this.httpHosts.slice(),wt=function(ne,ae){J===$.connectCounter&&!ae&&!ne&&It()};v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var Ut=dt.shift();if(!Ut){nt(new L.default("Unable to connect (no available host)",80003,404));return}V.host=Ut;var It=function(){if(!dt.length){nt(new L.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!$.realtime.http.checkConnectivity){nt(new L.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}$.realtime.http.checkConnectivity(function(ne,ae){if(J===$.connectCounter){if(ne){nt(ne);return}if(!ae){nt(new L.default("Unable to connect (network unreachable)",80003,404));return}V.host=g.arrPopRandomElement(dt),$.tryATransport(V,$.baseTransport,wt)}})};if(this.forceFallbackHost&&dt.length){this.forceFallbackHost=!1,It();return}this.tryATransport(V,this.baseTransport,wt)},rt.prototype.getUpgradePossibilities=function(){var V=this.activeProtocol.getTransport().shortName,J=g.arrIndexOf(this.upgradeTransports,V);return this.upgradeTransports.slice(J+1)},rt.prototype.upgradeIfNeeded=function(V){var J=this,$=this.getUpgradePossibilities();v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect($)),$.length&&g.arrForEach($,function(nt){var dt=J.createTransportParams(V.host,"upgrade");J.tryATransport(dt,nt,P)})},rt.prototype.closeImpl=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),g.safeArrForEach(this.pendingTransports,function(V){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+V),V&&V.close()}),g.safeArrForEach(this.proposedTransports,function(V){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+V),V&&V.dispose()}),this.activeProtocol&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},rt.prototype.onAuthUpdated=function(V,J){var $=this,nt;switch(this.state.state){case"connected":{if(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var dt=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){$.state.state==="connected"&&$.upgradeIfNeeded(dt)})}var wt=(nt=this.activeProtocol)===null||nt===void 0?void 0:nt.getTransport();wt&&wt.onAuthUpdated&&wt.onAuthUpdated(V);var Ut=h.default.fromValues({action:U.AUTH,auth:{accessToken:V.token}});this.send(Ut);var It=function(){$.off(ne),J(null,V)},ne=function(Lt){Lt.current==="failed"&&($.off(It),$.off(ne),J(Lt.reason||$.getStateError()))};this.once("connectiondetails",It),this.on("connectionstate",ne);break}case"connecting":v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var ae=function(Lt){switch(Lt.current){case"connected":$.off(ae),J(null,V);break;case"failed":case"closed":case"suspended":$.off(ae),J(Lt.reason||$.getStateError());break}};this.on("connectionstate",ae),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},rt.prototype.disconnectAllTransports=function(V){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(V?" except the active transport":"")),this.connectCounter++,g.safeArrForEach(this.pendingTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+J),J&&J.disconnect()}),this.pendingTransports=[],g.safeArrForEach(this.proposedTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+J),J&&J.dispose()}),this.proposedTransports=[],this.activeProtocol&&!V&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},rt.prototype.send=function(V,J,$){$=$||P;var nt=this.state;if(nt.sendEvents){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new m.PendingMessage(V,$));return}var dt=J&&nt.queueEvents||nt.forceQueueEvents;if(!dt){var wt="rejecting event, queueEvent was "+J+", state was "+nt.state;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()",wt),$(this.errorReason||new L.default(wt,9e4,400));return}v.default.shouldLog(v.default.LOG_MICRO)&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+h.default.stringify(V)),this.queue(V,$)},rt.prototype.sendImpl=function(V){var J=V.message;V.ackRequired&&!V.sendAttempted&&(J.msgSerial=this.msgSerial++);try{this.activeProtocol.send(V)}catch($){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+$.stack)}},rt.prototype.queue=function(V,J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var $=this.queuedMessages.last(),nt=this.options.maxMessageSize;$&&!$.sendAttempted&&F($.message,V,nt)?($.merged||($.callback=G.default.create([$.callback]),$.merged=!0),$.callback.push(J)):this.queuedMessages.push(new m.PendingMessage(V,J))},rt.prototype.sendQueuedMessages=function(){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var V;V=this.queuedMessages.shift();)this.sendImpl(V)},rt.prototype.queuePendingMessages=function(V){V&&V.length&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+V.length+" pending messages"),this.queuedMessages.prepend(V))},rt.prototype.failQueuedMessages=function(V){var J=this.queuedMessages.count();J>0&&(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+J+" queued messages, err = "+g.inspectError(V)),this.queuedMessages.completeAllMessages(V))},rt.prototype.onChannelMessage=function(V,J){var $=this.activeProtocol&&J===this.activeProtocol.getTransport(),nt=g.arrIn(this.pendingTransports,J)&&this.state==this.states.synchronizing;$||nt?this.realtime.channels.onChannelMessage(V):g.arrIndexOf([U.ACK,U.NACK,U.ERROR],V.action)>-1?this.realtime.channels.onChannelMessage(V):v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(V)+"on defunct transport; discarding")},rt.prototype.ping=function(V,J){var $=this;if(V){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+V);var nt=function(){V.off("heartbeat",Ut),J(new L.default("Timeout waiting for heartbeat response",5e4,500))},dt=g.now(),wt=g.cheapRandStr(),Ut=function(_e){if(_e===wt){V.off("heartbeat",Ut),clearTimeout(It);var we=g.now()-dt;J(null,we)}},It=setTimeout(nt,this.options.timeouts.realtimeRequestTimeout);V.on("heartbeat",Ut),V.ping(wt);return}if(this.state.state!=="connected"){J(new L.default("Unable to ping service; not connected",4e4,400));return}var ne=!1,ae=function(_e,we){$.off("transport.active",Lt),ne||(ne=!0,J(_e,we))},Lt=function(){ne||(ne=!0,C.default.Config.nextTick(function(){$.ping(null,J)}))};this.on("transport.active",Lt),this.ping(this.activeProtocol.getTransport(),ae)},rt.prototype.abort=function(V){this.activeProtocol.getTransport().fail(V)},rt.prototype.registerProposedTransport=function(V){this.proposedTransports.push(V)},rt.prototype.getTransportPreference=function(){var V,J;return this.transportPreference||y()&&((J=(V=C.default.WebStorage)===null||V===void 0?void 0:V.get)===null||J===void 0?void 0:J.call(V,K))},rt.prototype.persistTransportPreference=function(V){var J,$;g.arrIn(_.default.upgradeTransports,V.shortName)&&(this.transportPreference=V.shortName,y()&&(($=(J=C.default.WebStorage)===null||J===void 0?void 0:J.set)===null||$===void 0||$.call(J,K,V.shortName)))},rt.prototype.unpersistTransportPreference=function(){var V,J;this.transportPreference=null,y()&&((J=(V=C.default.WebStorage)===null||V===void 0?void 0:V.remove)===null||J===void 0||J.call(V,K))},rt.prototype.actOnErrorFromAuthorize=function(V){if(V.code===40171)this.notifyState({state:"failed",error:V});else if(V.code===40102)this.notifyState({state:"failed",error:V});else if(V.statusCode===T.default.Forbidden){var J="Client configured authentication provider returned 403; failing the connection";v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",J),this.notifyState({state:"failed",error:new L.default(J,80019,403,V)})}else{var J="Client configured authentication provider request failed";v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",J),this.notifyState({state:this.state.failState,error:new L.default(J,80019,401,V)})}},rt.prototype.onConnectionDetailsUpdate=function(V,J){if(V){this.connectionDetails=V,V.maxMessageSize&&(this.options.maxMessageSize=V.maxMessageSize);var $=V.clientId;if($){var nt=this.realtime.auth._uncheckedSetClientId($);if(nt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",nt.message),J.fail(nt);return}}var dt=V.connectionStateTtl;dt&&(this.connectionStateTtl=dt),this.maxIdleInterval=V.maxIdleInterval,this.emit("connectiondetails",V)}},rt.supportedTransports={},rt})(E.default);i.default=Z}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(7)),h=o.__importDefault(r(2)),g=(function(m){o.__extends(_,m);function _(){var C=m.call(this)||this;return C.messages=[],C}return _.prototype.count=function(){return this.messages.length},_.prototype.push=function(C){this.messages.push(C)},_.prototype.shift=function(){return this.messages.shift()},_.prototype.last=function(){return this.messages[this.messages.length-1]},_.prototype.copyAll=function(){return this.messages.slice()},_.prototype.append=function(C){this.messages.push.apply(this.messages,C)},_.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},_.prototype.completeMessages=function(C,E,R){h.default.logAction(h.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+E),R=R||null;var v=this.messages;if(v.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var N=v[0];if(N){var B=N.message.msgSerial,L=C+E;if(L>B)for(var j=v.splice(0,L-B),M=0,G=j;M<G.length;M++){var O=G[M];O.callback(R)}v.length==0&&this.emit("idle")}},_.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},_.prototype.resetSendAttempted=function(){for(var C=0,E=this.messages;C<E.length;C++){var R=E[C];R.sendAttempted=!1}},_.prototype.clear=function(){h.default.logAction(h.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},_})(f.default);i.default=g}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=(function(){function f(h,g,m,_){this.previous=h,this.current=g,m&&(this.retryIn=m),_&&(this.reason=_)}return f})();i.default=o}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(10)),h=o.__importDefault(r(7)),g=o.__importStar(r(1)),m=o.__importDefault(r(33)),_=o.__importDefault(r(2)),C=o.__importDefault(r(54)),E=o.__importDefault(r(9)),R=o.__importDefault(r(39)),v=o.__importStar(r(4)),N=o.__importDefault(r(16)),B=o.__importDefault(r(21)),L=f.default.Action,j=function(){};function M(A){if(A&&"params"in A&&!g.isObject(A.params))return new v.default("options.params must be an object",4e4,400);if(A&&"modes"in A){if(!g.isArray(A.modes))return new v.default("options.modes must be an array",4e4,400);for(var T=0;T<A.modes.length;T++){var y=A.modes[T];if(!y||typeof y!="string"||!g.arrIn(f.default.channelModes,String.prototype.toUpperCase.call(y)))return new v.default("Invalid channel mode: "+y,4e4,400)}}}var G=(function(A){o.__extends(T,A);function T(y,z,U){var P=A.call(this,y,z,U)||this;return P.retryCount=0,P.history=function(K,Q){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),Q===void 0)if(typeof K=="function")Q=K,K=null;else{if(this.rest.options.promises)return g.promisify(this,"history",arguments);Q=j}if(K&&K.untilAttach){if(this.state!=="attached"){Q(new v.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){Q(new v.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete K.untilAttach,K.from_serial=this.properties.attachSerial}m.default.prototype._history.call(this,K,Q)},P.whenState=(function(K,Q){return h.default.prototype.whenState.call(P,K,P.state,Q)}),_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel()","started; name = "+z),P.realtime=y,P.presence=new C.default(P),P.connectionManager=y.connection.connectionManager,P.state="initialized",P.subscriptions=new h.default,P.syncChannelSerial=void 0,P.properties={attachSerial:void 0,channelSerial:void 0},P.setOptions(U),P.errorReason=null,P._requestedFlags=null,P._mode=null,P._attachResume=!1,P._decodingContext={channelOptions:P.channelOptions,plugins:y.options.plugins||{},baseEncodedPreviousPayload:void 0},P._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},P._allChannelChanges=new h.default,P}return T.prototype.invalidStateError=function(){return new v.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},T.processListenerArgs=function(y){return y=Array.prototype.slice.call(y),typeof y[0]=="function"&&y.unshift(null),y[y.length-1]==null&&y.pop(),y},T.prototype.setOptions=function(y,z){var U=this.channelOptions;if(!z&&this.rest.options.promises)return g.promisify(this,"setOptions",arguments);var P=z||function(Q){Q&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+Q.toString())},K=M(y);if(K){P(K);return}m.default.prototype.setOptions.call(this,y),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(y,U)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(Q){switch(this.event){case"update":case"attached":P==null||P(null);return;default:P==null||P(Q.reason);return}})):P()},T.prototype._shouldReattachToSetOptions=function(y,z){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(y!=null&&y.params){var U=O(y.params),P=O(z.params);if(Object.keys(U).length!==Object.keys(P).length||!g.shallowEquals(P,U))return!0}return!!(y!=null&&y.modes&&(!z.modes||!g.arrEquals(y.modes,z.modes)))},T.prototype.publish=function(){for(var y=this,z=[],U=0;U<arguments.length;U++)z[U]=arguments[U];var P=z[0],K=z.length,Q=z[K-1];if(typeof Q!="function"){if(this.realtime.options.promises)return g.promisify(this,"publish",arguments);Q=j,++K}if(!this.connectionManager.activeState()){Q(this.connectionManager.getError());return}if(K==2)if(g.isObject(P))P=[E.default.fromValues(P)];else if(g.isArray(P))P=E.default.fromValuesArray(P);else throw new v.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else P=[E.default.fromValues({name:z[0],data:z[1]})];var X=this.realtime.options.maxMessageSize;E.default.encodeArray(P,this.channelOptions,function(Y){if(Y){Q(Y);return}var D=E.default.getMessagesSize(P);if(D>X){Q(new v.default("Maximum size of messages that can be published at once exceeded ( was "+D+" bytes; limit is "+X+" bytes)",40009,400));return}y.__publish(P,Q)})},T.prototype.__publish=function(y,z){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+y.length);var U=this.state;switch(U){case"failed":case"suspended":z(v.default.fromValues(this.invalidStateError()));break;default:{_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+U);var P=new f.default;P.action=L.MESSAGE,P.channel=this.name,P.messages=y,this.sendMessage(P,z);break}}},T.prototype.onEvent=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var z=this.subscriptions,U=0;U<y.length;U++){var P=y[U];z.emit(P.name,P)}},T.prototype.attach=function(y,z){var U;if(typeof y=="function"?(z=y,U=null):U=y,!z){if(this.realtime.options.promises)return g.promisify(this,"attach",arguments);z=function(P){P&&_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+P.toString())}}if(U)_.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=U;else if(this.state==="attached"){z(null,null);return}this._attach(!1,null,z)},T.prototype._attach=function(y,z,U){U||(U=function(K){K&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+K.toString())});var P=this.connectionManager;if(!P.activeState()){U(P.getError());return}(this.state!=="attaching"||y)&&this.requestState("attaching",z),this.once(function(K){switch(this.event){case"attached":U==null||U(null,K);break;case"detached":case"suspended":case"failed":U==null||U(K.reason||P.getError()||new v.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":U==null||U(new v.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},T.prototype.attachImpl=function(){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var y=f.default.fromValues({action:L.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?y.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&y.encodeModesToFlags(g.allToUpperCase(this.channelOptions.modes)),this._attachResume&&y.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(y.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(y,j)},T.prototype.detach=function(y){if(!y){if(this.realtime.options.promises)return g.promisify(this,"detach",arguments);y=j}var z=this.connectionManager;if(!z.activeState()){y(z.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),y();break;case"detached":y();break;case"failed":y(new v.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(U){switch(this.event){case"detached":y();break;case"attached":case"suspended":case"failed":y(U.reason||z.getError()||new v.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":y(new v.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},T.prototype.detachImpl=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var z=f.default.fromValues({action:L.DETACH,channel:this.name});this.sendMessage(z,y||j)},T.prototype.subscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=T.processListenerArgs(y),P=U[0],K=U[1],Q=U[2];if(!Q&&this.realtime.options.promises)return g.promisify(this,"subscribe",[P,K]);if(this.state==="failed"){Q==null||Q(v.default.fromValues(this.invalidStateError()));return}return P&&typeof P=="object"&&!Array.isArray(P)?this._subscribeFilter(P,K):this.subscriptions.on(P,K),this.attach(Q||j)},T.prototype._subscribeFilter=function(y,z){var U=function(P){var K,Q,X,Y,D,I,F={name:P.name,refTimeserial:(Q=(K=P.extras)===null||K===void 0?void 0:K.ref)===null||Q===void 0?void 0:Q.timeserial,refType:(Y=(X=P.extras)===null||X===void 0?void 0:X.ref)===null||Y===void 0?void 0:Y.type,isRef:!!(!((I=(D=P.extras)===null||D===void 0?void 0:D.ref)===null||I===void 0)&&I.timeserial),clientId:P.clientId};Object.entries(y).find(function(W){var it=W[0],Z=W[1];return Z!==void 0?F[it]!==Z:!1})||z(P)};this._addFilteredSubscription(y,z,U),this.subscriptions.on(U)},T.prototype._addFilteredSubscription=function(y,z,U){var P;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(z)){var K=this.filteredSubscriptions.get(z);K.set(y,((P=K==null?void 0:K.get(y))===null||P===void 0?void 0:P.concat(U))||[U])}else this.filteredSubscriptions.set(z,new Map([[y,[U]]]))},T.prototype._getAndDeleteFilteredSubscriptions=function(y,z){var U=this;if(!this.filteredSubscriptions)return[];if(!z&&y)return Array.from(this.filteredSubscriptions.entries()).map(function(X){var Y,D=X[0],I=X[1],F=I.get(y);return I.delete(y),I.size===0&&((Y=U.filteredSubscriptions)===null||Y===void 0||Y.delete(D)),F}).reduce(function(X,Y){var D;return Y?(D=X).concat.apply(D,Y):X},[]);if(!z||!this.filteredSubscriptions.has(z))return[];var P=this.filteredSubscriptions.get(z);if(!y){var K=Array.from(P.values()).reduce(function(X,Y){return X.concat.apply(X,Y)},[]);return this.filteredSubscriptions.delete(z),K}var Q=P.get(y);return P.delete(y),Q||[]},T.prototype.unsubscribe=function(){for(var y=this,z,U=[],P=0;P<arguments.length;P++)U[P]=arguments[P];var K=T.processListenerArgs(U),Q=K[0],X=K[1];if(typeof Q=="object"&&!X||!((z=this.filteredSubscriptions)===null||z===void 0)&&z.has(X)){this._getAndDeleteFilteredSubscriptions(Q,X).forEach(function(Y){return y.subscriptions.off(Y)});return}this.subscriptions.off(Q,X)},T.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new v.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var y=this.connectionManager;if(!y.activeState())throw y.getError();var z=f.default.fromValues({action:L.SYNC,channel:this.name});this.syncChannelSerial&&(z.channelSerial=this.syncChannelSerial),y.send(z)},T.prototype.sendMessage=function(y,z){this.connectionManager.send(y,this.realtime.options.queueMessages,z)},T.prototype.sendPresence=function(y,z){var U=f.default.fromValues({action:L.PRESENCE,channel:this.name,presence:g.isArray(y)?N.default.fromValuesArray(y):[N.default.fromValues(y)]});this.sendMessage(U,z)},T.prototype.onMessage=function(y){(y.action===L.ATTACHED||y.action===L.MESSAGE||y.action===L.PRESENCE)&&this.setChannelSerial(y.channelSerial);var z,U=!1;switch(y.action){case L.ATTACHED:{this.properties.attachSerial=y.channelSerial,this._mode=y.getMode(),this.params=y.params||{};var P=y.decodeModesFromFlags();this.modes=P&&g.allToLowerCase(P)||void 0;var K=y.hasFlag("RESUMED"),Q=y.hasFlag("HAS_PRESENCE"),X=y.hasFlag("HAS_BACKLOG");if(this.state==="attached"){K||this.presence.onAttached(Q);var Y=new R.default(this.state,this.state,K,X,y.error);this._allChannelChanges.emit("update",Y),(!K||this.channelOptions.updateOnAttached)&&this.emit("update",Y)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",y.error,K,Q,X);break}case L.DETACHED:{var D=y.error?v.default.fromValues(y.error):new v.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",D):this.state==="attaching"?this.notifyState("suspended",D):this.requestState("attaching",D);break}case L.SYNC:if(U=!0,z=this.syncChannelSerial=y.channelSerial,!y.presence)break;case L.PRESENCE:{for(var I=y.presence,F=y.id,W=y.connectionId,it=y.timestamp,Z=this.channelOptions,at=void 0,rt=0;rt<I.length;rt++)try{at=I[rt],N.default.decode(at,Z),at.connectionId||(at.connectionId=W),at.timestamp||(at.timestamp=it),at.id||(at.id=F+":"+rt)}catch(wt){_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",wt.toString())}this.presence.setPresence(I,U,z);break}case L.MESSAGE:{if(this.state!=="attached"){_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+y.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var V=y.messages,J=V[0],$=V[V.length-1],F=y.id,W=y.connectionId,it=y.timestamp;if(J.extras&&J.extras.delta&&J.extras.delta.from!==this._lastPayload.messageId){var nt='Delta message decode failure - previous message not available for message "'+y.id+'" on this channel "'+this.name+'".';_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",nt),this._startDecodeFailureRecovery(new v.default(nt,40018,400));break}for(var rt=0;rt<V.length;rt++){var nt=V[rt];try{E.default.decode(nt,this._decodingContext)}catch(Lt){switch(_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",Lt.toString()),Lt.code){case 40018:this._startDecodeFailureRecovery(Lt);return;case 40019:case 40021:this.notifyState("failed",Lt);return}}nt.connectionId||(nt.connectionId=W),nt.timestamp||(nt.timestamp=it),nt.id||(nt.id=F+":"+rt)}this._lastPayload.messageId=$.id,this._lastPayload.protocolMessageChannelSerial=y.channelSerial,this.onEvent(V);break}case L.ERROR:{var dt=y.error;dt&&dt.code==80016?this.checkPendingState():this.notifyState("failed",v.default.fromValues(dt));break}default:_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+y.action+")"),this.connectionManager.abort(B.default.unknownChannelErr())}},T.prototype._startDecodeFailureRecovery=function(y){var z=this;this._lastPayload.decodeFailureRecoveryInProgress||(_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,y,function(){z._lastPayload.decodeFailureRecoveryInProgress=!1}))},T.prototype.onAttached=function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},T.prototype.notifyState=function(y,z,U,P,K){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+y),this.clearStateTimer(),g.arrIn(["detached","suspended","failed"],y)&&(this.properties.channelSerial=null),y!==this.state){this.presence.actOnChannelState(y,P,z),y==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),z&&(this.errorReason=z);var Q=new R.default(this.state,y,U,K,z),X=y==="failed"?_.default.LOG_ERROR:_.default.LOG_MAJOR;_.default.logAction(X,'Channel state for channel "'+this.name+'"',y+(z?"; reason: "+z:"")),y!=="attaching"&&y!=="suspended"&&(this.retryCount=0),y==="attached"&&this.onAttached(),y==="attached"?this._attachResume=!0:(y==="detaching"||y==="failed")&&(this._attachResume=!1),this.state=y,this._allChannelChanges.emit(y,Q),this.emit(y,Q)}},T.prototype.requestState=function(y,z){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+y),this.notifyState(y,z),this.checkPendingState()},T.prototype.checkPendingState=function(){var y=this.connectionManager.state;if(!(y.sendEvents||y.forceQueueEvents)){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},T.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var y=new v.default("Channel attach timed out",90007,408);this.notifyState("suspended",y);break}case"detaching":{var y=new v.default("Channel detach timed out",90007,408);this.notifyState("attached",y);break}default:this.checkPendingState();break}},T.prototype.startStateTimerIfNotRunning=function(){var y=this;this.stateTimer||(this.stateTimer=setTimeout(function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),y.stateTimer=null,y.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},T.prototype.clearStateTimer=function(){var y=this.stateTimer;y&&(clearTimeout(y),this.stateTimer=null)},T.prototype.startRetryTimer=function(){var y=this;if(!this.retryTimer){this.retryCount++;var z=g.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){y.state==="suspended"&&y.connectionManager.state.sendEvents&&(y.retryTimer=null,_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),y.requestState("attaching"))},z)}},T.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},T.prototype.getReleaseErr=function(){var y=this.state;return y==="initialized"||y==="detached"||y==="failed"?null:new v.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+y,90001,400)},T.prototype.setChannelSerial=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+y+"; previous = "+this.properties.channelSerial),y&&(this.properties.channelSerial=y)},T})(m.default);function O(A){var T=A||{};T.agent;var y=o.__rest(T,["agent"]);return y}i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=(function(){function f(h,g,m,_,C){this.previous=h,this.current=g,g==="attached"&&(this.resumed=m,this.hasBacklog=_),C&&(this.reason=C)}return f})();i.default=o}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.WordArray,m=h.Hasher,_=f.algo,C=[],E=_.SHA1=m.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(R,v){for(var N=this._hash.words,B=N[0],L=N[1],j=N[2],M=N[3],G=N[4],O=0;O<80;O++){if(O<16)C[O]=R[v+O]|0;else{var A=C[O-3]^C[O-8]^C[O-14]^C[O-16];C[O]=A<<1|A>>>31}var T=(B<<5|B>>>27)+G+C[O];O<20?T+=(L&j|~L&M)+1518500249:O<40?T+=(L^j^M)+1859775393:O<60?T+=(L&j|L&M|j&M)-1894007588:T+=(L^j^M)-899497514,G=M,M=j,j=L<<30|L>>>2,L=B,B=T}N[0]=N[0]+B|0,N[1]=N[1]+L|0,N[2]=N[2]+j|0,N[3]=N[3]+M|0,N[4]=N[4]+G|0},_doFinalize:function(){var R=this._data,v=R.words,N=this._nDataBytes*8,B=R.sigBytes*8;return v[B>>>5]|=128<<24-B%32,v[(B+64>>>9<<4)+14]=Math.floor(N/4294967296),v[(B+64>>>9<<4)+15]=N,R.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var R=m.clone.call(this);return R._hash=this._hash.clone(),R}});f.SHA1=m._createHelper(E),f.HmacSHA1=m._createHmacHelper(E)})(),o.SHA1})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});function o(O){if(O===void 0)return"undefined";var A,T;if(O instanceof ArrayBuffer?(T="ArrayBuffer",A=new DataView(O)):O instanceof DataView&&(T="DataView",A=O),!A)return JSON.stringify(O);for(var y=[],z=0;z<O.byteLength;z++){if(z>20){y.push("...");break}var U=A.getUint8(z).toString(16);U.length===1&&(U="0"+U),y.push(U)}return"<"+T+" "+y.join(" ")+">"}function f(O,A,T){for(var y=0,z=T.length;y<z;y++){var U=T.charCodeAt(y);if(U<128){O.setUint8(A++,U>>>0&127|0);continue}if(U<2048){O.setUint8(A++,U>>>6&31|192),O.setUint8(A++,U>>>0&63|128);continue}if(U<65536){O.setUint8(A++,U>>>12&15|224),O.setUint8(A++,U>>>6&63|128),O.setUint8(A++,U>>>0&63|128);continue}if(U<1114112){O.setUint8(A++,U>>>18&7|240),O.setUint8(A++,U>>>12&63|128),O.setUint8(A++,U>>>6&63|128),O.setUint8(A++,U>>>0&63|128);continue}throw new Error("bad codepoint "+U)}}function h(O,A,T){for(var y="",z=A,U=A+T;z<U;z++){var P=O.getUint8(z);if((P&128)===0){y+=String.fromCharCode(P);continue}if((P&224)===192){y+=String.fromCharCode((P&15)<<6|O.getUint8(++z)&63);continue}if((P&240)===224){y+=String.fromCharCode((P&15)<<12|(O.getUint8(++z)&63)<<6|(O.getUint8(++z)&63)<<0);continue}if((P&248)===240){y+=String.fromCharCode((P&7)<<18|(O.getUint8(++z)&63)<<12|(O.getUint8(++z)&63)<<6|(O.getUint8(++z)&63)<<0);continue}throw new Error("Invalid byte "+P.toString(16))}return y}function g(O){for(var A=0,T=0,y=O.length;T<y;T++){var z=O.charCodeAt(T);if(z<128){A+=1;continue}if(z<2048){A+=2;continue}if(z<65536){A+=3;continue}if(z<1114112){A+=4;continue}throw new Error("bad codepoint "+z)}return A}function m(O,A){var T=G(O,A);if(T!==0){var y=new ArrayBuffer(T),z=new DataView(y);return M(O,z,0,A),y}}var _=65536*65536,C=1/_;function E(O,A){return A=A||0,O.getInt32(A)*_+O.getUint32(A+4)}function R(O,A){return A=A||0,O.getUint32(A)*_+O.getUint32(A+4)}function v(O,A,T){T<9223372036854776e3?(O.setInt32(A,Math.floor(T*C)),O.setInt32(A+4,T&-1)):(O.setUint32(A,2147483647),O.setUint32(A+4,2147483647))}function N(O,A,T){T<18446744073709552e3?(O.setUint32(A,Math.floor(T*C)),O.setInt32(A+4,T&-1)):(O.setUint32(A,4294967295),O.setUint32(A+4,4294967295))}var B=(function(){function O(A,T){var y=this;this.map=function(z){for(var U={},P=0;P<z;P++){var K=y.parse();U[K]=y.parse()}return U},this.bin=function(z){var U=new ArrayBuffer(z);return new Uint8Array(U).set(new Uint8Array(y.view.buffer,y.offset,z),0),y.offset+=z,U},this.buf=this.bin,this.str=function(z){var U=h(y.view,y.offset,z);return y.offset+=z,U},this.array=function(z){for(var U=new Array(z),P=0;P<z;P++)U[P]=y.parse();return U},this.ext=function(z){return y.offset+=z,{type:y.view.getInt8(y.offset),data:y.buf(z)}},this.parse=function(){var z=y.view.getUint8(y.offset),U,P;if((z&128)===0)return y.offset++,z;if((z&240)===128)return P=z&15,y.offset++,y.map(P);if((z&240)===144)return P=z&15,y.offset++,y.array(P);if((z&224)===160)return P=z&31,y.offset++,y.str(P);if((z&224)===224)return U=y.view.getInt8(y.offset),y.offset++,U;switch(z){case 192:return y.offset++,null;case 193:y.offset++;return;case 194:return y.offset++,!1;case 195:return y.offset++,!0;case 196:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.bin(P);case 197:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.bin(P);case 198:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.bin(P);case 199:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.ext(P);case 200:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.ext(P);case 201:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.ext(P);case 202:return U=y.view.getFloat32(y.offset+1),y.offset+=5,U;case 203:return U=y.view.getFloat64(y.offset+1),y.offset+=9,U;case 204:return U=y.view.getUint8(y.offset+1),y.offset+=2,U;case 205:return U=y.view.getUint16(y.offset+1),y.offset+=3,U;case 206:return U=y.view.getUint32(y.offset+1),y.offset+=5,U;case 207:return U=R(y.view,y.offset+1),y.offset+=9,U;case 208:return U=y.view.getInt8(y.offset+1),y.offset+=2,U;case 209:return U=y.view.getInt16(y.offset+1),y.offset+=3,U;case 210:return U=y.view.getInt32(y.offset+1),y.offset+=5,U;case 211:return U=E(y.view,y.offset+1),y.offset+=9,U;case 212:return P=1,y.offset++,y.ext(P);case 213:return P=2,y.offset++,y.ext(P);case 214:return P=4,y.offset++,y.ext(P);case 215:return P=8,y.offset++,y.ext(P);case 216:return P=16,y.offset++,y.ext(P);case 217:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.str(P);case 218:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.str(P);case 219:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.str(P);case 220:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.array(P);case 221:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.array(P);case 222:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.map(P);case 223:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.map(P)}throw new Error("Unknown type 0x"+z.toString(16))},this.offset=T||0,this.view=A}return O})();function L(O){var A=new DataView(O),T=new B(A),y=T.parse();if(T.offset!==O.byteLength)throw new Error(O.byteLength-T.offset+" trailing bytes");return y}function j(O,A){return Object.keys(O).filter(function(T){var y=O[T],z=typeof y;return(!A||y!=null)&&(z!=="function"||!!y.toJSON)})}function M(O,A,T,y){var z=typeof O;if(typeof O=="string"){var U=g(O);if(U<32)return A.setUint8(T,U|160),f(A,T+1,O),1+U;if(U<256)return A.setUint8(T,217),A.setUint8(T+1,U),f(A,T+2,O),2+U;if(U<65536)return A.setUint8(T,218),A.setUint16(T+1,U),f(A,T+3,O),3+U;if(U<4294967296)return A.setUint8(T,219),A.setUint32(T+1,U),f(A,T+5,O),5+U}if(ArrayBuffer.isView&&ArrayBuffer.isView(O)&&(O=O.buffer),O instanceof ArrayBuffer){var P=O.byteLength;if(P<256)return A.setUint8(T,196),A.setUint8(T+1,P),new Uint8Array(A.buffer).set(new Uint8Array(O),T+2),2+P;if(P<65536)return A.setUint8(T,197),A.setUint16(T+1,P),new Uint8Array(A.buffer).set(new Uint8Array(O),T+3),3+P;if(P<4294967296)return A.setUint8(T,198),A.setUint32(T+1,P),new Uint8Array(A.buffer).set(new Uint8Array(O),T+5),5+P}if(typeof O=="number"){if(Math.floor(O)!==O)return A.setUint8(T,203),A.setFloat64(T+1,O),9;if(O>=0){if(O<128)return A.setUint8(T,O),1;if(O<256)return A.setUint8(T,204),A.setUint8(T+1,O),2;if(O<65536)return A.setUint8(T,205),A.setUint16(T+1,O),3;if(O<4294967296)return A.setUint8(T,206),A.setUint32(T+1,O),5;if(O<18446744073709552e3)return A.setUint8(T,207),N(A,T+1,O),9;throw new Error("Number too big 0x"+O.toString(16))}if(O>=-32)return A.setInt8(T,O),1;if(O>=-128)return A.setUint8(T,208),A.setInt8(T+1,O),2;if(O>=-32768)return A.setUint8(T,209),A.setInt16(T+1,O),3;if(O>=-2147483648)return A.setUint8(T,210),A.setInt32(T+1,O),5;if(O>=-9223372036854776e3)return A.setUint8(T,211),v(A,T+1,O),9;throw new Error("Number too small -0x"+(-O).toString(16).substr(1))}if(z==="undefined")return y?0:(A.setUint8(T,212),A.setUint8(T+1,0),A.setUint8(T+2,0),3);if(O===null)return y?0:(A.setUint8(T,192),1);if(z==="boolean")return A.setUint8(T,O?195:194),1;if(typeof O.toJSON=="function")return M(O.toJSON(),A,T,y);if(z==="object"){var K,Q=0,X=void 0,Y=Array.isArray(O);if(Y?K=O.length:(X=j(O,y),K=X.length),K<16?(A.setUint8(T,K|(Y?144:128)),Q=1):K<65536?(A.setUint8(T,Y?220:222),A.setUint16(T+1,K),Q=3):K<4294967296&&(A.setUint8(T,Y?221:223),A.setUint32(T+1,K),Q=5),Y)for(var D=0;D<K;D++)Q+=M(O[D],A,T+Q,y);else if(X)for(var D=0;D<K;D++){var I=X[D];Q+=M(I,A,T+Q),Q+=M(O[I],A,T+Q,y)}return Q}if(z==="function")return 0;throw new Error("Unknown type "+z)}function G(O,A){var T=typeof O;if(T==="string"){var y=g(O);if(y<32)return 1+y;if(y<256)return 2+y;if(y<65536)return 3+y;if(y<4294967296)return 5+y}if(ArrayBuffer.isView&&ArrayBuffer.isView(O)&&(O=O.buffer),O instanceof ArrayBuffer){var z=O.byteLength;if(z<256)return 2+z;if(z<65536)return 3+z;if(z<4294967296)return 5+z}if(typeof O=="number"){if(Math.floor(O)!==O)return 9;if(O>=0){if(O<128)return 1;if(O<256)return 2;if(O<65536)return 3;if(O<4294967296)return 5;if(O<18446744073709552e3)return 9;throw new Error("Number too big 0x"+O.toString(16))}if(O>=-32)return 1;if(O>=-128)return 2;if(O>=-32768)return 3;if(O>=-2147483648)return 5;if(O>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+O.toString(16).substr(1))}if(T==="boolean")return 1;if(O===null)return A?0:1;if(O===void 0)return A?0:3;if(typeof O.toJSON=="function")return G(O.toJSON(),A);if(T==="object"){var U,P=0;if(Array.isArray(O)){U=O.length;for(var K=0;K<U;K++)P+=G(O[K],A)}else{var Q=j(O,A);U=Q.length;for(var K=0;K<U;K++){var X=Q[K];P+=G(X)+G(O[X],A)}}if(U<16)return 1+P;if(U<65536)return 3+P;if(U<4294967296)return 5+P;throw new Error("Array or object too long 0x"+U.toString(16))}if(T==="function")return 0;throw new Error("Unknown type "+T)}i.default={encode:m,decode:L,inspect:o,utf8Write:f,utf8Read:h,utf8ByteCount:g}}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(30)),h=o.__importDefault(r(50)),g=o.__importDefault(r(3)),m=o.__importDefault(r(4)),_=o.__importDefault(r(55)),C=o.__importDefault(r(57)),E=o.__importDefault(r(62)),R=o.__importDefault(r(64)),v=o.__importDefault(r(68)),N=o.__importDefault(r(2)),B=r(8),L=o.__importDefault(r(65)),j=o.__importDefault(r(66)),M=o.__importDefault(r(41)),G=(0,C.default)(R.default,_.default);g.default.Crypto=G,g.default.BufferUtils=_.default,g.default.Http=E.default,g.default.Config=R.default,g.default.Transports=v.default,g.default.WebStorage=L.default,f.default.Crypto=G,h.default.Crypto=G,N.default.initLogHandlers(),g.default.Defaults=(0,B.getDefaults)(j.default),g.default.Config.agent&&(g.default.Defaults.agent+=" "+g.default.Config.agent),g.default.Config.noUpgrade&&(g.default.Defaults.upgradeTransports=[]),i.default={ErrorInfo:m.default,Rest:f.default,Realtime:h.default,msgpack:M.default}}),(function(n){n.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')}),(function(n,i){}),(function(n,i,r){(function(o,f){n.exports=f(r(6),r(32),r(25))})(this,function(o){return o.HmacSHA256})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(47)),g=o.__importDefault(r(15)),m=o.__importDefault(r(20)),_=o.__importDefault(r(4)),C=o.__importDefault(r(48)),E=function(){},R=(function(){function L(j){this.rest=j,this.admin=new v(j)}return L})(),v=(function(){function L(j){this.rest=j,this.deviceRegistrations=new N(j),this.channelSubscriptions=new B(j)}return L.prototype.publish=function(j,M,G){var O=this.rest,A=O.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(O.options,A),y={},z=f.mixin({recipient:j},M);if(typeof G!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);G=E}O.options.headers&&f.mixin(T,O.options.headers),O.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var U=f.encodeBody(z,A);g.default.post(O,"/push/publish",U,T,y,null,function(P){return G(P)})},L})(),N=(function(){function L(j){this.rest=j}return L.prototype.save=function(j,M){var G=this.rest,O=h.default.fromValues(j),A=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(G.options,A),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),G.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var z=f.encodeBody(O,A);g.default.put(G,"/push/deviceRegistrations/"+encodeURIComponent(j.id),z,T,y,null,function(U,P,K,Q){M(U,U?void 0:h.default.fromResponseBody(P,Q?void 0:A))})},L.prototype.get=function(j,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(G.options,O),T=j.id||j;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"get",arguments);M=E}if(typeof T!="string"||!T.length){M(new _.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&f.mixin(A,G.options.headers),g.default.get(G,"/push/deviceRegistrations/"+encodeURIComponent(T),A,{},null,function(y,z,U,P){M(y,y?void 0:h.default.fromResponseBody(z,P?void 0:O))})},L.prototype.list=function(j,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),new m.default(G,"/push/deviceRegistrations",T,A,function(y,z,U){return h.default.fromResponseBody(y,U?void 0:O)}).get(j,M)},L.prototype.remove=function(j,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(G.options,O),T={},y=j.id||j;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"remove",arguments);M=E}if(typeof y!="string"||!y.length){M(new _.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&f.mixin(A,G.options.headers),G.options.pushFullWait&&f.mixin(T,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations/"+encodeURIComponent(y),A,T,null,function(z){return M(z)})},L.prototype.removeWhere=function(j,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}G.options.headers&&f.mixin(A,G.options.headers),G.options.pushFullWait&&f.mixin(j,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations",A,j,null,function(T){return M(T)})},L})(),B=(function(){function L(j){this.remove=L.prototype.removeWhere,this.rest=j}return L.prototype.save=function(j,M){var G=this.rest,O=C.default.fromValues(j),A=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(G.options,A),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),G.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var z=f.encodeBody(O,A);g.default.post(G,"/push/channelSubscriptions",z,T,y,null,function(U,P,K,Q){M(U,!U&&C.default.fromResponseBody(P,Q?void 0:A))})},L.prototype.list=function(j,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),new m.default(G,"/push/channelSubscriptions",T,A,function(y,z,U){return C.default.fromResponseBody(y,U?void 0:O)}).get(j,M)},L.prototype.removeWhere=function(j,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}G.options.headers&&f.mixin(A,G.options.headers),G.options.pushFullWait&&f.mixin(j,{fullWait:"true"}),g.default.delete(G,"/push/channelSubscriptions",A,j,null,function(T){return M(T)})},L.prototype.listChannels=function(j,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"listChannels",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),G.options.pushFullWait&&f.mixin(j,{fullWait:"true"}),new m.default(G,"/push/channels",T,A,function(y,z,U){for(var P=!U&&O?f.decodeBody(y,O):y,K=0;K<P.length;K++)P[K]=String(P[K]);return P}).get(j,M)},L})();i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(4)),g;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(g||(g={}));var m;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(m||(m={}));var _=(function(){function C(){}return C.prototype.toJSON=function(){var E,R,v;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(R=this.push)===null||R===void 0?void 0:R.state,error:(v=this.push)===null||v===void 0?void 0:v.error}}},C.prototype.toString=function(){var E,R,v,N,B="[DeviceDetails";return this.id&&(B+="; id="+this.id),this.platform&&(B+="; platform="+this.platform),this.formFactor&&(B+="; formFactor="+this.formFactor),this.clientId&&(B+="; clientId="+this.clientId),this.metadata&&(B+="; metadata="+this.metadata),this.deviceIdentityToken&&(B+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(B+="; push.recipient="+JSON.stringify(this.push.recipient)),!((R=this.push)===null||R===void 0)&&R.state&&(B+="; push.state="+this.push.state),!((v=this.push)===null||v===void 0)&&v.error&&(B+="; push.error="+JSON.stringify(this.push.error)),!((N=this.push)===null||N===void 0)&&N.metadata&&(B+="; push.metadata="+this.push.metadata),B+="]",B},C.fromResponseBody=function(E,R){return R&&(E=f.decodeBody(E,R)),f.isArray(E)?C.fromValuesArray(E):C.fromValues(E)},C.fromValues=function(E){return E.error=E.error&&h.default.fromValues(E.error),Object.assign(new C,E)},C.fromValuesArray=function(E){for(var R=E.length,v=new Array(R),N=0;N<R;N++)v[N]=C.fromValues(E[N]);return v},C.toRequestBody=f.encodeBody,C})();i.default=_}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=(function(){function g(){}return g.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},g.prototype.toString=function(){var m="[PushChannelSubscription";return this.channel&&(m+="; channel="+this.channel),this.deviceId&&(m+="; deviceId="+this.deviceId),this.clientId&&(m+="; clientId="+this.clientId),m+="]",m},g.fromResponseBody=function(m,_){return _&&(m=f.decodeBody(m,_)),f.isArray(m)?g.fromValuesArray(m):g.fromValues(m)},g.fromValues=function(m){return Object.assign(new g,m)},g.fromValuesArray=function(m){for(var _=m.length,C=new Array(_),E=0;E<_;E++)C[E]=g.fromValues(m[E]);return C},g.toRequestBody=f.encodeBody,g})();i.default=h}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=(function(){function G(O){this.count=O&&O.count||0,this.data=O&&O.data||0,this.uncompressedData=O&&O.uncompressedData||0,this.failed=O&&O.failed||0,this.refused=O&&O.refused||0}return G})(),g=(function(G){o.__extends(O,G);function O(A){var T=G.call(this,A)||this;return A&&A.category&&(T.category={},f.forInOwnNonNullProperties(A.category,function(y){T.category[y]=new h(A.category[y])})),T}return O})(h),m=(function(){function G(O){this.peak=O&&O.peak||0,this.min=O&&O.min||0,this.mean=O&&O.mean||0,this.opened=O&&O.opened||0,this.refused=O&&O.refused||0}return G})(),_=(function(){function G(O){this.succeeded=O&&O.succeeded||0,this.failed=O&&O.failed||0,this.refused=O&&O.refused||0}return G})(),C=(function(){function G(O){this.plain=new m(O&&O.plain),this.tls=new m(O&&O.tls),this.all=new m(O&&O.all)}return G})(),E=(function(){function G(O){this.messages=new g(O&&O.messages),this.presence=new g(O&&O.presence),this.all=new g(O&&O.all)}return G})(),R=(function(){function G(O){this.realtime=new E(O&&O.realtime),this.rest=new E(O&&O.rest),this.webhook=new E(O&&O.webhook),this.sharedQueue=new E(O&&O.sharedQueue),this.externalQueue=new E(O&&O.externalQueue),this.httpEvent=new E(O&&O.httpEvent),this.push=new E(O&&O.push),this.all=new E(O&&O.all)}return G})(),v=(function(){function G(O){this.all=new E(O&&O.all),this.inbound=new R(O&&O.inbound),this.outbound=new R(O&&O.outbound)}return G})(),N=(function(){function G(O){this.all=new E(O&&O.all),this.producerPaid=new v(O&&O.producerPaid),this.consumerPaid=new v(O&&O.consumerPaid)}return G})(),B=(function(){function G(O){this.messages=O&&O.messages||0;var A=O&&O.notifications;this.notifications={invalid:A&&A.invalid||0,attempted:A&&A.attempted||0,successful:A&&A.successful||0,failed:A&&A.failed||0},this.directPublishes=O&&O.directPublishes||0}return G})(),L=(function(){function G(O){this.succeeded=O&&O.succeeded||0,this.skipped=O&&O.skipped||0,this.failed=O&&O.failed||0}return G})(),j=(function(){function G(O){var A=this;this.delta=void 0,O&&O.delta&&(this.delta={},f.forInOwnNonNullProperties(O.delta,function(T){A.delta[T]=new L(O.delta[T])}))}return G})(),M=(function(G){o.__extends(O,G);function O(A){var T=G.call(this,A)||this;return T.persisted=new E(A&&A.persisted),T.connections=new C(A&&A.connections),T.channels=new m(A&&A.channels),T.apiRequests=new _(A&&A.apiRequests),T.tokenRequests=new _(A&&A.tokenRequests),T.xchgProducer=new N(A&&A.xchgProducer),T.xchgConsumer=new N(A&&A.xchgConsumer),T.push=new B(A&&A.pushStats),T.processed=new j(A&&A.processed),T.inProgress=A&&A.inProgress||void 0,T.unit=A&&A.unit||void 0,T.intervalId=A&&A.intervalId||void 0,T}return O.fromValues=function(A){return new O(A)},O})(v);i.default=M}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(30)),g=o.__importDefault(r(7)),m=o.__importDefault(r(2)),_=o.__importDefault(r(51)),C=o.__importDefault(r(38)),E=o.__importDefault(r(8)),R=o.__importDefault(r(4)),v=o.__importDefault(r(10)),N=o.__importDefault(r(35)),B=o.__importDefault(r(3)),L=o.__importDefault(r(9)),j=(function(G){o.__extends(O,G);function O(A){var T=G.call(this,A)||this;return m.default.logAction(m.default.LOG_MINOR,"Realtime()",""),T.connection=new _.default(T,T.options),T.channels=new M(T),A.autoConnect!==!1&&T.connect(),T}return O.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},O.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},O.Promise=function(A){return A=E.default.objectifyOptions(A),A.promises=!0,new O(A)},O.Callbacks=O,O.Utils=f,O.ConnectionManager=N.default,O.Platform=B.default,O.ProtocolMessage=v.default,O.Message=L.default,O})(h.default),M=(function(G){o.__extends(O,G);function O(A){var T=G.call(this)||this;return T.realtime=A,T.all=Object.create(null),A.connection.connectionManager.on("transport.active",function(){T.onTransportActive()}),T}return O.prototype.channelSerials=function(){for(var A={},T=0,y=f.keysArray(this.all,!0);T<y.length;T++){var z=y[T],U=this.all[z];U.properties.channelSerial&&(A[z]=U.properties.channelSerial)}return A},O.prototype.recoverChannels=function(A){for(var T=0,y=f.keysArray(A,!0);T<y.length;T++){var z=y[T],U=this.get(z);U.properties.channelSerial=A[z]}},O.prototype.onChannelMessage=function(A){var T=A.channel;if(T===void 0){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+A.action);return}var y=this.all[T];if(!y){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+T);return}y.onMessage(A)},O.prototype.onTransportActive=function(){for(var A in this.all){var T=this.all[A];T.state==="attaching"||T.state==="detaching"?T.checkPendingState():T.state==="suspended"?T._attach(!1,null):T.state==="attached"&&T.requestState("attaching")}},O.prototype.propogateConnectionInterruption=function(A,T){var y={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},z=["attaching","attached","detaching","suspended"],U=y[A];for(var P in this.all){var K=this.all[P];f.arrIn(z,K.state)&&K.notifyState(U,T)}},O.prototype.get=function(A,T){A=String(A);var y=this.all[A];if(!y)y=this.all[A]=new C.default(this.realtime,A,T);else if(T){if(y._shouldReattachToSetOptions(T,y.channelOptions))throw new R.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);y.setOptions(T)}return y},O.prototype.getDerived=function(A,T,y){if(T.filter){var z=f.toBase64(T.filter),U=f.matchDerivedChannel(A);A="[filter=".concat(z).concat(U.qualifierParam,"]").concat(U.channelName)}return this.get(A,y)},O.prototype.release=function(A){A=String(A);var T=this.all[A];if(T){var y=T.getReleaseErr();if(y)throw y;delete this.all[A]}},O})(g.default);i.default=j}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(7)),g=o.__importDefault(r(35)),m=o.__importDefault(r(2)),_=o.__importDefault(r(37)),C=o.__importDefault(r(3));function E(){}var R=(function(v){o.__extends(N,v);function N(B,L){var j=v.call(this)||this;return j.whenState=(function(M,G){return h.default.prototype.whenState.call(j,M,j.state,G,new _.default(void 0,M))}),j.ably=B,j.connectionManager=new g.default(B,L),j.state=j.connectionManager.state.state,j.key=void 0,j.id=void 0,j.errorReason=null,j.connectionManager.on("connectionstate",function(M){var G=j.state=M.current;C.default.Config.nextTick(function(){j.emit(G,M)})}),j.connectionManager.on("update",function(M){C.default.Config.nextTick(function(){j.emit("update",M)})}),j}return N.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},N.prototype.ping=function(B){if(m.default.logAction(m.default.LOG_MINOR,"Connection.ping()",""),!B){if(this.ably.options.promises)return f.promisify(this,"ping",arguments);B=E}this.connectionManager.ping(null,B)},N.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(N.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),N.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},N})(h.default);i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.PendingMessage=void 0;var o=r(0),f=o.__importDefault(r(10)),h=o.__importStar(r(1)),g=o.__importDefault(r(7)),m=o.__importDefault(r(2)),_=o.__importDefault(r(36)),C=o.__importDefault(r(4)),E=f.default.Action,R=(function(){function N(B,L){this.message=B,this.callback=L,this.merged=!1;var j=B.action;this.sendAttempted=!1,this.ackRequired=j==E.MESSAGE||j==E.PRESENCE}return N})();i.PendingMessage=R;var v=(function(N){o.__extends(B,N);function B(L){var j=N.call(this)||this;return j.transport=L,j.messageQueue=new _.default,L.on("ack",function(M,G){j.onAck(M,G)}),L.on("nack",function(M,G,O){j.onNack(M,G,O)}),j}return B.prototype.onAck=function(L,j){m.default.logAction(m.default.LOG_MICRO,"Protocol.onAck()","serial = "+L+"; count = "+j),this.messageQueue.completeMessages(L,j)},B.prototype.onNack=function(L,j,M){m.default.logAction(m.default.LOG_ERROR,"Protocol.onNack()","serial = "+L+"; count = "+j+"; err = "+h.inspectError(M)),M||(M=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(L,j,M)},B.prototype.onceIdle=function(L){var j=this.messageQueue;if(j.count()===0){L();return}j.once("idle",L)},B.prototype.send=function(L){L.ackRequired&&this.messageQueue.push(L),m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Protocol.send()","sending msg; "+f.default.stringify(L.message)),L.sendAttempted=!0,this.transport.send(L.message)},B.prototype.getTransport=function(){return this.transport},B.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},B.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},B.prototype.finish=function(){var L=this.transport;this.onceIdle(function(){L.disconnect()})},B})(g.default);i.default=v}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(3)),h=o.__importStar(r(1)),g=o.__importDefault(r(26)),m=o.__importDefault(r(8)),_=o.__importDefault(r(2)),C=o.__importDefault(r(10)),E=o.__importDefault(r(4)),R="web_socket";function v(L){return!!L.on}var N=(function(L){o.__extends(j,L);function j(M,G,O){var A=L.call(this,M,G,O)||this;return A.shortName=R,O.heartbeats=f.default.Config.useProtocolHeartbeats,A.wsHost=m.default.getHost(O.options,O.host,!0),A}return j.isAvailable=function(){return!!f.default.Config.WebSocket},j.prototype.createWebSocket=function(M,G){return this.uri=M+h.toQueryString(G),new f.default.Config.WebSocket(this.uri)},j.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},j.prototype.connect=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),g.default.prototype.connect.call(this);var M=this,G=this.params,O=G.options,A=O.tls?"wss://":"ws://",T=A+this.wsHost+":"+m.default.getPort(O)+"/";_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+T),this.auth.getAuthParams(function(y,z){if(!M.isDisposed){var U="";for(var P in z)U+=" "+P+": "+z[P]+";";if(_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+U+" err: "+y),y){M.disconnect(y);return}var K=G.getConnectParams(z);try{var Q=M.wsConnection=M.createWebSocket(T,K);Q.binaryType=f.default.Config.binaryType,Q.onopen=function(){M.onWsOpen()},Q.onclose=function(X){M.onWsClose(X)},Q.onmessage=function(X){M.onWsData(X.data)},Q.onerror=function(X){M.onWsError(X)},v(Q)&&Q.on("ping",function(){M.onActivity()})}catch(X){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(X.stack||X.message)),M.disconnect(X)}}})},j.prototype.send=function(M){var G=this.wsConnection;if(!G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{G.send(C.default.serialize(M,this.params.format))}catch(A){var O="Exception from ws connection when trying to send: "+h.inspectError(A);_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()",O),this.finish("disconnected",new E.default(O,5e4,500))}},j.prototype.onWsData=function(M){_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+M.length+"; type = "+typeof M);try{this.onProtocolMessage(C.default.deserialize(M,this.format))}catch(G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+G.stack)}},j.prototype.onWsOpen=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},j.prototype.onWsClose=function(M){var G,O;if(typeof M=="object"?(O=M.code,G=M.wasClean||O===1e3):(O=M,G=O==1e3),delete this.wsConnection,G){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var A=new E.default("Websocket closed",80003,400);this.finish("disconnected",A)}else{var T="Unclean disconnection of WebSocket ; code = "+O,A=new E.default(T,80003,400);_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()",T),this.finish("disconnected",A)}this.emit("disposed")},j.prototype.onWsError=function(M){var G=this;_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+M.message),f.default.Config.nextTick(function(){G.disconnect(Error(M.message))})},j.prototype.dispose=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var M=this.wsConnection;M&&(M.onmessage=function(){},delete this.wsConnection,f.default.Config.nextTick(function(){if(_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!M)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");M.close()}))},j})(g.default);function B(L){return N.isAvailable()&&(L.supportedTransports[R]=N),N}i.default=B}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(34)),g=o.__importDefault(r(7)),m=o.__importDefault(r(2)),_=o.__importDefault(r(16)),C=o.__importStar(r(4)),E=o.__importDefault(r(38)),R=o.__importDefault(r(24)),v=o.__importDefault(r(39)),N=function(){};function B(A){return A.channel.realtime.auth.clientId}function L(A){var T=A.channel.realtime,y=T.auth.clientId;return(!y||y==="*")&&T.connection.state==="connected"}function j(A,T,y){switch(A.state){case"attached":case"suspended":y();break;case"initialized":case"detached":case"detaching":case"attaching":A.attach(function(z){z?T(z):y()});break;default:T(C.default.fromValues(A.invalidStateError()))}}function M(A,T){if(A.isSynthesized()||T.isSynthesized())return A.timestamp>=T.timestamp;var y=A.parseId(),z=T.parseId();return y.msgSerial===z.msgSerial?y.index>z.index:y.msgSerial>z.msgSerial}var G=(function(A){o.__extends(T,A);function T(y){var z=A.call(this,y)||this;return z.channel=y,z.syncComplete=!1,z.members=new O(z,function(U){return U.clientId+":"+U.connectionId}),z._myMembers=new O(z,function(U){return U.clientId}),z.subscriptions=new g.default,z.pendingPresence=[],z}return T.prototype.enter=function(y,z){if(L(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"enter",z)},T.prototype.update=function(y,z){if(L(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"update",z)},T.prototype.enterClient=function(y,z,U){return this._enterOrUpdateClient(void 0,y,z,"enter",U)},T.prototype.updateClient=function(y,z,U){return this._enterOrUpdateClient(void 0,y,z,"update",U)},T.prototype._enterOrUpdateClient=function(y,z,U,P,K){var Q=this;if(!K)if(typeof U=="function")K=U,U=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"_enterOrUpdateClient",[y,z,U,P]);K=N}var X=this.channel;if(!X.connectionManager.activeState()){K(X.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence."+P+"Client()","channel = "+X.name+", id = "+y+", client = "+(z||"(implicit) "+B(this)));var Y=_.default.fromData(U);Y.action=P,y&&(Y.id=y),z&&(Y.clientId=z),_.default.encode(Y,X.channelOptions,function(D){if(D){K(D);return}switch(X.state){case"attached":X.sendPresence(Y,K);break;case"initialized":case"detached":X.attach();case"attaching":Q.pendingPresence.push({presence:Y,callback:K});break;default:D=new C.PartialErrorInfo("Unable to "+P+" presence channel while in "+X.state+" state",90001),D.code=90001,K(D)}})},T.prototype.leave=function(y,z){if(L(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,y,z)},T.prototype.leaveClient=function(y,z,U){if(!U)if(typeof z=="function")U=z,z=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"leaveClient",[y,z]);U=N}var P=this.channel;if(!P.connectionManager.activeState()){U==null||U(P.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+y);var K=_.default.fromData(z);switch(K.action="leave",y&&(K.clientId=y),P.state){case"attached":P.sendPresence(K,U);break;case"attaching":this.pendingPresence.push({presence:K,callback:U});break;case"initialized":case"failed":{var Q=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);U==null||U(Q);break}default:U==null||U(P.invalidStateError())}},T.prototype.get=function(y,z){var U=this,P=Array.prototype.slice.call(arguments);P.length==1&&typeof P[0]=="function"&&P.unshift(null),y=P[0],z=P[1];var K=!y||("waitForSync"in y?y.waitForSync:!0);if(!z){if(this.channel.realtime.options.promises)return f.promisify(this,"get",P);z=N}function Q(X){z(null,y?X.list(y):X.values())}if(this.channel.state==="suspended"){K?z(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):Q(this.members);return}j(this.channel,z,function(){var X=U.members;K?X.waitSync(function(){Q(X)}):Q(X)})},T.prototype.history=function(y,z){if(m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),z===void 0)if(typeof y=="function")z=y,y=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"history",arguments);z=N}y&&y.untilAttach&&(this.channel.state==="attached"?(delete y.untilAttach,y.from_serial=this.channel.properties.attachSerial):z(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),h.default.prototype._history.call(this,y,z)},T.prototype.setPresence=function(y,z,U){m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+y.length+" participants; syncChannelSerial = "+U);var P,K,Q=this.members,X=this._myMembers,Y=[],D=this.channel.connectionManager.connectionId;z&&(this.members.startSync(),U&&(K=U.match(/^[\w-]+:(.*)$/))&&(P=K[1]));for(var I=0;I<y.length;I++){var F=_.default.fromValues(y[I]);switch(F.action){case"leave":Q.remove(F)&&Y.push(F),F.connectionId===D&&!F.isSynthesized()&&X.remove(F);break;case"enter":case"present":case"update":Q.put(F)&&Y.push(F),F.connectionId===D&&X.put(F);break}}z&&!P&&(Q.endSync(),this.channel.syncChannelSerial=null);for(var I=0;I<Y.length;I++){var F=Y[I];this.subscriptions.emit(F.action,F)}},T.prototype.onAttached=function(y){m.default.logAction(m.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+y),y?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var z=this.pendingPresence,U=z.length;if(U){this.pendingPresence=[];var P=[],K=R.default.create();m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+U+" queued presence messages");for(var Q=0;Q<U;Q++){var X=z[Q];P.push(X.presence),K.push(X.callback)}this.channel.sendPresence(P,K)}},T.prototype.actOnChannelState=function(y,z,U){switch(y){case"attached":this.onAttached(z);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(U);break}},T.prototype.failPendingPresence=function(y){if(this.pendingPresence.length){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+f.inspectError(y));for(var z=0;z<this.pendingPresence.length;z++)try{this.pendingPresence[z].callback(y)}catch{}this.pendingPresence=[]}},T.prototype._clearMyMembers=function(){this._myMembers.clear()},T.prototype._ensureMyMembersPresent=function(){var y=this,z=this._myMembers,U=function(Q){if(Q){var X="Presence auto-re-enter failed: "+Q.toString(),Y=new C.default(X,91004,400);m.default.logAction(m.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",X);var D=new v.default(y.channel.state,y.channel.state,!0,!1,Y);y.channel.emit("update",D)}};for(var P in z.map){var K=z.map[P];m.default.logAction(m.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+K.clientId+'" into the presence set'),this._enterOrUpdateClient(K.id,K.clientId,K.data,"enter",U)}},T.prototype._synthesizeLeaves=function(y){var z=this.subscriptions;f.arrForEach(y,function(U){var P=_.default.fromValues({action:"leave",connectionId:U.connectionId,clientId:U.clientId,data:U.data,encoding:U.encoding,timestamp:f.now()});z.emit("leave",P)})},T.prototype.on=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];m.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,y)},T.prototype.off=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];m.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,y)},T.prototype.subscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=E.default.processListenerArgs(y),P=U[0],K=U[1],Q=U[2],X=this.channel;if(!Q){if(this.channel.realtime.options.promises)return f.promisify(this,"subscribe",[P,K]);Q=N}if(X.state==="failed"){Q(C.default.fromValues(X.invalidStateError()));return}this.subscriptions.on(P,K),X.attach(Q)},T.prototype.unsubscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=E.default.processListenerArgs(y),P=U[0],K=U[1];this.subscriptions.off(P,K)},T})(h.default),O=(function(A){o.__extends(T,A);function T(y,z){var U=A.call(this)||this;return U.presence=y,U.map=Object.create(null),U.syncInProgress=!1,U.residualMembers=null,U.memberKey=z,U}return T.prototype.get=function(y){return this.map[y]},T.prototype.getClient=function(y){var z=this.map,U=[];for(var P in z){var K=z[P];K.clientId==y&&K.action!="absent"&&U.push(K)}return U},T.prototype.list=function(y){var z=this.map,U=y&&y.clientId,P=y&&y.connectionId,K=[];for(var Q in z){var X=z[Q];X.action!=="absent"&&(U&&U!=X.clientId||P&&P!=X.connectionId||K.push(X))}return K},T.prototype.put=function(y){(y.action==="enter"||y.action==="update")&&(y=_.default.fromValues(y),y.action="present");var z=this.map,U=this.memberKey(y);this.residualMembers&&delete this.residualMembers[U];var P=z[U];return P&&!M(y,P)?!1:(z[U]=y,!0)},T.prototype.values=function(){var y=this.map,z=[];for(var U in y){var P=y[U];P.action!="absent"&&z.push(P)}return z},T.prototype.remove=function(y){var z=this.map,U=this.memberKey(y),P=z[U];return P&&!M(y,P)?!1:(this.syncInProgress?(y=_.default.fromValues(y),y.action="absent",z[U]=y):delete z[U],!0)},T.prototype.startSync=function(){var y=this.map,z=this.syncInProgress;m.default.logAction(m.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),this.syncInProgress||(this.residualMembers=f.copy(y),this.setInProgress(!0))},T.prototype.endSync=function(){var y=this.map,z=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),z){for(var U in y){var P=y[U];P.action==="absent"&&delete y[U]}this.presence._synthesizeLeaves(f.valuesArray(this.residualMembers));for(var U in this.residualMembers)delete y[U];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},T.prototype.waitSync=function(y){var z=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),!z){y();return}this.once("sync",y)},T.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},T.prototype.setInProgress=function(y){m.default.logAction(m.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+y),this.syncInProgress=y,this.presence.syncComplete=!y},T})(g.default);i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=r(56),h=r(31),g=r(11),m=o.__importDefault(r(5)),_=o.__importDefault(r(3)),C=(function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(R){return R!=null&&R.sigBytes!==void 0},E.prototype.isArrayBuffer=function(R){return R!=null&&R.constructor===ArrayBuffer},E.prototype.isTypedArray=function(R){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(R)},E.prototype.uint8ViewToBase64=function(R){for(var v="",N=this.base64CharSet,B=R.byteLength,L=B%3,j=B-L,M,G,O,A,T,y=0;y<j;y=y+3)T=R[y]<<16|R[y+1]<<8|R[y+2],M=(T&16515072)>>18,G=(T&258048)>>12,O=(T&4032)>>6,A=T&63,v+=N[M]+N[G]+N[O]+N[A];return L==1?(T=R[j],M=(T&252)>>2,G=(T&3)<<4,v+=N[M]+N[G]+"=="):L==2&&(T=R[j]<<8|R[j+1],M=(T&64512)>>10,G=(T&1008)>>4,O=(T&15)<<2,v+=N[M]+N[G]+N[O]+"="),v},E.prototype.base64ToArrayBuffer=function(R){for(var v=atob==null?void 0:atob(R),N=v.length,B=new Uint8Array(N),L=0;L<N;L++){var j=v.charCodeAt(L);B[L]=j}return B.buffer},E.prototype.isBuffer=function(R){return this.isArrayBuffer(R)||this.isWordArray(R)||this.isTypedArray(R)},E.prototype.toBuffer=function(R){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(R))return new Uint8Array(R);if(this.isTypedArray(R))return new Uint8Array(R.buffer);if(this.isWordArray(R)){for(var v=new ArrayBuffer(R.sigBytes),N=new Uint8Array(v),B=0;B<R.sigBytes;B++)N[B]=R.words[B>>>2]>>>24-B%4*8&255;return N}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(R){return this.isArrayBuffer(R)?R:this.toBuffer(R).buffer},E.prototype.toWordArray=function(R){return this.isTypedArray(R)&&(R=R.buffer),this.isWordArray(R)?R:m.default.create(R)},E.prototype.base64Encode=function(R){return this.isWordArray(R)?(0,g.stringify)(R):this.uint8ViewToBase64(this.toBuffer(R))},E.prototype.base64Decode=function(R){return ArrayBuffer&&_.default.Config.atob?this.base64ToArrayBuffer(R):(0,g.parse)(R)},E.prototype.hexEncode=function(R){return(0,f.stringify)(this.toWordArray(R))},E.prototype.hexDecode=function(R){var v=(0,f.parse)(R);return ArrayBuffer?this.toArrayBuffer(v):v},E.prototype.utf8Encode=function(R){return _.default.Config.TextEncoder?new _.default.Config.TextEncoder().encode(R).buffer:(0,h.parse)(R)},E.prototype.utf8Decode=function(R){if(!this.isBuffer(R))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(R)?new TextDecoder().decode(R):(R=this.toWordArray(R),(0,h.stringify)(R))},E.prototype.bufferCompare=function(R,v){if(!R)return-1;if(!v)return 1;var N=this.toWordArray(R),B=this.toWordArray(v);N.clamp(),B.clamp();var L=N.sigBytes-B.sigBytes;if(L!=0)return L;for(var j=N.words,M=B.words,G=0;G<j.length;G++)if(L=j[G]-M[G],L!=0)return L;return 0},E.prototype.byteLength=function(R){return this.isArrayBuffer(R)||this.isTypedArray(R)?R.byteLength:this.isWordArray(R)?R.sigBytes:-1},E.prototype.typedArrayToBuffer=function(R){return R.buffer},E})();i.default=new C}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return o.enc.Hex})}),(function(n,i,r){r.r(i);var o=r(5),f=r.n(o),h=r(11),g=r(23),m=r.n(g),_=r(2),C=r.n(_),E=r(4),R=r.n(E),v=function(N,B){var L="aes",j=256,M="cbc",G=16,O=4,A=4294967296,T=2147483648,y;if(N.getRandomWordArray)y=N.getRandomWordArray;else if(typeof Uint32Array<"u"&&N.getRandomValues){var z=new Uint32Array(O);y=function(I,F){var W=I/4,it=W==O?z:new Uint32Array(W);N.getRandomValues(it,function(Z){typeof F<"u"&&F(Z,B.toWordArray(it))})}}else y=function(I,F){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var W=I/4,it=new Array(W),Z=0;Z<W;Z++)it[Z]=Math.floor(Math.random()*A)-T;F(null,f.a.create(it))};function U(I){return I+G&-G}function P(I){if(I.algorithm==="aes"&&I.mode==="cbc"){if(I.keyLength===128||I.keyLength===256)return;throw new Error("Unsupported key length "+I.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function K(I){return I.replace("_","/").replace("-","+")}var Q=[f.a.create([269488144,269488144,269488144,269488144],16),f.a.create([16777216],1),f.a.create([33685504],2),f.a.create([50529024],3),f.a.create([67372036],4),f.a.create([84215045,83886080],5),f.a.create([101058054,101056512],6),f.a.create([117901063,117901056],7),f.a.create([134744072,134744072],8),f.a.create([151587081,151587081,150994944],9),f.a.create([168430090,168430090,168427520],10),f.a.create([185273099,185273099,185273088],11),f.a.create([202116108,202116108,202116108],12),f.a.create([218959117,218959117,218959117,218103808],13),f.a.create([235802126,235802126,235802126,235798528],14),f.a.create([252645135,252645135,252645135,252645135],15),f.a.create([269488144,269488144,269488144,269488144],16)];function X(){}function Y(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}X.CipherParams=Y,X.getDefaultParams=function(I){var F;if(typeof I=="function"||typeof I=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof I=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),X.generateRandomKey(function(it){I(null,X.getDefaultParams({key:it}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,X.getDefaultParams({key:I}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!I.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof I.key=="string"?F=Object(h.parse)(K(I.key)):F=B.toWordArray(I.key);var W=new Y;if(W.key=F,W.algorithm=I.algorithm||L,W.keyLength=F.words.length*32,W.mode=I.mode||M,I.keyLength&&I.keyLength!==W.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+I.keyLength+" was specified, but the key actually has length "+W.keyLength);return P(W),W},X.generateRandomKey=function(I,F){arguments.length==1&&typeof I=="function"&&(F=I,I=void 0),y((I||j)/8,function(W,it){F!==void 0&&F(W?R.a.fromValues(W):null,it)})},X.getCipher=function(I){var F=I instanceof Y?I:X.getDefaultParams(I);return{cipherParams:F,cipher:new D(F,O,I.iv)}};function D(I,F,W){this.algorithm=I.algorithm+"-"+String(I.keyLength)+"-"+I.mode,this.cjsAlgorithm=I.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=B.toWordArray(I.key),W&&(this.iv=B.toWordArray(W).clone()),this.blockLengthWords=F}return D.prototype.encrypt=function(I,F){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),I=B.toWordArray(I);var W=I.sigBytes,it=U(W),Z=this,at=function(){Z.getIv(function(rt,V){if(rt){F(rt);return}var J=Z.encryptCipher.process(I.concat(Q[it-W])),$=V.concat(J);F(null,$)})};this.encryptCipher?at():this.iv?(this.encryptCipher=m.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),at()):y(G,function(rt,V){if(rt){F(rt);return}Z.encryptCipher=m.a.algo[Z.cjsAlgorithm].createEncryptor(Z.key,{iv:V}),Z.iv=V,at()})},D.prototype.decrypt=function(I){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),I=B.toWordArray(I);var F=this.blockLengthWords,W=I.words,it=f.a.create(W.slice(0,F)),Z=f.a.create(W.slice(F)),at=m.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:it}),rt=at.process(Z),V=at.finalize();return at.reset(),V&&V.sigBytes&&rt.concat(V),rt},D.prototype.getIv=function(I){if(this.iv){var F=this.iv;this.iv=null,I(null,F);return}var W=this;y(G,function(it,Z){if(it){I(it);return}I(null,W.encryptCipher.process(Z))})},X};i.default=v}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.WordArray,m=f.enc;m.Utf16=m.Utf16BE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],N=0;N<R;N+=2){var B=E[N>>>2]>>>16-N%4*8&65535;v.push(String.fromCharCode(B))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=C.charCodeAt(v)<<16-v%2*16;return g.create(R,E*2)}},m.Utf16LE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],N=0;N<R;N+=2){var B=_(E[N>>>2]>>>16-N%4*8&65535);v.push(String.fromCharCode(B))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=_(C.charCodeAt(v)<<16-v%2*16);return g.create(R,E*2)}};function _(C){return C<<8&4278255360|C>>>8&16711935}})(),o.enc.Utf16})}),(function(n,i,r){(function(o,f){n.exports=f(r(6),r(28))})(this,function(o){return(function(f){var h=o,g=h.lib,m=g.CipherParams,_=h.enc,C=_.Hex,E=h.format;E.Hex={stringify:function(R){return R.ciphertext.toString(C)},parse:function(R){var v=C.parse(R);return m.create({ciphertext:v})}}})(),o.format.Hex})}),(function(n,i,r){(function(o,f){n.exports=f(r(6),r(11),r(61),r(27),r(28))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.BlockCipher,m=f.algo,_=[],C=[],E=[],R=[],v=[],N=[],B=[],L=[],j=[],M=[];(function(){for(var A=[],T=0;T<256;T++)T<128?A[T]=T<<1:A[T]=T<<1^283;for(var y=0,z=0,T=0;T<256;T++){var U=z^z<<1^z<<2^z<<3^z<<4;U=U>>>8^U&255^99,_[y]=U,C[U]=y;var P=A[y],K=A[P],Q=A[K],X=A[U]*257^U*16843008;E[y]=X<<24|X>>>8,R[y]=X<<16|X>>>16,v[y]=X<<8|X>>>24,N[y]=X;var X=Q*16843009^K*65537^P*257^y*16843008;B[U]=X<<24|X>>>8,L[U]=X<<16|X>>>16,j[U]=X<<8|X>>>24,M[U]=X,y?(y=P^A[A[A[Q^P]]],z^=A[A[z]]):y=z=1}})();var G=[0,1,2,4,8,16,32,64,128,27,54],O=m.AES=g.extend({_doReset:function(){var A;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var T=this._keyPriorReset=this._key,y=T.words,z=T.sigBytes/4,U=this._nRounds=z+6,P=(U+1)*4,K=this._keySchedule=[],Q=0;Q<P;Q++)Q<z?K[Q]=y[Q]:(A=K[Q-1],Q%z?z>6&&Q%z==4&&(A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255]):(A=A<<8|A>>>24,A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255],A^=G[Q/z|0]<<24),K[Q]=K[Q-z]^A);for(var X=this._invKeySchedule=[],Y=0;Y<P;Y++){var Q=P-Y;if(Y%4)var A=K[Q];else var A=K[Q-4];Y<4||Q<=4?X[Y]=A:X[Y]=B[_[A>>>24]]^L[_[A>>>16&255]]^j[_[A>>>8&255]]^M[_[A&255]]}}},encryptBlock:function(A,T){this._doCryptBlock(A,T,this._keySchedule,E,R,v,N,_)},decryptBlock:function(A,T){var y=A[T+1];A[T+1]=A[T+3],A[T+3]=y,this._doCryptBlock(A,T,this._invKeySchedule,B,L,j,M,C);var y=A[T+1];A[T+1]=A[T+3],A[T+3]=y},_doCryptBlock:function(A,T,y,z,U,P,K,Q){for(var X=this._nRounds,Y=A[T]^y[0],D=A[T+1]^y[1],I=A[T+2]^y[2],F=A[T+3]^y[3],W=4,it=1;it<X;it++){var Z=z[Y>>>24]^U[D>>>16&255]^P[I>>>8&255]^K[F&255]^y[W++],at=z[D>>>24]^U[I>>>16&255]^P[F>>>8&255]^K[Y&255]^y[W++],rt=z[I>>>24]^U[F>>>16&255]^P[Y>>>8&255]^K[D&255]^y[W++],V=z[F>>>24]^U[Y>>>16&255]^P[D>>>8&255]^K[I&255]^y[W++];Y=Z,D=at,I=rt,F=V}var Z=(Q[Y>>>24]<<24|Q[D>>>16&255]<<16|Q[I>>>8&255]<<8|Q[F&255])^y[W++],at=(Q[D>>>24]<<24|Q[I>>>16&255]<<16|Q[F>>>8&255]<<8|Q[Y&255])^y[W++],rt=(Q[I>>>24]<<24|Q[F>>>16&255]<<16|Q[Y>>>8&255]<<8|Q[D&255])^y[W++],V=(Q[F>>>24]<<24|Q[Y>>>16&255]<<16|Q[D>>>8&255]<<8|Q[I&255])^y[W++];A[T]=Z,A[T+1]=at,A[T+2]=rt,A[T+3]=V},keySize:256/32});f.AES=g._createHelper(O)})(),o.AES})}),(function(n,i,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(f){var h=o,g=h.lib,m=g.WordArray,_=g.Hasher,C=h.algo,E=[];(function(){for(var j=0;j<64;j++)E[j]=f.abs(f.sin(j+1))*4294967296|0})();var R=C.MD5=_.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(j,M){for(var G=0;G<16;G++){var O=M+G,A=j[O];j[O]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var T=this._hash.words,y=j[M+0],z=j[M+1],U=j[M+2],P=j[M+3],K=j[M+4],Q=j[M+5],X=j[M+6],Y=j[M+7],D=j[M+8],I=j[M+9],F=j[M+10],W=j[M+11],it=j[M+12],Z=j[M+13],at=j[M+14],rt=j[M+15],V=T[0],J=T[1],$=T[2],nt=T[3];V=v(V,J,$,nt,y,7,E[0]),nt=v(nt,V,J,$,z,12,E[1]),$=v($,nt,V,J,U,17,E[2]),J=v(J,$,nt,V,P,22,E[3]),V=v(V,J,$,nt,K,7,E[4]),nt=v(nt,V,J,$,Q,12,E[5]),$=v($,nt,V,J,X,17,E[6]),J=v(J,$,nt,V,Y,22,E[7]),V=v(V,J,$,nt,D,7,E[8]),nt=v(nt,V,J,$,I,12,E[9]),$=v($,nt,V,J,F,17,E[10]),J=v(J,$,nt,V,W,22,E[11]),V=v(V,J,$,nt,it,7,E[12]),nt=v(nt,V,J,$,Z,12,E[13]),$=v($,nt,V,J,at,17,E[14]),J=v(J,$,nt,V,rt,22,E[15]),V=N(V,J,$,nt,z,5,E[16]),nt=N(nt,V,J,$,X,9,E[17]),$=N($,nt,V,J,W,14,E[18]),J=N(J,$,nt,V,y,20,E[19]),V=N(V,J,$,nt,Q,5,E[20]),nt=N(nt,V,J,$,F,9,E[21]),$=N($,nt,V,J,rt,14,E[22]),J=N(J,$,nt,V,K,20,E[23]),V=N(V,J,$,nt,I,5,E[24]),nt=N(nt,V,J,$,at,9,E[25]),$=N($,nt,V,J,P,14,E[26]),J=N(J,$,nt,V,D,20,E[27]),V=N(V,J,$,nt,Z,5,E[28]),nt=N(nt,V,J,$,U,9,E[29]),$=N($,nt,V,J,Y,14,E[30]),J=N(J,$,nt,V,it,20,E[31]),V=B(V,J,$,nt,Q,4,E[32]),nt=B(nt,V,J,$,D,11,E[33]),$=B($,nt,V,J,W,16,E[34]),J=B(J,$,nt,V,at,23,E[35]),V=B(V,J,$,nt,z,4,E[36]),nt=B(nt,V,J,$,K,11,E[37]),$=B($,nt,V,J,Y,16,E[38]),J=B(J,$,nt,V,F,23,E[39]),V=B(V,J,$,nt,Z,4,E[40]),nt=B(nt,V,J,$,y,11,E[41]),$=B($,nt,V,J,P,16,E[42]),J=B(J,$,nt,V,X,23,E[43]),V=B(V,J,$,nt,I,4,E[44]),nt=B(nt,V,J,$,it,11,E[45]),$=B($,nt,V,J,rt,16,E[46]),J=B(J,$,nt,V,U,23,E[47]),V=L(V,J,$,nt,y,6,E[48]),nt=L(nt,V,J,$,Y,10,E[49]),$=L($,nt,V,J,at,15,E[50]),J=L(J,$,nt,V,Q,21,E[51]),V=L(V,J,$,nt,it,6,E[52]),nt=L(nt,V,J,$,P,10,E[53]),$=L($,nt,V,J,F,15,E[54]),J=L(J,$,nt,V,z,21,E[55]),V=L(V,J,$,nt,D,6,E[56]),nt=L(nt,V,J,$,rt,10,E[57]),$=L($,nt,V,J,X,15,E[58]),J=L(J,$,nt,V,Z,21,E[59]),V=L(V,J,$,nt,K,6,E[60]),nt=L(nt,V,J,$,W,10,E[61]),$=L($,nt,V,J,U,15,E[62]),J=L(J,$,nt,V,I,21,E[63]),T[0]=T[0]+V|0,T[1]=T[1]+J|0,T[2]=T[2]+$|0,T[3]=T[3]+nt|0},_doFinalize:function(){var j=this._data,M=j.words,G=this._nDataBytes*8,O=j.sigBytes*8;M[O>>>5]|=128<<24-O%32;var A=f.floor(G/4294967296),T=G;M[(O+64>>>9<<4)+15]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,M[(O+64>>>9<<4)+14]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,j.sigBytes=(M.length+1)*4,this._process();for(var y=this._hash,z=y.words,U=0;U<4;U++){var P=z[U];z[U]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return y},clone:function(){var j=_.clone.call(this);return j._hash=this._hash.clone(),j}});function v(j,M,G,O,A,T,y){var z=j+(M&G|~M&O)+A+y;return(z<<T|z>>>32-T)+M}function N(j,M,G,O,A,T,y){var z=j+(M&O|G&~O)+A+y;return(z<<T|z>>>32-T)+M}function B(j,M,G,O,A,T,y){var z=j+(M^G^O)+A+y;return(z<<T|z>>>32-T)+M}function L(j,M,G,O,A,T,y){var z=j+(G^(M|~O))+A+y;return(z<<T|z>>>32-T)+M}h.MD5=_._createHelper(R),h.HmacMD5=_._createHmacHelper(R)})(Math),o.MD5})}),(function(n,i,r){var o;Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),h=f.__importDefault(r(3)),g=f.__importStar(r(1)),m=f.__importDefault(r(8)),_=r(4),C=f.__importDefault(r(19)),E=f.__importDefault(r(17)),R=f.__importDefault(r(22)),v=f.__importDefault(r(2)),N=r(29),B=f.__importDefault(r(63)),L=r(14);function j(O){var A=O.statusCode;return A===408&&!O.code||A===400&&!O.code||A>=500&&A<=504}function M(O){var A=O.connection,T=A&&A.connectionManager.host;return T?[T].concat(m.default.getFallbackHosts(O.options)):m.default.getHosts(O.options)}var G=(o=(function(){function O(A){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=M,this.options=A||{};var T=this.options.connectivityCheckUrl||m.default.connectivityCheckUrl,y=this.options.connectivityCheckParams,z=!this.options.connectivityCheckUrl;h.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(U,P,K,Q,X,Y,D){var I=E.default.createRequest(K,Q,X,Y,R.default.REQ_SEND,P&&P.options.timeouts,U);return I.once("complete",D),I.exec(),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,y,function(P,K,Q,X,Y){var D=!1;z?D=!P&&(K==null?void 0:K.replace(/\n/,""))=="yes":D=!P&&(0,L.isSuccessCode)(Y),v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+D),U(null,D)})}):h.default.Config.jsonpSupported?(this.Request=function(U,P,K,Q,X,Y,D){var I=(0,N.createRequest)(K,Q,X,Y,R.default.REQ_SEND,P&&P.options.timeouts,U);return I.once("complete",D),h.default.Config.nextTick(function(){I.exec()}),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){var P=this,K=m.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(U);return}this.checksInProgress=[U],v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+K);var Q=new N.Request("isTheInternetUp",K,null,null,null,R.default.REQ_SEND,m.default.TIMEOUTS);Q.once("complete",function(X,Y){var D=!X&&Y;v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+D);for(var I=0;I<P.checksInProgress.length;I++)P.checksInProgress[I](null,D);P.checksInProgress=null}),h.default.Config.nextTick(function(){Q.exec()})}):h.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=B.default,this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,null,function(P,K){var Q=!P&&(K==null?void 0:K.replace(/\n/,""))=="yes";v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+Q),U(null,Q)})}):this.Request=function(U,P,K,Q,X,Y,D){D(new _.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return O.prototype.do=function(A,T,y,z,U,P,K){var Q=this,X=typeof y=="function"?y:function(F){return T.baseUri(F)+y},Y=T._currentFallback;if(Y)if(Y.validUntil>g.now()){if(!this.Request){K==null||K(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,T,X(Y.host),z,P,U,function(F){for(var W=[],it=1;it<arguments.length;it++)W[it-1]=arguments[it];if(F&&j(F)){T._currentFallback=null,Q.do(A,T,y,z,U,P,K);return}K==null||K.apply(void 0,f.__spreadArray([F],W,!1))});return}else T._currentFallback=null;var D=M(T);if(D.length===1){this.doUri(A,T,X(D[0]),z,U,P,K);return}var I=function(F,W){var it=F.shift();Q.doUri(A,T,X(it),z,U,P,function(Z){for(var at=[],rt=1;rt<arguments.length;rt++)at[rt-1]=arguments[rt];if(Z&&j(Z)&&F.length){I(F,!0);return}W&&(T._currentFallback={host:it,validUntil:g.now()+T.options.timeouts.fallbackRetryTimeout}),K==null||K.apply(void 0,f.__spreadArray([Z],at,!1))})};I(D)},O.prototype.doUri=function(A,T,y,z,U,P,K){if(!this.Request){K(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,T,y,z,P,U,K)},O})(),o.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],o.methodsWithoutBody=[C.default.Get,C.default.Delete],o.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],o);i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(4)),h=o.__importDefault(r(3)),g=o.__importDefault(r(8)),m=o.__importStar(r(1)),_=r(1);function C(v,N){return!!N.get("x-ably-errorcode")}function E(v,N){if(C(v,N))return v.error&&f.default.fromValues(v.error)}function R(v,N,B,L,j,M,G){var O=new Headers(L||{}),A=v?v.toUpperCase():m.isEmptyArg(M)?"GET":"POST",T=new AbortController,y=setTimeout(function(){T.abort(),G(new f.PartialErrorInfo("Request timed out",null,408))},N?N.options.timeouts.httpRequestTimeout:g.default.TIMEOUTS.httpRequestTimeout),z={method:A,headers:O,body:M};h.default.Config.isWebworker||(z.credentials=O.has("authorization")?"include":"same-origin"),(0,_.getGlobalObject)().fetch(B+"?"+new URLSearchParams(j||{}),z).then(function(U){clearTimeout(y);var P=U.headers.get("Content-Type"),K;P&&P.indexOf("application/x-msgpack")>-1?K=U.arrayBuffer():P&&P.indexOf("application/json")>-1?K=U.json():K=U.text(),K.then(function(Q){var X=!!P&&P.indexOf("application/x-msgpack")===-1;if(U.ok)G(null,Q,U.headers,X,U.status);else{var Y=E(Q,U.headers)||new f.PartialErrorInfo("Error response received from server: "+U.status+" body was: "+h.default.Config.inspect(Q),null,U.status);G(Y,Q,U.headers,X,U.status)}})}).catch(function(U){clearTimeout(y),G(U)})}i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(41)),h=o.__importStar(r(1)),g=h.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function m(){var R=g.location;return!g.WebSocket||!R||!R.origin||R.origin.indexOf("http")>-1}var _=g.navigator&&g.navigator.userAgent.toString(),C=g.location&&g.location.href,E={agent:"browser",logTimestamps:!0,userAgent:_,currentUrl:C,noUpgrade:_&&!!_.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:g.WebSocket,fetchSupported:!!g.fetch,xhrSupported:g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:m(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:f.default,supportsBinary:!!g.TextDecoder,preferBinary:!1,ArrayBuffer:g.ArrayBuffer,atob:g.atob,nextTick:typeof g.setImmediate<"u"?g.setImmediate.bind(g):function(R){setTimeout(R,0)},addEventListener:g.addEventListener,inspect:JSON.stringify,stringByteSize:function(R){return g.TextDecoder&&new g.TextEncoder().encode(R).length||R.length},TextEncoder:g.TextEncoder,TextDecoder:g.TextDecoder,Promise:g.Promise,getRandomValues:(function(R){if(R!==void 0)return function(v,N){R.getRandomValues(v),N&&N(null)}})(g.crypto||msCrypto)};i.default=E}),(function(n,i,r){(function(o){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),h=f.__importStar(r(1)),g="ablyjs-storage-test",m=(function(){function _(){try{o.sessionStorage.setItem(g,g),o.sessionStorage.removeItem(g),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{o.localStorage.setItem(g,g),o.localStorage.removeItem(g),this.localSupported=!0}catch{this.localSupported=!1}}return _.prototype.get=function(C){return this._get(C,!1)},_.prototype.getSession=function(C){return this._get(C,!0)},_.prototype.remove=function(C){return this._remove(C,!1)},_.prototype.removeSession=function(C){return this._remove(C,!0)},_.prototype.set=function(C,E,R){return this._set(C,E,R,!1)},_.prototype.setSession=function(C,E,R){return this._set(C,E,R,!0)},_.prototype._set=function(C,E,R,v){var N={value:E};return R&&(N.expires=h.now()+R),this.storageInterface(v).setItem(C,JSON.stringify(N))},_.prototype._get=function(C,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var R=this.storageInterface(E).getItem(C);if(!R)return null;var v=JSON.parse(R);return v.expires&&v.expires<h.now()?(this.storageInterface(E).removeItem(C),null):v.value},_.prototype._remove=function(C,E){return this.storageInterface(E).removeItem(C)},_.prototype.storageInterface=function(C){return C?o.sessionStorage:o.localStorage},_})();i.default=new m}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(67)),h={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],baseTransportOrder:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],transportPreferenceOrder:[f.default.JsonP,f.default.XhrPolling,f.default.XhrStreaming,f.default.WebSocket],upgradeTransports:[f.default.XhrStreaming,f.default.WebSocket]};i.default=h}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var o;(function(f){f.WebSocket="web_socket",f.Comet="comet",f.XhrStreaming="xhr_streaming",f.XhrPolling="xhr_polling",f.JsonP="jsonp"})(o||(o={})),i.default=o}),(function(n,i,r){r.r(i);var o=r(29),f=r.n(o),h=r(1),g=r(3),m=r.n(g),_=r(12),C=r.n(_),E=r(17),R=r.n(E),v=function(j){var M="xhr_polling";function G(O,A,T){T.stream=!1,C.a.call(this,O,A,T),this.shortName=M}return h.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(O,A,T,y,z){return R.a.createRequest(O,A,T,y,z,this.timeouts)},typeof j<"u"&&G.isAvailable()&&(j.supportedTransports[M]=G),G},N=v,B=function(j){var M="xhr_streaming";function G(O,A,T){C.a.call(this,O,A,T),this.shortName=M}return h.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.streamingSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(O,A,T,y,z){return R.a.createRequest(O,A,T,y,z,this.timeouts)},typeof j<"u"&&G.isAvailable()&&(j.supportedTransports[M]=G),G},L=B;i.default=[f.a,N,L]})]).default})})(Hp)),Hp.exports}var yS=vS(),Bm=function(l,t){return Bm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},Bm(l,t)};function SS(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Bm(l,t);function n(){this.constructor=l}l.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var vg=function(){return vg=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},vg.apply(this,arguments)};function bf(l,t){var n={};for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&t.indexOf(i)<0&&(n[i]=l[i]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(l);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(l,i[r])&&(n[i[r]]=l[i[r]]);return n}function bS(l,t,n,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,n,i);else for(var h=l.length-1;h>=0;h--)(f=l[h])&&(o=(r<3?f(o):r>3?f(t,n,o):f(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function _S(l,t){return function(n,i){t(n,i,l)}}function ES(l,t,n,i,r,o){function f(L){if(L!==void 0&&typeof L!="function")throw new TypeError("Function expected");return L}for(var h=i.kind,g=h==="getter"?"get":h==="setter"?"set":"value",m=!t&&l?i.static?l:l.prototype:null,_=t||(m?Object.getOwnPropertyDescriptor(m,i.name):{}),C,E=!1,R=n.length-1;R>=0;R--){var v={};for(var N in i)v[N]=N==="access"?{}:i[N];for(var N in i.access)v.access[N]=i.access[N];v.addInitializer=function(L){if(E)throw new TypeError("Cannot add initializers after decoration has completed");o.push(f(L||null))};var B=(0,n[R])(h==="accessor"?{get:_.get,set:_.set}:_[g],v);if(h==="accessor"){if(B===void 0)continue;if(B===null||typeof B!="object")throw new TypeError("Object expected");(C=f(B.get))&&(_.get=C),(C=f(B.set))&&(_.set=C),(C=f(B.init))&&r.unshift(C)}else(C=f(B))&&(h==="field"?r.unshift(C):_[g]=C)}m&&Object.defineProperty(m,i.name,_),E=!0}function CS(l,t,n){for(var i=arguments.length>2,r=0;r<t.length;r++)n=i?t[r].call(l,n):t[r].call(l);return i?n:void 0}function TS(l){return typeof l=="symbol"?l:"".concat(l)}function AS(l,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(l,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function wS(l,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,t)}function le(l,t,n,i){function r(o){return o instanceof n?o:new n(function(f){f(o)})}return new(n||(n=Promise))(function(o,f){function h(_){try{m(i.next(_))}catch(C){f(C)}}function g(_){try{m(i.throw(_))}catch(C){f(C)}}function m(_){_.done?o(_.value):r(_.value).then(h,g)}m((i=i.apply(l,t||[])).next())})}function RS(l,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=h(0),f.throw=h(1),f.return=h(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function h(m){return function(_){return g([m,_])}}function g(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,r&&(o=m[0]&2?r.return:m[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,m[1])).done)return o;switch(r=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){n.label=m[1];break}if(m[0]===6&&n.label<o[1]){n.label=o[1],o=m;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(m);break}o[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(l,n)}catch(_){m=[6,_],r=0}finally{i=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var jg=Object.create?(function(l,t,n,i){i===void 0&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(l,i,r)}):(function(l,t,n,i){i===void 0&&(i=n),l[i]=t[n]});function OS(l,t){for(var n in l)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&jg(t,l,n)}function yg(l){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&l[t],i=0;if(n)return n.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&i>=l.length&&(l=void 0),{value:l&&l[i++],done:!l}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function av(l,t){var n=typeof Symbol=="function"&&l[Symbol.iterator];if(!n)return l;var i=n.call(l),r,o=[],f;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(h){f={error:h}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(f)throw f.error}}return o}function xS(){for(var l=[],t=0;t<arguments.length;t++)l=l.concat(av(arguments[t]));return l}function MS(){for(var l=0,t=0,n=arguments.length;t<n;t++)l+=arguments[t].length;for(var i=Array(l),r=0,t=0;t<n;t++)for(var o=arguments[t],f=0,h=o.length;f<h;f++,r++)i[r]=o[f];return i}function NS(l,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,o;i<r;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return l.concat(o||Array.prototype.slice.call(t))}function df(l){return this instanceof df?(this.v=l,this):new df(l)}function jS(l,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(l,t||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",f),r[Symbol.asyncIterator]=function(){return this},r;function f(R){return function(v){return Promise.resolve(v).then(R,C)}}function h(R,v){i[R]&&(r[R]=function(N){return new Promise(function(B,L){o.push([R,N,B,L])>1||g(R,N)})},v&&(r[R]=v(r[R])))}function g(R,v){try{m(i[R](v))}catch(N){E(o[0][3],N)}}function m(R){R.value instanceof df?Promise.resolve(R.value.v).then(_,C):E(o[0][2],R)}function _(R){g("next",R)}function C(R){g("throw",R)}function E(R,v){R(v),o.shift(),o.length&&g(o[0][0],o[0][1])}}function DS(l){var t,n;return t={},i("next"),i("throw",function(r){throw r}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(r,o){t[r]=l[r]?function(f){return(n=!n)?{value:df(l[r](f)),done:!1}:o?o(f):f}:o}}function US(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=l[Symbol.asyncIterator],n;return t?t.call(l):(l=typeof yg=="function"?yg(l):l[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=l[o]&&function(f){return new Promise(function(h,g){f=l[o](f),r(h,g,f.done,f.value)})}}function r(o,f,h,g){Promise.resolve(g).then(function(m){o({value:m,done:h})},f)}}function BS(l,t){return Object.defineProperty?Object.defineProperty(l,"raw",{value:t}):l.raw=t,l}var d_=Object.create?(function(l,t){Object.defineProperty(l,"default",{enumerable:!0,value:t})}):function(l,t){l.default=t},zm=function(l){return zm=Object.getOwnPropertyNames||function(t){var n=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[n.length]=i);return n},zm(l)};function zS(l){if(l&&l.__esModule)return l;var t={};if(l!=null)for(var n=zm(l),i=0;i<n.length;i++)n[i]!=="default"&&jg(t,l,n[i]);return d_(t,l),t}function LS(l){return l&&l.__esModule?l:{default:l}}function GS(l,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?l!==t||!i:!t.has(l))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(l):i?i.value:t.get(l)}function PS(l,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?l!==t||!r:!t.has(l))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(l,n):r?r.value=n:t.set(l,n),n}function HS(l,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof l=="function"?t===l:l.has(t)}function IS(l,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var i,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],n&&(r=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");r&&(i=function(){try{r.call(this)}catch(o){return Promise.reject(o)}}),l.stack.push({value:t,dispose:i,async:n})}else n&&l.stack.push({async:!0});return t}var g_=typeof SuppressedError=="function"?SuppressedError:function(l,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=l,i.suppressed=t,i};function kS(l){function t(o){l.error=l.hasError?new g_(o,l.error,"An error was suppressed during disposal."):o,l.hasError=!0}var n,i=0;function r(){for(;n=l.stack.pop();)try{if(!n.async&&i===1)return i=0,l.stack.push(n),Promise.resolve().then(r);if(n.dispose){var o=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(o).then(r,function(f){return t(f),r()})}else i|=1}catch(f){t(f)}if(i===1)return l.hasError?Promise.reject(l.error):Promise.resolve();if(l.hasError)throw l.error}return r()}function qS(l,t){return typeof l=="string"&&/^\.\.?\//.test(l)?l.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,i,r,o,f){return i?t?".jsx":".js":r&&(!o||!f)?n:r+o+"."+f.toLowerCase()+"js"}):l}const p_={__extends:SS,__assign:vg,__rest:bf,__decorate:bS,__param:_S,__esDecorate:ES,__runInitializers:CS,__propKey:TS,__setFunctionName:AS,__metadata:wS,__awaiter:le,__generator:RS,__createBinding:jg,__exportStar:OS,__values:yg,__read:av,__spread:xS,__spreadArrays:MS,__spreadArray:NS,__await:df,__asyncGenerator:jS,__asyncDelegator:DS,__asyncValues:US,__makeTemplateObject:BS,__importStar:zS,__importDefault:LS,__classPrivateFieldGet:GS,__classPrivateFieldSet:PS,__classPrivateFieldIn:HS,__addDisposableResource:IS,__disposeResources:kS,__rewriteRelativeImportExtension:qS},m_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:IS,get __assign(){return vg},__asyncDelegator:DS,__asyncGenerator:jS,__asyncValues:US,__await:df,__awaiter:le,__classPrivateFieldGet:GS,__classPrivateFieldIn:HS,__classPrivateFieldSet:PS,__createBinding:jg,__decorate:bS,__disposeResources:kS,__esDecorate:ES,__exportStar:OS,__extends:SS,__generator:RS,__importDefault:LS,__importStar:zS,__makeTemplateObject:BS,__metadata:wS,__param:_S,__propKey:TS,__read:av,__rest:bf,__rewriteRelativeImportExtension:qS,__runInitializers:CS,__setFunctionName:AS,__spread:xS,__spreadArray:NS,__spreadArrays:MS,__values:yg,default:p_},Symbol.toStringTag,{value:"Module"})),v_="modulepreload",y_=function(l){return"/"+l},o1={},Au=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){let f=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),g=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));r=f(n.map(m=>{if(m=y_(m),m in o1)return;o1[m]=!0;const _=m.endsWith(".css"),C=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${C}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":v_,_||(E.as="script"),E.crossOrigin="",E.href=m,g&&E.setAttribute("nonce",g),document.head.appendChild(E),_)return new Promise((R,v)=>{E.addEventListener("load",R),E.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return r.then(f=>{for(const h of f||[])h.status==="rejected"&&o(h.reason);return t().catch(o)})},S_=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...n)=>Au(async()=>{const{default:i}=await Promise.resolve().then(()=>wu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)};class rv extends Error{constructor(t,n="FunctionsError",i){super(t),this.name=n,this.context=i}}class u1 extends rv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class c1 extends rv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class f1 extends rv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Lm;(function(l){l.Any="any",l.ApNortheast1="ap-northeast-1",l.ApNortheast2="ap-northeast-2",l.ApSouth1="ap-south-1",l.ApSoutheast1="ap-southeast-1",l.ApSoutheast2="ap-southeast-2",l.CaCentral1="ca-central-1",l.EuCentral1="eu-central-1",l.EuWest1="eu-west-1",l.EuWest2="eu-west-2",l.EuWest3="eu-west-3",l.SaEast1="sa-east-1",l.UsEast1="us-east-1",l.UsWest1="us-west-1",l.UsWest2="us-west-2"})(Lm||(Lm={}));class b_{constructor(t,{headers:n={},customFetch:i,region:r=Lm.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=S_(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return le(this,arguments,void 0,function*(n,i={}){var r;try{const{headers:o,method:f,body:h,signal:g}=i;let m={},{region:_}=i;_||(_=this.region);const C=new URL(`${this.url}/${n}`);_&&_!=="any"&&(m["x-region"]=_,C.searchParams.set("forceFunctionRegion",_));let E;h&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=h):typeof h=="string"?(m["Content-Type"]="text/plain",E=h):typeof FormData<"u"&&h instanceof FormData?E=h:(m["Content-Type"]="application/json",E=JSON.stringify(h)):E=h;const R=yield this.fetch(C.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),o),body:E,signal:g}).catch(L=>{throw L.name==="AbortError"?L:new u1(L)}),v=R.headers.get("x-relay-error");if(v&&v==="true")throw new c1(R);if(!R.ok)throw new f1(R);let N=((r=R.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),B;return N==="application/json"?B=yield R.json():N==="application/octet-stream"||N==="application/pdf"?B=yield R.blob():N==="text/event-stream"?B=R:N==="multipart/form-data"?B=yield R.formData():B=yield R.text(),{data:B,error:null,response:R}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new u1(o)}:{data:null,error:o,response:o instanceof f1||o instanceof c1?o.context:void 0}}})}}var ea={};const _f=b2(m_);var eg={},ng={},ig={},ag={},rg={},__=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},gf=__();const E_=gf.fetch,VS=gf.fetch.bind(gf),YS=gf.Headers,C_=gf.Request,T_=gf.Response,wu=Object.freeze(Object.defineProperty({__proto__:null,Headers:YS,Request:C_,Response:T_,default:VS,fetch:E_},Symbol.toStringTag,{value:"Module"})),A_=b2(wu);var sg={},h1;function KS(){if(h1)return sg;h1=1,Object.defineProperty(sg,"__esModule",{value:!0});class l extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return sg.default=l,sg}var d1;function QS(){if(d1)return rg;d1=1,Object.defineProperty(rg,"__esModule",{value:!0});const l=_f,t=l.__importDefault(A_),n=l.__importDefault(KS());class i{constructor(o){var f,h;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(f=o.shouldThrowOnError)!==null&&f!==void 0?f:!1,this.signal=o.signal,this.isMaybeSingle=(h=o.isMaybeSingle)!==null&&h!==void 0?h:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,f){return this.headers=new Headers(this.headers),this.headers.set(o,f),this}then(o,f){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let g=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var _,C,E,R;let v=null,N=null,B=null,L=m.status,j=m.statusText;if(m.ok){if(this.method!=="HEAD"){const A=await m.text();A===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((_=this.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?N=A:N=JSON.parse(A))}const G=(C=this.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),O=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");G&&O&&O.length>1&&(B=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(N)&&(N.length>1?(v={code:"PGRST116",details:`Results contain ${N.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},N=null,B=null,L=406,j="Not Acceptable"):N.length===1?N=N[0]:N=null)}else{const G=await m.text();try{v=JSON.parse(G),Array.isArray(v)&&m.status===404&&(N=[],v=null,L=200,j="OK")}catch{m.status===404&&G===""?(L=204,j="No Content"):v={message:G}}if(v&&this.isMaybeSingle&&(!((R=v==null?void 0:v.details)===null||R===void 0)&&R.includes("0 rows"))&&(v=null,L=200,j="OK"),v&&this.shouldThrowOnError)throw new n.default(v)}return{error:v,data:N,count:B,status:L,statusText:j}});return this.shouldThrowOnError||(g=g.catch(m=>{var _,C,E;return{error:{message:`${(_=m==null?void 0:m.name)!==null&&_!==void 0?_:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(C=m==null?void 0:m.stack)!==null&&C!==void 0?C:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),g.then(o,f)}returns(){return this}overrideTypes(){return this}}return rg.default=i,rg}var g1;function XS(){if(g1)return ag;g1=1,Object.defineProperty(ag,"__esModule",{value:!0});const t=_f.__importDefault(QS());class n extends t.default{select(r){let o=!1;const f=(r??"*").split("").map(h=>/\s/.test(h)&&!o?"":(h==='"'&&(o=!o),h)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:o=!0,nullsFirst:f,foreignTable:h,referencedTable:g=h}={}){const m=g?`${g}.order`:"order",_=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${_?`${_},`:""}${r}.${o?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:o,referencedTable:f=o}={}){const h=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(h,`${r}`),this}range(r,o,{foreignTable:f,referencedTable:h=f}={}){const g=typeof h>"u"?"offset":`${h}.offset`,m=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${r}`),this.url.searchParams.set(m,`${o-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:o=!1,settings:f=!1,buffers:h=!1,wal:g=!1,format:m="text"}={}){var _;const C=[r?"analyze":null,o?"verbose":null,f?"settings":null,h?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${C};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return ag.default=n,ag}var p1;function sv(){if(p1)return ig;p1=1,Object.defineProperty(ig,"__esModule",{value:!0});const t=_f.__importDefault(XS());class n extends t.default{eq(r,o){return this.url.searchParams.append(r,`eq.${o}`),this}neq(r,o){return this.url.searchParams.append(r,`neq.${o}`),this}gt(r,o){return this.url.searchParams.append(r,`gt.${o}`),this}gte(r,o){return this.url.searchParams.append(r,`gte.${o}`),this}lt(r,o){return this.url.searchParams.append(r,`lt.${o}`),this}lte(r,o){return this.url.searchParams.append(r,`lte.${o}`),this}like(r,o){return this.url.searchParams.append(r,`like.${o}`),this}likeAllOf(r,o){return this.url.searchParams.append(r,`like(all).{${o.join(",")}}`),this}likeAnyOf(r,o){return this.url.searchParams.append(r,`like(any).{${o.join(",")}}`),this}ilike(r,o){return this.url.searchParams.append(r,`ilike.${o}`),this}ilikeAllOf(r,o){return this.url.searchParams.append(r,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(r,o){return this.url.searchParams.append(r,`ilike(any).{${o.join(",")}}`),this}is(r,o){return this.url.searchParams.append(r,`is.${o}`),this}in(r,o){const f=Array.from(new Set(o)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(r,`in.(${f})`),this}contains(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cs.{${o.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(o)}`),this}containedBy(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cd.{${o.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(o)}`),this}rangeGt(r,o){return this.url.searchParams.append(r,`sr.${o}`),this}rangeGte(r,o){return this.url.searchParams.append(r,`nxl.${o}`),this}rangeLt(r,o){return this.url.searchParams.append(r,`sl.${o}`),this}rangeLte(r,o){return this.url.searchParams.append(r,`nxr.${o}`),this}rangeAdjacent(r,o){return this.url.searchParams.append(r,`adj.${o}`),this}overlaps(r,o){return typeof o=="string"?this.url.searchParams.append(r,`ov.${o}`):this.url.searchParams.append(r,`ov.{${o.join(",")}}`),this}textSearch(r,o,{config:f,type:h}={}){let g="";h==="plain"?g="pl":h==="phrase"?g="ph":h==="websearch"&&(g="w");const m=f===void 0?"":`(${f})`;return this.url.searchParams.append(r,`${g}fts${m}.${o}`),this}match(r){return Object.entries(r).forEach(([o,f])=>{this.url.searchParams.append(o,`eq.${f}`)}),this}not(r,o,f){return this.url.searchParams.append(r,`not.${o}.${f}`),this}or(r,{foreignTable:o,referencedTable:f=o}={}){const h=f?`${f}.or`:"or";return this.url.searchParams.append(h,`(${r})`),this}filter(r,o,f){return this.url.searchParams.append(r,`${o}.${f}`),this}}return ig.default=n,ig}var m1;function FS(){if(m1)return ng;m1=1,Object.defineProperty(ng,"__esModule",{value:!0});const t=_f.__importDefault(sv());class n{constructor(r,{headers:o={},schema:f,fetch:h}){this.url=r,this.headers=new Headers(o),this.schema=f,this.fetch=h}select(r,o){const{head:f=!1,count:h}=o??{},g=f?"HEAD":"GET";let m=!1;const _=(r??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",_),h&&this.headers.append("Prefer",`count=${h}`),new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:o,defaultToNull:f=!0}={}){var h;const g="POST";if(o&&this.headers.append("Prefer",`count=${o}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((_,C)=>_.concat(Object.keys(C)),[]);if(m.length>0){const _=[...new Set(m)].map(C=>`"${C}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}upsert(r,{onConflict:o,ignoreDuplicates:f=!1,count:h,defaultToNull:g=!0}={}){var m;const _="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),h&&this.headers.append("Prefer",`count=${h}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const C=r.reduce((E,R)=>E.concat(Object.keys(R)),[]);if(C.length>0){const E=[...new Set(C)].map(R=>`"${R}"`);this.url.searchParams.set("columns",E.join(","))}}return new t.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:o}={}){var f;const h="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:r}={}){var o;const f="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return ng.default=n,ng}var v1;function w_(){if(v1)return eg;v1=1,Object.defineProperty(eg,"__esModule",{value:!0});const l=_f,t=l.__importDefault(FS()),n=l.__importDefault(sv());class i{constructor(o,{headers:f={},schema:h,fetch:g}={}){this.url=o,this.headers=new Headers(f),this.schemaName=h,this.fetch=g}from(o){const f=new URL(`${this.url}/${o}`);return new t.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new i(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,f={},{head:h=!1,get:g=!1,count:m}={}){var _;let C;const E=new URL(`${this.url}/rpc/${o}`);let R;h||g?(C=h?"HEAD":"GET",Object.entries(f).filter(([N,B])=>B!==void 0).map(([N,B])=>[N,Array.isArray(B)?`{${B.join(",")}}`:`${B}`]).forEach(([N,B])=>{E.searchParams.append(N,B)})):(C="POST",R=f);const v=new Headers(this.headers);return m&&v.set("Prefer",`count=${m}`),new n.default({method:C,url:E,headers:v,schema:this.schemaName,body:R,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}}return eg.default=i,eg}var y1;function R_(){if(y1)return ea;y1=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.PostgrestError=ea.PostgrestBuilder=ea.PostgrestTransformBuilder=ea.PostgrestFilterBuilder=ea.PostgrestQueryBuilder=ea.PostgrestClient=void 0;const l=_f,t=l.__importDefault(w_());ea.PostgrestClient=t.default;const n=l.__importDefault(FS());ea.PostgrestQueryBuilder=n.default;const i=l.__importDefault(sv());ea.PostgrestFilterBuilder=i.default;const r=l.__importDefault(XS());ea.PostgrestTransformBuilder=r.default;const o=l.__importDefault(QS());ea.PostgrestBuilder=o.default;const f=l.__importDefault(KS());return ea.PostgrestError=f.default,ea.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:o.default,PostgrestError:f.default},ea}var O_=R_();const x_=pf(O_),{PostgrestClient:M_,PostgrestQueryBuilder:LT,PostgrestFilterBuilder:GT,PostgrestTransformBuilder:PT,PostgrestBuilder:HT,PostgrestError:IT}=x_;class N_{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const i=n.node,r=parseInt(i.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const i=this.getWebSocketConstructor();return new i(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const j_="2.76.1",D_=`realtime-js/${j_}`,U_="1.0.0",Gm=1e4,B_=1e3,z_=100;var od;(function(l){l[l.connecting=0]="connecting",l[l.open=1]="open",l[l.closing=2]="closing",l[l.closed=3]="closed"})(od||(od={}));var Ei;(function(l){l.closed="closed",l.errored="errored",l.joined="joined",l.joining="joining",l.leaving="leaving"})(Ei||(Ei={}));var Vr;(function(l){l.close="phx_close",l.error="phx_error",l.join="phx_join",l.reply="phx_reply",l.leave="phx_leave",l.access_token="access_token"})(Vr||(Vr={}));var Pm;(function(l){l.websocket="websocket"})(Pm||(Pm={}));var pu;(function(l){l.Connecting="connecting",l.Open="open",l.Closing="closing",l.Closed="closed"})(pu||(pu={}));class L_{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,n,i)}_decodeBroadcast(t,n,i){const r=n.getUint8(1),o=n.getUint8(2);let f=this.HEADER_LENGTH+2;const h=i.decode(t.slice(f,f+r));f=f+r;const g=i.decode(t.slice(f,f+o));f=f+o;const m=JSON.parse(i.decode(t.slice(f,t.byteLength)));return{ref:null,topic:h,event:g,payload:m}}}class JS{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var jn;(function(l){l.abstime="abstime",l.bool="bool",l.date="date",l.daterange="daterange",l.float4="float4",l.float8="float8",l.int2="int2",l.int4="int4",l.int4range="int4range",l.int8="int8",l.int8range="int8range",l.json="json",l.jsonb="jsonb",l.money="money",l.numeric="numeric",l.oid="oid",l.reltime="reltime",l.text="text",l.time="time",l.timestamp="timestamp",l.timestamptz="timestamptz",l.timetz="timetz",l.tsrange="tsrange",l.tstzrange="tstzrange"})(jn||(jn={}));const S1=(l,t,n={})=>{var i;const r=(i=n.skipTypes)!==null&&i!==void 0?i:[];return t?Object.keys(t).reduce((o,f)=>(o[f]=G_(f,l,t,r),o),{}):{}},G_=(l,t,n,i)=>{const r=t.find(h=>h.name===l),o=r==null?void 0:r.type,f=n[l];return o&&!i.includes(o)?ZS(o,f):Hm(f)},ZS=(l,t)=>{if(l.charAt(0)==="_"){const n=l.slice(1,l.length);return k_(t,n)}switch(l){case jn.bool:return P_(t);case jn.float4:case jn.float8:case jn.int2:case jn.int4:case jn.int8:case jn.numeric:case jn.oid:return H_(t);case jn.json:case jn.jsonb:return I_(t);case jn.timestamp:return q_(t);case jn.abstime:case jn.date:case jn.daterange:case jn.int4range:case jn.int8range:case jn.money:case jn.reltime:case jn.text:case jn.time:case jn.timestamptz:case jn.timetz:case jn.tsrange:case jn.tstzrange:return Hm(t);default:return Hm(t)}},Hm=l=>l,P_=l=>{switch(l){case"t":return!0;case"f":return!1;default:return l}},H_=l=>{if(typeof l=="string"){const t=parseFloat(l);if(!Number.isNaN(t))return t}return l},I_=l=>{if(typeof l=="string")try{return JSON.parse(l)}catch(t){return console.log(`JSON parse error: ${t}`),l}return l},k_=(l,t)=>{if(typeof l!="string")return l;const n=l.length-1,i=l[n];if(l[0]==="{"&&i==="}"){let o;const f=l.slice(1,n);try{o=JSON.parse("["+f+"]")}catch{o=f?f.split(","):[]}return o.map(h=>ZS(t,h))}return l},q_=l=>typeof l=="string"?l.replace(" ","T"):l,WS=l=>{const t=new URL(l);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Ip{constructor(t,n,i={},r=Gm){this.channel=t,this.event=n,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var i;return this._hasReceived(t)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var b1;(function(l){l.SYNC="sync",l.JOIN="join",l.LEAVE="leave"})(b1||(b1={}));class ud{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:o,onLeave:f,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ud.syncState(this.state,r,o,f),this.pendingDiffs.forEach(g=>{this.state=ud.syncDiff(this.state,g,o,f)}),this.pendingDiffs=[],h()}),this.channel._on(i.diff,{},r=>{const{onJoin:o,onLeave:f,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=ud.syncDiff(this.state,r,o,f),h())}),this.onJoin((r,o,f)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:o,newPresences:f})}),this.onLeave((r,o,f)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:o,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,i,r){const o=this.cloneDeep(t),f=this.transformState(n),h={},g={};return this.map(o,(m,_)=>{f[m]||(g[m]=_)}),this.map(f,(m,_)=>{const C=o[m];if(C){const E=_.map(B=>B.presence_ref),R=C.map(B=>B.presence_ref),v=_.filter(B=>R.indexOf(B.presence_ref)<0),N=C.filter(B=>E.indexOf(B.presence_ref)<0);v.length>0&&(h[m]=v),N.length>0&&(g[m]=N)}else h[m]=_}),this.syncDiff(o,{joins:h,leaves:g},i,r)}static syncDiff(t,n,i,r){const{joins:o,leaves:f}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(o,(h,g)=>{var m;const _=(m=t[h])!==null&&m!==void 0?m:[];if(t[h]=this.cloneDeep(g),_.length>0){const C=t[h].map(R=>R.presence_ref),E=_.filter(R=>C.indexOf(R.presence_ref)<0);t[h].unshift(...E)}i(h,_,g)}),this.map(f,(h,g)=>{let m=t[h];if(!m)return;const _=g.map(C=>C.presence_ref);m=m.filter(C=>_.indexOf(C.presence_ref)<0),t[h]=m,r(h,m,g),m.length===0&&delete t[h]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(i=>n(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,i)=>{const r=t[i];return"metas"in r?n[i]=r.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[i]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _1;(function(l){l.ALL="*",l.INSERT="INSERT",l.UPDATE="UPDATE",l.DELETE="DELETE"})(_1||(_1={}));var cd;(function(l){l.BROADCAST="broadcast",l.PRESENCE="presence",l.POSTGRES_CHANGES="postgres_changes",l.SYSTEM="system"})(cd||(cd={}));var gl;(function(l){l.SUBSCRIBED="SUBSCRIBED",l.TIMED_OUT="TIMED_OUT",l.CLOSED="CLOSED",l.CHANNEL_ERROR="CHANNEL_ERROR"})(gl||(gl={}));class lv{constructor(t,n={config:{}},i){var r,o;if(this.topic=t,this.params=n,this.socket=i,this.bindings={},this.state=Ei.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Ip(this,Vr.join,this.params,this.timeout),this.rejoinTimer=new JS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ei.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ei.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Ei.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ei.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Ei.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vr.reply,{},(f,h)=>{this._trigger(this._replyEventName(h),f)}),this.presence=new ud(this),this.broadcastEndpointURL=WS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var i,r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Ei.closed){const{config:{broadcast:f,presence:h,private:g}}=this.params,m=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(R=>R.filter))!==null&&r!==void 0?r:[],_=!!this.bindings[cd.PRESENCE]&&this.bindings[cd.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,C={},E={broadcast:f,presence:Object.assign(Object.assign({},h),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(R=>t==null?void 0:t(gl.CHANNEL_ERROR,R)),this._onClose(()=>t==null?void 0:t(gl.CLOSED)),this.updateJoinPayload(Object.assign({config:E},C)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:R})=>{var v;if(this.socket.setAuth(),R===void 0){t==null||t(gl.SUBSCRIBED);return}else{const N=this.bindings.postgres_changes,B=(v=N==null?void 0:N.length)!==null&&v!==void 0?v:0,L=[];for(let j=0;j<B;j++){const M=N[j],{filter:{event:G,schema:O,table:A,filter:T}}=M,y=R&&R[j];if(y&&y.event===G&&y.schema===O&&y.table===A&&y.filter===T)L.push(Object.assign(Object.assign({},M),{id:y.id}));else{this.unsubscribe(),this.state=Ei.errored,t==null||t(gl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,t&&t(gl.SUBSCRIBED);return}}).receive("error",R=>{this.state=Ei.errored,t==null||t(gl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(R).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(gl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,i){return this.state===Ei.joined&&t===cd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,i)}async httpSend(t,n,i={}){var r;const o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},h=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(r=i.timeout)!==null&&r!==void 0?r:this.timeout);if(h.status===202)return{success:!0};let g=h.statusText;try{const m=await h.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(t,n={}){var i,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:f}=t,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var f,h,g;const m=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((g=(h=(f=this.params)===null||f===void 0?void 0:f.config)===null||h===void 0?void 0:h.broadcast)===null||g===void 0)&&g.ack)&&o("ok"),m.receive("ok",()=>o("ok")),m.receive("error",()=>o("error")),m.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ei.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vr.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Ip(this,Vr.leave,{},t),i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ei.closed,this.bindings={}}async _fetchWithTimeout(t,n,i){const r=new AbortController,o=setTimeout(()=>r.abort(),i),f=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(o),f}_push(t,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Ip(this,t,n,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>z_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,i){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,i){var r,o;const f=t.toLocaleLowerCase(),{close:h,error:g,leave:m,join:_}=Vr;if(i&&[h,g,m,_].indexOf(f)>=0&&i!==this._joinRef())return;let E=this._onMessage(f,n,i);if(n&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(R=>{var v,N,B;return((v=R.filter)===null||v===void 0?void 0:v.event)==="*"||((B=(N=R.filter)===null||N===void 0?void 0:N.event)===null||B===void 0?void 0:B.toLocaleLowerCase())===f}).map(R=>R.callback(E,i)):(o=this.bindings[f])===null||o===void 0||o.filter(R=>{var v,N,B,L,j,M;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in R){const G=R.id,O=(v=R.filter)===null||v===void 0?void 0:v.event;return G&&((N=n.ids)===null||N===void 0?void 0:N.includes(G))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((B=n.data)===null||B===void 0?void 0:B.type.toLocaleLowerCase()))}else{const G=(j=(L=R==null?void 0:R.filter)===null||L===void 0?void 0:L.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return G==="*"||G===((M=n==null?void 0:n.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===f}).map(R=>{if(typeof E=="object"&&"ids"in E){const v=E.data,{schema:N,table:B,commit_timestamp:L,type:j,errors:M}=v;E=Object.assign(Object.assign({},{schema:N,table:B,commit_timestamp:L,eventType:j,new:{},old:{},errors:M}),this._getPayloadRecords(v))}R.callback(E,i)})}_isClosed(){return this.state===Ei.closed}_isJoined(){return this.state===Ei.joined}_isJoining(){return this.state===Ei.joining}_isLeaving(){return this.state===Ei.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,i){const r=t.toLocaleLowerCase(),o={type:r,filter:n,callback:i};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(t,n){const i=t.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var o;return!(((o=r.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===i&&lv.isEqual(r.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(t[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Vr.close,{},t)}_onError(t){this._on(Vr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ei.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=S1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=S1(t.columns,t.old_record)),n}}const kp=()=>{},lg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},V_=[1e3,2e3,5e3,1e4],Y_=1e4,K_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Q_{constructor(t,n){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gm,this.transport=null,this.heartbeatIntervalMs=lg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=kp,this.ref=0,this.reconnectTimer=null,this.logger=kp,this.conn=null,this.sendBuffer=[],this.serializer=new L_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...f)=>Au(async()=>{const{default:h}=await Promise.resolve().then(()=>wu);return{default:h}},void 0).then(({default:h})=>h(...f)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...f)=>o(...f)},!(!((i=n==null?void 0:n.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${Pm.websocket}`,this.httpEndpoint=WS(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=N_.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:U_}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,i){this.logger(t,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case od.connecting:return pu.Connecting;case od.open:return pu.Open;case od.closing:return pu.Closing;default:return pu.Closed}}isConnected(){return this.connectionState()===pu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const i=`realtime:${t}`,r=this.getChannels().find(o=>o.topic===i);if(r)return r;{const o=new lv(`realtime:${t}`,n,this);return this.channels.push(o),o}}push(t){const{topic:n,event:i,payload:r,ref:o}=t,f=()=>{this.encode(t,h=>{var g;(g=this.conn)===null||g===void 0||g.send(h)})};this.log("push",`${n} ${i} (${o})`,r),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(B_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},lg.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:o,ref:f}=n,h=f?`(${f})`:"",g=o.status||"";this.log("receive",`${g} ${i} ${r} ${h}`.trim(),o),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(r,o,f)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Vr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const i=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${i}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const i=new Blob([K_],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(i=>{const r={access_token:n,version:D_};n&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Vr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(i=>{try{i(n)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(i){this.log("error",`error triggering ${t} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new JS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,i,r,o,f,h,g,m,_;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(i=t==null?void 0:t.timeout)!==null&&i!==void 0?i:Gm,this.heartbeatIntervalMs=(r=t==null?void 0:t.heartbeatIntervalMs)!==null&&r!==void 0?r:lg.HEARTBEAT_INTERVAL,this.worker=(o=t==null?void 0:t.worker)!==null&&o!==void 0?o:!1,this.accessToken=(f=t==null?void 0:t.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(h=t==null?void 0:t.heartbeatCallback)!==null&&h!==void 0?h:kp,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(C=>V_[C-1]||Y_),this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((C,E)=>E(JSON.stringify(C))),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ov extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Qn(l){return typeof l=="object"&&l!==null&&"__isStorageError"in l}class X_ extends ov{constructor(t,n,i){super(t),this.name="StorageApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Im extends ov{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const uv=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...n)=>Au(async()=>{const{default:i}=await Promise.resolve().then(()=>wu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},F_=()=>le(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Au(()=>Promise.resolve().then(()=>wu),void 0)).Response:Response}),km=l=>{if(Array.isArray(l))return l.map(n=>km(n));if(typeof l=="function"||l!==Object(l))return l;const t={};return Object.entries(l).forEach(([n,i])=>{const r=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[r]=km(i)}),t},J_=l=>{if(typeof l!="object"||l===null)return!1;const t=Object.getPrototypeOf(l);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},qp=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Z_=(l,t,n)=>le(void 0,void 0,void 0,function*(){const i=yield F_();l instanceof i&&!(n!=null&&n.noResolveJson)?l.json().then(r=>{const o=l.status||500,f=(r==null?void 0:r.statusCode)||o+"";t(new X_(qp(r),o,f))}).catch(r=>{t(new Im(qp(r),r))}):t(new Im(qp(l),l))}),W_=(l,t,n,i)=>{const r={method:l,headers:(t==null?void 0:t.headers)||{}};return l==="GET"||!i?r:(J_(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,t!=null&&t.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),n))};function Sd(l,t,n,i,r,o){return le(this,void 0,void 0,function*(){return new Promise((f,h)=>{l(n,W_(t,i,r,o)).then(g=>{if(!g.ok)throw g;return i!=null&&i.noResolveJson?g:g.json()}).then(g=>f(g)).catch(g=>Z_(g,h,i))})})}function gd(l,t,n,i){return le(this,void 0,void 0,function*(){return Sd(l,"GET",t,n,i)})}function qr(l,t,n,i,r){return le(this,void 0,void 0,function*(){return Sd(l,"POST",t,i,r,n)})}function qm(l,t,n,i,r){return le(this,void 0,void 0,function*(){return Sd(l,"PUT",t,i,r,n)})}function $_(l,t,n,i){return le(this,void 0,void 0,function*(){return Sd(l,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function cv(l,t,n,i,r){return le(this,void 0,void 0,function*(){return Sd(l,"DELETE",t,i,r,n)})}class tE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return le(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}}var $S;class eE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[$S]="BlobDownloadBuilder",this.promise=null}asStream(){return new tE(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return le(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}}$S=Symbol.toStringTag;const nE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},E1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class iE{constructor(t,n={},i,r){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=i,this.fetch=uv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,i,r){return le(this,void 0,void 0,function*(){try{let o;const f=Object.assign(Object.assign({},E1),r);let h=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(f.upsert)});const g=f.metadata;typeof Blob<"u"&&i instanceof Blob?(o=new FormData,o.append("cacheControl",f.cacheControl),g&&o.append("metadata",this.encodeMetadata(g)),o.append("",i)):typeof FormData<"u"&&i instanceof FormData?(o=i,o.append("cacheControl",f.cacheControl),g&&o.append("metadata",this.encodeMetadata(g))):(o=i,h["cache-control"]=`max-age=${f.cacheControl}`,h["content-type"]=f.contentType,g&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),r!=null&&r.headers&&(h=Object.assign(Object.assign({},h),r.headers));const m=this._removeEmptyFolders(n),_=this._getFinalPath(m),C=yield(t=="PUT"?qm:qr)(this.fetch,`${this.url}/object/${_}`,o,Object.assign({headers:h},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:C.Id,fullPath:C.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Qn(o))return{data:null,error:o};throw o}})}upload(t,n,i){return le(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,i)})}uploadToSignedUrl(t,n,i,r){return le(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),f=this._getFinalPath(o),h=new URL(this.url+`/object/upload/sign/${f}`);h.searchParams.set("token",n);try{let g;const m=Object.assign({upsert:E1.upsert},r),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&i instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",i)):typeof FormData<"u"&&i instanceof FormData?(g=i,g.append("cacheControl",m.cacheControl)):(g=i,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType);const C=yield qm(this.fetch,h.toString(),g,{headers:_});return{data:{path:o,fullPath:C.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(Qn(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(t,n){return le(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const o=yield qr(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),f=new URL(this.url+o.url),h=f.searchParams.get("token");if(!h)throw new ov("No token returned by API");return{data:{signedUrl:f.toString(),path:t,token:h},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qn(i))return{data:null,error:i};throw i}})}update(t,n,i){return le(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,i)})}move(t,n,i){return le(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}copy(t,n,i){return le(this,void 0,void 0,function*(){try{return{data:{path:(yield qr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,i){return le(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),o=yield qr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const f=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${f}`)},{data:o,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,i){return le(this,void 0,void 0,function*(){try{const r=yield qr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),o=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${o}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}download(t,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),f=o?`?${o}`:"",h=this._getFinalPath(t),g=()=>gd(this.fetch,`${this.url}/${r}/${h}${f}`,{headers:this.headers,noResolveJson:!0});return new eE(g,this.shouldThrowOnError)}info(t){return le(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const i=yield gd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:km(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qn(i))return{data:null,error:i};throw i}})}exists(t){return le(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield $_(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qn(i)&&i instanceof Im){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,n){const i=this._getFinalPath(t),r=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&r.push(o);const h=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});g!==""&&r.push(g);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${i}${m}`)}}}remove(t){return le(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qn(n))return{data:null,error:n};throw n}})}list(t,n,i){return le(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},nE),n),{prefix:t||""});return{data:yield qr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}listV2(t,n){return le(this,void 0,void 0,function*(){try{const i=Object.assign({},t);return{data:yield qr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qn(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const tb="2.76.1",eb={"X-Client-Info":`storage-js/${tb}`};class aE{constructor(t,n={},i,r){this.shouldThrowOnError=!1;const o=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},eb),n),this.fetch=uv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return le(this,void 0,void 0,function*(){try{return{data:yield gd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}getBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield gd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qn(n))return{data:null,error:n};throw n}})}createBucket(t){return le(this,arguments,void 0,function*(n,i={public:!1}){try{return{data:yield qr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return le(this,void 0,void 0,function*(){try{return{data:yield qm(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qn(i))return{data:null,error:i};throw i}})}emptyBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qn(n))return{data:null,error:n};throw n}})}}class rE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},eb),n),this.fetch=uv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qn(n))return{data:null,error:n};throw n}})}listBuckets(t){return le(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const i=n.toString(),r=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`,o=yield gd(this.fetch,r,{headers:this.headers});return{data:Array.isArray(o)?o.filter(h=>h.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qn(n))return{data:null,error:n};throw n}})}}const fv={"X-Client-Info":`storage-js/${tb}`,"Content-Type":"application/json"};class nb extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ka(l){return typeof l=="object"&&l!==null&&"__isStorageVectorsError"in l}class Vp extends nb{constructor(t,n,i){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sE extends nb{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var C1;(function(l){l.InternalError="InternalError",l.S3VectorConflictException="S3VectorConflictException",l.S3VectorNotFoundException="S3VectorNotFoundException",l.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",l.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",l.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(C1||(C1={}));const hv=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...n)=>Au(async()=>{const{default:i}=await Promise.resolve().then(()=>wu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},lE=l=>{if(typeof l!="object"||l===null)return!1;const t=Object.getPrototypeOf(l);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},T1=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),oE=(l,t,n)=>le(void 0,void 0,void 0,function*(){if(l&&typeof l=="object"&&"status"in l&&"ok"in l&&typeof l.status=="number"&&!(n!=null&&n.noResolveJson)){const r=l.status||500,o=l;if(typeof o.json=="function")o.json().then(f=>{const h=(f==null?void 0:f.statusCode)||(f==null?void 0:f.code)||r+"";t(new Vp(T1(f),r,h))}).catch(()=>{const f=r+"",h=o.statusText||`HTTP ${r} error`;t(new Vp(h,r,f))});else{const f=r+"",h=o.statusText||`HTTP ${r} error`;t(new Vp(h,r,f))}}else t(new sE(T1(l),l))}),uE=(l,t,n,i)=>{const r={method:l,headers:(t==null?void 0:t.headers)||{}};return i?(lE(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),n)):r};function cE(l,t,n,i,r,o){return le(this,void 0,void 0,function*(){return new Promise((f,h)=>{l(n,uE(t,i,r,o)).then(g=>{if(!g.ok)throw g;if(i!=null&&i.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>f(g)).catch(g=>oE(g,h,i))})})}function qa(l,t,n,i,r){return le(this,void 0,void 0,function*(){return cE(l,"POST",t,i,r,n)})}class fE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return le(this,void 0,void 0,function*(){try{return{data:(yield qa(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}getIndex(t,n){return le(this,void 0,void 0,function*(){try{return{data:yield qa(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ka(i))return{data:null,error:i};throw i}})}listIndexes(t){return le(this,void 0,void 0,function*(){try{return{data:yield qa(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return le(this,void 0,void 0,function*(){try{return{data:(yield qa(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ka(i))return{data:null,error:i};throw i}})}}class hE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return le(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield qa(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}getVectors(t){return le(this,void 0,void 0,function*(){try{return{data:yield qa(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}listVectors(t){return le(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield qa(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}queryVectors(t){return le(this,void 0,void 0,function*(){try{return{data:yield qa(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}deleteVectors(t){return le(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield qa(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}}class dE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return le(this,void 0,void 0,function*(){try{return{data:(yield qa(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}getBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield qa(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}listBuckets(){return le(this,arguments,void 0,function*(t={}){try{return{data:yield qa(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}deleteBucket(t){return le(this,void 0,void 0,function*(){try{return{data:(yield qa(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}})}}class gE extends dE{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new pE(this.url,this.headers,t,this.fetch)}}class pE extends fE{constructor(t,n,i,r){super(t,n,r),this.vectorBucketName=i}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return le(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return le(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return le(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return le(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new mE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class mE extends hE{constructor(t,n,i,r,o){super(t,n,o),this.vectorBucketName=i,this.indexName=r}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return le(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return le(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return le(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return le(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return le(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vE extends aE{constructor(t,n={},i,r){super(t,n,i,r)}from(t){return new iE(this.url,this.headers,t,this.fetch)}get vectors(){return new gE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new rE(this.url+"/iceberg",this.headers,this.fetch)}}const yE="2.76.1";let id="";typeof Deno<"u"?id="deno":typeof document<"u"?id="web":typeof navigator<"u"&&navigator.product==="ReactNative"?id="react-native":id="node";const SE={"X-Client-Info":`supabase-js-${id}/${yE}`},bE={headers:SE},_E={schema:"public"},EE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},CE={},TE=l=>{let t;return l?t=l:typeof fetch>"u"?t=VS:t=fetch,(...n)=>t(...n)},AE=()=>typeof Headers>"u"?YS:Headers,wE=(l,t,n)=>{const i=TE(n),r=AE();return async(o,f)=>{var h;const g=(h=await t())!==null&&h!==void 0?h:l;let m=new r(f==null?void 0:f.headers);return m.has("apikey")||m.set("apikey",l),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),i(o,Object.assign(Object.assign({},f),{headers:m}))}};function RE(l){return l.endsWith("/")?l:l+"/"}function OE(l,t){var n,i;const{db:r,auth:o,realtime:f,global:h}=l,{db:g,auth:m,realtime:_,global:C}=t,E={db:Object.assign(Object.assign({},g),r),auth:Object.assign(Object.assign({},m),o),realtime:Object.assign(Object.assign({},_),f),storage:{},global:Object.assign(Object.assign(Object.assign({},C),h),{headers:Object.assign(Object.assign({},(n=C==null?void 0:C.headers)!==null&&n!==void 0?n:{}),(i=h==null?void 0:h.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return l.accessToken?E.accessToken=l.accessToken:delete E.accessToken,E}function xE(l){const t=l==null?void 0:l.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(RE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const ib="2.76.1",lf=30*1e3,Vm=3,Yp=Vm*lf,ME="http://localhost:9999",NE="supabase.auth.token",jE={"X-Client-Info":`gotrue-js/${ib}`},Ym="X-Supabase-Api-Version",ab={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},DE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,UE=600*1e3;class pd extends Error{constructor(t,n,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function be(l){return typeof l=="object"&&l!==null&&"__isAuthError"in l}class BE extends pd{constructor(t,n,i){super(t,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function zE(l){return be(l)&&l.name==="AuthApiError"}class mu extends pd{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class yo extends pd{constructor(t,n,i,r){super(t,i,r),this.name=n,this.status=i}}class lo extends yo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function LE(l){return be(l)&&l.name==="AuthSessionMissingError"}class Wc extends yo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class og extends yo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ug extends yo{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function GE(l){return be(l)&&l.name==="AuthImplicitGrantRedirectError"}class A1 extends yo{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Km extends yo{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Kp(l){return be(l)&&l.name==="AuthRetryableFetchError"}class w1 extends yo{constructor(t,n,i){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}class Qm extends yo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Sg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),R1=` 	
\r=`.split(""),PE=(()=>{const l=new Array(128);for(let t=0;t<l.length;t+=1)l[t]=-1;for(let t=0;t<R1.length;t+=1)l[R1[t].charCodeAt(0)]=-2;for(let t=0;t<Sg.length;t+=1)l[Sg[t].charCodeAt(0)]=t;return l})();function O1(l,t,n){if(l!==null)for(t.queue=t.queue<<8|l,t.queuedBits+=8;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(Sg[i]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(Sg[i]),t.queuedBits-=6}}function rb(l,t,n){const i=PE[l];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(l)}"`)}}function x1(l){const t=[],n=f=>{t.push(String.fromCodePoint(f))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},o=f=>{kE(f,i,n)};for(let f=0;f<l.length;f+=1)rb(l.charCodeAt(f),r,o);return t.join("")}function HE(l,t){if(l<=127){t(l);return}else if(l<=2047){t(192|l>>6),t(128|l&63);return}else if(l<=65535){t(224|l>>12),t(128|l>>6&63),t(128|l&63);return}else if(l<=1114111){t(240|l>>18),t(128|l>>12&63),t(128|l>>6&63),t(128|l&63);return}throw new Error(`Unrecognized Unicode codepoint: ${l.toString(16)}`)}function IE(l,t){for(let n=0;n<l.length;n+=1){let i=l.charCodeAt(n);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(l.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}HE(i,t)}}function kE(l,t,n){if(t.utf8seq===0){if(l<=127){n(l);return}for(let i=1;i<6;i+=1)if((l>>7-i&1)===0){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=l&31;else if(t.utf8seq===3)t.codepoint=l&15;else if(t.utf8seq===4)t.codepoint=l&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(l<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|l&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function cf(l){const t=[],n={queue:0,queuedBits:0},i=r=>{t.push(r)};for(let r=0;r<l.length;r+=1)rb(l.charCodeAt(r),n,i);return new Uint8Array(t)}function qE(l){const t=[];return IE(l,n=>t.push(n)),new Uint8Array(t)}function yu(l){const t=[],n={queue:0,queuedBits:0},i=r=>{t.push(r)};return l.forEach(r=>O1(r,n,i)),O1(null,n,i),t.join("")}function VE(l){return Math.round(Date.now()/1e3)+l}function YE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){const t=Math.random()*16|0;return(l=="x"?t:t&3|8).toString(16)})}const Ha=()=>typeof window<"u"&&typeof document<"u",uu={tested:!1,writable:!1},sb=()=>{if(!Ha())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(uu.tested)return uu.writable;const l=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(l,l),globalThis.localStorage.removeItem(l),uu.tested=!0,uu.writable=!0}catch{uu.tested=!0,uu.writable=!1}return uu.writable};function KE(l){const t={},n=new URL(l);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,o)=>{t[o]=r})}catch{}return n.searchParams.forEach((i,r)=>{t[r]=i}),t}const lb=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...n)=>Au(async()=>{const{default:i}=await Promise.resolve().then(()=>wu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},QE=l=>typeof l=="object"&&l!==null&&"status"in l&&"ok"in l&&"json"in l&&typeof l.json=="function",of=async(l,t,n)=>{await l.setItem(t,JSON.stringify(n))},cu=async(l,t)=>{const n=await l.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},io=async(l,t)=>{await l.removeItem(t)};class Dg{constructor(){this.promise=new Dg.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Dg.promiseConstructor=Promise;function Qp(l){const t=l.split(".");if(t.length!==3)throw new Qm("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!DE.test(t[i]))throw new Qm("JWT not in base64url format");return{header:JSON.parse(x1(t[0])),payload:JSON.parse(x1(t[1])),signature:cf(t[2]),raw:{header:t[0],payload:t[1]}}}async function XE(l){return await new Promise(t=>{setTimeout(()=>t(null),l)})}function FE(l,t){return new Promise((i,r)=>{(async()=>{for(let o=0;o<1/0;o++)try{const f=await l(o);if(!t(o,null,f)){i(f);return}}catch(f){if(!t(o,f)){r(f);return}}})()})}function JE(l){return("0"+l.toString(16)).substr(-2)}function ZE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let r="";for(let o=0;o<56;o++)r+=n.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(t),Array.from(t,JE).join("")}async function WE(l){const n=new TextEncoder().encode(l),i=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(i);return Array.from(r).map(o=>String.fromCharCode(o)).join("")}async function $E(l){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),l;const n=await WE(l);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $c(l,t,n=!1){const i=ZE();let r=i;n&&(r+="/PASSWORD_RECOVERY"),await of(l,`${t}-code-verifier`,r);const o=await $E(i);return[o,i===o?"plain":"s256"]}const tC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function eC(l){const t=l.headers.get(Ym);if(!t||!t.match(tC))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function nC(l){if(!l)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(l<=t)throw new Error("JWT has expired")}function iC(l){switch(l){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const aC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tf(l){if(!aC.test(l))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xp(){const l={};return new Proxy(l,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function M1(l){return JSON.parse(JSON.stringify(l))}const du=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),rC=[502,503,504];async function N1(l){var t;if(!QE(l))throw new Km(du(l),0);if(rC.includes(l.status))throw new Km(du(l),l.status);let n;try{n=await l.json()}catch(o){throw new mu(du(o),o)}let i;const r=eC(l);if(r&&r.getTime()>=ab["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new w1(du(n),l.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new lo}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,f)=>o&&typeof f=="string",!0))throw new w1(du(n),l.status,n.weak_password.reasons);throw new BE(du(n),l.status||500,i)}const sC=(l,t,n,i)=>{const r={method:l,headers:(t==null?void 0:t.headers)||{}};return l==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))};async function Ne(l,t,n,i){var r;const o=Object.assign({},i==null?void 0:i.headers);o[Ym]||(o[Ym]=ab["2024-01-01"].name),i!=null&&i.jwt&&(o.Authorization=`Bearer ${i.jwt}`);const f=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(f.redirect_to=i.redirectTo);const h=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",g=await lC(l,t,n+h,{headers:o,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(g):{data:Object.assign({},g),error:null}}async function lC(l,t,n,i,r,o){const f=sC(t,i,r,o);let h;try{h=await l(n,Object.assign({},f))}catch(g){throw console.error(g),new Km(du(g),0)}if(h.ok||await N1(h),i!=null&&i.noResolveJson)return h;try{return await h.json()}catch(g){await N1(g)}}function kr(l){var t;let n=null;cC(l)&&(n=Object.assign({},l),l.expires_at||(n.expires_at=VE(l.expires_in)));const i=(t=l.user)!==null&&t!==void 0?t:l;return{data:{session:n,user:i},error:null}}function j1(l){const t=kr(l);return!t.error&&l.weak_password&&typeof l.weak_password=="object"&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.message&&typeof l.weak_password.message=="string"&&l.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(t.data.weak_password=l.weak_password),t}function uo(l){var t;return{data:{user:(t=l.user)!==null&&t!==void 0?t:l},error:null}}function oC(l){return{data:l,error:null}}function uC(l){const{action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:o}=l,f=bf(l,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:o},g=Object.assign({},f);return{data:{properties:h,user:g},error:null}}function D1(l){return l}function cC(l){return l.access_token&&l.refresh_token&&l.expires_in}const Fp=["global","local","others"];class fC{constructor({url:t="",headers:n={},fetch:i}){this.url=t,this.headers=n,this.fetch=lb(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Fp[0]){if(Fp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fp.join(", ")}`);try{return await Ne(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(be(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,n={}){try{return await Ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:uo})}catch(i){if(be(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:n}=t,i=bf(t,["options"]),r=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await Ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:uC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(be(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Ne(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:uo})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,i,r,o,f,h,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:D1});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(h=_.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const N=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(v.split(";")[1].split("=")[1]);m[`${B}Page`]=N}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(be(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){tf(t);try{return await Ne(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:uo})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){tf(t);try{return await Ne(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:uo})}catch(i){if(be(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,n=!1){tf(t);try{return await Ne(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:uo})}catch(i){if(be(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){tf(t.userId);try{const{data:n,error:i}=await Ne(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:i}}catch(n){if(be(n))return{data:null,error:n};throw n}}async _deleteFactor(t){tf(t.userId),tf(t.id);try{return{data:await Ne(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,i,r,o,f,h,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Ne(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:D1});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(h=_.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const N=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(v.split(";")[1].split("=")[1]);m[`${B}Page`]=N}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(be(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await Ne(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await Ne(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ne(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await Ne(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}}function U1(l={}){return{getItem:t=>l[t]||null,setItem:(t,n)=>{l[t]=n},removeItem:t=>{delete l[t]}}}const ef={debug:!!(globalThis&&sb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ob extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class hC extends ob{}async function dC(l,t,n){ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",l,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),ef.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",l)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(l,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",l,r.name);try{return await n()}finally{ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",l,r.name)}}else{if(t===0)throw ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",l),new hC(`Acquiring an exclusive Navigator LockManager lock "${l}" immediately failed`);if(ef.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function gC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ub(l){if(!/^0x[a-fA-F0-9]{40}$/.test(l))throw new Error(`@supabase/auth-js: Address "${l}" is invalid.`);return l.toLowerCase()}function pC(l){return parseInt(l,16)}function mC(l){const t=new TextEncoder().encode(l);return"0x"+Array.from(t,i=>i.toString(16).padStart(2,"0")).join("")}function vC(l){var t;const{chainId:n,domain:i,expirationTime:r,issuedAt:o=new Date,nonce:f,notBefore:h,requestId:g,resources:m,scheme:_,uri:C,version:E}=l;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((t=l.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${l.statement}`)}const R=ub(l.address),v=_?`${_}://${i}`:i,N=l.statement?`${l.statement}
`:"",B=`${v} wants you to sign in with your Ethereum account:
${R}

${N}`;let L=`URI: ${C}
Version: ${E}
Chain ID: ${n}${f?`
Nonce: ${f}`:""}
Issued At: ${o.toISOString()}`;if(r&&(L+=`
Expiration Time: ${r.toISOString()}`),h&&(L+=`
Not Before: ${h.toISOString()}`),g&&(L+=`
Request ID: ${g}`),m){let j=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);j+=`
- ${M}`}L+=j}return`${B}
${L}`}class fi extends Error{constructor({message:t,code:n,cause:i,name:r}){var o;super(t,{cause:i}),this.__isWebAuthnError=!0,this.name=(o=r??(i instanceof Error?i.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=n}}class bg extends fi{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function yC({error:l,options:t}){var n,i,r;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(t.signal instanceof AbortSignal)return new fi({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else if(l.name==="ConstraintError"){if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new fi({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:l});if(t.mediation==="conditional"&&((i=o.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new fi({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:l});if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new fi({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:l})}else{if(l.name==="InvalidStateError")return new fi({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:l});if(l.name==="NotAllowedError")return new fi({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="NotSupportedError")return o.pubKeyCredParams.filter(h=>h.type==="public-key").length===0?new fi({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:l}):new fi({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:l});if(l.name==="SecurityError"){const f=window.location.hostname;if(cb(f)){if(o.rp.id!==f)return new fi({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new fi({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new fi({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:l})}else if(l.name==="UnknownError")return new fi({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new fi({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}function SC({error:l,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(t.signal instanceof AbortSignal)return new fi({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else{if(l.name==="NotAllowedError")return new fi({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="SecurityError"){const i=window.location.hostname;if(cb(i)){if(n.rpId!==i)return new fi({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new fi({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="UnknownError")return new fi({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new fi({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}class bC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const _C=new bC;function EC(l){if(!l)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(l);const{challenge:t,user:n,excludeCredentials:i}=l,r=bf(l,["challenge","user","excludeCredentials"]),o=cf(t).buffer,f=Object.assign(Object.assign({},n),{id:cf(n.id).buffer}),h=Object.assign(Object.assign({},r),{challenge:o,user:f});if(i&&i.length>0){h.excludeCredentials=new Array(i.length);for(let g=0;g<i.length;g++){const m=i[g];h.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:cf(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return h}function CC(l){if(!l)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(l);const{challenge:t,allowCredentials:n}=l,i=bf(l,["challenge","allowCredentials"]),r=cf(t).buffer,o=Object.assign(Object.assign({},i),{challenge:r});if(n&&n.length>0){o.allowCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const h=n[f];o.allowCredentials[f]=Object.assign(Object.assign({},h),{id:cf(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return o}function TC(l){var t;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const n=l;return{id:l.id,rawId:l.id,response:{attestationObject:yu(new Uint8Array(l.response.attestationObject)),clientDataJSON:yu(new Uint8Array(l.response.clientDataJSON))},type:"public-key",clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function AC(l){var t;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const n=l,i=l.getClientExtensionResults(),r=l.response;return{id:l.id,rawId:l.id,response:{authenticatorData:yu(new Uint8Array(r.authenticatorData)),clientDataJSON:yu(new Uint8Array(r.clientDataJSON)),signature:yu(new Uint8Array(r.signature)),userHandle:r.userHandle?yu(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function cb(l){return l==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(l)}function B1(){var l,t;return!!(Ha()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((l=navigator==null?void 0:navigator.credentials)===null||l===void 0?void 0:l.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function wC(l){try{const t=await navigator.credentials.create(l);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new bg("Browser returned unexpected credential type",t)}:{data:null,error:new bg("Empty credential response",t)}}catch(t){return{data:null,error:yC({error:t,options:l})}}}async function RC(l){try{const t=await navigator.credentials.get(l);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new bg("Browser returned unexpected credential type",t)}:{data:null,error:new bg("Empty credential response",t)}}catch(t){return{data:null,error:SC({error:t,options:l})}}}const OC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},xC={userVerification:"preferred",hints:["security-key"]};function _g(...l){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),i={};for(const r of l)if(r)for(const o in r){const f=r[o];if(f!==void 0)if(Array.isArray(f))i[o]=f;else if(n(f))i[o]=f;else if(t(f)){const h=i[o];t(h)?i[o]=_g(h,f):i[o]=_g(f)}else i[o]=f}return i}function MC(l,t){return _g(OC,l,t||{})}function NC(l,t){return _g(xC,l,t||{})}class jC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:i,signal:r},o){try{const{data:f,error:h}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!f)return{data:null,error:h};const g=r??_C.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=MC(f.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:_,error:C}=await wC({publicKey:m,signal:g});return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}case"request":{const m=NC(f.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:_,error:C}=await RC(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}}}catch(f){return be(f)?{data:null,error:f}:{data:null,error:new mu("Unexpected error in challenge",f)}}}async _verify({challengeId:t,factorId:n,webauthn:i}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:i})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r}},o){if(!n)return{data:null,error:new pd("rpId is required for WebAuthn authentication")};try{if(!B1())return{data:null,error:new mu("Browser does not support WebAuthn",null)};const{data:f,error:h}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:i},signal:r},{request:o});if(!f)return{data:null,error:h};const{webauthn:g}=f;return this._verify({factorId:t,challengeId:f.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:i,credential_response:g.credential_response}})}catch(f){return be(f)?{data:null,error:f}:{data:null,error:new mu("Unexpected error in authenticate",f)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r},o){if(!n)return{data:null,error:new pd("rpId is required for WebAuthn registration")};try{if(!B1())return{data:null,error:new mu("Browser does not support WebAuthn",null)};const{data:f,error:h}=await this._enroll({friendlyName:t});if(!f)return await this.client.mfa.listFactors().then(_=>{var C;return(C=_.data)===null||C===void 0?void 0:C.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===t&&E.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:h};const{data:g,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:n,rpOrigins:i},signal:r},{create:o});return g?this._verify({factorId:f.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:i,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(f){return be(f)?{data:null,error:f}:{data:null,error:new mu("Unexpected error in register",f)}}}}gC();const DC={url:ME,storageKey:NE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:jE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function z1(l,t,n){return await n()}const nf={};class md{get jwks(){var t,n;return(n=(t=nf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){nf[this.storageKey]=Object.assign(Object.assign({},nf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=nf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){nf[this.storageKey]=Object.assign(Object.assign({},nf[this.storageKey]),{cachedAt:t})}constructor(t){var n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=md.nextInstanceID,md.nextInstanceID+=1,this.instanceID>0&&Ha()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},DC),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new fC({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=lb(r.fetch),this.lock=r.lock||z1,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ha()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=dC:this.lock=z1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new jC(this)},this.persistSession?(r.storage?this.storage=r.storage:sb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=U1(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=U1(this.memoryStorage)),Ha()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ib}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=KE(window.location.href);let i="none";if(this._isImplicitGrantCallback(n)?i="implicit":await this._isPKCECallback(n)&&(i="pkce"),Ha()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:o}=await this._getSessionFromURL(n,i);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),GE(o)){const g=(t=o.details)===null||t===void 0?void 0:t.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:f,redirectType:h}=r;return this._debug("#_initialize()","detected session in URL",f,"redirect type",h),await this._saveSession(f),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return be(n)?{error:n}:{error:new mu("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,i,r;try{const o=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:kr}),{data:f,error:h}=o;if(h||!f)return{data:{user:null,session:null},error:h};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(o){if(be(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(t){var n,i,r;try{let o;if("email"in t){const{email:_,password:C,options:E}=t;let R=null,v=null;this.flowType==="pkce"&&([R,v]=await $c(this.storage,this.storageKey)),o=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:_,password:C,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:R,code_challenge_method:v},xform:kr})}else if("phone"in t){const{phone:_,password:C,options:E}=t;o=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:C,data:(i=E==null?void 0:E.data)!==null&&i!==void 0?i:{},channel:(r=E==null?void 0:E.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:kr})}else throw new og("You must provide either an email or phone number and a password");const{data:f,error:h}=o;if(h||!f)return{data:{user:null,session:null},error:h};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(o){if(be(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(t){try{let n;if("email"in t){const{email:o,password:f,options:h}=t;n=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:f,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:j1})}else if("phone"in t){const{phone:o,password:f,options:h}=t;n=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:f,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:j1})}else throw new og("You must provide either an email or phone number and a password");const{data:i,error:r}=n;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Wc}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,i,r,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,i,r,o,f,h,g,m,_,C,E;let R,v;if("message"in t)R=t.message,v=t.signature;else{const{chain:N,wallet:B,statement:L,options:j}=t;let M;if(Ha())if(typeof B=="object")M=B;else{const z=window;if("ethereum"in z&&typeof z.ethereum=="object"&&"request"in z.ethereum&&typeof z.ethereum.request=="function")M=z.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof B!="object"||!(j!=null&&j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=B}const G=new URL((n=j==null?void 0:j.url)!==null&&n!==void 0?n:window.location.href),O=await M.request({method:"eth_requestAccounts"}).then(z=>z).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=ub(O[0]);let T=(i=j==null?void 0:j.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!T){const z=await M.request({method:"eth_chainId"});T=pC(z)}const y={domain:G.host,address:A,statement:L,uri:G.href,version:"1",chainId:T,nonce:(r=j==null?void 0:j.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(f=(o=j==null?void 0:j.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(h=j==null?void 0:j.signInWithEthereum)===null||h===void 0?void 0:h.expirationTime,notBefore:(g=j==null?void 0:j.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=j==null?void 0:j.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=j==null?void 0:j.signInWithEthereum)===null||_===void 0?void 0:_.resources};R=vC(y),v=await M.request({method:"personal_sign",params:[mC(R),A]})}try{const{data:N,error:B}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:R,signature:v},!((C=t.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(E=t.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:kr});if(B)throw B;return!N||!N.session||!N.user?{data:{user:null,session:null},error:new Wc}:(N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),{data:Object.assign({},N),error:B})}catch(N){if(be(N))return{data:{user:null,session:null},error:N};throw N}}async signInWithSolana(t){var n,i,r,o,f,h,g,m,_,C,E,R;let v,N;if("message"in t)v=t.message,N=t.signature;else{const{chain:B,wallet:L,statement:j,options:M}=t;let G;if(Ha())if(typeof L=="object")G=L;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))G=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(M!=null&&M.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=L}const O=new URL((n=M==null?void 0:M.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in G&&G.signIn){const A=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M==null?void 0:M.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),j?{statement:j}:null));let T;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")T=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)T=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)v=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),N=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${O.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...j?["",j,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(r=(i=M==null?void 0:M.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((o=M==null?void 0:M.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((f=M==null?void 0:M.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((h=M==null?void 0:M.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((g=M==null?void 0:M.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M==null?void 0:M.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((C=(_=M==null?void 0:M.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||C===void 0)&&C.length?["Resources",...M.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const A=await G.signMessage(new TextEncoder().encode(v),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=A}}try{const{data:B,error:L}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:yu(N)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(R=t.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:kr});if(L)throw L;return!B||!B.session||!B.user?{data:{user:null,session:null},error:new Wc}:(B.session&&(await this._saveSession(B.session),await this._notifyAllSubscribers("SIGNED_IN",B.session)),{data:Object.assign({},B),error:L})}catch(B){if(be(B))return{data:{user:null,session:null},error:B};throw B}}async _exchangeCodeForSession(t){const n=await cu(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(n??"").split("/");try{const{data:o,error:f}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:kr});if(await io(this.storage,`${this.storageKey}-code-verifier`),f)throw f;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Wc}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:r??null}),error:f})}catch(o){if(be(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(t){try{const{options:n,provider:i,token:r,access_token:o,nonce:f}=t,h=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:o,nonce:f,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:kr}),{data:g,error:m}=h;return m?{data:{user:null,session:null},error:m}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Wc}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:m})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,i,r,o,f;try{if("email"in t){const{email:h,options:g}=t;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await $c(this.storage,this.storageKey));const{error:C}=await Ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(i=g==null?void 0:g.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:h,options:g}=t,{data:m,error:_}=await Ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},create_user:(o=g==null?void 0:g.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(f=g==null?void 0:g.channel)!==null&&f!==void 0?f:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_}}throw new og("You must provide either an email or phone number.")}catch(h){if(be(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(t){var n,i;try{let r,o;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,o=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:f,error:h}=await Ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:r,xform:kr});if(h)throw h;if(!f)throw new Error("An error occurred on token verification.");const g=f.session,m=f.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(r){if(be(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,i,r;try{let o=null,f=null;return this.flowType==="pkce"&&([o,f]=await $c(this.storage,this.storageKey)),await Ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:f}),headers:this.headers,xform:oC})}catch(o){if(be(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;if(i)throw i;if(!n)throw new lo;const{error:r}=await Ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:i,type:r,options:o}=t,{error:f}=await Ne(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:f}}else if("phone"in t){const{phone:i,type:r,options:o}=t,{data:f,error:h}=await Ne(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:h}}throw new og("You must provide either an email or phone number and a type")}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await cu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at*1e3-Date.now()<Yp:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.userStorage){const f=await cu(this.userStorage,this.storageKey+"-user");f!=null&&f.user?t.user=f.user:t.user=Xp()}if(this.storage.isServer&&t.user){let f=this.suppressGetSessionWarning;t=new Proxy(t,{get:(g,m,_)=>(!f&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),f=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,m,_))})}return{data:{session:t},error:null}}const{data:r,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:uo}):await this._useSession(async n=>{var i,r,o;const{data:f,error:h}=n;if(h)throw h;return!(!((i=f.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new lo}:await Ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(r=f.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0,xform:uo})})}catch(n){if(be(n))return LE(n)&&(await this._removeSession(),await io(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async i=>{const{data:r,error:o}=i;if(o)throw o;if(!r.session)throw new lo;const f=r.session;let h=null,g=null;this.flowType==="pkce"&&t.email!=null&&([h,g]=await $c(this.storage,this.storageKey));const{data:m,error:_}=await Ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:h,code_challenge_method:g}),jwt:f.access_token,xform:uo});if(_)throw _;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(i){if(be(i))return{data:{user:null},error:i};throw i}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new lo;const n=Date.now()/1e3;let i=n,r=!0,o=null;const{payload:f}=Qp(t.access_token);if(f.exp&&(i=f.exp,r=i<=n),r){const{data:h,error:g}=await this._callRefreshToken(t.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!h)return{data:{user:null,session:null},error:null};o=h}else{const{data:h,error:g}=await this._getUser(t.access_token);if(g)throw g;o={access_token:t.access_token,refresh_token:t.refresh_token,user:h.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(be(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var i;if(!t){const{data:f,error:h}=n;if(h)throw h;t=(i=f.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new lo;const{data:r,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Ha())throw new ug("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ug(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new A1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ug("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new A1("No code detected.");const{data:j,error:M}=await this._exchangeCodeForSession(t.code);if(M)throw M;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:j.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:o,refresh_token:f,expires_in:h,expires_at:g,token_type:m}=t;if(!o||!h||!f||!m)throw new ug("No session defined in URL");const _=Math.round(Date.now()/1e3),C=parseInt(h);let E=_+C;g&&(E=parseInt(g));const R=E-_;R*1e3<=lf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${C}s`);const v=E-C;_-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,E,_):_-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,E,_);const{data:N,error:B}=await this._getUser(o);if(B)throw B;const L={provider_token:i,provider_refresh_token:r,access_token:o,expires_in:C,expires_at:E,refresh_token:f,token_type:m,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:L,redirectType:t.type},error:null}}catch(i){if(be(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await cu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:r,error:o}=n;if(o)return{error:o};const f=(i=r.session)===null||i===void 0?void 0:i.access_token;if(f){const{error:h}=await this.admin.signOut(f,t);if(h&&!(zE(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return t!=="others"&&(await this._removeSession(),await io(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=YE(),i={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async n=>{var i,r;try{const{data:{session:o},error:f}=n;if(f)throw f;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,n={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await $c(this.storage,this.storageKey,!0));try{return await Ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(be(o))return{data:null,error:o};throw o}}async getUserIdentities(){var t;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:i,error:r}=await this._useSession(async o=>{var f,h,g,m,_;const{data:C,error:E}=o;if(E)throw E;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(f=t.options)===null||f===void 0?void 0:f.redirectTo,scopes:(h=t.options)===null||h===void 0?void 0:h.scopes,queryParams:(g=t.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Ne(this.fetch,"GET",R,{headers:this.headers,jwt:(_=(m=C.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(r)throw r;return Ha()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(be(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var i;try{const{error:r,data:{session:o}}=n;if(r)throw r;const{options:f,provider:h,token:g,access_token:m,nonce:_}=t,C=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=o==null?void 0:o.access_token)!==null&&i!==void 0?i:void 0,body:{provider:h,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:kr}),{data:E,error:R}=C;return R?{data:{user:null,session:null},error:R}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new Wc}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:R})}catch(r){if(be(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var i,r;const{data:o,error:f}=n;if(f)throw f;return await Ne(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await FE(async r=>(r>0&&await XE(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await Ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:kr})),(r,o)=>{const f=200*Math.pow(2,r);return o&&Kp(o)&&Date.now()+f-i<lf})}catch(i){if(this._debug(n,"error",i),be(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",i),Ha()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t,n;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await cu(this.storage,this.storageKey);if(r&&this.userStorage){let f=await cu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:r.user},await of(this.userStorage,this.storageKey+"-user",f)),r.user=(t=f==null?void 0:f.user)!==null&&t!==void 0?t:Xp()}else if(r&&!r.user&&!r.user){const f=await cu(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(r.user=f.user,await io(this.storage,this.storageKey+"-user"),await of(this.storage,this.storageKey,r)):r.user=Xp()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const o=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Yp;if(this._debug(i,`session has${o?"":" not"} expired with margin of ${Yp}s`),o){if(this.autoRefreshToken&&r.refresh_token){const{error:f}=await this._callRefreshToken(r.refresh_token);f&&(console.error(f),Kp(f)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:h}=await this._getUser(r.access_token);!h&&(f!=null&&f.user)?(r.user=f.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(i,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(t){var n,i;if(!t)throw new lo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Dg;const{data:o,error:f}=await this._refreshAccessToken(t);if(f)throw f;if(!o.session)throw new lo;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const h={data:o.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(o){if(this._debug(r,"error",o),be(o)){const f={data:null,error:o};return Kp(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(f),f}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(o),o}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,i=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:n});const o=[],f=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(t,n)}catch(g){o.push(g)}});if(await Promise.all(f),o.length>0){for(let h=0;h<o.length;h+=1)console.error(o[h]);throw o[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),i=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&n.user&&await of(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const o=M1(r);await of(this.storage,this.storageKey,o)}else{const r=M1(n);await of(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await io(this.storage,this.storageKey),await io(this.storage,this.storageKey+"-code-verifier"),await io(this.storage,this.storageKey+"-user"),this.userStorage&&await io(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ha()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),lf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-t)/lf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${lf}ms, refresh threshold is ${Vm} ticks`),r<=Vm&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof ob)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ha()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,i){const r=[`provider=${encodeURIComponent(n)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[o,f]=await $c(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(f)}`});r.push(h.toString())}if(i!=null&&i.queryParams){const o=new URLSearchParams(i.queryParams);r.push(o.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;return o?{data:null,error:o}:await Ne(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var i,r;const{data:o,error:f}=n;if(f)return{data:null,error:f};const h=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:g,error:m}=await Ne(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(i=o==null?void 0:o.session)===null||i===void 0?void 0:i.access_token});return m?{data:null,error:m}:(t.factorType==="totp"&&g.type==="totp"&&(!((r=g==null?void 0:g.totp)===null||r===void 0)&&r.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;if(o)return{data:null,error:o};const f=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?TC(t.webauthn.credential_response):AC(t.webauthn.credential_response)})}:{code:t.code}),{data:h,error:g}=await Ne(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:f,headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:g})})}catch(n){if(be(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;if(o)return{data:null,error:o};const f=await Ne(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});if(f.error)return f;const{data:h}=f;if(h.type!=="webauthn")return{data:h,error:null};switch(h.webauthn.type){case"create":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:EC(h.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:CC(h.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(be(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:i}=await this.getUser();if(i)return{data:null,error:i};const r={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])r.all.push(o),o.status==="verified"&&r[o.factor_type].push(o);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,i;const{data:{session:r},error:o}=t;if(o)return{data:null,error:o};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=Qp(r.access_token);let h=null;f.aal&&(h=f.aal);let g=h;((i=(n=r.user.factors)===null||n===void 0?void 0:n.filter(C=>C.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(g="aal2");const _=f.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:_},error:null}}))}async fetchJwk(t,n={keys:[]}){let i=n.keys.find(h=>h.kid===t);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(h=>h.kid===t),i&&this.jwks_cached_at+UE>r)return i;const{data:o,error:f}=await Ne(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=r,i=o.keys.find(h=>h.kid===t),!i)?null:i}async getClaims(t,n={}){try{let i=t;if(!i){const{data:R,error:v}=await this.getSession();if(v||!R.session)return{data:null,error:v};i=R.session.access_token}const{header:r,payload:o,signature:f,raw:{header:h,payload:g}}=Qp(i);n!=null&&n.allowExpired||nC(o.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!m){const{error:R}=await this.getUser(i);if(R)throw R;return{data:{claims:o,header:r,signature:f},error:null}}const _=iC(r.alg),C=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,C,f,qE(`${h}.${g}`)))throw new Qm("Invalid JWT signature");return{data:{claims:o,header:r,signature:f},error:null}}catch(i){if(be(i))return{data:null,error:i};throw i}}}md.nextInstanceID=0;const UC=md;class BC extends UC{constructor(t){super(t)}}class zC{constructor(t,n,i){var r,o,f;this.supabaseUrl=t,this.supabaseKey=n;const h=xE(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const g=`sb-${h.hostname.split(".")[0]}-auth-token`,m={db:_E,realtime:CE,auth:Object.assign(Object.assign({},EE),{storageKey:g}),global:bE},_=OE(i??{},m);this.storageKey=(r=_.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=_.global.headers)!==null&&o!==void 0?o:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(C,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=_.auth)!==null&&f!==void 0?f:{},this.headers,_.global.fetch),this.fetch=wE(n,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new M_(new URL("rest/v1",h).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new vE(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new b_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,i)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:i}=await this.auth.getSession();return(n=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:o,storageKey:f,flowType:h,lock:g,debug:m},_,C){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new BC({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),_),storageKey:f,autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:o,flowType:h,lock:g,debug:m,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(R=>R.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Q_(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,n,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const LC=(l,t,n)=>new zC(l,t,n);function GC(){if(typeof window<"u"||typeof process>"u")return!1;const l=process.version;if(l==null)return!1;const t=l.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}GC()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const PC="https://pmlwhqhezvczissdvuyc.supabase.co",HC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtbHdocWhlenZjemlzc2R2dXljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0MTA4MDUsImV4cCI6MjA3Njk4NjgwNX0.3W7AiFmapKzKJENDQ0H_Chz-V_AAw7a20fGOYlcCMb8",gu=LC(PC,HC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),kC=l=>l.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase()),L1=l=>{const t=kC(l);return t.charAt(0).toUpperCase()+t.slice(1)},fb=(...l)=>l.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim(),qC=l=>{for(const t in l)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var VC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=st.forwardRef(({color:l="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:o,iconNode:f,...h},g)=>st.createElement("svg",{ref:g,...VC,width:t,height:t,stroke:l,strokeWidth:i?Number(n)*24/Number(t):n,className:fb("lucide",r),...!o&&!qC(h)&&{"aria-hidden":"true"},...h},[...f.map(([m,_])=>st.createElement(m,_)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=(l,t)=>{const n=st.forwardRef(({className:i,...r},o)=>st.createElement(YC,{ref:o,iconNode:t,className:fb(`lucide-${IC(L1(l))}`,`lucide-${l}`,i),...r}));return n.displayName=L1(l),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],hb=Ef("eraser",KC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]],XC=Ef("feather",QC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],db=Ef("pen",FC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],gb=Ef("redo",JC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],pb=Ef("trash-2",ZC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],mb=Ef("undo",WC),G1="Feather_studentId",P1=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,l=>{const t=Math.random()*16|0;return(l==="x"?t:t&3|8).toString(16)}),$C=()=>{try{let l=sessionStorage.getItem(G1);return l?(console.log("📱 Using existing studentId:",l),l):(l=`student-${P1()}`,sessionStorage.setItem(G1,l),console.log("🆕 Created new studentId:",l),l)}catch{return console.warn("⚠️ sessionStorage unavailable, using memory-only studentId"),`student-temp-${P1()}`}},fu={width:800,height:600},tT=.65,eT=2.2,cg="studentCanvasPrefs",H1=2,I1=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,nT=({sharedImage:l,canvasWidth:t,canvasHeight:n})=>{const[i,r]=st.useState(null);if(st.useEffect(()=>{if(!l){r(null);return}const R=new window.Image;R.src=l.dataUrl,R.onload=()=>{r(R)}},[l]),!l||!i)return null;const o=i.naturalWidth||i.width,f=i.naturalHeight||i.height;if(!o||!f||!t||!n)return null;const h=o/f,g=t/n;let m,_,C,E;return h>g?(m=t,_=t/h,C=0,E=(n-_)/2):(_=n,m=n*h,C=(t-m)/2,E=0),m=Math.min(m,t),_=Math.min(_,n),k.jsx(iv,{image:i,x:C,y:E,width:m,height:_,listening:!1})};function iT(){const[l]=vd(),t=yf(),n=l.get("room"),i=l.get("name"),[r,o]=st.useState(null),f=st.useRef({roomId:null,studentName:null,clientId:null}),[h,g]=st.useState(null),[m]=st.useState(()=>$C()),[_,C]=st.useState(!1),E=st.useRef(null),[R,v]=st.useState(null),[N,B]=st.useState("loading"),[L,j]=st.useState([]),[M,G]=st.useState([]),[O,A]=st.useState(null),[T,y]=st.useState("pen"),[z,U]=st.useState("black"),[P,K]=st.useState(3),[Q,X]=st.useState(!1),[Y,D]=st.useState("stylus-only"),[I,F]=st.useState("left"),[W,it]=st.useState(I1()),Z=st.useRef(!1);st.useEffect(()=>{(!n||!i)&&t(`/student-login${n?`?room=${n}`:""}`)},[n,i,t]),st.useEffect(()=>{if(!n||!i)return;const ht=f.current;if(ht.clientId&&ht.roomId===n&&ht.studentName===i){g(ht.clientId);return}const vt=Math.random().toString(36).substring(2,8),Rt=Math.random().toString(36).substring(2,8),ue=Date.now().toString(36).slice(-4),Zt=`student-${`${vt}${Rt}${ue}`}`;f.current={roomId:n,studentName:i,clientId:Zt},g(Zt)},[i,n]),st.useEffect(()=>{if(!(!n||!i)&&!(typeof window>"u"))try{const ht=localStorage.getItem(cg);if(ht){const vt=JSON.parse(ht);if(vt.version!==H1){localStorage.removeItem(cg);return}vt.tool&&y(vt.tool),vt.color&&U(vt.color),typeof vt.brushSize=="number"&&K(vt.brushSize),vt.inputMode&&D(vt.inputMode),vt.toolbarPosition&&F(vt.toolbarPosition)}}catch{localStorage.removeItem(cg)}},[n,i]),st.useEffect(()=>{const ht=()=>{it(I1())};return window.addEventListener("resize",ht),()=>window.removeEventListener("resize",ht)},[]),st.useEffect(()=>{W&&(D("all"),K(3))},[W]),st.useEffect(()=>{if(!n||!i||typeof window>"u")return;if(V.current){V.current=!1;return}const ht={version:H1,tool:T,color:z,brushSize:P,inputMode:Y,toolbarPosition:I};localStorage.setItem(cg,JSON.stringify(ht))},[T,z,P,Y,I,n,i]);const at=st.useRef([]),rt=st.useRef([]),V=st.useRef(!0),J=st.useRef(!1),$=st.useRef(!1),nt=st.useRef(L);st.useEffect(()=>{nt.current=L},[L]);const dt=st.useRef(M);st.useEffect(()=>{dt.current=M},[M]);const wt=st.useRef(null),Ut=st.useRef(null),[It,ne]=st.useState(fu),ae=st.useMemo(()=>fu.width?It.width/fu.width:1,[It.width]),Lt=st.useRef(It),_e=st.useRef(ae);st.useEffect(()=>{Lt.current=It,_e.current=ae},[It,ae]);const we=st.useRef(null),Ze=st.useRef(null);st.useEffect(()=>{if(!J.current&&r){const ht=setTimeout(()=>{r.publish("student-layer",{lines:L,studentId:m,clientId:h,meta:{display:It,scale:ae}}),console.log("📤 Published student layer:",L.length,"lines (studentId:",m,")")},150);return()=>clearTimeout(ht)}},[L,r,h,m,It,ae]),st.useEffect(()=>{if(!n||!m||!i)return;const ht=setTimeout(async()=>{try{await fetch("/api/strokes/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:n,studentId:m,lines:L,studentName:i})})}catch(vt){console.error("Error auto-saving strokes to Redis:",vt)}},2e3);return()=>clearTimeout(ht)},[L,n,m,i]),st.useEffect(()=>{if(!n||!m||!i)return;const ht=()=>{const vt=JSON.stringify({roomId:n,studentId:m,lines:L,studentName:i});navigator.sendBeacon("/api/strokes/save",vt)};return window.addEventListener("beforeunload",ht),()=>window.removeEventListener("beforeunload",ht)},[L,n,m,i]),st.useEffect(()=>()=>{Ze.current&&cancelAnimationFrame(Ze.current)},[]),st.useEffect(()=>{const ht=wt.current;if(!ht)return;const vt=ce=>{const Zt=ce.target;Zt.closest("button")||Zt.closest(".student-toolbar")||Zt.closest(".student-topbar")||ce.preventDefault()},Rt=ce=>{ce.preventDefault()},ue=ce=>{if(Q)return ce.preventDefault(),!1};return ht.addEventListener("touchstart",vt,{passive:!1}),ht.addEventListener("touchmove",vt,{passive:!1}),ht.addEventListener("gesturestart",Rt,{passive:!1}),ht.addEventListener("gesturechange",Rt,{passive:!1}),document.addEventListener("selectstart",ue),()=>{ht&&(ht.removeEventListener("touchstart",vt),ht.removeEventListener("touchmove",vt),ht.removeEventListener("gesturestart",Rt),ht.removeEventListener("gesturechange",Rt)),document.removeEventListener("selectstart",ue)}},[Q]),st.useEffect(()=>{if(!n||!i||!h||E.current===n)return;E.current=n;let ht=!1;return(async()=>{try{const{data:Rt,error:ue}=await gu.from("sessions").select("*").ilike("room_code",n).order("created_at",{ascending:!1}).limit(1);if(ue){console.error("Session query error:",ue),B("no-session");return}if(!Rt||Rt.length===0){console.log("No session found for room code:",n),B("no-session");return}const ce=Rt[0];if(ht)return;if(ce.status==="ended"){console.log("Session found but already ended"),B("ended"),setTimeout(()=>t("/student-login"),3e3);return}v(ce.id),B(ce.status==="active"?"active":"waiting")}catch(Rt){console.error("Error validating session:",Rt),B("no-session"),E.current=null}})(),()=>{ht=!0}},[n,h,i,t]),st.useEffect(()=>{if(!n||!i||!h||!m)return;let ht=null,vt=null,Rt=!0,ue=!1;const ce=[];return(async()=>{try{ht=new yS.Realtime({authUrl:"/api/token",authParams:{clientId:h}}),ht.connection.on("connected",async()=>{if(Rt)if(C(!0),console.log("✅ Student connected to Ably"),ue&&vt){console.log("🔄 Reconnected - re-entering presence and syncing state");try{await vt.presence.enter({name:i,studentId:m,isVisible:!document.hidden}),console.log("✅ Re-entered presence as:",i,"with studentId:",m),setTimeout(()=>{Rt&&(console.log("🔄 Requesting full state (question + annotations)"),vt.publish("request-current-state",{clientId:h,studentId:m,timestamp:Date.now()}))},300)}catch(fe){console.error("❌ Error during reconnection:",fe)}}else ue=!0}),ht.connection.on("disconnected",()=>{Rt&&C(!1)}),vt=ht.channels.get(`room-${n}`);const he=(fe,Be)=>{vt.subscribe(fe,Be),ce.push({event:fe,handler:Be})};if(he("student-layer",()=>{}),he("teacher-annotation",fe=>{if(Rt&&(console.log("📨 Received teacher-annotation event. Target:",fe.data.targetStudentId,"My clientId:",h,"Match:",fe.data.targetStudentId===h),fe.data.targetStudentId===h)){const Be=fe.data.annotations||[];console.log("✅ ClientId matches! Applying",Be.length,"teacher annotation strokes"),J.current=!0,G(Be),setTimeout(()=>{J.current=!1},100)}}),he("sync-full-state",fe=>{if(Rt&&fe.data.targetClientId===h){const{content:Be=null,annotations:$e=[]}=fe.data;console.log("📨 Received sync-full-state:",{hasContent:!!Be,annotationCount:$e.length}),A(Be||null),$e.length>0&&(console.log("✅ Applying",$e.length,"teacher annotations from sync"),J.current=!0,G($e),setTimeout(()=>{J.current=!1},100))}}),he("clear-all-drawings",fe=>{var Be;Rt&&(console.log("📨 Received clear-all-drawings with content:",fe.data),(Be=fe.data)!=null&&Be.content?A(fe.data.content):A(null),J.current=!0,j([]),G([]),setTimeout(()=>{J.current=!1},100))}),he("session-started",()=>{Rt&&B("active")}),he("session-ended",()=>{Rt&&(console.log("🔚 Session ended"),B("ended"),t("/student-login"))}),await vt.presence.enter({name:i,studentId:m,isVisible:!document.hidden}),!Rt){await vt.presence.leaveClient(h),ht.close();return}o(vt),setTimeout(()=>{Rt&&vt.publish("request-current-state",{clientId:h,studentId:m,timestamp:Date.now()})},500),setTimeout(async()=>{if(Rt)try{console.log("📥 Loading own strokes from Redis...");const fe=await fetch(`/api/strokes/load?roomId=${n}&studentId=${m}`);if(fe.ok){const Be=await fe.json();Be.lines&&Be.lines.length>0&&(console.log(`✅ Restored ${Be.lines.length} lines from Redis`),J.current=!0,j(Be.lines),setTimeout(()=>{J.current=!1},100))}}catch(fe){console.error("Error loading strokes from Redis:",fe)}},700)}catch(he){console.error("Failed to initialize Ably:",he)}})(),()=>{if(Rt=!1,vt){ce.forEach(({event:he,handler:fe})=>{vt.unsubscribe(he,fe)});try{vt.presence.leaveClient(h)}catch(he){console.error("Error leaving presence:",he)}}if(o(null),ht)try{ht.close()}catch(he){console.error("Error closing Ably:",he)}}},[h,n,i,t,m]),st.useEffect(()=>{if(!r||Z.current)return;Z.current=!0;const ht=()=>{const vt=!document.hidden;r.presence.update({name:i,studentId:m,isVisible:vt,lastVisibilityChange:Date.now()}),r.publish("student-visibility",{studentId:m,studentName:i,isVisible:vt,timestamp:Date.now()})};return document.addEventListener("visibilitychange",ht),()=>{Z.current=!1,document.removeEventListener("visibilitychange",ht)}},[r,h,i]),st.useEffect(()=>{const ht=wt.current;if(!ht)return;const vt=()=>{if(!wt.current)return;const ue=wt.current.getBoundingClientRect(),ce=W?16:48,Zt=Math.max(280,ue.width-ce),he=Math.max(210,ue.height-ce),fe=Zt/fu.width,Be=he/fu.height,$e=Math.min(fe,Be),na=Math.max(W?.35:tT,Math.min(eT,$e)),Ii=Math.round(na*20)/20;ne({width:Math.round(fu.width*Ii),height:Math.round(fu.height*Ii)})};vt(),window.addEventListener("resize",vt);let Rt;return window.ResizeObserver&&(Rt=new ResizeObserver(()=>vt()),Rt.observe(ht)),()=>{window.removeEventListener("resize",vt),Rt&&Rt.disconnect()}},[I,W]);const He=ht=>Y!=="stylus-only"?!0:(ht==null?void 0:ht.pointerType)==="pen",gn=ht=>{const vt=ht.evt;if(!He(vt)){vt!=null&&vt.preventDefault&&vt.preventDefault();return}const Rt=ht.target.getStage();if(Rt&&vt.pointerId!==void 0){const ue=Rt.content;if(ue&&ue.setPointerCapture)try{ue.setPointerCapture(vt.pointerId)}catch{}}if(T==="pen"){X(!0);const ue=Rt.getPointerPosition(),ce=ue.x/ae,Zt=ue.y/ae,he={tool:T,points:[ce,Zt],color:z,strokeWidth:P/ae};we.current=he,at.current.push([...L]),rt.current=[],j([...L,he])}else T==="eraser"&&(X(!0),$.current=!1);vt.preventDefault&&vt.preventDefault(),vt.stopPropagation&&vt.stopPropagation()},Pn=ht=>{if(!Q)return;const vt=ht.evt;if(!He(vt)){vt!=null&&vt.preventDefault&&vt.preventDefault();return}const ue=ht.target.getStage().getPointerPosition();if(T==="pen"){if(we.current){const ce=ue.x/ae,Zt=ue.y/ae;we.current.points=we.current.points.concat([ce,Zt]);const he=we.current;Ze.current&&cancelAnimationFrame(Ze.current),Ze.current=requestAnimationFrame(()=>{he&&j(fe=>fe.length>0?[...fe.slice(0,-1),he]:fe)})}}else if(T==="eraser"){const ce=L.length,Zt=ue.x,he=ue.y,fe=20,Be=L.filter($e=>{for(let Fn=0;Fn<$e.points.length;Fn+=2){const na=$e.points[Fn]*ae,Ii=$e.points[Fn+1]*ae;if(Math.sqrt(Math.pow(na-Zt,2)+Math.pow(Ii-he,2))<fe)return!1}return!0});Be.length<ce&&!$.current&&(at.current.push([...L]),rt.current=[],$.current=!0),j(Be)}vt!=null&&vt.preventDefault&&vt.preventDefault(),vt!=null&&vt.stopPropagation&&vt.stopPropagation()},Ot=ht=>{const vt=ht==null?void 0:ht.evt;if(!He(vt)){vt!=null&&vt.preventDefault&&vt.preventDefault();return}X(!1),we.current=null},Kt=()=>{if(at.current.length>0){const ht=at.current.pop();rt.current.push([...L]),j(ht)}},je=()=>{if(rt.current.length>0){const ht=rt.current.pop();at.current.push([...L]),j(ht)}},ye=()=>{at.current.push([...L]),rt.current=[],j([])},We=()=>{var ht;return h?((ht=h.split("-")[1])==null?void 0:ht.substring(0,3))||h:"---"},an=()=>{D(ht=>ht==="stylus-only"?"all":"stylus-only")},ge=()=>{F(ht=>ht==="left"?"right":"left")},ct=()=>`Connected as ${i&&i!=="Anonymous"?i:We()}`,At=_?"Connected":"Reconnecting…",Mt=_?"online":"offline",qt=ht=>ht.map((vt,Rt)=>vt*ae),pe=ht=>(ht.strokeWidth||3)*ae;return!n||!i?null:k.jsxs("div",{className:"student-canvas-page",children:[N==="loading"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-spinner"}),k.jsx("h2",{children:"Connecting to session..."}),k.jsx("p",{children:"Please wait while we verify your session"})]})}),N==="waiting"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:"⏳"}),k.jsx("h2",{children:"Waiting for teacher"}),k.jsx("p",{children:"Your teacher hasn't started the session yet. Please wait..."})]})}),N==="no-session"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:"🔍"}),k.jsx("h2",{children:"No session found"}),k.jsxs("p",{children:['There is no active session for room code "',n,'".']}),k.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem"},children:"Please make sure your teacher has started a session, or verify the room code is correct."}),k.jsx("button",{onClick:()=>t("/student-login"),style:{marginTop:"1.5rem",padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"transform 0.2s"},onMouseEnter:ht=>ht.target.style.transform="scale(1.05)",onMouseLeave:ht=>ht.target.style.transform="scale(1)",children:"Back to Login"})]})}),N==="ended"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon ended",children:"✓"}),k.jsx("h2",{children:"Session ended"}),k.jsx("p",{children:"Thank you for participating! The teacher has ended this session."}),k.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",opacity:.8},children:"Redirecting to login..."})]})}),k.jsxs("div",{className:"student-canvas-container",children:[k.jsxs("div",{className:"student-status-bar",children:[k.jsxs("div",{className:"student-status-text",children:[k.jsxs("h1",{children:["Student Canvas",n&&k.jsxs("span",{style:{marginLeft:"0.75rem",fontSize:"0.75rem",fontWeight:"400",color:"rgba(0, 0, 0, 0.4)",letterSpacing:"0.5px"},children:["Session: ",n]})]}),k.jsx("p",{children:ct()})]}),k.jsxs("div",{className:"student-status-actions",children:[!W&&k.jsxs(k.Fragment,{children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:T==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",Y==="all"?"All inputs":"Stylus only"]})}),k.jsxs("div",{className:`connection-pill ${Mt}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:At})]}),k.jsxs("button",{className:"move-toolbar-btn",onClick:ge,children:["Move toolbar to ",I==="left"?"right":"left"]})]}),W&&k.jsxs("div",{className:`connection-pill ${Mt}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:At})]})]})]}),k.jsxs("div",{className:`student-workspace ${I==="right"?"toolbar-right":""} ${W?"mobile-view":""}`,children:[W?k.jsxs("div",{className:"mobile-toolbar",children:[k.jsxs("div",{className:"mobile-colors",children:[k.jsx("button",{onClick:()=>U("black"),className:`mobile-color-button ${z==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>U("#0066FF"),className:`mobile-color-button ${z==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>U("#00AA00"),className:`mobile-color-button ${z==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>y("pen"),className:`mobile-tool-button ${T==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(db,{size:20})}),k.jsx("button",{onClick:()=>y("eraser"),className:`mobile-tool-button ${T==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(hb,{size:20})}),k.jsx("button",{onClick:Kt,className:"mobile-tool-button",disabled:at.current.length===0,"aria-label":"Undo",children:k.jsx(mb,{size:20})}),k.jsx("button",{onClick:je,className:"mobile-tool-button",disabled:rt.current.length===0,"aria-label":"Redo",children:k.jsx(gb,{size:20})}),k.jsx("button",{onClick:ye,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(pb,{size:20})})]})]}):k.jsxs("div",{className:"student-sidebar",children:[k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsxs("div",{className:"color-buttons",children:[k.jsx("button",{onClick:()=>U("black"),className:`color-button ${z==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>U("#0066FF"),className:`color-button ${z==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>U("#00AA00"),className:`color-button ${z==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>y("pen"),className:`tool-icon-button ${T==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>y("eraser"),className:`tool-icon-button ${T==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsx("div",{className:"brush-size-control",children:k.jsxs("div",{className:"brush-slider-container",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:P,onChange:ht=>K(parseInt(ht.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:P})]})})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${Y==="all"?"all-inputs":""}`,onClick:an,children:Y==="stylus-only"?"Stylus mode (pen only)":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:Kt,className:"history-button",disabled:at.current.length===0,children:"Undo"}),k.jsx("button",{onClick:je,className:"history-button",disabled:rt.current.length===0,children:"Redo"}),k.jsx("button",{onClick:ye,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"student-canvas-panel",ref:wt,children:k.jsx("div",{className:"student-canvas-frame",children:k.jsx("div",{className:"student-canvas-surface",style:{width:`${It.width}px`,height:`${It.height}px`},children:k.jsxs(Ng,{ref:Ut,width:It.width,height:It.height,onPointerDown:gn,onPointerMove:Pn,onPointerUp:Ot,onPointerLeave:Ot,onTouchStart:ht=>{var vt,Rt;(Rt=(vt=ht.evt)==null?void 0:vt.preventDefault)==null||Rt.call(vt)},onTouchMove:ht=>{var vt,Rt;(Rt=(vt=ht.evt)==null?void 0:vt.preventDefault)==null||Rt.call(vt)},onTouchEnd:ht=>{var vt,Rt;(Rt=(vt=ht.evt)==null?void 0:vt.preventDefault)==null||Rt.call(vt)},className:"canvas-stage",style:{touchAction:"none"},perfectDrawEnabled:!1,children:[k.jsx(Yr,{listening:!1,children:k.jsx(nT,{sharedImage:O,canvasWidth:It.width,canvasHeight:It.height})}),k.jsx(Yr,{children:L.map((ht,vt)=>k.jsx(fo,{points:qt(ht.points),stroke:ht.color,strokeWidth:pe(ht),tension:.5,lineCap:"round",lineJoin:"round"},`student-${vt}`))}),k.jsx(Yr,{listening:!1,children:M.map((ht,vt)=>k.jsx(fo,{points:qt(ht.points),stroke:ht.color,strokeWidth:pe(ht),tension:.5,lineCap:"round",lineJoin:"round"},`teacher-${vt}`))})]})})})})]})]})]})}const k1="Feather_username";function aT(){const[l]=vd(),t=yf(),[n,i]=st.useState(""),[r,o]=st.useState(""),[f,h]=st.useState(""),[g,m]=st.useState(!1);st.useEffect(()=>{const C=localStorage.getItem(k1);C&&i(C);const E=l.get("room");E&&o(E.toUpperCase())},[l]);const _=async C=>{if(C.preventDefault(),!n.trim()){h("Please enter your name");return}if(!r.trim()){h("Please enter a session code");return}m(!0),h(""),localStorage.setItem(k1,n.trim());try{const E=(await Au(async()=>{const{default:L}=await Promise.resolve().then(()=>lT);return{default:L}},void 0)).default,R=new E.Realtime({authUrl:"/api/token",authParams:{clientId:`ping-${Date.now()}`}});await new Promise((L,j)=>{const M=setTimeout(()=>j(new Error("Connection timeout")),8e3);R.connection.once("connected",()=>{clearTimeout(M),L()}),R.connection.once("failed",()=>{clearTimeout(M),j(new Error("Connection failed"))})});const B=(await R.channels.get(`room-${r.trim().toUpperCase()}`).presence.get()).some(L=>L.clientId.startsWith("teacher-"));if(R.close(),!B){h("No active teacher found. Please check your session code."),m(!1);return}t(`/student?room=${r.trim().toUpperCase()}&name=${encodeURIComponent(n.trim())}`)}catch(E){console.error("Failed to connect:",E),h("Failed to connect to session. Please try again."),m(!1)}};return k.jsx("div",{className:"student-login-page",children:k.jsxs("div",{className:"student-login-card",children:[k.jsx("h1",{children:"Student Login"}),k.jsx("p",{className:"login-subtitle",children:"Join your classroom session to start drawing."}),k.jsxs("form",{onSubmit:_,children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"name",children:"Name"}),k.jsx("input",{id:"name",type:"text",placeholder:"Your name",value:n,onChange:C=>{i(C.target.value),h("")},autoFocus:!0,maxLength:50})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"sessionCode",children:"Session code"}),k.jsx("input",{id:"sessionCode",type:"text",placeholder:"SESSION CODE (E.G., ABC123)",value:r,onChange:C=>{o(C.target.value.toUpperCase()),h("")},maxLength:10})]}),f&&k.jsx("div",{className:"login-error",children:f}),k.jsx("button",{type:"submit",className:"join-button",disabled:g,children:g?"Checking session...":"Join Session"})]})]})})}var Jp,q1;function rT(){if(q1)return Jp;q1=1;function l(o){return typeof o=="string"&&(o=o.indexOf(":")==-1?{token:o}:{key:o}),o.promises=!0,o}var t=vS(),n=function(o,f,h,g){return new t.ErrorInfo(o,f,h,g)},i=function(o){return new t.Rest(l(o))};Object.assign(i,t.Rest);var r=function(o){return new t.Realtime(l(o))};return Object.assign(r,t.Realtime),Jp={ErrorInfo:n,Rest:i,Realtime:r},Jp}var sT=rT();const dv=pf(sT),lT=Object.freeze(Object.defineProperty({__proto__:null,default:dv},Symbol.toStringTag,{value:"Module"}));var af={},Zp,V1;function oT(){return V1||(V1=1,Zp=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Zp}var Wp={},ao={},Y1;function Ru(){if(Y1)return ao;Y1=1;let l;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ao.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},ao.getSymbolTotalCodewords=function(i){return t[i]},ao.getBCHDigit=function(n){let i=0;for(;n!==0;)i++,n>>>=1;return i},ao.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');l=i},ao.isKanjiModeEnabled=function(){return typeof l<"u"},ao.toSJIS=function(i){return l(i)},ao}var $p={},K1;function gv(){return K1||(K1=1,(function(l){l.L={bit:1},l.M={bit:0},l.Q={bit:3},l.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return l.L;case"m":case"medium":return l.M;case"q":case"quartile":return l.Q;case"h":case"high":return l.H;default:throw new Error("Unknown EC Level: "+n)}}l.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},l.from=function(i,r){if(l.isValid(i))return i;try{return t(i)}catch{return r}}})($p)),$p}var tm,Q1;function uT(){if(Q1)return tm;Q1=1;function l(){this.buffer=[],this.length=0}return l.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let i=0;i<n;i++)this.putBit((t>>>n-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},tm=l,tm}var em,X1;function cT(){if(X1)return em;X1=1;function l(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return l.prototype.set=function(t,n,i,r){const o=t*this.size+n;this.data[o]=i,r&&(this.reservedBit[o]=!0)},l.prototype.get=function(t,n){return this.data[t*this.size+n]},l.prototype.xor=function(t,n,i){this.data[t*this.size+n]^=i},l.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},em=l,em}var nm={},F1;function fT(){return F1||(F1=1,(function(l){const t=Ru().getSymbolSize;l.getRowColCoords=function(i){if(i===1)return[];const r=Math.floor(i/7)+2,o=t(i),f=o===145?26:Math.ceil((o-13)/(2*r-2))*2,h=[o-7];for(let g=1;g<r-1;g++)h[g]=h[g-1]-f;return h.push(6),h.reverse()},l.getPositions=function(i){const r=[],o=l.getRowColCoords(i),f=o.length;for(let h=0;h<f;h++)for(let g=0;g<f;g++)h===0&&g===0||h===0&&g===f-1||h===f-1&&g===0||r.push([o[h],o[g]]);return r}})(nm)),nm}var im={},J1;function hT(){if(J1)return im;J1=1;const l=Ru().getSymbolSize,t=7;return im.getPositions=function(i){const r=l(i);return[[0,0],[r-t,0],[0,r-t]]},im}var am={},Z1;function dT(){return Z1||(Z1=1,(function(l){l.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};l.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},l.from=function(r){return l.isValid(r)?parseInt(r,10):void 0},l.getPenaltyN1=function(r){const o=r.size;let f=0,h=0,g=0,m=null,_=null;for(let C=0;C<o;C++){h=g=0,m=_=null;for(let E=0;E<o;E++){let R=r.get(C,E);R===m?h++:(h>=5&&(f+=t.N1+(h-5)),m=R,h=1),R=r.get(E,C),R===_?g++:(g>=5&&(f+=t.N1+(g-5)),_=R,g=1)}h>=5&&(f+=t.N1+(h-5)),g>=5&&(f+=t.N1+(g-5))}return f},l.getPenaltyN2=function(r){const o=r.size;let f=0;for(let h=0;h<o-1;h++)for(let g=0;g<o-1;g++){const m=r.get(h,g)+r.get(h,g+1)+r.get(h+1,g)+r.get(h+1,g+1);(m===4||m===0)&&f++}return f*t.N2},l.getPenaltyN3=function(r){const o=r.size;let f=0,h=0,g=0;for(let m=0;m<o;m++){h=g=0;for(let _=0;_<o;_++)h=h<<1&2047|r.get(m,_),_>=10&&(h===1488||h===93)&&f++,g=g<<1&2047|r.get(_,m),_>=10&&(g===1488||g===93)&&f++}return f*t.N3},l.getPenaltyN4=function(r){let o=0;const f=r.data.length;for(let g=0;g<f;g++)o+=r.data[g];return Math.abs(Math.ceil(o*100/f/5)-10)*t.N4};function n(i,r,o){switch(i){case l.Patterns.PATTERN000:return(r+o)%2===0;case l.Patterns.PATTERN001:return r%2===0;case l.Patterns.PATTERN010:return o%3===0;case l.Patterns.PATTERN011:return(r+o)%3===0;case l.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(o/3))%2===0;case l.Patterns.PATTERN101:return r*o%2+r*o%3===0;case l.Patterns.PATTERN110:return(r*o%2+r*o%3)%2===0;case l.Patterns.PATTERN111:return(r*o%3+(r+o)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}l.applyMask=function(r,o){const f=o.size;for(let h=0;h<f;h++)for(let g=0;g<f;g++)o.isReserved(g,h)||o.xor(g,h,n(r,g,h))},l.getBestMask=function(r,o){const f=Object.keys(l.Patterns).length;let h=0,g=1/0;for(let m=0;m<f;m++){o(m),l.applyMask(m,r);const _=l.getPenaltyN1(r)+l.getPenaltyN2(r)+l.getPenaltyN3(r)+l.getPenaltyN4(r);l.applyMask(m,r),_<g&&(g=_,h=m)}return h}})(am)),am}var fg={},W1;function vb(){if(W1)return fg;W1=1;const l=gv(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return fg.getBlocksCount=function(r,o){switch(o){case l.L:return t[(r-1)*4+0];case l.M:return t[(r-1)*4+1];case l.Q:return t[(r-1)*4+2];case l.H:return t[(r-1)*4+3];default:return}},fg.getTotalCodewordsCount=function(r,o){switch(o){case l.L:return n[(r-1)*4+0];case l.M:return n[(r-1)*4+1];case l.Q:return n[(r-1)*4+2];case l.H:return n[(r-1)*4+3];default:return}},fg}var rm={},Zh={},$1;function gT(){if($1)return Zh;$1=1;const l=new Uint8Array(512),t=new Uint8Array(256);return(function(){let i=1;for(let r=0;r<255;r++)l[r]=i,t[i]=r,i<<=1,i&256&&(i^=285);for(let r=255;r<512;r++)l[r]=l[r-255]})(),Zh.log=function(i){if(i<1)throw new Error("log("+i+")");return t[i]},Zh.exp=function(i){return l[i]},Zh.mul=function(i,r){return i===0||r===0?0:l[t[i]+t[r]]},Zh}var t2;function pT(){return t2||(t2=1,(function(l){const t=gT();l.mul=function(i,r){const o=new Uint8Array(i.length+r.length-1);for(let f=0;f<i.length;f++)for(let h=0;h<r.length;h++)o[f+h]^=t.mul(i[f],r[h]);return o},l.mod=function(i,r){let o=new Uint8Array(i);for(;o.length-r.length>=0;){const f=o[0];for(let g=0;g<r.length;g++)o[g]^=t.mul(r[g],f);let h=0;for(;h<o.length&&o[h]===0;)h++;o=o.slice(h)}return o},l.generateECPolynomial=function(i){let r=new Uint8Array([1]);for(let o=0;o<i;o++)r=l.mul(r,new Uint8Array([1,t.exp(o)]));return r}})(rm)),rm}var sm,e2;function mT(){if(e2)return sm;e2=1;const l=pT();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(i){this.degree=i,this.genPoly=l.generateECPolynomial(this.degree)},t.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(i.length+this.degree);r.set(i);const o=l.mod(r,this.genPoly),f=this.degree-o.length;if(f>0){const h=new Uint8Array(this.degree);return h.set(o,f),h}return o},sm=t,sm}var lm={},om={},um={},n2;function yb(){return n2||(n2=1,um.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),um}var _s={},i2;function Sb(){if(i2)return _s;i2=1;const l="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;_s.KANJI=new RegExp(n,"g"),_s.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),_s.BYTE=new RegExp(i,"g"),_s.NUMERIC=new RegExp(l,"g"),_s.ALPHANUMERIC=new RegExp(t,"g");const r=new RegExp("^"+n+"$"),o=new RegExp("^"+l+"$"),f=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return _s.testKanji=function(g){return r.test(g)},_s.testNumeric=function(g){return o.test(g)},_s.testAlphanumeric=function(g){return f.test(g)},_s}var a2;function Ou(){return a2||(a2=1,(function(l){const t=yb(),n=Sb();l.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},l.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},l.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},l.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},l.MIXED={bit:-1},l.getCharCountIndicator=function(o,f){if(!o.ccBits)throw new Error("Invalid mode: "+o);if(!t.isValid(f))throw new Error("Invalid version: "+f);return f>=1&&f<10?o.ccBits[0]:f<27?o.ccBits[1]:o.ccBits[2]},l.getBestModeForData=function(o){return n.testNumeric(o)?l.NUMERIC:n.testAlphanumeric(o)?l.ALPHANUMERIC:n.testKanji(o)?l.KANJI:l.BYTE},l.toString=function(o){if(o&&o.id)return o.id;throw new Error("Invalid mode")},l.isValid=function(o){return o&&o.bit&&o.ccBits};function i(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return l.NUMERIC;case"alphanumeric":return l.ALPHANUMERIC;case"kanji":return l.KANJI;case"byte":return l.BYTE;default:throw new Error("Unknown mode: "+r)}}l.from=function(o,f){if(l.isValid(o))return o;try{return i(o)}catch{return f}}})(om)),om}var r2;function vT(){return r2||(r2=1,(function(l){const t=Ru(),n=vb(),i=gv(),r=Ou(),o=yb(),f=7973,h=t.getBCHDigit(f);function g(E,R,v){for(let N=1;N<=40;N++)if(R<=l.getCapacity(N,v,E))return N}function m(E,R){return r.getCharCountIndicator(E,R)+4}function _(E,R){let v=0;return E.forEach(function(N){const B=m(N.mode,R);v+=B+N.getBitsLength()}),v}function C(E,R){for(let v=1;v<=40;v++)if(_(E,v)<=l.getCapacity(v,R,r.MIXED))return v}l.from=function(R,v){return o.isValid(R)?parseInt(R,10):v},l.getCapacity=function(R,v,N){if(!o.isValid(R))throw new Error("Invalid QR Code version");typeof N>"u"&&(N=r.BYTE);const B=t.getSymbolTotalCodewords(R),L=n.getTotalCodewordsCount(R,v),j=(B-L)*8;if(N===r.MIXED)return j;const M=j-m(N,R);switch(N){case r.NUMERIC:return Math.floor(M/10*3);case r.ALPHANUMERIC:return Math.floor(M/11*2);case r.KANJI:return Math.floor(M/13);case r.BYTE:default:return Math.floor(M/8)}},l.getBestVersionForData=function(R,v){let N;const B=i.from(v,i.M);if(Array.isArray(R)){if(R.length>1)return C(R,B);if(R.length===0)return 1;N=R[0]}else N=R;return g(N.mode,N.getLength(),B)},l.getEncodedBits=function(R){if(!o.isValid(R)||R<7)throw new Error("Invalid QR Code version");let v=R<<12;for(;t.getBCHDigit(v)-h>=0;)v^=f<<t.getBCHDigit(v)-h;return R<<12|v}})(lm)),lm}var cm={},s2;function yT(){if(s2)return cm;s2=1;const l=Ru(),t=1335,n=21522,i=l.getBCHDigit(t);return cm.getEncodedBits=function(o,f){const h=o.bit<<3|f;let g=h<<10;for(;l.getBCHDigit(g)-i>=0;)g^=t<<l.getBCHDigit(g)-i;return(h<<10|g)^n},cm}var fm={},hm,l2;function ST(){if(l2)return hm;l2=1;const l=Ou();function t(n){this.mode=l.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(i){let r,o,f;for(r=0;r+3<=this.data.length;r+=3)o=this.data.substr(r,3),f=parseInt(o,10),i.put(f,10);const h=this.data.length-r;h>0&&(o=this.data.substr(r),f=parseInt(o,10),i.put(f,h*3+1))},hm=t,hm}var dm,o2;function bT(){if(o2)return dm;o2=1;const l=Ou(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(i){this.mode=l.ALPHANUMERIC,this.data=i}return n.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let o;for(o=0;o+2<=this.data.length;o+=2){let f=t.indexOf(this.data[o])*45;f+=t.indexOf(this.data[o+1]),r.put(f,11)}this.data.length%2&&r.put(t.indexOf(this.data[o]),6)},dm=n,dm}var gm,u2;function _T(){if(u2)return gm;u2=1;const l=Ou();function t(n){this.mode=l.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(i){return i*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let i=0,r=this.data.length;i<r;i++)n.put(this.data[i],8)},gm=t,gm}var pm,c2;function ET(){if(c2)return pm;c2=1;const l=Ou(),t=Ru();function n(i){this.mode=l.KANJI,this.data=i}return n.getBitsLength=function(r){return r*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(i){let r;for(r=0;r<this.data.length;r++){let o=t.toSJIS(this.data[r]);if(o>=33088&&o<=40956)o-=33088;else if(o>=57408&&o<=60351)o-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);o=(o>>>8&255)*192+(o&255),i.put(o,13)}},pm=n,pm}var mm={exports:{}},f2;function CT(){return f2||(f2=1,(function(l){var t={single_source_shortest_paths:function(n,i,r){var o={},f={};f[i]=0;var h=t.PriorityQueue.make();h.push(i,0);for(var g,m,_,C,E,R,v,N,B;!h.empty();){g=h.pop(),m=g.value,C=g.cost,E=n[m]||{};for(_ in E)E.hasOwnProperty(_)&&(R=E[_],v=C+R,N=f[_],B=typeof f[_]>"u",(B||N>v)&&(f[_]=v,h.push(_,v),o[_]=m))}if(typeof r<"u"&&typeof f[r]>"u"){var L=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(L)}return o},extract_shortest_path_from_predecessor_list:function(n,i){for(var r=[],o=i;o;)r.push(o),n[o],o=n[o];return r.reverse(),r},find_path:function(n,i,r){var o=t.single_source_shortest_paths(n,i,r);return t.extract_shortest_path_from_predecessor_list(o,r)},PriorityQueue:{make:function(n){var i=t.PriorityQueue,r={},o;n=n||{};for(o in i)i.hasOwnProperty(o)&&(r[o]=i[o]);return r.queue=[],r.sorter=n.sorter||i.default_sorter,r},default_sorter:function(n,i){return n.cost-i.cost},push:function(n,i){var r={value:n,cost:i};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};l.exports=t})(mm)),mm.exports}var h2;function TT(){return h2||(h2=1,(function(l){const t=Ou(),n=ST(),i=bT(),r=_T(),o=ET(),f=Sb(),h=Ru(),g=CT();function m(L){return unescape(encodeURIComponent(L)).length}function _(L,j,M){const G=[];let O;for(;(O=L.exec(M))!==null;)G.push({data:O[0],index:O.index,mode:j,length:O[0].length});return G}function C(L){const j=_(f.NUMERIC,t.NUMERIC,L),M=_(f.ALPHANUMERIC,t.ALPHANUMERIC,L);let G,O;return h.isKanjiModeEnabled()?(G=_(f.BYTE,t.BYTE,L),O=_(f.KANJI,t.KANJI,L)):(G=_(f.BYTE_KANJI,t.BYTE,L),O=[]),j.concat(M,G,O).sort(function(T,y){return T.index-y.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function E(L,j){switch(j){case t.NUMERIC:return n.getBitsLength(L);case t.ALPHANUMERIC:return i.getBitsLength(L);case t.KANJI:return o.getBitsLength(L);case t.BYTE:return r.getBitsLength(L)}}function R(L){return L.reduce(function(j,M){const G=j.length-1>=0?j[j.length-1]:null;return G&&G.mode===M.mode?(j[j.length-1].data+=M.data,j):(j.push(M),j)},[])}function v(L){const j=[];for(let M=0;M<L.length;M++){const G=L[M];switch(G.mode){case t.NUMERIC:j.push([G,{data:G.data,mode:t.ALPHANUMERIC,length:G.length},{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.ALPHANUMERIC:j.push([G,{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.KANJI:j.push([G,{data:G.data,mode:t.BYTE,length:m(G.data)}]);break;case t.BYTE:j.push([{data:G.data,mode:t.BYTE,length:m(G.data)}])}}return j}function N(L,j){const M={},G={start:{}};let O=["start"];for(let A=0;A<L.length;A++){const T=L[A],y=[];for(let z=0;z<T.length;z++){const U=T[z],P=""+A+z;y.push(P),M[P]={node:U,lastCount:0},G[P]={};for(let K=0;K<O.length;K++){const Q=O[K];M[Q]&&M[Q].node.mode===U.mode?(G[Q][P]=E(M[Q].lastCount+U.length,U.mode)-E(M[Q].lastCount,U.mode),M[Q].lastCount+=U.length):(M[Q]&&(M[Q].lastCount=U.length),G[Q][P]=E(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,j))}}O=y}for(let A=0;A<O.length;A++)G[O[A]].end=0;return{map:G,table:M}}function B(L,j){let M;const G=t.getBestModeForData(L);if(M=t.from(j,G),M!==t.BYTE&&M.bit<G.bit)throw new Error('"'+L+'" cannot be encoded with mode '+t.toString(M)+`.
 Suggested mode is: `+t.toString(G));switch(M===t.KANJI&&!h.isKanjiModeEnabled()&&(M=t.BYTE),M){case t.NUMERIC:return new n(L);case t.ALPHANUMERIC:return new i(L);case t.KANJI:return new o(L);case t.BYTE:return new r(L)}}l.fromArray=function(j){return j.reduce(function(M,G){return typeof G=="string"?M.push(B(G,null)):G.data&&M.push(B(G.data,G.mode)),M},[])},l.fromString=function(j,M){const G=C(j,h.isKanjiModeEnabled()),O=v(G),A=N(O,M),T=g.find_path(A.map,"start","end"),y=[];for(let z=1;z<T.length-1;z++)y.push(A.table[T[z]].node);return l.fromArray(R(y))},l.rawSplit=function(j){return l.fromArray(C(j,h.isKanjiModeEnabled()))}})(fm)),fm}var d2;function AT(){if(d2)return Wp;d2=1;const l=Ru(),t=gv(),n=uT(),i=cT(),r=fT(),o=hT(),f=dT(),h=vb(),g=mT(),m=vT(),_=yT(),C=Ou(),E=TT();function R(A,T){const y=A.size,z=o.getPositions(T);for(let U=0;U<z.length;U++){const P=z[U][0],K=z[U][1];for(let Q=-1;Q<=7;Q++)if(!(P+Q<=-1||y<=P+Q))for(let X=-1;X<=7;X++)K+X<=-1||y<=K+X||(Q>=0&&Q<=6&&(X===0||X===6)||X>=0&&X<=6&&(Q===0||Q===6)||Q>=2&&Q<=4&&X>=2&&X<=4?A.set(P+Q,K+X,!0,!0):A.set(P+Q,K+X,!1,!0))}}function v(A){const T=A.size;for(let y=8;y<T-8;y++){const z=y%2===0;A.set(y,6,z,!0),A.set(6,y,z,!0)}}function N(A,T){const y=r.getPositions(T);for(let z=0;z<y.length;z++){const U=y[z][0],P=y[z][1];for(let K=-2;K<=2;K++)for(let Q=-2;Q<=2;Q++)K===-2||K===2||Q===-2||Q===2||K===0&&Q===0?A.set(U+K,P+Q,!0,!0):A.set(U+K,P+Q,!1,!0)}}function B(A,T){const y=A.size,z=m.getEncodedBits(T);let U,P,K;for(let Q=0;Q<18;Q++)U=Math.floor(Q/3),P=Q%3+y-8-3,K=(z>>Q&1)===1,A.set(U,P,K,!0),A.set(P,U,K,!0)}function L(A,T,y){const z=A.size,U=_.getEncodedBits(T,y);let P,K;for(P=0;P<15;P++)K=(U>>P&1)===1,P<6?A.set(P,8,K,!0):P<8?A.set(P+1,8,K,!0):A.set(z-15+P,8,K,!0),P<8?A.set(8,z-P-1,K,!0):P<9?A.set(8,15-P-1+1,K,!0):A.set(8,15-P-1,K,!0);A.set(z-8,8,1,!0)}function j(A,T){const y=A.size;let z=-1,U=y-1,P=7,K=0;for(let Q=y-1;Q>0;Q-=2)for(Q===6&&Q--;;){for(let X=0;X<2;X++)if(!A.isReserved(U,Q-X)){let Y=!1;K<T.length&&(Y=(T[K]>>>P&1)===1),A.set(U,Q-X,Y),P--,P===-1&&(K++,P=7)}if(U+=z,U<0||y<=U){U-=z,z=-z;break}}}function M(A,T,y){const z=new n;y.forEach(function(X){z.put(X.mode.bit,4),z.put(X.getLength(),C.getCharCountIndicator(X.mode,A)),X.write(z)});const U=l.getSymbolTotalCodewords(A),P=h.getTotalCodewordsCount(A,T),K=(U-P)*8;for(z.getLengthInBits()+4<=K&&z.put(0,4);z.getLengthInBits()%8!==0;)z.putBit(0);const Q=(K-z.getLengthInBits())/8;for(let X=0;X<Q;X++)z.put(X%2?17:236,8);return G(z,A,T)}function G(A,T,y){const z=l.getSymbolTotalCodewords(T),U=h.getTotalCodewordsCount(T,y),P=z-U,K=h.getBlocksCount(T,y),Q=z%K,X=K-Q,Y=Math.floor(z/K),D=Math.floor(P/K),I=D+1,F=Y-D,W=new g(F);let it=0;const Z=new Array(K),at=new Array(K);let rt=0;const V=new Uint8Array(A.buffer);for(let wt=0;wt<K;wt++){const Ut=wt<X?D:I;Z[wt]=V.slice(it,it+Ut),at[wt]=W.encode(Z[wt]),it+=Ut,rt=Math.max(rt,Ut)}const J=new Uint8Array(z);let $=0,nt,dt;for(nt=0;nt<rt;nt++)for(dt=0;dt<K;dt++)nt<Z[dt].length&&(J[$++]=Z[dt][nt]);for(nt=0;nt<F;nt++)for(dt=0;dt<K;dt++)J[$++]=at[dt][nt];return J}function O(A,T,y,z){let U;if(Array.isArray(A))U=E.fromArray(A);else if(typeof A=="string"){let Y=T;if(!Y){const D=E.rawSplit(A);Y=m.getBestVersionForData(D,y)}U=E.fromString(A,Y||40)}else throw new Error("Invalid data");const P=m.getBestVersionForData(U,y);if(!P)throw new Error("The amount of data is too big to be stored in a QR Code");if(!T)T=P;else if(T<P)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+P+`.
`);const K=M(T,y,U),Q=l.getSymbolSize(T),X=new i(Q);return R(X,T),v(X),N(X,T),L(X,y,0),T>=7&&B(X,T),j(X,K),isNaN(z)&&(z=f.getBestMask(X,L.bind(null,X,y))),f.applyMask(z,X),L(X,y,z),{modules:X,version:T,errorCorrectionLevel:y,maskPattern:z,segments:U}}return Wp.create=function(T,y){if(typeof T>"u"||T==="")throw new Error("No input text");let z=t.M,U,P;return typeof y<"u"&&(z=t.from(y.errorCorrectionLevel,t.M),U=m.from(y.version),P=f.from(y.maskPattern),y.toSJISFunc&&l.setToSJISFunction(y.toSJISFunc)),O(T,U,z,P)},Wp}var vm={},ym={},g2;function bb(){return g2||(g2=1,(function(l){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let i=n.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+n);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(o){return[o,o]}))),i.length===6&&i.push("F","F");const r=parseInt(i.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+i.slice(0,6).join("")}}l.getOptions=function(i){i||(i={}),i.color||(i.color={});const r=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,o=i.width&&i.width>=21?i.width:void 0,f=i.scale||4;return{width:o,scale:o?4:f,margin:r,color:{dark:t(i.color.dark||"#000000ff"),light:t(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},l.getScale=function(i,r){return r.width&&r.width>=i+r.margin*2?r.width/(i+r.margin*2):r.scale},l.getImageWidth=function(i,r){const o=l.getScale(i,r);return Math.floor((i+r.margin*2)*o)},l.qrToImageData=function(i,r,o){const f=r.modules.size,h=r.modules.data,g=l.getScale(f,o),m=Math.floor((f+o.margin*2)*g),_=o.margin*g,C=[o.color.light,o.color.dark];for(let E=0;E<m;E++)for(let R=0;R<m;R++){let v=(E*m+R)*4,N=o.color.light;if(E>=_&&R>=_&&E<m-_&&R<m-_){const B=Math.floor((E-_)/g),L=Math.floor((R-_)/g);N=C[h[B*f+L]?1:0]}i[v++]=N.r,i[v++]=N.g,i[v++]=N.b,i[v]=N.a}}})(ym)),ym}var p2;function wT(){return p2||(p2=1,(function(l){const t=bb();function n(r,o,f){r.clearRect(0,0,o.width,o.height),o.style||(o.style={}),o.height=f,o.width=f,o.style.height=f+"px",o.style.width=f+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}l.render=function(o,f,h){let g=h,m=f;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),f||(m=i()),g=t.getOptions(g);const _=t.getImageWidth(o.modules.size,g),C=m.getContext("2d"),E=C.createImageData(_,_);return t.qrToImageData(E.data,o,g),n(C,m,_),C.putImageData(E,0,0),m},l.renderToDataURL=function(o,f,h){let g=h;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),g||(g={});const m=l.render(o,f,g),_=g.type||"image/png",C=g.rendererOpts||{};return m.toDataURL(_,C.quality)}})(vm)),vm}var Sm={},m2;function RT(){if(m2)return Sm;m2=1;const l=bb();function t(r,o){const f=r.a/255,h=o+'="'+r.hex+'"';return f<1?h+" "+o+'-opacity="'+f.toFixed(2).slice(1)+'"':h}function n(r,o,f){let h=r+o;return typeof f<"u"&&(h+=" "+f),h}function i(r,o,f){let h="",g=0,m=!1,_=0;for(let C=0;C<r.length;C++){const E=Math.floor(C%o),R=Math.floor(C/o);!E&&!m&&(m=!0),r[C]?(_++,C>0&&E>0&&r[C-1]||(h+=m?n("M",E+f,.5+R+f):n("m",g,0),g=0,m=!1),E+1<o&&r[C+1]||(h+=n("h",_),_=0)):g++}return h}return Sm.render=function(o,f,h){const g=l.getOptions(f),m=o.modules.size,_=o.modules.data,C=m+g.margin*2,E=g.color.light.a?"<path "+t(g.color.light,"fill")+' d="M0 0h'+C+"v"+C+'H0z"/>':"",R="<path "+t(g.color.dark,"stroke")+' d="'+i(_,m,g.margin)+'"/>',v='viewBox="0 0 '+C+" "+C+'"',B='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+v+' shape-rendering="crispEdges">'+E+R+`</svg>
`;return typeof h=="function"&&h(null,B),B},Sm}var v2;function OT(){if(v2)return af;v2=1;const l=oT(),t=AT(),n=wT(),i=RT();function r(o,f,h,g,m){const _=[].slice.call(arguments,1),C=_.length,E=typeof _[C-1]=="function";if(!E&&!l())throw new Error("Callback required as last argument");if(E){if(C<2)throw new Error("Too few arguments provided");C===2?(m=h,h=f,f=g=void 0):C===3&&(f.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=h,h=f,f=void 0))}else{if(C<1)throw new Error("Too few arguments provided");return C===1?(h=f,f=g=void 0):C===2&&!f.getContext&&(g=h,h=f,f=void 0),new Promise(function(R,v){try{const N=t.create(h,g);R(o(N,f,g))}catch(N){v(N)}})}try{const R=t.create(h,g);m(null,o(R,f,g))}catch(R){m(R)}}return af.create=t.create,af.toCanvas=r.bind(null,n.render),af.toDataURL=r.bind(null,n.renderToDataURL),af.toString=r.bind(null,function(o,f,h){return i.render(o,h)}),af}var xT=OT();const _b=pf(xT),Eb=({active:l=!1,size:t=20})=>{const n=l?"#ff4d4f":"#b8c1cc",i=l?"#ff4d4f":"transparent";return k.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[k.jsx("path",{d:"M5 2.5V17.5",stroke:n,strokeWidth:"1.6",strokeLinecap:"round"}),k.jsx("path",{d:"M5 3h10l-2 3 2 3H5V3Z",fill:i,stroke:n,strokeWidth:"1.4",strokeLinejoin:"round"})]})},Cb=({student:l,onClick:t,onToggleFlag:n,teacherAnnotations:i=[],sharedImage:r,hideNames:o=!1})=>{var G,O,A,T;const f=st.useRef(null),h=st.useRef(null),[g,m]=st.useState(null),[_,C]=st.useState(300);st.useEffect(()=>{if(!r){m(null);return}const y=new window.Image;y.src=r.dataUrl,y.onload=()=>{m(y)}},[r]),st.useEffect(()=>{if(!h.current)return;const y=()=>{h.current&&C(h.current.clientWidth)};y();const z=new ResizeObserver(y);return z.observe(h.current),()=>z.disconnect()},[]);const E=()=>{if(l!=null&&l.name)return l.name;if(!(l!=null&&l.clientId))return"Unknown Student";const y=l.clientId.match(/student-(\d+)/);return y?`Student ${y[1]}`:l.clientId},R=()=>{if(!l.lastUpdate)return"Just joined";const y=Math.floor((Date.now()-l.lastUpdate)/1e3);return y<5?"Just now":y<60?`${y}s ago`:`${Math.floor(y/60)}m ago`},v=((O=(G=l.meta)==null?void 0:G.base)==null?void 0:O.width)||800,N=((T=(A=l.meta)==null?void 0:A.base)==null?void 0:T.height)||600,B=_/v,L=y=>{y.stopPropagation(),n&&n(l.clientId)},M=(()=>{if(!r||!g)return null;const y=r.width/r.height,z=v/N;let U,P,K,Q;return y>z?(U=v,P=v/y,K=0,Q=(N-P)/2):(P=N,U=N*y,K=(v-U)/2,Q=0),{x:K,y:Q,width:U,height:P}})();return k.jsxs("div",{className:`student-card ${l.isActive?"active":"inactive"}`,onClick:()=>t(l),children:[k.jsxs("div",{className:"student-card-header",children:[k.jsxs("div",{className:"student-name",children:[k.jsx("span",{className:"student-icon",children:"👤"}),o?"•••":E()]}),k.jsxs("div",{className:"student-header-actions",children:[k.jsx("button",{className:`flag-button ${l.isFlagged?"active":""}`,onClick:L,"aria-label":l.isFlagged?"Remove flag":"Flag student",title:l.isFlagged?"Remove flag":"Flag student",children:k.jsx(Eb,{active:l.isFlagged,size:18})}),k.jsxs("div",{className:"student-status",children:[k.jsx("span",{className:`status-dot ${l.isActive?"online":"offline"}`}),l.isVisible===!1&&l.isActive&&k.jsx("span",{className:"visibility-indicator away",title:"Student is distracted (switched away from tab)",children:"⚠️"})]})]})]}),k.jsxs("div",{className:"student-card-canvas",ref:h,children:[k.jsxs(Ng,{ref:f,width:v,height:N,scaleX:B,scaleY:B,style:{transformOrigin:"top left",width:"100%",height:"100%"},children:[M&&k.jsx(Yr,{listening:!1,children:k.jsx(iv,{image:g,x:M.x,y:M.y,width:M.width,height:M.height})}),k.jsx(Yr,{children:l.lines&&l.lines.map((y,z)=>k.jsx(fo,{points:y.points,stroke:y.color||"black",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`preview-${l.clientId}-${z}`))}),k.jsx(Yr,{children:i.map((y,z)=>k.jsx(fo,{points:y.points,stroke:y.color||"#FF0000",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${l.clientId}-${z}`))})]}),(!l.lines||l.lines.length===0)&&k.jsxs("div",{className:"no-drawing",children:[k.jsx("span",{children:"✏️"}),k.jsx("p",{children:"No drawing yet"})]}),l.lines&&l.lines.length>0&&k.jsxs("div",{className:"stroke-count",children:[l.lines.length," stroke",l.lines.length!==1?"s":""]})]}),k.jsxs("div",{className:"student-card-footer",children:[k.jsx("span",{className:"last-update",children:R()}),k.jsx("span",{className:"click-hint",children:"Click to annotate →"})]})]})},rf={width:800,height:600},hg="teacherAnnotationPrefs",y2=2,bm=[{label:"Red",value:"#FF3B30"},{label:"Purple",value:"#7C3AED"},{label:"Teal",value:"#0EA5E9"}],Tb=({student:l,isOpen:t,onClose:n,onAnnotate:i,existingAnnotations:r=[],isFlagged:o=!1,onToggleFlag:f,sharedImage:h})=>{const[g,m]=st.useState("pen"),[_,C]=st.useState(bm[0].value),[E,R]=st.useState(3),[v,N]=st.useState(!1),[B,L]=st.useState([]),[j,M]=st.useState("stylus-only"),[G,O]=st.useState("left"),[A,T]=st.useState(null),[y,z]=st.useState(!1),U=st.useRef([]),P=st.useRef([]),K=st.useRef(!1),Q=st.useRef(null),X=st.useRef(!0),Y=st.useRef(0),D=st.useRef(null),I=st.useRef(null);st.useEffect(()=>{if(!h){T(null);return}const Ot=new window.Image;Ot.src=h.dataUrl,Ot.onload=()=>{T(Ot)}},[h]);const F=st.useRef(null),W=st.useRef(null),[it,Z]=st.useState({width:960,height:720}),at=st.useMemo(()=>({x:it.width/rf.width,y:it.height/rf.height}),[it]);st.useEffect(()=>{const Ot=()=>{z(window.innerWidth<=768)};return Ot(),window.addEventListener("resize",Ot),()=>window.removeEventListener("resize",Ot)},[]),st.useEffect(()=>{if(!(typeof window>"u"))try{const Ot=localStorage.getItem(hg);if(Ot){const Kt=JSON.parse(Ot);if(Kt.version!==y2){localStorage.removeItem(hg);return}Kt.tool&&m(Kt.tool),Kt.color&&C(Kt.color),typeof Kt.brushSize=="number"&&R(Kt.brushSize),Kt.inputMode&&M(Kt.inputMode),Kt.toolbarPosition&&O(Kt.toolbarPosition)}}catch{localStorage.removeItem(hg)}},[]),st.useEffect(()=>{if(typeof window>"u")return;if(X.current){X.current=!1;return}const Ot={version:y2,tool:g,color:_,brushSize:E,inputMode:j,toolbarPosition:G};localStorage.setItem(hg,JSON.stringify(Ot))},[g,_,E,j,G]),st.useEffect(()=>{t&&l&&l.clientId!==Q.current&&(Q.current=l.clientId,L(r),U.current=[],P.current=[])},[t,l,r]),st.useEffect(()=>{t&&l&&L(r)},[r,t,l]),st.useEffect(()=>()=>{I.current&&cancelAnimationFrame(I.current)},[]),st.useEffect(()=>{if(!t)return;const Ot=document.body.style.overflow,Kt=document.body.style.position,je=document.body.style.touchAction,ye=document.body.style.width,We=document.body.style.top,an=window.scrollY||document.documentElement.scrollTop||0;Y.current=an,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${an}px`,document.body.style.touchAction="none";const ge=F.current,ct=qt=>{const pe=qt.target;pe.closest("button")||pe.closest(".annotation-sidebar")||pe.closest(".annotation-status-actions")||qt.preventDefault()},At=qt=>{qt.preventDefault()},Mt=qt=>{if(v)return qt.preventDefault(),!1};return ge&&(ge.addEventListener("touchstart",ct,{passive:!1}),ge.addEventListener("touchmove",ct,{passive:!1}),ge.addEventListener("gesturestart",At,{passive:!1}),ge.addEventListener("gesturechange",At,{passive:!1})),document.addEventListener("selectstart",Mt),()=>{document.body.style.overflow=Ot,document.body.style.position=Kt,document.body.style.width=ye,document.body.style.top=We,document.body.style.touchAction=je,ge&&(ge.removeEventListener("touchstart",ct),ge.removeEventListener("touchmove",ct),ge.removeEventListener("gesturestart",At),ge.removeEventListener("gesturechange",At)),document.removeEventListener("selectstart",Mt),requestAnimationFrame(()=>{window.scrollTo(0,Y.current)})}},[t,v]),st.useEffect(()=>{if(!t)return;const Ot=()=>{if(!F.current)return;const Kt=F.current.getBoundingClientRect(),We=24+4,an=Math.max(320,Kt.width-We),ge=Math.max(240,Kt.height-We),ct=an/rf.width,At=ge/rf.height,Mt=Math.min(ct,At);Z({width:Math.round(rf.width*Mt),height:Math.round(rf.height*Mt)})};return Ot(),window.addEventListener("resize",Ot),()=>window.removeEventListener("resize",Ot)},[G,t]);const rt=()=>{if(!h||!A)return null;const Ot=h.width/h.height,Kt=it.width/it.height;let je,ye,We,an;return Ot>Kt?(je=it.width,ye=it.width/Ot,We=0,an=(it.height-ye)/2):(ye=it.height,je=it.height*Ot,We=(it.width-je)/2,an=0),{x:We,y:an,width:je,height:ye}};if(!t||!l)return null;const V=rt(),J=()=>{if(l.name)return l.name;const Ot=l.clientId.match(/student-(\d+)/)||l.clientId.match(/load-test-student-(\d+)/);return Ot?`Student ${Ot[1]}`:l.clientId},$=Ot=>j!=="stylus-only"?!0:(Ot==null?void 0:Ot.pointerType)==="pen",nt=(Ot=[])=>Ot.map((Kt,je)=>je%2===0?Kt*at.x:Kt*at.y),dt=Ot=>({x:Ot.x/at.x,y:Ot.y/at.y}),wt=Ot=>(Ot.strokeWidth||3)*at.x,Ut=Ot=>{const Kt=Ot.evt;if(Kt!=null&&Kt.preventDefault&&Kt.preventDefault(),Kt!=null&&Kt.stopPropagation&&Kt.stopPropagation(),!$(Kt))return;const je=Ot.target.getStage();if(je&&Kt.pointerId!==void 0){const ye=je.content;if(ye&&ye.setPointerCapture)try{ye.setPointerCapture(Kt.pointerId)}catch{}}if(g==="pen"){N(!0);const ye=je.getPointerPosition(),{x:We,y:an}=dt(ye),ge={tool:"pen",points:[We,an],color:_,strokeWidth:E};U.current.push([...B]),P.current=[],D.current=ge,L([...B,ge])}else g==="eraser"&&(N(!0),K.current=!1)},It=Ot=>{const Kt=Ot.evt;if(Kt!=null&&Kt.preventDefault&&Kt.preventDefault(),Kt!=null&&Kt.stopPropagation&&Kt.stopPropagation(),!v||!$(Kt))return;const ye=Ot.target.getStage().getPointerPosition();if(g==="pen"){if(D.current){const{x:We,y:an}=dt(ye);D.current.points=D.current.points.concat([We,an]);const ge=D.current;I.current&&cancelAnimationFrame(I.current),I.current=requestAnimationFrame(()=>{ge&&L(ct=>ct.length===0?ct:[...ct.slice(0,-1),ge])})}}else if(g==="eraser"){const We=B.length,an=20,ge=B.filter(ct=>{for(let At=0;At<ct.points.length;At+=2){const Mt=ct.points[At]*at.x,qt=ct.points[At+1]*at.y;if(Math.sqrt(Math.pow(Mt-ye.x,2)+Math.pow(qt-ye.y,2))<an)return!1}return!0});ge.length<We&&!K.current&&(U.current.push([...B]),P.current=[],K.current=!0),L(ge)}},ne=Ot=>{const Kt=Ot==null?void 0:Ot.evt;if(!$(Kt)){Kt!=null&&Kt.preventDefault&&Kt.preventDefault();return}if(N(!1),I.current&&(cancelAnimationFrame(I.current),I.current=null),D.current&&g==="pen"){const je=D.current;L(ye=>{if(ye.length===0)return ye;const We=[...ye.slice(0,-1),je];return setTimeout(()=>i(We),0),We}),D.current=null}else setTimeout(()=>i(B),0)},ae=()=>{if(U.current.length>0){const Ot=U.current.pop();P.current.push([...B]),L(Ot),i(Ot)}},Lt=()=>{if(P.current.length>0){const Ot=P.current.pop();U.current.push([...B]),L(Ot),i(Ot)}},_e=()=>{U.current.push([...B]),P.current=[];const Ot=[];L(Ot),i(Ot)},we=()=>{f&&f(l.clientId)},Ze=()=>{N(!1),n()},He=()=>{M(Ot=>Ot==="stylus-only"?"all":"stylus-only")},gn=()=>{O(Ot=>Ot==="left"?"right":"left")},Pn=Ot=>{Ot.preventDefault(),Ot.stopPropagation()};return k.jsx("div",{className:"annotation-modal-overlay",onTouchMove:Pn,onTouchStart:Pn,children:k.jsx("div",{className:"annotation-modal student-console",children:k.jsxs("div",{className:"annotation-console",children:[k.jsxs("div",{className:"annotation-status-bar",children:[k.jsxs("div",{className:"annotation-status-text",children:[k.jsx("h1",{children:"Annotate Student"}),k.jsx("p",{children:J()})]}),k.jsxs("div",{className:"annotation-status-actions",children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:g==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",j==="all"?"All inputs":"Stylus only"]})}),k.jsxs("button",{className:`flag-pill ${o?"active":""}`,onClick:we,children:[k.jsx(Eb,{active:o,size:16}),o?"Flagged":"Flag"]}),k.jsxs("button",{className:"status-badge",onClick:gn,children:["Move toolbar to ",G==="left"?"right":"left"]}),k.jsx("button",{className:"status-badge danger",onClick:Ze,children:"✕ Close"})]})]}),k.jsxs("div",{className:`annotation-workspace ${G==="right"?"toolbar-right":""} ${y?"mobile-view":""}`,children:[y?k.jsxs("div",{className:"mobile-annotation-toolbar",children:[k.jsx("div",{className:"mobile-colors",children:bm.map(Ot=>k.jsx("button",{onClick:()=>C(Ot.value),className:`mobile-color-button ${_===Ot.value?"active":""}`,style:{background:Ot.value},"aria-label":Ot.label},Ot.value))}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>m("pen"),className:`mobile-tool-button ${g==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(db,{size:20})}),k.jsx("button",{onClick:()=>m("eraser"),className:`mobile-tool-button ${g==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(hb,{size:20})}),k.jsx("button",{onClick:ae,className:"mobile-tool-button",disabled:U.current.length===0,"aria-label":"Undo",children:k.jsx(mb,{size:20})}),k.jsx("button",{onClick:Lt,className:"mobile-tool-button",disabled:P.current.length===0,"aria-label":"Redo",children:k.jsx(gb,{size:20})}),k.jsx("button",{onClick:_e,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(pb,{size:20})})]})]}):k.jsxs("div",{className:"annotation-sidebar",children:[k.jsxs("div",{className:"sidebar-header",children:[k.jsx("h2",{children:"Annotation Console"}),k.jsx("p",{children:"Mirror of student workspace"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsx("div",{className:"color-row",children:bm.map(Ot=>k.jsx("button",{className:`color-button ${_===Ot.value?"active":""}`,style:{background:Ot.value},onClick:()=>C(Ot.value),"aria-label":Ot.label},Ot.value))})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>m("pen"),className:`tool-icon-button ${g==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>m("eraser"),className:`tool-icon-button ${g==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsxs("div",{className:"brush-size-control",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:E,onChange:Ot=>R(parseInt(Ot.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:E})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${j==="all"?"all":""}`,onClick:He,children:j==="stylus-only"?"Stylus only":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:ae,className:"history-button",disabled:U.current.length===0,children:"Undo"}),k.jsx("button",{onClick:Lt,className:"history-button",disabled:P.current.length===0,children:"Redo"}),k.jsx("button",{onClick:_e,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"annotation-canvas-panel",children:k.jsx("div",{className:"annotation-canvas-frame",ref:F,onTouchMove:Ot=>Ot.preventDefault(),onTouchStart:Ot=>Ot.preventDefault(),children:k.jsxs(Ng,{ref:W,width:it.width,height:it.height,onPointerDown:Ut,onPointerMove:It,onPointerUp:ne,onPointerLeave:ne,onTouchStart:Ot=>Ot.preventDefault(),onTouchMove:Ot=>Ot.preventDefault(),onTouchEnd:Ot=>Ot.preventDefault(),className:"annotation-stage",perfectDrawEnabled:!1,children:[V&&k.jsx(Yr,{listening:!1,children:k.jsx(iv,{image:A,x:V.x,y:V.y,width:V.width,height:V.height})}),k.jsx(Yr,{listening:!1,children:l.lines&&l.lines.map((Ot,Kt)=>k.jsx(fo,{points:nt(Ot.points),stroke:Ot.color||"black",strokeWidth:(Ot.strokeWidth||3)*at.x,tension:.5,lineCap:"round",lineJoin:"round"},`student-${Kt}`))}),k.jsx(Yr,{children:B.map((Ot,Kt)=>k.jsx(fo,{points:nt(Ot.points),stroke:Ot.color,strokeWidth:wt(Ot),tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${Kt}`))})]})})})]})]})})})},Ab=async(l,t=800,n=600,i=.7)=>{console.log("📸 Processing image:",l.name,l.type,l.size,"bytes");let r,o,f;if(typeof createImageBitmap=="function")try{console.log("📸 Using createImageBitmap");const v=await createImageBitmap(l);o=v.width,f=v.height,r=v}catch(v){console.warn("📸 createImageBitmap failed, using fallback:",v),r=null}r||(console.log("📸 Using Image() fallback for iOS/Safari"),r=await new Promise((v,N)=>{const B=new Image,L=URL.createObjectURL(l);B.onload=()=>{URL.revokeObjectURL(L),v(B)},B.onerror=j=>{URL.revokeObjectURL(L),console.error("📸 Image load error:",j),N(new Error(`Failed to load image: ${l.name}. File may be corrupted or in unsupported format.`))},B.src=L}),o=r.naturalWidth||r.width,f=r.naturalHeight||r.height);const h=Math.min(t/o,n/f,1),g=Math.round(o*h),m=Math.round(f*h);console.log("📸 Resizing:",o,"x",f,"→",g,"x",m);const _=document.createElement("canvas");_.width=g,_.height=m;const C=_.getContext("2d");C.fillStyle="#FFFFFF",C.fillRect(0,0,g,m),C.drawImage(r,0,0,g,m);const E=await new Promise((v,N)=>{try{_.toBlob(B=>{B?(console.log("📸 Compressed to:",B.size,"bytes"),v(B)):(console.error("📸 Canvas toBlob returned null"),N(new Error("Failed to compress image. Canvas may be too large or device out of memory.")))},"image/jpeg",i)}catch(B){console.error("📸 Canvas toBlob error:",B),N(new Error(`Failed to compress image: ${B.message}`))}}),R=await new Promise((v,N)=>{const B=new FileReader;B.onload=()=>{console.log("📸 Data URL created, length:",B.result.length),v(B.result)},B.onerror=L=>{var j;console.error("📸 Failed to create data URL:",L,B.error),N(new Error(`Failed to create data URL: ${((j=B.error)==null?void 0:j.message)||"Unknown FileReader error"}`))},B.readAsDataURL(E)});return console.log("📸 ✅ Image processing complete"),{blob:E,dataUrl:R,width:g,height:m,size:E.size}},MT=()=>{const[l,t]=vd(),n=yf(),i=()=>{const Dt="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let Bt="";for(let Wt=0;Wt<6;Wt++)Bt+=Dt.charAt(Math.floor(Math.random()*Dt.length));return Bt},[r,o]=st.useState(""),f=st.useRef(!1);st.useEffect(()=>{if(f.current)return;const Dt=l.get("room");if(Dt)o(Dt.toUpperCase());else{const Bt=i();o(Bt),t({room:Bt},{replace:!0})}f.current=!0},[l,t]);const[h,g]=st.useState(null),[m,_]=st.useState("created"),[C,E]=st.useState(null),[R,v]=st.useState(null),[N,B]=st.useState(!1),[L]=st.useState(`teacher-${Math.random().toString(36).substring(7)}`),[j,M]=st.useState(0),[G,O]=st.useState(()=>{const Dt=parseInt(l.get("bot"))||0,Bt={};if(Dt>0)for(let Wt=1;Wt<=Dt;Wt++){const $t=`bot-student-${Wt}`;Bt[$t]={studentId:$t,clientId:`bot-${Wt}`,name:`Bot ${Wt}`,lastUpdate:Date.now()-Wt*1e3,isActive:!0,isFlagged:!1}}return Bt}),[A,T]=st.useState(null),[y,z]=st.useState({}),[U,P]=st.useState(""),[K,Q]=st.useState("all"),[X,Y]=st.useState("all"),[D,I]=st.useState(()=>{const Dt=localStorage.getItem("teacherDashboardHideNames");return Dt?JSON.parse(Dt):!1}),[F,W]=st.useState(()=>{const Dt=localStorage.getItem("teacherDashboardCardsPerRow");return Dt?parseInt(Dt):3}),[it,Z]=st.useState("blank"),[at,rt]=st.useState(null),[V,J]=st.useState(null),[$,nt]=st.useState(""),[dt,wt]=st.useState(!1),[Ut,It]=st.useState(null),ne=st.useRef(null),ae=st.useRef({}),Lt=st.useRef(null),_e=st.useRef(null),we=st.useRef(null),[Ze,He]=st.useState(!1),[gn,Pn]=st.useState(""),[Ot,Kt]=st.useState([]);st.useRef(!1);const je=st.useRef({roomId:null,status:"idle"}),ye=st.useRef(new Set),We=st.useRef(!1);st.useEffect(()=>{ne.current=Ut},[Ut]),st.useEffect(()=>{ae.current=y},[y]);const an=st.useRef(0),ge=(Dt,Bt="info")=>{const Wt=`${Date.now()}-${an.current++}`;Kt($t=>[...$t,{id:Wt,message:Dt,type:Bt}]),setTimeout(()=>{Kt($t=>$t.filter(Yt=>Yt.id!==Wt))},4e3)},ct=st.useCallback(async(Dt="teacher_ended")=>{if(!h||m!=="active"&&m!=="created")return!1;try{if(j>0&&r){console.log(`💾 Saving final question ${j} before ending session...`);try{const Bt=await fetch("/api/strokes/persist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:r,sessionId:h,questionNumber:j,contentType:Ut!=null&&Ut.type?"template":Ut?"image":"blank",content:Ut})});if(Bt.ok){const Wt=await Bt.json();console.log(`✅ Saved final ${Wt.savedCount} student responses before ending`)}}catch(Bt){console.error("Error saving final question:",Bt)}}return await gu.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",h),R&&await R.publish("session-ended",{timestamp:Date.now(),reason:Dt}),_("ended"),Lt.current&&(clearTimeout(Lt.current),Lt.current=null),!0}catch(Bt){return console.error("Error ending session:",Bt),!1}},[h,m,R,j,r,Ut]);st.useEffect(()=>{if(!r||!h||j===0)return;const Dt=setTimeout(async()=>{try{const Bt=Object.entries(G).map(async([Wt,$t])=>{if(!(!$t.lines&&!y[Wt]))return fetch("/api/strokes/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:r,studentId:Wt,lines:$t.lines||[],annotations:y[Wt]||[],studentName:$t.name})})});await Promise.all(Bt)}catch(Bt){console.error("Error auto-saving to Redis:",Bt)}},2e3);return()=>clearTimeout(Dt)},[G,y,r,h,j]),st.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(D))},[D]),st.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",F.toString())},[F]),st.useEffect(()=>{if(!r||(je.current.roomId!==r&&(je.current={roomId:r,status:"idle"}),je.current.status==="in-progress"||je.current.status==="done"))return;je.current={roomId:r,status:"in-progress"};let Dt=!1;const Bt=()=>{const $t=je.current;!Dt&&$t.roomId===r&&(je.current={roomId:r,status:"idle"})};return(async()=>{try{const{data:$t,error:Yt}=await gu.from("sessions").select("*").ilike("room_code",r).order("created_at",{ascending:!1}).limit(1);if(Yt){console.error("Failed to query sessions:",Yt),Bt();return}let pn=null;if($t&&$t.length>0){const xn=$t[0];if(xn.status==="ended"){const{data:mn,error:Xt}=await gu.from("sessions").update({status:"created",started_at:null,ended_at:null}).eq("id",xn.id).select().single();if(Xt){console.error("Failed to update session:",Xt),Bt();return}pn=mn}else pn=xn}else{const{data:xn,error:mn}=await gu.from("sessions").insert([{room_code:r,status:"created"}]).select().single();if(mn)if(mn.code==="23505"){const{data:Xt,error:te}=await gu.from("sessions").select("*").ilike("room_code",r).order("created_at",{ascending:!1}).limit(1);if(te){console.error("Failed to load existing session after duplicate key error:",te),Bt();return}if(Xt&&Xt.length>0)pn=Xt[0];else{console.error("Duplicate key reported but no session found when refetching."),Bt();return}}else{console.error("Failed to create session:",mn),Bt();return}else pn=xn}if(Dt)return;pn?(g(pn.id),_(pn.status),Dt||(je.current={roomId:r,status:"done"})):Bt()}catch($t){console.error("Error initializing session:",$t),Bt()}})(),()=>{Dt=!0;const $t=je.current;$t.roomId===r&&$t.status==="in-progress"&&(je.current={roomId:r,status:"idle"})}},[r,L]),st.useEffect(()=>{if(!h||typeof window>"u")return;!N&&(m==="active"||m==="created")&&!Lt.current&&(console.log("⏱️ Teacher disconnected, starting 10-minute auto-logout timer"),Lt.current=window.setTimeout(async()=>{console.log("⏰ 10-minute timeout reached, automatically ending session"),await ct("teacher_timeout_10min")?console.log("✅ Session ended due to teacher inactivity"):console.warn("Auto-logout timer fired but session was already ended or unavailable"),Lt.current=null},600*1e3)),N&&Lt.current&&(console.log("✅ Teacher reconnected, cancelling auto-logout timer"),clearTimeout(Lt.current),Lt.current=null)},[N,h,m,ct]),st.useEffect(()=>()=>{Lt.current&&(clearTimeout(Lt.current),Lt.current=null)},[]),st.useEffect(()=>{if(We.current||!r||!L)return;We.current=!0;let Dt=null,Bt=null;return(async()=>{try{const $t=`/api/token?clientId=${L}`,Yt=await fetch($t),pn=await Yt.text();if(!Yt.ok)throw new Error(`Token request failed (${Yt.status} ${Yt.statusText})${pn?` – ${pn}`:""}`);let xn;try{xn=JSON.parse(pn)}catch(Xt){throw new Error(`Token response was not valid JSON: ${Xt.message}`)}Dt=new dv.Realtime({authCallback:async(Xt,te)=>{te(null,xn)},clientId:L}),Dt.connection.on("connected",()=>{B(!0),console.log("✅ Teacher connected to Ably")}),Dt.connection.on("disconnected",()=>{B(!1)}),Dt.connection.on("suspended",()=>{B(!1)}),Dt.connection.on("failed",()=>{B(!1)}),Dt.connection.on("closing",()=>{B(!1)}),Dt.connection.on("closed",()=>{B(!1)}),E(Dt),Bt=Dt.channels.get(`room-${r}`),Bt.presence.subscribe("enter",Xt=>{var Re,tn;if(!Xt.clientId||Xt.clientId===L||!Xt.clientId.includes("student"))return;const te=((Re=Xt.data)==null?void 0:Re.name)||At(Xt.clientId),re=Xt.clientId,oe=(tn=Xt.data)==null?void 0:tn.studentId;if(console.log("👤 Presence enter event:",{studentName:te,incomingClientId:re,incomingStudentId:oe,hasData:!!Xt.data}),!oe){console.warn("⚠️ Student joined without persistent studentId:",re);return}if(!re){console.warn("⚠️ Student joined without clientId:",oe);return}O(Hn=>{var Oa,yr;const Bn=Hn[oe];if(Bn&&Bn.clientId){console.log("🔄 Student reconnected:",Bn.clientId,"→",re,"(",te,")"),(A==null?void 0:A.studentId)===oe&&T({...Bn,clientId:re});const Ya={...Bn,clientId:re,name:te,isActive:!0,isVisible:((Oa=Xt.data)==null?void 0:Oa.isVisible)!==!1,lastUpdate:Date.now()};return console.log("✅ Updated existing student:",Ya),{...Hn,[oe]:Ya}}const on=!ye.current.has(oe);on?(ye.current.add(oe),ge(`${te} joined`,"success")):Bn&&!Bn.clientId&&console.warn("⚠️ Fixed student with undefined clientId:",oe);const Ra={studentId:oe,clientId:re,name:te,isActive:!0,isVisible:((yr=Xt.data)==null?void 0:yr.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:(Bn==null?void 0:Bn.isFlagged)||!1};return console.log(on?"✅ Added new student:":"✅ Initialized student with clientId:",Ra),console.log("📊 Total students after add:",Object.keys(Hn).length+1),{...Hn,[oe]:Ra}}),setTimeout(()=>{var Bn;const Hn=((Bn=ae.current)==null?void 0:Bn[oe])||[];Bt.publish("sync-full-state",{targetClientId:re,content:ne.current||null,annotations:Hn,timestamp:Date.now()}),Hn.length>0&&console.log("📤 Sent",Hn.length,"teacher annotations to",te)},300)}),Bt.presence.subscribe("leave",Xt=>{var te;if(Xt.clientId!==L&&Xt.clientId.includes("student")){const re=(te=Xt.data)==null?void 0:te.studentId;O(oe=>{const Re=re?oe[re]:null;if(!Re)return oe;const tn=(Re==null?void 0:Re.name)||At(Xt.clientId);ye.current.has(re)&&ge(`${tn} left`,"info");const{[re]:Hn,...Bn}=oe;return Bn})}}),Bt.subscribe("student-visibility",Xt=>{const{studentId:te,studentName:re,isVisible:oe}=Xt.data;te&&O(Re=>{const tn=Re[te];if(!tn)return Re;const Hn=tn.isVisible===!1;return oe?Hn&&ge(`✓ ${re} returned`,"success"):ge(`⚠️ ${re} switched away`,"warning"),{...Re,[te]:{...tn,isVisible:oe,lastVisibilityChange:Date.now()}}})}),Bt.subscribe("student-layer",Xt=>{const{lines:te,studentId:re,clientId:oe}=Xt.data;O(Re=>{const tn=re||Object.keys(Re).find(Hn=>Re[Hn].clientId===oe);return tn?(console.log("✅ Updating student",tn,"with",(te||[]).length,"lines"),{...Re,[tn]:{...Re[tn],lines:te||[]}}):(console.warn("⚠️ Student not found for stroke update. studentId:",re,"clientId:",oe),console.warn("Available students:",Object.keys(Re)),Re)})}),Bt.subscribe("teacher-image",Xt=>{It(Xt.data)}),Bt.subscribe("request-current-state",Xt=>{var re;const te=(re=Xt.data)==null?void 0:re.studentId;setTimeout(()=>{var Re;const oe=((Re=ae.current)==null?void 0:Re[te])||[];Bt.publish("sync-full-state",{targetClientId:Xt.clientId,content:ne.current||null,annotations:oe,timestamp:Date.now()})},100)}),await Bt.presence.enter({role:"teacher",timestamp:Date.now()});const mn=await Bt.presence.get();O(Xt=>{const te={...Xt};return console.log(`📥 Loading ${mn.length} existing members from presence`),mn.forEach(re=>{var Bn,wa,on;if(!re.clientId||re.clientId===L||!re.clientId.includes("student"))return;const oe=((Bn=re.data)==null?void 0:Bn.name)||At(re.clientId),Re=(wa=re.data)==null?void 0:wa.studentId,tn=re.clientId;if(!Re){console.warn("⚠️ Student in presence without studentId:",tn);return}if(!tn){console.warn("⚠️ Student in presence without clientId:",Re);return}const Hn=Xt[Re]||{};te[Re]={...Hn,studentId:Re,clientId:tn,name:oe,isActive:!0,isVisible:((on=re.data)==null?void 0:on.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:Hn.isFlagged||!1},ye.current.has(Re)||ye.current.add(Re),console.log("✅ Loaded student from presence:",oe,"| studentId:",Re,"| clientId:",tn)}),console.log(`📊 Total students in state after presence load: ${Object.keys(te).length}`),te}),v(Bt),setTimeout(async()=>{try{console.log("📥 Loading strokes from Redis...");const Xt=await fetch(`/api/strokes/load?roomId=${r}`);if(Xt.ok){const te=await Xt.json();te.students&&Object.keys(te.students).length>0&&(console.log(`✅ Loaded ${Object.keys(te.students).length} students' data from Redis`),O(re=>{const oe={...re};return Object.entries(te.students).forEach(([Re,tn])=>{var Hn;oe[Re]?oe[Re]={...oe[Re],lines:tn.lines||[]}:oe[Re]={studentId:Re,clientId:void 0,name:((Hn=tn.meta)==null?void 0:Hn.name)||"Unknown",lines:tn.lines||[],isActive:!1,lastUpdate:Date.now()}}),oe}),z(re=>{const oe={...re};return Object.entries(te.students).forEach(([Re,tn])=>{tn.annotations&&tn.annotations.length>0&&(oe[Re]=tn.annotations)}),oe}))}}catch(Xt){console.error("Error loading strokes from Redis:",Xt)}},1e3)}catch($t){console.error("Failed to connect to Ably:",$t)}})(),()=>{Bt&&(Bt.unsubscribe(),Bt.presence.unsubscribe()),Dt&&Dt.close()}},[r,L]);const At=Dt=>{const Bt=Dt.match(/student-(\d+)/)||Dt.match(/student-([\w]+)/);return Bt?`Student ${Bt[1]}`:Dt},Mt=Dt=>{T(G[Dt.studentId]||Dt)},qt=()=>{T(null)},pe=async Dt=>{if(!A||!R)return;const Bt=A.studentId,Wt=A.clientId;if(!Bt){console.error("❌ Student has no persistent studentId, cannot save annotation");return}z($t=>({...$t,[Bt]:Dt})),R.publish("teacher-annotation",{targetStudentId:Wt,annotations:Dt,teacherId:L,timestamp:Date.now()})},ht=Dt=>{O(Bt=>{const Wt=Bt[Dt];return Wt?{...Bt,[Dt]:{...Wt,isFlagged:!Wt.isFlagged}}:Bt}),T(Bt=>Bt&&Bt.studentId===Dt?{...Bt,isFlagged:!Bt.isFlagged}:Bt)},vt=()=>{_e.current&&(_e.current.value="",_e.current.click())},Rt=async Dt=>{var Yt,pn,xn,mn,Xt;const Bt=(Yt=Dt.target.files)==null?void 0:Yt[0];if(!Bt){nt("No file selected.");return}const Wt=(Bt.size/(1024*1024)).toFixed(2);if(console.log("📸 File selected:",{name:Bt.name,type:Bt.type,size:`${Wt}MB (${Bt.size} bytes)`,lastModified:new Date(Bt.lastModified).toISOString()}),!Bt.type.startsWith("image/")){const te=`❌ Invalid file type: ${Bt.type||"unknown"}. Please select an image file (JPG, PNG, etc.)`;nt(te),console.error(te),ge("Invalid file type","error");return}const $t=25;if(Bt.size>$t*1024*1024){const te=`❌ File too large: ${Wt}MB. Maximum size is ${$t}MB.`;nt(te),console.error(te),ge("File too large","error");return}wt(!0),nt(`Processing ${Bt.name} (${Wt}MB)...`);try{const{dataUrl:te,width:re,height:oe,size:Re}=await Ab(Bt),tn={dataUrl:te,width:re,height:oe,filename:Bt.name,timestamp:Date.now()};J(tn),nt(`✅ Image ready (${re}×${oe}, ${Math.round(Re/1024)}KB)`),console.log("✅ Image processed successfully")}catch(te){const re={fileName:Bt.name,fileType:Bt.type,fileSize:`${Wt}MB`,errorMessage:te.message||"Unknown error",errorStack:te.stack};console.error("❌ [TEACHER] Image upload failed:",re);let oe=`❌ Upload failed: ${te.message||"Unknown error"}
`;oe+=`File: ${Bt.name} (${Bt.type})
`,oe+=`Size: ${Wt}MB
`,(pn=te.message)!=null&&pn.includes("load")?oe+="Error loading image. The file may be corrupted or in an unsupported format.":(xn=te.message)!=null&&xn.includes("compress")?oe+="Error compressing image. Try a different image or smaller file.":(mn=te.message)!=null&&mn.includes("memory")||(Xt=te.message)!=null&&Xt.includes("allocation")?oe+="Image too large for device memory. Try a smaller image.":oe+="Try a different image or format (JPG/PNG recommended).",nt(oe),ge(`Upload failed: ${te.message}`,"error")}finally{wt(!1)}},ue=()=>{J(null),nt(""),_e.current&&(_e.current.value="")},ce=Dt=>{const Bt=document.createElement("canvas"),Wt=800,$t=600;Bt.width=Wt,Bt.height=$t;const Yt=Bt.getContext("2d");if(Yt.fillStyle="#FFFFFF",Yt.fillRect(0,0,Wt,$t),Dt==="hanzi"){const mn=(Wt-450)/2,Xt=($t-450)/2;Yt.strokeStyle="#0F9D83",Yt.lineWidth=4,Yt.strokeRect(mn,Xt,450,450),Yt.strokeStyle="#B0E8D8",Yt.lineWidth=2,Yt.setLineDash([8,8]),Yt.beginPath(),Yt.moveTo(Wt/2,Xt),Yt.lineTo(Wt/2,Xt+450),Yt.stroke(),Yt.beginPath(),Yt.moveTo(mn,$t/2),Yt.lineTo(mn+450,$t/2),Yt.stroke()}else if(Dt==="graph-corner"){Yt.strokeStyle="#E0E0E0",Yt.lineWidth=1,Yt.setLineDash([]);for(let Xt=80;Xt<=Wt-80;Xt+=40)Yt.beginPath(),Yt.moveTo(Xt,80),Yt.lineTo(Xt,$t-80),Yt.stroke();for(let Xt=80;Xt<=$t-80;Xt+=40)Yt.beginPath(),Yt.moveTo(80,Xt),Yt.lineTo(Wt-80,Xt),Yt.stroke();Yt.strokeStyle="#5B9BD5",Yt.lineWidth=3,Yt.beginPath(),Yt.moveTo(80,$t-80),Yt.lineTo(Wt-80,$t-80),Yt.stroke(),Yt.beginPath(),Yt.moveTo(80,80),Yt.lineTo(80,$t-80),Yt.stroke()}else if(Dt==="graph-cross"){Yt.strokeStyle="#E0E0E0",Yt.lineWidth=1,Yt.setLineDash([]);for(let Xt=80;Xt<=Wt-80;Xt+=40)Yt.beginPath(),Yt.moveTo(Xt,80),Yt.lineTo(Xt,$t-80),Yt.stroke();for(let Xt=80;Xt<=$t-80;Xt+=40)Yt.beginPath(),Yt.moveTo(80,Xt),Yt.lineTo(Wt-80,Xt),Yt.stroke();Yt.strokeStyle="#5B9BD5",Yt.lineWidth=3,Yt.beginPath(),Yt.moveTo(80,$t/2),Yt.lineTo(Wt-80,$t/2),Yt.stroke(),Yt.beginPath(),Yt.moveTo(Wt/2,80),Yt.lineTo(Wt/2,$t-80),Yt.stroke()}const pn=Bt.toDataURL("image/png");return{type:Dt,dataUrl:pn,width:Wt,height:$t,timestamp:Date.now()}},Zt=Dt=>{const Bt=ce(Dt);rt(Bt),nt(`Template ready: ${Dt}`)},he=async()=>{if(!R||!h||!N){console.error("Cannot send: channel or sessionId missing",{channel:!!R,sessionId:h,isConnected:N}),nt("Error: Not connected properly. Please refresh the page."),ge("Failed to send: Connection issue","error");return}if($.includes("sending")){console.log("Already sending, ignoring duplicate click");return}nt("Sending to class...");try{if(j>0){console.log(`💾 Persisting question ${j} before moving to next...`);try{const $t=await fetch("/api/strokes/persist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:r,sessionId:h,questionNumber:j,contentType:Ut!=null&&Ut.type?"template":Ut?"image":"blank",content:Ut})});if($t.ok){const Yt=await $t.json();console.log(`✅ Persisted ${Yt.savedCount} student responses for question ${j}`)}else console.warn("Failed to persist question, but continuing...",await $t.text())}catch($t){console.error("Error persisting question:",$t)}}const Dt=j+1;if(M(Dt),console.log(`📝 Moving to question ${Dt}`),m==="created"){const{error:$t}=await gu.from("sessions").update({status:"active",started_at:new Date().toISOString()}).eq("id",h);if($t){console.error("Failed to start session:",$t),nt("Failed to start session. Please try again.");return}_("active"),await R.publish("session-started",{timestamp:Date.now(),sessionId:h})}let Wt=null;it==="templates"&&at?Wt=at:it==="image"&&V&&(Wt=V),await R.publish("clear-all-drawings",{timestamp:Date.now(),content:Wt}),O($t=>{const Yt={};return Object.keys($t).forEach(pn=>{Yt[pn]={...$t[pn],lines:[]}}),Yt}),z({}),it==="blank"?(It(null),rt(null),nt("Blank canvas sent to all students.")):it==="templates"&&at?(It(at),nt("Template sent to all students.")):it==="image"&&V&&(It(V),nt("Image sent to all students.")),ge("Content sent!","success")}catch(Dt){console.error("Failed to send to class:",Dt),nt("Failed to send. Please try again."),ge("Failed to send content","error")}},fe=async()=>{window.confirm(`Are you sure you want to end this session?

All students will be logged out and the session will be closed.`)&&(await ct("teacher_ended"),C&&C.close(),n("/"))},Be=async()=>{const Dt=`${window.location.origin}/student?room=${r}`;try{const Bt=await _b.toDataURL(Dt,{width:300,margin:2,color:{dark:"#0F172A",light:"#FFFFFF"}});Pn(Bt),He(!0)}catch(Bt){console.error("Failed to generate QR code:",Bt)}},$e=async()=>{const Dt=`${window.location.origin}/student?room=${r}`,Bt=()=>{ge("Link copied to clipboard!","success")};if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(Dt),Bt();return}catch(Wt){console.error("Clipboard API failed:",Wt)}try{const Wt=we.current;if(Wt&&(Wt.select(),Wt.setSelectionRange(0,Dt.length),document.execCommand("copy"))){Bt(),window.getSelection().removeAllRanges();return}throw new Error("execCommand failed")}catch(Wt){console.error("Fallback copy failed:",Wt),we.current&&we.current.select(),ge("Select the link and press ⌘C/CTRL+C to copy","warning")}},Fn=()=>Object.values(G).sort((Dt,Bt)=>{const Wt=(Dt.name||Dt.clientId||"").toLowerCase(),$t=(Bt.name||Bt.clientId||"").toLowerCase();return Wt.localeCompare($t)}),na=()=>{const Dt=Fn(),Bt=U.trim().toLowerCase();return Dt.filter(Wt=>{const $t=Bt?(Wt.name||Wt.studentId).toLowerCase().includes(Bt):!0,Yt=K==="all"||K==="flagged"&&Wt.isFlagged,pn=X==="all"||X==="distracted"&&Wt.isVisible===!1&&Wt.isActive;return $t&&Yt&&pn})},Ii=Fn(),yl=na(),So=Ii.filter(Dt=>Dt.isActive).length,ki=A?G[A.studentId]||A:null,Aa=$?!/fail|no file/i.test($):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:Ot.map(Dt=>k.jsxs("div",{className:`toast toast-${Dt.type}`,children:[Dt.type==="success"&&k.jsx("span",{className:"toast-icon",children:"✓"}),Dt.type==="info"&&k.jsx("span",{className:"toast-icon",children:"ℹ"}),Dt.type==="error"&&k.jsx("span",{className:"toast-icon",children:"✕"}),k.jsx("span",{className:"toast-message",children:Dt.message})]},Dt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsxs("div",{className:"feather-branding",onClick:()=>window.location.reload(),style:{cursor:"pointer"},children:[k.jsx(XC,{size:32,strokeWidth:2}),k.jsx("span",{className:"feather-text",children:"Feather"})]}),k.jsx("section",{className:"hero-card glass-panel",children:k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"Teacher dashboard"}),k.jsx("h1",{children:"Monitor and annotate student canvases live"}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code to invite students. Their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:Be,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:r})]}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Session live"}),k.jsx("span",{className:`status-pill connection-pill ${N?"online":"offline"}`,children:N?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:So}),k.jsx("span",{children:"online"})]})]}),k.jsx("button",{className:"end-session-btn",onClick:fe,title:"End session and logout all students",children:"End Session"})]})]})}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),at&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",at.type==="hanzi"?"Hanzi":at.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:he,disabled:it==="image"&&!V,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${it==="blank"?"active":""}`,onClick:()=>{Z("blank"),rt(null),J(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${it==="templates"?"active":""}`,onClick:()=>{Z("templates"),J(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${it==="image"?"active":""} ${V?"ready":""}`,onClick:()=>{Z("image"),rt(null)},disabled:dt,children:dt?"Uploading…":"Send image"})]}),k.jsx("input",{ref:_e,type:"file",accept:"image/*",onChange:Rt,style:{display:"none"}}),it==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(at==null?void 0:at.type)==="hanzi"?"active":""}`,onClick:()=>Zt("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(at==null?void 0:at.type)==="graph-corner"?"active":""}`,onClick:()=>Zt("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(at==null?void 0:at.type)==="graph-cross"?"active":""}`,onClick:()=>Zt("graph-cross"),children:"Graph (cross)"})]}),at&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:at.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),it==="image"&&k.jsx(k.Fragment,{children:V?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:V.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:V.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:V.width&&V.height?`${Math.round(V.width)} × ${Math.round(V.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:vt,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:ue,children:"Clear"})]}),$&&k.jsx("span",{className:`image-message ${Aa?"success":"error"}`,children:$})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:vt,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),$&&k.jsx("span",{className:`image-message ${Aa?"success":"error"}`,children:$})]})}),it==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"controls-section glass-panel",children:k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:"🔍"}),k.jsx("input",{type:"text",placeholder:"Filter students",value:U,onChange:Dt=>P(Dt.target.value),className:"search-input"}),U&&k.jsx("button",{className:"clear-search-btn",onClick:()=>P(""),title:"Clear search",children:"✕"})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:D,onChange:Dt=>I(Dt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${K==="flagged"?"active":""}`,onClick:()=>Q(Dt=>Dt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${X==="distracted"?"active":""}`,onClick:()=>Y(Dt=>Dt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:"⚠️ Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:F,onChange:Dt=>W(Number(Dt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:Ii.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),k.jsx("h2",{children:"Waiting for students to join…"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):yl.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:"🔍"}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',U,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>P(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${F}, 1fr)`},children:yl.filter(Dt=>Dt&&Dt.studentId&&Dt.clientId).map(Dt=>k.jsx(Cb,{student:Dt,onClick:Mt,onToggleFlag:ht,teacherAnnotations:y[Dt.studentId]||[],sharedImage:Ut,hideNames:D},Dt.studentId))})})})]}),k.jsx(Tb,{student:ki,isOpen:!!ki,isFlagged:ki==null?void 0:ki.isFlagged,onToggleFlag:ht,onClose:qt,onAnnotate:pe,existingAnnotations:ki?y[ki.studentId]||[]:[],sharedImage:Ut}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:["💡 ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),Ze&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>He(!1),children:k.jsxs("div",{className:"qr-modal",onClick:Dt=>Dt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",r]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>He(!1),children:"✕"})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:gn&&k.jsx("img",{src:gn,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:we,type:"text",value:`${window.location.origin}/student?room=${r}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:$e,children:"Copy Link"})]})]})]})]})})]})},S2={width:800,height:600};function NT(){const[l]=vd(),t=l.get("room")||"load-test",n=l.get("name")||`TestStudent-${Date.now()}`,[i,r]=st.useState(null),[o]=st.useState(`test-student-${Math.random().toString(36).substr(2,9)}`),[f,h]=st.useState(!1),[g,m]=st.useState([]),[_,C]=st.useState([]),[E,R]=st.useState("pen"),[v,N]=st.useState(!1),B=st.useRef(!1);st.useEffect(()=>{(async()=>{try{const A=new yS.Realtime({authUrl:"/api/token",authParams:{clientId:o}});A.connection.on("connected",()=>{console.log("Connected to Ably"),h(!0)}),A.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),h(!1)});const T=A.channels.get(`room-${t}`);await new Promise((z,U)=>{T.once("attached",z),T.once("failed",U),T.attach()}),console.log("✅ Test Student channel attached");const y={name:n,role:"student",testMode:!0};console.log("📍 Entering presence with data:",y),await T.presence.enter(y),console.log("✅ Test Student entered presence as:",n),T.subscribe("student-layer",z=>{B.current=!0;const U=z.data;U.action==="clear"?m([]):U.lines&&m(P=>[...P,...U.lines]),setTimeout(()=>{B.current=!1},0)}),T.subscribe("teacher-layer",z=>{const U=z.data;U.action==="clear"?C([]):U.lines&&C(P=>[...P,...U.lines])}),r(T)}catch(A){console.error("Failed to initialize Ably:",A)}})()},[o,t,n]);const L=O=>{const A=O.target.getStage().getPointerPosition();if(!A)return;N(!0);const T={tool:E,points:[A.x,A.y],color:"black",strokeWidth:3};m([...g,T])},j=O=>{if(!v)return;const T=O.target.getStage().getPointerPosition();if(!T)return;const y=g[g.length-1];y&&(y.points=y.points.concat([T.x,T.y]),m([...g.slice(0,-1),y]))},M=()=>{if(!v||!i){N(!1);return}N(!1);const O=g[g.length-1];O&&O.points.length>=4&&i.publish("student-layer",{lines:[O]})},G=()=>{m([]),i&&i.publish("student-layer",{action:"clear"})};return k.jsxs("div",{className:"student-container",children:[k.jsxs("div",{className:"student-header",children:[k.jsxs("div",{className:"student-info",children:[k.jsx("span",{className:"student-name",children:n}),k.jsxs("span",{className:"room-code",children:["Room: ",t]}),k.jsx("span",{className:`connection-status ${f?"connected":"disconnected"}`,children:f?"● Connected":"○ Disconnected"})]}),k.jsx("div",{className:"test-badge",children:"TEST MODE"})]}),k.jsxs("div",{className:"toolbar",children:[k.jsx("button",{className:`tool-btn ${E==="pen"?"active":""}`,onClick:()=>R("pen"),title:"Pen",children:"✏️ Pen"}),k.jsx("button",{className:`tool-btn ${E==="eraser"?"active":""}`,onClick:()=>R("eraser"),title:"Eraser",children:"🧹 Eraser"}),k.jsx("button",{className:"tool-btn",onClick:G,title:"Clear Canvas",children:"🗑️ Clear"})]}),k.jsx("div",{className:"canvas-container",children:k.jsxs(Ng,{width:S2.width,height:S2.height,onMouseDown:L,onMousemove:j,onMouseup:M,onTouchStart:L,onTouchMove:j,onTouchEnd:M,className:"konva-stage",children:[k.jsx(Yr,{children:g.map((O,A)=>k.jsx(fo,{points:O.points,stroke:O.tool==="eraser"?"white":O.color,strokeWidth:O.tool==="eraser"?20:O.strokeWidth,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:O.tool==="eraser"?"destination-out":"source-over"},`student-${A}`))}),k.jsx(Yr,{listening:!1,children:_.map((O,A)=>k.jsx(fo,{points:O.points,stroke:"red",strokeWidth:O.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round",opacity:.7},`teacher-${A}`))})]})}),k.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",background:"#f0f0f0",padding:"10px",borderRadius:"8px",fontSize:"12px"},children:[k.jsx("div",{children:k.jsx("strong",{children:"Test Mode Instructions:"})}),k.jsx("div",{children:"• No login required"}),k.jsx("div",{children:"• Draw on canvas to test"}),k.jsx("div",{children:"• Red lines are from teacher"})]})]})}const jT=()=>{const[l]=vd(),t=yf(),n=()=>{const ht=l.get("room");return ht?ht.toUpperCase():"load-test".toUpperCase()},[i]=ei.useState(n),[r,o]=st.useState(null),[f,h]=st.useState(null),[g,m]=st.useState(!1),[_]=st.useState(`test-teacher-${Math.random().toString(36).substring(7)}`),[C,E]=st.useState({}),[R,v]=st.useState(null),[N,B]=st.useState({}),[L,j]=st.useState(""),[M,G]=st.useState("all"),[O,A]=st.useState("all"),[T,y]=st.useState(()=>{const ht=localStorage.getItem("teacherDashboardHideNames");return ht?JSON.parse(ht):!1}),[z,U]=st.useState(()=>{const ht=localStorage.getItem("teacherDashboardCardsPerRow");return ht?parseInt(ht):3}),[P,K]=st.useState("blank"),[Q,X]=st.useState(null),[Y,D]=st.useState(null),[I,F]=st.useState(""),[W,it]=st.useState(!1),[Z,at]=st.useState(null),rt=st.useRef(null),V=st.useRef(null),J=st.useRef(null),[$,nt]=st.useState(!1),[dt,wt]=st.useState(""),[Ut,It]=st.useState([]);st.useRef(!1),st.useEffect(()=>{rt.current=Z},[Z]);const ne=(ht,vt="info")=>{const Rt=Date.now();It(ue=>[...ue,{id:Rt,message:ht,type:vt}]),setTimeout(()=>{It(ue=>ue.filter(ce=>ce.id!==Rt))},4e3)};st.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(T))},[T]),st.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",z.toString())},[z]),st.useEffect(()=>((async()=>{try{const vt=new dv.Realtime({authUrl:"/api/token",authParams:{clientId:_}});vt.connection.on("connected",()=>{console.log("✅ Test Teacher connected to Ably"),m(!0)}),vt.connection.on("disconnected",()=>{console.log("❌ Test Teacher disconnected"),m(!1)});const Rt=vt.channels.get(`room-${i}`);await new Promise((Zt,he)=>{Rt.once("attached",Zt),Rt.once("failed",he),Rt.attach()}),console.log("✅ Channel attached"),Rt.presence.subscribe("enter",Zt=>{var he,fe;console.log("👤 Member entered:",Zt.clientId,"Role:",(he=Zt.data)==null?void 0:he.role,"Data:",Zt.data),((fe=Zt.data)==null?void 0:fe.role)==="student"&&(console.log("✅ Adding student to dashboard:",Zt.data.name||Zt.clientId),E(Be=>({...Be,[Zt.clientId]:{clientId:Zt.clientId,name:Zt.data.name||Zt.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,testMode:Zt.data.testMode||!1,meta:{base:{width:800,height:600}}}})))}),Rt.presence.subscribe("leave",Zt=>{console.log("👋 Student left:",Zt.clientId),E(he=>{const fe={...he};return fe[Zt.clientId]&&(fe[Zt.clientId].isActive=!1),fe})}),Rt.presence.subscribe("update",Zt=>{var he;((he=Zt.data)==null?void 0:he.isVisible)!==void 0&&E(fe=>{const Be={...fe};return Be[Zt.clientId]&&(Be[Zt.clientId].isVisible=Zt.data.isVisible),Be})});const ue=await Rt.presence.get();console.log(`📋 Found ${ue.length} members in presence`);const ce={};ue.forEach(Zt=>{var he,fe,Be,$e,Fn;console.log("  - Member:",Zt.clientId,"Role:",(he=Zt.data)==null?void 0:he.role,"Name:",(fe=Zt.data)==null?void 0:fe.name),((Be=Zt.data)==null?void 0:Be.role)==="student"&&(console.log("    ✅ Adding existing student:",Zt.data.name||Zt.clientId),ce[Zt.clientId]={clientId:Zt.clientId,name:Zt.data.name||Zt.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:(($e=Zt.data)==null?void 0:$e.isVisible)!==!1,testMode:((Fn=Zt.data)==null?void 0:Fn.testMode)||!1,meta:{base:{width:800,height:600}}})}),console.log(`✅ Initialized with ${Object.keys(ce).length} students`),E(ce),Rt.subscribe("student-layer",Zt=>{const{clientId:he}=Zt,fe=Zt.data;E(Be=>{const $e={...Be};return $e[he]||($e[he]={clientId:he,name:he,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,meta:{base:{width:800,height:600}}}),fe.action==="clear"?$e[he].lines=[]:fe.lines&&($e[he].lines=[...$e[he].lines,...fe.lines]),$e[he].lastUpdate=Date.now(),$e})}),await Rt.presence.enter({role:"teacher",name:"Test Teacher",testMode:!0}),o(vt),h(Rt)}catch(vt){console.error("Failed to connect to Ably:",vt)}})(),()=>{f&&f.presence.leave(),r&&r.close()}),[i,_]),st.useEffect(()=>{if($){const ht=`${window.location.origin}/test/student?room=${i}`;_b.toDataURL(ht,{width:300,margin:2}).then(vt=>wt(vt)).catch(vt=>console.error("Failed to generate QR code:",vt))}},[$,i]);const ae=()=>{t("/")},Lt=()=>{nt(!0)},_e=()=>{f&&(f.publish("session-ended",{timestamp:Date.now(),reason:"teacher_ended"}),ne("Session ended","success"))},we=ht=>{v(C[ht.clientId]||ht)},Ze=()=>{v(null)},He=ht=>{if(!R||!f)return;const vt=R.clientId;B(Rt=>({...Rt,[vt]:ht})),f.publish("teacher-annotation",{targetStudentId:vt,annotations:ht,teacherId:_,timestamp:Date.now()}),console.log("📤 Published annotations for",vt)},gn=ht=>{E(vt=>{const Rt=vt[ht];return Rt?{...vt,[ht]:{...Rt,isFlagged:!Rt.isFlagged}}:vt}),v(vt=>vt&&vt.clientId===ht?{...vt,isFlagged:!vt.isFlagged}:vt)},Pn=ht=>{const vt=document.createElement("canvas");vt.width=800,vt.height=600;const Rt=vt.getContext("2d");if(Rt.fillStyle="white",Rt.fillRect(0,0,800,600),Rt.strokeStyle="#ddd",Rt.lineWidth=1,ht==="hanzi")Rt.strokeRect(250,150,300,300),Rt.beginPath(),Rt.moveTo(400,150),Rt.lineTo(400,450),Rt.moveTo(250,300),Rt.lineTo(550,300),Rt.stroke();else if(ht==="graph-corner"){Rt.beginPath(),Rt.moveTo(100,500),Rt.lineTo(100,100),Rt.lineTo(700,100),Rt.stroke();for(let ce=1;ce<10;ce++){const Zt=100+ce*60;Rt.beginPath(),Rt.moveTo(Zt,100),Rt.lineTo(Zt,500),Rt.stroke()}for(let ce=1;ce<8;ce++){const Zt=100+ce*50;Rt.beginPath(),Rt.moveTo(100,Zt),Rt.lineTo(700,Zt),Rt.stroke()}}else if(ht==="graph-cross"){Rt.beginPath(),Rt.moveTo(50,300),Rt.lineTo(750,300),Rt.moveTo(400,50),Rt.lineTo(400,550),Rt.stroke();for(let ce=-6;ce<=6;ce++){if(ce===0)continue;const Zt=400+ce*50;Rt.beginPath(),Rt.moveTo(Zt,50),Rt.lineTo(Zt,550),Rt.stroke()}for(let ce=-5;ce<=5;ce++){if(ce===0)continue;const Zt=300+ce*50;Rt.beginPath(),Rt.moveTo(50,Zt),Rt.lineTo(750,Zt),Rt.stroke()}}const ue=vt.toDataURL("image/png");X({type:ht,dataUrl:ue,width:800,height:600})},Ot=()=>{V.current&&(V.current.value="",V.current.click())},Kt=async ht=>{var Rt;const vt=(Rt=ht.target.files)==null?void 0:Rt[0];if(!vt){F("No file selected.");return}it(!0),F("");try{const{dataUrl:ue,width:ce,height:Zt}=await Ab(vt),he={dataUrl:ue,width:ce,height:Zt,filename:vt.name,timestamp:Date.now()};D(he),F("Image ready to send.")}catch(ue){console.error("Failed to upload image:",ue),F("Upload failed. Please try again.")}finally{it(!1)}},je=()=>{D(null),F("")},ye=()=>{if(!f)return;let ht=null;P==="templates"&&Q?ht=Q:P==="image"&&Y&&(ht=Y),f.publish("teacher-action",{action:"send-blank-canvas",questionNumber:1,sharedImage:ht,timestamp:Date.now()}),at(ht||null),ne("Sent to all students","success"),console.log("📄 Sent to class:",P)},We=async()=>{const ht=`${window.location.origin}/test/student?room=${i}`;try{await navigator.clipboard.writeText(ht),ne("Link copied to clipboard","success")}catch(vt){console.error("Clipboard API failed:",vt);try{J.current&&(J.current.select(),document.execCommand("copy"),ne("Link copied to clipboard","success"))}catch(Rt){console.error("Fallback copy failed:",Rt),J.current&&J.current.select(),alert("Please copy the selected link manually")}}},an=()=>Object.values(C).sort((ht,vt)=>ht.isActive&&!vt.isActive?-1:!ht.isActive&&vt.isActive?1:(vt.lastUpdate||0)-(ht.lastUpdate||0)),ge=()=>{const ht=an(),vt=L.trim().toLowerCase();return ht.filter(Rt=>{const ue=vt?(Rt.name||Rt.clientId).toLowerCase().includes(vt):!0,ce=M==="all"||M==="flagged"&&Rt.isFlagged,Zt=O==="all"||O==="distracted"&&Rt.isVisible===!1&&Rt.isActive;return ue&&ce&&Zt})},ct=an(),At=ge(),Mt=ct.filter(ht=>ht.isActive).length,qt=R?C[R.clientId]||R:null,pe=I?!/fail|no file/i.test(I):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:Ut.map(ht=>k.jsxs("div",{className:`toast toast-${ht.type}`,children:[ht.type==="success"&&k.jsx("span",{className:"toast-icon",children:"✓"}),ht.type==="info"&&k.jsx("span",{className:"toast-icon",children:"ℹ"}),ht.type==="error"&&k.jsx("span",{className:"toast-icon",children:"✕"}),k.jsx("span",{className:"toast-message",children:ht.message})]},ht.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsx("button",{className:"back-link",onClick:ae,children:"← Exit class"}),k.jsxs("section",{className:"hero-card glass-panel",children:[k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"🧪 Test Teacher dashboard"}),k.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:Lt,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:i})]}),k.jsx("button",{className:"end-session-btn",onClick:_e,title:"End session and logout all students",children:"End Session"}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Test mode"}),k.jsx("span",{className:`status-pill connection-pill ${g?"online":"offline"}`,children:g?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:Mt}),k.jsx("span",{children:"online"})]})]})]})]}),k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:"🔍"}),k.jsx("input",{type:"text",placeholder:"Filter students",value:L,onChange:ht=>j(ht.target.value),className:"search-input"}),L&&k.jsx("button",{className:"clear-search-btn",onClick:()=>j(""),title:"Clear search",children:"✕"})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:T,onChange:ht=>y(ht.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${M==="flagged"?"active":""}`,onClick:()=>G(ht=>ht==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${O==="distracted"?"active":""}`,onClick:()=>A(ht=>ht==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:"⚠️ Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:z,onChange:ht=>U(Number(ht.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})]}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),Q&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",Q.type==="hanzi"?"Hanzi":Q.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:ye,disabled:P==="image"&&!Y,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${P==="blank"?"active":""}`,onClick:()=>{K("blank"),X(null),D(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${P==="templates"?"active":""}`,onClick:()=>{K("templates"),D(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${P==="image"?"active":""} ${Y?"ready":""}`,onClick:()=>{K("image"),X(null)},disabled:W,children:W?"Uploading…":"Send image"})]}),k.jsx("input",{ref:V,type:"file",accept:"image/*",onChange:Kt,style:{display:"none"}}),P==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="hanzi"?"active":""}`,onClick:()=>Pn("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="graph-corner"?"active":""}`,onClick:()=>Pn("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="graph-cross"?"active":""}`,onClick:()=>Pn("graph-cross"),children:"Graph (cross)"})]}),Q&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:Q.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),P==="image"&&k.jsx(k.Fragment,{children:Y?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:Y.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:Y.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:Y.width&&Y.height?`${Math.round(Y.width)} × ${Math.round(Y.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:Ot,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:je,children:"Clear"})]}),I&&k.jsx("span",{className:`image-message ${pe?"success":"error"}`,children:I})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:Ot,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),I&&k.jsx("span",{className:`image-message ${pe?"success":"error"}`,children:I})]})}),P==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:ct.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),k.jsx("h2",{children:"Waiting for students to join…"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):At.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:"🔍"}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',L,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>j(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${z}, 1fr)`},children:At.filter(ht=>ht&&ht.clientId).map(ht=>k.jsx(Cb,{student:ht,onClick:we,onToggleFlag:gn,teacherAnnotations:N[ht.clientId]||[],sharedImage:Z,hideNames:T},ht.clientId))})})})]}),k.jsx(Tb,{student:qt,isOpen:!!qt,isFlagged:qt==null?void 0:qt.isFlagged,onToggleFlag:gn,onClose:Ze,onAnnotate:He,existingAnnotations:qt?N[qt.clientId]||[]:[],sharedImage:Z}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:["💡 ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),$&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>nt(!1),children:k.jsxs("div",{className:"qr-modal",onClick:ht=>ht.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",i]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>nt(!1),children:"✕"})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:dt&&k.jsx("img",{src:dt,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:J,type:"text",value:`${window.location.origin}/test/student?room=${i}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:We,children:"Copy Link"})]})]})]})]})})]})};function DT(){return k.jsx(S3,{children:k.jsxs(p3,{children:[k.jsx(hu,{path:"/",element:k.jsx(b3,{})}),k.jsx(hu,{path:"/student-login",element:k.jsx(aT,{})}),k.jsx(hu,{path:"/student",element:k.jsx(iT,{})}),k.jsx(hu,{path:"/teacher",element:k.jsx(MT,{})}),k.jsx(hu,{path:"/test/student",element:k.jsx(NT,{})}),k.jsx(hu,{path:"/test/teacher",element:k.jsx(jT,{})})]})})}C4.createRoot(document.getElementById("root")).render(k.jsx(ei.StrictMode,{children:k.jsx(DT,{})}));
