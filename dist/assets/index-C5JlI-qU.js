function S4(o,t){for(var n=0;n<t.length;n++){const a=t[n];if(typeof a!="string"&&!Array.isArray(a)){for(const r in a)if(r!=="default"&&!(r in o)){const l=Object.getOwnPropertyDescriptor(a,r);l&&Object.defineProperty(o,r,l.get?l:{enumerable:!0,get:()=>a[r]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function pf(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function T2(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var t=o.default;if(typeof t=="function"){var n=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(a){var r=Object.getOwnPropertyDescriptor(o,a);Object.defineProperty(n,a,r.get?r:{enumerable:!0,get:function(){return o[a]}})}),n}var Sp={exports:{}},Kd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ly;function b4(){if(ly)return Kd;ly=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(a,r,l){var f=null;if(l!==void 0&&(f=""+l),r.key!==void 0&&(f=""+r.key),"key"in r){l={};for(var d in r)d!=="key"&&(l[d]=r[d])}else l=r;return r=l.ref,{$$typeof:o,type:a,key:f,ref:r!==void 0?r:null,props:l}}return Kd.Fragment=t,Kd.jsx=n,Kd.jsxs=n,Kd}var uy;function _4(){return uy||(uy=1,Sp.exports=b4()),Sp.exports}var k=_4(),bp={exports:{}},Ne={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy;function E4(){if(cy)return Ne;cy=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),f=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),E=Symbol.iterator;function R(Z){return Z===null||typeof Z!="object"?null:(Z=E&&Z[E]||Z["@@iterator"],typeof Z=="function"?Z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,L={};function B(Z,at,rt){this.props=Z,this.context=at,this.refs=L,this.updater=rt||v}B.prototype.isReactComponent={},B.prototype.setState=function(Z,at){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,at,"setState")},B.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function N(){}N.prototype=B.prototype;function M(Z,at,rt){this.props=Z,this.context=at,this.refs=L,this.updater=rt||v}var P=M.prototype=new N;P.constructor=M,D(P,B.prototype),P.isPureReactComponent=!0;var O=Array.isArray;function A(){}var T={H:null,A:null,T:null,S:null},y=Object.prototype.hasOwnProperty;function z(Z,at,rt){var V=rt.ref;return{$$typeof:o,type:Z,key:at,ref:V!==void 0?V:null,props:rt}}function U(Z,at){return z(Z.type,at,Z.props)}function G(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===o}function K(Z){var at={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(rt){return at[rt]})}var Q=/\/+/g;function X(Z,at){return typeof Z=="object"&&Z!==null&&Z.key!=null?K(""+Z.key):at.toString(36)}function Y(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(A,A):(Z.status="pending",Z.then(function(at){Z.status==="pending"&&(Z.status="fulfilled",Z.value=at)},function(at){Z.status==="pending"&&(Z.status="rejected",Z.reason=at)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function j(Z,at,rt,V,J){var tt=typeof Z;(tt==="undefined"||tt==="boolean")&&(Z=null);var nt=!1;if(Z===null)nt=!0;else switch(tt){case"bigint":case"string":case"number":nt=!0;break;case"object":switch(Z.$$typeof){case o:case t:nt=!0;break;case _:return nt=Z._init,j(nt(Z._payload),at,rt,V,J)}}if(nt)return J=J(Z),nt=V===""?"."+X(Z,0):V,O(J)?(rt="",nt!=null&&(rt=nt.replace(Q,"$&/")+"/"),j(J,at,rt,"",function(jt){return jt})):J!=null&&(G(J)&&(J=U(J,rt+(J.key==null||Z&&Z.key===J.key?"":(""+J.key).replace(Q,"$&/")+"/")+nt)),at.push(J)),1;nt=0;var ht=V===""?".":V+":";if(O(Z))for(var wt=0;wt<Z.length;wt++)V=Z[wt],tt=ht+X(V,wt),nt+=j(V,at,rt,tt,J);else if(wt=R(Z),typeof wt=="function")for(Z=wt.call(Z),wt=0;!(V=Z.next()).done;)V=V.value,tt=ht+X(V,wt++),nt+=j(V,at,rt,tt,J);else if(tt==="object"){if(typeof Z.then=="function")return j(Y(Z),at,rt,V,J);throw at=String(Z),Error("Objects are not valid as a React child (found: "+(at==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":at)+"). If you meant to render a collection of children, use an array instead.")}return nt}function I(Z,at,rt){if(Z==null)return Z;var V=[],J=0;return j(Z,V,"","",function(tt){return at.call(rt,tt,J++)}),V}function F(Z){if(Z._status===-1){var at=Z._result;at=at(),at.then(function(rt){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=rt)},function(rt){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=rt)}),Z._status===-1&&(Z._status=0,Z._result=at)}if(Z._status===1)return Z._result.default;throw Z._result}var W=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var at=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(at))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},it={map:I,forEach:function(Z,at,rt){I(Z,function(){at.apply(this,arguments)},rt)},count:function(Z){var at=0;return I(Z,function(){at++}),at},toArray:function(Z){return I(Z,function(at){return at})||[]},only:function(Z){if(!G(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return Ne.Activity=C,Ne.Children=it,Ne.Component=B,Ne.Fragment=n,Ne.Profiler=r,Ne.PureComponent=M,Ne.StrictMode=a,Ne.Suspense=g,Ne.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,Ne.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return T.H.useMemoCache(Z)}},Ne.cache=function(Z){return function(){return Z.apply(null,arguments)}},Ne.cacheSignal=function(){return null},Ne.cloneElement=function(Z,at,rt){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var V=D({},Z.props),J=Z.key;if(at!=null)for(tt in at.key!==void 0&&(J=""+at.key),at)!y.call(at,tt)||tt==="key"||tt==="__self"||tt==="__source"||tt==="ref"&&at.ref===void 0||(V[tt]=at[tt]);var tt=arguments.length-2;if(tt===1)V.children=rt;else if(1<tt){for(var nt=Array(tt),ht=0;ht<tt;ht++)nt[ht]=arguments[ht+2];V.children=nt}return z(Z.type,J,V)},Ne.createContext=function(Z){return Z={$$typeof:f,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:l,_context:Z},Z},Ne.createElement=function(Z,at,rt){var V,J={},tt=null;if(at!=null)for(V in at.key!==void 0&&(tt=""+at.key),at)y.call(at,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(J[V]=at[V]);var nt=arguments.length-2;if(nt===1)J.children=rt;else if(1<nt){for(var ht=Array(nt),wt=0;wt<nt;wt++)ht[wt]=arguments[wt+2];J.children=ht}if(Z&&Z.defaultProps)for(V in nt=Z.defaultProps,nt)J[V]===void 0&&(J[V]=nt[V]);return z(Z,tt,J)},Ne.createRef=function(){return{current:null}},Ne.forwardRef=function(Z){return{$$typeof:d,render:Z}},Ne.isValidElement=G,Ne.lazy=function(Z){return{$$typeof:_,_payload:{_status:-1,_result:Z},_init:F}},Ne.memo=function(Z,at){return{$$typeof:m,type:Z,compare:at===void 0?null:at}},Ne.startTransition=function(Z){var at=T.T,rt={};T.T=rt;try{var V=Z(),J=T.S;J!==null&&J(rt,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(A,W)}catch(tt){W(tt)}finally{at!==null&&rt.types!==null&&(at.types=rt.types),T.T=at}},Ne.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},Ne.use=function(Z){return T.H.use(Z)},Ne.useActionState=function(Z,at,rt){return T.H.useActionState(Z,at,rt)},Ne.useCallback=function(Z,at){return T.H.useCallback(Z,at)},Ne.useContext=function(Z){return T.H.useContext(Z)},Ne.useDebugValue=function(){},Ne.useDeferredValue=function(Z,at){return T.H.useDeferredValue(Z,at)},Ne.useEffect=function(Z,at){return T.H.useEffect(Z,at)},Ne.useEffectEvent=function(Z){return T.H.useEffectEvent(Z)},Ne.useId=function(){return T.H.useId()},Ne.useImperativeHandle=function(Z,at,rt){return T.H.useImperativeHandle(Z,at,rt)},Ne.useInsertionEffect=function(Z,at){return T.H.useInsertionEffect(Z,at)},Ne.useLayoutEffect=function(Z,at){return T.H.useLayoutEffect(Z,at)},Ne.useMemo=function(Z,at){return T.H.useMemo(Z,at)},Ne.useOptimistic=function(Z,at){return T.H.useOptimistic(Z,at)},Ne.useReducer=function(Z,at,rt){return T.H.useReducer(Z,at,rt)},Ne.useRef=function(Z){return T.H.useRef(Z)},Ne.useState=function(Z){return T.H.useState(Z)},Ne.useSyncExternalStore=function(Z,at,rt){return T.H.useSyncExternalStore(Z,at,rt)},Ne.useTransition=function(){return T.H.useTransition()},Ne.version="19.2.0",Ne}var fy;function Ag(){return fy||(fy=1,bp.exports=E4()),bp.exports}var st=Ag();const ra=pf(st),C4=S4({__proto__:null,default:ra},[st]);var _p={exports:{}},Qd={},Ep={exports:{}},Cp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dy;function T4(){return dy||(dy=1,(function(o){function t(j,I){var F=j.length;j.push(I);t:for(;0<F;){var W=F-1>>>1,it=j[W];if(0<r(it,I))j[W]=I,j[F]=it,F=W;else break t}}function n(j){return j.length===0?null:j[0]}function a(j){if(j.length===0)return null;var I=j[0],F=j.pop();if(F!==I){j[0]=F;t:for(var W=0,it=j.length,Z=it>>>1;W<Z;){var at=2*(W+1)-1,rt=j[at],V=at+1,J=j[V];if(0>r(rt,F))V<it&&0>r(J,rt)?(j[W]=J,j[V]=F,W=V):(j[W]=rt,j[at]=F,W=at);else if(V<it&&0>r(J,F))j[W]=J,j[V]=F,W=V;else break t}}return I}function r(j,I){var F=j.sortIndex-I.sortIndex;return F!==0?F:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,L=!1,B=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function P(j){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=j)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(j){if(D=!1,P(j),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-j)}}var A=!1,T=-1,y=5,z=-1;function U(){return L?!0:!(o.unstable_now()-z<y)}function G(){if(L=!1,A){var j=o.unstable_now();z=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(T),T=-1),R=!0;var F=E;try{e:{for(P(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=j);if(j=o.unstable_now(),typeof it=="function"){C.callback=it,P(j),I=!0;break e}C===n(g)&&a(g),P(j)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-j),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(G)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=G,K=function(){X.postMessage(null)}}else K=function(){B(G,0)};function Y(j,I){T=B(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return j()}finally{E=F}},o.unstable_requestPaint=function(){L=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var F=E;E=j;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(j,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,j){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,j={id:_++,callback:I,priorityLevel:j,startTime:F,expirationTime:it,sortIndex:-1},F>W?(j.sortIndex=F,t(m,j),n(g)===null&&j===n(m)&&(D?(N(T),T=-1):D=!0,Y(O,F-W))):(j.sortIndex=it,t(g,j),v||R||(v=!0,A||(A=!0,K()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var F=E;E=I;try{return j.apply(this,arguments)}finally{E=F}}}})(Cp)),Cp}var hy;function A4(){return hy||(hy=1,Ep.exports=T4()),Ep.exports}var Tp={exports:{}},ei={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gy;function w4(){if(gy)return ei;gy=1;var o=Ag();function t(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var a={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(g,m,_){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:C==null?null:""+C,children:g,containerInfo:m,implementation:_}}var f=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return ei.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,ei.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(g,m,null,_)},ei.flushSync=function(g){var m=f.T,_=a.p;try{if(f.T=null,a.p=2,g)return g()}finally{f.T=m,a.p=_,a.d.f()}},ei.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(g,m))},ei.prefetchDNS=function(g){typeof g=="string"&&a.d.D(g)},ei.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,R=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?a.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:C,integrity:E,fetchPriority:R}):_==="script"&&a.d.X(g,{crossOrigin:C,integrity:E,fetchPriority:R,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},ei.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=d(m.as,m.crossOrigin);a.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(g)},ei.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin);a.d.L(g,_,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},ei.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=d(m.as,m.crossOrigin);a.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(g)},ei.requestFormReset=function(g){a.d.r(g)},ei.unstable_batchedUpdates=function(g,m){return g(m)},ei.useFormState=function(g,m,_){return f.H.useFormState(g,m,_)},ei.useFormStatus=function(){return f.H.useHostTransitionStatus()},ei.version="19.2.0",ei}var py;function A2(){if(py)return Tp.exports;py=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),Tp.exports=w4(),Tp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var my;function R4(){if(my)return Qd;my=1;var o=A4(),t=Ag(),n=A2();function a(e){var i="https://react.dev/errors/"+e;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var i=e,c=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,(i.flags&4098)!==0&&(c=i.return),e=i.return;while(e)}return i.tag===3?c:null}function f(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function d(e){if(e.tag===31){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function g(e){if(l(e)!==e)throw Error(a(188))}function m(e){var i=e.alternate;if(!i){if(i=l(e),i===null)throw Error(a(188));return i!==e?null:e}for(var c=e,h=i;;){var b=c.return;if(b===null)break;var w=b.alternate;if(w===null){if(h=b.return,h!==null){c=h;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===c)return g(b),e;if(w===h)return g(b),i;w=w.sibling}throw Error(a(188))}if(c.return!==h.return)c=b,h=w;else{for(var q=!1,$=b.child;$;){if($===c){q=!0,c=b,h=w;break}if($===h){q=!0,h=b,c=w;break}$=$.sibling}if(!q){for($=w.child;$;){if($===c){q=!0,c=w,h=b;break}if($===h){q=!0,h=w,c=b;break}$=$.sibling}if(!q)throw Error(a(189))}}if(c.alternate!==h)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?e:i}function _(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e;for(e=e.child;e!==null;){if(i=_(e),i!==null)return i;e=e.sibling}return null}var C=Object.assign,E=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),M=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function K(e){return e===null||typeof e!="object"?null:(e=G&&e[G]||e["@@iterator"],typeof e=="function"?e:null)}var Q=Symbol.for("react.client.reference");function X(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case D:return"Fragment";case B:return"Profiler";case L:return"StrictMode";case O:return"Suspense";case A:return"SuspenseList";case z:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case M:return e.displayName||"Context";case N:return(e._context.displayName||"Context")+".Consumer";case P:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case T:return i=e.displayName||null,i!==null?i:X(e.type)||"Memo";case y:i=e._payload,e=e._init;try{return X(e(i))}catch{}}return null}var Y=Array.isArray,j=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},W=[],it=-1;function Z(e){return{current:e}}function at(e){0>it||(e.current=W[it],W[it]=null,it--)}function rt(e,i){it++,W[it]=e.current,e.current=i}var V=Z(null),J=Z(null),tt=Z(null),nt=Z(null);function ht(e,i){switch(rt(tt,i),rt(J,e),rt(V,null),i.nodeType){case 9:case 11:e=(e=i.documentElement)&&(e=e.namespaceURI)?Nv(e):0;break;default:if(e=i.tagName,i=i.namespaceURI)i=Nv(i),e=Dv(i,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}at(V),rt(V,e)}function wt(){at(V),at(J),at(tt)}function jt(e){e.memoizedState!==null&&rt(nt,e);var i=V.current,c=Dv(i,e.type);i!==c&&(rt(J,e),rt(V,c))}function kt(e){J.current===e&&(at(V),at(J)),nt.current===e&&(at(nt),kd._currentValue=F)}var ee,re;function Lt(e){if(ee===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);ee=i&&i[1]||"",re=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ee+e+re}var ge=!1;function pe(e,i){if(!e||ge)return"";ge=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(i){var Dt=function(){throw Error()};if(Object.defineProperty(Dt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Dt,[])}catch(At){var Et=At}Reflect.construct(e,[],Dt)}else{try{Dt.call()}catch(At){Et=At}e.call(Dt.prototype)}}else{try{throw Error()}catch(At){Et=At}(Dt=e())&&typeof Dt.catch=="function"&&Dt.catch(function(){})}}catch(At){if(At&&Et&&typeof At.stack=="string")return[At.stack,Et.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),q=w[0],$=w[1];if(q&&$){var ut=q.split(`
`),St=$.split(`
`);for(b=h=0;h<ut.length&&!ut[h].includes("DetermineComponentFrameRoot");)h++;for(;b<St.length&&!St[b].includes("DetermineComponentFrameRoot");)b++;if(h===ut.length||b===St.length)for(h=ut.length-1,b=St.length-1;1<=h&&0<=b&&ut[h]!==St[b];)b--;for(;1<=h&&0<=b;h--,b--)if(ut[h]!==St[b]){if(h!==1||b!==1)do if(h--,b--,0>b||ut[h]!==St[b]){var xt=`
`+ut[h].replace(" at new "," at ");return e.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",e.displayName)),xt}while(1<=h&&0<=b);break}}}finally{ge=!1,Error.prepareStackTrace=c}return(c=e?e.displayName||e.name:"")?Lt(c):""}function rn(e,i){switch(e.tag){case 26:case 27:case 5:return Lt(e.type);case 16:return Lt("Lazy");case 13:return e.child!==i&&i!==null?Lt("Suspense Fallback"):Lt("Suspense");case 19:return Lt("SuspenseList");case 0:case 15:return pe(e.type,!1);case 11:return pe(e.type.render,!1);case 1:return pe(e.type,!0);case 31:return Lt("Activity");default:return""}}function Ye(e){try{var i="",c=null;do i+=rn(e,c),c=e,e=e.return;while(e);return i}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var mn=Object.prototype.hasOwnProperty,Yn=o.unstable_scheduleCallback,sn=o.unstable_cancelCallback,Ot=o.unstable_shouldYield,Zt=o.unstable_requestPaint,Ce=o.unstable_now,Ke=o.unstable_getCurrentPriorityLevel,Je=o.unstable_ImmediatePriority,Te=o.unstable_UserBlockingPriority,lt=o.unstable_NormalPriority,Tt=o.unstable_LowPriority,Rt=o.unstable_IdlePriority,qt=o.log,le=o.unstable_setDisableYieldValue,Bt=null,vt=null;function dt(e){if(typeof qt=="function"&&le(e),vt&&typeof vt.setStrictMode=="function")try{vt.setStrictMode(Bt,e)}catch{}}var Yt=Math.clz32?Math.clz32:Ae,ae=Math.log,Qt=Math.LN2;function Ae(e){return e>>>=0,e===0?32:31-(ae(e)/Qt|0)|0}var be=256,Ie=262144,Cn=4194304;function Re(e){var i=e&42;if(i!==0)return i;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function dn(e,i,c){var h=e.pendingLanes;if(h===0)return 0;var b=0,w=e.suspendedLanes,q=e.pingedLanes;e=e.warmLanes;var $=h&134217727;return $!==0?(h=$&~w,h!==0?b=Re(h):(q&=$,q!==0?b=Re(q):c||(c=$&~e,c!==0&&(b=Re(c))))):($=h&~w,$!==0?b=Re($):q!==0?b=Re(q):c||(c=h&~e,c!==0&&(b=Re(c)))),b===0?0:i!==0&&i!==b&&(i&w)===0&&(w=b&-b,c=i&-i,w>=c||w===32&&(c&4194048)!==0)?i:b}function Mn(e,i){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&i)===0}function Sr(e,i){switch(e){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ts(){var e=Cn;return Cn<<=1,(Cn&62914560)===0&&(Cn=4194304),e}function br(e){for(var i=[],c=0;31>c;c++)i.push(e);return i}function Yi(e,i){e.pendingLanes|=i,i!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Oi(e,i,c,h,b,w){var q=e.pendingLanes;e.pendingLanes=c,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=c,e.entangledLanes&=c,e.errorRecoveryDisabledLanes&=c,e.shellSuspendCounter=0;var $=e.entanglements,ut=e.expirationTimes,St=e.hiddenUpdates;for(c=q&~c;0<c;){var xt=31-Yt(c),Dt=1<<xt;$[xt]=0,ut[xt]=-1;var Et=St[xt];if(Et!==null)for(St[xt]=null,xt=0;xt<Et.length;xt++){var At=Et[xt];At!==null&&(At.lane&=-536870913)}c&=~Dt}h!==0&&Ki(e,h,0),w!==0&&b===0&&e.tag!==0&&(e.suspendedLanes|=w&~(q&~i))}function Ki(e,i,c){e.pendingLanes|=i,e.suspendedLanes&=~i;var h=31-Yt(i);e.entangledLanes|=i,e.entanglements[h]=e.entanglements[h]|1073741824|c&261930}function Nt(e,i){var c=e.entangledLanes|=i;for(e=e.entanglements;c;){var h=31-Yt(c),b=1<<h;b&i|e[h]&i&&(e[h]|=i),c&=~b}}function Ut(e,i){var c=i&-i;return c=(c&42)!==0?1:$t(c),(c&(e.suspendedLanes|i))!==0?0:c}function $t(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ft(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function It(){var e=I.p;return e!==0?e:(e=window.event,e===void 0?32:ey(e.type))}function Qe(e,i){var c=I.p;try{return I.p=e,i()}finally{I.p=c}}var en=Math.random().toString(36).slice(2),Oe="__reactFiber$"+en,ie="__reactProps$"+en,on="__reactContainer$"+en,_e="__reactEvents$"+en,je="__reactListeners$"+en,Pe="__reactHandles$"+en,we="__reactResources$"+en,Ue="__reactMarker$"+en;function ye(e){delete e[Oe],delete e[ie],delete e[_e],delete e[je],delete e[Pe]}function ln(e){var i=e[Oe];if(i)return i;for(var c=e.parentNode;c;){if(i=c[on]||c[Oe]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(e=Gv(e);e!==null;){if(c=e[Oe])return c;e=Gv(e)}return i}e=c,c=e.parentNode}return null}function un(e){if(e=e[Oe]||e[on]){var i=e.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return e}return null}function ai(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e.stateNode;throw Error(a(33))}function ii(e){var i=e[we];return i||(i=e[we]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Kn(e){e[Ue]=!0}var As=new Set,ws={};function yi(e,i){sa(e,i),sa(e+"Capture",i)}function sa(e,i){for(ws[e]=i,e=0;e<i.length;e++)As.add(i[e])}var ta=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nu={},Co={};function Du(e){return mn.call(Co,e)?!0:mn.call(Nu,e)?!1:ta.test(e)?Co[e]=!0:(Nu[e]=!0,!1)}function To(e,i,c){if(Du(i))if(c===null)e.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":e.removeAttribute(i);return;case"boolean":var h=i.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){e.removeAttribute(i);return}}e.setAttribute(i,""+c)}}function Si(e,i,c){if(c===null)e.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttribute(i,""+c)}}function bi(e,i,c,h){if(h===null)e.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(c);return}e.setAttributeNS(i,c,""+h)}}function Va(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ju(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Eh(e,i,c){var h=Object.getOwnPropertyDescriptor(e.constructor.prototype,i);if(!e.hasOwnProperty(i)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var b=h.get,w=h.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return b.call(this)},set:function(q){c=""+q,w.call(this,q)}}),Object.defineProperty(e,i,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(q){c=""+q},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Uu(e){if(!e._valueTracker){var i=ju(e)?"checked":"value";e._valueTracker=Eh(e,i,""+e[i])}}function Cf(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var c=i.getValue(),h="";return e&&(h=ju(e)?e.checked?"true":"false":e.value),e=h,e!==c?(i.setValue(e),!0):!1}function El(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Ch=/[\n"\\]/g;function ri(e){return e.replace(Ch,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Cl(e,i,c,h,b,w,q,$){e.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?e.type=q:e.removeAttribute("type"),i!=null?q==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+Va(i)):e.value!==""+Va(i)&&(e.value=""+Va(i)):q!=="submit"&&q!=="reset"||e.removeAttribute("value"),i!=null?Af(e,q,Va(i)):c!=null?Af(e,q,Va(c)):h!=null&&e.removeAttribute("value"),b==null&&w!=null&&(e.defaultChecked=!!w),b!=null&&(e.checked=b&&typeof b!="function"&&typeof b!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?e.name=""+Va($):e.removeAttribute("name")}function Tf(e,i,c,h,b,w,q,$){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.type=w),i!=null||c!=null){if(!(w!=="submit"&&w!=="reset"||i!=null)){Uu(e);return}c=c!=null?""+Va(c):"",i=i!=null?""+Va(i):c,$||i===e.value||(e.value=i),e.defaultValue=i}h=h??b,h=typeof h!="function"&&typeof h!="symbol"&&!!h,e.checked=$?e.checked:!!h,e.defaultChecked=!!h,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(e.name=q),Uu(e)}function Af(e,i,c){i==="number"&&El(e.ownerDocument)===e||e.defaultValue===""+c||(e.defaultValue=""+c)}function Rs(e,i,c,h){if(e=e.options,i){i={};for(var b=0;b<c.length;b++)i["$"+c[b]]=!0;for(c=0;c<e.length;c++)b=i.hasOwnProperty("$"+e[c].value),e[c].selected!==b&&(e[c].selected=b),b&&h&&(e[c].defaultSelected=!0)}else{for(c=""+Va(c),i=null,b=0;b<e.length;b++){if(e[b].value===c){e[b].selected=!0,h&&(e[b].defaultSelected=!0);return}i!==null||e[b].disabled||(i=e[b])}i!==null&&(i.selected=!0)}}function wf(e,i,c){if(i!=null&&(i=""+Va(i),i!==e.value&&(e.value=i),c==null)){e.defaultValue!==i&&(e.defaultValue=i);return}e.defaultValue=c!=null?""+Va(c):""}function Rf(e,i,c,h){if(i==null){if(h!=null){if(c!=null)throw Error(a(92));if(Y(h)){if(1<h.length)throw Error(a(93));h=h[0]}c=h}c==null&&(c=""),i=c}c=Va(i),e.defaultValue=c,h=e.textContent,h===c&&h!==""&&h!==null&&(e.value=h),Uu(e)}function Fr(e,i){if(i){var c=e.firstChild;if(c&&c===e.lastChild&&c.nodeType===3){c.nodeValue=i;return}}e.textContent=i}var Th=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Of(e,i,c){var h=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="":h?e.setProperty(i,c):typeof c!="number"||c===0||Th.has(i)?i==="float"?e.cssFloat=c:e[i]=(""+c).trim():e[i]=c+"px"}function xf(e,i,c){if(i!=null&&typeof i!="object")throw Error(a(62));if(e=e.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||i!=null&&i.hasOwnProperty(h)||(h.indexOf("--")===0?e.setProperty(h,""):h==="float"?e.cssFloat="":e[h]="");for(var b in i)h=i[b],i.hasOwnProperty(b)&&c[b]!==h&&Of(e,b,h)}else for(var w in i)i.hasOwnProperty(w)&&Of(e,w,i[w])}function Bu(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ah=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tl(e){return Lg.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ya(){}var Ao=null;function zu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _r=null,Qi=null;function Mf(e){var i=un(e);if(i&&(e=i.stateNode)){var c=e[ie]||null;t:switch(e=i.stateNode,i.type){case"input":if(Cl(e,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=e;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ri(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var h=c[i];if(h!==e&&h.form===e.form){var b=h[ie]||null;if(!b)throw Error(a(90));Cl(h,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(i=0;i<c.length;i++)h=c[i],h.form===e.form&&Cf(h)}break t;case"textarea":wf(e,c.value,c.defaultValue);break t;case"select":i=c.value,i!=null&&Rs(e,!!c.multiple,i,!1)}}}var Lu=!1;function Nf(e,i,c){if(Lu)return e(i,c);Lu=!0;try{var h=e(i);return h}finally{if(Lu=!1,(_r!==null||Qi!==null)&&(Wo(),_r&&(i=_r,e=Qi,Qi=_r=null,Mf(i),e)))for(i=0;i<e.length;i++)Mf(e[i])}}function wo(e,i){var c=e.stateNode;if(c===null)return null;var h=c[ie]||null;if(h===null)return null;c=h[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break t;default:e=!1}if(e)return null;if(c&&typeof c!="function")throw Error(a(231,i,typeof c));return c}var Xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pu=!1;if(Xi)try{var Os={};Object.defineProperty(Os,"passive",{get:function(){Pu=!0}}),window.addEventListener("test",Os,Os),window.removeEventListener("test",Os,Os)}catch{Pu=!1}var Er=null,Gu=null,Ro=null;function Df(){if(Ro)return Ro;var e,i=Gu,c=i.length,h,b="value"in Er?Er.value:Er.textContent,w=b.length;for(e=0;e<c&&i[e]===b[e];e++);var q=c-e;for(h=1;h<=q&&i[c-h]===b[w-h];h++);return Ro=b.slice(e,1<h?1-h:void 0)}function Al(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function wl(){return!0}function Hu(){return!1}function ja(e){function i(c,h,b,w,q){this._reactName=c,this._targetInst=b,this.type=h,this.nativeEvent=w,this.target=q,this.currentTarget=null;for(var $ in e)e.hasOwnProperty($)&&(c=e[$],this[$]=c?c(w):w[$]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?wl:Hu,this.isPropagationStopped=Hu,this}return C(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=wl)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=wl)},persist:function(){},isPersistent:wl}),i}var Jr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Iu=ja(Jr),Rl=C({},Jr,{view:0,detail:0}),wh=ja(Rl),xs,Ol,Zr,xl=C({},Rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Oo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zr&&(Zr&&e.type==="mousemove"?(xs=e.screenX-Zr.screenX,Ol=e.screenY-Zr.screenY):Ol=xs=0,Zr=e),xs)},movementY:function(e){return"movementY"in e?e.movementY:Ol}}),jf=ja(xl),ku=C({},xl,{dataTransfer:0}),Ml=ja(ku),qu=C({},Rl,{relatedTarget:0}),Vu=ja(qu),Rh=C({},Jr,{animationName:0,elapsedTime:0,pseudoElement:0}),Wr=ja(Rh),Oh=C({},Jr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),$r=ja(Oh),Cr=C({},Jr,{data:0}),Nl=ja(Cr),Uf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ms(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Mh[e])?!!i[e]:!1}function Oo(){return Ms}var Nh=C({},Rl,{key:function(e){if(e.key){var i=Uf[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=Al(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Oo,charCode:function(e){return e.type==="keypress"?Al(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Al(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Bf=ja(Nh),Dh=C({},xl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zf=ja(Dh),Pg=C({},Rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Oo}),pa=ja(Pg),jh=C({},Jr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uh=ja(jh),Bh=C({},xl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zh=ja(Bh),Lh=C({},Jr,{newState:0,oldState:0}),Yu=ja(Lh),Lf=[9,13,27,32],Ku=Xi&&"CompositionEvent"in window,xo=null;Xi&&"documentMode"in document&&(xo=document.documentMode);var Ph=Xi&&"TextEvent"in window&&!xo,Qu=Xi&&(!Ku||xo&&8<xo&&11>=xo),Xu=" ",Pf=!1;function Fu(e,i){switch(e){case"keyup":return Lf.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dl(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ts=!1;function Gh(e,i){switch(e){case"compositionend":return Dl(i);case"keypress":return i.which!==32?null:(Pf=!0,Xu);case"textInput":return e=i.data,e===Xu&&Pf?null:e;default:return null}}function Gf(e,i){if(ts)return e==="compositionend"||!Ku&&Fu(e,i)?(e=Df(),Ro=Gu=Er=null,ts=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Qu&&i.locale!=="ko"?null:i.data;default:return null}}var Hh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fi(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!Hh[e.type]:i==="textarea"}function Ju(e,i,c,h){_r?Qi?Qi.push(h):Qi=[h]:_r=h,i=N0(i,"onChange"),0<i.length&&(c=new Iu("onChange","change",null,c,h),e.push({event:c,listeners:i}))}var jl=null,Mo=null;function si(e){Av(e,0)}function Ul(e){var i=ai(e);if(Cf(i))return e}function Zu(e,i){if(e==="change")return i}var Hf=!1;if(Xi){var Wu;if(Xi){var Bl="oninput"in document;if(!Bl){var $u=document.createElement("div");$u.setAttribute("oninput","return;"),Bl=typeof $u.oninput=="function"}Wu=Bl}else Wu=!1;Hf=Wu&&(!document.documentMode||9<document.documentMode)}function If(){jl&&(jl.detachEvent("onpropertychange",zl),Mo=jl=null)}function zl(e){if(e.propertyName==="value"&&Ul(Mo)){var i=[];Ju(i,Mo,e,zu(e)),Nf(si,i)}}function Ll(e,i,c){e==="focusin"?(If(),jl=i,Mo=c,jl.attachEvent("onpropertychange",zl)):e==="focusout"&&If()}function In(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ul(Mo)}function Gg(e,i){if(e==="click")return Ul(i)}function Hg(e,i){if(e==="input"||e==="change")return Ul(i)}function Ih(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var ma=typeof Object.is=="function"?Object.is:Ih;function _i(e,i){if(ma(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var c=Object.keys(e),h=Object.keys(i);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var b=c[h];if(!mn.call(i,b)||!ma(e[b],i[b]))return!1}return!0}function kf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qf(e,i){var c=kf(e);e=0;for(var h;c;){if(c.nodeType===3){if(h=e+c.textContent.length,e<=i&&h>=i)return{node:c,offset:i-e};e=h}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=kf(c)}}function No(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?No(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function xi(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var i=El(e.document);i instanceof e.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)e=i.contentWindow;else break;i=El(e.document)}return i}function tc(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}var Vf=Xi&&"documentMode"in document&&11>=document.documentMode,Ns=null,Pl=null,Ds=null,Do=!1;function Yf(e,i,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Do||Ns==null||Ns!==El(h)||(h=Ns,"selectionStart"in h&&tc(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ds&&_i(Ds,h)||(Ds=h,h=N0(Pl,"onSelect"),0<h.length&&(i=new Iu("onSelect","select",null,i,c),e.push({event:i,listeners:h}),i.target=Ns)))}function es(e,i){var c={};return c[e.toLowerCase()]=i.toLowerCase(),c["Webkit"+e]="webkit"+i,c["Moz"+e]="moz"+i,c}var jo={animationend:es("Animation","AnimationEnd"),animationiteration:es("Animation","AnimationIteration"),animationstart:es("Animation","AnimationStart"),transitionrun:es("Transition","TransitionRun"),transitionstart:es("Transition","TransitionStart"),transitioncancel:es("Transition","TransitionCancel"),transitionend:es("Transition","TransitionEnd")},ec={},Kf={};Xi&&(Kf=document.createElement("div").style,"AnimationEvent"in window||(delete jo.animationend.animation,delete jo.animationiteration.animation,delete jo.animationstart.animation),"TransitionEvent"in window||delete jo.transitionend.transition);function va(e){if(ec[e])return ec[e];if(!jo[e])return e;var i=jo[e],c;for(c in i)if(i.hasOwnProperty(c)&&c in Kf)return ec[e]=i[c];return e}var nc=va("animationend"),Qf=va("animationiteration"),kh=va("animationstart"),Xf=va("transitionrun"),Ua=va("transitionstart"),qh=va("transitioncancel"),Ba=va("transitionend"),Ff=new Map,Ji="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ji.push("scrollEnd");function ya(e,i){Ff.set(e,i),yi(i,[e])}var Mi=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ka=[],ns=0,Ei=0;function Gl(){for(var e=ns,i=Ei=ns=0;i<e;){var c=Ka[i];Ka[i++]=null;var h=Ka[i];Ka[i++]=null;var b=Ka[i];Ka[i++]=null;var w=Ka[i];if(Ka[i++]=null,h!==null&&b!==null){var q=h.pending;q===null?b.next=b:(b.next=q.next,q.next=b),h.pending=b}w!==0&&Jf(c,b,w)}}function Tr(e,i,c,h){Ka[ns++]=e,Ka[ns++]=i,Ka[ns++]=c,Ka[ns++]=h,Ei|=h,e.lanes|=h,e=e.alternate,e!==null&&(e.lanes|=h)}function js(e,i,c,h){return Tr(e,i,c,h),Hl(e)}function oi(e,i){return Tr(e,null,null,i),Hl(e)}function Jf(e,i,c){e.lanes|=c;var h=e.alternate;h!==null&&(h.lanes|=c);for(var b=!1,w=e.return;w!==null;)w.childLanes|=c,h=w.alternate,h!==null&&(h.childLanes|=c),w.tag===22&&(e=w.stateNode,e===null||e._visibility&1||(b=!0)),e=w,w=w.return;return e.tag===3?(w=e.stateNode,b&&i!==null&&(b=31-Yt(c),e=w.hiddenUpdates,h=e[b],h===null?e[b]=[i]:h.push(i),i.lane=c|536870912),w):null}function Hl(e){if(50<ho)throw ho=0,go=null,Error(a(185));for(var i=e.return;i!==null;)e=i,i=e.return;return e.tag===3?e.stateNode:null}var Zi={};function Vh(e,i,c,h){this.tag=e,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oa(e,i,c,h){return new Vh(e,i,c,h)}function ac(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ni(e,i){var c=e.alternate;return c===null?(c=Oa(e.tag,i,e.key,e.mode),c.elementType=e.elementType,c.type=e.type,c.stateNode=e.stateNode,c.alternate=e,e.alternate=c):(c.pendingProps=i,c.type=e.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=e.flags&65011712,c.childLanes=e.childLanes,c.lanes=e.lanes,c.child=e.child,c.memoizedProps=e.memoizedProps,c.memoizedState=e.memoizedState,c.updateQueue=e.updateQueue,i=e.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=e.sibling,c.index=e.index,c.ref=e.ref,c.refCleanup=e.refCleanup,c}function ic(e,i){e.flags&=65011714;var c=e.alternate;return c===null?(e.childLanes=0,e.lanes=i,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=c.childLanes,e.lanes=c.lanes,e.child=c.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=c.memoizedProps,e.memoizedState=c.memoizedState,e.updateQueue=c.updateQueue,e.type=c.type,i=c.dependencies,e.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),e}function Uo(e,i,c,h,b,w){var q=0;if(h=e,typeof e=="function")ac(e)&&(q=1);else if(typeof e=="string")q=o4(e,c,V.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case z:return e=Oa(31,c,i,b),e.elementType=z,e.lanes=w,e;case D:return as(c.children,b,w,i);case L:q=8,b|=24;break;case B:return e=Oa(12,c,i,b|2),e.elementType=B,e.lanes=w,e;case O:return e=Oa(13,c,i,b),e.elementType=O,e.lanes=w,e;case A:return e=Oa(19,c,i,b),e.elementType=A,e.lanes=w,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:q=10;break t;case N:q=9;break t;case P:q=11;break t;case T:q=14;break t;case y:q=16,h=null;break t}q=29,c=Error(a(130,e===null?"null":typeof e,"")),h=null}return i=Oa(q,c,i,b),i.elementType=e,i.type=h,i.lanes=w,i}function as(e,i,c,h){return e=Oa(7,e,h,i),e.lanes=c,e}function Il(e,i,c){return e=Oa(6,e,null,i),e.lanes=c,e}function Qa(e){var i=Oa(18,null,null,0);return i.stateNode=e,i}function rc(e,i,c){return i=Oa(4,e.children!==null?e.children:[],e.key,i),i.lanes=c,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}var Xa=new WeakMap;function li(e,i){if(typeof e=="object"&&e!==null){var c=Xa.get(e);return c!==void 0?c:(i={value:e,source:i,stack:Ye(i)},Xa.set(e,i),i)}return{value:e,source:i,stack:Ye(i)}}var Us=[],Bo=0,Di=null,zo=0,Fa=[],Sa=0,Ar=null,ji=1,Ui="";function Wi(e,i){Us[Bo++]=zo,Us[Bo++]=Di,Di=e,zo=i}function sc(e,i,c){Fa[Sa++]=ji,Fa[Sa++]=Ui,Fa[Sa++]=Ar,Ar=e;var h=ji;e=Ui;var b=32-Yt(h)-1;h&=~(1<<b),c+=1;var w=32-Yt(i)+b;if(30<w){var q=b-b%5;w=(h&(1<<q)-1).toString(32),h>>=q,b-=q,ji=1<<32-Yt(i)+b|c<<b|h,Ui=w+e}else ji=1<<w|c<<b|h,Ui=e}function kl(e){e.return!==null&&(Wi(e,1),sc(e,1,0))}function Zf(e){for(;e===Di;)Di=Us[--Bo],Us[Bo]=null,zo=Us[--Bo],Us[Bo]=null;for(;e===Ar;)Ar=Fa[--Sa],Fa[Sa]=null,Ui=Fa[--Sa],Fa[Sa]=null,ji=Fa[--Sa],Fa[Sa]=null}function Yh(e,i){Fa[Sa++]=ji,Fa[Sa++]=Ui,Fa[Sa++]=Ar,ji=i.id,Ui=i.overflow,Ar=e}var ba=null,Tn=null,qe=!1,ui=null,za=!1,oc=Error(a(519));function wr(e){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Lo(li(i,e)),oc}function Wf(e){var i=e.stateNode,c=e.type,h=e.memoizedProps;switch(i[Oe]=e,i[ie]=h,c){case"dialog":Fe("cancel",i),Fe("close",i);break;case"iframe":case"object":case"embed":Fe("load",i);break;case"video":case"audio":for(c=0;c<Ld.length;c++)Fe(Ld[c],i);break;case"source":Fe("error",i);break;case"img":case"image":case"link":Fe("error",i),Fe("load",i);break;case"details":Fe("toggle",i);break;case"input":Fe("invalid",i),Tf(i,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Fe("invalid",i);break;case"textarea":Fe("invalid",i),Rf(i,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||h.suppressHydrationWarning===!0||xv(i.textContent,c)?(h.popover!=null&&(Fe("beforetoggle",i),Fe("toggle",i)),h.onScroll!=null&&Fe("scroll",i),h.onScrollEnd!=null&&Fe("scrollend",i),h.onClick!=null&&(i.onclick=Ya),i=!0):i=!1,i||wr(e,!0)}function $f(e){for(ba=e.return;ba;)switch(ba.tag){case 5:case 31:case 13:za=!1;return;case 27:case 3:za=!0;return;default:ba=ba.return}}function Bs(e){if(e!==ba)return!1;if(!qe)return $f(e),qe=!0,!1;var i=e.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=e.type,c=!(c!=="form"&&c!=="button")||ip(e.type,e.memoizedProps)),c=!c),c&&Tn&&wr(e),$f(e),i===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));Tn=Pv(e)}else if(i===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));Tn=Pv(e)}else i===27?(i=Tn,el(e.type)?(e=up,up=null,Tn=e):Tn=i):Tn=ba?mr(e.stateNode.nextSibling):null;return!0}function is(){Tn=ba=null,qe=!1}function zs(){var e=ui;return e!==null&&(Rn===null?Rn=e:Rn.push.apply(Rn,e),ui=null),e}function Lo(e){ui===null?ui=[e]:ui.push(e)}var lc=Z(null),Xe=null,Bi=null;function rs(e,i,c){rt(lc,i._currentValue),i._currentValue=c}function $i(e){e._currentValue=lc.current,at(lc)}function td(e,i,c){for(;e!==null;){var h=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),e===c)break;e=e.return}}function ed(e,i,c,h){var b=e.child;for(b!==null&&(b.return=e);b!==null;){var w=b.dependencies;if(w!==null){var q=b.child;w=w.firstContext;t:for(;w!==null;){var $=w;w=b;for(var ut=0;ut<i.length;ut++)if($.context===i[ut]){w.lanes|=c,$=w.alternate,$!==null&&($.lanes|=c),td(w.return,c,e),h||(q=null);break t}w=$.next}}else if(b.tag===18){if(q=b.return,q===null)throw Error(a(341));q.lanes|=c,w=q.alternate,w!==null&&(w.lanes|=c),td(q,c,e),q=null}else q=b.child;if(q!==null)q.return=b;else for(q=b;q!==null;){if(q===e){q=null;break}if(b=q.sibling,b!==null){b.return=q.return,q=b;break}q=q.return}b=q}}function Po(e,i,c,h){e=null;for(var b=i,w=!1;b!==null;){if(!w){if((b.flags&524288)!==0)w=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var q=b.alternate;if(q===null)throw Error(a(387));if(q=q.memoizedProps,q!==null){var $=b.type;ma(b.pendingProps.value,q.value)||(e!==null?e.push($):e=[$])}}else if(b===nt.current){if(q=b.alternate,q===null)throw Error(a(387));q.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(e!==null?e.push(kd):e=[kd])}b=b.return}e!==null&&ed(i,e,c,h),i.flags|=262144}function uc(e){for(e=e.firstContext;e!==null;){if(!ma(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Rr(e){Xe=e,Bi=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Nn(e){return Vl(Xe,e)}function ql(e,i){return Xe===null&&Rr(e),Vl(e,i)}function Vl(e,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},Bi===null){if(e===null)throw Error(a(308));Bi=i,e.dependencies={lanes:0,firstContext:i},e.flags|=524288}else Bi=Bi.next=i;return c}var Ls=typeof AbortController<"u"?AbortController:function(){var e=[],i=this.signal={aborted:!1,addEventListener:function(c,h){e.push(h)}};this.abort=function(){i.aborted=!0,e.forEach(function(c){return c()})}},nd=o.unstable_scheduleCallback,ad=o.unstable_NormalPriority,ea={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function cc(){return{controller:new Ls,data:new Map,refCount:0}}function Go(e){e.refCount--,e.refCount===0&&nd(ad,function(){e.controller.abort()})}var Ho=null,fc=0,Ps=0,ss=null;function ke(e,i){if(Ho===null){var c=Ho=[];fc=0,Ps=Fg(),ss={status:"pending",value:void 0,then:function(h){c.push(h)}}}return fc++,i.then(Kh,Kh),i}function Kh(){if(--fc===0&&Ho!==null){ss!==null&&(ss.status="fulfilled");var e=Ho;Ho=null,Ps=0,ss=null;for(var i=0;i<e.length;i++)(0,e[i])()}}function ci(e,i){var c=[],h={status:"pending",value:null,reason:null,then:function(b){c.push(b)}};return e.then(function(){h.status="fulfilled",h.value=i;for(var b=0;b<c.length;b++)(0,c[b])(i)},function(b){for(h.status="rejected",h.reason=b,b=0;b<c.length;b++)(0,c[b])(void 0)}),h}var dc=j.S;j.S=function(e,i){Gc=Ce(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&ke(e,i),dc!==null&&dc(e,i)};var Gs=Z(null);function Io(){var e=Gs.current;return e!==null?e:Le.pooledCache}function Or(e,i){i===null?rt(Gs,Gs.current):rt(Gs,i.pool)}function Hs(){var e=Io();return e===null?null:{parent:ea._currentValue,pool:e}}var Is=Error(a(460)),Yl=Error(a(474)),hc=Error(a(542)),Kl={then:function(){}};function xr(e){return e=e.status,e==="fulfilled"||e==="rejected"}function gc(e,i,c){switch(c=e[c],c===void 0?e.push(i):c!==i&&(i.then(Ya,Ya),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,Dr(e),e;default:if(typeof i.status=="string")i.then(Ya,Ya);else{if(e=Le,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=i,e.status="pending",e.then(function(h){if(i.status==="pending"){var b=i;b.status="fulfilled",b.value=h}},function(h){if(i.status==="pending"){var b=i;b.status="rejected",b.reason=h}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,Dr(e),e}throw Nr=i,Is}}function Mr(e){try{var i=e._init;return i(e._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Nr=c,Is):c}}var Nr=null;function pc(){if(Nr===null)throw Error(a(459));var e=Nr;return Nr=null,e}function Dr(e){if(e===Is||e===hc)throw Error(a(483))}var os=null,Ql=0;function Xl(e){var i=Ql;return Ql+=1,os===null&&(os=[]),gc(os,e,i)}function Fl(e,i){i=i.props.ref,e.ref=i!==void 0?i:null}function ks(e,i){throw i.$$typeof===E?Error(a(525)):(e=Object.prototype.toString.call(i),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)))}function ce(e){function i(pt,ft){if(e){var yt=pt.deletions;yt===null?(pt.deletions=[ft],pt.flags|=16):yt.push(ft)}}function c(pt,ft){if(!e)return null;for(;ft!==null;)i(pt,ft),ft=ft.sibling;return null}function h(pt){for(var ft=new Map;pt!==null;)pt.key!==null?ft.set(pt.key,pt):ft.set(pt.index,pt),pt=pt.sibling;return ft}function b(pt,ft){return pt=Ni(pt,ft),pt.index=0,pt.sibling=null,pt}function w(pt,ft,yt){return pt.index=yt,e?(yt=pt.alternate,yt!==null?(yt=yt.index,yt<ft?(pt.flags|=67108866,ft):yt):(pt.flags|=67108866,ft)):(pt.flags|=1048576,ft)}function q(pt){return e&&pt.alternate===null&&(pt.flags|=67108866),pt}function $(pt,ft,yt,Mt){return ft===null||ft.tag!==6?(ft=Il(yt,pt.mode,Mt),ft.return=pt,ft):(ft=b(ft,yt),ft.return=pt,ft)}function ut(pt,ft,yt,Mt){var ue=yt.type;return ue===D?xt(pt,ft,yt.props.children,Mt,yt.key):ft!==null&&(ft.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===y&&Mr(ue)===ft.type)?(ft=b(ft,yt.props),Fl(ft,yt),ft.return=pt,ft):(ft=Uo(yt.type,yt.key,yt.props,null,pt.mode,Mt),Fl(ft,yt),ft.return=pt,ft)}function St(pt,ft,yt,Mt){return ft===null||ft.tag!==4||ft.stateNode.containerInfo!==yt.containerInfo||ft.stateNode.implementation!==yt.implementation?(ft=rc(yt,pt.mode,Mt),ft.return=pt,ft):(ft=b(ft,yt.children||[]),ft.return=pt,ft)}function xt(pt,ft,yt,Mt,ue){return ft===null||ft.tag!==7?(ft=as(yt,pt.mode,Mt,ue),ft.return=pt,ft):(ft=b(ft,yt),ft.return=pt,ft)}function Dt(pt,ft,yt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return ft=Il(""+ft,pt.mode,yt),ft.return=pt,ft;if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case R:return yt=Uo(ft.type,ft.key,ft.props,null,pt.mode,yt),Fl(yt,ft),yt.return=pt,yt;case v:return ft=rc(ft,pt.mode,yt),ft.return=pt,ft;case y:return ft=Mr(ft),Dt(pt,ft,yt)}if(Y(ft)||K(ft))return ft=as(ft,pt.mode,yt,null),ft.return=pt,ft;if(typeof ft.then=="function")return Dt(pt,Xl(ft),yt);if(ft.$$typeof===M)return Dt(pt,ql(pt,ft),yt);ks(pt,ft)}return null}function Et(pt,ft,yt,Mt){var ue=ft!==null?ft.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return ue!==null?null:$(pt,ft,""+yt,Mt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case R:return yt.key===ue?ut(pt,ft,yt,Mt):null;case v:return yt.key===ue?St(pt,ft,yt,Mt):null;case y:return yt=Mr(yt),Et(pt,ft,yt,Mt)}if(Y(yt)||K(yt))return ue!==null?null:xt(pt,ft,yt,Mt,null);if(typeof yt.then=="function")return Et(pt,ft,Xl(yt),Mt);if(yt.$$typeof===M)return Et(pt,ft,ql(pt,yt),Mt);ks(pt,yt)}return null}function At(pt,ft,yt,Mt,ue){if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint")return pt=pt.get(yt)||null,$(ft,pt,""+Mt,ue);if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case R:return pt=pt.get(Mt.key===null?yt:Mt.key)||null,ut(ft,pt,Mt,ue);case v:return pt=pt.get(Mt.key===null?yt:Mt.key)||null,St(ft,pt,Mt,ue);case y:return Mt=Mr(Mt),At(pt,ft,yt,Mt,ue)}if(Y(Mt)||K(Mt))return pt=pt.get(yt)||null,xt(ft,pt,Mt,ue,null);if(typeof Mt.then=="function")return At(pt,ft,yt,Xl(Mt),ue);if(Mt.$$typeof===M)return At(pt,ft,yt,ql(ft,Mt),ue);ks(ft,Mt)}return null}function ne(pt,ft,yt,Mt){for(var ue=null,gn=null,se=ft,He=ft=0,Ze=null;se!==null&&He<yt.length;He++){se.index>He?(Ze=se,se=null):Ze=se.sibling;var pn=Et(pt,se,yt[He],Mt);if(pn===null){se===null&&(se=Ze);break}e&&se&&pn.alternate===null&&i(pt,se),ft=w(pn,ft,He),gn===null?ue=pn:gn.sibling=pn,gn=pn,se=Ze}if(He===yt.length)return c(pt,se),qe&&Wi(pt,He),ue;if(se===null){for(;He<yt.length;He++)se=Dt(pt,yt[He],Mt),se!==null&&(ft=w(se,ft,He),gn===null?ue=se:gn.sibling=se,gn=se);return qe&&Wi(pt,He),ue}for(se=h(se);He<yt.length;He++)Ze=At(se,pt,He,yt[He],Mt),Ze!==null&&(e&&Ze.alternate!==null&&se.delete(Ze.key===null?He:Ze.key),ft=w(Ze,ft,He),gn===null?ue=Ze:gn.sibling=Ze,gn=Ze);return e&&se.forEach(function(sl){return i(pt,sl)}),qe&&Wi(pt,He),ue}function ve(pt,ft,yt,Mt){if(yt==null)throw Error(a(151));for(var ue=null,gn=null,se=ft,He=ft=0,Ze=null,pn=yt.next();se!==null&&!pn.done;He++,pn=yt.next()){se.index>He?(Ze=se,se=null):Ze=se.sibling;var sl=Et(pt,se,pn.value,Mt);if(sl===null){se===null&&(se=Ze);break}e&&se&&sl.alternate===null&&i(pt,se),ft=w(sl,ft,He),gn===null?ue=sl:gn.sibling=sl,gn=sl,se=Ze}if(pn.done)return c(pt,se),qe&&Wi(pt,He),ue;if(se===null){for(;!pn.done;He++,pn=yt.next())pn=Dt(pt,pn.value,Mt),pn!==null&&(ft=w(pn,ft,He),gn===null?ue=pn:gn.sibling=pn,gn=pn);return qe&&Wi(pt,He),ue}for(se=h(se);!pn.done;He++,pn=yt.next())pn=At(se,pt,He,pn.value,Mt),pn!==null&&(e&&pn.alternate!==null&&se.delete(pn.key===null?He:pn.key),ft=w(pn,ft,He),gn===null?ue=pn:gn.sibling=pn,gn=pn);return e&&se.forEach(function(y4){return i(pt,y4)}),qe&&Wi(pt,He),ue}function xn(pt,ft,yt,Mt){if(typeof yt=="object"&&yt!==null&&yt.type===D&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case R:t:{for(var ue=yt.key;ft!==null;){if(ft.key===ue){if(ue=yt.type,ue===D){if(ft.tag===7){c(pt,ft.sibling),Mt=b(ft,yt.props.children),Mt.return=pt,pt=Mt;break t}}else if(ft.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===y&&Mr(ue)===ft.type){c(pt,ft.sibling),Mt=b(ft,yt.props),Fl(Mt,yt),Mt.return=pt,pt=Mt;break t}c(pt,ft);break}else i(pt,ft);ft=ft.sibling}yt.type===D?(Mt=as(yt.props.children,pt.mode,Mt,yt.key),Mt.return=pt,pt=Mt):(Mt=Uo(yt.type,yt.key,yt.props,null,pt.mode,Mt),Fl(Mt,yt),Mt.return=pt,pt=Mt)}return q(pt);case v:t:{for(ue=yt.key;ft!==null;){if(ft.key===ue)if(ft.tag===4&&ft.stateNode.containerInfo===yt.containerInfo&&ft.stateNode.implementation===yt.implementation){c(pt,ft.sibling),Mt=b(ft,yt.children||[]),Mt.return=pt,pt=Mt;break t}else{c(pt,ft);break}else i(pt,ft);ft=ft.sibling}Mt=rc(yt,pt.mode,Mt),Mt.return=pt,pt=Mt}return q(pt);case y:return yt=Mr(yt),xn(pt,ft,yt,Mt)}if(Y(yt))return ne(pt,ft,yt,Mt);if(K(yt)){if(ue=K(yt),typeof ue!="function")throw Error(a(150));return yt=ue.call(yt),ve(pt,ft,yt,Mt)}if(typeof yt.then=="function")return xn(pt,ft,Xl(yt),Mt);if(yt.$$typeof===M)return xn(pt,ft,ql(pt,yt),Mt);ks(pt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint"?(yt=""+yt,ft!==null&&ft.tag===6?(c(pt,ft.sibling),Mt=b(ft,yt),Mt.return=pt,pt=Mt):(c(pt,ft),Mt=Il(yt,pt.mode,Mt),Mt.return=pt,pt=Mt),q(pt)):c(pt,ft)}return function(pt,ft,yt,Mt){try{Ql=0;var ue=xn(pt,ft,yt,Mt);return os=null,ue}catch(se){if(se===Is||se===hc)throw se;var gn=Oa(29,se,null,pt.mode);return gn.lanes=Mt,gn.return=pt,gn}finally{}}}var qs=ce(!0),Qh=ce(!1),jr=!1;function Vs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function id(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ls(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function us(e,i,c){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,(de&2)!==0){var b=h.pending;return b===null?i.next=i:(i.next=b.next,b.next=i),h.pending=i,i=Hl(e),Jf(e,null,c),i}return Tr(e,h,i,c),Hl(e)}function Jl(e,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var h=i.lanes;h&=e.pendingLanes,c|=h,i.lanes=c,Nt(e,c)}}function rd(e,i){var c=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var b=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var q={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};w===null?b=w=q:w=w.next=q,c=c.next}while(c!==null);w===null?b=w=i:w=w.next=i}else b=w=i;c={baseState:h.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},e.updateQueue=c;return}e=c.lastBaseUpdate,e===null?c.firstBaseUpdate=i:e.next=i,c.lastBaseUpdate=i}var Zl=!1;function ko(){if(Zl){var e=ss;if(e!==null)throw e}}function cs(e,i,c,h){Zl=!1;var b=e.updateQueue;jr=!1;var w=b.firstBaseUpdate,q=b.lastBaseUpdate,$=b.shared.pending;if($!==null){b.shared.pending=null;var ut=$,St=ut.next;ut.next=null,q===null?w=St:q.next=St,q=ut;var xt=e.alternate;xt!==null&&(xt=xt.updateQueue,$=xt.lastBaseUpdate,$!==q&&($===null?xt.firstBaseUpdate=St:$.next=St,xt.lastBaseUpdate=ut))}if(w!==null){var Dt=b.baseState;q=0,xt=St=ut=null,$=w;do{var Et=$.lane&-536870913,At=Et!==$.lane;if(At?(Be&Et)===Et:(h&Et)===Et){Et!==0&&Et===Ps&&(Zl=!0),xt!==null&&(xt=xt.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});t:{var ne=e,ve=$;Et=i;var xn=c;switch(ve.tag){case 1:if(ne=ve.payload,typeof ne=="function"){Dt=ne.call(xn,Dt,Et);break t}Dt=ne;break t;case 3:ne.flags=ne.flags&-65537|128;case 0:if(ne=ve.payload,Et=typeof ne=="function"?ne.call(xn,Dt,Et):ne,Et==null)break t;Dt=C({},Dt,Et);break t;case 2:jr=!0}}Et=$.callback,Et!==null&&(e.flags|=64,At&&(e.flags|=8192),At=b.callbacks,At===null?b.callbacks=[Et]:At.push(Et))}else At={lane:Et,tag:$.tag,payload:$.payload,callback:$.callback,next:null},xt===null?(St=xt=At,ut=Dt):xt=xt.next=At,q|=Et;if($=$.next,$===null){if($=b.shared.pending,$===null)break;At=$,$=At.next,At.next=null,b.lastBaseUpdate=At,b.shared.pending=null}}while(!0);xt===null&&(ut=Dt),b.baseState=ut,b.firstBaseUpdate=St,b.lastBaseUpdate=xt,w===null&&(b.shared.lanes=0),ys|=q,e.lanes=q,e.memoizedState=Dt}}function sd(e,i){if(typeof e!="function")throw Error(a(191,e));e.call(i)}function Xh(e,i){var c=e.callbacks;if(c!==null)for(e.callbacks=null,e=0;e<c.length;e++)sd(c[e],i)}var qo=Z(null),tr=Z(0);function er(e,i){e=wi,rt(tr,e),rt(qo,i),wi=e|i.baseLanes}function ua(){rt(tr,wi),rt(qo,qo.current)}function nr(){wi=tr.current,at(qo),at(tr)}var zn=Z(null),Ci=null;function fs(e){var i=e.alternate;rt(Qn,Qn.current&1),rt(zn,e),Ci===null&&(i===null||qo.current!==null||i.memoizedState!==null)&&(Ci=e)}function na(e){rt(Qn,Qn.current),rt(zn,e),Ci===null&&(Ci=e)}function ar(e){e.tag===22?(rt(Qn,Qn.current),rt(zn,e),Ci===null&&(Ci=e)):ds()}function ds(){rt(Qn,Qn.current),rt(zn,zn.current)}function fi(e){at(zn),Ci===e&&(Ci=null),at(Qn)}var Qn=Z(0);function mc(e){for(var i=e;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||op(c)||lp(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var ir=0,xe=null,vn=null,aa=null,Ur=!1,Ti=!1,Ys=!1,vc=0,Wl=0,rr=null,Ig=0;function Vn(){throw Error(a(321))}function od(e,i){if(i===null)return!1;for(var c=0;c<i.length&&c<e.length;c++)if(!ma(e[c],i[c]))return!1;return!0}function Ks(e,i,c,h,b,w){return ir=w,xe=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,j.H=e===null||e.memoizedState===null?Qs:nu,Ys=!1,w=c(h,b),Ys=!1,Ti&&(w=Jh(i,c,h,b)),Fh(e),w}function Fh(e){j.H=Yo;var i=vn!==null&&vn.next!==null;if(ir=0,aa=vn=xe=null,Ur=!1,Wl=0,rr=null,i)throw Error(a(300));e===null||ia||(e=e.dependencies,e!==null&&uc(e)&&(ia=!0))}function Jh(e,i,c,h){xe=e;var b=0;do{if(Ti&&(rr=null),Wl=0,Ti=!1,25<=b)throw Error(a(301));if(b+=1,aa=vn=null,e.updateQueue!=null){var w=e.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}j.H=Xs,w=i(c,h)}while(Ti);return w}function kg(){var e=j.H,i=e.useState()[0];return i=typeof i.then=="function"?$l(i):i,e=e.useState()[0],(vn!==null?vn.memoizedState:null)!==e&&(xe.flags|=1024),i}function ld(){var e=vc!==0;return vc=0,e}function ud(e,i,c){i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~c}function cd(e){if(Ur){for(e=e.memoizedState;e!==null;){var i=e.queue;i!==null&&(i.pending=null),e=e.next}Ur=!1}ir=0,aa=vn=xe=null,Ti=!1,Wl=vc=0,rr=null}function La(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return aa===null?xe.memoizedState=aa=e:aa=aa.next=e,aa}function Xn(){if(vn===null){var e=xe.alternate;e=e!==null?e.memoizedState:null}else e=vn.next;var i=aa===null?xe.memoizedState:aa.next;if(i!==null)aa=i,vn=e;else{if(e===null)throw xe.alternate===null?Error(a(467)):Error(a(310));vn=e,e={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},aa===null?xe.memoizedState=aa=e:aa=aa.next=e}return aa}function yc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $l(e){var i=Wl;return Wl+=1,rr===null&&(rr=[]),e=gc(rr,e,i),i=xe,(aa===null?i.memoizedState:aa.next)===null&&(i=i.alternate,j.H=i===null||i.memoizedState===null?Qs:nu),e}function Sc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return $l(e);if(e.$$typeof===M)return Nn(e)}throw Error(a(438,String(e)))}function fd(e){var i=null,c=xe.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var h=xe.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(i={data:h.data.map(function(b){return b.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=yc(),xe.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(e),h=0;h<e;h++)c[h]=U;return i.index++,c}function sr(e,i){return typeof i=="function"?i(e):i}function bc(e){var i=Xn();return dd(i,vn,e)}function dd(e,i,c){var h=e.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=c;var b=e.baseQueue,w=h.pending;if(w!==null){if(b!==null){var q=b.next;b.next=w.next,w.next=q}i.baseQueue=b=w,h.pending=null}if(w=e.baseState,b===null)e.memoizedState=w;else{i=b.next;var $=q=null,ut=null,St=i,xt=!1;do{var Dt=St.lane&-536870913;if(Dt!==St.lane?(Be&Dt)===Dt:(ir&Dt)===Dt){var Et=St.revertLane;if(Et===0)ut!==null&&(ut=ut.next={lane:0,revertLane:0,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),Dt===Ps&&(xt=!0);else if((ir&Et)===Et){St=St.next,Et===Ps&&(xt=!0);continue}else Dt={lane:0,revertLane:St.revertLane,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ut===null?($=ut=Dt,q=w):ut=ut.next=Dt,xe.lanes|=Et,ys|=Et;Dt=St.action,Ys&&c(w,Dt),w=St.hasEagerState?St.eagerState:c(w,Dt)}else Et={lane:Dt,revertLane:St.revertLane,gesture:St.gesture,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ut===null?($=ut=Et,q=w):ut=ut.next=Et,xe.lanes|=Dt,ys|=Dt;St=St.next}while(St!==null&&St!==i);if(ut===null?q=w:ut.next=$,!ma(w,e.memoizedState)&&(ia=!0,xt&&(c=ss,c!==null)))throw c;e.memoizedState=w,e.baseState=q,e.baseQueue=ut,h.lastRenderedState=w}return b===null&&(h.lanes=0),[e.memoizedState,h.dispatch]}function hd(e){var i=Xn(),c=i.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=e;var h=c.dispatch,b=c.pending,w=i.memoizedState;if(b!==null){c.pending=null;var q=b=b.next;do w=e(w,q.action),q=q.next;while(q!==b);ma(w,i.memoizedState)||(ia=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),c.lastRenderedState=w}return[w,h]}function Zh(e,i,c){var h=xe,b=Xn(),w=qe;if(w){if(c===void 0)throw Error(a(407));c=c()}else c=i();var q=!ma((vn||b).memoizedState,c);if(q&&(b.memoizedState=c,ia=!0),b=b.queue,Sd(gd.bind(null,h,b,e),[e]),b.getSnapshot!==i||q||aa!==null&&aa.memoizedState.tag&1){if(h.flags|=2048,Vo(9,{destroy:void 0},$h.bind(null,h,b,c,i),null),Le===null)throw Error(a(349));w||(ir&127)!==0||Wh(h,i,c)}return c}function Wh(e,i,c){e.flags|=16384,e={getSnapshot:i,value:c},i=xe.updateQueue,i===null?(i=yc(),xe.updateQueue=i,i.stores=[e]):(c=i.stores,c===null?i.stores=[e]:c.push(e))}function $h(e,i,c,h){i.value=c,i.getSnapshot=h,pd(i)&&t0(e)}function gd(e,i,c){return c(function(){pd(i)&&t0(e)})}function pd(e){var i=e.getSnapshot;e=e.value;try{var c=i();return!ma(e,c)}catch{return!0}}function t0(e){var i=oi(e,2);i!==null&&hn(i,e,2)}function _c(e){var i=La();if(typeof e=="function"){var c=e;if(e=c(),Ys){dt(!0);try{c()}finally{dt(!1)}}}return i.memoizedState=i.baseState=e,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sr,lastRenderedState:e},i}function md(e,i,c,h){return e.baseState=c,dd(e,vn,typeof h=="function"?h:sr)}function e0(e,i,c,h,b){if(eu(e))throw Error(a(485));if(e=i.action,e!==null){var w={payload:b,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){w.listeners.push(q)}};j.T!==null?c(!0):w.isTransition=!1,h(w),c=i.pending,c===null?(w.next=i.pending=w,Ec(i,w)):(w.next=c.next,i.pending=c.next=w)}}function Ec(e,i){var c=i.action,h=i.payload,b=e.state;if(i.isTransition){var w=j.T,q={};j.T=q;try{var $=c(b,h),ut=j.S;ut!==null&&ut(q,$),Cc(e,i,$)}catch(St){vd(e,i,St)}finally{w!==null&&q.types!==null&&(w.types=q.types),j.T=w}}else try{w=c(b,h),Cc(e,i,w)}catch(St){vd(e,i,St)}}function Cc(e,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){n0(e,i,h)},function(h){return vd(e,i,h)}):n0(e,i,c)}function n0(e,i,c){i.status="fulfilled",i.value=c,a0(i),e.state=c,i=e.pending,i!==null&&(c=i.next,c===i?e.pending=null:(c=c.next,i.next=c,Ec(e,c)))}function vd(e,i,c){var h=e.pending;if(e.pending=null,h!==null){h=h.next;do i.status="rejected",i.reason=c,a0(i),i=i.next;while(i!==h)}e.action=null}function a0(e){e=e.listeners;for(var i=0;i<e.length;i++)(0,e[i])()}function i0(e,i){return i}function yd(e,i){if(qe){var c=Le.formState;if(c!==null){t:{var h=xe;if(qe){if(Tn){e:{for(var b=Tn,w=za;b.nodeType!==8;){if(!w){b=null;break e}if(b=mr(b.nextSibling),b===null){b=null;break e}}w=b.data,b=w==="F!"||w==="F"?b:null}if(b){Tn=mr(b.nextSibling),h=b.data==="F!";break t}}wr(h)}h=!1}h&&(i=c[0])}}return c=La(),c.memoizedState=c.baseState=i,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i0,lastRenderedState:i},c.queue=h,c=Cd.bind(null,xe,h),h.dispatch=c,h=_c(!1),w=Fn.bind(null,xe,!1,h.queue),h=La(),b={state:i,dispatch:null,action:e,pending:null},h.queue=b,c=e0.bind(null,xe,b,w,c),b.dispatch=c,h.memoizedState=e,[i,c,!1]}function r0(e){var i=Xn();return s0(i,vn,e)}function s0(e,i,c){if(i=dd(e,i,i0)[0],e=bc(sr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var h=$l(i)}catch(q){throw q===Is?hc:q}else h=i;i=Xn();var b=i.queue,w=b.dispatch;return c!==i.memoizedState&&(xe.flags|=2048,Vo(9,{destroy:void 0},qg.bind(null,b,c),null)),[h,w,e]}function qg(e,i){e.action=i}function o0(e){var i=Xn(),c=vn;if(c!==null)return s0(i,c,e);Xn(),i=i.memoizedState,c=Xn();var h=c.queue.dispatch;return c.memoizedState=e,[i,h,!1]}function Vo(e,i,c,h){return e={tag:e,create:c,deps:h,inst:i,next:null},i=xe.updateQueue,i===null&&(i=yc(),xe.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=e.next=e:(h=c.next,c.next=e,e.next=h,i.lastEffect=e),e}function l0(){return Xn().memoizedState}function Tc(e,i,c,h){var b=La();xe.flags|=e,b.memoizedState=Vo(1|i,{destroy:void 0},c,h===void 0?null:h)}function Ac(e,i,c,h){var b=Xn();h=h===void 0?null:h;var w=b.memoizedState.inst;vn!==null&&h!==null&&od(h,vn.memoizedState.deps)?b.memoizedState=Vo(i,w,c,h):(xe.flags|=e,b.memoizedState=Vo(1|i,w,c,h))}function u0(e,i){Tc(8390656,8,e,i)}function Sd(e,i){Ac(2048,8,e,i)}function Vg(e){xe.flags|=4;var i=xe.updateQueue;if(i===null)i=yc(),xe.updateQueue=i,i.events=[e];else{var c=i.events;c===null?i.events=[e]:c.push(e)}}function c0(e){var i=Xn().memoizedState;return Vg({ref:i,nextImpl:e}),function(){if((de&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function f0(e,i){return Ac(4,2,e,i)}function d0(e,i){return Ac(4,4,e,i)}function h0(e,i){if(typeof i=="function"){e=e();var c=i(e);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function g0(e,i,c){c=c!=null?c.concat([e]):null,Ac(4,4,h0.bind(null,i,e),c)}function wc(){}function p0(e,i){var c=Xn();i=i===void 0?null:i;var h=c.memoizedState;return i!==null&&od(i,h[1])?h[0]:(c.memoizedState=[e,i],e)}function m0(e,i){var c=Xn();i=i===void 0?null:i;var h=c.memoizedState;if(i!==null&&od(i,h[1]))return h[0];if(h=e(),Ys){dt(!0);try{e()}finally{dt(!1)}}return c.memoizedState=[h,i],h}function di(e,i,c){return c===void 0||(ir&1073741824)!==0&&(Be&261930)===0?e.memoizedState=i:(e.memoizedState=c,e=Ir(),xe.lanes|=e,ys|=e,c)}function bd(e,i,c,h){return ma(c,i)?c:qo.current!==null?(e=di(e,c,h),ma(e,i)||(ia=!0),e):(ir&42)===0||(ir&1073741824)!==0&&(Be&261930)===0?(ia=!0,e.memoizedState=c):(e=Ir(),xe.lanes|=e,ys|=e,i)}function Rc(e,i,c,h,b){var w=I.p;I.p=w!==0&&8>w?w:8;var q=j.T,$={};j.T=$,Fn(e,!1,i,c);try{var ut=b(),St=j.S;if(St!==null&&St($,ut),ut!==null&&typeof ut=="object"&&typeof ut.then=="function"){var xt=ci(ut,h);tu(e,i,xt,Da(e))}else tu(e,i,h,Da(e))}catch(Dt){tu(e,i,{then:function(){},status:"rejected",reason:Dt},Da())}finally{I.p=w,q!==null&&$.types!==null&&(q.types=$.types),j.T=q}}function v0(){}function Oc(e,i,c,h){if(e.tag!==5)throw Error(a(476));var b=_d(e).queue;Rc(e,b,i,F,c===null?v0:function(){return y0(e),c(h)})}function _d(e){var i=e.memoizedState;if(i!==null)return i;i={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sr,lastRenderedState:F},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sr,lastRenderedState:c},next:null},e.memoizedState=i,e=e.alternate,e!==null&&(e.memoizedState=i),i}function y0(e){var i=_d(e);i.next===null&&(i=e.alternate.memoizedState),tu(e,i.next.queue,{},Da())}function xc(){return Nn(kd)}function Ed(){return Xn().memoizedState}function S0(){return Xn().memoizedState}function Yg(e){for(var i=e.return;i!==null;){switch(i.tag){case 24:case 3:var c=Da();e=ls(c);var h=us(i,e,c);h!==null&&(hn(h,i,c),Jl(h,i,c)),i={cache:cc()},e.payload=i;return}i=i.return}}function Kg(e,i,c){var h=Da();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},eu(e)?b0(i,c):(c=js(e,i,c,h),c!==null&&(hn(c,e,h),Td(c,i,h)))}function Cd(e,i,c){var h=Da();tu(e,i,c,h)}function tu(e,i,c,h){var b={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(eu(e))b0(i,b);else{var w=e.alternate;if(e.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var q=i.lastRenderedState,$=w(q,c);if(b.hasEagerState=!0,b.eagerState=$,ma($,q))return Tr(e,i,b,0),Le===null&&Gl(),!1}catch{}finally{}if(c=js(e,i,b,h),c!==null)return hn(c,e,h),Td(c,i,h),!0}return!1}function Fn(e,i,c,h){if(h={lane:2,revertLane:Fg(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},eu(e)){if(i)throw Error(a(479))}else i=js(e,c,h,2),i!==null&&hn(i,e,2)}function eu(e){var i=e.alternate;return e===xe||i!==null&&i===xe}function b0(e,i){Ti=Ur=!0;var c=e.pending;c===null?i.next=i:(i.next=c.next,c.next=i),e.pending=i}function Td(e,i,c){if((c&4194048)!==0){var h=i.lanes;h&=e.pendingLanes,c|=h,i.lanes=c,Nt(e,c)}}var Yo={readContext:Nn,use:Sc,useCallback:Vn,useContext:Vn,useEffect:Vn,useImperativeHandle:Vn,useLayoutEffect:Vn,useInsertionEffect:Vn,useMemo:Vn,useReducer:Vn,useRef:Vn,useState:Vn,useDebugValue:Vn,useDeferredValue:Vn,useTransition:Vn,useSyncExternalStore:Vn,useId:Vn,useHostTransitionStatus:Vn,useFormState:Vn,useActionState:Vn,useOptimistic:Vn,useMemoCache:Vn,useCacheRefresh:Vn};Yo.useEffectEvent=Vn;var Qs={readContext:Nn,use:Sc,useCallback:function(e,i){return La().memoizedState=[e,i===void 0?null:i],e},useContext:Nn,useEffect:u0,useImperativeHandle:function(e,i,c){c=c!=null?c.concat([e]):null,Tc(4194308,4,h0.bind(null,i,e),c)},useLayoutEffect:function(e,i){return Tc(4194308,4,e,i)},useInsertionEffect:function(e,i){Tc(4,2,e,i)},useMemo:function(e,i){var c=La();i=i===void 0?null:i;var h=e();if(Ys){dt(!0);try{e()}finally{dt(!1)}}return c.memoizedState=[h,i],h},useReducer:function(e,i,c){var h=La();if(c!==void 0){var b=c(i);if(Ys){dt(!0);try{c(i)}finally{dt(!1)}}}else b=i;return h.memoizedState=h.baseState=b,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:b},h.queue=e,e=e.dispatch=Kg.bind(null,xe,e),[h.memoizedState,e]},useRef:function(e){var i=La();return e={current:e},i.memoizedState=e},useState:function(e){e=_c(e);var i=e.queue,c=Cd.bind(null,xe,i);return i.dispatch=c,[e.memoizedState,c]},useDebugValue:wc,useDeferredValue:function(e,i){var c=La();return di(c,e,i)},useTransition:function(){var e=_c(!1);return e=Rc.bind(null,xe,e.queue,!0,!1),La().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,i,c){var h=xe,b=La();if(qe){if(c===void 0)throw Error(a(407));c=c()}else{if(c=i(),Le===null)throw Error(a(349));(Be&127)!==0||Wh(h,i,c)}b.memoizedState=c;var w={value:c,getSnapshot:i};return b.queue=w,u0(gd.bind(null,h,w,e),[e]),h.flags|=2048,Vo(9,{destroy:void 0},$h.bind(null,h,w,c,i),null),c},useId:function(){var e=La(),i=Le.identifierPrefix;if(qe){var c=Ui,h=ji;c=(h&~(1<<32-Yt(h)-1)).toString(32)+c,i="_"+i+"R_"+c,c=vc++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=Ig++,i="_"+i+"r_"+c.toString(32)+"_";return e.memoizedState=i},useHostTransitionStatus:xc,useFormState:yd,useActionState:yd,useOptimistic:function(e){var i=La();i.memoizedState=i.baseState=e;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=Fn.bind(null,xe,!0,c),c.dispatch=i,[e,i]},useMemoCache:fd,useCacheRefresh:function(){return La().memoizedState=Yg.bind(null,xe)},useEffectEvent:function(e){var i=La(),c={impl:e};return i.memoizedState=c,function(){if((de&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}},nu={readContext:Nn,use:Sc,useCallback:p0,useContext:Nn,useEffect:Sd,useImperativeHandle:g0,useInsertionEffect:f0,useLayoutEffect:d0,useMemo:m0,useReducer:bc,useRef:l0,useState:function(){return bc(sr)},useDebugValue:wc,useDeferredValue:function(e,i){var c=Xn();return bd(c,vn.memoizedState,e,i)},useTransition:function(){var e=bc(sr)[0],i=Xn().memoizedState;return[typeof e=="boolean"?e:$l(e),i]},useSyncExternalStore:Zh,useId:Ed,useHostTransitionStatus:xc,useFormState:r0,useActionState:r0,useOptimistic:function(e,i){var c=Xn();return md(c,vn,e,i)},useMemoCache:fd,useCacheRefresh:S0};nu.useEffectEvent=c0;var Xs={readContext:Nn,use:Sc,useCallback:p0,useContext:Nn,useEffect:Sd,useImperativeHandle:g0,useInsertionEffect:f0,useLayoutEffect:d0,useMemo:m0,useReducer:hd,useRef:l0,useState:function(){return hd(sr)},useDebugValue:wc,useDeferredValue:function(e,i){var c=Xn();return vn===null?di(c,e,i):bd(c,vn.memoizedState,e,i)},useTransition:function(){var e=hd(sr)[0],i=Xn().memoizedState;return[typeof e=="boolean"?e:$l(e),i]},useSyncExternalStore:Zh,useId:Ed,useHostTransitionStatus:xc,useFormState:o0,useActionState:o0,useOptimistic:function(e,i){var c=Xn();return vn!==null?md(c,vn,e,i):(c.baseState=e,[e,c.queue.dispatch])},useMemoCache:fd,useCacheRefresh:S0};Xs.useEffectEvent=c0;function hs(e,i,c,h){i=e.memoizedState,c=c(h,i),c=c==null?i:C({},i,c),e.memoizedState=c,e.lanes===0&&(e.updateQueue.baseState=c)}var Pa={enqueueSetState:function(e,i,c){e=e._reactInternals;var h=Da(),b=ls(h);b.payload=i,c!=null&&(b.callback=c),i=us(e,b,h),i!==null&&(hn(i,e,h),Jl(i,e,h))},enqueueReplaceState:function(e,i,c){e=e._reactInternals;var h=Da(),b=ls(h);b.tag=1,b.payload=i,c!=null&&(b.callback=c),i=us(e,b,h),i!==null&&(hn(i,e,h),Jl(i,e,h))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var c=Da(),h=ls(c);h.tag=2,i!=null&&(h.callback=i),i=us(e,h,c),i!==null&&(hn(i,e,c),Jl(i,e,c))}};function _0(e,i,c,h,b,w,q){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,w,q):i.prototype&&i.prototype.isPureReactComponent?!_i(c,h)||!_i(b,w):!0}function E0(e,i,c,h){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,h),i.state!==e&&Pa.enqueueReplaceState(i,i.state,null)}function or(e,i){var c=i;if("ref"in i){c={};for(var h in i)h!=="ref"&&(c[h]=i[h])}if(e=e.defaultProps){c===i&&(c=C({},c));for(var b in e)c[b]===void 0&&(c[b]=e[b])}return c}function au(e){Mi(e)}function iu(e){console.error(e)}function Mc(e){Mi(e)}function Nc(e,i){try{var c=e.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(h){setTimeout(function(){throw h})}}function C0(e,i,c){try{var h=e.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function hi(e,i,c){return c=ls(c),c.tag=3,c.payload={element:null},c.callback=function(){Nc(e,i)},c}function Ad(e){return e=ls(e),e.tag=3,e}function T0(e,i,c,h){var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var w=h.value;e.payload=function(){return b(w)},e.callback=function(){C0(i,c,h)}}var q=c.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(e.callback=function(){C0(i,c,h),typeof b!="function"&&(ka===null?ka=new Set([this]):ka.add(this));var $=h.stack;this.componentDidCatch(h.value,{componentStack:$!==null?$:""})})}function wd(e,i,c,h,b){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(i=c.alternate,i!==null&&Po(i,c,b,!0),c=zn.current,c!==null){switch(c.tag){case 31:case 13:return Ci===null?S():c.alternate===null&&wn===0&&(wn=3),c.flags&=-257,c.flags|=65536,c.lanes=b,h===Kl?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([h]):i.add(h),En(e,h,b)),!1;case 22:return c.flags|=65536,h===Kl?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([h]):c.add(h)),En(e,h,b)),!1}throw Error(a(435,c.tag))}return En(e,h,b),S(),!1}if(qe)return i=zn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=b,h!==oc&&(e=Error(a(422),{cause:h}),Lo(li(e,c)))):(h!==oc&&(i=Error(a(423),{cause:h}),Lo(li(i,c))),e=e.current.alternate,e.flags|=65536,b&=-b,e.lanes|=b,h=li(h,c),b=hi(e.stateNode,h,b),rd(e,b),wn!==4&&(wn=2)),!1;var w=Error(a(520),{cause:h});if(w=li(w,c),We===null?We=[w]:We.push(w),wn!==4&&(wn=2),i===null)return!0;h=li(h,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,e=b&-b,c.lanes|=e,e=hi(c.stateNode,h,e),rd(c,e),!1;case 1:if(i=c.type,w=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ka===null||!ka.has(w))))return c.flags|=65536,b&=-b,c.lanes|=b,b=Ad(b),T0(b,e,c,h),rd(c,b),!1}c=c.return}while(c!==null);return!1}var Rd=Error(a(461)),ia=!1;function _a(e,i,c,h){i.child=e===null?Qh(i,null,c,h):qs(i,e.child,c,h)}function Ko(e,i,c,h,b){c=c.render;var w=i.ref;if("ref"in h){var q={};for(var $ in h)$!=="ref"&&(q[$]=h[$])}else q=h;return Rr(i),h=Ks(e,i,c,q,w,b),$=ld(),e!==null&&!ia?(ud(e,i,b),Pi(e,i,b)):(qe&&$&&kl(i),i.flags|=1,_a(e,i,h,b),i.child)}function Ja(e,i,c,h,b){if(e===null){var w=c.type;return typeof w=="function"&&!ac(w)&&w.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=w,Dc(e,i,w,h,b)):(e=Uo(c.type,null,h,i,i.mode,b),e.ref=i.ref,e.return=i,i.child=e)}if(w=e.child,!Ga(e,b)){var q=w.memoizedProps;if(c=c.compare,c=c!==null?c:_i,c(q,h)&&e.ref===i.ref)return Pi(e,i,b)}return i.flags|=1,e=Ni(w,h),e.ref=i.ref,e.return=i,i.child=e}function Dc(e,i,c,h,b){if(e!==null){var w=e.memoizedProps;if(_i(w,h)&&e.ref===i.ref)if(ia=!1,i.pendingProps=h=w,Ga(e,b))(e.flags&131072)!==0&&(ia=!0);else return i.lanes=e.lanes,Pi(e,i,b)}return Za(e,i,c,h,b)}function Od(e,i,c,h){var b=h.children,w=e!==null?e.memoizedState:null;if(e===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((i.flags&128)!==0){if(w=w!==null?w.baseLanes|c:c,e!==null){for(h=i.child=e.child,b=0;h!==null;)b=b|h.lanes|h.childLanes,h=h.sibling;h=b&~w}else h=0,i.child=null;return xd(e,i,w,c,h)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},e!==null&&Or(i,w!==null?w.cachePool:null),w!==null?er(i,w):ua(),ar(i);else return h=i.lanes=536870912,xd(e,i,w!==null?w.baseLanes|c:c,c,h)}else w!==null?(Or(i,w.cachePool),er(i,w),ds(),i.memoizedState=null):(e!==null&&Or(i,null),ua(),ds());return _a(e,i,b,c),i.child}function Fs(e,i){return e!==null&&e.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function xd(e,i,c,h,b){var w=Io();return w=w===null?null:{parent:ea._currentValue,pool:w},i.memoizedState={baseLanes:c,cachePool:w},e!==null&&Or(i,null),ua(),ar(i),e!==null&&Po(e,i,h,!0),i.childLanes=b,null}function Br(e,i){return i=ca({mode:i.mode,children:i.children},e.mode),i.ref=e.ref,e.child=i,i.return=e,i}function Js(e,i,c){return qs(i,e.child,null,c),e=Br(i,i.pendingProps),e.flags|=2,fi(i),i.memoizedState=null,e}function jc(e,i,c){var h=i.pendingProps,b=(i.flags&128)!==0;if(i.flags&=-129,e===null){if(qe){if(h.mode==="hidden")return e=Br(i,h),i.lanes=536870912,Fs(null,e);if(na(i),(e=Tn)?(e=Lv(e,za),e=e!==null&&e.data==="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:Ar!==null?{id:ji,overflow:Ui}:null,retryLane:536870912,hydrationErrors:null},c=Qa(e),c.return=i,i.child=c,ba=i,Tn=null)):e=null,e===null)throw wr(i);return i.lanes=536870912,null}return Br(i,h)}var w=e.memoizedState;if(w!==null){var q=w.dehydrated;if(na(i),b)if(i.flags&256)i.flags&=-257,i=Js(e,i,c);else if(i.memoizedState!==null)i.child=e.child,i.flags|=128,i=null;else throw Error(a(558));else if(ia||Po(e,i,c,!1),b=(c&e.childLanes)!==0,ia||b){if(h=Le,h!==null&&(q=Ut(h,c),q!==0&&q!==w.retryLane))throw w.retryLane=q,oi(e,q),hn(h,e,q),Rd;S(),i=Js(e,i,c)}else e=w.treeContext,Tn=mr(q.nextSibling),ba=i,qe=!0,ui=null,za=!1,e!==null&&Yh(i,e),i=Br(i,h),i.flags|=4096;return i}return e=Ni(e.child,{mode:h.mode,children:h.children}),e.ref=i.ref,i.child=e,e.return=i,e}function Zs(e,i){var c=i.ref;if(c===null)e!==null&&e.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(e===null||e.ref!==c)&&(i.flags|=4194816)}}function Za(e,i,c,h,b){return Rr(i),c=Ks(e,i,c,h,void 0,b),h=ld(),e!==null&&!ia?(ud(e,i,b),Pi(e,i,b)):(qe&&h&&kl(i),i.flags|=1,_a(e,i,c,b),i.child)}function gi(e,i,c,h,b,w){return Rr(i),i.updateQueue=null,c=Jh(i,h,c,b),Fh(e),h=ld(),e!==null&&!ia?(ud(e,i,w),Pi(e,i,w)):(qe&&h&&kl(i),i.flags|=1,_a(e,i,c,w),i.child)}function gs(e,i,c,h,b){if(Rr(i),i.stateNode===null){var w=Zi,q=c.contextType;typeof q=="object"&&q!==null&&(w=Nn(q)),w=new c(h,w),i.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Pa,i.stateNode=w,w._reactInternals=i,w=i.stateNode,w.props=h,w.state=i.memoizedState,w.refs={},Vs(i),q=c.contextType,w.context=typeof q=="object"&&q!==null?Nn(q):Zi,w.state=i.memoizedState,q=c.getDerivedStateFromProps,typeof q=="function"&&(hs(i,c,q,h),w.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(q=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),q!==w.state&&Pa.enqueueReplaceState(w,w.state,null),cs(i,h,w,b),ko(),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308),h=!0}else if(e===null){w=i.stateNode;var $=i.memoizedProps,ut=or(c,$);w.props=ut;var St=w.context,xt=c.contextType;q=Zi,typeof xt=="object"&&xt!==null&&(q=Nn(xt));var Dt=c.getDerivedStateFromProps;xt=typeof Dt=="function"||typeof w.getSnapshotBeforeUpdate=="function",$=i.pendingProps!==$,xt||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||($||St!==q)&&E0(i,w,h,q),jr=!1;var Et=i.memoizedState;w.state=Et,cs(i,h,w,b),ko(),St=i.memoizedState,$||Et!==St||jr?(typeof Dt=="function"&&(hs(i,c,Dt,h),St=i.memoizedState),(ut=jr||_0(i,c,ut,h,Et,St,q))?(xt||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(i.flags|=4194308)):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=St),w.props=h,w.state=St,w.context=q,h=ut):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{w=i.stateNode,id(e,i),q=i.memoizedProps,xt=or(c,q),w.props=xt,Dt=i.pendingProps,Et=w.context,St=c.contextType,ut=Zi,typeof St=="object"&&St!==null&&(ut=Nn(St)),$=c.getDerivedStateFromProps,(St=typeof $=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(q!==Dt||Et!==ut)&&E0(i,w,h,ut),jr=!1,Et=i.memoizedState,w.state=Et,cs(i,h,w,b),ko();var At=i.memoizedState;q!==Dt||Et!==At||jr||e!==null&&e.dependencies!==null&&uc(e.dependencies)?(typeof $=="function"&&(hs(i,c,$,h),At=i.memoizedState),(xt=jr||_0(i,c,xt,h,Et,At,ut)||e!==null&&e.dependencies!==null&&uc(e.dependencies))?(St||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,At,ut),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,At,ut)),typeof w.componentDidUpdate=="function"&&(i.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=At),w.props=h,w.state=At,w.context=ut,h=xt):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=1024),h=!1)}return w=h,Zs(e,i),h=(i.flags&128)!==0,w||h?(w=i.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:w.render(),i.flags|=1,e!==null&&h?(i.child=qs(i,e.child,null,b),i.child=qs(i,null,c,b)):_a(e,i,c,b),i.memoizedState=w.state,e=i.child):e=Pi(e,i,b),e}function lr(e,i,c,h){return is(),i.flags|=256,_a(e,i,c,h),i.child}var zi={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function oa(e){return{baseLanes:e,cachePool:Hs()}}function Ws(e,i,c){return e=e!==null?e.childLanes&~c:0,i&&(e|=me),e}function zr(e,i,c){var h=i.pendingProps,b=!1,w=(i.flags&128)!==0,q;if((q=w)||(q=e!==null&&e.memoizedState===null?!1:(Qn.current&2)!==0),q&&(b=!0,i.flags&=-129),q=(i.flags&32)!==0,i.flags&=-33,e===null){if(qe){if(b?fs(i):ds(),(e=Tn)?(e=Lv(e,za),e=e!==null&&e.data!=="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:Ar!==null?{id:ji,overflow:Ui}:null,retryLane:536870912,hydrationErrors:null},c=Qa(e),c.return=i,i.child=c,ba=i,Tn=null)):e=null,e===null)throw wr(i);return lp(e)?i.lanes=32:i.lanes=536870912,null}var $=h.children;return h=h.fallback,b?(ds(),b=i.mode,$=ca({mode:"hidden",children:$},b),h=as(h,b,c,null),$.return=i,h.return=i,$.sibling=h,i.child=$,h=i.child,h.memoizedState=oa(c),h.childLanes=Ws(e,q,c),i.memoizedState=zi,Fs(null,h)):(fs(i),Qo(i,$))}var ut=e.memoizedState;if(ut!==null&&($=ut.dehydrated,$!==null)){if(w)i.flags&256?(fs(i),i.flags&=-257,i=Jn(e,i,c)):i.memoizedState!==null?(ds(),i.child=e.child,i.flags|=128,i=null):(ds(),$=h.fallback,b=i.mode,h=ca({mode:"visible",children:h.children},b),$=as($,b,c,null),$.flags|=2,h.return=i,$.return=i,h.sibling=$,i.child=h,qs(i,e.child,null,c),h=i.child,h.memoizedState=oa(c),h.childLanes=Ws(e,q,c),i.memoizedState=zi,i=Fs(null,h));else if(fs(i),lp($)){if(q=$.nextSibling&&$.nextSibling.dataset,q)var St=q.dgst;q=St,h=Error(a(419)),h.stack="",h.digest=q,Lo({value:h,source:null,stack:null}),i=Jn(e,i,c)}else if(ia||Po(e,i,c,!1),q=(c&e.childLanes)!==0,ia||q){if(q=Le,q!==null&&(h=Ut(q,c),h!==0&&h!==ut.retryLane))throw ut.retryLane=h,oi(e,h),hn(q,e,h),Rd;op($)||S(),i=Jn(e,i,c)}else op($)?(i.flags|=192,i.child=e.child,i=null):(e=ut.treeContext,Tn=mr($.nextSibling),ba=i,qe=!0,ui=null,za=!1,e!==null&&Yh(i,e),i=Qo(i,h.children),i.flags|=4096);return i}return b?(ds(),$=h.fallback,b=i.mode,ut=e.child,St=ut.sibling,h=Ni(ut,{mode:"hidden",children:h.children}),h.subtreeFlags=ut.subtreeFlags&65011712,St!==null?$=Ni(St,$):($=as($,b,c,null),$.flags|=2),$.return=i,h.return=i,h.sibling=$,i.child=h,Fs(null,h),h=i.child,$=e.child.memoizedState,$===null?$=oa(c):(b=$.cachePool,b!==null?(ut=ea._currentValue,b=b.parent!==ut?{parent:ut,pool:ut}:b):b=Hs(),$={baseLanes:$.baseLanes|c,cachePool:b}),h.memoizedState=$,h.childLanes=Ws(e,q,c),i.memoizedState=zi,Fs(e.child,h)):(fs(i),c=e.child,e=c.sibling,c=Ni(c,{mode:"visible",children:h.children}),c.return=i,c.sibling=null,e!==null&&(q=i.deletions,q===null?(i.deletions=[e],i.flags|=16):q.push(e)),i.child=c,i.memoizedState=null,c)}function Qo(e,i){return i=ca({mode:"visible",children:i},e.mode),i.return=e,e.child=i}function ca(e,i){return e=Oa(22,e,null,i),e.lanes=0,e}function Jn(e,i,c){return qs(i,e.child,null,c),e=Qo(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function nn(e,i,c){e.lanes|=i;var h=e.alternate;h!==null&&(h.lanes|=i),td(e.return,i,c)}function Lr(e,i,c,h,b,w){var q=e.memoizedState;q===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:b,treeForkCount:w}:(q.isBackwards=i,q.rendering=null,q.renderingStartTime=0,q.last=h,q.tail=c,q.tailMode=b,q.treeForkCount=w)}function Li(e,i,c){var h=i.pendingProps,b=h.revealOrder,w=h.tail;h=h.children;var q=Qn.current,$=(q&2)!==0;if($?(q=q&1|2,i.flags|=128):q&=1,rt(Qn,q),_a(e,i,h,c),h=qe?zo:0,!$&&e!==null&&(e.flags&128)!==0)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&nn(e,c,i);else if(e.tag===19)nn(e,c,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(b){case"forwards":for(c=i.child,b=null;c!==null;)e=c.alternate,e!==null&&mc(e)===null&&(b=c),c=c.sibling;c=b,c===null?(b=i.child,i.child=null):(b=c.sibling,c.sibling=null),Lr(i,!1,b,c,w,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,b=i.child,i.child=null;b!==null;){if(e=b.alternate,e!==null&&mc(e)===null){i.child=b;break}e=b.sibling,b.sibling=c,c=b,b=e}Lr(i,!0,c,null,w,h);break;case"together":Lr(i,!1,null,null,void 0,h);break;default:i.memoizedState=null}return i.child}function Pi(e,i,c){if(e!==null&&(i.dependencies=e.dependencies),ys|=i.lanes,(c&i.childLanes)===0)if(e!==null){if(Po(e,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(e!==null&&i.child!==e.child)throw Error(a(153));if(i.child!==null){for(e=i.child,c=Ni(e,e.pendingProps),i.child=c,c.return=i;e.sibling!==null;)e=e.sibling,c=c.sibling=Ni(e,e.pendingProps),c.return=i;c.sibling=null}return i.child}function Ga(e,i){return(e.lanes&i)!==0?!0:(e=e.dependencies,!!(e!==null&&uc(e)))}function Uc(e,i,c){switch(i.tag){case 3:ht(i,i.stateNode.containerInfo),rs(i,ea,e.memoizedState.cache),is();break;case 27:case 5:jt(i);break;case 4:ht(i,i.stateNode.containerInfo);break;case 10:rs(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,na(i),null;break;case 13:var h=i.memoizedState;if(h!==null)return h.dehydrated!==null?(fs(i),i.flags|=128,null):(c&i.child.childLanes)!==0?zr(e,i,c):(fs(i),e=Pi(e,i,c),e!==null?e.sibling:null);fs(i);break;case 19:var b=(e.flags&128)!==0;if(h=(c&i.childLanes)!==0,h||(Po(e,i,c,!1),h=(c&i.childLanes)!==0),b){if(h)return Li(e,i,c);i.flags|=128}if(b=i.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),rt(Qn,Qn.current),h)break;return null;case 22:return i.lanes=0,Od(e,i,c,i.pendingProps);case 24:rs(i,ea,e.memoizedState.cache)}return Pi(e,i,c)}function ps(e,i,c){if(e!==null)if(e.memoizedProps!==i.pendingProps)ia=!0;else{if(!Ga(e,c)&&(i.flags&128)===0)return ia=!1,Uc(e,i,c);ia=(e.flags&131072)!==0}else ia=!1,qe&&(i.flags&1048576)!==0&&sc(i,zo,i.index);switch(i.lanes=0,i.tag){case 16:t:{var h=i.pendingProps;if(e=Mr(i.elementType),i.type=e,typeof e=="function")ac(e)?(h=or(e,h),i.tag=1,i=gs(null,i,e,h,c)):(i.tag=0,i=Za(null,i,e,h,c));else{if(e!=null){var b=e.$$typeof;if(b===P){i.tag=11,i=Ko(null,i,e,h,c);break t}else if(b===T){i.tag=14,i=Ja(null,i,e,h,c);break t}}throw i=X(e)||e,Error(a(306,i,""))}}return i;case 0:return Za(e,i,i.type,i.pendingProps,c);case 1:return h=i.type,b=or(h,i.pendingProps),gs(e,i,h,b,c);case 3:t:{if(ht(i,i.stateNode.containerInfo),e===null)throw Error(a(387));h=i.pendingProps;var w=i.memoizedState;b=w.element,id(e,i),cs(i,h,null,c);var q=i.memoizedState;if(h=q.cache,rs(i,ea,h),h!==w.cache&&ed(i,[ea],c,!0),ko(),h=q.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:q.cache},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){i=lr(e,i,h,c);break t}else if(h!==b){b=li(Error(a(424)),i),Lo(b),i=lr(e,i,h,c);break t}else{switch(e=i.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Tn=mr(e.firstChild),ba=i,qe=!0,ui=null,za=!0,c=Qh(i,null,h,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(is(),h===b){i=Pi(e,i,c);break t}_a(e,i,h,c)}i=i.child}return i;case 26:return Zs(e,i),e===null?(c=qv(i.type,null,i.pendingProps,null))?i.memoizedState=c:qe||(c=i.type,e=i.pendingProps,h=D0(tt.current).createElement(c),h[Oe]=i,h[ie]=e,qa(h,c,e),Kn(h),i.stateNode=h):i.memoizedState=qv(i.type,e.memoizedProps,i.pendingProps,e.memoizedState),null;case 27:return jt(i),e===null&&qe&&(h=i.stateNode=Hv(i.type,i.pendingProps,tt.current),ba=i,za=!0,b=Tn,el(i.type)?(up=b,Tn=mr(h.firstChild)):Tn=b),_a(e,i,i.pendingProps.children,c),Zs(e,i),e===null&&(i.flags|=4194304),i.child;case 5:return e===null&&qe&&((b=h=Tn)&&(h=Xb(h,i.type,i.pendingProps,za),h!==null?(i.stateNode=h,ba=i,Tn=mr(h.firstChild),za=!1,b=!0):b=!1),b||wr(i)),jt(i),b=i.type,w=i.pendingProps,q=e!==null?e.memoizedProps:null,h=w.children,ip(b,w)?h=null:q!==null&&ip(b,q)&&(i.flags|=32),i.memoizedState!==null&&(b=Ks(e,i,kg,null,null,c),kd._currentValue=b),Zs(e,i),_a(e,i,h,c),i.child;case 6:return e===null&&qe&&((e=c=Tn)&&(c=Fb(c,i.pendingProps,za),c!==null?(i.stateNode=c,ba=i,Tn=null,e=!0):e=!1),e||wr(i)),null;case 13:return zr(e,i,c);case 4:return ht(i,i.stateNode.containerInfo),h=i.pendingProps,e===null?i.child=qs(i,null,h,c):_a(e,i,h,c),i.child;case 11:return Ko(e,i,i.type,i.pendingProps,c);case 7:return _a(e,i,i.pendingProps,c),i.child;case 8:return _a(e,i,i.pendingProps.children,c),i.child;case 12:return _a(e,i,i.pendingProps.children,c),i.child;case 10:return h=i.pendingProps,rs(i,i.type,h.value),_a(e,i,h.children,c),i.child;case 9:return b=i.type._context,h=i.pendingProps.children,Rr(i),b=Nn(b),h=h(b),i.flags|=1,_a(e,i,h,c),i.child;case 14:return Ja(e,i,i.type,i.pendingProps,c);case 15:return Dc(e,i,i.type,i.pendingProps,c);case 19:return Li(e,i,c);case 31:return jc(e,i,c);case 22:return Od(e,i,c,i.pendingProps);case 24:return Rr(i),h=Nn(ea),e===null?(b=Io(),b===null&&(b=Le,w=cc(),b.pooledCache=w,w.refCount++,w!==null&&(b.pooledCacheLanes|=c),b=w),i.memoizedState={parent:h,cache:b},Vs(i),rs(i,ea,b)):((e.lanes&c)!==0&&(id(e,i),cs(i,null,null,c),ko()),b=e.memoizedState,w=i.memoizedState,b.parent!==h?(b={parent:h,cache:h},i.memoizedState=b,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=b),rs(i,ea,h)):(h=w.cache,rs(i,ea,h),h!==b.cache&&ed(i,[ea],c,!0))),_a(e,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Ea(e){e.flags|=4}function Md(e,i,c,h,b){if((i=(e.mode&32)!==0)&&(i=!1),i){if(e.flags|=16777216,(b&335544128)===b)if(e.stateNode.complete)e.flags|=8192;else if(s())e.flags|=8192;else throw Nr=Kl,Yl}else e.flags&=-16777217}function A0(e,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Xv(i))if(s())e.flags|=8192;else throw Nr=Kl,Yl}function Bc(e,i){i!==null&&(e.flags|=4),e.flags&16384&&(i=e.tag!==22?Ts():536870912,e.lanes|=i,Ge|=i)}function An(e,i){if(!qe)switch(e.tailMode){case"hidden":i=e.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?e.tail=null:c.sibling=null;break;case"collapsed":c=e.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function bn(e){var i=e.alternate!==null&&e.alternate.child===e.child,c=0,h=0;if(i)for(var b=e.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags&65011712,h|=b.flags&65011712,b.return=e,b=b.sibling;else for(b=e.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags,h|=b.flags,b.return=e,b=b.sibling;return e.subtreeFlags|=h,e.childLanes=c,i}function Xo(e,i,c){var h=i.pendingProps;switch(Zf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(i),null;case 1:return bn(i),null;case 3:return c=i.stateNode,h=null,e!==null&&(h=e.memoizedState.cache),i.memoizedState.cache!==h&&(i.flags|=2048),$i(ea),wt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(Bs(i)?Ea(i):e===null||e.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,zs())),bn(i),null;case 26:var b=i.type,w=i.memoizedState;return e===null?(Ea(i),w!==null?(bn(i),A0(i,w)):(bn(i),Md(i,b,null,h,c))):w?w!==e.memoizedState?(Ea(i),bn(i),A0(i,w)):(bn(i),i.flags&=-16777217):(e=e.memoizedProps,e!==h&&Ea(i),bn(i),Md(i,b,e,h,c)),null;case 27:if(kt(i),c=tt.current,b=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==h&&Ea(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return bn(i),null}e=V.current,Bs(i)?Wf(i):(e=Hv(b,h,c),i.stateNode=e,Ea(i))}return bn(i),null;case 5:if(kt(i),b=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==h&&Ea(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return bn(i),null}if(w=V.current,Bs(i))Wf(i);else{var q=D0(tt.current);switch(w){case 1:w=q.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:w=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":w=q.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":w=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":w=q.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof h.is=="string"?q.createElement("select",{is:h.is}):q.createElement("select"),h.multiple?w.multiple=!0:h.size&&(w.size=h.size);break;default:w=typeof h.is=="string"?q.createElement(b,{is:h.is}):q.createElement(b)}}w[Oe]=i,w[ie]=h;t:for(q=i.child;q!==null;){if(q.tag===5||q.tag===6)w.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===i)break t;for(;q.sibling===null;){if(q.return===null||q.return===i)break t;q=q.return}q.sibling.return=q.return,q=q.sibling}i.stateNode=w;t:switch(qa(w,b,h),b){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&Ea(i)}}return bn(i),Md(i,i.type,e===null?null:e.memoizedProps,i.pendingProps,c),null;case 6:if(e&&i.stateNode!=null)e.memoizedProps!==h&&Ea(i);else{if(typeof h!="string"&&i.stateNode===null)throw Error(a(166));if(e=tt.current,Bs(i)){if(e=i.stateNode,c=i.memoizedProps,h=null,b=ba,b!==null)switch(b.tag){case 27:case 5:h=b.memoizedProps}e[Oe]=i,e=!!(e.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||xv(e.nodeValue,c)),e||wr(i,!0)}else e=D0(e).createTextNode(h),e[Oe]=i,i.stateNode=e}return bn(i),null;case 31:if(c=i.memoizedState,e===null||e.memoizedState!==null){if(h=Bs(i),c!==null){if(e===null){if(!h)throw Error(a(318));if(e=i.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(557));e[Oe]=i}else is(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;bn(i),e=!1}else c=zs(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),e=!0;if(!e)return i.flags&256?(fi(i),i):(fi(i),null);if((i.flags&128)!==0)throw Error(a(558))}return bn(i),null;case 13:if(h=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(b=Bs(i),h!==null&&h.dehydrated!==null){if(e===null){if(!b)throw Error(a(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(a(317));b[Oe]=i}else is(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;bn(i),b=!1}else b=zs(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=b),b=!0;if(!b)return i.flags&256?(fi(i),i):(fi(i),null)}return fi(i),(i.flags&128)!==0?(i.lanes=c,i):(c=h!==null,e=e!==null&&e.memoizedState!==null,c&&(h=i.child,b=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(b=h.alternate.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==b&&(h.flags|=2048)),c!==e&&c&&(i.child.flags|=8192),Bc(i,i.updateQueue),bn(i),null);case 4:return wt(),e===null&&$g(i.stateNode.containerInfo),bn(i),null;case 10:return $i(i.type),bn(i),null;case 19:if(at(Qn),h=i.memoizedState,h===null)return bn(i),null;if(b=(i.flags&128)!==0,w=h.rendering,w===null)if(b)An(h,!1);else{if(wn!==0||e!==null&&(e.flags&128)!==0)for(e=i.child;e!==null;){if(w=mc(e),w!==null){for(i.flags|=128,An(h,!1),e=w.updateQueue,i.updateQueue=e,Bc(i,e),i.subtreeFlags=0,e=c,c=i.child;c!==null;)ic(c,e),c=c.sibling;return rt(Qn,Qn.current&1|2),qe&&Wi(i,h.treeForkCount),i.child}e=e.sibling}h.tail!==null&&Ce()>Ri&&(i.flags|=128,b=!0,An(h,!1),i.lanes=4194304)}else{if(!b)if(e=mc(w),e!==null){if(i.flags|=128,b=!0,e=e.updateQueue,i.updateQueue=e,Bc(i,e),An(h,!0),h.tail===null&&h.tailMode==="hidden"&&!w.alternate&&!qe)return bn(i),null}else 2*Ce()-h.renderingStartTime>Ri&&c!==536870912&&(i.flags|=128,b=!0,An(h,!1),i.lanes=4194304);h.isBackwards?(w.sibling=i.child,i.child=w):(e=h.last,e!==null?e.sibling=w:i.child=w,h.last=w)}return h.tail!==null?(e=h.tail,h.rendering=e,h.tail=e.sibling,h.renderingStartTime=Ce(),e.sibling=null,c=Qn.current,rt(Qn,b?c&1|2:c&1),qe&&Wi(i,h.treeForkCount),e):(bn(i),null);case 22:case 23:return fi(i),nr(),h=i.memoizedState!==null,e!==null?e.memoizedState!==null!==h&&(i.flags|=8192):h&&(i.flags|=8192),h?(c&536870912)!==0&&(i.flags&128)===0&&(bn(i),i.subtreeFlags&6&&(i.flags|=8192)):bn(i),c=i.updateQueue,c!==null&&Bc(i,c.retryQueue),c=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==c&&(i.flags|=2048),e!==null&&at(Gs),null;case 24:return c=null,e!==null&&(c=e.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),$i(ea),bn(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function Nd(e,i){switch(Zf(i),i.tag){case 1:return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return $i(ea),wt(),e=i.flags,(e&65536)!==0&&(e&128)===0?(i.flags=e&-65537|128,i):null;case 26:case 27:case 5:return kt(i),null;case 31:if(i.memoizedState!==null){if(fi(i),i.alternate===null)throw Error(a(340));is()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 13:if(fi(i),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(a(340));is()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return at(Qn),null;case 4:return wt(),null;case 10:return $i(i.type),null;case 22:case 23:return fi(i),nr(),e!==null&&at(Gs),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 24:return $i(ea),null;case 25:return null;default:return null}}function ru(e,i){switch(Zf(i),i.tag){case 3:$i(ea),wt();break;case 26:case 27:case 5:kt(i);break;case 4:wt();break;case 31:i.memoizedState!==null&&fi(i);break;case 13:fi(i);break;case 19:at(Qn);break;case 10:$i(i.type);break;case 22:case 23:fi(i),nr(),e!==null&&at(Gs);break;case 24:$i(ea)}}function $s(e,i){try{var c=i.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var b=h.next;c=b;do{if((c.tag&e)===e){h=void 0;var w=c.create,q=c.inst;h=w(),q.destroy=h}c=c.next}while(c!==b)}}catch($){Xt(i,i.return,$)}}function pi(e,i,c){try{var h=i.updateQueue,b=h!==null?h.lastEffect:null;if(b!==null){var w=b.next;h=w;do{if((h.tag&e)===e){var q=h.inst,$=q.destroy;if($!==void 0){q.destroy=void 0,b=i;var ut=c,St=$;try{St()}catch(xt){Xt(b,ut,xt)}}}h=h.next}while(h!==w)}}catch(xt){Xt(i,i.return,xt)}}function Fo(e){var i=e.updateQueue;if(i!==null){var c=e.stateNode;try{Xh(i,c)}catch(h){Xt(e,e.return,h)}}}function zc(e,i,c){c.props=or(e.type,e.memoizedProps),c.state=e.memoizedState;try{c.componentWillUnmount()}catch(h){Xt(e,i,h)}}function ur(e,i){try{var c=e.ref;if(c!==null){switch(e.tag){case 26:case 27:case 5:var h=e.stateNode;break;case 30:h=e.stateNode;break;default:h=e.stateNode}typeof c=="function"?e.refCleanup=c(h):c.current=h}}catch(b){Xt(e,i,b)}}function Ha(e,i){var c=e.ref,h=e.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(b){Xt(e,i,b)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(b){Xt(e,i,b)}else c.current=null}function Dd(e){var i=e.type,c=e.memoizedProps,h=e.stateNode;try{t:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break t;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(b){Xt(e,e.return,b)}}function Pr(e,i,c){try{var h=e.stateNode;kb(h,e.type,c,i),h[ie]=i}catch(b){Xt(e,e.return,b)}}function w0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&el(e.type)||e.tag===4}function to(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||w0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&el(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function su(e,i,c){var h=e.tag;if(h===5||h===6)e=e.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(e,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(e),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Ya));else if(h!==4&&(h===27&&el(e.type)&&(c=e.stateNode,i=null),e=e.child,e!==null))for(su(e,i,c),e=e.sibling;e!==null;)su(e,i,c),e=e.sibling}function eo(e,i,c){var h=e.tag;if(h===5||h===6)e=e.stateNode,i?c.insertBefore(e,i):c.appendChild(e);else if(h!==4&&(h===27&&el(e.type)&&(c=e.stateNode),e=e.child,e!==null))for(eo(e,i,c),e=e.sibling;e!==null;)eo(e,i,c),e=e.sibling}function ou(e){var i=e.stateNode,c=e.memoizedProps;try{for(var h=e.type,b=i.attributes;b.length;)i.removeAttributeNode(b[0]);qa(i,h,c),i[Oe]=e,i[ie]=c}catch(w){Xt(e,e.return,w)}}var Wa=!1,cn=!1,ms=!1,Lc=typeof WeakSet=="function"?WeakSet:Set,Dn=null;function jd(e,i){if(e=e.containerInfo,np=G0,e=xi(e),tc(e)){if("selectionStart"in e)var c={start:e.selectionStart,end:e.selectionEnd};else t:{c=(c=e.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var b=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break t}var q=0,$=-1,ut=-1,St=0,xt=0,Dt=e,Et=null;e:for(;;){for(var At;Dt!==c||b!==0&&Dt.nodeType!==3||($=q+b),Dt!==w||h!==0&&Dt.nodeType!==3||(ut=q+h),Dt.nodeType===3&&(q+=Dt.nodeValue.length),(At=Dt.firstChild)!==null;)Et=Dt,Dt=At;for(;;){if(Dt===e)break e;if(Et===c&&++St===b&&($=q),Et===w&&++xt===h&&(ut=q),(At=Dt.nextSibling)!==null)break;Dt=Et,Et=Dt.parentNode}Dt=At}c=$===-1||ut===-1?null:{start:$,end:ut}}else c=null}c=c||{start:0,end:0}}else c=null;for(ap={focusedElem:e,selectionRange:c},G0=!1,Dn=i;Dn!==null;)if(i=Dn,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,Dn=e;else for(;Dn!==null;){switch(i=Dn,w=i.alternate,e=i.flags,i.tag){case 0:if((e&4)!==0&&(e=i.updateQueue,e=e!==null?e.events:null,e!==null))for(c=0;c<e.length;c++)b=e[c],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&w!==null){e=void 0,c=i,b=w.memoizedProps,w=w.memoizedState,h=c.stateNode;try{var ne=or(c.type,b);e=h.getSnapshotBeforeUpdate(ne,w),h.__reactInternalSnapshotBeforeUpdate=e}catch(ve){Xt(c,c.return,ve)}}break;case 3:if((e&1024)!==0){if(e=i.stateNode.containerInfo,c=e.nodeType,c===9)sp(e);else if(c===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":sp(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=i.sibling,e!==null){e.return=i.return,Dn=e;break}Dn=i.return}}function no(e,i,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:cr(e,c),h&4&&$s(5,c);break;case 1:if(cr(e,c),h&4)if(e=c.stateNode,i===null)try{e.componentDidMount()}catch(q){Xt(c,c.return,q)}else{var b=or(c.type,i.memoizedProps);i=i.memoizedState;try{e.componentDidUpdate(b,i,e.__reactInternalSnapshotBeforeUpdate)}catch(q){Xt(c,c.return,q)}}h&64&&Fo(c),h&512&&ur(c,c.return);break;case 3:if(cr(e,c),h&64&&(e=c.updateQueue,e!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Xh(e,i)}catch(q){Xt(c,c.return,q)}}break;case 27:i===null&&h&4&&ou(c);case 26:case 5:cr(e,c),i===null&&h&4&&Dd(c),h&512&&ur(c,c.return);break;case 12:cr(e,c);break;case 31:cr(e,c),h&4&&uu(e,c);break;case 13:cr(e,c),h&4&&ao(e,c),h&64&&(e=c.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(c=ha.bind(null,c),Jb(e,c))));break;case 22:if(h=c.memoizedState!==null||Wa,!h){i=i!==null&&i.memoizedState!==null||cn,b=Wa;var w=cn;Wa=h,(cn=i)&&!w?$a(e,c,(c.subtreeFlags&8772)!==0):cr(e,c),Wa=b,cn=w}break;case 30:break;default:cr(e,c)}}function lu(e){var i=e.alternate;i!==null&&(e.alternate=null,lu(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&ye(i)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var fn=null,fe=!1;function Ve(e,i,c){for(c=c.child;c!==null;)Zn(e,i,c),c=c.sibling}function Zn(e,i,c){if(vt&&typeof vt.onCommitFiberUnmount=="function")try{vt.onCommitFiberUnmount(Bt,c)}catch{}switch(c.tag){case 26:cn||Ha(c,i),Ve(e,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:cn||Ha(c,i);var h=fn,b=fe;el(c.type)&&(fn=c.stateNode,fe=!1),Ve(e,i,c),Gd(c.stateNode),fn=h,fe=b;break;case 5:cn||Ha(c,i);case 6:if(h=fn,b=fe,fn=null,Ve(e,i,c),fn=h,fe=b,fn!==null)if(fe)try{(fn.nodeType===9?fn.body:fn.nodeName==="HTML"?fn.ownerDocument.body:fn).removeChild(c.stateNode)}catch(w){Xt(c,i,w)}else try{fn.removeChild(c.stateNode)}catch(w){Xt(c,i,w)}break;case 18:fn!==null&&(fe?(e=fn,Bv(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,c.stateNode),Xc(e)):Bv(fn,c.stateNode));break;case 4:h=fn,b=fe,fn=c.stateNode.containerInfo,fe=!0,Ve(e,i,c),fn=h,fe=b;break;case 0:case 11:case 14:case 15:pi(2,c,i),cn||pi(4,c,i),Ve(e,i,c);break;case 1:cn||(Ha(c,i),h=c.stateNode,typeof h.componentWillUnmount=="function"&&zc(c,i,h)),Ve(e,i,c);break;case 21:Ve(e,i,c);break;case 22:cn=(h=cn)||c.memoizedState!==null,Ve(e,i,c),cn=h;break;default:Ve(e,i,c)}}function uu(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Xc(e)}catch(c){Xt(i,i.return,c)}}}function ao(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Xc(e)}catch(c){Xt(i,i.return,c)}}function io(e){switch(e.tag){case 31:case 13:case 19:var i=e.stateNode;return i===null&&(i=e.stateNode=new Lc),i;case 22:return e=e.stateNode,i=e._retryCache,i===null&&(i=e._retryCache=new Lc),i;default:throw Error(a(435,e.tag))}}function ro(e,i){var c=io(e);i.forEach(function(h){if(!c.has(h)){c.add(h);var b=an.bind(null,e,h);h.then(b,b)}})}function fa(e,i){var c=i.deletions;if(c!==null)for(var h=0;h<c.length;h++){var b=c[h],w=e,q=i,$=q;t:for(;$!==null;){switch($.tag){case 27:if(el($.type)){fn=$.stateNode,fe=!1;break t}break;case 5:fn=$.stateNode,fe=!1;break t;case 3:case 4:fn=$.stateNode.containerInfo,fe=!0;break t}$=$.return}if(fn===null)throw Error(a(160));Zn(w,q,b),fn=null,fe=!1,w=b.alternate,w!==null&&(w.return=null),b.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)R0(i,e),i=i.sibling}var xa=null;function R0(e,i){var c=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:fa(i,e),Ca(e),h&4&&(pi(3,e,e.return),$s(3,e),pi(5,e,e.return));break;case 1:fa(i,e),Ca(e),h&512&&(cn||c===null||Ha(c,c.return)),h&64&&Wa&&(e=e.updateQueue,e!==null&&(h=e.callbacks,h!==null&&(c=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var b=xa;if(fa(i,e),Ca(e),h&512&&(cn||c===null||Ha(c,c.return)),h&4){var w=c!==null?c.memoizedState:null;if(h=e.memoizedState,c===null)if(h===null)if(e.stateNode===null){t:{h=e.type,c=e.memoizedProps,b=b.ownerDocument||b;e:switch(h){case"title":w=b.getElementsByTagName("title")[0],(!w||w[Ue]||w[Oe]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=b.createElement(h),b.head.insertBefore(w,b.querySelector("head > title"))),qa(w,h,c),w[Oe]=e,Kn(w),h=w;break t;case"link":var q=Kv("link","href",b).get(h+(c.href||""));if(q){for(var $=0;$<q.length;$++)if(w=q[$],w.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&w.getAttribute("rel")===(c.rel==null?null:c.rel)&&w.getAttribute("title")===(c.title==null?null:c.title)&&w.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){q.splice($,1);break e}}w=b.createElement(h),qa(w,h,c),b.head.appendChild(w);break;case"meta":if(q=Kv("meta","content",b).get(h+(c.content||""))){for($=0;$<q.length;$++)if(w=q[$],w.getAttribute("content")===(c.content==null?null:""+c.content)&&w.getAttribute("name")===(c.name==null?null:c.name)&&w.getAttribute("property")===(c.property==null?null:c.property)&&w.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&w.getAttribute("charset")===(c.charSet==null?null:c.charSet)){q.splice($,1);break e}}w=b.createElement(h),qa(w,h,c),b.head.appendChild(w);break;default:throw Error(a(468,h))}w[Oe]=e,Kn(w),h=w}e.stateNode=h}else Qv(b,e.type,e.stateNode);else e.stateNode=Yv(b,h,e.memoizedProps);else w!==h?(w===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):w.count--,h===null?Qv(b,e.type,e.stateNode):Yv(b,h,e.memoizedProps)):h===null&&e.stateNode!==null&&Pr(e,e.memoizedProps,c.memoizedProps)}break;case 27:fa(i,e),Ca(e),h&512&&(cn||c===null||Ha(c,c.return)),c!==null&&h&4&&Pr(e,e.memoizedProps,c.memoizedProps);break;case 5:if(fa(i,e),Ca(e),h&512&&(cn||c===null||Ha(c,c.return)),e.flags&32){b=e.stateNode;try{Fr(b,"")}catch(ne){Xt(e,e.return,ne)}}h&4&&e.stateNode!=null&&(b=e.memoizedProps,Pr(e,b,c!==null?c.memoizedProps:b)),h&1024&&(ms=!0);break;case 6:if(fa(i,e),Ca(e),h&4){if(e.stateNode===null)throw Error(a(162));h=e.memoizedProps,c=e.stateNode;try{c.nodeValue=h}catch(ne){Xt(e,e.return,ne)}}break;case 3:if(B0=null,b=xa,xa=j0(i.containerInfo),fa(i,e),xa=b,Ca(e),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Xc(i.containerInfo)}catch(ne){Xt(e,e.return,ne)}ms&&(ms=!1,Ud(e));break;case 4:h=xa,xa=j0(e.stateNode.containerInfo),fa(i,e),Ca(e),xa=h;break;case 12:fa(i,e),Ca(e);break;case 31:fa(i,e),Ca(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,ro(e,h)));break;case 13:fa(i,e),Ca(e),e.child.flags&8192&&e.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Hr=Ce()),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,ro(e,h)));break;case 22:b=e.memoizedState!==null;var ut=c!==null&&c.memoizedState!==null,St=Wa,xt=cn;if(Wa=St||b,cn=xt||ut,fa(i,e),cn=xt,Wa=St,Ca(e),h&8192)t:for(i=e.stateNode,i._visibility=b?i._visibility&-2:i._visibility|1,b&&(c===null||ut||Wa||cn||so(e)),c=null,i=e;;){if(i.tag===5||i.tag===26){if(c===null){ut=c=i;try{if(w=ut.stateNode,b)q=w.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{$=ut.stateNode;var Dt=ut.memoizedProps.style,Et=Dt!=null&&Dt.hasOwnProperty("display")?Dt.display:null;$.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(ne){Xt(ut,ut.return,ne)}}}else if(i.tag===6){if(c===null){ut=i;try{ut.stateNode.nodeValue=b?"":ut.memoizedProps}catch(ne){Xt(ut,ut.return,ne)}}}else if(i.tag===18){if(c===null){ut=i;try{var At=ut.stateNode;b?zv(At,!0):zv(ut.stateNode,!1)}catch(ne){Xt(ut,ut.return,ne)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break t;for(;i.sibling===null;){if(i.return===null||i.return===e)break t;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}h&4&&(h=e.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,ro(e,c))));break;case 19:fa(i,e),Ca(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,ro(e,h)));break;case 30:break;case 21:break;default:fa(i,e),Ca(e)}}function Ca(e){var i=e.flags;if(i&2){try{for(var c,h=e.return;h!==null;){if(w0(h)){c=h;break}h=h.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var b=c.stateNode,w=to(e);eo(e,w,b);break;case 5:var q=c.stateNode;c.flags&32&&(Fr(q,""),c.flags&=-33);var $=to(e);eo(e,$,q);break;case 3:case 4:var ut=c.stateNode.containerInfo,St=to(e);su(e,St,ut);break;default:throw Error(a(161))}}catch(xt){Xt(e,e.return,xt)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function Ud(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var i=e;Ud(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),e=e.sibling}}function cr(e,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)no(e,i.alternate,i),i=i.sibling}function so(e){for(e=e.child;e!==null;){var i=e;switch(i.tag){case 0:case 11:case 14:case 15:pi(4,i,i.return),so(i);break;case 1:Ha(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&zc(i,i.return,c),so(i);break;case 27:Gd(i.stateNode);case 26:case 5:Ha(i,i.return),so(i);break;case 22:i.memoizedState===null&&so(i);break;case 30:so(i);break;default:so(i)}e=e.sibling}}function $a(e,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var h=i.alternate,b=e,w=i,q=w.flags;switch(w.tag){case 0:case 11:case 15:$a(b,w,c),$s(4,w);break;case 1:if($a(b,w,c),h=w,b=h.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(St){Xt(h,h.return,St)}if(h=w,b=h.updateQueue,b!==null){var $=h.stateNode;try{var ut=b.shared.hiddenCallbacks;if(ut!==null)for(b.shared.hiddenCallbacks=null,b=0;b<ut.length;b++)sd(ut[b],$)}catch(St){Xt(h,h.return,St)}}c&&q&64&&Fo(w),ur(w,w.return);break;case 27:ou(w);case 26:case 5:$a(b,w,c),c&&h===null&&q&4&&Dd(w),ur(w,w.return);break;case 12:$a(b,w,c);break;case 31:$a(b,w,c),c&&q&4&&uu(b,w);break;case 13:$a(b,w,c),c&&q&4&&ao(b,w);break;case 22:w.memoizedState===null&&$a(b,w,c),ur(w,w.return);break;case 30:break;default:$a(b,w,c)}i=i.sibling}}function oo(e,i){var c=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),e=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(e=i.memoizedState.cachePool.pool),e!==c&&(e!=null&&e.refCount++,c!=null&&Go(c))}function vs(e,i){e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&Go(e))}function Ai(e,i,c,h){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)mi(e,i,c,h),i=i.sibling}function mi(e,i,c,h){var b=i.flags;switch(i.tag){case 0:case 11:case 15:Ai(e,i,c,h),b&2048&&$s(9,i);break;case 1:Ai(e,i,c,h);break;case 3:Ai(e,i,c,h),b&2048&&(e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&Go(e)));break;case 12:if(b&2048){Ai(e,i,c,h),e=i.stateNode;try{var w=i.memoizedProps,q=w.id,$=w.onPostCommit;typeof $=="function"&&$(q,i.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(ut){Xt(i,i.return,ut)}}else Ai(e,i,c,h);break;case 31:Ai(e,i,c,h);break;case 13:Ai(e,i,c,h);break;case 23:break;case 22:w=i.stateNode,q=i.alternate,i.memoizedState!==null?w._visibility&2?Ai(e,i,c,h):kn(e,i):w._visibility&2?Ai(e,i,c,h):(w._visibility|=2,Ia(e,i,c,h,(i.subtreeFlags&10256)!==0||!1)),b&2048&&oo(q,i);break;case 24:Ai(e,i,c,h),b&2048&&vs(i.alternate,i);break;default:Ai(e,i,c,h)}}function Ia(e,i,c,h,b){for(b=b&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var w=e,q=i,$=c,ut=h,St=q.flags;switch(q.tag){case 0:case 11:case 15:Ia(w,q,$,ut,b),$s(8,q);break;case 23:break;case 22:var xt=q.stateNode;q.memoizedState!==null?xt._visibility&2?Ia(w,q,$,ut,b):kn(w,q):(xt._visibility|=2,Ia(w,q,$,ut,b)),b&&St&2048&&oo(q.alternate,q);break;case 24:Ia(w,q,$,ut,b),b&&St&2048&&vs(q.alternate,q);break;default:Ia(w,q,$,ut,b)}i=i.sibling}}function kn(e,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=e,h=i,b=h.flags;switch(h.tag){case 22:kn(c,h),b&2048&&oo(h.alternate,h);break;case 24:kn(c,h),b&2048&&vs(h.alternate,h);break;default:kn(c,h)}i=i.sibling}}var lo=8192;function uo(e,i,c){if(e.subtreeFlags&lo)for(e=e.child;e!==null;)Bd(e,i,c),e=e.sibling}function Bd(e,i,c){switch(e.tag){case 26:uo(e,i,c),e.flags&lo&&e.memoizedState!==null&&l4(c,xa,e.memoizedState,e.memoizedProps);break;case 5:uo(e,i,c);break;case 3:case 4:var h=xa;xa=j0(e.stateNode.containerInfo),uo(e,i,c),xa=h;break;case 22:e.memoizedState===null&&(h=e.alternate,h!==null&&h.memoizedState!==null?(h=lo,lo=16777216,uo(e,i,c),lo=h):uo(e,i,c));break;default:uo(e,i,c)}}function la(e){var i=e.alternate;if(i!==null&&(e=i.child,e!==null)){i.child=null;do i=e.sibling,e.sibling=null,e=i;while(e!==null)}}function co(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var h=i[c];Dn=h,Pc(h,e)}la(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)fr(e),e=e.sibling}function fr(e){switch(e.tag){case 0:case 11:case 15:co(e),e.flags&2048&&pi(9,e,e.return);break;case 3:co(e);break;case 12:co(e);break;case 22:var i=e.stateNode;e.memoizedState!==null&&i._visibility&2&&(e.return===null||e.return.tag!==13)?(i._visibility&=-3,Ln(e)):co(e);break;default:co(e)}}function Ln(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var h=i[c];Dn=h,Pc(h,e)}la(e)}for(e=e.child;e!==null;){switch(i=e,i.tag){case 0:case 11:case 15:pi(8,i,i.return),Ln(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,Ln(i));break;default:Ln(i)}e=e.sibling}}function Pc(e,i){for(;Dn!==null;){var c=Dn;switch(c.tag){case 0:case 11:case 15:pi(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Go(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,Dn=h;else t:for(c=e;Dn!==null;){h=Dn;var b=h.sibling,w=h.return;if(lu(h),h===c){Dn=null;break t}if(b!==null){b.return=w,Dn=b;break t}Dn=w}}}var O0={getCacheForType:function(e){var i=Nn(ea),c=i.data.get(e);return c===void 0&&(c=e(),i.data.set(e,c)),c},cacheSignal:function(){return Nn(ea).controller.signal}},da=typeof WeakMap=="function"?WeakMap:Map,de=0,Le=null,Ee=null,Be=0,yn=0,Ma=null,Gi=!1,Gr=!1,Jo=!1,wi=0,wn=0,ys=0,ze=0,_n=0,me=0,Ge=0,We=null,Rn=null,dr=!1,Hr=0,Gc=0,Ri=1/0,jn=null,ka=null,Un=0,hr=null,Ta=null,ti=0,fo=0,Na=null,Hc=null,ho=0,go=null;function Da(){return(de&2)!==0&&Be!==0?Be&-Be:j.T!==null?Fg():It()}function Ir(){if(me===0)if((Be&536870912)===0||qe){var e=Ie;Ie<<=1,(Ie&3932160)===0&&(Ie=262144),me=e}else me=536870912;return e=zn.current,e!==null&&(e.flags|=32),me}function hn(e,i,c){(e===Le&&(yn===2||yn===9)||e.cancelPendingCommit!==null)&&(pr(e,0),gr(e,Be,me,!1)),Yi(e,c),((de&2)===0||e!==Le)&&(e===Le&&((de&2)===0&&(ze|=c),wn===4&&gr(e,Be,me,!1)),_s(e))}function kr(e,i,c){if((de&6)!==0)throw Error(a(327));var h=!c&&(i&127)===0&&(i&e.expiredLanes)===0||Mn(e,i),b=h?et(e,i):x(e,i,!0),w=h;do{if(b===0){Gr&&!h&&gr(e,i,0,!1);break}else{if(c=e.current.alternate,w&&!Zo(c)){b=x(e,i,!1),w=!1;continue}if(b===2){if(w=i,e.errorRecoveryDisabledLanes&w)var q=0;else q=e.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){i=q;t:{var $=e;b=We;var ut=$.current.memoizedState.isDehydrated;if(ut&&(pr($,q).flags|=256),q=x($,q,!1),q!==2){if(Jo&&!ut){$.errorRecoveryDisabledLanes|=w,ze|=w,b=4;break t}w=Rn,Rn=b,w!==null&&(Rn===null?Rn=w:Rn.push.apply(Rn,w))}b=q}if(w=!1,b!==2)continue}}if(b===1){pr(e,0),gr(e,i,0,!0);break}t:{switch(h=e,w=b,w){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:gr(h,i,me,!Gi);break t;case 2:Rn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(b=Hr+300-Ce(),10<b)){if(gr(h,i,me,!Gi),dn(h,0,!0)!==0)break t;ti=i,h.timeoutHandle=jv(po.bind(null,h,c,Rn,jn,dr,i,me,ze,Ge,Gi,w,"Throttled",-0,0),b);break t}po(h,c,Rn,jn,dr,i,me,ze,Ge,Gi,w,null,-0,0)}}break}while(!0);_s(e)}function po(e,i,c,h,b,w,q,$,ut,St,xt,Dt,Et,At){if(e.timeoutHandle=-1,Dt=i.subtreeFlags,Dt&8192||(Dt&16785408)===16785408){Dt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ya},Bd(i,w,Dt);var ne=(w&62914560)===w?Hr-Ce():(w&4194048)===w?Gc-Ce():0;if(ne=u4(Dt,ne),ne!==null){ti=w,e.cancelPendingCommit=ne(Me.bind(null,e,i,w,c,h,b,q,$,ut,xt,Dt,null,Et,At)),gr(e,w,q,!St);return}}Me(e,i,w,c,h,b,q,$,ut)}function Zo(e){for(var i=e;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var b=c[h],w=b.getSnapshot;b=b.value;try{if(!ma(w(),b))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function gr(e,i,c,h){i&=~_n,i&=~ze,e.suspendedLanes|=i,e.pingedLanes&=~i,h&&(e.warmLanes|=i),h=e.expirationTimes;for(var b=i;0<b;){var w=31-Yt(b),q=1<<w;h[w]=-1,b&=~q}c!==0&&Ki(e,c,i)}function Wo(){return(de&6)===0?(zd(0),!1):!0}function Ic(){if(Ee!==null){if(yn===0)var e=Ee.return;else e=Ee,Bi=Xe=null,cd(e),os=null,Ql=0,e=Ee;for(;e!==null;)ru(e.alternate,e),e=e.return;Ee=null}}function pr(e,i){var c=e.timeoutHandle;c!==-1&&(e.timeoutHandle=-1,Yb(c)),c=e.cancelPendingCommit,c!==null&&(e.cancelPendingCommit=null,c()),ti=0,Ic(),Le=e,Ee=c=Ni(e.current,null),Be=i,yn=0,Ma=null,Gi=!1,Gr=Mn(e,i),Jo=!1,Ge=me=_n=ze=ys=wn=0,Rn=We=null,dr=!1,(i&8)!==0&&(i|=i&32);var h=e.entangledLanes;if(h!==0)for(e=e.entanglements,h&=i;0<h;){var b=31-Yt(h),w=1<<b;i|=e[b],h&=~w}return wi=i,Gl(),c}function kc(e,i){xe=null,j.H=Yo,i===Is||i===hc?(i=pc(),yn=3):i===Yl?(i=pc(),yn=4):yn=i===Rd?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Ma=i,Ee===null&&(wn=1,Nc(e,li(i,e.current)))}function s(){var e=zn.current;return e===null?!0:(Be&4194048)===Be?Ci===null:(Be&62914560)===Be||(Be&536870912)!==0?e===Ci:!1}function u(){var e=j.H;return j.H=Yo,e===null?Yo:e}function p(){var e=j.A;return j.A=O0,e}function S(){wn=4,Gi||(Be&4194048)!==Be&&zn.current!==null||(Gr=!0),(ys&134217727)===0&&(ze&134217727)===0||Le===null||gr(Le,Be,me,!1)}function x(e,i,c){var h=de;de|=2;var b=u(),w=p();(Le!==e||Be!==i)&&(jn=null,pr(e,i)),i=!1;var q=wn;t:do try{if(yn!==0&&Ee!==null){var $=Ee,ut=Ma;switch(yn){case 8:Ic(),q=6;break t;case 3:case 2:case 9:case 6:zn.current===null&&(i=!0);var St=yn;if(yn=0,Ma=null,Gt(e,$,ut,St),c&&Gr){q=0;break t}break;default:St=yn,yn=0,Ma=null,Gt(e,$,ut,St)}}H(),q=wn;break}catch(xt){kc(e,xt)}while(!0);return i&&e.shellSuspendCounter++,Bi=Xe=null,de=h,j.H=b,j.A=w,Ee===null&&(Le=null,Be=0,Gl()),q}function H(){for(;Ee!==null;)_t(Ee)}function et(e,i){var c=de;de|=2;var h=u(),b=p();Le!==e||Be!==i?(jn=null,Ri=Ce()+500,pr(e,i)):Gr=Mn(e,i);t:do try{if(yn!==0&&Ee!==null){i=Ee;var w=Ma;e:switch(yn){case 1:yn=0,Ma=null,Gt(e,i,w,1);break;case 2:case 9:if(xr(w)){yn=0,Ma=null,zt(i);break}i=function(){yn!==2&&yn!==9||Le!==e||(yn=7),_s(e)},w.then(i,i);break t;case 3:yn=7;break t;case 4:yn=5;break t;case 7:xr(w)?(yn=0,Ma=null,zt(i)):(yn=0,Ma=null,Gt(e,i,w,7));break;case 5:var q=null;switch(Ee.tag){case 26:q=Ee.memoizedState;case 5:case 27:var $=Ee;if(q?Xv(q):$.stateNode.complete){yn=0,Ma=null;var ut=$.sibling;if(ut!==null)Ee=ut;else{var St=$.return;St!==null?(Ee=St,Wt(St)):Ee=null}break e}}yn=0,Ma=null,Gt(e,i,w,5);break;case 6:yn=0,Ma=null,Gt(e,i,w,6);break;case 8:Ic(),wn=6;break t;default:throw Error(a(462))}}ct();break}catch(xt){kc(e,xt)}while(!0);return Bi=Xe=null,j.H=h,j.A=b,de=c,Ee!==null?0:(Le=null,Be=0,Gl(),wn)}function ct(){for(;Ee!==null&&!Ot();)_t(Ee)}function _t(e){var i=ps(e.alternate,e,wi);e.memoizedProps=e.pendingProps,i===null?Wt(e):Ee=i}function zt(e){var i=e,c=i.alternate;switch(i.tag){case 15:case 0:i=gi(c,i,i.pendingProps,i.type,void 0,Be);break;case 11:i=gi(c,i,i.pendingProps,i.type.render,i.ref,Be);break;case 5:cd(i);default:ru(c,i),i=Ee=ic(i,wi),i=ps(c,i,wi)}e.memoizedProps=e.pendingProps,i===null?Wt(e):Ee=i}function Gt(e,i,c,h){Bi=Xe=null,cd(i),os=null,Ql=0;var b=i.return;try{if(wd(e,b,i,c,Be)){wn=1,Nc(e,li(c,e.current)),Ee=null;return}}catch(w){if(b!==null)throw Ee=b,w;wn=1,Nc(e,li(c,e.current)),Ee=null;return}i.flags&32768?(qe||h===1?e=!0:Gr||(Be&536870912)!==0?e=!1:(Gi=e=!0,(h===2||h===9||h===3||h===6)&&(h=zn.current,h!==null&&h.tag===13&&(h.flags|=16384))),te(i,e)):Wt(i)}function Wt(e){var i=e;do{if((i.flags&32768)!==0){te(i,Gi);return}e=i.return;var c=Xo(i.alternate,i,wi);if(c!==null){Ee=c;return}if(i=i.sibling,i!==null){Ee=i;return}Ee=i=e}while(i!==null);wn===0&&(wn=5)}function te(e,i){do{var c=Nd(e.alternate,e);if(c!==null){c.flags&=32767,Ee=c;return}if(c=e.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(e=e.sibling,e!==null)){Ee=e;return}Ee=e=c}while(e!==null);wn=6,Ee=null}function Me(e,i,c,h,b,w,q,$,ut){e.cancelPendingCommit=null;do gt();while(Un!==0);if((de&6)!==0)throw Error(a(327));if(i!==null){if(i===e.current)throw Error(a(177));if(w=i.lanes|i.childLanes,w|=Ei,Oi(e,c,w,q,$,ut),e===Le&&(Ee=Le=null,Be=0),Ta=i,hr=e,ti=c,fo=w,Na=b,Hc=h,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,bs(lt,function(){return Ct(),null})):(e.callbackNode=null,e.callbackPriority=0),h=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||h){h=j.T,j.T=null,b=I.p,I.p=2,q=de,de|=4;try{jd(e,i,c)}finally{de=q,I.p=b,j.T=h}}Un=1,vi(),$o(),Ss()}}function vi(){if(Un===1){Un=0;var e=hr,i=Ta,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=j.T,j.T=null;var h=I.p;I.p=2;var b=de;de|=4;try{R0(i,e);var w=ap,q=xi(e.containerInfo),$=w.focusedElem,ut=w.selectionRange;if(q!==$&&$&&$.ownerDocument&&No($.ownerDocument.documentElement,$)){if(ut!==null&&tc($)){var St=ut.start,xt=ut.end;if(xt===void 0&&(xt=St),"selectionStart"in $)$.selectionStart=St,$.selectionEnd=Math.min(xt,$.value.length);else{var Dt=$.ownerDocument||document,Et=Dt&&Dt.defaultView||window;if(Et.getSelection){var At=Et.getSelection(),ne=$.textContent.length,ve=Math.min(ut.start,ne),xn=ut.end===void 0?ve:Math.min(ut.end,ne);!At.extend&&ve>xn&&(q=xn,xn=ve,ve=q);var pt=qf($,ve),ft=qf($,xn);if(pt&&ft&&(At.rangeCount!==1||At.anchorNode!==pt.node||At.anchorOffset!==pt.offset||At.focusNode!==ft.node||At.focusOffset!==ft.offset)){var yt=Dt.createRange();yt.setStart(pt.node,pt.offset),At.removeAllRanges(),ve>xn?(At.addRange(yt),At.extend(ft.node,ft.offset)):(yt.setEnd(ft.node,ft.offset),At.addRange(yt))}}}}for(Dt=[],At=$;At=At.parentNode;)At.nodeType===1&&Dt.push({element:At,left:At.scrollLeft,top:At.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<Dt.length;$++){var Mt=Dt[$];Mt.element.scrollLeft=Mt.left,Mt.element.scrollTop=Mt.top}}G0=!!np,ap=np=null}finally{de=b,I.p=h,j.T=c}}e.current=i,Un=2}}function $o(){if(Un===2){Un=0;var e=hr,i=Ta,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=j.T,j.T=null;var h=I.p;I.p=2;var b=de;de|=4;try{no(e,i.alternate,i)}finally{de=b,I.p=h,j.T=c}}Un=3}}function Ss(){if(Un===4||Un===3){Un=0,Zt();var e=hr,i=Ta,c=ti,h=Hc;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Un=5:(Un=0,Ta=hr=null,bt(e,e.pendingLanes));var b=e.pendingLanes;if(b===0&&(ka=null),Ft(c),i=i.stateNode,vt&&typeof vt.onCommitFiberRoot=="function")try{vt.onCommitFiberRoot(Bt,i,void 0,(i.current.flags&128)===128)}catch{}if(h!==null){i=j.T,b=I.p,I.p=2,j.T=null;try{for(var w=e.onRecoverableError,q=0;q<h.length;q++){var $=h[q];w($.value,{componentStack:$.stack})}}finally{j.T=i,I.p=b}}(ti&3)!==0&&gt(),_s(e),b=e.pendingLanes,(c&261930)!==0&&(b&42)!==0?e===go?ho++:(ho=0,go=e):ho=0,zd(0)}}function bt(e,i){(e.pooledCacheLanes&=i)===0&&(i=e.pooledCache,i!=null&&(e.pooledCache=null,Go(i)))}function gt(){return vi(),$o(),Ss(),Ct()}function Ct(){if(Un!==5)return!1;var e=hr,i=fo;fo=0;var c=Ft(ti),h=j.T,b=I.p;try{I.p=32>c?32:c,j.T=null,c=Na,Na=null;var w=hr,q=ti;if(Un=0,Ta=hr=null,ti=0,(de&6)!==0)throw Error(a(331));var $=de;if(de|=4,fr(w.current),mi(w,w.current,q,c),de=$,zd(0,!1),vt&&typeof vt.onPostCommitFiberRoot=="function")try{vt.onPostCommitFiberRoot(Bt,w)}catch{}return!0}finally{I.p=b,j.T=h,bt(e,i)}}function Ht(e,i,c){i=li(c,i),i=hi(e.stateNode,i,2),e=us(e,i,2),e!==null&&(Yi(e,2),_s(e))}function Xt(e,i,c){if(e.tag===3)Ht(e,e,c);else for(;i!==null;){if(i.tag===3){Ht(i,e,c);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ka===null||!ka.has(h))){e=li(c,e),c=Ad(2),h=us(i,c,2),h!==null&&(T0(c,h,i,e),Yi(h,2),_s(h));break}}i=i.return}}function En(e,i,c){var h=e.pingCache;if(h===null){h=e.pingCache=new da;var b=new Set;h.set(i,b)}else b=h.get(i),b===void 0&&(b=new Set,h.set(i,b));b.has(c)||(Jo=!0,b.add(c),e=Se.bind(null,e,i,c),i.then(e,e))}function Se(e,i,c){var h=e.pingCache;h!==null&&h.delete(i),e.pingedLanes|=e.suspendedLanes&c,e.warmLanes&=~c,Le===e&&(Be&c)===c&&(wn===4||wn===3&&(Be&62914560)===Be&&300>Ce()-Hr?(de&2)===0&&pr(e,0):_n|=c,Ge===Be&&(Ge=0)),_s(e)}function $e(e,i){i===0&&(i=Ts()),e=oi(e,i),e!==null&&(Yi(e,i),_s(e))}function ha(e){var i=e.memoizedState,c=0;i!==null&&(c=i.retryLane),$e(e,c)}function an(e,i){var c=0;switch(e.tag){case 31:case 13:var h=e.stateNode,b=e.memoizedState;b!==null&&(c=b.retryLane);break;case 19:h=e.stateNode;break;case 22:h=e.stateNode._retryCache;break;default:throw Error(a(314))}h!==null&&h.delete(i),$e(e,c)}function bs(e,i){return Yn(e,i)}var qc=null,Vc=null,Qg=!1,x0=!1,Xg=!1,tl=0;function _s(e){e!==Vc&&e.next===null&&(Vc===null?qc=Vc=e:Vc=Vc.next=e),x0=!0,Qg||(Qg=!0,Ub())}function zd(e,i){if(!Xg&&x0){Xg=!0;do for(var c=!1,h=qc;h!==null;){if(e!==0){var b=h.pendingLanes;if(b===0)var w=0;else{var q=h.suspendedLanes,$=h.pingedLanes;w=(1<<31-Yt(42|e)+1)-1,w&=b&~(q&~$),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(c=!0,Ev(h,w))}else w=Be,w=dn(h,h===Le?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||Mn(h,w)||(c=!0,Ev(h,w));h=h.next}while(c);Xg=!1}}function jb(){Sv()}function Sv(){x0=Qg=!1;var e=0;tl!==0&&Vb()&&(e=tl);for(var i=Ce(),c=null,h=qc;h!==null;){var b=h.next,w=bv(h,i);w===0?(h.next=null,c===null?qc=b:c.next=b,b===null&&(Vc=c)):(c=h,(e!==0||(w&3)!==0)&&(x0=!0)),h=b}Un!==0&&Un!==5||zd(e),tl!==0&&(tl=0)}function bv(e,i){for(var c=e.suspendedLanes,h=e.pingedLanes,b=e.expirationTimes,w=e.pendingLanes&-62914561;0<w;){var q=31-Yt(w),$=1<<q,ut=b[q];ut===-1?(($&c)===0||($&h)!==0)&&(b[q]=Sr($,i)):ut<=i&&(e.expiredLanes|=$),w&=~$}if(i=Le,c=Be,c=dn(e,e===i?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h=e.callbackNode,c===0||e===i&&(yn===2||yn===9)||e.cancelPendingCommit!==null)return h!==null&&h!==null&&sn(h),e.callbackNode=null,e.callbackPriority=0;if((c&3)===0||Mn(e,c)){if(i=c&-c,i===e.callbackPriority)return i;switch(h!==null&&sn(h),Ft(c)){case 2:case 8:c=Te;break;case 32:c=lt;break;case 268435456:c=Rt;break;default:c=lt}return h=_v.bind(null,e),c=Yn(c,h),e.callbackPriority=i,e.callbackNode=c,i}return h!==null&&h!==null&&sn(h),e.callbackPriority=2,e.callbackNode=null,2}function _v(e,i){if(Un!==0&&Un!==5)return e.callbackNode=null,e.callbackPriority=0,null;var c=e.callbackNode;if(gt()&&e.callbackNode!==c)return null;var h=Be;return h=dn(e,e===Le?h:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h===0?null:(kr(e,h,i),bv(e,Ce()),e.callbackNode!=null&&e.callbackNode===c?_v.bind(null,e):null)}function Ev(e,i){if(gt())return null;kr(e,i,!0)}function Ub(){Kb(function(){(de&6)!==0?Yn(Je,jb):Sv()})}function Fg(){if(tl===0){var e=Ps;e===0&&(e=be,be<<=1,(be&261888)===0&&(be=256)),tl=e}return tl}function Cv(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Tl(""+e)}function Tv(e,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,e.id&&c.setAttribute("form",e.id),i.parentNode.insertBefore(c,i),e=new FormData(e),c.parentNode.removeChild(c),e}function Bb(e,i,c,h,b){if(i==="submit"&&c&&c.stateNode===b){var w=Cv((b[ie]||null).action),q=h.submitter;q&&(i=(i=q[ie]||null)?Cv(i.formAction):q.getAttribute("formAction"),i!==null&&(w=i,q=null));var $=new Iu("action","action",null,h,b);e.push({event:$,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(tl!==0){var ut=q?Tv(b,q):new FormData(b);Oc(c,{pending:!0,data:ut,method:b.method,action:w},null,ut)}}else typeof w=="function"&&($.preventDefault(),ut=q?Tv(b,q):new FormData(b),Oc(c,{pending:!0,data:ut,method:b.method,action:w},w,ut))},currentTarget:b}]})}}for(var Jg=0;Jg<Ji.length;Jg++){var Zg=Ji[Jg],zb=Zg.toLowerCase(),Lb=Zg[0].toUpperCase()+Zg.slice(1);ya(zb,"on"+Lb)}ya(nc,"onAnimationEnd"),ya(Qf,"onAnimationIteration"),ya(kh,"onAnimationStart"),ya("dblclick","onDoubleClick"),ya("focusin","onFocus"),ya("focusout","onBlur"),ya(Xf,"onTransitionRun"),ya(Ua,"onTransitionStart"),ya(qh,"onTransitionCancel"),ya(Ba,"onTransitionEnd"),sa("onMouseEnter",["mouseout","mouseover"]),sa("onMouseLeave",["mouseout","mouseover"]),sa("onPointerEnter",["pointerout","pointerover"]),sa("onPointerLeave",["pointerout","pointerover"]),yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yi("onBeforeInput",["compositionend","keypress","textInput","paste"]),yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ld));function Av(e,i){i=(i&4)!==0;for(var c=0;c<e.length;c++){var h=e[c],b=h.event;h=h.listeners;t:{var w=void 0;if(i)for(var q=h.length-1;0<=q;q--){var $=h[q],ut=$.instance,St=$.currentTarget;if($=$.listener,ut!==w&&b.isPropagationStopped())break t;w=$,b.currentTarget=St;try{w(b)}catch(xt){Mi(xt)}b.currentTarget=null,w=ut}else for(q=0;q<h.length;q++){if($=h[q],ut=$.instance,St=$.currentTarget,$=$.listener,ut!==w&&b.isPropagationStopped())break t;w=$,b.currentTarget=St;try{w(b)}catch(xt){Mi(xt)}b.currentTarget=null,w=ut}}}}function Fe(e,i){var c=i[_e];c===void 0&&(c=i[_e]=new Set);var h=e+"__bubble";c.has(h)||(wv(i,e,2,!1),c.add(h))}function Wg(e,i,c){var h=0;i&&(h|=4),wv(c,e,h,i)}var M0="_reactListening"+Math.random().toString(36).slice(2);function $g(e){if(!e[M0]){e[M0]=!0,As.forEach(function(c){c!=="selectionchange"&&(Pb.has(c)||Wg(c,!1,e),Wg(c,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[M0]||(i[M0]=!0,Wg("selectionchange",!1,i))}}function wv(e,i,c,h){switch(ey(i)){case 2:var b=d4;break;case 8:b=h4;break;default:b=gp}c=b.bind(null,i,c,e),b=void 0,!Pu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(b=!0),h?b!==void 0?e.addEventListener(i,c,{capture:!0,passive:b}):e.addEventListener(i,c,!0):b!==void 0?e.addEventListener(i,c,{passive:b}):e.addEventListener(i,c,!1)}function tp(e,i,c,h,b){var w=h;if((i&1)===0&&(i&2)===0&&h!==null)t:for(;;){if(h===null)return;var q=h.tag;if(q===3||q===4){var $=h.stateNode.containerInfo;if($===b)break;if(q===4)for(q=h.return;q!==null;){var ut=q.tag;if((ut===3||ut===4)&&q.stateNode.containerInfo===b)return;q=q.return}for(;$!==null;){if(q=ln($),q===null)return;if(ut=q.tag,ut===5||ut===6||ut===26||ut===27){h=w=q;continue t}$=$.parentNode}}h=h.return}Nf(function(){var St=w,xt=zu(c),Dt=[];t:{var Et=Ff.get(e);if(Et!==void 0){var At=Iu,ne=e;switch(e){case"keypress":if(Al(c)===0)break t;case"keydown":case"keyup":At=Bf;break;case"focusin":ne="focus",At=Vu;break;case"focusout":ne="blur",At=Vu;break;case"beforeblur":case"afterblur":At=Vu;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":At=jf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":At=Ml;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":At=pa;break;case nc:case Qf:case kh:At=Wr;break;case Ba:At=Uh;break;case"scroll":case"scrollend":At=wh;break;case"wheel":At=zh;break;case"copy":case"cut":case"paste":At=$r;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":At=zf;break;case"toggle":case"beforetoggle":At=Yu}var ve=(i&4)!==0,xn=!ve&&(e==="scroll"||e==="scrollend"),pt=ve?Et!==null?Et+"Capture":null:Et;ve=[];for(var ft=St,yt;ft!==null;){var Mt=ft;if(yt=Mt.stateNode,Mt=Mt.tag,Mt!==5&&Mt!==26&&Mt!==27||yt===null||pt===null||(Mt=wo(ft,pt),Mt!=null&&ve.push(Pd(ft,Mt,yt))),xn)break;ft=ft.return}0<ve.length&&(Et=new At(Et,ne,null,c,xt),Dt.push({event:Et,listeners:ve}))}}if((i&7)===0){t:{if(Et=e==="mouseover"||e==="pointerover",At=e==="mouseout"||e==="pointerout",Et&&c!==Ao&&(ne=c.relatedTarget||c.fromElement)&&(ln(ne)||ne[on]))break t;if((At||Et)&&(Et=xt.window===xt?xt:(Et=xt.ownerDocument)?Et.defaultView||Et.parentWindow:window,At?(ne=c.relatedTarget||c.toElement,At=St,ne=ne?ln(ne):null,ne!==null&&(xn=l(ne),ve=ne.tag,ne!==xn||ve!==5&&ve!==27&&ve!==6)&&(ne=null)):(At=null,ne=St),At!==ne)){if(ve=jf,Mt="onMouseLeave",pt="onMouseEnter",ft="mouse",(e==="pointerout"||e==="pointerover")&&(ve=zf,Mt="onPointerLeave",pt="onPointerEnter",ft="pointer"),xn=At==null?Et:ai(At),yt=ne==null?Et:ai(ne),Et=new ve(Mt,ft+"leave",At,c,xt),Et.target=xn,Et.relatedTarget=yt,Mt=null,ln(xt)===St&&(ve=new ve(pt,ft+"enter",ne,c,xt),ve.target=yt,ve.relatedTarget=xn,Mt=ve),xn=Mt,At&&ne)e:{for(ve=Gb,pt=At,ft=ne,yt=0,Mt=pt;Mt;Mt=ve(Mt))yt++;Mt=0;for(var ue=ft;ue;ue=ve(ue))Mt++;for(;0<yt-Mt;)pt=ve(pt),yt--;for(;0<Mt-yt;)ft=ve(ft),Mt--;for(;yt--;){if(pt===ft||ft!==null&&pt===ft.alternate){ve=pt;break e}pt=ve(pt),ft=ve(ft)}ve=null}else ve=null;At!==null&&Rv(Dt,Et,At,ve,!1),ne!==null&&xn!==null&&Rv(Dt,xn,ne,ve,!0)}}t:{if(Et=St?ai(St):window,At=Et.nodeName&&Et.nodeName.toLowerCase(),At==="select"||At==="input"&&Et.type==="file")var gn=Zu;else if(Fi(Et))if(Hf)gn=Hg;else{gn=In;var se=Ll}else At=Et.nodeName,!At||At.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?St&&Bu(St.elementType)&&(gn=Zu):gn=Gg;if(gn&&(gn=gn(e,St))){Ju(Dt,gn,c,xt);break t}se&&se(e,Et,St),e==="focusout"&&St&&Et.type==="number"&&St.memoizedProps.value!=null&&Af(Et,"number",Et.value)}switch(se=St?ai(St):window,e){case"focusin":(Fi(se)||se.contentEditable==="true")&&(Ns=se,Pl=St,Ds=null);break;case"focusout":Ds=Pl=Ns=null;break;case"mousedown":Do=!0;break;case"contextmenu":case"mouseup":case"dragend":Do=!1,Yf(Dt,c,xt);break;case"selectionchange":if(Vf)break;case"keydown":case"keyup":Yf(Dt,c,xt)}var He;if(Ku)t:{switch(e){case"compositionstart":var Ze="onCompositionStart";break t;case"compositionend":Ze="onCompositionEnd";break t;case"compositionupdate":Ze="onCompositionUpdate";break t}Ze=void 0}else ts?Fu(e,c)&&(Ze="onCompositionEnd"):e==="keydown"&&c.keyCode===229&&(Ze="onCompositionStart");Ze&&(Qu&&c.locale!=="ko"&&(ts||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&ts&&(He=Df()):(Er=xt,Gu="value"in Er?Er.value:Er.textContent,ts=!0)),se=N0(St,Ze),0<se.length&&(Ze=new Nl(Ze,e,null,c,xt),Dt.push({event:Ze,listeners:se}),He?Ze.data=He:(He=Dl(c),He!==null&&(Ze.data=He)))),(He=Ph?Gh(e,c):Gf(e,c))&&(Ze=N0(St,"onBeforeInput"),0<Ze.length&&(se=new Nl("onBeforeInput","beforeinput",null,c,xt),Dt.push({event:se,listeners:Ze}),se.data=He)),Bb(Dt,e,St,c,xt)}Av(Dt,i)})}function Pd(e,i,c){return{instance:e,listener:i,currentTarget:c}}function N0(e,i){for(var c=i+"Capture",h=[];e!==null;){var b=e,w=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||w===null||(b=wo(e,c),b!=null&&h.unshift(Pd(e,b,w)),b=wo(e,i),b!=null&&h.push(Pd(e,b,w))),e.tag===3)return h;e=e.return}return[]}function Gb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Rv(e,i,c,h,b){for(var w=i._reactName,q=[];c!==null&&c!==h;){var $=c,ut=$.alternate,St=$.stateNode;if($=$.tag,ut!==null&&ut===h)break;$!==5&&$!==26&&$!==27||St===null||(ut=St,b?(St=wo(c,w),St!=null&&q.unshift(Pd(c,St,ut))):b||(St=wo(c,w),St!=null&&q.push(Pd(c,St,ut)))),c=c.return}q.length!==0&&e.push({event:i,listeners:q})}var Hb=/\r\n?/g,Ib=/\u0000|\uFFFD/g;function Ov(e){return(typeof e=="string"?e:""+e).replace(Hb,`
`).replace(Ib,"")}function xv(e,i){return i=Ov(i),Ov(e)===i}function On(e,i,c,h,b,w){switch(c){case"children":typeof h=="string"?i==="body"||i==="textarea"&&h===""||Fr(e,h):(typeof h=="number"||typeof h=="bigint")&&i!=="body"&&Fr(e,""+h);break;case"className":Si(e,"class",h);break;case"tabIndex":Si(e,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Si(e,c,h);break;case"style":xf(e,h,w);break;case"data":if(i!=="object"){Si(e,"data",h);break}case"src":case"href":if(h===""&&(i!=="a"||c!=="href")){e.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(c);break}h=Tl(""+h),e.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){e.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(c==="formAction"?(i!=="input"&&On(e,i,"name",b.name,b,null),On(e,i,"formEncType",b.formEncType,b,null),On(e,i,"formMethod",b.formMethod,b,null),On(e,i,"formTarget",b.formTarget,b,null)):(On(e,i,"encType",b.encType,b,null),On(e,i,"method",b.method,b,null),On(e,i,"target",b.target,b,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(c);break}h=Tl(""+h),e.setAttribute(c,h);break;case"onClick":h!=null&&(e.onclick=Ya);break;case"onScroll":h!=null&&Fe("scroll",e);break;case"onScrollEnd":h!=null&&Fe("scrollend",e);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(c=h.__html,c!=null){if(b.children!=null)throw Error(a(60));e.innerHTML=c}}break;case"multiple":e.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":e.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){e.removeAttribute("xlink:href");break}c=Tl(""+h),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,""+h):e.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,""):e.removeAttribute(c);break;case"capture":case"download":h===!0?e.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,h):e.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?e.setAttribute(c,h):e.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?e.removeAttribute(c):e.setAttribute(c,h);break;case"popover":Fe("beforetoggle",e),Fe("toggle",e),To(e,"popover",h);break;case"xlinkActuate":bi(e,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":bi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":bi(e,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":bi(e,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":bi(e,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":bi(e,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":bi(e,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":bi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":bi(e,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":To(e,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Ah.get(c)||c,To(e,c,h))}}function ep(e,i,c,h,b,w){switch(c){case"style":xf(e,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(c=h.__html,c!=null){if(b.children!=null)throw Error(a(60));e.innerHTML=c}}break;case"children":typeof h=="string"?Fr(e,h):(typeof h=="number"||typeof h=="bigint")&&Fr(e,""+h);break;case"onScroll":h!=null&&Fe("scroll",e);break;case"onScrollEnd":h!=null&&Fe("scrollend",e);break;case"onClick":h!=null&&(e.onclick=Ya);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ws.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(b=c.endsWith("Capture"),i=c.slice(2,b?c.length-7:void 0),w=e[ie]||null,w=w!=null?w[c]:null,typeof w=="function"&&e.removeEventListener(i,w,b),typeof h=="function")){typeof w!="function"&&w!==null&&(c in e?e[c]=null:e.hasAttribute(c)&&e.removeAttribute(c)),e.addEventListener(i,h,b);break t}c in e?e[c]=h:h===!0?e.setAttribute(c,""):To(e,c,h)}}}function qa(e,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",e),Fe("load",e);var h=!1,b=!1,w;for(w in c)if(c.hasOwnProperty(w)){var q=c[w];if(q!=null)switch(w){case"src":h=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:On(e,i,w,q,c,null)}}b&&On(e,i,"srcSet",c.srcSet,c,null),h&&On(e,i,"src",c.src,c,null);return;case"input":Fe("invalid",e);var $=w=q=b=null,ut=null,St=null;for(h in c)if(c.hasOwnProperty(h)){var xt=c[h];if(xt!=null)switch(h){case"name":b=xt;break;case"type":q=xt;break;case"checked":ut=xt;break;case"defaultChecked":St=xt;break;case"value":w=xt;break;case"defaultValue":$=xt;break;case"children":case"dangerouslySetInnerHTML":if(xt!=null)throw Error(a(137,i));break;default:On(e,i,h,xt,c,null)}}Tf(e,w,$,ut,St,q,b,!1);return;case"select":Fe("invalid",e),h=q=w=null;for(b in c)if(c.hasOwnProperty(b)&&($=c[b],$!=null))switch(b){case"value":w=$;break;case"defaultValue":q=$;break;case"multiple":h=$;default:On(e,i,b,$,c,null)}i=w,c=q,e.multiple=!!h,i!=null?Rs(e,!!h,i,!1):c!=null&&Rs(e,!!h,c,!0);return;case"textarea":Fe("invalid",e),w=b=h=null;for(q in c)if(c.hasOwnProperty(q)&&($=c[q],$!=null))switch(q){case"value":h=$;break;case"defaultValue":b=$;break;case"children":w=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(a(91));break;default:On(e,i,q,$,c,null)}Rf(e,h,b,w);return;case"option":for(ut in c)if(c.hasOwnProperty(ut)&&(h=c[ut],h!=null))switch(ut){case"selected":e.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:On(e,i,ut,h,c,null)}return;case"dialog":Fe("beforetoggle",e),Fe("toggle",e),Fe("cancel",e),Fe("close",e);break;case"iframe":case"object":Fe("load",e);break;case"video":case"audio":for(h=0;h<Ld.length;h++)Fe(Ld[h],e);break;case"image":Fe("error",e),Fe("load",e);break;case"details":Fe("toggle",e);break;case"embed":case"source":case"link":Fe("error",e),Fe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(St in c)if(c.hasOwnProperty(St)&&(h=c[St],h!=null))switch(St){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:On(e,i,St,h,c,null)}return;default:if(Bu(i)){for(xt in c)c.hasOwnProperty(xt)&&(h=c[xt],h!==void 0&&ep(e,i,xt,h,c,void 0));return}}for($ in c)c.hasOwnProperty($)&&(h=c[$],h!=null&&On(e,i,$,h,c,null))}function kb(e,i,c,h){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,w=null,q=null,$=null,ut=null,St=null,xt=null;for(At in c){var Dt=c[At];if(c.hasOwnProperty(At)&&Dt!=null)switch(At){case"checked":break;case"value":break;case"defaultValue":ut=Dt;default:h.hasOwnProperty(At)||On(e,i,At,null,h,Dt)}}for(var Et in h){var At=h[Et];if(Dt=c[Et],h.hasOwnProperty(Et)&&(At!=null||Dt!=null))switch(Et){case"type":w=At;break;case"name":b=At;break;case"checked":St=At;break;case"defaultChecked":xt=At;break;case"value":q=At;break;case"defaultValue":$=At;break;case"children":case"dangerouslySetInnerHTML":if(At!=null)throw Error(a(137,i));break;default:At!==Dt&&On(e,i,Et,At,h,Dt)}}Cl(e,q,$,ut,St,xt,w,b);return;case"select":At=q=$=Et=null;for(w in c)if(ut=c[w],c.hasOwnProperty(w)&&ut!=null)switch(w){case"value":break;case"multiple":At=ut;default:h.hasOwnProperty(w)||On(e,i,w,null,h,ut)}for(b in h)if(w=h[b],ut=c[b],h.hasOwnProperty(b)&&(w!=null||ut!=null))switch(b){case"value":Et=w;break;case"defaultValue":$=w;break;case"multiple":q=w;default:w!==ut&&On(e,i,b,w,h,ut)}i=$,c=q,h=At,Et!=null?Rs(e,!!c,Et,!1):!!h!=!!c&&(i!=null?Rs(e,!!c,i,!0):Rs(e,!!c,c?[]:"",!1));return;case"textarea":At=Et=null;for($ in c)if(b=c[$],c.hasOwnProperty($)&&b!=null&&!h.hasOwnProperty($))switch($){case"value":break;case"children":break;default:On(e,i,$,null,h,b)}for(q in h)if(b=h[q],w=c[q],h.hasOwnProperty(q)&&(b!=null||w!=null))switch(q){case"value":Et=b;break;case"defaultValue":At=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(a(91));break;default:b!==w&&On(e,i,q,b,h,w)}wf(e,Et,At);return;case"option":for(var ne in c)if(Et=c[ne],c.hasOwnProperty(ne)&&Et!=null&&!h.hasOwnProperty(ne))switch(ne){case"selected":e.selected=!1;break;default:On(e,i,ne,null,h,Et)}for(ut in h)if(Et=h[ut],At=c[ut],h.hasOwnProperty(ut)&&Et!==At&&(Et!=null||At!=null))switch(ut){case"selected":e.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:On(e,i,ut,Et,h,At)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ve in c)Et=c[ve],c.hasOwnProperty(ve)&&Et!=null&&!h.hasOwnProperty(ve)&&On(e,i,ve,null,h,Et);for(St in h)if(Et=h[St],At=c[St],h.hasOwnProperty(St)&&Et!==At&&(Et!=null||At!=null))switch(St){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(a(137,i));break;default:On(e,i,St,Et,h,At)}return;default:if(Bu(i)){for(var xn in c)Et=c[xn],c.hasOwnProperty(xn)&&Et!==void 0&&!h.hasOwnProperty(xn)&&ep(e,i,xn,void 0,h,Et);for(xt in h)Et=h[xt],At=c[xt],!h.hasOwnProperty(xt)||Et===At||Et===void 0&&At===void 0||ep(e,i,xt,Et,h,At);return}}for(var pt in c)Et=c[pt],c.hasOwnProperty(pt)&&Et!=null&&!h.hasOwnProperty(pt)&&On(e,i,pt,null,h,Et);for(Dt in h)Et=h[Dt],At=c[Dt],!h.hasOwnProperty(Dt)||Et===At||Et==null&&At==null||On(e,i,Dt,Et,h,At)}function Mv(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function qb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,i=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var b=c[h],w=b.transferSize,q=b.initiatorType,$=b.duration;if(w&&$&&Mv(q)){for(q=0,$=b.responseEnd,h+=1;h<c.length;h++){var ut=c[h],St=ut.startTime;if(St>$)break;var xt=ut.transferSize,Dt=ut.initiatorType;xt&&Mv(Dt)&&(ut=ut.responseEnd,q+=xt*(ut<$?1:($-St)/(ut-St)))}if(--h,i+=8*(w+q)/(b.duration/1e3),e++,10<e)break}}if(0<e)return i/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var np=null,ap=null;function D0(e){return e.nodeType===9?e:e.ownerDocument}function Nv(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Dv(e,i){if(e===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&i==="foreignObject"?0:e}function ip(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var rp=null;function Vb(){var e=window.event;return e&&e.type==="popstate"?e===rp?!1:(rp=e,!0):(rp=null,!1)}var jv=typeof setTimeout=="function"?setTimeout:void 0,Yb=typeof clearTimeout=="function"?clearTimeout:void 0,Uv=typeof Promise=="function"?Promise:void 0,Kb=typeof queueMicrotask=="function"?queueMicrotask:typeof Uv<"u"?function(e){return Uv.resolve(null).then(e).catch(Qb)}:jv;function Qb(e){setTimeout(function(){throw e})}function el(e){return e==="head"}function Bv(e,i){var c=i,h=0;do{var b=c.nextSibling;if(e.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"||c==="/&"){if(h===0){e.removeChild(b),Xc(i);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")Gd(e.ownerDocument.documentElement);else if(c==="head"){c=e.ownerDocument.head,Gd(c);for(var w=c.firstChild;w;){var q=w.nextSibling,$=w.nodeName;w[Ue]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&w.rel.toLowerCase()==="stylesheet"||c.removeChild(w),w=q}}else c==="body"&&Gd(e.ownerDocument.body);c=b}while(c);Xc(i)}function zv(e,i){var c=e;e=0;do{var h=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(e===0)break;e--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||e++;c=h}while(c)}function sp(e){var i=e.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":sp(c),ye(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}e.removeChild(c)}}function Xb(e,i,c,h){for(;e.nodeType===1;){var b=c;if(e.nodeName.toLowerCase()!==i.toLowerCase()){if(!h&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(h){if(!e[Ue])switch(i){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(w=e.getAttribute("rel"),w==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(w!==b.rel||e.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||e.getAttribute("title")!==(b.title==null?null:b.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(w=e.getAttribute("src"),(w!==(b.src==null?null:b.src)||e.getAttribute("type")!==(b.type==null?null:b.type)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&w&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(i==="input"&&e.type==="hidden"){var w=b.name==null?null:""+b.name;if(b.type==="hidden"&&e.getAttribute("name")===w)return e}else return e;if(e=mr(e.nextSibling),e===null)break}return null}function Fb(e,i,c){if(i==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!c||(e=mr(e.nextSibling),e===null))return null;return e}function Lv(e,i){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=mr(e.nextSibling),e===null))return null;return e}function op(e){return e.data==="$?"||e.data==="$~"}function lp(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Jb(e,i){var c=e.ownerDocument;if(e.data==="$~")e._reactRetry=i;else if(e.data!=="$?"||c.readyState!=="loading")i();else{var h=function(){i(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),e._reactRetry=h}}function mr(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return e}var up=null;function Pv(e){e=e.nextSibling;for(var i=0;e;){if(e.nodeType===8){var c=e.data;if(c==="/$"||c==="/&"){if(i===0)return mr(e.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}e=e.nextSibling}return null}function Gv(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var c=e.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return e;i--}else c!=="/$"&&c!=="/&"||i++}e=e.previousSibling}return null}function Hv(e,i,c){switch(i=D0(c),e){case"html":if(e=i.documentElement,!e)throw Error(a(452));return e;case"head":if(e=i.head,!e)throw Error(a(453));return e;case"body":if(e=i.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function Gd(e){for(var i=e.attributes;i.length;)e.removeAttributeNode(i[0]);ye(e)}var vr=new Map,Iv=new Set;function j0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var mo=I.d;I.d={f:Zb,r:Wb,D:$b,C:t4,L:e4,m:n4,X:i4,S:a4,M:r4};function Zb(){var e=mo.f(),i=Wo();return e||i}function Wb(e){var i=un(e);i!==null&&i.tag===5&&i.type==="form"?y0(i):mo.r(e)}var Yc=typeof document>"u"?null:document;function kv(e,i,c){var h=Yc;if(h&&typeof i=="string"&&i){var b=ri(i);b='link[rel="'+e+'"][href="'+b+'"]',typeof c=="string"&&(b+='[crossorigin="'+c+'"]'),Iv.has(b)||(Iv.add(b),e={rel:e,crossOrigin:c,href:i},h.querySelector(b)===null&&(i=h.createElement("link"),qa(i,"link",e),Kn(i),h.head.appendChild(i)))}}function $b(e){mo.D(e),kv("dns-prefetch",e,null)}function t4(e,i){mo.C(e,i),kv("preconnect",e,i)}function e4(e,i,c){mo.L(e,i,c);var h=Yc;if(h&&e&&i){var b='link[rel="preload"][as="'+ri(i)+'"]';i==="image"&&c&&c.imageSrcSet?(b+='[imagesrcset="'+ri(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(b+='[imagesizes="'+ri(c.imageSizes)+'"]')):b+='[href="'+ri(e)+'"]';var w=b;switch(i){case"style":w=Kc(e);break;case"script":w=Qc(e)}vr.has(w)||(e=C({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:e,as:i},c),vr.set(w,e),h.querySelector(b)!==null||i==="style"&&h.querySelector(Hd(w))||i==="script"&&h.querySelector(Id(w))||(i=h.createElement("link"),qa(i,"link",e),Kn(i),h.head.appendChild(i)))}}function n4(e,i){mo.m(e,i);var c=Yc;if(c&&e){var h=i&&typeof i.as=="string"?i.as:"script",b='link[rel="modulepreload"][as="'+ri(h)+'"][href="'+ri(e)+'"]',w=b;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Qc(e)}if(!vr.has(w)&&(e=C({rel:"modulepreload",href:e},i),vr.set(w,e),c.querySelector(b)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Id(w)))return}h=c.createElement("link"),qa(h,"link",e),Kn(h),c.head.appendChild(h)}}}function a4(e,i,c){mo.S(e,i,c);var h=Yc;if(h&&e){var b=ii(h).hoistableStyles,w=Kc(e);i=i||"default";var q=b.get(w);if(!q){var $={loading:0,preload:null};if(q=h.querySelector(Hd(w)))$.loading=5;else{e=C({rel:"stylesheet",href:e,"data-precedence":i},c),(c=vr.get(w))&&cp(e,c);var ut=q=h.createElement("link");Kn(ut),qa(ut,"link",e),ut._p=new Promise(function(St,xt){ut.onload=St,ut.onerror=xt}),ut.addEventListener("load",function(){$.loading|=1}),ut.addEventListener("error",function(){$.loading|=2}),$.loading|=4,U0(q,i,h)}q={type:"stylesheet",instance:q,count:1,state:$},b.set(w,q)}}}function i4(e,i){mo.X(e,i);var c=Yc;if(c&&e){var h=ii(c).hoistableScripts,b=Qc(e),w=h.get(b);w||(w=c.querySelector(Id(b)),w||(e=C({src:e,async:!0},i),(i=vr.get(b))&&fp(e,i),w=c.createElement("script"),Kn(w),qa(w,"link",e),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(b,w))}}function r4(e,i){mo.M(e,i);var c=Yc;if(c&&e){var h=ii(c).hoistableScripts,b=Qc(e),w=h.get(b);w||(w=c.querySelector(Id(b)),w||(e=C({src:e,async:!0,type:"module"},i),(i=vr.get(b))&&fp(e,i),w=c.createElement("script"),Kn(w),qa(w,"link",e),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(b,w))}}function qv(e,i,c,h){var b=(b=tt.current)?j0(b):null;if(!b)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Kc(c.href),c=ii(b).hoistableStyles,h=c.get(i),h||(h={type:"style",instance:null,count:0,state:null},c.set(i,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){e=Kc(c.href);var w=ii(b).hoistableStyles,q=w.get(e);if(q||(b=b.ownerDocument||b,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(e,q),(w=b.querySelector(Hd(e)))&&!w._p&&(q.instance=w,q.state.loading=5),vr.has(e)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},vr.set(e,c),w||s4(b,e,c,q.state))),i&&h===null)throw Error(a(528,""));return q}if(i&&h!==null)throw Error(a(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Qc(c),c=ii(b).hoistableScripts,h=c.get(i),h||(h={type:"script",instance:null,count:0,state:null},c.set(i,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Kc(e){return'href="'+ri(e)+'"'}function Hd(e){return'link[rel="stylesheet"]['+e+"]"}function Vv(e){return C({},e,{"data-precedence":e.precedence,precedence:null})}function s4(e,i,c,h){e.querySelector('link[rel="preload"][as="style"]['+i+"]")?h.loading=1:(i=e.createElement("link"),h.preload=i,i.addEventListener("load",function(){return h.loading|=1}),i.addEventListener("error",function(){return h.loading|=2}),qa(i,"link",c),Kn(i),e.head.appendChild(i))}function Qc(e){return'[src="'+ri(e)+'"]'}function Id(e){return"script[async]"+e}function Yv(e,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var h=e.querySelector('style[data-href~="'+ri(c.href)+'"]');if(h)return i.instance=h,Kn(h),h;var b=C({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(e.ownerDocument||e).createElement("style"),Kn(h),qa(h,"style",b),U0(h,c.precedence,e),i.instance=h;case"stylesheet":b=Kc(c.href);var w=e.querySelector(Hd(b));if(w)return i.state.loading|=4,i.instance=w,Kn(w),w;h=Vv(c),(b=vr.get(b))&&cp(h,b),w=(e.ownerDocument||e).createElement("link"),Kn(w);var q=w;return q._p=new Promise(function($,ut){q.onload=$,q.onerror=ut}),qa(w,"link",h),i.state.loading|=4,U0(w,c.precedence,e),i.instance=w;case"script":return w=Qc(c.src),(b=e.querySelector(Id(w)))?(i.instance=b,Kn(b),b):(h=c,(b=vr.get(w))&&(h=C({},c),fp(h,b)),e=e.ownerDocument||e,b=e.createElement("script"),Kn(b),qa(b,"link",h),e.head.appendChild(b),i.instance=b);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(h=i.instance,i.state.loading|=4,U0(h,c.precedence,e));return i.instance}function U0(e,i,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=h.length?h[h.length-1]:null,w=b,q=0;q<h.length;q++){var $=h[q];if($.dataset.precedence===i)w=$;else if(w!==b)break}w?w.parentNode.insertBefore(e,w.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(e,i.firstChild))}function cp(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.title==null&&(e.title=i.title)}function fp(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.integrity==null&&(e.integrity=i.integrity)}var B0=null;function Kv(e,i,c){if(B0===null){var h=new Map,b=B0=new Map;b.set(c,h)}else b=B0,h=b.get(c),h||(h=new Map,b.set(c,h));if(h.has(e))return h;for(h.set(e,null),c=c.getElementsByTagName(e),b=0;b<c.length;b++){var w=c[b];if(!(w[Ue]||w[Oe]||e==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var q=w.getAttribute(i)||"";q=e+q;var $=h.get(q);$?$.push(w):h.set(q,[w])}}return h}function Qv(e,i,c){e=e.ownerDocument||e,e.head.insertBefore(c,i==="title"?e.querySelector("head > title"):null)}function o4(e,i,c){if(c===1||i.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return e=i.disabled,typeof i.precedence=="string"&&e==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Xv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function l4(e,i,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var b=Kc(h.href),w=i.querySelector(Hd(b));if(w){i=w._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(e.count++,e=z0.bind(e),i.then(e,e)),c.state.loading|=4,c.instance=w,Kn(w);return}w=i.ownerDocument||i,h=Vv(h),(b=vr.get(b))&&cp(h,b),w=w.createElement("link"),Kn(w);var q=w;q._p=new Promise(function($,ut){q.onload=$,q.onerror=ut}),qa(w,"link",h),c.instance=w}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(e.count++,c=z0.bind(e),i.addEventListener("load",c),i.addEventListener("error",c))}}var dp=0;function u4(e,i){return e.stylesheets&&e.count===0&&P0(e,e.stylesheets),0<e.count||0<e.imgCount?function(c){var h=setTimeout(function(){if(e.stylesheets&&P0(e,e.stylesheets),e.unsuspend){var w=e.unsuspend;e.unsuspend=null,w()}},6e4+i);0<e.imgBytes&&dp===0&&(dp=62500*qb());var b=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&P0(e,e.stylesheets),e.unsuspend)){var w=e.unsuspend;e.unsuspend=null,w()}},(e.imgBytes>dp?50:800)+i);return e.unsuspend=c,function(){e.unsuspend=null,clearTimeout(h),clearTimeout(b)}}:null}function z0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)P0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var L0=null;function P0(e,i){e.stylesheets=null,e.unsuspend!==null&&(e.count++,L0=new Map,i.forEach(c4,e),L0=null,z0.call(e))}function c4(e,i){if(!(i.state.loading&4)){var c=L0.get(e);if(c)var h=c.get(null);else{c=new Map,L0.set(e,c);for(var b=e.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<b.length;w++){var q=b[w];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(c.set(q.dataset.precedence,q),h=q)}h&&c.set(null,h)}b=i.instance,q=b.getAttribute("data-precedence"),w=c.get(q)||h,w===h&&c.set(null,b),c.set(q,b),this.count++,h=z0.bind(this),b.addEventListener("load",h),b.addEventListener("error",h),w?w.parentNode.insertBefore(b,w.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(b,e.firstChild)),i.state.loading|=4}}var kd={$$typeof:M,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function f4(e,i,c,h,b,w,q,$,ut){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=br(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=br(0),this.hiddenUpdates=br(null),this.identifierPrefix=h,this.onUncaughtError=b,this.onCaughtError=w,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ut,this.incompleteTransitions=new Map}function Fv(e,i,c,h,b,w,q,$,ut,St,xt,Dt){return e=new f4(e,i,c,q,ut,St,xt,Dt,$),i=1,w===!0&&(i|=24),w=Oa(3,null,null,i),e.current=w,w.stateNode=e,i=cc(),i.refCount++,e.pooledCache=i,i.refCount++,w.memoizedState={element:h,isDehydrated:c,cache:i},Vs(w),e}function Jv(e){return e?(e=Zi,e):Zi}function Zv(e,i,c,h,b,w){b=Jv(b),h.context===null?h.context=b:h.pendingContext=b,h=ls(i),h.payload={element:c},w=w===void 0?null:w,w!==null&&(h.callback=w),c=us(e,h,i),c!==null&&(hn(c,e,i),Jl(c,e,i))}function Wv(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var c=e.retryLane;e.retryLane=c!==0&&c<i?c:i}}function hp(e,i){Wv(e,i),(e=e.alternate)&&Wv(e,i)}function $v(e){if(e.tag===13||e.tag===31){var i=oi(e,67108864);i!==null&&hn(i,e,67108864),hp(e,67108864)}}function ty(e){if(e.tag===13||e.tag===31){var i=Da();i=$t(i);var c=oi(e,i);c!==null&&hn(c,e,i),hp(e,i)}}var G0=!0;function d4(e,i,c,h){var b=j.T;j.T=null;var w=I.p;try{I.p=2,gp(e,i,c,h)}finally{I.p=w,j.T=b}}function h4(e,i,c,h){var b=j.T;j.T=null;var w=I.p;try{I.p=8,gp(e,i,c,h)}finally{I.p=w,j.T=b}}function gp(e,i,c,h){if(G0){var b=pp(h);if(b===null)tp(e,i,h,H0,c),ny(e,h);else if(p4(b,e,i,c,h))h.stopPropagation();else if(ny(e,h),i&4&&-1<g4.indexOf(e)){for(;b!==null;){var w=un(b);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var q=Re(w.pendingLanes);if(q!==0){var $=w;for($.pendingLanes|=2,$.entangledLanes|=2;q;){var ut=1<<31-Yt(q);$.entanglements[1]|=ut,q&=~ut}_s(w),(de&6)===0&&(Ri=Ce()+500,zd(0))}}break;case 31:case 13:$=oi(w,2),$!==null&&hn($,w,2),Wo(),hp(w,2)}if(w=pp(h),w===null&&tp(e,i,h,H0,c),w===b)break;b=w}b!==null&&h.stopPropagation()}else tp(e,i,h,null,c)}}function pp(e){return e=zu(e),mp(e)}var H0=null;function mp(e){if(H0=null,e=ln(e),e!==null){var i=l(e);if(i===null)e=null;else{var c=i.tag;if(c===13){if(e=f(i),e!==null)return e;e=null}else if(c===31){if(e=d(i),e!==null)return e;e=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null)}}return H0=e,null}function ey(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ke()){case Je:return 2;case Te:return 8;case lt:case Tt:return 32;case Rt:return 268435456;default:return 32}default:return 32}}var vp=!1,nl=null,al=null,il=null,qd=new Map,Vd=new Map,rl=[],g4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ny(e,i){switch(e){case"focusin":case"focusout":nl=null;break;case"dragenter":case"dragleave":al=null;break;case"mouseover":case"mouseout":il=null;break;case"pointerover":case"pointerout":qd.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vd.delete(i.pointerId)}}function Yd(e,i,c,h,b,w){return e===null||e.nativeEvent!==w?(e={blockedOn:i,domEventName:c,eventSystemFlags:h,nativeEvent:w,targetContainers:[b]},i!==null&&(i=un(i),i!==null&&$v(i)),e):(e.eventSystemFlags|=h,i=e.targetContainers,b!==null&&i.indexOf(b)===-1&&i.push(b),e)}function p4(e,i,c,h,b){switch(i){case"focusin":return nl=Yd(nl,e,i,c,h,b),!0;case"dragenter":return al=Yd(al,e,i,c,h,b),!0;case"mouseover":return il=Yd(il,e,i,c,h,b),!0;case"pointerover":var w=b.pointerId;return qd.set(w,Yd(qd.get(w)||null,e,i,c,h,b)),!0;case"gotpointercapture":return w=b.pointerId,Vd.set(w,Yd(Vd.get(w)||null,e,i,c,h,b)),!0}return!1}function ay(e){var i=ln(e.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=f(c),i!==null){e.blockedOn=i,Qe(e.priority,function(){ty(c)});return}}else if(i===31){if(i=d(c),i!==null){e.blockedOn=i,Qe(e.priority,function(){ty(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){e.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}e.blockedOn=null}function I0(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var c=pp(e.nativeEvent);if(c===null){c=e.nativeEvent;var h=new c.constructor(c.type,c);Ao=h,c.target.dispatchEvent(h),Ao=null}else return i=un(c),i!==null&&$v(i),e.blockedOn=c,!1;i.shift()}return!0}function iy(e,i,c){I0(e)&&c.delete(i)}function m4(){vp=!1,nl!==null&&I0(nl)&&(nl=null),al!==null&&I0(al)&&(al=null),il!==null&&I0(il)&&(il=null),qd.forEach(iy),Vd.forEach(iy)}function k0(e,i){e.blockedOn===i&&(e.blockedOn=null,vp||(vp=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,m4)))}var q0=null;function ry(e){q0!==e&&(q0=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){q0===e&&(q0=null);for(var i=0;i<e.length;i+=3){var c=e[i],h=e[i+1],b=e[i+2];if(typeof h!="function"){if(mp(h||c)===null)continue;break}var w=un(c);w!==null&&(e.splice(i,3),i-=3,Oc(w,{pending:!0,data:b,method:c.method,action:h},h,b))}}))}function Xc(e){function i(ut){return k0(ut,e)}nl!==null&&k0(nl,e),al!==null&&k0(al,e),il!==null&&k0(il,e),qd.forEach(i),Vd.forEach(i);for(var c=0;c<rl.length;c++){var h=rl[c];h.blockedOn===e&&(h.blockedOn=null)}for(;0<rl.length&&(c=rl[0],c.blockedOn===null);)ay(c),c.blockedOn===null&&rl.shift();if(c=(e.ownerDocument||e).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var b=c[h],w=c[h+1],q=b[ie]||null;if(typeof w=="function")q||ry(c);else if(q){var $=null;if(w&&w.hasAttribute("formAction")){if(b=w,q=w[ie]||null)$=q.formAction;else if(mp(b)!==null)continue}else $=q.action;typeof $=="function"?c[h+1]=$:(c.splice(h,3),h-=3),ry(c)}}}function sy(){function e(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(q){return b=q})},focusReset:"manual",scroll:"manual"})}function i(){b!==null&&(b(),b=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,b=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),b!==null&&(b(),b=null)}}}function yp(e){this._internalRoot=e}V0.prototype.render=yp.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(a(409));var c=i.current,h=Da();Zv(c,h,e,i,null,null)},V0.prototype.unmount=yp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Zv(e.current,2,null,e,null,null),Wo(),i[on]=null}};function V0(e){this._internalRoot=e}V0.prototype.unstable_scheduleHydration=function(e){if(e){var i=It();e={blockedOn:null,target:e,priority:i};for(var c=0;c<rl.length&&i!==0&&i<rl[c].priority;c++);rl.splice(c,0,e),c===0&&ay(e)}};var oy=t.version;if(oy!=="19.2.0")throw Error(a(527,oy,"19.2.0"));I.findDOMNode=function(e){var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=m(i),e=e!==null?_(e):null,e=e===null?null:e.stateNode,e};var v4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Y0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Y0.isDisabled&&Y0.supportsFiber)try{Bt=Y0.inject(v4),vt=Y0}catch{}}return Qd.createRoot=function(e,i){if(!r(e))throw Error(a(299));var c=!1,h="",b=au,w=iu,q=Mc;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(b=i.onUncaughtError),i.onCaughtError!==void 0&&(w=i.onCaughtError),i.onRecoverableError!==void 0&&(q=i.onRecoverableError)),i=Fv(e,1,!1,null,null,c,h,null,b,w,q,sy),e[on]=i.current,$g(e),new yp(i)},Qd.hydrateRoot=function(e,i,c){if(!r(e))throw Error(a(299));var h=!1,b="",w=au,q=iu,$=Mc,ut=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(b=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(q=c.onCaughtError),c.onRecoverableError!==void 0&&($=c.onRecoverableError),c.formState!==void 0&&(ut=c.formState)),i=Fv(e,1,!0,i,c??null,h,b,ut,w,q,$,sy),i.context=Jv(null),c=i.current,h=Da(),h=$t(h),b=ls(h),b.callback=null,us(c,b,h),c=h,i.current.lanes=c,Yi(i,c),_s(i),e[on]=i.current,$g(e),new V0(i)},Qd.version="19.2.0",Qd}var vy;function O4(){if(vy)return _p.exports;vy=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),_p.exports=R4(),_p.exports}var x4=O4();const M4=pf(x4);A2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fh(){return fh=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},fh.apply(this,arguments)}var gl;(function(o){o.Pop="POP",o.Push="PUSH",o.Replace="REPLACE"})(gl||(gl={}));const yy="popstate";function N4(o){o===void 0&&(o={});function t(a,r){let{pathname:l,search:f,hash:d}=a.location;return Tm("",{pathname:l,search:f,hash:d},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){return typeof r=="string"?r:R2(r)}return j4(t,n,null,o)}function wa(o,t){if(o===!1||o===null||typeof o>"u")throw new Error(t)}function w2(o,t){if(!o){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function D4(){return Math.random().toString(36).substr(2,8)}function Sy(o,t){return{usr:o.state,key:o.key,idx:t}}function Tm(o,t,n,a){return n===void 0&&(n=null),fh({pathname:typeof o=="string"?o:o.pathname,search:"",hash:""},typeof t=="string"?mf(t):t,{state:n,key:t&&t.key||a||D4()})}function R2(o){let{pathname:t="/",search:n="",hash:a=""}=o;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function mf(o){let t={};if(o){let n=o.indexOf("#");n>=0&&(t.hash=o.substr(n),o=o.substr(0,n));let a=o.indexOf("?");a>=0&&(t.search=o.substr(a),o=o.substr(0,a)),o&&(t.pathname=o)}return t}function j4(o,t,n,a){a===void 0&&(a={});let{window:r=document.defaultView,v5Compat:l=!1}=a,f=r.history,d=gl.Pop,g=null,m=_();m==null&&(m=0,f.replaceState(fh({},f.state,{idx:m}),""));function _(){return(f.state||{idx:null}).idx}function C(){d=gl.Pop;let L=_(),B=L==null?null:L-m;m=L,g&&g({action:d,location:D.location,delta:B})}function E(L,B){d=gl.Push;let N=Tm(D.location,L,B);m=_()+1;let M=Sy(N,m),P=D.createHref(N);try{f.pushState(M,"",P)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;r.location.assign(P)}l&&g&&g({action:d,location:D.location,delta:1})}function R(L,B){d=gl.Replace;let N=Tm(D.location,L,B);m=_();let M=Sy(N,m),P=D.createHref(N);f.replaceState(M,"",P),l&&g&&g({action:d,location:D.location,delta:0})}function v(L){let B=r.location.origin!=="null"?r.location.origin:r.location.href,N=typeof L=="string"?L:R2(L);return N=N.replace(/ $/,"%20"),wa(B,"No window.location.(origin|href) available to create URL for href: "+N),new URL(N,B)}let D={get action(){return d},get location(){return o(r,f)},listen(L){if(g)throw new Error("A history only accepts one active listener");return r.addEventListener(yy,C),g=L,()=>{r.removeEventListener(yy,C),g=null}},createHref(L){return t(r,L)},createURL:v,encodeLocation(L){let B=v(L);return{pathname:B.pathname,search:B.search,hash:B.hash}},push:E,replace:R,go(L){return f.go(L)}};return D}var by;(function(o){o.data="data",o.deferred="deferred",o.redirect="redirect",o.error="error"})(by||(by={}));function U4(o,t,n){return n===void 0&&(n="/"),B4(o,t,n)}function B4(o,t,n,a){let r=typeof t=="string"?mf(t):t,l=M2(r.pathname||"/",n);if(l==null)return null;let f=O2(o);z4(f);let d=null;for(let g=0;d==null&&g<f.length;++g){let m=X4(l);d=Y4(f[g],m)}return d}function O2(o,t,n,a){t===void 0&&(t=[]),n===void 0&&(n=[]),a===void 0&&(a="");let r=(l,f,d)=>{let g={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:f,route:l};g.relativePath.startsWith("/")&&(wa(g.relativePath.startsWith(a),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(a.length));let m=_u([a,g.relativePath]),_=n.concat(g);l.children&&l.children.length>0&&(wa(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),O2(l.children,t,_,m)),!(l.path==null&&!l.index)&&t.push({path:m,score:q4(m,l.index),routesMeta:_})};return o.forEach((l,f)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))r(l,f);else for(let g of x2(l.path))r(l,f,g)}),t}function x2(o){let t=o.split("/");if(t.length===0)return[];let[n,...a]=t,r=n.endsWith("?"),l=n.replace(/\?$/,"");if(a.length===0)return r?[l,""]:[l];let f=x2(a.join("/")),d=[];return d.push(...f.map(g=>g===""?l:[l,g].join("/"))),r&&d.push(...f),d.map(g=>o.startsWith("/")&&g===""?"/":g)}function z4(o){o.sort((t,n)=>t.score!==n.score?n.score-t.score:V4(t.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}const L4=/^:[\w-]+$/,P4=3,G4=2,H4=1,I4=10,k4=-2,_y=o=>o==="*";function q4(o,t){let n=o.split("/"),a=n.length;return n.some(_y)&&(a+=k4),t&&(a+=G4),n.filter(r=>!_y(r)).reduce((r,l)=>r+(L4.test(l)?P4:l===""?H4:I4),a)}function V4(o,t){return o.length===t.length&&o.slice(0,-1).every((a,r)=>a===t[r])?o[o.length-1]-t[t.length-1]:0}function Y4(o,t,n){let{routesMeta:a}=o,r={},l="/",f=[];for(let d=0;d<a.length;++d){let g=a[d],m=d===a.length-1,_=l==="/"?t:t.slice(l.length)||"/",C=K4({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},_),E=g.route;if(!C)return null;Object.assign(r,C.params),f.push({params:r,pathname:_u([l,C.pathname]),pathnameBase:t3(_u([l,C.pathnameBase])),route:E}),C.pathnameBase!=="/"&&(l=_u([l,C.pathnameBase]))}return f}function K4(o,t){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[n,a]=Q4(o.path,o.caseSensitive,o.end),r=t.match(n);if(!r)return null;let l=r[0],f=l.replace(/(.)\/+$/,"$1"),d=r.slice(1);return{params:a.reduce((m,_,C)=>{let{paramName:E,isOptional:R}=_;if(E==="*"){let D=d[C]||"";f=l.slice(0,l.length-D.length).replace(/(.)\/+$/,"$1")}const v=d[C];return R&&!v?m[E]=void 0:m[E]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:f,pattern:o}}function Q4(o,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),w2(o==="*"||!o.endsWith("*")||o.endsWith("/*"),'Route path "'+o+'" will be treated as if it were '+('"'+o.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+o.replace(/\*$/,"/*")+'".'));let a=[],r="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,d,g)=>(a.push({paramName:d,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(a.push({paramName:"*"}),r+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":o!==""&&o!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function X4(o){try{return o.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return w2(!1,'The URL path "'+o+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),o}}function M2(o,t){if(t==="/")return o;if(!o.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=o.charAt(n);return a&&a!=="/"?null:o.slice(n)||"/"}function F4(o,t){t===void 0&&(t="/");let{pathname:n,search:a="",hash:r=""}=typeof o=="string"?mf(o):o;return{pathname:n?n.startsWith("/")?n:J4(n,t):t,search:e3(a),hash:n3(r)}}function J4(o,t){let n=t.replace(/\/+$/,"").split("/");return o.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Ap(o,t,n,a){return"Cannot include a '"+o+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Z4(o){return o.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function W4(o,t){let n=Z4(o);return t?n.map((a,r)=>r===n.length-1?a.pathname:a.pathnameBase):n.map(a=>a.pathnameBase)}function $4(o,t,n,a){a===void 0&&(a=!1);let r;typeof o=="string"?r=mf(o):(r=fh({},o),wa(!r.pathname||!r.pathname.includes("?"),Ap("?","pathname","search",r)),wa(!r.pathname||!r.pathname.includes("#"),Ap("#","pathname","hash",r)),wa(!r.search||!r.search.includes("#"),Ap("#","search","hash",r)));let l=o===""||r.pathname==="",f=l?"/":r.pathname,d;if(f==null)d=n;else{let C=t.length-1;if(!a&&f.startsWith("..")){let E=f.split("/");for(;E[0]==="..";)E.shift(),C-=1;r.pathname=E.join("/")}d=C>=0?t[C]:"/"}let g=F4(r,d),m=f&&f!=="/"&&f.endsWith("/"),_=(l||f===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(m||_)&&(g.pathname+="/"),g}const _u=o=>o.join("/").replace(/\/\/+/g,"/"),t3=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),e3=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,n3=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function a3(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}const N2=["post","put","patch","delete"];new Set(N2);const i3=["get",...N2];new Set(i3);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dh(){return dh=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},dh.apply(this,arguments)}const Zm=st.createContext(null),r3=st.createContext(null),wg=st.createContext(null),Rg=st.createContext(null),vf=st.createContext({outlet:null,matches:[],isDataRoute:!1}),D2=st.createContext(null);function Og(){return st.useContext(Rg)!=null}function Wm(){return Og()||wa(!1),st.useContext(Rg).location}function j2(o){st.useContext(wg).static||st.useLayoutEffect(o)}function yf(){let{isDataRoute:o}=st.useContext(vf);return o?y3():s3()}function s3(){Og()||wa(!1);let o=st.useContext(Zm),{basename:t,future:n,navigator:a}=st.useContext(wg),{matches:r}=st.useContext(vf),{pathname:l}=Wm(),f=JSON.stringify(W4(r,n.v7_relativeSplatPath)),d=st.useRef(!1);return j2(()=>{d.current=!0}),st.useCallback(function(m,_){if(_===void 0&&(_={}),!d.current)return;if(typeof m=="number"){a.go(m);return}let C=$4(m,JSON.parse(f),l,_.relative==="path");o==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:_u([t,C.pathname])),(_.replace?a.replace:a.push)(C,_.state,_)},[t,a,f,l,o])}function o3(o,t){return l3(o,t)}function l3(o,t,n,a){Og()||wa(!1);let{navigator:r}=st.useContext(wg),{matches:l}=st.useContext(vf),f=l[l.length-1],d=f?f.params:{};f&&f.pathname;let g=f?f.pathnameBase:"/";f&&f.route;let m=Wm(),_;if(t){var C;let L=typeof t=="string"?mf(t):t;g==="/"||(C=L.pathname)!=null&&C.startsWith(g)||wa(!1),_=L}else _=m;let E=_.pathname||"/",R=E;if(g!=="/"){let L=g.replace(/^\//,"").split("/");R="/"+E.replace(/^\//,"").split("/").slice(L.length).join("/")}let v=U4(o,{pathname:R}),D=h3(v&&v.map(L=>Object.assign({},L,{params:Object.assign({},d,L.params),pathname:_u([g,r.encodeLocation?r.encodeLocation(L.pathname).pathname:L.pathname]),pathnameBase:L.pathnameBase==="/"?g:_u([g,r.encodeLocation?r.encodeLocation(L.pathnameBase).pathname:L.pathnameBase])})),l,n,a);return t&&D?st.createElement(Rg.Provider,{value:{location:dh({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:gl.Pop}},D):D}function u3(){let o=v3(),t=a3(o)?o.status+" "+o.statusText:o instanceof Error?o.message:JSON.stringify(o),n=o instanceof Error?o.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return st.createElement(st.Fragment,null,st.createElement("h2",null,"Unexpected Application Error!"),st.createElement("h3",{style:{fontStyle:"italic"}},t),n?st.createElement("pre",{style:r},n):null,null)}const c3=st.createElement(u3,null);class f3 extends st.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?st.createElement(vf.Provider,{value:this.props.routeContext},st.createElement(D2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function d3(o){let{routeContext:t,match:n,children:a}=o,r=st.useContext(Zm);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),st.createElement(vf.Provider,{value:t},a)}function h3(o,t,n,a){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),a===void 0&&(a=null),o==null){var l;if(!n)return null;if(n.errors)o=n.matches;else if((l=a)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)o=n.matches;else return null}let f=o,d=(r=n)==null?void 0:r.errors;if(d!=null){let _=f.findIndex(C=>C.route.id&&(d==null?void 0:d[C.route.id])!==void 0);_>=0||wa(!1),f=f.slice(0,Math.min(f.length,_+1))}let g=!1,m=-1;if(n&&a&&a.v7_partialHydration)for(let _=0;_<f.length;_++){let C=f[_];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(m=_),C.route.id){let{loaderData:E,errors:R}=n,v=C.route.loader&&E[C.route.id]===void 0&&(!R||R[C.route.id]===void 0);if(C.route.lazy||v){g=!0,m>=0?f=f.slice(0,m+1):f=[f[0]];break}}}return f.reduceRight((_,C,E)=>{let R,v=!1,D=null,L=null;n&&(R=d&&C.route.id?d[C.route.id]:void 0,D=C.route.errorElement||c3,g&&(m<0&&E===0?(S3("route-fallback"),v=!0,L=null):m===E&&(v=!0,L=C.route.hydrateFallbackElement||null)));let B=t.concat(f.slice(0,E+1)),N=()=>{let M;return R?M=D:v?M=L:C.route.Component?M=st.createElement(C.route.Component,null):C.route.element?M=C.route.element:M=_,st.createElement(d3,{match:C,routeContext:{outlet:_,matches:B,isDataRoute:n!=null},children:M})};return n&&(C.route.ErrorBoundary||C.route.errorElement||E===0)?st.createElement(f3,{location:n.location,revalidation:n.revalidation,component:D,error:R,children:N(),routeContext:{outlet:null,matches:B,isDataRoute:!0}}):N()},null)}var U2=(function(o){return o.UseBlocker="useBlocker",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o})(U2||{}),B2=(function(o){return o.UseBlocker="useBlocker",o.UseLoaderData="useLoaderData",o.UseActionData="useActionData",o.UseRouteError="useRouteError",o.UseNavigation="useNavigation",o.UseRouteLoaderData="useRouteLoaderData",o.UseMatches="useMatches",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o.UseRouteId="useRouteId",o})(B2||{});function g3(o){let t=st.useContext(Zm);return t||wa(!1),t}function p3(o){let t=st.useContext(r3);return t||wa(!1),t}function m3(o){let t=st.useContext(vf);return t||wa(!1),t}function z2(o){let t=m3(),n=t.matches[t.matches.length-1];return n.route.id||wa(!1),n.route.id}function v3(){var o;let t=st.useContext(D2),n=p3(),a=z2();return t!==void 0?t:(o=n.errors)==null?void 0:o[a]}function y3(){let{router:o}=g3(U2.UseNavigateStable),t=z2(B2.UseNavigateStable),n=st.useRef(!1);return j2(()=>{n.current=!0}),st.useCallback(function(r,l){l===void 0&&(l={}),n.current&&(typeof r=="number"?o.navigate(r):o.navigate(r,dh({fromRouteId:t},l)))},[o,t])}const Ey={};function S3(o,t,n){Ey[o]||(Ey[o]=!0)}function b3(o,t){o==null||o.v7_startTransition,o==null||o.v7_relativeSplatPath}function gu(o){wa(!1)}function _3(o){let{basename:t="/",children:n=null,location:a,navigationType:r=gl.Pop,navigator:l,static:f=!1,future:d}=o;Og()&&wa(!1);let g=t.replace(/^\/*/,"/"),m=st.useMemo(()=>({basename:g,navigator:l,static:f,future:dh({v7_relativeSplatPath:!1},d)}),[g,d,l,f]);typeof a=="string"&&(a=mf(a));let{pathname:_="/",search:C="",hash:E="",state:R=null,key:v="default"}=a,D=st.useMemo(()=>{let L=M2(_,g);return L==null?null:{location:{pathname:L,search:C,hash:E,state:R,key:v},navigationType:r}},[g,_,C,E,R,v,r]);return D==null?null:st.createElement(wg.Provider,{value:m},st.createElement(Rg.Provider,{children:n,value:D}))}function E3(o){let{children:t,location:n}=o;return o3(Am(t),n)}new Promise(()=>{});function Am(o,t){t===void 0&&(t=[]);let n=[];return st.Children.forEach(o,(a,r)=>{if(!st.isValidElement(a))return;let l=[...t,r];if(a.type===st.Fragment){n.push.apply(n,Am(a.props.children,l));return}a.type!==gu&&wa(!1),!a.props.index||!a.props.children||wa(!1);let f={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(f.children=Am(a.props.children,l)),n.push(f)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wm(o){return o===void 0&&(o=""),new URLSearchParams(typeof o=="string"||Array.isArray(o)||o instanceof URLSearchParams?o:Object.keys(o).reduce((t,n)=>{let a=o[n];return t.concat(Array.isArray(a)?a.map(r=>[n,r]):[[n,a]])},[]))}function C3(o,t){let n=wm(o);return t&&t.forEach((a,r)=>{n.has(r)||t.getAll(r).forEach(l=>{n.append(r,l)})}),n}const T3="6";try{window.__reactRouterVersion=T3}catch{}const A3="startTransition",Cy=C4[A3];function w3(o){let{basename:t,children:n,future:a,window:r}=o,l=st.useRef();l.current==null&&(l.current=N4({window:r,v5Compat:!0}));let f=l.current,[d,g]=st.useState({action:f.action,location:f.location}),{v7_startTransition:m}=a||{},_=st.useCallback(C=>{m&&Cy?Cy(()=>g(C)):g(C)},[g,m]);return st.useLayoutEffect(()=>f.listen(_),[f,_]),st.useEffect(()=>b3(a),[a]),st.createElement(_3,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:f,future:a})}var Ty;(function(o){o.UseScrollRestoration="useScrollRestoration",o.UseSubmit="useSubmit",o.UseSubmitFetcher="useSubmitFetcher",o.UseFetcher="useFetcher",o.useViewTransitionState="useViewTransitionState"})(Ty||(Ty={}));var Ay;(function(o){o.UseFetcher="useFetcher",o.UseFetchers="useFetchers",o.UseScrollRestoration="useScrollRestoration"})(Ay||(Ay={}));function Sh(o){let t=st.useRef(wm(o)),n=st.useRef(!1),a=Wm(),r=st.useMemo(()=>C3(a.search,n.current?null:t.current),[a.search]),l=yf(),f=st.useCallback((d,g)=>{const m=wm(typeof d=="function"?d(r):d);n.current=!0,l("?"+m,g)},[l,r]);return[r,f]}function R3(){const o=yf(),[t,n]=st.useState(!1),[a,r]=st.useState(""),[l,f]=st.useState("demo"),d=g=>{g.preventDefault(),a.trim()&&l.trim()&&o(`/student?room=${l}&name=${encodeURIComponent(a.trim())}`)};return t?k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsx("div",{className:"glass-surface landing-container",style:{maxWidth:"500px"},children:k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",style:{fontSize:"2rem"},children:"Join as Student"}),k.jsx("p",{className:"landing-description",children:"Enter your name and room code to start drawing"})]}),k.jsxs("form",{onSubmit:d,style:{width:"100%",marginTop:"2rem"},children:[k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"studentName",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Your Name"}),k.jsx("input",{id:"studentName",type:"text",value:a,onChange:g=>r(g.target.value),placeholder:"Enter your name",autoFocus:!0,required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"roomCode",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Room Code"}),k.jsx("input",{id:"roomCode",type:"text",value:l,onChange:g=>f(g.target.value.toUpperCase()),placeholder:"Enter room code",required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s",fontFamily:"monospace",letterSpacing:"2px"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[k.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"2px solid #ddd",borderRadius:"8px",background:"white",cursor:"pointer",transition:"all 0.2s"},children:" Back"}),k.jsx("button",{type:"submit",style:{flex:2,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:g=>g.target.style.transform="translateY(-2px)",onMouseOut:g=>g.target.style.transform="translateY(0)",children:"Join Room "})]})]})]})})})]}):k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsxs("div",{className:"glass-surface landing-container",children:[k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",children:"Teach visually. Collaborate instantly."}),k.jsx("p",{className:"landing-description",children:"Feather streams pencil-perfect strokes between teachers and students in real time. Instant sync, buttery smooth annotation tools, and delightful classroom-ready controls built for iPad and stylus workflows."})]}),k.jsxs("dl",{className:"features",children:[k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Palm rejection"}),k.jsx("dd",{className:"feature-subtitle",children:"Silky palm drawing"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Frameless logos"}),k.jsx("dd",{className:"feature-subtitle",children:"Delightful annotations"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Realtime sync"}),k.jsx("dd",{className:"feature-subtitle",children:"Sub-second latency"})]})]})]}),k.jsxs("div",{className:"workspace-section",children:[k.jsx("p",{className:"workspace-label",children:"PICK YOUR WORKSPACE"}),k.jsxs("div",{className:"workspace-cards",children:[k.jsxs("a",{onClick:()=>o("/teacher"),className:"glass-button teacher-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Teacher dashboard"}),k.jsx("p",{className:"workspace-description",children:"Monitor your students, sync views, and annotate the board. Assign templates/images, and manage the class."})]}),k.jsx("span",{className:"workspace-emoji",children:""})]}),k.jsxs("a",{onClick:()=>o("/student-login"),className:"glass-button student-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Student workspace"}),k.jsx("p",{className:"workspace-description",children:"Sketch on a public or draw alongside the class, with undo/redo, templates, and stylus-first controls."})]}),k.jsx("span",{className:"workspace-emoji",children:""})]})]})]})]})})]})}const O3=Math.PI/180;function x3(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const Su=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Jt={_global:Su,version:"10.0.7",isBrowser:x3(),isUnminified:/param/.test((function(o){}).toString()),dblClickWindow:400,getAngle(o){return Jt.angleDeg?o*O3:o},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Jt.DD.isDragging},isTransforming(){var o,t;return(t=(o=Jt.Transformer)===null||o===void 0?void 0:o.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!Jt.DD.node},releaseCanvasOnDestroy:!0,document:Su.document,_injectGlobal(o){typeof Su.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),Su.Konva=o}},$n=o=>{Jt[o.prototype.getClassName()]=o};Jt._injectGlobal(Jt);const M3=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,wy=()=>{if(typeof document>"u")throw new Error(M3)};class Ii{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Ii(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const n=this.m;return{x:n[0]*t.x+n[2]*t.y+n[4],y:n[1]*t.x+n[3]*t.y+n[5]}}translate(t,n){return this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n,this}scale(t,n){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n,this}rotate(t){const n=Math.cos(t),a=Math.sin(t),r=this.m[0]*n+this.m[2]*a,l=this.m[1]*n+this.m[3]*a,f=this.m[0]*-a+this.m[2]*n,d=this.m[1]*-a+this.m[3]*n;return this.m[0]=r,this.m[1]=l,this.m[2]=f,this.m[3]=d,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,n){const a=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,l=this.m[2]+this.m[0]*t,f=this.m[3]+this.m[1]*t;return this.m[0]=a,this.m[1]=r,this.m[2]=l,this.m[3]=f,this}multiply(t){const n=this.m[0]*t.m[0]+this.m[2]*t.m[1],a=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],l=this.m[1]*t.m[2]+this.m[3]*t.m[3],f=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],d=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=l,this.m[4]=f,this.m[5]=d,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,a=-this.m[1]*t,r=-this.m[2]*t,l=this.m[0]*t,f=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),d=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=l,this.m[4]=f,this.m[5]=d,this}getMatrix(){return this.m}decompose(){const t=this.m[0],n=this.m[1],a=this.m[2],r=this.m[3],l=this.m[4],f=this.m[5],d=t*r-n*a,g={x:l,y:f,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){const m=Math.sqrt(t*t+n*n);g.rotation=n>0?Math.acos(t/m):-Math.acos(t/m),g.scaleX=m,g.scaleY=d/m,g.skewX=(t*a+n*r)/d,g.skewY=0}else if(a!=0||r!=0){const m=Math.sqrt(a*a+r*r);g.rotation=Math.PI/2-(r>0?Math.acos(-a/m):-Math.acos(a/m)),g.scaleX=d/m,g.scaleY=m,g.skewX=0,g.skewY=(t*a+n*r)/d}return g.rotation=mt._getRotation(g.rotation),g}}const N3="[object Array]",D3="[object Number]",j3="[object String]",U3="[object Boolean]",B3=Math.PI/180,z3=180/Math.PI,wp="#",L3="",P3="0",G3="Konva warning: ",Ry="Konva error: ",H3="rgb(",Rp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},I3=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let K0=[];const k3=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(o){setTimeout(o,60)},mt={_isElement(o){return!!(o&&o.nodeType==1)},_isFunction(o){return!!(o&&o.constructor&&o.call&&o.apply)},_isPlainObject(o){return!!o&&o.constructor===Object},_isArray(o){return Object.prototype.toString.call(o)===N3},_isNumber(o){return Object.prototype.toString.call(o)===D3&&!isNaN(o)&&isFinite(o)},_isString(o){return Object.prototype.toString.call(o)===j3},_isBoolean(o){return Object.prototype.toString.call(o)===U3},isObject(o){return o instanceof Object},isValidSelector(o){if(typeof o!="string")return!1;const t=o[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(o){return o===0||o>0?1:-1},requestAnimFrame(o){K0.push(o),K0.length===1&&k3(function(){const t=K0;K0=[],t.forEach(function(n){n()})})},createCanvasElement(){wy();const o=document.createElement("canvas");try{o.style=o.style||{}}catch{}return o},createImageElement(){return wy(),document.createElement("img")},_isInDocument(o){for(;o=o.parentNode;)if(o==document)return!0;return!1},_urlToImage(o,t){const n=mt.createImageElement();n.onload=function(){t(n)},n.src=o},_rgbToHex(o,t,n){return((1<<24)+(o<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(o){o=o.replace(wp,L3);const t=parseInt(o,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let o=(Math.random()*16777215<<0).toString(16);for(;o.length<6;)o=P3+o;return wp+o},getRGB(o){let t;return o in Rp?(t=Rp[o],{r:t[0],g:t[1],b:t[2]}):o[0]===wp?this._hexToRgb(o.substring(1)):o.substr(0,4)===H3?(t=I3.exec(o.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(o){return o=o||"black",mt._namedColorToRBA(o)||mt._hex3ColorToRGBA(o)||mt._hex4ColorToRGBA(o)||mt._hex6ColorToRGBA(o)||mt._hex8ColorToRGBA(o)||mt._rgbColorToRGBA(o)||mt._rgbaColorToRGBA(o)||mt._hslColorToRGBA(o)},_namedColorToRBA(o){const t=Rp[o.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(o){if(o.indexOf("rgb(")===0){o=o.match(/rgb\(([^)]+)\)/)[1];const t=o.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(o){if(o.indexOf("rgba(")===0){o=o.match(/rgba\(([^)]+)\)/)[1];const t=o.split(/ *, */).map((n,a)=>n.slice(-1)==="%"?a===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(o){if(o[0]==="#"&&o.length===9)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:parseInt(o.slice(7,9),16)/255}},_hex6ColorToRGBA(o){if(o[0]==="#"&&o.length===7)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:1}},_hex4ColorToRGBA(o){if(o[0]==="#"&&o.length===5)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:parseInt(o[4]+o[4],16)/255}},_hex3ColorToRGBA(o){if(o[0]==="#"&&o.length===4)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:1}},_hslColorToRGBA(o){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(o)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o),a=Number(n[0])/360,r=Number(n[1])/100,l=Number(n[2])/100;let f,d,g;if(r===0)return g=l*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};l<.5?f=l*(1+r):f=l+r-l*r;const m=2*l-f,_=[0,0,0];for(let C=0;C<3;C++)d=a+1/3*-(C-1),d<0&&d++,d>1&&d--,6*d<1?g=m+(f-m)*6*d:2*d<1?g=f:3*d<2?g=m+(f-m)*(2/3-d)*6:g=m,_[C]=g*255;return{r:Math.round(_[0]),g:Math.round(_[1]),b:Math.round(_[2]),a:1}}},haveIntersection(o,t){return!(t.x>o.x+o.width||t.x+t.width<o.x||t.y>o.y+o.height||t.y+t.height<o.y)},cloneObject(o){const t={};for(const n in o)this._isPlainObject(o[n])?t[n]=this.cloneObject(o[n]):this._isArray(o[n])?t[n]=this.cloneArray(o[n]):t[n]=o[n];return t},cloneArray(o){return o.slice(0)},degToRad(o){return o*B3},radToDeg(o){return o*z3},_degToRad(o){return mt.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),mt.degToRad(o)},_radToDeg(o){return mt.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),mt.radToDeg(o)},_getRotation(o){return Jt.angleDeg?mt.radToDeg(o):o},_capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},throw(o){throw new Error(Ry+o)},error(o){console.error(Ry+o)},warn(o){Jt.showWarnings&&console.warn(G3+o)},each(o,t){for(const n in o)t(n,o[n])},_inRange(o,t,n){return t<=o&&o<n},_getProjectionToSegment(o,t,n,a,r,l){let f,d,g;const m=(o-n)*(o-n)+(t-a)*(t-a);if(m==0)f=o,d=t,g=(r-n)*(r-n)+(l-a)*(l-a);else{const _=((r-o)*(n-o)+(l-t)*(a-t))/m;_<0?(f=o,d=t,g=(o-r)*(o-r)+(t-l)*(t-l)):_>1?(f=n,d=a,g=(n-r)*(n-r)+(a-l)*(a-l)):(f=o+_*(n-o),d=t+_*(a-t),g=(f-r)*(f-r)+(d-l)*(d-l))}return[f,d,g]},_getProjectionToLine(o,t,n){const a=mt.cloneObject(o);let r=Number.MAX_VALUE;return t.forEach(function(l,f){if(!n&&f===t.length-1)return;const d=t[(f+1)%t.length],g=mt._getProjectionToSegment(l.x,l.y,d.x,d.y,o.x,o.y),m=g[0],_=g[1],C=g[2];C<r&&(a.x=m,a.y=_,r=C)}),a},_prepareArrayForTween(o,t,n){const a=[],r=[];if(o.length>t.length){const f=t;t=o,o=f}for(let f=0;f<o.length;f+=2)a.push({x:o[f],y:o[f+1]});for(let f=0;f<t.length;f+=2)r.push({x:t[f],y:t[f+1]});const l=[];return r.forEach(function(f){const d=mt._getProjectionToLine(f,a,n);l.push(d.x),l.push(d.y)}),l},_prepareToStringify(o){let t;o.visitedByCircularReferenceRemoval=!0;for(const n in o)if(o.hasOwnProperty(n)&&o[n]&&typeof o[n]=="object"){if(t=Object.getOwnPropertyDescriptor(o,n),o[n].visitedByCircularReferenceRemoval||mt._isElement(o[n]))if(t.configurable)delete o[n];else return null;else if(mt._prepareToStringify(o[n])===null)if(t.configurable)delete o[n];else return null}return delete o.visitedByCircularReferenceRemoval,o},_assign(o,t){for(const n in t)o[n]=t[n];return o},_getFirstPointerId(o){return o.touches?o.changedTouches[0].identifier:o.pointerId||999},releaseCanvas(...o){Jt.releaseCanvasOnDestroy&&o.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(o,t,n,a){let r=t<0?t:0,l=n<0?n:0;t=Math.abs(t),n=Math.abs(n);let f=0,d=0,g=0,m=0;typeof a=="number"?f=d=g=m=Math.min(a,t/2,n/2):(f=Math.min(a[0]||0,t/2,n/2),d=Math.min(a[1]||0,t/2,n/2),m=Math.min(a[2]||0,t/2,n/2),g=Math.min(a[3]||0,t/2,n/2)),o.moveTo(r+f,l),o.lineTo(r+t-d,l),o.arc(r+t-d,l+d,d,Math.PI*3/2,0,!1),o.lineTo(r+t,l+n-m),o.arc(r+t-m,l+n-m,m,0,Math.PI/2,!1),o.lineTo(r+g,l+n),o.arc(r+g,l+n-g,g,Math.PI/2,Math.PI,!1),o.lineTo(r,l+f),o.arc(r+f,l+f,f,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(o,t,n,a,r){a=Math.abs(a);for(let l=0;l<n;l++){const f=t[(l-1+n)%n],d=t[l],g=t[(l+1)%n],m={x:d.x-f.x,y:d.y-f.y},_={x:g.x-d.x,y:g.y-d.y},C=Math.hypot(m.x,m.y),E=Math.hypot(_.x,_.y);let R;typeof r=="number"?R=r:R=l<r.length?r[l]:0,R=a*Math.cos(Math.PI/n)*Math.min(1,R/a*2);const D={x:m.x/C,y:m.y/C},L={x:_.x/E,y:_.y/E},B={x:d.x-D.x*R,y:d.y-D.y*R},N={x:d.x+L.x*R,y:d.y+L.y*R};l===0?o.moveTo(B.x,B.y):o.lineTo(B.x,B.y),o.arcTo(d.x,d.y,N.x,N.y,R)}}};function q3(o){const t=[],n=o.length,a=mt;for(let r=0;r<n;r++){let l=o[r];a._isNumber(l)?l=Math.round(l*1e3)/1e3:a._isString(l)||(l=l+""),t.push(l)}return t}const Oy=",",V3="(",Y3=")",K3="([",Q3="])",X3=";",F3="()",J3="=",xy=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],Z3=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],W3=100;let Q0=null;function My(){if(Q0!==null)return Q0;try{const t=mt.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Q0=!1,!1)}catch{return Q0=!1,!1}}class xg{constructor(t){this.canvas=t,Jt.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,n){let a=this.traceArr,r=a.length,l="",f,d,g,m;for(f=0;f<r;f++)d=a[f],g=d.method,g?(m=d.args,l+=g,t?l+=F3:mt._isArray(m[0])?l+=K3+m.join(Oy)+Q3:(n&&(m=m.map(_=>typeof _=="number"?Math.floor(_):_)),l+=V3+m.join(Oy)+Y3)):(l+=d.property,t||(l+=J3+d.val)),l+=X3;return l}clearTrace(){this.traceArr=[]}_trace(t){let n=this.traceArr,a;n.push(t),a=n.length,a>=W3&&n.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const n=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(t){const n=t.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(t){const n=t.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(t){const n=t.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(t){const n=t.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(t,n){this._context[t]=n}arc(t,n,a,r,l,f){this._context.arc(t,n,a,r,l,f)}arcTo(t,n,a,r,l){this._context.arcTo(t,n,a,r,l)}beginPath(){this._context.beginPath()}bezierCurveTo(t,n,a,r,l,f){this._context.bezierCurveTo(t,n,a,r,l,f)}clearRect(t,n,a,r){this._context.clearRect(t,n,a,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,n){const a=arguments;if(a.length===2)return this._context.createImageData(t,n);if(a.length===1)return this._context.createImageData(t)}createLinearGradient(t,n,a,r){return this._context.createLinearGradient(t,n,a,r)}createPattern(t,n){return this._context.createPattern(t,n)}createRadialGradient(t,n,a,r,l,f){return this._context.createRadialGradient(t,n,a,r,l,f)}drawImage(t,n,a,r,l,f,d,g,m){const _=arguments,C=this._context;_.length===3?C.drawImage(t,n,a):_.length===5?C.drawImage(t,n,a,r,l):_.length===9&&C.drawImage(t,n,a,r,l,f,d,g,m)}ellipse(t,n,a,r,l,f,d,g){this._context.ellipse(t,n,a,r,l,f,d,g)}isPointInPath(t,n,a,r){return a?this._context.isPointInPath(a,t,n,r):this._context.isPointInPath(t,n,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,n,a,r){this._context.fillRect(t,n,a,r)}strokeRect(t,n,a,r){this._context.strokeRect(t,n,a,r)}fillText(t,n,a,r){r?this._context.fillText(t,n,a,r):this._context.fillText(t,n,a)}measureText(t){return this._context.measureText(t)}getImageData(t,n,a,r){return this._context.getImageData(t,n,a,r)}lineTo(t,n){this._context.lineTo(t,n)}moveTo(t,n){this._context.moveTo(t,n)}rect(t,n,a,r){this._context.rect(t,n,a,r)}roundRect(t,n,a,r,l){this._context.roundRect(t,n,a,r,l)}putImageData(t,n,a){this._context.putImageData(t,n,a)}quadraticCurveTo(t,n,a,r){this._context.quadraticCurveTo(t,n,a,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,n){this._context.scale(t,n)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,n,a,r,l,f){this._context.setTransform(t,n,a,r,l,f)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,n,a,r){this._context.strokeText(t,n,a,r)}transform(t,n,a,r,l,f){this._context.transform(t,n,a,r,l,f)}translate(t,n){this._context.translate(t,n)}_enableTrace(){let t=this,n=xy.length,a=this.setAttr,r,l;const f=function(d){let g=t[d],m;t[d]=function(){return l=q3(Array.prototype.slice.call(arguments,0)),m=g.apply(t,arguments),t._trace({method:d,args:l}),m}};for(r=0;r<n;r++)f(xy[r]);t.setAttr=function(){a.apply(t,arguments);const d=arguments[0];let g=arguments[1];(d==="shadowOffsetX"||d==="shadowOffsetY"||d==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),t._trace({property:d,val:g})}}_applyGlobalCompositeOperation(t){const n=t.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}Z3.forEach(function(o){Object.defineProperty(xg.prototype,o,{get(){return this._context[o]},set(t){this._context[o]=t}})});class $3 extends xg{constructor(t,{willReadFrequently:n=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(t){const n=t.fill();this.setAttr("fillStyle",n),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const n=t._getLinearGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fillRadialGradient(t){const n=t._getRadialGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fill(t){const n=t.fill(),a=t.getFillPriority();if(n&&a==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&a==="pattern"){this._fillPattern(t);return}const l=t.getFillLinearGradientColorStops();if(l&&a==="linear-gradient"){this._fillLinearGradient(t);return}const f=t.getFillRadialGradientColorStops();if(f&&a==="radial-gradient"){this._fillRadialGradient(t);return}n?this._fillColor(t):r?this._fillPattern(t):l?this._fillLinearGradient(t):f&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const n=t.getStrokeLinearGradientStartPoint(),a=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),l=this.createLinearGradient(n.x,n.y,a.x,a.y);if(r){for(let f=0;f<r.length;f+=2)l.addColorStop(r[f],r[f+1]);this.setAttr("strokeStyle",l)}}_stroke(t){const n=t.dash(),a=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!a){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t),n&&t.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),a||this.restore()}}_applyShadow(t){var n,a,r;const l=(n=t.getShadowRGBA())!==null&&n!==void 0?n:"black",f=(a=t.getShadowBlur())!==null&&a!==void 0?a:5,d=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},g=t.getAbsoluteScale(),m=this.canvas.getPixelRatio(),_=g.x*m,C=g.y*m;this.setAttr("shadowColor",l),this.setAttr("shadowBlur",f*Math.min(Math.abs(_),Math.abs(C))),this.setAttr("shadowOffsetX",d.x*_),this.setAttr("shadowOffsetY",d.y*C)}}class t5 extends xg{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const n=t.getStrokeScaleEnabled();if(!n){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t);const a=t.hitStrokeWidth(),r=a==="auto"?t.strokeWidth():a;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),n||this.restore()}}}let X0;function e5(){if(X0)return X0;const o=mt.createCanvasElement(),t=o.getContext("2d");return X0=(function(){const n=Jt._global.devicePixelRatio||1,a=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/a})(),mt.releaseCanvas(o),X0}class $m{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const a=(t||{}).pixelRatio||Jt.pixelRatio||e5();this.pixelRatio=a,this._canvas=mt.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const n=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,n){this.setWidth(t||0),this.setHeight(n||0)}toDataURL(t,n){try{return this._canvas.toDataURL(t,n)}catch{try{return this._canvas.toDataURL()}catch(r){return mt.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class dl extends $m{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new $3(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function Ny(){const o=mt.createCanvasElement();o.width=1,o.height=1;const t=o.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data;return!(n[0]===255&&n[1]===0&&n[2]===255&&n[3]===255)}function Dy(){var o,t;return typeof navigator>"u"?!1:(t=(o=navigator.brave)===null||o===void 0?void 0:o.isBrave())!==null&&t!==void 0?t:!1}let jy=!1;function n5(){return Dy()&&Ny()&&!jy&&(jy=!0,mt.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),Dy()&&Ny()}class tv extends $m{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new t5(this),this.setSize(t.width,t.height),n5()}}const Sn={get isDragging(){let o=!1;return Sn._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(o=!0)}),o},justDragged:!1,get node(){let o;return Sn._dragElements.forEach(t=>{o=t.node}),o},_dragElements:new Map,_drag(o){const t=[];Sn._dragElements.forEach((n,a)=>{const{node:r}=n,l=r.getStage();l.setPointersPositions(o),n.pointerId===void 0&&(n.pointerId=mt._getFirstPointerId(o));const f=l._changedPointerPositions.find(d=>d.id===n.pointerId);if(f){if(n.dragStatus!=="dragging"){const d=r.dragDistance();if(Math.max(Math.abs(f.x-n.startPointerPos.x),Math.abs(f.y-n.startPointerPos.y))<d||(r.startDrag({evt:o}),!r.isDragging()))return}r._setDragPosition(o,n),t.push(r)}}),t.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:o},!0)})},_endDragBefore(o){const t=[];Sn._dragElements.forEach(n=>{const{node:a}=n,r=a.getStage();if(o&&r.setPointersPositions(o),!r._changedPointerPositions.find(d=>d.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(Sn.justDragged=!0,Jt._mouseListenClick=!1,Jt._touchListenClick=!1,Jt._pointerListenClick=!1,n.dragStatus="stopped");const f=n.node.getLayer()||n.node instanceof Jt.Stage&&n.node;f&&t.indexOf(f)===-1&&t.push(f)}),t.forEach(n=>{n.draw()})},_endDragAfter(o){Sn._dragElements.forEach((t,n)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:o},!0),t.dragStatus!=="dragging"&&Sn._dragElements.delete(n)})}};Jt.isBrowser&&(window.addEventListener("mouseup",Sn._endDragBefore,!0),window.addEventListener("touchend",Sn._endDragBefore,!0),window.addEventListener("touchcancel",Sn._endDragBefore,!0),window.addEventListener("mousemove",Sn._drag),window.addEventListener("touchmove",Sn._drag),window.addEventListener("mouseup",Sn._endDragAfter,!1),window.addEventListener("touchend",Sn._endDragAfter,!1),window.addEventListener("touchcancel",Sn._endDragAfter,!1));function ml(o){return mt._isString(o)?'"'+o+'"':Object.prototype.toString.call(o)==="[object Number]"||mt._isBoolean(o)?o:Object.prototype.toString.call(o)}function L2(o){return o>255?255:o<0?0:Math.round(o)}function Kt(){if(Jt.isUnminified)return function(o,t){return mt._isNumber(o)||mt.warn(ml(o)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),o}}function Mg(o){if(Jt.isUnminified)return function(t,n){let a=mt._isNumber(t),r=mt._isArray(t)&&t.length==o;return!a&&!r&&mt.warn(ml(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+o+")"),t}}function ev(){if(Jt.isUnminified)return function(o,t){return mt._isNumber(o)||o==="auto"||mt.warn(ml(o)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),o}}function Eu(){if(Jt.isUnminified)return function(o,t){return mt._isString(o)||mt.warn(ml(o)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),o}}function P2(){if(Jt.isUnminified)return function(o,t){const n=mt._isString(o),a=Object.prototype.toString.call(o)==="[object CanvasGradient]"||o&&o.addColorStop;return n||a||mt.warn(ml(o)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),o}}function a5(){if(Jt.isUnminified)return function(o,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&o instanceof n||(mt._isArray(o)?o.forEach(function(a){mt._isNumber(a)||mt.warn('"'+t+'" attribute has non numeric element '+a+". Make sure that all elements are numbers.")}):mt.warn(ml(o)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),o}}function Qr(){if(Jt.isUnminified)return function(o,t){return o===!0||o===!1||mt.warn(ml(o)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),o}}function i5(o){if(Jt.isUnminified)return function(t,n){return t==null||mt.isObject(t)||mt.warn(ml(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+o),t}}const Xd="get",Fd="set",ot={addGetterSetter(o,t,n,a,r){ot.addGetter(o,t,n),ot.addSetter(o,t,a,r),ot.addOverloadedGetterSetter(o,t)},addGetter(o,t,n){const a=Xd+mt._capitalize(t);o.prototype[a]=o.prototype[a]||function(){const r=this.attrs[t];return r===void 0?n:r}},addSetter(o,t,n,a){const r=Fd+mt._capitalize(t);o.prototype[r]||ot.overWriteSetter(o,t,n,a)},overWriteSetter(o,t,n,a){const r=Fd+mt._capitalize(t);o.prototype[r]=function(l){return n&&l!==void 0&&l!==null&&(l=n.call(this,l,t)),this._setAttr(t,l),a&&a.call(this),this}},addComponentsGetterSetter(o,t,n,a,r){const l=n.length,f=mt._capitalize,d=Xd+f(t),g=Fd+f(t);o.prototype[d]=function(){const _={};for(let C=0;C<l;C++){const E=n[C];_[E]=this.getAttr(t+f(E))}return _};const m=i5(n);o.prototype[g]=function(_){const C=this.attrs[t];a&&(_=a.call(this,_,t)),m&&m.call(this,_,t);for(const E in _)_.hasOwnProperty(E)&&this._setAttr(t+f(E),_[E]);return _||n.forEach(E=>{this._setAttr(t+f(E),void 0)}),this._fireChangeEvent(t,C,_),r&&r.call(this),this},ot.addOverloadedGetterSetter(o,t)},addOverloadedGetterSetter(o,t){const n=mt._capitalize(t),a=Fd+n,r=Xd+n;o.prototype[t]=function(){return arguments.length?(this[a](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(o,t,n,a){mt.error("Adding deprecated "+t);const r=Xd+mt._capitalize(t),l=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[r]=function(){mt.error(l);const f=this.attrs[t];return f===void 0?n:f},ot.addSetter(o,t,a,function(){mt.error(l)}),ot.addOverloadedGetterSetter(o,t)},backCompat(o,t){mt.each(t,function(n,a){const r=o.prototype[a],l=Xd+mt._capitalize(n),f=Fd+mt._capitalize(n);function d(){r.apply(this,arguments),mt.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+a+'" instead.')}o.prototype[n]=d,o.prototype[l]=d,o.prototype[f]=d})},afterSetFilter(){this._filterUpToDate=!1}};function r5(o){const t=/(\w+)\(([^)]+)\)/g;let n;for(;(n=t.exec(o))!==null;){const[,a,r]=n;switch(a){case"blur":{const l=parseFloat(r.replace("px",""));return function(f){this.blurRadius(l*.5);const d=Jt.Filters;d&&d.Blur&&d.Blur.call(this,f)}}case"brightness":{const l=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(f){this.brightness(l);const d=Jt.Filters;d&&d.Brightness&&d.Brightness.call(this,f)}}case"contrast":{const l=parseFloat(r);return function(f){const d=100*(Math.sqrt(l)-1);this.contrast(d);const g=Jt.Filters;g&&g.Contrast&&g.Contrast.call(this,f)}}case"grayscale":return function(l){const f=Jt.Filters;f&&f.Grayscale&&f.Grayscale.call(this,l)};case"sepia":return function(l){const f=Jt.Filters;f&&f.Sepia&&f.Sepia.call(this,l)};case"invert":return function(l){const f=Jt.Filters;f&&f.Invert&&f.Invert.call(this,l)};default:mt.warn(`CSS filter "${a}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const mg="absoluteOpacity",F0="allEventListeners",yo="absoluteTransform",Uy="absoluteScale",cu="canvas",s5="Change",o5="children",l5="konva",Rm="listening",u5="mouseenter",c5="mouseleave",f5="pointerenter",d5="pointerleave",h5="touchenter",g5="touchleave",By="set",zy="Shape",vg=" ",Ly="stage",ul="transform",p5="Stage",Om="visible",m5=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(vg);let v5=1;class Vt{constructor(t){this._id=v5++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===ul||t===yo)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,n){let a=this._cache.get(t);return(a===void 0||(t===ul||t===yo)&&a.dirty===!0)&&(a=n.call(this),this._cache.set(t,a)),a}_calculate(t,n,a){if(!this._attachedDepsListeners.get(t)){const r=n.map(l=>l+"Change.konva").join(vg);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,a)}_getCanvasCache(){return this._cache.get(cu)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===yo&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(cu)){const{scene:t,filter:n,hit:a,buffer:r}=this._cache.get(cu);mt.releaseCanvas(t,n,a,r),this._cache.delete(cu)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const n=t||{};let a={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(a=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(n.width||a.width),l=Math.ceil(n.height||a.height),f=n.pixelRatio,d=n.x===void 0?Math.floor(a.x):n.x,g=n.y===void 0?Math.floor(a.y):n.y,m=n.offset||0,_=n.drawBorder||!1,C=n.hitCanvasPixelRatio||1;if(!r||!l){mt.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const E=Math.abs(Math.round(a.x)-d)>.5?1:0,R=Math.abs(Math.round(a.y)-g)>.5?1:0;r+=m*2+E,l+=m*2+R,d-=m,g-=m;const v=new dl({pixelRatio:f,width:r,height:l}),D=new dl({pixelRatio:f,width:0,height:0,willReadFrequently:!0}),L=new tv({pixelRatio:C,width:r,height:l}),B=v.getContext(),N=L.getContext(),M=new dl({width:v.width/v.pixelRatio+Math.abs(d),height:v.height/v.pixelRatio+Math.abs(g),pixelRatio:v.pixelRatio}),P=M.getContext();return L.isCache=!0,v.isCache=!0,this._cache.delete(cu),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,D.getContext()._context.imageSmoothingEnabled=!1),B.save(),N.save(),P.save(),B.translate(-d,-g),N.translate(-d,-g),P.translate(-d,-g),M.x=d,M.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(mg),this._clearSelfAndDescendantCache(Uy),this.drawScene(v,this,M),this.drawHit(L,this),this._isUnderCache=!1,B.restore(),N.restore(),_&&(B.save(),B.beginPath(),B.rect(0,0,r,l),B.closePath(),B.setAttr("strokeStyle","red"),B.setAttr("lineWidth",5),B.stroke(),B.restore()),this._cache.set(cu,{scene:v,filter:D,hit:L,buffer:M,x:d,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(cu)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,n){const a=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,l=1/0,f=-1/0,d=-1/0;const g=this.getAbsoluteTransform(n);return a.forEach(function(m){const _=g.point(m);r===void 0&&(r=f=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),f=Math.max(f,_.x),d=Math.max(d,_.y)}),{x:r,y:l,width:f-r,height:d-l}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();t.translate(n.x,n.y);const a=this._getCachedSceneCanvas(),r=a.pixelRatio;t.drawImage(a._canvas,0,0,a.width/r,a.height/r),t.restore()}_drawCachedHitCanvas(t){const n=this._getCanvasCache(),a=n.hit;t.save(),t.translate(n.x,n.y),t.drawImage(a._canvas,0,0,a.width/a.pixelRatio,a.height/a.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),n=this._getCanvasCache(),a=n.scene,r=n.filter,l=r.getContext(),f,d,g,m;if(!t||t.length===0)return a;if(this._filterUpToDate)return r;let _=!0;for(let E=0;E<t.length;E++)if(typeof t[E]=="string"&&My(),typeof t[E]!="string"||!My()){_=!1;break}const C=a.pixelRatio;if(r.setSize(a.width/a.pixelRatio,a.height/a.pixelRatio),_){const E=t.join(" ");return l.save(),l.setAttr("filter",E),l.drawImage(a._canvas,0,0,a.getWidth()/C,a.getHeight()/C),l.restore(),this._filterUpToDate=!0,r}try{for(f=t.length,l.clear(),l.drawImage(a._canvas,0,0,a.getWidth()/C,a.getHeight()/C),d=l.getImageData(0,0,r.getWidth(),r.getHeight()),g=0;g<f;g++)m=t[g],typeof m=="string"&&(m=r5(m)),m.call(this,d),l.putImageData(d,0,0)}catch(E){mt.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,n){if(this._cache&&this._cache.delete(F0),arguments.length===3)return this._delegate.apply(this,arguments);const a=t.split(vg);for(let r=0;r<a.length;r++){const f=a[r].split("."),d=f[0],g=f[1]||"";this.eventListeners[d]||(this.eventListeners[d]=[]),this.eventListeners[d].push({name:g,handler:n})}return this}off(t,n){let a=(t||"").split(vg),r=a.length,l,f,d,g,m,_;if(this._cache&&this._cache.delete(F0),!t)for(f in this.eventListeners)this._off(f);for(l=0;l<r;l++)if(d=a[l],g=d.split("."),m=g[0],_=g[1],m)this.eventListeners[m]&&this._off(m,_,n);else for(f in this.eventListeners)this._off(f,_,n);return this}dispatchEvent(t){const n={target:this,type:t.type,evt:t};return this.fire(t.type,n),this}addEventListener(t,n){return this.on(t,function(a){n.call(this,a.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,n,a){const r=this;this.on(t,function(l){const f=l.target.findAncestors(n,!0,r);for(let d=0;d<f.length;d++)l=mt.cloneObject(l),l.currentTarget=f[d],a.call(f[d],l)})}remove(){return this.isDragging()&&this.stopDrag(),Sn._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(yo),this._clearSelfAndDescendantCache(mg),this._clearSelfAndDescendantCache(Uy),this._clearSelfAndDescendantCache(Ly),this._clearSelfAndDescendantCache(Om),this._clearSelfAndDescendantCache(Rm)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const n="get"+mt._capitalize(t);return mt._isFunction(this[n])?this[n]():this.attrs[t]}getAncestors(){let t=this.getParent(),n=[];for(;t;)n.push(t),t=t.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let n,a;if(!t)return this;for(n in t)n!==o5&&(a=By+mt._capitalize(n),mt._isFunction(this[a])?this[a](t[n]):this._setAttr(n,t[n]))}),this}isListening(){return this._getCache(Rm,this._isListening)}_isListening(t){if(!this.listening())return!1;const a=this.getParent();return a&&a!==t&&this!==t?a._isListening(t):!0}isVisible(){return this._getCache(Om,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const a=this.getParent();return a&&a!==t&&this!==t?a._isVisible(t):!0}shouldDrawHit(t,n=!1){if(t)return this._isVisible(t)&&this._isListening(t);const a=this.getLayer();let r=!1;Sn._dragElements.forEach(f=>{f.dragStatus==="dragging"&&(f.node.nodeType==="Stage"||f.node.getLayer()===a)&&(r=!0)});const l=!n&&!Jt.hitOnDragEnabled&&(r||Jt.isTransforming());return this.isListening()&&this.isVisible()&&!l}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),n=this,a=0,r,l,f,d;function g(_){for(r=[],l=_.length,f=0;f<l;f++)d=_[f],a++,d.nodeType!==zy&&(r=r.concat(d.getChildren().slice())),d._id===n._id&&(f=l);r.length>0&&r[0].getDepth()<=t&&g(r)}const m=this.getStage();return n.nodeType!==p5&&m&&g(m.getChildren()),a}getDepth(){let t=0,n=this.parent;for(;n;)t++,n=n.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ul),this._clearSelfAndDescendantCache(yo)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const n=t.getPointerPosition();if(!n)return null;const a=this.getAbsoluteTransform().copy();return a.invert(),a.point(n)}getAbsolutePosition(t){let n=!1,a=this.parent;for(;a;){if(a.isCached()){n=!0;break}a=a.parent}n&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),l=new Ii,f=this.offset();return l.m=r.slice(),l.translate(f.x,f.y),l.getTranslation()}setAbsolutePosition(t){const{x:n,y:a,...r}=this._clearTransform();this.attrs.x=n,this.attrs.y=a,this._clearCache(ul);const l=this._getAbsoluteTransform().copy();return l.invert(),l.translate(t.x,t.y),t={x:this.attrs.x+l.getTranslation().x,y:this.attrs.y+l.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(ul),this._clearSelfAndDescendantCache(yo),this}_setTransform(t){let n;for(n in t)this.attrs[n]=t[n]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let n=t.x,a=t.y,r=this.x(),l=this.y();return n!==void 0&&(r+=n),a!==void 0&&(l+=a),this.setPosition({x:r,y:l}),this}_eachAncestorReverse(t,n){let a=[],r=this.getParent(),l,f;if(!(n&&n._id===this._id)){for(a.unshift(this);r&&(!n||r._id!==n._id);)a.unshift(r),r=r.parent;for(l=a.length,f=0;f<l;f++)t(a[f])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return mt.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return mt.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return mt.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return mt.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return mt.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&mt.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(mg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(t*=n.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),n,a,r,l,f;const d={attrs:{},className:this.getClassName()};for(n in t)a=t[n],f=mt.isObject(a)&&!mt._isPlainObject(a)&&!mt._isArray(a),!f&&(r=typeof this[n]=="function"&&this[n],delete t[n],l=r?r.call(this):null,t[n]=a,l!==a&&(d.attrs[n]=a));return mt._prepareToStringify(d)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,n,a){const r=[];n&&this._isMatch(t)&&r.push(this);let l=this.parent;for(;l;){if(l===a)return r;l._isMatch(t)&&r.push(l),l=l.parent}return r}isAncestorOf(t){return!1}findAncestor(t,n,a){return this.findAncestors(t,n,a)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let n=t.replace(/ /g,"").split(","),a=n.length,r,l;for(r=0;r<a;r++)if(l=n[r],mt.isValidSelector(l)||(mt.warn('Selector "'+l+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),mt.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),mt.warn("Konva is awesome, right?")),l.charAt(0)==="#"){if(this.id()===l.slice(1))return!0}else if(l.charAt(0)==="."){if(this.hasName(l.slice(1)))return!0}else if(this.className===l||this.nodeType===l)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(Ly,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,n={},a){return n.target=n.target||this,a?this._fireAndBubble(t,n):this._fire(t,n),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(yo,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let n;if(t)return n=new Ii,this._eachAncestorReverse(function(a){const r=a.transformsEnabled();r==="all"?n.multiply(a.getTransform()):r==="position"&&n.translate(a.x()-a.offsetX(),a.y()-a.offsetY())},t),n;{n=this._cache.get(yo)||new Ii,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const a=this.transformsEnabled();if(a==="all")n.multiply(this.getTransform());else if(a==="position"){const r=this.attrs.x||0,l=this.attrs.y||0,f=this.attrs.offsetX||0,d=this.attrs.offsetY||0;n.translate(r-f,l-d)}return n.dirty=!1,n}}getAbsoluteScale(t){let n=this;for(;n;)n._isUnderCache&&(t=n),n=n.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ul,this._getTransform)}_getTransform(){var t,n;const a=this._cache.get(ul)||new Ii;a.reset();const r=this.x(),l=this.y(),f=Jt.getAngle(this.rotation()),d=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,_=this.attrs.skewY||0,C=this.attrs.offsetX||0,E=this.attrs.offsetY||0;return(r!==0||l!==0)&&a.translate(r,l),f!==0&&a.rotate(f),(m!==0||_!==0)&&a.skew(m,_),(d!==1||g!==1)&&a.scale(d,g),(C!==0||E!==0)&&a.translate(-1*C,-1*E),a.dirty=!1,a}clone(t){let n=mt.cloneObject(this.attrs),a,r,l,f,d;for(a in t)n[a]=t[a];const g=new this.constructor(n);for(a in this.eventListeners)for(r=this.eventListeners[a],l=r.length,f=0;f<l;f++)d=r[f],d.name.indexOf(l5)<0&&(g.eventListeners[a]||(g.eventListeners[a]=[]),g.eventListeners[a].push(d));return g}_toKonvaCanvas(t){t=t||{};const n=this.getClientRect(),a=this.getStage(),r=t.x!==void 0?t.x:Math.floor(n.x),l=t.y!==void 0?t.y:Math.floor(n.y),f=t.pixelRatio||1,d=new dl({width:t.width||Math.ceil(n.width)||(a?a.width():0),height:t.height||Math.ceil(n.height)||(a?a.height():0),pixelRatio:f}),g=d.getContext(),m=new dl({width:d.width/d.pixelRatio+Math.abs(r),height:d.height/d.pixelRatio+Math.abs(l),pixelRatio:d.pixelRatio});return t.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(r||l)&&g.translate(-1*r,-1*l),this.drawScene(d,void 0,m),g.restore(),d}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const n=t.mimeType||null,a=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(n,a);return t.callback&&t.callback(r),r}toImage(t){return new Promise((n,a)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,mt._urlToImage(this.toDataURL(t),function(l){n(l),r==null||r(l)})}catch(r){a(r)}})}toBlob(t){return new Promise((n,a)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(l=>{n(l),r==null||r(l)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(r){a(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Jt.dragDistance}_off(t,n,a){let r=this.eventListeners[t],l,f,d;for(l=0;l<r.length;l++)if(f=r[l].name,d=r[l].handler,(f!=="konva"||n==="konva")&&(!n||f===n)&&(!a||a===d)){if(r.splice(l,1),r.length===0){delete this.eventListeners[t];break}l--}}_fireChangeEvent(t,n,a){this._fire(t+s5,{oldVal:n,newVal:a})}addName(t){if(!this.hasName(t)){const n=this.name(),a=n?n+" "+t:t;this.name(a)}return this}hasName(t){if(!t)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const n=(this.name()||"").split(/\s/g),a=n.indexOf(t);return a!==-1&&(n.splice(a,1),this.name(n.join(" "))),this}setAttr(t,n){const a=this[By+mt._capitalize(t)];return mt._isFunction(a)?a.call(this,n):this._setAttr(t,n),this}_requestDraw(){if(Jt.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,n){const a=this.attrs[t];a===n&&!mt.isObject(n)||(n==null?delete this.attrs[t]:this.attrs[t]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(t,a,n),this._requestDraw())}_setComponentAttr(t,n,a){let r;a!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][n]=a,this._fireChangeEvent(t,r,a))}_fireAndBubble(t,n,a){n&&this.nodeType===zy&&(n.target=this);const r=[u5,c5,f5,d5,h5,g5];if(!(r.indexOf(t)!==-1&&(a&&(this===a||this.isAncestorOf&&this.isAncestorOf(a))||this.nodeType==="Stage"&&!a))){this._fire(t,n);const f=r.indexOf(t)!==-1&&a&&a.isAncestorOf&&a.isAncestorOf(this)&&!a.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!f&&(a&&a.parent?this._fireAndBubble.call(this.parent,t,n,a):this._fireAndBubble.call(this.parent,t,n))}}_getProtoListeners(t){var n,a,r;const l=(n=this._cache.get(F0))!==null&&n!==void 0?n:{};let f=l==null?void 0:l[t];if(f===void 0){f=[];let d=Object.getPrototypeOf(this);for(;d;){const g=(r=(a=d.eventListeners)===null||a===void 0?void 0:a[t])!==null&&r!==void 0?r:[];f.push(...g),d=Object.getPrototypeOf(d)}l[t]=f,this._cache.set(F0,l)}return f}_fire(t,n){n=n||{},n.currentTarget=this,n.type=t;const a=this._getProtoListeners(t);if(a)for(let l=0;l<a.length;l++)a[l].handler.call(this,n);const r=this.eventListeners[t];if(r)for(let l=0;l<r.length;l++)r[l].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const n=t?t.pointerId:void 0,a=this.getStage(),r=this.getAbsolutePosition();if(!a)return;const l=a._getPointerById(n)||a._changedPointerPositions[0]||r;Sn._dragElements.set(this._id,{node:this,startPointerPos:l,offset:{x:l.x-r.x,y:l.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(t,n=!0){Sn._dragElements.has(this._id)||this._createDragElement(t);const a=Sn._dragElements.get(this._id);a.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},n)}_setDragPosition(t,n){const a=this.getStage()._getPointerById(n.pointerId);if(!a)return;let r={x:a.x-n.offset.x,y:a.y-n.offset.y};const l=this.dragBoundFunc();if(l!==void 0){const f=l.call(this,r,t);f?r=f:mt.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const n=Sn._dragElements.get(this._id);n&&(n.dragStatus="stopped"),Sn._endDragBefore(t),Sn._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=Sn._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Jt.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;Sn._dragElements.forEach(l=>{this.isAncestorOf(l.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=Sn._dragElements.get(this._id),a=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";a?this.stopDrag():r&&Sn._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const n=this.getStage();if(!n)return!1;const a={x:-t.x,y:-t.y,width:n.width()+2*t.x,height:n.height()+2*t.y};return mt.haveIntersection(a,this.getClientRect())}static create(t,n){return mt._isString(t)&&(t=JSON.parse(t)),this._createNode(t,n)}static _createNode(t,n){let a=Vt.prototype.getClassName.call(t),r=t.children,l,f,d;n&&(t.attrs.container=n),Jt[a]||(mt.warn('Can not find a node with class name "'+a+'". Fallback to "Shape".'),a="Shape");const g=Jt[a];if(l=new g(t.attrs),r)for(f=r.length,d=0;d<f;d++)l.add(Vt._createNode(r[d]));return l}}Vt.prototype.nodeType="Node";Vt.prototype._attrsAffectingSize=[];Vt.prototype.eventListeners={};Vt.prototype.on.call(Vt.prototype,m5,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ul),this._clearSelfAndDescendantCache(yo)});Vt.prototype.on.call(Vt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Om)});Vt.prototype.on.call(Vt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Rm)});Vt.prototype.on.call(Vt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(mg)});const Bn=ot.addGetterSetter;Bn(Vt,"zIndex");Bn(Vt,"absolutePosition");Bn(Vt,"position");Bn(Vt,"x",0,Kt());Bn(Vt,"y",0,Kt());Bn(Vt,"globalCompositeOperation","source-over",Eu());Bn(Vt,"opacity",1,Kt());Bn(Vt,"name","",Eu());Bn(Vt,"id","",Eu());Bn(Vt,"rotation",0,Kt());ot.addComponentsGetterSetter(Vt,"scale",["x","y"]);Bn(Vt,"scaleX",1,Kt());Bn(Vt,"scaleY",1,Kt());ot.addComponentsGetterSetter(Vt,"skew",["x","y"]);Bn(Vt,"skewX",0,Kt());Bn(Vt,"skewY",0,Kt());ot.addComponentsGetterSetter(Vt,"offset",["x","y"]);Bn(Vt,"offsetX",0,Kt());Bn(Vt,"offsetY",0,Kt());Bn(Vt,"dragDistance",void 0,Kt());Bn(Vt,"width",0,Kt());Bn(Vt,"height",0,Kt());Bn(Vt,"listening",!0,Qr());Bn(Vt,"preventDefault",!0,Qr());Bn(Vt,"filters",void 0,function(o){return this._filterUpToDate=!1,o});Bn(Vt,"visible",!0,Qr());Bn(Vt,"transformsEnabled","all",Eu());Bn(Vt,"size");Bn(Vt,"dragBoundFunc");Bn(Vt,"draggable",!1,Qr());ot.backCompat(Vt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Vi extends Vt{constructor(){super(...arguments),this.children=[]}getChildren(t){const n=this.children||[];return t?n.filter(t):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let a=0;a<t.length;a++)this.add(t[a]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const n=this._generalFind(t,!0);return n.length>0?n[0]:void 0}_generalFind(t,n){const a=[];return this._descendants(r=>{const l=r._isMatch(t);return l&&a.push(r),!!(l&&n)}),a}_descendants(t){let n=!1;const a=this.getChildren();for(const r of a){if(n=t(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(t),n))return!0}return!1}toObject(){const t=Vt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(n=>{t.children.push(n.toObject())}),t}isAncestorOf(t){let n=t.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(t){const n=Vt.prototype.clone.call(this,t);return this.getChildren().forEach(function(a){n.add(a.clone())}),n}getAllIntersections(t){const n=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(t)&&n.push(a)}),n}_clearSelfAndDescendantCache(t){var n;super._clearSelfAndDescendantCache(t),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(a){a._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(n,a){n.index=a}),this._requestDraw()}drawScene(t,n,a){const r=this.getLayer(),l=t||r&&r.getCanvas(),f=l&&l.getContext(),d=this._getCanvasCache(),g=d&&d.scene,m=l&&l.isCache;if(!this.isVisible()&&!m)return this;if(g){f.save();const _=this.getAbsoluteTransform(n).getMatrix();f.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",l,n,a);return this}drawHit(t,n){if(!this.shouldDrawHit(n))return this;const a=this.getLayer(),r=t||a&&a.hitCanvas,l=r&&r.getContext(),f=this._getCanvasCache();if(f&&f.hit){l.save();const g=this.getAbsoluteTransform(n).getMatrix();l.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(l),l.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(t,n,a,r){var l;const f=n&&n.getContext(),d=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),_=typeof d=="number"&&typeof g=="number"||m,C=a===this;if(_){f.save();const R=this.getAbsoluteTransform(a);let v=R.getMatrix();f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),f.beginPath();let D;if(m)D=m.call(this,f,this);else{const L=this.clipX(),B=this.clipY();f.rect(L||0,B||0,d,g)}f.clip.apply(f,D),v=R.copy().invert().getMatrix(),f.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const E=!C&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(f.save(),f._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(R){R[t](n,a,r)}),E&&f.restore(),_&&f.restore()}getClientRect(t={}){var n;const a=t.skipTransform,r=t.relativeTo;let l,f,d,g,m={x:1/0,y:1/0,width:0,height:0};const _=this;(n=this.children)===null||n===void 0||n.forEach(function(R){if(!R.visible())return;const v=R.getClientRect({relativeTo:_,skipShadow:t.skipShadow,skipStroke:t.skipStroke});v.width===0&&v.height===0||(l===void 0?(l=v.x,f=v.y,d=v.x+v.width,g=v.y+v.height):(l=Math.min(l,v.x),f=Math.min(f,v.y),d=Math.max(d,v.x+v.width),g=Math.max(g,v.y+v.height)))});const C=this.find("Shape");let E=!1;for(let R=0;R<C.length;R++)if(C[R]._isVisible(this)){E=!0;break}return E&&l!==void 0?m={x:l,y:f,width:d-l,height:g-f}:m={x:0,y:0,width:0,height:0},a?m:this._transformedRect(m,r)}}ot.addComponentsGetterSetter(Vi,"clip",["x","y","width","height"]);ot.addGetterSetter(Vi,"clipX",void 0,Kt());ot.addGetterSetter(Vi,"clipY",void 0,Kt());ot.addGetterSetter(Vi,"clipWidth",void 0,Kt());ot.addGetterSetter(Vi,"clipHeight",void 0,Kt());ot.addGetterSetter(Vi,"clipFunc");const hh=new Map,G2=Jt._global.PointerEvent!==void 0;function Op(o){return hh.get(o)}function nv(o){return{evt:o,pointerId:o.pointerId}}function H2(o,t){return hh.get(o)===t}function I2(o,t){ih(o),t.getStage()&&(hh.set(o,t),G2&&t._fire("gotpointercapture",nv(new PointerEvent("gotpointercapture"))))}function ih(o,t){const n=hh.get(o);if(!n)return;const a=n.getStage();a&&a.content,hh.delete(o),G2&&n._fire("lostpointercapture",nv(new PointerEvent("lostpointercapture")))}const y5="Stage",S5="string",Py="px",b5="mouseout",k2="mouseleave",q2="mouseover",V2="mouseenter",Y2="mousemove",K2="mousedown",Q2="mouseup",Wd="pointermove",$d="pointerdown",uf="pointerup",th="pointercancel",_5="lostpointercapture",J0="pointerout",eh="pointerleave",Z0="pointerover",W0="pointerenter",xm="contextmenu",X2="touchstart",F2="touchend",J2="touchmove",Z2="touchcancel",Mm="wheel",E5=5,C5=[[V2,"_pointerenter"],[K2,"_pointerdown"],[Y2,"_pointermove"],[Q2,"_pointerup"],[k2,"_pointerleave"],[X2,"_pointerdown"],[J2,"_pointermove"],[F2,"_pointerup"],[Z2,"_pointercancel"],[q2,"_pointerover"],[Mm,"_wheel"],[xm,"_contextmenu"],[$d,"_pointerdown"],[Wd,"_pointermove"],[uf,"_pointerup"],[th,"_pointercancel"],[eh,"_pointerleave"],[_5,"_lostpointercapture"]],xp={mouse:{[J0]:b5,[eh]:k2,[Z0]:q2,[W0]:V2,[Wd]:Y2,[$d]:K2,[uf]:Q2,[th]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[J0]:"touchout",[eh]:"touchleave",[Z0]:"touchover",[W0]:"touchenter",[Wd]:J2,[$d]:X2,[uf]:F2,[th]:Z2,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[J0]:J0,[eh]:eh,[Z0]:Z0,[W0]:W0,[Wd]:Wd,[$d]:$d,[uf]:uf,[th]:th,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},nh=o=>o.indexOf("pointer")>=0?"pointer":o.indexOf("touch")>=0?"touch":"mouse",Fc=o=>{const t=nh(o);if(t==="pointer")return Jt.pointerEventsEnabled&&xp.pointer;if(t==="touch")return xp.touch;if(t==="mouse")return xp.mouse};function Gy(o={}){return(o.clipFunc||o.clipWidth||o.clipHeight)&&mt.warn("Stage does not support clipping. Please use clip for Layers or Groups."),o}const T5="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",rh=[];let Ng=class extends Vi{constructor(t){super(Gy(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),rh.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Gy(this.attrs)}),this._checkVisibility()}_validateAdd(t){const n=t.getType()==="Layer",a=t.getType()==="FastLayer";n||a||mt.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===S5){let n;if(t.charAt(0)==="."){const a=t.slice(1);t=document.getElementsByClassName(a)[0]}else t.charAt(0)!=="#"?n=t:n=t.slice(1),t=document.getElementById(n);if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,n=t.length;for(let a=0;a<n;a++)t[a].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),Vi.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&mt._isInDocument(t)&&this.container().removeChild(t);const n=rh.indexOf(this);return n>-1&&rh.splice(n,1),mt.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(mt.warn(T5),null)}_getPointerById(t){return this._pointerPositions.find(n=>n.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const n=new dl({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),a=n.getContext()._context,r=this.children;return(t.x||t.y)&&a.translate(-1*t.x,-1*t.y),r.forEach(function(l){if(!l.isVisible())return;const f=l._toKonvaCanvas(t);a.drawImage(f._canvas,t.x,t.y,f.getWidth()/f.getPixelRatio(),f.getHeight()/f.getPixelRatio())}),n}getIntersection(t){if(!t)return null;const n=this.children,a=n.length,r=a-1;for(let l=r;l>=0;l--){const f=n[l].getIntersection(t);if(f)return f}return null}_resizeDOM(){const t=this.width(),n=this.height();this.content&&(this.content.style.width=t+Py,this.content.style.height=n+Py),this.bufferCanvas.setSize(t,n),this.bufferHitCanvas.setSize(t,n),this.children.forEach(a=>{a.setSize({width:t,height:n}),a.draw()})}add(t,...n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const a=this.children.length;return a>E5&&mt.warn("The stage has "+a+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Jt.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return H2(t,this)}setPointerCapture(t){I2(t,this)}releaseCapture(t){ih(t)}getLayers(){return this.children}_bindContentEvents(){Jt.isBrowser&&C5.forEach(([t,n])=>{this.content.addEventListener(t,a=>{this[n](a)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const n=Fc(t.type);n&&this._fire(n.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const n=Fc(t.type);n&&this._fire(n.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let n=this[t+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(t){const n=Fc(t.type),a=nh(t.type);if(!n)return;this.setPointersPositions(t);const r=this._getTargetShape(a),l=!(Jt.isDragging()||Jt.isTransforming())||Jt.hitOnDragEnabled;r&&l?(r._fireAndBubble(n.pointerout,{evt:t}),r._fireAndBubble(n.pointerleave,{evt:t}),this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this[a+"targetShape"]=null):l&&(this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const n=Fc(t.type),a=nh(t.type);if(!n)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(l=>{const f=this.getIntersection(l);if(Sn.justDragged=!1,Jt["_"+a+"ListenClick"]=!0,!f||!f.isListening()){this[a+"ClickStartShape"]=void 0;return}Jt.capturePointerEventsEnabled&&f.setPointerCapture(l.id),this[a+"ClickStartShape"]=f,f._fireAndBubble(n.pointerdown,{evt:t,pointerId:l.id}),r=!0;const d=t.type.indexOf("touch")>=0;f.preventDefault()&&t.cancelable&&d&&t.preventDefault()}),r||this._fire(n.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const n=Fc(t.type),a=nh(t.type);if(!n)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(Jt.isDragging()&&Sn.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(Jt.isDragging()||Jt.isTransforming())||Jt.hitOnDragEnabled))return;const f={};let d=!1;const g=this._getTargetShape(a);this._changedPointerPositions.forEach(m=>{const _=Op(m.id)||this.getIntersection(m),C=m.id,E={evt:t,pointerId:C},R=g!==_;if(R&&g&&(g._fireAndBubble(n.pointerout,{...E},_),g._fireAndBubble(n.pointerleave,{...E},_)),_){if(f[_._id])return;f[_._id]=!0}_&&_.isListening()?(d=!0,R&&(_._fireAndBubble(n.pointerover,{...E},g),_._fireAndBubble(n.pointerenter,{...E},g),this[a+"targetShape"]=_),_._fireAndBubble(n.pointermove,{...E})):g&&(this._fire(n.pointerover,{evt:t,target:this,currentTarget:this,pointerId:C}),this[a+"targetShape"]=null)}),d||this._fire(n.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const n=Fc(t.type),a=nh(t.type);if(!n)return;this.setPointersPositions(t);const r=this[a+"ClickStartShape"],l=this[a+"ClickEndShape"],f={};let d=!1;this._changedPointerPositions.forEach(g=>{const m=Op(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),f[m._id])return;f[m._id]=!0}const _=g.id,C={evt:t,pointerId:_};let E=!1;Jt["_"+a+"InDblClickWindow"]?(E=!0,clearTimeout(this[a+"DblTimeout"])):Sn.justDragged||(Jt["_"+a+"InDblClickWindow"]=!0,clearTimeout(this[a+"DblTimeout"])),this[a+"DblTimeout"]=setTimeout(function(){Jt["_"+a+"InDblClickWindow"]=!1},Jt.dblClickWindow),m&&m.isListening()?(d=!0,this[a+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...C}),Jt["_"+a+"ListenClick"]&&r&&r===m&&(m._fireAndBubble(n.pointerclick,{...C}),E&&l&&l===m&&m._fireAndBubble(n.pointerdblclick,{...C}))):(this[a+"ClickEndShape"]=null,d||(this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),d=!0),Jt["_"+a+"ListenClick"]&&this._fire(n.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:_}),E&&this._fire(n.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:_}))}),d||this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Jt["_"+a+"ListenClick"]=!1,t.cancelable&&a!=="touch"&&a!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(xm,{evt:t}):this._fire(xm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Mm,{evt:t}):this._fire(Mm,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const n=Op(t.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(uf,nv(t)),ih(t.pointerId)}_lostpointercapture(t){ih(t.pointerId)}setPointersPositions(t){const n=this._getContentPosition();let a=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,l=>{this._pointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,l=>{this._changedPointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})})):(a=(t.clientX-n.left)/n.scaleX,r=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:a,y:r},this._pointerPositions=[{x:a,y:r,id:mt._getFirstPointerId(t)}],this._changedPointerPositions=[{x:a,y:r,id:mt._getFirstPointerId(t)}])}_setPointerPosition(t){mt.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new dl({width:this.width(),height:this.height()}),this.bufferHitCanvas=new tv({pixelRatio:1,width:this.width(),height:this.height()}),!Jt.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return mt.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Ng.prototype.nodeType=y5;$n(Ng);ot.addGetterSetter(Ng,"container");Jt.isBrowser&&document.addEventListener("visibilitychange",()=>{rh.forEach(o=>{o.batchDraw()})});const W2="hasShadow",$2="shadowRGBA",tS="patternImage",eS="linearGradient",nS="radialGradient";let $0;function Mp(){return $0||($0=mt.createCanvasElement().getContext("2d"),$0)}const sh={};function A5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function w5(o){o.stroke()}function R5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function O5(o){o.stroke()}function x5(){this._clearCache(W2)}function M5(){this._clearCache($2)}function N5(){this._clearCache(tS)}function D5(){this._clearCache(eS)}function j5(){this._clearCache(nS)}class Pt extends Vt{constructor(t){super(t);let n;for(;n=mt.getRandomColor(),!(n&&!(n in sh)););this.colorKey=n,sh[n]=this}getContext(){return mt.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return mt.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(W2,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(tS,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Mp().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const a=new Ii;a.translate(this.fillPatternX(),this.fillPatternY()),a.rotate(Jt.getAngle(this.fillPatternRotation())),a.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),a.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=a.getMatrix(),l=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(l)}return n}}_getLinearGradient(){return this._getCache(eS,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const n=Mp(),a=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),l=n.createLinearGradient(a.x,a.y,r.x,r.y);for(let f=0;f<t.length;f+=2)l.addColorStop(t[f],t[f+1]);return l}}_getRadialGradient(){return this._getCache(nS,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const n=Mp(),a=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),l=n.createRadialGradient(a.x,a.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let f=0;f<t.length;f+=2)l.addColorStop(t[f],t[f+1]);return l}}getShadowRGBA(){return this._getCache($2,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=mt.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const n=this.getStage();if(!n)return!1;const a=n.bufferHitCanvas;return a.getContext().clear(),this.drawHit(a,void 0,!0),a.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return Vt.prototype.destroy.call(this),delete sh[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=t||this.hasFill(),l=this.hasStroke(),f=this.getAbsoluteOpacity()!==1;if(r&&l&&f)return!0;const d=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(r&&l&&d&&g)}setStrokeHitEnabled(t){mt.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let n=!1,a=this.getParent();for(;a;){if(a.isCached()){n=!0;break}a=a.getParent()}const r=t.skipTransform,l=t.relativeTo||n&&this.getStage()||void 0,f=this.getSelfRect(),g=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=f.width+g,_=f.height+g,C=!t.skipShadow&&this.hasShadow(),E=C?this.shadowOffsetX():0,R=C?this.shadowOffsetY():0,v=m+Math.abs(E),D=_+Math.abs(R),L=C&&this.shadowBlur()||0,B=v+L*2,N=D+L*2,M={width:B,height:N,x:-(g/2+L)+Math.min(E,0)+f.x,y:-(g/2+L)+Math.min(R,0)+f.y};return r?M:this._transformedRect(M,l)}drawScene(t,n,a){const r=this.getLayer(),l=t||r.getCanvas(),f=l.getContext(),d=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let _;const C=n===this;if(!this.isVisible()&&!C)return this;if(d){f.save();const E=this.getAbsoluteTransform(n).getMatrix();return f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedSceneCanvas(f),f.restore(),this}if(!g)return this;if(f.save(),this._useBufferCanvas()){_=this.getStage();const E=a||_.bufferCanvas,R=E.getContext();R.clear(),R.save(),R._applyLineJoin(this),R._applyMiterLimit(this);const v=this.getAbsoluteTransform(n).getMatrix();R.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.call(this,R,this),R.restore();const D=E.pixelRatio;m&&f._applyShadow(this),f._applyOpacity(this),f._applyGlobalCompositeOperation(this),f.drawImage(E._canvas,E.x||0,E.y||0,E.width/D,E.height/D)}else{if(f._applyLineJoin(this),f._applyMiterLimit(this),!C){const E=this.getAbsoluteTransform(n).getMatrix();f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),f._applyOpacity(this),f._applyGlobalCompositeOperation(this)}m&&f._applyShadow(this),g.call(this,f,this)}return f.restore(),this}drawHit(t,n,a=!1){if(!this.shouldDrawHit(n,a))return this;const r=this.getLayer(),l=t||r.hitCanvas,f=l&&l.getContext(),d=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||mt.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){f.save();const C=this.getAbsoluteTransform(n).getMatrix();return f.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._drawCachedHitCanvas(f),f.restore(),this}if(!d)return this;if(f.save(),f._applyLineJoin(this),f._applyMiterLimit(this),!(this===n)){const C=this.getAbsoluteTransform(n).getMatrix();f.transform(C[0],C[1],C[2],C[3],C[4],C[5])}return d.call(this,f,this),f.restore(),this}drawHitFromCache(t=0){const n=this._getCanvasCache(),a=this._getCachedSceneCanvas(),r=n.hit,l=r.getContext(),f=r.getWidth(),d=r.getHeight();l.clear(),l.drawImage(a._canvas,0,0,f,d);try{const g=l.getImageData(0,0,f,d),m=g.data,_=m.length,C=mt._hexToRgb(this.colorKey);for(let E=0;E<_;E+=4)m[E+3]>t?(m[E]=C.r,m[E+1]=C.g,m[E+2]=C.b,m[E+3]=255):m[E+3]=0;l.putImageData(g,0,0)}catch(g){mt.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return H2(t,this)}setPointerCapture(t){I2(t,this)}releaseCapture(t){ih(t)}}Pt.prototype._fillFunc=A5;Pt.prototype._strokeFunc=w5;Pt.prototype._fillFuncHit=R5;Pt.prototype._strokeFuncHit=O5;Pt.prototype._centroid=!1;Pt.prototype.nodeType="Shape";$n(Pt);Pt.prototype.eventListeners={};Pt.prototype.on.call(Pt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",x5);Pt.prototype.on.call(Pt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",M5);Pt.prototype.on.call(Pt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",N5);Pt.prototype.on.call(Pt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",D5);Pt.prototype.on.call(Pt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",j5);ot.addGetterSetter(Pt,"stroke",void 0,P2());ot.addGetterSetter(Pt,"strokeWidth",2,Kt());ot.addGetterSetter(Pt,"fillAfterStrokeEnabled",!1);ot.addGetterSetter(Pt,"hitStrokeWidth","auto",ev());ot.addGetterSetter(Pt,"strokeHitEnabled",!0,Qr());ot.addGetterSetter(Pt,"perfectDrawEnabled",!0,Qr());ot.addGetterSetter(Pt,"shadowForStrokeEnabled",!0,Qr());ot.addGetterSetter(Pt,"lineJoin");ot.addGetterSetter(Pt,"lineCap");ot.addGetterSetter(Pt,"miterLimit");ot.addGetterSetter(Pt,"sceneFunc");ot.addGetterSetter(Pt,"hitFunc");ot.addGetterSetter(Pt,"dash");ot.addGetterSetter(Pt,"dashOffset",0,Kt());ot.addGetterSetter(Pt,"shadowColor",void 0,Eu());ot.addGetterSetter(Pt,"shadowBlur",0,Kt());ot.addGetterSetter(Pt,"shadowOpacity",1,Kt());ot.addComponentsGetterSetter(Pt,"shadowOffset",["x","y"]);ot.addGetterSetter(Pt,"shadowOffsetX",0,Kt());ot.addGetterSetter(Pt,"shadowOffsetY",0,Kt());ot.addGetterSetter(Pt,"fillPatternImage");ot.addGetterSetter(Pt,"fill",void 0,P2());ot.addGetterSetter(Pt,"fillPatternX",0,Kt());ot.addGetterSetter(Pt,"fillPatternY",0,Kt());ot.addGetterSetter(Pt,"fillLinearGradientColorStops");ot.addGetterSetter(Pt,"strokeLinearGradientColorStops");ot.addGetterSetter(Pt,"fillRadialGradientStartRadius",0);ot.addGetterSetter(Pt,"fillRadialGradientEndRadius",0);ot.addGetterSetter(Pt,"fillRadialGradientColorStops");ot.addGetterSetter(Pt,"fillPatternRepeat","repeat");ot.addGetterSetter(Pt,"fillEnabled",!0);ot.addGetterSetter(Pt,"strokeEnabled",!0);ot.addGetterSetter(Pt,"shadowEnabled",!0);ot.addGetterSetter(Pt,"dashEnabled",!0);ot.addGetterSetter(Pt,"strokeScaleEnabled",!0);ot.addGetterSetter(Pt,"fillPriority","color");ot.addComponentsGetterSetter(Pt,"fillPatternOffset",["x","y"]);ot.addGetterSetter(Pt,"fillPatternOffsetX",0,Kt());ot.addGetterSetter(Pt,"fillPatternOffsetY",0,Kt());ot.addComponentsGetterSetter(Pt,"fillPatternScale",["x","y"]);ot.addGetterSetter(Pt,"fillPatternScaleX",1,Kt());ot.addGetterSetter(Pt,"fillPatternScaleY",1,Kt());ot.addComponentsGetterSetter(Pt,"fillLinearGradientStartPoint",["x","y"]);ot.addComponentsGetterSetter(Pt,"strokeLinearGradientStartPoint",["x","y"]);ot.addGetterSetter(Pt,"fillLinearGradientStartPointX",0);ot.addGetterSetter(Pt,"strokeLinearGradientStartPointX",0);ot.addGetterSetter(Pt,"fillLinearGradientStartPointY",0);ot.addGetterSetter(Pt,"strokeLinearGradientStartPointY",0);ot.addComponentsGetterSetter(Pt,"fillLinearGradientEndPoint",["x","y"]);ot.addComponentsGetterSetter(Pt,"strokeLinearGradientEndPoint",["x","y"]);ot.addGetterSetter(Pt,"fillLinearGradientEndPointX",0);ot.addGetterSetter(Pt,"strokeLinearGradientEndPointX",0);ot.addGetterSetter(Pt,"fillLinearGradientEndPointY",0);ot.addGetterSetter(Pt,"strokeLinearGradientEndPointY",0);ot.addComponentsGetterSetter(Pt,"fillRadialGradientStartPoint",["x","y"]);ot.addGetterSetter(Pt,"fillRadialGradientStartPointX",0);ot.addGetterSetter(Pt,"fillRadialGradientStartPointY",0);ot.addComponentsGetterSetter(Pt,"fillRadialGradientEndPoint",["x","y"]);ot.addGetterSetter(Pt,"fillRadialGradientEndPointX",0);ot.addGetterSetter(Pt,"fillRadialGradientEndPointY",0);ot.addGetterSetter(Pt,"fillPatternRotation",0);ot.addGetterSetter(Pt,"fillRule",void 0,Eu());ot.backCompat(Pt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const U5="#",B5="beforeDraw",z5="draw",aS=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],L5=aS.length;let Cu=class extends Vi{constructor(t){super(t),this.canvas=new dl,this.hitCanvas=new tv({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),t<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[t+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Vt.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Vt.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Vt.prototype.moveDown.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Vt.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return Vt.prototype.remove.call(this),t&&t.parentNode&&mt._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:n}){return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&mt.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Vt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){mt.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){mt.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,mt.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let n=1,a=!1;for(;;){for(let r=0;r<L5;r++){const l=aS[r],f=this._getIntersection({x:t.x+l.x*n,y:t.y+l.y*n}),d=f.shape;if(d)return d;if(a=!!f.antialiased,!f.antialiased)break}if(a)n+=1;else return null}}_getIntersection(t){const n=this.hitCanvas.pixelRatio,a=this.hitCanvas.context.getImageData(Math.round(t.x*n),Math.round(t.y*n),1,1).data,r=a[3];if(r===255){const l=mt._rgbToHex(a[0],a[1],a[2]),f=sh[U5+l];return f?{shape:f}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,n,a){const r=this.getLayer(),l=t||r&&r.getCanvas();return this._fire(B5,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),Vi.prototype.drawScene.call(this,l,n,a),this._fire(z5,{node:this}),this}drawHit(t,n){const a=this.getLayer(),r=t||a&&a.hitCanvas;return a&&a.clearBeforeDraw()&&a.getHitCanvas().getContext().clear(),Vi.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){mt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return mt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return mt.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Cu.prototype.nodeType="Layer";$n(Cu);ot.addGetterSetter(Cu,"imageSmoothingEnabled",!0);ot.addGetterSetter(Cu,"clearBeforeDraw",!0);ot.addGetterSetter(Cu,"hitGraphEnabled",!0,Qr());class av extends Cu{constructor(t){super(t),this.listening(!1),mt.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}av.prototype.nodeType="FastLayer";$n(av);class ff extends Vi{_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&mt.throw("You may only add groups and shapes to groups.")}}ff.prototype.nodeType="Group";$n(ff);const Np=(function(){return Su.performance&&Su.performance.now?function(){return Su.performance.now()}:function(){return new Date().getTime()}})();class yr{constructor(t,n){this.id=yr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Np(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(t){let n=[];return t&&(n=Array.isArray(t)?t:[t]),this.layers=n,this}getLayers(){return this.layers}addLayer(t){const n=this.layers,a=n.length;for(let r=0;r<a;r++)if(n[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const n=yr.animations,a=n.length;for(let r=0;r<a;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Np(),yr._addAnimation(this),this}stop(){return yr._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const n=t.id,a=this.animations,r=a.length;for(let l=0;l<r;l++)if(a[l].id===n){this.animations.splice(l,1);break}}static _runFrames(){const t={},n=this.animations;for(let a=0;a<n.length;a++){const r=n[a],l=r.layers,f=r.func;r._updateFrameObject(Np());const d=l.length;let g;if(f?g=f.call(r,r.frame)!==!1:g=!0,!!g)for(let m=0;m<d;m++){const _=l[m];_._id!==void 0&&(t[_._id]=_)}}for(const a in t)t.hasOwnProperty(a)&&t[a].batchDraw()}static _animationLoop(){const t=yr;t.animations.length?(t._runFrames(),mt.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,mt.requestAnimFrame(this._animationLoop))}}yr.animations=[];yr.animIdCounter=0;yr.animRunning=!1;const P5={node:1,duration:1,easing:1,onFinish:1,yoyo:1},G5=1,Hy=2,Iy=3,ky=["fill","stroke","shadowColor"];let H5=0;class I5{constructor(t,n,a,r,l,f,d){this.prop=t,this.propFunc=n,this.begin=r,this._pos=r,this.duration=f,this._change=0,this.prevPos=0,this.yoyo=d,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=a,this._change=l-this.begin,this.pause()}fire(t){const n=this[t];n&&n()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=Hy,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Iy,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===Hy?this.setTime(t):this.state===Iy&&this.setTime(this.duration-t)}pause(){this.state=G5,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Gn{constructor(t){const n=this,a=t.node,r=a._id,l=t.easing||oh.Linear,f=!!t.yoyo;let d,g;typeof t.duration>"u"?d=.3:t.duration===0?d=.001:d=t.duration,this.node=a,this._id=H5++;const m=a.getLayer()||(a instanceof Jt.Stage?a.getLayers():null);m||mt.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new yr(function(){n.tween.onEnterFrame()},m),this.tween=new I5(g,function(_){n._tweenFunc(_)},l,0,1,d*1e3,f),this._addListeners(),Gn.attrs[r]||(Gn.attrs[r]={}),Gn.attrs[r][this._id]||(Gn.attrs[r][this._id]={}),Gn.tweens[r]||(Gn.tweens[r]={});for(g in t)P5[g]===void 0&&this._addAttr(g,t[g]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,n){const a=this.node,r=a._id;let l,f,d,g,m;const _=Gn.tweens[r][t];_&&delete Gn.attrs[r][_][t];let C=a.getAttr(t);if(mt._isArray(n))if(l=[],f=Math.max(n.length,C.length),t==="points"&&n.length!==C.length&&(n.length>C.length?(g=C,C=mt._prepareArrayForTween(C,n,a.closed())):(d=n,n=mt._prepareArrayForTween(n,C,a.closed()))),t.indexOf("fill")===0)for(let E=0;E<f;E++)if(E%2===0)l.push(n[E]-C[E]);else{const R=mt.colorToRGBA(C[E]);m=mt.colorToRGBA(n[E]),C[E]=R,l.push({r:m.r-R.r,g:m.g-R.g,b:m.b-R.b,a:m.a-R.a})}else for(let E=0;E<f;E++)l.push(n[E]-C[E]);else ky.indexOf(t)!==-1?(C=mt.colorToRGBA(C),m=mt.colorToRGBA(n),l={r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a}):l=n-C;Gn.attrs[r][this._id][t]={start:C,diff:l,end:n,trueEnd:d,trueStart:g},Gn.tweens[r][t]=this._id}_tweenFunc(t){const n=this.node,a=Gn.attrs[n._id][this._id];let r,l,f,d,g,m,_,C;for(r in a){if(l=a[r],f=l.start,d=l.diff,C=l.end,mt._isArray(f))if(g=[],_=Math.max(f.length,C.length),r.indexOf("fill")===0)for(m=0;m<_;m++)m%2===0?g.push((f[m]||0)+d[m]*t):g.push("rgba("+Math.round(f[m].r+d[m].r*t)+","+Math.round(f[m].g+d[m].g*t)+","+Math.round(f[m].b+d[m].b*t)+","+(f[m].a+d[m].a*t)+")");else for(m=0;m<_;m++)g.push((f[m]||0)+d[m]*t);else ky.indexOf(r)!==-1?g="rgba("+Math.round(f.r+d.r*t)+","+Math.round(f.g+d.g*t)+","+Math.round(f.b+d.b*t)+","+(f.a+d.a*t)+")":g=f+d*t;n.setAttr(r,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,n=Gn.attrs[t._id][this._id];n.points&&n.points.trueEnd&&t.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,n=Gn.attrs[t._id][this._id];n.points&&n.points.trueStart&&t.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,n=this._id,a=Gn.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in a)delete Gn.tweens[t][r];delete Gn.attrs[t][n],Gn.tweens[t]&&(Object.keys(Gn.tweens[t]).length===0&&delete Gn.tweens[t],Object.keys(Gn.attrs[t]).length===0&&delete Gn.attrs[t])}}Gn.attrs={};Gn.tweens={};Vt.prototype.to=function(o){const t=o.onFinish;o.node=this,o.onFinish=function(){this.destroy(),t&&t()},new Gn(o).play()};const oh={BackEaseIn(o,t,n,a){return n*(o/=a)*o*((1.70158+1)*o-1.70158)+t},BackEaseOut(o,t,n,a){return n*((o=o/a-1)*o*((1.70158+1)*o+1.70158)+1)+t},BackEaseInOut(o,t,n,a){let r=1.70158;return(o/=a/2)<1?n/2*(o*o*(((r*=1.525)+1)*o-r))+t:n/2*((o-=2)*o*(((r*=1.525)+1)*o+r)+2)+t},ElasticEaseIn(o,t,n,a,r,l){let f=0;return o===0?t:(o/=a)===1?t+n:(l||(l=a*.3),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(o-=1))*Math.sin((o*a-f)*(2*Math.PI)/l))+t)},ElasticEaseOut(o,t,n,a,r,l){let f=0;return o===0?t:(o/=a)===1?t+n:(l||(l=a*.3),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*o)*Math.sin((o*a-f)*(2*Math.PI)/l)+n+t)},ElasticEaseInOut(o,t,n,a,r,l){let f=0;return o===0?t:(o/=a/2)===2?t+n:(l||(l=a*(.3*1.5)),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),o<1?-.5*(r*Math.pow(2,10*(o-=1))*Math.sin((o*a-f)*(2*Math.PI)/l))+t:r*Math.pow(2,-10*(o-=1))*Math.sin((o*a-f)*(2*Math.PI)/l)*.5+n+t)},BounceEaseOut(o,t,n,a){return(o/=a)<1/2.75?n*(7.5625*o*o)+t:o<2/2.75?n*(7.5625*(o-=1.5/2.75)*o+.75)+t:o<2.5/2.75?n*(7.5625*(o-=2.25/2.75)*o+.9375)+t:n*(7.5625*(o-=2.625/2.75)*o+.984375)+t},BounceEaseIn(o,t,n,a){return n-oh.BounceEaseOut(a-o,0,n,a)+t},BounceEaseInOut(o,t,n,a){return o<a/2?oh.BounceEaseIn(o*2,0,n,a)*.5+t:oh.BounceEaseOut(o*2-a,0,n,a)*.5+n*.5+t},EaseIn(o,t,n,a){return n*(o/=a)*o+t},EaseOut(o,t,n,a){return-n*(o/=a)*(o-2)+t},EaseInOut(o,t,n,a){return(o/=a/2)<1?n/2*o*o+t:-n/2*(--o*(o-2)-1)+t},StrongEaseIn(o,t,n,a){return n*(o/=a)*o*o*o*o+t},StrongEaseOut(o,t,n,a){return n*((o=o/a-1)*o*o*o*o+1)+t},StrongEaseInOut(o,t,n,a){return(o/=a/2)<1?n/2*o*o*o*o*o+t:n/2*((o-=2)*o*o*o*o+2)+t},Linear(o,t,n,a){return n*o/a+t}},df=mt._assign(Jt,{Util:mt,Transform:Ii,Node:Vt,Container:Vi,Stage:Ng,stages:rh,Layer:Cu,FastLayer:av,Group:ff,DD:Sn,Shape:Pt,shapes:sh,Animation:yr,Tween:Gn,Easings:oh,Context:xg,Canvas:$m});class bo extends Pt{_sceneFunc(t){const n=Jt.getAngle(this.angle()),a=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,n,a),t.arc(0,0,this.innerRadius(),n,0,!a),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),n=this.outerRadius(),a=this.clockwise(),r=Jt.getAngle(a?360-this.angle():this.angle()),l=Math.cos(Math.min(r,Math.PI)),f=1,d=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),g=Math.sin(Math.min(r,Math.PI/2)),m=l*(l>0?t:n),_=f*n,C=d*(d>0?t:n),E=g*(g>0?n:t);return{x:m,y:a?-1*E:C,width:_-m,height:E-C}}}bo.prototype._centroid=!0;bo.prototype.className="Arc";bo.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];$n(bo);ot.addGetterSetter(bo,"innerRadius",0,Kt());ot.addGetterSetter(bo,"outerRadius",0,Kt());ot.addGetterSetter(bo,"angle",0,Kt());ot.addGetterSetter(bo,"clockwise",!1,Qr());function Nm(o,t,n,a,r,l,f){const d=Math.sqrt(Math.pow(n-o,2)+Math.pow(a-t,2)),g=Math.sqrt(Math.pow(r-n,2)+Math.pow(l-a,2)),m=f*d/(d+g),_=f*g/(d+g),C=n-m*(r-o),E=a-m*(l-t),R=n+_*(r-o),v=a+_*(l-t);return[C,E,R,v]}function qy(o,t){const n=o.length,a=[];for(let r=2;r<n-2;r+=2){const l=Nm(o[r-2],o[r-1],o[r],o[r+1],o[r+2],o[r+3],t);isNaN(l[0])||(a.push(l[0]),a.push(l[1]),a.push(o[r]),a.push(o[r+1]),a.push(l[2]),a.push(l[3]))}return a}let _o=class extends Pt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const n=this.points(),a=n.length,r=this.tension(),l=this.closed(),f=this.bezier();if(!a)return;let d=0;if(t.beginPath(),t.moveTo(n[0],n[1]),r!==0&&a>4){const g=this.getTensionPoints(),m=g.length;for(d=l?0:4,l||t.quadraticCurveTo(g[0],g[1],g[2],g[3]);d<m-2;)t.bezierCurveTo(g[d++],g[d++],g[d++],g[d++],g[d++],g[d++]);l||t.quadraticCurveTo(g[m-2],g[m-1],n[a-2],n[a-1])}else if(f)for(d=2;d<a;)t.bezierCurveTo(n[d++],n[d++],n[d++],n[d++],n[d++],n[d++]);else for(d=2;d<a;d+=2)t.lineTo(n[d],n[d+1]);l?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():qy(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),n=t.length,a=this.tension(),r=Nm(t[n-2],t[n-1],t[0],t[1],t[2],t[3],a),l=Nm(t[n-4],t[n-3],t[n-2],t[n-1],t[0],t[1],a),f=qy(t,a);return[r[2],r[3]].concat(f).concat([l[0],l[1],t[n-2],t[n-1],l[2],l[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let n=t[0],a=t[0],r=t[1],l=t[1],f,d;for(let g=0;g<t.length/2;g++)f=t[g*2],d=t[g*2+1],n=Math.min(n,f),a=Math.max(a,f),r=Math.min(r,d),l=Math.max(l,d);return{x:n,y:r,width:a-n,height:l-r}}};_o.prototype.className="Line";_o.prototype._attrsAffectingSize=["points","bezier","tension"];$n(_o);ot.addGetterSetter(_o,"closed",!1);ot.addGetterSetter(_o,"bezier",!1);ot.addGetterSetter(_o,"tension",0,Kt());ot.addGetterSetter(_o,"points",[],a5());const k5=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],q5=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],V5=[[1],[1,1],[1,2,1],[1,3,3,1]],Vy=(o,t,n)=>{let a,r;const f=n/2;a=0;for(let d=0;d<20;d++)r=f*k5[20][d]+f,a+=q5[20][d]*Y5(o,t,r);return f*a},Yy=(o,t,n)=>{n===void 0&&(n=1);const a=o[0]-2*o[1]+o[2],r=t[0]-2*t[1]+t[2],l=2*o[1]-2*o[0],f=2*t[1]-2*t[0],d=4*(a*a+r*r),g=4*(a*l+r*f),m=l*l+f*f;if(d===0)return n*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(t[2]-t[0],2));const _=g/(2*d),C=m/d,E=n+_,R=C-_*_,v=E*E+R>0?Math.sqrt(E*E+R):0,D=_*_+R>0?Math.sqrt(_*_+R):0,L=_+Math.sqrt(_*_+R)!==0?R*Math.log(Math.abs((E+v)/(_+D))):0;return Math.sqrt(d)/2*(E*v-_*D+L)};function Y5(o,t,n){const a=Dm(1,n,o),r=Dm(1,n,t),l=a*a+r*r;return Math.sqrt(l)}const Dm=(o,t,n)=>{const a=n.length-1;let r,l;if(a===0)return 0;if(o===0){l=0;for(let f=0;f<=a;f++)l+=V5[a][f]*Math.pow(1-t,a-f)*Math.pow(t,f)*n[f];return l}else{r=new Array(a);for(let f=0;f<a;f++)r[f]=a*(n[f+1]-n[f]);return Dm(o-1,t,r)}},Ky=(o,t,n)=>{let a=1,r=o/t,l=(o-n(r))/t,f=0;for(;a>.001;){const d=n(r+l),g=Math.abs(o-d)/t;if(g<a)a=g,r+=l;else{const m=n(r-l),_=Math.abs(o-m)/t;_<a?(a=_,r-=l):l/=2}if(f++,f>500)break}return r};class Hn extends Pt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Hn.parsePathData(this.data()),this.pathLength=Hn.getPathLength(this.dataArray)}_sceneFunc(t){const n=this.dataArray;t.beginPath();let a=!1;for(let r=0;r<n.length;r++){const l=n[r].command,f=n[r].points;switch(l){case"L":t.lineTo(f[0],f[1]);break;case"M":t.moveTo(f[0],f[1]);break;case"C":t.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":t.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const d=f[0],g=f[1],m=f[2],_=f[3],C=f[4],E=f[5],R=f[6],v=f[7],D=m>_?m:_,L=m>_?1:m/_,B=m>_?_/m:1;t.translate(d,g),t.rotate(R),t.scale(L,B),t.arc(0,0,D,C,C+E,1-v),t.scale(1/L,1/B),t.rotate(-R),t.translate(-d,-g);break;case"z":a=!0,t.closePath();break}}!a&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],_=g.points[5],C=g.points[4]+_;let E=Math.PI/180;if(Math.abs(m-C)<E&&(E=Math.abs(m-C)),_<0)for(let R=m-E;R>C;R-=E){const v=Hn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}else for(let R=m+E;R<C;R+=E){const v=Hn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const _=Hn.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);t.push(_.x,_.y)}else t=t.concat(g.points)});let n=t[0],a=t[0],r=t[1],l=t[1],f,d;for(let g=0;g<t.length/2;g++)f=t[g*2],d=t[g*2+1],isNaN(f)||(n=Math.min(n,f),a=Math.max(a,f)),isNaN(d)||(r=Math.min(r,d),l=Math.max(l,d));return{x:n,y:r,width:a-n,height:l-r}}getLength(){return this.pathLength}getPointAtLength(t){return Hn.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,n,a,r){return Math.sqrt((a-t)*(a-t)+(r-n)*(r-n))}static getPathLength(t){let n=0;for(let a=0;a<t.length;++a)n+=t[a].pathLength;return n}static getPointAtLengthOfDataArray(t,n){let a,r=0,l=n.length;if(!l)return null;for(;r<l&&t>n[r].pathLength;)t-=n[r].pathLength,++r;if(r===l)return a=n[r-1].points.slice(-2),{x:a[0],y:a[1]};if(t<.01)return n[r].command==="M"?(a=n[r].points.slice(0,2),{x:a[0],y:a[1]}):{x:n[r].start.x,y:n[r].start.y};const f=n[r],d=f.points;switch(f.command){case"L":return Hn.getPointOnLine(t,f.start.x,f.start.y,d[0],d[1]);case"C":return Hn.getPointOnCubicBezier(Ky(t,Hn.getPathLength(n),D=>Vy([f.start.x,d[0],d[2],d[4]],[f.start.y,d[1],d[3],d[5]],D)),f.start.x,f.start.y,d[0],d[1],d[2],d[3],d[4],d[5]);case"Q":return Hn.getPointOnQuadraticBezier(Ky(t,Hn.getPathLength(n),D=>Yy([f.start.x,d[0],d[2]],[f.start.y,d[1],d[3]],D)),f.start.x,f.start.y,d[0],d[1],d[2],d[3]);case"A":const g=d[0],m=d[1],_=d[2],C=d[3],E=d[5],R=d[6];let v=d[4];return v+=E*t/f.pathLength,Hn.getPointOnEllipticalArc(g,m,_,C,v,R)}return null}static getPointOnLine(t,n,a,r,l,f,d){f=f??n,d=d??a;const g=this.getLineLength(n,a,r,l);if(g<1e-10)return{x:n,y:a};if(r===n)return{x:f,y:d+(l>a?t:-t)};const m=(l-a)/(r-n),_=Math.sqrt(t*t/(1+m*m))*(r<n?-1:1),C=m*_;if(Math.abs(d-a-m*(f-n))<1e-10)return{x:f+_,y:d+C};const E=((f-n)*(r-n)+(d-a)*(l-a))/(g*g),R=n+E*(r-n),v=a+E*(l-a),D=this.getLineLength(f,d,R,v),L=Math.sqrt(t*t-D*D),B=Math.sqrt(L*L/(1+m*m))*(r<n?-1:1),N=m*B;return{x:R+B,y:v+N}}static getPointOnCubicBezier(t,n,a,r,l,f,d,g,m){function _(L){return L*L*L}function C(L){return 3*L*L*(1-L)}function E(L){return 3*L*(1-L)*(1-L)}function R(L){return(1-L)*(1-L)*(1-L)}const v=g*_(t)+f*C(t)+r*E(t)+n*R(t),D=m*_(t)+d*C(t)+l*E(t)+a*R(t);return{x:v,y:D}}static getPointOnQuadraticBezier(t,n,a,r,l,f,d){function g(R){return R*R}function m(R){return 2*R*(1-R)}function _(R){return(1-R)*(1-R)}const C=f*g(t)+r*m(t)+n*_(t),E=d*g(t)+l*m(t)+a*_(t);return{x:C,y:E}}static getPointOnEllipticalArc(t,n,a,r,l,f){const d=Math.cos(f),g=Math.sin(f),m={x:a*Math.cos(l),y:r*Math.sin(l)};return{x:t+(m.x*d-m.y*g),y:n+(m.x*g+m.y*d)}}static parsePathData(t){if(!t)return[];let n=t;const a=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let C=0;C<a.length;C++)n=n.replace(new RegExp(a[C],"g"),"|"+a[C]);const r=n.split("|"),l=[],f=[];let d=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let C=1;C<r.length;C++){let E=r[C],R=E.charAt(0);for(E=E.slice(1),f.length=0;_=m.exec(E);)f.push(_[0]);let v=[],D=R==="A"||R==="a"?0:-1;for(let L=0,B=f.length;L<B;L++){const N=f[L];if(N==="00"){v.push(0,0),D>=0&&(D+=2,D>=7&&(D-=7));continue}if(D>=0){if(D===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(N)){v.push(parseInt(N[0],10)),v.push(parseInt(N[1],10)),v.push(parseFloat(N.slice(2))),D+=3,D>=7&&(D-=7);continue}if(N==="11"||N==="10"||N==="01"){v.push(parseInt(N[0],10)),v.push(parseInt(N[1],10)),D+=2,D>=7&&(D-=7);continue}if(N==="0"||N==="1"){v.push(parseInt(N,10)),D+=1,D>=7&&(D-=7);continue}}else if(D===4){if(/^[01]\d+(?:\.\d+)?$/.test(N)){v.push(parseInt(N[0],10)),v.push(parseFloat(N.slice(1))),D+=2,D>=7&&(D-=7);continue}if(N==="0"||N==="1"){v.push(parseInt(N,10)),D+=1,D>=7&&(D-=7);continue}}const M=parseFloat(N);isNaN(M)?v.push(0):v.push(M),D+=1,D>=7&&(D-=7)}else{const M=parseFloat(N);isNaN(M)?v.push(0):v.push(M)}}for(;v.length>0&&!isNaN(v[0]);){let L="",B=[];const N=d,M=g;let P,O,A,T,y,z,U,G,K,Q;switch(R){case"l":d+=v.shift(),g+=v.shift(),L="L",B.push(d,g);break;case"L":d=v.shift(),g=v.shift(),B.push(d,g);break;case"m":const X=v.shift(),Y=v.shift();if(d+=X,g+=Y,L="M",l.length>2&&l[l.length-1].command==="z"){for(let j=l.length-2;j>=0;j--)if(l[j].command==="M"){d=l[j].points[0]+X,g=l[j].points[1]+Y;break}}B.push(d,g),R="l";break;case"M":d=v.shift(),g=v.shift(),L="M",B.push(d,g),R="L";break;case"h":d+=v.shift(),L="L",B.push(d,g);break;case"H":d=v.shift(),L="L",B.push(d,g);break;case"v":g+=v.shift(),L="L",B.push(d,g);break;case"V":g=v.shift(),L="L",B.push(d,g);break;case"C":B.push(v.shift(),v.shift(),v.shift(),v.shift()),d=v.shift(),g=v.shift(),B.push(d,g);break;case"c":B.push(d+v.shift(),g+v.shift(),d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),L="C",B.push(d,g);break;case"S":O=d,A=g,P=l[l.length-1],P.command==="C"&&(O=d+(d-P.points[2]),A=g+(g-P.points[3])),B.push(O,A,v.shift(),v.shift()),d=v.shift(),g=v.shift(),L="C",B.push(d,g);break;case"s":O=d,A=g,P=l[l.length-1],P.command==="C"&&(O=d+(d-P.points[2]),A=g+(g-P.points[3])),B.push(O,A,d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),L="C",B.push(d,g);break;case"Q":B.push(v.shift(),v.shift()),d=v.shift(),g=v.shift(),B.push(d,g);break;case"q":B.push(d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),L="Q",B.push(d,g);break;case"T":O=d,A=g,P=l[l.length-1],P.command==="Q"&&(O=d+(d-P.points[0]),A=g+(g-P.points[1])),d=v.shift(),g=v.shift(),L="Q",B.push(O,A,d,g);break;case"t":O=d,A=g,P=l[l.length-1],P.command==="Q"&&(O=d+(d-P.points[0]),A=g+(g-P.points[1])),d+=v.shift(),g+=v.shift(),L="Q",B.push(O,A,d,g);break;case"A":T=v.shift(),y=v.shift(),z=v.shift(),U=v.shift(),G=v.shift(),K=d,Q=g,d=v.shift(),g=v.shift(),L="A",B=this.convertEndpointToCenterParameterization(K,Q,d,g,U,G,T,y,z);break;case"a":T=v.shift(),y=v.shift(),z=v.shift(),U=v.shift(),G=v.shift(),K=d,Q=g,d+=v.shift(),g+=v.shift(),L="A",B=this.convertEndpointToCenterParameterization(K,Q,d,g,U,G,T,y,z);break}l.push({command:L||R,points:B,start:{x:N,y:M},pathLength:this.calcLength(N,M,L||R,B)})}(R==="z"||R==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(t,n,a,r){let l,f,d,g;const m=Hn;switch(a){case"L":return m.getLineLength(t,n,r[0],r[1]);case"C":return Vy([t,r[0],r[2],r[4]],[n,r[1],r[3],r[5]],1);case"Q":return Yy([t,r[0],r[2]],[n,r[1],r[3]],1);case"A":l=0;const _=r[4],C=r[5],E=r[4]+C;let R=Math.PI/180;if(Math.abs(_-E)<R&&(R=Math.abs(_-E)),f=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],_,0),C<0)for(g=_-R;g>E;g-=R)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),f=d;else for(g=_+R;g<E;g+=R)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),f=d;return d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],E,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),l}return 0}static convertEndpointToCenterParameterization(t,n,a,r,l,f,d,g,m){const _=m*(Math.PI/180),C=Math.cos(_)*(t-a)/2+Math.sin(_)*(n-r)/2,E=-1*Math.sin(_)*(t-a)/2+Math.cos(_)*(n-r)/2,R=C*C/(d*d)+E*E/(g*g);R>1&&(d*=Math.sqrt(R),g*=Math.sqrt(R));let v=Math.sqrt((d*d*(g*g)-d*d*(E*E)-g*g*(C*C))/(d*d*(E*E)+g*g*(C*C)));l===f&&(v*=-1),isNaN(v)&&(v=0);const D=v*d*E/g,L=v*-g*C/d,B=(t+a)/2+Math.cos(_)*D-Math.sin(_)*L,N=(n+r)/2+Math.sin(_)*D+Math.cos(_)*L,M=function(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1])},P=function(U,G){return(U[0]*G[0]+U[1]*G[1])/(M(U)*M(G))},O=function(U,G){return(U[0]*G[1]<U[1]*G[0]?-1:1)*Math.acos(P(U,G))},A=O([1,0],[(C-D)/d,(E-L)/g]),T=[(C-D)/d,(E-L)/g],y=[(-1*C-D)/d,(-1*E-L)/g];let z=O(T,y);return P(T,y)<=-1&&(z=Math.PI),P(T,y)>=1&&(z=0),f===0&&z>0&&(z=z-2*Math.PI),f===1&&z<0&&(z=z+2*Math.PI),[B,N,d,g,A,z,_,f]}}Hn.prototype.className="Path";Hn.prototype._attrsAffectingSize=["data"];$n(Hn);ot.addGetterSetter(Hn,"data");class Tu extends _o{_sceneFunc(t){super._sceneFunc(t);const n=Math.PI*2,a=this.points();let r=a;const l=this.tension()!==0&&a.length>4;l&&(r=this.getTensionPoints());const f=this.pointerLength(),d=a.length;let g,m;if(l){const E=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],a[d-2],a[d-1]],R=Hn.calcLength(r[r.length-4],r[r.length-3],"C",E),v=Hn.getPointOnQuadraticBezier(Math.min(1,1-f/R),E[0],E[1],E[2],E[3],E[4],E[5]);g=a[d-2]-v.x,m=a[d-1]-v.y}else g=a[d-2]-a[d-4],m=a[d-1]-a[d-3];const _=(Math.atan2(m,g)+n)%n,C=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(a[d-2],a[d-1]),t.rotate(_),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(a[0],a[1]),l?(g=(r[0]+r[2])/2-a[0],m=(r[1]+r[3])/2-a[1]):(g=a[2]-a[0],m=a[3]-a[1]),t.rotate((Math.atan2(-m,-g)+n)%n),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),n=this.pointerWidth()/2;return{x:t.x,y:t.y-n,width:t.width,height:t.height+n*2}}}Tu.prototype.className="Arrow";$n(Tu);ot.addGetterSetter(Tu,"pointerLength",10,Kt());ot.addGetterSetter(Tu,"pointerWidth",10,Kt());ot.addGetterSetter(Tu,"pointerAtBeginning",!1);ot.addGetterSetter(Tu,"pointerAtEnding",!0);class Sf extends Pt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}Sf.prototype._centroid=!0;Sf.prototype.className="Circle";Sf.prototype._attrsAffectingSize=["radius"];$n(Sf);ot.addGetterSetter(Sf,"radius",0,Kt());class vl extends Pt{_sceneFunc(t){const n=this.radiusX(),a=this.radiusY();t.beginPath(),t.save(),n!==a&&t.scale(1,a/n),t.arc(0,0,n,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}vl.prototype.className="Ellipse";vl.prototype._centroid=!0;vl.prototype._attrsAffectingSize=["radiusX","radiusY"];$n(vl);ot.addComponentsGetterSetter(vl,"radius",["x","y"]);ot.addGetterSetter(vl,"radiusX",0,Kt());ot.addGetterSetter(vl,"radiusY",0,Kt());let Xr=class iS extends Pt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),n=this.hasShadow();return t&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const n=this.getWidth(),a=this.getHeight(),r=this.cornerRadius(),l=this.attrs.image;let f;if(l){const d=this.attrs.cropWidth,g=this.attrs.cropHeight;d&&g?f=[l,this.cropX(),this.cropY(),d,g,0,0,n,a]:f=[l,0,0,n,a]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?mt.drawRoundedRectPath(t,n,a,r):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)),l&&(r&&t.clip(),t.drawImage.apply(t,f))}_hitFunc(t){const n=this.width(),a=this.height(),r=this.cornerRadius();t.beginPath(),r?mt.drawRoundedRectPath(t,n,a,r):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,n,a;return(a=(t=this.attrs.width)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&a!==void 0?a:0}getHeight(){var t,n,a;return(a=(t=this.attrs.height)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&a!==void 0?a:0}static fromURL(t,n,a=null){const r=mt.createImageElement();r.onload=function(){const l=new iS({image:r});n(l)},r.onerror=a,r.crossOrigin="Anonymous",r.src=t}};Xr.prototype.className="Image";Xr.prototype._attrsAffectingSize=["image"];$n(Xr);ot.addGetterSetter(Xr,"cornerRadius",0,Mg(4));ot.addGetterSetter(Xr,"image");ot.addComponentsGetterSetter(Xr,"crop",["x","y","width","height"]);ot.addGetterSetter(Xr,"cropX",0,Kt());ot.addGetterSetter(Xr,"cropY",0,Kt());ot.addGetterSetter(Xr,"cropWidth",0,Kt());ot.addGetterSetter(Xr,"cropHeight",0,Kt());const rS=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],K5="Change.konva",Q5="none",jm="up",Um="right",Bm="down",zm="left",X5=rS.length;class iv extends ff{constructor(t){super(t),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let n=this,a;const r=function(){n._sync()};for(a=0;a<X5;a++)t.on(rS[a]+K5,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),n=this.getTag(),a,r,l,f,d,g,m;if(t&&n){switch(a=t.width(),r=t.height(),l=n.pointerDirection(),f=n.pointerWidth(),m=n.pointerHeight(),d=0,g=0,l){case jm:d=a/2,g=-1*m;break;case Um:d=a+f,g=r/2;break;case Bm:d=a/2,g=r+m;break;case zm:d=-1*f,g=r/2;break}n.setAttrs({x:-1*d,y:-1*g,width:a,height:r}),t.setAttrs({x:-1*d,y:-1*g})}}}iv.prototype.className="Label";$n(iv);class Au extends Pt{_sceneFunc(t){const n=this.width(),a=this.height(),r=this.pointerDirection(),l=this.pointerWidth(),f=this.pointerHeight(),d=this.cornerRadius();let g=0,m=0,_=0,C=0;typeof d=="number"?g=m=_=C=Math.min(d,n/2,a/2):(g=Math.min(d[0]||0,n/2,a/2),m=Math.min(d[1]||0,n/2,a/2),C=Math.min(d[2]||0,n/2,a/2),_=Math.min(d[3]||0,n/2,a/2)),t.beginPath(),t.moveTo(g,0),r===jm&&(t.lineTo((n-l)/2,0),t.lineTo(n/2,-1*f),t.lineTo((n+l)/2,0)),t.lineTo(n-m,0),t.arc(n-m,m,m,Math.PI*3/2,0,!1),r===Um&&(t.lineTo(n,(a-f)/2),t.lineTo(n+l,a/2),t.lineTo(n,(a+f)/2)),t.lineTo(n,a-C),t.arc(n-C,a-C,C,0,Math.PI/2,!1),r===Bm&&(t.lineTo((n+l)/2,a),t.lineTo(n/2,a+f),t.lineTo((n-l)/2,a)),t.lineTo(_,a),t.arc(_,a-_,_,Math.PI/2,Math.PI,!1),r===zm&&(t.lineTo(0,(a+f)/2),t.lineTo(-1*l,a/2),t.lineTo(0,(a-f)/2)),t.lineTo(0,g),t.arc(g,g,g,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,n=0,a=this.pointerWidth(),r=this.pointerHeight(),l=this.pointerDirection(),f=this.width(),d=this.height();return l===jm?(n-=r,d+=r):l===Bm?d+=r:l===zm?(t-=a*1.5,f+=a):l===Um&&(f+=a*1.5),{x:t,y:n,width:f,height:d}}}Au.prototype.className="Tag";$n(Au);ot.addGetterSetter(Au,"pointerDirection",Q5);ot.addGetterSetter(Au,"pointerWidth",0,Kt());ot.addGetterSetter(Au,"pointerHeight",0,Kt());ot.addGetterSetter(Au,"cornerRadius",0,Mg(4));class bh extends Pt{_sceneFunc(t){const n=this.cornerRadius(),a=this.width(),r=this.height();t.beginPath(),n?mt.drawRoundedRectPath(t,a,r,n):t.rect(0,0,a,r),t.closePath(),t.fillStrokeShape(this)}}bh.prototype.className="Rect";$n(bh);ot.addGetterSetter(bh,"cornerRadius",0,Mg(4));class yl extends Pt{_sceneFunc(t){const n=this._getPoints(),a=this.radius(),r=this.sides(),l=this.cornerRadius();if(t.beginPath(),l)mt.drawRoundedPolygonPath(t,n,r,a,l);else{t.moveTo(n[0].x,n[0].y);for(let f=1;f<n.length;f++)t.lineTo(n[f].x,n[f].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,n=this.attrs.radius||0,a=[];for(let r=0;r<t;r++)a.push({x:n*Math.sin(r*2*Math.PI/t),y:-1*n*Math.cos(r*2*Math.PI/t)});return a}getSelfRect(){const t=this._getPoints();let n=t[0].x,a=t[0].y,r=t[0].x,l=t[0].y;return t.forEach(f=>{n=Math.min(n,f.x),a=Math.max(a,f.x),r=Math.min(r,f.y),l=Math.max(l,f.y)}),{x:n,y:r,width:a-n,height:l-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}yl.prototype.className="RegularPolygon";yl.prototype._centroid=!0;yl.prototype._attrsAffectingSize=["radius"];$n(yl);ot.addGetterSetter(yl,"radius",0,Kt());ot.addGetterSetter(yl,"sides",0,Kt());ot.addGetterSetter(yl,"cornerRadius",0,Mg(4));const Qy=Math.PI*2;class wu extends Pt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Qy,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Qy,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}wu.prototype.className="Ring";wu.prototype._centroid=!0;wu.prototype._attrsAffectingSize=["innerRadius","outerRadius"];$n(wu);ot.addGetterSetter(wu,"innerRadius",0,Kt());ot.addGetterSetter(wu,"outerRadius",0,Kt());class Cs extends Pt{constructor(t){super(t),this._updated=!0,this.anim=new yr(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const n=this.animation(),a=this.frameIndex(),r=a*4,l=this.animations()[n],f=this.frameOffsets(),d=l[r+0],g=l[r+1],m=l[r+2],_=l[r+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,m,_),t.closePath(),t.fillStrokeShape(this)),C)if(f){const E=f[n],R=a*2;t.drawImage(C,d,g,m,_,E[R+0],E[R+1],m,_)}else t.drawImage(C,d,g,m,_,0,0,m,_)}_hitFunc(t){const n=this.animation(),a=this.frameIndex(),r=a*4,l=this.animations()[n],f=this.frameOffsets(),d=l[r+2],g=l[r+3];if(t.beginPath(),f){const m=f[n],_=a*2;t.rect(m[_+0],m[_+1],d,g)}else t.rect(0,0,d,g);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),n=this.animation(),a=this.animations(),r=a[n],l=r.length/4;t<l-1?this.frameIndex(t+1):this.frameIndex(0)}}Cs.prototype.className="Sprite";$n(Cs);ot.addGetterSetter(Cs,"animation");ot.addGetterSetter(Cs,"animations");ot.addGetterSetter(Cs,"frameOffsets");ot.addGetterSetter(Cs,"image");ot.addGetterSetter(Cs,"frameIndex",0,Kt());ot.addGetterSetter(Cs,"frameRate",17,Kt());ot.backCompat(Cs,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Sl extends Pt{_sceneFunc(t){const n=this.innerRadius(),a=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-a);for(let l=1;l<r*2;l++){const f=l%2===0?a:n,d=f*Math.sin(l*Math.PI/r),g=-1*f*Math.cos(l*Math.PI/r);t.lineTo(d,g)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Sl.prototype.className="Star";Sl.prototype._centroid=!0;Sl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];$n(Sl);ot.addGetterSetter(Sl,"numPoints",5,Kt());ot.addGetterSetter(Sl,"innerRadius",0,Kt());ot.addGetterSetter(Sl,"outerRadius",0,Kt());function cl(o){return[...o].reduce((t,n,a,r)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const l=r[a+1];l&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(l)?(t.push(n+l),r[a+1]=""):t.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(r[a+1]||""))?t.push(n+r[a+1]):a>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?t[t.length-1]+=n:n&&t.push(n);return t},[])}const Jc="auto",F5="center",sS="inherit",Zc="justify",J5="Change.konva",Z5="2d",Xy="-",oS="left",W5="text",$5="Text",t6="top",e6="bottom",Fy="middle",lS="normal",n6="px ",tg=" ",a6="right",Jy="rtl",i6="word",r6="char",Zy="none",Dp="",uS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],s6=uS.length;function o6(o){return o.split(",").map(t=>{t=t.trim();const n=t.indexOf(" ")>=0,a=t.indexOf('"')>=0||t.indexOf("'")>=0;return n&&!a&&(t=`"${t}"`),t}).join(", ")}let eg;function jp(){return eg||(eg=mt.createCanvasElement().getContext(Z5),eg)}function l6(o){o.fillText(this._partialText,this._partialTextX,this._partialTextY)}function u6(o){o.setAttr("miterLimit",2),o.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function c6(o){return o=o||{},!o.fillLinearGradientColorStops&&!o.fillRadialGradientColorStops&&!o.fillPatternImage&&(o.fill=o.fill||"black"),o}class qn extends Pt{constructor(t){super(c6(t)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<s6;n++)this.on(uS[n]+J5,this._setTextData);this._setTextData()}_sceneFunc(t){var n,a;const r=this.textArr,l=r.length;if(!this.text())return;let f=this.padding(),d=this.fontSize(),g=this.lineHeight()*d,m=this.verticalAlign(),_=this.direction(),C=0,E=this.align(),R=this.getWidth(),v=this.letterSpacing(),D=this.charRenderFunc(),L=this.fill(),B=this.textDecoration(),N=B.indexOf("underline")!==-1,M=B.indexOf("line-through")!==-1,P;_=_===sS?t.direction:_;let O=g/2,A=Fy;if(!Jt.legacyTextRendering){const T=this.measureSize("M");A="alphabetic";const y=(n=T.fontBoundingBoxAscent)!==null&&n!==void 0?n:T.actualBoundingBoxAscent,z=(a=T.fontBoundingBoxDescent)!==null&&a!==void 0?a:T.actualBoundingBoxDescent;O=(y-z)/2+g/2}for(_===Jy&&t.setAttr("direction",_),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",A),t.setAttr("textAlign",oS),m===Fy?C=(this.getHeight()-l*g-f*2)/2:m===e6&&(C=this.getHeight()-l*g-f*2),t.translate(f,C+f),P=0;P<l;P++){let T=0,y=0;const z=r[P],U=z.text,G=z.width,K=z.lastInParagraph;if(t.save(),E===a6?T+=R-G-f*2:E===F5&&(T+=(R-G-f*2)/2),N){t.save(),t.beginPath();const Q=Jt.legacyTextRendering?Math.round(d/2):Math.round(d/4),X=T,Y=O+y+Q;t.moveTo(X,Y);const j=E===Zc&&!K?R-f*2:G;t.lineTo(X+Math.round(j),Y),t.lineWidth=d/15;const I=this._getLinearGradient();t.strokeStyle=I||L,t.stroke(),t.restore()}if(_!==Jy&&(v!==0||E===Zc||D)){const Q=U.split(" ").length-1,X=cl(U);for(let Y=0;Y<X.length;Y++){const j=X[Y];if(j===" "&&!K&&E===Zc&&(T+=(R-f*2-G)/Q),this._partialTextX=T,this._partialTextY=O+y,this._partialText=j,D){t.save();const F=r.slice(0,P).reduce((it,Z)=>it+cl(Z.text).length,0),W=Y+F;D({char:j,index:W,x:T,y:O+y,lineIndex:P,column:Y,isLastInLine:K,width:this.measureSize(j).width,context:t})}t.fillStrokeShape(this),D&&t.restore(),T+=this.measureSize(j).width+v}}else v!==0&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=T,this._partialTextY=O+y,this._partialText=U,t.fillStrokeShape(this);if(M){t.save(),t.beginPath();const Q=Jt.legacyTextRendering?0:-Math.round(d/4),X=E===Zc?0:T;t.moveTo(X,O+y+Q);const Y=E===Zc&&!K?R-f*2:G;t.lineTo(X+Math.round(Y),O+y+Q),t.lineWidth=d/15;const j=this._getLinearGradient();t.strokeStyle=j||L,t.stroke(),t.restore()}t.restore(),l>1&&(O+=g)}}_hitFunc(t){const n=this.getWidth(),a=this.getHeight();t.beginPath(),t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}setText(t){const n=mt._isString(t)?t:t==null?"":t+"";return this._setAttr(W5,n),this}getWidth(){return this.attrs.width===Jc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Jc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return mt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var n,a,r,l,f,d,g,m,_,C,E;let R=jp(),v=this.fontSize(),D;R.save(),R.font=this._getContextFont(),D=R.measureText(t),R.restore();const L=v/100;return{actualBoundingBoxAscent:(n=D.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*L,actualBoundingBoxDescent:(a=D.actualBoundingBoxDescent)!==null&&a!==void 0?a:0,actualBoundingBoxLeft:(r=D.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*L,actualBoundingBoxRight:(l=D.actualBoundingBoxRight)!==null&&l!==void 0?l:75.732421875*L,alphabeticBaseline:(f=D.alphabeticBaseline)!==null&&f!==void 0?f:0,emHeightAscent:(d=D.emHeightAscent)!==null&&d!==void 0?d:100*L,emHeightDescent:(g=D.emHeightDescent)!==null&&g!==void 0?g:-20*L,fontBoundingBoxAscent:(m=D.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*L,fontBoundingBoxDescent:(_=D.fontBoundingBoxDescent)!==null&&_!==void 0?_:21*L,hangingBaseline:(C=D.hangingBaseline)!==null&&C!==void 0?C:72.80000305175781*L,ideographicBaseline:(E=D.ideographicBaseline)!==null&&E!==void 0?E:-21*L,width:D.width,height:v}}_getContextFont(){return this.fontStyle()+tg+this.fontVariant()+tg+(this.fontSize()+n6)+o6(this.fontFamily())}_addTextLine(t){this.align()===Zc&&(t=t.trim());const a=this._getTextWidth(t);return this.textArr.push({text:t,width:a,lastInParagraph:!1})}_getTextWidth(t){const n=this.letterSpacing(),a=t.length;return jp().measureText(t).width+n*a}_setTextData(){let t=this.text().split(`
`),n=+this.fontSize(),a=0,r=this.lineHeight()*n,l=this.attrs.width,f=this.attrs.height,d=l!==Jc&&l!==void 0,g=f!==Jc&&f!==void 0,m=this.padding(),_=l-m*2,C=f-m*2,E=0,R=this.wrap(),v=R!==Zy,D=R!==r6&&v,L=this.ellipsis();this.textArr=[],jp().font=this._getContextFont();const B=L?this._getTextWidth(Dp):0;for(let N=0,M=t.length;N<M;++N){let P=t[N],O=this._getTextWidth(P);if(d&&O>_)for(;P.length>0;){let A=0,T=cl(P).length,y="",z=0;for(;A<T;){const U=A+T>>>1,G=cl(P),K=G.slice(0,U+1).join(""),Q=this._getTextWidth(K);(L&&g&&E+r>C?Q+B:Q)<=_?(A=U+1,y=K,z=Q):T=U}if(y){if(D){const K=cl(P),Q=cl(y),X=K[Q.length],Y=X===tg||X===Xy;let j;if(Y&&z<=_)j=Q.length;else{const I=Q.lastIndexOf(tg),F=Q.lastIndexOf(Xy);j=Math.max(I,F)+1}j>0&&(A=j,y=K.slice(0,A).join(""),z=this._getTextWidth(y))}if(y=y.trimRight(),this._addTextLine(y),a=Math.max(a,z),E+=r,this._shouldHandleEllipsis(E)){this._tryToAddEllipsisToLastLine();break}if(P=cl(P).slice(A).join("").trimLeft(),P.length>0&&(O=this._getTextWidth(P),O<=_)){this._addTextLine(P),E+=r,a=Math.max(a,O);break}}else break}else this._addTextLine(P),E+=r,a=Math.max(a,O),this._shouldHandleEllipsis(E)&&N<M-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&E+r>C)break}this.textHeight=n,this.textWidth=a}_shouldHandleEllipsis(t){const n=+this.fontSize(),a=this.lineHeight()*n,r=this.attrs.height,l=r!==Jc&&r!==void 0,f=this.padding(),d=r-f*2;return!(this.wrap()!==Zy)||l&&t+a>d}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,n=t!==Jc&&t!==void 0,a=this.padding(),r=t-a*2,l=this.ellipsis(),f=this.textArr[this.textArr.length-1];!f||!l||(n&&(this._getTextWidth(f.text+Dp)<r||(f.text=f.text.slice(0,f.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(f.text+Dp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return t&&n?!0:super._useBufferCanvas()}}qn.prototype._fillFunc=l6;qn.prototype._strokeFunc=u6;qn.prototype.className=$5;qn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];$n(qn);ot.overWriteSetter(qn,"width",ev());ot.overWriteSetter(qn,"height",ev());ot.addGetterSetter(qn,"direction",sS);ot.addGetterSetter(qn,"fontFamily","Arial");ot.addGetterSetter(qn,"fontSize",12,Kt());ot.addGetterSetter(qn,"fontStyle",lS);ot.addGetterSetter(qn,"fontVariant",lS);ot.addGetterSetter(qn,"padding",0,Kt());ot.addGetterSetter(qn,"align",oS);ot.addGetterSetter(qn,"verticalAlign",t6);ot.addGetterSetter(qn,"lineHeight",1,Kt());ot.addGetterSetter(qn,"wrap",i6);ot.addGetterSetter(qn,"ellipsis",!1,Qr());ot.addGetterSetter(qn,"letterSpacing",0,Kt());ot.addGetterSetter(qn,"text","",Eu());ot.addGetterSetter(qn,"textDecoration","");ot.addGetterSetter(qn,"charRenderFunc",void 0);const f6="",cS="normal";function fS(o){o.fillText(this.partialText,0,0)}function dS(o){o.strokeText(this.partialText,0,0)}class Ra extends Pt{constructor(t){super(t),this.dummyCanvas=mt.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Hn.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const n=this.pathLength;return t>n?null:Hn.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Hn.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const n=this.textDecoration(),a=this.fill(),r=this.fontSize(),l=this.glyphInfo,f=n.indexOf("underline")!==-1,d=n.indexOf("line-through")!==-1;f&&t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),this.partialText=l[g].text,t.fillStrokeShape(this),f&&(g===0&&t.moveTo(0,r/2+1),t.lineTo(l[g].width,r/2+1)),t.restore()}if(f&&(t.strokeStyle=a,t.lineWidth=r/20,t.stroke()),d){t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),g===0&&t.moveTo(0,0),t.lineTo(l[g].width,0),t.restore()}t.strokeStyle=a,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const n=this.glyphInfo;if(n.length>=1){const a=n[0].p0;t.moveTo(a.x,a.y)}for(let a=0;a<n.length;a++){const r=n[a].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return mt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return qn.prototype.setText.call(this,t)}_getContextFont(){return qn.prototype._getContextFont.call(this)}_getTextSize(t){const a=this.dummyCanvas.getContext("2d");a.save(),a.font=this._getContextFont();const r=a.measureText(t);return a.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=cl(this.text()),n=[];let a=0;for(let C=0;C<t.length;C++)n.push({char:t[C],width:this._getTextSize(t[C]).width}),a+=n[C].width;const{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=a,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const l=this.letterSpacing(),f=this.align(),d=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*l,0);let m=0;f==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),f==="right"&&(m=Math.max(0,this.pathLength-g));let _=m;for(let C=0;C<n.length;C++){const E=this._getPointAtLength(_);if(!E)return;const R=n[C].char;let v=n[C].width+l;if(R===" "&&f==="justify"){const P=this.text().split(" ").length-1;v+=(this.pathLength-g)/P}const D=this._getPointAtLength(_+v);if(!D)return;const L=Hn.getLineLength(E.x,E.y,D.x,D.y);let B=0;if(d)try{B=d(n[C-1].char,R)*this.fontSize()}catch{B=0}E.x+=B,D.x+=B,this.textWidth+=B;const N=Hn.getPointOnLine(B+L/2,E.x,E.y,D.x,D.y),M=Math.atan2(D.y-E.y,D.x-E.x);this.glyphInfo.push({transposeX:N.x,transposeY:N.y,text:t[C],rotation:M,p0:E,p1:D,width:L}),_+=v}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});let n=t[0]||0,a=t[0]||0,r=t[1]||0,l=t[1]||0,f,d;for(let m=0;m<t.length/2;m++)f=t[m*2],d=t[m*2+1],n=Math.min(n,f),a=Math.max(a,f),r=Math.min(r,d),l=Math.max(l,d);const g=this.fontSize();return{x:n-g/2,y:r-g/2,width:a-n+g,height:l-r+g}}destroy(){return mt.releaseCanvas(this.dummyCanvas),super.destroy()}}Ra.prototype._fillFunc=fS;Ra.prototype._strokeFunc=dS;Ra.prototype._fillFuncHit=fS;Ra.prototype._strokeFuncHit=dS;Ra.prototype.className="TextPath";Ra.prototype._attrsAffectingSize=["text","fontSize","data"];$n(Ra);ot.addGetterSetter(Ra,"data");ot.addGetterSetter(Ra,"fontFamily","Arial");ot.addGetterSetter(Ra,"fontSize",12,Kt());ot.addGetterSetter(Ra,"fontStyle",cS);ot.addGetterSetter(Ra,"align","left");ot.addGetterSetter(Ra,"letterSpacing",0,Kt());ot.addGetterSetter(Ra,"textBaseline","middle");ot.addGetterSetter(Ra,"fontVariant",cS);ot.addGetterSetter(Ra,"text",f6);ot.addGetterSetter(Ra,"textDecoration","");ot.addGetterSetter(Ra,"kerningFunc",void 0);const hS="tr-konva",d6=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(o=>o+`.${hS}`).join(" "),Wy="nodesRect",h6=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],g6={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},p6="ontouchstart"in Jt._global;function m6(o,t,n){if(o==="rotater")return n;t+=mt.degToRad(g6[o]||0);const a=(mt.radToDeg(t)%360+360)%360;return mt._inRange(a,315+22.5,360)||mt._inRange(a,0,22.5)?"ns-resize":mt._inRange(a,45-22.5,45+22.5)?"nesw-resize":mt._inRange(a,90-22.5,90+22.5)?"ew-resize":mt._inRange(a,135-22.5,135+22.5)?"nwse-resize":mt._inRange(a,180-22.5,180+22.5)?"ns-resize":mt._inRange(a,225-22.5,225+22.5)?"nesw-resize":mt._inRange(a,270-22.5,270+22.5)?"ew-resize":mt._inRange(a,315-22.5,315+22.5)?"nwse-resize":(mt.error("Transformer has unknown angle for cursor detection: "+a),"pointer")}const yg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function v6(o){return{x:o.x+o.width/2*Math.cos(o.rotation)+o.height/2*Math.sin(-o.rotation),y:o.y+o.height/2*Math.cos(o.rotation)+o.width/2*Math.sin(o.rotation)}}function gS(o,t,n){const a=n.x+(o.x-n.x)*Math.cos(t)-(o.y-n.y)*Math.sin(t),r=n.y+(o.x-n.x)*Math.sin(t)+(o.y-n.y)*Math.cos(t);return{...o,rotation:o.rotation+t,x:a,y:r}}function y6(o,t){const n=v6(o);return gS(o,t,n)}function S6(o,t,n){let a=t;for(let r=0;r<o.length;r++){const l=Jt.getAngle(o[r]),f=Math.abs(l-t)%(Math.PI*2);Math.min(f,Math.PI*2-f)<n&&(a=l)}return a}let Lm=0;class tn extends ff{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d6,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return mt.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return hS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const n=t.filter(r=>r.isAncestorOf(this)?(mt.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=n,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){const f=r._attrsAffectingSize.map(d=>d+"Change."+this._getEventNamespace()).join(" ");r.on(f,l)}r.on(h6.map(f=>f+`.${this._getEventNamespace()}`).join(" "),l),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let n;t.on(`dragstart.${this._getEventNamespace()}`,a=>{n=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(a,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,a=>{if(!n)return;const r=t.getAbsolutePosition(),l=r.x-n.x,f=r.y-n.y;this.nodes().forEach(d=>{if(d===t||d.isDragging())return;const g=d.getAbsolutePosition();d.setAbsolutePosition({x:g.x+l,y:g.y+f}),d.startDrag(a)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Wy),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Wy,this.__getNodeRect)}__getNodeShape(t,n=this.rotation(),a){const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=t.getAbsoluteScale(a),f=t.getAbsolutePosition(a),d=r.x*l.x-t.offsetX()*l.x,g=r.y*l.y-t.offsetY()*l.y,m=(Jt.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),_={x:f.x+d*Math.cos(m)+g*Math.sin(-m),y:f.y+g*Math.cos(m)+d*Math.sin(m),width:r.width*l.x,height:r.height*l.y,rotation:m};return gS(_,-Jt.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const _=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),C=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}],E=m.getAbsoluteTransform();C.forEach(function(R){const v=E.point(R);n.push(v)})});const a=new Ii;a.rotate(-Jt.getAngle(this.rotation()));let r=1/0,l=1/0,f=-1/0,d=-1/0;n.forEach(function(m){const _=a.point(m);r===void 0&&(r=f=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),f=Math.max(f,_.x),d=Math.max(d,_.y)}),a.invert();const g=a.point({x:r,y:l});return{x:g.x,y:g.y,width:f-r,height:d-l,rotation:Jt.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),yg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const n=new bh({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:p6?10:"auto"}),a=this;n.on("mousedown touchstart",function(r){a._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{const r=Jt.getAngle(this.rotation()),l=this.rotateAnchorCursor(),f=m6(t,r,l);n.getStage().content&&(n.getStage().content.style.cursor=f),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const t=new Pt({name:"back",width:0,height:0,sceneFunc(n,a){const r=a.getParent(),l=r.padding();n.beginPath(),n.rect(-l,-l,a.width()+l*2,a.height()+l*2),n.moveTo(a.width()/2,-l),r.rotateEnabled()&&r.rotateLineVisible()&&n.lineTo(a.width()/2,-r.rotateAnchorOffset()*mt._sign(a.height())-l),n.fillStrokeShape(a)},hitFunc:(n,a)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();n.beginPath(),n.rect(-r,-r,a.width()+r*2,a.height()+r*2),n.fillStrokeShape(a)}});this.add(t),this._proxyDrag(t),t.on("dragstart",n=>{n.cancelBubble=!0}),t.on("dragmove",n=>{n.cancelBubble=!0}),t.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const n=this._getNodeRect(),a=n.width,r=n.height,l=Math.sqrt(Math.pow(a,2)+Math.pow(r,2));this.sin=Math.abs(r/l),this.cos=Math.abs(a/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const f=t.target.getAbsolutePosition(),d=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:d.x-f.x,y:d.y-f.y},Lm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:t.evt,target:g})})}_handleMouseMove(t){let n,a,r;const l=this.findOne("."+this._movingAnchorName),f=l.getStage();f.setPointersPositions(t);const d=f.getPointerPosition();let g={x:d.x-this._anchorDragOffset.x,y:d.y-this._anchorDragOffset.y};const m=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,t)),l.setAbsolutePosition(g);const _=l.getAbsolutePosition();if(m.x===_.x&&m.y===_.y)return;if(this._movingAnchorName==="rotater"){const N=this._getNodeRect();n=l.x()-N.width/2,a=-l.y()+N.height/2;let M=Math.atan2(-a,n)+Math.PI/2;N.height<0&&(M-=Math.PI);const O=Jt.getAngle(this.rotation())+M,A=Jt.getAngle(this.rotationSnapTolerance()),y=S6(this.rotationSnaps(),O,A)-N.rotation,z=y6(N,y);this._fitNodesInto(z,t);return}const C=this.shiftBehavior();let E;C==="inverted"?E=this.keepRatio()&&!t.shiftKey:C==="none"?E=this.keepRatio():E=this.keepRatio()||t.shiftKey;let R=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(N.x-l.x(),2)+Math.pow(N.y-l.y(),2));const M=this.findOne(".top-left").x()>N.x?-1:1,P=this.findOne(".top-left").y()>N.y?-1:1;n=r*this.cos*M,a=r*this.sin*P,this.findOne(".top-left").x(N.x-n),this.findOne(".top-left").y(N.y-a)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(l.x()-N.x,2)+Math.pow(N.y-l.y(),2));const M=this.findOne(".top-right").x()<N.x?-1:1,P=this.findOne(".top-right").y()>N.y?-1:1;n=r*this.cos*M,a=r*this.sin*P,this.findOne(".top-right").x(N.x+n),this.findOne(".top-right").y(N.y-a)}var v=l.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(N.x-l.x(),2)+Math.pow(l.y()-N.y,2));const M=N.x<l.x()?-1:1,P=l.y()<N.y?-1:1;n=r*this.cos*M,a=r*this.sin*P,l.x(N.x-n),l.y(N.y+a)}v=l.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(l.x()-N.x,2)+Math.pow(l.y()-N.y,2));const M=this.findOne(".bottom-right").x()<N.x?-1:1,P=this.findOne(".bottom-right").y()<N.y?-1:1;n=r*this.cos*M,a=r*this.sin*P,this.findOne(".bottom-right").x(N.x+n),this.findOne(".bottom-right").y(N.y+a)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(R=this.centeredScaling()||t.altKey,R){const N=this.findOne(".top-left"),M=this.findOne(".bottom-right"),P=N.x(),O=N.y(),A=this.getWidth()-M.x(),T=this.getHeight()-M.y();M.move({x:-P,y:-O}),N.move({x:A,y:T})}const D=this.findOne(".top-left").getAbsolutePosition();n=D.x,a=D.y;const L=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),B=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:a,width:L,height:B,rotation:Jt.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const a=this.getNode();Lm--,this._fire("transformend",{evt:t,target:a}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),a&&this._nodes.forEach(r=>{var l;r._fire("transformend",{evt:t,target:r}),(l=r.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,n){const a=this._getNodeRect(),r=1;if(mt._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(mt._inRange(t.height,-this.padding()*2-r,r)){this.update();return}const l=new Ii;if(l.rotate(Jt.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=l.point({x:-this.padding()*2,y:0});t.x+=E.x,t.y+=E.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=l.point({x:0,y:-this.padding()*2});t.x+=E.x,t.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(a,t);E?t=E:mt.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const f=1e7,d=new Ii;d.translate(a.x,a.y),d.rotate(a.rotation),d.scale(a.width/f,a.height/f);const g=new Ii,m=t.width/f,_=t.height/f;this.flipEnabled()===!1?(g.translate(t.x,t.y),g.rotate(t.rotation),g.translate(t.width<0?t.width:0,t.height<0?t.height:0),g.scale(Math.abs(m),Math.abs(_))):(g.translate(t.x,t.y),g.rotate(t.rotation),g.scale(m,_));const C=g.multiply(d.invert());this._nodes.forEach(E=>{var R;if(!E.getStage())return;const v=E.getParent().getAbsoluteTransform(),D=E.getTransform().copy();D.translate(E.offsetX(),E.offsetY());const L=new Ii;L.multiply(v.copy().invert()).multiply(C).multiply(v).multiply(D);const B=L.decompose();E.setAttrs(B),(R=E.getLayer())===null||R===void 0||R.batchDraw()}),this.rotation(mt._getRotation(t.rotation)),this._nodes.forEach(E=>{this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,n){this.findOne(t).setAttrs(n)}update(){var t;const n=this._getNodeRect();this.rotation(mt._getRotation(n.rotation));const a=n.width,r=n.height,l=this.enabledAnchors(),f=this.resizeEnabled(),d=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(C=>{C.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+d,offsetY:g/2+d,visible:f&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:a/2,y:0,offsetY:g/2+d,visible:f&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:a,y:0,offsetX:g/2-d,offsetY:g/2+d,visible:f&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:g/2+d,visible:f&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:a,y:r/2,offsetX:g/2-d,visible:f&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:g/2+d,offsetY:g/2-d,visible:f&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:a/2,y:r,offsetY:g/2-d,visible:f&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:a,y:r,offsetX:g/2-d,offsetY:g/2-d,visible:f&&l.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:a/2,y:-this.rotateAnchorOffset()*mt._sign(r)-d,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:a,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(C=>C.draggable()),x:0,y:0});const _=this.anchorStyleFunc();_&&m.forEach(C=>{_(C)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),ff.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Vt.prototype.toObject.call(this)}clone(t){return Vt.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}tn.isTransforming=()=>Lm>0;function b6(o){return o instanceof Array||mt.warn("enabledAnchors value should be an array"),o instanceof Array&&o.forEach(function(t){yg.indexOf(t)===-1&&mt.warn("Unknown anchor name: "+t+". Available names are: "+yg.join(", "))}),o||[]}tn.prototype.className="Transformer";$n(tn);ot.addGetterSetter(tn,"enabledAnchors",yg,b6);ot.addGetterSetter(tn,"flipEnabled",!0,Qr());ot.addGetterSetter(tn,"resizeEnabled",!0);ot.addGetterSetter(tn,"anchorSize",10,Kt());ot.addGetterSetter(tn,"rotateEnabled",!0);ot.addGetterSetter(tn,"rotateLineVisible",!0);ot.addGetterSetter(tn,"rotationSnaps",[]);ot.addGetterSetter(tn,"rotateAnchorOffset",50,Kt());ot.addGetterSetter(tn,"rotateAnchorCursor","crosshair");ot.addGetterSetter(tn,"rotationSnapTolerance",5,Kt());ot.addGetterSetter(tn,"borderEnabled",!0);ot.addGetterSetter(tn,"anchorStroke","rgb(0, 161, 255)");ot.addGetterSetter(tn,"anchorStrokeWidth",1,Kt());ot.addGetterSetter(tn,"anchorFill","white");ot.addGetterSetter(tn,"anchorCornerRadius",0,Kt());ot.addGetterSetter(tn,"borderStroke","rgb(0, 161, 255)");ot.addGetterSetter(tn,"borderStrokeWidth",1,Kt());ot.addGetterSetter(tn,"borderDash");ot.addGetterSetter(tn,"keepRatio",!0);ot.addGetterSetter(tn,"shiftBehavior","default");ot.addGetterSetter(tn,"centeredScaling",!1);ot.addGetterSetter(tn,"ignoreStroke",!1);ot.addGetterSetter(tn,"padding",0,Kt());ot.addGetterSetter(tn,"nodes");ot.addGetterSetter(tn,"node");ot.addGetterSetter(tn,"boundBoxFunc");ot.addGetterSetter(tn,"anchorDragBoundFunc");ot.addGetterSetter(tn,"anchorStyleFunc");ot.addGetterSetter(tn,"shouldOverdrawWholeArea",!1);ot.addGetterSetter(tn,"useSingleNodeRotation",!0);ot.backCompat(tn,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class Eo extends Pt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Jt.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Eo.prototype.className="Wedge";Eo.prototype._centroid=!0;Eo.prototype._attrsAffectingSize=["radius"];$n(Eo);ot.addGetterSetter(Eo,"radius",0,Kt());ot.addGetterSetter(Eo,"angle",0,Kt());ot.addGetterSetter(Eo,"clockwise",!1);ot.backCompat(Eo,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function $y(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const _6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],E6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function C6(o,t){const n=o.data,a=o.width,r=o.height;let l,f,d,g,m,_,C,E,R,v,D,L,B,N,M,P,O,A,T,y;const z=t+t+1,U=a-1,G=r-1,K=t+1,Q=K*(K+1)/2,X=new $y,Y=_6[t],j=E6[t];let I=null,F=X,W=null,it=null;for(let Z=1;Z<z;Z++)F=F.next=new $y,Z===K&&(I=F);F.next=X,d=f=0;for(let Z=0;Z<r;Z++){L=B=N=M=g=m=_=C=0,E=K*(P=n[f]),R=K*(O=n[f+1]),v=K*(A=n[f+2]),D=K*(T=n[f+3]),g+=Q*P,m+=Q*O,_+=Q*A,C+=Q*T,F=X;for(let at=0;at<K;at++)F.r=P,F.g=O,F.b=A,F.a=T,F=F.next;for(let at=1;at<K;at++)l=f+((U<at?U:at)<<2),g+=(F.r=P=n[l])*(y=K-at),m+=(F.g=O=n[l+1])*y,_+=(F.b=A=n[l+2])*y,C+=(F.a=T=n[l+3])*y,L+=P,B+=O,N+=A,M+=T,F=F.next;W=X,it=I;for(let at=0;at<a;at++)n[f+3]=T=C*Y>>j,T!==0?(T=255/T,n[f]=(g*Y>>j)*T,n[f+1]=(m*Y>>j)*T,n[f+2]=(_*Y>>j)*T):n[f]=n[f+1]=n[f+2]=0,g-=E,m-=R,_-=v,C-=D,E-=W.r,R-=W.g,v-=W.b,D-=W.a,l=d+((l=at+t+1)<U?l:U)<<2,L+=W.r=n[l],B+=W.g=n[l+1],N+=W.b=n[l+2],M+=W.a=n[l+3],g+=L,m+=B,_+=N,C+=M,W=W.next,E+=P=it.r,R+=O=it.g,v+=A=it.b,D+=T=it.a,L-=P,B-=O,N-=A,M-=T,it=it.next,f+=4;d+=a}for(let Z=0;Z<a;Z++){B=N=M=L=m=_=C=g=0,f=Z<<2,E=K*(P=n[f]),R=K*(O=n[f+1]),v=K*(A=n[f+2]),D=K*(T=n[f+3]),g+=Q*P,m+=Q*O,_+=Q*A,C+=Q*T,F=X;for(let rt=0;rt<K;rt++)F.r=P,F.g=O,F.b=A,F.a=T,F=F.next;let at=a;for(let rt=1;rt<=t;rt++)f=at+Z<<2,g+=(F.r=P=n[f])*(y=K-rt),m+=(F.g=O=n[f+1])*y,_+=(F.b=A=n[f+2])*y,C+=(F.a=T=n[f+3])*y,L+=P,B+=O,N+=A,M+=T,F=F.next,rt<G&&(at+=a);f=Z,W=X,it=I;for(let rt=0;rt<r;rt++)l=f<<2,n[l+3]=T=C*Y>>j,T>0?(T=255/T,n[l]=(g*Y>>j)*T,n[l+1]=(m*Y>>j)*T,n[l+2]=(_*Y>>j)*T):n[l]=n[l+1]=n[l+2]=0,g-=E,m-=R,_-=v,C-=D,E-=W.r,R-=W.g,v-=W.b,D-=W.a,l=Z+((l=rt+K)<G?l:G)*a<<2,g+=L+=W.r=n[l],m+=B+=W.g=n[l+1],_+=N+=W.b=n[l+2],C+=M+=W.a=n[l+3],W=W.next,E+=P=it.r,R+=O=it.g,v+=A=it.b,D+=T=it.a,L-=P,B-=O,N-=A,M-=T,it=it.next,f+=a}}const T6=function(t){const n=Math.round(this.blurRadius());n>0&&C6(t,n)};ot.addGetterSetter(Vt,"blurRadius",0,Kt(),ot.afterSetFilter);const A6=function(o){const t=this.brightness()*255,n=o.data,a=n.length;for(let r=0;r<a;r+=4)n[r]+=t,n[r+1]+=t,n[r+2]+=t};ot.addGetterSetter(Vt,"brightness",0,Kt(),ot.afterSetFilter);const w6=function(o){const t=this.brightness(),n=o.data,a=n.length;for(let r=0;r<a;r+=4)n[r]=Math.min(255,n[r]*t),n[r+1]=Math.min(255,n[r+1]*t),n[r+2]=Math.min(255,n[r+2]*t)},R6=function(o){const t=Math.pow((this.contrast()+100)/100,2),n=o.data,a=n.length;let r=150,l=150,f=150;for(let d=0;d<a;d+=4)r=n[d],l=n[d+1],f=n[d+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,l/=255,l-=.5,l*=t,l+=.5,l*=255,f/=255,f-=.5,f*=t,f+=.5,f*=255,r=r<0?0:r>255?255:r,l=l<0?0:l>255?255:l,f=f<0?0:f>255?255:f,n[d]=r,n[d+1]=l,n[d+2]=f};ot.addGetterSetter(Vt,"contrast",0,Kt(),ot.afterSetFilter);const O6=function(o){var t,n,a,r,l,f,d,g,m;const _=o.data,C=o.width,E=o.height,R=Math.min(1,Math.max(0,(n=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:.5)),v=Math.min(1,Math.max(0,(r=(a=this.embossWhiteLevel)===null||a===void 0?void 0:a.call(this))!==null&&r!==void 0?r:.5)),L=(d={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(f=(l=this.embossDirection)===null||l===void 0?void 0:l.call(this))!==null&&f!==void 0?f:"top-left"])!==null&&d!==void 0?d:315,B=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),N=R*10,M=v*255,P=L*Math.PI/180,O=Math.cos(P),A=Math.sin(P),T=128/1020*N,y=new Uint8ClampedArray(_),z=new Float32Array(C*E);for(let X=0,Y=0;Y<_.length;Y+=4,X++)z[X]=.2126*y[Y]+.7152*y[Y+1]+.0722*y[Y+2];const U=[-1,0,1,-2,0,2,-1,0,1],G=[-1,-2,-1,0,0,0,1,2,1],K=[-C-1,-C,-C+1,-1,0,1,C-1,C,C+1],Q=X=>X<0?0:X>255?255:X;for(let X=1;X<E-1;X++)for(let Y=1;Y<C-1;Y++){const j=X*C+Y;let I=0,F=0;I+=z[j+K[0]]*U[0],F+=z[j+K[0]]*G[0],I+=z[j+K[1]]*U[1],F+=z[j+K[1]]*G[1],I+=z[j+K[2]]*U[2],F+=z[j+K[2]]*G[2],I+=z[j+K[3]]*U[3],F+=z[j+K[3]]*G[3],I+=z[j+K[5]]*U[5],F+=z[j+K[5]]*G[5],I+=z[j+K[6]]*U[6],F+=z[j+K[6]]*G[6],I+=z[j+K[7]]*U[7],F+=z[j+K[7]]*G[7],I+=z[j+K[8]]*U[8],F+=z[j+K[8]]*G[8];const W=O*I+A*F,it=Q(M+W*T),Z=j*4;if(B){const at=it-M;_[Z]=Q(y[Z]+at),_[Z+1]=Q(y[Z+1]+at),_[Z+2]=Q(y[Z+2]+at),_[Z+3]=y[Z+3]}else _[Z]=_[Z+1]=_[Z+2]=it,_[Z+3]=y[Z+3]}for(let X=0;X<C;X++){let Y=X*4,j=((E-1)*C+X)*4;_[Y]=y[Y],_[Y+1]=y[Y+1],_[Y+2]=y[Y+2],_[Y+3]=y[Y+3],_[j]=y[j],_[j+1]=y[j+1],_[j+2]=y[j+2],_[j+3]=y[j+3]}for(let X=1;X<E-1;X++){let Y=X*C*4,j=(X*C+(C-1))*4;_[Y]=y[Y],_[Y+1]=y[Y+1],_[Y+2]=y[Y+2],_[Y+3]=y[Y+3],_[j]=y[j],_[j+1]=y[j+1],_[j+2]=y[j+2],_[j+3]=y[j+3]}return o};ot.addGetterSetter(Vt,"embossStrength",.5,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"embossWhiteLevel",.5,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"embossDirection","top-left",void 0,ot.afterSetFilter);ot.addGetterSetter(Vt,"embossBlend",!1,void 0,ot.afterSetFilter);function Up(o,t,n,a,r){const l=n-t,f=r-a;if(l===0)return a+f/2;if(f===0)return a;let d=(o-t)/l;return d=f*d+a,d}const x6=function(o){const t=o.data,n=t.length;let a=t[0],r=a,l,f=t[1],d=f,g,m=t[2],_=m,C;const E=this.enhance();if(E===0)return;for(let M=0;M<n;M+=4)l=t[M+0],l<a?a=l:l>r&&(r=l),g=t[M+1],g<f?f=g:g>d&&(d=g),C=t[M+2],C<m?m=C:C>_&&(_=C);r===a&&(r=255,a=0),d===f&&(d=255,f=0),_===m&&(_=255,m=0);let R,v,D,L,B,N;if(E>0)R=r+E*(255-r),v=a-E*(a-0),D=d+E*(255-d),L=f-E*(f-0),B=_+E*(255-_),N=m-E*(m-0);else{const M=(r+a)*.5;R=r+E*(r-M),v=a+E*(a-M);const P=(d+f)*.5;D=d+E*(d-P),L=f+E*(f-P);const O=(_+m)*.5;B=_+E*(_-O),N=m+E*(m-O)}for(let M=0;M<n;M+=4)t[M+0]=Up(t[M+0],a,r,v,R),t[M+1]=Up(t[M+1],f,d,L,D),t[M+2]=Up(t[M+2],m,_,N,B)};ot.addGetterSetter(Vt,"enhance",0,Kt(),ot.afterSetFilter);const M6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4){const r=.34*t[a]+.5*t[a+1]+.16*t[a+2];t[a]=r,t[a+1]=r,t[a+2]=r}};ot.addGetterSetter(Vt,"hue",0,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"saturation",0,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"luminance",0,Kt(),ot.afterSetFilter);const N6=function(o){const t=o.data,n=t.length,a=1,r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,f=this.luminance()*127,d=a*r*Math.cos(l*Math.PI/180),g=a*r*Math.sin(l*Math.PI/180),m=.299*a+.701*d+.167*g,_=.587*a-.587*d+.33*g,C=.114*a-.114*d-.497*g,E=.299*a-.299*d-.328*g,R=.587*a+.413*d+.035*g,v=.114*a-.114*d+.293*g,D=.299*a-.3*d+1.25*g,L=.587*a-.586*d-1.05*g,B=.114*a+.886*d-.2*g;let N,M,P,O;for(let A=0;A<n;A+=4)N=t[A+0],M=t[A+1],P=t[A+2],O=t[A+3],t[A+0]=m*N+_*M+C*P+f,t[A+1]=E*N+R*M+v*P+f,t[A+2]=D*N+L*M+B*P+f,t[A+3]=O},D6=function(o){const t=o.data,n=t.length,a=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,f=a*r*Math.cos(l*Math.PI/180),d=a*r*Math.sin(l*Math.PI/180),g=.299*a+.701*f+.167*d,m=.587*a-.587*f+.33*d,_=.114*a-.114*f-.497*d,C=.299*a-.299*f-.328*d,E=.587*a+.413*f+.035*d,R=.114*a-.114*f+.293*d,v=.299*a-.3*f+1.25*d,D=.587*a-.586*f-1.05*d,L=.114*a+.886*f-.2*d;for(let B=0;B<n;B+=4){const N=t[B+0],M=t[B+1],P=t[B+2],O=t[B+3];t[B+0]=g*N+m*M+_*P,t[B+1]=C*N+E*M+R*P,t[B+2]=v*N+D*M+L*P,t[B+3]=O}};ot.addGetterSetter(Vt,"hue",0,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"saturation",0,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"value",0,Kt(),ot.afterSetFilter);const j6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4)t[a]=255-t[a],t[a+1]=255-t[a+1],t[a+2]=255-t[a+2]},U6=function(o,t,n){const a=o.data,r=t.data,l=o.width,f=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||f/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=l,D=360/v*Math.PI/180;for(let L=0;L<v;L+=1){const B=Math.sin(L*D),N=Math.cos(L*D);for(let M=0;M<R;M+=1){_=Math.floor(d+m*M/R*N),C=Math.floor(g+m*M/R*B);let P=(C*l+_)*4;const O=a[P+0],A=a[P+1],T=a[P+2],y=a[P+3];P=(L+M*l)*4,r[P+0]=O,r[P+1]=A,r[P+2]=T,r[P+3]=y}}},B6=function(o,t,n){const a=o.data,r=t.data,l=o.width,f=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||f/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=l,D=0;let L,B;for(_=0;_<l;_+=1)for(C=0;C<f;C+=1){const N=_-d,M=C-g,P=Math.sqrt(N*N+M*M)*R/m;let O=(Math.atan2(M,N)*180/Math.PI+360+D)%360;O=O*v/360,L=Math.floor(O),B=Math.floor(P);let A=(B*l+L)*4;const T=a[A+0],y=a[A+1],z=a[A+2],U=a[A+3];A=(C*l+_)*4,r[A+0]=T,r[A+1]=y,r[A+2]=z,r[A+3]=U}},z6=function(o){const t=o.width,n=o.height;let a,r,l,f,d,g,m,_,C,E,R=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),D=Math.floor(t*(v%360)/360);if(R<1)return;const L=mt.createCanvasElement();L.width=t,L.height=n;const B=L.getContext("2d").getImageData(0,0,t,n);mt.releaseCanvas(L),U6(o,B,{polarCenterX:t/2,polarCenterY:n/2});let N=t/Math.pow(2,R);for(;N<=8;)N=N*2,R-=1;N=Math.ceil(N);let M=N,P=0,O=M,A=1;for(D+N>t&&(P=M,O=0,A=-1),r=0;r<n;r+=1)for(a=P;a!==O;a+=A)l=Math.round(a+D)%t,C=(t*r+l)*4,d=B.data[C+0],g=B.data[C+1],m=B.data[C+2],_=B.data[C+3],E=(t*r+a)*4,B.data[E+0]=d,B.data[E+1]=g,B.data[E+2]=m,B.data[E+3]=_;for(r=0;r<n;r+=1)for(M=Math.floor(N),f=0;f<R;f+=1){for(a=0;a<M+1;a+=1)C=(t*r+a)*4,d=B.data[C+0],g=B.data[C+1],m=B.data[C+2],_=B.data[C+3],E=(t*r+M*2-a-1)*4,B.data[E+0]=d,B.data[E+1]=g,B.data[E+2]=m,B.data[E+3]=_;M*=2}B6(B,o,{})};ot.addGetterSetter(Vt,"kaleidoscopePower",2,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"kaleidoscopeAngle",0,Kt(),ot.afterSetFilter);function ng(o,t,n){let a=(n*o.width+t)*4;const r=[];return r.push(o.data[a++],o.data[a++],o.data[a++],o.data[a++]),r}function Jd(o,t){return Math.sqrt(Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)+Math.pow(o[2]-t[2],2))}function L6(o){const t=[0,0,0];for(let n=0;n<o.length;n++)t[0]+=o[n][0],t[1]+=o[n][1],t[2]+=o[n][2];return t[0]/=o.length,t[1]/=o.length,t[2]/=o.length,t}function P6(o,t){const n=ng(o,0,0),a=ng(o,o.width-1,0),r=ng(o,0,o.height-1),l=ng(o,o.width-1,o.height-1),f=t||10;if(Jd(n,a)<f&&Jd(a,l)<f&&Jd(l,r)<f&&Jd(r,n)<f){const d=L6([a,n,l,r]),g=[];for(let m=0;m<o.width*o.height;m++){const _=Jd(d,[o.data[m*4],o.data[m*4+1],o.data[m*4+2]]);g[m]=_<f?0:255}return g}}function G6(o,t){for(let n=0;n<o.width*o.height;n++)o.data[4*n+3]=t[n]}function H6(o,t,n){const a=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,L=a[C*r+E];_+=o[D]*L}}f[m]=_===2040?255:0}return f}function I6(o,t,n){const a=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,L=a[C*r+E];_+=o[D]*L}}f[m]=_>=1020?255:0}return f}function k6(o,t,n){const a=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,L=a[C*r+E];_+=o[D]*L}}f[m]=_}return f}const q6=function(o){const t=this.threshold();let n=P6(o,t);return n&&(n=H6(n,o.width,o.height),n=I6(n,o.width,o.height),n=k6(n,o.width,o.height),G6(o,n)),o};ot.addGetterSetter(Vt,"threshold",0,Kt(),ot.afterSetFilter);const V6=function(o){const t=this.noise()*255,n=o.data,a=n.length,r=t/2;for(let l=0;l<a;l+=4)n[l+0]+=r-2*r*Math.random(),n[l+1]+=r-2*r*Math.random(),n[l+2]+=r-2*r*Math.random()};ot.addGetterSetter(Vt,"noise",.2,Kt(),ot.afterSetFilter);const Y6=function(o){let t=Math.ceil(this.pixelSize()),n=o.width,a=o.height,r=Math.ceil(n/t),l=Math.ceil(a/t),f=o.data;if(t<=0){mt.error("pixelSize value can not be <= 0");return}for(let d=0;d<r;d+=1)for(let g=0;g<l;g+=1){let m=0,_=0,C=0,E=0;const R=d*t,v=R+t,D=g*t,L=D+t;let B=0;for(let N=R;N<v;N+=1)if(!(N>=n))for(let M=D;M<L;M+=1){if(M>=a)continue;const P=(n*M+N)*4;m+=f[P+0],_+=f[P+1],C+=f[P+2],E+=f[P+3],B+=1}m=m/B,_=_/B,C=C/B,E=E/B;for(let N=R;N<v;N+=1)if(!(N>=n))for(let M=D;M<L;M+=1){if(M>=a)continue;const P=(n*M+N)*4;f[P+0]=m,f[P+1]=_,f[P+2]=C,f[P+3]=E}}};ot.addGetterSetter(Vt,"pixelSize",8,Kt(),ot.afterSetFilter);const K6=function(o){const t=Math.round(this.levels()*254)+1,n=o.data,a=n.length,r=255/t;for(let l=0;l<a;l+=1)n[l]=Math.floor(n[l]/r)*r};ot.addGetterSetter(Vt,"levels",.5,Kt(),ot.afterSetFilter);const Q6=function(o){const t=o.data,n=t.length,a=this.red(),r=this.green(),l=this.blue();for(let f=0;f<n;f+=4){const d=(.34*t[f]+.5*t[f+1]+.16*t[f+2])/255;t[f]=d*a,t[f+1]=d*r,t[f+2]=d*l,t[f+3]=t[f+3]}};ot.addGetterSetter(Vt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});ot.addGetterSetter(Vt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});ot.addGetterSetter(Vt,"blue",0,L2,ot.afterSetFilter);const X6=function(o){const t=o.data,n=t.length,a=this.red(),r=this.green(),l=this.blue(),f=this.alpha();for(let d=0;d<n;d+=4){const g=1-f;t[d]=a*f+t[d]*g,t[d+1]=r*f+t[d+1]*g,t[d+2]=l*f+t[d+2]*g}};ot.addGetterSetter(Vt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});ot.addGetterSetter(Vt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});ot.addGetterSetter(Vt,"blue",0,L2,ot.afterSetFilter);ot.addGetterSetter(Vt,"alpha",1,function(o){return this._filterUpToDate=!1,o>1?1:o<0?0:o});const F6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4){const r=t[a+0],l=t[a+1],f=t[a+2];t[a+0]=Math.min(255,r*.393+l*.769+f*.189),t[a+1]=Math.min(255,r*.349+l*.686+f*.168),t[a+2]=Math.min(255,r*.272+l*.534+f*.131)}},J6=function(o){const n=o.data;for(let a=0;a<n.length;a+=4){const r=n[a],l=n[a+1],f=n[a+2];.2126*r+.7152*l+.0722*f>=128&&(n[a]=255-r,n[a+1]=255-l,n[a+2]=255-f)}return o},Z6=function(o){const t=this.threshold()*255,n=o.data,a=n.length;for(let r=0;r<a;r+=1)n[r]=n[r]<t?0:255};ot.addGetterSetter(Vt,"threshold",.5,Kt(),ot.afterSetFilter);df.Util._assign(df,{Arc:bo,Arrow:Tu,Circle:Sf,Ellipse:vl,Image:Xr,Label:iv,Tag:Au,Line:_o,Path:Hn,Rect:bh,RegularPolygon:yl,Ring:wu,Sprite:Cs,Star:Sl,Text:qn,TextPath:Ra,Transformer:tn,Wedge:Eo,Filters:{Blur:T6,Brightness:w6,Brighten:A6,Contrast:R6,Emboss:O6,Enhance:x6,Grayscale:M6,HSL:N6,HSV:D6,Invert:j6,Kaleidoscope:z6,Mask:q6,Noise:V6,Pixelate:Y6,Posterize:K6,RGB:Q6,RGBA:X6,Sepia:F6,Solarize:J6,Threshold:Z6}});var Bp={exports:{}},zp={exports:{}},Lp={exports:{}},Pp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function W6(){return t1||(t1=1,(function(o){function t(j,I){var F=j.length;j.push(I);t:for(;0<F;){var W=F-1>>>1,it=j[W];if(0<r(it,I))j[W]=I,j[F]=it,F=W;else break t}}function n(j){return j.length===0?null:j[0]}function a(j){if(j.length===0)return null;var I=j[0],F=j.pop();if(F!==I){j[0]=F;t:for(var W=0,it=j.length,Z=it>>>1;W<Z;){var at=2*(W+1)-1,rt=j[at],V=at+1,J=j[V];if(0>r(rt,F))V<it&&0>r(J,rt)?(j[W]=J,j[V]=F,W=V):(j[W]=rt,j[at]=F,W=at);else if(V<it&&0>r(J,F))j[W]=J,j[V]=F,W=V;else break t}}return I}function r(j,I){var F=j.sortIndex-I.sortIndex;return F!==0?F:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,L=!1,B=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function P(j){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=j)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(j){if(D=!1,P(j),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-j)}}var A=!1,T=-1,y=5,z=-1;function U(){return L?!0:!(o.unstable_now()-z<y)}function G(){if(L=!1,A){var j=o.unstable_now();z=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(T),T=-1),R=!0;var F=E;try{e:{for(P(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=j);if(j=o.unstable_now(),typeof it=="function"){C.callback=it,P(j),I=!0;break e}C===n(g)&&a(g),P(j)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-j),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(G)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=G,K=function(){X.postMessage(null)}}else K=function(){B(G,0)};function Y(j,I){T=B(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return j()}finally{E=F}},o.unstable_requestPaint=function(){L=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var F=E;E=j;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(j,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,j){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,j={id:_++,callback:I,priorityLevel:j,startTime:F,expirationTime:it,sortIndex:-1},F>W?(j.sortIndex=F,t(m,j),n(g)===null&&j===n(m)&&(D?(N(T),T=-1):D=!0,Y(O,F-W))):(j.sortIndex=it,t(g,j),v||R||(v=!0,A||(A=!0,K()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var F=E;E=I;try{return j.apply(this,arguments)}finally{E=F}}}})(Pp)),Pp}var e1;function $6(){return e1||(e1=1,Lp.exports=W6()),Lp.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function t8(){return n1||(n1=1,(function(o){o.exports=function(t){function n(s,u,p,S){return new uc(s,u,p,S)}function a(){}function r(s){var u="https://react.dev/errors/"+s;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){var u=s,p=s;if(s.alternate)for(;u.return;)u=u.return;else{s=u;do u=s,(u.flags&4098)!==0&&(p=u.return),s=u.return;while(s)}return u.tag===3?p:null}function f(s){if(l(s)!==s)throw Error(r(188))}function d(s){var u=s.alternate;if(!u){if(u=l(s),u===null)throw Error(r(188));return u!==s?null:s}for(var p=s,S=u;;){var x=p.return;if(x===null)break;var H=x.alternate;if(H===null){if(S=x.return,S!==null){p=S;continue}break}if(x.child===H.child){for(H=x.child;H;){if(H===p)return f(x),s;if(H===S)return f(x),u;H=H.sibling}throw Error(r(188))}if(p.return!==S.return)p=x,S=H;else{for(var et=!1,ct=x.child;ct;){if(ct===p){et=!0,p=x,S=H;break}if(ct===S){et=!0,S=x,p=H;break}ct=ct.sibling}if(!et){for(ct=H.child;ct;){if(ct===p){et=!0,p=H,S=x;break}if(ct===S){et=!0,S=H,p=x;break}ct=ct.sibling}if(!et)throw Error(r(189))}}if(p.alternate!==S)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:u}function g(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(u=g(s),u!==null)return u;s=s.sibling}return null}function m(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(s.tag!==4&&(u=m(s),u!==null))return u;s=s.sibling}return null}function _(s){return s===null||typeof s!="object"?null:(s=Xl&&s[Xl]||s["@@iterator"],typeof s=="function"?s:null)}function C(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Fl?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case Hs:return"Fragment";case Yl:return"Profiler";case Is:return"StrictMode";case Mr:return"Suspense";case Nr:return"SuspenseList";case os:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case Or:return"Portal";case xr:return(s.displayName||"Context")+".Provider";case Kl:return(s._context.displayName||"Context")+".Consumer";case gc:var u=s.render;return s=s.displayName,s||(s=u.displayName||u.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case pc:return u=s.displayName||null,u!==null?u:C(s.type)||"Memo";case Dr:u=s._payload,s=s._init;try{return C(s(u))}catch{}}return null}function E(s){return{current:s}}function R(s){0>Xs||(s.current=nu[Xs],nu[Xs]=null,Xs--)}function v(s,u){Xs++,nu[Xs]=s.current,s.current=u}function D(s){return s>>>=0,s===0?32:31-(_0(s)/E0|0)|0}function L(s){var u=s&42;if(u!==0)return u;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function B(s,u,p){var S=s.pendingLanes;if(S===0)return 0;var x=0,H=s.suspendedLanes,et=s.pingedLanes;s=s.warmLanes;var ct=S&134217727;return ct!==0?(S=ct&~H,S!==0?x=L(S):(et&=ct,et!==0?x=L(et):p||(p=ct&~s,p!==0&&(x=L(p))))):(ct=S&~H,ct!==0?x=L(ct):et!==0?x=L(et):p||(p=S&~s,p!==0&&(x=L(p)))),x===0?0:u!==0&&u!==x&&(u&H)===0&&(H=x&-x,p=u&-u,H>=p||H===32&&(p&4194048)!==0)?u:x}function N(s,u){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&u)===0}function M(s,u){switch(s){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P(){var s=or;return or<<=1,(or&4194048)===0&&(or=256),s}function O(){var s=au;return au<<=1,(au&62914560)===0&&(au=4194304),s}function A(s){for(var u=[],p=0;31>p;p++)u.push(s);return u}function T(s,u){s.pendingLanes|=u,u!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function y(s,u,p,S,x,H){var et=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ct=s.entanglements,_t=s.expirationTimes,zt=s.hiddenUpdates;for(p=et&~p;0<p;){var Gt=31-Pa(p),Wt=1<<Gt;ct[Gt]=0,_t[Gt]=-1;var te=zt[Gt];if(te!==null)for(zt[Gt]=null,Gt=0;Gt<te.length;Gt++){var Me=te[Gt];Me!==null&&(Me.lane&=-536870913)}p&=~Wt}S!==0&&z(s,S,0),H!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=H&~(et&~u))}function z(s,u,p){s.pendingLanes|=u,s.suspendedLanes&=~u;var S=31-Pa(u);s.entangledLanes|=u,s.entanglements[S]=s.entanglements[S]|1073741824|p&4194090}function U(s,u){var p=s.entangledLanes|=u;for(s=s.entanglements;p;){var S=31-Pa(p),x=1<<S;x&u|s[S]&u&&(s[S]|=u),p&=~x}}function G(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function K(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Q(s){if(typeof ia=="function"&&_a(s),Ja&&typeof Ja.setStrictMode=="function")try{Ja.setStrictMode(Ko,s)}catch{}}function X(s){if(Dc===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Dc=u&&u[1]||"",Od=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Dc+s+Od}function Y(s,u){if(!s||Fs)return"";Fs=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(u){var Wt=function(){throw Error()};if(Object.defineProperty(Wt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Wt,[])}catch(Me){var te=Me}Reflect.construct(s,[],Wt)}else{try{Wt.call()}catch(Me){te=Me}s.call(Wt.prototype)}}else{try{throw Error()}catch(Me){te=Me}(Wt=s())&&typeof Wt.catch=="function"&&Wt.catch(function(){})}}catch(Me){if(Me&&te&&typeof Me.stack=="string")return[Me.stack,te.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var H=S.DetermineComponentFrameRoot(),et=H[0],ct=H[1];if(et&&ct){var _t=et.split(`
`),zt=ct.split(`
`);for(x=S=0;S<_t.length&&!_t[S].includes("DetermineComponentFrameRoot");)S++;for(;x<zt.length&&!zt[x].includes("DetermineComponentFrameRoot");)x++;if(S===_t.length||x===zt.length)for(S=_t.length-1,x=zt.length-1;1<=S&&0<=x&&_t[S]!==zt[x];)x--;for(;1<=S&&0<=x;S--,x--)if(_t[S]!==zt[x]){if(S!==1||x!==1)do if(S--,x--,0>x||_t[S]!==zt[x]){var Gt=`
`+_t[S].replace(" at new "," at ");return s.displayName&&Gt.includes("<anonymous>")&&(Gt=Gt.replace("<anonymous>",s.displayName)),Gt}while(1<=S&&0<=x);break}}}finally{Fs=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?X(p):""}function j(s){switch(s.tag){case 26:case 27:case 5:return X(s.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return Y(s.type,!1);case 11:return Y(s.type.render,!1);case 1:return Y(s.type,!0);case 31:return X("Activity");default:return""}}function I(s){try{var u="";do u+=j(s),s=s.return;while(s);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function F(s,u){if(typeof s=="object"&&s!==null){var p=xd.get(s);return p!==void 0?p:(u={value:s,source:u,stack:I(u)},xd.set(s,u),u)}return{value:s,source:u,stack:I(u)}}function W(s,u){Br[Js++]=Zs,Br[Js++]=jc,jc=s,Zs=u}function it(s,u,p){Za[gi++]=lr,Za[gi++]=zi,Za[gi++]=gs,gs=s;var S=lr;s=zi;var x=32-Pa(S)-1;S&=~(1<<x),p+=1;var H=32-Pa(u)+x;if(30<H){var et=x-x%5;H=(S&(1<<et)-1).toString(32),S>>=et,x-=et,lr=1<<32-Pa(u)+x|p<<x|S,zi=H+s}else lr=1<<H|p<<x|S,zi=s}function Z(s){s.return!==null&&(W(s,1),it(s,1,0))}function at(s){for(;s===jc;)jc=Br[--Js],Br[Js]=null,Zs=Br[--Js],Br[Js]=null;for(;s===gs;)gs=Za[--gi],Za[gi]=null,zi=Za[--gi],Za[gi]=null,lr=Za[--gi],Za[gi]=null}function rt(s,u){v(zr,u),v(Ws,s),v(oa,null),s=id(u),R(oa),v(oa,s)}function V(){R(oa),R(Ws),R(zr)}function J(s){s.memoizedState!==null&&v(Qo,s);var u=oa.current,p=ls(u,s.type);u!==p&&(v(Ws,s),v(oa,p))}function tt(s){Ws.current===s&&(R(oa),R(Ws)),Qo.current===s&&(R(Qo),er?Ti._currentValue=Ur:Ti._currentValue2=Ur)}function nt(s){var u=Error(r(418,""));throw re(F(u,s)),Pi}function ht(s,u){if(!zn)throw Error(r(175));u0(s.stateNode,s.type,s.memoizedProps,u,s)||nt(s)}function wt(s){for(ca=s.return;ca;)switch(ca.tag){case 5:case 13:Li=!1;return;case 27:case 3:Li=!0;return;default:ca=ca.return}}function jt(s){if(!zn||s!==ca)return!1;if(!nn)return wt(s),nn=!0,!1;var u=s.tag;if(Fn?u!==3&&u!==27&&(u!==5||wc(s.type)&&!cs(s.type,s.memoizedProps))&&Jn&&nt(s):u!==3&&(u!==5||wc(s.type)&&!cs(s.type,s.memoizedProps))&&Jn&&nt(s),wt(s),u===13){if(!zn)throw Error(r(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Jn=c0(s)}else Jn=Fn&&u===27?r0(s.type,Jn):ca?yd(s.stateNode):null;return!0}function kt(){zn&&(Jn=ca=null,nn=!1)}function ee(){var s=Lr;return s!==null&&(Na===null?Na=s:Na.push.apply(Na,s),Lr=null),s}function re(s){Lr===null?Lr=[s]:Lr.push(s)}function Lt(s,u){return s===u&&(s!==0||1/s===1/u)||s!==s&&u!==u}function ge(s,u,p){er?(v(Uc,u._currentValue),u._currentValue=p):(v(Uc,u._currentValue2),u._currentValue2=p)}function pe(s){var u=Uc.current;er?s._currentValue=u:s._currentValue2=u,R(Uc)}function rn(s,u,p){for(;s!==null;){var S=s.alternate;if((s.childLanes&u)!==u?(s.childLanes|=u,S!==null&&(S.childLanes|=u)):S!==null&&(S.childLanes&u)!==u&&(S.childLanes|=u),s===p)break;s=s.return}}function Ye(s,u,p,S){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var H=x.dependencies;if(H!==null){var et=x.child;H=H.firstContext;t:for(;H!==null;){var ct=H;H=x;for(var _t=0;_t<u.length;_t++)if(ct.context===u[_t]){H.lanes|=p,ct=H.alternate,ct!==null&&(ct.lanes|=p),rn(H.return,p,s),S||(et=null);break t}H=ct.next}}else if(x.tag===18){if(et=x.return,et===null)throw Error(r(341));et.lanes|=p,H=et.alternate,H!==null&&(H.lanes|=p),rn(et,p,s),et=null}else et=x.child;if(et!==null)et.return=x;else for(et=x;et!==null;){if(et===s){et=null;break}if(x=et.sibling,x!==null){x.return=et.return,et=x;break}et=et.return}x=et}}function mn(s,u,p,S){s=null;for(var x=u,H=!1;x!==null;){if(!H){if((x.flags&524288)!==0)H=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var et=x.alternate;if(et===null)throw Error(r(387));if(et=et.memoizedProps,et!==null){var ct=x.type;Ga(x.pendingProps.value,et.value)||(s!==null?s.push(ct):s=[ct])}}else if(x===Qo.current){if(et=x.alternate,et===null)throw Error(r(387));et.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Ti):s=[Ti])}x=x.return}s!==null&&Ye(u,s,p,S),u.flags|=262144}function Yn(s){for(s=s.firstContext;s!==null;){var u=s.context;if(!Ga(er?u._currentValue:u._currentValue2,s.memoizedValue))return!0;s=s.next}return!1}function sn(s){ps=s,Ea=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ot(s){return Ce(ps,s)}function Zt(s,u){return ps===null&&sn(s),Ce(s,u)}function Ce(s,u){var p=er?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},Ea===null){if(s===null)throw Error(r(308));Ea=u,s.dependencies={lanes:0,firstContext:u},s.flags|=524288}else Ea=Ea.next=u;return p}function Ke(){return{controller:new Md,data:new Map,refCount:0}}function Je(s){s.refCount--,s.refCount===0&&A0(Bc,function(){s.controller.abort()})}function Te(s){s!==Xo&&s.next===null&&(Xo===null?bn=Xo=s:Xo=Xo.next=s),ru=!0,Nd||(Nd=!0,vt())}function lt(s,u){if(!$s&&ru){$s=!0;do for(var p=!1,S=bn;S!==null;){if(s!==0){var x=S.pendingLanes;if(x===0)var H=0;else{var et=S.suspendedLanes,ct=S.pingedLanes;H=(1<<31-Pa(42|s)+1)-1,H&=x&~(et&~ct),H=H&201326741?H&201326741|1:H?H|2:0}H!==0&&(p=!0,Bt(S,H))}else H=Ge,H=B(S,S===_n?H:0,S.cancelPendingCommit!==null||S.timeoutHandle!==tr),(H&3)===0||N(S,H)||(p=!0,Bt(S,H));S=S.next}while(p);$s=!1}}function Tt(){Rt()}function Rt(){ru=Nd=!1;var s=0;pi!==0&&(fi()&&(s=pi),pi=0);for(var u=hi(),p=null,S=bn;S!==null;){var x=S.next,H=qt(S,u);H===0?(S.next=null,p===null?bn=x:p.next=x,x===null&&(Xo=p)):(p=S,(s!==0||(H&3)!==0)&&(ru=!0)),S=x}lt(s)}function qt(s,u){for(var p=s.suspendedLanes,S=s.pingedLanes,x=s.expirationTimes,H=s.pendingLanes&-62914561;0<H;){var et=31-Pa(H),ct=1<<et,_t=x[et];_t===-1?((ct&p)===0||(ct&S)!==0)&&(x[et]=M(ct,u)):_t<=u&&(s.expiredLanes|=ct),H&=~ct}if(u=_n,p=Ge,p=B(s,s===u?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==tr),S=s.callbackNode,p===0||s===u&&(We===2||We===9)||s.cancelPendingCommit!==null)return S!==null&&S!==null&&Mc(S),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||N(s,p)){if(u=p&-p,u===s.callbackPriority)return u;switch(S!==null&&Mc(S),K(p)){case 2:case 8:p=T0;break;case 32:p=wd;break;case 268435456:p=Rd;break;default:p=wd}return S=le.bind(null,s),p=iu(p,S),s.callbackPriority=u,s.callbackNode=p,u}return S!==null&&S!==null&&Mc(S),s.callbackPriority=2,s.callbackNode=null,2}function le(s,u){if(hn!==0&&hn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(zs()&&s.callbackNode!==p)return null;var S=Ge;return S=B(s,s===_n?S:0,s.cancelPendingCommit!==null||s.timeoutHandle!==tr),S===0?null:(li(s,S,u),qt(s,hi()),s.callbackNode!=null&&s.callbackNode===p?le.bind(null,s):null)}function Bt(s,u){if(zs())return null;li(s,u,!0)}function vt(){vc?Wl(function(){(ze&6)!==0?iu(Ad,Tt):Rt()}):iu(Ad,Tt)}function dt(){return pi===0&&(pi=P()),pi}function Yt(s,u){if(Fo===null){var p=Fo=[];zc=0,ur=dt(),Ha={status:"pending",value:void 0,then:function(S){p.push(S)}}}return zc++,u.then(ae,ae),u}function ae(){if(--zc===0&&Fo!==null){Ha!==null&&(Ha.status="fulfilled");var s=Fo;Fo=null,ur=0,Ha=null;for(var u=0;u<s.length;u++)(0,s[u])()}}function Qt(s,u){var p=[],S={status:"pending",value:null,reason:null,then:function(x){p.push(x)}};return s.then(function(){S.status="fulfilled",S.value=u;for(var x=0;x<p.length;x++)(0,p[x])(u)},function(x){for(S.status="rejected",S.reason=x,x=0;x<p.length;x++)(0,p[x])(void 0)}),S}function Ae(){var s=Pr.current;return s!==null?s:_n.pooledCache}function be(s,u){u===null?v(Pr,Pr.current):v(Pr,u.pool)}function Ie(){var s=Ae();return s===null?null:{parent:er?An._currentValue:An._currentValue2,pool:s}}function Cn(s,u){if(Ga(s,u))return!0;if(typeof s!="object"||s===null||typeof u!="object"||u===null)return!1;var p=Object.keys(s),S=Object.keys(u);if(p.length!==S.length)return!1;for(S=0;S<p.length;S++){var x=p[S];if(!w0.call(u,x)||!Ga(s[x],u[x]))return!1}return!0}function Re(s){return s=s.status,s==="fulfilled"||s==="rejected"}function dn(){}function Mn(s,u,p){switch(p=s[p],p===void 0?s.push(u):p!==u&&(u.then(dn,dn),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,Ts(s),s;default:if(typeof u.status=="string")u.then(dn,dn);else{if(s=_n,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=u,s.status="pending",s.then(function(S){if(u.status==="pending"){var x=u;x.status="fulfilled",x.value=S}},function(S){if(u.status==="pending"){var x=u;x.status="rejected",x.reason=S}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,Ts(s),s}throw Wa=u,to}}function Sr(){if(Wa===null)throw Error(r(459));var s=Wa;return Wa=null,s}function Ts(s){if(s===to||s===eo)throw Error(r(483))}function br(){for(var s=ms,u=Lc=ms=0;u<s;){var p=cn[u];cn[u++]=null;var S=cn[u];cn[u++]=null;var x=cn[u];cn[u++]=null;var H=cn[u];if(cn[u++]=null,S!==null&&x!==null){var et=S.pending;et===null?x.next=x:(x.next=et.next,et.next=x),S.pending=x}H!==0&&Nt(p,x,H)}}function Yi(s,u,p,S){cn[ms++]=s,cn[ms++]=u,cn[ms++]=p,cn[ms++]=S,Lc|=S,s.lanes|=S,s=s.alternate,s!==null&&(s.lanes|=S)}function Oi(s,u,p,S){return Yi(s,u,p,S),Ut(s)}function Ki(s,u){return Yi(s,null,null,u),Ut(s)}function Nt(s,u,p){s.lanes|=p;var S=s.alternate;S!==null&&(S.lanes|=p);for(var x=!1,H=s.return;H!==null;)H.childLanes|=p,S=H.alternate,S!==null&&(S.childLanes|=p),H.tag===22&&(s=H.stateNode,s===null||s._visibility&1||(x=!0)),s=H,H=H.return;return s.tag===3?(H=s.stateNode,x&&u!==null&&(x=31-Pa(p),s=H.hiddenUpdates,S=s[x],S===null?s[x]=[u]:S.push(u),u.lane=p|536870912),H):null}function Ut(s){if(50<pr)throw pr=0,kc=null,Error(r(185));for(var u=s.return;u!==null;)s=u,u=s.return;return s.tag===3?s.stateNode:null}function $t(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ft(s,u){s=s.updateQueue,u.updateQueue===s&&(u.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function It(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Qe(s,u,p){var S=s.updateQueue;if(S===null)return null;if(S=S.shared,(ze&2)!==0){var x=S.pending;return x===null?u.next=u:(u.next=x.next,x.next=u),S.pending=u,u=Ut(s),Nt(s,null,p),u}return Yi(s,S,u,p),Ut(s)}function en(s,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function Oe(s,u){var p=s.updateQueue,S=s.alternate;if(S!==null&&(S=S.updateQueue,p===S)){var x=null,H=null;if(p=p.firstBaseUpdate,p!==null){do{var et={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};H===null?x=H=et:H=H.next=et,p=p.next}while(p!==null);H===null?x=H=u:H=H.next=u}else x=H=u;p={baseState:S.baseState,firstBaseUpdate:x,lastBaseUpdate:H,shared:S.shared,callbacks:S.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=u:s.next=u,p.lastBaseUpdate=u}function ie(){if(jd){var s=Ha;if(s!==null)throw s}}function on(s,u,p,S){jd=!1;var x=s.updateQueue;Dn=!1;var H=x.firstBaseUpdate,et=x.lastBaseUpdate,ct=x.shared.pending;if(ct!==null){x.shared.pending=null;var _t=ct,zt=_t.next;_t.next=null,et===null?H=zt:et.next=zt,et=_t;var Gt=s.alternate;Gt!==null&&(Gt=Gt.updateQueue,ct=Gt.lastBaseUpdate,ct!==et&&(ct===null?Gt.firstBaseUpdate=zt:ct.next=zt,Gt.lastBaseUpdate=_t))}if(H!==null){var Wt=x.baseState;et=0,Gt=zt=_t=null,ct=H;do{var te=ct.lane&-536870913,Me=te!==ct.lane;if(Me?(Ge&te)===te:(S&te)===te){te!==0&&te===ur&&(jd=!0),Gt!==null&&(Gt=Gt.next={lane:0,tag:ct.tag,payload:ct.payload,callback:null,next:null});t:{var vi=s,$o=ct;te=u;var Ss=p;switch($o.tag){case 1:if(vi=$o.payload,typeof vi=="function"){Wt=vi.call(Ss,Wt,te);break t}Wt=vi;break t;case 3:vi.flags=vi.flags&-65537|128;case 0:if(vi=$o.payload,te=typeof vi=="function"?vi.call(Ss,Wt,te):vi,te==null)break t;Wt=dc({},Wt,te);break t;case 2:Dn=!0}}te=ct.callback,te!==null&&(s.flags|=64,Me&&(s.flags|=8192),Me=x.callbacks,Me===null?x.callbacks=[te]:Me.push(te))}else Me={lane:te,tag:ct.tag,payload:ct.payload,callback:ct.callback,next:null},Gt===null?(zt=Gt=Me,_t=Wt):Gt=Gt.next=Me,et|=te;if(ct=ct.next,ct===null){if(ct=x.shared.pending,ct===null)break;Me=ct,ct=Me.next,Me.next=null,x.lastBaseUpdate=Me,x.shared.pending=null}}while(!0);Gt===null&&(_t=Wt),x.baseState=_t,x.firstBaseUpdate=zt,x.lastBaseUpdate=Gt,H===null&&(x.shared.lanes=0),ka|=et,s.lanes=et,s.memoizedState=Wt}}function _e(s,u){if(typeof s!="function")throw Error(r(191,s));s.call(u)}function je(s,u){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)_e(p[s],u)}function Pe(s,u){s=Ri,v(lu,s),v(no,u),Ri=s|u.baseLanes}function we(){v(lu,Ri),v(no,no.current)}function Ue(){Ri=lu.current,R(no),R(lu)}function ye(){throw Error(r(321))}function ln(s,u){if(u===null)return!1;for(var p=0;p<u.length&&p<s.length;p++)if(!Ga(s[p],u[p]))return!1;return!0}function un(s,u,p,S,x,H){return fn=H,fe=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ce.H=s===null||s.memoizedState===null?Ud:cr,io=!1,H=p(S,x),io=!1,ao&&(H=ii(u,p,S,x)),ai(s),H}function ai(s){ce.H=Ca;var u=Ve!==null&&Ve.next!==null;if(fn=0,Zn=Ve=fe=null,uu=!1,fa=0,xa=null,u)throw Error(r(300));s===null||la||(s=s.dependencies,s!==null&&Yn(s)&&(la=!0))}function ii(s,u,p,S){fe=s;var x=0;do{if(ao&&(xa=null),fa=0,ao=!1,25<=x)throw Error(r(301));if(x+=1,Zn=Ve=null,s.updateQueue!=null){var H=s.updateQueue;H.lastEffect=null,H.events=null,H.stores=null,H.memoCache!=null&&(H.memoCache.index=0)}ce.H=so,H=u(p,S)}while(ao);return H}function Kn(){var s=ce.H,u=s.useState()[0];return u=typeof u.then=="function"?Co(u):u,s=s.useState()[0],(Ve!==null?Ve.memoizedState:null)!==s&&(fe.flags|=1024),u}function As(){var s=ro!==0;return ro=0,s}function ws(s,u,p){u.updateQueue=s.updateQueue,u.flags&=-2053,s.lanes&=~p}function yi(s){if(uu){for(s=s.memoizedState;s!==null;){var u=s.queue;u!==null&&(u.pending=null),s=s.next}uu=!1}fn=0,Zn=Ve=fe=null,ao=!1,fa=ro=0,xa=null}function sa(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zn===null?fe.memoizedState=Zn=s:Zn=Zn.next=s,Zn}function ta(){if(Ve===null){var s=fe.alternate;s=s!==null?s.memoizedState:null}else s=Ve.next;var u=Zn===null?fe.memoizedState:Zn.next;if(u!==null)Zn=u,Ve=s;else{if(s===null)throw fe.alternate===null?Error(r(467)):Error(r(310));Ve=s,s={memoizedState:Ve.memoizedState,baseState:Ve.baseState,baseQueue:Ve.baseQueue,queue:Ve.queue,next:null},Zn===null?fe.memoizedState=Zn=s:Zn=Zn.next=s}return Zn}function Nu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Co(s){var u=fa;return fa+=1,xa===null&&(xa=[]),s=Mn(xa,s,u),u=fe,(Zn===null?u.memoizedState:Zn.next)===null&&(u=u.alternate,ce.H=u===null||u.memoizedState===null?Ud:cr),s}function Du(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Co(s);if(s.$$typeof===xr)return Ot(s)}throw Error(r(438,String(s)))}function To(s){var u=null,p=fe.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var S=fe.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(u={data:S.data.map(function(x){return x.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Nu(),fe.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(s),S=0;S<s;S++)p[S]=Ql;return u.index++,p}function Si(s,u){return typeof u=="function"?u(s):u}function bi(s){var u=ta();return Va(u,Ve,s)}function Va(s,u,p){var S=s.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=p;var x=s.baseQueue,H=S.pending;if(H!==null){if(x!==null){var et=x.next;x.next=H.next,H.next=et}u.baseQueue=x=H,S.pending=null}if(H=s.baseState,x===null)s.memoizedState=H;else{u=x.next;var ct=et=null,_t=null,zt=u,Gt=!1;do{var Wt=zt.lane&-536870913;if(Wt!==zt.lane?(Ge&Wt)===Wt:(fn&Wt)===Wt){var te=zt.revertLane;if(te===0)_t!==null&&(_t=_t.next={lane:0,revertLane:0,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null}),Wt===ur&&(Gt=!0);else if((fn&te)===te){zt=zt.next,te===ur&&(Gt=!0);continue}else Wt={lane:0,revertLane:zt.revertLane,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},_t===null?(ct=_t=Wt,et=H):_t=_t.next=Wt,fe.lanes|=te,ka|=te;Wt=zt.action,io&&p(H,Wt),H=zt.hasEagerState?zt.eagerState:p(H,Wt)}else te={lane:Wt,revertLane:zt.revertLane,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},_t===null?(ct=_t=te,et=H):_t=_t.next=te,fe.lanes|=Wt,ka|=Wt;zt=zt.next}while(zt!==null&&zt!==u);if(_t===null?et=H:_t.next=ct,!Ga(H,s.memoizedState)&&(la=!0,Gt&&(p=Ha,p!==null)))throw p;s.memoizedState=H,s.baseState=et,s.baseQueue=_t,S.lastRenderedState=H}return x===null&&(S.lanes=0),[s.memoizedState,S.dispatch]}function ju(s){var u=ta(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var S=p.dispatch,x=p.pending,H=u.memoizedState;if(x!==null){p.pending=null;var et=x=x.next;do H=s(H,et.action),et=et.next;while(et!==x);Ga(H,u.memoizedState)||(la=!0),u.memoizedState=H,u.baseQueue===null&&(u.baseState=H),p.lastRenderedState=H}return[H,S]}function Eh(s,u,p){var S=fe,x=ta(),H=nn;if(H){if(p===void 0)throw Error(r(407));p=p()}else p=u();var et=!Ga((Ve||x).memoizedState,p);et&&(x.memoizedState=p,la=!0),x=x.queue;var ct=El.bind(null,S,x,s);if(Qi(2048,8,ct,[s]),x.getSnapshot!==u||et||Zn!==null&&Zn.memoizedState.tag&1){if(S.flags|=2048,Ya(9,Ao(),Cf.bind(null,S,x,p,u),null),_n===null)throw Error(r(349));H||(fn&124)!==0||Uu(S,u,p)}return p}function Uu(s,u,p){s.flags|=16384,s={getSnapshot:u,value:p},u=fe.updateQueue,u===null?(u=Nu(),fe.updateQueue=u,u.stores=[s]):(p=u.stores,p===null?u.stores=[s]:p.push(s))}function Cf(s,u,p,S){u.value=p,u.getSnapshot=S,Ch(u)&&ri(s)}function El(s,u,p){return p(function(){Ch(u)&&ri(s)})}function Ch(s){var u=s.getSnapshot;s=s.value;try{var p=u();return!Ga(s,p)}catch{return!0}}function ri(s){var u=Ki(s,2);u!==null&&Xa(u,s,2)}function Cl(s){var u=sa();if(typeof s=="function"){var p=s;if(s=p(),io){Q(!0);try{p()}finally{Q(!1)}}}return u.memoizedState=u.baseState=s,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:s},u}function Tf(s,u,p,S){return s.baseState=p,Va(s,Ve,typeof S=="function"?S:Si)}function Af(s,u,p,S,x){if(Zr(s))throw Error(r(485));if(s=u.action,s!==null){var H={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(et){H.listeners.push(et)}};ce.T!==null?p(!0):H.isTransition=!1,S(H),p=u.pending,p===null?(H.next=u.pending=H,Rs(u,H)):(H.next=p.next,u.pending=p.next=H)}}function Rs(s,u){var p=u.action,S=u.payload,x=s.state;if(u.isTransition){var H=ce.T,et={};ce.T=et;try{var ct=p(x,S),_t=ce.S;_t!==null&&_t(et,ct),wf(s,u,ct)}catch(zt){Fr(s,u,zt)}finally{ce.T=H}}else try{H=p(x,S),wf(s,u,H)}catch(zt){Fr(s,u,zt)}}function wf(s,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(S){Rf(s,u,S)},function(S){return Fr(s,u,S)}):Rf(s,u,p)}function Rf(s,u,p){u.status="fulfilled",u.value=p,Th(u),s.state=p,u=s.pending,u!==null&&(p=u.next,p===u?s.pending=null:(p=p.next,u.next=p,Rs(s,p)))}function Fr(s,u,p){var S=s.pending;if(s.pending=null,S!==null){S=S.next;do u.status="rejected",u.reason=p,Th(u),u=u.next;while(u!==S)}s.action=null}function Th(s){s=s.listeners;for(var u=0;u<s.length;u++)(0,s[u])()}function Of(s,u){return u}function xf(s,u){if(nn){var p=_n.formState;if(p!==null){t:{var S=fe;if(nn){if(Jn){var x=a0(Jn,Li);if(x){Jn=yd(x),S=i0(x);break t}}nt(S)}S=!1}S&&(u=p[0])}}p=sa(),p.memoizedState=p.baseState=u,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Of,lastRenderedState:u},p.queue=S,p=wh.bind(null,fe,S),S.dispatch=p,S=Cl(!1);var H=Ol.bind(null,fe,!1,S.queue);return S=sa(),x={state:u,dispatch:null,action:s,pending:null},S.queue=x,p=Af.bind(null,fe,x,H,p),x.dispatch=p,S.memoizedState=s,[u,p,!1]}function Bu(s){var u=ta();return Ah(u,Ve,s)}function Ah(s,u,p){if(u=Va(s,u,Of)[0],s=bi(Si)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var S=Co(u)}catch(et){throw et===to?eo:et}else S=u;u=ta();var x=u.queue,H=x.dispatch;return p!==u.memoizedState&&(fe.flags|=2048,Ya(9,Ao(),Lg.bind(null,x,p),null)),[S,H,s]}function Lg(s,u){s.action=u}function Tl(s){var u=ta(),p=Ve;if(p!==null)return Ah(u,p,s);ta(),u=u.memoizedState,p=ta();var S=p.queue.dispatch;return p.memoizedState=s,[u,S,!1]}function Ya(s,u,p,S){return s={tag:s,create:p,deps:S,inst:u,next:null},u=fe.updateQueue,u===null&&(u=Nu(),fe.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=s.next=s:(S=p.next,p.next=s,s.next=S,u.lastEffect=s),s}function Ao(){return{destroy:void 0,resource:void 0}}function zu(){return ta().memoizedState}function _r(s,u,p,S){var x=sa();S=S===void 0?null:S,fe.flags|=s,x.memoizedState=Ya(1|u,Ao(),p,S)}function Qi(s,u,p,S){var x=ta();S=S===void 0?null:S;var H=x.memoizedState.inst;Ve!==null&&S!==null&&ln(S,Ve.memoizedState.deps)?x.memoizedState=Ya(u,H,p,S):(fe.flags|=s,x.memoizedState=Ya(1|u,H,p,S))}function Mf(s,u){_r(8390656,8,s,u)}function Lu(s,u){Qi(2048,8,s,u)}function Nf(s,u){return Qi(4,2,s,u)}function wo(s,u){return Qi(4,4,s,u)}function Xi(s,u){if(typeof u=="function"){s=s();var p=u(s);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return s=s(),u.current=s,function(){u.current=null}}function Pu(s,u,p){p=p!=null?p.concat([s]):null,Qi(4,4,Xi.bind(null,u,s),p)}function Os(){}function Er(s,u){var p=ta();u=u===void 0?null:u;var S=p.memoizedState;return u!==null&&ln(u,S[1])?S[0]:(p.memoizedState=[s,u],s)}function Gu(s,u){var p=ta();u=u===void 0?null:u;var S=p.memoizedState;if(u!==null&&ln(u,S[1]))return S[0];if(S=s(),io){Q(!0);try{s()}finally{Q(!1)}}return p.memoizedState=[S,u],S}function Ro(s,u,p){return p===void 0||(fn&1073741824)!==0?s.memoizedState=u:(s.memoizedState=p,s=rc(),fe.lanes|=s,ka|=s,p)}function Df(s,u,p,S){return Ga(p,u)?p:no.current!==null?(s=Ro(s,p,S),Ga(s,u)||(la=!0),s):(fn&42)===0?(la=!0,s.memoizedState=p):(s=rc(),fe.lanes|=s,ka|=s,u)}function Al(s,u,p,S,x){var H=ar();na(H!==0&&8>H?H:8);var et=ce.T,ct={};ce.T=ct,Ol(s,!1,u,p);try{var _t=x(),zt=ce.S;if(zt!==null&&zt(ct,_t),_t!==null&&typeof _t=="object"&&typeof _t.then=="function"){var Gt=Qt(_t,S);xs(s,u,Gt,Qa(s))}else xs(s,u,S,Qa(s))}catch(Wt){xs(s,u,{then:function(){},status:"rejected",reason:Wt},Qa())}finally{na(H),ce.T=et}}function wl(s){var u=s.memoizedState;if(u!==null)return u;u={memoizedState:Ur,baseState:Ur,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:Ur},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:p},next:null},s.memoizedState=u,s=s.alternate,s!==null&&(s.memoizedState=u),u}function Hu(){return Ot(Ti)}function ja(){return ta().memoizedState}function Jr(){return ta().memoizedState}function Iu(s){for(var u=s.return;u!==null;){switch(u.tag){case 24:case 3:var p=Qa();s=It(p);var S=Qe(u,s,p);S!==null&&(Xa(S,u,p),en(S,u,p)),u={cache:Ke()},s.payload=u;return}u=u.return}}function Rl(s,u,p){var S=Qa();p={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Zr(s)?xl(u,p):(p=Oi(s,u,p,S),p!==null&&(Xa(p,s,S),jf(p,u,S)))}function wh(s,u,p){var S=Qa();xs(s,u,p,S)}function xs(s,u,p,S){var x={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Zr(s))xl(u,x);else{var H=s.alternate;if(s.lanes===0&&(H===null||H.lanes===0)&&(H=u.lastRenderedReducer,H!==null))try{var et=u.lastRenderedState,ct=H(et,p);if(x.hasEagerState=!0,x.eagerState=ct,Ga(ct,et))return Yi(s,u,x,0),_n===null&&br(),!1}catch{}finally{}if(p=Oi(s,u,x,S),p!==null)return Xa(p,s,S),jf(p,u,S),!0}return!1}function Ol(s,u,p,S){if(S={lane:2,revertLane:dt(),action:S,hasEagerState:!1,eagerState:null,next:null},Zr(s)){if(u)throw Error(r(479))}else u=Oi(s,p,S,2),u!==null&&Xa(u,s,2)}function Zr(s){var u=s.alternate;return s===fe||u!==null&&u===fe}function xl(s,u){ao=uu=!0;var p=s.pending;p===null?u.next=u:(u.next=p.next,p.next=u),s.pending=u}function jf(s,u,p){if((p&4194048)!==0){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function ku(s){var u=oo;return oo+=1,$a===null&&($a=[]),Mn($a,s,u)}function Ml(s,u){u=u.props.ref,s.ref=u!==void 0?u:null}function qu(s,u){throw u.$$typeof===Gs?Error(r(525)):(s=Object.prototype.toString.call(u),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":s)))}function Vu(s){var u=s._init;return u(s._payload)}function Rh(s){function u(bt,gt){if(s){var Ct=bt.deletions;Ct===null?(bt.deletions=[gt],bt.flags|=16):Ct.push(gt)}}function p(bt,gt){if(!s)return null;for(;gt!==null;)u(bt,gt),gt=gt.sibling;return null}function S(bt){for(var gt=new Map;bt!==null;)bt.key!==null?gt.set(bt.key,bt):gt.set(bt.index,bt),bt=bt.sibling;return gt}function x(bt,gt){return bt=Nn(bt,gt),bt.index=0,bt.sibling=null,bt}function H(bt,gt,Ct){return bt.index=Ct,s?(Ct=bt.alternate,Ct!==null?(Ct=Ct.index,Ct<gt?(bt.flags|=67108866,gt):Ct):(bt.flags|=67108866,gt)):(bt.flags|=1048576,gt)}function et(bt){return s&&bt.alternate===null&&(bt.flags|=67108866),bt}function ct(bt,gt,Ct,Ht){return gt===null||gt.tag!==6?(gt=nd(Ct,bt.mode,Ht),gt.return=bt,gt):(gt=x(gt,Ct),gt.return=bt,gt)}function _t(bt,gt,Ct,Ht){var Xt=Ct.type;return Xt===Hs?Gt(bt,gt,Ct.props.children,Ht,Ct.key):gt!==null&&(gt.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===Dr&&Vu(Xt)===gt.type)?(gt=x(gt,Ct.props),Ml(gt,Ct),gt.return=bt,gt):(gt=Vl(Ct.type,Ct.key,Ct.props,null,bt.mode,Ht),Ml(gt,Ct),gt.return=bt,gt)}function zt(bt,gt,Ct,Ht){return gt===null||gt.tag!==4||gt.stateNode.containerInfo!==Ct.containerInfo||gt.stateNode.implementation!==Ct.implementation?(gt=ad(Ct,bt.mode,Ht),gt.return=bt,gt):(gt=x(gt,Ct.children||[]),gt.return=bt,gt)}function Gt(bt,gt,Ct,Ht,Xt){return gt===null||gt.tag!==7?(gt=Ls(Ct,bt.mode,Ht,Xt),gt.return=bt,gt):(gt=x(gt,Ct),gt.return=bt,gt)}function Wt(bt,gt,Ct){if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return gt=nd(""+gt,bt.mode,Ct),gt.return=bt,gt;if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case Io:return Ct=Vl(gt.type,gt.key,gt.props,null,bt.mode,Ct),Ml(Ct,gt),Ct.return=bt,Ct;case Or:return gt=ad(gt,bt.mode,Ct),gt.return=bt,gt;case Dr:var Ht=gt._init;return gt=Ht(gt._payload),Wt(bt,gt,Ct)}if(ks(gt)||_(gt))return gt=Ls(gt,bt.mode,Ct,null),gt.return=bt,gt;if(typeof gt.then=="function")return Wt(bt,ku(gt),Ct);if(gt.$$typeof===xr)return Wt(bt,Zt(bt,gt),Ct);qu(bt,gt)}return null}function te(bt,gt,Ct,Ht){var Xt=gt!==null?gt.key:null;if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return Xt!==null?null:ct(bt,gt,""+Ct,Ht);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case Io:return Ct.key===Xt?_t(bt,gt,Ct,Ht):null;case Or:return Ct.key===Xt?zt(bt,gt,Ct,Ht):null;case Dr:return Xt=Ct._init,Ct=Xt(Ct._payload),te(bt,gt,Ct,Ht)}if(ks(Ct)||_(Ct))return Xt!==null?null:Gt(bt,gt,Ct,Ht,null);if(typeof Ct.then=="function")return te(bt,gt,ku(Ct),Ht);if(Ct.$$typeof===xr)return te(bt,gt,Zt(bt,Ct),Ht);qu(bt,Ct)}return null}function Me(bt,gt,Ct,Ht,Xt){if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number"||typeof Ht=="bigint")return bt=bt.get(Ct)||null,ct(gt,bt,""+Ht,Xt);if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case Io:return bt=bt.get(Ht.key===null?Ct:Ht.key)||null,_t(gt,bt,Ht,Xt);case Or:return bt=bt.get(Ht.key===null?Ct:Ht.key)||null,zt(gt,bt,Ht,Xt);case Dr:var En=Ht._init;return Ht=En(Ht._payload),Me(bt,gt,Ct,Ht,Xt)}if(ks(Ht)||_(Ht))return bt=bt.get(Ct)||null,Gt(gt,bt,Ht,Xt,null);if(typeof Ht.then=="function")return Me(bt,gt,Ct,ku(Ht),Xt);if(Ht.$$typeof===xr)return Me(bt,gt,Ct,Zt(gt,Ht),Xt);qu(gt,Ht)}return null}function vi(bt,gt,Ct,Ht){for(var Xt=null,En=null,Se=gt,$e=gt=0,ha=null;Se!==null&&$e<Ct.length;$e++){Se.index>$e?(ha=Se,Se=null):ha=Se.sibling;var an=te(bt,Se,Ct[$e],Ht);if(an===null){Se===null&&(Se=ha);break}s&&Se&&an.alternate===null&&u(bt,Se),gt=H(an,gt,$e),En===null?Xt=an:En.sibling=an,En=an,Se=ha}if($e===Ct.length)return p(bt,Se),nn&&W(bt,$e),Xt;if(Se===null){for(;$e<Ct.length;$e++)Se=Wt(bt,Ct[$e],Ht),Se!==null&&(gt=H(Se,gt,$e),En===null?Xt=Se:En.sibling=Se,En=Se);return nn&&W(bt,$e),Xt}for(Se=S(Se);$e<Ct.length;$e++)ha=Me(Se,bt,$e,Ct[$e],Ht),ha!==null&&(s&&ha.alternate!==null&&Se.delete(ha.key===null?$e:ha.key),gt=H(ha,gt,$e),En===null?Xt=ha:En.sibling=ha,En=ha);return s&&Se.forEach(function(bs){return u(bt,bs)}),nn&&W(bt,$e),Xt}function $o(bt,gt,Ct,Ht){if(Ct==null)throw Error(r(151));for(var Xt=null,En=null,Se=gt,$e=gt=0,ha=null,an=Ct.next();Se!==null&&!an.done;$e++,an=Ct.next()){Se.index>$e?(ha=Se,Se=null):ha=Se.sibling;var bs=te(bt,Se,an.value,Ht);if(bs===null){Se===null&&(Se=ha);break}s&&Se&&bs.alternate===null&&u(bt,Se),gt=H(bs,gt,$e),En===null?Xt=bs:En.sibling=bs,En=bs,Se=ha}if(an.done)return p(bt,Se),nn&&W(bt,$e),Xt;if(Se===null){for(;!an.done;$e++,an=Ct.next())an=Wt(bt,an.value,Ht),an!==null&&(gt=H(an,gt,$e),En===null?Xt=an:En.sibling=an,En=an);return nn&&W(bt,$e),Xt}for(Se=S(Se);!an.done;$e++,an=Ct.next())an=Me(Se,bt,$e,an.value,Ht),an!==null&&(s&&an.alternate!==null&&Se.delete(an.key===null?$e:an.key),gt=H(an,gt,$e),En===null?Xt=an:En.sibling=an,En=an);return s&&Se.forEach(function(qc){return u(bt,qc)}),nn&&W(bt,$e),Xt}function Ss(bt,gt,Ct,Ht){if(typeof Ct=="object"&&Ct!==null&&Ct.type===Hs&&Ct.key===null&&(Ct=Ct.props.children),typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case Io:t:{for(var Xt=Ct.key;gt!==null;){if(gt.key===Xt){if(Xt=Ct.type,Xt===Hs){if(gt.tag===7){p(bt,gt.sibling),Ht=x(gt,Ct.props.children),Ht.return=bt,bt=Ht;break t}}else if(gt.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===Dr&&Vu(Xt)===gt.type){p(bt,gt.sibling),Ht=x(gt,Ct.props),Ml(Ht,Ct),Ht.return=bt,bt=Ht;break t}p(bt,gt);break}else u(bt,gt);gt=gt.sibling}Ct.type===Hs?(Ht=Ls(Ct.props.children,bt.mode,Ht,Ct.key),Ht.return=bt,bt=Ht):(Ht=Vl(Ct.type,Ct.key,Ct.props,null,bt.mode,Ht),Ml(Ht,Ct),Ht.return=bt,bt=Ht)}return et(bt);case Or:t:{for(Xt=Ct.key;gt!==null;){if(gt.key===Xt)if(gt.tag===4&&gt.stateNode.containerInfo===Ct.containerInfo&&gt.stateNode.implementation===Ct.implementation){p(bt,gt.sibling),Ht=x(gt,Ct.children||[]),Ht.return=bt,bt=Ht;break t}else{p(bt,gt);break}else u(bt,gt);gt=gt.sibling}Ht=ad(Ct,bt.mode,Ht),Ht.return=bt,bt=Ht}return et(bt);case Dr:return Xt=Ct._init,Ct=Xt(Ct._payload),Ss(bt,gt,Ct,Ht)}if(ks(Ct))return vi(bt,gt,Ct,Ht);if(_(Ct)){if(Xt=_(Ct),typeof Xt!="function")throw Error(r(150));return Ct=Xt.call(Ct),$o(bt,gt,Ct,Ht)}if(typeof Ct.then=="function")return Ss(bt,gt,ku(Ct),Ht);if(Ct.$$typeof===xr)return Ss(bt,gt,Zt(bt,Ct),Ht);qu(bt,Ct)}return typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint"?(Ct=""+Ct,gt!==null&&gt.tag===6?(p(bt,gt.sibling),Ht=x(gt,Ct),Ht.return=bt,bt=Ht):(p(bt,gt),Ht=nd(Ct,bt.mode,Ht),Ht.return=bt,bt=Ht),et(bt)):p(bt,gt)}return function(bt,gt,Ct,Ht){try{oo=0;var Xt=Ss(bt,gt,Ct,Ht);return $a=null,Xt}catch(Se){if(Se===to||Se===eo)throw Se;var En=n(29,Se,null,bt.mode);return En.lanes=Ht,En.return=bt,En}finally{}}}function Wr(s){var u=s.alternate;v(kn,kn.current&1),v(mi,s),Ia===null&&(u===null||no.current!==null||u.memoizedState!==null)&&(Ia=s)}function Oh(s){if(s.tag===22){if(v(kn,kn.current),v(mi,s),Ia===null){var u=s.alternate;u!==null&&u.memoizedState!==null&&(Ia=s)}}else $r()}function $r(){v(kn,kn.current),v(mi,mi.current)}function Cr(s){R(mi),Ia===s&&(Ia=null),R(kn)}function Nl(s){for(var u=s;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Ec(p)||Cc(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function Uf(s,u,p,S){u=s.memoizedState,p=p(S,u),p=p==null?u:dc({},u,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}function xh(s,u,p,S,x,H,et){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(S,H,et):u.prototype&&u.prototype.isPureReactComponent?!Cn(p,S)||!Cn(x,H):!0}function Mh(s,u,p,S){s=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,S),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,S),u.state!==s&&lo.enqueueReplaceState(u,u.state,null)}function Ms(s,u){var p=u;if("ref"in u){p={};for(var S in u)S!=="ref"&&(p[S]=u[S])}if(s=s.defaultProps){p===u&&(p=dc({},p));for(var x in s)p[x]===void 0&&(p[x]=s[x])}return p}function Oo(s,u){try{var p=s.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(S){setTimeout(function(){throw S})}}function Nh(s,u,p){try{var S=s.onCaughtError;S(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Bf(s,u,p){return p=It(p),p.tag=3,p.payload={element:null},p.callback=function(){Oo(s,u)},p}function Dh(s){return s=It(s),s.tag=3,s}function zf(s,u,p,S){var x=p.type.getDerivedStateFromError;if(typeof x=="function"){var H=S.value;s.payload=function(){return x(H)},s.callback=function(){Nh(u,p,S)}}var et=p.stateNode;et!==null&&typeof et.componentDidCatch=="function"&&(s.callback=function(){Nh(u,p,S),typeof x!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var ct=S.stack;this.componentDidCatch(S.value,{componentStack:ct!==null?ct:""})})}function Pg(s,u,p,S,x){if(p.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(u=p.alternate,u!==null&&mn(u,p,x,!0),p=mi.current,p!==null){switch(p.tag){case 13:return Ia===null?sc():p.alternate===null&&jn===0&&(jn=3),p.flags&=-257,p.flags|=65536,p.lanes=x,S===ou?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([S]):u.add(S),Bi(s,S,x)),!1;case 22:return p.flags|=65536,S===ou?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([S])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([S]):p.add(S)),Bi(s,S,x)),!1}throw Error(r(435,p.tag))}return Bi(s,S,x),sc(),!1}if(nn)return u=mi.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=x,S!==Pi&&(s=Error(r(422),{cause:S}),re(F(s,p)))):(S!==Pi&&(u=Error(r(423),{cause:S}),re(F(u,p))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,S=F(S,p),x=Bf(s.stateNode,S,x),Oe(s,x),jn!==4&&(jn=2)),!1;var H=Error(r(520),{cause:S});if(H=F(H,p),fo===null?fo=[H]:fo.push(H),jn!==4&&(jn=2),u===null)return!0;S=F(S,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,s=x&-x,p.lanes|=s,s=Bf(p.stateNode,S,s),Oe(p,s),!1;case 1:if(u=p.type,H=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Ir===null||!Ir.has(H))))return p.flags|=65536,x&=-x,p.lanes|=x,x=Dh(x),zf(x,s,p,S),Oe(p,x),!1}p=p.return}while(p!==null);return!1}function pa(s,u,p,S){u.child=s===null?Ai(u,null,p,S):vs(u,s.child,p,S)}function jh(s,u,p,S,x){p=p.render;var H=u.ref;if("ref"in S){var et={};for(var ct in S)ct!=="ref"&&(et[ct]=S[ct])}else et=S;return sn(u),S=un(s,u,p,et,H,x),ct=As(),s!==null&&!la?(ws(s,u,x),Fi(s,u,x)):(nn&&ct&&Z(u),u.flags|=1,pa(s,u,S,x),u.child)}function Uh(s,u,p,S,x){if(s===null){var H=p.type;return typeof H=="function"&&!Rr(H)&&H.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=H,Bh(s,u,H,S,x)):(s=Vl(p.type,null,S,u,u.mode,x),s.ref=u.ref,s.return=u,u.child=s)}if(H=s.child,!Ju(s,x)){var et=H.memoizedProps;if(p=p.compare,p=p!==null?p:Cn,p(et,S)&&s.ref===u.ref)return Fi(s,u,x)}return u.flags|=1,s=Nn(H,S),s.ref=u.ref,s.return=u,u.child=s}function Bh(s,u,p,S,x){if(s!==null){var H=s.memoizedProps;if(Cn(H,S)&&s.ref===u.ref)if(la=!1,u.pendingProps=S=H,Ju(s,x))(s.flags&131072)!==0&&(la=!0);else return u.lanes=s.lanes,Fi(s,u,x)}return Lf(s,u,p,S,x)}function zh(s,u,p){var S=u.pendingProps,x=S.children,H=s!==null?s.memoizedState:null;if(S.mode==="hidden"){if((u.flags&128)!==0){if(S=H!==null?H.baseLanes|p:p,s!==null){for(x=u.child=s.child,H=0;x!==null;)H=H|x.lanes|x.childLanes,x=x.sibling;u.childLanes=H&~S}else u.childLanes=0,u.child=null;return Lh(s,u,S,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},s!==null&&be(u,H!==null?H.cachePool:null),H!==null?Pe(u,H):we(),Oh(u);else return u.lanes=u.childLanes=536870912,Lh(s,u,H!==null?H.baseLanes|p:p,p)}else H!==null?(be(u,H.cachePool),Pe(u,H),$r(),u.memoizedState=null):(s!==null&&be(u,null),we(),$r());return pa(s,u,x,p),u.child}function Lh(s,u,p,S){var x=Ae();return x=x===null?null:{parent:er?An._currentValue:An._currentValue2,pool:x},u.memoizedState={baseLanes:p,cachePool:x},s!==null&&be(u,null),we(),Oh(u),s!==null&&mn(s,u,S,!0),null}function Yu(s,u){var p=u.ref;if(p===null)s!==null&&s.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(u.flags|=4194816)}}function Lf(s,u,p,S,x){return sn(u),p=un(s,u,p,S,void 0,x),S=As(),s!==null&&!la?(ws(s,u,x),Fi(s,u,x)):(nn&&S&&Z(u),u.flags|=1,pa(s,u,p,x),u.child)}function Ku(s,u,p,S,x,H){return sn(u),u.updateQueue=null,p=ii(u,S,p,x),ai(s),S=As(),s!==null&&!la?(ws(s,u,H),Fi(s,u,H)):(nn&&S&&Z(u),u.flags|=1,pa(s,u,p,H),u.child)}function xo(s,u,p,S,x){if(sn(u),u.stateNode===null){var H=hs,et=p.contextType;typeof et=="object"&&et!==null&&(H=Ot(et)),H=new p(S,H),u.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,H.updater=lo,u.stateNode=H,H._reactInternals=u,H=u.stateNode,H.props=S,H.state=u.memoizedState,H.refs={},$t(u),et=p.contextType,H.context=typeof et=="object"&&et!==null?Ot(et):hs,H.state=u.memoizedState,et=p.getDerivedStateFromProps,typeof et=="function"&&(Uf(u,p,et,S),H.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(et=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),et!==H.state&&lo.enqueueReplaceState(H,H.state,null),on(u,S,H,x),ie(),H.state=u.memoizedState),typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!0}else if(s===null){H=u.stateNode;var ct=u.memoizedProps,_t=Ms(p,ct);H.props=_t;var zt=H.context,Gt=p.contextType;et=hs,typeof Gt=="object"&&Gt!==null&&(et=Ot(Gt));var Wt=p.getDerivedStateFromProps;Gt=typeof Wt=="function"||typeof H.getSnapshotBeforeUpdate=="function",ct=u.pendingProps!==ct,Gt||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ct||zt!==et)&&Mh(u,H,S,et),Dn=!1;var te=u.memoizedState;H.state=te,on(u,S,H,x),ie(),zt=u.memoizedState,ct||te!==zt||Dn?(typeof Wt=="function"&&(Uf(u,p,Wt,S),zt=u.memoizedState),(_t=Dn||xh(u,p,_t,S,te,zt,et))?(Gt||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(u.flags|=4194308)):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=S,u.memoizedState=zt),H.props=S,H.state=zt,H.context=et,S=_t):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!1)}else{H=u.stateNode,Ft(s,u),et=u.memoizedProps,Gt=Ms(p,et),H.props=Gt,Wt=u.pendingProps,te=H.context,zt=p.contextType,_t=hs,typeof zt=="object"&&zt!==null&&(_t=Ot(zt)),ct=p.getDerivedStateFromProps,(zt=typeof ct=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(et!==Wt||te!==_t)&&Mh(u,H,S,_t),Dn=!1,te=u.memoizedState,H.state=te,on(u,S,H,x),ie();var Me=u.memoizedState;et!==Wt||te!==Me||Dn||s!==null&&s.dependencies!==null&&Yn(s.dependencies)?(typeof ct=="function"&&(Uf(u,p,ct,S),Me=u.memoizedState),(Gt=Dn||xh(u,p,Gt,S,te,Me,_t)||s!==null&&s.dependencies!==null&&Yn(s.dependencies))?(zt||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(S,Me,_t),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(S,Me,_t)),typeof H.componentDidUpdate=="function"&&(u.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof H.componentDidUpdate!="function"||et===s.memoizedProps&&te===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&te===s.memoizedState||(u.flags|=1024),u.memoizedProps=S,u.memoizedState=Me),H.props=S,H.state=Me,H.context=_t,S=Gt):(typeof H.componentDidUpdate!="function"||et===s.memoizedProps&&te===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&te===s.memoizedState||(u.flags|=1024),S=!1)}return H=S,Yu(s,u),S=(u.flags&128)!==0,H||S?(H=u.stateNode,p=S&&typeof p.getDerivedStateFromError!="function"?null:H.render(),u.flags|=1,s!==null&&S?(u.child=vs(u,s.child,null,x),u.child=vs(u,null,p,x)):pa(s,u,p,x),u.memoizedState=H.state,s=u.child):s=Fi(s,u,x),s}function Ph(s,u,p,S){return kt(),u.flags|=256,pa(s,u,p,S),u.child}function Qu(s){return{baseLanes:s,cachePool:Ie()}}function Xu(s,u,p){return s=s!==null?s.childLanes&~p:0,u&&(s|=Ta),s}function Pf(s,u,p){var S=u.pendingProps,x=!1,H=(u.flags&128)!==0,et;if((et=H)||(et=s!==null&&s.memoizedState===null?!1:(kn.current&2)!==0),et&&(x=!0,u.flags&=-129),et=(u.flags&32)!==0,u.flags&=-33,s===null){if(nn){if(x?Wr(u):$r(),nn){var ct=Jn,_t;(_t=ct)&&(ct=Ac(ct,Li),ct!==null?(u.memoizedState={dehydrated:ct,treeContext:gs!==null?{id:lr,overflow:zi}:null,retryLane:536870912,hydrationErrors:null},_t=n(18,null,null,0),_t.stateNode=ct,_t.return=u,u.child=_t,ca=u,Jn=null,_t=!0):_t=!1),_t||nt(u)}if(ct=u.memoizedState,ct!==null&&(ct=ct.dehydrated,ct!==null))return Cc(ct)?u.lanes=32:u.lanes=536870912,null;Cr(u)}return ct=S.children,S=S.fallback,x?($r(),x=u.mode,ct=Dl({mode:"hidden",children:ct},x),S=Ls(S,x,p,null),ct.return=u,S.return=u,ct.sibling=S,u.child=ct,x=u.child,x.memoizedState=Qu(p),x.childLanes=Xu(s,et,p),u.memoizedState=co,S):(Wr(u),Fu(u,ct))}if(_t=s.memoizedState,_t!==null&&(ct=_t.dehydrated,ct!==null)){if(H)u.flags&256?(Wr(u),u.flags&=-257,u=ts(s,u,p)):u.memoizedState!==null?($r(),u.child=s.child,u.flags|=128,u=null):($r(),x=S.fallback,ct=u.mode,S=Dl({mode:"visible",children:S.children},ct),x=Ls(x,ct,p,null),x.flags|=2,S.return=u,x.return=u,S.sibling=x,u.child=S,vs(u,s.child,null,p),S=u.child,S.memoizedState=Qu(p),S.childLanes=Xu(s,et,p),u.memoizedState=co,u=x);else if(Wr(u),Cc(ct))et=n0(ct).digest,S=Error(r(419)),S.stack="",S.digest=et,re({value:S,source:null,stack:null}),u=ts(s,u,p);else if(la||mn(s,u,p,!1),et=(p&s.childLanes)!==0,la||et){if(et=_n,et!==null&&(S=p&-p,S=(S&42)!==0?1:G(S),S=(S&(et.suspendedLanes|p))!==0?0:S,S!==0&&S!==_t.retryLane))throw _t.retryLane=S,Ki(s,S),Xa(et,s,S),Bd;Ec(ct)||sc(),u=ts(s,u,p)}else Ec(ct)?(u.flags|=192,u.child=s.child,u=null):(s=_t.treeContext,zn&&(Jn=o0(ct),ca=u,nn=!0,Lr=null,Li=!1,s!==null&&(Za[gi++]=lr,Za[gi++]=zi,Za[gi++]=gs,lr=s.id,zi=s.overflow,gs=u)),u=Fu(u,S.children),u.flags|=4096);return u}return x?($r(),x=S.fallback,ct=u.mode,_t=s.child,H=_t.sibling,S=Nn(_t,{mode:"hidden",children:S.children}),S.subtreeFlags=_t.subtreeFlags&65011712,H!==null?x=Nn(H,x):(x=Ls(x,ct,p,null),x.flags|=2),x.return=u,S.return=u,S.sibling=x,u.child=S,S=x,x=u.child,ct=s.child.memoizedState,ct===null?ct=Qu(p):(_t=ct.cachePool,_t!==null?(H=er?An._currentValue:An._currentValue2,_t=_t.parent!==H?{parent:H,pool:H}:_t):_t=Ie(),ct={baseLanes:ct.baseLanes|p,cachePool:_t}),x.memoizedState=ct,x.childLanes=Xu(s,et,p),u.memoizedState=co,S):(Wr(u),p=s.child,s=p.sibling,p=Nn(p,{mode:"visible",children:S.children}),p.return=u,p.sibling=null,s!==null&&(et=u.deletions,et===null?(u.deletions=[s],u.flags|=16):et.push(s)),u.child=p,u.memoizedState=null,p)}function Fu(s,u){return u=Dl({mode:"visible",children:u},s.mode),u.return=s,s.child=u}function Dl(s,u){return s=n(22,s,null,u),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function ts(s,u,p){return vs(u,s.child,null,p),s=Fu(u,u.pendingProps.children),s.flags|=2,u.memoizedState=null,s}function Gh(s,u,p){s.lanes|=u;var S=s.alternate;S!==null&&(S.lanes|=u),rn(s.return,u,p)}function Gf(s,u,p,S,x){var H=s.memoizedState;H===null?s.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:S,tail:p,tailMode:x}:(H.isBackwards=u,H.rendering=null,H.renderingStartTime=0,H.last=S,H.tail=p,H.tailMode=x)}function Hh(s,u,p){var S=u.pendingProps,x=S.revealOrder,H=S.tail;if(pa(s,u,S.children,p),S=kn.current,(S&2)!==0)S=S&1|2,u.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=u.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Gh(s,p,u);else if(s.tag===19)Gh(s,p,u);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===u)break t;for(;s.sibling===null;){if(s.return===null||s.return===u)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}S&=1}switch(v(kn,S),x){case"forwards":for(p=u.child,x=null;p!==null;)s=p.alternate,s!==null&&Nl(s)===null&&(x=p),p=p.sibling;p=x,p===null?(x=u.child,u.child=null):(x=p.sibling,p.sibling=null),Gf(u,!1,x,p,H);break;case"backwards":for(p=null,x=u.child,u.child=null;x!==null;){if(s=x.alternate,s!==null&&Nl(s)===null){u.child=x;break}s=x.sibling,x.sibling=p,p=x,x=s}Gf(u,!0,p,null,H);break;case"together":Gf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Fi(s,u,p){if(s!==null&&(u.dependencies=s.dependencies),ka|=u.lanes,(p&u.childLanes)===0)if(s!==null){if(mn(s,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(s!==null&&u.child!==s.child)throw Error(r(153));if(u.child!==null){for(s=u.child,p=Nn(s,s.pendingProps),u.child=p,p.return=u;s.sibling!==null;)s=s.sibling,p=p.sibling=Nn(s,s.pendingProps),p.return=u;p.sibling=null}return u.child}function Ju(s,u){return(s.lanes&u)!==0?!0:(s=s.dependencies,!!(s!==null&&Yn(s)))}function jl(s,u,p){switch(u.tag){case 3:rt(u,u.stateNode.containerInfo),ge(u,An,s.memoizedState.cache),kt();break;case 27:case 5:J(u);break;case 4:rt(u,u.stateNode.containerInfo);break;case 10:ge(u,u.type,u.memoizedProps.value);break;case 13:var S=u.memoizedState;if(S!==null)return S.dehydrated!==null?(Wr(u),u.flags|=128,null):(p&u.child.childLanes)!==0?Pf(s,u,p):(Wr(u),s=Fi(s,u,p),s!==null?s.sibling:null);Wr(u);break;case 19:var x=(s.flags&128)!==0;if(S=(p&u.childLanes)!==0,S||(mn(s,u,p,!1),S=(p&u.childLanes)!==0),x){if(S)return Hh(s,u,p);u.flags|=128}if(x=u.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),v(kn,kn.current),S)break;return null;case 22:case 23:return u.lanes=0,zh(s,u,p);case 24:ge(u,An,s.memoizedState.cache)}return Fi(s,u,p)}function Mo(s,u,p){if(s!==null)if(s.memoizedProps!==u.pendingProps)la=!0;else{if(!Ju(s,p)&&(u.flags&128)===0)return la=!1,jl(s,u,p);la=(s.flags&131072)!==0}else la=!1,nn&&(u.flags&1048576)!==0&&it(u,Zs,u.index);switch(u.lanes=0,u.tag){case 16:t:{s=u.pendingProps;var S=u.elementType,x=S._init;if(S=x(S._payload),u.type=S,typeof S=="function")Rr(S)?(s=Ms(S,s),u.tag=1,u=xo(null,u,S,s,p)):(u.tag=0,u=Lf(null,u,S,s,p));else{if(S!=null){if(x=S.$$typeof,x===gc){u.tag=11,u=jh(null,u,S,s,p);break t}else if(x===pc){u.tag=14,u=Uh(null,u,S,s,p);break t}}throw u=C(S)||S,Error(r(306,u,""))}}return u;case 0:return Lf(s,u,u.type,u.pendingProps,p);case 1:return S=u.type,x=Ms(S,u.pendingProps),xo(s,u,S,x,p);case 3:t:{if(rt(u,u.stateNode.containerInfo),s===null)throw Error(r(387));var H=u.pendingProps;x=u.memoizedState,S=x.element,Ft(s,u),on(u,H,null,p);var et=u.memoizedState;if(H=et.cache,ge(u,An,H),H!==x.cache&&Ye(u,[An],p,!0),ie(),H=et.element,zn&&x.isDehydrated)if(x={element:H,isDehydrated:!1,cache:et.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=Ph(s,u,H,p);break t}else if(H!==S){S=F(Error(r(424)),u),re(S),u=Ph(s,u,H,p);break t}else for(zn&&(Jn=qg(u.stateNode.containerInfo),ca=u,nn=!0,Lr=null,Li=!0),p=Ai(u,null,H,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(kt(),H===S){u=Fi(s,u,p);break t}pa(s,u,H,p)}u=u.child}return u;case 26:if(di)return Yu(s,u),s===null?(p=v0(u.type,null,u.pendingProps,null))?u.memoizedState=p:nn||(u.stateNode=S0(u.type,u.pendingProps,zr.current,u)):u.memoizedState=v0(u.type,s.memoizedProps,u.pendingProps,s.memoizedState),null;case 27:if(Fn)return J(u),s===null&&Fn&&nn&&(S=u.stateNode=eu(u.type,u.pendingProps,zr.current,oa.current,!1),ca=u,Li=!0,Jn=Vo(u.type,S,Jn)),pa(s,u,u.pendingProps.children,p),Yu(s,u),s===null&&(u.flags|=4194304),u.child;case 5:return s===null&&nn&&(p0(u.type,u.pendingProps,oa.current),(x=S=Jn)&&(S=l0(S,u.type,u.pendingProps,Li),S!==null?(u.stateNode=S,ca=u,Jn=s0(S),Li=!1,x=!0):x=!1),x||nt(u)),J(u),x=u.type,H=u.pendingProps,et=s!==null?s.memoizedProps:null,S=H.children,cs(x,H)?S=null:et!==null&&cs(x,et)&&(u.flags|=32),u.memoizedState!==null&&(x=un(s,u,Kn,null,null,p),er?Ti._currentValue=x:Ti._currentValue2=x),Yu(s,u),pa(s,u,S,p),u.child;case 6:return s===null&&nn&&(m0(u.pendingProps,oa.current),(s=p=Jn)&&(p=Tc(p,u.pendingProps,Li),p!==null?(u.stateNode=p,ca=u,Jn=null,s=!0):s=!1),s||nt(u)),null;case 13:return Pf(s,u,p);case 4:return rt(u,u.stateNode.containerInfo),S=u.pendingProps,s===null?u.child=vs(u,null,S,p):pa(s,u,S,p),u.child;case 11:return jh(s,u,u.type,u.pendingProps,p);case 7:return pa(s,u,u.pendingProps,p),u.child;case 8:return pa(s,u,u.pendingProps.children,p),u.child;case 12:return pa(s,u,u.pendingProps.children,p),u.child;case 10:return S=u.pendingProps,ge(u,u.type,S.value),pa(s,u,S.children,p),u.child;case 9:return x=u.type._context,S=u.pendingProps.children,sn(u),x=Ot(x),S=S(x),u.flags|=1,pa(s,u,S,p),u.child;case 14:return Uh(s,u,u.type,u.pendingProps,p);case 15:return Bh(s,u,u.type,u.pendingProps,p);case 19:return Hh(s,u,p);case 31:return S=u.pendingProps,p=u.mode,S={mode:S.mode,children:S.children},s===null?(p=Dl(S,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=Nn(s.child,S),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return zh(s,u,p);case 24:return sn(u),S=Ot(An),s===null?(x=Ae(),x===null&&(x=_n,H=Ke(),x.pooledCache=H,H.refCount++,H!==null&&(x.pooledCacheLanes|=p),x=H),u.memoizedState={parent:S,cache:x},$t(u),ge(u,An,x)):((s.lanes&p)!==0&&(Ft(s,u),on(u,null,null,p),ie()),x=s.memoizedState,H=u.memoizedState,x.parent!==S?(x={parent:S,cache:S},u.memoizedState=x,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=x),ge(u,An,S)):(S=H.cache,ge(u,An,S),S!==x.cache&&Ye(u,[An],p,!0))),pa(s,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function si(s){s.flags|=4}function Ul(s,u){if(s!==null&&s.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(s=u.child;s!==null;){if((s.flags&13878)!==0||(s.subtreeFlags&13878)!==0)return!0;s=s.sibling}return!1}function Zu(s,u,p,S){if(ua)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)Zl(s,p.stateNode);else if(!(p.tag===4||Fn&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(nr)for(var x=u.child;x!==null;){if(x.tag===5){var H=x.stateNode;p&&S&&(H=md(H,x.type,x.memoizedProps)),Zl(s,H)}else if(x.tag===6)H=x.stateNode,p&&S&&(H=e0(H,x.memoizedProps)),Zl(s,H);else if(x.tag!==4){if(x.tag===22&&x.memoizedState!==null)H=x.child,H!==null&&(H.return=x),Zu(s,x,!0,!0);else if(x.child!==null){x.child.return=x,x=x.child;continue}}if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return}x.sibling.return=x.return,x=x.sibling}}function Hf(s,u,p,S){var x=!1;if(nr)for(var H=u.child;H!==null;){if(H.tag===5){var et=H.stateNode;p&&S&&(et=md(et,H.type,H.memoizedProps)),pd(s,et)}else if(H.tag===6)et=H.stateNode,p&&S&&(et=e0(et,H.memoizedProps)),pd(s,et);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)x=H.child,x!==null&&(x.return=H),Hf(s,H,!0,!0),x=!0;else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===u)break;for(;H.sibling===null;){if(H.return===null||H.return===u)return x;H=H.return}H.sibling.return=H.return,H=H.sibling}return x}function Wu(s,u){if(nr&&Ul(s,u)){s=u.stateNode;var p=s.containerInfo,S=gd();Hf(S,u,!1,!1),s.pendingChildren=S,si(u),t0(p,S)}}function Bl(s,u,p,S){if(ua)s.memoizedProps!==S&&si(u);else if(nr){var x=s.stateNode,H=s.memoizedProps;if((s=Ul(s,u))||H!==S){var et=oa.current;H=$h(x,p,H,S,!s,null),H===x?u.stateNode=x:(ko(H,p,S,et)&&si(u),u.stateNode=H,s?Zu(H,u,!1,!1):si(u))}else u.stateNode=x}}function $u(s,u,p){if(mc(u,p)){if(s.flags|=16777216,!ir(u,p))if(ji())s.flags|=8192;else throw Wa=ou,su}else s.flags&=-16777217}function If(s,u){if(Kg(u)){if(s.flags|=16777216,!Cd(u))if(ji())s.flags|=8192;else throw Wa=ou,su}else s.flags&=-16777217}function zl(s,u){u!==null&&(s.flags|=4),s.flags&16384&&(u=s.tag!==22?O():536870912,s.lanes|=u,ti|=u)}function Ll(s,u){if(!nn)switch(s.tailMode){case"hidden":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?u||s.tail===null?s.tail=null:s.tail.sibling=null:S.sibling=null}}function In(s){var u=s.alternate!==null&&s.alternate.child===s.child,p=0,S=0;if(u)for(var x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags&65011712,S|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags,S|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=S,s.childLanes=p,u}function Gg(s,u,p){var S=u.pendingProps;switch(at(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return In(u),null;case 1:return In(u),null;case 3:return p=u.stateNode,S=null,s!==null&&(S=s.memoizedState.cache),u.memoizedState.cache!==S&&(u.flags|=2048),pe(An),V(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(jt(u)?si(u):s===null||s.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,ee())),Wu(s,u),In(u),null;case 26:if(di){p=u.type;var x=u.memoizedState;return s===null?(si(u),x!==null?(In(u),If(u,x)):(In(u),$u(u,p,S))):x?x!==s.memoizedState?(si(u),In(u),If(u,x)):(In(u),u.flags&=-16777217):(ua?s.memoizedProps!==S&&si(u):Bl(s,u,p,S),In(u),$u(u,p,S)),null}case 27:if(Fn){if(tt(u),p=zr.current,x=u.type,s!==null&&u.stateNode!=null)ua?s.memoizedProps!==S&&si(u):Bl(s,u,x,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return In(u),null}s=oa.current,jt(u)?ht(u,s):(s=eu(x,S,p,s,!0),u.stateNode=s,si(u))}return In(u),null}case 5:if(tt(u),p=u.type,s!==null&&u.stateNode!=null)Bl(s,u,p,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return In(u),null}s=oa.current,jt(u)?ht(u,s):(x=rd(p,S,zr.current,s,u),Zu(x,u,!1,!1),u.stateNode=x,ko(x,p,S,s)&&si(u))}return In(u),$u(u,u.type,u.pendingProps),null;case 6:if(s&&u.stateNode!=null)p=s.memoizedProps,ua?p!==S&&si(u):nr&&(p!==S?(u.stateNode=sd(S,zr.current,oa.current,u),si(u)):u.stateNode=s.stateNode);else{if(typeof S!="string"&&u.stateNode===null)throw Error(r(166));if(s=zr.current,p=oa.current,jt(u)){if(!zn)throw Error(r(176));if(s=u.stateNode,p=u.memoizedProps,S=null,x=ca,x!==null)switch(x.tag){case 27:case 5:S=x.memoizedProps}Sd(s,p,u,S)||nt(u)}else u.stateNode=sd(S,s,p,u)}return In(u),null;case 13:if(S=u.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=jt(u),S!==null&&S.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(!zn)throw Error(r(344));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));Vg(x,u)}else kt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;In(u),x=!1}else x=ee(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return u.flags&256?(Cr(u),u):(Cr(u),null)}if(Cr(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=S!==null,s=s!==null&&s.memoizedState!==null,p){S=u.child,x=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(x=S.alternate.memoizedState.cachePool.pool);var H=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(H=S.memoizedState.cachePool.pool),H!==x&&(S.flags|=2048)}return p!==s&&p&&(u.child.flags|=8192),zl(u,u.updateQueue),In(u),null;case 4:return V(),Wu(s,u),s===null&&fs(u.stateNode.containerInfo),In(u),null;case 10:return pe(u.type),In(u),null;case 19:if(R(kn),x=u.memoizedState,x===null)return In(u),null;if(S=(u.flags&128)!==0,H=x.rendering,H===null)if(S)Ll(x,!1);else{if(jn!==0||s!==null&&(s.flags&128)!==0)for(s=u.child;s!==null;){if(H=Nl(s),H!==null){for(u.flags|=128,Ll(x,!1),s=H.updateQueue,u.updateQueue=s,zl(u,s),u.subtreeFlags=0,s=p,p=u.child;p!==null;)ql(p,s),p=p.sibling;return v(kn,kn.current&1|2),u.child}s=s.sibling}x.tail!==null&&hi()>go&&(u.flags|=128,S=!0,Ll(x,!1),u.lanes=4194304)}else{if(!S)if(s=Nl(H),s!==null){if(u.flags|=128,S=!0,s=s.updateQueue,u.updateQueue=s,zl(u,s),Ll(x,!0),x.tail===null&&x.tailMode==="hidden"&&!H.alternate&&!nn)return In(u),null}else 2*hi()-x.renderingStartTime>go&&p!==536870912&&(u.flags|=128,S=!0,Ll(x,!1),u.lanes=4194304);x.isBackwards?(H.sibling=u.child,u.child=H):(s=x.last,s!==null?s.sibling=H:u.child=H,x.last=H)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=hi(),u.sibling=null,s=kn.current,v(kn,S?s&1|2:s&1),u):(In(u),null);case 22:case 23:return Cr(u),Ue(),S=u.memoizedState!==null,s!==null?s.memoizedState!==null!==S&&(u.flags|=8192):S&&(u.flags|=8192),S?(p&536870912)!==0&&(u.flags&128)===0&&(In(u),u.subtreeFlags&6&&(u.flags|=8192)):In(u),p=u.updateQueue,p!==null&&zl(u,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),S=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(S=u.memoizedState.cachePool.pool),S!==p&&(u.flags|=2048),s!==null&&R(Pr),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),pe(An),In(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function Hg(s,u){switch(at(u),u.tag){case 1:return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 3:return pe(An),V(),s=u.flags,(s&65536)!==0&&(s&128)===0?(u.flags=s&-65537|128,u):null;case 26:case 27:case 5:return tt(u),null;case 13:if(Cr(u),s=u.memoizedState,s!==null&&s.dehydrated!==null){if(u.alternate===null)throw Error(r(340));kt()}return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 19:return R(kn),null;case 4:return V(),null;case 10:return pe(u.type),null;case 22:case 23:return Cr(u),Ue(),s!==null&&R(Pr),s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 24:return pe(An),null;case 25:return null;default:return null}}function Ih(s,u){switch(at(u),u.tag){case 3:pe(An),V();break;case 26:case 27:case 5:tt(u);break;case 4:V();break;case 13:Cr(u);break;case 19:R(kn);break;case 10:pe(u.type);break;case 22:case 23:Cr(u),Ue(),s!==null&&R(Pr);break;case 24:pe(An)}}function ma(s,u){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var x=S.next;p=x;do{if((p.tag&s)===s){S=void 0;var H=p.create,et=p.inst;S=H(),et.destroy=S}p=p.next}while(p!==x)}}catch(ct){Xe(u,u.return,ct)}}function _i(s,u,p){try{var S=u.updateQueue,x=S!==null?S.lastEffect:null;if(x!==null){var H=x.next;S=H;do{if((S.tag&s)===s){var et=S.inst,ct=et.destroy;if(ct!==void 0){et.destroy=void 0,x=u;var _t=p,zt=ct;try{zt()}catch(Gt){Xe(x,_t,Gt)}}}S=S.next}while(S!==H)}}catch(Gt){Xe(u,u.return,Gt)}}function kf(s){var u=s.updateQueue;if(u!==null){var p=s.stateNode;try{je(u,p)}catch(S){Xe(s,s.return,S)}}}function qf(s,u,p){p.props=Ms(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(S){Xe(s,u,S)}}function No(s,u){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var S=Vs(s.stateNode);break;case 30:S=s.stateNode;break;default:S=s.stateNode}typeof p=="function"?s.refCleanup=p(S):p.current=S}}catch(x){Xe(s,u,x)}}function xi(s,u){var p=s.ref,S=s.refCleanup;if(p!==null)if(typeof S=="function")try{S()}catch(x){Xe(s,u,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(x){Xe(s,u,x)}else p.current=null}function tc(s){var u=s.type,p=s.memoizedProps,S=s.stateNode;try{La(S,u,p,s)}catch(x){Xe(s,s.return,x)}}function Vf(s,u,p){try{Xn(s.stateNode,s.type,p,u,s)}catch(S){Xe(s,s.return,S)}}function Ns(s){return s.tag===5||s.tag===3||(di?s.tag===26:!1)||(Fn?s.tag===27&&Qs(s.type):!1)||s.tag===4}function Pl(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||Ns(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(Fn&&s.tag===27&&Qs(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ds(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?$l(p,s,u):ud(p,s);else if(S!==4&&(Fn&&S===27&&Qs(s.type)&&(p=s.stateNode,u=null),s=s.child,s!==null))for(Ds(s,u,p),s=s.sibling;s!==null;)Ds(s,u,p),s=s.sibling}function Do(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?yc(p,s,u):ld(p,s);else if(S!==4&&(Fn&&S===27&&Qs(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(Do(s,u,p),s=s.sibling;s!==null;)Do(s,u,p),s=s.sibling}function Yf(s,u,p){s=s.containerInfo;try{_c(s,p)}catch(S){Xe(u,u.return,S)}}function es(s){var u=s.stateNode,p=s.memoizedProps;try{b0(s.type,p,u,s)}catch(S){Xe(s,s.return,S)}}function jo(s,u){for(us(s.containerInfo),da=u;da!==null;)if(s=da,u=s.child,(s.subtreeFlags&1024)!==0&&u!==null)u.return=s,da=u;else for(;da!==null;){s=da;var p=s.alternate;switch(u=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0;var S=s,x=p.memoizedProps;p=p.memoizedState;var H=S.stateNode;try{var et=Ms(S.type,x,S.elementType===S.type);u=H.getSnapshotBeforeUpdate(et,p),H.__reactInternalSnapshotBeforeUpdate=u}catch(ct){Xe(S,S.return,ct)}}break;case 3:(u&1024)!==0&&ua&&Wh(s.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=s.sibling,u!==null){u.return=s.return,da=u;break}da=s.return}}function ec(s,u,p){var S=p.flags;switch(p.tag){case 0:case 11:case 15:Ji(s,p),S&4&&ma(5,p);break;case 1:if(Ji(s,p),S&4)if(s=p.stateNode,u===null)try{s.componentDidMount()}catch(et){Xe(p,p.return,et)}else{var x=Ms(p.type,u.memoizedProps);u=u.memoizedState;try{s.componentDidUpdate(x,u,s.__reactInternalSnapshotBeforeUpdate)}catch(et){Xe(p,p.return,et)}}S&64&&kf(p),S&512&&No(p,p.return);break;case 3:if(Ji(s,p),S&64&&(s=p.updateQueue,s!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=Vs(p.child.stateNode);break;case 1:u=p.child.stateNode}try{je(s,u)}catch(et){Xe(p,p.return,et)}}break;case 27:Fn&&u===null&&S&4&&es(p);case 26:case 5:Ji(s,p),u===null&&S&4&&tc(p),S&512&&No(p,p.return);break;case 12:Ji(s,p);break;case 13:Ji(s,p),S&4&&Qf(s,p),S&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=td.bind(null,p),vd(s,p))));break;case 22:if(S=p.memoizedState!==null||fr,!S){u=u!==null&&u.memoizedState!==null||Ln,x=fr;var H=Ln;fr=S,(Ln=u)&&!H?Mi(s,p,(p.subtreeFlags&8772)!==0):Ji(s,p),fr=x,Ln=H}break;case 30:break;default:Ji(s,p)}}function Kf(s){var u=s.alternate;u!==null&&(s.alternate=null,Kf(u)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(u=s.stateNode,u!==null&&Qn(u)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function va(s,u,p){for(p=p.child;p!==null;)nc(s,u,p),p=p.sibling}function nc(s,u,p){if(Ja&&typeof Ja.onCommitFiberUnmount=="function")try{Ja.onCommitFiberUnmount(Ko,p)}catch{}switch(p.tag){case 26:if(di){Ln||xi(p,u),va(s,u,p),p.memoizedState?_d(p.memoizedState):p.stateNode&&Ed(p.stateNode);break}case 27:if(Fn){Ln||xi(p,u);var S=de,x=Le;Qs(p.type)&&(de=p.stateNode,Le=!1),va(s,u,p),Td(p.stateNode),de=S,Le=x;break}case 5:Ln||xi(p,u);case 6:if(ua){if(S=de,x=Le,de=null,va(s,u,p),de=S,Le=x,de!==null)if(Le)try{fd(de,p.stateNode)}catch(H){Xe(p,u,H)}else try{Sc(de,p.stateNode)}catch(H){Xe(p,u,H)}}else va(s,u,p);break;case 18:ua&&de!==null&&(Le?g0(de,p.stateNode):h0(de,p.stateNode));break;case 4:ua?(S=de,x=Le,de=p.stateNode.containerInfo,Le=!0,va(s,u,p),de=S,Le=x):(nr&&Yf(p.stateNode,p,gd()),va(s,u,p));break;case 0:case 11:case 14:case 15:Ln||_i(2,p,u),Ln||_i(4,p,u),va(s,u,p);break;case 1:Ln||(xi(p,u),S=p.stateNode,typeof S.componentWillUnmount=="function"&&qf(p,u,S)),va(s,u,p);break;case 21:va(s,u,p);break;case 22:Ln=(S=Ln)||p.memoizedState!==null,va(s,u,p),Ln=S;break;default:va(s,u,p)}}function Qf(s,u){if(zn&&u.memoizedState===null&&(s=u.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{d0(s)}catch(p){Xe(u,u.return,p)}}function kh(s){switch(s.tag){case 13:case 19:var u=s.stateNode;return u===null&&(u=s.stateNode=new O0),u;case 22:return s=s.stateNode,u=s._retryCache,u===null&&(u=s._retryCache=new O0),u;default:throw Error(r(435,s.tag))}}function Xf(s,u){var p=kh(s);u.forEach(function(S){var x=ed.bind(null,s,S);p.has(S)||(p.add(S),S.then(x,x))})}function Ua(s,u){var p=u.deletions;if(p!==null)for(var S=0;S<p.length;S++){var x=p[S],H=s,et=u;if(ua){var ct=et;t:for(;ct!==null;){switch(ct.tag){case 27:if(Fn){if(Qs(ct.type)){de=ct.stateNode,Le=!1;break t}break}case 5:de=ct.stateNode,Le=!1;break t;case 3:case 4:de=ct.stateNode.containerInfo,Le=!0;break t}ct=ct.return}if(de===null)throw Error(r(160));nc(H,et,x),de=null,Le=!1}else nc(H,et,x);H=x.alternate,H!==null&&(H.return=null),x.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)qh(u,s),u=u.sibling}function qh(s,u){var p=s.alternate,S=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ua(u,s),Ba(s),S&4&&(_i(3,s,s.return),ma(3,s),_i(5,s,s.return));break;case 1:Ua(u,s),Ba(s),S&512&&(Ln||p===null||xi(p,p.return)),S&64&&fr&&(s=s.updateQueue,s!==null&&(S=s.callbacks,S!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?S:p.concat(S))));break;case 26:if(di){var x=Ee;if(Ua(u,s),Ba(s),S&512&&(Ln||p===null||xi(p,p.return)),S&4){S=p!==null?p.memoizedState:null;var H=s.memoizedState;p===null?H===null?s.stateNode===null?s.stateNode=y0(x,s.type,s.memoizedProps,s):xc(x,s.type,s.stateNode):s.stateNode=Oc(x,H,s.memoizedProps):S!==H?(S===null?p.stateNode!==null&&Ed(p.stateNode):_d(S),H===null?xc(x,s.type,s.stateNode):Oc(x,H,s.memoizedProps)):H===null&&s.stateNode!==null&&Vf(s,s.memoizedProps,p.memoizedProps)}break}case 27:if(Fn){Ua(u,s),Ba(s),S&512&&(Ln||p===null||xi(p,p.return)),p!==null&&S&4&&Vf(s,s.memoizedProps,p.memoizedProps);break}case 5:if(Ua(u,s),Ba(s),S&512&&(Ln||p===null||xi(p,p.return)),ua){if(s.flags&32){x=s.stateNode;try{sr(x)}catch(Gt){Xe(s,s.return,Gt)}}S&4&&s.stateNode!=null&&(x=s.memoizedProps,Vf(s,x,p!==null?p.memoizedProps:x)),S&1024&&(Pc=!0)}break;case 6:if(Ua(u,s),Ba(s),S&4&&ua){if(s.stateNode===null)throw Error(r(162));S=s.memoizedProps,p=p!==null?p.memoizedProps:S,x=s.stateNode;try{cd(x,p,S)}catch(Gt){Xe(s,s.return,Gt)}}break;case 3:if(di?(Yg(),x=Ee,Ee=Rc(u.containerInfo),Ua(u,s),Ee=x):Ua(u,s),Ba(s),S&4){if(ua&&zn&&p!==null&&p.memoizedState.isDehydrated)try{f0(u.containerInfo)}catch(Gt){Xe(s,s.return,Gt)}if(nr){S=u.containerInfo,p=u.pendingChildren;try{_c(S,p)}catch(Gt){Xe(s,s.return,Gt)}}}Pc&&(Pc=!1,Ff(s));break;case 4:di?(p=Ee,Ee=Rc(s.stateNode.containerInfo),Ua(u,s),Ba(s),Ee=p):(Ua(u,s),Ba(s)),S&4&&nr&&Yf(s.stateNode,s,s.stateNode.pendingChildren);break;case 12:Ua(u,s),Ba(s);break;case 13:Ua(u,s),Ba(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(ho=hi()),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Xf(s,S)));break;case 22:x=s.memoizedState!==null;var et=p!==null&&p.memoizedState!==null,ct=fr,_t=Ln;if(fr=ct||x,Ln=_t||et,Ua(u,s),Ln=_t,fr=ct,Ba(s),S&8192&&(u=s.stateNode,u._visibility=x?u._visibility&-2:u._visibility|1,x&&(p===null||et||fr||Ln||ya(s)),ua)){t:if(p=null,ua)for(u=s;;){if(u.tag===5||di&&u.tag===26){if(p===null){et=p=u;try{H=et.stateNode,x?bc(H):hd(et.stateNode,et.memoizedProps)}catch(Gt){Xe(et,et.return,Gt)}}}else if(u.tag===6){if(p===null){et=u;try{var zt=et.stateNode;x?dd(zt):Zh(zt,et.memoizedProps)}catch(Gt){Xe(et,et.return,Gt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===s)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break t;for(;u.sibling===null;){if(u.return===null||u.return===s)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}S&4&&(S=s.updateQueue,S!==null&&(p=S.retryQueue,p!==null&&(S.retryQueue=null,Xf(s,p))));break;case 19:Ua(u,s),Ba(s),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Xf(s,S)));break;case 30:break;case 21:break;default:Ua(u,s),Ba(s)}}function Ba(s){var u=s.flags;if(u&2){try{if(ua){for(var p,S=s.return;S!==null;){if(Ns(S)){p=S;break}S=S.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:if(Fn){var x=p.stateNode,H=Pl(s);Do(s,H,x);break}case 5:var et=p.stateNode;p.flags&32&&(sr(et),p.flags&=-33);var ct=Pl(s);Do(s,ct,et);break;case 3:case 4:var _t=p.stateNode.containerInfo,zt=Pl(s);Ds(s,zt,_t);break;default:throw Error(r(161))}}}catch(Gt){Xe(s,s.return,Gt)}s.flags&=-3}u&4096&&(s.flags&=-4097)}function Ff(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var u=s;Ff(u),u.tag===5&&u.flags&1024&&Ys(u.stateNode),s=s.sibling}}function Ji(s,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)ec(s,u.alternate,u),u=u.sibling}function ya(s){for(s=s.child;s!==null;){var u=s;switch(u.tag){case 0:case 11:case 14:case 15:_i(4,u,u.return),ya(u);break;case 1:xi(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&qf(u,u.return,p),ya(u);break;case 27:Fn&&Td(u.stateNode);case 26:case 5:xi(u,u.return),ya(u);break;case 22:u.memoizedState===null&&ya(u);break;case 30:ya(u);break;default:ya(u)}s=s.sibling}}function Mi(s,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var S=u.alternate,x=s,H=u,et=H.flags;switch(H.tag){case 0:case 11:case 15:Mi(x,H,p),ma(4,H);break;case 1:if(Mi(x,H,p),S=H,x=S.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(zt){Xe(S,S.return,zt)}if(S=H,x=S.updateQueue,x!==null){var ct=S.stateNode;try{var _t=x.shared.hiddenCallbacks;if(_t!==null)for(x.shared.hiddenCallbacks=null,x=0;x<_t.length;x++)_e(_t[x],ct)}catch(zt){Xe(S,S.return,zt)}}p&&et&64&&kf(H),No(H,H.return);break;case 27:Fn&&es(H);case 26:case 5:Mi(x,H,p),p&&S===null&&et&4&&tc(H),No(H,H.return);break;case 12:Mi(x,H,p);break;case 13:Mi(x,H,p),p&&et&4&&Qf(x,H);break;case 22:H.memoizedState===null&&Mi(x,H,p),No(H,H.return);break;case 30:break;default:Mi(x,H,p)}u=u.sibling}}function Ka(s,u){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(s=u.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&Je(p))}function ns(s,u){s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&Je(s))}function Ei(s,u,p,S){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Gl(s,u,p,S),u=u.sibling}function Gl(s,u,p,S){var x=u.flags;switch(u.tag){case 0:case 11:case 15:Ei(s,u,p,S),x&2048&&ma(9,u);break;case 1:Ei(s,u,p,S);break;case 3:Ei(s,u,p,S),x&2048&&(s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&Je(s)));break;case 12:if(x&2048){Ei(s,u,p,S),s=u.stateNode;try{var H=u.memoizedProps,et=H.id,ct=H.onPostCommit;typeof ct=="function"&&ct(et,u.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(_t){Xe(u,u.return,_t)}}else Ei(s,u,p,S);break;case 13:Ei(s,u,p,S);break;case 23:break;case 22:H=u.stateNode,et=u.alternate,u.memoizedState!==null?H._visibility&2?Ei(s,u,p,S):js(s,u):H._visibility&2?Ei(s,u,p,S):(H._visibility|=2,Tr(s,u,p,S,(u.subtreeFlags&10256)!==0)),x&2048&&Ka(et,u);break;case 24:Ei(s,u,p,S),x&2048&&ns(u.alternate,u);break;default:Ei(s,u,p,S)}}function Tr(s,u,p,S,x){for(x=x&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var H=s,et=u,ct=p,_t=S,zt=et.flags;switch(et.tag){case 0:case 11:case 15:Tr(H,et,ct,_t,x),ma(8,et);break;case 23:break;case 22:var Gt=et.stateNode;et.memoizedState!==null?Gt._visibility&2?Tr(H,et,ct,_t,x):js(H,et):(Gt._visibility|=2,Tr(H,et,ct,_t,x)),x&&zt&2048&&Ka(et.alternate,et);break;case 24:Tr(H,et,ct,_t,x),x&&zt&2048&&ns(et.alternate,et);break;default:Tr(H,et,ct,_t,x)}u=u.sibling}}function js(s,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=s,S=u,x=S.flags;switch(S.tag){case 22:js(p,S),x&2048&&Ka(S.alternate,S);break;case 24:js(p,S),x&2048&&ns(S.alternate,S);break;default:js(p,S)}u=u.sibling}}function oi(s){if(s.subtreeFlags&Be)for(s=s.child;s!==null;)Jf(s),s=s.sibling}function Jf(s){switch(s.tag){case 26:oi(s),s.flags&Be&&(s.memoizedState!==null?tu(Ee,s.memoizedState,s.memoizedProps):vn(s.type,s.memoizedProps));break;case 5:oi(s),s.flags&Be&&vn(s.type,s.memoizedProps);break;case 3:case 4:if(di){var u=Ee;Ee=Rc(s.stateNode.containerInfo),oi(s),Ee=u}else oi(s);break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Be,Be=16777216,oi(s),Be=u):oi(s));break;default:oi(s)}}function Hl(s){var u=s.alternate;if(u!==null&&(s=u.child,s!==null)){u.child=null;do u=s.sibling,s.sibling=null,s=u;while(s!==null)}}function Zi(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];da=S,ac(S,s)}Hl(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Vh(s),s=s.sibling}function Vh(s){switch(s.tag){case 0:case 11:case 15:Zi(s),s.flags&2048&&_i(9,s,s.return);break;case 3:Zi(s);break;case 12:Zi(s);break;case 22:var u=s.stateNode;s.memoizedState!==null&&u._visibility&2&&(s.return===null||s.return.tag!==13)?(u._visibility&=-3,Oa(s)):Zi(s);break;default:Zi(s)}}function Oa(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];da=S,ac(S,s)}Hl(s)}for(s=s.child;s!==null;){switch(u=s,u.tag){case 0:case 11:case 15:_i(8,u,u.return),Oa(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,Oa(u));break;default:Oa(u)}s=s.sibling}}function ac(s,u){for(;da!==null;){var p=da;switch(p.tag){case 0:case 11:case 15:_i(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var S=p.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:Je(p.memoizedState.cache)}if(S=p.child,S!==null)S.return=p,da=S;else t:for(p=s;da!==null;){S=da;var x=S.sibling,H=S.return;if(Kf(S),S===p){da=null;break t}if(x!==null){x.return=H,da=x;break t}da=H}}}function Ni(s){var u=Ci(s);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(r(364));return u}if(s=Ig(s),s===null)throw Error(r(362));return s.stateNode.current}function ic(s,u){var p=s.tag;switch(u.$$typeof){case Ma:if(s.type===u.value)return!0;break;case Gi:t:{for(u=u.value,s=[s,0],p=0;p<s.length;){var S=s[p++],x=S.tag,H=s[p++],et=u[H];if(x!==5&&x!==26&&x!==27||!Ks(S)){for(;et!=null&&ic(S,et);)H++,et=u[H];if(H===u.length){u=!0;break t}else for(S=S.child;S!==null;)s.push(S,H),S=S.sibling}}u=!1}return u;case Gr:if((p===5||p===26||p===27)&&Fh(s.stateNode,u.value))return!0;break;case wi:if((p===5||p===6||p===26||p===27)&&(s=od(s),s!==null&&0<=s.indexOf(u.value)))return!0;break;case Jo:if((p===5||p===26||p===27)&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Uo(s){switch(s.$$typeof){case Ma:return"<"+(C(s.value)||"Unknown")+">";case Gi:return":has("+(Uo(s)||"")+")";case Gr:return'[role="'+s.value+'"]';case wi:return'"'+s.value+'"';case Jo:return'[data-testname="'+s.value+'"]';default:throw Error(r(365))}}function as(s,u){var p=[];s=[s,0];for(var S=0;S<s.length;){var x=s[S++],H=x.tag,et=s[S++],ct=u[et];if(H!==5&&H!==26&&H!==27||!Ks(x)){for(;ct!=null&&ic(x,ct);)et++,ct=u[et];if(et===u.length)p.push(x);else for(x=x.child;x!==null;)s.push(x,et),x=x.sibling}}return p}function Il(s,u){if(!rr)throw Error(r(363));s=Ni(s),s=as(s,u),u=[],s=Array.from(s);for(var p=0;p<s.length;){var S=s[p++],x=S.tag;if(x===5||x===26||x===27)Ks(S)||u.push(S.stateNode);else for(S=S.child;S!==null;)s.push(S),S=S.sibling}return u}function Qa(){if((ze&2)!==0&&Ge!==0)return Ge&-Ge;if(ce.T!==null){var s=ur;return s!==0?s:dt()}return ds()}function rc(){Ta===0&&(Ta=(Ge&536870912)===0||nn?P():536870912);var s=mi.current;return s!==null&&(s.flags|=32),Ta}function Xa(s,u,p){(s===_n&&(We===2||We===9)||s.cancelPendingCommit!==null)&&(Sa(s,0),Di(s,Ge,Ta,!1)),T(s,p),((ze&2)===0||s!==_n)&&(s===_n&&((ze&2)===0&&(Un|=p),jn===4&&Di(s,Ge,Ta,!1)),Te(s))}function li(s,u,p){if((ze&6)!==0)throw Error(r(327));var S=!p&&(u&124)===0&&(u&s.expiredLanes)===0||N(s,u),x=S?Yh(s,u):kl(s,u,!0),H=S;do{if(x===0){Hr&&!S&&Di(s,u,0,!1);break}else{if(p=s.current.alternate,H&&!Bo(p)){x=kl(s,u,!1),H=!1;continue}if(x===2){if(H=u,s.errorRecoveryDisabledLanes&H)var et=0;else et=s.pendingLanes&-536870913,et=et!==0?et:et&536870912?536870912:0;if(et!==0){u=et;t:{var ct=s;x=fo;var _t=zn&&ct.current.memoizedState.isDehydrated;if(_t&&(Sa(ct,et).flags|=256),et=kl(ct,et,!1),et!==2){if(Gc&&!_t){ct.errorRecoveryDisabledLanes|=H,Un|=H,x=4;break t}H=Na,Na=x,H!==null&&(Na===null?Na=H:Na.push.apply(Na,H))}x=et}if(H=!1,x!==2)continue}}if(x===1){Sa(s,0),Di(s,u,0,!0);break}t:{switch(S=s,H=x,H){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:Di(S,u,Ta,!dr);break t;case 2:Na=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(x=ho+300-hi(),10<x)){if(Di(S,u,Ta,!dr),B(S,0,!0)!==0)break t;S.timeoutHandle=Xh(Us.bind(null,S,p,Na,Da,Hc,u,Ta,Un,ti,dr,H,2,-0,0),x);break t}Us(S,p,Na,Da,Hc,u,Ta,Un,ti,dr,H,0,-0,0)}}break}while(!0);Te(s)}function Us(s,u,p,S,x,H,et,ct,_t,zt,Gt,Wt,te,Me){if(s.timeoutHandle=tr,Wt=u.subtreeFlags,(Wt&8192||(Wt&16785408)===16785408)&&(xe(),Jf(u),Wt=aa(),Wt!==null)){s.cancelPendingCommit=Wt(wr.bind(null,s,u,H,p,S,x,et,ct,_t,Gt,1,te,Me)),Di(s,H,et,!zt);return}wr(s,u,H,p,S,x,et,ct,_t)}function Bo(s){for(var u=s;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var S=0;S<p.length;S++){var x=p[S],H=x.getSnapshot;x=x.value;try{if(!Ga(H(),x))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Di(s,u,p,S){u&=~hr,u&=~Un,s.suspendedLanes|=u,s.pingedLanes&=~u,S&&(s.warmLanes|=u),S=s.expirationTimes;for(var x=u;0<x;){var H=31-Pa(x),et=1<<H;S[H]=-1,x&=~et}p!==0&&z(s,p,u)}function zo(){return(ze&6)===0?(lt(0),!1):!0}function Fa(){if(me!==null){if(We===0)var s=me.return;else s=me,Ea=ps=null,yi(s),$a=null,oo=0,s=me;for(;s!==null;)Ih(s.alternate,s),s=s.return;me=null}}function Sa(s,u){var p=s.timeoutHandle;p!==tr&&(s.timeoutHandle=tr,qo(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Fa(),_n=s,me=p=Nn(s.current,null),Ge=u,We=0,Rn=null,dr=!1,Hr=N(s,u),Gc=!1,ti=Ta=hr=Un=ka=jn=0,Na=fo=null,Hc=!1,(u&8)!==0&&(u|=u&32);var S=s.entangledLanes;if(S!==0)for(s=s.entanglements,S&=u;0<S;){var x=31-Pa(S),H=1<<x;u|=s[x],S&=~H}return Ri=u,br(),p}function Ar(s,u){fe=null,ce.H=Ca,u===to||u===eo?(u=Sr(),We=3):u===su?(u=Sr(),We=4):We=u===Bd?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Rn=u,me===null&&(jn=1,Oo(s,F(u,s.current)))}function ji(){var s=mi.current;return s===null?!0:(Ge&4194048)===Ge?Ia===null:(Ge&62914560)===Ge||(Ge&536870912)!==0?s===Ia:!1}function Ui(){var s=ce.H;return ce.H=Ca,s===null?Ca:s}function Wi(){var s=ce.A;return ce.A=yn,s}function sc(){jn=4,dr||(Ge&4194048)!==Ge&&mi.current!==null||(Hr=!0),(ka&134217727)===0&&(Un&134217727)===0||_n===null||Di(_n,Ge,Ta,!1)}function kl(s,u,p){var S=ze;ze|=2;var x=Ui(),H=Wi();(_n!==s||Ge!==u)&&(Da=null,Sa(s,u)),u=!1;var et=jn;t:do try{if(We!==0&&me!==null){var ct=me,_t=Rn;switch(We){case 8:Fa(),et=6;break t;case 3:case 2:case 9:case 6:mi.current===null&&(u=!0);var zt=We;if(We=0,Rn=null,ui(s,ct,_t,zt),p&&Hr){et=0;break t}break;default:zt=We,We=0,Rn=null,ui(s,ct,_t,zt)}}Zf(),et=jn;break}catch(Gt){Ar(s,Gt)}while(!0);return u&&s.shellSuspendCounter++,Ea=ps=null,ze=S,ce.H=x,ce.A=H,me===null&&(_n=null,Ge=0,br()),et}function Zf(){for(;me!==null;)Tn(me)}function Yh(s,u){var p=ze;ze|=2;var S=Ui(),x=Wi();_n!==s||Ge!==u?(Da=null,go=hi()+500,Sa(s,u)):Hr=N(s,u);t:do try{if(We!==0&&me!==null){u=me;var H=Rn;e:switch(We){case 1:We=0,Rn=null,ui(s,u,H,1);break;case 2:case 9:if(Re(H)){We=0,Rn=null,qe(u);break}u=function(){We!==2&&We!==9||_n!==s||(We=7),Te(s)},H.then(u,u);break t;case 3:We=7;break t;case 4:We=5;break t;case 7:Re(H)?(We=0,Rn=null,qe(u)):(We=0,Rn=null,ui(s,u,H,7));break;case 5:var et=null;switch(me.tag){case 26:et=me.memoizedState;case 5:case 27:var ct=me,_t=ct.type,zt=ct.pendingProps;if(et?Cd(et):ir(_t,zt)){We=0,Rn=null;var Gt=ct.sibling;if(Gt!==null)me=Gt;else{var Wt=ct.return;Wt!==null?(me=Wt,za(Wt)):me=null}break e}}We=0,Rn=null,ui(s,u,H,5);break;case 6:We=0,Rn=null,ui(s,u,H,6);break;case 8:Fa(),jn=6;break t;default:throw Error(r(462))}}ba();break}catch(te){Ar(s,te)}while(!0);return Ea=ps=null,ce.H=S,ce.A=x,ze=p,me!==null?0:(_n=null,Ge=0,br(),jn)}function ba(){for(;me!==null&&!Nc();)Tn(me)}function Tn(s){var u=Mo(s.alternate,s,Ri);s.memoizedProps=s.pendingProps,u===null?za(s):me=u}function qe(s){var u=s,p=u.alternate;switch(u.tag){case 15:case 0:u=Ku(p,u,u.pendingProps,u.type,void 0,Ge);break;case 11:u=Ku(p,u,u.pendingProps,u.type.render,u.ref,Ge);break;case 5:yi(u);default:Ih(p,u),u=me=ql(u,Ri),u=Mo(p,u,Ri)}s.memoizedProps=s.pendingProps,u===null?za(s):me=u}function ui(s,u,p,S){Ea=ps=null,yi(u),$a=null,oo=0;var x=u.return;try{if(Pg(s,x,u,p,Ge)){jn=1,Oo(s,F(p,s.current)),me=null;return}}catch(H){if(x!==null)throw me=x,H;jn=1,Oo(s,F(p,s.current)),me=null;return}u.flags&32768?(nn||S===1?s=!0:Hr||(Ge&536870912)!==0?s=!1:(dr=s=!0,(S===2||S===9||S===3||S===6)&&(S=mi.current,S!==null&&S.tag===13&&(S.flags|=16384))),oc(u,s)):za(u)}function za(s){var u=s;do{if((u.flags&32768)!==0){oc(u,dr);return}s=u.return;var p=Gg(u.alternate,u,Ri);if(p!==null){me=p;return}if(u=u.sibling,u!==null){me=u;return}me=u=s}while(u!==null);jn===0&&(jn=5)}function oc(s,u){do{var p=Hg(s.alternate,s);if(p!==null){p.flags&=32767,me=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(s=s.sibling,s!==null)){me=s;return}me=s=p}while(s!==null);jn=6,me=null}function wr(s,u,p,S,x,H,et,ct,_t){s.cancelPendingCommit=null;do zs();while(hn!==0);if((ze&6)!==0)throw Error(r(327));if(u!==null){if(u===s.current)throw Error(r(177));if(H=u.lanes|u.childLanes,H|=Lc,y(s,p,H,et,ct,_t),s===_n&&(me=_n=null,Ge=0),po=u,kr=s,Zo=p,gr=H,Wo=x,Ic=S,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Po(wd,function(){return Lo(),null})):(s.callbackNode=null,s.callbackPriority=0),S=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||S){S=ce.T,ce.T=null,x=ar(),na(2),et=ze,ze|=4;try{jo(s,u,p)}finally{ze=et,na(x),ce.T=S}}hn=1,Wf(),$f(),Bs()}}function Wf(){if(hn===1){hn=0;var s=kr,u=po,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=ce.T,ce.T=null;var S=ar();na(2);var x=ze;ze|=4;try{qh(u,s),Jl(s.containerInfo)}finally{ze=x,na(S),ce.T=p}}s.current=u,hn=2}}function $f(){if(hn===2){hn=0;var s=kr,u=po,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=ce.T,ce.T=null;var S=ar();na(2);var x=ze;ze|=4;try{ec(s,u.alternate,u)}finally{ze=x,na(S),ce.T=p}}hn=3}}function Bs(){if(hn===4||hn===3){hn=0,C0();var s=kr,u=po,p=Zo,S=Ic;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?hn=5:(hn=0,po=kr=null,is(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(Ir=null),K(p),u=u.stateNode,Ja&&typeof Ja.onCommitFiberRoot=="function")try{Ja.onCommitFiberRoot(Ko,u,void 0,(u.current.flags&128)===128)}catch{}if(S!==null){u=ce.T,x=ar(),na(2),ce.T=null;try{for(var H=s.onRecoverableError,et=0;et<S.length;et++){var ct=S[et];H(ct.value,{componentStack:ct.stack})}}finally{ce.T=u,na(x)}}(Zo&3)!==0&&zs(),Te(s),x=s.pendingLanes,(p&4194090)!==0&&(x&42)!==0?s===kc?pr++:(pr=0,kc=s):pr=0,lt(0)}}function is(s,u){(s.pooledCacheLanes&=u)===0&&(u=s.pooledCache,u!=null&&(s.pooledCache=null,Je(u)))}function zs(s){return Wf(),$f(),Bs(),Lo()}function Lo(){if(hn!==5)return!1;var s=kr,u=gr;gr=0;var p=K(Zo),S=32>p?32:p;p=ce.T;var x=ar();try{na(S),ce.T=null,S=Wo,Wo=null;var H=kr,et=Zo;if(hn=0,po=kr=null,Zo=0,(ze&6)!==0)throw Error(r(331));var ct=ze;if(ze|=4,Vh(H.current),Gl(H,H.current,et,S),ze=ct,lt(0,!1),Ja&&typeof Ja.onPostCommitFiberRoot=="function")try{Ja.onPostCommitFiberRoot(Ko,H)}catch{}return!0}finally{na(x),ce.T=p,is(s,u)}}function lc(s,u,p){u=F(p,u),u=Bf(s.stateNode,u,2),s=Qe(s,u,2),s!==null&&(T(s,2),Te(s))}function Xe(s,u,p){if(s.tag===3)lc(s,s,p);else for(;u!==null;){if(u.tag===3){lc(u,s,p);break}else if(u.tag===1){var S=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Ir===null||!Ir.has(S))){s=F(p,s),p=Dh(2),S=Qe(u,p,2),S!==null&&(zf(p,S,u,s),T(S,2),Te(S));break}}u=u.return}}function Bi(s,u,p){var S=s.pingCache;if(S===null){S=s.pingCache=new ys;var x=new Set;S.set(u,x)}else x=S.get(u),x===void 0&&(x=new Set,S.set(u,x));x.has(p)||(Gc=!0,x.add(p),s=rs.bind(null,s,u,p),u.then(s,s))}function rs(s,u,p){var S=s.pingCache;S!==null&&S.delete(u),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,_n===s&&(Ge&p)===p&&(jn===4||jn===3&&(Ge&62914560)===Ge&&300>hi()-ho?(ze&2)===0&&Sa(s,0):hr|=p,ti===Ge&&(ti=0)),Te(s)}function $i(s,u){u===0&&(u=O()),s=Ki(s,u),s!==null&&(T(s,u),Te(s))}function td(s){var u=s.memoizedState,p=0;u!==null&&(p=u.retryLane),$i(s,p)}function ed(s,u){var p=0;switch(s.tag){case 13:var S=s.stateNode,x=s.memoizedState;x!==null&&(p=x.retryLane);break;case 19:S=s.stateNode;break;case 22:S=s.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(u),$i(s,p)}function Po(s,u){return iu(s,u)}function uc(s,u,p,S){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Nn(s,u){var p=s.alternate;return p===null?(p=n(s.tag,u,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=u,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,u=s.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function ql(s,u){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,u=p.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),s}function Vl(s,u,p,S,x,H){var et=0;if(S=s,typeof s=="function")Rr(s)&&(et=1);else if(typeof s=="string")et=di&&Fn?bd(s,p,oa.current)?26:Yo(s)?27:5:di?bd(s,p,oa.current)?26:5:Fn&&Yo(s)?27:5;else t:switch(s){case os:return s=n(31,p,u,x),s.elementType=os,s.lanes=H,s;case Hs:return Ls(p.children,x,H,u);case Is:et=8,x|=24;break;case Yl:return s=n(12,p,u,x|2),s.elementType=Yl,s.lanes=H,s;case Mr:return s=n(13,p,u,x),s.elementType=Mr,s.lanes=H,s;case Nr:return s=n(19,p,u,x),s.elementType=Nr,s.lanes=H,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case hc:case xr:et=10;break t;case Kl:et=9;break t;case gc:et=11;break t;case pc:et=14;break t;case Dr:et=16,S=null;break t}et=29,p=Error(r(130,s===null?"null":typeof s,"")),S=null}return u=n(et,p,u,x),u.elementType=s,u.type=S,u.lanes=H,u}function Ls(s,u,p,S){return s=n(7,s,S,u),s.lanes=p,s}function nd(s,u,p){return s=n(6,s,null,u),s.lanes=p,s}function ad(s,u,p){return u=n(4,s.children!==null?s.children:[],s.key,u),u.lanes=p,u.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},u}function ea(s,u,p,S,x,H,et,ct){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=tr,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=A(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=A(0),this.hiddenUpdates=A(null),this.identifierPrefix=S,this.onUncaughtError=x,this.onCaughtError=H,this.onRecoverableError=et,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ct,this.incompleteTransitions=new Map}function cc(s,u,p,S,x,H,et,ct,_t,zt,Gt,Wt){return s=new ea(s,u,p,et,ct,_t,zt,Wt),u=1,H===!0&&(u|=24),H=n(3,null,null,u),s.current=H,H.stateNode=s,u=Ke(),u.refCount++,s.pooledCache=u,u.refCount++,H.memoizedState={element:S,isDehydrated:p,cache:u},$t(H),s}function Go(s){return s?(s=hs,s):hs}function Ho(s){var u=s._reactInternals;if(u===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(u),s=s!==null?g(s):null,s===null?null:Vs(s.stateNode)}function fc(s,u,p,S,x,H){x=Go(x),S.context===null?S.context=x:S.pendingContext=x,S=It(u),S.payload={element:p},H=H===void 0?null:H,H!==null&&(S.callback=H),p=Qe(s,S,u),p!==null&&(Xa(p,s,u),en(p,s,u))}function Ps(s,u){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<u?p:u}}function ss(s,u){Ps(s,u),(s=s.alternate)&&Ps(s,u)}var ke={},Kh=Ag(),ci=$6(),dc=Object.assign,Gs=Symbol.for("react.element"),Io=Symbol.for("react.transitional.element"),Or=Symbol.for("react.portal"),Hs=Symbol.for("react.fragment"),Is=Symbol.for("react.strict_mode"),Yl=Symbol.for("react.profiler"),hc=Symbol.for("react.provider"),Kl=Symbol.for("react.consumer"),xr=Symbol.for("react.context"),gc=Symbol.for("react.forward_ref"),Mr=Symbol.for("react.suspense"),Nr=Symbol.for("react.suspense_list"),pc=Symbol.for("react.memo"),Dr=Symbol.for("react.lazy"),os=Symbol.for("react.activity"),Ql=Symbol.for("react.memo_cache_sentinel"),Xl=Symbol.iterator,Fl=Symbol.for("react.client.reference"),ks=Array.isArray,ce=Kh.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,qs=t.rendererVersion,Qh=t.rendererPackageName,jr=t.extraDevToolsConfig,Vs=t.getPublicInstance,id=t.getRootHostContext,ls=t.getChildHostContext,us=t.prepareForCommit,Jl=t.resetAfterCommit,rd=t.createInstance;t.cloneMutableInstance;var Zl=t.appendInitialChild,ko=t.finalizeInitialChildren,cs=t.shouldSetTextContent,sd=t.createTextInstance;t.cloneMutableTextInstance;var Xh=t.scheduleTimeout,qo=t.cancelTimeout,tr=t.noTimeout,er=t.isPrimaryRenderer;t.warnsIfNotActing;var ua=t.supportsMutation,nr=t.supportsPersistence,zn=t.supportsHydration,Ci=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var fs=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var na=t.setCurrentUpdatePriority,ar=t.getCurrentUpdatePriority,ds=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var fi=t.shouldAttemptEagerTransition,Qn=t.detachDeletedInstance;t.requestPostPaintCallback;var mc=t.maySuspendCommit,ir=t.preloadInstance,xe=t.startSuspendingCommit,vn=t.suspendInstance;t.suspendOnActiveViewTransition;var aa=t.waitForCommitToBeReady,Ur=t.NotPendingTransition,Ti=t.HostTransitionContext,Ys=t.resetFormInstance;t.bindToConsole;var vc=t.supportsMicrotasks,Wl=t.scheduleMicrotask,rr=t.supportsTestSelectors,Ig=t.findFiberRoot,Vn=t.getBoundingRect,od=t.getTextContent,Ks=t.isHiddenSubtree,Fh=t.matchAccessibilityRole,Jh=t.setFocusIfFocusable,kg=t.setupIntersectionObserver,ld=t.appendChild,ud=t.appendChildToContainer,cd=t.commitTextUpdate,La=t.commitMount,Xn=t.commitUpdate,yc=t.insertBefore,$l=t.insertInContainerBefore,Sc=t.removeChild,fd=t.removeChildFromContainer,sr=t.resetTextContent,bc=t.hideInstance,dd=t.hideTextInstance,hd=t.unhideInstance,Zh=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopGestureTransition,t.getCurrentGestureOffset,t.subscribeToGestureDirection,t.createViewTransitionInstance;var Wh=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var $h=t.cloneInstance,gd=t.createContainerChildSet,pd=t.appendChildToContainerChildSet,t0=t.finalizeContainerChildren,_c=t.replaceContainerChildren,md=t.cloneHiddenInstance,e0=t.cloneHiddenTextInstance,Ec=t.isSuspenseInstancePending,Cc=t.isSuspenseInstanceFallback,n0=t.getSuspenseInstanceFallbackErrorDetails,vd=t.registerSuspenseInstanceRetry,a0=t.canHydrateFormStateMarker,i0=t.isFormStateMarkerMatching,yd=t.getNextHydratableSibling,r0=t.getNextHydratableSiblingAfterSingleton,s0=t.getFirstHydratableChild,qg=t.getFirstHydratableChildWithinContainer,o0=t.getFirstHydratableChildWithinSuspenseInstance,Vo=t.getFirstHydratableChildWithinSingleton,l0=t.canHydrateInstance,Tc=t.canHydrateTextInstance,Ac=t.canHydrateSuspenseInstance,u0=t.hydrateInstance,Sd=t.hydrateTextInstance,Vg=t.hydrateSuspenseInstance,c0=t.getNextHydratableInstanceAfterSuspenseInstance,f0=t.commitHydratedContainer,d0=t.commitHydratedSuspenseInstance,h0=t.clearSuspenseBoundary,g0=t.clearSuspenseBoundaryFromContainer,wc=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var p0=t.validateHydratableInstance,m0=t.validateHydratableTextInstance,di=t.supportsResources,bd=t.isHostHoistableType,Rc=t.getHoistableRoot,v0=t.getResource,Oc=t.acquireResource,_d=t.releaseResource,y0=t.hydrateHoistable,xc=t.mountHoistable,Ed=t.unmountHoistable,S0=t.createHoistableInstance,Yg=t.prepareToCommitHoistables,Kg=t.mayResourceSuspendCommit,Cd=t.preloadResource,tu=t.suspendResource,Fn=t.supportsSingletons,eu=t.resolveSingletonInstance,b0=t.acquireSingletonInstance,Td=t.releaseSingletonInstance,Yo=t.isHostSingletonType,Qs=t.isSingletonScope,nu=[],Xs=-1,hs={},Pa=Math.clz32?Math.clz32:D,_0=Math.log,E0=Math.LN2,or=256,au=4194304,iu=ci.unstable_scheduleCallback,Mc=ci.unstable_cancelCallback,Nc=ci.unstable_shouldYield,C0=ci.unstable_requestPaint,hi=ci.unstable_now,Ad=ci.unstable_ImmediatePriority,T0=ci.unstable_UserBlockingPriority,wd=ci.unstable_NormalPriority,Rd=ci.unstable_IdlePriority,ia=ci.log,_a=ci.unstable_setDisableYieldValue,Ko=null,Ja=null,Dc,Od,Fs=!1,xd=new WeakMap,Br=[],Js=0,jc=null,Zs=0,Za=[],gi=0,gs=null,lr=1,zi="",oa=E(null),Ws=E(null),zr=E(null),Qo=E(null),ca=null,Jn=null,nn=!1,Lr=null,Li=!1,Pi=Error(r(519)),Ga=typeof Object.is=="function"?Object.is:Lt,Uc=E(null),ps=null,Ea=null,Md=typeof AbortController<"u"?AbortController:function(){var s=[],u=this.signal={aborted:!1,addEventListener:function(p,S){s.push(S)}};this.abort=function(){u.aborted=!0,s.forEach(function(p){return p()})}},A0=ci.unstable_scheduleCallback,Bc=ci.unstable_NormalPriority,An={$$typeof:xr,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},bn=null,Xo=null,Nd=!1,ru=!1,$s=!1,pi=0,Fo=null,zc=0,ur=0,Ha=null,Dd=ce.S;ce.S=function(s,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&Yt(s,u),Dd!==null&&Dd(s,u)};var Pr=E(null),w0=Object.prototype.hasOwnProperty,to=Error(r(460)),su=Error(r(474)),eo=Error(r(542)),ou={then:function(){}},Wa=null,cn=[],ms=0,Lc=0,Dn=!1,jd=!1,no=E(null),lu=E(0),fn=0,fe=null,Ve=null,Zn=null,uu=!1,ao=!1,io=!1,ro=0,fa=0,xa=null,R0=0,Ca={readContext:Ot,use:Du,useCallback:ye,useContext:ye,useEffect:ye,useImperativeHandle:ye,useLayoutEffect:ye,useInsertionEffect:ye,useMemo:ye,useReducer:ye,useRef:ye,useState:ye,useDebugValue:ye,useDeferredValue:ye,useTransition:ye,useSyncExternalStore:ye,useId:ye,useHostTransitionStatus:ye,useFormState:ye,useActionState:ye,useOptimistic:ye,useMemoCache:ye,useCacheRefresh:ye},Ud={readContext:Ot,use:Du,useCallback:function(s,u){return sa().memoizedState=[s,u===void 0?null:u],s},useContext:Ot,useEffect:Mf,useImperativeHandle:function(s,u,p){p=p!=null?p.concat([s]):null,_r(4194308,4,Xi.bind(null,u,s),p)},useLayoutEffect:function(s,u){return _r(4194308,4,s,u)},useInsertionEffect:function(s,u){_r(4,2,s,u)},useMemo:function(s,u){var p=sa();u=u===void 0?null:u;var S=s();if(io){Q(!0);try{s()}finally{Q(!1)}}return p.memoizedState=[S,u],S},useReducer:function(s,u,p){var S=sa();if(p!==void 0){var x=p(u);if(io){Q(!0);try{p(u)}finally{Q(!1)}}}else x=u;return S.memoizedState=S.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},S.queue=s,s=s.dispatch=Rl.bind(null,fe,s),[S.memoizedState,s]},useRef:function(s){var u=sa();return s={current:s},u.memoizedState=s},useState:function(s){s=Cl(s);var u=s.queue,p=wh.bind(null,fe,u);return u.dispatch=p,[s.memoizedState,p]},useDebugValue:Os,useDeferredValue:function(s,u){var p=sa();return Ro(p,s,u)},useTransition:function(){var s=Cl(!1);return s=Al.bind(null,fe,s.queue,!0,!1),sa().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,u,p){var S=fe,x=sa();if(nn){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),_n===null)throw Error(r(349));(Ge&124)!==0||Uu(S,u,p)}x.memoizedState=p;var H={value:p,getSnapshot:u};return x.queue=H,Mf(El.bind(null,S,H,s),[s]),S.flags|=2048,Ya(9,Ao(),Cf.bind(null,S,H,p,u),null),p},useId:function(){var s=sa(),u=_n.identifierPrefix;if(nn){var p=zi,S=lr;p=(S&~(1<<32-Pa(S)-1)).toString(32)+p,u=""+u+"R"+p,p=ro++,0<p&&(u+="H"+p.toString(32)),u+=""}else p=R0++,u=""+u+"r"+p.toString(32)+"";return s.memoizedState=u},useHostTransitionStatus:Hu,useFormState:xf,useActionState:xf,useOptimistic:function(s){var u=sa();u.memoizedState=u.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=Ol.bind(null,fe,!0,p),p.dispatch=u,[s,u]},useMemoCache:To,useCacheRefresh:function(){return sa().memoizedState=Iu.bind(null,fe)}},cr={readContext:Ot,use:Du,useCallback:Er,useContext:Ot,useEffect:Lu,useImperativeHandle:Pu,useInsertionEffect:Nf,useLayoutEffect:wo,useMemo:Gu,useReducer:bi,useRef:zu,useState:function(){return bi(Si)},useDebugValue:Os,useDeferredValue:function(s,u){var p=ta();return Df(p,Ve.memoizedState,s,u)},useTransition:function(){var s=bi(Si)[0],u=ta().memoizedState;return[typeof s=="boolean"?s:Co(s),u]},useSyncExternalStore:Eh,useId:ja,useHostTransitionStatus:Hu,useFormState:Bu,useActionState:Bu,useOptimistic:function(s,u){var p=ta();return Tf(p,Ve,s,u)},useMemoCache:To,useCacheRefresh:Jr},so={readContext:Ot,use:Du,useCallback:Er,useContext:Ot,useEffect:Lu,useImperativeHandle:Pu,useInsertionEffect:Nf,useLayoutEffect:wo,useMemo:Gu,useReducer:ju,useRef:zu,useState:function(){return ju(Si)},useDebugValue:Os,useDeferredValue:function(s,u){var p=ta();return Ve===null?Ro(p,s,u):Df(p,Ve.memoizedState,s,u)},useTransition:function(){var s=ju(Si)[0],u=ta().memoizedState;return[typeof s=="boolean"?s:Co(s),u]},useSyncExternalStore:Eh,useId:ja,useHostTransitionStatus:Hu,useFormState:Tl,useActionState:Tl,useOptimistic:function(s,u){var p=ta();return Ve!==null?Tf(p,Ve,s,u):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:To,useCacheRefresh:Jr},$a=null,oo=0,vs=Rh(!0),Ai=Rh(!1),mi=E(null),Ia=null,kn=E(0),lo={enqueueSetState:function(s,u,p){s=s._reactInternals;var S=Qa(),x=It(S);x.payload=u,p!=null&&(x.callback=p),u=Qe(s,x,S),u!==null&&(Xa(u,s,S),en(u,s,S))},enqueueReplaceState:function(s,u,p){s=s._reactInternals;var S=Qa(),x=It(S);x.tag=1,x.payload=u,p!=null&&(x.callback=p),u=Qe(s,x,S),u!==null&&(Xa(u,s,S),en(u,s,S))},enqueueForceUpdate:function(s,u){s=s._reactInternals;var p=Qa(),S=It(p);S.tag=2,u!=null&&(S.callback=u),u=Qe(s,S,p),u!==null&&(Xa(u,s,p),en(u,s,p))}},uo=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Bd=Error(r(461)),la=!1,co={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},fr=!1,Ln=!1,Pc=!1,O0=typeof WeakSet=="function"?WeakSet:Set,da=null,de=null,Le=!1,Ee=null,Be=8192,yn={getCacheForType:function(s){var u=Ot(An),p=u.data.get(s);return p===void 0&&(p=s(),u.data.set(s,p)),p}},Ma=0,Gi=1,Gr=2,Jo=3,wi=4;if(typeof Symbol=="function"&&Symbol.for){var wn=Symbol.for;Ma=wn("selector.component"),Gi=wn("selector.has_pseudo_class"),Gr=wn("selector.role"),Jo=wn("selector.test_id"),wi=wn("selector.text")}var ys=typeof WeakMap=="function"?WeakMap:Map,ze=0,_n=null,me=null,Ge=0,We=0,Rn=null,dr=!1,Hr=!1,Gc=!1,Ri=0,jn=0,ka=0,Un=0,hr=0,Ta=0,ti=0,fo=null,Na=null,Hc=!1,ho=0,go=1/0,Da=null,Ir=null,hn=0,kr=null,po=null,Zo=0,gr=0,Wo=null,Ic=null,pr=0,kc=null;return ke.attemptContinuousHydration=function(s){if(s.tag===13){var u=Ki(s,67108864);u!==null&&Xa(u,s,67108864),ss(s,67108864)}},ke.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var u=Qa();u=G(u);var p=Ki(s,u);p!==null&&Xa(p,s,u),ss(s,u)}},ke.attemptSynchronousHydration=function(s){switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var u=L(s.pendingLanes);if(u!==0){for(s.pendingLanes|=2,s.entangledLanes|=2;u;){var p=1<<31-Pa(u);s.entanglements[1]|=p,u&=~p}Te(s),(ze&6)===0&&(go=hi()+500,lt(0))}}break;case 13:u=Ki(s,2),u!==null&&Xa(u,s,2),zo(),ss(s,2)}},ke.batchedUpdates=function(s,u){return s(u)},ke.createComponentSelector=function(s){return{$$typeof:Ma,value:s}},ke.createContainer=function(s,u,p,S,x,H,et,ct,_t,zt){return cc(s,u,!1,null,p,S,H,et,ct,_t,zt,null)},ke.createHasPseudoClassSelector=function(s){return{$$typeof:Gi,value:s}},ke.createHydrationContainer=function(s,u,p,S,x,H,et,ct,_t,zt,Gt,Wt,te){return s=cc(p,S,!0,s,x,H,ct,_t,zt,Gt,Wt,te),s.context=Go(null),p=s.current,S=Qa(),S=G(S),x=It(S),x.callback=u??null,Qe(p,x,S),u=S,s.current.lanes=u,T(s,u),Te(s),s},ke.createPortal=function(s,u,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Or,key:S==null?null:""+S,children:s,containerInfo:u,implementation:p}},ke.createRoleSelector=function(s){return{$$typeof:Gr,value:s}},ke.createTestNameSelector=function(s){return{$$typeof:Jo,value:s}},ke.createTextSelector=function(s){return{$$typeof:wi,value:s}},ke.defaultOnCaughtError=function(s){console.error(s)},ke.defaultOnRecoverableError=function(s){uo(s)},ke.defaultOnUncaughtError=function(s){uo(s)},ke.deferredUpdates=function(s){var u=ce.T,p=ar();try{return na(32),ce.T=null,s()}finally{na(p),ce.T=u}},ke.discreteUpdates=function(s,u,p,S,x){var H=ce.T,et=ar();try{return na(2),ce.T=null,s(u,p,S,x)}finally{na(et),ce.T=H,ze===0&&(go=hi()+500)}},ke.findAllNodes=Il,ke.findBoundingRects=function(s,u){if(!rr)throw Error(r(363));u=Il(s,u),s=[];for(var p=0;p<u.length;p++)s.push(Vn(u[p]));for(u=s.length-1;0<u;u--){p=s[u];for(var S=p.x,x=S+p.width,H=p.y,et=H+p.height,ct=u-1;0<=ct;ct--)if(u!==ct){var _t=s[ct],zt=_t.x,Gt=zt+_t.width,Wt=_t.y,te=Wt+_t.height;if(S>=zt&&H>=Wt&&x<=Gt&&et<=te){s.splice(u,1);break}else if(S!==zt||p.width!==_t.width||te<H||Wt>et){if(!(H!==Wt||p.height!==_t.height||Gt<S||zt>x)){zt>S&&(_t.width+=zt-S,_t.x=S),Gt<x&&(_t.width=x-zt),s.splice(u,1);break}}else{Wt>H&&(_t.height+=Wt-H,_t.y=H),te<et&&(_t.height=et-Wt),s.splice(u,1);break}}}return s},ke.findHostInstance=Ho,ke.findHostInstanceWithNoPortals=function(s){return s=d(s),s=s!==null?m(s):null,s===null?null:Vs(s.stateNode)},ke.findHostInstanceWithWarning=function(s){return Ho(s)},ke.flushPassiveEffects=zs,ke.flushSyncFromReconciler=function(s){var u=ze;ze|=1;var p=ce.T,S=ar();try{if(na(2),ce.T=null,s)return s()}finally{na(S),ce.T=p,ze=u,(ze&6)===0&&lt(0)}},ke.flushSyncWork=zo,ke.focusWithin=function(s,u){if(!rr)throw Error(r(363));for(s=Ni(s),u=as(s,u),u=Array.from(u),s=0;s<u.length;){var p=u[s++],S=p.tag;if(!Ks(p)){if((S===5||S===26||S===27)&&Jh(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},ke.getFindAllNodesFailureDescription=function(s,u){if(!rr)throw Error(r(363));var p=0,S=[];s=[Ni(s),0];for(var x=0;x<s.length;){var H=s[x++],et=H.tag,ct=s[x++],_t=u[ct];if((et!==5&&et!==26&&et!==27||!Ks(H))&&(ic(H,_t)&&(S.push(Uo(_t)),ct++,ct>p&&(p=ct)),ct<u.length))for(H=H.child;H!==null;)s.push(H,ct),H=H.sibling}if(p<u.length){for(s=[];p<u.length;p++)s.push(Uo(u[p]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},ke.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 27:case 5:return Vs(s.child.stateNode);default:return s.child.stateNode}},ke.injectIntoDevTools=function(){var s={bundleType:0,version:qs,rendererPackageName:Qh,currentDispatcherRef:ce,reconcilerVersion:"19.1.0"};if(jr!==null&&(s.rendererConfig=jr),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)s=!0;else{try{Ko=u.inject(s),Ja=u}catch{}s=!!u.checkDCE}}return s},ke.isAlreadyRendering=function(){return(ze&6)!==0},ke.observeVisibleRects=function(s,u,p,S){if(!rr)throw Error(r(363));s=Il(s,u);var x=kg(s,p,S).disconnect;return{disconnect:function(){x()}}},ke.shouldError=function(){return null},ke.shouldSuspend=function(){return!1},ke.startHostTransition=function(s,u,p,S){if(s.tag!==5)throw Error(r(476));var x=wl(s).queue;Al(s,x,u,Ur,p===null?a:function(){var H=wl(s).next.queue;return xs(s,H,{},Qa()),p(S)})},ke.updateContainer=function(s,u,p,S){var x=u.current,H=Qa();return fc(x,H,s,u,p,S),H},ke.updateContainerSync=function(s,u,p,S){return fc(u.current,2,s,u,p,S),2},ke},o.exports.default=o.exports,Object.defineProperty(o.exports,"__esModule",{value:!0})})(zp)),zp.exports}var a1;function e8(){return a1||(a1=1,Bp.exports=t8()),Bp.exports}var n8=e8();const a8=pf(n8);var Gp={exports:{}},vo={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function i8(){return i1||(i1=1,vo.ConcurrentRoot=1,vo.ContinuousEventPriority=8,vo.DefaultEventPriority=32,vo.DiscreteEventPriority=2,vo.IdleEventPriority=268435456,vo.LegacyRoot=0,vo.NoEventPriority=0),vo}var r1;function r8(){return r1||(r1=1,Gp.exports=i8()),Gp.exports}var Dg=r8();const s1={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let o1=!1,l1=!1;const Sg=".react-konva-event",s8=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,o8=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,l8={};function jg(o,t,n=l8){if(!o1&&"zIndex"in t&&(console.warn(o8),o1=!0),!l1&&t.draggable){var a=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;a&&!r&&(console.warn(s8),l1=!0)}for(var l in n)if(!s1[l]){var f=l.slice(0,2)==="on",d=n[l]!==t[l];if(f&&d){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),o.off(g,n[l])}var m=!t.hasOwnProperty(l);m&&o.setAttr(l,void 0)}var _=t._useStrictMode,C={},E=!1;const R={};for(var l in t)if(!s1[l]){var f=l.slice(0,2)==="on",v=n[l]!==t[l];if(f&&v){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),t[l]&&(R[g]=t[l])}!f&&(t[l]!==n[l]||_&&t[l]!==o.getAttr(l))&&(E=!0,C[l]=t[l])}E&&(o.setAttrs(C),bl(o));for(var g in R)o.off(g+Sg),o.on(g+Sg,R[g])}function bl(o){if(!Jt.autoDrawEnabled){var t=o.getLayer()||o.getStage();t&&t.batchDraw()}}var Hp={exports:{}},Ip={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1;function u8(){return u1||(u1=1,(function(o){function t(j,I){var F=j.length;j.push(I);t:for(;0<F;){var W=F-1>>>1,it=j[W];if(0<r(it,I))j[W]=I,j[F]=it,F=W;else break t}}function n(j){return j.length===0?null:j[0]}function a(j){if(j.length===0)return null;var I=j[0],F=j.pop();if(F!==I){j[0]=F;t:for(var W=0,it=j.length,Z=it>>>1;W<Z;){var at=2*(W+1)-1,rt=j[at],V=at+1,J=j[V];if(0>r(rt,F))V<it&&0>r(J,rt)?(j[W]=J,j[V]=F,W=V):(j[W]=rt,j[at]=F,W=at);else if(V<it&&0>r(J,F))j[W]=J,j[V]=F,W=V;else break t}}return I}function r(j,I){var F=j.sortIndex-I.sortIndex;return F!==0?F:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,L=!1,B=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function P(j){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=j)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(j){if(D=!1,P(j),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-j)}}var A=!1,T=-1,y=5,z=-1;function U(){return L?!0:!(o.unstable_now()-z<y)}function G(){if(L=!1,A){var j=o.unstable_now();z=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(T),T=-1),R=!0;var F=E;try{e:{for(P(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=j);if(j=o.unstable_now(),typeof it=="function"){C.callback=it,P(j),I=!0;break e}C===n(g)&&a(g),P(j)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-j),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(G)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=G,K=function(){X.postMessage(null)}}else K=function(){B(G,0)};function Y(j,I){T=B(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return j()}finally{E=F}},o.unstable_requestPaint=function(){L=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var F=E;E=j;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(j,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,j){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,j={id:_++,callback:I,priorityLevel:j,startTime:F,expirationTime:it,sortIndex:-1},F>W?(j.sortIndex=F,t(m,j),n(g)===null&&j===n(m)&&(D?(N(T),T=-1):D=!0,Y(O,F-W))):(j.sortIndex=it,t(g,j),v||R||(v=!0,A||(A=!0,K()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var F=E;E=I;try{return j.apply(this,arguments)}finally{E=F}}}})(Ip)),Ip}var c1;function c8(){return c1||(c1=1,Hp.exports=u8()),Hp.exports}var kp=c8();const pS={},f8={};df.Node.prototype._applyProps=jg;let mS=Dg.DefaultEventPriority;function d8(o,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}o.add(t),bl(o)}function h8(o,t,n){let a=df[o];a||(console.error(`Konva has no node with the type ${o}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${o}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),a=df.Group);const r={},l={};for(var f in t)if(f!=="ref"){var d=f.slice(0,2)==="on";d?l[f]=t[f]:r[f]=t[f]}const g=new a(r);return jg(g,l),g}function g8(o,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${o}"`)}function p8(o,t,n){return!1}function m8(o){return o}function v8(){return null}function y8(){return null}function S8(o,t,n,a){return f8}function b8(){}function _8(o){}function E8(o,t){return!1}function C8(){return pS}function T8(){return pS}const A8=setTimeout,w8=clearTimeout,R8=!0,O8=o=>{o()},x8=-1;function M8(o,t){return!1}const N8=!1,D8=!1,j8=!0,U8=!1,B8=!1;function z8(o,t){t.parent===o?t.moveToTop():o.add(t),bl(o)}function L8(o,t){t.parent===o?t.moveToTop():o.add(t),bl(o)}function vS(o,t,n){t._remove(),o.add(t),t.setZIndex(n.getZIndex()),bl(o)}function P8(o,t,n){vS(o,t,n)}function G8(o,t){t.destroy(),t.off(Sg),bl(o)}function H8(o,t){t.destroy(),t.off(Sg),bl(o)}function I8(o,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function k8(o,t,n){}function q8(o,t,n,a){jg(o,a,n)}function V8(o){o.hide(),bl(o)}function Y8(o){}function K8(o,t){(t.visible==null||t.visible)&&o.show()}function Q8(o,t){}function X8(o){}function F8(){}function J8(){return Dg.DefaultEventPriority}function Z8(){}function W8(){return null}function $8(o){mS=o}function t_(){return mS}function e_(){return Dg.DiscreteEventPriority}function n_(){return!1}function a_(){}function i_(){return!1}function r_(){return!0}function s_(){}function o_(){}function l_(){return null}const u_=null;function c_(){}const f_=Object.freeze(Object.defineProperty({__proto__:null,NotPendingTransition:u_,appendChild:z8,appendChildToContainer:L8,appendInitialChild:d8,cancelTimeout:w8,clearContainer:X8,commitMount:k8,commitTextUpdate:I8,commitUpdate:q8,createInstance:h8,createTextInstance:g8,detachDeletedInstance:F8,finalizeInitialChildren:p8,getChildHostContext:T8,getCurrentEventPriority:J8,getCurrentUpdatePriority:t_,getInstanceFromScope:W8,getPublicInstance:m8,getRootHostContext:C8,hideInstance:V8,hideTextInstance:Y8,idlePriority:kp.unstable_IdlePriority,insertBefore:vS,insertInContainerBefore:P8,isPrimaryRenderer:N8,maySuspendCommit:i_,noTimeout:x8,now:kp.unstable_now,preloadInstance:r_,prepareForCommit:v8,preparePortalMount:y8,prepareScopeUpdate:Z8,prepareUpdate:S8,removeChild:G8,removeChildFromContainer:H8,requestPostPaintCallback:a_,resetAfterCommit:b8,resetFormInstance:c_,resetTextContent:_8,resolveUpdatePriority:e_,run:kp.unstable_runWithPriority,scheduleMicrotask:O8,scheduleTimeout:A8,setCurrentUpdatePriority:$8,shouldAttemptEagerTransition:n_,shouldDeprioritizeSubtree:E8,shouldSetTextContent:M8,startSuspendingCommit:s_,supportsHydration:B8,supportsMicrotasks:R8,supportsMutation:j8,supportsPersistence:U8,suspendInstance:o_,unhideInstance:K8,unhideTextInstance:Q8,waitForCommitToBeReady:l_,warnsIfNotActing:D8},Symbol.toStringTag,{value:"Module"}));function yS(o,t,n){if(!o)return;if(n(o)===!0)return o;let a=o.child;for(;a;){const r=yS(a,t,n);if(r)return r;a=a.sibling}}function SS(o){try{return Object.defineProperties(o,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return o}}const rv=SS(st.createContext(null));class bS extends st.Component{render(){return st.createElement(rv.Provider,{value:this._reactInternals},this.props.children)}}function d_(){const o=st.useContext(rv);if(o===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=st.useId();return st.useMemo(()=>{for(const n of[o,o==null?void 0:o.alternate]){if(!n)continue;const a=yS(n,!1,r=>{let l=r.memoizedState;for(;l;){if(l.memoizedState===t)return!0;l=l.next}});if(a)return a}},[o,t])}const h_=Symbol.for("react.context"),g_=o=>o!==null&&typeof o=="object"&&"$$typeof"in o&&o.$$typeof===h_;function p_(){const o=d_(),[t]=st.useState(()=>new Map);t.clear();let n=o;for(;n;){const a=n.type;g_(a)&&a!==rv&&!t.has(a)&&t.set(a,st.use(SS(a))),n=n.return}return t}function m_(){const o=p_();return st.useMemo(()=>Array.from(o.keys()).reduce((t,n)=>a=>st.createElement(t,null,st.createElement(n.Provider,{...a,value:o.get(n)})),t=>st.createElement(bS,{...t})),[o])}if(ra.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function v_(o){const t=ra.useRef({});return ra.useLayoutEffect(()=>{t.current=o}),ra.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const y_=()=>{const o=ra.useRef(0);return ra.useMemo(()=>{o.current++},[]),o.current>1},S_=o=>{const t=ra.useRef(null),n=ra.useRef(null),a=ra.useRef(null),r=v_(o),l=m_(),f=ra.useRef(!1),d=m=>{const{forwardedRef:_}=o;_&&(typeof _=="function"?_(m):_.current=m)},g=y_();return ra.useLayoutEffect(()=>f.current&&g?()=>{f.current=!1,d(null),sf.updateContainer(null,a.current,null),n.current.destroy()}:(f.current=!0,n.current=new df.Stage({width:o.width,height:o.height,container:t.current}),d(n.current),a.current=sf.createContainer(n.current,Dg.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),sf.updateContainer(ra.createElement(l,{},o.children),a.current,null,()=>{}),()=>{g||(d(null),sf.updateContainer(null,a.current,null),n.current.destroy())}),[]),ra.useLayoutEffect(()=>{d(n.current),jg(n.current,o,r),sf.updateContainer(ra.createElement(l,{},o.children),a.current,null)}),ra.createElement("div",{ref:t,id:o.id,accessKey:o.accessKey,className:o.className,role:o.role,style:o.style,tabIndex:o.tabIndex,title:o.title})},Kr="Layer",pl="Line",sv="Image",sf=a8(f_);sf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:ra.version,rendererPackageName:"react-konva"});const Ug=ra.forwardRef((o,t)=>ra.createElement(bS,{},ra.createElement(S_,{...o,forwardedRef:t})));var qp={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var f1;function _S(){return f1||(f1=1,(function(o,t){(function(a,r){o.exports=r()})(window,function(){return(function(n){var a={};function r(l){if(a[l])return a[l].exports;var f=a[l]={i:l,l:!1,exports:{}};return n[l].call(f.exports,f,f.exports,r),f.l=!0,f.exports}return r.m=n,r.c=a,r.d=function(l,f,d){r.o(l,f)||Object.defineProperty(l,f,{enumerable:!0,get:d})},r.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},r.t=function(l,f){if(f&1&&(l=r(l)),f&8||f&4&&typeof l=="object"&&l&&l.__esModule)return l;var d=Object.create(null);if(r.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:l}),f&2&&typeof l!="string")for(var g in l)r.d(d,g,(function(m){return l[m]}).bind(null,g));return d},r.n=function(l){var f=l&&l.__esModule?function(){return l.default}:function(){return l};return r.d(f,"a",f),f},r.o=function(l,f){return Object.prototype.hasOwnProperty.call(l,f)},r.p="",r(r.s=42)})([(function(n,a,r){r.r(a),r.d(a,"__extends",function(){return f}),r.d(a,"__assign",function(){return d}),r.d(a,"__rest",function(){return g}),r.d(a,"__decorate",function(){return m}),r.d(a,"__param",function(){return _}),r.d(a,"__metadata",function(){return C}),r.d(a,"__awaiter",function(){return E}),r.d(a,"__generator",function(){return R}),r.d(a,"__createBinding",function(){return v}),r.d(a,"__exportStar",function(){return D}),r.d(a,"__values",function(){return L}),r.d(a,"__read",function(){return B}),r.d(a,"__spread",function(){return N}),r.d(a,"__spreadArrays",function(){return M}),r.d(a,"__spreadArray",function(){return P}),r.d(a,"__await",function(){return O}),r.d(a,"__asyncGenerator",function(){return A}),r.d(a,"__asyncDelegator",function(){return T}),r.d(a,"__asyncValues",function(){return y}),r.d(a,"__makeTemplateObject",function(){return z}),r.d(a,"__importStar",function(){return G}),r.d(a,"__importDefault",function(){return K}),r.d(a,"__classPrivateFieldGet",function(){return Q}),r.d(a,"__classPrivateFieldSet",function(){return X});/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */var l=function(Y,j){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var W in F)Object.prototype.hasOwnProperty.call(F,W)&&(I[W]=F[W])},l(Y,j)};function f(Y,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");l(Y,j);function I(){this.constructor=Y}Y.prototype=j===null?Object.create(j):(I.prototype=j.prototype,new I)}var d=function(){return d=Object.assign||function(j){for(var I,F=1,W=arguments.length;F<W;F++){I=arguments[F];for(var it in I)Object.prototype.hasOwnProperty.call(I,it)&&(j[it]=I[it])}return j},d.apply(this,arguments)};function g(Y,j){var I={};for(var F in Y)Object.prototype.hasOwnProperty.call(Y,F)&&j.indexOf(F)<0&&(I[F]=Y[F]);if(Y!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,F=Object.getOwnPropertySymbols(Y);W<F.length;W++)j.indexOf(F[W])<0&&Object.prototype.propertyIsEnumerable.call(Y,F[W])&&(I[F[W]]=Y[F[W]]);return I}function m(Y,j,I,F){var W=arguments.length,it=W<3?j:F===null?F=Object.getOwnPropertyDescriptor(j,I):F,Z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")it=Reflect.decorate(Y,j,I,F);else for(var at=Y.length-1;at>=0;at--)(Z=Y[at])&&(it=(W<3?Z(it):W>3?Z(j,I,it):Z(j,I))||it);return W>3&&it&&Object.defineProperty(j,I,it),it}function _(Y,j){return function(I,F){j(I,F,Y)}}function C(Y,j){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Y,j)}function E(Y,j,I,F){function W(it){return it instanceof I?it:new I(function(Z){Z(it)})}return new(I||(I=Promise))(function(it,Z){function at(J){try{V(F.next(J))}catch(tt){Z(tt)}}function rt(J){try{V(F.throw(J))}catch(tt){Z(tt)}}function V(J){J.done?it(J.value):W(J.value).then(at,rt)}V((F=F.apply(Y,j||[])).next())})}function R(Y,j){var I={label:0,sent:function(){if(it[0]&1)throw it[1];return it[1]},trys:[],ops:[]},F,W,it,Z;return Z={next:at(0),throw:at(1),return:at(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function at(V){return function(J){return rt([V,J])}}function rt(V){if(F)throw new TypeError("Generator is already executing.");for(;I;)try{if(F=1,W&&(it=V[0]&2?W.return:V[0]?W.throw||((it=W.return)&&it.call(W),0):W.next)&&!(it=it.call(W,V[1])).done)return it;switch(W=0,it&&(V=[V[0]&2,it.value]),V[0]){case 0:case 1:it=V;break;case 4:return I.label++,{value:V[1],done:!1};case 5:I.label++,W=V[1],V=[0];continue;case 7:V=I.ops.pop(),I.trys.pop();continue;default:if(it=I.trys,!(it=it.length>0&&it[it.length-1])&&(V[0]===6||V[0]===2)){I=0;continue}if(V[0]===3&&(!it||V[1]>it[0]&&V[1]<it[3])){I.label=V[1];break}if(V[0]===6&&I.label<it[1]){I.label=it[1],it=V;break}if(it&&I.label<it[2]){I.label=it[2],I.ops.push(V);break}it[2]&&I.ops.pop(),I.trys.pop();continue}V=j.call(Y,I)}catch(J){V=[6,J],W=0}finally{F=it=0}if(V[0]&5)throw V[1];return{value:V[0]?V[1]:void 0,done:!0}}}var v=Object.create?(function(Y,j,I,F){F===void 0&&(F=I),Object.defineProperty(Y,F,{enumerable:!0,get:function(){return j[I]}})}):(function(Y,j,I,F){F===void 0&&(F=I),Y[F]=j[I]});function D(Y,j){for(var I in Y)I!=="default"&&!Object.prototype.hasOwnProperty.call(j,I)&&v(j,Y,I)}function L(Y){var j=typeof Symbol=="function"&&Symbol.iterator,I=j&&Y[j],F=0;if(I)return I.call(Y);if(Y&&typeof Y.length=="number")return{next:function(){return Y&&F>=Y.length&&(Y=void 0),{value:Y&&Y[F++],done:!Y}}};throw new TypeError(j?"Object is not iterable.":"Symbol.iterator is not defined.")}function B(Y,j){var I=typeof Symbol=="function"&&Y[Symbol.iterator];if(!I)return Y;var F=I.call(Y),W,it=[],Z;try{for(;(j===void 0||j-- >0)&&!(W=F.next()).done;)it.push(W.value)}catch(at){Z={error:at}}finally{try{W&&!W.done&&(I=F.return)&&I.call(F)}finally{if(Z)throw Z.error}}return it}function N(){for(var Y=[],j=0;j<arguments.length;j++)Y=Y.concat(B(arguments[j]));return Y}function M(){for(var Y=0,j=0,I=arguments.length;j<I;j++)Y+=arguments[j].length;for(var F=Array(Y),W=0,j=0;j<I;j++)for(var it=arguments[j],Z=0,at=it.length;Z<at;Z++,W++)F[W]=it[Z];return F}function P(Y,j,I){if(I||arguments.length===2)for(var F=0,W=j.length,it;F<W;F++)(it||!(F in j))&&(it||(it=Array.prototype.slice.call(j,0,F)),it[F]=j[F]);return Y.concat(it||Array.prototype.slice.call(j))}function O(Y){return this instanceof O?(this.v=Y,this):new O(Y)}function A(Y,j,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var F=I.apply(Y,j||[]),W,it=[];return W={},Z("next"),Z("throw"),Z("return"),W[Symbol.asyncIterator]=function(){return this},W;function Z(nt){F[nt]&&(W[nt]=function(ht){return new Promise(function(wt,jt){it.push([nt,ht,wt,jt])>1||at(nt,ht)})})}function at(nt,ht){try{rt(F[nt](ht))}catch(wt){tt(it[0][3],wt)}}function rt(nt){nt.value instanceof O?Promise.resolve(nt.value.v).then(V,J):tt(it[0][2],nt)}function V(nt){at("next",nt)}function J(nt){at("throw",nt)}function tt(nt,ht){nt(ht),it.shift(),it.length&&at(it[0][0],it[0][1])}}function T(Y){var j,I;return j={},F("next"),F("throw",function(W){throw W}),F("return"),j[Symbol.iterator]=function(){return this},j;function F(W,it){j[W]=Y[W]?function(Z){return(I=!I)?{value:O(Y[W](Z)),done:W==="return"}:it?it(Z):Z}:it}}function y(Y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var j=Y[Symbol.asyncIterator],I;return j?j.call(Y):(Y=typeof L=="function"?L(Y):Y[Symbol.iterator](),I={},F("next"),F("throw"),F("return"),I[Symbol.asyncIterator]=function(){return this},I);function F(it){I[it]=Y[it]&&function(Z){return new Promise(function(at,rt){Z=Y[it](Z),W(at,rt,Z.done,Z.value)})}}function W(it,Z,at,rt){Promise.resolve(rt).then(function(V){it({value:V,done:at})},Z)}}function z(Y,j){return Object.defineProperty?Object.defineProperty(Y,"raw",{value:j}):Y.raw=j,Y}var U=Object.create?(function(Y,j){Object.defineProperty(Y,"default",{enumerable:!0,value:j})}):function(Y,j){Y.default=j};function G(Y){if(Y&&Y.__esModule)return Y;var j={};if(Y!=null)for(var I in Y)I!=="default"&&Object.prototype.hasOwnProperty.call(Y,I)&&v(j,Y,I);return U(j,Y),j}function K(Y){return Y&&Y.__esModule?Y:{default:Y}}function Q(Y,j,I,F){if(I==="a"&&!F)throw new TypeError("Private accessor was defined without a getter");if(typeof j=="function"?Y!==j||!F:!j.has(Y))throw new TypeError("Cannot read private member from an object whose class did not declare it");return I==="m"?F:I==="a"?F.call(Y):F?F.value:j.get(Y)}function X(Y,j,I,F,W){if(F==="m")throw new TypeError("Private method is not writable");if(F==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof j=="function"?Y!==j||!W:!j.has(Y))throw new TypeError("Cannot write private member to an object whose class did not declare it");return F==="a"?W.call(Y,I):W?W.value=I:j.set(Y,I),I}}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0}),a.allToUpperCase=a.allToLowerCase=a.encodeBody=a.decodeBody=a.Format=a.promisify=a.trim=a.arrChooseN=a.randomHexString=a.randomString=a.cheapRandStr=a.dataSizeBytes=a.inspectBody=a.inspectError=a.isErrorInfoOrPartialErrorInfo=a.now=a.parseQueryString=a.toQueryString=a.arrPopRandomElement=a.defaultPostHeaders=a.defaultGetHeaders=a.allSame=a.arrEvery=a.arrFilter=a.arrMap=a.safeArrForEach=a.arrForEach=a.forInOwnNonNullProperties=a.valuesArray=a.keysArray=a.arrWithoutValue=a.arrDeleteValue=a.arrIn=a.arrIndexOf=a.arrSubtract=a.arrIntersectOb=a.arrIntersect=a.intersect=a.containsValue=a.inherits=a.prototypicalClone=a.shallowClone=a.isEmptyArg=a.isOnlyPropIn=a.isEmpty=a.isObject=a.ensureArray=a.isArray=a.copy=a.mixin=void 0,a.arrEquals=a.toBase64=a.matchDerivedChannel=a.shallowEquals=a.getGlobalObject=a.getRetryTime=a.getJitterCoefficient=a.getBackoffCoefficient=void 0;var f=r(0),d=f.__importDefault(r(3)),g=f.__importStar(r(8)),m=f.__importDefault(r(4)),_=r(11),C=r(31);function E(lt){return Math.floor(Math.random()*lt.length)}function R(lt){for(var Tt=[],Rt=1;Rt<arguments.length;Rt++)Tt[Rt-1]=arguments[Rt];for(var qt=0;qt<Tt.length;qt++){var le=Tt[qt];if(!le)break;var Bt=Object.prototype.hasOwnProperty;for(var vt in le)(!Bt||Bt.call(le,vt))&&(lt[vt]=le[vt])}return lt}a.mixin=R;function v(lt){return R({},lt)}a.copy=v,a.isArray=Array.isArray||function(lt){return Object.prototype.toString.call(lt)=="[object Array]"};function D(lt){return M(lt)?[]:(0,a.isArray)(lt)?lt:[lt]}a.ensureArray=D;function L(lt){return Object.prototype.toString.call(lt)=="[object Object]"}a.isObject=L;function B(lt){for(var Tt in lt)return!1;return!0}a.isEmpty=B;function N(lt,Tt){for(var Rt in lt)if(Rt!==Tt)return!1;return!0}a.isOnlyPropIn=N;function M(lt){return lt==null}a.isEmptyArg=M;function P(lt){var Tt=new Object;for(var Rt in lt)Tt[Rt]=lt[Rt];return Tt}a.shallowClone=P;function O(lt,Tt){var Rt=(function(){function le(){}return le})();Rt.prototype=lt;var qt=new Rt;return Tt&&R(qt,Tt),qt}a.prototypicalClone=O;var A=function(lt,Tt){if(d.default.Config.inherits){d.default.Config.inherits(lt,Tt);return}lt.super_=Tt,lt.prototype=O(Tt.prototype,{constructor:lt})};a.inherits=A;function T(lt,Tt){for(var Rt in lt)if(lt[Rt]==Tt)return!0;return!1}a.containsValue=T;function y(lt,Tt){return(0,a.isArray)(Tt)?z(lt,Tt):U(lt,Tt)}a.intersect=y;function z(lt,Tt){for(var Rt=[],qt=0;qt<lt.length;qt++){var le=lt[qt];(0,a.arrIndexOf)(Tt,le)!=-1&&Rt.push(le)}return Rt}a.arrIntersect=z;function U(lt,Tt){for(var Rt=[],qt=0;qt<lt.length;qt++){var le=lt[qt];le in Tt&&Rt.push(le)}return Rt}a.arrIntersectOb=U;function G(lt,Tt){for(var Rt=[],qt=0;qt<lt.length;qt++){var le=lt[qt];(0,a.arrIndexOf)(Tt,le)==-1&&Rt.push(le)}return Rt}a.arrSubtract=G,a.arrIndexOf=Array.prototype.indexOf?function(lt,Tt,Rt){return lt.indexOf(Tt,Rt)}:function(lt,Tt,Rt){Rt=Rt||0;for(var qt=lt.length;Rt<qt;Rt++)if(lt[Rt]===Tt)return Rt;return-1};function K(lt,Tt){return(0,a.arrIndexOf)(lt,Tt)!==-1}a.arrIn=K;function Q(lt,Tt){var Rt=(0,a.arrIndexOf)(lt,Tt),qt=Rt!=-1;return qt&&lt.splice(Rt,1),qt}a.arrDeleteValue=Q;function X(lt,Tt){var Rt=lt.slice();return Q(Rt,Tt),Rt}a.arrWithoutValue=X;function Y(lt,Tt){var Rt=[];for(var qt in lt)Tt&&!Object.prototype.hasOwnProperty.call(lt,qt)||Rt.push(qt);return Rt}a.keysArray=Y;function j(lt,Tt){var Rt=[];for(var qt in lt)Tt&&!Object.prototype.hasOwnProperty.call(lt,qt)||Rt.push(lt[qt]);return Rt}a.valuesArray=j;function I(lt,Tt){for(var Rt in lt)Object.prototype.hasOwnProperty.call(lt,Rt)&&lt[Rt]&&Tt(Rt)}a.forInOwnNonNullProperties=I,a.arrForEach=Array.prototype.forEach?function(lt,Tt){lt.forEach(Tt)}:function(lt,Tt){for(var Rt=lt.length,qt=0;qt<Rt;qt++)Tt(lt[qt],qt,lt)};function F(lt,Tt){return(0,a.arrForEach)(lt.slice(),Tt)}a.safeArrForEach=F,a.arrMap=Array.prototype.map?function(lt,Tt){return lt.map(Tt)}:function(lt,Tt){for(var Rt=[],qt=lt.length,le=0;le<qt;le++)Rt.push(Tt(lt[le],le,lt));return Rt},a.arrFilter=Array.prototype.filter?function(lt,Tt){return lt.filter(Tt)}:function(lt,Tt){for(var Rt=[],qt=lt.length,le=0;le<qt;le++)Tt(lt[le])&&Rt.push(lt[le]);return Rt},a.arrEvery=Array.prototype.every?function(lt,Tt){return lt.every(Tt)}:function(lt,Tt){for(var Rt=lt.length,qt=0;qt<Rt;qt++)if(!Tt(lt[qt],qt,lt))return!1;return!0};function W(lt,Tt){if(lt.length===0)return!0;var Rt=lt[0][Tt];return(0,a.arrEvery)(lt,function(qt){return qt[Tt]===Rt})}a.allSame=W;var it={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function Z(lt,Tt){var Rt=it[Tt||ge.json];return{accept:Rt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(lt)}}a.defaultGetHeaders=Z;function at(lt,Tt){var Rt,qt=Rt=it[Tt||ge.json];return{accept:qt,"content-type":Rt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(lt)}}a.defaultPostHeaders=at;function rt(lt){return lt.splice(E(lt),1)[0]}a.arrPopRandomElement=rt;function V(lt){var Tt=[];if(lt)for(var Rt in lt)Tt.push(encodeURIComponent(Rt)+"="+encodeURIComponent(lt[Rt]));return Tt.length?"?"+Tt.join("&"):""}a.toQueryString=V;function J(lt){for(var Tt,Rt=/([^?&=]+)=?([^&]*)/g,qt={};Tt=Rt.exec(lt);)qt[decodeURIComponent(Tt[1])]=decodeURIComponent(Tt[2]);return qt}a.parseQueryString=J,a.now=Date.now||function(){return new Date().getTime()};function tt(lt){return typeof lt=="object"&&lt!==null&&(lt.constructor.name=="ErrorInfo"||lt.constructor.name=="PartialErrorInfo")}a.isErrorInfoOrPartialErrorInfo=tt;function nt(lt){var Tt,Rt;return lt instanceof Error||((Tt=lt==null?void 0:lt.constructor)===null||Tt===void 0?void 0:Tt.name)==="ErrorInfo"||((Rt=lt==null?void 0:lt.constructor)===null||Rt===void 0?void 0:Rt.name)==="PartialErrorInfo"?lt.toString():d.default.Config.inspect(lt)}a.inspectError=nt;function ht(lt){return d.default.BufferUtils.isBuffer(lt)?lt.toString():typeof lt=="string"?lt:d.default.Config.inspect(lt)}a.inspectBody=ht;function wt(lt){if(d.default.BufferUtils.isBuffer(lt))return d.default.BufferUtils.byteLength(lt);if(typeof lt=="string")return d.default.Config.stringByteSize(lt);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof lt)}a.dataSizeBytes=wt;function jt(){return String(Math.random()).substr(2)}a.cheapRandStr=jt;var kt=function(lt){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var Tt=new Uint8Array(lt);return d.default.Config.getRandomValues(Tt),d.default.BufferUtils.base64Encode(Tt)}for(var Rt=d.default.BufferUtils.base64CharSet,qt=Math.round(lt*4/3),le="",Bt=0;Bt<qt;Bt++)le+=Rt[E(Rt)];return le};a.randomString=kt;var ee=function(lt){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var Tt=new Uint8Array(lt);return d.default.Config.getRandomValues(Tt),d.default.BufferUtils.hexEncode(Tt)}for(var Rt=d.default.BufferUtils.hexCharSet,qt=lt*2,le="",Bt=0;Bt<qt;Bt++)le+=Rt[E(Rt)];return le};a.randomHexString=ee;function re(lt,Tt){for(var Rt=Math.min(Tt,lt.length),qt=lt.slice(),le=[],Bt=0;Bt<Rt;Bt++)le.push(rt(qt));return le}a.arrChooseN=re,a.trim=String.prototype.trim?function(lt){return lt.trim()}:function(lt){return lt.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function Lt(lt,Tt,Rt){return new Promise(function(qt,le){lt[Tt].apply(lt,f.__spreadArray(f.__spreadArray([],Rt,!1),[function(Bt,vt){Bt?le(Bt):qt(vt)}],!1))})}a.promisify=Lt;var ge;(function(lt){lt.msgpack="msgpack",lt.json="json"})(ge=a.Format||(a.Format={}));function pe(lt,Tt){return Tt=="msgpack"?d.default.Config.msgpack.decode(lt):JSON.parse(String(lt))}a.decodeBody=pe;function rn(lt,Tt){return Tt=="msgpack"?d.default.Config.msgpack.encode(lt,!0):JSON.stringify(lt)}a.encodeBody=rn;function Ye(lt){return lt.map(function(Tt){return Tt&&Tt.toLowerCase()})}a.allToLowerCase=Ye;function mn(lt){return lt.map(function(Tt){return Tt&&Tt.toUpperCase()})}a.allToUpperCase=mn;function Yn(lt){return Math.min((lt+2)/3,2)}a.getBackoffCoefficient=Yn;function sn(){return 1-Math.random()*.2}a.getJitterCoefficient=sn;function Ot(lt,Tt){return lt*Yn(Tt)*sn()}a.getRetryTime=Ot;function Zt(){return l||(typeof window<"u"?window:self)}a.getGlobalObject=Zt;function Ce(lt,Tt){return Object.keys(lt).every(function(Rt){return lt[Rt]===Tt[Rt]})&&Object.keys(Tt).every(function(Rt){return Tt[Rt]===lt[Rt]})}a.shallowEquals=Ce;function Ke(lt){var Tt=/^(\[([^?]*)(?:(.*))\])?(.+)$/,Rt=lt.match(Tt);if(!Rt||!Rt.length||Rt.length<5)throw new m.default("regex match failed",400,40010);if(Rt[2])throw new m.default("cannot use a derived option with a ".concat(Rt[2]," channel"),400,40010);return{qualifierParam:Rt[3]||"",channelName:Rt[4]}}a.matchDerivedChannel=Ke;function Je(lt){return d.default.Config.createHmac?Buffer.from(lt,"ascii").toString("base64"):(0,_.stringify)((0,C.parse)(lt))}a.toBase64=Je;function Te(lt,Tt){return lt.length===Tt.length&&(0,a.arrEvery)(lt,function(Rt,qt){return Rt===Tt[qt]})}a.arrEquals=Te}).call(this,r(13))}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var f=r(0),d=f.__importDefault(r(3)),g=l||(typeof window<"u"?window:self),m;(function(v){v[v.None=0]="None",v[v.Error=1]="Error",v[v.Major=2]="Major",v[v.Minor=3]="Minor",v[v.Micro=4]="Micro"})(m||(m={}));function _(v,D){return"".concat(v).padStart(D?3:2,"0")}function C(v){return d.default.Config.logTimestamps?function(D){var L=new Date;v(_(L.getHours())+":"+_(L.getMinutes())+":"+_(L.getSeconds())+"."+_(L.getMilliseconds(),1)+" "+D)}:v}var E=function(){var v,D,L,B;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((D=(v=g==null?void 0:g.console)===null||v===void 0?void 0:v.log)===null||D===void 0?void 0:D.apply)=="function"?(L=function(){for(var N=[],M=0;M<arguments.length;M++)N[M]=arguments[M];console.log.apply(console,N)},B=console.warn?function(){for(var N=[],M=0;M<arguments.length;M++)N[M]=arguments[M];console.warn.apply(console,N)}:L):g!=null&&g.console.log?L=B=function(){Function.prototype.apply.call(console.log,console,arguments)}:L=B=function(){},[L,B].map(C)},R=(function(){function v(){v.logLevel=v.LOG_DEFAULT}return v.initLogHandlers=function(){var D=E(),L=D[0],B=D[1];this.logHandler=L,this.logErrorHandler=B},v.renamedClientOption=function(D,L){v.deprecationWarning("The `".concat(D,"` client option has been renamed to `").concat(L,"`. Please update your code to use `").concat(L,"` instead. `").concat(D,"` will be removed in a future version."))},v.renamedMethod=function(D,L,B){v.deprecationWarning("`".concat(D,"`s `").concat(L,"` method has been renamed to `").concat(B,"`. Please update your code to use `").concat(B,"` instead. `").concat(L,"` will be removed in a future version."))},v.deprecationWarning=function(D){v.shouldLog(m.Error)&&v.logErrorHandler("Ably: Deprecation warning - ".concat(D))},v.logLevel=m.Error,v.LOG_NONE=m.None,v.LOG_ERROR=m.Error,v.LOG_MAJOR=m.Major,v.LOG_MINOR=m.Minor,v.LOG_MICRO=m.Micro,v.LOG_DEFAULT=m.Error,v.LOG_DEBUG=m.Micro,v.logAction=function(D,L,B){v.shouldLog(D)&&(D===m.Error?v.logErrorHandler:v.logHandler)("Ably: "+L+": "+B)},v.deprecated=function(D,L){v.deprecationWarning("".concat(D," is deprecated and will be removed in a future version. ").concat(L))},v.shouldLog=function(D){return D<=v.logLevel},v.setLog=function(D,L){D!==void 0&&(v.logLevel=D),L!==void 0&&(v.logHandler=v.logErrorHandler=L)},v})();a.default=R}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function f(){}return f})();a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.PartialErrorInfo=void 0;var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1));function g(C){var E="["+C.constructor.name;return C.message&&(E+=": "+C.message),C.statusCode&&(E+="; statusCode="+C.statusCode),C.code&&(E+="; code="+C.code),C.cause&&(E+="; cause="+d.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(E+="; see "+C.href+" "),E+="]",E}var m=(function(C){l.__extends(E,C);function E(R,v,D,L){var B=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(B,E.prototype),B.code=v,B.statusCode=D,B.cause=L,B}return E.prototype.toString=function(){return g(this)},E.fromValues=function(R){var v=R,D=v.message,L=v.code,B=v.statusCode;if(typeof D!="string"||typeof L!="number"||typeof B!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+f.default.Config.inspect(R));var N=Object.assign(new E(D,L,B),R);return N.code&&!N.href&&(N.href="https://help.ably.io/error/"+N.code),N},E})(Error);a.default=m;var _=(function(C){l.__extends(E,C);function E(R,v,D,L){var B=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(B,E.prototype),B.code=v,B.statusCode=D,B.cause=L,B}return E.prototype.toString=function(){return g(this)},E})(Error);a.PartialErrorInfo=_}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){if(typeof ArrayBuffer=="function"){var f=l,d=f.lib,g=d.WordArray,m=g.init,_=g.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var E=C.byteLength,R=[],v=0;v<E;v++)R[v>>>2]|=C[v]<<24-v%4*8;m.call(this,R,E)}else m.apply(this,arguments)};_.prototype=g}})(),l.lib.WordArray})}),(function(n,a,r){(function(l){(function(f,d){n.exports=d()})(this,function(){var f=f||(function(d,g){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof l<"u"&&l.crypto&&(m=l.crypto),!m)try{m=r(44)}catch{}var _=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||(function(){function A(){}return function(T){var y;return A.prototype=T,y=new A,A.prototype=null,y}})(),E={},R=E.lib={},v=R.Base=(function(){return{extend:function(A){var T=C(this);return A&&T.mixIn(A),(!T.hasOwnProperty("init")||this.init===T.init)&&(T.init=function(){T.$super.init.apply(this,arguments)}),T.init.prototype=T,T.$super=this,T},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var T in A)A.hasOwnProperty(T)&&(this[T]=A[T]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),D=R.WordArray=v.extend({init:function(A,T){A=this.words=A||[],T!=g?this.sigBytes=T:this.sigBytes=A.length*4},toString:function(A){return(A||B).stringify(this)},concat:function(A){var T=this.words,y=A.words,z=this.sigBytes,U=A.sigBytes;if(this.clamp(),z%4)for(var G=0;G<U;G++){var K=y[G>>>2]>>>24-G%4*8&255;T[z+G>>>2]|=K<<24-(z+G)%4*8}else for(var G=0;G<U;G+=4)T[z+G>>>2]=y[G>>>2];return this.sigBytes+=U,this},clamp:function(){var A=this.words,T=this.sigBytes;A[T>>>2]&=4294967295<<32-T%4*8,A.length=d.ceil(T/4)},clone:function(){var A=v.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var T=[],y=0;y<A;y+=4)T.push(_());return new D.init(T,A)}}),L=E.enc={},B=L.Hex={stringify:function(A){for(var T=A.words,y=A.sigBytes,z=[],U=0;U<y;U++){var G=T[U>>>2]>>>24-U%4*8&255;z.push((G>>>4).toString(16)),z.push((G&15).toString(16))}return z.join("")},parse:function(A){for(var T=A.length,y=[],z=0;z<T;z+=2)y[z>>>3]|=parseInt(A.substr(z,2),16)<<24-z%8*4;return new D.init(y,T/2)}},N=L.Latin1={stringify:function(A){for(var T=A.words,y=A.sigBytes,z=[],U=0;U<y;U++){var G=T[U>>>2]>>>24-U%4*8&255;z.push(String.fromCharCode(G))}return z.join("")},parse:function(A){for(var T=A.length,y=[],z=0;z<T;z++)y[z>>>2]|=(A.charCodeAt(z)&255)<<24-z%4*8;return new D.init(y,T)}},M=L.Utf8={stringify:function(A){try{return decodeURIComponent(escape(N.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return N.parse(unescape(encodeURIComponent(A)))}},P=R.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new D.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=M.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var T,y=this._data,z=y.words,U=y.sigBytes,G=this.blockSize,K=G*4,Q=U/K;A?Q=d.ceil(Q):Q=d.max((Q|0)-this._minBufferSize,0);var X=Q*G,Y=d.min(X*4,U);if(X){for(var j=0;j<X;j+=G)this._doProcessBlock(z,j);T=z.splice(0,X),y.sigBytes-=Y}return new D.init(T,Y)},clone:function(){var A=v.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});R.Hasher=P.extend({cfg:v.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){P.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var T=this._doFinalize();return T},blockSize:16,_createHelper:function(A){return function(T,y){return new A.init(y).finalize(T)}},_createHmacHelper:function(A){return function(T,y){return new O.HMAC.init(A,y).finalize(T)}}});var O=E.algo={};return E})(Math);return f})}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(3));function m(E,R,v){try{R.apply(E,v)}catch(D){d.default.logAction(d.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+D+"; stack = "+(D&&D.stack))}}function _(E,R,v){for(var D,L,B,N=0;N<E.length;N++)if(D=E[N],v&&(D=D[v]),f.isArray(D)){for(;(L=f.arrIndexOf(D,R))!==-1;)D.splice(L,1);v&&D.length===0&&delete E[N][v]}else if(f.isObject(D))for(B in D)Object.prototype.hasOwnProperty.call(D,B)&&f.isArray(D[B])&&_([D],R,B)}var C=(function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var R=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];if(v.length===1){var L=v[0];if(typeof L=="function")this.any.push(L);else throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v))}if(v.length===2){var B=v[0],N=v[1];if(typeof N!="function")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));if(f.isEmptyArg(B))this.any.push(N);else if(f.isArray(B))B.forEach(function(P){R.on(P,N)});else{if(typeof B!="string")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));var M=this.events[B]||(this.events[B]=[]);M.push(N)}}},E.prototype.off=function(){for(var R,v=this,D=[],L=0;L<arguments.length;L++)D[L]=arguments[L];if(D.length==0||f.isEmptyArg(D[0])&&f.isEmptyArg(D[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var B=D[0],N=D[1],M=null,P=null;if(D.length===1||!N)typeof B=="function"?M=B:P=B;else{if(typeof N!="function")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));R=[B,N],P=R[0],M=R[1]}if(M&&f.isEmptyArg(P)){_([this.any,this.events,this.anyOnce,this.eventsOnce],M);return}if(f.isArray(P)){P.forEach(function(O){v.off(O,M)});return}if(typeof P!="string")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));M?_([this.events,this.eventsOnce],M,P):(delete this.events[P],delete this.eventsOnce[P])},E.prototype.listeners=function(R){if(R){var v=this.events[R]||[];return this.eventsOnce[R]&&Array.prototype.push.apply(v,this.eventsOnce[R]),v.length?v:null}return this.any.length?this.any:null},E.prototype.emit=function(R){for(var v=[],D=1;D<arguments.length;D++)v[D-1]=arguments[D];var L={event:R},B=[];this.anyOnce.length&&(Array.prototype.push.apply(B,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(B,this.any);var N=this.eventsOnce[R];N&&(Array.prototype.push.apply(B,N),delete this.eventsOnce[R]);var M=this.events[R];M&&Array.prototype.push.apply(B,M),f.arrForEach(B,function(P){m(L,P,v)})},E.prototype.once=function(){for(var R=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];var L=v.length;if((L===0||L===1&&typeof v[0]!="function")&&g.default.Config.Promise){var B=v[0];return new g.default.Config.Promise(function(T){R.once(B,T)})}var N=v[0],M=v[1];if(v.length===1&&typeof N=="function")this.anyOnce.push(N);else if(f.isEmptyArg(N)){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));this.anyOnce.push(M)}else if(f.isArray(N)){var P=this,O=function(){var T=Array.prototype.slice.call(arguments);if(f.arrForEach(N,function(y){P.off(y,O)}),typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));M.apply(this,T)};f.arrForEach(N,function(T){P.on(T,O)})}else{if(typeof N!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));var A=this.eventsOnce[N]||(this.eventsOnce[N]=[]);if(M){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));A.push(M)}}},E.prototype.whenState=function(R,v,D){for(var L=this,B=[],N=3;N<arguments.length;N++)B[N-3]=arguments[N];var M={event:R};if(typeof R!="string"||typeof v!="string")throw"whenState requires a valid event String argument";if(typeof D!="function"&&g.default.Config.Promise)return new g.default.Config.Promise(function(P){E.prototype.whenState.apply(L,[R,v,P].concat(B))});R===v?m(M,D,B):this.once(R,D)},E})();a.default=C}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.getDefaults=a.normaliseOptions=a.objectifyOptions=a.getAgentString=a.getHosts=a.getFallbackHosts=a.environmentFallbackHosts=a.getHttpScheme=a.getPort=a.getHost=void 0;var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(4)),_=r(43),C="ably-js/"+_.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:_.version,protocolVersion:2,agent:C,getHost:R,getPort:v,getHttpScheme:D,environmentFallbackHosts:L,getFallbackHosts:B,getHosts:N,checkHost:M,objectifyOptions:T,normaliseOptions:y};function R(U,G,K){return K?G=G==U.restHost&&U.realtimeHost||G||U.realtimeHost:G=G||U.restHost,G}a.getHost=R;function v(U,G){return G||U.tls?U.tlsPort:U.port}a.getPort=v;function D(U){return U.tls?"https://":"http://"}a.getHttpScheme=D;function L(U){return[U+"-a-fallback.ably-realtime.com",U+"-b-fallback.ably-realtime.com",U+"-c-fallback.ably-realtime.com",U+"-d-fallback.ably-realtime.com",U+"-e-fallback.ably-realtime.com"]}a.environmentFallbackHosts=L;function B(U){var G=U.fallbackHosts,K=typeof U.httpMaxRetryCount<"u"?U.httpMaxRetryCount:E.httpMaxRetryCount;return G?d.arrChooseN(G,K):[]}a.getFallbackHosts=B;function N(U){return[U.restHost].concat(B(U))}a.getHosts=N;function M(U){if(typeof U!="string")throw new m.default("host must be a string; was a "+typeof U,4e4,400);if(!U.length)throw new m.default("host must not be zero-length",4e4,400)}function P(U,G,K){return U.realtimeHost?U.realtimeHost:U.restHost?(g.default.logAction(g.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+U.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+U.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),U.restHost):G?E.REALTIME_HOST:K+"-"+E.REALTIME_HOST}function O(U){var G={};for(var K in E.TIMEOUTS)G[K]=U[K]||E.TIMEOUTS[K];return G}function A(U){var G=E.agent;if(U.agents)for(var K in U.agents)G+=" "+K+"/"+U.agents[K];return G}a.getAgentString=A;function T(U){return typeof U=="string"?U.indexOf(":")==-1?{token:U}:{key:U}:U}a.objectifyOptions=T;function y(U){if(U.host&&(g.default.renamedClientOption("host","restHost"),U.restHost=U.host),U.wsHost&&(g.default.renamedClientOption("wsHost","realtimeHost"),U.realtimeHost=U.wsHost),U.queueEvents&&(g.default.renamedClientOption("queueEvents","queueMessages"),U.queueMessages=U.queueEvents),U.headers&&g.default.deprecated("the `headers` client option",""),U.fallbackHostsUseDefault){if(U.fallbackHosts){var G="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",G),new m.default(G,4e4,400)}if(U.port||U.tlsPort){var G="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",G),new m.default(G,4e4,400)}U.environment?g.default.deprecated("The `fallbackHostsUseDefault` client option","If youre using this client option to force the library to make use of fallback hosts even though youve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):g.default.deprecated("The `fallbackHostsUseDefault` client option","If youre using this client option to force the library to make use of fallback hosts even though youre not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if youre using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),U.fallbackHosts=E.FALLBACK_HOSTS}U.recover===!0&&(g.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),U.recover=function(rt,V){V(!0)}),typeof U.recover=="function"&&U.closeOnUnload===!0&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),U.recover=void 0),"closeOnUnload"in U||(U.closeOnUnload=!U.recover),U.transports&&d.arrIn(U.transports,"xhr")&&(g.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),d.arrDeleteValue(U.transports,"xhr"),U.transports.push("xhr_streaming")),"queueMessages"in U||(U.queueMessages=!0);var K=U.environment&&String(U.environment).toLowerCase()||E.ENVIRONMENT,Q=!K||K==="production";!U.fallbackHosts&&!U.restHost&&!U.realtimeHost&&!U.port&&!U.tlsPort&&(U.fallbackHosts=Q?E.FALLBACK_HOSTS:L(K));var X=U.restHost||(Q?E.REST_HOST:K+"-"+E.REST_HOST),Y=P(U,Q,K);d.arrForEach((U.fallbackHosts||[]).concat(X,Y),M),U.port=U.port||E.PORT,U.tlsPort=U.tlsPort||E.TLS_PORT,"tls"in U||(U.tls=!0);var j=O(U);if("useBinaryProtocol"in U?U.useBinaryProtocol=f.default.Config.supportsBinary&&U.useBinaryProtocol:U.useBinaryProtocol=f.default.Config.preferBinary,U.clientId){var I=U.headers=U.headers||{};I["X-Ably-ClientId"]=f.default.BufferUtils.base64Encode(f.default.BufferUtils.utf8Encode(U.clientId))}"idempotentRestPublishing"in U||(U.idempotentRestPublishing=!0),U.promises&&!f.default.Config.Promise&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),U.promises=!1);var F=null,W=U.connectivityCheckUrl;if(U.connectivityCheckUrl){var it=U.connectivityCheckUrl.split("?"),Z=it[0],at=it[1];F=at?d.parseQueryString(at):{},Z.indexOf("://")===-1&&(Z="https://"+Z),W=Z}return l.__assign(l.__assign({},U),{useBinaryProtocol:"useBinaryProtocol"in U?f.default.Config.supportsBinary&&U.useBinaryProtocol:f.default.Config.preferBinary,realtimeHost:Y,restHost:X,maxMessageSize:U.maxMessageSize||E.maxMessageSize,timeouts:j,connectivityCheckParams:F,connectivityCheckUrl:W})}a.normaliseOptions=y,a.default=E;function z(U){return Object.assign(E,U)}a.getDefaults=z}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importDefault(r(2)),g=l.__importDefault(r(4)),m=l.__importStar(r(1));function _(v){return!v||!v.channelOptions?{channelOptions:v,plugins:{},baseEncodedPreviousPayload:void 0}:v}function C(v){if(v&&v.cipher){if(!f.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var D=f.default.Crypto.getCipher(v.cipher);return{cipher:D.cipherParams,channelCipher:D.cipher}}return v??{}}function E(v){var D=0;return v.name&&(D+=v.name.length),v.clientId&&(D+=v.clientId.length),v.extras&&(D+=JSON.stringify(v.extras).length),v.data&&(D+=m.dataSizeBytes(v.data)),D}var R=(function(){function v(){}return v.prototype.toJSON=function(){var D=this.encoding,L=this.data;return L&&f.default.BufferUtils.isBuffer(L)&&(arguments.length>0?(D=D?D+"/base64":"base64",L=f.default.BufferUtils.base64Encode(L)):L=f.default.BufferUtils.toBuffer(L)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:D,data:L}},v.prototype.toString=function(){var D="[Message";return this.name&&(D+="; name="+this.name),this.id&&(D+="; id="+this.id),this.timestamp&&(D+="; timestamp="+this.timestamp),this.clientId&&(D+="; clientId="+this.clientId),this.connectionId&&(D+="; connectionId="+this.connectionId),this.encoding&&(D+="; encoding="+this.encoding),this.extras&&(D+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?D+="; data="+this.data:f.default.BufferUtils.isBuffer(this.data)?D+="; data (buffer)="+f.default.BufferUtils.base64Encode(this.data):D+="; data (json)="+JSON.stringify(this.data)),this.extras&&(D+="; extras="+JSON.stringify(this.extras)),D+="]",D},v.encrypt=function(D,L,B){var N=D.data,M=D.encoding,P=L.channelCipher;M=M?M+"/":"",f.default.BufferUtils.isBuffer(N)||(N=f.default.BufferUtils.utf8Encode(String(N)),M=M+"utf-8/"),P.encrypt(N,function(O,A){if(O){B(O);return}D.data=A,D.encoding=M+"cipher+"+P.algorithm,B(null,D)})},v.encode=function(D,L,B){var N=D.data,M=typeof N=="string"||f.default.BufferUtils.isBuffer(N)||N===null||N===void 0;if(!M)if(m.isObject(N)||m.isArray(N))D.data=JSON.stringify(N),D.encoding=D.encoding?D.encoding+"/json":"json";else throw new g.default("Data type is unsupported",40013,400);L!=null&&L.cipher?v.encrypt(D,L,B):B(null,D)},v.encodeArray=function(D,L,B){for(var N=0,M=0;M<D.length;M++)v.encode(D[M],L,function(P){if(P){B(P);return}N++,N==D.length&&B(null,D)})},v.decode=function(D,L){var B=_(L),N=D.data,M=D.encoding;if(M){var P=M.split("/"),O=void 0,A=P.length,T=D.data,y="";try{for(;(O=A)>0;){var z=P[--A].match(/([-\w]+)(\+([\w-]+))?/);if(!z)break;switch(y=z[1],y){case"base64":T=f.default.BufferUtils.base64Decode(String(T)),O==P.length&&(N=T);continue;case"utf-8":T=f.default.BufferUtils.utf8Decode(T);continue;case"json":T=JSON.parse(T);continue;case"cipher":if(B.channelOptions!=null&&B.channelOptions.cipher&&B.channelOptions.channelCipher){var U=z[3],G=B.channelOptions.channelCipher;if(U!=G.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");T=G.decrypt(T);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!B.plugins||!B.plugins.vcdiff)throw new g.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new g.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var K=B.baseEncodedPreviousPayload;typeof K=="string"&&(K=f.default.BufferUtils.utf8Encode(K)),K=f.default.BufferUtils.toBuffer(K),T=f.default.BufferUtils.toBuffer(T),T=f.default.BufferUtils.typedArrayToBuffer(B.plugins.vcdiff.decode(T,K)),N=T}catch(X){throw new g.default("Vcdiff delta decode failed with "+X,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(X){var Q=X;throw new g.default("Error processing the "+y+" encoding, decoder returned "+Q.message+"",Q.code||40013,400)}finally{D.encoding=O<=0?null:P.slice(0,O).join("/"),D.data=T}}B.baseEncodedPreviousPayload=N},v.fromResponseBody=function(D,L,B){B&&(D=m.decodeBody(D,B));for(var N=0;N<D.length;N++){var M=D[N]=v.fromValues(D[N]);try{v.decode(M,L)}catch(P){d.default.logAction(d.default.LOG_ERROR,"Message.fromResponseBody()",P.toString())}}return D},v.fromValues=function(D){return Object.assign(new v,D)},v.fromValuesArray=function(D){for(var L=D.length,B=new Array(L),N=0;N<L;N++)B[N]=v.fromValues(D[N]);return B},v.fromEncoded=function(D,L){var B=v.fromValues(D),N=C(L??null);try{v.decode(B,N)}catch(M){d.default.logAction(d.default.LOG_ERROR,"Message.fromEncoded()",M.toString())}return B},v.fromEncodedArray=function(D,L){return D.map(function(B){return v.fromEncoded(B,L)})},v.getMessagesSize=function(D){for(var L,B=0,N=0;N<D.length;N++)L=D[N],B+=L.size||(L.size=E(L));return B},v.serialize=m.encodeBody,v})();a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(4)),g=l.__importDefault(r(9)),m=l.__importDefault(r(16)),_={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(_).forEach(function(B){C[_[B]]=B});var E={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},R=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function v(B){var N=[];if(B)for(var M=0;M<B.length;M++)N.push(B[M].toString());return"[ "+N.join(", ")+" ]"}var D="id channel channelSerial connectionId count msgSerial timestamp".split(" "),L=(function(){function B(){var N=this;this.hasFlag=function(M){return(N.flags&E[M])>0}}return B.prototype.setFlag=function(N){return this.flags=this.flags|E[N]},B.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},B.prototype.encodeModesToFlags=function(N){var M=this;N.forEach(function(P){return M.setFlag(P)})},B.prototype.decodeModesFromFlags=function(){var N=this,M=[];return B.channelModes.forEach(function(P){N.hasFlag(P)&&M.push(P)}),M.length>0?M:void 0},B.fromValues=function(N){return Object.assign(new B,N)},B.Action=_,B.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],B.ActionName=C,B.serialize=f.encodeBody,B.deserialize=function(N,M){var P=f.decodeBody(N,M);return B.fromDeserialized(P)},B.fromDeserialized=function(N){var M=N.error;M&&(N.error=d.default.fromValues(M));var P=N.messages;if(P)for(var O=0;O<P.length;O++)P[O]=g.default.fromValues(P[O]);var A=N.presence;if(A)for(var O=0;O<A.length;O++)A[O]=m.default.fromValues(A[O],!0);return Object.assign(new B,N)},B.stringify=function(N){var M="[ProtocolMessage";N.action!==void 0&&(M+="; action="+B.ActionName[N.action]||!1);for(var P,O=0;O<D.length;O++)P=D[O],N[P]!==void 0&&(M+="; "+P+"="+N[P]);if(N.messages&&(M+="; messages="+v(g.default.fromValuesArray(N.messages))),N.presence&&(M+="; presence="+v(m.default.fromValuesArray(N.presence))),N.error&&(M+="; error="+d.default.fromValues(N.error).toString()),N.auth&&N.auth.accessToken&&(M+="; token="+N.auth.accessToken),N.flags&&(M+="; flags="+R.filter(N.hasFlag).join(",")),N.params){var A="";f.forInOwnNonNullProperties(N.params,function(T){A.length>0&&(A+="; "),A+=T+"="+N.params[T]}),A.length>0&&(M+="; params=["+A+"]")}return M+="]",M},B})();a.default=L}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=f.enc;m.Base64={stringify:function(C){var E=C.words,R=C.sigBytes,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var D=[],L=0;L<R;L+=3)for(var B=E[L>>>2]>>>24-L%4*8&255,N=E[L+1>>>2]>>>24-(L+1)%4*8&255,M=E[L+2>>>2]>>>24-(L+2)%4*8&255,P=B<<16|N<<8|M,O=0;O<4&&L+O*.75<R;O++)D.push(v.charAt(P>>>6*(3-O)&63));var A=v.charAt(64);if(A)for(;D.length%4;)D.push(A);return D.join("")},parse:function(C){var E=C.length,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var D=0;D<R.length;D++)v[R.charCodeAt(D)]=D}var L=R.charAt(64);if(L){var B=C.indexOf(L);B!==-1&&(E=B)}return _(C,E,v)}};function _(C,E,R){for(var v=[],D=0,L=0;L<E;L++)if(L%4){var B=R[C.charCodeAt(L-1)]<<L%4*2,N=R[C.charCodeAt(L)]>>>6-L%4*2,M=B|N;v[D>>>2]|=M<<24-D%4*8,D++}return g.create(v,D)}})(),l.enc.Base64})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(10)),g=l.__importDefault(r(26)),m=l.__importDefault(r(2)),_=l.__importDefault(r(8)),C=l.__importDefault(r(21)),E=l.__importDefault(r(18)),R=l.__importDefault(r(4)),v=l.__importDefault(r(22)),D=l.__importDefault(r(3));function L(M){var P=[80015,80017,80030];return M.code?E.default.isTokenErr(M)?!1:f.arrIn(P,M.code)?!0:M.code>=4e4&&M.code<5e4:!1}function B(M){return L(M)?[d.default.fromValues({action:d.default.Action.ERROR,error:M})]:[d.default.fromValues({action:d.default.Action.DISCONNECTED,error:M})]}var N=(function(M){l.__extends(P,M);function P(O,A,T){var y=M.call(this,O,A,T,!0)||this;return y.onAuthUpdated=function(z){y.authParams={access_token:z.token}},y.stream="stream"in T?T.stream:!0,y.sendRequest=null,y.recvRequest=null,y.pendingCallback=null,y.pendingItems=null,y}return P.prototype.connect=function(){var O=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","starting"),g.default.prototype.connect.call(this);var A=this.params,T=A.options,y=_.default.getHost(T,A.host),z=_.default.getPort(T),U=T.tls?"https://":"http://";this.baseUri=U+y+":"+z+"/comet/";var G=this.baseUri+"connect";m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","uri: "+G),this.auth.getAuthParams(function(K,Q){if(K){O.disconnect(K);return}if(!O.isDisposed){O.authParams=Q;var X=O.params.getConnectParams(Q);"stream"in X&&(O.stream=X.stream),m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+f.toQueryString(X));var Y=!1,j=O.recvRequest=O.createRequest(G,null,X,null,O.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV);j.on("data",function(I){O.recvRequest&&(Y||(Y=!0,O.emit("preconnect")),O.onData(I))}),j.on("complete",function(I){if(O.recvRequest||(I=I||new R.default("Request cancelled",80003,400)),O.recvRequest=null,!Y&&!I&&(Y=!0,O.emit("preconnect")),O.onActivity(),I){I.code?O.onData(B(I)):O.disconnect(I);return}D.default.Config.nextTick(function(){O.recv()})}),j.exec()}})},P.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},P.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},P.prototype._requestCloseOrDisconnect=function(O){var A=this,T=O?this.closeUri:this.disconnectUri;if(T){var y=this.createRequest(T,null,this.authParams,null,v.default.REQ_SEND);y.on("complete",function(z){z&&(m.default.logAction(m.default.LOG_ERROR,"CometTransport.request"+(O?"Close()":"Disconnect()"),"request returned err = "+f.inspectError(z)),A.finish("disconnected",z))}),y.exec()}},P.prototype.dispose=function(){var O=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),D.default.Config.nextTick(function(){O.emit("disposed")}))},P.prototype.onConnect=function(O){var A;if(!this.isDisposed){var T=(A=O.connectionDetails)===null||A===void 0?void 0:A.connectionKey;g.default.prototype.onConnect.call(this,O);var y=this.baseUri+T;m.default.logAction(m.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+y),this.sendUri=y+"/send",this.recvUri=y+"/recv",this.closeUri=y+"/close",this.disconnectUri=y+"/disconnect"}},P.prototype.send=function(O){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(O);return}var A=this.pendingItems||[];A.push(O),this.pendingItems=null,this.sendItems(A)},P.prototype.sendAnyPending=function(){var O=this.pendingItems;O&&(this.pendingItems=null,this.sendItems(O))},P.prototype.sendItems=function(O){var A=this,T=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(O),v.default.REQ_SEND);T.on("complete",function(y,z){if(y&&m.default.logAction(m.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+f.inspectError(y)),A.sendRequest=null,y){y.code?A.onData(B(y)):A.disconnect(y);return}z&&A.onData(z),A.pendingItems&&D.default.Config.nextTick(function(){A.sendRequest||A.sendAnyPending()})}),T.exec()},P.prototype.recv=function(){var O=this;if(!this.recvRequest&&this.isConnected){var A=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV_POLL);A.on("data",function(T){O.onData(T)}),A.on("complete",function(T){if(O.recvRequest=null,O.onActivity(),T){T.code?O.onData(B(T)):O.disconnect(T);return}D.default.Config.nextTick(function(){O.recv()})}),A.exec()}},P.prototype.onData=function(O){try{var A=this.decodeResponse(O);if(A&&A.length)for(var T=0;T<A.length;T++)this.onProtocolMessage(d.default.fromDeserialized(A[T]))}catch(y){m.default.logAction(m.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+y.stack)}},P.prototype.encodeRequest=function(O){return JSON.stringify(O)},P.prototype.decodeResponse=function(O){return typeof O=="string"?JSON.parse(O):O},P})(g.default);a.default=N}),(function(n,a){var r;r=(function(){return this})();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.isSuccessCode=void 0;var l;(function(d){d[d.Success=200]="Success",d[d.NoContent=204]="NoContent",d[d.BadRequest=400]="BadRequest",d[d.Unauthorized=401]="Unauthorized",d[d.Forbidden=403]="Forbidden",d[d.RequestTimeout=408]="RequestTimeout",d[d.InternalServerError=500]="InternalServerError"})(l||(l={}));function f(d){return d>=l.Success&&d<l.BadRequest}a.isSuccessCode=f,a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(18)),_=l.__importDefault(r(19)),C=r(4),E=l.__importDefault(r(14));function R(M,P,O,A,T){M.http.supportsAuthHeaders?M.auth.getAuthHeaders(function(y,z){y?A(y):T(d.mixin(z,P),O)}):M.auth.getAuthParams(function(y,z){y?A(y):T(P,d.mixin(z,O))})}function v(M,P){return function(O,A,T,y,z){if(O&&!A){M(O);return}if(z===E.default.NoContent){M(O,[],T,!0,z);return}if(!y)try{A=d.decodeBody(A,P)}catch(Y){d.isErrorInfoOrPartialErrorInfo(Y)?M(Y):M(new C.PartialErrorInfo(d.inspectError(Y),null));return}if(!A){M(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var U=A,G=U.statusCode,K=U.response,Q=U.headers;if(G===void 0){M(O,A,T,!0,z);return}if(G<200||G>=300){var X=K&&K.error||O;X||(X=new Error("Error in unenveloping "+A),X.statusCode=G),M(X,K,Q,!0,G);return}M(O,K,Q,!0,G)}}function D(M){var P=[];if(M)for(var O in M)P.push(O+"="+M[O]);return P.join("&")}function L(M,P){return M+(P?"?":"")+D(P)}function B(M,P,O,A){return function(T,y,z,U,G){T?g.default.logAction(g.default.LOG_MICRO,"Resource."+P+"()","Received Error; "+L(O,A)+"; Error: "+d.inspectError(T)):g.default.logAction(g.default.LOG_MICRO,"Resource."+P+"()","Received; "+L(O,A)+"; Headers: "+D(z)+"; StatusCode: "+G+"; Body: "+(f.default.BufferUtils.isBuffer(y)?y.toString():y)),M&&M(T,y,z,U,G)}}var N=(function(){function M(){}return M.get=function(P,O,A,T,y,z){M.do(_.default.Get,P,O,null,A,T,y,z)},M.delete=function(P,O,A,T,y,z){M.do(_.default.Delete,P,O,null,A,T,y,z)},M.post=function(P,O,A,T,y,z,U){M.do(_.default.Post,P,O,A,T,y,z,U)},M.patch=function(P,O,A,T,y,z,U){M.do(_.default.Patch,P,O,A,T,y,z,U)},M.put=function(P,O,A,T,y,z,U){M.do(_.default.Put,P,O,A,T,y,z,U)},M.do=function(P,O,A,T,y,z,U,G){g.default.shouldLog(g.default.LOG_MICRO)&&(G=B(G,P,A,z)),U&&(G=G&&v(G,U),(z=z||{}).envelope=U);function K(Q,X){var Y;if(g.default.shouldLog(g.default.LOG_MICRO)&&g.default.logAction(g.default.LOG_MICRO,"Resource."+P+"()","Sending; "+L(A,X)),g.default.shouldLog(g.default.LOG_MICRO)){var j=T;if(((Y=Q["content-type"])===null||Y===void 0?void 0:Y.indexOf("msgpack"))>0)try{j=f.default.Config.msgpack.decode(T)}catch(I){g.default.logAction(g.default.LOG_MICRO,"Resource."+P+"()","Sending MsgPack Decoding Error: "+d.inspectError(I))}g.default.logAction(g.default.LOG_MICRO,"Resource."+P+"()","Sending; "+L(A,X)+"; Body: "+j)}O.http.do(P,O,A,Q,T,X,function(I,F,W,it,Z){if(I&&m.default.isTokenErr(I)){O.auth.authorize(null,null,function(at){if(at){G(at);return}R(O,Q,X,G,K)});return}G(I,F,W,it,Z)})}R(O,y,z,G,K)},M})();a.default=N}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=l.__importDefault(r(3)),g=l.__importDefault(r(9)),m=l.__importStar(r(1));function _(E){return C.Actions.indexOf(E)}var C=(function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var R=this.id.split(":");return{connectionId:R[0],msgSerial:parseInt(R[1],10),index:parseInt(R[2],10)}},E.prototype.toJSON=function(){var R=this.data,v=this.encoding;return R&&d.default.BufferUtils.isBuffer(R)&&(arguments.length>0?(v=v?v+"/base64":"base64",R=d.default.BufferUtils.base64Encode(R)):R=d.default.BufferUtils.toBuffer(R)),{id:this.id,clientId:this.clientId,action:_(this.action),data:R,encoding:v,extras:this.extras}},E.prototype.toString=function(){var R="[PresenceMessage";return R+="; action="+this.action,this.id&&(R+="; id="+this.id),this.timestamp&&(R+="; timestamp="+this.timestamp),this.clientId&&(R+="; clientId="+this.clientId),this.connectionId&&(R+="; connectionId="+this.connectionId),this.encoding&&(R+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?R+="; data="+this.data:d.default.BufferUtils.isBuffer(this.data)?R+="; data (buffer)="+d.default.BufferUtils.base64Encode(this.data):R+="; data (json)="+JSON.stringify(this.data)),this.extras&&(R+="; extras="+JSON.stringify(this.extras)),R+="]",R},E.fromResponseBody=function(R,v,D){var L=[];D&&(R=m.decodeBody(R,D));for(var B=0;B<R.length;B++){var N=L[B]=E.fromValues(R[B],!0);try{E.decode(N,v)}catch(M){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",M.toString())}}return L},E.fromValues=function(R,v){return v&&(R.action=E.Actions[R.action]),Object.assign(new E,R)},E.fromValuesArray=function(R){for(var v=R.length,D=new Array(v),L=0;L<v;L++)D[L]=E.fromValues(R[L]);return D},E.fromEncoded=function(R,v){var D=E.fromValues(R,!0);try{E.decode(D,v??{})}catch(L){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromEncoded()",L.toString())}return D},E.fromEncodedArray=function(R,v){return R.map(function(D){return E.fromEncoded(D,v)})},E.fromData=function(R){return R instanceof E?R:E.fromValues({data:R})},E.Actions=["absent","present","enter","leave","update"],E.encode=g.default.encode,E.decode=g.default.decode,E.getMessagesSize=g.default.getMessagesSize,E})();a.default=C}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var f=r(0),d=f.__importStar(r(1)),g=f.__importDefault(r(7)),m=f.__importStar(r(4)),_=f.__importDefault(r(2)),C=f.__importDefault(r(8)),E=f.__importDefault(r(22)),R=f.__importDefault(r(3));function v(U,G){return d.arrIn(d.allToLowerCase(d.keysArray(G)),"x-ably-errorcode")}function D(U,G){if(v(U,G))return U.error&&m.default.fromValues(U.error)}var L=function(){},B=0,N={},M=typeof l<"u"&&l.XDomainRequest;function P(){var U=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return U&&Number(U[1])}function O(){var U;return M&&(U=P())&&U===10}function A(U,G){return U.getResponseHeader&&U.getResponseHeader(G)}function T(U){return U.getResponseHeader&&(U.getResponseHeader("transfer-encoding")||!U.getResponseHeader("content-length"))}function y(U){for(var G=d.trim(U.getAllResponseHeaders()).split(`\r
`),K={},Q=0;Q<G.length;Q++){var X=G[Q].split(":").map(d.trim);K[X[0].toLowerCase()]=X[1]}return K}var z=(function(U){f.__extends(G,U);function G(K,Q,X,Y,j,I,F){var W=U.call(this)||this;return X=X||{},X.rnd=d.cheapRandStr(),O()&&!X.envelope&&(X.envelope="json"),W.uri=K+d.toQueryString(X),W.headers=Q||{},W.body=Y,W.method=F?F.toUpperCase():d.isEmptyArg(Y)?"GET":"POST",W.requestMode=j,W.timeouts=I,W.timedOut=!1,W.requestComplete=!1,W.id=String(++B),N[W.id]=W,W}return G.createRequest=function(K,Q,X,Y,j,I,F){var W=I||C.default.TIMEOUTS;return new G(K,Q,d.copy(X),Y,j,W,F)},G.prototype.complete=function(K,Q,X,Y,j){this.requestComplete||(this.requestComplete=!0,!K&&Q&&this.emit("data",Q),this.emit("complete",K,Q,X,Y,j),this.dispose())},G.prototype.abort=function(){this.dispose()},G.prototype.exec=function(){var K=this,Q=this.headers,X=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,Y=this.timer=setTimeout(function(){K.timedOut=!0,I.abort()},X),j=this.method,I=this.xhr=new XMLHttpRequest,F=Q.accept,W=this.body,it="text";if(F?F.indexOf("application/x-msgpack")===0&&(it="arraybuffer"):Q.accept="application/json",W){var Z=Q["content-type"]||(Q["content-type"]="application/json");Z.indexOf("application/json")>-1&&typeof W!="string"&&(W=JSON.stringify(W))}I.open(j,this.uri,!0),I.responseType=it,"authorization"in Q&&(I.withCredentials=!0);for(var at in Q)I.setRequestHeader(at,Q[at]);var rt=function(Lt,ge,pe,rn){var Ye,mn=ge+" (event type: "+Lt.type+")";!((Ye=K==null?void 0:K.xhr)===null||Ye===void 0)&&Ye.statusText&&(mn+=", current statusText is "+K.xhr.statusText),_.default.logAction(_.default.LOG_ERROR,"Request.on"+Lt.type+"()",mn),K.complete(new m.PartialErrorInfo(mn,pe,rn))};I.onerror=function(Lt){rt(Lt,"XHR error occurred",null,400)},I.onabort=function(Lt){K.timedOut?rt(Lt,"Request aborted due to request timeout expiring",null,408):rt(Lt,"Request cancelled",null,400)},I.ontimeout=function(Lt){rt(Lt,"Request timed out",null,408)};var V,J,tt,nt=0,ht=!1,wt=function(){if(clearTimeout(Y),tt=J<400,J==204){K.complete(null,null,null,null,J);return}V=K.requestMode==E.default.REQ_RECV_STREAM&&tt&&T(I)},jt=function(){var Lt;try{var ge=A(I,"content-type"),pe=ge?ge.indexOf("application/json")>=0:I.responseType=="text";if(pe){var rn=I.responseType==="arraybuffer"?R.default.BufferUtils.utf8Decode(I.response):String(I.responseText);rn.length?Lt=JSON.parse(rn):Lt=rn,ht=!0}else Lt=I.response;Lt.response!==void 0?(J=Lt.statusCode,tt=J<400,Q=Lt.headers,Lt=Lt.response):Q=y(I)}catch(mn){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+mn.message,null,400));return}if(tt||d.isArray(Lt)){K.complete(null,Lt,Q,ht,J);return}var Ye=D(Lt,Q);Ye||(Ye=new m.PartialErrorInfo("Error response received from server: "+J+" body was: "+R.default.Config.inspect(Lt),null,J)),K.complete(Ye,Lt,Q,ht,J)};function kt(){for(var Lt=I.responseText,ge=Lt.length-1,pe,rn;nt<ge&&(pe=Lt.indexOf(`
`,nt))>-1;)rn=Lt.slice(nt,pe),nt=pe+1,ee(rn)}var ee=function(Lt){try{Lt=JSON.parse(Lt)}catch(ge){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+ge.message,null,400));return}K.emit("data",Lt)},re=function(){kt(),K.streamComplete=!0,R.default.Config.nextTick(function(){K.complete()})};I.onreadystatechange=function(){var Lt=I.readyState;Lt<3||I.status!==0&&(J===void 0&&(J=I.status,J===1223&&(J=204),wt()),Lt==3&&V?kt():Lt==4&&(V?re():jt()))},I.send(W)},G.prototype.dispose=function(){var K=this.xhr;if(K){K.onreadystatechange=K.onerror=K.onabort=K.ontimeout=L,this.xhr=null;var Q=this.timer;Q&&(clearTimeout(Q),this.timer=null),this.requestComplete||K.abort()}delete N[this.id]},G})(g.default);a.default=z}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=l.__importStar(r(1)),g=l.__importDefault(r(24)),m=l.__importDefault(r(4)),_=l.__importDefault(r(45)),C=r(11),E=l.__importDefault(r(19)),R=l.__importDefault(r(14)),v=l.__importDefault(r(3)),D=l.__importDefault(r(15)),L=Math.pow(2,17);function B(){}function N(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function M(X){return!!X.connection}function P(X){return d.isErrorInfoOrPartialErrorInfo(X)?(X.code||(X.statusCode===403?X.code=40300:(X.code=40170,X.statusCode=401)),X):new m.default(d.inspectError(X),X.code||40170,X.statusCode||401)}var O=function(X,Y){if(v.default.Config.createHmac){var j=v.default.Config.createHmac("SHA256",Y);return j.update(X),j.digest("base64")}return(0,C.stringify)((0,_.default)(X,Y))};function A(X){if(!X)return"";typeof X=="string"&&(X=JSON.parse(X));var Y=Object.create(null),j=d.keysArray(X,!0);if(!j)return"";j.sort();for(var I=0;I<j.length;I++)Y[j[I]]=X[j[I]].sort();return JSON.stringify(Y)}function T(X){if(X.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(X.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(X.key)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(X.tokenDetails)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var Y="authOptions must include valid authentication parameters";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",Y),new Error(Y)}}function y(X){return"useTokenAuth"in X&&!X.useTokenAuth}function z(X){return X.useTokenAuth||!y(X)&&(X.authCallback||X.authUrl||X.token||X.tokenDetails)}function U(X){return!X.key&&!X.authCallback&&!X.authUrl}var G=0;function K(){return G++}var Q=(function(){function X(Y,j){if(this.authOptions={},this.client=Y,this.tokenParams=j.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,z(j)){if(j.key&&!O){var I="client-side token request signing not supported";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new Error(I)}U(j)&&f.default.logAction(f.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(j.defaultTokenParams,j),T(this.authOptions)}else{if(!j.key){var I="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new m.default(I,40160,401)}f.default.logAction(f.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(j)}}return X.prototype.authorize=function(Y,j,I){var F=this,W;if(typeof Y=="function"&&!I?(I=Y,W=Y=null):typeof j=="function"&&!I?(I=j,W=null):W=j,!I&&this.client.options.promises)return d.promisify(this,"authorize",arguments);if(W&&W.key&&this.authOptions.key!==W.key)throw new m.default("Unable to update auth options with incompatible key",40102,401);W&&"force"in W&&(f.default.deprecated("The `force` auth option","If youre using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the librarys stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if youre currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),d.isOnlyPropIn(W,"force")&&(W=null)),this._forceNewToken(Y,W,function(it,Z){if(it){F.client.connection&&it.statusCode===R.default.Forbidden&&F.client.connection.connectionManager.actOnErrorFromAuthorize(it),I==null||I(it);return}M(F.client)?F.client.connection.connectionManager.onAuthUpdated(Z,I||B):I==null||I(null,Z)})},X.prototype.authorise=function(Y,j,I){f.default.renamedMethod("Auth","authorise","authorize"),this.authorize(Y,j,I)},X.prototype._forceNewToken=function(Y,j,I){var F=this;this.tokenDetails=null,this._saveTokenOptions(Y,j),T(this.authOptions),this._ensureValidAuthCredentials(!0,function(W,it){delete F.tokenParams.timestamp,delete F.authOptions.queryTime,I(W,it)})},X.prototype.requestToken=function(Y,j,I){var F=this;if(typeof Y=="function"&&!I?(I=Y,j=Y=null):typeof j=="function"&&!I&&(I=j,j=null),!I&&this.client.options.promises)return d.promisify(this,"requestToken",arguments);j=j||this.authOptions,Y=Y||d.copy(this.tokenParams);var W=I||B,it,Z=this.client;if(j.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),it=j.authCallback;else if(j.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),it=function(nt,ht){var wt=d.mixin({accept:"application/json, text/plain"},j.authHeaders),jt=j.authMethod&&j.authMethod.toLowerCase()==="post",kt,ee=j.authUrl.indexOf("?");ee>-1&&(kt=d.parseQueryString(j.authUrl.slice(ee)),j.authUrl=j.authUrl.slice(0,ee),jt||(j.authParams=d.mixin(kt,j.authParams)));var re=d.mixin({},j.authParams||{},nt),Lt=function(rn,Ye,mn,Yn){var sn;if(rn?f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+d.inspectError(rn)):(sn=mn["content-type"],f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+sn+"; body: "+d.inspectBody(Ye))),rn||Yn)return ht(rn,Ye);if(v.default.BufferUtils.isBuffer(Ye)&&(Ye=Ye.toString()),!sn){ht(new m.default("authUrl response is missing a content-type header",40170,401));return}var Ot=sn.indexOf("application/json")>-1,Zt=sn.indexOf("text/plain")>-1||sn.indexOf("application/jwt")>-1;if(!Ot&&!Zt){ht(new m.default("authUrl responded with unacceptable content-type "+sn+", should be either text/plain, application/jwt or application/json",40170,401));return}if(Ot){if(Ye.length>L){ht(new m.default("authUrl response exceeded max permitted length",40170,401));return}try{Ye=JSON.parse(Ye)}catch(Ce){ht(new m.default("Unexpected error processing authURL response; err = "+Ce.message,40170,401));return}}ht(null,Ye,sn)};if(f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+j.authUrl+"; Params: "+JSON.stringify(re)+"; method: "+(jt?"POST":"GET")),jt){var ge=wt||{};ge["content-type"]="application/x-www-form-urlencoded";var pe=d.toQueryString(re).slice(1);F.client.http.doUri(E.default.Post,Z,j.authUrl,ge,pe,kt,Lt)}else F.client.http.doUri(E.default.Get,Z,j.authUrl,wt||{},null,re,Lt)};else if(j.key)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),it=function(nt,ht){F.createTokenRequest(nt,j,ht)};else{var at="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";f.default.logAction(f.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),W(new m.default(at,40171,403));return}"capability"in Y&&(Y.capability=A(Y.capability));var rt=function(nt,ht){var wt=nt.keyName,jt="/keys/"+wt+"/requestToken",kt=function(re){return Z.baseUri(re)+jt},ee=d.defaultPostHeaders(F.client.options);j.requestHeaders&&d.mixin(ee,j.requestHeaders),f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+jt+"; Token params: "+JSON.stringify(nt)),F.client.http.do(E.default.Post,Z,kt,ee,JSON.stringify(nt),null,ht)},V=!1,J=this.client.options.timeouts.realtimeRequestTimeout,tt=setTimeout(function(){V=!0;var nt="Token request callback timed out after "+J/1e3+" seconds";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",nt),W(new m.default(nt,40170,401))},J);it(Y,function(nt,ht,wt){if(!V){if(clearTimeout(tt),nt){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+d.inspectError(nt)),W(P(nt));return}if(typeof ht=="string"){ht.length===0?W(new m.default("Token string is empty",40170,401)):ht.length>L?W(new m.default("Token string exceeded max permitted length (was "+ht.length+" bytes)",40170,401)):ht==="undefined"||ht==="null"?W(new m.default("Token string was literal null/undefined",40170,401)):ht[0]==="{"&&!(wt&&wt.indexOf("application/jwt")>-1)?W(new m.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):W(null,{token:ht});return}if(typeof ht!="object"){var jt="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof ht;f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",jt),W(new m.default(jt,40170,401));return}var kt=JSON.stringify(ht).length;if(kt>L&&!j.suppressMaxLengthCheck){W(new m.default("Token request/details object exceeded max permitted stringified size (was "+kt+" bytes)",40170,401));return}if("issued"in ht){W(null,ht);return}if(!("keyName"in ht)){var jt="Expected token request callback to call back with a token string, token request object, or token details object";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",jt),W(new m.default(jt,40170,401));return}rt(ht,function(ee,re,Lt,ge){if(ee){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+d.inspectError(ee)),W(P(ee));return}ge||(re=JSON.parse(re)),f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","token received"),W(null,re)})}})},X.prototype.createTokenRequest=function(Y,j,I){var F=this;if(typeof Y=="function"&&!I?(I=Y,j=Y=null):typeof j=="function"&&!I&&(I=j,j=null),!I&&this.client.options.promises)return d.promisify(this,"createTokenRequest",arguments);j=j||this.authOptions,Y=Y||d.copy(this.tokenParams);var W=j.key;if(!W){I(new m.default("No key specified",40101,403));return}var it=W.split(":"),Z=it[0],at=it[1];if(!at){I(new m.default("Invalid key specified",40101,403));return}if(Y.clientId===""){I(new m.default("clientId cant be an empty string",40012,400));return}"capability"in Y&&(Y.capability=A(Y.capability));var rt=d.mixin({keyName:Z},Y),V=Y.clientId||"",J=Y.ttl||"",tt=Y.capability||"";(function(nt){if(rt.timestamp){nt();return}F.getTimestamp(j&&j.queryTime,function(ht,wt){if(ht){I(ht);return}rt.timestamp=wt,nt()})})(function(){var nt=rt.nonce||(rt.nonce=N()),ht=rt.timestamp,wt=rt.keyName+`
`+J+`
`+tt+`
`+V+`
`+ht+`
`+nt+`
`;rt.mac=rt.mac||O(wt,at),f.default.logAction(f.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),I(null,rt)})},X.prototype.getAuthParams=function(Y){this.method=="basic"?Y(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(j,I){if(j){Y(j);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");Y(null,{access_token:I.token})})},X.prototype.getAuthHeaders=function(Y){this.method=="basic"?Y(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(j,I){if(j){Y(j);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");Y(null,{authorization:"Bearer "+d.toBase64(I.token)})})},X.prototype.getTimestamp=function(Y,j){!this.isTimeOffsetSet()&&(Y||this.authOptions.queryTime)?this.client.time(j):j(null,this.getTimestampUsingOffset())},X.prototype.getTimestampUsingOffset=function(){return d.now()+(this.client.serverTimeOffset||0)},X.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},X.prototype._saveBasicOptions=function(Y){this.method="basic",this.key=Y.key,this.basicKey=d.toBase64(Y.key),this.authOptions=Y||{},"clientId"in Y&&this._userSetClientId(Y.clientId)},X.prototype._saveTokenOptions=function(Y,j){this.method="token",Y&&(this.tokenParams=Y),j&&(j.token&&(j.tokenDetails=typeof j.token=="string"?{token:j.token}:j.token),j.tokenDetails&&(this.tokenDetails=j.tokenDetails),"clientId"in j&&this._userSetClientId(j.clientId),this.authOptions=j)},X.prototype._ensureValidAuthCredentials=function(Y,j){var I=this,F=this.tokenDetails;if(F){if(this._tokenClientIdMismatch(F.clientId)){j(new m.default("Mismatch between clientId in token ("+F.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!F.expires||F.expires>=this.getTimestampUsingOffset()){f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+F.expires),j(null,F);return}f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=g.default.create())).push(j),!(this.currentTokenRequestId!==null&&!Y)){var W=this.currentTokenRequestId=K();this.requestToken(this.tokenParams,this.authOptions,function(it,Z){if(I.currentTokenRequestId>W){f.default.logAction(f.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}I.currentTokenRequestId=null;var at=I.waitingForTokenRequest||B;if(I.waitingForTokenRequest=null,it){at(it);return}at(null,I.tokenDetails=Z)})}},X.prototype._userSetClientId=function(Y){if(typeof Y=="string"||Y===null){if(Y==="*")throw new m.default('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var j=this._uncheckedSetClientId(Y);if(j)throw j}else throw new m.default("clientId must be either a string or null",40012,400)},X.prototype._uncheckedSetClientId=function(Y){if(this._tokenClientIdMismatch(Y)){var j="Unexpected clientId mismatch: client has "+this.clientId+", requested "+Y,I=new m.default(j,40102,401);return f.default.logAction(f.default.LOG_ERROR,"Auth._uncheckedSetClientId()",j),I}else return this.clientId=this.tokenParams.clientId=Y,null},X.prototype._tokenClientIdMismatch=function(Y){return!!(this.clientId&&this.clientId!=="*"&&Y&&Y!=="*"&&this.clientId!==Y)},X.isTokenErr=function(Y){return Y.code&&Y.code>=40140&&Y.code<40150},X.prototype.revokeTokens=function(Y,j,I){if(z(this.client.options))throw new m.default("Cannot revoke tokens when using token auth",40162,401);var F=this.client.options.keyName,W;if(typeof j=="function"?(I=j,W={}):W=j??{},I===void 0){if(this.client.options.promises)return d.promisify(this,"revokeTokens",[Y,W]);I=B}var it=I,Z=l.__assign({targets:Y.map(function(J){return"".concat(J.type,":").concat(J.value)})},W),at=this.client.options.useBinaryProtocol?d.Format.msgpack:d.Format.json,rt=d.defaultPostHeaders(this.client.options,at);this.client.options.headers&&d.mixin(rt,this.client.options.headers);var V=d.encodeBody(Z,at);D.default.post(this.client,"/keys/".concat(F,"/revokeTokens"),V,rt,{newBatchResponse:"true"},null,function(J,tt,nt,ht){if(J){it(J);return}var wt=ht?tt:d.decodeBody(tt,at);it(null,wt)})},X})();a.default=Q}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(f){f.Get="get",f.Delete="delete",f.Post="post",f.Put="put",f.Patch="patch"})(l||(l={})),a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.HttpPaginatedResponse=a.PaginatedResult=void 0;var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(15)),m=l.__importDefault(r(14));function _(L){var B=L.match(/^\.\/(\w+)\?(.*)$/);return B&&B[2]&&f.parseQueryString(B[2])}function C(L){typeof L=="string"&&(L=L.split(","));for(var B={},N=0;N<L.length;N++){var M=L[N].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(M){var P=_(M[1]);P&&(B[M[2]]=P)}}return B}function E(L,B,N){return!(N&&(B||typeof L.code=="number"))}var R=(function(){function L(B,N,M,P,O,A){this.rest=B,this.path=N,this.headers=M,this.envelope=P??null,this.bodyHandler=O,this.useHttpPaginatedResponse=A||!1}return L.prototype.get=function(B,N){var M=this;g.default.get(this.rest,this.path,this.headers,B,this.envelope,function(P,O,A,T,y){M.handlePage(P,O,A,T,y,N)})},L.prototype.delete=function(B,N){var M=this;g.default.delete(this.rest,this.path,this.headers,B,this.envelope,function(P,O,A,T,y){M.handlePage(P,O,A,T,y,N)})},L.prototype.post=function(B,N,M){var P=this;g.default.post(this.rest,this.path,N,this.headers,B,this.envelope,function(O,A,T,y,z){M&&P.handlePage(O,A,T,y,z,M)})},L.prototype.put=function(B,N,M){var P=this;g.default.put(this.rest,this.path,N,this.headers,B,this.envelope,function(O,A,T,y,z){M&&P.handlePage(O,A,T,y,z,M)})},L.prototype.patch=function(B,N,M){var P=this;g.default.patch(this.rest,this.path,N,this.headers,B,this.envelope,function(O,A,T,y,z){M&&P.handlePage(O,A,T,y,z,M)})},L.prototype.handlePage=function(B,N,M,P,O,A){if(B&&E(B,N,this.useHttpPaginatedResponse)){d.default.logAction(d.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+f.inspectError(B)),A==null||A(B);return}var T,y,z;try{T=O==m.default.NoContent?[]:this.bodyHandler(N,M||{},P)}catch(U){A==null||A(B||U);return}M&&(y=M.Link||M.link)&&(z=C(y)),this.useHttpPaginatedResponse?A(null,new D(this,T,M||{},O,z,B)):A(null,new v(this,T,z))},L})(),v=(function(){function L(B,N,M){var P=this;this.resource=B,this.items=N;var O=this;M&&("first"in M&&(this.first=function(A){if(!A&&O.resource.rest.options.promises)return f.promisify(O,"first",[]);O.get(M.first,A)}),"current"in M&&(this.current=function(A){if(!A&&O.resource.rest.options.promises)return f.promisify(O,"current",[]);O.get(M.current,A)}),this.next=function(A){if(!A&&O.resource.rest.options.promises)return f.promisify(O,"next",[]);"next"in M?O.get(M.next,A):A(null,null)},this.hasNext=function(){return"next"in M},this.isLast=function(){var A;return!(!((A=P.hasNext)===null||A===void 0)&&A.call(P))})}return L.prototype.get=function(B,N){var M=this.resource;g.default.get(M.rest,M.path,M.headers,B,M.envelope,function(P,O,A,T,y){M.handlePage(P,O,A,T,y,N)})},L})();a.PaginatedResult=v;var D=(function(L){l.__extends(B,L);function B(N,M,P,O,A,T){var y=L.call(this,N,M,A)||this;return y.statusCode=O,y.success=O<300&&O>=200,y.headers=P,y.errorCode=T&&T.code,y.errorMessage=T&&T.message,y}return B.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},B})(v);a.HttpPaginatedResponse=D,a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.isRetriable=void 0;var l=r(0),f=l.__importDefault(r(4)),d={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},g={disconnected:function(){return f.default.fromValues({statusCode:400,code:d.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return f.default.fromValues({statusCode:400,code:d.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return f.default.fromValues({statusCode:400,code:d.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return f.default.fromValues({statusCode:400,code:d.CLOSING,message:"Connection closing"})},closed:function(){return f.default.fromValues({statusCode:400,code:d.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return f.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return f.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function m(_){return!_.statusCode||!_.code||_.statusCode>=500?!0:Object.values(d).includes(_.code)}a.isRetriable=m,a.default=g}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(f){f[f.REQ_SEND=0]="REQ_SEND",f[f.REQ_RECV=1]="REQ_RECV",f[f.REQ_RECV_POLL=2]="REQ_RECV_POLL",f[f.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(l||(l={})),a.default=l}),(function(n,a,r){(function(l,f){n.exports=f(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(l){return l})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=(function(){function g(m){this.members=m||[]}return g.prototype.call=function(){for(var m=[],_=0;_<arguments.length;_++)m[_]=arguments[_];for(var C=0,E=this.members;C<E.length;C++){var R=E[C];if(R)try{R.apply(void 0,m)}catch(v){f.default.logAction(f.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+v+"; stack = "+v.stack)}}},g.prototype.push=function(){for(var m,_=[],C=0;C<arguments.length;C++)_[C]=arguments[C];(m=this.members).push.apply(m,_)},g.create=function(m){var _=new g(m);return Object.assign(function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];return _.call.apply(_,C)},{push:function(C){return _.push(C)}})},g})();a.default=d}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){(function(){var f=l,d=f.lib,g=d.Base,m=f.enc,_=m.Utf8,C=f.algo;C.HMAC=g.extend({init:function(E,R){E=this._hasher=new E.init,typeof R=="string"&&(R=_.parse(R));var v=E.blockSize,D=v*4;R.sigBytes>D&&(R=E.finalize(R)),R.clamp();for(var L=this._oKey=R.clone(),B=this._iKey=R.clone(),N=L.words,M=B.words,P=0;P<v;P++)N[P]^=1549556828,M[P]^=909522486;L.sigBytes=B.sigBytes=D,this.reset()},reset:function(){var E=this._hasher;E.reset(),E.update(this._iKey)},update:function(E){return this._hasher.update(E),this},finalize:function(E){var R=this._hasher,v=R.finalize(E);R.reset();var D=R.finalize(this._oKey.clone().concat(v));return D}})})()})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(21)),C=l.__importDefault(r(4)),E=l.__importDefault(r(3)),R=f.default.Action,v=f.default.fromValues({action:R.CLOSE}),D=f.default.fromValues({action:R.DISCONNECT}),L=(function(B){l.__extends(N,B);function N(M,P,O,A){var T=B.call(this)||this;return A&&(O.format=void 0,O.heartbeats=!0),T.connectionManager=M,M.registerProposedTransport(T),T.auth=P,T.params=O,T.timeouts=O.options.timeouts,T.format=O.format,T.isConnected=!1,T.isFinished=!1,T.isDisposed=!1,T.maxIdleInterval=null,T.idleTimer=null,T.lastActivity=null,T}return N.prototype.connect=function(){},N.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",_.default.closed())},N.prototype.disconnect=function(M){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",M||_.default.disconnected())},N.prototype.fail=function(M){this.isConnected&&this.requestDisconnect(),this.finish("failed",M||_.default.failed())},N.prototype.finish=function(M,P){var O;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((O=this.idleTimer)!==null&&O!==void 0?O:void 0),this.idleTimer=null,this.emit(M,P),this.dispose())},N.prototype.onProtocolMessage=function(M){switch(m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+f.default.stringify(M)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),M.action){case R.HEARTBEAT:m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",M.id);break;case R.CONNECTED:this.onConnect(M),this.emit("connected",M.error,M.connectionId,M.connectionDetails,M);break;case R.CLOSED:this.onClose(M);break;case R.DISCONNECTED:this.onDisconnect(M);break;case R.ACK:this.emit("ack",M.msgSerial,M.count);break;case R.NACK:this.emit("nack",M.msgSerial,M.count,M.error);break;case R.SYNC:this.connectionManager.onChannelMessage(M,this);break;case R.ACTIVATE:break;case R.AUTH:this.auth.authorize(function(P){P&&m.default.logAction(m.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+d.inspectError(P))});break;case R.ERROR:if(m.default.logAction(m.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(M.error)+(M.channel?", channel: "+M.channel:"")),M.channel===void 0){this.onFatalError(M);break}this.connectionManager.onChannelMessage(M,this);break;default:this.connectionManager.onChannelMessage(M,this)}},N.prototype.onConnect=function(M){if(this.isConnected=!0,!M.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var P=M.connectionDetails.maxIdleInterval;P&&(this.maxIdleInterval=P+this.timeouts.realtimeRequestTimeout,this.onActivity())},N.prototype.onDisconnect=function(M){var P=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onDisconnect()","err = "+d.inspectError(P)),this.finish("disconnected",P)},N.prototype.onFatalError=function(M){var P=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onFatalError()","err = "+d.inspectError(P)),this.finish("failed",P)},N.prototype.onClose=function(M){var P=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onClose()","err = "+d.inspectError(P)),this.finish("closed",P)},N.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestClose()",""),this.send(v)},N.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(D)},N.prototype.ping=function(M){var P={action:f.default.Action.HEARTBEAT};M&&(P.id=M),this.send(f.default.fromValues(P))},N.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},N.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=d.now(),this.setIdleTimer(this.maxIdleInterval+100))},N.prototype.setIdleTimer=function(M){var P=this;this.idleTimer||(this.idleTimer=setTimeout(function(){P.onIdleTimerExpire()},M))},N.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var M=d.now()-this.lastActivity,P=this.maxIdleInterval-M;if(P<=0){var O="No activity seen from realtime in "+M+"ms; assuming connection has dropped";m.default.logAction(m.default.LOG_ERROR,"Transport.onIdleTimerExpire()",O),this.disconnect(new C.default(O,80003,408))}else this.setIdleTimer(P+100)},N.tryConnect=function(M,P,O,A,T){var y=new M(P,O,A),z,U=function(K){clearTimeout(z),T({event:this.event,error:K})},G=P.options.timeouts.realtimeRequestTimeout;z=setTimeout(function(){y.off(["preconnect","disconnected","failed"]),y.dispose(),U.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},G),y.on(["failed","disconnected"],U),y.on("preconnect",function(){m.default.logAction(m.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+y),clearTimeout(z),y.off(["failed","disconnected"],U),T(null,y)}),y.connect()},N})(g.default);a.default=L}),(function(n,a,r){(function(l,f){n.exports=f(r(6),r(40),r(25))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.Base,m=d.WordArray,_=f.algo,C=_.MD5,E=_.EvpKDF=g.extend({cfg:g.extend({keySize:128/32,hasher:C,iterations:1}),init:function(R){this.cfg=this.cfg.extend(R)},compute:function(R,v){for(var D,L=this.cfg,B=L.hasher.create(),N=m.create(),M=N.words,P=L.keySize,O=L.iterations;M.length<P;){D&&B.update(D),D=B.update(R).finalize(v),B.reset();for(var A=1;A<O;A++)D=B.finalize(D),B.reset();N.concat(D)}return N.sigBytes=P*4,N}});f.EvpKDF=function(R,v,D){return E.create(D).compute(R,v)}})(),l.EvpKDF})}),(function(n,a,r){(function(l,f){n.exports=f(r(6),r(27))})(this,function(l){l.lib.Cipher||(function(f){var d=l,g=d.lib,m=g.Base,_=g.WordArray,C=g.BufferedBlockAlgorithm,E=d.enc;E.Utf8;var R=E.Base64,v=d.algo,D=v.EvpKDF,L=g.Cipher=C.extend({cfg:m.extend(),createEncryptor:function(Q,X){return this.create(this._ENC_XFORM_MODE,Q,X)},createDecryptor:function(Q,X){return this.create(this._DEC_XFORM_MODE,Q,X)},init:function(Q,X,Y){this.cfg=this.cfg.extend(Y),this._xformMode=Q,this._key=X,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(Q){return this._append(Q),this._process()},finalize:function(Q){Q&&this._append(Q);var X=this._doFinalize();return X},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function Q(X){return typeof X=="string"?K:z}return function(X){return{encrypt:function(Y,j,I){return Q(j).encrypt(X,Y,j,I)},decrypt:function(Y,j,I){return Q(j).decrypt(X,Y,j,I)}}}})()});g.StreamCipher=L.extend({_doFinalize:function(){var Q=this._process(!0);return Q},blockSize:1});var B=d.mode={},N=g.BlockCipherMode=m.extend({createEncryptor:function(Q,X){return this.Encryptor.create(Q,X)},createDecryptor:function(Q,X){return this.Decryptor.create(Q,X)},init:function(Q,X){this._cipher=Q,this._iv=X}}),M=B.CBC=(function(){var Q=N.extend();Q.Encryptor=Q.extend({processBlock:function(Y,j){var I=this._cipher,F=I.blockSize;X.call(this,Y,j,F),I.encryptBlock(Y,j),this._prevBlock=Y.slice(j,j+F)}}),Q.Decryptor=Q.extend({processBlock:function(Y,j){var I=this._cipher,F=I.blockSize,W=Y.slice(j,j+F);I.decryptBlock(Y,j),X.call(this,Y,j,F),this._prevBlock=W}});function X(Y,j,I){var F,W=this._iv;W?(F=W,this._iv=f):F=this._prevBlock;for(var it=0;it<I;it++)Y[j+it]^=F[it]}return Q})(),P=d.pad={},O=P.Pkcs7={pad:function(Q,X){for(var Y=X*4,j=Y-Q.sigBytes%Y,I=j<<24|j<<16|j<<8|j,F=[],W=0;W<j;W+=4)F.push(I);var it=_.create(F,j);Q.concat(it)},unpad:function(Q){var X=Q.words[Q.sigBytes-1>>>2]&255;Q.sigBytes-=X}};g.BlockCipher=L.extend({cfg:L.cfg.extend({mode:M,padding:O}),reset:function(){var Q;L.reset.call(this);var X=this.cfg,Y=X.iv,j=X.mode;this._xformMode==this._ENC_XFORM_MODE?Q=j.createEncryptor:(Q=j.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Q?this._mode.init(this,Y&&Y.words):(this._mode=Q.call(j,this,Y&&Y.words),this._mode.__creator=Q)},_doProcessBlock:function(Q,X){this._mode.processBlock(Q,X)},_doFinalize:function(){var Q,X=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(X.pad(this._data,this.blockSize),Q=this._process(!0)):(Q=this._process(!0),X.unpad(Q)),Q},blockSize:128/32});var A=g.CipherParams=m.extend({init:function(Q){this.mixIn(Q)},toString:function(Q){return(Q||this.formatter).stringify(this)}}),T=d.format={},y=T.OpenSSL={stringify:function(Q){var X,Y=Q.ciphertext,j=Q.salt;return j?X=_.create([1398893684,1701076831]).concat(j).concat(Y):X=Y,X.toString(R)},parse:function(Q){var X,Y=R.parse(Q),j=Y.words;return j[0]==1398893684&&j[1]==1701076831&&(X=_.create(j.slice(2,4)),j.splice(0,4),Y.sigBytes-=16),A.create({ciphertext:Y,salt:X})}},z=g.SerializableCipher=m.extend({cfg:m.extend({format:y}),encrypt:function(Q,X,Y,j){j=this.cfg.extend(j);var I=Q.createEncryptor(Y,j),F=I.finalize(X),W=I.cfg;return A.create({ciphertext:F,key:Y,iv:W.iv,algorithm:Q,mode:W.mode,padding:W.padding,blockSize:Q.blockSize,formatter:j.format})},decrypt:function(Q,X,Y,j){j=this.cfg.extend(j),X=this._parse(X,j.format);var I=Q.createDecryptor(Y,j).finalize(X.ciphertext);return I},_parse:function(Q,X){return typeof Q=="string"?X.parse(Q,this):Q}}),U=d.kdf={},G=U.OpenSSL={execute:function(Q,X,Y,j){j||(j=_.random(64/8));var I=D.create({keySize:X+Y}).compute(Q,j),F=_.create(I.words.slice(X),Y*4);return I.sigBytes=X*4,A.create({key:I,iv:F,salt:j})}},K=g.PasswordBasedCipher=z.extend({cfg:z.cfg.extend({kdf:G}),encrypt:function(Q,X,Y,j){j=this.cfg.extend(j);var I=j.kdf.execute(Y,Q.keySize,Q.ivSize);j.iv=I.iv;var F=z.encrypt.call(this,Q,X,I.key,j);return F.mixIn(I),F},decrypt:function(Q,X,Y,j){j=this.cfg.extend(j),X=this._parse(X,j.format);var I=j.kdf.execute(Y,Q.keySize,Q.ivSize,X.salt);j.iv=I.iv;var F=z.decrypt.call(this,Q,X,I.key,j);return F}})})()})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.Request=a.createRequest=void 0;var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(12)),g=l.__importDefault(r(3)),m=l.__importDefault(r(7)),_=r(4),C=l.__importDefault(r(8)),E=l.__importDefault(r(2)),R=l.__importDefault(r(22)),v=f.getGlobalObject(),D=function(){},L=v._ablyjs_jsonp={};L._=function(T){return L["_"+T]||D};var B=1,N="jsonp";function M(T,y,z,U,G,K,Q){return K=K||C.default.TIMEOUTS,new O(void 0,T,y,f.copy(z),U,G,K,Q)}a.createRequest=M;var P=(function(T){l.__extends(y,T);function y(z,U,G){var K=T.call(this,z,U,G)||this;return K.shortName=N,G.stream=!1,K}return y.isAvailable=function(){return g.default.Config.jsonpSupported&&g.default.Config.allowComet},y.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},y.prototype.createRequest=function(z,U,G,K,Q,X,Y){return X=(this===null||this===void 0?void 0:this.timeouts)||X||C.default.TIMEOUTS,M(z,U,G,K,Q,X,Y)},y})(d.default),O=(function(T){l.__extends(y,T);function y(z,U,G,K,Q,X,Y,j){var I=T.call(this)||this;return z===void 0&&(z=B++),I.id=z,I.uri=U,I.params=K||{},I.params.rnd=f.cheapRandStr(),G&&(G["X-Ably-Version"]&&(I.params.v=G["X-Ably-Version"]),G["X-Ably-Lib"]&&(I.params.lib=G["X-Ably-Lib"])),I.body=Q,I.method=j,I.requestMode=X,I.timeouts=Y,I.requestComplete=!1,I}return y.prototype.exec=function(){var z=this,U=this.id,G=this.body,K=this.method,Q=this.uri,X=this.params;X.callback="_ablyjs_jsonp._("+U+")",X.envelope="jsonp",G&&(X.body=G),K&&K!=="get"&&(X.method=K);var Y=this.script=document.createElement("script"),j=Q+f.toQueryString(X);Y.src=j,Y.src.split("/").slice(-1)[0]!==j.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),Y.async=!0,Y.type="text/javascript",Y.charset="UTF-8",Y.onerror=function(W){z.complete(new _.PartialErrorInfo("JSONP script error (event: "+g.default.Config.inspect(W)+")",null,400))},L["_"+U]=function(W){if(W.statusCode){var it=W.response;if(W.statusCode==204)z.complete(null,null,null,W.statusCode);else if(!it)z.complete(new _.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(W.statusCode<400||f.isArray(it))z.complete(null,it,W.headers,W.statusCode);else{var Z=it.error||new _.PartialErrorInfo("Error response received from server",null,W.statusCode);z.complete(Z)}}else z.complete(null,W)};var I=this.requestMode==R.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),I);var F=document.getElementsByTagName("head")[0];F.insertBefore(Y,F.firstChild)},y.prototype.complete=function(z,U,G,K){if(G=G||{},!this.requestComplete){this.requestComplete=!0;var Q=void 0;U&&(Q=typeof U=="string"?"text/plain":"application/json",G["content-type"]=Q,this.emit("data",U)),this.emit("complete",z,U,G,!0,K),this.dispose()}},y.prototype.abort=function(){this.dispose()},y.prototype.dispose=function(){var z=this.timer;z&&(clearTimeout(z),this.timer=null);var U=this.script;U.parentNode&&U.parentNode.removeChild(U),delete L[this.id],this.emit("disposed")},y})(m.default);a.Request=O;function A(T){return v.JSONPTransport=P,P.isAvailable()&&(T.supportedTransports[N]=P),P}a.default=A}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(8)),m=l.__importDefault(r(18)),_=l.__importDefault(r(46)),C=l.__importDefault(r(20)),E=l.__importDefault(r(33)),R=l.__importDefault(r(4)),v=l.__importDefault(r(49)),D=l.__importDefault(r(19)),L=l.__importDefault(r(3)),B=l.__importDefault(r(9)),N=l.__importDefault(r(16)),M=l.__importDefault(r(15)),P=function(){},O=(function(){function T(y){if(!y){var z="no options provided";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",z),new Error(z)}var U=g.default.objectifyOptions(y);U.log?(d.default.setLog(U.log.level,U.log.handler),d.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):d.default.setLog(U.logLevel,U.logHandler),d.default.logAction(d.default.LOG_MICRO,"Rest()","initialized with clientOptions "+L.default.Config.inspect(y));var G=this.options=g.default.normaliseOptions(U);if(G.key){var K=G.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!K){var z="invalid key parameter";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",z),new R.default(z,40400,404)}G.keyName=K[1],G.keySecret=K[2]}if("clientId"in G)if(typeof G.clientId=="string"||G.clientId===null){if(G.clientId==="*")throw new R.default('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new R.default("clientId must be either a string or null",40012,400);d.default.logAction(d.default.LOG_MINOR,"Rest()","started; version = "+g.default.version),this.baseUri=this.authority=function(Q){return g.default.getHttpScheme(G)+Q+":"+g.default.getPort(G,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new L.default.Http(G),this.auth=new m.default(this,G),this.channels=new A(this),this.push=new _.default(this)}return T.prototype.stats=function(y,z){if(z===void 0)if(typeof y=="function")z=y,y=null;else{if(this.options.promises)return f.promisify(this,"stats",[y]);z=P}var U=f.defaultGetHeaders(this.options),G=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,K=this.http.supportsLinkHeaders?void 0:G;this.options.headers&&f.mixin(U,this.options.headers),new C.default(this,"/stats",U,K,function(Q,X,Y){for(var j=Y?Q:JSON.parse(Q),I=0;I<j.length;I++)j[I]=v.default.fromValues(j[I]);return j}).get(y,z)},T.prototype.time=function(y,z){var U=this;if(z===void 0){if(typeof y=="function")z=y,y=null;else if(this.options.promises)return f.promisify(this,"time",[y])}var G=z||P,K=f.defaultGetHeaders(this.options);this.options.headers&&f.mixin(K,this.options.headers);var Q=function(X){return U.authority(X)+"/time"};this.http.do(D.default.Get,this,Q,K,null,y,function(X,Y,j,I){if(X){G(X);return}I||(Y=JSON.parse(Y));var F=Y[0];if(!F){G(new R.default("Internal error (unexpected result type from GET /time)",5e4,500));return}U.serverTimeOffset=F-f.now(),G(null,F)})},T.prototype.request=function(y,z,U,G,K,Q){var X=this.options.useBinaryProtocol,Y=X?L.default.Config.msgpack.encode:JSON.stringify,j=X?L.default.Config.msgpack.decode:JSON.parse,I=X?f.Format.msgpack:f.Format.json,F=this.http.supportsLinkHeaders?void 0:I;U=U||{};var W=y.toLowerCase(),it=W=="get"?f.defaultGetHeaders(this.options,I):f.defaultPostHeaders(this.options,I);if(Q===void 0){if(this.options.promises)return f.promisify(this,"request",[y,z,U,G,K]);Q=P}typeof G!="string"&&(G=Y(G)),this.options.headers&&f.mixin(it,this.options.headers),K&&f.mixin(it,K);var Z=new C.default(this,z,it,F,function(at,rt,V){return f.ensureArray(V?at:j(at))},!0);if(!f.arrIn(L.default.Http.methods,W))throw new R.default("Unsupported method "+W,40500,405);f.arrIn(L.default.Http.methodsWithBody,W)?Z[W](U,G,Q):Z[W](U,Q)},T.prototype.batchPublish=function(y,z){if(z===void 0){if(this.options.promises)return f.promisify(this,"batchPublish",[y]);z=P}var U=z,G,K;f.isArray(y)?(G=y,K=!1):(G=[y],K=!0);var Q=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,X=f.defaultPostHeaders(this.options,Q);this.options.headers&&f.mixin(X,this.options.headers);var Y=f.encodeBody(G,Q);M.default.post(this,"/messages",Y,X,{newBatchResponse:"true"},null,function(j,I,F,W){if(j){U(j);return}var it=W?I:f.decodeBody(I,Q);K?U(null,it[0]):U(null,it)})},T.prototype.batchPresence=function(y,z){if(z===void 0){if(this.options.promises)return f.promisify(this,"batchPresence",[y]);z=P}var U=z,G=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,K=f.defaultPostHeaders(this.options,G);this.options.headers&&f.mixin(K,this.options.headers);var Q=y.join(",");M.default.get(this,"/presence",K,{newBatchResponse:"true",channels:Q},null,function(X,Y,j,I){if(X){U(X);return}var F=I?Y:f.decodeBody(Y,G);U(null,F)})},T.prototype.setLog=function(y){d.default.setLog(y.level,y.handler)},T.Promise=function(y){return y=g.default.objectifyOptions(y),y.promises=!0,new T(y)},T.Callbacks=T,T.Platform=L.default,T.Message=B.default,T.PresenceMessage=N.default,T})(),A=(function(){function T(y){this.rest=y,this.all=Object.create(null)}return T.prototype.get=function(y,z){y=String(y);var U=this.all[y];return U?z&&U.setOptions(z):this.all[y]=U=new E.default(this.rest,y,z),U},T.prototype.release=function(y){delete this.all[String(y)]},T})();a.default=O}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return l.enc.Utf8})}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[],R=[];(function(){function L(P){for(var O=f.sqrt(P),A=2;A<=O;A++)if(!(P%A))return!1;return!0}function B(P){return(P-(P|0))*4294967296|0}for(var N=2,M=0;M<64;)L(N)&&(M<8&&(E[M]=B(f.pow(N,1/2))),R[M]=B(f.pow(N,1/3)),M++),N++})();var v=[],D=C.SHA256=_.extend({_doReset:function(){this._hash=new m.init(E.slice(0))},_doProcessBlock:function(L,B){for(var N=this._hash.words,M=N[0],P=N[1],O=N[2],A=N[3],T=N[4],y=N[5],z=N[6],U=N[7],G=0;G<64;G++){if(G<16)v[G]=L[B+G]|0;else{var K=v[G-15],Q=(K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3,X=v[G-2],Y=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;v[G]=Q+v[G-7]+Y+v[G-16]}var j=T&y^~T&z,I=M&P^M&O^P&O,F=(M<<30|M>>>2)^(M<<19|M>>>13)^(M<<10|M>>>22),W=(T<<26|T>>>6)^(T<<21|T>>>11)^(T<<7|T>>>25),it=U+W+j+R[G]+v[G],Z=F+I;U=z,z=y,y=T,T=A+it|0,A=O,O=P,P=M,M=it+Z|0}N[0]=N[0]+M|0,N[1]=N[1]+P|0,N[2]=N[2]+O|0,N[3]=N[3]+A|0,N[4]=N[4]+T|0,N[5]=N[5]+y|0,N[6]=N[6]+z|0,N[7]=N[7]+U|0},_doFinalize:function(){var L=this._data,B=L.words,N=this._nDataBytes*8,M=L.sigBytes*8;return B[M>>>5]|=128<<24-M%32,B[(M+64>>>9<<4)+14]=f.floor(N/4294967296),B[(M+64>>>9<<4)+15]=N,L.sigBytes=B.length*4,this._process(),this._hash},clone:function(){var L=_.clone.call(this);return L._hash=this._hash.clone(),L}});d.SHA256=_._createHelper(D),d.HmacSHA256=_._createHmacHelper(D)})(Math),l.SHA256})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(34)),_=l.__importDefault(r(9)),C=l.__importDefault(r(4)),E=l.__importDefault(r(20)),R=l.__importDefault(r(15)),v=l.__importDefault(r(3));function D(){}var L=9;function B(P){return f.arrEvery(P,function(O){return!O.id})}function N(P){var O=P||{};if(O.cipher){if(!v.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var A=v.default.Crypto.getCipher(O.cipher);O.cipher=A.cipherParams,O.channelCipher=A.cipher}else"cipher"in O&&(O.cipher=void 0,O.channelCipher=null);return O}var M=(function(P){l.__extends(O,P);function O(A,T,y){var z=P.call(this)||this;return g.default.logAction(g.default.LOG_MINOR,"Channel()","started; name = "+T),z.rest=A,z.name=T,z.basePath="/channels/"+encodeURIComponent(T),z.presence=new m.default(z),z.channelOptions=N(y),z}return O.prototype.setOptions=function(A){this.channelOptions=N(A)},O.prototype.history=function(A,T){if(g.default.logAction(g.default.LOG_MICRO,"Channel.history()","channel = "+this.name),T===void 0)if(typeof A=="function")T=A,A=null;else{if(this.rest.options.promises)return f.promisify(this,"history",arguments);T=D}this._history(A,T)},O.prototype._history=function(A,T){var y=this.rest,z=y.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,U=this.rest.http.supportsLinkHeaders?void 0:z,G=f.defaultGetHeaders(y.options,z);y.options.headers&&f.mixin(G,y.options.headers);var K=this.channelOptions;new E.default(y,this.basePath+"/messages",G,U,function(Q,X,Y){return _.default.fromResponseBody(Q,K,Y?void 0:z)}).get(A,T)},O.prototype.publish=function(){var A=this,T=arguments.length,y=arguments[0],z=arguments[1],U=arguments[T-1],G,K;if(typeof U!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);U=D}if(typeof y=="string"||y===null)G=[_.default.fromValues({name:y,data:z})],K=arguments[2];else if(f.isObject(y))G=[_.default.fromValues(y)],K=arguments[1];else if(f.isArray(y))G=_.default.fromValuesArray(y),K=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof K!="object"||!K)&&(K={});var Q=this.rest,X=Q.options,Y=X.useBinaryProtocol?f.Format.msgpack:f.Format.json,j=Q.options.idempotentRestPublishing,I=f.defaultPostHeaders(Q.options,Y);if(X.headers&&f.mixin(I,X.headers),j&&B(G)){var F=f.randomString(L);f.arrForEach(G,function(W,it){W.id=F+":"+it.toString()})}_.default.encodeArray(G,this.channelOptions,function(W){if(W){U(W);return}var it=_.default.getMessagesSize(G),Z=X.maxMessageSize;if(it>Z){U(new C.default("Maximum size of messages that can be published at once exceeded ( was "+it+" bytes; limit is "+Z+" bytes)",40009,400));return}A._publish(_.default.serialize(G,Y),I,K,U)})},O.prototype._publish=function(A,T,y,z){R.default.post(this.rest,this.basePath+"/messages",A,T,y,null,z)},O.prototype.status=function(A){if(typeof A!="function"&&this.rest.options.promises)return f.promisify(this,"status",[]);var T=this.rest.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,y=f.defaultPostHeaders(this.rest.options,T);R.default.get(this.rest,this.basePath,y,{},T,A||D)},O})(d.default);a.default=M}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(20)),_=l.__importDefault(r(16));function C(){}var E=(function(R){l.__extends(v,R);function v(D){var L=R.call(this)||this;return L.channel=D,L.basePath=D.basePath+"/presence",L}return v.prototype.get=function(D,L){if(g.default.logAction(g.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),L===void 0)if(typeof D=="function")L=D,D=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"get",arguments);L=C}var B=this.channel.rest,N=B.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:N,P=f.defaultGetHeaders(B.options,N);B.options.headers&&f.mixin(P,B.options.headers);var O=this.channel.channelOptions;new m.default(B,this.basePath,P,M,function(A,T,y){return _.default.fromResponseBody(A,O,y?void 0:N)}).get(D,L)},v.prototype.history=function(D,L){return g.default.logAction(g.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(D,L)},v.prototype._history=function(D,L){if(L===void 0)if(typeof D=="function")L=D,D=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"_history",[D]);L=C}var B=this.channel.rest,N=B.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:N,P=f.defaultGetHeaders(B.options,N);B.options.headers&&f.mixin(P,B.options.headers);var O=this.channel.channelOptions;new m.default(B,this.basePath+"/history",P,M,function(A,T,y){return _.default.fromResponseBody(A,O,y?void 0:N)}).get(D,L)},v})(d.default);a.default=E}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0}),a.TransportParams=void 0;var f=r(0),d=f.__importDefault(r(10)),g=f.__importStar(r(1)),m=f.__importStar(r(52)),_=f.__importStar(r(8)),C=f.__importDefault(r(3)),E=f.__importDefault(r(7)),R=f.__importDefault(r(36)),v=f.__importDefault(r(2)),D=f.__importDefault(r(37)),L=f.__importStar(r(21)),B=f.__importStar(r(4)),N=f.__importDefault(r(18)),M=f.__importDefault(r(9)),P=f.__importDefault(r(24)),O=f.__importDefault(r(53)),A=f.__importDefault(r(26)),T=f.__importDefault(r(14)),y=function(){var at;return typeof C.default.WebStorage<"u"&&((at=C.default.WebStorage)===null||at===void 0?void 0:at.localSupported)},z=function(){var at;return typeof C.default.WebStorage<"u"&&((at=C.default.WebStorage)===null||at===void 0?void 0:at.sessionSupported)},U=d.default.Action,G=function(){},K="ably-transport-preference",Q="ably-connection-recovery";function X(){var at,rt;return z()&&((rt=(at=C.default.WebStorage)===null||at===void 0?void 0:at.getSession)===null||rt===void 0?void 0:rt.call(at,Q))}function Y(at){var rt,V;return z()&&((V=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.setSession)===null||V===void 0?void 0:V.call(rt,Q,at))}function j(){var at,rt;return z()&&((rt=(at=C.default.WebStorage)===null||at===void 0?void 0:at.removeSession)===null||rt===void 0?void 0:rt.call(at,Q))}function I(at,rt){return g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,at.shortName)>g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,rt.shortName)}function F(at,rt,V){var J;if(at.channel!==rt.channel||(J=at.action)!==U.PRESENCE&&J!==U.MESSAGE||J!==rt.action)return!1;var tt=J===U.PRESENCE?"presence":"messages",nt=at[tt].concat(rt[tt]),ht=M.default.getMessagesSize(nt);return ht>V||!g.allSame(nt,"clientId")||!g.arrEvery(nt,function(wt){return!wt.id})?!1:(at[tt]=nt,!0)}function W(at){try{return JSON.parse(at)}catch{return null}}var it=(function(){function at(rt,V,J,tt){this.options=rt,this.host=V,this.mode=J,this.connectionKey=tt,this.format=rt.useBinaryProtocol?g.Format.msgpack:g.Format.json}return at.prototype.getConnectParams=function(rt){var V=rt?g.copy(rt):{},J=this.options;switch(this.mode){case"upgrade":V.upgrade=this.connectionKey;break;case"resume":V.resume=this.connectionKey;break;case"recover":{var tt=W(J.recover);tt&&(V.recover=tt.connectionKey);break}}return J.clientId!==void 0&&(V.clientId=J.clientId),J.echoMessages===!1&&(V.echo="false"),this.format!==void 0&&(V.format=this.format),this.stream!==void 0&&(V.stream=this.stream),this.heartbeats!==void 0&&(V.heartbeats=this.heartbeats),V.v=_.default.protocolVersion,V.agent=(0,_.getAgentString)(this.options),J.transportParams!==void 0&&g.mixin(V,J.transportParams),V},at.prototype.toString=function(){var rt="[mode="+this.mode;return this.host&&(rt+=",host="+this.host),this.connectionKey&&(rt+=",connectionKey="+this.connectionKey),this.format&&(rt+=",format="+this.format),rt+="]",rt},at})();a.TransportParams=it;var Z=(function(at){f.__extends(rt,at);function rt(V,J){var tt=at.call(this)||this;tt.disconnectedRetryCount=0,rt.initTransports(),tt.realtime=V,tt.options=J;var nt=J.timeouts,ht=nt.preferenceConnectTimeout+nt.realtimeRequestTimeout;if(tt.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:ht,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:nt.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},tt.state=tt.states.initialized,tt.errorReason=null,tt.queuedMessages=new R.default,tt.msgSerial=0,tt.connectionDetails=void 0,tt.connectionId=void 0,tt.connectionKey=void 0,tt.connectionStateTtl=nt.connectionStateTtl,tt.maxIdleInterval=null,tt.transports=g.intersect(J.transports||_.default.defaultTransports,rt.supportedTransports),tt.baseTransport=g.intersect(_.default.baseTransportOrder,tt.transports)[0],tt.upgradeTransports=g.intersect(tt.transports,_.default.upgradeTransports),tt.transportPreference=null,tt.httpHosts=_.default.getHosts(J),tt.activeProtocol=null,tt.proposedTransports=[],tt.pendingTransports=[],tt.host=null,tt.lastAutoReconnectAttempt=null,tt.lastActivity=null,tt.forceFallbackHost=!1,tt.connectCounter=0,v.default.logAction(v.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(J.transports||_.default.defaultTransports)+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+tt.transports+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+tt.httpHosts+"]"),!tt.transports.length){var wt="no requested transports available";throw v.default.logAction(v.default.LOG_ERROR,"realtime.ConnectionManager()",wt),new Error(wt)}var jt=C.default.Config.addEventListener;return jt&&(z()&&typeof J.recover=="function"&&jt("beforeunload",tt.persistConnection.bind(tt)),J.closeOnUnload===!0&&jt("beforeunload",function(){v.default.logAction(v.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),tt.requestState({state:"closing"})}),jt("online",function(){tt.state==tt.states.disconnected||tt.state==tt.states.suspended?(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser online event","reattempting connection"),tt.requestState({state:"connecting"})):tt.state==tt.states.connecting&&(tt.pendingTransports.forEach(function(kt){kt.off()}),tt.disconnectAllTransports(),tt.startConnect())}),jt("offline",function(){tt.state==tt.states.connected&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser offline event","disconnecting active transport"),tt.disconnectAllTransports())})),tt}return rt.initTransports=function(){(0,O.default)(rt),g.arrForEach(C.default.Transports,function(V){V(rt)})},rt.prototype.createTransportParams=function(V,J){return new it(this.options,V,J,this.connectionKey)},rt.prototype.getTransportParams=function(V){var J=this,tt=function(nt){if(J.connectionKey){nt("resume");return}if(typeof J.options.recover=="string"){nt("recover");return}var ht=J.options.recover,wt=X();if(wt&&typeof ht=="function"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),ht(wt,function(jt){jt?(J.options.recover=wt.recoveryKey,nt("recover")):nt("clean")});return}nt("clean")};tt(function(nt){var ht=J.createTransportParams(null,nt);if(nt==="recover"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+J.options.recover);var wt=W(J.options.recover);wt&&(J.msgSerial=wt.msgSerial)}else v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+ht.toString());V(ht)})},rt.prototype.tryATransport=function(V,J,tt){var nt=this;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+J),A.default.tryConnect(rt.supportedTransports[J],this,this.realtime.auth,V,function(ht,wt){var jt=nt.state;if(jt==nt.states.closing||jt==nt.states.closed||jt==nt.states.failed){wt&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+jt.state+" while we were attempting the transport; closing "+wt),wt.close()),tt(!0);return}if(ht){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+J+" "+ht.event+", err: "+ht.error.toString()),N.default.isTokenErr(ht.error)&&!(nt.errorReason&&N.default.isTokenErr(nt.errorReason))?(nt.errorReason=ht.error,nt.realtime.auth._forceNewToken(null,null,function(kt){if(kt){nt.actOnErrorFromAuthorize(kt);return}nt.tryATransport(V,J,tt)})):ht.event==="failed"?(nt.notifyState({state:"failed",error:ht.error}),tt(!0)):ht.event==="disconnected"&&((0,L.isRetriable)(ht.error)?tt(!1):(nt.notifyState({state:nt.states.connecting.failState,error:ht.error}),tt(!0)));return}v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+J+"; setting pending"),nt.setTransportPending(wt,V),tt(null,wt)})},rt.prototype.setTransportPending=function(V,J){var tt=this,nt=J.mode;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+V+"; mode = "+nt),g.arrDeleteValue(this.proposedTransports,V),this.pendingTransports.push(V);var ht=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];V.once("connected",function(jt,kt,ee){nt=="upgrade"&&tt.activeProtocol?V.shortName!==ht&&g.arrIn(tt.getUpgradePossibilities(),ht)&&tt.activeProtocol?setTimeout(function(){tt.scheduleTransportActivation(jt,V,kt,ee)},tt.options.timeouts.parallelUpgradeDelay):tt.scheduleTransportActivation(jt,V,kt,ee):(tt.activateTransport(jt,V,kt,ee),C.default.Config.nextTick(function(){tt.connectImpl(J)})),nt==="recover"&&tt.options.recover&&(tt.options.recover=null,tt.unpersistConnection())});var wt=this;V.on(["disconnected","closed","failed"],function(jt){wt.deactivateTransport(V,this.event,jt)}),this.emit("transport.pending",V)},rt.prototype.scheduleTransportActivation=function(V,J,tt,nt){var ht=this,wt=this.activeProtocol&&this.activeProtocol.getTransport(),jt=function(){J.disconnect(),g.arrDeleteValue(ht.pendingTransports,J)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),jt();return}if(wt&&!I(J,wt)){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+" is no better than current active transport "+wt.shortName+" - abandoning upgrade"),jt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+J);var kt=null;if(!J.isConnected){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+"is no longer connected; abandoning upgrade"),jt();return}if(this.state===this.states.connected)v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,kt=this.activeProtocol;else if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),jt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+J);var ee=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+J),J.send(d.default.fromValues({action:U.ACTIVATE})),ht.activateTransport(V,J,tt,nt),ht.state===ht.states.synchronizing?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+J),ht.state=ht.states.connected):v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+ht.state.state+", so leaving unchanged"),ht.state.sendEvents&&ht.sendQueuedMessages()};kt?kt.onceIdle(ee):ee()},rt.prototype.activateTransport=function(V,J,tt,nt){var ht=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+J),V&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+V),tt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+tt),nt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(nt)),this.persistTransportPreference(J);var wt=this.state,jt=this.states.connected.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+wt.state),wt.state==this.states.closing.state||wt.state==this.states.closed.state||wt.state==this.states.failed.state)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),J.disconnect(),!1;if(g.arrDeleteValue(this.pendingTransports,J),!J.isConnected)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+J+" since it appears to no longer be connected"),!1;var kt=this.activeProtocol;this.activeProtocol=new m.default(J),this.host=J.params.host;var ee=nt.connectionKey;if(ee&&this.connectionKey!=ee&&this.setConnection(tt,nt,!!V),this.onConnectionDetailsUpdate(nt,J),C.default.Config.nextTick(function(){J.on("connected",function(Lt,ge,pe){ht.onConnectionDetailsUpdate(pe,J),ht.emit("update",new D.default(jt,jt,null,Lt))})}),wt.state===this.states.connected.state?V&&(this.errorReason=this.realtime.connection.errorReason=V,this.emit("update",new D.default(jt,jt,null,V))):(this.notifyState({state:"connected",error:V}),this.errorReason=this.realtime.connection.errorReason=V||null),this.emit("transport.active",J),kt)if(kt.messageQueue.count()>0&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+kt.transport.shortName+", new one is "+J.shortName+") finishing with "+kt.messageQueue.count()+" messages still pending"),kt.transport===J){var re="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",re)}else kt.finish();return g.safeArrForEach(this.pendingTransports,function(Lt){if(Lt===J){var ge="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",ge),g.arrDeleteValue(ht.pendingTransports,J)}else Lt.disconnect()}),g.safeArrForEach(this.proposedTransports,function(Lt){Lt===J?(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+J.shortName+"; stack = "+new Error().stack),g.arrDeleteValue(ht.proposedTransports,J)):Lt.dispose()}),!0},rt.prototype.deactivateTransport=function(V,J,tt){var nt=this.activeProtocol,ht=nt&&nt.getTransport()===V,wt=g.arrDeleteValue(this.pendingTransports,V),jt=g.arrDeleteValue(this.proposedTransports,V),kt=this.noTransportsScheduledForActivation();if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+V),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+J+(ht?"; was active":wt?"; was pending":jt?"; was proposed":"")+(kt?"":"; another transport is scheduled for activation")),tt&&tt.message&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+tt.message),ht&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(nt.getPendingMessages()),C.default.Config.nextTick(function(){nt.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",V),ht&&kt||ht&&J==="failed"||J==="closed"||nt===null&&wt&&this.pendingTransports.length===0){if(J==="disconnected"&&tt&&tt.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:J,error:tt,retryImmediately:!0});return}var ee=J==="failed"&&N.default.isTokenErr(tt)?"disconnected":J;this.notifyState({state:ee,error:tt});return}ht&&J==="disconnected"&&this.state!==this.states.synchronizing&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:tt}))},rt.prototype.noTransportsScheduledForActivation=function(){return g.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(V){return!V.isConnected})},rt.prototype.setConnection=function(V,J,tt){var nt=this.connectionId,ht=nt&&nt!==V,wt=!nt&&tt;(ht||wt)&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==V&&v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=V,this.realtime.connection.key=this.connectionKey=J.connectionKey},rt.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},rt.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},rt.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var V=g.now()-this.lastActivity;V>this.connectionStateTtl+this.maxIdleInterval&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+V+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},rt.prototype.persistConnection=function(){if(z()){var V=this.createRecoveryKey();V&&Y({recoveryKey:V,disconnectedAt:g.now(),location:l.location,clientId:this.realtime.auth.clientId})}},rt.prototype.unpersistConnection=function(){j()},rt.prototype.getError=function(){return this.errorReason||this.getStateError()},rt.prototype.getStateError=function(){var V,J;return(J=(V=L.default)[this.state.state])===null||J===void 0?void 0:J.call(V)},rt.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},rt.prototype.enactStateChange=function(V){var J=V.current==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(J,"Connection state",V.current+(V.reason?"; reason: "+V.reason:"")),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+V.current+"; reason = "+(V.reason&&V.reason.message));var tt=this.state=this.states[V.current];V.reason&&(this.errorReason=V.reason,this.realtime.connection.errorReason=V.reason),(tt.terminal||tt.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",V)},rt.prototype.startTransitionTimer=function(V){var J=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+V.state),this.transitionTimer&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){J.transitionTimer&&(J.transitionTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager "+V.state+" timer expired","requesting new state: "+V.failState),J.notifyState({state:V.failState}))},V.retryDelay)},rt.prototype.cancelTransitionTimer=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},rt.prototype.startSuspendTimer=function(){var V=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){V.suspendTimer&&(V.suspendTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),V.states.connecting.failState="suspended",V.notifyState({state:"suspended"}))},this.connectionStateTtl))},rt.prototype.checkSuspendTimer=function(V){V!=="disconnected"&&V!=="suspended"&&V!=="connecting"&&this.cancelSuspendTimer()},rt.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},rt.prototype.startRetryTimer=function(V){var J=this;this.retryTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),J.retryTimer=null,J.requestState({state:"connecting"})},V)},rt.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},rt.prototype.notifyState=function(V){var J=this,tt,nt,ht=V.state,wt=ht==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||V.retryImmediately||this.state===this.states.connecting&&V.error&&N.default.isTokenErr(V.error)&&!(this.errorReason&&N.default.isTokenErr(this.errorReason)));if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+ht+(wt?"; will retry connection immediately":"")),ht!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(V.state),(ht==="suspended"||ht==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var jt=this.states[V.state],kt=jt.retryDelay;jt.state==="disconnected"&&(this.disconnectedRetryCount++,kt=g.getRetryTime(jt.retryDelay,this.disconnectedRetryCount));var ee=new D.default(this.state.state,jt.state,kt,V.error||((nt=(tt=L.default)[jt.state])===null||nt===void 0?void 0:nt.call(tt)));if(wt){var re=function(){J.state===J.states.disconnected&&(J.lastAutoReconnectAttempt=g.now(),J.requestState({state:"connecting"}))},Lt=this.lastAutoReconnectAttempt&&g.now()-this.lastAutoReconnectAttempt+1;Lt&&Lt<1e3?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+Lt+"ms ago, waiting another "+(1e3-Lt)+"ms before trying again"),setTimeout(re,1e3-Lt)):C.default.Config.nextTick(re)}else(ht==="disconnected"||ht==="suspended")&&this.startRetryTimer(kt);(ht==="disconnected"&&!wt||ht==="suspended"||jt.terminal)&&C.default.Config.nextTick(function(){J.disconnectAllTransports()}),ht=="connected"&&!this.activeProtocol&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(ee),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(ht,ee.reason),this.failQueuedMessages(ee.reason))}},rt.prototype.requestState=function(V){var J=this,tt,nt,ht=V.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+ht+"; current state: "+this.state.state),ht!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(ht),!(ht=="connecting"&&this.state.state=="connected")&&!(ht=="closing"&&this.state.state=="closed"))){var wt=this.states[ht],jt=new D.default(this.state.state,wt.state,null,V.error||((nt=(tt=L.default)[wt.state])===null||nt===void 0?void 0:nt.call(tt)));this.enactStateChange(jt),ht=="connecting"&&C.default.Config.nextTick(function(){J.startConnect()}),ht=="closing"&&this.closeImpl()}},rt.prototype.startConnect=function(){var V=this;if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var J=this.realtime.auth,tt=++this.connectCounter,nt=function(){V.checkConnectionStateFreshness(),V.getTransportParams(function(wt){if(wt.mode==="recover"&&wt.options.recover){var jt=W(wt.options.recover);jt&&V.realtime.channels.recoverChannels(jt.channelSerials)}tt===V.connectCounter&&V.connectImpl(wt,tt)})};if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),J.method==="basic")nt();else{var ht=function(wt){tt===V.connectCounter&&(wt?V.actOnErrorFromAuthorize(wt):nt())};this.errorReason&&N.default.isTokenErr(this.errorReason)?J._forceNewToken(null,null,ht):J._ensureValidAuthCredentials(!1,ht)}},rt.prototype.connectImpl=function(V,J){var tt=this.state.state;tt!==this.states.connecting.state&&tt!==this.states.connected.state?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+tt):this.pendingTransports.length?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):tt==this.states.connected.state?this.upgradeIfNeeded(V):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(V,J):this.connectBase(V,J)},rt.prototype.connectPreference=function(V,J){var tt=this,nt=this.getTransportPreference(),ht=!1;g.arrIn(this.transports,nt)||(this.unpersistTransportPreference(),this.connectImpl(V,J)),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+nt);var wt=setTimeout(function(){ht=!0,tt.state.state!==tt.states.connected.state&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+nt+" failed; clearing preference and trying from scratch"),tt.disconnectAllTransports(),tt.unpersistTransportPreference()),tt.connectImpl(V,J)},this.options.timeouts.preferenceConnectTimeout);V.host=this.httpHosts[0],this.tryATransport(V,nt,function(jt,kt){clearTimeout(wt),ht&&kt?(kt.off(),kt.disconnect(),g.arrDeleteValue(tt.pendingTransports,kt)):!kt&&!jt&&(tt.unpersistTransportPreference(),tt.connectImpl(V,J))})},rt.prototype.connectBase=function(V,J){var tt=this,nt=function(ee){tt.notifyState({state:tt.states.connecting.failState,error:ee})},ht=this.httpHosts.slice(),wt=function(ee,re){J===tt.connectCounter&&!re&&!ee&&kt()};v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var jt=ht.shift();if(!jt){nt(new B.default("Unable to connect (no available host)",80003,404));return}V.host=jt;var kt=function(){if(!ht.length){nt(new B.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!tt.realtime.http.checkConnectivity){nt(new B.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}tt.realtime.http.checkConnectivity(function(ee,re){if(J===tt.connectCounter){if(ee){nt(ee);return}if(!re){nt(new B.default("Unable to connect (network unreachable)",80003,404));return}V.host=g.arrPopRandomElement(ht),tt.tryATransport(V,tt.baseTransport,wt)}})};if(this.forceFallbackHost&&ht.length){this.forceFallbackHost=!1,kt();return}this.tryATransport(V,this.baseTransport,wt)},rt.prototype.getUpgradePossibilities=function(){var V=this.activeProtocol.getTransport().shortName,J=g.arrIndexOf(this.upgradeTransports,V);return this.upgradeTransports.slice(J+1)},rt.prototype.upgradeIfNeeded=function(V){var J=this,tt=this.getUpgradePossibilities();v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect(tt)),tt.length&&g.arrForEach(tt,function(nt){var ht=J.createTransportParams(V.host,"upgrade");J.tryATransport(ht,nt,G)})},rt.prototype.closeImpl=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),g.safeArrForEach(this.pendingTransports,function(V){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+V),V&&V.close()}),g.safeArrForEach(this.proposedTransports,function(V){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+V),V&&V.dispose()}),this.activeProtocol&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},rt.prototype.onAuthUpdated=function(V,J){var tt=this,nt;switch(this.state.state){case"connected":{if(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var ht=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){tt.state.state==="connected"&&tt.upgradeIfNeeded(ht)})}var wt=(nt=this.activeProtocol)===null||nt===void 0?void 0:nt.getTransport();wt&&wt.onAuthUpdated&&wt.onAuthUpdated(V);var jt=d.default.fromValues({action:U.AUTH,auth:{accessToken:V.token}});this.send(jt);var kt=function(){tt.off(ee),J(null,V)},ee=function(Lt){Lt.current==="failed"&&(tt.off(kt),tt.off(ee),J(Lt.reason||tt.getStateError()))};this.once("connectiondetails",kt),this.on("connectionstate",ee);break}case"connecting":v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var re=function(Lt){switch(Lt.current){case"connected":tt.off(re),J(null,V);break;case"failed":case"closed":case"suspended":tt.off(re),J(Lt.reason||tt.getStateError());break}};this.on("connectionstate",re),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},rt.prototype.disconnectAllTransports=function(V){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(V?" except the active transport":"")),this.connectCounter++,g.safeArrForEach(this.pendingTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+J),J&&J.disconnect()}),this.pendingTransports=[],g.safeArrForEach(this.proposedTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+J),J&&J.dispose()}),this.proposedTransports=[],this.activeProtocol&&!V&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},rt.prototype.send=function(V,J,tt){tt=tt||G;var nt=this.state;if(nt.sendEvents){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new m.PendingMessage(V,tt));return}var ht=J&&nt.queueEvents||nt.forceQueueEvents;if(!ht){var wt="rejecting event, queueEvent was "+J+", state was "+nt.state;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()",wt),tt(this.errorReason||new B.default(wt,9e4,400));return}v.default.shouldLog(v.default.LOG_MICRO)&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+d.default.stringify(V)),this.queue(V,tt)},rt.prototype.sendImpl=function(V){var J=V.message;V.ackRequired&&!V.sendAttempted&&(J.msgSerial=this.msgSerial++);try{this.activeProtocol.send(V)}catch(tt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+tt.stack)}},rt.prototype.queue=function(V,J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var tt=this.queuedMessages.last(),nt=this.options.maxMessageSize;tt&&!tt.sendAttempted&&F(tt.message,V,nt)?(tt.merged||(tt.callback=P.default.create([tt.callback]),tt.merged=!0),tt.callback.push(J)):this.queuedMessages.push(new m.PendingMessage(V,J))},rt.prototype.sendQueuedMessages=function(){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var V;V=this.queuedMessages.shift();)this.sendImpl(V)},rt.prototype.queuePendingMessages=function(V){V&&V.length&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+V.length+" pending messages"),this.queuedMessages.prepend(V))},rt.prototype.failQueuedMessages=function(V){var J=this.queuedMessages.count();J>0&&(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+J+" queued messages, err = "+g.inspectError(V)),this.queuedMessages.completeAllMessages(V))},rt.prototype.onChannelMessage=function(V,J){var tt=this.activeProtocol&&J===this.activeProtocol.getTransport(),nt=g.arrIn(this.pendingTransports,J)&&this.state==this.states.synchronizing;tt||nt?this.realtime.channels.onChannelMessage(V):g.arrIndexOf([U.ACK,U.NACK,U.ERROR],V.action)>-1?this.realtime.channels.onChannelMessage(V):v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(V)+"on defunct transport; discarding")},rt.prototype.ping=function(V,J){var tt=this;if(V){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+V);var nt=function(){V.off("heartbeat",jt),J(new B.default("Timeout waiting for heartbeat response",5e4,500))},ht=g.now(),wt=g.cheapRandStr(),jt=function(ge){if(ge===wt){V.off("heartbeat",jt),clearTimeout(kt);var pe=g.now()-ht;J(null,pe)}},kt=setTimeout(nt,this.options.timeouts.realtimeRequestTimeout);V.on("heartbeat",jt),V.ping(wt);return}if(this.state.state!=="connected"){J(new B.default("Unable to ping service; not connected",4e4,400));return}var ee=!1,re=function(ge,pe){tt.off("transport.active",Lt),ee||(ee=!0,J(ge,pe))},Lt=function(){ee||(ee=!0,C.default.Config.nextTick(function(){tt.ping(null,J)}))};this.on("transport.active",Lt),this.ping(this.activeProtocol.getTransport(),re)},rt.prototype.abort=function(V){this.activeProtocol.getTransport().fail(V)},rt.prototype.registerProposedTransport=function(V){this.proposedTransports.push(V)},rt.prototype.getTransportPreference=function(){var V,J;return this.transportPreference||y()&&((J=(V=C.default.WebStorage)===null||V===void 0?void 0:V.get)===null||J===void 0?void 0:J.call(V,K))},rt.prototype.persistTransportPreference=function(V){var J,tt;g.arrIn(_.default.upgradeTransports,V.shortName)&&(this.transportPreference=V.shortName,y()&&((tt=(J=C.default.WebStorage)===null||J===void 0?void 0:J.set)===null||tt===void 0||tt.call(J,K,V.shortName)))},rt.prototype.unpersistTransportPreference=function(){var V,J;this.transportPreference=null,y()&&((J=(V=C.default.WebStorage)===null||V===void 0?void 0:V.remove)===null||J===void 0||J.call(V,K))},rt.prototype.actOnErrorFromAuthorize=function(V){if(V.code===40171)this.notifyState({state:"failed",error:V});else if(V.code===40102)this.notifyState({state:"failed",error:V});else if(V.statusCode===T.default.Forbidden){var J="Client configured authentication provider returned 403; failing the connection";v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",J),this.notifyState({state:"failed",error:new B.default(J,80019,403,V)})}else{var J="Client configured authentication provider request failed";v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",J),this.notifyState({state:this.state.failState,error:new B.default(J,80019,401,V)})}},rt.prototype.onConnectionDetailsUpdate=function(V,J){if(V){this.connectionDetails=V,V.maxMessageSize&&(this.options.maxMessageSize=V.maxMessageSize);var tt=V.clientId;if(tt){var nt=this.realtime.auth._uncheckedSetClientId(tt);if(nt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",nt.message),J.fail(nt);return}}var ht=V.connectionStateTtl;ht&&(this.connectionStateTtl=ht),this.maxIdleInterval=V.maxIdleInterval,this.emit("connectiondetails",V)}},rt.supportedTransports={},rt})(E.default);a.default=Z}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(7)),d=l.__importDefault(r(2)),g=(function(m){l.__extends(_,m);function _(){var C=m.call(this)||this;return C.messages=[],C}return _.prototype.count=function(){return this.messages.length},_.prototype.push=function(C){this.messages.push(C)},_.prototype.shift=function(){return this.messages.shift()},_.prototype.last=function(){return this.messages[this.messages.length-1]},_.prototype.copyAll=function(){return this.messages.slice()},_.prototype.append=function(C){this.messages.push.apply(this.messages,C)},_.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},_.prototype.completeMessages=function(C,E,R){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+E),R=R||null;var v=this.messages;if(v.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var D=v[0];if(D){var L=D.message.msgSerial,B=C+E;if(B>L)for(var N=v.splice(0,B-L),M=0,P=N;M<P.length;M++){var O=P[M];O.callback(R)}v.length==0&&this.emit("idle")}},_.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},_.prototype.resetSendAttempted=function(){for(var C=0,E=this.messages;C<E.length;C++){var R=E[C];R.sendAttempted=!1}},_.prototype.clear=function(){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},_})(f.default);a.default=g}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function f(d,g,m,_){this.previous=d,this.current=g,m&&(this.retryIn=m),_&&(this.reason=_)}return f})();a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(10)),d=l.__importDefault(r(7)),g=l.__importStar(r(1)),m=l.__importDefault(r(33)),_=l.__importDefault(r(2)),C=l.__importDefault(r(54)),E=l.__importDefault(r(9)),R=l.__importDefault(r(39)),v=l.__importStar(r(4)),D=l.__importDefault(r(16)),L=l.__importDefault(r(21)),B=f.default.Action,N=function(){};function M(A){if(A&&"params"in A&&!g.isObject(A.params))return new v.default("options.params must be an object",4e4,400);if(A&&"modes"in A){if(!g.isArray(A.modes))return new v.default("options.modes must be an array",4e4,400);for(var T=0;T<A.modes.length;T++){var y=A.modes[T];if(!y||typeof y!="string"||!g.arrIn(f.default.channelModes,String.prototype.toUpperCase.call(y)))return new v.default("Invalid channel mode: "+y,4e4,400)}}}var P=(function(A){l.__extends(T,A);function T(y,z,U){var G=A.call(this,y,z,U)||this;return G.retryCount=0,G.history=function(K,Q){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),Q===void 0)if(typeof K=="function")Q=K,K=null;else{if(this.rest.options.promises)return g.promisify(this,"history",arguments);Q=N}if(K&&K.untilAttach){if(this.state!=="attached"){Q(new v.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){Q(new v.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete K.untilAttach,K.from_serial=this.properties.attachSerial}m.default.prototype._history.call(this,K,Q)},G.whenState=(function(K,Q){return d.default.prototype.whenState.call(G,K,G.state,Q)}),_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel()","started; name = "+z),G.realtime=y,G.presence=new C.default(G),G.connectionManager=y.connection.connectionManager,G.state="initialized",G.subscriptions=new d.default,G.syncChannelSerial=void 0,G.properties={attachSerial:void 0,channelSerial:void 0},G.setOptions(U),G.errorReason=null,G._requestedFlags=null,G._mode=null,G._attachResume=!1,G._decodingContext={channelOptions:G.channelOptions,plugins:y.options.plugins||{},baseEncodedPreviousPayload:void 0},G._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},G._allChannelChanges=new d.default,G}return T.prototype.invalidStateError=function(){return new v.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},T.processListenerArgs=function(y){return y=Array.prototype.slice.call(y),typeof y[0]=="function"&&y.unshift(null),y[y.length-1]==null&&y.pop(),y},T.prototype.setOptions=function(y,z){var U=this.channelOptions;if(!z&&this.rest.options.promises)return g.promisify(this,"setOptions",arguments);var G=z||function(Q){Q&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+Q.toString())},K=M(y);if(K){G(K);return}m.default.prototype.setOptions.call(this,y),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(y,U)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(Q){switch(this.event){case"update":case"attached":G==null||G(null);return;default:G==null||G(Q.reason);return}})):G()},T.prototype._shouldReattachToSetOptions=function(y,z){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(y!=null&&y.params){var U=O(y.params),G=O(z.params);if(Object.keys(U).length!==Object.keys(G).length||!g.shallowEquals(G,U))return!0}return!!(y!=null&&y.modes&&(!z.modes||!g.arrEquals(y.modes,z.modes)))},T.prototype.publish=function(){for(var y=this,z=[],U=0;U<arguments.length;U++)z[U]=arguments[U];var G=z[0],K=z.length,Q=z[K-1];if(typeof Q!="function"){if(this.realtime.options.promises)return g.promisify(this,"publish",arguments);Q=N,++K}if(!this.connectionManager.activeState()){Q(this.connectionManager.getError());return}if(K==2)if(g.isObject(G))G=[E.default.fromValues(G)];else if(g.isArray(G))G=E.default.fromValuesArray(G);else throw new v.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else G=[E.default.fromValues({name:z[0],data:z[1]})];var X=this.realtime.options.maxMessageSize;E.default.encodeArray(G,this.channelOptions,function(Y){if(Y){Q(Y);return}var j=E.default.getMessagesSize(G);if(j>X){Q(new v.default("Maximum size of messages that can be published at once exceeded ( was "+j+" bytes; limit is "+X+" bytes)",40009,400));return}y.__publish(G,Q)})},T.prototype.__publish=function(y,z){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+y.length);var U=this.state;switch(U){case"failed":case"suspended":z(v.default.fromValues(this.invalidStateError()));break;default:{_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+U);var G=new f.default;G.action=B.MESSAGE,G.channel=this.name,G.messages=y,this.sendMessage(G,z);break}}},T.prototype.onEvent=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var z=this.subscriptions,U=0;U<y.length;U++){var G=y[U];z.emit(G.name,G)}},T.prototype.attach=function(y,z){var U;if(typeof y=="function"?(z=y,U=null):U=y,!z){if(this.realtime.options.promises)return g.promisify(this,"attach",arguments);z=function(G){G&&_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+G.toString())}}if(U)_.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=U;else if(this.state==="attached"){z(null,null);return}this._attach(!1,null,z)},T.prototype._attach=function(y,z,U){U||(U=function(K){K&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+K.toString())});var G=this.connectionManager;if(!G.activeState()){U(G.getError());return}(this.state!=="attaching"||y)&&this.requestState("attaching",z),this.once(function(K){switch(this.event){case"attached":U==null||U(null,K);break;case"detached":case"suspended":case"failed":U==null||U(K.reason||G.getError()||new v.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":U==null||U(new v.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},T.prototype.attachImpl=function(){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var y=f.default.fromValues({action:B.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?y.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&y.encodeModesToFlags(g.allToUpperCase(this.channelOptions.modes)),this._attachResume&&y.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(y.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(y,N)},T.prototype.detach=function(y){if(!y){if(this.realtime.options.promises)return g.promisify(this,"detach",arguments);y=N}var z=this.connectionManager;if(!z.activeState()){y(z.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),y();break;case"detached":y();break;case"failed":y(new v.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(U){switch(this.event){case"detached":y();break;case"attached":case"suspended":case"failed":y(U.reason||z.getError()||new v.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":y(new v.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},T.prototype.detachImpl=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var z=f.default.fromValues({action:B.DETACH,channel:this.name});this.sendMessage(z,y||N)},T.prototype.subscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=T.processListenerArgs(y),G=U[0],K=U[1],Q=U[2];if(!Q&&this.realtime.options.promises)return g.promisify(this,"subscribe",[G,K]);if(this.state==="failed"){Q==null||Q(v.default.fromValues(this.invalidStateError()));return}return G&&typeof G=="object"&&!Array.isArray(G)?this._subscribeFilter(G,K):this.subscriptions.on(G,K),this.attach(Q||N)},T.prototype._subscribeFilter=function(y,z){var U=function(G){var K,Q,X,Y,j,I,F={name:G.name,refTimeserial:(Q=(K=G.extras)===null||K===void 0?void 0:K.ref)===null||Q===void 0?void 0:Q.timeserial,refType:(Y=(X=G.extras)===null||X===void 0?void 0:X.ref)===null||Y===void 0?void 0:Y.type,isRef:!!(!((I=(j=G.extras)===null||j===void 0?void 0:j.ref)===null||I===void 0)&&I.timeserial),clientId:G.clientId};Object.entries(y).find(function(W){var it=W[0],Z=W[1];return Z!==void 0?F[it]!==Z:!1})||z(G)};this._addFilteredSubscription(y,z,U),this.subscriptions.on(U)},T.prototype._addFilteredSubscription=function(y,z,U){var G;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(z)){var K=this.filteredSubscriptions.get(z);K.set(y,((G=K==null?void 0:K.get(y))===null||G===void 0?void 0:G.concat(U))||[U])}else this.filteredSubscriptions.set(z,new Map([[y,[U]]]))},T.prototype._getAndDeleteFilteredSubscriptions=function(y,z){var U=this;if(!this.filteredSubscriptions)return[];if(!z&&y)return Array.from(this.filteredSubscriptions.entries()).map(function(X){var Y,j=X[0],I=X[1],F=I.get(y);return I.delete(y),I.size===0&&((Y=U.filteredSubscriptions)===null||Y===void 0||Y.delete(j)),F}).reduce(function(X,Y){var j;return Y?(j=X).concat.apply(j,Y):X},[]);if(!z||!this.filteredSubscriptions.has(z))return[];var G=this.filteredSubscriptions.get(z);if(!y){var K=Array.from(G.values()).reduce(function(X,Y){return X.concat.apply(X,Y)},[]);return this.filteredSubscriptions.delete(z),K}var Q=G.get(y);return G.delete(y),Q||[]},T.prototype.unsubscribe=function(){for(var y=this,z,U=[],G=0;G<arguments.length;G++)U[G]=arguments[G];var K=T.processListenerArgs(U),Q=K[0],X=K[1];if(typeof Q=="object"&&!X||!((z=this.filteredSubscriptions)===null||z===void 0)&&z.has(X)){this._getAndDeleteFilteredSubscriptions(Q,X).forEach(function(Y){return y.subscriptions.off(Y)});return}this.subscriptions.off(Q,X)},T.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new v.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var y=this.connectionManager;if(!y.activeState())throw y.getError();var z=f.default.fromValues({action:B.SYNC,channel:this.name});this.syncChannelSerial&&(z.channelSerial=this.syncChannelSerial),y.send(z)},T.prototype.sendMessage=function(y,z){this.connectionManager.send(y,this.realtime.options.queueMessages,z)},T.prototype.sendPresence=function(y,z){var U=f.default.fromValues({action:B.PRESENCE,channel:this.name,presence:g.isArray(y)?D.default.fromValuesArray(y):[D.default.fromValues(y)]});this.sendMessage(U,z)},T.prototype.onMessage=function(y){(y.action===B.ATTACHED||y.action===B.MESSAGE||y.action===B.PRESENCE)&&this.setChannelSerial(y.channelSerial);var z,U=!1;switch(y.action){case B.ATTACHED:{this.properties.attachSerial=y.channelSerial,this._mode=y.getMode(),this.params=y.params||{};var G=y.decodeModesFromFlags();this.modes=G&&g.allToLowerCase(G)||void 0;var K=y.hasFlag("RESUMED"),Q=y.hasFlag("HAS_PRESENCE"),X=y.hasFlag("HAS_BACKLOG");if(this.state==="attached"){K||this.presence.onAttached(Q);var Y=new R.default(this.state,this.state,K,X,y.error);this._allChannelChanges.emit("update",Y),(!K||this.channelOptions.updateOnAttached)&&this.emit("update",Y)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",y.error,K,Q,X);break}case B.DETACHED:{var j=y.error?v.default.fromValues(y.error):new v.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",j):this.state==="attaching"?this.notifyState("suspended",j):this.requestState("attaching",j);break}case B.SYNC:if(U=!0,z=this.syncChannelSerial=y.channelSerial,!y.presence)break;case B.PRESENCE:{for(var I=y.presence,F=y.id,W=y.connectionId,it=y.timestamp,Z=this.channelOptions,at=void 0,rt=0;rt<I.length;rt++)try{at=I[rt],D.default.decode(at,Z),at.connectionId||(at.connectionId=W),at.timestamp||(at.timestamp=it),at.id||(at.id=F+":"+rt)}catch(wt){_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",wt.toString())}this.presence.setPresence(I,U,z);break}case B.MESSAGE:{if(this.state!=="attached"){_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+y.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var V=y.messages,J=V[0],tt=V[V.length-1],F=y.id,W=y.connectionId,it=y.timestamp;if(J.extras&&J.extras.delta&&J.extras.delta.from!==this._lastPayload.messageId){var nt='Delta message decode failure - previous message not available for message "'+y.id+'" on this channel "'+this.name+'".';_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",nt),this._startDecodeFailureRecovery(new v.default(nt,40018,400));break}for(var rt=0;rt<V.length;rt++){var nt=V[rt];try{E.default.decode(nt,this._decodingContext)}catch(Lt){switch(_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",Lt.toString()),Lt.code){case 40018:this._startDecodeFailureRecovery(Lt);return;case 40019:case 40021:this.notifyState("failed",Lt);return}}nt.connectionId||(nt.connectionId=W),nt.timestamp||(nt.timestamp=it),nt.id||(nt.id=F+":"+rt)}this._lastPayload.messageId=tt.id,this._lastPayload.protocolMessageChannelSerial=y.channelSerial,this.onEvent(V);break}case B.ERROR:{var ht=y.error;ht&&ht.code==80016?this.checkPendingState():this.notifyState("failed",v.default.fromValues(ht));break}default:_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+y.action+")"),this.connectionManager.abort(L.default.unknownChannelErr())}},T.prototype._startDecodeFailureRecovery=function(y){var z=this;this._lastPayload.decodeFailureRecoveryInProgress||(_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,y,function(){z._lastPayload.decodeFailureRecoveryInProgress=!1}))},T.prototype.onAttached=function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},T.prototype.notifyState=function(y,z,U,G,K){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+y),this.clearStateTimer(),g.arrIn(["detached","suspended","failed"],y)&&(this.properties.channelSerial=null),y!==this.state){this.presence.actOnChannelState(y,G,z),y==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),z&&(this.errorReason=z);var Q=new R.default(this.state,y,U,K,z),X=y==="failed"?_.default.LOG_ERROR:_.default.LOG_MAJOR;_.default.logAction(X,'Channel state for channel "'+this.name+'"',y+(z?"; reason: "+z:"")),y!=="attaching"&&y!=="suspended"&&(this.retryCount=0),y==="attached"&&this.onAttached(),y==="attached"?this._attachResume=!0:(y==="detaching"||y==="failed")&&(this._attachResume=!1),this.state=y,this._allChannelChanges.emit(y,Q),this.emit(y,Q)}},T.prototype.requestState=function(y,z){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+y),this.notifyState(y,z),this.checkPendingState()},T.prototype.checkPendingState=function(){var y=this.connectionManager.state;if(!(y.sendEvents||y.forceQueueEvents)){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},T.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var y=new v.default("Channel attach timed out",90007,408);this.notifyState("suspended",y);break}case"detaching":{var y=new v.default("Channel detach timed out",90007,408);this.notifyState("attached",y);break}default:this.checkPendingState();break}},T.prototype.startStateTimerIfNotRunning=function(){var y=this;this.stateTimer||(this.stateTimer=setTimeout(function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),y.stateTimer=null,y.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},T.prototype.clearStateTimer=function(){var y=this.stateTimer;y&&(clearTimeout(y),this.stateTimer=null)},T.prototype.startRetryTimer=function(){var y=this;if(!this.retryTimer){this.retryCount++;var z=g.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){y.state==="suspended"&&y.connectionManager.state.sendEvents&&(y.retryTimer=null,_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),y.requestState("attaching"))},z)}},T.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},T.prototype.getReleaseErr=function(){var y=this.state;return y==="initialized"||y==="detached"||y==="failed"?null:new v.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+y,90001,400)},T.prototype.setChannelSerial=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+y+"; previous = "+this.properties.channelSerial),y&&(this.properties.channelSerial=y)},T})(m.default);function O(A){var T=A||{};T.agent;var y=l.__rest(T,["agent"]);return y}a.default=P}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function f(d,g,m,_,C){this.previous=d,this.current=g,g==="attached"&&(this.resumed=m,this.hasBacklog=_),C&&(this.reason=C)}return f})();a.default=l}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=d.Hasher,_=f.algo,C=[],E=_.SHA1=m.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(R,v){for(var D=this._hash.words,L=D[0],B=D[1],N=D[2],M=D[3],P=D[4],O=0;O<80;O++){if(O<16)C[O]=R[v+O]|0;else{var A=C[O-3]^C[O-8]^C[O-14]^C[O-16];C[O]=A<<1|A>>>31}var T=(L<<5|L>>>27)+P+C[O];O<20?T+=(B&N|~B&M)+1518500249:O<40?T+=(B^N^M)+1859775393:O<60?T+=(B&N|B&M|N&M)-1894007588:T+=(B^N^M)-899497514,P=M,M=N,N=B<<30|B>>>2,B=L,L=T}D[0]=D[0]+L|0,D[1]=D[1]+B|0,D[2]=D[2]+N|0,D[3]=D[3]+M|0,D[4]=D[4]+P|0},_doFinalize:function(){var R=this._data,v=R.words,D=this._nDataBytes*8,L=R.sigBytes*8;return v[L>>>5]|=128<<24-L%32,v[(L+64>>>9<<4)+14]=Math.floor(D/4294967296),v[(L+64>>>9<<4)+15]=D,R.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var R=m.clone.call(this);return R._hash=this._hash.clone(),R}});f.SHA1=m._createHelper(E),f.HmacSHA1=m._createHmacHelper(E)})(),l.SHA1})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});function l(O){if(O===void 0)return"undefined";var A,T;if(O instanceof ArrayBuffer?(T="ArrayBuffer",A=new DataView(O)):O instanceof DataView&&(T="DataView",A=O),!A)return JSON.stringify(O);for(var y=[],z=0;z<O.byteLength;z++){if(z>20){y.push("...");break}var U=A.getUint8(z).toString(16);U.length===1&&(U="0"+U),y.push(U)}return"<"+T+" "+y.join(" ")+">"}function f(O,A,T){for(var y=0,z=T.length;y<z;y++){var U=T.charCodeAt(y);if(U<128){O.setUint8(A++,U>>>0&127|0);continue}if(U<2048){O.setUint8(A++,U>>>6&31|192),O.setUint8(A++,U>>>0&63|128);continue}if(U<65536){O.setUint8(A++,U>>>12&15|224),O.setUint8(A++,U>>>6&63|128),O.setUint8(A++,U>>>0&63|128);continue}if(U<1114112){O.setUint8(A++,U>>>18&7|240),O.setUint8(A++,U>>>12&63|128),O.setUint8(A++,U>>>6&63|128),O.setUint8(A++,U>>>0&63|128);continue}throw new Error("bad codepoint "+U)}}function d(O,A,T){for(var y="",z=A,U=A+T;z<U;z++){var G=O.getUint8(z);if((G&128)===0){y+=String.fromCharCode(G);continue}if((G&224)===192){y+=String.fromCharCode((G&15)<<6|O.getUint8(++z)&63);continue}if((G&240)===224){y+=String.fromCharCode((G&15)<<12|(O.getUint8(++z)&63)<<6|(O.getUint8(++z)&63)<<0);continue}if((G&248)===240){y+=String.fromCharCode((G&7)<<18|(O.getUint8(++z)&63)<<12|(O.getUint8(++z)&63)<<6|(O.getUint8(++z)&63)<<0);continue}throw new Error("Invalid byte "+G.toString(16))}return y}function g(O){for(var A=0,T=0,y=O.length;T<y;T++){var z=O.charCodeAt(T);if(z<128){A+=1;continue}if(z<2048){A+=2;continue}if(z<65536){A+=3;continue}if(z<1114112){A+=4;continue}throw new Error("bad codepoint "+z)}return A}function m(O,A){var T=P(O,A);if(T!==0){var y=new ArrayBuffer(T),z=new DataView(y);return M(O,z,0,A),y}}var _=65536*65536,C=1/_;function E(O,A){return A=A||0,O.getInt32(A)*_+O.getUint32(A+4)}function R(O,A){return A=A||0,O.getUint32(A)*_+O.getUint32(A+4)}function v(O,A,T){T<9223372036854776e3?(O.setInt32(A,Math.floor(T*C)),O.setInt32(A+4,T&-1)):(O.setUint32(A,2147483647),O.setUint32(A+4,2147483647))}function D(O,A,T){T<18446744073709552e3?(O.setUint32(A,Math.floor(T*C)),O.setInt32(A+4,T&-1)):(O.setUint32(A,4294967295),O.setUint32(A+4,4294967295))}var L=(function(){function O(A,T){var y=this;this.map=function(z){for(var U={},G=0;G<z;G++){var K=y.parse();U[K]=y.parse()}return U},this.bin=function(z){var U=new ArrayBuffer(z);return new Uint8Array(U).set(new Uint8Array(y.view.buffer,y.offset,z),0),y.offset+=z,U},this.buf=this.bin,this.str=function(z){var U=d(y.view,y.offset,z);return y.offset+=z,U},this.array=function(z){for(var U=new Array(z),G=0;G<z;G++)U[G]=y.parse();return U},this.ext=function(z){return y.offset+=z,{type:y.view.getInt8(y.offset),data:y.buf(z)}},this.parse=function(){var z=y.view.getUint8(y.offset),U,G;if((z&128)===0)return y.offset++,z;if((z&240)===128)return G=z&15,y.offset++,y.map(G);if((z&240)===144)return G=z&15,y.offset++,y.array(G);if((z&224)===160)return G=z&31,y.offset++,y.str(G);if((z&224)===224)return U=y.view.getInt8(y.offset),y.offset++,U;switch(z){case 192:return y.offset++,null;case 193:y.offset++;return;case 194:return y.offset++,!1;case 195:return y.offset++,!0;case 196:return G=y.view.getUint8(y.offset+1),y.offset+=2,y.bin(G);case 197:return G=y.view.getUint16(y.offset+1),y.offset+=3,y.bin(G);case 198:return G=y.view.getUint32(y.offset+1),y.offset+=5,y.bin(G);case 199:return G=y.view.getUint8(y.offset+1),y.offset+=2,y.ext(G);case 200:return G=y.view.getUint16(y.offset+1),y.offset+=3,y.ext(G);case 201:return G=y.view.getUint32(y.offset+1),y.offset+=5,y.ext(G);case 202:return U=y.view.getFloat32(y.offset+1),y.offset+=5,U;case 203:return U=y.view.getFloat64(y.offset+1),y.offset+=9,U;case 204:return U=y.view.getUint8(y.offset+1),y.offset+=2,U;case 205:return U=y.view.getUint16(y.offset+1),y.offset+=3,U;case 206:return U=y.view.getUint32(y.offset+1),y.offset+=5,U;case 207:return U=R(y.view,y.offset+1),y.offset+=9,U;case 208:return U=y.view.getInt8(y.offset+1),y.offset+=2,U;case 209:return U=y.view.getInt16(y.offset+1),y.offset+=3,U;case 210:return U=y.view.getInt32(y.offset+1),y.offset+=5,U;case 211:return U=E(y.view,y.offset+1),y.offset+=9,U;case 212:return G=1,y.offset++,y.ext(G);case 213:return G=2,y.offset++,y.ext(G);case 214:return G=4,y.offset++,y.ext(G);case 215:return G=8,y.offset++,y.ext(G);case 216:return G=16,y.offset++,y.ext(G);case 217:return G=y.view.getUint8(y.offset+1),y.offset+=2,y.str(G);case 218:return G=y.view.getUint16(y.offset+1),y.offset+=3,y.str(G);case 219:return G=y.view.getUint32(y.offset+1),y.offset+=5,y.str(G);case 220:return G=y.view.getUint16(y.offset+1),y.offset+=3,y.array(G);case 221:return G=y.view.getUint32(y.offset+1),y.offset+=5,y.array(G);case 222:return G=y.view.getUint16(y.offset+1),y.offset+=3,y.map(G);case 223:return G=y.view.getUint32(y.offset+1),y.offset+=5,y.map(G)}throw new Error("Unknown type 0x"+z.toString(16))},this.offset=T||0,this.view=A}return O})();function B(O){var A=new DataView(O),T=new L(A),y=T.parse();if(T.offset!==O.byteLength)throw new Error(O.byteLength-T.offset+" trailing bytes");return y}function N(O,A){return Object.keys(O).filter(function(T){var y=O[T],z=typeof y;return(!A||y!=null)&&(z!=="function"||!!y.toJSON)})}function M(O,A,T,y){var z=typeof O;if(typeof O=="string"){var U=g(O);if(U<32)return A.setUint8(T,U|160),f(A,T+1,O),1+U;if(U<256)return A.setUint8(T,217),A.setUint8(T+1,U),f(A,T+2,O),2+U;if(U<65536)return A.setUint8(T,218),A.setUint16(T+1,U),f(A,T+3,O),3+U;if(U<4294967296)return A.setUint8(T,219),A.setUint32(T+1,U),f(A,T+5,O),5+U}if(ArrayBuffer.isView&&ArrayBuffer.isView(O)&&(O=O.buffer),O instanceof ArrayBuffer){var G=O.byteLength;if(G<256)return A.setUint8(T,196),A.setUint8(T+1,G),new Uint8Array(A.buffer).set(new Uint8Array(O),T+2),2+G;if(G<65536)return A.setUint8(T,197),A.setUint16(T+1,G),new Uint8Array(A.buffer).set(new Uint8Array(O),T+3),3+G;if(G<4294967296)return A.setUint8(T,198),A.setUint32(T+1,G),new Uint8Array(A.buffer).set(new Uint8Array(O),T+5),5+G}if(typeof O=="number"){if(Math.floor(O)!==O)return A.setUint8(T,203),A.setFloat64(T+1,O),9;if(O>=0){if(O<128)return A.setUint8(T,O),1;if(O<256)return A.setUint8(T,204),A.setUint8(T+1,O),2;if(O<65536)return A.setUint8(T,205),A.setUint16(T+1,O),3;if(O<4294967296)return A.setUint8(T,206),A.setUint32(T+1,O),5;if(O<18446744073709552e3)return A.setUint8(T,207),D(A,T+1,O),9;throw new Error("Number too big 0x"+O.toString(16))}if(O>=-32)return A.setInt8(T,O),1;if(O>=-128)return A.setUint8(T,208),A.setInt8(T+1,O),2;if(O>=-32768)return A.setUint8(T,209),A.setInt16(T+1,O),3;if(O>=-2147483648)return A.setUint8(T,210),A.setInt32(T+1,O),5;if(O>=-9223372036854776e3)return A.setUint8(T,211),v(A,T+1,O),9;throw new Error("Number too small -0x"+(-O).toString(16).substr(1))}if(z==="undefined")return y?0:(A.setUint8(T,212),A.setUint8(T+1,0),A.setUint8(T+2,0),3);if(O===null)return y?0:(A.setUint8(T,192),1);if(z==="boolean")return A.setUint8(T,O?195:194),1;if(typeof O.toJSON=="function")return M(O.toJSON(),A,T,y);if(z==="object"){var K,Q=0,X=void 0,Y=Array.isArray(O);if(Y?K=O.length:(X=N(O,y),K=X.length),K<16?(A.setUint8(T,K|(Y?144:128)),Q=1):K<65536?(A.setUint8(T,Y?220:222),A.setUint16(T+1,K),Q=3):K<4294967296&&(A.setUint8(T,Y?221:223),A.setUint32(T+1,K),Q=5),Y)for(var j=0;j<K;j++)Q+=M(O[j],A,T+Q,y);else if(X)for(var j=0;j<K;j++){var I=X[j];Q+=M(I,A,T+Q),Q+=M(O[I],A,T+Q,y)}return Q}if(z==="function")return 0;throw new Error("Unknown type "+z)}function P(O,A){var T=typeof O;if(T==="string"){var y=g(O);if(y<32)return 1+y;if(y<256)return 2+y;if(y<65536)return 3+y;if(y<4294967296)return 5+y}if(ArrayBuffer.isView&&ArrayBuffer.isView(O)&&(O=O.buffer),O instanceof ArrayBuffer){var z=O.byteLength;if(z<256)return 2+z;if(z<65536)return 3+z;if(z<4294967296)return 5+z}if(typeof O=="number"){if(Math.floor(O)!==O)return 9;if(O>=0){if(O<128)return 1;if(O<256)return 2;if(O<65536)return 3;if(O<4294967296)return 5;if(O<18446744073709552e3)return 9;throw new Error("Number too big 0x"+O.toString(16))}if(O>=-32)return 1;if(O>=-128)return 2;if(O>=-32768)return 3;if(O>=-2147483648)return 5;if(O>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+O.toString(16).substr(1))}if(T==="boolean")return 1;if(O===null)return A?0:1;if(O===void 0)return A?0:3;if(typeof O.toJSON=="function")return P(O.toJSON(),A);if(T==="object"){var U,G=0;if(Array.isArray(O)){U=O.length;for(var K=0;K<U;K++)G+=P(O[K],A)}else{var Q=N(O,A);U=Q.length;for(var K=0;K<U;K++){var X=Q[K];G+=P(X)+P(O[X],A)}}if(U<16)return 1+G;if(U<65536)return 3+G;if(U<4294967296)return 5+G;throw new Error("Array or object too long 0x"+U.toString(16))}if(T==="function")return 0;throw new Error("Unknown type "+T)}a.default={encode:m,decode:B,inspect:l,utf8Write:f,utf8Read:d,utf8ByteCount:g}}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(30)),d=l.__importDefault(r(50)),g=l.__importDefault(r(3)),m=l.__importDefault(r(4)),_=l.__importDefault(r(55)),C=l.__importDefault(r(57)),E=l.__importDefault(r(62)),R=l.__importDefault(r(64)),v=l.__importDefault(r(68)),D=l.__importDefault(r(2)),L=r(8),B=l.__importDefault(r(65)),N=l.__importDefault(r(66)),M=l.__importDefault(r(41)),P=(0,C.default)(R.default,_.default);g.default.Crypto=P,g.default.BufferUtils=_.default,g.default.Http=E.default,g.default.Config=R.default,g.default.Transports=v.default,g.default.WebStorage=B.default,f.default.Crypto=P,d.default.Crypto=P,D.default.initLogHandlers(),g.default.Defaults=(0,L.getDefaults)(N.default),g.default.Config.agent&&(g.default.Defaults.agent+=" "+g.default.Config.agent),g.default.Config.noUpgrade&&(g.default.Defaults.upgradeTransports=[]),a.default={ErrorInfo:m.default,Rest:f.default,Realtime:d.default,msgpack:M.default}}),(function(n){n.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')}),(function(n,a){}),(function(n,a,r){(function(l,f){n.exports=f(r(6),r(32),r(25))})(this,function(l){return l.HmacSHA256})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(47)),g=l.__importDefault(r(15)),m=l.__importDefault(r(20)),_=l.__importDefault(r(4)),C=l.__importDefault(r(48)),E=function(){},R=(function(){function B(N){this.rest=N,this.admin=new v(N)}return B})(),v=(function(){function B(N){this.rest=N,this.deviceRegistrations=new D(N),this.channelSubscriptions=new L(N)}return B.prototype.publish=function(N,M,P){var O=this.rest,A=O.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(O.options,A),y={},z=f.mixin({recipient:N},M);if(typeof P!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);P=E}O.options.headers&&f.mixin(T,O.options.headers),O.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var U=f.encodeBody(z,A);g.default.post(O,"/push/publish",U,T,y,null,function(G){return P(G)})},B})(),D=(function(){function B(N){this.rest=N}return B.prototype.save=function(N,M){var P=this.rest,O=d.default.fromValues(N),A=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(P.options,A),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}P.options.headers&&f.mixin(T,P.options.headers),P.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var z=f.encodeBody(O,A);g.default.put(P,"/push/deviceRegistrations/"+encodeURIComponent(N.id),z,T,y,null,function(U,G,K,Q){M(U,U?void 0:d.default.fromResponseBody(G,Q?void 0:A))})},B.prototype.get=function(N,M){var P=this.rest,O=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(P.options,O),T=N.id||N;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"get",arguments);M=E}if(typeof T!="string"||!T.length){M(new _.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}P.options.headers&&f.mixin(A,P.options.headers),g.default.get(P,"/push/deviceRegistrations/"+encodeURIComponent(T),A,{},null,function(y,z,U,G){M(y,y?void 0:d.default.fromResponseBody(z,G?void 0:O))})},B.prototype.list=function(N,M){var P=this.rest,O=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(P.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}P.options.headers&&f.mixin(T,P.options.headers),new m.default(P,"/push/deviceRegistrations",T,A,function(y,z,U){return d.default.fromResponseBody(y,U?void 0:O)}).get(N,M)},B.prototype.remove=function(N,M){var P=this.rest,O=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(P.options,O),T={},y=N.id||N;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"remove",arguments);M=E}if(typeof y!="string"||!y.length){M(new _.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}P.options.headers&&f.mixin(A,P.options.headers),P.options.pushFullWait&&f.mixin(T,{fullWait:"true"}),g.default.delete(P,"/push/deviceRegistrations/"+encodeURIComponent(y),A,T,null,function(z){return M(z)})},B.prototype.removeWhere=function(N,M){var P=this.rest,O=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(P.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}P.options.headers&&f.mixin(A,P.options.headers),P.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),g.default.delete(P,"/push/deviceRegistrations",A,N,null,function(T){return M(T)})},B})(),L=(function(){function B(N){this.remove=B.prototype.removeWhere,this.rest=N}return B.prototype.save=function(N,M){var P=this.rest,O=C.default.fromValues(N),A=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(P.options,A),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}P.options.headers&&f.mixin(T,P.options.headers),P.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var z=f.encodeBody(O,A);g.default.post(P,"/push/channelSubscriptions",z,T,y,null,function(U,G,K,Q){M(U,!U&&C.default.fromResponseBody(G,Q?void 0:A))})},B.prototype.list=function(N,M){var P=this.rest,O=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(P.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}P.options.headers&&f.mixin(T,P.options.headers),new m.default(P,"/push/channelSubscriptions",T,A,function(y,z,U){return C.default.fromResponseBody(y,U?void 0:O)}).get(N,M)},B.prototype.removeWhere=function(N,M){var P=this.rest,O=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(P.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}P.options.headers&&f.mixin(A,P.options.headers),P.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),g.default.delete(P,"/push/channelSubscriptions",A,N,null,function(T){return M(T)})},B.prototype.listChannels=function(N,M){var P=this.rest,O=P.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(P.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"listChannels",arguments);M=E}P.options.headers&&f.mixin(T,P.options.headers),P.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),new m.default(P,"/push/channels",T,A,function(y,z,U){for(var G=!U&&O?f.decodeBody(y,O):y,K=0;K<G.length;K++)G[K]=String(G[K]);return G}).get(N,M)},B})();a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(4)),g;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(g||(g={}));var m;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(m||(m={}));var _=(function(){function C(){}return C.prototype.toJSON=function(){var E,R,v;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(R=this.push)===null||R===void 0?void 0:R.state,error:(v=this.push)===null||v===void 0?void 0:v.error}}},C.prototype.toString=function(){var E,R,v,D,L="[DeviceDetails";return this.id&&(L+="; id="+this.id),this.platform&&(L+="; platform="+this.platform),this.formFactor&&(L+="; formFactor="+this.formFactor),this.clientId&&(L+="; clientId="+this.clientId),this.metadata&&(L+="; metadata="+this.metadata),this.deviceIdentityToken&&(L+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(L+="; push.recipient="+JSON.stringify(this.push.recipient)),!((R=this.push)===null||R===void 0)&&R.state&&(L+="; push.state="+this.push.state),!((v=this.push)===null||v===void 0)&&v.error&&(L+="; push.error="+JSON.stringify(this.push.error)),!((D=this.push)===null||D===void 0)&&D.metadata&&(L+="; push.metadata="+this.push.metadata),L+="]",L},C.fromResponseBody=function(E,R){return R&&(E=f.decodeBody(E,R)),f.isArray(E)?C.fromValuesArray(E):C.fromValues(E)},C.fromValues=function(E){return E.error=E.error&&d.default.fromValues(E.error),Object.assign(new C,E)},C.fromValuesArray=function(E){for(var R=E.length,v=new Array(R),D=0;D<R;D++)v[D]=C.fromValues(E[D]);return v},C.toRequestBody=f.encodeBody,C})();a.default=_}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=(function(){function g(){}return g.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},g.prototype.toString=function(){var m="[PushChannelSubscription";return this.channel&&(m+="; channel="+this.channel),this.deviceId&&(m+="; deviceId="+this.deviceId),this.clientId&&(m+="; clientId="+this.clientId),m+="]",m},g.fromResponseBody=function(m,_){return _&&(m=f.decodeBody(m,_)),f.isArray(m)?g.fromValuesArray(m):g.fromValues(m)},g.fromValues=function(m){return Object.assign(new g,m)},g.fromValuesArray=function(m){for(var _=m.length,C=new Array(_),E=0;E<_;E++)C[E]=g.fromValues(m[E]);return C},g.toRequestBody=f.encodeBody,g})();a.default=d}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=(function(){function P(O){this.count=O&&O.count||0,this.data=O&&O.data||0,this.uncompressedData=O&&O.uncompressedData||0,this.failed=O&&O.failed||0,this.refused=O&&O.refused||0}return P})(),g=(function(P){l.__extends(O,P);function O(A){var T=P.call(this,A)||this;return A&&A.category&&(T.category={},f.forInOwnNonNullProperties(A.category,function(y){T.category[y]=new d(A.category[y])})),T}return O})(d),m=(function(){function P(O){this.peak=O&&O.peak||0,this.min=O&&O.min||0,this.mean=O&&O.mean||0,this.opened=O&&O.opened||0,this.refused=O&&O.refused||0}return P})(),_=(function(){function P(O){this.succeeded=O&&O.succeeded||0,this.failed=O&&O.failed||0,this.refused=O&&O.refused||0}return P})(),C=(function(){function P(O){this.plain=new m(O&&O.plain),this.tls=new m(O&&O.tls),this.all=new m(O&&O.all)}return P})(),E=(function(){function P(O){this.messages=new g(O&&O.messages),this.presence=new g(O&&O.presence),this.all=new g(O&&O.all)}return P})(),R=(function(){function P(O){this.realtime=new E(O&&O.realtime),this.rest=new E(O&&O.rest),this.webhook=new E(O&&O.webhook),this.sharedQueue=new E(O&&O.sharedQueue),this.externalQueue=new E(O&&O.externalQueue),this.httpEvent=new E(O&&O.httpEvent),this.push=new E(O&&O.push),this.all=new E(O&&O.all)}return P})(),v=(function(){function P(O){this.all=new E(O&&O.all),this.inbound=new R(O&&O.inbound),this.outbound=new R(O&&O.outbound)}return P})(),D=(function(){function P(O){this.all=new E(O&&O.all),this.producerPaid=new v(O&&O.producerPaid),this.consumerPaid=new v(O&&O.consumerPaid)}return P})(),L=(function(){function P(O){this.messages=O&&O.messages||0;var A=O&&O.notifications;this.notifications={invalid:A&&A.invalid||0,attempted:A&&A.attempted||0,successful:A&&A.successful||0,failed:A&&A.failed||0},this.directPublishes=O&&O.directPublishes||0}return P})(),B=(function(){function P(O){this.succeeded=O&&O.succeeded||0,this.skipped=O&&O.skipped||0,this.failed=O&&O.failed||0}return P})(),N=(function(){function P(O){var A=this;this.delta=void 0,O&&O.delta&&(this.delta={},f.forInOwnNonNullProperties(O.delta,function(T){A.delta[T]=new B(O.delta[T])}))}return P})(),M=(function(P){l.__extends(O,P);function O(A){var T=P.call(this,A)||this;return T.persisted=new E(A&&A.persisted),T.connections=new C(A&&A.connections),T.channels=new m(A&&A.channels),T.apiRequests=new _(A&&A.apiRequests),T.tokenRequests=new _(A&&A.tokenRequests),T.xchgProducer=new D(A&&A.xchgProducer),T.xchgConsumer=new D(A&&A.xchgConsumer),T.push=new L(A&&A.pushStats),T.processed=new N(A&&A.processed),T.inProgress=A&&A.inProgress||void 0,T.unit=A&&A.unit||void 0,T.intervalId=A&&A.intervalId||void 0,T}return O.fromValues=function(A){return new O(A)},O})(v);a.default=M}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(30)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(51)),C=l.__importDefault(r(38)),E=l.__importDefault(r(8)),R=l.__importDefault(r(4)),v=l.__importDefault(r(10)),D=l.__importDefault(r(35)),L=l.__importDefault(r(3)),B=l.__importDefault(r(9)),N=(function(P){l.__extends(O,P);function O(A){var T=P.call(this,A)||this;return m.default.logAction(m.default.LOG_MINOR,"Realtime()",""),T.connection=new _.default(T,T.options),T.channels=new M(T),A.autoConnect!==!1&&T.connect(),T}return O.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},O.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},O.Promise=function(A){return A=E.default.objectifyOptions(A),A.promises=!0,new O(A)},O.Callbacks=O,O.Utils=f,O.ConnectionManager=D.default,O.Platform=L.default,O.ProtocolMessage=v.default,O.Message=B.default,O})(d.default),M=(function(P){l.__extends(O,P);function O(A){var T=P.call(this)||this;return T.realtime=A,T.all=Object.create(null),A.connection.connectionManager.on("transport.active",function(){T.onTransportActive()}),T}return O.prototype.channelSerials=function(){for(var A={},T=0,y=f.keysArray(this.all,!0);T<y.length;T++){var z=y[T],U=this.all[z];U.properties.channelSerial&&(A[z]=U.properties.channelSerial)}return A},O.prototype.recoverChannels=function(A){for(var T=0,y=f.keysArray(A,!0);T<y.length;T++){var z=y[T],U=this.get(z);U.properties.channelSerial=A[z]}},O.prototype.onChannelMessage=function(A){var T=A.channel;if(T===void 0){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+A.action);return}var y=this.all[T];if(!y){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+T);return}y.onMessage(A)},O.prototype.onTransportActive=function(){for(var A in this.all){var T=this.all[A];T.state==="attaching"||T.state==="detaching"?T.checkPendingState():T.state==="suspended"?T._attach(!1,null):T.state==="attached"&&T.requestState("attaching")}},O.prototype.propogateConnectionInterruption=function(A,T){var y={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},z=["attaching","attached","detaching","suspended"],U=y[A];for(var G in this.all){var K=this.all[G];f.arrIn(z,K.state)&&K.notifyState(U,T)}},O.prototype.get=function(A,T){A=String(A);var y=this.all[A];if(!y)y=this.all[A]=new C.default(this.realtime,A,T);else if(T){if(y._shouldReattachToSetOptions(T,y.channelOptions))throw new R.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);y.setOptions(T)}return y},O.prototype.getDerived=function(A,T,y){if(T.filter){var z=f.toBase64(T.filter),U=f.matchDerivedChannel(A);A="[filter=".concat(z).concat(U.qualifierParam,"]").concat(U.channelName)}return this.get(A,y)},O.prototype.release=function(A){A=String(A);var T=this.all[A];if(T){var y=T.getReleaseErr();if(y)throw y;delete this.all[A]}},O})(g.default);a.default=N}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(35)),m=l.__importDefault(r(2)),_=l.__importDefault(r(37)),C=l.__importDefault(r(3));function E(){}var R=(function(v){l.__extends(D,v);function D(L,B){var N=v.call(this)||this;return N.whenState=(function(M,P){return d.default.prototype.whenState.call(N,M,N.state,P,new _.default(void 0,M))}),N.ably=L,N.connectionManager=new g.default(L,B),N.state=N.connectionManager.state.state,N.key=void 0,N.id=void 0,N.errorReason=null,N.connectionManager.on("connectionstate",function(M){var P=N.state=M.current;C.default.Config.nextTick(function(){N.emit(P,M)})}),N.connectionManager.on("update",function(M){C.default.Config.nextTick(function(){N.emit("update",M)})}),N}return D.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},D.prototype.ping=function(L){if(m.default.logAction(m.default.LOG_MINOR,"Connection.ping()",""),!L){if(this.ably.options.promises)return f.promisify(this,"ping",arguments);L=E}this.connectionManager.ping(null,L)},D.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(D.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),D.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},D})(d.default);a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.PendingMessage=void 0;var l=r(0),f=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(36)),C=l.__importDefault(r(4)),E=f.default.Action,R=(function(){function D(L,B){this.message=L,this.callback=B,this.merged=!1;var N=L.action;this.sendAttempted=!1,this.ackRequired=N==E.MESSAGE||N==E.PRESENCE}return D})();a.PendingMessage=R;var v=(function(D){l.__extends(L,D);function L(B){var N=D.call(this)||this;return N.transport=B,N.messageQueue=new _.default,B.on("ack",function(M,P){N.onAck(M,P)}),B.on("nack",function(M,P,O){N.onNack(M,P,O)}),N}return L.prototype.onAck=function(B,N){m.default.logAction(m.default.LOG_MICRO,"Protocol.onAck()","serial = "+B+"; count = "+N),this.messageQueue.completeMessages(B,N)},L.prototype.onNack=function(B,N,M){m.default.logAction(m.default.LOG_ERROR,"Protocol.onNack()","serial = "+B+"; count = "+N+"; err = "+d.inspectError(M)),M||(M=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(B,N,M)},L.prototype.onceIdle=function(B){var N=this.messageQueue;if(N.count()===0){B();return}N.once("idle",B)},L.prototype.send=function(B){B.ackRequired&&this.messageQueue.push(B),m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Protocol.send()","sending msg; "+f.default.stringify(B.message)),B.sendAttempted=!0,this.transport.send(B.message)},L.prototype.getTransport=function(){return this.transport},L.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},L.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},L.prototype.finish=function(){var B=this.transport;this.onceIdle(function(){B.disconnect()})},L})(g.default);a.default=v}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(26)),m=l.__importDefault(r(8)),_=l.__importDefault(r(2)),C=l.__importDefault(r(10)),E=l.__importDefault(r(4)),R="web_socket";function v(B){return!!B.on}var D=(function(B){l.__extends(N,B);function N(M,P,O){var A=B.call(this,M,P,O)||this;return A.shortName=R,O.heartbeats=f.default.Config.useProtocolHeartbeats,A.wsHost=m.default.getHost(O.options,O.host,!0),A}return N.isAvailable=function(){return!!f.default.Config.WebSocket},N.prototype.createWebSocket=function(M,P){return this.uri=M+d.toQueryString(P),new f.default.Config.WebSocket(this.uri)},N.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},N.prototype.connect=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),g.default.prototype.connect.call(this);var M=this,P=this.params,O=P.options,A=O.tls?"wss://":"ws://",T=A+this.wsHost+":"+m.default.getPort(O)+"/";_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+T),this.auth.getAuthParams(function(y,z){if(!M.isDisposed){var U="";for(var G in z)U+=" "+G+": "+z[G]+";";if(_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+U+" err: "+y),y){M.disconnect(y);return}var K=P.getConnectParams(z);try{var Q=M.wsConnection=M.createWebSocket(T,K);Q.binaryType=f.default.Config.binaryType,Q.onopen=function(){M.onWsOpen()},Q.onclose=function(X){M.onWsClose(X)},Q.onmessage=function(X){M.onWsData(X.data)},Q.onerror=function(X){M.onWsError(X)},v(Q)&&Q.on("ping",function(){M.onActivity()})}catch(X){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(X.stack||X.message)),M.disconnect(X)}}})},N.prototype.send=function(M){var P=this.wsConnection;if(!P){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{P.send(C.default.serialize(M,this.params.format))}catch(A){var O="Exception from ws connection when trying to send: "+d.inspectError(A);_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()",O),this.finish("disconnected",new E.default(O,5e4,500))}},N.prototype.onWsData=function(M){_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+M.length+"; type = "+typeof M);try{this.onProtocolMessage(C.default.deserialize(M,this.format))}catch(P){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+P.stack)}},N.prototype.onWsOpen=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},N.prototype.onWsClose=function(M){var P,O;if(typeof M=="object"?(O=M.code,P=M.wasClean||O===1e3):(O=M,P=O==1e3),delete this.wsConnection,P){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var A=new E.default("Websocket closed",80003,400);this.finish("disconnected",A)}else{var T="Unclean disconnection of WebSocket ; code = "+O,A=new E.default(T,80003,400);_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()",T),this.finish("disconnected",A)}this.emit("disposed")},N.prototype.onWsError=function(M){var P=this;_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+M.message),f.default.Config.nextTick(function(){P.disconnect(Error(M.message))})},N.prototype.dispose=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var M=this.wsConnection;M&&(M.onmessage=function(){},delete this.wsConnection,f.default.Config.nextTick(function(){if(_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!M)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");M.close()}))},N})(g.default);function L(B){return D.isAvailable()&&(B.supportedTransports[R]=D),D}a.default=L}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(34)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(16)),C=l.__importStar(r(4)),E=l.__importDefault(r(38)),R=l.__importDefault(r(24)),v=l.__importDefault(r(39)),D=function(){};function L(A){return A.channel.realtime.auth.clientId}function B(A){var T=A.channel.realtime,y=T.auth.clientId;return(!y||y==="*")&&T.connection.state==="connected"}function N(A,T,y){switch(A.state){case"attached":case"suspended":y();break;case"initialized":case"detached":case"detaching":case"attaching":A.attach(function(z){z?T(z):y()});break;default:T(C.default.fromValues(A.invalidStateError()))}}function M(A,T){if(A.isSynthesized()||T.isSynthesized())return A.timestamp>=T.timestamp;var y=A.parseId(),z=T.parseId();return y.msgSerial===z.msgSerial?y.index>z.index:y.msgSerial>z.msgSerial}var P=(function(A){l.__extends(T,A);function T(y){var z=A.call(this,y)||this;return z.channel=y,z.syncComplete=!1,z.members=new O(z,function(U){return U.clientId+":"+U.connectionId}),z._myMembers=new O(z,function(U){return U.clientId}),z.subscriptions=new g.default,z.pendingPresence=[],z}return T.prototype.enter=function(y,z){if(B(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"enter",z)},T.prototype.update=function(y,z){if(B(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"update",z)},T.prototype.enterClient=function(y,z,U){return this._enterOrUpdateClient(void 0,y,z,"enter",U)},T.prototype.updateClient=function(y,z,U){return this._enterOrUpdateClient(void 0,y,z,"update",U)},T.prototype._enterOrUpdateClient=function(y,z,U,G,K){var Q=this;if(!K)if(typeof U=="function")K=U,U=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"_enterOrUpdateClient",[y,z,U,G]);K=D}var X=this.channel;if(!X.connectionManager.activeState()){K(X.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence."+G+"Client()","channel = "+X.name+", id = "+y+", client = "+(z||"(implicit) "+L(this)));var Y=_.default.fromData(U);Y.action=G,y&&(Y.id=y),z&&(Y.clientId=z),_.default.encode(Y,X.channelOptions,function(j){if(j){K(j);return}switch(X.state){case"attached":X.sendPresence(Y,K);break;case"initialized":case"detached":X.attach();case"attaching":Q.pendingPresence.push({presence:Y,callback:K});break;default:j=new C.PartialErrorInfo("Unable to "+G+" presence channel while in "+X.state+" state",90001),j.code=90001,K(j)}})},T.prototype.leave=function(y,z){if(B(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,y,z)},T.prototype.leaveClient=function(y,z,U){if(!U)if(typeof z=="function")U=z,z=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"leaveClient",[y,z]);U=D}var G=this.channel;if(!G.connectionManager.activeState()){U==null||U(G.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+y);var K=_.default.fromData(z);switch(K.action="leave",y&&(K.clientId=y),G.state){case"attached":G.sendPresence(K,U);break;case"attaching":this.pendingPresence.push({presence:K,callback:U});break;case"initialized":case"failed":{var Q=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);U==null||U(Q);break}default:U==null||U(G.invalidStateError())}},T.prototype.get=function(y,z){var U=this,G=Array.prototype.slice.call(arguments);G.length==1&&typeof G[0]=="function"&&G.unshift(null),y=G[0],z=G[1];var K=!y||("waitForSync"in y?y.waitForSync:!0);if(!z){if(this.channel.realtime.options.promises)return f.promisify(this,"get",G);z=D}function Q(X){z(null,y?X.list(y):X.values())}if(this.channel.state==="suspended"){K?z(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):Q(this.members);return}N(this.channel,z,function(){var X=U.members;K?X.waitSync(function(){Q(X)}):Q(X)})},T.prototype.history=function(y,z){if(m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),z===void 0)if(typeof y=="function")z=y,y=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"history",arguments);z=D}y&&y.untilAttach&&(this.channel.state==="attached"?(delete y.untilAttach,y.from_serial=this.channel.properties.attachSerial):z(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),d.default.prototype._history.call(this,y,z)},T.prototype.setPresence=function(y,z,U){m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+y.length+" participants; syncChannelSerial = "+U);var G,K,Q=this.members,X=this._myMembers,Y=[],j=this.channel.connectionManager.connectionId;z&&(this.members.startSync(),U&&(K=U.match(/^[\w-]+:(.*)$/))&&(G=K[1]));for(var I=0;I<y.length;I++){var F=_.default.fromValues(y[I]);switch(F.action){case"leave":Q.remove(F)&&Y.push(F),F.connectionId===j&&!F.isSynthesized()&&X.remove(F);break;case"enter":case"present":case"update":Q.put(F)&&Y.push(F),F.connectionId===j&&X.put(F);break}}z&&!G&&(Q.endSync(),this.channel.syncChannelSerial=null);for(var I=0;I<Y.length;I++){var F=Y[I];this.subscriptions.emit(F.action,F)}},T.prototype.onAttached=function(y){m.default.logAction(m.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+y),y?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var z=this.pendingPresence,U=z.length;if(U){this.pendingPresence=[];var G=[],K=R.default.create();m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+U+" queued presence messages");for(var Q=0;Q<U;Q++){var X=z[Q];G.push(X.presence),K.push(X.callback)}this.channel.sendPresence(G,K)}},T.prototype.actOnChannelState=function(y,z,U){switch(y){case"attached":this.onAttached(z);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(U);break}},T.prototype.failPendingPresence=function(y){if(this.pendingPresence.length){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+f.inspectError(y));for(var z=0;z<this.pendingPresence.length;z++)try{this.pendingPresence[z].callback(y)}catch{}this.pendingPresence=[]}},T.prototype._clearMyMembers=function(){this._myMembers.clear()},T.prototype._ensureMyMembersPresent=function(){var y=this,z=this._myMembers,U=function(Q){if(Q){var X="Presence auto-re-enter failed: "+Q.toString(),Y=new C.default(X,91004,400);m.default.logAction(m.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",X);var j=new v.default(y.channel.state,y.channel.state,!0,!1,Y);y.channel.emit("update",j)}};for(var G in z.map){var K=z.map[G];m.default.logAction(m.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+K.clientId+'" into the presence set'),this._enterOrUpdateClient(K.id,K.clientId,K.data,"enter",U)}},T.prototype._synthesizeLeaves=function(y){var z=this.subscriptions;f.arrForEach(y,function(U){var G=_.default.fromValues({action:"leave",connectionId:U.connectionId,clientId:U.clientId,data:U.data,encoding:U.encoding,timestamp:f.now()});z.emit("leave",G)})},T.prototype.on=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];m.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,y)},T.prototype.off=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];m.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,y)},T.prototype.subscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=E.default.processListenerArgs(y),G=U[0],K=U[1],Q=U[2],X=this.channel;if(!Q){if(this.channel.realtime.options.promises)return f.promisify(this,"subscribe",[G,K]);Q=D}if(X.state==="failed"){Q(C.default.fromValues(X.invalidStateError()));return}this.subscriptions.on(G,K),X.attach(Q)},T.prototype.unsubscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=E.default.processListenerArgs(y),G=U[0],K=U[1];this.subscriptions.off(G,K)},T})(d.default),O=(function(A){l.__extends(T,A);function T(y,z){var U=A.call(this)||this;return U.presence=y,U.map=Object.create(null),U.syncInProgress=!1,U.residualMembers=null,U.memberKey=z,U}return T.prototype.get=function(y){return this.map[y]},T.prototype.getClient=function(y){var z=this.map,U=[];for(var G in z){var K=z[G];K.clientId==y&&K.action!="absent"&&U.push(K)}return U},T.prototype.list=function(y){var z=this.map,U=y&&y.clientId,G=y&&y.connectionId,K=[];for(var Q in z){var X=z[Q];X.action!=="absent"&&(U&&U!=X.clientId||G&&G!=X.connectionId||K.push(X))}return K},T.prototype.put=function(y){(y.action==="enter"||y.action==="update")&&(y=_.default.fromValues(y),y.action="present");var z=this.map,U=this.memberKey(y);this.residualMembers&&delete this.residualMembers[U];var G=z[U];return G&&!M(y,G)?!1:(z[U]=y,!0)},T.prototype.values=function(){var y=this.map,z=[];for(var U in y){var G=y[U];G.action!="absent"&&z.push(G)}return z},T.prototype.remove=function(y){var z=this.map,U=this.memberKey(y),G=z[U];return G&&!M(y,G)?!1:(this.syncInProgress?(y=_.default.fromValues(y),y.action="absent",z[U]=y):delete z[U],!0)},T.prototype.startSync=function(){var y=this.map,z=this.syncInProgress;m.default.logAction(m.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),this.syncInProgress||(this.residualMembers=f.copy(y),this.setInProgress(!0))},T.prototype.endSync=function(){var y=this.map,z=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),z){for(var U in y){var G=y[U];G.action==="absent"&&delete y[U]}this.presence._synthesizeLeaves(f.valuesArray(this.residualMembers));for(var U in this.residualMembers)delete y[U];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},T.prototype.waitSync=function(y){var z=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),!z){y();return}this.once("sync",y)},T.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},T.prototype.setInProgress=function(y){m.default.logAction(m.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+y),this.syncInProgress=y,this.presence.syncComplete=!y},T})(g.default);a.default=P}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=r(56),d=r(31),g=r(11),m=l.__importDefault(r(5)),_=l.__importDefault(r(3)),C=(function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(R){return R!=null&&R.sigBytes!==void 0},E.prototype.isArrayBuffer=function(R){return R!=null&&R.constructor===ArrayBuffer},E.prototype.isTypedArray=function(R){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(R)},E.prototype.uint8ViewToBase64=function(R){for(var v="",D=this.base64CharSet,L=R.byteLength,B=L%3,N=L-B,M,P,O,A,T,y=0;y<N;y=y+3)T=R[y]<<16|R[y+1]<<8|R[y+2],M=(T&16515072)>>18,P=(T&258048)>>12,O=(T&4032)>>6,A=T&63,v+=D[M]+D[P]+D[O]+D[A];return B==1?(T=R[N],M=(T&252)>>2,P=(T&3)<<4,v+=D[M]+D[P]+"=="):B==2&&(T=R[N]<<8|R[N+1],M=(T&64512)>>10,P=(T&1008)>>4,O=(T&15)<<2,v+=D[M]+D[P]+D[O]+"="),v},E.prototype.base64ToArrayBuffer=function(R){for(var v=atob==null?void 0:atob(R),D=v.length,L=new Uint8Array(D),B=0;B<D;B++){var N=v.charCodeAt(B);L[B]=N}return L.buffer},E.prototype.isBuffer=function(R){return this.isArrayBuffer(R)||this.isWordArray(R)||this.isTypedArray(R)},E.prototype.toBuffer=function(R){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(R))return new Uint8Array(R);if(this.isTypedArray(R))return new Uint8Array(R.buffer);if(this.isWordArray(R)){for(var v=new ArrayBuffer(R.sigBytes),D=new Uint8Array(v),L=0;L<R.sigBytes;L++)D[L]=R.words[L>>>2]>>>24-L%4*8&255;return D}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(R){return this.isArrayBuffer(R)?R:this.toBuffer(R).buffer},E.prototype.toWordArray=function(R){return this.isTypedArray(R)&&(R=R.buffer),this.isWordArray(R)?R:m.default.create(R)},E.prototype.base64Encode=function(R){return this.isWordArray(R)?(0,g.stringify)(R):this.uint8ViewToBase64(this.toBuffer(R))},E.prototype.base64Decode=function(R){return ArrayBuffer&&_.default.Config.atob?this.base64ToArrayBuffer(R):(0,g.parse)(R)},E.prototype.hexEncode=function(R){return(0,f.stringify)(this.toWordArray(R))},E.prototype.hexDecode=function(R){var v=(0,f.parse)(R);return ArrayBuffer?this.toArrayBuffer(v):v},E.prototype.utf8Encode=function(R){return _.default.Config.TextEncoder?new _.default.Config.TextEncoder().encode(R).buffer:(0,d.parse)(R)},E.prototype.utf8Decode=function(R){if(!this.isBuffer(R))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(R)?new TextDecoder().decode(R):(R=this.toWordArray(R),(0,d.stringify)(R))},E.prototype.bufferCompare=function(R,v){if(!R)return-1;if(!v)return 1;var D=this.toWordArray(R),L=this.toWordArray(v);D.clamp(),L.clamp();var B=D.sigBytes-L.sigBytes;if(B!=0)return B;for(var N=D.words,M=L.words,P=0;P<N.length;P++)if(B=N[P]-M[P],B!=0)return B;return 0},E.prototype.byteLength=function(R){return this.isArrayBuffer(R)||this.isTypedArray(R)?R.byteLength:this.isWordArray(R)?R.sigBytes:-1},E.prototype.typedArrayToBuffer=function(R){return R.buffer},E})();a.default=new C}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return l.enc.Hex})}),(function(n,a,r){r.r(a);var l=r(5),f=r.n(l),d=r(11),g=r(23),m=r.n(g),_=r(2),C=r.n(_),E=r(4),R=r.n(E),v=function(D,L){var B="aes",N=256,M="cbc",P=16,O=4,A=4294967296,T=2147483648,y;if(D.getRandomWordArray)y=D.getRandomWordArray;else if(typeof Uint32Array<"u"&&D.getRandomValues){var z=new Uint32Array(O);y=function(I,F){var W=I/4,it=W==O?z:new Uint32Array(W);D.getRandomValues(it,function(Z){typeof F<"u"&&F(Z,L.toWordArray(it))})}}else y=function(I,F){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var W=I/4,it=new Array(W),Z=0;Z<W;Z++)it[Z]=Math.floor(Math.random()*A)-T;F(null,f.a.create(it))};function U(I){return I+P&-P}function G(I){if(I.algorithm==="aes"&&I.mode==="cbc"){if(I.keyLength===128||I.keyLength===256)return;throw new Error("Unsupported key length "+I.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function K(I){return I.replace("_","/").replace("-","+")}var Q=[f.a.create([269488144,269488144,269488144,269488144],16),f.a.create([16777216],1),f.a.create([33685504],2),f.a.create([50529024],3),f.a.create([67372036],4),f.a.create([84215045,83886080],5),f.a.create([101058054,101056512],6),f.a.create([117901063,117901056],7),f.a.create([134744072,134744072],8),f.a.create([151587081,151587081,150994944],9),f.a.create([168430090,168430090,168427520],10),f.a.create([185273099,185273099,185273088],11),f.a.create([202116108,202116108,202116108],12),f.a.create([218959117,218959117,218959117,218103808],13),f.a.create([235802126,235802126,235802126,235798528],14),f.a.create([252645135,252645135,252645135,252645135],15),f.a.create([269488144,269488144,269488144,269488144],16)];function X(){}function Y(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}X.CipherParams=Y,X.getDefaultParams=function(I){var F;if(typeof I=="function"||typeof I=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof I=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),X.generateRandomKey(function(it){I(null,X.getDefaultParams({key:it}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,X.getDefaultParams({key:I}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!I.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof I.key=="string"?F=Object(d.parse)(K(I.key)):F=L.toWordArray(I.key);var W=new Y;if(W.key=F,W.algorithm=I.algorithm||B,W.keyLength=F.words.length*32,W.mode=I.mode||M,I.keyLength&&I.keyLength!==W.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+I.keyLength+" was specified, but the key actually has length "+W.keyLength);return G(W),W},X.generateRandomKey=function(I,F){arguments.length==1&&typeof I=="function"&&(F=I,I=void 0),y((I||N)/8,function(W,it){F!==void 0&&F(W?R.a.fromValues(W):null,it)})},X.getCipher=function(I){var F=I instanceof Y?I:X.getDefaultParams(I);return{cipherParams:F,cipher:new j(F,O,I.iv)}};function j(I,F,W){this.algorithm=I.algorithm+"-"+String(I.keyLength)+"-"+I.mode,this.cjsAlgorithm=I.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=L.toWordArray(I.key),W&&(this.iv=L.toWordArray(W).clone()),this.blockLengthWords=F}return j.prototype.encrypt=function(I,F){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),I=L.toWordArray(I);var W=I.sigBytes,it=U(W),Z=this,at=function(){Z.getIv(function(rt,V){if(rt){F(rt);return}var J=Z.encryptCipher.process(I.concat(Q[it-W])),tt=V.concat(J);F(null,tt)})};this.encryptCipher?at():this.iv?(this.encryptCipher=m.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),at()):y(P,function(rt,V){if(rt){F(rt);return}Z.encryptCipher=m.a.algo[Z.cjsAlgorithm].createEncryptor(Z.key,{iv:V}),Z.iv=V,at()})},j.prototype.decrypt=function(I){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),I=L.toWordArray(I);var F=this.blockLengthWords,W=I.words,it=f.a.create(W.slice(0,F)),Z=f.a.create(W.slice(F)),at=m.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:it}),rt=at.process(Z),V=at.finalize();return at.reset(),V&&V.sigBytes&&rt.concat(V),rt},j.prototype.getIv=function(I){if(this.iv){var F=this.iv;this.iv=null,I(null,F);return}var W=this;y(P,function(it,Z){if(it){I(it);return}I(null,W.encryptCipher.process(Z))})},X};a.default=v}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=f.enc;m.Utf16=m.Utf16BE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],D=0;D<R;D+=2){var L=E[D>>>2]>>>16-D%4*8&65535;v.push(String.fromCharCode(L))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=C.charCodeAt(v)<<16-v%2*16;return g.create(R,E*2)}},m.Utf16LE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],D=0;D<R;D+=2){var L=_(E[D>>>2]>>>16-D%4*8&65535);v.push(String.fromCharCode(L))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=_(C.charCodeAt(v)<<16-v%2*16);return g.create(R,E*2)}};function _(C){return C<<8&4278255360|C>>>8&16711935}})(),l.enc.Utf16})}),(function(n,a,r){(function(l,f){n.exports=f(r(6),r(28))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.CipherParams,_=d.enc,C=_.Hex,E=d.format;E.Hex={stringify:function(R){return R.ciphertext.toString(C)},parse:function(R){var v=C.parse(R);return m.create({ciphertext:v})}}})(),l.format.Hex})}),(function(n,a,r){(function(l,f){n.exports=f(r(6),r(11),r(61),r(27),r(28))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.BlockCipher,m=f.algo,_=[],C=[],E=[],R=[],v=[],D=[],L=[],B=[],N=[],M=[];(function(){for(var A=[],T=0;T<256;T++)T<128?A[T]=T<<1:A[T]=T<<1^283;for(var y=0,z=0,T=0;T<256;T++){var U=z^z<<1^z<<2^z<<3^z<<4;U=U>>>8^U&255^99,_[y]=U,C[U]=y;var G=A[y],K=A[G],Q=A[K],X=A[U]*257^U*16843008;E[y]=X<<24|X>>>8,R[y]=X<<16|X>>>16,v[y]=X<<8|X>>>24,D[y]=X;var X=Q*16843009^K*65537^G*257^y*16843008;L[U]=X<<24|X>>>8,B[U]=X<<16|X>>>16,N[U]=X<<8|X>>>24,M[U]=X,y?(y=G^A[A[A[Q^G]]],z^=A[A[z]]):y=z=1}})();var P=[0,1,2,4,8,16,32,64,128,27,54],O=m.AES=g.extend({_doReset:function(){var A;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var T=this._keyPriorReset=this._key,y=T.words,z=T.sigBytes/4,U=this._nRounds=z+6,G=(U+1)*4,K=this._keySchedule=[],Q=0;Q<G;Q++)Q<z?K[Q]=y[Q]:(A=K[Q-1],Q%z?z>6&&Q%z==4&&(A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255]):(A=A<<8|A>>>24,A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255],A^=P[Q/z|0]<<24),K[Q]=K[Q-z]^A);for(var X=this._invKeySchedule=[],Y=0;Y<G;Y++){var Q=G-Y;if(Y%4)var A=K[Q];else var A=K[Q-4];Y<4||Q<=4?X[Y]=A:X[Y]=L[_[A>>>24]]^B[_[A>>>16&255]]^N[_[A>>>8&255]]^M[_[A&255]]}}},encryptBlock:function(A,T){this._doCryptBlock(A,T,this._keySchedule,E,R,v,D,_)},decryptBlock:function(A,T){var y=A[T+1];A[T+1]=A[T+3],A[T+3]=y,this._doCryptBlock(A,T,this._invKeySchedule,L,B,N,M,C);var y=A[T+1];A[T+1]=A[T+3],A[T+3]=y},_doCryptBlock:function(A,T,y,z,U,G,K,Q){for(var X=this._nRounds,Y=A[T]^y[0],j=A[T+1]^y[1],I=A[T+2]^y[2],F=A[T+3]^y[3],W=4,it=1;it<X;it++){var Z=z[Y>>>24]^U[j>>>16&255]^G[I>>>8&255]^K[F&255]^y[W++],at=z[j>>>24]^U[I>>>16&255]^G[F>>>8&255]^K[Y&255]^y[W++],rt=z[I>>>24]^U[F>>>16&255]^G[Y>>>8&255]^K[j&255]^y[W++],V=z[F>>>24]^U[Y>>>16&255]^G[j>>>8&255]^K[I&255]^y[W++];Y=Z,j=at,I=rt,F=V}var Z=(Q[Y>>>24]<<24|Q[j>>>16&255]<<16|Q[I>>>8&255]<<8|Q[F&255])^y[W++],at=(Q[j>>>24]<<24|Q[I>>>16&255]<<16|Q[F>>>8&255]<<8|Q[Y&255])^y[W++],rt=(Q[I>>>24]<<24|Q[F>>>16&255]<<16|Q[Y>>>8&255]<<8|Q[j&255])^y[W++],V=(Q[F>>>24]<<24|Q[Y>>>16&255]<<16|Q[j>>>8&255]<<8|Q[I&255])^y[W++];A[T]=Z,A[T+1]=at,A[T+2]=rt,A[T+3]=V},keySize:256/32});f.AES=g._createHelper(O)})(),l.AES})}),(function(n,a,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[];(function(){for(var N=0;N<64;N++)E[N]=f.abs(f.sin(N+1))*4294967296|0})();var R=C.MD5=_.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(N,M){for(var P=0;P<16;P++){var O=M+P,A=N[O];N[O]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var T=this._hash.words,y=N[M+0],z=N[M+1],U=N[M+2],G=N[M+3],K=N[M+4],Q=N[M+5],X=N[M+6],Y=N[M+7],j=N[M+8],I=N[M+9],F=N[M+10],W=N[M+11],it=N[M+12],Z=N[M+13],at=N[M+14],rt=N[M+15],V=T[0],J=T[1],tt=T[2],nt=T[3];V=v(V,J,tt,nt,y,7,E[0]),nt=v(nt,V,J,tt,z,12,E[1]),tt=v(tt,nt,V,J,U,17,E[2]),J=v(J,tt,nt,V,G,22,E[3]),V=v(V,J,tt,nt,K,7,E[4]),nt=v(nt,V,J,tt,Q,12,E[5]),tt=v(tt,nt,V,J,X,17,E[6]),J=v(J,tt,nt,V,Y,22,E[7]),V=v(V,J,tt,nt,j,7,E[8]),nt=v(nt,V,J,tt,I,12,E[9]),tt=v(tt,nt,V,J,F,17,E[10]),J=v(J,tt,nt,V,W,22,E[11]),V=v(V,J,tt,nt,it,7,E[12]),nt=v(nt,V,J,tt,Z,12,E[13]),tt=v(tt,nt,V,J,at,17,E[14]),J=v(J,tt,nt,V,rt,22,E[15]),V=D(V,J,tt,nt,z,5,E[16]),nt=D(nt,V,J,tt,X,9,E[17]),tt=D(tt,nt,V,J,W,14,E[18]),J=D(J,tt,nt,V,y,20,E[19]),V=D(V,J,tt,nt,Q,5,E[20]),nt=D(nt,V,J,tt,F,9,E[21]),tt=D(tt,nt,V,J,rt,14,E[22]),J=D(J,tt,nt,V,K,20,E[23]),V=D(V,J,tt,nt,I,5,E[24]),nt=D(nt,V,J,tt,at,9,E[25]),tt=D(tt,nt,V,J,G,14,E[26]),J=D(J,tt,nt,V,j,20,E[27]),V=D(V,J,tt,nt,Z,5,E[28]),nt=D(nt,V,J,tt,U,9,E[29]),tt=D(tt,nt,V,J,Y,14,E[30]),J=D(J,tt,nt,V,it,20,E[31]),V=L(V,J,tt,nt,Q,4,E[32]),nt=L(nt,V,J,tt,j,11,E[33]),tt=L(tt,nt,V,J,W,16,E[34]),J=L(J,tt,nt,V,at,23,E[35]),V=L(V,J,tt,nt,z,4,E[36]),nt=L(nt,V,J,tt,K,11,E[37]),tt=L(tt,nt,V,J,Y,16,E[38]),J=L(J,tt,nt,V,F,23,E[39]),V=L(V,J,tt,nt,Z,4,E[40]),nt=L(nt,V,J,tt,y,11,E[41]),tt=L(tt,nt,V,J,G,16,E[42]),J=L(J,tt,nt,V,X,23,E[43]),V=L(V,J,tt,nt,I,4,E[44]),nt=L(nt,V,J,tt,it,11,E[45]),tt=L(tt,nt,V,J,rt,16,E[46]),J=L(J,tt,nt,V,U,23,E[47]),V=B(V,J,tt,nt,y,6,E[48]),nt=B(nt,V,J,tt,Y,10,E[49]),tt=B(tt,nt,V,J,at,15,E[50]),J=B(J,tt,nt,V,Q,21,E[51]),V=B(V,J,tt,nt,it,6,E[52]),nt=B(nt,V,J,tt,G,10,E[53]),tt=B(tt,nt,V,J,F,15,E[54]),J=B(J,tt,nt,V,z,21,E[55]),V=B(V,J,tt,nt,j,6,E[56]),nt=B(nt,V,J,tt,rt,10,E[57]),tt=B(tt,nt,V,J,X,15,E[58]),J=B(J,tt,nt,V,Z,21,E[59]),V=B(V,J,tt,nt,K,6,E[60]),nt=B(nt,V,J,tt,W,10,E[61]),tt=B(tt,nt,V,J,U,15,E[62]),J=B(J,tt,nt,V,I,21,E[63]),T[0]=T[0]+V|0,T[1]=T[1]+J|0,T[2]=T[2]+tt|0,T[3]=T[3]+nt|0},_doFinalize:function(){var N=this._data,M=N.words,P=this._nDataBytes*8,O=N.sigBytes*8;M[O>>>5]|=128<<24-O%32;var A=f.floor(P/4294967296),T=P;M[(O+64>>>9<<4)+15]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,M[(O+64>>>9<<4)+14]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,N.sigBytes=(M.length+1)*4,this._process();for(var y=this._hash,z=y.words,U=0;U<4;U++){var G=z[U];z[U]=(G<<8|G>>>24)&16711935|(G<<24|G>>>8)&4278255360}return y},clone:function(){var N=_.clone.call(this);return N._hash=this._hash.clone(),N}});function v(N,M,P,O,A,T,y){var z=N+(M&P|~M&O)+A+y;return(z<<T|z>>>32-T)+M}function D(N,M,P,O,A,T,y){var z=N+(M&O|P&~O)+A+y;return(z<<T|z>>>32-T)+M}function L(N,M,P,O,A,T,y){var z=N+(M^P^O)+A+y;return(z<<T|z>>>32-T)+M}function B(N,M,P,O,A,T,y){var z=N+(P^(M|~O))+A+y;return(z<<T|z>>>32-T)+M}d.MD5=_._createHelper(R),d.HmacMD5=_._createHmacHelper(R)})(Math),l.MD5})}),(function(n,a,r){var l;Object.defineProperty(a,"__esModule",{value:!0});var f=r(0),d=f.__importDefault(r(3)),g=f.__importStar(r(1)),m=f.__importDefault(r(8)),_=r(4),C=f.__importDefault(r(19)),E=f.__importDefault(r(17)),R=f.__importDefault(r(22)),v=f.__importDefault(r(2)),D=r(29),L=f.__importDefault(r(63)),B=r(14);function N(O){var A=O.statusCode;return A===408&&!O.code||A===400&&!O.code||A>=500&&A<=504}function M(O){var A=O.connection,T=A&&A.connectionManager.host;return T?[T].concat(m.default.getFallbackHosts(O.options)):m.default.getHosts(O.options)}var P=(l=(function(){function O(A){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=M,this.options=A||{};var T=this.options.connectivityCheckUrl||m.default.connectivityCheckUrl,y=this.options.connectivityCheckParams,z=!this.options.connectivityCheckUrl;d.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(U,G,K,Q,X,Y,j){var I=E.default.createRequest(K,Q,X,Y,R.default.REQ_SEND,G&&G.options.timeouts,U);return I.once("complete",j),I.exec(),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,y,function(G,K,Q,X,Y){var j=!1;z?j=!G&&(K==null?void 0:K.replace(/\n/,""))=="yes":j=!G&&(0,B.isSuccessCode)(Y),v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+j),U(null,j)})}):d.default.Config.jsonpSupported?(this.Request=function(U,G,K,Q,X,Y,j){var I=(0,D.createRequest)(K,Q,X,Y,R.default.REQ_SEND,G&&G.options.timeouts,U);return I.once("complete",j),d.default.Config.nextTick(function(){I.exec()}),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){var G=this,K=m.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(U);return}this.checksInProgress=[U],v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+K);var Q=new D.Request("isTheInternetUp",K,null,null,null,R.default.REQ_SEND,m.default.TIMEOUTS);Q.once("complete",function(X,Y){var j=!X&&Y;v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+j);for(var I=0;I<G.checksInProgress.length;I++)G.checksInProgress[I](null,j);G.checksInProgress=null}),d.default.Config.nextTick(function(){Q.exec()})}):d.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=L.default,this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,null,function(G,K){var Q=!G&&(K==null?void 0:K.replace(/\n/,""))=="yes";v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+Q),U(null,Q)})}):this.Request=function(U,G,K,Q,X,Y,j){j(new _.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return O.prototype.do=function(A,T,y,z,U,G,K){var Q=this,X=typeof y=="function"?y:function(F){return T.baseUri(F)+y},Y=T._currentFallback;if(Y)if(Y.validUntil>g.now()){if(!this.Request){K==null||K(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,T,X(Y.host),z,G,U,function(F){for(var W=[],it=1;it<arguments.length;it++)W[it-1]=arguments[it];if(F&&N(F)){T._currentFallback=null,Q.do(A,T,y,z,U,G,K);return}K==null||K.apply(void 0,f.__spreadArray([F],W,!1))});return}else T._currentFallback=null;var j=M(T);if(j.length===1){this.doUri(A,T,X(j[0]),z,U,G,K);return}var I=function(F,W){var it=F.shift();Q.doUri(A,T,X(it),z,U,G,function(Z){for(var at=[],rt=1;rt<arguments.length;rt++)at[rt-1]=arguments[rt];if(Z&&N(Z)&&F.length){I(F,!0);return}W&&(T._currentFallback={host:it,validUntil:g.now()+T.options.timeouts.fallbackRetryTimeout}),K==null||K.apply(void 0,f.__spreadArray([Z],at,!1))})};I(j)},O.prototype.doUri=function(A,T,y,z,U,G,K){if(!this.Request){K(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,T,y,z,G,U,K)},O})(),l.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],l.methodsWithoutBody=[C.default.Get,C.default.Delete],l.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],l);a.default=P}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(4)),d=l.__importDefault(r(3)),g=l.__importDefault(r(8)),m=l.__importStar(r(1)),_=r(1);function C(v,D){return!!D.get("x-ably-errorcode")}function E(v,D){if(C(v,D))return v.error&&f.default.fromValues(v.error)}function R(v,D,L,B,N,M,P){var O=new Headers(B||{}),A=v?v.toUpperCase():m.isEmptyArg(M)?"GET":"POST",T=new AbortController,y=setTimeout(function(){T.abort(),P(new f.PartialErrorInfo("Request timed out",null,408))},D?D.options.timeouts.httpRequestTimeout:g.default.TIMEOUTS.httpRequestTimeout),z={method:A,headers:O,body:M};d.default.Config.isWebworker||(z.credentials=O.has("authorization")?"include":"same-origin"),(0,_.getGlobalObject)().fetch(L+"?"+new URLSearchParams(N||{}),z).then(function(U){clearTimeout(y);var G=U.headers.get("Content-Type"),K;G&&G.indexOf("application/x-msgpack")>-1?K=U.arrayBuffer():G&&G.indexOf("application/json")>-1?K=U.json():K=U.text(),K.then(function(Q){var X=!!G&&G.indexOf("application/x-msgpack")===-1;if(U.ok)P(null,Q,U.headers,X,U.status);else{var Y=E(Q,U.headers)||new f.PartialErrorInfo("Error response received from server: "+U.status+" body was: "+d.default.Config.inspect(Q),null,U.status);P(Y,Q,U.headers,X,U.status)}})}).catch(function(U){clearTimeout(y),P(U)})}a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(41)),d=l.__importStar(r(1)),g=d.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function m(){var R=g.location;return!g.WebSocket||!R||!R.origin||R.origin.indexOf("http")>-1}var _=g.navigator&&g.navigator.userAgent.toString(),C=g.location&&g.location.href,E={agent:"browser",logTimestamps:!0,userAgent:_,currentUrl:C,noUpgrade:_&&!!_.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:g.WebSocket,fetchSupported:!!g.fetch,xhrSupported:g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:m(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:f.default,supportsBinary:!!g.TextDecoder,preferBinary:!1,ArrayBuffer:g.ArrayBuffer,atob:g.atob,nextTick:typeof g.setImmediate<"u"?g.setImmediate.bind(g):function(R){setTimeout(R,0)},addEventListener:g.addEventListener,inspect:JSON.stringify,stringByteSize:function(R){return g.TextDecoder&&new g.TextEncoder().encode(R).length||R.length},TextEncoder:g.TextEncoder,TextDecoder:g.TextDecoder,Promise:g.Promise,getRandomValues:(function(R){if(R!==void 0)return function(v,D){R.getRandomValues(v),D&&D(null)}})(g.crypto||msCrypto)};a.default=E}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var f=r(0),d=f.__importStar(r(1)),g="ablyjs-storage-test",m=(function(){function _(){try{l.sessionStorage.setItem(g,g),l.sessionStorage.removeItem(g),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{l.localStorage.setItem(g,g),l.localStorage.removeItem(g),this.localSupported=!0}catch{this.localSupported=!1}}return _.prototype.get=function(C){return this._get(C,!1)},_.prototype.getSession=function(C){return this._get(C,!0)},_.prototype.remove=function(C){return this._remove(C,!1)},_.prototype.removeSession=function(C){return this._remove(C,!0)},_.prototype.set=function(C,E,R){return this._set(C,E,R,!1)},_.prototype.setSession=function(C,E,R){return this._set(C,E,R,!0)},_.prototype._set=function(C,E,R,v){var D={value:E};return R&&(D.expires=d.now()+R),this.storageInterface(v).setItem(C,JSON.stringify(D))},_.prototype._get=function(C,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var R=this.storageInterface(E).getItem(C);if(!R)return null;var v=JSON.parse(R);return v.expires&&v.expires<d.now()?(this.storageInterface(E).removeItem(C),null):v.value},_.prototype._remove=function(C,E){return this.storageInterface(E).removeItem(C)},_.prototype.storageInterface=function(C){return C?l.sessionStorage:l.localStorage},_})();a.default=new m}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(67)),d={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],baseTransportOrder:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],transportPreferenceOrder:[f.default.JsonP,f.default.XhrPolling,f.default.XhrStreaming,f.default.WebSocket],upgradeTransports:[f.default.XhrStreaming,f.default.WebSocket]};a.default=d}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(f){f.WebSocket="web_socket",f.Comet="comet",f.XhrStreaming="xhr_streaming",f.XhrPolling="xhr_polling",f.JsonP="jsonp"})(l||(l={})),a.default=l}),(function(n,a,r){r.r(a);var l=r(29),f=r.n(l),d=r(1),g=r(3),m=r.n(g),_=r(12),C=r.n(_),E=r(17),R=r.n(E),v=function(N){var M="xhr_polling";function P(O,A,T){T.stream=!1,C.a.call(this,O,A,T),this.shortName=M}return d.inherits(P,C.a),P.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.allowComet},P.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},P.prototype.createRequest=function(O,A,T,y,z){return R.a.createRequest(O,A,T,y,z,this.timeouts)},typeof N<"u"&&P.isAvailable()&&(N.supportedTransports[M]=P),P},D=v,L=function(N){var M="xhr_streaming";function P(O,A,T){C.a.call(this,O,A,T),this.shortName=M}return d.inherits(P,C.a),P.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.streamingSupported&&m.a.Config.allowComet},P.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},P.prototype.createRequest=function(O,A,T,y,z){return R.a.createRequest(O,A,T,y,z,this.timeouts)},typeof N<"u"&&P.isAvailable()&&(N.supportedTransports[M]=P),P},B=L;a.default=[f.a,D,B]})]).default})})(qp)),qp.exports}var ES=_S(),Pm=function(o,t){return Pm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(n[r]=a[r])},Pm(o,t)};function CS(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Pm(o,t);function n(){this.constructor=o}o.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var bg=function(){return bg=Object.assign||function(t){for(var n,a=1,r=arguments.length;a<r;a++){n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},bg.apply(this,arguments)};function bf(o,t){var n={};for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&t.indexOf(a)<0&&(n[a]=o[a]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(o);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(o,a[r])&&(n[a[r]]=o[a[r]]);return n}function TS(o,t,n,a){var r=arguments.length,l=r<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,n):a,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,t,n,a);else for(var d=o.length-1;d>=0;d--)(f=o[d])&&(l=(r<3?f(l):r>3?f(t,n,l):f(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l}function AS(o,t){return function(n,a){t(n,a,o)}}function wS(o,t,n,a,r,l){function f(B){if(B!==void 0&&typeof B!="function")throw new TypeError("Function expected");return B}for(var d=a.kind,g=d==="getter"?"get":d==="setter"?"set":"value",m=!t&&o?a.static?o:o.prototype:null,_=t||(m?Object.getOwnPropertyDescriptor(m,a.name):{}),C,E=!1,R=n.length-1;R>=0;R--){var v={};for(var D in a)v[D]=D==="access"?{}:a[D];for(var D in a.access)v.access[D]=a.access[D];v.addInitializer=function(B){if(E)throw new TypeError("Cannot add initializers after decoration has completed");l.push(f(B||null))};var L=(0,n[R])(d==="accessor"?{get:_.get,set:_.set}:_[g],v);if(d==="accessor"){if(L===void 0)continue;if(L===null||typeof L!="object")throw new TypeError("Object expected");(C=f(L.get))&&(_.get=C),(C=f(L.set))&&(_.set=C),(C=f(L.init))&&r.unshift(C)}else(C=f(L))&&(d==="field"?r.unshift(C):_[g]=C)}m&&Object.defineProperty(m,a.name,_),E=!0}function RS(o,t,n){for(var a=arguments.length>2,r=0;r<t.length;r++)n=a?t[r].call(o,n):t[r].call(o);return a?n:void 0}function OS(o){return typeof o=="symbol"?o:"".concat(o)}function xS(o,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function MS(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function oe(o,t,n,a){function r(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function d(_){try{m(a.next(_))}catch(C){f(C)}}function g(_){try{m(a.throw(_))}catch(C){f(C)}}function m(_){_.done?l(_.value):r(_.value).then(d,g)}m((a=a.apply(o,t||[])).next())})}function NS(o,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,r,l,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=d(0),f.throw=d(1),f.return=d(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function d(m){return function(_){return g([m,_])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(a=1,r&&(l=m[0]&2?r.return:m[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,m[1])).done)return l;switch(r=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(o,n)}catch(_){m=[6,_],r=0}finally{a=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Bg=Object.create?(function(o,t,n,a){a===void 0&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(o,a,r)}):(function(o,t,n,a){a===void 0&&(a=n),o[a]=t[n]});function DS(o,t){for(var n in o)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Bg(t,o,n)}function _g(o){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&o[t],a=0;if(n)return n.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&a>=o.length&&(o=void 0),{value:o&&o[a++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ov(o,t){var n=typeof Symbol=="function"&&o[Symbol.iterator];if(!n)return o;var a=n.call(o),r,l=[],f;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)l.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(f)throw f.error}}return l}function jS(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(ov(arguments[t]));return o}function US(){for(var o=0,t=0,n=arguments.length;t<n;t++)o+=arguments[t].length;for(var a=Array(o),r=0,t=0;t<n;t++)for(var l=arguments[t],f=0,d=l.length;f<d;f++,r++)a[r]=l[f];return a}function BS(o,t,n){if(n||arguments.length===2)for(var a=0,r=t.length,l;a<r;a++)(l||!(a in t))&&(l||(l=Array.prototype.slice.call(t,0,a)),l[a]=t[a]);return o.concat(l||Array.prototype.slice.call(t))}function hf(o){return this instanceof hf?(this.v=o,this):new hf(o)}function zS(o,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n.apply(o,t||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",f),r[Symbol.asyncIterator]=function(){return this},r;function f(R){return function(v){return Promise.resolve(v).then(R,C)}}function d(R,v){a[R]&&(r[R]=function(D){return new Promise(function(L,B){l.push([R,D,L,B])>1||g(R,D)})},v&&(r[R]=v(r[R])))}function g(R,v){try{m(a[R](v))}catch(D){E(l[0][3],D)}}function m(R){R.value instanceof hf?Promise.resolve(R.value.v).then(_,C):E(l[0][2],R)}function _(R){g("next",R)}function C(R){g("throw",R)}function E(R,v){R(v),l.shift(),l.length&&g(l[0][0],l[0][1])}}function LS(o){var t,n;return t={},a("next"),a("throw",function(r){throw r}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(r,l){t[r]=o[r]?function(f){return(n=!n)?{value:hf(o[r](f)),done:!1}:l?l(f):f}:l}}function PS(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],n;return t?t.call(o):(o=typeof _g=="function"?_g(o):o[Symbol.iterator](),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(l){n[l]=o[l]&&function(f){return new Promise(function(d,g){f=o[l](f),r(d,g,f.done,f.value)})}}function r(l,f,d,g){Promise.resolve(g).then(function(m){l({value:m,done:d})},f)}}function GS(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}var b_=Object.create?(function(o,t){Object.defineProperty(o,"default",{enumerable:!0,value:t})}):function(o,t){o.default=t},Gm=function(o){return Gm=Object.getOwnPropertyNames||function(t){var n=[];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[n.length]=a);return n},Gm(o)};function HS(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var n=Gm(o),a=0;a<n.length;a++)n[a]!=="default"&&Bg(t,o,n[a]);return b_(t,o),t}function IS(o){return o&&o.__esModule?o:{default:o}}function kS(o,t,n,a){if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!a:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?a:n==="a"?a.call(o):a?a.value:t.get(o)}function qS(o,t,n,a,r){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!r:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?r.call(o,n):r?r.value=n:t.set(o,n),n}function VS(o,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?t===o:o.has(t)}function YS(o,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var a,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=t[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=t[Symbol.dispose],n&&(r=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");r&&(a=function(){try{r.call(this)}catch(l){return Promise.reject(l)}}),o.stack.push({value:t,dispose:a,async:n})}else n&&o.stack.push({async:!0});return t}var __=typeof SuppressedError=="function"?SuppressedError:function(o,t,n){var a=new Error(n);return a.name="SuppressedError",a.error=o,a.suppressed=t,a};function KS(o){function t(l){o.error=o.hasError?new __(l,o.error,"An error was suppressed during disposal."):l,o.hasError=!0}var n,a=0;function r(){for(;n=o.stack.pop();)try{if(!n.async&&a===1)return a=0,o.stack.push(n),Promise.resolve().then(r);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return a|=2,Promise.resolve(l).then(r,function(f){return t(f),r()})}else a|=1}catch(f){t(f)}if(a===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return r()}function QS(o,t){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,a,r,l,f){return a?t?".jsx":".js":r&&(!l||!f)?n:r+l+"."+f.toLowerCase()+"js"}):o}const E_={__extends:CS,__assign:bg,__rest:bf,__decorate:TS,__param:AS,__esDecorate:wS,__runInitializers:RS,__propKey:OS,__setFunctionName:xS,__metadata:MS,__awaiter:oe,__generator:NS,__createBinding:Bg,__exportStar:DS,__values:_g,__read:ov,__spread:jS,__spreadArrays:US,__spreadArray:BS,__await:hf,__asyncGenerator:zS,__asyncDelegator:LS,__asyncValues:PS,__makeTemplateObject:GS,__importStar:HS,__importDefault:IS,__classPrivateFieldGet:kS,__classPrivateFieldSet:qS,__classPrivateFieldIn:VS,__addDisposableResource:YS,__disposeResources:KS,__rewriteRelativeImportExtension:QS},C_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:YS,get __assign(){return bg},__asyncDelegator:LS,__asyncGenerator:zS,__asyncValues:PS,__await:hf,__awaiter:oe,__classPrivateFieldGet:kS,__classPrivateFieldIn:VS,__classPrivateFieldSet:qS,__createBinding:Bg,__decorate:TS,__disposeResources:KS,__esDecorate:wS,__exportStar:DS,__extends:CS,__generator:NS,__importDefault:IS,__importStar:HS,__makeTemplateObject:GS,__metadata:MS,__param:AS,__propKey:OS,__read:ov,__rest:bf,__rewriteRelativeImportExtension:QS,__runInitializers:RS,__setFunctionName:xS,__spread:jS,__spreadArray:BS,__spreadArrays:US,__values:_g,default:E_},Symbol.toStringTag,{value:"Module"})),T_="modulepreload",A_=function(o){return"/"+o},d1={},Ru=function(t,n,a){let r=Promise.resolve();if(n&&n.length>0){let f=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=f(n.map(m=>{if(m=A_(m),m in d1)return;d1[m]=!0;const _=m.endsWith(".css"),C=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${C}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":T_,_||(E.as="script"),E.crossOrigin="",E.href=m,g&&E.setAttribute("nonce",g),document.head.appendChild(E),_)return new Promise((R,v)=>{E.addEventListener("load",R),E.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(f){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=f,window.dispatchEvent(d),!d.defaultPrevented)throw f}return r.then(f=>{for(const d of f||[])d.status==="rejected"&&l(d.reason);return t().catch(l)})},w_=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>Ru(async()=>{const{default:a}=await Promise.resolve().then(()=>Ou);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)};class lv extends Error{constructor(t,n="FunctionsError",a){super(t),this.name=n,this.context=a}}class h1 extends lv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class g1 extends lv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class p1 extends lv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Hm;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Hm||(Hm={}));class R_{constructor(t,{headers:n={},customFetch:a,region:r=Hm.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=w_(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return oe(this,arguments,void 0,function*(n,a={}){var r;try{const{headers:l,method:f,body:d,signal:g}=a;let m={},{region:_}=a;_||(_=this.region);const C=new URL(`${this.url}/${n}`);_&&_!=="any"&&(m["x-region"]=_,C.searchParams.set("forceFunctionRegion",_));let E;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=d):typeof d=="string"?(m["Content-Type"]="text/plain",E=d):typeof FormData<"u"&&d instanceof FormData?E=d:(m["Content-Type"]="application/json",E=JSON.stringify(d)):E=d;const R=yield this.fetch(C.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),l),body:E,signal:g}).catch(B=>{throw B.name==="AbortError"?B:new h1(B)}),v=R.headers.get("x-relay-error");if(v&&v==="true")throw new g1(R);if(!R.ok)throw new p1(R);let D=((r=R.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),L;return D==="application/json"?L=yield R.json():D==="application/octet-stream"||D==="application/pdf"?L=yield R.blob():D==="text/event-stream"?L=R:D==="multipart/form-data"?L=yield R.formData():L=yield R.text(),{data:L,error:null,response:R}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new h1(l)}:{data:null,error:l,response:l instanceof p1||l instanceof g1?l.context:void 0}}})}}var ni={};const _f=T2(C_);var ag={},ig={},rg={},sg={},og={},O_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},gf=O_();const x_=gf.fetch,XS=gf.fetch.bind(gf),FS=gf.Headers,M_=gf.Request,N_=gf.Response,Ou=Object.freeze(Object.defineProperty({__proto__:null,Headers:FS,Request:M_,Response:N_,default:XS,fetch:x_},Symbol.toStringTag,{value:"Module"})),D_=T2(Ou);var lg={},m1;function JS(){if(m1)return lg;m1=1,Object.defineProperty(lg,"__esModule",{value:!0});class o extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return lg.default=o,lg}var v1;function ZS(){if(v1)return og;v1=1,Object.defineProperty(og,"__esModule",{value:!0});const o=_f,t=o.__importDefault(D_),n=o.__importDefault(JS());class a{constructor(l){var f,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(f=l.shouldThrowOnError)!==null&&f!==void 0?f:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,f){return this.headers=new Headers(this.headers),this.headers.set(l,f),this}then(l,f){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let g=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var _,C,E,R;let v=null,D=null,L=null,B=m.status,N=m.statusText;if(m.ok){if(this.method!=="HEAD"){const A=await m.text();A===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((_=this.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?D=A:D=JSON.parse(A))}const P=(C=this.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),O=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");P&&O&&O.length>1&&(L=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(D)&&(D.length>1?(v={code:"PGRST116",details:`Results contain ${D.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},D=null,L=null,B=406,N="Not Acceptable"):D.length===1?D=D[0]:D=null)}else{const P=await m.text();try{v=JSON.parse(P),Array.isArray(v)&&m.status===404&&(D=[],v=null,B=200,N="OK")}catch{m.status===404&&P===""?(B=204,N="No Content"):v={message:P}}if(v&&this.isMaybeSingle&&(!((R=v==null?void 0:v.details)===null||R===void 0)&&R.includes("0 rows"))&&(v=null,B=200,N="OK"),v&&this.shouldThrowOnError)throw new n.default(v)}return{error:v,data:D,count:L,status:B,statusText:N}});return this.shouldThrowOnError||(g=g.catch(m=>{var _,C,E;return{error:{message:`${(_=m==null?void 0:m.name)!==null&&_!==void 0?_:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(C=m==null?void 0:m.stack)!==null&&C!==void 0?C:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),g.then(l,f)}returns(){return this}overrideTypes(){return this}}return og.default=a,og}var y1;function WS(){if(y1)return sg;y1=1,Object.defineProperty(sg,"__esModule",{value:!0});const t=_f.__importDefault(ZS());class n extends t.default{select(r){let l=!1;const f=(r??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:l=!0,nullsFirst:f,foreignTable:d,referencedTable:g=d}={}){const m=g?`${g}.order`:"order",_=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${_?`${_},`:""}${r}.${l?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:l,referencedTable:f=l}={}){const d=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(d,`${r}`),this}range(r,l,{foreignTable:f,referencedTable:d=f}={}){const g=typeof d>"u"?"offset":`${d}.offset`,m=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(g,`${r}`),this.url.searchParams.set(m,`${l-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:l=!1,settings:f=!1,buffers:d=!1,wal:g=!1,format:m="text"}={}){var _;const C=[r?"analyze":null,l?"verbose":null,f?"settings":null,d?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${C};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return sg.default=n,sg}var S1;function uv(){if(S1)return rg;S1=1,Object.defineProperty(rg,"__esModule",{value:!0});const t=_f.__importDefault(WS());class n extends t.default{eq(r,l){return this.url.searchParams.append(r,`eq.${l}`),this}neq(r,l){return this.url.searchParams.append(r,`neq.${l}`),this}gt(r,l){return this.url.searchParams.append(r,`gt.${l}`),this}gte(r,l){return this.url.searchParams.append(r,`gte.${l}`),this}lt(r,l){return this.url.searchParams.append(r,`lt.${l}`),this}lte(r,l){return this.url.searchParams.append(r,`lte.${l}`),this}like(r,l){return this.url.searchParams.append(r,`like.${l}`),this}likeAllOf(r,l){return this.url.searchParams.append(r,`like(all).{${l.join(",")}}`),this}likeAnyOf(r,l){return this.url.searchParams.append(r,`like(any).{${l.join(",")}}`),this}ilike(r,l){return this.url.searchParams.append(r,`ilike.${l}`),this}ilikeAllOf(r,l){return this.url.searchParams.append(r,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(r,l){return this.url.searchParams.append(r,`ilike(any).{${l.join(",")}}`),this}is(r,l){return this.url.searchParams.append(r,`is.${l}`),this}in(r,l){const f=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(r,`in.(${f})`),this}contains(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cs.{${l.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(l)}`),this}containedBy(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cd.{${l.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(l)}`),this}rangeGt(r,l){return this.url.searchParams.append(r,`sr.${l}`),this}rangeGte(r,l){return this.url.searchParams.append(r,`nxl.${l}`),this}rangeLt(r,l){return this.url.searchParams.append(r,`sl.${l}`),this}rangeLte(r,l){return this.url.searchParams.append(r,`nxr.${l}`),this}rangeAdjacent(r,l){return this.url.searchParams.append(r,`adj.${l}`),this}overlaps(r,l){return typeof l=="string"?this.url.searchParams.append(r,`ov.${l}`):this.url.searchParams.append(r,`ov.{${l.join(",")}}`),this}textSearch(r,l,{config:f,type:d}={}){let g="";d==="plain"?g="pl":d==="phrase"?g="ph":d==="websearch"&&(g="w");const m=f===void 0?"":`(${f})`;return this.url.searchParams.append(r,`${g}fts${m}.${l}`),this}match(r){return Object.entries(r).forEach(([l,f])=>{this.url.searchParams.append(l,`eq.${f}`)}),this}not(r,l,f){return this.url.searchParams.append(r,`not.${l}.${f}`),this}or(r,{foreignTable:l,referencedTable:f=l}={}){const d=f?`${f}.or`:"or";return this.url.searchParams.append(d,`(${r})`),this}filter(r,l,f){return this.url.searchParams.append(r,`${l}.${f}`),this}}return rg.default=n,rg}var b1;function $S(){if(b1)return ig;b1=1,Object.defineProperty(ig,"__esModule",{value:!0});const t=_f.__importDefault(uv());class n{constructor(r,{headers:l={},schema:f,fetch:d}){this.url=r,this.headers=new Headers(l),this.schema=f,this.fetch=d}select(r,l){const{head:f=!1,count:d}=l??{},g=f?"HEAD":"GET";let m=!1;const _=(r??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",_),d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:l,defaultToNull:f=!0}={}){var d;const g="POST";if(l&&this.headers.append("Prefer",`count=${l}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((_,C)=>_.concat(Object.keys(C)),[]);if(m.length>0){const _=[...new Set(m)].map(C=>`"${C}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(r,{onConflict:l,ignoreDuplicates:f=!1,count:d,defaultToNull:g=!0}={}){var m;const _="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const C=r.reduce((E,R)=>E.concat(Object.keys(R)),[]);if(C.length>0){const E=[...new Set(C)].map(R=>`"${R}"`);this.url.searchParams.set("columns",E.join(","))}}return new t.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:l}={}){var f;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:r}={}){var l;const f="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return ig.default=n,ig}var _1;function j_(){if(_1)return ag;_1=1,Object.defineProperty(ag,"__esModule",{value:!0});const o=_f,t=o.__importDefault($S()),n=o.__importDefault(uv());class a{constructor(l,{headers:f={},schema:d,fetch:g}={}){this.url=l,this.headers=new Headers(f),this.schemaName=d,this.fetch=g}from(l){const f=new URL(`${this.url}/${l}`);return new t.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,f={},{head:d=!1,get:g=!1,count:m}={}){var _;let C;const E=new URL(`${this.url}/rpc/${l}`);let R;d||g?(C=d?"HEAD":"GET",Object.entries(f).filter(([D,L])=>L!==void 0).map(([D,L])=>[D,Array.isArray(L)?`{${L.join(",")}}`:`${L}`]).forEach(([D,L])=>{E.searchParams.append(D,L)})):(C="POST",R=f);const v=new Headers(this.headers);return m&&v.set("Prefer",`count=${m}`),new n.default({method:C,url:E,headers:v,schema:this.schemaName,body:R,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}}return ag.default=a,ag}var E1;function U_(){if(E1)return ni;E1=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.PostgrestError=ni.PostgrestBuilder=ni.PostgrestTransformBuilder=ni.PostgrestFilterBuilder=ni.PostgrestQueryBuilder=ni.PostgrestClient=void 0;const o=_f,t=o.__importDefault(j_());ni.PostgrestClient=t.default;const n=o.__importDefault($S());ni.PostgrestQueryBuilder=n.default;const a=o.__importDefault(uv());ni.PostgrestFilterBuilder=a.default;const r=o.__importDefault(WS());ni.PostgrestTransformBuilder=r.default;const l=o.__importDefault(ZS());ni.PostgrestBuilder=l.default;const f=o.__importDefault(JS());return ni.PostgrestError=f.default,ni.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:l.default,PostgrestError:f.default},ni}var B_=U_();const z_=pf(B_),{PostgrestClient:L_,PostgrestQueryBuilder:XT,PostgrestFilterBuilder:FT,PostgrestTransformBuilder:JT,PostgrestBuilder:ZT,PostgrestError:WT}=z_;class P_{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const a=n.node,r=parseInt(a.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const a=this.getWebSocketConstructor();return new a(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const G_="2.76.1",H_=`realtime-js/${G_}`,I_="1.0.0",Im=1e4,k_=1e3,q_=100;var lh;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(lh||(lh={}));var Aa;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Aa||(Aa={}));var Yr;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(Yr||(Yr={}));var km;(function(o){o.websocket="websocket"})(km||(km={}));var vu;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(vu||(vu={}));class V_{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,n,a)}_decodeBroadcast(t,n,a){const r=n.getUint8(1),l=n.getUint8(2);let f=this.HEADER_LENGTH+2;const d=a.decode(t.slice(f,f+r));f=f+r;const g=a.decode(t.slice(f,f+l));f=f+l;const m=JSON.parse(a.decode(t.slice(f,t.byteLength)));return{ref:null,topic:d,event:g,payload:m}}}class tb{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Pn;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(Pn||(Pn={}));const C1=(o,t,n={})=>{var a;const r=(a=n.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,f)=>(l[f]=Y_(f,o,t,r),l),{}):{}},Y_=(o,t,n,a)=>{const r=t.find(d=>d.name===o),l=r==null?void 0:r.type,f=n[o];return l&&!a.includes(l)?eb(l,f):qm(f)},eb=(o,t)=>{if(o.charAt(0)==="_"){const n=o.slice(1,o.length);return F_(t,n)}switch(o){case Pn.bool:return K_(t);case Pn.float4:case Pn.float8:case Pn.int2:case Pn.int4:case Pn.int8:case Pn.numeric:case Pn.oid:return Q_(t);case Pn.json:case Pn.jsonb:return X_(t);case Pn.timestamp:return J_(t);case Pn.abstime:case Pn.date:case Pn.daterange:case Pn.int4range:case Pn.int8range:case Pn.money:case Pn.reltime:case Pn.text:case Pn.time:case Pn.timestamptz:case Pn.timetz:case Pn.tsrange:case Pn.tstzrange:return qm(t);default:return qm(t)}},qm=o=>o,K_=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Q_=o=>{if(typeof o=="string"){const t=parseFloat(o);if(!Number.isNaN(t))return t}return o},X_=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(t){return console.log(`JSON parse error: ${t}`),o}return o},F_=(o,t)=>{if(typeof o!="string")return o;const n=o.length-1,a=o[n];if(o[0]==="{"&&a==="}"){let l;const f=o.slice(1,n);try{l=JSON.parse("["+f+"]")}catch{l=f?f.split(","):[]}return l.map(d=>eb(t,d))}return o},J_=o=>typeof o=="string"?o.replace(" ","T"):o,nb=o=>{const t=new URL(o);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Vp{constructor(t,n,a={},r=Im){this.channel=t,this.event=n,this.payload=a,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var a;return this._hasReceived(t)&&n((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var T1;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(T1||(T1={}));class uh{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},r=>{const{onJoin:l,onLeave:f,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=uh.syncState(this.state,r,l,f),this.pendingDiffs.forEach(g=>{this.state=uh.syncDiff(this.state,g,l,f)}),this.pendingDiffs=[],d()}),this.channel._on(a.diff,{},r=>{const{onJoin:l,onLeave:f,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=uh.syncDiff(this.state,r,l,f),d())}),this.onJoin((r,l,f)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:l,newPresences:f})}),this.onLeave((r,l,f)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:l,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,a,r){const l=this.cloneDeep(t),f=this.transformState(n),d={},g={};return this.map(l,(m,_)=>{f[m]||(g[m]=_)}),this.map(f,(m,_)=>{const C=l[m];if(C){const E=_.map(L=>L.presence_ref),R=C.map(L=>L.presence_ref),v=_.filter(L=>R.indexOf(L.presence_ref)<0),D=C.filter(L=>E.indexOf(L.presence_ref)<0);v.length>0&&(d[m]=v),D.length>0&&(g[m]=D)}else d[m]=_}),this.syncDiff(l,{joins:d,leaves:g},a,r)}static syncDiff(t,n,a,r){const{joins:l,leaves:f}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return a||(a=()=>{}),r||(r=()=>{}),this.map(l,(d,g)=>{var m;const _=(m=t[d])!==null&&m!==void 0?m:[];if(t[d]=this.cloneDeep(g),_.length>0){const C=t[d].map(R=>R.presence_ref),E=_.filter(R=>C.indexOf(R.presence_ref)<0);t[d].unshift(...E)}a(d,_,g)}),this.map(f,(d,g)=>{let m=t[d];if(!m)return;const _=g.map(C=>C.presence_ref);m=m.filter(C=>_.indexOf(C.presence_ref)<0),t[d]=m,r(d,m,g),m.length===0&&delete t[d]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(a=>n(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,a)=>{const r=t[a];return"metas"in r?n[a]=r.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[a]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var A1;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(A1||(A1={}));var ch;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(ch||(ch={}));var So;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(So||(So={}));class cv{constructor(t,n={config:{}},a){var r,l;if(this.topic=t,this.params=n,this.socket=a,this.bindings={},this.state=Aa.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Vp(this,Yr.join,this.params,this.timeout),this.rejoinTimer=new tb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Aa.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Aa.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Aa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Aa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Aa.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yr.reply,{},(f,d)=>{this._trigger(this._replyEventName(d),f)}),this.presence=new uh(this),this.broadcastEndpointURL=nb(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var a,r,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Aa.closed){const{config:{broadcast:f,presence:d,private:g}}=this.params,m=(r=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(R=>R.filter))!==null&&r!==void 0?r:[],_=!!this.bindings[ch.PRESENCE]&&this.bindings[ch.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,C={},E={broadcast:f,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(R=>t==null?void 0:t(So.CHANNEL_ERROR,R)),this._onClose(()=>t==null?void 0:t(So.CLOSED)),this.updateJoinPayload(Object.assign({config:E},C)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:R})=>{var v;if(this.socket.setAuth(),R===void 0){t==null||t(So.SUBSCRIBED);return}else{const D=this.bindings.postgres_changes,L=(v=D==null?void 0:D.length)!==null&&v!==void 0?v:0,B=[];for(let N=0;N<L;N++){const M=D[N],{filter:{event:P,schema:O,table:A,filter:T}}=M,y=R&&R[N];if(y&&y.event===P&&y.schema===O&&y.table===A&&y.filter===T)B.push(Object.assign(Object.assign({},M),{id:y.id}));else{this.unsubscribe(),this.state=Aa.errored,t==null||t(So.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=B,t&&t(So.SUBSCRIBED);return}}).receive("error",R=>{this.state=Aa.errored,t==null||t(So.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(R).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(So.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,a){return this.state===Aa.joined&&t===ch.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,a)}async httpSend(t,n,a={}){var r;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(r=a.timeout)!==null&&r!==void 0?r:this.timeout);if(d.status===202)return{success:!0};let g=d.statusText;try{const m=await d.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(t,n={}){var a,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:f}=t,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var f,d,g;const m=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((g=(d=(f=this.params)===null||f===void 0?void 0:f.config)===null||d===void 0?void 0:d.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Aa.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yr.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(r=>{a=new Vp(this,Yr.leave,{},t),a.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Aa.closed,this.bindings={}}async _fetchWithTimeout(t,n,a){const r=new AbortController,l=setTimeout(()=>r.abort(),a),f=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(l),f}_push(t,n,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Vp(this,t,n,a);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>q_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,a){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,a){var r,l;const f=t.toLocaleLowerCase(),{close:d,error:g,leave:m,join:_}=Yr;if(a&&[d,g,m,_].indexOf(f)>=0&&a!==this._joinRef())return;let E=this._onMessage(f,n,a);if(n&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(R=>{var v,D,L;return((v=R.filter)===null||v===void 0?void 0:v.event)==="*"||((L=(D=R.filter)===null||D===void 0?void 0:D.event)===null||L===void 0?void 0:L.toLocaleLowerCase())===f}).map(R=>R.callback(E,a)):(l=this.bindings[f])===null||l===void 0||l.filter(R=>{var v,D,L,B,N,M;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in R){const P=R.id,O=(v=R.filter)===null||v===void 0?void 0:v.event;return P&&((D=n.ids)===null||D===void 0?void 0:D.includes(P))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((L=n.data)===null||L===void 0?void 0:L.type.toLocaleLowerCase()))}else{const P=(N=(B=R==null?void 0:R.filter)===null||B===void 0?void 0:B.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return P==="*"||P===((M=n==null?void 0:n.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===f}).map(R=>{if(typeof E=="object"&&"ids"in E){const v=E.data,{schema:D,table:L,commit_timestamp:B,type:N,errors:M}=v;E=Object.assign(Object.assign({},{schema:D,table:L,commit_timestamp:B,eventType:N,new:{},old:{},errors:M}),this._getPayloadRecords(v))}R.callback(E,a)})}_isClosed(){return this.state===Aa.closed}_isJoined(){return this.state===Aa.joined}_isJoining(){return this.state===Aa.joining}_isLeaving(){return this.state===Aa.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,a){const r=t.toLocaleLowerCase(),l={type:r,filter:n,callback:a};return this.bindings[r]?this.bindings[r].push(l):this.bindings[r]=[l],this}_off(t,n){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(r=>{var l;return!(((l=r.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&cv.isEqual(r.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const a in t)if(t[a]!==n[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Yr.close,{},t)}_onError(t){this._on(Yr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Aa.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=C1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=C1(t.columns,t.old_record)),n}}const Yp=()=>{},ug={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Z_=[1e3,2e3,5e3,1e4],W_=1e4,$_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class tE{constructor(t,n){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Im,this.transport=null,this.heartbeatIntervalMs=ug.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Yp,this.ref=0,this.reconnectTimer=null,this.logger=Yp,this.conn=null,this.sendBuffer=[],this.serializer=new V_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let l;return r?l=r:typeof fetch>"u"?l=(...f)=>Ru(async()=>{const{default:d}=await Promise.resolve().then(()=>Ou);return{default:d}},void 0).then(({default:d})=>d(...f)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...f)=>l(...f)},!(!((a=n==null?void 0:n.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${km.websocket}`,this.httpEndpoint=nb(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=P_.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:I_}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,a){this.logger(t,n,a)}connectionState(){switch(this.conn&&this.conn.readyState){case lh.connecting:return vu.Connecting;case lh.open:return vu.Open;case lh.closing:return vu.Closing;default:return vu.Closed}}isConnected(){return this.connectionState()===vu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const a=`realtime:${t}`,r=this.getChannels().find(l=>l.topic===a);if(r)return r;{const l=new cv(`realtime:${t}`,n,this);return this.channels.push(l),l}}push(t){const{topic:n,event:a,payload:r,ref:l}=t,f=()=>{this.encode(t,d=>{var g;(g=this.conn)===null||g===void 0||g.send(d)})};this.log("push",`${n} ${a} (${l})`,r),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(k_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},ug.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:r,payload:l,ref:f}=n,d=f?`(${f})`:"",g=l.status||"";this.log("receive",`${g} ${a} ${r} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(a)).forEach(m=>m._trigger(r,l,f)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Yr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const a=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${a}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const a=new Blob([$_],{type:"application/javascript"});n=URL.createObjectURL(a)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(a=>{const r={access_token:n,version:H_};n&&a.updateJoinPayload(r),a.joinedOnce&&a._isJoined()&&a._push(Yr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(n)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new tb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ug.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,a,r,l,f,d,g,m,_;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:Im,this.heartbeatIntervalMs=(r=t==null?void 0:t.heartbeatIntervalMs)!==null&&r!==void 0?r:ug.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(f=t==null?void 0:t.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(d=t==null?void 0:t.heartbeatCallback)!==null&&d!==void 0?d:Yp,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(C=>Z_[C-1]||W_),this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((C,E)=>E(JSON.stringify(C))),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class fv extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Wn(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class eE extends fv{constructor(t,n,a){super(t),this.name="StorageApiError",this.status=n,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Vm extends fv{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const dv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>Ru(async()=>{const{default:a}=await Promise.resolve().then(()=>Ou);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},nE=()=>oe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ru(()=>Promise.resolve().then(()=>Ou),void 0)).Response:Response}),Ym=o=>{if(Array.isArray(o))return o.map(n=>Ym(n));if(typeof o=="function"||o!==Object(o))return o;const t={};return Object.entries(o).forEach(([n,a])=>{const r=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[r]=Ym(a)}),t},aE=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Kp=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),iE=(o,t,n)=>oe(void 0,void 0,void 0,function*(){const a=yield nE();o instanceof a&&!(n!=null&&n.noResolveJson)?o.json().then(r=>{const l=o.status||500,f=(r==null?void 0:r.statusCode)||l+"";t(new eE(Kp(r),l,f))}).catch(r=>{t(new Vm(Kp(r),r))}):t(new Vm(Kp(o),o))}),rE=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"||!a?r:(aE(a)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,t!=null&&t.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),n))};function _h(o,t,n,a,r,l){return oe(this,void 0,void 0,function*(){return new Promise((f,d)=>{o(n,rE(t,a,r,l)).then(g=>{if(!g.ok)throw g;return a!=null&&a.noResolveJson?g:g.json()}).then(g=>f(g)).catch(g=>iE(g,d,a))})})}function gh(o,t,n,a){return oe(this,void 0,void 0,function*(){return _h(o,"GET",t,n,a)})}function Vr(o,t,n,a,r){return oe(this,void 0,void 0,function*(){return _h(o,"POST",t,a,r,n)})}function Km(o,t,n,a,r){return oe(this,void 0,void 0,function*(){return _h(o,"PUT",t,a,r,n)})}function sE(o,t,n,a){return oe(this,void 0,void 0,function*(){return _h(o,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),a)})}function hv(o,t,n,a,r){return oe(this,void 0,void 0,function*(){return _h(o,"DELETE",t,a,r,n)})}class oE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return oe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wn(t))return{data:null,error:t};throw t}})}}var ab;class lE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[ab]="BlobDownloadBuilder",this.promise=null}asStream(){return new oE(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return oe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wn(t))return{data:null,error:t};throw t}})}}ab=Symbol.toStringTag;const uE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},w1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class cE{constructor(t,n={},a,r){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=a,this.fetch=dv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,a,r){return oe(this,void 0,void 0,function*(){try{let l;const f=Object.assign(Object.assign({},w1),r);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(f.upsert)});const g=f.metadata;typeof Blob<"u"&&a instanceof Blob?(l=new FormData,l.append("cacheControl",f.cacheControl),g&&l.append("metadata",this.encodeMetadata(g)),l.append("",a)):typeof FormData<"u"&&a instanceof FormData?(l=a,l.append("cacheControl",f.cacheControl),g&&l.append("metadata",this.encodeMetadata(g))):(l=a,d["cache-control"]=`max-age=${f.cacheControl}`,d["content-type"]=f.contentType,g&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),r!=null&&r.headers&&(d=Object.assign(Object.assign({},d),r.headers));const m=this._removeEmptyFolders(n),_=this._getFinalPath(m),C=yield(t=="PUT"?Km:Vr)(this.fetch,`${this.url}/object/${_}`,l,Object.assign({headers:d},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:C.Id,fullPath:C.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Wn(l))return{data:null,error:l};throw l}})}upload(t,n,a){return oe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,a)})}uploadToSignedUrl(t,n,a,r){return oe(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),f=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${f}`);d.searchParams.set("token",n);try{let g;const m=Object.assign({upsert:w1.upsert},r),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&a instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",a)):typeof FormData<"u"&&a instanceof FormData?(g=a,g.append("cacheControl",m.cacheControl)):(g=a,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType);const C=yield Km(this.fetch,d.toString(),g,{headers:_});return{data:{path:l,fullPath:C.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(Wn(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(t,n){return oe(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const l=yield Vr(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:r}),f=new URL(this.url+l.url),d=f.searchParams.get("token");if(!d)throw new fv("No token returned by API");return{data:{signedUrl:f.toString(),path:t,token:d},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wn(a))return{data:null,error:a};throw a}})}update(t,n,a){return oe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,a)})}move(t,n,a){return oe(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}})}copy(t,n,a){return oe(this,void 0,void 0,function*(){try{return{data:{path:(yield Vr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,a){return oe(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),l=yield Vr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const f=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${f}`)},{data:l,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,a){return oe(this,void 0,void 0,function*(){try{const r=yield Vr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),l=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:r.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${l}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}})}download(t,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),f=l?`?${l}`:"",d=this._getFinalPath(t),g=()=>gh(this.fetch,`${this.url}/${r}/${d}${f}`,{headers:this.headers,noResolveJson:!0});return new lE(g,this.shouldThrowOnError)}info(t){return oe(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const a=yield gh(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Ym(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wn(a))return{data:null,error:a};throw a}})}exists(t){return oe(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield sE(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wn(a)&&a instanceof Vm){const r=a.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,n){const a=this._getFinalPath(t),r=[],l=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&r.push(l);const d=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});g!==""&&r.push(g);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${a}${m}`)}}}remove(t){return oe(this,void 0,void 0,function*(){try{return{data:yield hv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}})}list(t,n,a){return oe(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},uE),n),{prefix:t||""});return{data:yield Vr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},a),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}})}listV2(t,n){return oe(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield Vr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wn(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const ib="2.76.1",rb={"X-Client-Info":`storage-js/${ib}`};class fE{constructor(t,n={},a,r){this.shouldThrowOnError=!1;const l=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rb),n),this.fetch=dv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return oe(this,void 0,void 0,function*(){try{return{data:yield gh(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wn(t))return{data:null,error:t};throw t}})}getBucket(t){return oe(this,void 0,void 0,function*(){try{return{data:yield gh(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}})}createBucket(t){return oe(this,arguments,void 0,function*(n,a={public:!1}){try{return{data:yield Vr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return oe(this,void 0,void 0,function*(){try{return{data:yield Km(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wn(a))return{data:null,error:a};throw a}})}emptyBucket(t){return oe(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return oe(this,void 0,void 0,function*(){try{return{data:yield hv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}})}}class dE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rb),n),this.fetch=dv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return oe(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}})}listBuckets(t){return oe(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const a=n.toString(),r=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`,l=yield gh(this.fetch,r,{headers:this.headers});return{data:Array.isArray(l)?l.filter(d=>d.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return oe(this,void 0,void 0,function*(){try{return{data:yield hv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}})}}const gv={"X-Client-Info":`storage-js/${ib}`,"Content-Type":"application/json"};class sb extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ki(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class Qp extends sb{constructor(t,n,a){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class hE extends sb{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var R1;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(R1||(R1={}));const pv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>Ru(async()=>{const{default:a}=await Promise.resolve().then(()=>Ou);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},gE=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},O1=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),pE=(o,t,n)=>oe(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!(n!=null&&n.noResolveJson)){const r=o.status||500,l=o;if(typeof l.json=="function")l.json().then(f=>{const d=(f==null?void 0:f.statusCode)||(f==null?void 0:f.code)||r+"";t(new Qp(O1(f),r,d))}).catch(()=>{const f=r+"",d=l.statusText||`HTTP ${r} error`;t(new Qp(d,r,f))});else{const f=r+"",d=l.statusText||`HTTP ${r} error`;t(new Qp(d,r,f))}}else t(new hE(O1(o),o))}),mE=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return a?(gE(a)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,Object.assign(Object.assign({},r),n)):r};function vE(o,t,n,a,r,l){return oe(this,void 0,void 0,function*(){return new Promise((f,d)=>{o(n,mE(t,a,r,l)).then(g=>{if(!g.ok)throw g;if(a!=null&&a.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>f(g)).catch(g=>pE(g,d,a))})})}function qi(o,t,n,a,r){return oe(this,void 0,void 0,function*(){return vE(o,"POST",t,a,r,n)})}class yE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},gv),n),this.fetch=pv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return oe(this,void 0,void 0,function*(){try{return{data:(yield qi(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}getIndex(t,n){return oe(this,void 0,void 0,function*(){try{return{data:yield qi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ki(a))return{data:null,error:a};throw a}})}listIndexes(t){return oe(this,void 0,void 0,function*(){try{return{data:yield qi(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return oe(this,void 0,void 0,function*(){try{return{data:(yield qi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ki(a))return{data:null,error:a};throw a}})}}class SE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},gv),n),this.fetch=pv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return oe(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield qi(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}getVectors(t){return oe(this,void 0,void 0,function*(){try{return{data:yield qi(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}listVectors(t){return oe(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield qi(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}queryVectors(t){return oe(this,void 0,void 0,function*(){try{return{data:yield qi(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}deleteVectors(t){return oe(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield qi(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}}class bE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},gv),n),this.fetch=pv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return oe(this,void 0,void 0,function*(){try{return{data:(yield qi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}getBucket(t){return oe(this,void 0,void 0,function*(){try{return{data:yield qi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}listBuckets(){return oe(this,arguments,void 0,function*(t={}){try{return{data:yield qi(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}deleteBucket(t){return oe(this,void 0,void 0,function*(){try{return{data:(yield qi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ki(n))return{data:null,error:n};throw n}})}}class _E extends bE{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new EE(this.url,this.headers,t,this.fetch)}}class EE extends yE{constructor(t,n,a,r){super(t,n,r),this.vectorBucketName=a}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return oe(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return oe(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return oe(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return oe(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new CE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class CE extends SE{constructor(t,n,a,r,l){super(t,n,l),this.vectorBucketName=a,this.indexName=r}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return oe(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return oe(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return oe(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return oe(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return oe(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class TE extends fE{constructor(t,n={},a,r){super(t,n,a,r)}from(t){return new cE(this.url,this.headers,t,this.fetch)}get vectors(){return new _E(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new dE(this.url+"/iceberg",this.headers,this.fetch)}}const AE="2.76.1";let ah="";typeof Deno<"u"?ah="deno":typeof document<"u"?ah="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ah="react-native":ah="node";const wE={"X-Client-Info":`supabase-js-${ah}/${AE}`},RE={headers:wE},OE={schema:"public"},xE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ME={},NE=o=>{let t;return o?t=o:typeof fetch>"u"?t=XS:t=fetch,(...n)=>t(...n)},DE=()=>typeof Headers>"u"?FS:Headers,jE=(o,t,n)=>{const a=NE(n),r=DE();return async(l,f)=>{var d;const g=(d=await t())!==null&&d!==void 0?d:o;let m=new r(f==null?void 0:f.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),a(l,Object.assign(Object.assign({},f),{headers:m}))}};function UE(o){return o.endsWith("/")?o:o+"/"}function BE(o,t){var n,a;const{db:r,auth:l,realtime:f,global:d}=o,{db:g,auth:m,realtime:_,global:C}=t,E={db:Object.assign(Object.assign({},g),r),auth:Object.assign(Object.assign({},m),l),realtime:Object.assign(Object.assign({},_),f),storage:{},global:Object.assign(Object.assign(Object.assign({},C),d),{headers:Object.assign(Object.assign({},(n=C==null?void 0:C.headers)!==null&&n!==void 0?n:{}),(a=d==null?void 0:d.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return o.accessToken?E.accessToken=o.accessToken:delete E.accessToken,E}function zE(o){const t=o==null?void 0:o.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(UE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const ob="2.76.1",of=30*1e3,Qm=3,Xp=Qm*of,LE="http://localhost:9999",PE="supabase.auth.token",GE={"X-Client-Info":`gotrue-js/${ob}`},Xm="X-Supabase-Api-Version",lb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},HE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,IE=600*1e3;class ph extends Error{constructor(t,n,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=a}}function he(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class kE extends ph{constructor(t,n,a){super(t,n,a),this.name="AuthApiError",this.status=n,this.code=a}}function qE(o){return he(o)&&o.name==="AuthApiError"}class yu extends ph{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class _l extends ph{constructor(t,n,a,r){super(t,a,r),this.name=n,this.status=a}}class fl extends _l{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function VE(o){return he(o)&&o.name==="AuthSessionMissingError"}class Wc extends _l{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cg extends _l{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class fg extends _l{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function YE(o){return he(o)&&o.name==="AuthImplicitGrantRedirectError"}class x1 extends _l{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Fm extends _l{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Fp(o){return he(o)&&o.name==="AuthRetryableFetchError"}class M1 extends _l{constructor(t,n,a){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=a}}class Jm extends _l{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Eg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),N1=` 	
\r=`.split(""),KE=(()=>{const o=new Array(128);for(let t=0;t<o.length;t+=1)o[t]=-1;for(let t=0;t<N1.length;t+=1)o[N1[t].charCodeAt(0)]=-2;for(let t=0;t<Eg.length;t+=1)o[Eg[t].charCodeAt(0)]=t;return o})();function D1(o,t,n){if(o!==null)for(t.queue=t.queue<<8|o,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;n(Eg[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;n(Eg[a]),t.queuedBits-=6}}function ub(o,t,n){const a=KE[o];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function j1(o){const t=[],n=f=>{t.push(String.fromCodePoint(f))},a={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},l=f=>{FE(f,a,n)};for(let f=0;f<o.length;f+=1)ub(o.charCodeAt(f),r,l);return t.join("")}function QE(o,t){if(o<=127){t(o);return}else if(o<=2047){t(192|o>>6),t(128|o&63);return}else if(o<=65535){t(224|o>>12),t(128|o>>6&63),t(128|o&63);return}else if(o<=1114111){t(240|o>>18),t(128|o>>12&63),t(128|o>>6&63),t(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function XE(o,t){for(let n=0;n<o.length;n+=1){let a=o.charCodeAt(n);if(a>55295&&a<=56319){const r=(a-55296)*1024&65535;a=(o.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}QE(a,t)}}function FE(o,t,n){if(t.utf8seq===0){if(o<=127){n(o);return}for(let a=1;a<6;a+=1)if((o>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=o&31;else if(t.utf8seq===3)t.codepoint=o&15;else if(t.utf8seq===4)t.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|o&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function cf(o){const t=[],n={queue:0,queuedBits:0},a=r=>{t.push(r)};for(let r=0;r<o.length;r+=1)ub(o.charCodeAt(r),n,a);return new Uint8Array(t)}function JE(o){const t=[];return XE(o,n=>t.push(n)),new Uint8Array(t)}function bu(o){const t=[],n={queue:0,queuedBits:0},a=r=>{t.push(r)};return o.forEach(r=>D1(r,n,a)),D1(null,n,a),t.join("")}function ZE(o){return Math.round(Date.now()/1e3)+o}function WE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o=="x"?t:t&3|8).toString(16)})}const Hi=()=>typeof window<"u"&&typeof document<"u",fu={tested:!1,writable:!1},cb=()=>{if(!Hi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fu.tested)return fu.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),fu.tested=!0,fu.writable=!0}catch{fu.tested=!0,fu.writable=!1}return fu.writable};function $E(o){const t={},n=new URL(o);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,l)=>{t[l]=r})}catch{}return n.searchParams.forEach((a,r)=>{t[r]=a}),t}const fb=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>Ru(async()=>{const{default:a}=await Promise.resolve().then(()=>Ou);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},tC=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",lf=async(o,t,n)=>{await o.setItem(t,JSON.stringify(n))},du=async(o,t)=>{const n=await o.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},ol=async(o,t)=>{await o.removeItem(t)};class zg{constructor(){this.promise=new zg.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}zg.promiseConstructor=Promise;function Jp(o){const t=o.split(".");if(t.length!==3)throw new Jm("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!HE.test(t[a]))throw new Jm("JWT not in base64url format");return{header:JSON.parse(j1(t[0])),payload:JSON.parse(j1(t[1])),signature:cf(t[2]),raw:{header:t[0],payload:t[1]}}}async function eC(o){return await new Promise(t=>{setTimeout(()=>t(null),o)})}function nC(o,t){return new Promise((a,r)=>{(async()=>{for(let l=0;l<1/0;l++)try{const f=await o(l);if(!t(l,null,f)){a(f);return}}catch(f){if(!t(l,f)){r(f);return}}})()})}function aC(o){return("0"+o.toString(16)).substr(-2)}function iC(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=n.length;let r="";for(let l=0;l<56;l++)r+=n.charAt(Math.floor(Math.random()*a));return r}return crypto.getRandomValues(t),Array.from(t,aC).join("")}async function rC(o){const n=new TextEncoder().encode(o),a=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(a);return Array.from(r).map(l=>String.fromCharCode(l)).join("")}async function sC(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const n=await rC(o);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $c(o,t,n=!1){const a=iC();let r=a;n&&(r+="/PASSWORD_RECOVERY"),await lf(o,`${t}-code-verifier`,r);const l=await sC(a);return[l,a===l?"plain":"s256"]}const oC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function lC(o){const t=o.headers.get(Xm);if(!t||!t.match(oC))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function uC(o){if(!o)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(o<=t)throw new Error("JWT has expired")}function cC(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const fC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tf(o){if(!fC.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Zp(){const o={};return new Proxy(o,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function U1(o){return JSON.parse(JSON.stringify(o))}const pu=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),dC=[502,503,504];async function B1(o){var t;if(!tC(o))throw new Fm(pu(o),0);if(dC.includes(o.status))throw new Fm(pu(o),o.status);let n;try{n=await o.json()}catch(l){throw new yu(pu(l),l)}let a;const r=lC(o);if(r&&r.getTime()>=lb["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?a=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(a=n.error_code),a){if(a==="weak_password")throw new M1(pu(n),o.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new fl}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,f)=>l&&typeof f=="string",!0))throw new M1(pu(n),o.status,n.weak_password.reasons);throw new kE(pu(n),o.status||500,a)}const hC=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(a),Object.assign(Object.assign({},r),n))};async function De(o,t,n,a){var r;const l=Object.assign({},a==null?void 0:a.headers);l[Xm]||(l[Xm]=lb["2024-01-01"].name),a!=null&&a.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const f=(r=a==null?void 0:a.query)!==null&&r!==void 0?r:{};a!=null&&a.redirectTo&&(f.redirect_to=a.redirectTo);const d=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",g=await gC(o,t,n+d,{headers:l,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(g):{data:Object.assign({},g),error:null}}async function gC(o,t,n,a,r,l){const f=hC(t,a,r,l);let d;try{d=await o(n,Object.assign({},f))}catch(g){throw console.error(g),new Fm(pu(g),0)}if(d.ok||await B1(d),a!=null&&a.noResolveJson)return d;try{return await d.json()}catch(g){await B1(g)}}function qr(o){var t;let n=null;vC(o)&&(n=Object.assign({},o),o.expires_at||(n.expires_at=ZE(o.expires_in)));const a=(t=o.user)!==null&&t!==void 0?t:o;return{data:{session:n,user:a},error:null}}function z1(o){const t=qr(o);return!t.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((n,a)=>n&&typeof a=="string",!0)&&(t.data.weak_password=o.weak_password),t}function hl(o){var t;return{data:{user:(t=o.user)!==null&&t!==void 0?t:o},error:null}}function pC(o){return{data:o,error:null}}function mC(o){const{action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:l}=o,f=bf(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:l},g=Object.assign({},f);return{data:{properties:d,user:g},error:null}}function L1(o){return o}function vC(o){return o.access_token&&o.refresh_token&&o.expires_in}const Wp=["global","local","others"];class yC{constructor({url:t="",headers:n={},fetch:a}){this.url=t,this.headers=n,this.fetch=fb(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Wp[0]){if(Wp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Wp.join(", ")}`);try{return await De(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(he(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,n={}){try{return await De(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:hl})}catch(a){if(he(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:n}=t,a=bf(t,["options"]),r=Object.assign(Object.assign({},a),n);return"newEmail"in a&&(r.new_email=a==null?void 0:a.newEmail,delete r.newEmail),await De(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:mC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(he(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await De(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:hl})}catch(n){if(he(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,a,r,l,f,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await De(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:L1});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),L=JSON.parse(v.split(";")[1].split("=")[1]);m[`${L}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(he(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){tf(t);try{return await De(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:hl})}catch(n){if(he(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){tf(t);try{return await De(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:hl})}catch(a){if(he(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,n=!1){tf(t);try{return await De(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:hl})}catch(a){if(he(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){tf(t.userId);try{const{data:n,error:a}=await De(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:a}}catch(n){if(he(n))return{data:null,error:n};throw n}}async _deleteFactor(t){tf(t.userId),tf(t.id);try{return{data:await De(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(he(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,a,r,l,f,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await De(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:L1});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),L=JSON.parse(v.split(";")[1].split("=")[1]);m[`${L}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(he(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await De(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await De(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(he(n))return{data:null,error:n};throw n}}}function P1(o={}){return{getItem:t=>o[t]||null,setItem:(t,n)=>{o[t]=n},removeItem:t=>{delete o[t]}}}const ef={debug:!!(globalThis&&cb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class db extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class SC extends db{}async function bC(o,t,n){ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),ef.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async r=>{if(r){ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,r.name);try{return await n()}finally{ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,r.name)}}else{if(t===0)throw ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new SC(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(ef.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function _C(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function hb(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function EC(o){return parseInt(o,16)}function CC(o){const t=new TextEncoder().encode(o);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function TC(o){var t;const{chainId:n,domain:a,expirationTime:r,issuedAt:l=new Date,nonce:f,notBefore:d,requestId:g,resources:m,scheme:_,uri:C,version:E}=o;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((t=o.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const R=hb(o.address),v=_?`${_}://${a}`:a,D=o.statement?`${o.statement}
`:"",L=`${v} wants you to sign in with your Ethereum account:
${R}

${D}`;let B=`URI: ${C}
Version: ${E}
Chain ID: ${n}${f?`
Nonce: ${f}`:""}
Issued At: ${l.toISOString()}`;if(r&&(B+=`
Expiration Time: ${r.toISOString()}`),d&&(B+=`
Not Before: ${d.toISOString()}`),g&&(B+=`
Request ID: ${g}`),m){let N=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);N+=`
- ${M}`}B+=N}return`${L}
${B}`}class ga extends Error{constructor({message:t,code:n,cause:a,name:r}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=r??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class Cg extends ga{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function AC({error:o,options:t}){var n,a,r;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ga({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new ga({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new ga({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new ga({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new ga({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new ga({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new ga({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new ga({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const f=window.location.hostname;if(gb(f)){if(l.rp.id!==f)return new ga({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new ga({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new ga({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new ga({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new ga({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function wC({error:o,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ga({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new ga({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const a=window.location.hostname;if(gb(a)){if(n.rpId!==a)return new ga({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new ga({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new ga({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new ga({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class RC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const OC=new RC;function xC(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:t,user:n,excludeCredentials:a}=o,r=bf(o,["challenge","user","excludeCredentials"]),l=cf(t).buffer,f=Object.assign(Object.assign({},n),{id:cf(n.id).buffer}),d=Object.assign(Object.assign({},r),{challenge:l,user:f});if(a&&a.length>0){d.excludeCredentials=new Array(a.length);for(let g=0;g<a.length;g++){const m=a[g];d.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:cf(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function MC(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:t,allowCredentials:n}=o,a=bf(o,["challenge","allowCredentials"]),r=cf(t).buffer,l=Object.assign(Object.assign({},a),{challenge:r});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const d=n[f];l.allowCredentials[f]=Object.assign(Object.assign({},d),{id:cf(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function NC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o;return{id:o.id,rawId:o.id,response:{attestationObject:bu(new Uint8Array(o.response.attestationObject)),clientDataJSON:bu(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function DC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o,a=o.getClientExtensionResults(),r=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:bu(new Uint8Array(r.authenticatorData)),clientDataJSON:bu(new Uint8Array(r.clientDataJSON)),signature:bu(new Uint8Array(r.signature)),userHandle:r.userHandle?bu(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function gb(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function G1(){var o,t;return!!(Hi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator==null?void 0:navigator.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function jC(o){try{const t=await navigator.credentials.create(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Cg("Browser returned unexpected credential type",t)}:{data:null,error:new Cg("Empty credential response",t)}}catch(t){return{data:null,error:AC({error:t,options:o})}}}async function UC(o){try{const t=await navigator.credentials.get(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Cg("Browser returned unexpected credential type",t)}:{data:null,error:new Cg("Empty credential response",t)}}catch(t){return{data:null,error:wC({error:t,options:o})}}}const BC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},zC={userVerification:"preferred",hints:["security-key"]};function Tg(...o){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),a={};for(const r of o)if(r)for(const l in r){const f=r[l];if(f!==void 0)if(Array.isArray(f))a[l]=f;else if(n(f))a[l]=f;else if(t(f)){const d=a[l];t(d)?a[l]=Tg(d,f):a[l]=Tg(f)}else a[l]=f}return a}function LC(o,t){return Tg(BC,o,t||{})}function PC(o,t){return Tg(zC,o,t||{})}class GC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:a,signal:r},l){try{const{data:f,error:d}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!f)return{data:null,error:d};const g=r??OC.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${a}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=LC(f.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:C}=await jC({publicKey:m,signal:g});return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}case"request":{const m=PC(f.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:C}=await UC(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}}}catch(f){return he(f)?{data:null,error:f}:{data:null,error:new yu("Unexpected error in challenge",f)}}}async _verify({challengeId:t,factorId:n,webauthn:a}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:r}},l){if(!n)return{data:null,error:new ph("rpId is required for WebAuthn authentication")};try{if(!G1())return{data:null,error:new yu("Browser does not support WebAuthn",null)};const{data:f,error:d}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:a},signal:r},{request:l});if(!f)return{data:null,error:d};const{webauthn:g}=f;return this._verify({factorId:t,challengeId:f.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:a,credential_response:g.credential_response}})}catch(f){return he(f)?{data:null,error:f}:{data:null,error:new yu("Unexpected error in authenticate",f)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:r},l){if(!n)return{data:null,error:new ph("rpId is required for WebAuthn registration")};try{if(!G1())return{data:null,error:new yu("Browser does not support WebAuthn",null)};const{data:f,error:d}=await this._enroll({friendlyName:t});if(!f)return await this.client.mfa.listFactors().then(_=>{var C;return(C=_.data)===null||C===void 0?void 0:C.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===t&&E.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:d};const{data:g,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:n,rpOrigins:a},signal:r},{create:l});return g?this._verify({factorId:f.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:a,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(f){return he(f)?{data:null,error:f}:{data:null,error:new yu("Unexpected error in register",f)}}}}_C();const HC={url:LE,storageKey:PE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:GE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function H1(o,t,n){return await n()}const nf={};class mh{get jwks(){var t,n;return(n=(t=nf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){nf[this.storageKey]=Object.assign(Object.assign({},nf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=nf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){nf[this.storageKey]=Object.assign(Object.assign({},nf[this.storageKey]),{cachedAt:t})}constructor(t){var n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=mh.nextInstanceID,mh.nextInstanceID+=1,this.instanceID>0&&Hi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},HC),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new yC({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=fb(r.fetch),this.lock=r.lock||H1,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Hi()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=bC:this.lock=H1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new GC(this)},this.persistSession?(r.storage?this.storage=r.storage:cb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=P1(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=P1(this.memoryStorage)),Hi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ob}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=$E(window.location.href);let a="none";if(this._isImplicitGrantCallback(n)?a="implicit":await this._isPKCECallback(n)&&(a="pkce"),Hi()&&this.detectSessionInUrl&&a!=="none"){const{data:r,error:l}=await this._getSessionFromURL(n,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),YE(l)){const g=(t=l.details)===null||t===void 0?void 0:t.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:f,redirectType:d}=r;return this._debug("#_initialize()","detected session in URL",f,"redirect type",d),await this._saveSession(f),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return he(n)?{error:n}:{error:new yu("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,a,r;try{const l=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:qr}),{data:f,error:d}=l;if(d||!f)return{data:{user:null,session:null},error:d};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(he(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var n,a,r;try{let l;if("email"in t){const{email:_,password:C,options:E}=t;let R=null,v=null;this.flowType==="pkce"&&([R,v]=await $c(this.storage,this.storageKey)),l=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:_,password:C,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:R,code_challenge_method:v},xform:qr})}else if("phone"in t){const{phone:_,password:C,options:E}=t;l=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:C,data:(a=E==null?void 0:E.data)!==null&&a!==void 0?a:{},channel:(r=E==null?void 0:E.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:qr})}else throw new cg("You must provide either an email or phone number and a password");const{data:f,error:d}=l;if(d||!f)return{data:{user:null,session:null},error:d};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(he(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:f,options:d}=t;n=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:f,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:z1})}else if("phone"in t){const{phone:l,password:f,options:d}=t;n=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:f,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:z1})}else throw new cg("You must provide either an email or phone number and a password");const{data:a,error:r}=n;return r?{data:{user:null,session:null},error:r}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Wc}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:r})}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,a,r,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,a,r,l,f,d,g,m,_,C,E;let R,v;if("message"in t)R=t.message,v=t.signature;else{const{chain:D,wallet:L,statement:B,options:N}=t;let M;if(Hi())if(typeof L=="object")M=L;else{const z=window;if("ethereum"in z&&typeof z.ethereum=="object"&&"request"in z.ethereum&&typeof z.ethereum.request=="function")M=z.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=L}const P=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href),O=await M.request({method:"eth_requestAccounts"}).then(z=>z).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=hb(O[0]);let T=(a=N==null?void 0:N.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!T){const z=await M.request({method:"eth_chainId"});T=EC(z)}const y={domain:P.host,address:A,statement:B,uri:P.href,version:"1",chainId:T,nonce:(r=N==null?void 0:N.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(f=(l=N==null?void 0:N.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(d=N==null?void 0:N.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(g=N==null?void 0:N.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=N==null?void 0:N.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=N==null?void 0:N.signInWithEthereum)===null||_===void 0?void 0:_.resources};R=TC(y),v=await M.request({method:"personal_sign",params:[CC(R),A]})}try{const{data:D,error:L}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:R,signature:v},!((C=t.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(E=t.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:qr});if(L)throw L;return!D||!D.session||!D.user?{data:{user:null,session:null},error:new Wc}:(D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),{data:Object.assign({},D),error:L})}catch(D){if(he(D))return{data:{user:null,session:null},error:D};throw D}}async signInWithSolana(t){var n,a,r,l,f,d,g,m,_,C,E,R;let v,D;if("message"in t)v=t.message,D=t.signature;else{const{chain:L,wallet:B,statement:N,options:M}=t;let P;if(Hi())if(typeof B=="object")P=B;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))P=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof B!="object"||!(M!=null&&M.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=B}const O=new URL((n=M==null?void 0:M.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in P&&P.signIn){const A=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M==null?void 0:M.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),N?{statement:N}:null));let T;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")T=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)T=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)v=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),D=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${O.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(r=(a=M==null?void 0:M.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((l=M==null?void 0:M.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((f=M==null?void 0:M.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((d=M==null?void 0:M.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((g=M==null?void 0:M.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M==null?void 0:M.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((C=(_=M==null?void 0:M.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||C===void 0)&&C.length?["Resources",...M.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const A=await P.signMessage(new TextEncoder().encode(v),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=A}}try{const{data:L,error:B}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:bu(D)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(R=t.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:qr});if(B)throw B;return!L||!L.session||!L.user?{data:{user:null,session:null},error:new Wc}:(L.session&&(await this._saveSession(L.session),await this._notifyAllSubscribers("SIGNED_IN",L.session)),{data:Object.assign({},L),error:B})}catch(L){if(he(L))return{data:{user:null,session:null},error:L};throw L}}async _exchangeCodeForSession(t){const n=await du(this.storage,`${this.storageKey}-code-verifier`),[a,r]=(n??"").split("/");try{const{data:l,error:f}=await De(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:qr});if(await ol(this.storage,`${this.storageKey}-code-verifier`),f)throw f;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Wc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:r??null}),error:f})}catch(l){if(he(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:n,provider:a,token:r,access_token:l,nonce:f}=t,d=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:r,access_token:l,nonce:f,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:qr}),{data:g,error:m}=d;return m?{data:{user:null,session:null},error:m}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Wc}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:m})}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,a,r,l,f;try{if("email"in t){const{email:d,options:g}=t;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await $c(this.storage,this.storageKey));const{error:C}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(a=g==null?void 0:g.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:d,options:g}=t,{data:m,error:_}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(f=g==null?void 0:g.channel)!==null&&f!==void 0?f:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_}}throw new cg("You must provide either an email or phone number.")}catch(d){if(he(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(t){var n,a;try{let r,l;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:f,error:d}=await De(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:r,xform:qr});if(d)throw d;if(!f)throw new Error("An error occurred on token verification.");const g=f.session,m=f.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(r){if(he(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,a,r;try{let l=null,f=null;return this.flowType==="pkce"&&([l,f]=await $c(this.storage,this.storageKey)),await De(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&a!==void 0?a:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:f}),headers:this.headers,xform:pC})}catch(l){if(he(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;if(a)throw a;if(!n)throw new fl;const{error:r}=await De(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(he(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:a,type:r,options:l}=t,{error:f}=await De(this.fetch,"POST",n,{headers:this.headers,body:{email:a,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}else if("phone"in t){const{phone:a,type:r,options:l}=t,{data:f,error:d}=await De(this.fetch,"POST",n,{headers:this.headers,body:{phone:a,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:d}}throw new cg("You must provide either an email or phone number and a type")}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await a,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=n();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await du(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<Xp:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const f=await du(this.userStorage,this.storageKey+"-user");f!=null&&f.user?t.user=f.user:t.user=Zp()}if(this.storage.isServer&&t.user){let f=this.suppressGetSessionWarning;t=new Proxy(t,{get:(g,m,_)=>(!f&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),f=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,m,_))})}return{data:{session:t},error:null}}const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:hl}):await this._useSession(async n=>{var a,r,l;const{data:f,error:d}=n;if(d)throw d;return!(!((a=f.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new fl}:await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(r=f.session)===null||r===void 0?void 0:r.access_token)!==null&&l!==void 0?l:void 0,xform:hl})})}catch(n){if(he(n))return VE(n)&&(await this._removeSession(),await ol(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async a=>{const{data:r,error:l}=a;if(l)throw l;if(!r.session)throw new fl;const f=r.session;let d=null,g=null;this.flowType==="pkce"&&t.email!=null&&([d,g]=await $c(this.storage,this.storageKey));const{data:m,error:_}=await De(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:g}),jwt:f.access_token,xform:hl});if(_)throw _;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(a){if(he(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new fl;const n=Date.now()/1e3;let a=n,r=!0,l=null;const{payload:f}=Jp(t.access_token);if(f.exp&&(a=f.exp,r=a<=n),r){const{data:d,error:g}=await this._callRefreshToken(t.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:g}=await this._getUser(t.access_token);if(g)throw g;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:a-n,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(n){if(he(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var a;if(!t){const{data:f,error:d}=n;if(d)throw d;t=(a=f.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new fl;const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Hi())throw new fg("No browser detected.");if(t.error||t.error_description||t.error_code)throw new fg(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new x1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new fg("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new x1("No code detected.");const{data:N,error:M}=await this._exchangeCodeForSession(t.code);if(M)throw M;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:r,access_token:l,refresh_token:f,expires_in:d,expires_at:g,token_type:m}=t;if(!l||!d||!f||!m)throw new fg("No session defined in URL");const _=Math.round(Date.now()/1e3),C=parseInt(d);let E=_+C;g&&(E=parseInt(g));const R=E-_;R*1e3<=of&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${C}s`);const v=E-C;_-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,E,_):_-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,E,_);const{data:D,error:L}=await this._getUser(l);if(L)throw L;const B={provider_token:a,provider_refresh_token:r,access_token:l,expires_in:C,expires_at:E,refresh_token:f,token_type:m,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:B,redirectType:t.type},error:null}}catch(a){if(he(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await du(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{error:l};const f=(a=r.session)===null||a===void 0?void 0:a.access_token;if(f){const{error:d}=await this.admin.signOut(f,t);if(d&&!(qE(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return t!=="others"&&(await this._removeSession(),await ol(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=WE(),a={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async n=>{var a,r;try{const{data:{session:l},error:f}=n;if(f)throw f;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let a=null,r=null;this.flowType==="pkce"&&([a,r]=await $c(this.storage,this.storageKey,!0));try{return await De(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(he(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:n,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(he(n))return{data:null,error:n};throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:a,error:r}=await this._useSession(async l=>{var f,d,g,m,_;const{data:C,error:E}=l;if(E)throw E;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(f=t.options)===null||f===void 0?void 0:f.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=t.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await De(this.fetch,"GET",R,{headers:this.headers,jwt:(_=(m=C.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(r)throw r;return Hi()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(he(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var a;try{const{error:r,data:{session:l}}=n;if(r)throw r;const{options:f,provider:d,token:g,access_token:m,nonce:_}=t,C=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l==null?void 0:l.access_token)!==null&&a!==void 0?a:void 0,body:{provider:d,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:qr}),{data:E,error:R}=C;return R?{data:{user:null,session:null},error:R}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new Wc}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:R})}catch(r){if(he(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var a,r;const{data:l,error:f}=n;if(f)throw f;return await De(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const a=Date.now();return await nC(async r=>(r>0&&await eC(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await De(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:qr})),(r,l)=>{const f=200*Math.pow(2,r);return l&&Fp(l)&&Date.now()+f-a<of})}catch(a){if(this._debug(n,"error",a),he(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",a),Hi()&&!n.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,n;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const r=await du(this.storage,this.storageKey);if(r&&this.userStorage){let f=await du(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:r.user},await lf(this.userStorage,this.storageKey+"-user",f)),r.user=(t=f==null?void 0:f.user)!==null&&t!==void 0?t:Zp()}else if(r&&!r.user&&!r.user){const f=await du(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(r.user=f.user,await ol(this.storage,this.storageKey+"-user"),await lf(this.storage,this.storageKey,r)):r.user=Zp()}if(this._debug(a,"session from storage",r),!this._isValidSession(r)){this._debug(a,"session is not valid"),r!==null&&await this._removeSession();return}const l=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Xp;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${Xp}s`),l){if(this.autoRefreshToken&&r.refresh_token){const{error:f}=await this._callRefreshToken(r.refresh_token);f&&(console.error(f),Fp(f)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:d}=await this._getUser(r.access_token);!d&&(f!=null&&f.user)?(r.user=f.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(a,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(a,"error",r),console.error(r);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var n,a;if(!t)throw new fl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new zg;const{data:l,error:f}=await this._refreshAccessToken(t);if(f)throw f;if(!l.session)throw new fl;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(r,"error",l),he(l)){const f={data:null,error:l};return Fp(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(f),f}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,a=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],f=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,n)}catch(g){l.push(g)}});if(await Promise.all(f),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),a=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&n.user&&await lf(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const l=U1(r);await lf(this.storage,this.storageKey,l)}else{const r=U1(n);await lf(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await ol(this.storage,this.storageKey),await ol(this.storage,this.storageKey+"-code-verifier"),await ol(this.storage,this.storageKey+"-user"),this.userStorage&&await ol(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Hi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),of);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:a}}=n;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((a.expires_at*1e3-t)/of);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${of}ms, refresh threshold is ${Qm} ticks`),r<=Qm&&await this._callRefreshToken(a.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof db)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Hi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,a){const r=[`provider=${encodeURIComponent(n)}`];if(a!=null&&a.redirectTo&&r.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&r.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,f]=await $c(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(f)}`});r.push(d.toString())}if(a!=null&&a.queryParams){const l=new URLSearchParams(a.queryParams);r.push(l.toString())}return a!=null&&a.skipBrowserRedirect&&r.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;return l?{data:null,error:l}:await De(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var a,r;const{data:l,error:f}=n;if(f)return{data:null,error:f};const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:g,error:m}=await De(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token});return m?{data:null,error:m}:(t.factorType==="totp"&&g.type==="totp"&&(!((r=g==null?void 0:g.totp)===null||r===void 0)&&r.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{data:null,error:l};const f=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?NC(t.webauthn.credential_response):DC(t.webauthn.credential_response)})}:{code:t.code}),{data:d,error:g}=await De(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:f,headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:g})})}catch(n){if(he(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{data:null,error:l};const f=await De(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token});if(f.error)return f;const{data:d}=f;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:xC(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:MC(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(he(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:a}=await this.getUser();if(a)return{data:null,error:a};const r={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])r.all.push(l),l.status==="verified"&&r[l.factor_type].push(l);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,a;const{data:{session:r},error:l}=t;if(l)return{data:null,error:l};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=Jp(r.access_token);let d=null;f.aal&&(d=f.aal);let g=d;((a=(n=r.user.factors)===null||n===void 0?void 0:n.filter(C=>C.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(g="aal2");const _=f.amr||[];return{data:{currentLevel:d,nextLevel:g,currentAuthenticationMethods:_},error:null}}))}async fetchJwk(t,n={keys:[]}){let a=n.keys.find(d=>d.kid===t);if(a)return a;const r=Date.now();if(a=this.jwks.keys.find(d=>d.kid===t),a&&this.jwks_cached_at+IE>r)return a;const{data:l,error:f}=await De(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=r,a=l.keys.find(d=>d.kid===t),!a)?null:a}async getClaims(t,n={}){try{let a=t;if(!a){const{data:R,error:v}=await this.getSession();if(v||!R.session)return{data:null,error:v};a=R.session.access_token}const{header:r,payload:l,signature:f,raw:{header:d,payload:g}}=Jp(a);n!=null&&n.allowExpired||uC(l.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!m){const{error:R}=await this.getUser(a);if(R)throw R;return{data:{claims:l,header:r,signature:f},error:null}}const _=cC(r.alg),C=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,C,f,JE(`${d}.${g}`)))throw new Jm("Invalid JWT signature");return{data:{claims:l,header:r,signature:f},error:null}}catch(a){if(he(a))return{data:null,error:a};throw a}}}mh.nextInstanceID=0;const IC=mh;class kC extends IC{constructor(t){super(t)}}class qC{constructor(t,n,a){var r,l,f;this.supabaseUrl=t,this.supabaseKey=n;const d=zE(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const g=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:OE,realtime:ME,auth:Object.assign(Object.assign({},xE),{storageKey:g}),global:RE},_=BE(a??{},m);this.storageKey=(r=_.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(l=_.global.headers)!==null&&l!==void 0?l:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(C,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=_.auth)!==null&&f!==void 0?f:{},this.headers,_.global.fetch),this.fetch=jE(n,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new L_(new URL("rest/v1",d).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new TE(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new R_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,a)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(n=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:a,storage:r,userStorage:l,storageKey:f,flowType:d,lock:g,debug:m},_,C){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new kC({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),_),storageKey:f,autoRefreshToken:t,persistSession:n,detectSessionInUrl:a,storage:r,userStorage:l,flowType:d,lock:g,debug:m,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(R=>R.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new tE(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,a)=>{this._handleTokenChanged(n,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,n,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const VC=(o,t,n)=>new qC(o,t,n);function YC(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const t=o.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}YC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const KC="https://pmlwhqhezvczissdvuyc.supabase.co",QC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtbHdocWhlenZjemlzc2R2dXljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0MTA4MDUsImV4cCI6MjA3Njk4NjgwNX0.3W7AiFmapKzKJENDQ0H_Chz-V_AAw7a20fGOYlcCMb8",mu=VC(KC,QC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),FC=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,a)=>a?a.toUpperCase():n.toLowerCase()),I1=o=>{const t=FC(o);return t.charAt(0).toUpperCase()+t.slice(1)},pb=(...o)=>o.filter((t,n,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===n).join(" ").trim(),JC=o=>{for(const t in o)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ZC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=st.forwardRef(({color:o="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:l,iconNode:f,...d},g)=>st.createElement("svg",{ref:g,...ZC,width:t,height:t,stroke:o,strokeWidth:a?Number(n)*24/Number(t):n,className:pb("lucide",r),...!l&&!JC(d)&&{"aria-hidden":"true"},...d},[...f.map(([m,_])=>st.createElement(m,_)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=(o,t)=>{const n=st.forwardRef(({className:a,...r},l)=>st.createElement(WC,{ref:l,iconNode:t,className:pb(`lucide-${XC(I1(o))}`,`lucide-${o}`,a),...r}));return n.displayName=I1(o),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],mb=Ef("eraser",$C);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tT=[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]],eT=Ef("feather",tT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],vb=Ef("pen",nT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aT=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],yb=Ef("redo",aT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Sb=Ef("trash-2",iT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rT=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],bb=Ef("undo",rT),k1="Feather_studentId",q1=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,o=>{const t=Math.random()*16|0;return(o==="x"?t:t&3|8).toString(16)}),sT=()=>{try{let o=sessionStorage.getItem(k1);return o?(console.log(" Using existing studentId:",o),o):(o=`student-${q1()}`,sessionStorage.setItem(k1,o),console.log(" Created new studentId:",o),o)}catch{return console.warn(" sessionStorage unavailable, using memory-only studentId"),`student-temp-${q1()}`}},oT="feather-whiteboard",lT=1,vh="teacher-strokes",yh="student-strokes";let dg=null;const mv=()=>new Promise((o,t)=>{if(dg){o(dg);return}const n=indexedDB.open(oT,lT);n.onerror=()=>{console.error("IndexedDB error:",n.error),t(n.error)},n.onsuccess=()=>{dg=n.result,console.log(" IndexedDB initialized"),o(dg)},n.onupgradeneeded=a=>{const r=a.target.result;if(!r.objectStoreNames.contains(vh)){const l=r.createObjectStore(vh,{keyPath:"id"});l.createIndex("roomId","roomId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1}),console.log("Created teacher-strokes object store")}if(!r.objectStoreNames.contains(yh)){const l=r.createObjectStore(yh,{keyPath:"id"});l.createIndex("roomId","roomId",{unique:!1}),l.createIndex("studentId","studentId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1}),console.log("Created student-strokes object store")}}}),_b=async(o,t,n,a)=>{try{const r=await mv(),l=a==="teacher"?vh:yh,d=r.transaction([l],"readwrite").objectStore(l),m={id:`${t}:${n}:${o.strokeId||Date.now()}`,roomId:t,userId:n,stroke:o,timestamp:Date.now()},_=d.put(m);return new Promise((C,E)=>{_.onsuccess=()=>C(),_.onerror=()=>{console.error("Error saving stroke to IndexedDB:",_.error),E(_.error)}})}catch(r){throw console.error("saveStroke error:",r),r}},Eb=async(o,t,n)=>{try{const a=await mv(),r=n==="teacher"?vh:yh,g=a.transaction([r],"readonly").objectStore(r).index("roomId").getAll(o);return new Promise((m,_)=>{g.onsuccess=()=>{const E=(g.result||[]).filter(R=>R.userId===t).sort((R,v)=>R.timestamp-v.timestamp).map(R=>R.stroke);console.log(` Loaded ${E.length} ${n} strokes from IndexedDB`),m(E)},g.onerror=()=>{console.error("Error loading strokes from IndexedDB:",g.error),_(g.error)}})}catch(a){return console.error("loadStrokes error:",a),[]}},Cb=async(o,t,n)=>{try{const a=await mv(),r=n==="teacher"?vh:yh,g=a.transaction([r],"readwrite").objectStore(r).index("roomId").openCursor(o);return new Promise((m,_)=>{g.onsuccess=C=>{const E=C.target.result;E?(E.value.userId===t&&E.delete(),E.continue()):(console.log(` Cleared ${n} strokes from IndexedDB for room ${o}`),m())},g.onerror=()=>{console.error("Error clearing strokes from IndexedDB:",g.error),_(g.error)}})}catch(a){throw console.error("clearStrokes error:",a),a}},uT=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,hu={width:800,height:600},cT=.65,fT=2.2,hg="studentCanvasPrefs",V1=2,Y1=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,dT=({sharedImage:o,canvasWidth:t,canvasHeight:n})=>{const[a,r]=st.useState(null);if(st.useEffect(()=>{if(!o){r(null);return}const R=new window.Image;R.src=o.dataUrl,R.onload=()=>{r(R)}},[o]),!o||!a)return null;const l=a.naturalWidth||a.width,f=a.naturalHeight||a.height;if(!l||!f||!t||!n)return null;const d=l/f,g=t/n;let m,_,C,E;return d>g?(m=t,_=t/d,C=0,E=(n-_)/2):(_=n,m=n*d,C=(t-m)/2,E=0),m=Math.min(m,t),_=Math.min(_,n),k.jsx(sv,{image:a,x:C,y:E,width:m,height:_,listening:!1})};function hT(){const[o]=Sh(),t=yf(),n=o.get("room"),a=o.get("name"),[r,l]=st.useState(null),f=st.useRef({roomId:null,studentName:null,clientId:null}),[d,g]=st.useState(null),[m]=st.useState(()=>sT()),[_,C]=st.useState(!1),E=st.useRef(null),[R,v]=st.useState(null),[D,L]=st.useState("loading"),[B,N]=st.useState([]),[M,P]=st.useState([]),[O,A]=st.useState(null),[T,y]=st.useState("pen"),[z,U]=st.useState("black"),[G,K]=st.useState(3),[Q,X]=st.useState(!1),[Y,j]=st.useState("stylus-only"),[I,F]=st.useState("left"),[W,it]=st.useState(Y1()),Z=st.useRef(!1);st.useEffect(()=>{(!n||!a)&&t(`/student-login${n?`?room=${n}`:""}`)},[n,a,t]),st.useEffect(()=>{if(!n||!a)return;const vt=f.current;if(vt.clientId&&vt.roomId===n&&vt.studentName===a){g(vt.clientId);return}const dt=Math.random().toString(36).substring(2,8),Yt=Math.random().toString(36).substring(2,8),ae=Date.now().toString(36).slice(-4),Ae=`student-${`${dt}${Yt}${ae}`}`;f.current={roomId:n,studentName:a,clientId:Ae},g(Ae)},[a,n]),st.useEffect(()=>{if(!(!n||!a)&&!(typeof window>"u"))try{const vt=localStorage.getItem(hg);if(vt){const dt=JSON.parse(vt);if(dt.version!==V1){localStorage.removeItem(hg);return}dt.tool&&y(dt.tool),dt.color&&U(dt.color),typeof dt.brushSize=="number"&&K(dt.brushSize),dt.inputMode&&j(dt.inputMode),dt.toolbarPosition&&F(dt.toolbarPosition)}}catch{localStorage.removeItem(hg)}},[n,a]),st.useEffect(()=>{const vt=()=>{it(Y1())};return window.addEventListener("resize",vt),()=>window.removeEventListener("resize",vt)},[]),st.useEffect(()=>{W&&(j("all"),K(3))},[W]),st.useEffect(()=>{if(!n||!a||typeof window>"u")return;if(V.current){V.current=!1;return}const vt={version:V1,tool:T,color:z,brushSize:G,inputMode:Y,toolbarPosition:I};localStorage.setItem(hg,JSON.stringify(vt))},[T,z,G,Y,I,n,a]);const at=st.useRef([]),rt=st.useRef([]),V=st.useRef(!0),J=st.useRef(!1),tt=st.useRef(!1),nt=st.useRef(B);st.useEffect(()=>{nt.current=B},[B]);const ht=st.useRef(M);st.useEffect(()=>{ht.current=M},[M]);const wt=st.useRef(null),jt=st.useRef(null),[kt,ee]=st.useState(hu),re=st.useMemo(()=>hu.width?kt.width/hu.width:1,[kt.width]),Lt=st.useRef(kt),ge=st.useRef(re);st.useEffect(()=>{Lt.current=kt,ge.current=re},[kt,re]);const pe=st.useRef(null),rn=st.useRef(null);st.useEffect(()=>{if(!J.current&&r){const vt=setTimeout(()=>{r.publish("student-layer",{lines:B,studentId:m,clientId:d,meta:{display:kt,scale:re}}),console.log(" Published student layer:",B.length,"lines (studentId:",m,")")},150);return()=>clearTimeout(vt)}},[B,r,d,m,kt,re]);const Ye=st.useRef(new Set);st.useEffect(()=>{if(!n||!m||!a)return;const vt=setTimeout(async()=>{try{const dt=B.filter(Yt=>Yt.strokeId&&!Ye.current.has(Yt.strokeId));if(dt.length===0)return;await fetch("/api/strokes/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:n,party:"student",studentId:m,studentName:a,strokes:dt})}),dt.forEach(Yt=>Ye.current.add(Yt.strokeId)),console.log(` Saved ${dt.length} new student strokes to Redis`)}catch(dt){console.error("Error auto-saving strokes to Redis:",dt)}},3e3);return()=>clearTimeout(vt)},[B,n,m,a]),st.useEffect(()=>{if(!n||!m||!a)return;const vt=()=>{const dt=JSON.stringify({roomId:n,studentId:m,lines:B,studentName:a});navigator.sendBeacon("/api/strokes/save",dt)};return window.addEventListener("beforeunload",vt),()=>window.removeEventListener("beforeunload",vt)},[B,n,m,a]),st.useEffect(()=>()=>{rn.current&&cancelAnimationFrame(rn.current)},[]),st.useEffect(()=>{const vt=wt.current;if(!vt)return;const dt=Qt=>{const Ae=Qt.target;Ae.closest("button")||Ae.closest(".student-toolbar")||Ae.closest(".student-topbar")||Qt.preventDefault()},Yt=Qt=>{Qt.preventDefault()},ae=Qt=>{if(Q)return Qt.preventDefault(),!1};return vt.addEventListener("touchstart",dt,{passive:!1}),vt.addEventListener("touchmove",dt,{passive:!1}),vt.addEventListener("gesturestart",Yt,{passive:!1}),vt.addEventListener("gesturechange",Yt,{passive:!1}),document.addEventListener("selectstart",ae),()=>{vt&&(vt.removeEventListener("touchstart",dt),vt.removeEventListener("touchmove",dt),vt.removeEventListener("gesturestart",Yt),vt.removeEventListener("gesturechange",Yt)),document.removeEventListener("selectstart",ae)}},[Q]),st.useEffect(()=>{if(!n||!a||!d||E.current===n)return;E.current=n;let vt=!1;return(async()=>{try{const{data:Yt,error:ae}=await mu.from("sessions").select("*").ilike("room_code",n).order("created_at",{ascending:!1}).limit(1);if(ae){console.error("Session query error:",ae),L("no-session");return}if(!Yt||Yt.length===0){console.log("No session found for room code:",n),L("no-session");return}const Qt=Yt[0];if(vt)return;if(Qt.status==="ended"){console.log("Session found but already ended"),L("ended"),setTimeout(()=>t("/student-login"),3e3);return}v(Qt.id),L(Qt.status==="active"?"active":"waiting")}catch(Yt){console.error("Error validating session:",Yt),L("no-session"),E.current=null}})(),()=>{vt=!0}},[n,d,a,t]),st.useEffect(()=>{if(!n||!a||!d||!m)return;let vt=null,dt=null,Yt=!0,ae=!1;const Qt=[];return(async()=>{var be;try{vt=new ES.Realtime({authUrl:"/api/token",authParams:{clientId:d}}),vt.connection.on("connected",async()=>{if(Yt)if(C(!0),console.log(" Student connected to Ably"),ae&&dt){console.log(" Reconnected - re-entering presence and syncing state");try{await dt.presence.enter({name:a,studentId:m,isVisible:!document.hidden}),console.log(" Re-entered presence as:",a,"with studentId:",m),setTimeout(()=>{Yt&&(console.log(" Requesting full state (question + annotations)"),dt.publish("request-current-state",{clientId:d,studentId:m,timestamp:Date.now()}))},300)}catch(Re){console.error(" Error during reconnection:",Re)}}else ae=!0}),vt.connection.on("disconnected",()=>{Yt&&C(!1)}),dt=vt.channels.get(`room-${n}`);const Ie=(Re,dn)=>{dt.subscribe(Re,dn),Qt.push({event:Re,handler:dn})};if(Ie("student-layer",()=>{}),Ie("teacher-annotation",Re=>{if(Yt&&(console.log(" Received teacher-annotation event. Target:",Re.data.targetStudentId,"My clientId:",d,"Match:",Re.data.targetStudentId===d),Re.data.targetStudentId===d)){const dn=Re.data.annotations||[];console.log(" ClientId matches! Applying",dn.length,"teacher annotation strokes"),J.current=!0,P(dn),setTimeout(()=>{J.current=!1},100)}}),Ie("sync-full-state",Re=>{if(Yt&&Re.data.targetClientId===d){const{content:dn=null,annotations:Mn=[]}=Re.data;console.log(" Received sync-full-state:",{hasContent:!!dn,annotationCount:Mn.length}),A(dn||null),Mn.length>0&&(console.log(" Applying",Mn.length,"teacher annotations from sync"),J.current=!0,P(Mn),setTimeout(()=>{J.current=!1},100))}}),Ie("clear-all-drawings",Re=>{var dn;Yt&&(console.log(" Received clear-all-drawings with content:",Re.data),(dn=Re.data)!=null&&dn.content?A(Re.data.content):A(null),J.current=!0,N([]),P([]),setTimeout(()=>{J.current=!1},100),Cb().then(()=>{console.log(" Cleared student strokes from IndexedDB")}).catch(Mn=>{console.error("Error clearing IndexedDB:",Mn)}))}),Ie("session-started",()=>{Yt&&L("active")}),Ie("session-ended",()=>{Yt&&(console.log(" Session ended"),L("ended"),t("/student-login"))}),await dt.presence.enter({name:a,studentId:m,isVisible:!document.hidden}),!Yt){await dt.presence.leaveClient(d),vt.close();return}l(dt),setTimeout(()=>{Yt&&dt.publish("request-current-state",{clientId:d,studentId:m,timestamp:Date.now()})},500),performance.navigation.type===1||((be=performance.getEntriesByType("navigation")[0])==null?void 0:be.type)==="reload"?setTimeout(async()=>{if(Yt)try{console.log(" Page refresh detected - loading from IndexedDB + Redis...");const Re=await Eb();Re&&Re.length>0&&(console.log(` Loaded ${Re.length} own strokes from IndexedDB`),J.current=!0,N(Re),setTimeout(()=>{J.current=!1},100));const dn=await fetch(`/api/strokes/load?roomId=${n}&party=teacher`);if(dn.ok){const Mn=await dn.json();Mn.strokes&&Mn.strokes.length>0?(console.log(` Loaded ${Mn.strokes.length} teacher annotations from Redis`),J.current=!0,setTeacherAnnotations(Mn.strokes),setTimeout(()=>{J.current=!1},100)):console.log(" No teacher annotations found in Redis")}}catch(Re){console.error("Error loading strokes on refresh:",Re)}},700):console.log(" Normal page load - skipping persistence restore")}catch(Ie){console.error("Failed to initialize Ably:",Ie)}})(),()=>{if(Yt=!1,dt){Qt.forEach(({event:be,handler:Ie})=>{dt.unsubscribe(be,Ie)});try{dt.presence.leaveClient(d)}catch(be){console.error("Error leaving presence:",be)}}if(l(null),vt)try{vt.close()}catch(be){console.error("Error closing Ably:",be)}}},[d,n,a,t,m]),st.useEffect(()=>{if(!r||Z.current)return;Z.current=!0;const vt=()=>{const dt=!document.hidden;r.presence.update({name:a,studentId:m,isVisible:dt,lastVisibilityChange:Date.now()}),r.publish("student-visibility",{studentId:m,studentName:a,isVisible:dt,timestamp:Date.now()})};return document.addEventListener("visibilitychange",vt),()=>{Z.current=!1,document.removeEventListener("visibilitychange",vt)}},[r,d,a]),st.useEffect(()=>{const vt=wt.current;if(!vt)return;const dt=()=>{if(!wt.current)return;const ae=wt.current.getBoundingClientRect(),Qt=W?16:48,Ae=Math.max(280,ae.width-Qt),be=Math.max(210,ae.height-Qt),Ie=Ae/hu.width,Cn=be/hu.height,Re=Math.min(Ie,Cn),Mn=Math.max(W?.35:cT,Math.min(fT,Re)),Sr=Math.round(Mn*20)/20;ee({width:Math.round(hu.width*Sr),height:Math.round(hu.height*Sr)})};dt(),window.addEventListener("resize",dt);let Yt;return window.ResizeObserver&&(Yt=new ResizeObserver(()=>dt()),Yt.observe(vt)),()=>{window.removeEventListener("resize",dt),Yt&&Yt.disconnect()}},[I,W]);const mn=vt=>Y!=="stylus-only"?!0:(vt==null?void 0:vt.pointerType)==="pen",Yn=vt=>{const dt=vt.evt;if(!mn(dt)){dt!=null&&dt.preventDefault&&dt.preventDefault();return}const Yt=vt.target.getStage();if(Yt&&dt.pointerId!==void 0){const ae=Yt.content;if(ae&&ae.setPointerCapture)try{ae.setPointerCapture(dt.pointerId)}catch{}}if(T==="pen"){X(!0);const ae=Yt.getPointerPosition(),Qt=ae.x/re,Ae=ae.y/re,be={tool:T,points:[Qt,Ae],color:z,strokeWidth:G/re,strokeId:uT()};pe.current=be,at.current.push([...B]),rt.current=[],N([...B,be])}else T==="eraser"&&(X(!0),tt.current=!1);dt.preventDefault&&dt.preventDefault(),dt.stopPropagation&&dt.stopPropagation()},sn=vt=>{if(!Q)return;const dt=vt.evt;if(!mn(dt)){dt!=null&&dt.preventDefault&&dt.preventDefault();return}const ae=vt.target.getStage().getPointerPosition();if(T==="pen"){if(pe.current){const Qt=ae.x/re,Ae=ae.y/re;pe.current.points=pe.current.points.concat([Qt,Ae]);const be=pe.current;rn.current&&cancelAnimationFrame(rn.current),rn.current=requestAnimationFrame(()=>{be&&N(Ie=>Ie.length>0?[...Ie.slice(0,-1),be]:Ie)})}}else if(T==="eraser"){const Qt=B.length,Ae=ae.x,be=ae.y,Ie=20,Cn=B.filter(Re=>{for(let dn=0;dn<Re.points.length;dn+=2){const Mn=Re.points[dn]*re,Sr=Re.points[dn+1]*re;if(Math.sqrt(Math.pow(Mn-Ae,2)+Math.pow(Sr-be,2))<Ie)return!1}return!0});Cn.length<Qt&&!tt.current&&(at.current.push([...B]),rt.current=[],tt.current=!0),N(Cn)}dt!=null&&dt.preventDefault&&dt.preventDefault(),dt!=null&&dt.stopPropagation&&dt.stopPropagation()},Ot=vt=>{const dt=vt==null?void 0:vt.evt;if(!mn(dt)){dt!=null&&dt.preventDefault&&dt.preventDefault();return}if(X(!1),pe.current&&pe.current.strokeId){const Yt=pe.current;setTimeout(async()=>{try{await _b(Yt)}catch(ae){console.error("Error saving stroke to IndexedDB:",ae)}},150)}pe.current=null},Zt=()=>{if(at.current.length>0){const vt=at.current.pop();rt.current.push([...B]),N(vt)}},Ce=()=>{if(rt.current.length>0){const vt=rt.current.pop();at.current.push([...B]),N(vt)}},Ke=()=>{at.current.push([...B]),rt.current=[],N([])},Je=()=>{var vt;return d?((vt=d.split("-")[1])==null?void 0:vt.substring(0,3))||d:"---"},Te=()=>{j(vt=>vt==="stylus-only"?"all":"stylus-only")},lt=()=>{F(vt=>vt==="left"?"right":"left")},Tt=()=>`Connected as ${a&&a!=="Anonymous"?a:Je()}`,Rt=_?"Connected":"Reconnecting",qt=_?"online":"offline",le=vt=>vt.map((dt,Yt)=>dt*re),Bt=vt=>(vt.strokeWidth||3)*re;return!n||!a?null:k.jsxs("div",{className:"student-canvas-page",children:[D==="loading"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-spinner"}),k.jsx("h2",{children:"Connecting to session..."}),k.jsx("p",{children:"Please wait while we verify your session"})]})}),D==="waiting"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:""}),k.jsx("h2",{children:"Waiting for teacher"}),k.jsx("p",{children:"Your teacher hasn't started the session yet. Please wait..."})]})}),D==="no-session"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:""}),k.jsx("h2",{children:"No session found"}),k.jsxs("p",{children:['There is no active session for room code "',n,'".']}),k.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem"},children:"Please make sure your teacher has started a session, or verify the room code is correct."}),k.jsx("button",{onClick:()=>t("/student-login"),style:{marginTop:"1.5rem",padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"transform 0.2s"},onMouseEnter:vt=>vt.target.style.transform="scale(1.05)",onMouseLeave:vt=>vt.target.style.transform="scale(1)",children:"Back to Login"})]})}),D==="ended"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon ended",children:""}),k.jsx("h2",{children:"Session ended"}),k.jsx("p",{children:"Thank you for participating! The teacher has ended this session."}),k.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",opacity:.8},children:"Redirecting to login..."})]})}),k.jsxs("div",{className:"student-canvas-container",children:[k.jsxs("div",{className:"student-status-bar",children:[k.jsxs("div",{className:"student-status-text",children:[k.jsxs("h1",{children:["Student Canvas",n&&k.jsxs("span",{style:{marginLeft:"0.75rem",fontSize:"0.75rem",fontWeight:"400",color:"rgba(0, 0, 0, 0.4)",letterSpacing:"0.5px"},children:["Session: ",n]})]}),k.jsx("p",{children:Tt()})]}),k.jsxs("div",{className:"student-status-actions",children:[!W&&k.jsxs(k.Fragment,{children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:T==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",Y==="all"?"All inputs":"Stylus only"]})}),k.jsxs("div",{className:`connection-pill ${qt}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:Rt})]}),k.jsxs("button",{className:"move-toolbar-btn",onClick:lt,children:["Move toolbar to ",I==="left"?"right":"left"]})]}),W&&k.jsxs("div",{className:`connection-pill ${qt}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:Rt})]})]})]}),k.jsxs("div",{className:`student-workspace ${I==="right"?"toolbar-right":""} ${W?"mobile-view":""}`,children:[W?k.jsxs("div",{className:"mobile-toolbar",children:[k.jsxs("div",{className:"mobile-colors",children:[k.jsx("button",{onClick:()=>U("black"),className:`mobile-color-button ${z==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>U("#0066FF"),className:`mobile-color-button ${z==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>U("#00AA00"),className:`mobile-color-button ${z==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>y("pen"),className:`mobile-tool-button ${T==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(vb,{size:20})}),k.jsx("button",{onClick:()=>y("eraser"),className:`mobile-tool-button ${T==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(mb,{size:20})}),k.jsx("button",{onClick:Zt,className:"mobile-tool-button",disabled:at.current.length===0,"aria-label":"Undo",children:k.jsx(bb,{size:20})}),k.jsx("button",{onClick:Ce,className:"mobile-tool-button",disabled:rt.current.length===0,"aria-label":"Redo",children:k.jsx(yb,{size:20})}),k.jsx("button",{onClick:Ke,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(Sb,{size:20})})]})]}):k.jsxs("div",{className:"student-sidebar",children:[k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsxs("div",{className:"color-buttons",children:[k.jsx("button",{onClick:()=>U("black"),className:`color-button ${z==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>U("#0066FF"),className:`color-button ${z==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>U("#00AA00"),className:`color-button ${z==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>y("pen"),className:`tool-icon-button ${T==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>y("eraser"),className:`tool-icon-button ${T==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsx("div",{className:"brush-size-control",children:k.jsxs("div",{className:"brush-slider-container",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:G,onChange:vt=>K(parseInt(vt.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:G})]})})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${Y==="all"?"all-inputs":""}`,onClick:Te,children:Y==="stylus-only"?"Stylus mode (pen only)":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:Zt,className:"history-button",disabled:at.current.length===0,children:"Undo"}),k.jsx("button",{onClick:Ce,className:"history-button",disabled:rt.current.length===0,children:"Redo"}),k.jsx("button",{onClick:Ke,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"student-canvas-panel",ref:wt,children:k.jsx("div",{className:"student-canvas-frame",children:k.jsx("div",{className:"student-canvas-surface",style:{width:`${kt.width}px`,height:`${kt.height}px`},children:k.jsxs(Ug,{ref:jt,width:kt.width,height:kt.height,onPointerDown:Yn,onPointerMove:sn,onPointerUp:Ot,onPointerLeave:Ot,onTouchStart:vt=>{var dt,Yt;(Yt=(dt=vt.evt)==null?void 0:dt.preventDefault)==null||Yt.call(dt)},onTouchMove:vt=>{var dt,Yt;(Yt=(dt=vt.evt)==null?void 0:dt.preventDefault)==null||Yt.call(dt)},onTouchEnd:vt=>{var dt,Yt;(Yt=(dt=vt.evt)==null?void 0:dt.preventDefault)==null||Yt.call(dt)},className:"canvas-stage",style:{touchAction:"none"},perfectDrawEnabled:!1,children:[k.jsx(Kr,{listening:!1,children:k.jsx(dT,{sharedImage:O,canvasWidth:kt.width,canvasHeight:kt.height})}),k.jsx(Kr,{children:B.map((vt,dt)=>k.jsx(pl,{points:le(vt.points),stroke:vt.color,strokeWidth:Bt(vt),tension:.5,lineCap:"round",lineJoin:"round"},`student-${dt}`))}),k.jsx(Kr,{listening:!1,children:M.map((vt,dt)=>k.jsx(pl,{points:le(vt.points),stroke:vt.color,strokeWidth:Bt(vt),tension:.5,lineCap:"round",lineJoin:"round"},`teacher-${dt}`))})]})})})})]})]})]})}const K1="Feather_username";function gT(){const[o]=Sh(),t=yf(),[n,a]=st.useState(""),[r,l]=st.useState(""),[f,d]=st.useState(""),[g,m]=st.useState(!1);st.useEffect(()=>{const C=localStorage.getItem(K1);C&&a(C);const E=o.get("room");E&&l(E.toUpperCase())},[o]);const _=async C=>{if(C.preventDefault(),!n.trim()){d("Please enter your name");return}if(!r.trim()){d("Please enter a session code");return}m(!0),d(""),localStorage.setItem(K1,n.trim());try{const E=(await Ru(async()=>{const{default:B}=await Promise.resolve().then(()=>vT);return{default:B}},void 0)).default,R=new E.Realtime({authUrl:"/api/token",authParams:{clientId:`ping-${Date.now()}`}});await new Promise((B,N)=>{const M=setTimeout(()=>N(new Error("Connection timeout")),8e3);R.connection.once("connected",()=>{clearTimeout(M),B()}),R.connection.once("failed",()=>{clearTimeout(M),N(new Error("Connection failed"))})});const L=(await R.channels.get(`room-${r.trim().toUpperCase()}`).presence.get()).some(B=>B.clientId.startsWith("teacher-"));if(R.close(),!L){d("No active teacher found. Please check your session code."),m(!1);return}t(`/student?room=${r.trim().toUpperCase()}&name=${encodeURIComponent(n.trim())}`)}catch(E){console.error("Failed to connect:",E),d("Failed to connect to session. Please try again."),m(!1)}};return k.jsx("div",{className:"student-login-page",children:k.jsxs("div",{className:"student-login-card",children:[k.jsx("h1",{children:"Student Login"}),k.jsx("p",{className:"login-subtitle",children:"Join your classroom session to start drawing."}),k.jsxs("form",{onSubmit:_,children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"name",children:"Name"}),k.jsx("input",{id:"name",type:"text",placeholder:"Your name",value:n,onChange:C=>{a(C.target.value),d("")},autoFocus:!0,maxLength:50})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"sessionCode",children:"Session code"}),k.jsx("input",{id:"sessionCode",type:"text",placeholder:"SESSION CODE (E.G., ABC123)",value:r,onChange:C=>{l(C.target.value.toUpperCase()),d("")},maxLength:10})]}),f&&k.jsx("div",{className:"login-error",children:f}),k.jsx("button",{type:"submit",className:"join-button",disabled:g,children:g?"Checking session...":"Join Session"})]})]})})}var $p,Q1;function pT(){if(Q1)return $p;Q1=1;function o(l){return typeof l=="string"&&(l=l.indexOf(":")==-1?{token:l}:{key:l}),l.promises=!0,l}var t=_S(),n=function(l,f,d,g){return new t.ErrorInfo(l,f,d,g)},a=function(l){return new t.Rest(o(l))};Object.assign(a,t.Rest);var r=function(l){return new t.Realtime(o(l))};return Object.assign(r,t.Realtime),$p={ErrorInfo:n,Rest:a,Realtime:r},$p}var mT=pT();const vv=pf(mT),vT=Object.freeze(Object.defineProperty({__proto__:null,default:vv},Symbol.toStringTag,{value:"Module"}));var af={},tm,X1;function yT(){return X1||(X1=1,tm=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),tm}var em={},ll={},F1;function xu(){if(F1)return ll;F1=1;let o;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ll.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17},ll.getSymbolTotalCodewords=function(a){return t[a]},ll.getBCHDigit=function(n){let a=0;for(;n!==0;)a++,n>>>=1;return a},ll.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');o=a},ll.isKanjiModeEnabled=function(){return typeof o<"u"},ll.toSJIS=function(a){return o(a)},ll}var nm={},J1;function yv(){return J1||(J1=1,(function(o){o.L={bit:1},o.M={bit:0},o.Q={bit:3},o.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return o.L;case"m":case"medium":return o.M;case"q":case"quartile":return o.Q;case"h":case"high":return o.H;default:throw new Error("Unknown EC Level: "+n)}}o.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},o.from=function(a,r){if(o.isValid(a))return a;try{return t(a)}catch{return r}}})(nm)),nm}var am,Z1;function ST(){if(Z1)return am;Z1=1;function o(){this.buffer=[],this.length=0}return o.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let a=0;a<n;a++)this.putBit((t>>>n-a-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},am=o,am}var im,W1;function bT(){if(W1)return im;W1=1;function o(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return o.prototype.set=function(t,n,a,r){const l=t*this.size+n;this.data[l]=a,r&&(this.reservedBit[l]=!0)},o.prototype.get=function(t,n){return this.data[t*this.size+n]},o.prototype.xor=function(t,n,a){this.data[t*this.size+n]^=a},o.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},im=o,im}var rm={},$1;function _T(){return $1||($1=1,(function(o){const t=xu().getSymbolSize;o.getRowColCoords=function(a){if(a===1)return[];const r=Math.floor(a/7)+2,l=t(a),f=l===145?26:Math.ceil((l-13)/(2*r-2))*2,d=[l-7];for(let g=1;g<r-1;g++)d[g]=d[g-1]-f;return d.push(6),d.reverse()},o.getPositions=function(a){const r=[],l=o.getRowColCoords(a),f=l.length;for(let d=0;d<f;d++)for(let g=0;g<f;g++)d===0&&g===0||d===0&&g===f-1||d===f-1&&g===0||r.push([l[d],l[g]]);return r}})(rm)),rm}var sm={},t2;function ET(){if(t2)return sm;t2=1;const o=xu().getSymbolSize,t=7;return sm.getPositions=function(a){const r=o(a);return[[0,0],[r-t,0],[0,r-t]]},sm}var om={},e2;function CT(){return e2||(e2=1,(function(o){o.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};o.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},o.from=function(r){return o.isValid(r)?parseInt(r,10):void 0},o.getPenaltyN1=function(r){const l=r.size;let f=0,d=0,g=0,m=null,_=null;for(let C=0;C<l;C++){d=g=0,m=_=null;for(let E=0;E<l;E++){let R=r.get(C,E);R===m?d++:(d>=5&&(f+=t.N1+(d-5)),m=R,d=1),R=r.get(E,C),R===_?g++:(g>=5&&(f+=t.N1+(g-5)),_=R,g=1)}d>=5&&(f+=t.N1+(d-5)),g>=5&&(f+=t.N1+(g-5))}return f},o.getPenaltyN2=function(r){const l=r.size;let f=0;for(let d=0;d<l-1;d++)for(let g=0;g<l-1;g++){const m=r.get(d,g)+r.get(d,g+1)+r.get(d+1,g)+r.get(d+1,g+1);(m===4||m===0)&&f++}return f*t.N2},o.getPenaltyN3=function(r){const l=r.size;let f=0,d=0,g=0;for(let m=0;m<l;m++){d=g=0;for(let _=0;_<l;_++)d=d<<1&2047|r.get(m,_),_>=10&&(d===1488||d===93)&&f++,g=g<<1&2047|r.get(_,m),_>=10&&(g===1488||g===93)&&f++}return f*t.N3},o.getPenaltyN4=function(r){let l=0;const f=r.data.length;for(let g=0;g<f;g++)l+=r.data[g];return Math.abs(Math.ceil(l*100/f/5)-10)*t.N4};function n(a,r,l){switch(a){case o.Patterns.PATTERN000:return(r+l)%2===0;case o.Patterns.PATTERN001:return r%2===0;case o.Patterns.PATTERN010:return l%3===0;case o.Patterns.PATTERN011:return(r+l)%3===0;case o.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(l/3))%2===0;case o.Patterns.PATTERN101:return r*l%2+r*l%3===0;case o.Patterns.PATTERN110:return(r*l%2+r*l%3)%2===0;case o.Patterns.PATTERN111:return(r*l%3+(r+l)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}o.applyMask=function(r,l){const f=l.size;for(let d=0;d<f;d++)for(let g=0;g<f;g++)l.isReserved(g,d)||l.xor(g,d,n(r,g,d))},o.getBestMask=function(r,l){const f=Object.keys(o.Patterns).length;let d=0,g=1/0;for(let m=0;m<f;m++){l(m),o.applyMask(m,r);const _=o.getPenaltyN1(r)+o.getPenaltyN2(r)+o.getPenaltyN3(r)+o.getPenaltyN4(r);o.applyMask(m,r),_<g&&(g=_,d=m)}return d}})(om)),om}var gg={},n2;function Tb(){if(n2)return gg;n2=1;const o=yv(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return gg.getBlocksCount=function(r,l){switch(l){case o.L:return t[(r-1)*4+0];case o.M:return t[(r-1)*4+1];case o.Q:return t[(r-1)*4+2];case o.H:return t[(r-1)*4+3];default:return}},gg.getTotalCodewordsCount=function(r,l){switch(l){case o.L:return n[(r-1)*4+0];case o.M:return n[(r-1)*4+1];case o.Q:return n[(r-1)*4+2];case o.H:return n[(r-1)*4+3];default:return}},gg}var lm={},Zd={},a2;function TT(){if(a2)return Zd;a2=1;const o=new Uint8Array(512),t=new Uint8Array(256);return(function(){let a=1;for(let r=0;r<255;r++)o[r]=a,t[a]=r,a<<=1,a&256&&(a^=285);for(let r=255;r<512;r++)o[r]=o[r-255]})(),Zd.log=function(a){if(a<1)throw new Error("log("+a+")");return t[a]},Zd.exp=function(a){return o[a]},Zd.mul=function(a,r){return a===0||r===0?0:o[t[a]+t[r]]},Zd}var i2;function AT(){return i2||(i2=1,(function(o){const t=TT();o.mul=function(a,r){const l=new Uint8Array(a.length+r.length-1);for(let f=0;f<a.length;f++)for(let d=0;d<r.length;d++)l[f+d]^=t.mul(a[f],r[d]);return l},o.mod=function(a,r){let l=new Uint8Array(a);for(;l.length-r.length>=0;){const f=l[0];for(let g=0;g<r.length;g++)l[g]^=t.mul(r[g],f);let d=0;for(;d<l.length&&l[d]===0;)d++;l=l.slice(d)}return l},o.generateECPolynomial=function(a){let r=new Uint8Array([1]);for(let l=0;l<a;l++)r=o.mul(r,new Uint8Array([1,t.exp(l)]));return r}})(lm)),lm}var um,r2;function wT(){if(r2)return um;r2=1;const o=AT();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(a){this.degree=a,this.genPoly=o.generateECPolynomial(this.degree)},t.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(a.length+this.degree);r.set(a);const l=o.mod(r,this.genPoly),f=this.degree-l.length;if(f>0){const d=new Uint8Array(this.degree);return d.set(l,f),d}return l},um=t,um}var cm={},fm={},dm={},s2;function Ab(){return s2||(s2=1,dm.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),dm}var Es={},o2;function wb(){if(o2)return Es;o2=1;const o="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Es.KANJI=new RegExp(n,"g"),Es.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Es.BYTE=new RegExp(a,"g"),Es.NUMERIC=new RegExp(o,"g"),Es.ALPHANUMERIC=new RegExp(t,"g");const r=new RegExp("^"+n+"$"),l=new RegExp("^"+o+"$"),f=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Es.testKanji=function(g){return r.test(g)},Es.testNumeric=function(g){return l.test(g)},Es.testAlphanumeric=function(g){return f.test(g)},Es}var l2;function Mu(){return l2||(l2=1,(function(o){const t=Ab(),n=wb();o.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},o.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},o.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},o.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},o.MIXED={bit:-1},o.getCharCountIndicator=function(l,f){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!t.isValid(f))throw new Error("Invalid version: "+f);return f>=1&&f<10?l.ccBits[0]:f<27?l.ccBits[1]:l.ccBits[2]},o.getBestModeForData=function(l){return n.testNumeric(l)?o.NUMERIC:n.testAlphanumeric(l)?o.ALPHANUMERIC:n.testKanji(l)?o.KANJI:o.BYTE},o.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},o.isValid=function(l){return l&&l.bit&&l.ccBits};function a(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return o.NUMERIC;case"alphanumeric":return o.ALPHANUMERIC;case"kanji":return o.KANJI;case"byte":return o.BYTE;default:throw new Error("Unknown mode: "+r)}}o.from=function(l,f){if(o.isValid(l))return l;try{return a(l)}catch{return f}}})(fm)),fm}var u2;function RT(){return u2||(u2=1,(function(o){const t=xu(),n=Tb(),a=yv(),r=Mu(),l=Ab(),f=7973,d=t.getBCHDigit(f);function g(E,R,v){for(let D=1;D<=40;D++)if(R<=o.getCapacity(D,v,E))return D}function m(E,R){return r.getCharCountIndicator(E,R)+4}function _(E,R){let v=0;return E.forEach(function(D){const L=m(D.mode,R);v+=L+D.getBitsLength()}),v}function C(E,R){for(let v=1;v<=40;v++)if(_(E,v)<=o.getCapacity(v,R,r.MIXED))return v}o.from=function(R,v){return l.isValid(R)?parseInt(R,10):v},o.getCapacity=function(R,v,D){if(!l.isValid(R))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=r.BYTE);const L=t.getSymbolTotalCodewords(R),B=n.getTotalCodewordsCount(R,v),N=(L-B)*8;if(D===r.MIXED)return N;const M=N-m(D,R);switch(D){case r.NUMERIC:return Math.floor(M/10*3);case r.ALPHANUMERIC:return Math.floor(M/11*2);case r.KANJI:return Math.floor(M/13);case r.BYTE:default:return Math.floor(M/8)}},o.getBestVersionForData=function(R,v){let D;const L=a.from(v,a.M);if(Array.isArray(R)){if(R.length>1)return C(R,L);if(R.length===0)return 1;D=R[0]}else D=R;return g(D.mode,D.getLength(),L)},o.getEncodedBits=function(R){if(!l.isValid(R)||R<7)throw new Error("Invalid QR Code version");let v=R<<12;for(;t.getBCHDigit(v)-d>=0;)v^=f<<t.getBCHDigit(v)-d;return R<<12|v}})(cm)),cm}var hm={},c2;function OT(){if(c2)return hm;c2=1;const o=xu(),t=1335,n=21522,a=o.getBCHDigit(t);return hm.getEncodedBits=function(l,f){const d=l.bit<<3|f;let g=d<<10;for(;o.getBCHDigit(g)-a>=0;)g^=t<<o.getBCHDigit(g)-a;return(d<<10|g)^n},hm}var gm={},pm,f2;function xT(){if(f2)return pm;f2=1;const o=Mu();function t(n){this.mode=o.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(a){let r,l,f;for(r=0;r+3<=this.data.length;r+=3)l=this.data.substr(r,3),f=parseInt(l,10),a.put(f,10);const d=this.data.length-r;d>0&&(l=this.data.substr(r),f=parseInt(l,10),a.put(f,d*3+1))},pm=t,pm}var mm,d2;function MT(){if(d2)return mm;d2=1;const o=Mu(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(a){this.mode=o.ALPHANUMERIC,this.data=a}return n.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let l;for(l=0;l+2<=this.data.length;l+=2){let f=t.indexOf(this.data[l])*45;f+=t.indexOf(this.data[l+1]),r.put(f,11)}this.data.length%2&&r.put(t.indexOf(this.data[l]),6)},mm=n,mm}var vm,h2;function NT(){if(h2)return vm;h2=1;const o=Mu();function t(n){this.mode=o.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(a){return a*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let a=0,r=this.data.length;a<r;a++)n.put(this.data[a],8)},vm=t,vm}var ym,g2;function DT(){if(g2)return ym;g2=1;const o=Mu(),t=xu();function n(a){this.mode=o.KANJI,this.data=a}return n.getBitsLength=function(r){return r*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(a){let r;for(r=0;r<this.data.length;r++){let l=t.toSJIS(this.data[r]);if(l>=33088&&l<=40956)l-=33088;else if(l>=57408&&l<=60351)l-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);l=(l>>>8&255)*192+(l&255),a.put(l,13)}},ym=n,ym}var Sm={exports:{}},p2;function jT(){return p2||(p2=1,(function(o){var t={single_source_shortest_paths:function(n,a,r){var l={},f={};f[a]=0;var d=t.PriorityQueue.make();d.push(a,0);for(var g,m,_,C,E,R,v,D,L;!d.empty();){g=d.pop(),m=g.value,C=g.cost,E=n[m]||{};for(_ in E)E.hasOwnProperty(_)&&(R=E[_],v=C+R,D=f[_],L=typeof f[_]>"u",(L||D>v)&&(f[_]=v,d.push(_,v),l[_]=m))}if(typeof r<"u"&&typeof f[r]>"u"){var B=["Could not find a path from ",a," to ",r,"."].join("");throw new Error(B)}return l},extract_shortest_path_from_predecessor_list:function(n,a){for(var r=[],l=a;l;)r.push(l),n[l],l=n[l];return r.reverse(),r},find_path:function(n,a,r){var l=t.single_source_shortest_paths(n,a,r);return t.extract_shortest_path_from_predecessor_list(l,r)},PriorityQueue:{make:function(n){var a=t.PriorityQueue,r={},l;n=n||{};for(l in a)a.hasOwnProperty(l)&&(r[l]=a[l]);return r.queue=[],r.sorter=n.sorter||a.default_sorter,r},default_sorter:function(n,a){return n.cost-a.cost},push:function(n,a){var r={value:n,cost:a};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};o.exports=t})(Sm)),Sm.exports}var m2;function UT(){return m2||(m2=1,(function(o){const t=Mu(),n=xT(),a=MT(),r=NT(),l=DT(),f=wb(),d=xu(),g=jT();function m(B){return unescape(encodeURIComponent(B)).length}function _(B,N,M){const P=[];let O;for(;(O=B.exec(M))!==null;)P.push({data:O[0],index:O.index,mode:N,length:O[0].length});return P}function C(B){const N=_(f.NUMERIC,t.NUMERIC,B),M=_(f.ALPHANUMERIC,t.ALPHANUMERIC,B);let P,O;return d.isKanjiModeEnabled()?(P=_(f.BYTE,t.BYTE,B),O=_(f.KANJI,t.KANJI,B)):(P=_(f.BYTE_KANJI,t.BYTE,B),O=[]),N.concat(M,P,O).sort(function(T,y){return T.index-y.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function E(B,N){switch(N){case t.NUMERIC:return n.getBitsLength(B);case t.ALPHANUMERIC:return a.getBitsLength(B);case t.KANJI:return l.getBitsLength(B);case t.BYTE:return r.getBitsLength(B)}}function R(B){return B.reduce(function(N,M){const P=N.length-1>=0?N[N.length-1]:null;return P&&P.mode===M.mode?(N[N.length-1].data+=M.data,N):(N.push(M),N)},[])}function v(B){const N=[];for(let M=0;M<B.length;M++){const P=B[M];switch(P.mode){case t.NUMERIC:N.push([P,{data:P.data,mode:t.ALPHANUMERIC,length:P.length},{data:P.data,mode:t.BYTE,length:P.length}]);break;case t.ALPHANUMERIC:N.push([P,{data:P.data,mode:t.BYTE,length:P.length}]);break;case t.KANJI:N.push([P,{data:P.data,mode:t.BYTE,length:m(P.data)}]);break;case t.BYTE:N.push([{data:P.data,mode:t.BYTE,length:m(P.data)}])}}return N}function D(B,N){const M={},P={start:{}};let O=["start"];for(let A=0;A<B.length;A++){const T=B[A],y=[];for(let z=0;z<T.length;z++){const U=T[z],G=""+A+z;y.push(G),M[G]={node:U,lastCount:0},P[G]={};for(let K=0;K<O.length;K++){const Q=O[K];M[Q]&&M[Q].node.mode===U.mode?(P[Q][G]=E(M[Q].lastCount+U.length,U.mode)-E(M[Q].lastCount,U.mode),M[Q].lastCount+=U.length):(M[Q]&&(M[Q].lastCount=U.length),P[Q][G]=E(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,N))}}O=y}for(let A=0;A<O.length;A++)P[O[A]].end=0;return{map:P,table:M}}function L(B,N){let M;const P=t.getBestModeForData(B);if(M=t.from(N,P),M!==t.BYTE&&M.bit<P.bit)throw new Error('"'+B+'" cannot be encoded with mode '+t.toString(M)+`.
 Suggested mode is: `+t.toString(P));switch(M===t.KANJI&&!d.isKanjiModeEnabled()&&(M=t.BYTE),M){case t.NUMERIC:return new n(B);case t.ALPHANUMERIC:return new a(B);case t.KANJI:return new l(B);case t.BYTE:return new r(B)}}o.fromArray=function(N){return N.reduce(function(M,P){return typeof P=="string"?M.push(L(P,null)):P.data&&M.push(L(P.data,P.mode)),M},[])},o.fromString=function(N,M){const P=C(N,d.isKanjiModeEnabled()),O=v(P),A=D(O,M),T=g.find_path(A.map,"start","end"),y=[];for(let z=1;z<T.length-1;z++)y.push(A.table[T[z]].node);return o.fromArray(R(y))},o.rawSplit=function(N){return o.fromArray(C(N,d.isKanjiModeEnabled()))}})(gm)),gm}var v2;function BT(){if(v2)return em;v2=1;const o=xu(),t=yv(),n=ST(),a=bT(),r=_T(),l=ET(),f=CT(),d=Tb(),g=wT(),m=RT(),_=OT(),C=Mu(),E=UT();function R(A,T){const y=A.size,z=l.getPositions(T);for(let U=0;U<z.length;U++){const G=z[U][0],K=z[U][1];for(let Q=-1;Q<=7;Q++)if(!(G+Q<=-1||y<=G+Q))for(let X=-1;X<=7;X++)K+X<=-1||y<=K+X||(Q>=0&&Q<=6&&(X===0||X===6)||X>=0&&X<=6&&(Q===0||Q===6)||Q>=2&&Q<=4&&X>=2&&X<=4?A.set(G+Q,K+X,!0,!0):A.set(G+Q,K+X,!1,!0))}}function v(A){const T=A.size;for(let y=8;y<T-8;y++){const z=y%2===0;A.set(y,6,z,!0),A.set(6,y,z,!0)}}function D(A,T){const y=r.getPositions(T);for(let z=0;z<y.length;z++){const U=y[z][0],G=y[z][1];for(let K=-2;K<=2;K++)for(let Q=-2;Q<=2;Q++)K===-2||K===2||Q===-2||Q===2||K===0&&Q===0?A.set(U+K,G+Q,!0,!0):A.set(U+K,G+Q,!1,!0)}}function L(A,T){const y=A.size,z=m.getEncodedBits(T);let U,G,K;for(let Q=0;Q<18;Q++)U=Math.floor(Q/3),G=Q%3+y-8-3,K=(z>>Q&1)===1,A.set(U,G,K,!0),A.set(G,U,K,!0)}function B(A,T,y){const z=A.size,U=_.getEncodedBits(T,y);let G,K;for(G=0;G<15;G++)K=(U>>G&1)===1,G<6?A.set(G,8,K,!0):G<8?A.set(G+1,8,K,!0):A.set(z-15+G,8,K,!0),G<8?A.set(8,z-G-1,K,!0):G<9?A.set(8,15-G-1+1,K,!0):A.set(8,15-G-1,K,!0);A.set(z-8,8,1,!0)}function N(A,T){const y=A.size;let z=-1,U=y-1,G=7,K=0;for(let Q=y-1;Q>0;Q-=2)for(Q===6&&Q--;;){for(let X=0;X<2;X++)if(!A.isReserved(U,Q-X)){let Y=!1;K<T.length&&(Y=(T[K]>>>G&1)===1),A.set(U,Q-X,Y),G--,G===-1&&(K++,G=7)}if(U+=z,U<0||y<=U){U-=z,z=-z;break}}}function M(A,T,y){const z=new n;y.forEach(function(X){z.put(X.mode.bit,4),z.put(X.getLength(),C.getCharCountIndicator(X.mode,A)),X.write(z)});const U=o.getSymbolTotalCodewords(A),G=d.getTotalCodewordsCount(A,T),K=(U-G)*8;for(z.getLengthInBits()+4<=K&&z.put(0,4);z.getLengthInBits()%8!==0;)z.putBit(0);const Q=(K-z.getLengthInBits())/8;for(let X=0;X<Q;X++)z.put(X%2?17:236,8);return P(z,A,T)}function P(A,T,y){const z=o.getSymbolTotalCodewords(T),U=d.getTotalCodewordsCount(T,y),G=z-U,K=d.getBlocksCount(T,y),Q=z%K,X=K-Q,Y=Math.floor(z/K),j=Math.floor(G/K),I=j+1,F=Y-j,W=new g(F);let it=0;const Z=new Array(K),at=new Array(K);let rt=0;const V=new Uint8Array(A.buffer);for(let wt=0;wt<K;wt++){const jt=wt<X?j:I;Z[wt]=V.slice(it,it+jt),at[wt]=W.encode(Z[wt]),it+=jt,rt=Math.max(rt,jt)}const J=new Uint8Array(z);let tt=0,nt,ht;for(nt=0;nt<rt;nt++)for(ht=0;ht<K;ht++)nt<Z[ht].length&&(J[tt++]=Z[ht][nt]);for(nt=0;nt<F;nt++)for(ht=0;ht<K;ht++)J[tt++]=at[ht][nt];return J}function O(A,T,y,z){let U;if(Array.isArray(A))U=E.fromArray(A);else if(typeof A=="string"){let Y=T;if(!Y){const j=E.rawSplit(A);Y=m.getBestVersionForData(j,y)}U=E.fromString(A,Y||40)}else throw new Error("Invalid data");const G=m.getBestVersionForData(U,y);if(!G)throw new Error("The amount of data is too big to be stored in a QR Code");if(!T)T=G;else if(T<G)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+G+`.
`);const K=M(T,y,U),Q=o.getSymbolSize(T),X=new a(Q);return R(X,T),v(X),D(X,T),B(X,y,0),T>=7&&L(X,T),N(X,K),isNaN(z)&&(z=f.getBestMask(X,B.bind(null,X,y))),f.applyMask(z,X),B(X,y,z),{modules:X,version:T,errorCorrectionLevel:y,maskPattern:z,segments:U}}return em.create=function(T,y){if(typeof T>"u"||T==="")throw new Error("No input text");let z=t.M,U,G;return typeof y<"u"&&(z=t.from(y.errorCorrectionLevel,t.M),U=m.from(y.version),G=f.from(y.maskPattern),y.toSJISFunc&&o.setToSJISFunction(y.toSJISFunc)),O(T,U,z,G)},em}var bm={},_m={},y2;function Rb(){return y2||(y2=1,(function(o){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let a=n.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+n);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(l){return[l,l]}))),a.length===6&&a.push("F","F");const r=parseInt(a.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+a.slice(0,6).join("")}}o.getOptions=function(a){a||(a={}),a.color||(a.color={});const r=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,l=a.width&&a.width>=21?a.width:void 0,f=a.scale||4;return{width:l,scale:l?4:f,margin:r,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},o.getScale=function(a,r){return r.width&&r.width>=a+r.margin*2?r.width/(a+r.margin*2):r.scale},o.getImageWidth=function(a,r){const l=o.getScale(a,r);return Math.floor((a+r.margin*2)*l)},o.qrToImageData=function(a,r,l){const f=r.modules.size,d=r.modules.data,g=o.getScale(f,l),m=Math.floor((f+l.margin*2)*g),_=l.margin*g,C=[l.color.light,l.color.dark];for(let E=0;E<m;E++)for(let R=0;R<m;R++){let v=(E*m+R)*4,D=l.color.light;if(E>=_&&R>=_&&E<m-_&&R<m-_){const L=Math.floor((E-_)/g),B=Math.floor((R-_)/g);D=C[d[L*f+B]?1:0]}a[v++]=D.r,a[v++]=D.g,a[v++]=D.b,a[v]=D.a}}})(_m)),_m}var S2;function zT(){return S2||(S2=1,(function(o){const t=Rb();function n(r,l,f){r.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=f,l.width=f,l.style.height=f+"px",l.style.width=f+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}o.render=function(l,f,d){let g=d,m=f;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),f||(m=a()),g=t.getOptions(g);const _=t.getImageWidth(l.modules.size,g),C=m.getContext("2d"),E=C.createImageData(_,_);return t.qrToImageData(E.data,l,g),n(C,m,_),C.putImageData(E,0,0),m},o.renderToDataURL=function(l,f,d){let g=d;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),g||(g={});const m=o.render(l,f,g),_=g.type||"image/png",C=g.rendererOpts||{};return m.toDataURL(_,C.quality)}})(bm)),bm}var Em={},b2;function LT(){if(b2)return Em;b2=1;const o=Rb();function t(r,l){const f=r.a/255,d=l+'="'+r.hex+'"';return f<1?d+" "+l+'-opacity="'+f.toFixed(2).slice(1)+'"':d}function n(r,l,f){let d=r+l;return typeof f<"u"&&(d+=" "+f),d}function a(r,l,f){let d="",g=0,m=!1,_=0;for(let C=0;C<r.length;C++){const E=Math.floor(C%l),R=Math.floor(C/l);!E&&!m&&(m=!0),r[C]?(_++,C>0&&E>0&&r[C-1]||(d+=m?n("M",E+f,.5+R+f):n("m",g,0),g=0,m=!1),E+1<l&&r[C+1]||(d+=n("h",_),_=0)):g++}return d}return Em.render=function(l,f,d){const g=o.getOptions(f),m=l.modules.size,_=l.modules.data,C=m+g.margin*2,E=g.color.light.a?"<path "+t(g.color.light,"fill")+' d="M0 0h'+C+"v"+C+'H0z"/>':"",R="<path "+t(g.color.dark,"stroke")+' d="'+a(_,m,g.margin)+'"/>',v='viewBox="0 0 '+C+" "+C+'"',L='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+v+' shape-rendering="crispEdges">'+E+R+`</svg>
`;return typeof d=="function"&&d(null,L),L},Em}var _2;function PT(){if(_2)return af;_2=1;const o=yT(),t=BT(),n=zT(),a=LT();function r(l,f,d,g,m){const _=[].slice.call(arguments,1),C=_.length,E=typeof _[C-1]=="function";if(!E&&!o())throw new Error("Callback required as last argument");if(E){if(C<2)throw new Error("Too few arguments provided");C===2?(m=d,d=f,f=g=void 0):C===3&&(f.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=d,d=f,f=void 0))}else{if(C<1)throw new Error("Too few arguments provided");return C===1?(d=f,f=g=void 0):C===2&&!f.getContext&&(g=d,d=f,f=void 0),new Promise(function(R,v){try{const D=t.create(d,g);R(l(D,f,g))}catch(D){v(D)}})}try{const R=t.create(d,g);m(null,l(R,f,g))}catch(R){m(R)}}return af.create=t.create,af.toCanvas=r.bind(null,n.render),af.toDataURL=r.bind(null,n.renderToDataURL),af.toString=r.bind(null,function(l,f,d){return a.render(l,d)}),af}var GT=PT();const Ob=pf(GT),xb=({active:o=!1,size:t=20})=>{const n=o?"#ff4d4f":"#b8c1cc",a=o?"#ff4d4f":"transparent";return k.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[k.jsx("path",{d:"M5 2.5V17.5",stroke:n,strokeWidth:"1.6",strokeLinecap:"round"}),k.jsx("path",{d:"M5 3h10l-2 3 2 3H5V3Z",fill:a,stroke:n,strokeWidth:"1.4",strokeLinejoin:"round"})]})},Mb=({student:o,onClick:t,onToggleFlag:n,teacherAnnotations:a=[],sharedImage:r,hideNames:l=!1})=>{var P,O,A,T;const f=st.useRef(null),d=st.useRef(null),[g,m]=st.useState(null),[_,C]=st.useState(300);st.useEffect(()=>{if(!r){m(null);return}const y=new window.Image;y.src=r.dataUrl,y.onload=()=>{m(y)}},[r]),st.useEffect(()=>{if(!d.current)return;const y=()=>{d.current&&C(d.current.clientWidth)};y();const z=new ResizeObserver(y);return z.observe(d.current),()=>z.disconnect()},[]);const E=()=>{if(o!=null&&o.name)return o.name;if(!(o!=null&&o.clientId))return"Unknown Student";const y=o.clientId.match(/student-(\d+)/);return y?`Student ${y[1]}`:o.clientId},R=()=>{if(!o.lastUpdate)return"Just joined";const y=Math.floor((Date.now()-o.lastUpdate)/1e3);return y<5?"Just now":y<60?`${y}s ago`:`${Math.floor(y/60)}m ago`},v=((O=(P=o.meta)==null?void 0:P.base)==null?void 0:O.width)||800,D=((T=(A=o.meta)==null?void 0:A.base)==null?void 0:T.height)||600,L=_/v,B=y=>{y.stopPropagation(),n&&n(o.clientId)},M=(()=>{if(!r||!g)return null;const y=r.width/r.height,z=v/D;let U,G,K,Q;return y>z?(U=v,G=v/y,K=0,Q=(D-G)/2):(G=D,U=D*y,K=(v-U)/2,Q=0),{x:K,y:Q,width:U,height:G}})();return k.jsxs("div",{className:`student-card ${o.isActive?"active":"inactive"}`,onClick:()=>t(o),children:[k.jsxs("div",{className:"student-card-header",children:[k.jsxs("div",{className:"student-name",children:[k.jsx("span",{className:"student-icon",children:""}),l?"":E()]}),k.jsxs("div",{className:"student-header-actions",children:[k.jsx("button",{className:`flag-button ${o.isFlagged?"active":""}`,onClick:B,"aria-label":o.isFlagged?"Remove flag":"Flag student",title:o.isFlagged?"Remove flag":"Flag student",children:k.jsx(xb,{active:o.isFlagged,size:18})}),k.jsxs("div",{className:"student-status",children:[k.jsx("span",{className:`status-dot ${o.isActive?"online":"offline"}`}),o.isVisible===!1&&o.isActive&&k.jsx("span",{className:"visibility-indicator away",title:"Student is distracted (switched away from tab)",children:""})]})]})]}),k.jsxs("div",{className:"student-card-canvas",ref:d,children:[k.jsxs(Ug,{ref:f,width:v,height:D,scaleX:L,scaleY:L,style:{transformOrigin:"top left",width:"100%",height:"100%"},children:[M&&k.jsx(Kr,{listening:!1,children:k.jsx(sv,{image:g,x:M.x,y:M.y,width:M.width,height:M.height})}),k.jsx(Kr,{children:o.lines&&o.lines.map((y,z)=>k.jsx(pl,{points:y.points,stroke:y.color||"black",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`preview-${o.clientId}-${z}`))}),k.jsx(Kr,{children:a.map((y,z)=>k.jsx(pl,{points:y.points,stroke:y.color||"#FF0000",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${o.clientId}-${z}`))})]}),(!o.lines||o.lines.length===0)&&k.jsxs("div",{className:"no-drawing",children:[k.jsx("span",{children:""}),k.jsx("p",{children:"No drawing yet"})]}),o.lines&&o.lines.length>0&&k.jsxs("div",{className:"stroke-count",children:[o.lines.length," stroke",o.lines.length!==1?"s":""]})]}),k.jsxs("div",{className:"student-card-footer",children:[k.jsx("span",{className:"last-update",children:R()}),k.jsx("span",{className:"click-hint",children:"Click to annotate "})]})]})},rf={width:800,height:600},pg="teacherAnnotationPrefs",E2=2,Cm=[{label:"Red",value:"#FF3B30"},{label:"Purple",value:"#7C3AED"},{label:"Teal",value:"#0EA5E9"}],Nb=({student:o,isOpen:t,onClose:n,onAnnotate:a,existingAnnotations:r=[],isFlagged:l=!1,onToggleFlag:f,sharedImage:d,generateStrokeId:g})=>{const[m,_]=st.useState("pen"),[C,E]=st.useState(Cm[0].value),[R,v]=st.useState(3),[D,L]=st.useState(!1),[B,N]=st.useState([]),[M,P]=st.useState("stylus-only"),[O,A]=st.useState("left"),[T,y]=st.useState(null),[z,U]=st.useState(!1),G=st.useRef([]),K=st.useRef([]),Q=st.useRef(!1),X=st.useRef(null),Y=st.useRef(!0),j=st.useRef(0),I=st.useRef(null),F=st.useRef(null);st.useEffect(()=>{if(!d){y(null);return}const Ot=new window.Image;Ot.src=d.dataUrl,Ot.onload=()=>{y(Ot)}},[d]);const W=st.useRef(null),it=st.useRef(null),[Z,at]=st.useState({width:960,height:720}),rt=st.useMemo(()=>({x:Z.width/rf.width,y:Z.height/rf.height}),[Z]);st.useEffect(()=>{const Ot=()=>{U(window.innerWidth<=768)};return Ot(),window.addEventListener("resize",Ot),()=>window.removeEventListener("resize",Ot)},[]),st.useEffect(()=>{if(!(typeof window>"u"))try{const Ot=localStorage.getItem(pg);if(Ot){const Zt=JSON.parse(Ot);if(Zt.version!==E2){localStorage.removeItem(pg);return}Zt.tool&&_(Zt.tool),Zt.color&&E(Zt.color),typeof Zt.brushSize=="number"&&v(Zt.brushSize),Zt.inputMode&&P(Zt.inputMode),Zt.toolbarPosition&&A(Zt.toolbarPosition)}}catch{localStorage.removeItem(pg)}},[]),st.useEffect(()=>{if(typeof window>"u")return;if(Y.current){Y.current=!1;return}const Ot={version:E2,tool:m,color:C,brushSize:R,inputMode:M,toolbarPosition:O};localStorage.setItem(pg,JSON.stringify(Ot))},[m,C,R,M,O]),st.useEffect(()=>{t&&o&&o.clientId!==X.current&&(X.current=o.clientId,N(r),G.current=[],K.current=[])},[t,o,r]),st.useEffect(()=>{t&&o&&N(r)},[r,t,o]),st.useEffect(()=>()=>{F.current&&cancelAnimationFrame(F.current)},[]),st.useEffect(()=>{if(!t)return;const Ot=document.body.style.overflow,Zt=document.body.style.position,Ce=document.body.style.touchAction,Ke=document.body.style.width,Je=document.body.style.top,Te=window.scrollY||document.documentElement.scrollTop||0;j.current=Te,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${Te}px`,document.body.style.touchAction="none";const lt=W.current,Tt=le=>{const Bt=le.target;Bt.closest("button")||Bt.closest(".annotation-sidebar")||Bt.closest(".annotation-status-actions")||le.preventDefault()},Rt=le=>{le.preventDefault()},qt=le=>{if(D)return le.preventDefault(),!1};return lt&&(lt.addEventListener("touchstart",Tt,{passive:!1}),lt.addEventListener("touchmove",Tt,{passive:!1}),lt.addEventListener("gesturestart",Rt,{passive:!1}),lt.addEventListener("gesturechange",Rt,{passive:!1})),document.addEventListener("selectstart",qt),()=>{document.body.style.overflow=Ot,document.body.style.position=Zt,document.body.style.width=Ke,document.body.style.top=Je,document.body.style.touchAction=Ce,lt&&(lt.removeEventListener("touchstart",Tt),lt.removeEventListener("touchmove",Tt),lt.removeEventListener("gesturestart",Rt),lt.removeEventListener("gesturechange",Rt)),document.removeEventListener("selectstart",qt),requestAnimationFrame(()=>{window.scrollTo(0,j.current)})}},[t,D]),st.useEffect(()=>{if(!t)return;const Ot=()=>{if(!W.current)return;const Zt=W.current.getBoundingClientRect(),Je=24+4,Te=Math.max(320,Zt.width-Je),lt=Math.max(240,Zt.height-Je),Tt=Te/rf.width,Rt=lt/rf.height,qt=Math.min(Tt,Rt);at({width:Math.round(rf.width*qt),height:Math.round(rf.height*qt)})};return Ot(),window.addEventListener("resize",Ot),()=>window.removeEventListener("resize",Ot)},[O,t]);const V=()=>{if(!d||!T)return null;const Ot=d.width/d.height,Zt=Z.width/Z.height;let Ce,Ke,Je,Te;return Ot>Zt?(Ce=Z.width,Ke=Z.width/Ot,Je=0,Te=(Z.height-Ke)/2):(Ke=Z.height,Ce=Z.height*Ot,Je=(Z.width-Ce)/2,Te=0),{x:Je,y:Te,width:Ce,height:Ke}};if(!t||!o)return null;const J=V(),tt=()=>{if(o.name)return o.name;const Ot=o.clientId.match(/student-(\d+)/)||o.clientId.match(/load-test-student-(\d+)/);return Ot?`Student ${Ot[1]}`:o.clientId},nt=Ot=>M!=="stylus-only"?!0:(Ot==null?void 0:Ot.pointerType)==="pen",ht=(Ot=[])=>Ot.map((Zt,Ce)=>Ce%2===0?Zt*rt.x:Zt*rt.y),wt=Ot=>({x:Ot.x/rt.x,y:Ot.y/rt.y}),jt=Ot=>(Ot.strokeWidth||3)*rt.x,kt=Ot=>{const Zt=Ot.evt;if(Zt!=null&&Zt.preventDefault&&Zt.preventDefault(),Zt!=null&&Zt.stopPropagation&&Zt.stopPropagation(),!nt(Zt))return;const Ce=Ot.target.getStage();if(Ce&&Zt.pointerId!==void 0){const Ke=Ce.content;if(Ke&&Ke.setPointerCapture)try{Ke.setPointerCapture(Zt.pointerId)}catch{}}if(m==="pen"){L(!0);const Ke=Ce.getPointerPosition(),{x:Je,y:Te}=wt(Ke),lt={tool:"pen",points:[Je,Te],color:C,strokeWidth:R,strokeId:g?g():`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};G.current.push([...B]),K.current=[],I.current=lt,N([...B,lt])}else m==="eraser"&&(L(!0),Q.current=!1)},ee=Ot=>{const Zt=Ot.evt;if(Zt!=null&&Zt.preventDefault&&Zt.preventDefault(),Zt!=null&&Zt.stopPropagation&&Zt.stopPropagation(),!D||!nt(Zt))return;const Ke=Ot.target.getStage().getPointerPosition();if(m==="pen"){if(I.current){const{x:Je,y:Te}=wt(Ke);I.current.points=I.current.points.concat([Je,Te]);const lt=I.current;F.current&&cancelAnimationFrame(F.current),F.current=requestAnimationFrame(()=>{lt&&N(Tt=>Tt.length===0?Tt:[...Tt.slice(0,-1),lt])})}}else if(m==="eraser"){const Je=B.length,Te=20,lt=B.filter(Tt=>{for(let Rt=0;Rt<Tt.points.length;Rt+=2){const qt=Tt.points[Rt]*rt.x,le=Tt.points[Rt+1]*rt.y;if(Math.sqrt(Math.pow(qt-Ke.x,2)+Math.pow(le-Ke.y,2))<Te)return!1}return!0});lt.length<Je&&!Q.current&&(G.current.push([...B]),K.current=[],Q.current=!0),N(lt)}},re=Ot=>{const Zt=Ot==null?void 0:Ot.evt;if(!nt(Zt)){Zt!=null&&Zt.preventDefault&&Zt.preventDefault();return}if(L(!1),F.current&&(cancelAnimationFrame(F.current),F.current=null),I.current&&m==="pen"){const Ce=I.current;N(Ke=>{if(Ke.length===0)return Ke;const Je=[...Ke.slice(0,-1),Ce];return setTimeout(()=>a(Je),0),Je}),I.current=null}else setTimeout(()=>a(B),0)},Lt=()=>{if(G.current.length>0){const Ot=G.current.pop();K.current.push([...B]),N(Ot),a(Ot)}},ge=()=>{if(K.current.length>0){const Ot=K.current.pop();G.current.push([...B]),N(Ot),a(Ot)}},pe=()=>{G.current.push([...B]),K.current=[];const Ot=[];N(Ot),a(Ot)},rn=()=>{f&&f(o.clientId)},Ye=()=>{L(!1),n()},mn=()=>{P(Ot=>Ot==="stylus-only"?"all":"stylus-only")},Yn=()=>{A(Ot=>Ot==="left"?"right":"left")},sn=Ot=>{Ot.preventDefault(),Ot.stopPropagation()};return k.jsx("div",{className:"annotation-modal-overlay",onTouchMove:sn,onTouchStart:sn,children:k.jsx("div",{className:"annotation-modal student-console",children:k.jsxs("div",{className:"annotation-console",children:[k.jsxs("div",{className:"annotation-status-bar",children:[k.jsxs("div",{className:"annotation-status-text",children:[k.jsx("h1",{children:"Annotate Student"}),k.jsx("p",{children:tt()})]}),k.jsxs("div",{className:"annotation-status-actions",children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:m==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",M==="all"?"All inputs":"Stylus only"]})}),k.jsxs("button",{className:`flag-pill ${l?"active":""}`,onClick:rn,children:[k.jsx(xb,{active:l,size:16}),l?"Flagged":"Flag"]}),k.jsxs("button",{className:"status-badge",onClick:Yn,children:["Move toolbar to ",O==="left"?"right":"left"]}),k.jsx("button",{className:"status-badge danger",onClick:Ye,children:" Close"})]})]}),k.jsxs("div",{className:`annotation-workspace ${O==="right"?"toolbar-right":""} ${z?"mobile-view":""}`,children:[z?k.jsxs("div",{className:"mobile-annotation-toolbar",children:[k.jsx("div",{className:"mobile-colors",children:Cm.map(Ot=>k.jsx("button",{onClick:()=>E(Ot.value),className:`mobile-color-button ${C===Ot.value?"active":""}`,style:{background:Ot.value},"aria-label":Ot.label},Ot.value))}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>_("pen"),className:`mobile-tool-button ${m==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(vb,{size:20})}),k.jsx("button",{onClick:()=>_("eraser"),className:`mobile-tool-button ${m==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(mb,{size:20})}),k.jsx("button",{onClick:Lt,className:"mobile-tool-button",disabled:G.current.length===0,"aria-label":"Undo",children:k.jsx(bb,{size:20})}),k.jsx("button",{onClick:ge,className:"mobile-tool-button",disabled:K.current.length===0,"aria-label":"Redo",children:k.jsx(yb,{size:20})}),k.jsx("button",{onClick:pe,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(Sb,{size:20})})]})]}):k.jsxs("div",{className:"annotation-sidebar",children:[k.jsxs("div",{className:"sidebar-header",children:[k.jsx("h2",{children:"Annotation Console"}),k.jsx("p",{children:"Mirror of student workspace"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsx("div",{className:"color-row",children:Cm.map(Ot=>k.jsx("button",{className:`color-button ${C===Ot.value?"active":""}`,style:{background:Ot.value},onClick:()=>E(Ot.value),"aria-label":Ot.label},Ot.value))})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>_("pen"),className:`tool-icon-button ${m==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>_("eraser"),className:`tool-icon-button ${m==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsxs("div",{className:"brush-size-control",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:R,onChange:Ot=>v(parseInt(Ot.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:R})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${M==="all"?"all":""}`,onClick:mn,children:M==="stylus-only"?"Stylus only":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:Lt,className:"history-button",disabled:G.current.length===0,children:"Undo"}),k.jsx("button",{onClick:ge,className:"history-button",disabled:K.current.length===0,children:"Redo"}),k.jsx("button",{onClick:pe,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"annotation-canvas-panel",children:k.jsx("div",{className:"annotation-canvas-frame",ref:W,onTouchMove:Ot=>Ot.preventDefault(),onTouchStart:Ot=>Ot.preventDefault(),children:k.jsxs(Ug,{ref:it,width:Z.width,height:Z.height,onPointerDown:kt,onPointerMove:ee,onPointerUp:re,onPointerLeave:re,onTouchStart:Ot=>Ot.preventDefault(),onTouchMove:Ot=>Ot.preventDefault(),onTouchEnd:Ot=>Ot.preventDefault(),className:"annotation-stage",perfectDrawEnabled:!1,children:[J&&k.jsx(Kr,{listening:!1,children:k.jsx(sv,{image:T,x:J.x,y:J.y,width:J.width,height:J.height})}),k.jsx(Kr,{listening:!1,children:o.lines&&o.lines.map((Ot,Zt)=>k.jsx(pl,{points:ht(Ot.points),stroke:Ot.color||"black",strokeWidth:(Ot.strokeWidth||3)*rt.x,tension:.5,lineCap:"round",lineJoin:"round"},`student-${Zt}`))}),k.jsx(Kr,{children:B.map((Ot,Zt)=>k.jsx(pl,{points:ht(Ot.points),stroke:Ot.color,strokeWidth:jt(Ot),tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${Zt}`))})]})})})]})]})})})},Db=async(o,t=800,n=600,a=.7)=>{console.log(" Processing image:",o.name,o.type,o.size,"bytes");let r,l,f;if(typeof createImageBitmap=="function")try{console.log(" Using createImageBitmap");const v=await createImageBitmap(o);l=v.width,f=v.height,r=v}catch(v){console.warn(" createImageBitmap failed, using fallback:",v),r=null}r||(console.log(" Using Image() fallback for iOS/Safari"),r=await new Promise((v,D)=>{const L=new Image,B=URL.createObjectURL(o);L.onload=()=>{URL.revokeObjectURL(B),v(L)},L.onerror=N=>{URL.revokeObjectURL(B),console.error(" Image load error:",N),D(new Error(`Failed to load image: ${o.name}. File may be corrupted or in unsupported format.`))},L.src=B}),l=r.naturalWidth||r.width,f=r.naturalHeight||r.height);const d=Math.min(t/l,n/f,1),g=Math.round(l*d),m=Math.round(f*d);console.log(" Resizing:",l,"x",f,"",g,"x",m);const _=document.createElement("canvas");_.width=g,_.height=m;const C=_.getContext("2d");C.fillStyle="#FFFFFF",C.fillRect(0,0,g,m),C.drawImage(r,0,0,g,m);const E=await new Promise((v,D)=>{try{_.toBlob(L=>{L?(console.log(" Compressed to:",L.size,"bytes"),v(L)):(console.error(" Canvas toBlob returned null"),D(new Error("Failed to compress image. Canvas may be too large or device out of memory.")))},"image/jpeg",a)}catch(L){console.error(" Canvas toBlob error:",L),D(new Error(`Failed to compress image: ${L.message}`))}}),R=await new Promise((v,D)=>{const L=new FileReader;L.onload=()=>{console.log(" Data URL created, length:",L.result.length),v(L.result)},L.onerror=B=>{var N;console.error(" Failed to create data URL:",B,L.error),D(new Error(`Failed to create data URL: ${((N=L.error)==null?void 0:N.message)||"Unknown FileReader error"}`))},L.readAsDataURL(E)});return console.log("  Image processing complete"),{blob:E,dataUrl:R,width:g,height:m,size:E.size}},HT=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,IT=()=>{const[o,t]=Sh(),n=yf(),a=()=>{const Nt="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let Ut="";for(let $t=0;$t<6;$t++)Ut+=Nt.charAt(Math.floor(Math.random()*Nt.length));return Ut},[r,l]=st.useState(""),f=st.useRef(!1);st.useEffect(()=>{if(f.current)return;const Nt=o.get("room");if(Nt)l(Nt.toUpperCase());else{const Ut=a();l(Ut),t({room:Ut},{replace:!0})}f.current=!0},[o,t]);const[d,g]=st.useState(null),[m,_]=st.useState("created"),[C,E]=st.useState(null),[R,v]=st.useState(null),[D,L]=st.useState(!1),[B]=st.useState(`teacher-${Math.random().toString(36).substring(7)}`),[N,M]=st.useState(0),[P,O]=st.useState(()=>{const Nt=parseInt(o.get("bot"))||0,Ut={};if(Nt>0)for(let $t=1;$t<=Nt;$t++){const Ft=`bot-student-${$t}`;Ut[Ft]={studentId:Ft,clientId:`bot-${$t}`,name:`Bot ${$t}`,lastUpdate:Date.now()-$t*1e3,isActive:!0,isFlagged:!1}}return Ut}),[A,T]=st.useState(null),[y,z]=st.useState({}),[U,G]=st.useState(""),[K,Q]=st.useState("all"),[X,Y]=st.useState("all"),[j,I]=st.useState(()=>{const Nt=localStorage.getItem("teacherDashboardHideNames");return Nt?JSON.parse(Nt):!1}),[F,W]=st.useState(()=>{const Nt=localStorage.getItem("teacherDashboardCardsPerRow");return Nt?parseInt(Nt):3}),[it,Z]=st.useState("blank"),[at,rt]=st.useState(null),[V,J]=st.useState(null),[tt,nt]=st.useState(""),[ht,wt]=st.useState(!1),[jt,kt]=st.useState(null),ee=st.useRef(null),re=st.useRef({}),Lt=st.useRef(null),ge=st.useRef(null),pe=st.useRef(null),[rn,Ye]=st.useState(!1),[mn,Yn]=st.useState(""),[sn,Ot]=st.useState([]);st.useRef(!1);const Zt=st.useRef({roomId:null,status:"idle"}),Ce=st.useRef(new Set),Ke=st.useRef(!1);st.useEffect(()=>{ee.current=jt},[jt]),st.useEffect(()=>{re.current=y},[y]);const Je=st.useRef(0),Te=(Nt,Ut="info")=>{const $t=`${Date.now()}-${Je.current++}`;Ot(Ft=>[...Ft,{id:$t,message:Nt,type:Ut}]),setTimeout(()=>{Ot(Ft=>Ft.filter(It=>It.id!==$t))},4e3)},lt=st.useCallback(async(Nt="teacher_ended")=>{if(!d||m!=="active"&&m!=="created")return!1;try{if(N>0&&r){console.log(` Saving final question ${N} before ending session...`);try{const Ut=await fetch("/api/strokes/persist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:r,sessionId:d,questionNumber:N,contentType:jt!=null&&jt.type?"template":jt?"image":"blank",content:jt})});if(Ut.ok){const $t=await Ut.json();console.log(` Saved final ${$t.savedCount} student responses before ending`)}}catch(Ut){console.error("Error saving final question:",Ut)}}return await mu.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",d),R&&await R.publish("session-ended",{timestamp:Date.now(),reason:Nt}),_("ended"),Lt.current&&(clearTimeout(Lt.current),Lt.current=null),!0}catch(Ut){return console.error("Error ending session:",Ut),!1}},[d,m,R,N,r,jt]),Tt=st.useRef({students:{},teacher:{}}),Rt=st.useRef(null);st.useEffect(()=>{if(!(!r||!d||N===0))return Rt.current&&clearTimeout(Rt.current),Rt.current=setTimeout(async()=>{try{for(const[Ft,It]of Object.entries(P)){const Qe=It.lines||[];if(Qe.length===0)continue;const en=Tt.current.students[Ft]||new Set,Oe=Qe.filter(ie=>ie.strokeId&&!en.has(ie.strokeId));Oe.length>0&&(await fetch("/api/strokes/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:r,party:"student",studentId:Ft,studentName:It.name,strokes:Oe})}),Oe.forEach(ie=>en.add(ie.strokeId)),Tt.current.students[Ft]=en,console.log(` Saved ${Oe.length} new student strokes for ${It.name}`))}const Nt=Object.values(y).flat(),Ut=Tt.current.teacher||new Set,$t=Nt.filter(Ft=>Ft.strokeId&&!Ut.has(Ft.strokeId));$t.length>0&&(await fetch("/api/strokes/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:r,party:"teacher",strokes:$t})}),$t.forEach(Ft=>Ut.add(Ft.strokeId)),Tt.current.teacher=Ut,console.log(` Saved ${$t.length} new teacher annotation strokes`))}catch(Nt){console.error("Error auto-saving to Redis:",Nt)}},3e3),()=>{Rt.current&&clearTimeout(Rt.current)}},[P,y,r,d,N]),st.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(j))},[j]),st.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",F.toString())},[F]),st.useEffect(()=>{if(!r||(Zt.current.roomId!==r&&(Zt.current={roomId:r,status:"idle"}),Zt.current.status==="in-progress"||Zt.current.status==="done"))return;Zt.current={roomId:r,status:"in-progress"};let Nt=!1;const Ut=()=>{const Ft=Zt.current;!Nt&&Ft.roomId===r&&(Zt.current={roomId:r,status:"idle"})};return(async()=>{try{const{data:Ft,error:It}=await mu.from("sessions").select("*").ilike("room_code",r).order("created_at",{ascending:!1}).limit(1);if(It){console.error("Failed to query sessions:",It),Ut();return}let Qe=null;if(Ft&&Ft.length>0){const en=Ft[0];if(en.status==="ended"){const{data:Oe,error:ie}=await mu.from("sessions").update({status:"created",started_at:null,ended_at:null}).eq("id",en.id).select().single();if(ie){console.error("Failed to update session:",ie),Ut();return}Qe=Oe}else Qe=en}else{const{data:en,error:Oe}=await mu.from("sessions").insert([{room_code:r,status:"created"}]).select().single();if(Oe)if(Oe.code==="23505"){const{data:ie,error:on}=await mu.from("sessions").select("*").ilike("room_code",r).order("created_at",{ascending:!1}).limit(1);if(on){console.error("Failed to load existing session after duplicate key error:",on),Ut();return}if(ie&&ie.length>0)Qe=ie[0];else{console.error("Duplicate key reported but no session found when refetching."),Ut();return}}else{console.error("Failed to create session:",Oe),Ut();return}else Qe=en}if(Nt)return;Qe?(g(Qe.id),_(Qe.status),Nt||(Zt.current={roomId:r,status:"done"})):Ut()}catch(Ft){console.error("Error initializing session:",Ft),Ut()}})(),()=>{Nt=!0;const Ft=Zt.current;Ft.roomId===r&&Ft.status==="in-progress"&&(Zt.current={roomId:r,status:"idle"})}},[r,B]),st.useEffect(()=>{if(!d||typeof window>"u")return;!D&&(m==="active"||m==="created")&&!Lt.current&&(console.log(" Teacher disconnected, starting 10-minute auto-logout timer"),Lt.current=window.setTimeout(async()=>{console.log(" 10-minute timeout reached, automatically ending session"),await lt("teacher_timeout_10min")?console.log(" Session ended due to teacher inactivity"):console.warn("Auto-logout timer fired but session was already ended or unavailable"),Lt.current=null},600*1e3)),D&&Lt.current&&(console.log(" Teacher reconnected, cancelling auto-logout timer"),clearTimeout(Lt.current),Lt.current=null)},[D,d,m,lt]),st.useEffect(()=>()=>{Lt.current&&(clearTimeout(Lt.current),Lt.current=null)},[]),st.useEffect(()=>{if(Ke.current||!r||!B)return;Ke.current=!0;let Nt=null,Ut=null;return(async()=>{var Ft;try{const It=`/api/token?clientId=${B}`,Qe=await fetch(It),en=await Qe.text();if(!Qe.ok)throw new Error(`Token request failed (${Qe.status} ${Qe.statusText})${en?`  ${en}`:""}`);let Oe;try{Oe=JSON.parse(en)}catch(_e){throw new Error(`Token response was not valid JSON: ${_e.message}`)}Nt=new vv.Realtime({authCallback:async(_e,je)=>{je(null,Oe)},clientId:B}),Nt.connection.on("connected",()=>{L(!0),console.log(" Teacher connected to Ably")}),Nt.connection.on("disconnected",()=>{L(!1)}),Nt.connection.on("suspended",()=>{L(!1)}),Nt.connection.on("failed",()=>{L(!1)}),Nt.connection.on("closing",()=>{L(!1)}),Nt.connection.on("closed",()=>{L(!1)}),E(Nt),Ut=Nt.channels.get(`room-${r}`),Ut.presence.subscribe("enter",_e=>{var Ue,ye;if(!_e.clientId||_e.clientId===B||!_e.clientId.includes("student"))return;const je=((Ue=_e.data)==null?void 0:Ue.name)||qt(_e.clientId),Pe=_e.clientId,we=(ye=_e.data)==null?void 0:ye.studentId;if(console.log(" Presence enter event:",{studentName:je,incomingClientId:Pe,incomingStudentId:we,hasData:!!_e.data}),!we){console.warn(" Student joined without persistent studentId:",Pe);return}if(!Pe){console.warn(" Student joined without clientId:",we);return}O(ln=>{var As,ws;const un=ln[we];if(un&&un.clientId){console.log(" Student reconnected:",un.clientId,"",Pe,"(",je,")"),(A==null?void 0:A.studentId)===we&&T({...un,clientId:Pe});const yi={...un,clientId:Pe,name:je,isActive:!0,isVisible:((As=_e.data)==null?void 0:As.isVisible)!==!1,lastUpdate:Date.now()};return console.log(" Updated existing student:",yi),{...ln,[we]:yi}}const ii=!Ce.current.has(we);ii?(Ce.current.add(we),Te(`${je} joined`,"success")):un&&!un.clientId&&console.warn(" Fixed student with undefined clientId:",we);const Kn={studentId:we,clientId:Pe,name:je,isActive:!0,isVisible:((ws=_e.data)==null?void 0:ws.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:(un==null?void 0:un.isFlagged)||!1};return console.log(ii?" Added new student:":" Initialized student with clientId:",Kn),console.log(" Total students after add:",Object.keys(ln).length+1),{...ln,[we]:Kn}}),setTimeout(()=>{var un;const ln=((un=re.current)==null?void 0:un[we])||[];Ut.publish("sync-full-state",{targetClientId:Pe,content:ee.current||null,annotations:ln,timestamp:Date.now()}),ln.length>0&&console.log(" Sent",ln.length,"teacher annotations to",je)},300)}),Ut.presence.subscribe("leave",_e=>{var je;if(_e.clientId!==B&&_e.clientId.includes("student")){const Pe=(je=_e.data)==null?void 0:je.studentId;O(we=>{const Ue=Pe?we[Pe]:null;if(!Ue)return we;const ye=(Ue==null?void 0:Ue.name)||qt(_e.clientId);Ce.current.has(Pe)&&Te(`${ye} left`,"info");const{[Pe]:ln,...un}=we;return un})}}),Ut.subscribe("student-visibility",_e=>{const{studentId:je,studentName:Pe,isVisible:we}=_e.data;je&&O(Ue=>{const ye=Ue[je];if(!ye)return Ue;const ln=ye.isVisible===!1;return we?ln&&Te(` ${Pe} returned`,"success"):Te(` ${Pe} switched away`,"warning"),{...Ue,[je]:{...ye,isVisible:we,lastVisibilityChange:Date.now()}}})}),Ut.subscribe("student-layer",_e=>{const{lines:je,studentId:Pe,clientId:we}=_e.data;O(Ue=>{const ye=Pe||Object.keys(Ue).find(ln=>Ue[ln].clientId===we);return ye?(console.log(" Updating student",ye,"with",(je||[]).length,"lines"),{...Ue,[ye]:{...Ue[ye],lines:je||[]}}):(console.warn(" Student not found for stroke update. studentId:",Pe,"clientId:",we),console.warn("Available students:",Object.keys(Ue)),Ue)})}),Ut.subscribe("teacher-image",_e=>{kt(_e.data)}),Ut.subscribe("request-current-state",_e=>{var Pe;const je=(Pe=_e.data)==null?void 0:Pe.studentId;setTimeout(()=>{var Ue;const we=((Ue=re.current)==null?void 0:Ue[je])||[];Ut.publish("sync-full-state",{targetClientId:_e.clientId,content:ee.current||null,annotations:we,timestamp:Date.now()})},100)}),await Ut.presence.enter({role:"teacher",timestamp:Date.now()});const ie=await Ut.presence.get();O(_e=>{const je={..._e};return console.log(` Loading ${ie.length} existing members from presence`),ie.forEach(Pe=>{var un,ai,ii;if(!Pe.clientId||Pe.clientId===B||!Pe.clientId.includes("student"))return;const we=((un=Pe.data)==null?void 0:un.name)||qt(Pe.clientId),Ue=(ai=Pe.data)==null?void 0:ai.studentId,ye=Pe.clientId;if(!Ue){console.warn(" Student in presence without studentId:",ye);return}if(!ye){console.warn(" Student in presence without clientId:",Ue);return}const ln=_e[Ue]||{};je[Ue]={...ln,studentId:Ue,clientId:ye,name:we,isActive:!0,isVisible:((ii=Pe.data)==null?void 0:ii.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:ln.isFlagged||!1},Ce.current.has(Ue)||Ce.current.add(Ue),console.log(" Loaded student from presence:",we,"| studentId:",Ue,"| clientId:",ye)}),console.log(` Total students in state after presence load: ${Object.keys(je).length}`),je}),v(Ut),performance.navigation.type===1||((Ft=performance.getEntriesByType("navigation")[0])==null?void 0:Ft.type)==="reload"?setTimeout(async()=>{try{console.log(" Page refresh detected - loading from IndexedDB + Redis...");const _e=await Eb();if(_e&&_e.length>0){console.log(` Loaded ${_e.length} teacher annotations from IndexedDB`);const we={};_e.forEach(Ue=>{})}const je=await fetch(`/api/strokes/load?roomId=${r}&party=students`);if(je.ok){const we=await je.json();we.students&&Object.keys(we.students).length>0?(console.log(` Restored ${Object.keys(we.students).length} students' data from Redis after refresh`),O(Ue=>{const ye={...Ue};return Object.entries(we.students).forEach(([ln,un])=>{var ai;ye[ln]?ye[ln]={...ye[ln],lines:un.strokes||[]}:ye[ln]={studentId:ln,clientId:void 0,name:((ai=un.meta)==null?void 0:ai.name)||"Unknown",lines:un.strokes||[],isActive:!1,lastUpdate:Date.now()}}),ye})):console.log(" No student data found in Redis")}const Pe=await fetch(`/api/strokes/load?roomId=${r}&party=teacher`);if(Pe.ok){const we=await Pe.json();we.strokes&&we.strokes.length>0&&console.log(` Loaded ${we.strokes.length} teacher annotations from Redis`)}}catch(_e){console.error("Error loading strokes on refresh:",_e)}},1e3):console.log(" Normal page load - skipping persistence restore")}catch(It){console.error("Failed to connect to Ably:",It)}})(),()=>{Ut&&(Ut.unsubscribe(),Ut.presence.unsubscribe()),Nt&&Nt.close()}},[r,B]);const qt=Nt=>{const Ut=Nt.match(/student-(\d+)/)||Nt.match(/student-([\w]+)/);return Ut?`Student ${Ut[1]}`:Nt},le=Nt=>{T(P[Nt.studentId]||Nt)},Bt=()=>{T(null)},vt=async Nt=>{if(!A||!R)return;const Ut=A.studentId,$t=A.clientId;if(!Ut){console.error(" Student has no persistent studentId, cannot save annotation");return}z(Ft=>({...Ft,[Ut]:Nt})),R.publish("teacher-annotation",{targetStudentId:$t,annotations:Nt,teacherId:B,timestamp:Date.now()}),setTimeout(async()=>{try{for(const Ft of Nt)Ft.strokeId&&await _b(Ft)}catch(Ft){console.error("Error saving annotations to IndexedDB:",Ft)}},150)},dt=Nt=>{O(Ut=>{const $t=Ut[Nt];return $t?{...Ut,[Nt]:{...$t,isFlagged:!$t.isFlagged}}:Ut}),T(Ut=>Ut&&Ut.studentId===Nt?{...Ut,isFlagged:!Ut.isFlagged}:Ut)},Yt=()=>{ge.current&&(ge.current.value="",ge.current.click())},ae=async Nt=>{var It,Qe,en,Oe,ie;const Ut=(It=Nt.target.files)==null?void 0:It[0];if(!Ut){nt("No file selected.");return}const $t=(Ut.size/(1024*1024)).toFixed(2);if(console.log(" File selected:",{name:Ut.name,type:Ut.type,size:`${$t}MB (${Ut.size} bytes)`,lastModified:new Date(Ut.lastModified).toISOString()}),!Ut.type.startsWith("image/")){const on=` Invalid file type: ${Ut.type||"unknown"}. Please select an image file (JPG, PNG, etc.)`;nt(on),console.error(on),Te("Invalid file type","error");return}const Ft=25;if(Ut.size>Ft*1024*1024){const on=` File too large: ${$t}MB. Maximum size is ${Ft}MB.`;nt(on),console.error(on),Te("File too large","error");return}wt(!0),nt(`Processing ${Ut.name} (${$t}MB)...`);try{const{dataUrl:on,width:_e,height:je,size:Pe}=await Db(Ut),we={dataUrl:on,width:_e,height:je,filename:Ut.name,timestamp:Date.now()};J(we),nt(` Image ready (${_e}${je}, ${Math.round(Pe/1024)}KB)`),console.log(" Image processed successfully")}catch(on){const _e={fileName:Ut.name,fileType:Ut.type,fileSize:`${$t}MB`,errorMessage:on.message||"Unknown error",errorStack:on.stack};console.error(" [TEACHER] Image upload failed:",_e);let je=` Upload failed: ${on.message||"Unknown error"}
`;je+=`File: ${Ut.name} (${Ut.type})
`,je+=`Size: ${$t}MB
`,(Qe=on.message)!=null&&Qe.includes("load")?je+="Error loading image. The file may be corrupted or in an unsupported format.":(en=on.message)!=null&&en.includes("compress")?je+="Error compressing image. Try a different image or smaller file.":(Oe=on.message)!=null&&Oe.includes("memory")||(ie=on.message)!=null&&ie.includes("allocation")?je+="Image too large for device memory. Try a smaller image.":je+="Try a different image or format (JPG/PNG recommended).",nt(je),Te(`Upload failed: ${on.message}`,"error")}finally{wt(!1)}},Qt=()=>{J(null),nt(""),ge.current&&(ge.current.value="")},Ae=Nt=>{const Ut=document.createElement("canvas"),$t=800,Ft=600;Ut.width=$t,Ut.height=Ft;const It=Ut.getContext("2d");if(It.fillStyle="#FFFFFF",It.fillRect(0,0,$t,Ft),Nt==="hanzi"){const Oe=($t-450)/2,ie=(Ft-450)/2;It.strokeStyle="#0F9D83",It.lineWidth=4,It.strokeRect(Oe,ie,450,450),It.strokeStyle="#B0E8D8",It.lineWidth=2,It.setLineDash([8,8]),It.beginPath(),It.moveTo($t/2,ie),It.lineTo($t/2,ie+450),It.stroke(),It.beginPath(),It.moveTo(Oe,Ft/2),It.lineTo(Oe+450,Ft/2),It.stroke()}else if(Nt==="graph-corner"){It.strokeStyle="#E0E0E0",It.lineWidth=1,It.setLineDash([]);for(let ie=80;ie<=$t-80;ie+=40)It.beginPath(),It.moveTo(ie,80),It.lineTo(ie,Ft-80),It.stroke();for(let ie=80;ie<=Ft-80;ie+=40)It.beginPath(),It.moveTo(80,ie),It.lineTo($t-80,ie),It.stroke();It.strokeStyle="#5B9BD5",It.lineWidth=3,It.beginPath(),It.moveTo(80,Ft-80),It.lineTo($t-80,Ft-80),It.stroke(),It.beginPath(),It.moveTo(80,80),It.lineTo(80,Ft-80),It.stroke()}else if(Nt==="graph-cross"){It.strokeStyle="#E0E0E0",It.lineWidth=1,It.setLineDash([]);for(let ie=80;ie<=$t-80;ie+=40)It.beginPath(),It.moveTo(ie,80),It.lineTo(ie,Ft-80),It.stroke();for(let ie=80;ie<=Ft-80;ie+=40)It.beginPath(),It.moveTo(80,ie),It.lineTo($t-80,ie),It.stroke();It.strokeStyle="#5B9BD5",It.lineWidth=3,It.beginPath(),It.moveTo(80,Ft/2),It.lineTo($t-80,Ft/2),It.stroke(),It.beginPath(),It.moveTo($t/2,80),It.lineTo($t/2,Ft-80),It.stroke()}const Qe=Ut.toDataURL("image/png");return{type:Nt,dataUrl:Qe,width:$t,height:Ft,timestamp:Date.now()}},be=Nt=>{const Ut=Ae(Nt);rt(Ut),nt(`Template ready: ${Nt}`)},Ie=async()=>{if(!R||!d||!D){console.error("Cannot send: channel or sessionId missing",{channel:!!R,sessionId:d,isConnected:D}),nt("Error: Not connected properly. Please refresh the page."),Te("Failed to send: Connection issue","error");return}if(tt.includes("sending")){console.log("Already sending, ignoring duplicate click");return}nt("Sending to class...");try{if(N>0){console.log(` Persisting question ${N} before moving to next...`);try{const Ft=await fetch("/api/strokes/persist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:r,sessionId:d,questionNumber:N,contentType:jt!=null&&jt.type?"template":jt?"image":"blank",content:jt})});if(Ft.ok){const It=await Ft.json();console.log(` Persisted ${It.savedCount} student responses for question ${N}`)}else console.warn("Failed to persist question, but continuing...",await Ft.text())}catch(Ft){console.error("Error persisting question:",Ft)}}const Nt=N+1;if(M(Nt),console.log(` Moving to question ${Nt}`),m==="created"){const{error:Ft}=await mu.from("sessions").update({status:"active",started_at:new Date().toISOString()}).eq("id",d);if(Ft){console.error("Failed to start session:",Ft),nt("Failed to start session. Please try again.");return}_("active"),await R.publish("session-started",{timestamp:Date.now(),sessionId:d})}let $t=null;it==="templates"&&at?$t=at:it==="image"&&V&&($t=V),await R.publish("clear-all-drawings",{timestamp:Date.now(),content:$t}),O(Ft=>{const It={};return Object.keys(Ft).forEach(Qe=>{It[Qe]={...Ft[Qe],lines:[]}}),It}),z({});try{await Cb(),console.log(" Cleared teacher annotations from IndexedDB")}catch(Ft){console.error("Error clearing IndexedDB:",Ft)}it==="blank"?(kt(null),rt(null),nt("Blank canvas sent to all students.")):it==="templates"&&at?(kt(at),nt("Template sent to all students.")):it==="image"&&V&&(kt(V),nt("Image sent to all students.")),Te("Content sent!","success")}catch(Nt){console.error("Failed to send to class:",Nt),nt("Failed to send. Please try again."),Te("Failed to send content","error")}},Cn=async()=>{window.confirm(`Are you sure you want to end this session?

All students will be logged out and the session will be closed.`)&&(await lt("teacher_ended"),C&&C.close(),n("/"))},Re=async()=>{const Nt=`${window.location.origin}/student?room=${r}`;try{const Ut=await Ob.toDataURL(Nt,{width:300,margin:2,color:{dark:"#0F172A",light:"#FFFFFF"}});Yn(Ut),Ye(!0)}catch(Ut){console.error("Failed to generate QR code:",Ut)}},dn=async()=>{const Nt=`${window.location.origin}/student?room=${r}`,Ut=()=>{Te("Link copied to clipboard!","success")};if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(Nt),Ut();return}catch($t){console.error("Clipboard API failed:",$t)}try{const $t=pe.current;if($t&&($t.select(),$t.setSelectionRange(0,Nt.length),document.execCommand("copy"))){Ut(),window.getSelection().removeAllRanges();return}throw new Error("execCommand failed")}catch($t){console.error("Fallback copy failed:",$t),pe.current&&pe.current.select(),Te("Select the link and press C/CTRL+C to copy","warning")}},Mn=()=>Object.values(P).sort((Nt,Ut)=>{const $t=(Nt.name||Nt.clientId||"").toLowerCase(),Ft=(Ut.name||Ut.clientId||"").toLowerCase();return $t.localeCompare(Ft)}),Sr=()=>{const Nt=Mn(),Ut=U.trim().toLowerCase();return Nt.filter($t=>{const Ft=Ut?($t.name||$t.studentId).toLowerCase().includes(Ut):!0,It=K==="all"||K==="flagged"&&$t.isFlagged,Qe=X==="all"||X==="distracted"&&$t.isVisible===!1&&$t.isActive;return Ft&&It&&Qe})},Ts=Mn(),br=Sr(),Yi=Ts.filter(Nt=>Nt.isActive).length,Oi=A?P[A.studentId]||A:null,Ki=tt?!/fail|no file/i.test(tt):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:sn.map(Nt=>k.jsxs("div",{className:`toast toast-${Nt.type}`,children:[Nt.type==="success"&&k.jsx("span",{className:"toast-icon",children:""}),Nt.type==="info"&&k.jsx("span",{className:"toast-icon",children:""}),Nt.type==="error"&&k.jsx("span",{className:"toast-icon",children:""}),k.jsx("span",{className:"toast-message",children:Nt.message})]},Nt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsxs("div",{className:"feather-branding",onClick:()=>window.location.reload(),style:{cursor:"pointer"},children:[k.jsx(eT,{size:32,strokeWidth:2}),k.jsx("span",{className:"feather-text",children:"Feather"})]}),k.jsx("section",{className:"hero-card glass-panel",children:k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"Teacher dashboard"}),k.jsx("h1",{children:"Monitor and annotate student canvases live"}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code to invite students. Their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:Re,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:r})]}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Session live"}),k.jsx("span",{className:`status-pill connection-pill ${D?"online":"offline"}`,children:D?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:Yi}),k.jsx("span",{children:"online"})]})]}),k.jsx("button",{className:"end-session-btn",onClick:Cn,title:"End session and logout all students",children:"End Session"})]})]})}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),at&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",at.type==="hanzi"?"Hanzi":at.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:Ie,disabled:it==="image"&&!V,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${it==="blank"?"active":""}`,onClick:()=>{Z("blank"),rt(null),J(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${it==="templates"?"active":""}`,onClick:()=>{Z("templates"),J(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${it==="image"?"active":""} ${V?"ready":""}`,onClick:()=>{Z("image"),rt(null)},disabled:ht,children:ht?"Uploading":"Send image"})]}),k.jsx("input",{ref:ge,type:"file",accept:"image/*",onChange:ae,style:{display:"none"}}),it==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(at==null?void 0:at.type)==="hanzi"?"active":""}`,onClick:()=>be("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(at==null?void 0:at.type)==="graph-corner"?"active":""}`,onClick:()=>be("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(at==null?void 0:at.type)==="graph-cross"?"active":""}`,onClick:()=>be("graph-cross"),children:"Graph (cross)"})]}),at&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:at.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),it==="image"&&k.jsx(k.Fragment,{children:V?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:V.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:V.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:V.width&&V.height?`${Math.round(V.width)}  ${Math.round(V.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:Yt,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:Qt,children:"Clear"})]}),tt&&k.jsx("span",{className:`image-message ${Ki?"success":"error"}`,children:tt})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:Yt,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:""}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),tt&&k.jsx("span",{className:`image-message ${Ki?"success":"error"}`,children:tt})]})}),it==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"controls-section glass-panel",children:k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:""}),k.jsx("input",{type:"text",placeholder:"Filter students",value:U,onChange:Nt=>G(Nt.target.value),className:"search-input"}),U&&k.jsx("button",{className:"clear-search-btn",onClick:()=>G(""),title:"Clear search",children:""})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:j,onChange:Nt=>I(Nt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${K==="flagged"?"active":""}`,onClick:()=>Q(Nt=>Nt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${X==="distracted"?"active":""}`,onClick:()=>Y(Nt=>Nt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:" Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:F,onChange:Nt=>W(Number(Nt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:Ts.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:""}),k.jsx("h2",{children:"Waiting for students to join"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):br.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:""}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',U,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>G(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${F}, 1fr)`},children:br.filter(Nt=>Nt&&Nt.studentId&&Nt.clientId).map(Nt=>k.jsx(Mb,{student:Nt,onClick:le,onToggleFlag:dt,teacherAnnotations:y[Nt.studentId]||[],sharedImage:jt,hideNames:j},Nt.studentId))})})})]}),k.jsx(Nb,{student:Oi,isOpen:!!Oi,isFlagged:Oi==null?void 0:Oi.isFlagged,onToggleFlag:dt,onClose:Bt,onAnnotate:vt,existingAnnotations:Oi?y[Oi.studentId]||[]:[],sharedImage:jt,generateStrokeId:HT}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:[" ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),rn&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>Ye(!1),children:k.jsxs("div",{className:"qr-modal",onClick:Nt=>Nt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",r]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>Ye(!1),children:""})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:mn&&k.jsx("img",{src:mn,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:pe,type:"text",value:`${window.location.origin}/student?room=${r}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:dn,children:"Copy Link"})]})]})]})]})})]})},C2={width:800,height:600};function kT(){const[o]=Sh(),t=o.get("room")||"load-test",n=o.get("name")||`TestStudent-${Date.now()}`,[a,r]=st.useState(null),[l]=st.useState(`test-student-${Math.random().toString(36).substr(2,9)}`),[f,d]=st.useState(!1),[g,m]=st.useState([]),[_,C]=st.useState([]),[E,R]=st.useState("pen"),[v,D]=st.useState(!1),L=st.useRef(!1);st.useEffect(()=>{(async()=>{try{const A=new ES.Realtime({authUrl:"/api/token",authParams:{clientId:l}});A.connection.on("connected",()=>{console.log("Connected to Ably"),d(!0)}),A.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),d(!1)});const T=A.channels.get(`room-${t}`);await new Promise((z,U)=>{T.once("attached",z),T.once("failed",U),T.attach()}),console.log(" Test Student channel attached");const y={name:n,role:"student",testMode:!0};console.log(" Entering presence with data:",y),await T.presence.enter(y),console.log(" Test Student entered presence as:",n),T.subscribe("student-layer",z=>{L.current=!0;const U=z.data;U.action==="clear"?m([]):U.lines&&m(G=>[...G,...U.lines]),setTimeout(()=>{L.current=!1},0)}),T.subscribe("teacher-layer",z=>{const U=z.data;U.action==="clear"?C([]):U.lines&&C(G=>[...G,...U.lines])}),r(T)}catch(A){console.error("Failed to initialize Ably:",A)}})()},[l,t,n]);const B=O=>{const A=O.target.getStage().getPointerPosition();if(!A)return;D(!0);const T={tool:E,points:[A.x,A.y],color:"black",strokeWidth:3};m([...g,T])},N=O=>{if(!v)return;const T=O.target.getStage().getPointerPosition();if(!T)return;const y=g[g.length-1];y&&(y.points=y.points.concat([T.x,T.y]),m([...g.slice(0,-1),y]))},M=()=>{if(!v||!a){D(!1);return}D(!1);const O=g[g.length-1];O&&O.points.length>=4&&a.publish("student-layer",{lines:[O]})},P=()=>{m([]),a&&a.publish("student-layer",{action:"clear"})};return k.jsxs("div",{className:"student-container",children:[k.jsxs("div",{className:"student-header",children:[k.jsxs("div",{className:"student-info",children:[k.jsx("span",{className:"student-name",children:n}),k.jsxs("span",{className:"room-code",children:["Room: ",t]}),k.jsx("span",{className:`connection-status ${f?"connected":"disconnected"}`,children:f?" Connected":" Disconnected"})]}),k.jsx("div",{className:"test-badge",children:"TEST MODE"})]}),k.jsxs("div",{className:"toolbar",children:[k.jsx("button",{className:`tool-btn ${E==="pen"?"active":""}`,onClick:()=>R("pen"),title:"Pen",children:" Pen"}),k.jsx("button",{className:`tool-btn ${E==="eraser"?"active":""}`,onClick:()=>R("eraser"),title:"Eraser",children:" Eraser"}),k.jsx("button",{className:"tool-btn",onClick:P,title:"Clear Canvas",children:" Clear"})]}),k.jsx("div",{className:"canvas-container",children:k.jsxs(Ug,{width:C2.width,height:C2.height,onMouseDown:B,onMousemove:N,onMouseup:M,onTouchStart:B,onTouchMove:N,onTouchEnd:M,className:"konva-stage",children:[k.jsx(Kr,{children:g.map((O,A)=>k.jsx(pl,{points:O.points,stroke:O.tool==="eraser"?"white":O.color,strokeWidth:O.tool==="eraser"?20:O.strokeWidth,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:O.tool==="eraser"?"destination-out":"source-over"},`student-${A}`))}),k.jsx(Kr,{listening:!1,children:_.map((O,A)=>k.jsx(pl,{points:O.points,stroke:"red",strokeWidth:O.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round",opacity:.7},`teacher-${A}`))})]})}),k.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",background:"#f0f0f0",padding:"10px",borderRadius:"8px",fontSize:"12px"},children:[k.jsx("div",{children:k.jsx("strong",{children:"Test Mode Instructions:"})}),k.jsx("div",{children:" No login required"}),k.jsx("div",{children:" Draw on canvas to test"}),k.jsx("div",{children:" Red lines are from teacher"})]})]})}const qT=()=>{const[o]=Sh(),t=yf(),n=()=>{const Bt=o.get("room");return Bt?Bt.toUpperCase():"load-test".toUpperCase()},[a]=ra.useState(n),[r,l]=st.useState(null),[f,d]=st.useState(null),[g,m]=st.useState(!1),[_]=st.useState(`test-teacher-${Math.random().toString(36).substring(7)}`),[C,E]=st.useState({}),[R,v]=st.useState(null),[D,L]=st.useState({}),[B,N]=st.useState(""),[M,P]=st.useState("all"),[O,A]=st.useState("all"),[T,y]=st.useState(()=>{const Bt=localStorage.getItem("teacherDashboardHideNames");return Bt?JSON.parse(Bt):!1}),[z,U]=st.useState(()=>{const Bt=localStorage.getItem("teacherDashboardCardsPerRow");return Bt?parseInt(Bt):3}),[G,K]=st.useState("blank"),[Q,X]=st.useState(null),[Y,j]=st.useState(null),[I,F]=st.useState(""),[W,it]=st.useState(!1),[Z,at]=st.useState(null),rt=st.useRef(null),V=st.useRef(null),J=st.useRef(null),[tt,nt]=st.useState(!1),[ht,wt]=st.useState(""),[jt,kt]=st.useState([]);st.useRef(!1),st.useEffect(()=>{rt.current=Z},[Z]);const ee=(Bt,vt="info")=>{const dt=Date.now();kt(Yt=>[...Yt,{id:dt,message:Bt,type:vt}]),setTimeout(()=>{kt(Yt=>Yt.filter(ae=>ae.id!==dt))},4e3)};st.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(T))},[T]),st.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",z.toString())},[z]),st.useEffect(()=>((async()=>{try{const vt=new vv.Realtime({authUrl:"/api/token",authParams:{clientId:_}});vt.connection.on("connected",()=>{console.log(" Test Teacher connected to Ably"),m(!0)}),vt.connection.on("disconnected",()=>{console.log(" Test Teacher disconnected"),m(!1)});const dt=vt.channels.get(`room-${a}`);await new Promise((Qt,Ae)=>{dt.once("attached",Qt),dt.once("failed",Ae),dt.attach()}),console.log(" Channel attached"),dt.presence.subscribe("enter",Qt=>{var Ae,be;console.log(" Member entered:",Qt.clientId,"Role:",(Ae=Qt.data)==null?void 0:Ae.role,"Data:",Qt.data),((be=Qt.data)==null?void 0:be.role)==="student"&&(console.log(" Adding student to dashboard:",Qt.data.name||Qt.clientId),E(Ie=>({...Ie,[Qt.clientId]:{clientId:Qt.clientId,name:Qt.data.name||Qt.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,testMode:Qt.data.testMode||!1,meta:{base:{width:800,height:600}}}})))}),dt.presence.subscribe("leave",Qt=>{console.log(" Student left:",Qt.clientId),E(Ae=>{const be={...Ae};return be[Qt.clientId]&&(be[Qt.clientId].isActive=!1),be})}),dt.presence.subscribe("update",Qt=>{var Ae;((Ae=Qt.data)==null?void 0:Ae.isVisible)!==void 0&&E(be=>{const Ie={...be};return Ie[Qt.clientId]&&(Ie[Qt.clientId].isVisible=Qt.data.isVisible),Ie})});const Yt=await dt.presence.get();console.log(` Found ${Yt.length} members in presence`);const ae={};Yt.forEach(Qt=>{var Ae,be,Ie,Cn,Re;console.log("  - Member:",Qt.clientId,"Role:",(Ae=Qt.data)==null?void 0:Ae.role,"Name:",(be=Qt.data)==null?void 0:be.name),((Ie=Qt.data)==null?void 0:Ie.role)==="student"&&(console.log("     Adding existing student:",Qt.data.name||Qt.clientId),ae[Qt.clientId]={clientId:Qt.clientId,name:Qt.data.name||Qt.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:((Cn=Qt.data)==null?void 0:Cn.isVisible)!==!1,testMode:((Re=Qt.data)==null?void 0:Re.testMode)||!1,meta:{base:{width:800,height:600}}})}),console.log(` Initialized with ${Object.keys(ae).length} students`),E(ae),dt.subscribe("student-layer",Qt=>{const{clientId:Ae}=Qt,be=Qt.data;E(Ie=>{const Cn={...Ie};return Cn[Ae]||(Cn[Ae]={clientId:Ae,name:Ae,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,meta:{base:{width:800,height:600}}}),be.action==="clear"?Cn[Ae].lines=[]:be.lines&&(Cn[Ae].lines=[...Cn[Ae].lines,...be.lines]),Cn[Ae].lastUpdate=Date.now(),Cn})}),await dt.presence.enter({role:"teacher",name:"Test Teacher",testMode:!0}),l(vt),d(dt)}catch(vt){console.error("Failed to connect to Ably:",vt)}})(),()=>{f&&f.presence.leave(),r&&r.close()}),[a,_]),st.useEffect(()=>{if(tt){const Bt=`${window.location.origin}/test/student?room=${a}`;Ob.toDataURL(Bt,{width:300,margin:2}).then(vt=>wt(vt)).catch(vt=>console.error("Failed to generate QR code:",vt))}},[tt,a]);const re=()=>{t("/")},Lt=()=>{nt(!0)},ge=()=>{f&&(f.publish("session-ended",{timestamp:Date.now(),reason:"teacher_ended"}),ee("Session ended","success"))},pe=Bt=>{v(C[Bt.clientId]||Bt)},rn=()=>{v(null)},Ye=Bt=>{if(!R||!f)return;const vt=R.clientId;L(dt=>({...dt,[vt]:Bt})),f.publish("teacher-annotation",{targetStudentId:vt,annotations:Bt,teacherId:_,timestamp:Date.now()}),console.log(" Published annotations for",vt)},mn=Bt=>{E(vt=>{const dt=vt[Bt];return dt?{...vt,[Bt]:{...dt,isFlagged:!dt.isFlagged}}:vt}),v(vt=>vt&&vt.clientId===Bt?{...vt,isFlagged:!vt.isFlagged}:vt)},Yn=Bt=>{const vt=document.createElement("canvas");vt.width=800,vt.height=600;const dt=vt.getContext("2d");if(dt.fillStyle="white",dt.fillRect(0,0,800,600),dt.strokeStyle="#ddd",dt.lineWidth=1,Bt==="hanzi")dt.strokeRect(250,150,300,300),dt.beginPath(),dt.moveTo(400,150),dt.lineTo(400,450),dt.moveTo(250,300),dt.lineTo(550,300),dt.stroke();else if(Bt==="graph-corner"){dt.beginPath(),dt.moveTo(100,500),dt.lineTo(100,100),dt.lineTo(700,100),dt.stroke();for(let ae=1;ae<10;ae++){const Qt=100+ae*60;dt.beginPath(),dt.moveTo(Qt,100),dt.lineTo(Qt,500),dt.stroke()}for(let ae=1;ae<8;ae++){const Qt=100+ae*50;dt.beginPath(),dt.moveTo(100,Qt),dt.lineTo(700,Qt),dt.stroke()}}else if(Bt==="graph-cross"){dt.beginPath(),dt.moveTo(50,300),dt.lineTo(750,300),dt.moveTo(400,50),dt.lineTo(400,550),dt.stroke();for(let ae=-6;ae<=6;ae++){if(ae===0)continue;const Qt=400+ae*50;dt.beginPath(),dt.moveTo(Qt,50),dt.lineTo(Qt,550),dt.stroke()}for(let ae=-5;ae<=5;ae++){if(ae===0)continue;const Qt=300+ae*50;dt.beginPath(),dt.moveTo(50,Qt),dt.lineTo(750,Qt),dt.stroke()}}const Yt=vt.toDataURL("image/png");X({type:Bt,dataUrl:Yt,width:800,height:600})},sn=()=>{V.current&&(V.current.value="",V.current.click())},Ot=async Bt=>{var dt;const vt=(dt=Bt.target.files)==null?void 0:dt[0];if(!vt){F("No file selected.");return}it(!0),F("");try{const{dataUrl:Yt,width:ae,height:Qt}=await Db(vt),Ae={dataUrl:Yt,width:ae,height:Qt,filename:vt.name,timestamp:Date.now()};j(Ae),F("Image ready to send.")}catch(Yt){console.error("Failed to upload image:",Yt),F("Upload failed. Please try again.")}finally{it(!1)}},Zt=()=>{j(null),F("")},Ce=()=>{if(!f)return;let Bt=null;G==="templates"&&Q?Bt=Q:G==="image"&&Y&&(Bt=Y),f.publish("teacher-action",{action:"send-blank-canvas",questionNumber:1,sharedImage:Bt,timestamp:Date.now()}),at(Bt||null),ee("Sent to all students","success"),console.log(" Sent to class:",G)},Ke=async()=>{const Bt=`${window.location.origin}/test/student?room=${a}`;try{await navigator.clipboard.writeText(Bt),ee("Link copied to clipboard","success")}catch(vt){console.error("Clipboard API failed:",vt);try{J.current&&(J.current.select(),document.execCommand("copy"),ee("Link copied to clipboard","success"))}catch(dt){console.error("Fallback copy failed:",dt),J.current&&J.current.select(),alert("Please copy the selected link manually")}}},Je=()=>Object.values(C).sort((Bt,vt)=>Bt.isActive&&!vt.isActive?-1:!Bt.isActive&&vt.isActive?1:(vt.lastUpdate||0)-(Bt.lastUpdate||0)),Te=()=>{const Bt=Je(),vt=B.trim().toLowerCase();return Bt.filter(dt=>{const Yt=vt?(dt.name||dt.clientId).toLowerCase().includes(vt):!0,ae=M==="all"||M==="flagged"&&dt.isFlagged,Qt=O==="all"||O==="distracted"&&dt.isVisible===!1&&dt.isActive;return Yt&&ae&&Qt})},lt=Je(),Tt=Te(),Rt=lt.filter(Bt=>Bt.isActive).length,qt=R?C[R.clientId]||R:null,le=I?!/fail|no file/i.test(I):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:jt.map(Bt=>k.jsxs("div",{className:`toast toast-${Bt.type}`,children:[Bt.type==="success"&&k.jsx("span",{className:"toast-icon",children:""}),Bt.type==="info"&&k.jsx("span",{className:"toast-icon",children:""}),Bt.type==="error"&&k.jsx("span",{className:"toast-icon",children:""}),k.jsx("span",{className:"toast-message",children:Bt.message})]},Bt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsx("button",{className:"back-link",onClick:re,children:" Exit class"}),k.jsxs("section",{className:"hero-card glass-panel",children:[k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:" Test Teacher dashboard"}),k.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:Lt,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:a})]}),k.jsx("button",{className:"end-session-btn",onClick:ge,title:"End session and logout all students",children:"End Session"}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Test mode"}),k.jsx("span",{className:`status-pill connection-pill ${g?"online":"offline"}`,children:g?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:Rt}),k.jsx("span",{children:"online"})]})]})]})]}),k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:""}),k.jsx("input",{type:"text",placeholder:"Filter students",value:B,onChange:Bt=>N(Bt.target.value),className:"search-input"}),B&&k.jsx("button",{className:"clear-search-btn",onClick:()=>N(""),title:"Clear search",children:""})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:T,onChange:Bt=>y(Bt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${M==="flagged"?"active":""}`,onClick:()=>P(Bt=>Bt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${O==="distracted"?"active":""}`,onClick:()=>A(Bt=>Bt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:" Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:z,onChange:Bt=>U(Number(Bt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})]}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),Q&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",Q.type==="hanzi"?"Hanzi":Q.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:Ce,disabled:G==="image"&&!Y,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${G==="blank"?"active":""}`,onClick:()=>{K("blank"),X(null),j(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${G==="templates"?"active":""}`,onClick:()=>{K("templates"),j(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${G==="image"?"active":""} ${Y?"ready":""}`,onClick:()=>{K("image"),X(null)},disabled:W,children:W?"Uploading":"Send image"})]}),k.jsx("input",{ref:V,type:"file",accept:"image/*",onChange:Ot,style:{display:"none"}}),G==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="hanzi"?"active":""}`,onClick:()=>Yn("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="graph-corner"?"active":""}`,onClick:()=>Yn("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="graph-cross"?"active":""}`,onClick:()=>Yn("graph-cross"),children:"Graph (cross)"})]}),Q&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:Q.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),G==="image"&&k.jsx(k.Fragment,{children:Y?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:Y.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:Y.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:Y.width&&Y.height?`${Math.round(Y.width)}  ${Math.round(Y.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:sn,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:Zt,children:"Clear"})]}),I&&k.jsx("span",{className:`image-message ${le?"success":"error"}`,children:I})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:sn,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:""}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),I&&k.jsx("span",{className:`image-message ${le?"success":"error"}`,children:I})]})}),G==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:lt.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:""}),k.jsx("h2",{children:"Waiting for students to join"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):Tt.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:""}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',B,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>N(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${z}, 1fr)`},children:Tt.filter(Bt=>Bt&&Bt.clientId).map(Bt=>k.jsx(Mb,{student:Bt,onClick:pe,onToggleFlag:mn,teacherAnnotations:D[Bt.clientId]||[],sharedImage:Z,hideNames:T},Bt.clientId))})})})]}),k.jsx(Nb,{student:qt,isOpen:!!qt,isFlagged:qt==null?void 0:qt.isFlagged,onToggleFlag:mn,onClose:rn,onAnnotate:Ye,existingAnnotations:qt?D[qt.clientId]||[]:[],sharedImage:Z}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:[" ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),tt&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>nt(!1),children:k.jsxs("div",{className:"qr-modal",onClick:Bt=>Bt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",a]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>nt(!1),children:""})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:ht&&k.jsx("img",{src:ht,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:J,type:"text",value:`${window.location.origin}/test/student?room=${a}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:Ke,children:"Copy Link"})]})]})]})]})})]})};function VT(){return k.jsx(w3,{children:k.jsxs(E3,{children:[k.jsx(gu,{path:"/",element:k.jsx(R3,{})}),k.jsx(gu,{path:"/student-login",element:k.jsx(gT,{})}),k.jsx(gu,{path:"/student",element:k.jsx(hT,{})}),k.jsx(gu,{path:"/teacher",element:k.jsx(IT,{})}),k.jsx(gu,{path:"/test/student",element:k.jsx(kT,{})}),k.jsx(gu,{path:"/test/teacher",element:k.jsx(qT,{})})]})})}M4.createRoot(document.getElementById("root")).render(k.jsx(ra.StrictMode,{children:k.jsx(VT,{})}));
