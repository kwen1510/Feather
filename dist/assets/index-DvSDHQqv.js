function Q4(o,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in o)){const l=Object.getOwnPropertyDescriptor(i,r);l&&Object.defineProperty(o,r,l.get?l:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function cf(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function f2(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var t=o.default;if(typeof t=="function"){var n=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(i){var r=Object.getOwnPropertyDescriptor(o,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return o[i]}})}),n}var hp={exports:{}},Ih={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function X4(){if(n1)return Ih;n1=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(i,r,l){var f=null;if(l!==void 0&&(f=""+l),r.key!==void 0&&(f=""+r.key),"key"in r){l={};for(var d in r)d!=="key"&&(l[d]=r[d])}else l=r;return r=l.ref,{$$typeof:o,type:i,key:f,ref:r!==void 0?r:null,props:l}}return Ih.Fragment=t,Ih.jsx=n,Ih.jsxs=n,Ih}var i1;function F4(){return i1||(i1=1,hp.exports=X4()),hp.exports}var et=F4(),dp={exports:{}},be={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a1;function J4(){if(a1)return be;a1=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),f=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),E=Symbol.iterator;function R(J){return J===null||typeof J!="object"?null:(J=E&&J[E]||J["@@iterator"],typeof J=="function"?J:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,z={};function G(J,rt,it){this.props=J,this.context=rt,this.refs=z,this.updater=it||v}G.prototype.isReactComponent={},G.prototype.setState=function(J,rt){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,rt,"setState")},G.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function N(){}N.prototype=G.prototype;function M(J,rt,it){this.props=J,this.context=rt,this.refs=z,this.updater=it||v}var L=M.prototype=new N;L.constructor=M,D(L,G.prototype),L.isPureReactComponent=!0;var w=Array.isArray;function A(){}var O={H:null,A:null,T:null,S:null},y=Object.prototype.hasOwnProperty;function B(J,rt,it){var q=it.ref;return{$$typeof:o,type:J,key:rt,ref:q!==void 0?q:null,props:it}}function U(J,rt){return B(J.type,rt,J.props)}function P(J){return typeof J=="object"&&J!==null&&J.$$typeof===o}function K(J){var rt={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(it){return rt[it]})}var Y=/\/+/g;function Q(J,rt){return typeof J=="object"&&J!==null&&J.key!=null?K(""+J.key):rt.toString(36)}function V(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(A,A):(J.status="pending",J.then(function(rt){J.status==="pending"&&(J.status="fulfilled",J.value=rt)},function(rt){J.status==="pending"&&(J.status="rejected",J.reason=rt)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function j(J,rt,it,q,F){var $=typeof J;($==="undefined"||$==="boolean")&&(J=null);var nt=!1;if(J===null)nt=!0;else switch($){case"bigint":case"string":case"number":nt=!0;break;case"object":switch(J.$$typeof){case o:case t:nt=!0;break;case _:return nt=J._init,j(nt(J._payload),rt,it,q,F)}}if(nt)return F=F(J),nt=q===""?"."+Q(J,0):q,w(F)?(it="",nt!=null&&(it=nt.replace(Y,"$&/")+"/"),j(F,rt,it,"",function(jt){return jt})):F!=null&&(P(F)&&(F=U(F,it+(F.key==null||J&&J.key===F.key?"":(""+F.key).replace(Y,"$&/")+"/")+nt)),rt.push(F)),1;nt=0;var ht=q===""?".":q+":";if(w(J))for(var Tt=0;Tt<J.length;Tt++)q=J[Tt],$=ht+Q(q,Tt),nt+=j(q,rt,it,$,F);else if(Tt=R(J),typeof Tt=="function")for(J=Tt.call(J),Tt=0;!(q=J.next()).done;)q=q.value,$=ht+Q(q,Tt++),nt+=j(q,rt,it,$,F);else if($==="object"){if(typeof J.then=="function")return j(V(J),rt,it,q,F);throw rt=String(J),Error("Objects are not valid as a React child (found: "+(rt==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":rt)+"). If you meant to render a collection of children, use an array instead.")}return nt}function I(J,rt,it){if(J==null)return J;var q=[],F=0;return j(J,q,"","",function($){return rt.call(it,$,F++)}),q}function X(J){if(J._status===-1){var rt=J._result;rt=rt(),rt.then(function(it){(J._status===0||J._status===-1)&&(J._status=1,J._result=it)},function(it){(J._status===0||J._status===-1)&&(J._status=2,J._result=it)}),J._status===-1&&(J._status=0,J._result=rt)}if(J._status===1)return J._result.default;throw J._result}var Z=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var rt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(rt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},at={map:I,forEach:function(J,rt,it){I(J,function(){rt.apply(this,arguments)},it)},count:function(J){var rt=0;return I(J,function(){rt++}),rt},toArray:function(J){return I(J,function(rt){return rt})||[]},only:function(J){if(!P(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return be.Activity=C,be.Children=at,be.Component=G,be.Fragment=n,be.Profiler=r,be.PureComponent=M,be.StrictMode=i,be.Suspense=g,be.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,be.__COMPILER_RUNTIME={__proto__:null,c:function(J){return O.H.useMemoCache(J)}},be.cache=function(J){return function(){return J.apply(null,arguments)}},be.cacheSignal=function(){return null},be.cloneElement=function(J,rt,it){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var q=D({},J.props),F=J.key;if(rt!=null)for($ in rt.key!==void 0&&(F=""+rt.key),rt)!y.call(rt,$)||$==="key"||$==="__self"||$==="__source"||$==="ref"&&rt.ref===void 0||(q[$]=rt[$]);var $=arguments.length-2;if($===1)q.children=it;else if(1<$){for(var nt=Array($),ht=0;ht<$;ht++)nt[ht]=arguments[ht+2];q.children=nt}return B(J.type,F,q)},be.createContext=function(J){return J={$$typeof:f,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:l,_context:J},J},be.createElement=function(J,rt,it){var q,F={},$=null;if(rt!=null)for(q in rt.key!==void 0&&($=""+rt.key),rt)y.call(rt,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(F[q]=rt[q]);var nt=arguments.length-2;if(nt===1)F.children=it;else if(1<nt){for(var ht=Array(nt),Tt=0;Tt<nt;Tt++)ht[Tt]=arguments[Tt+2];F.children=ht}if(J&&J.defaultProps)for(q in nt=J.defaultProps,nt)F[q]===void 0&&(F[q]=nt[q]);return B(J,$,F)},be.createRef=function(){return{current:null}},be.forwardRef=function(J){return{$$typeof:d,render:J}},be.isValidElement=P,be.lazy=function(J){return{$$typeof:_,_payload:{_status:-1,_result:J},_init:X}},be.memo=function(J,rt){return{$$typeof:m,type:J,compare:rt===void 0?null:rt}},be.startTransition=function(J){var rt=O.T,it={};O.T=it;try{var q=J(),F=O.S;F!==null&&F(it,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(A,Z)}catch($){Z($)}finally{rt!==null&&it.types!==null&&(rt.types=it.types),O.T=rt}},be.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},be.use=function(J){return O.H.use(J)},be.useActionState=function(J,rt,it){return O.H.useActionState(J,rt,it)},be.useCallback=function(J,rt){return O.H.useCallback(J,rt)},be.useContext=function(J){return O.H.useContext(J)},be.useDebugValue=function(){},be.useDeferredValue=function(J,rt){return O.H.useDeferredValue(J,rt)},be.useEffect=function(J,rt){return O.H.useEffect(J,rt)},be.useEffectEvent=function(J){return O.H.useEffectEvent(J)},be.useId=function(){return O.H.useId()},be.useImperativeHandle=function(J,rt,it){return O.H.useImperativeHandle(J,rt,it)},be.useInsertionEffect=function(J,rt){return O.H.useInsertionEffect(J,rt)},be.useLayoutEffect=function(J,rt){return O.H.useLayoutEffect(J,rt)},be.useMemo=function(J,rt){return O.H.useMemo(J,rt)},be.useOptimistic=function(J,rt){return O.H.useOptimistic(J,rt)},be.useReducer=function(J,rt,it){return O.H.useReducer(J,rt,it)},be.useRef=function(J){return O.H.useRef(J)},be.useState=function(J){return O.H.useState(J)},be.useSyncExternalStore=function(J,rt,it){return O.H.useSyncExternalStore(J,rt,it)},be.useTransition=function(){return O.H.useTransition()},be.version="19.2.0",be}var r1;function Sg(){return r1||(r1=1,dp.exports=J4()),dp.exports}var mt=Sg();const Hn=cf(mt),Z4=Q4({__proto__:null,default:Hn},[mt]);var gp={exports:{}},kh={},pp={exports:{}},mp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s1;function W4(){return s1||(s1=1,(function(o){function t(j,I){var X=j.length;j.push(I);t:for(;0<X;){var Z=X-1>>>1,at=j[Z];if(0<r(at,I))j[Z]=I,j[X]=at,X=Z;else break t}}function n(j){return j.length===0?null:j[0]}function i(j){if(j.length===0)return null;var I=j[0],X=j.pop();if(X!==I){j[0]=X;t:for(var Z=0,at=j.length,J=at>>>1;Z<J;){var rt=2*(Z+1)-1,it=j[rt],q=rt+1,F=j[q];if(0>r(it,X))q<at&&0>r(F,it)?(j[Z]=F,j[q]=X,Z=q):(j[Z]=it,j[rt]=X,Z=rt);else if(q<at&&0>r(F,X))j[Z]=F,j[q]=X,Z=q;else break t}}return I}function r(j,I){var X=j.sortIndex-I.sortIndex;return X!==0?X:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,z=!1,G=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function L(j){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=j)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function w(j){if(D=!1,L(j),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&V(w,I.startTime-j)}}var A=!1,O=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,A){var j=o.unstable_now();B=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(O),O=-1),R=!0;var X=E;try{e:{for(L(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var Z=C.callback;if(typeof Z=="function"){C.callback=null,E=C.priorityLevel;var at=Z(C.expirationTime<=j);if(j=o.unstable_now(),typeof at=="function"){C.callback=at,L(j),I=!0;break e}C===n(g)&&i(g),L(j)}else i(g);C=n(g)}if(C!==null)I=!0;else{var J=n(m);J!==null&&V(w,J.startTime-j),I=!1}}break t}finally{C=null,E=X,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Q=Y.port2;Y.port1.onmessage=P,K=function(){Q.postMessage(null)}}else K=function(){G(P,0)};function V(j,I){O=G(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var X=E;E=I;try{return j()}finally{E=X}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=E;E=j;try{return I()}finally{E=X}},o.unstable_scheduleCallback=function(j,I,X){var Z=o.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Z+X:Z):X=Z,j){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=X+at,j={id:_++,callback:I,priorityLevel:j,startTime:X,expirationTime:at,sortIndex:-1},X>Z?(j.sortIndex=X,t(m,j),n(g)===null&&j===n(m)&&(D?(N(O),O=-1):D=!0,V(w,X-Z))):(j.sortIndex=at,t(g,j),v||R||(v=!0,A||(A=!0,K()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var X=E;E=I;try{return j.apply(this,arguments)}finally{E=X}}}})(mp)),mp}var l1;function $4(){return l1||(l1=1,pp.exports=W4()),pp.exports}var vp={exports:{}},Pi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o1;function t3(){if(o1)return Pi;o1=1;var o=Sg();function t(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(g,m,_){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:C==null?null:""+C,children:g,containerInfo:m,implementation:_}}var f=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Pi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Pi.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(g,m,null,_)},Pi.flushSync=function(g){var m=f.T,_=i.p;try{if(f.T=null,i.p=2,g)return g()}finally{f.T=m,i.p=_,i.d.f()}},Pi.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},Pi.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Pi.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,R=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:C,integrity:E,fetchPriority:R}):_==="script"&&i.d.X(g,{crossOrigin:C,integrity:E,fetchPriority:R,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Pi.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=d(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},Pi.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin);i.d.L(g,_,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Pi.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=d(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},Pi.requestFormReset=function(g){i.d.r(g)},Pi.unstable_batchedUpdates=function(g,m){return g(m)},Pi.useFormState=function(g,m,_){return f.H.useFormState(g,m,_)},Pi.useFormStatus=function(){return f.H.useHostTransitionStatus()},Pi.version="19.2.0",Pi}var u1;function h2(){if(u1)return vp.exports;u1=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),vp.exports=t3(),vp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1;function e3(){if(c1)return kh;c1=1;var o=$4(),t=Sg(),n=h2();function i(e){var a="https://react.dev/errors/"+e;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+e+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var a=e,c=e;if(e.alternate)for(;a.return;)a=a.return;else{e=a;do a=e,(a.flags&4098)!==0&&(c=a.return),e=a.return;while(e)}return a.tag===3?c:null}function f(e){if(e.tag===13){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function d(e){if(e.tag===31){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function g(e){if(l(e)!==e)throw Error(i(188))}function m(e){var a=e.alternate;if(!a){if(a=l(e),a===null)throw Error(i(188));return a!==e?null:e}for(var c=e,h=a;;){var b=c.return;if(b===null)break;var T=b.alternate;if(T===null){if(h=b.return,h!==null){c=h;continue}break}if(b.child===T.child){for(T=b.child;T;){if(T===c)return g(b),e;if(T===h)return g(b),a;T=T.sibling}throw Error(i(188))}if(c.return!==h.return)c=b,h=T;else{for(var k=!1,W=b.child;W;){if(W===c){k=!0,c=b,h=T;break}if(W===h){k=!0,h=b,c=T;break}W=W.sibling}if(!k){for(W=T.child;W;){if(W===c){k=!0,c=T,h=b;break}if(W===h){k=!0,h=T,c=b;break}W=W.sibling}if(!k)throw Error(i(189))}}if(c.alternate!==h)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?e:a}function _(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e;for(e=e.child;e!==null;){if(a=_(e),a!==null)return a;e=e.sibling}return null}var C=Object.assign,E=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),M=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function K(e){return e===null||typeof e!="object"?null:(e=P&&e[P]||e["@@iterator"],typeof e=="function"?e:null)}var Y=Symbol.for("react.client.reference");function Q(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Y?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case D:return"Fragment";case G:return"Profiler";case z:return"StrictMode";case w:return"Suspense";case A:return"SuspenseList";case B:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case M:return e.displayName||"Context";case N:return(e._context.displayName||"Context")+".Consumer";case L:var a=e.render;return e=e.displayName,e||(e=a.displayName||a.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case O:return a=e.displayName||null,a!==null?a:Q(e.type)||"Memo";case y:a=e._payload,e=e._init;try{return Q(e(a))}catch{}}return null}var V=Array.isArray,j=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},Z=[],at=-1;function J(e){return{current:e}}function rt(e){0>at||(e.current=Z[at],Z[at]=null,at--)}function it(e,a){at++,Z[at]=e.current,e.current=a}var q=J(null),F=J(null),$=J(null),nt=J(null);function ht(e,a){switch(it($,a),it(F,e),it(q,null),a.nodeType){case 9:case 11:e=(e=a.documentElement)&&(e=e.namespaceURI)?Av(e):0;break;default:if(e=a.tagName,a=a.namespaceURI)a=Av(a),e=Ov(a,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}rt(q),it(q,e)}function Tt(){rt(q),rt(F),rt($)}function jt(e){e.memoizedState!==null&&it(nt,e);var a=q.current,c=Ov(a,e.type);a!==c&&(it(F,e),it(q,c))}function Kt(e){F.current===e&&(rt(q),rt(F)),nt.current===e&&(rt(nt),Lh._currentValue=X)}var Wt,ge;function Pt(e){if(Wt===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);Wt=a&&a[1]||"",ge=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wt+e+ge}var pe=!1;function xe(e,a){if(!e||pe)return"";pe=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var wt=function(){throw Error()};if(Object.defineProperty(wt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(wt,[])}catch(Ct){var _t=Ct}Reflect.construct(e,[],wt)}else{try{wt.call()}catch(Ct){_t=Ct}e.call(wt.prototype)}}else{try{throw Error()}catch(Ct){_t=Ct}(wt=e())&&typeof wt.catch=="function"&&wt.catch(function(){})}}catch(Ct){if(Ct&&_t&&typeof Ct.stack=="string")return[Ct.stack,_t.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=h.DetermineComponentFrameRoot(),k=T[0],W=T[1];if(k&&W){var lt=k.split(`
`),yt=W.split(`
`);for(b=h=0;h<lt.length&&!lt[h].includes("DetermineComponentFrameRoot");)h++;for(;b<yt.length&&!yt[b].includes("DetermineComponentFrameRoot");)b++;if(h===lt.length||b===yt.length)for(h=lt.length-1,b=yt.length-1;1<=h&&0<=b&&lt[h]!==yt[b];)b--;for(;1<=h&&0<=b;h--,b--)if(lt[h]!==yt[b]){if(h!==1||b!==1)do if(h--,b--,0>b||lt[h]!==yt[b]){var At=`
`+lt[h].replace(" at new "," at ");return e.displayName&&At.includes("<anonymous>")&&(At=At.replace("<anonymous>",e.displayName)),At}while(1<=h&&0<=b);break}}}finally{pe=!1,Error.prepareStackTrace=c}return(c=e?e.displayName||e.name:"")?Pt(c):""}function zt(e,a){switch(e.tag){case 26:case 27:case 5:return Pt(e.type);case 16:return Pt("Lazy");case 13:return e.child!==a&&a!==null?Pt("Suspense Fallback"):Pt("Suspense");case 19:return Pt("SuspenseList");case 0:case 15:return xe(e.type,!1);case 11:return xe(e.type.render,!1);case 1:return xe(e.type,!0);case 31:return Pt("Activity");default:return""}}function ft(e){try{var a="",c=null;do a+=zt(e,c),c=e,e=e.return;while(e);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var xt=Object.prototype.hasOwnProperty,Qt=o.unstable_scheduleCallback,Jt=o.unstable_cancelCallback,$t=o.unstable_shouldYield,ve=o.unstable_requestPaint,ae=o.unstable_now,ln=o.unstable_getCurrentPriorityLevel,Sn=o.unstable_ImmediatePriority,We=o.unstable_UserBlockingPriority,ut=o.unstable_NormalPriority,Ot=o.unstable_LowPriority,Mt=o.unstable_IdlePriority,Ft=o.log,Ee=o.unstable_setDisableYieldValue,dn=null,An=null;function ki(e){if(typeof Ft=="function"&&Ee(e),An&&typeof An.setStrictMode=="function")try{An.setStrictMode(dn,e)}catch{}}var hi=Math.clz32?Math.clz32:cl,Su=Math.log,er=Math.LN2;function cl(e){return e>>>=0,e===0?32:31-(Su(e)/er|0)|0}var Gt=256,Yt=262144,ne=4194304;function Ae(e){var a=e&42;if(a!==0)return a;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function qt(e,a,c){var h=e.pendingLanes;if(h===0)return 0;var b=0,T=e.suspendedLanes,k=e.pingedLanes;e=e.warmLanes;var W=h&134217727;return W!==0?(h=W&~T,h!==0?b=Ae(h):(k&=W,k!==0?b=Ae(k):c||(c=W&~e,c!==0&&(b=Ae(c))))):(W=h&~T,W!==0?b=Ae(W):k!==0?b=Ae(k):c||(c=h&~e,c!==0&&(b=Ae(c)))),b===0?0:a!==0&&a!==b&&(a&T)===0&&(T=b&-b,c=a&-a,T>=c||T===32&&(c&4194048)!==0)?a:b}function jn(e,a){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&a)===0}function he(e,a){switch(e){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ze(){var e=ne;return ne<<=1,(ne&62914560)===0&&(ne=4194304),e}function me(e){for(var a=[],c=0;31>c;c++)a.push(e);return a}function Wn(e,a){e.pendingLanes|=a,a!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function nr(e,a,c,h,b,T){var k=e.pendingLanes;e.pendingLanes=c,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=c,e.entangledLanes&=c,e.errorRecoveryDisabledLanes&=c,e.shellSuspendCounter=0;var W=e.entanglements,lt=e.expirationTimes,yt=e.hiddenUpdates;for(c=k&~c;0<c;){var At=31-hi(c),wt=1<<At;W[At]=0,lt[At]=-1;var _t=yt[At];if(_t!==null)for(yt[At]=null,At=0;At<_t.length;At++){var Ct=_t[At];Ct!==null&&(Ct.lane&=-536870913)}c&=~wt}h!==0&&cs(e,h,0),T!==0&&b===0&&e.tag!==0&&(e.suspendedLanes|=T&~(k&~a))}function cs(e,a,c){e.pendingLanes|=a,e.suspendedLanes&=~a;var h=31-hi(a);e.entangledLanes|=a,e.entanglements[h]=e.entanglements[h]|1073741824|c&261930}function vf(e,a){var c=e.entangledLanes|=a;for(e=e.entanglements;c;){var h=31-hi(c),b=1<<h;b&a|e[h]&a&&(e[h]|=a),c&=~b}}function co(e,a){var c=a&-a;return c=(c&42)!==0?1:fo(c),(c&(e.suspendedLanes|a))!==0?0:c}function fo(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ho(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ir(){var e=I.p;return e!==0?e:(e=window.event,e===void 0?32:Fv(e.type))}function ar(e,a){var c=I.p;try{return I.p=e,a()}finally{I.p=c}}var na=Math.random().toString(36).slice(2),Pn="__reactFiber$"+na,Vn="__reactProps$"+na,wa="__reactContainer$"+na,bu="__reactEvents$"+na,gd="__reactListeners$"+na,pd="__reactHandles$"+na,_u="__reactResources$"+na,fs="__reactMarker$"+na;function bn(e){delete e[Pn],delete e[Vn],delete e[bu],delete e[gd],delete e[pd]}function jr(e){var a=e[Pn];if(a)return a;for(var c=e.parentNode;c;){if(a=c[wa]||c[Pn]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(e=jv(e);e!==null;){if(c=e[Pn])return c;e=jv(e)}return a}e=c,c=e.parentNode}return null}function Ur(e){if(e=e[Pn]||e[wa]){var a=e.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return e}return null}function fl(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e.stateNode;throw Error(i(33))}function hs(e){var a=e[_u];return a||(a=e[_u]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Yn(e){e[fs]=!0}var Eu=new Set,Cu={};function rr(e,a){In(e,a),In(e+"Capture",a)}function In(e,a){for(Cu[e]=a,e=0;e<a.length;e++)Eu.add(a[e])}var Un=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Tu={},hl={};function Au(e){return xt.call(hl,e)?!0:xt.call(Tu,e)?!1:Un.test(e)?hl[e]=!0:(Tu[e]=!0,!1)}function dl(e,a,c){if(Au(a))if(c===null)e.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":e.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){e.removeAttribute(a);return}}e.setAttribute(a,""+c)}}function ia(e,a,c){if(c===null)e.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttribute(a,""+c)}}function aa(e,a,c,h){if(h===null)e.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(c);return}e.setAttributeNS(a,c,""+h)}}function xi(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ou(e){var a=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function md(e,a,c){var h=Object.getOwnPropertyDescriptor(e.constructor.prototype,a);if(!e.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var b=h.get,T=h.set;return Object.defineProperty(e,a,{configurable:!0,get:function(){return b.call(this)},set:function(k){c=""+k,T.call(this,k)}}),Object.defineProperty(e,a,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(k){c=""+k},stopTracking:function(){e._valueTracker=null,delete e[a]}}}}function Ru(e){if(!e._valueTracker){var a=Ou(e)?"checked":"value";e._valueTracker=md(e,a,""+e[a])}}function yf(e){if(!e)return!1;var a=e._valueTracker;if(!a)return!0;var c=a.getValue(),h="";return e&&(h=Ou(e)?e.checked?"true":"false":e.value),e=h,e!==c?(a.setValue(e),!0):!1}function go(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var vd=/[\n"\\]/g;function qi(e){return e.replace(vd,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function po(e,a,c,h,b,T,k,W){e.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?e.type=k:e.removeAttribute("type"),a!=null?k==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+xi(a)):e.value!==""+xi(a)&&(e.value=""+xi(a)):k!=="submit"&&k!=="reset"||e.removeAttribute("value"),a!=null?bf(e,k,xi(a)):c!=null?bf(e,k,xi(c)):h!=null&&e.removeAttribute("value"),b==null&&T!=null&&(e.defaultChecked=!!T),b!=null&&(e.checked=b&&typeof b!="function"&&typeof b!="symbol"),W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?e.name=""+xi(W):e.removeAttribute("name")}function Sf(e,a,c,h,b,T,k,W){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(e.type=T),a!=null||c!=null){if(!(T!=="submit"&&T!=="reset"||a!=null)){Ru(e);return}c=c!=null?""+xi(c):"",a=a!=null?""+xi(a):c,W||a===e.value||(e.value=a),e.defaultValue=a}h=h??b,h=typeof h!="function"&&typeof h!="symbol"&&!!h,e.checked=W?e.checked:!!h,e.defaultChecked=!!h,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(e.name=k),Ru(e)}function bf(e,a,c){a==="number"&&go(e.ownerDocument)===e||e.defaultValue===""+c||(e.defaultValue=""+c)}function ds(e,a,c,h){if(e=e.options,a){a={};for(var b=0;b<c.length;b++)a["$"+c[b]]=!0;for(c=0;c<e.length;c++)b=a.hasOwnProperty("$"+e[c].value),e[c].selected!==b&&(e[c].selected=b),b&&h&&(e[c].defaultSelected=!0)}else{for(c=""+xi(c),a=null,b=0;b<e.length;b++){if(e[b].value===c){e[b].selected=!0,h&&(e[b].defaultSelected=!0);return}a!==null||e[b].disabled||(a=e[b])}a!==null&&(a.selected=!0)}}function _f(e,a,c){if(a!=null&&(a=""+xi(a),a!==e.value&&(e.value=a),c==null)){e.defaultValue!==a&&(e.defaultValue=a);return}e.defaultValue=c!=null?""+xi(c):""}function Ef(e,a,c,h){if(a==null){if(h!=null){if(c!=null)throw Error(i(92));if(V(h)){if(1<h.length)throw Error(i(93));h=h[0]}c=h}c==null&&(c=""),a=c}c=xi(a),e.defaultValue=c,h=e.textContent,h===c&&h!==""&&h!==null&&(e.value=h),Ru(e)}function Br(e,a){if(a){var c=e.firstChild;if(c&&c===e.lastChild&&c.nodeType===3){c.nodeValue=a;return}}e.textContent=a}var yd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cf(e,a,c){var h=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="":h?e.setProperty(a,c):typeof c!="number"||c===0||yd.has(a)?a==="float"?e.cssFloat=c:e[a]=(""+c).trim():e[a]=c+"px"}function Tf(e,a,c){if(a!=null&&typeof a!="object")throw Error(i(62));if(e=e.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?e.setProperty(h,""):h==="float"?e.cssFloat="":e[h]="");for(var b in a)h=a[b],a.hasOwnProperty(b)&&c[b]!==h&&Cf(e,b,h)}else for(var T in a)a.hasOwnProperty(T)&&Cf(e,T,a[T])}function wu(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mo(e){return Mg.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Mi(){}var gl=null;function xu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var sr=null,xa=null;function Af(e){var a=Ur(e);if(a&&(e=a.stateNode)){var c=e[Vn]||null;t:switch(e=a.stateNode,a.type){case"input":if(po(e,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=e;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+qi(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var h=c[a];if(h!==e&&h.form===e.form){var b=h[Vn]||null;if(!b)throw Error(i(90));po(h,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(a=0;a<c.length;a++)h=c[a],h.form===e.form&&yf(h)}break t;case"textarea":_f(e,c.value,c.defaultValue);break t;case"select":a=c.value,a!=null&&ds(e,!!c.multiple,a,!1)}}}var Mu=!1;function Of(e,a,c){if(Mu)return e(a,c);Mu=!0;try{var h=e(a);return h}finally{if(Mu=!1,(sr!==null||xa!==null)&&(Il(),sr&&(a=sr,e=xa,xa=sr=null,Af(a),e)))for(a=0;a<e.length;a++)Af(e[a])}}function pl(e,a){var c=e.stateNode;if(c===null)return null;var h=c[Vn]||null;if(h===null)return null;c=h[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break t;default:e=!1}if(e)return null;if(c&&typeof c!="function")throw Error(i(231,a,typeof c));return c}var Ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nu=!1;if(Ma)try{var gs={};Object.defineProperty(gs,"passive",{get:function(){Nu=!0}}),window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{Nu=!1}var lr=null,Du=null,ml=null;function Rf(){if(ml)return ml;var e,a=Du,c=a.length,h,b="value"in lr?lr.value:lr.textContent,T=b.length;for(e=0;e<c&&a[e]===b[e];e++);var k=c-e;for(h=1;h<=k&&a[c-h]===b[T-h];h++);return ml=b.slice(e,1<h?1-h:void 0)}function vo(e){var a=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&a===13&&(e=13)):e=a,e===10&&(e=13),32<=e||e===13?e:0}function yo(){return!0}function ju(){return!1}function yi(e){function a(c,h,b,T,k){this._reactName=c,this._targetInst=b,this.type=h,this.nativeEvent=T,this.target=k,this.currentTarget=null;for(var W in e)e.hasOwnProperty(W)&&(c=e[W],this[W]=c?c(T):T[W]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?yo:ju,this.isPropagationStopped=ju,this}return C(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=yo)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=yo)},persist:function(){},isPersistent:yo}),a}var zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uu=yi(zr),So=C({},zr,{view:0,detail:0}),bd=yi(So),ps,bo,Lr,_o=C({},So,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Lr&&(Lr&&e.type==="mousemove"?(ps=e.screenX-Lr.screenX,bo=e.screenY-Lr.screenY):bo=ps=0,Lr=e),ps)},movementY:function(e){return"movementY"in e?e.movementY:bo}}),wf=yi(_o),Bu=C({},_o,{dataTransfer:0}),Eo=yi(Bu),zu=C({},So,{relatedTarget:0}),Lu=yi(zu),_d=C({},zr,{animationName:0,elapsedTime:0,pseudoElement:0}),Gr=yi(_d),Ed=C({},zr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hr=yi(Ed),or=C({},zr,{data:0}),Co=yi(or),xf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Td={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ms(e){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(e):(e=Td[e])?!!a[e]:!1}function vl(){return ms}var Ad=C({},So,{key:function(e){if(e.key){var a=xf[e.key]||e.key;if(a!=="Unidentified")return a}return e.type==="keypress"?(e=vo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Cd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vl,charCode:function(e){return e.type==="keypress"?vo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Mf=yi(Ad),Od=C({},_o,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nf=yi(Od),Ng=C({},So,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vl}),$n=yi(Ng),Rd=C({},zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),wd=yi(Rd),xd=C({},_o,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Md=yi(xd),Nd=C({},zr,{newState:0,oldState:0}),Gu=yi(Nd),Df=[9,13,27,32],Hu=Ma&&"CompositionEvent"in window,yl=null;Ma&&"documentMode"in document&&(yl=document.documentMode);var Dd=Ma&&"TextEvent"in window&&!yl,Pu=Ma&&(!Hu||yl&&8<yl&&11>=yl),Iu=" ",jf=!1;function ku(e,a){switch(e){case"keyup":return Df.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function To(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Pr=!1;function jd(e,a){switch(e){case"compositionend":return To(a);case"keypress":return a.which!==32?null:(jf=!0,Iu);case"textInput":return e=a.data,e===Iu&&jf?null:e;default:return null}}function Uf(e,a){if(Pr)return e==="compositionend"||!Hu&&ku(e,a)?(e=Rf(),ml=Du=lr=null,Pr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Pu&&a.locale!=="ko"?null:a.data;default:return null}}var Ud={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Na(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a==="input"?!!Ud[e.type]:a==="textarea"}function qu(e,a,c,h){sr?xa?xa.push(h):xa=[h]:sr=h,a=A0(a,"onChange"),0<a.length&&(c=new Uu("onChange","change",null,c,h),e.push({event:c,listeners:a}))}var Ao=null,Sl=null;function Vi(e){Sv(e,0)}function Oo(e){var a=fl(e);if(yf(a))return e}function Vu(e,a){if(e==="change")return a}var Bf=!1;if(Ma){var Yu;if(Ma){var Ro="oninput"in document;if(!Ro){var Ku=document.createElement("div");Ku.setAttribute("oninput","return;"),Ro=typeof Ku.oninput=="function"}Yu=Ro}else Yu=!1;Bf=Yu&&(!document.documentMode||9<document.documentMode)}function zf(){Ao&&(Ao.detachEvent("onpropertychange",wo),Sl=Ao=null)}function wo(e){if(e.propertyName==="value"&&Oo(Sl)){var a=[];qu(a,Sl,e,xu(e)),Of(Vi,a)}}function xo(e,a,c){e==="focusin"?(zf(),Ao=a,Sl=c,Ao.attachEvent("onpropertychange",wo)):e==="focusout"&&zf()}function _n(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Oo(Sl)}function Dg(e,a){if(e==="click")return Oo(a)}function jg(e,a){if(e==="input"||e==="change")return Oo(a)}function Bd(e,a){return e===a&&(e!==0||1/e===1/a)||e!==e&&a!==a}var ti=typeof Object.is=="function"?Object.is:Bd;function ra(e,a){if(ti(e,a))return!0;if(typeof e!="object"||e===null||typeof a!="object"||a===null)return!1;var c=Object.keys(e),h=Object.keys(a);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var b=c[h];if(!xt.call(a,b)||!ti(e[b],a[b]))return!1}return!0}function Lf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Gf(e,a){var c=Lf(e);e=0;for(var h;c;){if(c.nodeType===3){if(h=e+c.textContent.length,e<=a&&h>=a)return{node:c,offset:a-e};e=h}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=Lf(c)}}function bl(e,a){return e&&a?e===a?!0:e&&e.nodeType===3?!1:a&&a.nodeType===3?bl(e,a.parentNode):"contains"in e?e.contains(a):e.compareDocumentPosition?!!(e.compareDocumentPosition(a)&16):!1:!1}function ha(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var a=go(e.document);a instanceof e.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)e=a.contentWindow;else break;a=go(e.document)}return a}function Qu(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a&&(a==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||a==="textarea"||e.contentEditable==="true")}var Hf=Ma&&"documentMode"in document&&11>=document.documentMode,vs=null,Mo=null,ys=null,_l=!1;function Pf(e,a,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;_l||vs==null||vs!==go(h)||(h=vs,"selectionStart"in h&&Qu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ys&&ra(ys,h)||(ys=h,h=A0(Mo,"onSelect"),0<h.length&&(a=new Uu("onSelect","select",null,a,c),e.push({event:a,listeners:h}),a.target=vs)))}function Ir(e,a){var c={};return c[e.toLowerCase()]=a.toLowerCase(),c["Webkit"+e]="webkit"+a,c["Moz"+e]="moz"+a,c}var El={animationend:Ir("Animation","AnimationEnd"),animationiteration:Ir("Animation","AnimationIteration"),animationstart:Ir("Animation","AnimationStart"),transitionrun:Ir("Transition","TransitionRun"),transitionstart:Ir("Transition","TransitionStart"),transitioncancel:Ir("Transition","TransitionCancel"),transitionend:Ir("Transition","TransitionEnd")},Xu={},If={};Ma&&(If=document.createElement("div").style,"AnimationEvent"in window||(delete El.animationend.animation,delete El.animationiteration.animation,delete El.animationstart.animation),"TransitionEvent"in window||delete El.transitionend.transition);function ei(e){if(Xu[e])return Xu[e];if(!El[e])return e;var a=El[e],c;for(c in a)if(a.hasOwnProperty(c)&&c in If)return Xu[e]=a[c];return e}var Fu=ei("animationend"),kf=ei("animationiteration"),zd=ei("animationstart"),qf=ei("transitionrun"),Si=ei("transitionstart"),Ld=ei("transitioncancel"),bi=ei("transitionend"),Vf=new Map,Da="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Da.push("scrollEnd");function ni(e,a){Vf.set(e,a),rr(a,[e])}var da=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ni=[],kr=0,sa=0;function No(){for(var e=kr,a=sa=kr=0;a<e;){var c=Ni[a];Ni[a++]=null;var h=Ni[a];Ni[a++]=null;var b=Ni[a];Ni[a++]=null;var T=Ni[a];if(Ni[a++]=null,h!==null&&b!==null){var k=h.pending;k===null?b.next=b:(b.next=k.next,k.next=b),h.pending=b}T!==0&&Yf(c,b,T)}}function ur(e,a,c,h){Ni[kr++]=e,Ni[kr++]=a,Ni[kr++]=c,Ni[kr++]=h,sa|=h,e.lanes|=h,e=e.alternate,e!==null&&(e.lanes|=h)}function Ss(e,a,c,h){return ur(e,a,c,h),Do(e)}function Yi(e,a){return ur(e,null,null,a),Do(e)}function Yf(e,a,c){e.lanes|=c;var h=e.alternate;h!==null&&(h.lanes|=c);for(var b=!1,T=e.return;T!==null;)T.childLanes|=c,h=T.alternate,h!==null&&(h.childLanes|=c),T.tag===22&&(e=T.stateNode,e===null||e._visibility&1||(b=!0)),e=T,T=T.return;return e.tag===3?(T=e.stateNode,b&&a!==null&&(b=31-hi(c),e=T.hiddenUpdates,h=e[b],h===null?e[b]=[a]:h.push(a),a.lane=c|536870912),T):null}function Do(e){if(50<Ws)throw Ws=0,$s=null,Error(i(185));for(var a=e.return;a!==null;)e=a,a=e.return;return e.tag===3?e.stateNode:null}var ja={};function Gd(e,a,c,h){this.tag=e,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(e,a,c,h){return new Gd(e,a,c,h)}function Ju(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ga(e,a){var c=e.alternate;return c===null?(c=di(e.tag,a,e.key,e.mode),c.elementType=e.elementType,c.type=e.type,c.stateNode=e.stateNode,c.alternate=e,e.alternate=c):(c.pendingProps=a,c.type=e.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=e.flags&65011712,c.childLanes=e.childLanes,c.lanes=e.lanes,c.child=e.child,c.memoizedProps=e.memoizedProps,c.memoizedState=e.memoizedState,c.updateQueue=e.updateQueue,a=e.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=e.sibling,c.index=e.index,c.ref=e.ref,c.refCleanup=e.refCleanup,c}function Zu(e,a){e.flags&=65011714;var c=e.alternate;return c===null?(e.childLanes=0,e.lanes=a,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=c.childLanes,e.lanes=c.lanes,e.child=c.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=c.memoizedProps,e.memoizedState=c.memoizedState,e.updateQueue=c.updateQueue,e.type=c.type,a=c.dependencies,e.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),e}function Cl(e,a,c,h,b,T){var k=0;if(h=e,typeof e=="function")Ju(e)&&(k=1);else if(typeof e=="string")k=B4(e,c,q.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case B:return e=di(31,c,a,b),e.elementType=B,e.lanes=T,e;case D:return qr(c.children,b,T,a);case z:k=8,b|=24;break;case G:return e=di(12,c,a,b|2),e.elementType=G,e.lanes=T,e;case w:return e=di(13,c,a,b),e.elementType=w,e.lanes=T,e;case A:return e=di(19,c,a,b),e.elementType=A,e.lanes=T,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:k=10;break t;case N:k=9;break t;case L:k=11;break t;case O:k=14;break t;case y:k=16,h=null;break t}k=29,c=Error(i(130,e===null?"null":typeof e,"")),h=null}return a=di(k,c,a,b),a.elementType=e,a.type=h,a.lanes=T,a}function qr(e,a,c,h){return e=di(7,e,h,a),e.lanes=c,e}function jo(e,a,c){return e=di(6,e,null,a),e.lanes=c,e}function Di(e){var a=di(18,null,null,0);return a.stateNode=e,a}function Wu(e,a,c){return a=di(4,e.children!==null?e.children:[],e.key,a),a.lanes=c,a.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},a}var ji=new WeakMap;function Ki(e,a){if(typeof e=="object"&&e!==null){var c=ji.get(e);return c!==void 0?c:(a={value:e,source:a,stack:ft(a)},ji.set(e,a),a)}return{value:e,source:a,stack:ft(a)}}var bs=[],Tl=0,pa=null,Al=0,Ui=[],ii=0,cr=null,ma=1,va="";function Ua(e,a){bs[Tl++]=Al,bs[Tl++]=pa,pa=e,Al=a}function $u(e,a,c){Ui[ii++]=ma,Ui[ii++]=va,Ui[ii++]=cr,cr=e;var h=ma;e=va;var b=32-hi(h)-1;h&=~(1<<b),c+=1;var T=32-hi(a)+b;if(30<T){var k=b-b%5;T=(h&(1<<k)-1).toString(32),h>>=k,b-=k,ma=1<<32-hi(a)+b|c<<b|h,va=T+e}else ma=1<<T|c<<b|h,va=e}function Uo(e){e.return!==null&&(Ua(e,1),$u(e,1,0))}function Kf(e){for(;e===pa;)pa=bs[--Tl],bs[Tl]=null,Al=bs[--Tl],bs[Tl]=null;for(;e===cr;)cr=Ui[--ii],Ui[ii]=null,va=Ui[--ii],Ui[ii]=null,ma=Ui[--ii],Ui[ii]=null}function Hd(e,a){Ui[ii++]=ma,Ui[ii++]=va,Ui[ii++]=cr,ma=a.id,va=a.overflow,cr=e}var ai=null,tn=null,Ne=!1,Qi=null,_i=!1,tc=Error(i(519));function fr(e){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ol(Ki(a,e)),tc}function Qf(e){var a=e.stateNode,c=e.type,h=e.memoizedProps;switch(a[Pn]=e,a[Vn]=h,c){case"dialog":Ue("cancel",a),Ue("close",a);break;case"iframe":case"object":case"embed":Ue("load",a);break;case"video":case"audio":for(c=0;c<Dh.length;c++)Ue(Dh[c],a);break;case"source":Ue("error",a);break;case"img":case"image":case"link":Ue("error",a),Ue("load",a);break;case"details":Ue("toggle",a);break;case"input":Ue("invalid",a),Sf(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Ue("invalid",a);break;case"textarea":Ue("invalid",a),Ef(a,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||h.suppressHydrationWarning===!0||Cv(a.textContent,c)?(h.popover!=null&&(Ue("beforetoggle",a),Ue("toggle",a)),h.onScroll!=null&&Ue("scroll",a),h.onScrollEnd!=null&&Ue("scrollend",a),h.onClick!=null&&(a.onclick=Mi),a=!0):a=!1,a||fr(e,!0)}function Xf(e){for(ai=e.return;ai;)switch(ai.tag){case 5:case 31:case 13:_i=!1;return;case 27:case 3:_i=!0;return;default:ai=ai.return}}function _s(e){if(e!==ai)return!1;if(!Ne)return Xf(e),Ne=!0,!1;var a=e.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=e.type,c=!(c!=="form"&&c!=="button")||Zg(e.type,e.memoizedProps)),c=!c),c&&tn&&fr(e),Xf(e),a===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));tn=Dv(e)}else if(a===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));tn=Dv(e)}else a===27?(a=tn,Vl(e.type)?(e=np,np=null,tn=e):tn=a):tn=ai?Wa(e.stateNode.nextSibling):null;return!0}function Vr(){tn=ai=null,Ne=!1}function Es(){var e=Qi;return e!==null&&(an===null?an=e:an.push.apply(an,e),Qi=null),e}function Ol(e){Qi===null?Qi=[e]:Qi.push(e)}var ec=J(null),je=null,ya=null;function Yr(e,a,c){it(ec,a._currentValue),a._currentValue=c}function Ba(e){e._currentValue=ec.current,rt(ec)}function Ff(e,a,c){for(;e!==null;){var h=e.alternate;if((e.childLanes&a)!==a?(e.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),e===c)break;e=e.return}}function Jf(e,a,c,h){var b=e.child;for(b!==null&&(b.return=e);b!==null;){var T=b.dependencies;if(T!==null){var k=b.child;T=T.firstContext;t:for(;T!==null;){var W=T;T=b;for(var lt=0;lt<a.length;lt++)if(W.context===a[lt]){T.lanes|=c,W=T.alternate,W!==null&&(W.lanes|=c),Ff(T.return,c,e),h||(k=null);break t}T=W.next}}else if(b.tag===18){if(k=b.return,k===null)throw Error(i(341));k.lanes|=c,T=k.alternate,T!==null&&(T.lanes|=c),Ff(k,c,e),k=null}else k=b.child;if(k!==null)k.return=b;else for(k=b;k!==null;){if(k===e){k=null;break}if(b=k.sibling,b!==null){b.return=k.return,k=b;break}k=k.return}b=k}}function Rl(e,a,c,h){e=null;for(var b=a,T=!1;b!==null;){if(!T){if((b.flags&524288)!==0)T=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var k=b.alternate;if(k===null)throw Error(i(387));if(k=k.memoizedProps,k!==null){var W=b.type;ti(b.pendingProps.value,k.value)||(e!==null?e.push(W):e=[W])}}else if(b===nt.current){if(k=b.alternate,k===null)throw Error(i(387));k.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(e!==null?e.push(Lh):e=[Lh])}b=b.return}e!==null&&Jf(a,e,c,h),a.flags|=262144}function nc(e){for(e=e.firstContext;e!==null;){if(!ti(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function hr(e){je=e,ya=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function on(e){return zo(je,e)}function Bo(e,a){return je===null&&hr(e),zo(e,a)}function zo(e,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},ya===null){if(e===null)throw Error(i(308));ya=a,e.dependencies={lanes:0,firstContext:a},e.flags|=524288}else ya=ya.next=a;return c}var Cs=typeof AbortController<"u"?AbortController:function(){var e=[],a=this.signal={aborted:!1,addEventListener:function(c,h){e.push(h)}};this.abort=function(){a.aborted=!0,e.forEach(function(c){return c()})}},Zf=o.unstable_scheduleCallback,Wf=o.unstable_NormalPriority,Bn={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ic(){return{controller:new Cs,data:new Map,refCount:0}}function wl(e){e.refCount--,e.refCount===0&&Zf(Wf,function(){e.controller.abort()})}var xl=null,ac=0,Ts=0,Kr=null;function Me(e,a){if(xl===null){var c=xl=[];ac=0,Ts=kg(),Kr={status:"pending",value:void 0,then:function(h){c.push(h)}}}return ac++,a.then(Pd,Pd),a}function Pd(){if(--ac===0&&xl!==null){Kr!==null&&(Kr.status="fulfilled");var e=xl;xl=null,Ts=0,Kr=null;for(var a=0;a<e.length;a++)(0,e[a])()}}function Xi(e,a){var c=[],h={status:"pending",value:null,reason:null,then:function(b){c.push(b)}};return e.then(function(){h.status="fulfilled",h.value=a;for(var b=0;b<c.length;b++)(0,c[b])(a)},function(b){for(h.status="rejected",h.reason=b,b=0;b<c.length;b++)(0,c[b])(void 0)}),h}var rc=j.S;j.S=function(e,a){Dc=ae(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Me(e,a),rc!==null&&rc(e,a)};var As=J(null);function Ml(){var e=As.current;return e!==null?e:Oe.pooledCache}function dr(e,a){a===null?it(As,As.current):it(As,a.pool)}function Os(){var e=Ml();return e===null?null:{parent:Bn._currentValue,pool:e}}var Rs=Error(i(460)),Lo=Error(i(474)),sc=Error(i(542)),Go={then:function(){}};function gr(e){return e=e.status,e==="fulfilled"||e==="rejected"}function lc(e,a,c){switch(c=e[c],c===void 0?e.push(a):c!==a&&(a.then(Mi,Mi),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,vr(e),e;default:if(typeof a.status=="string")a.then(Mi,Mi);else{if(e=Oe,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=a,e.status="pending",e.then(function(h){if(a.status==="pending"){var b=a;b.status="fulfilled",b.value=h}},function(h){if(a.status==="pending"){var b=a;b.status="rejected",b.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,vr(e),e}throw mr=a,Rs}}function pr(e){try{var a=e._init;return a(e._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(mr=c,Rs):c}}var mr=null;function oc(){if(mr===null)throw Error(i(459));var e=mr;return mr=null,e}function vr(e){if(e===Rs||e===sc)throw Error(i(483))}var Qr=null,Ho=0;function Po(e){var a=Ho;return Ho+=1,Qr===null&&(Qr=[]),lc(Qr,e,a)}function Io(e,a){a=a.props.ref,e.ref=a!==void 0?a:null}function ws(e,a){throw a.$$typeof===E?Error(i(525)):(e=Object.prototype.toString.call(a),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":e)))}function re(e){function a(gt,ct){if(e){var vt=gt.deletions;vt===null?(gt.deletions=[ct],gt.flags|=16):vt.push(ct)}}function c(gt,ct){if(!e)return null;for(;ct!==null;)a(gt,ct),ct=ct.sibling;return null}function h(gt){for(var ct=new Map;gt!==null;)gt.key!==null?ct.set(gt.key,gt):ct.set(gt.index,gt),gt=gt.sibling;return ct}function b(gt,ct){return gt=ga(gt,ct),gt.index=0,gt.sibling=null,gt}function T(gt,ct,vt){return gt.index=vt,e?(vt=gt.alternate,vt!==null?(vt=vt.index,vt<ct?(gt.flags|=67108866,ct):vt):(gt.flags|=67108866,ct)):(gt.flags|=1048576,ct)}function k(gt){return e&&gt.alternate===null&&(gt.flags|=67108866),gt}function W(gt,ct,vt,Rt){return ct===null||ct.tag!==6?(ct=jo(vt,gt.mode,Rt),ct.return=gt,ct):(ct=b(ct,vt),ct.return=gt,ct)}function lt(gt,ct,vt,Rt){var ie=vt.type;return ie===D?At(gt,ct,vt.props.children,Rt,vt.key):ct!==null&&(ct.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===y&&pr(ie)===ct.type)?(ct=b(ct,vt.props),Io(ct,vt),ct.return=gt,ct):(ct=Cl(vt.type,vt.key,vt.props,null,gt.mode,Rt),Io(ct,vt),ct.return=gt,ct)}function yt(gt,ct,vt,Rt){return ct===null||ct.tag!==4||ct.stateNode.containerInfo!==vt.containerInfo||ct.stateNode.implementation!==vt.implementation?(ct=Wu(vt,gt.mode,Rt),ct.return=gt,ct):(ct=b(ct,vt.children||[]),ct.return=gt,ct)}function At(gt,ct,vt,Rt,ie){return ct===null||ct.tag!==7?(ct=qr(vt,gt.mode,Rt,ie),ct.return=gt,ct):(ct=b(ct,vt),ct.return=gt,ct)}function wt(gt,ct,vt){if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return ct=jo(""+ct,gt.mode,vt),ct.return=gt,ct;if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case R:return vt=Cl(ct.type,ct.key,ct.props,null,gt.mode,vt),Io(vt,ct),vt.return=gt,vt;case v:return ct=Wu(ct,gt.mode,vt),ct.return=gt,ct;case y:return ct=pr(ct),wt(gt,ct,vt)}if(V(ct)||K(ct))return ct=qr(ct,gt.mode,vt,null),ct.return=gt,ct;if(typeof ct.then=="function")return wt(gt,Po(ct),vt);if(ct.$$typeof===M)return wt(gt,Bo(gt,ct),vt);ws(gt,ct)}return null}function _t(gt,ct,vt,Rt){var ie=ct!==null?ct.key:null;if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return ie!==null?null:W(gt,ct,""+vt,Rt);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case R:return vt.key===ie?lt(gt,ct,vt,Rt):null;case v:return vt.key===ie?yt(gt,ct,vt,Rt):null;case y:return vt=pr(vt),_t(gt,ct,vt,Rt)}if(V(vt)||K(vt))return ie!==null?null:At(gt,ct,vt,Rt,null);if(typeof vt.then=="function")return _t(gt,ct,Po(vt),Rt);if(vt.$$typeof===M)return _t(gt,ct,Bo(gt,vt),Rt);ws(gt,vt)}return null}function Ct(gt,ct,vt,Rt,ie){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint")return gt=gt.get(vt)||null,W(ct,gt,""+Rt,ie);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case R:return gt=gt.get(Rt.key===null?vt:Rt.key)||null,lt(ct,gt,Rt,ie);case v:return gt=gt.get(Rt.key===null?vt:Rt.key)||null,yt(ct,gt,Rt,ie);case y:return Rt=pr(Rt),Ct(gt,ct,vt,Rt,ie)}if(V(Rt)||K(Rt))return gt=gt.get(vt)||null,At(ct,gt,Rt,ie,null);if(typeof Rt.then=="function")return Ct(gt,ct,vt,Po(Rt),ie);if(Rt.$$typeof===M)return Ct(gt,ct,vt,Bo(ct,Rt),ie);ws(ct,Rt)}return null}function Zt(gt,ct,vt,Rt){for(var ie=null,Ye=null,te=ct,we=ct=0,Be=null;te!==null&&we<vt.length;we++){te.index>we?(Be=te,te=null):Be=te.sibling;var Ke=_t(gt,te,vt[we],Rt);if(Ke===null){te===null&&(te=Be);break}e&&te&&Ke.alternate===null&&a(gt,te),ct=T(Ke,ct,we),Ye===null?ie=Ke:Ye.sibling=Ke,Ye=Ke,te=Be}if(we===vt.length)return c(gt,te),Ne&&Ua(gt,we),ie;if(te===null){for(;we<vt.length;we++)te=wt(gt,vt[we],Rt),te!==null&&(ct=T(te,ct,we),Ye===null?ie=te:Ye.sibling=te,Ye=te);return Ne&&Ua(gt,we),ie}for(te=h(te);we<vt.length;we++)Be=Ct(te,gt,we,vt[we],Rt),Be!==null&&(e&&Be.alternate!==null&&te.delete(Be.key===null?we:Be.key),ct=T(Be,ct,we),Ye===null?ie=Be:Ye.sibling=Be,Ye=Be);return e&&te.forEach(function(Fl){return a(gt,Fl)}),Ne&&Ua(gt,we),ie}function ce(gt,ct,vt,Rt){if(vt==null)throw Error(i(151));for(var ie=null,Ye=null,te=ct,we=ct=0,Be=null,Ke=vt.next();te!==null&&!Ke.done;we++,Ke=vt.next()){te.index>we?(Be=te,te=null):Be=te.sibling;var Fl=_t(gt,te,Ke.value,Rt);if(Fl===null){te===null&&(te=Be);break}e&&te&&Fl.alternate===null&&a(gt,te),ct=T(Fl,ct,we),Ye===null?ie=Fl:Ye.sibling=Fl,Ye=Fl,te=Be}if(Ke.done)return c(gt,te),Ne&&Ua(gt,we),ie;if(te===null){for(;!Ke.done;we++,Ke=vt.next())Ke=wt(gt,Ke.value,Rt),Ke!==null&&(ct=T(Ke,ct,we),Ye===null?ie=Ke:Ye.sibling=Ke,Ye=Ke);return Ne&&Ua(gt,we),ie}for(te=h(te);!Ke.done;we++,Ke=vt.next())Ke=Ct(te,gt,we,Ke.value,Rt),Ke!==null&&(e&&Ke.alternate!==null&&te.delete(Ke.key===null?we:Ke.key),ct=T(Ke,ct,we),Ye===null?ie=Ke:Ye.sibling=Ke,Ye=Ke);return e&&te.forEach(function(K4){return a(gt,K4)}),Ne&&Ua(gt,we),ie}function sn(gt,ct,vt,Rt){if(typeof vt=="object"&&vt!==null&&vt.type===D&&vt.key===null&&(vt=vt.props.children),typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case R:t:{for(var ie=vt.key;ct!==null;){if(ct.key===ie){if(ie=vt.type,ie===D){if(ct.tag===7){c(gt,ct.sibling),Rt=b(ct,vt.props.children),Rt.return=gt,gt=Rt;break t}}else if(ct.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===y&&pr(ie)===ct.type){c(gt,ct.sibling),Rt=b(ct,vt.props),Io(Rt,vt),Rt.return=gt,gt=Rt;break t}c(gt,ct);break}else a(gt,ct);ct=ct.sibling}vt.type===D?(Rt=qr(vt.props.children,gt.mode,Rt,vt.key),Rt.return=gt,gt=Rt):(Rt=Cl(vt.type,vt.key,vt.props,null,gt.mode,Rt),Io(Rt,vt),Rt.return=gt,gt=Rt)}return k(gt);case v:t:{for(ie=vt.key;ct!==null;){if(ct.key===ie)if(ct.tag===4&&ct.stateNode.containerInfo===vt.containerInfo&&ct.stateNode.implementation===vt.implementation){c(gt,ct.sibling),Rt=b(ct,vt.children||[]),Rt.return=gt,gt=Rt;break t}else{c(gt,ct);break}else a(gt,ct);ct=ct.sibling}Rt=Wu(vt,gt.mode,Rt),Rt.return=gt,gt=Rt}return k(gt);case y:return vt=pr(vt),sn(gt,ct,vt,Rt)}if(V(vt))return Zt(gt,ct,vt,Rt);if(K(vt)){if(ie=K(vt),typeof ie!="function")throw Error(i(150));return vt=ie.call(vt),ce(gt,ct,vt,Rt)}if(typeof vt.then=="function")return sn(gt,ct,Po(vt),Rt);if(vt.$$typeof===M)return sn(gt,ct,Bo(gt,vt),Rt);ws(gt,vt)}return typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint"?(vt=""+vt,ct!==null&&ct.tag===6?(c(gt,ct.sibling),Rt=b(ct,vt),Rt.return=gt,gt=Rt):(c(gt,ct),Rt=jo(vt,gt.mode,Rt),Rt.return=gt,gt=Rt),k(gt)):c(gt,ct)}return function(gt,ct,vt,Rt){try{Ho=0;var ie=sn(gt,ct,vt,Rt);return Qr=null,ie}catch(te){if(te===Rs||te===sc)throw te;var Ye=di(29,te,null,gt.mode);return Ye.lanes=Rt,Ye.return=gt,Ye}finally{}}}var xs=re(!0),Id=re(!1),yr=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $f(e,a){e=e.updateQueue,a.updateQueue===e&&(a.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Xr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Fr(e,a,c){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,(le&2)!==0){var b=h.pending;return b===null?a.next=a:(a.next=b.next,b.next=a),h.pending=a,a=Do(e),Yf(e,null,c),a}return ur(e,h,a,c),Do(e)}function ko(e,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var h=a.lanes;h&=e.pendingLanes,c|=h,a.lanes=c,vf(e,c)}}function th(e,a){var c=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var b=null,T=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};T===null?b=T=k:T=T.next=k,c=c.next}while(c!==null);T===null?b=T=a:T=T.next=a}else b=T=a;c={baseState:h.baseState,firstBaseUpdate:b,lastBaseUpdate:T,shared:h.shared,callbacks:h.callbacks},e.updateQueue=c;return}e=c.lastBaseUpdate,e===null?c.firstBaseUpdate=a:e.next=a,c.lastBaseUpdate=a}var qo=!1;function Nl(){if(qo){var e=Kr;if(e!==null)throw e}}function Jr(e,a,c,h){qo=!1;var b=e.updateQueue;yr=!1;var T=b.firstBaseUpdate,k=b.lastBaseUpdate,W=b.shared.pending;if(W!==null){b.shared.pending=null;var lt=W,yt=lt.next;lt.next=null,k===null?T=yt:k.next=yt,k=lt;var At=e.alternate;At!==null&&(At=At.updateQueue,W=At.lastBaseUpdate,W!==k&&(W===null?At.firstBaseUpdate=yt:W.next=yt,At.lastBaseUpdate=lt))}if(T!==null){var wt=b.baseState;k=0,At=yt=lt=null,W=T;do{var _t=W.lane&-536870913,Ct=_t!==W.lane;if(Ct?(Ce&_t)===_t:(h&_t)===_t){_t!==0&&_t===Ts&&(qo=!0),At!==null&&(At=At.next={lane:0,tag:W.tag,payload:W.payload,callback:null,next:null});t:{var Zt=e,ce=W;_t=a;var sn=c;switch(ce.tag){case 1:if(Zt=ce.payload,typeof Zt=="function"){wt=Zt.call(sn,wt,_t);break t}wt=Zt;break t;case 3:Zt.flags=Zt.flags&-65537|128;case 0:if(Zt=ce.payload,_t=typeof Zt=="function"?Zt.call(sn,wt,_t):Zt,_t==null)break t;wt=C({},wt,_t);break t;case 2:yr=!0}}_t=W.callback,_t!==null&&(e.flags|=64,Ct&&(e.flags|=8192),Ct=b.callbacks,Ct===null?b.callbacks=[_t]:Ct.push(_t))}else Ct={lane:_t,tag:W.tag,payload:W.payload,callback:W.callback,next:null},At===null?(yt=At=Ct,lt=wt):At=At.next=Ct,k|=_t;if(W=W.next,W===null){if(W=b.shared.pending,W===null)break;Ct=W,W=Ct.next,Ct.next=null,b.lastBaseUpdate=Ct,b.shared.pending=null}}while(!0);At===null&&(lt=wt),b.baseState=lt,b.firstBaseUpdate=yt,b.lastBaseUpdate=At,T===null&&(b.shared.lanes=0),as|=k,e.lanes=k,e.memoizedState=wt}}function eh(e,a){if(typeof e!="function")throw Error(i(191,e));e.call(a)}function kd(e,a){var c=e.callbacks;if(c!==null)for(e.callbacks=null,e=0;e<c.length;e++)eh(c[e],a)}var Dl=J(null),za=J(0);function La(e,a){e=ca,it(za,e),it(Dl,a),ca=e|a.baseLanes}function Kn(){it(za,ca),it(Dl,Dl.current)}function Ga(){ca=za.current,rt(Dl),rt(za)}var gn=J(null),la=null;function Zr(e){var a=e.alternate;it(On,On.current&1),it(gn,e),la===null&&(a===null||Dl.current!==null||a.memoizedState!==null)&&(la=e)}function zn(e){it(On,On.current),it(gn,e),la===null&&(la=e)}function Ha(e){e.tag===22?(it(On,On.current),it(gn,e),la===null&&(la=e)):Wr()}function Wr(){it(On,On.current),it(gn,gn.current)}function Fi(e){rt(gn),la===e&&(la=null),rt(On)}var On=J(0);function uc(e){for(var a=e;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||tp(c)||ep(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Pa=0,ye=null,Qe=null,Ln=null,Sr=!1,oa=!1,Ns=!1,cc=0,Vo=0,Ia=null,Ug=0;function Tn(){throw Error(i(321))}function nh(e,a){if(a===null)return!1;for(var c=0;c<a.length&&c<e.length;c++)if(!ti(e[c],a[c]))return!1;return!0}function Ds(e,a,c,h,b,T){return Pa=T,ye=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,j.H=e===null||e.memoizedState===null?js:Xo,Ns=!1,T=c(h,b),Ns=!1,oa&&(T=Vd(a,c,h,b)),qd(e),T}function qd(e){j.H=Ul;var a=Qe!==null&&Qe.next!==null;if(Pa=0,Ln=Qe=ye=null,Sr=!1,Vo=0,Ia=null,a)throw Error(i(300));e===null||Gn||(e=e.dependencies,e!==null&&nc(e)&&(Gn=!0))}function Vd(e,a,c,h){ye=e;var b=0;do{if(oa&&(Ia=null),Vo=0,oa=!1,25<=b)throw Error(i(301));if(b+=1,Ln=Qe=null,e.updateQueue!=null){var T=e.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}j.H=Us,T=a(c,h)}while(oa);return T}function Bg(){var e=j.H,a=e.useState()[0];return a=typeof a.then=="function"?Yo(a):a,e=e.useState()[0],(Qe!==null?Qe.memoizedState:null)!==e&&(ye.flags|=1024),a}function ih(){var e=cc!==0;return cc=0,e}function ah(e,a,c){a.updateQueue=e.updateQueue,a.flags&=-2053,e.lanes&=~c}function rh(e){if(Sr){for(e=e.memoizedState;e!==null;){var a=e.queue;a!==null&&(a.pending=null),e=e.next}Sr=!1}Pa=0,Ln=Qe=ye=null,oa=!1,Vo=cc=0,Ia=null}function Ei(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?ye.memoizedState=Ln=e:Ln=Ln.next=e,Ln}function Rn(){if(Qe===null){var e=ye.alternate;e=e!==null?e.memoizedState:null}else e=Qe.next;var a=Ln===null?ye.memoizedState:Ln.next;if(a!==null)Ln=a,Qe=e;else{if(e===null)throw ye.alternate===null?Error(i(467)):Error(i(310));Qe=e,e={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},Ln===null?ye.memoizedState=Ln=e:Ln=Ln.next=e}return Ln}function fc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yo(e){var a=Vo;return Vo+=1,Ia===null&&(Ia=[]),e=lc(Ia,e,a),a=ye,(Ln===null?a.memoizedState:Ln.next)===null&&(a=a.alternate,j.H=a===null||a.memoizedState===null?js:Xo),e}function hc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Yo(e);if(e.$$typeof===M)return on(e)}throw Error(i(438,String(e)))}function sh(e){var a=null,c=ye.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var h=ye.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(b){return b.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=fc(),ye.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(e),h=0;h<e;h++)c[h]=U;return a.index++,c}function ka(e,a){return typeof a=="function"?a(e):a}function dc(e){var a=Rn();return lh(a,Qe,e)}function lh(e,a,c){var h=e.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=c;var b=e.baseQueue,T=h.pending;if(T!==null){if(b!==null){var k=b.next;b.next=T.next,T.next=k}a.baseQueue=b=T,h.pending=null}if(T=e.baseState,b===null)e.memoizedState=T;else{a=b.next;var W=k=null,lt=null,yt=a,At=!1;do{var wt=yt.lane&-536870913;if(wt!==yt.lane?(Ce&wt)===wt:(Pa&wt)===wt){var _t=yt.revertLane;if(_t===0)lt!==null&&(lt=lt.next={lane:0,revertLane:0,gesture:null,action:yt.action,hasEagerState:yt.hasEagerState,eagerState:yt.eagerState,next:null}),wt===Ts&&(At=!0);else if((Pa&_t)===_t){yt=yt.next,_t===Ts&&(At=!0);continue}else wt={lane:0,revertLane:yt.revertLane,gesture:null,action:yt.action,hasEagerState:yt.hasEagerState,eagerState:yt.eagerState,next:null},lt===null?(W=lt=wt,k=T):lt=lt.next=wt,ye.lanes|=_t,as|=_t;wt=yt.action,Ns&&c(T,wt),T=yt.hasEagerState?yt.eagerState:c(T,wt)}else _t={lane:wt,revertLane:yt.revertLane,gesture:yt.gesture,action:yt.action,hasEagerState:yt.hasEagerState,eagerState:yt.eagerState,next:null},lt===null?(W=lt=_t,k=T):lt=lt.next=_t,ye.lanes|=wt,as|=wt;yt=yt.next}while(yt!==null&&yt!==a);if(lt===null?k=T:lt.next=W,!ti(T,e.memoizedState)&&(Gn=!0,At&&(c=Kr,c!==null)))throw c;e.memoizedState=T,e.baseState=k,e.baseQueue=lt,h.lastRenderedState=T}return b===null&&(h.lanes=0),[e.memoizedState,h.dispatch]}function oh(e){var a=Rn(),c=a.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=e;var h=c.dispatch,b=c.pending,T=a.memoizedState;if(b!==null){c.pending=null;var k=b=b.next;do T=e(T,k.action),k=k.next;while(k!==b);ti(T,a.memoizedState)||(Gn=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),c.lastRenderedState=T}return[T,h]}function Yd(e,a,c){var h=ye,b=Rn(),T=Ne;if(T){if(c===void 0)throw Error(i(407));c=c()}else c=a();var k=!ti((Qe||b).memoizedState,c);if(k&&(b.memoizedState=c,Gn=!0),b=b.queue,gh(uh.bind(null,h,b,e),[e]),b.getSnapshot!==a||k||Ln!==null&&Ln.memoizedState.tag&1){if(h.flags|=2048,jl(9,{destroy:void 0},Qd.bind(null,h,b,c,a),null),Oe===null)throw Error(i(349));T||(Pa&127)!==0||Kd(h,a,c)}return c}function Kd(e,a,c){e.flags|=16384,e={getSnapshot:a,value:c},a=ye.updateQueue,a===null?(a=fc(),ye.updateQueue=a,a.stores=[e]):(c=a.stores,c===null?a.stores=[e]:c.push(e))}function Qd(e,a,c,h){a.value=c,a.getSnapshot=h,ch(a)&&Xd(e)}function uh(e,a,c){return c(function(){ch(a)&&Xd(e)})}function ch(e){var a=e.getSnapshot;e=e.value;try{var c=a();return!ti(e,c)}catch{return!0}}function Xd(e){var a=Yi(e,2);a!==null&&Ve(a,e,2)}function gc(e){var a=Ei();if(typeof e=="function"){var c=e;if(e=c(),Ns){ki(!0);try{c()}finally{ki(!1)}}}return a.memoizedState=a.baseState=e,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:e},a}function fh(e,a,c,h){return e.baseState=c,lh(e,Qe,typeof h=="function"?h:ka)}function Fd(e,a,c,h,b){if(Qo(e))throw Error(i(485));if(e=a.action,e!==null){var T={payload:b,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){T.listeners.push(k)}};j.T!==null?c(!0):T.isTransition=!1,h(T),c=a.pending,c===null?(T.next=a.pending=T,pc(a,T)):(T.next=c.next,a.pending=c.next=T)}}function pc(e,a){var c=a.action,h=a.payload,b=e.state;if(a.isTransition){var T=j.T,k={};j.T=k;try{var W=c(b,h),lt=j.S;lt!==null&&lt(k,W),mc(e,a,W)}catch(yt){hh(e,a,yt)}finally{T!==null&&k.types!==null&&(T.types=k.types),j.T=T}}else try{T=c(b,h),mc(e,a,T)}catch(yt){hh(e,a,yt)}}function mc(e,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){Jd(e,a,h)},function(h){return hh(e,a,h)}):Jd(e,a,c)}function Jd(e,a,c){a.status="fulfilled",a.value=c,Zd(a),e.state=c,a=e.pending,a!==null&&(c=a.next,c===a?e.pending=null:(c=c.next,a.next=c,pc(e,c)))}function hh(e,a,c){var h=e.pending;if(e.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=c,Zd(a),a=a.next;while(a!==h)}e.action=null}function Zd(e){e=e.listeners;for(var a=0;a<e.length;a++)(0,e[a])()}function Wd(e,a){return a}function dh(e,a){if(Ne){var c=Oe.formState;if(c!==null){t:{var h=ye;if(Ne){if(tn){e:{for(var b=tn,T=_i;b.nodeType!==8;){if(!T){b=null;break e}if(b=Wa(b.nextSibling),b===null){b=null;break e}}T=b.data,b=T==="F!"||T==="F"?b:null}if(b){tn=Wa(b.nextSibling),h=b.data==="F!";break t}}fr(h)}h=!1}h&&(a=c[0])}}return c=Ei(),c.memoizedState=c.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wd,lastRenderedState:a},c.queue=h,c=yh.bind(null,ye,h),h.dispatch=c,h=gc(!1),T=wn.bind(null,ye,!1,h.queue),h=Ei(),b={state:a,dispatch:null,action:e,pending:null},h.queue=b,c=Fd.bind(null,ye,b,T,c),b.dispatch=c,h.memoizedState=e,[a,c,!1]}function $d(e){var a=Rn();return t0(a,Qe,e)}function t0(e,a,c){if(a=lh(e,a,Wd)[0],e=dc(ka)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=Yo(a)}catch(k){throw k===Rs?sc:k}else h=a;a=Rn();var b=a.queue,T=b.dispatch;return c!==a.memoizedState&&(ye.flags|=2048,jl(9,{destroy:void 0},zg.bind(null,b,c),null)),[h,T,e]}function zg(e,a){e.action=a}function e0(e){var a=Rn(),c=Qe;if(c!==null)return t0(a,c,e);Rn(),a=a.memoizedState,c=Rn();var h=c.queue.dispatch;return c.memoizedState=e,[a,h,!1]}function jl(e,a,c,h){return e={tag:e,create:c,deps:h,inst:a,next:null},a=ye.updateQueue,a===null&&(a=fc(),ye.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=e.next=e:(h=c.next,c.next=e,e.next=h,a.lastEffect=e),e}function n0(){return Rn().memoizedState}function vc(e,a,c,h){var b=Ei();ye.flags|=e,b.memoizedState=jl(1|a,{destroy:void 0},c,h===void 0?null:h)}function yc(e,a,c,h){var b=Rn();h=h===void 0?null:h;var T=b.memoizedState.inst;Qe!==null&&h!==null&&nh(h,Qe.memoizedState.deps)?b.memoizedState=jl(a,T,c,h):(ye.flags|=e,b.memoizedState=jl(1|a,T,c,h))}function i0(e,a){vc(8390656,8,e,a)}function gh(e,a){yc(2048,8,e,a)}function Lg(e){ye.flags|=4;var a=ye.updateQueue;if(a===null)a=fc(),ye.updateQueue=a,a.events=[e];else{var c=a.events;c===null?a.events=[e]:c.push(e)}}function a0(e){var a=Rn().memoizedState;return Lg({ref:a,nextImpl:e}),function(){if((le&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function r0(e,a){return yc(4,2,e,a)}function s0(e,a){return yc(4,4,e,a)}function l0(e,a){if(typeof a=="function"){e=e();var c=a(e);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return e=e(),a.current=e,function(){a.current=null}}function o0(e,a,c){c=c!=null?c.concat([e]):null,yc(4,4,l0.bind(null,a,e),c)}function Sc(){}function u0(e,a){var c=Rn();a=a===void 0?null:a;var h=c.memoizedState;return a!==null&&nh(a,h[1])?h[0]:(c.memoizedState=[e,a],e)}function c0(e,a){var c=Rn();a=a===void 0?null:a;var h=c.memoizedState;if(a!==null&&nh(a,h[1]))return h[0];if(h=e(),Ns){ki(!0);try{e()}finally{ki(!1)}}return c.memoizedState=[h,a],h}function Ji(e,a,c){return c===void 0||(Pa&1073741824)!==0&&(Ce&261930)===0?e.memoizedState=a:(e.memoizedState=c,e=Or(),ye.lanes|=e,as|=e,c)}function ph(e,a,c,h){return ti(c,a)?c:Dl.current!==null?(e=Ji(e,c,h),ti(e,a)||(Gn=!0),e):(Pa&42)===0||(Pa&1073741824)!==0&&(Ce&261930)===0?(Gn=!0,e.memoizedState=c):(e=Or(),ye.lanes|=e,as|=e,a)}function bc(e,a,c,h,b){var T=I.p;I.p=T!==0&&8>T?T:8;var k=j.T,W={};j.T=W,wn(e,!1,a,c);try{var lt=b(),yt=j.S;if(yt!==null&&yt(W,lt),lt!==null&&typeof lt=="object"&&typeof lt.then=="function"){var At=Xi(lt,h);Ko(e,a,At,vi(e))}else Ko(e,a,h,vi(e))}catch(wt){Ko(e,a,{then:function(){},status:"rejected",reason:wt},vi())}finally{I.p=T,k!==null&&W.types!==null&&(k.types=W.types),j.T=k}}function f0(){}function _c(e,a,c,h){if(e.tag!==5)throw Error(i(476));var b=mh(e).queue;bc(e,b,a,X,c===null?f0:function(){return h0(e),c(h)})}function mh(e){var a=e.memoizedState;if(a!==null)return a;a={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:X},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:c},next:null},e.memoizedState=a,e=e.alternate,e!==null&&(e.memoizedState=a),a}function h0(e){var a=mh(e);a.next===null&&(a=e.alternate.memoizedState),Ko(e,a.next.queue,{},vi())}function Ec(){return on(Lh)}function vh(){return Rn().memoizedState}function d0(){return Rn().memoizedState}function Gg(e){for(var a=e.return;a!==null;){switch(a.tag){case 24:case 3:var c=vi();e=Xr(c);var h=Fr(a,e,c);h!==null&&(Ve(h,a,c),ko(h,a,c)),a={cache:ic()},e.payload=a;return}a=a.return}}function Hg(e,a,c){var h=vi();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Qo(e)?g0(a,c):(c=Ss(e,a,c,h),c!==null&&(Ve(c,e,h),Sh(c,a,h)))}function yh(e,a,c){var h=vi();Ko(e,a,c,h)}function Ko(e,a,c,h){var b={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))g0(a,b);else{var T=e.alternate;if(e.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var k=a.lastRenderedState,W=T(k,c);if(b.hasEagerState=!0,b.eagerState=W,ti(W,k))return ur(e,a,b,0),Oe===null&&No(),!1}catch{}finally{}if(c=Ss(e,a,b,h),c!==null)return Ve(c,e,h),Sh(c,a,h),!0}return!1}function wn(e,a,c,h){if(h={lane:2,revertLane:kg(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Qo(e)){if(a)throw Error(i(479))}else a=Ss(e,c,h,2),a!==null&&Ve(a,e,2)}function Qo(e){var a=e.alternate;return e===ye||a!==null&&a===ye}function g0(e,a){oa=Sr=!0;var c=e.pending;c===null?a.next=a:(a.next=c.next,c.next=a),e.pending=a}function Sh(e,a,c){if((c&4194048)!==0){var h=a.lanes;h&=e.pendingLanes,c|=h,a.lanes=c,vf(e,c)}}var Ul={readContext:on,use:hc,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useLayoutEffect:Tn,useInsertionEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useSyncExternalStore:Tn,useId:Tn,useHostTransitionStatus:Tn,useFormState:Tn,useActionState:Tn,useOptimistic:Tn,useMemoCache:Tn,useCacheRefresh:Tn};Ul.useEffectEvent=Tn;var js={readContext:on,use:hc,useCallback:function(e,a){return Ei().memoizedState=[e,a===void 0?null:a],e},useContext:on,useEffect:i0,useImperativeHandle:function(e,a,c){c=c!=null?c.concat([e]):null,vc(4194308,4,l0.bind(null,a,e),c)},useLayoutEffect:function(e,a){return vc(4194308,4,e,a)},useInsertionEffect:function(e,a){vc(4,2,e,a)},useMemo:function(e,a){var c=Ei();a=a===void 0?null:a;var h=e();if(Ns){ki(!0);try{e()}finally{ki(!1)}}return c.memoizedState=[h,a],h},useReducer:function(e,a,c){var h=Ei();if(c!==void 0){var b=c(a);if(Ns){ki(!0);try{c(a)}finally{ki(!1)}}}else b=a;return h.memoizedState=h.baseState=b,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:b},h.queue=e,e=e.dispatch=Hg.bind(null,ye,e),[h.memoizedState,e]},useRef:function(e){var a=Ei();return e={current:e},a.memoizedState=e},useState:function(e){e=gc(e);var a=e.queue,c=yh.bind(null,ye,a);return a.dispatch=c,[e.memoizedState,c]},useDebugValue:Sc,useDeferredValue:function(e,a){var c=Ei();return Ji(c,e,a)},useTransition:function(){var e=gc(!1);return e=bc.bind(null,ye,e.queue,!0,!1),Ei().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,a,c){var h=ye,b=Ei();if(Ne){if(c===void 0)throw Error(i(407));c=c()}else{if(c=a(),Oe===null)throw Error(i(349));(Ce&127)!==0||Kd(h,a,c)}b.memoizedState=c;var T={value:c,getSnapshot:a};return b.queue=T,i0(uh.bind(null,h,T,e),[e]),h.flags|=2048,jl(9,{destroy:void 0},Qd.bind(null,h,T,c,a),null),c},useId:function(){var e=Ei(),a=Oe.identifierPrefix;if(Ne){var c=va,h=ma;c=(h&~(1<<32-hi(h)-1)).toString(32)+c,a="_"+a+"R_"+c,c=cc++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=Ug++,a="_"+a+"r_"+c.toString(32)+"_";return e.memoizedState=a},useHostTransitionStatus:Ec,useFormState:dh,useActionState:dh,useOptimistic:function(e){var a=Ei();a.memoizedState=a.baseState=e;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=wn.bind(null,ye,!0,c),c.dispatch=a,[e,a]},useMemoCache:sh,useCacheRefresh:function(){return Ei().memoizedState=Gg.bind(null,ye)},useEffectEvent:function(e){var a=Ei(),c={impl:e};return a.memoizedState=c,function(){if((le&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},Xo={readContext:on,use:hc,useCallback:u0,useContext:on,useEffect:gh,useImperativeHandle:o0,useInsertionEffect:r0,useLayoutEffect:s0,useMemo:c0,useReducer:dc,useRef:n0,useState:function(){return dc(ka)},useDebugValue:Sc,useDeferredValue:function(e,a){var c=Rn();return ph(c,Qe.memoizedState,e,a)},useTransition:function(){var e=dc(ka)[0],a=Rn().memoizedState;return[typeof e=="boolean"?e:Yo(e),a]},useSyncExternalStore:Yd,useId:vh,useHostTransitionStatus:Ec,useFormState:$d,useActionState:$d,useOptimistic:function(e,a){var c=Rn();return fh(c,Qe,e,a)},useMemoCache:sh,useCacheRefresh:d0};Xo.useEffectEvent=a0;var Us={readContext:on,use:hc,useCallback:u0,useContext:on,useEffect:gh,useImperativeHandle:o0,useInsertionEffect:r0,useLayoutEffect:s0,useMemo:c0,useReducer:oh,useRef:n0,useState:function(){return oh(ka)},useDebugValue:Sc,useDeferredValue:function(e,a){var c=Rn();return Qe===null?Ji(c,e,a):ph(c,Qe.memoizedState,e,a)},useTransition:function(){var e=oh(ka)[0],a=Rn().memoizedState;return[typeof e=="boolean"?e:Yo(e),a]},useSyncExternalStore:Yd,useId:vh,useHostTransitionStatus:Ec,useFormState:e0,useActionState:e0,useOptimistic:function(e,a){var c=Rn();return Qe!==null?fh(c,Qe,e,a):(c.baseState=e,[e,c.queue.dispatch])},useMemoCache:sh,useCacheRefresh:d0};Us.useEffectEvent=a0;function $r(e,a,c,h){a=e.memoizedState,c=c(h,a),c=c==null?a:C({},a,c),e.memoizedState=c,e.lanes===0&&(e.updateQueue.baseState=c)}var Ci={enqueueSetState:function(e,a,c){e=e._reactInternals;var h=vi(),b=Xr(h);b.payload=a,c!=null&&(b.callback=c),a=Fr(e,b,h),a!==null&&(Ve(a,e,h),ko(a,e,h))},enqueueReplaceState:function(e,a,c){e=e._reactInternals;var h=vi(),b=Xr(h);b.tag=1,b.payload=a,c!=null&&(b.callback=c),a=Fr(e,b,h),a!==null&&(Ve(a,e,h),ko(a,e,h))},enqueueForceUpdate:function(e,a){e=e._reactInternals;var c=vi(),h=Xr(c);h.tag=2,a!=null&&(h.callback=a),a=Fr(e,h,c),a!==null&&(Ve(a,e,c),ko(a,e,c))}};function p0(e,a,c,h,b,T,k){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,T,k):a.prototype&&a.prototype.isPureReactComponent?!ra(c,h)||!ra(b,T):!0}function m0(e,a,c,h){e=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,h),a.state!==e&&Ci.enqueueReplaceState(a,a.state,null)}function qa(e,a){var c=a;if("ref"in a){c={};for(var h in a)h!=="ref"&&(c[h]=a[h])}if(e=e.defaultProps){c===a&&(c=C({},c));for(var b in e)c[b]===void 0&&(c[b]=e[b])}return c}function Fo(e){da(e)}function Jo(e){console.error(e)}function Cc(e){da(e)}function Tc(e,a){try{var c=e.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function v0(e,a,c){try{var h=e.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function Zi(e,a,c){return c=Xr(c),c.tag=3,c.payload={element:null},c.callback=function(){Tc(e,a)},c}function bh(e){return e=Xr(e),e.tag=3,e}function y0(e,a,c,h){var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var T=h.value;e.payload=function(){return b(T)},e.callback=function(){v0(a,c,h)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(e.callback=function(){v0(a,c,h),typeof b!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var W=h.stack;this.componentDidCatch(h.value,{componentStack:W!==null?W:""})})}function _h(e,a,c,h,b){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=c.alternate,a!==null&&Rl(a,c,b,!0),c=gn.current,c!==null){switch(c.tag){case 31:case 13:return la===null?S():c.alternate===null&&nn===0&&(nn=3),c.flags&=-257,c.flags|=65536,c.lanes=b,h===Go?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([h]):a.add(h),$e(e,h,b)),!1;case 22:return c.flags|=65536,h===Go?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([h]):c.add(h)),$e(e,h,b)),!1}throw Error(i(435,c.tag))}return $e(e,h,b),S(),!1}if(Ne)return a=gn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=b,h!==tc&&(e=Error(i(422),{cause:h}),Ol(Ki(e,c)))):(h!==tc&&(a=Error(i(423),{cause:h}),Ol(Ki(a,c))),e=e.current.alternate,e.flags|=65536,b&=-b,e.lanes|=b,h=Ki(h,c),b=Zi(e.stateNode,h,b),th(e,b),nn!==4&&(nn=2)),!1;var T=Error(i(520),{cause:h});if(T=Ki(T,c),Le===null?Le=[T]:Le.push(T),nn!==4&&(nn=2),a===null)return!0;h=Ki(h,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,e=b&-b,c.lanes|=e,e=Zi(c.stateNode,h,e),th(c,e),!1;case 1:if(a=c.type,T=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ri===null||!Ri.has(T))))return c.flags|=65536,b&=-b,c.lanes|=b,b=bh(b),y0(b,e,c,h),th(c,b),!1}c=c.return}while(c!==null);return!1}var Eh=Error(i(461)),Gn=!1;function ri(e,a,c,h){a.child=e===null?Id(a,null,c,h):xs(a,e.child,c,h)}function Bl(e,a,c,h,b){c=c.render;var T=a.ref;if("ref"in h){var k={};for(var W in h)W!=="ref"&&(k[W]=h[W])}else k=h;return hr(a),h=Ds(e,a,c,k,T,b),W=ih(),e!==null&&!Gn?(ah(e,a,b),_a(e,a,b)):(Ne&&W&&Uo(a),a.flags|=1,ri(e,a,h,b),a.child)}function Bi(e,a,c,h,b){if(e===null){var T=c.type;return typeof T=="function"&&!Ju(T)&&T.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=T,Ac(e,a,T,h,b)):(e=Cl(c.type,null,h,a,a.mode,b),e.ref=a.ref,e.return=a,a.child=e)}if(T=e.child,!Ti(e,b)){var k=T.memoizedProps;if(c=c.compare,c=c!==null?c:ra,c(k,h)&&e.ref===a.ref)return _a(e,a,b)}return a.flags|=1,e=ga(T,h),e.ref=a.ref,e.return=a,a.child=e}function Ac(e,a,c,h,b){if(e!==null){var T=e.memoizedProps;if(ra(T,h)&&e.ref===a.ref)if(Gn=!1,a.pendingProps=h=T,Ti(e,b))(e.flags&131072)!==0&&(Gn=!0);else return a.lanes=e.lanes,_a(e,a,b)}return zi(e,a,c,h,b)}function Ch(e,a,c,h){var b=h.children,T=e!==null?e.memoizedState:null;if(e===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((a.flags&128)!==0){if(T=T!==null?T.baseLanes|c:c,e!==null){for(h=a.child=e.child,b=0;h!==null;)b=b|h.lanes|h.childLanes,h=h.sibling;h=b&~T}else h=0,a.child=null;return Th(e,a,T,c,h)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},e!==null&&dr(a,T!==null?T.cachePool:null),T!==null?La(a,T):Kn(),Ha(a);else return h=a.lanes=536870912,Th(e,a,T!==null?T.baseLanes|c:c,c,h)}else T!==null?(dr(a,T.cachePool),La(a,T),Wr(),a.memoizedState=null):(e!==null&&dr(a,null),Kn(),Wr());return ri(e,a,b,c),a.child}function Bs(e,a){return e!==null&&e.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Th(e,a,c,h,b){var T=Ml();return T=T===null?null:{parent:Bn._currentValue,pool:T},a.memoizedState={baseLanes:c,cachePool:T},e!==null&&dr(a,null),Kn(),Ha(a),e!==null&&Rl(e,a,h,!0),a.childLanes=b,null}function br(e,a){return a=Qn({mode:a.mode,children:a.children},e.mode),a.ref=e.ref,e.child=a,a.return=e,a}function zs(e,a,c){return xs(a,e.child,null,c),e=br(a,a.pendingProps),e.flags|=2,Fi(a),a.memoizedState=null,e}function Oc(e,a,c){var h=a.pendingProps,b=(a.flags&128)!==0;if(a.flags&=-129,e===null){if(Ne){if(h.mode==="hidden")return e=br(a,h),a.lanes=536870912,Bs(null,e);if(zn(a),(e=tn)?(e=Nv(e,_i),e=e!==null&&e.data==="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:cr!==null?{id:ma,overflow:va}:null,retryLane:536870912,hydrationErrors:null},c=Di(e),c.return=a,a.child=c,ai=a,tn=null)):e=null,e===null)throw fr(a);return a.lanes=536870912,null}return br(a,h)}var T=e.memoizedState;if(T!==null){var k=T.dehydrated;if(zn(a),b)if(a.flags&256)a.flags&=-257,a=zs(e,a,c);else if(a.memoizedState!==null)a.child=e.child,a.flags|=128,a=null;else throw Error(i(558));else if(Gn||Rl(e,a,c,!1),b=(c&e.childLanes)!==0,Gn||b){if(h=Oe,h!==null&&(k=co(h,c),k!==0&&k!==T.retryLane))throw T.retryLane=k,Yi(e,k),Ve(h,e,k),Eh;S(),a=zs(e,a,c)}else e=T.treeContext,tn=Wa(k.nextSibling),ai=a,Ne=!0,Qi=null,_i=!1,e!==null&&Hd(a,e),a=br(a,h),a.flags|=4096;return a}return e=ga(e.child,{mode:h.mode,children:h.children}),e.ref=a.ref,a.child=e,e.return=a,e}function Ls(e,a){var c=a.ref;if(c===null)e!==null&&e.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(e===null||e.ref!==c)&&(a.flags|=4194816)}}function zi(e,a,c,h,b){return hr(a),c=Ds(e,a,c,h,void 0,b),h=ih(),e!==null&&!Gn?(ah(e,a,b),_a(e,a,b)):(Ne&&h&&Uo(a),a.flags|=1,ri(e,a,c,b),a.child)}function Wi(e,a,c,h,b,T){return hr(a),a.updateQueue=null,c=Vd(a,h,c,b),qd(e),h=ih(),e!==null&&!Gn?(ah(e,a,T),_a(e,a,T)):(Ne&&h&&Uo(a),a.flags|=1,ri(e,a,c,T),a.child)}function ts(e,a,c,h,b){if(hr(a),a.stateNode===null){var T=ja,k=c.contextType;typeof k=="object"&&k!==null&&(T=on(k)),T=new c(h,T),a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Ci,a.stateNode=T,T._reactInternals=a,T=a.stateNode,T.props=h,T.state=a.memoizedState,T.refs={},Ms(a),k=c.contextType,T.context=typeof k=="object"&&k!==null?on(k):ja,T.state=a.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&($r(a,c,k,h),T.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(k=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),k!==T.state&&Ci.enqueueReplaceState(T,T.state,null),Jr(a,h,T,b),Nl(),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(e===null){T=a.stateNode;var W=a.memoizedProps,lt=qa(c,W);T.props=lt;var yt=T.context,At=c.contextType;k=ja,typeof At=="object"&&At!==null&&(k=on(At));var wt=c.getDerivedStateFromProps;At=typeof wt=="function"||typeof T.getSnapshotBeforeUpdate=="function",W=a.pendingProps!==W,At||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(W||yt!==k)&&m0(a,T,h,k),yr=!1;var _t=a.memoizedState;T.state=_t,Jr(a,h,T,b),Nl(),yt=a.memoizedState,W||_t!==yt||yr?(typeof wt=="function"&&($r(a,c,wt,h),yt=a.memoizedState),(lt=yr||p0(a,c,lt,h,_t,yt,k))?(At||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=yt),T.props=h,T.state=yt,T.context=k,h=lt):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{T=a.stateNode,$f(e,a),k=a.memoizedProps,At=qa(c,k),T.props=At,wt=a.pendingProps,_t=T.context,yt=c.contextType,lt=ja,typeof yt=="object"&&yt!==null&&(lt=on(yt)),W=c.getDerivedStateFromProps,(yt=typeof W=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(k!==wt||_t!==lt)&&m0(a,T,h,lt),yr=!1,_t=a.memoizedState,T.state=_t,Jr(a,h,T,b),Nl();var Ct=a.memoizedState;k!==wt||_t!==Ct||yr||e!==null&&e.dependencies!==null&&nc(e.dependencies)?(typeof W=="function"&&($r(a,c,W,h),Ct=a.memoizedState),(At=yr||p0(a,c,At,h,_t,Ct,lt)||e!==null&&e.dependencies!==null&&nc(e.dependencies))?(yt||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(h,Ct,lt),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(h,Ct,lt)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||k===e.memoizedProps&&_t===e.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&_t===e.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=Ct),T.props=h,T.state=Ct,T.context=lt,h=At):(typeof T.componentDidUpdate!="function"||k===e.memoizedProps&&_t===e.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&_t===e.memoizedState||(a.flags|=1024),h=!1)}return T=h,Ls(e,a),h=(a.flags&128)!==0,T||h?(T=a.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:T.render(),a.flags|=1,e!==null&&h?(a.child=xs(a,e.child,null,b),a.child=xs(a,null,c,b)):ri(e,a,c,b),a.memoizedState=T.state,e=a.child):e=_a(e,a,b),e}function Va(e,a,c,h){return Vr(),a.flags|=256,ri(e,a,c,h),a.child}var Sa={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kn(e){return{baseLanes:e,cachePool:Os()}}function Gs(e,a,c){return e=e!==null?e.childLanes&~c:0,a&&(e|=ue),e}function _r(e,a,c){var h=a.pendingProps,b=!1,T=(a.flags&128)!==0,k;if((k=T)||(k=e!==null&&e.memoizedState===null?!1:(On.current&2)!==0),k&&(b=!0,a.flags&=-129),k=(a.flags&32)!==0,a.flags&=-33,e===null){if(Ne){if(b?Zr(a):Wr(),(e=tn)?(e=Nv(e,_i),e=e!==null&&e.data!=="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:cr!==null?{id:ma,overflow:va}:null,retryLane:536870912,hydrationErrors:null},c=Di(e),c.return=a,a.child=c,ai=a,tn=null)):e=null,e===null)throw fr(a);return ep(e)?a.lanes=32:a.lanes=536870912,null}var W=h.children;return h=h.fallback,b?(Wr(),b=a.mode,W=Qn({mode:"hidden",children:W},b),h=qr(h,b,c,null),W.return=a,h.return=a,W.sibling=h,a.child=W,h=a.child,h.memoizedState=kn(c),h.childLanes=Gs(e,k,c),a.memoizedState=Sa,Bs(null,h)):(Zr(a),zl(a,W))}var lt=e.memoizedState;if(lt!==null&&(W=lt.dehydrated,W!==null)){if(T)a.flags&256?(Zr(a),a.flags&=-257,a=xn(e,a,c)):a.memoizedState!==null?(Wr(),a.child=e.child,a.flags|=128,a=null):(Wr(),W=h.fallback,b=a.mode,h=Qn({mode:"visible",children:h.children},b),W=qr(W,b,c,null),W.flags|=2,h.return=a,W.return=a,h.sibling=W,a.child=h,xs(a,e.child,null,c),h=a.child,h.memoizedState=kn(c),h.childLanes=Gs(e,k,c),a.memoizedState=Sa,a=Bs(null,h));else if(Zr(a),ep(W)){if(k=W.nextSibling&&W.nextSibling.dataset,k)var yt=k.dgst;k=yt,h=Error(i(419)),h.stack="",h.digest=k,Ol({value:h,source:null,stack:null}),a=xn(e,a,c)}else if(Gn||Rl(e,a,c,!1),k=(c&e.childLanes)!==0,Gn||k){if(k=Oe,k!==null&&(h=co(k,c),h!==0&&h!==lt.retryLane))throw lt.retryLane=h,Yi(e,h),Ve(k,e,h),Eh;tp(W)||S(),a=xn(e,a,c)}else tp(W)?(a.flags|=192,a.child=e.child,a=null):(e=lt.treeContext,tn=Wa(W.nextSibling),ai=a,Ne=!0,Qi=null,_i=!1,e!==null&&Hd(a,e),a=zl(a,h.children),a.flags|=4096);return a}return b?(Wr(),W=h.fallback,b=a.mode,lt=e.child,yt=lt.sibling,h=ga(lt,{mode:"hidden",children:h.children}),h.subtreeFlags=lt.subtreeFlags&65011712,yt!==null?W=ga(yt,W):(W=qr(W,b,c,null),W.flags|=2),W.return=a,h.return=a,h.sibling=W,a.child=h,Bs(null,h),h=a.child,W=e.child.memoizedState,W===null?W=kn(c):(b=W.cachePool,b!==null?(lt=Bn._currentValue,b=b.parent!==lt?{parent:lt,pool:lt}:b):b=Os(),W={baseLanes:W.baseLanes|c,cachePool:b}),h.memoizedState=W,h.childLanes=Gs(e,k,c),a.memoizedState=Sa,Bs(e.child,h)):(Zr(a),c=e.child,e=c.sibling,c=ga(c,{mode:"visible",children:h.children}),c.return=a,c.sibling=null,e!==null&&(k=a.deletions,k===null?(a.deletions=[e],a.flags|=16):k.push(e)),a.child=c,a.memoizedState=null,c)}function zl(e,a){return a=Qn({mode:"visible",children:a},e.mode),a.return=e,e.child=a}function Qn(e,a){return e=di(22,e,null,a),e.lanes=0,e}function xn(e,a,c){return xs(a,e.child,null,c),e=zl(a,a.pendingProps.children),e.flags|=2,a.memoizedState=null,e}function Pe(e,a,c){e.lanes|=a;var h=e.alternate;h!==null&&(h.lanes|=a),Ff(e.return,a,c)}function Er(e,a,c,h,b,T){var k=e.memoizedState;k===null?e.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:b,treeForkCount:T}:(k.isBackwards=a,k.rendering=null,k.renderingStartTime=0,k.last=h,k.tail=c,k.tailMode=b,k.treeForkCount=T)}function ba(e,a,c){var h=a.pendingProps,b=h.revealOrder,T=h.tail;h=h.children;var k=On.current,W=(k&2)!==0;if(W?(k=k&1|2,a.flags|=128):k&=1,it(On,k),ri(e,a,h,c),h=Ne?Al:0,!W&&e!==null&&(e.flags&128)!==0)t:for(e=a.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pe(e,c,a);else if(e.tag===19)Pe(e,c,a);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===a)break t;for(;e.sibling===null;){if(e.return===null||e.return===a)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(b){case"forwards":for(c=a.child,b=null;c!==null;)e=c.alternate,e!==null&&uc(e)===null&&(b=c),c=c.sibling;c=b,c===null?(b=a.child,a.child=null):(b=c.sibling,c.sibling=null),Er(a,!1,b,c,T,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,b=a.child,a.child=null;b!==null;){if(e=b.alternate,e!==null&&uc(e)===null){a.child=b;break}e=b.sibling,b.sibling=c,c=b,b=e}Er(a,!0,c,null,T,h);break;case"together":Er(a,!1,null,null,void 0,h);break;default:a.memoizedState=null}return a.child}function _a(e,a,c){if(e!==null&&(a.dependencies=e.dependencies),as|=a.lanes,(c&a.childLanes)===0)if(e!==null){if(Rl(e,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(e!==null&&a.child!==e.child)throw Error(i(153));if(a.child!==null){for(e=a.child,c=ga(e,e.pendingProps),a.child=c,c.return=a;e.sibling!==null;)e=e.sibling,c=c.sibling=ga(e,e.pendingProps),c.return=a;c.sibling=null}return a.child}function Ti(e,a){return(e.lanes&a)!==0?!0:(e=e.dependencies,!!(e!==null&&nc(e)))}function Rc(e,a,c){switch(a.tag){case 3:ht(a,a.stateNode.containerInfo),Yr(a,Bn,e.memoizedState.cache),Vr();break;case 27:case 5:jt(a);break;case 4:ht(a,a.stateNode.containerInfo);break;case 10:Yr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,zn(a),null;break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(Zr(a),a.flags|=128,null):(c&a.child.childLanes)!==0?_r(e,a,c):(Zr(a),e=_a(e,a,c),e!==null?e.sibling:null);Zr(a);break;case 19:var b=(e.flags&128)!==0;if(h=(c&a.childLanes)!==0,h||(Rl(e,a,c,!1),h=(c&a.childLanes)!==0),b){if(h)return ba(e,a,c);a.flags|=128}if(b=a.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),it(On,On.current),h)break;return null;case 22:return a.lanes=0,Ch(e,a,c,a.pendingProps);case 24:Yr(a,Bn,e.memoizedState.cache)}return _a(e,a,c)}function es(e,a,c){if(e!==null)if(e.memoizedProps!==a.pendingProps)Gn=!0;else{if(!Ti(e,c)&&(a.flags&128)===0)return Gn=!1,Rc(e,a,c);Gn=(e.flags&131072)!==0}else Gn=!1,Ne&&(a.flags&1048576)!==0&&$u(a,Al,a.index);switch(a.lanes=0,a.tag){case 16:t:{var h=a.pendingProps;if(e=pr(a.elementType),a.type=e,typeof e=="function")Ju(e)?(h=qa(e,h),a.tag=1,a=ts(null,a,e,h,c)):(a.tag=0,a=zi(null,a,e,h,c));else{if(e!=null){var b=e.$$typeof;if(b===L){a.tag=11,a=Bl(null,a,e,h,c);break t}else if(b===O){a.tag=14,a=Bi(null,a,e,h,c);break t}}throw a=Q(e)||e,Error(i(306,a,""))}}return a;case 0:return zi(e,a,a.type,a.pendingProps,c);case 1:return h=a.type,b=qa(h,a.pendingProps),ts(e,a,h,b,c);case 3:t:{if(ht(a,a.stateNode.containerInfo),e===null)throw Error(i(387));h=a.pendingProps;var T=a.memoizedState;b=T.element,$f(e,a),Jr(a,h,null,c);var k=a.memoizedState;if(h=k.cache,Yr(a,Bn,h),h!==T.cache&&Jf(a,[Bn],c,!0),Nl(),h=k.element,T.isDehydrated)if(T={element:h,isDehydrated:!1,cache:k.cache},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){a=Va(e,a,h,c);break t}else if(h!==b){b=Ki(Error(i(424)),a),Ol(b),a=Va(e,a,h,c);break t}else{switch(e=a.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(tn=Wa(e.firstChild),ai=a,Ne=!0,Qi=null,_i=!0,c=Id(a,null,h,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Vr(),h===b){a=_a(e,a,c);break t}ri(e,a,h,c)}a=a.child}return a;case 26:return Ls(e,a),e===null?(c=Lv(a.type,null,a.pendingProps,null))?a.memoizedState=c:Ne||(c=a.type,e=a.pendingProps,h=O0($.current).createElement(c),h[Pn]=a,h[Vn]=e,wi(h,c,e),Yn(h),a.stateNode=h):a.memoizedState=Lv(a.type,e.memoizedProps,a.pendingProps,e.memoizedState),null;case 27:return jt(a),e===null&&Ne&&(h=a.stateNode=Uv(a.type,a.pendingProps,$.current),ai=a,_i=!0,b=tn,Vl(a.type)?(np=b,tn=Wa(h.firstChild)):tn=b),ri(e,a,a.pendingProps.children,c),Ls(e,a),e===null&&(a.flags|=4194304),a.child;case 5:return e===null&&Ne&&((b=h=tn)&&(h=E4(h,a.type,a.pendingProps,_i),h!==null?(a.stateNode=h,ai=a,tn=Wa(h.firstChild),_i=!1,b=!0):b=!1),b||fr(a)),jt(a),b=a.type,T=a.pendingProps,k=e!==null?e.memoizedProps:null,h=T.children,Zg(b,T)?h=null:k!==null&&Zg(b,k)&&(a.flags|=32),a.memoizedState!==null&&(b=Ds(e,a,Bg,null,null,c),Lh._currentValue=b),Ls(e,a),ri(e,a,h,c),a.child;case 6:return e===null&&Ne&&((e=c=tn)&&(c=C4(c,a.pendingProps,_i),c!==null?(a.stateNode=c,ai=a,tn=null,e=!0):e=!1),e||fr(a)),null;case 13:return _r(e,a,c);case 4:return ht(a,a.stateNode.containerInfo),h=a.pendingProps,e===null?a.child=xs(a,null,h,c):ri(e,a,h,c),a.child;case 11:return Bl(e,a,a.type,a.pendingProps,c);case 7:return ri(e,a,a.pendingProps,c),a.child;case 8:return ri(e,a,a.pendingProps.children,c),a.child;case 12:return ri(e,a,a.pendingProps.children,c),a.child;case 10:return h=a.pendingProps,Yr(a,a.type,h.value),ri(e,a,h.children,c),a.child;case 9:return b=a.type._context,h=a.pendingProps.children,hr(a),b=on(b),h=h(b),a.flags|=1,ri(e,a,h,c),a.child;case 14:return Bi(e,a,a.type,a.pendingProps,c);case 15:return Ac(e,a,a.type,a.pendingProps,c);case 19:return ba(e,a,c);case 31:return Oc(e,a,c);case 22:return Ch(e,a,c,a.pendingProps);case 24:return hr(a),h=on(Bn),e===null?(b=Ml(),b===null&&(b=Oe,T=ic(),b.pooledCache=T,T.refCount++,T!==null&&(b.pooledCacheLanes|=c),b=T),a.memoizedState={parent:h,cache:b},Ms(a),Yr(a,Bn,b)):((e.lanes&c)!==0&&($f(e,a),Jr(a,null,null,c),Nl()),b=e.memoizedState,T=a.memoizedState,b.parent!==h?(b={parent:h,cache:h},a.memoizedState=b,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=b),Yr(a,Bn,h)):(h=T.cache,Yr(a,Bn,h),h!==b.cache&&Jf(a,[Bn],c,!0))),ri(e,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function si(e){e.flags|=4}function Ah(e,a,c,h,b){if((a=(e.mode&32)!==0)&&(a=!1),a){if(e.flags|=16777216,(b&335544128)===b)if(e.stateNode.complete)e.flags|=8192;else if(s())e.flags|=8192;else throw mr=Go,Lo}else e.flags&=-16777217}function S0(e,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!kv(a))if(s())e.flags|=8192;else throw mr=Go,Lo}function wc(e,a){a!==null&&(e.flags|=4),e.flags&16384&&(a=e.tag!==22?ze():536870912,e.lanes|=a,Re|=a)}function en(e,a){if(!Ne)switch(e.tailMode){case"hidden":a=e.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?e.tail=null:c.sibling=null;break;case"collapsed":c=e.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function Je(e){var a=e.alternate!==null&&e.alternate.child===e.child,c=0,h=0;if(a)for(var b=e.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags&65011712,h|=b.flags&65011712,b.return=e,b=b.sibling;else for(b=e.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags,h|=b.flags,b.return=e,b=b.sibling;return e.subtreeFlags|=h,e.childLanes=c,a}function Ll(e,a,c){var h=a.pendingProps;switch(Kf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Je(a),null;case 1:return Je(a),null;case 3:return c=a.stateNode,h=null,e!==null&&(h=e.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),Ba(Bn),Tt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(_s(a)?si(a):e===null||e.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Es())),Je(a),null;case 26:var b=a.type,T=a.memoizedState;return e===null?(si(a),T!==null?(Je(a),S0(a,T)):(Je(a),Ah(a,b,null,h,c))):T?T!==e.memoizedState?(si(a),Je(a),S0(a,T)):(Je(a),a.flags&=-16777217):(e=e.memoizedProps,e!==h&&si(a),Je(a),Ah(a,b,e,h,c)),null;case 27:if(Kt(a),c=$.current,b=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==h&&si(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return Je(a),null}e=q.current,_s(a)?Qf(a):(e=Uv(b,h,c),a.stateNode=e,si(a))}return Je(a),null;case 5:if(Kt(a),b=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==h&&si(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return Je(a),null}if(T=q.current,_s(a))Qf(a);else{var k=O0($.current);switch(T){case 1:T=k.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:T=k.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":T=k.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":T=k.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":T=k.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof h.is=="string"?k.createElement("select",{is:h.is}):k.createElement("select"),h.multiple?T.multiple=!0:h.size&&(T.size=h.size);break;default:T=typeof h.is=="string"?k.createElement(b,{is:h.is}):k.createElement(b)}}T[Pn]=a,T[Vn]=h;t:for(k=a.child;k!==null;){if(k.tag===5||k.tag===6)T.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===a)break t;for(;k.sibling===null;){if(k.return===null||k.return===a)break t;k=k.return}k.sibling.return=k.return,k=k.sibling}a.stateNode=T;t:switch(wi(T,b,h),b){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&si(a)}}return Je(a),Ah(a,a.type,e===null?null:e.memoizedProps,a.pendingProps,c),null;case 6:if(e&&a.stateNode!=null)e.memoizedProps!==h&&si(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(i(166));if(e=$.current,_s(a)){if(e=a.stateNode,c=a.memoizedProps,h=null,b=ai,b!==null)switch(b.tag){case 27:case 5:h=b.memoizedProps}e[Pn]=a,e=!!(e.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||Cv(e.nodeValue,c)),e||fr(a,!0)}else e=O0(e).createTextNode(h),e[Pn]=a,a.stateNode=e}return Je(a),null;case 31:if(c=a.memoizedState,e===null||e.memoizedState!==null){if(h=_s(a),c!==null){if(e===null){if(!h)throw Error(i(318));if(e=a.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[Pn]=a}else Vr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Je(a),e=!1}else c=Es(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),e=!0;if(!e)return a.flags&256?(Fi(a),a):(Fi(a),null);if((a.flags&128)!==0)throw Error(i(558))}return Je(a),null;case 13:if(h=a.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(b=_s(a),h!==null&&h.dehydrated!==null){if(e===null){if(!b)throw Error(i(318));if(b=a.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(i(317));b[Pn]=a}else Vr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Je(a),b=!1}else b=Es(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=b),b=!0;if(!b)return a.flags&256?(Fi(a),a):(Fi(a),null)}return Fi(a),(a.flags&128)!==0?(a.lanes=c,a):(c=h!==null,e=e!==null&&e.memoizedState!==null,c&&(h=a.child,b=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(b=h.alternate.memoizedState.cachePool.pool),T=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(T=h.memoizedState.cachePool.pool),T!==b&&(h.flags|=2048)),c!==e&&c&&(a.child.flags|=8192),wc(a,a.updateQueue),Je(a),null);case 4:return Tt(),e===null&&Kg(a.stateNode.containerInfo),Je(a),null;case 10:return Ba(a.type),Je(a),null;case 19:if(rt(On),h=a.memoizedState,h===null)return Je(a),null;if(b=(a.flags&128)!==0,T=h.rendering,T===null)if(b)en(h,!1);else{if(nn!==0||e!==null&&(e.flags&128)!==0)for(e=a.child;e!==null;){if(T=uc(e),T!==null){for(a.flags|=128,en(h,!1),e=T.updateQueue,a.updateQueue=e,wc(a,e),a.subtreeFlags=0,e=c,c=a.child;c!==null;)Zu(c,e),c=c.sibling;return it(On,On.current&1|2),Ne&&Ua(a,h.treeForkCount),a.child}e=e.sibling}h.tail!==null&&ae()>fa&&(a.flags|=128,b=!0,en(h,!1),a.lanes=4194304)}else{if(!b)if(e=uc(T),e!==null){if(a.flags|=128,b=!0,e=e.updateQueue,a.updateQueue=e,wc(a,e),en(h,!0),h.tail===null&&h.tailMode==="hidden"&&!T.alternate&&!Ne)return Je(a),null}else 2*ae()-h.renderingStartTime>fa&&c!==536870912&&(a.flags|=128,b=!0,en(h,!1),a.lanes=4194304);h.isBackwards?(T.sibling=a.child,a.child=T):(e=h.last,e!==null?e.sibling=T:a.child=T,h.last=T)}return h.tail!==null?(e=h.tail,h.rendering=e,h.tail=e.sibling,h.renderingStartTime=ae(),e.sibling=null,c=On.current,it(On,b?c&1|2:c&1),Ne&&Ua(a,h.treeForkCount),e):(Je(a),null);case 22:case 23:return Fi(a),Ga(),h=a.memoizedState!==null,e!==null?e.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(c&536870912)!==0&&(a.flags&128)===0&&(Je(a),a.subtreeFlags&6&&(a.flags|=8192)):Je(a),c=a.updateQueue,c!==null&&wc(a,c.retryQueue),c=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==c&&(a.flags|=2048),e!==null&&rt(As),null;case 24:return c=null,e!==null&&(c=e.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Ba(Bn),Je(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Oh(e,a){switch(Kf(a),a.tag){case 1:return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 3:return Ba(Bn),Tt(),e=a.flags,(e&65536)!==0&&(e&128)===0?(a.flags=e&-65537|128,a):null;case 26:case 27:case 5:return Kt(a),null;case 31:if(a.memoizedState!==null){if(Fi(a),a.alternate===null)throw Error(i(340));Vr()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 13:if(Fi(a),e=a.memoizedState,e!==null&&e.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Vr()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 19:return rt(On),null;case 4:return Tt(),null;case 10:return Ba(a.type),null;case 22:case 23:return Fi(a),Ga(),e!==null&&rt(As),e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 24:return Ba(Bn),null;case 25:return null;default:return null}}function Zo(e,a){switch(Kf(a),a.tag){case 3:Ba(Bn),Tt();break;case 26:case 27:case 5:Kt(a);break;case 4:Tt();break;case 31:a.memoizedState!==null&&Fi(a);break;case 13:Fi(a);break;case 19:rt(On);break;case 10:Ba(a.type);break;case 22:case 23:Fi(a),Ga(),e!==null&&rt(As);break;case 24:Ba(Bn)}}function Hs(e,a){try{var c=a.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var b=h.next;c=b;do{if((c.tag&e)===e){h=void 0;var T=c.create,k=c.inst;h=T(),k.destroy=h}c=c.next}while(c!==b)}}catch(W){It(a,a.return,W)}}function $i(e,a,c){try{var h=a.updateQueue,b=h!==null?h.lastEffect:null;if(b!==null){var T=b.next;h=T;do{if((h.tag&e)===e){var k=h.inst,W=k.destroy;if(W!==void 0){k.destroy=void 0,b=a;var lt=c,yt=W;try{yt()}catch(At){It(b,lt,At)}}}h=h.next}while(h!==T)}}catch(At){It(a,a.return,At)}}function Gl(e){var a=e.updateQueue;if(a!==null){var c=e.stateNode;try{kd(a,c)}catch(h){It(e,e.return,h)}}}function xc(e,a,c){c.props=qa(e.type,e.memoizedProps),c.state=e.memoizedState;try{c.componentWillUnmount()}catch(h){It(e,a,h)}}function Ya(e,a){try{var c=e.ref;if(c!==null){switch(e.tag){case 26:case 27:case 5:var h=e.stateNode;break;case 30:h=e.stateNode;break;default:h=e.stateNode}typeof c=="function"?e.refCleanup=c(h):c.current=h}}catch(b){It(e,a,b)}}function Ai(e,a){var c=e.ref,h=e.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(b){It(e,a,b)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(b){It(e,a,b)}else c.current=null}function Rh(e){var a=e.type,c=e.memoizedProps,h=e.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break t;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(b){It(e,e.return,b)}}function Cr(e,a,c){try{var h=e.stateNode;m4(h,e.type,c,a),h[Vn]=a}catch(b){It(e,e.return,b)}}function b0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Vl(e.type)||e.tag===4}function Ps(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||b0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Vl(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wo(e,a,c){var h=e.tag;if(h===5||h===6)e=e.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(e,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(e),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Mi));else if(h!==4&&(h===27&&Vl(e.type)&&(c=e.stateNode,a=null),e=e.child,e!==null))for(Wo(e,a,c),e=e.sibling;e!==null;)Wo(e,a,c),e=e.sibling}function Is(e,a,c){var h=e.tag;if(h===5||h===6)e=e.stateNode,a?c.insertBefore(e,a):c.appendChild(e);else if(h!==4&&(h===27&&Vl(e.type)&&(c=e.stateNode),e=e.child,e!==null))for(Is(e,a,c),e=e.sibling;e!==null;)Is(e,a,c),e=e.sibling}function $o(e){var a=e.stateNode,c=e.memoizedProps;try{for(var h=e.type,b=a.attributes;b.length;)a.removeAttributeNode(b[0]);wi(a,h,c),a[Pn]=e,a[Vn]=c}catch(T){It(e,e.return,T)}}var Li=!1,ke=!1,ns=!1,Mc=typeof WeakSet=="function"?WeakSet:Set,un=null;function wh(e,a){if(e=e.containerInfo,Fg=j0,e=ha(e),Qu(e)){if("selectionStart"in e)var c={start:e.selectionStart,end:e.selectionEnd};else t:{c=(c=e.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var b=h.anchorOffset,T=h.focusNode;h=h.focusOffset;try{c.nodeType,T.nodeType}catch{c=null;break t}var k=0,W=-1,lt=-1,yt=0,At=0,wt=e,_t=null;e:for(;;){for(var Ct;wt!==c||b!==0&&wt.nodeType!==3||(W=k+b),wt!==T||h!==0&&wt.nodeType!==3||(lt=k+h),wt.nodeType===3&&(k+=wt.nodeValue.length),(Ct=wt.firstChild)!==null;)_t=wt,wt=Ct;for(;;){if(wt===e)break e;if(_t===c&&++yt===b&&(W=k),_t===T&&++At===h&&(lt=k),(Ct=wt.nextSibling)!==null)break;wt=_t,_t=wt.parentNode}wt=Ct}c=W===-1||lt===-1?null:{start:W,end:lt}}else c=null}c=c||{start:0,end:0}}else c=null;for(Jg={focusedElem:e,selectionRange:c},j0=!1,un=a;un!==null;)if(a=un,e=a.child,(a.subtreeFlags&1028)!==0&&e!==null)e.return=a,un=e;else for(;un!==null;){switch(a=un,T=a.alternate,e=a.flags,a.tag){case 0:if((e&4)!==0&&(e=a.updateQueue,e=e!==null?e.events:null,e!==null))for(c=0;c<e.length;c++)b=e[c],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&T!==null){e=void 0,c=a,b=T.memoizedProps,T=T.memoizedState,h=c.stateNode;try{var Zt=qa(c.type,b);e=h.getSnapshotBeforeUpdate(Zt,T),h.__reactInternalSnapshotBeforeUpdate=e}catch(ce){It(c,c.return,ce)}}break;case 3:if((e&1024)!==0){if(e=a.stateNode.containerInfo,c=e.nodeType,c===9)$g(e);else if(c===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":$g(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=a.sibling,e!==null){e.return=a.return,un=e;break}un=a.return}}function ks(e,a,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:Ka(e,c),h&4&&Hs(5,c);break;case 1:if(Ka(e,c),h&4)if(e=c.stateNode,a===null)try{e.componentDidMount()}catch(k){It(c,c.return,k)}else{var b=qa(c.type,a.memoizedProps);a=a.memoizedState;try{e.componentDidUpdate(b,a,e.__reactInternalSnapshotBeforeUpdate)}catch(k){It(c,c.return,k)}}h&64&&Gl(c),h&512&&Ya(c,c.return);break;case 3:if(Ka(e,c),h&64&&(e=c.updateQueue,e!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{kd(e,a)}catch(k){It(c,c.return,k)}}break;case 27:a===null&&h&4&&$o(c);case 26:case 5:Ka(e,c),a===null&&h&4&&Rh(c),h&512&&Ya(c,c.return);break;case 12:Ka(e,c);break;case 31:Ka(e,c),h&4&&eu(e,c);break;case 13:Ka(e,c),h&4&&qs(e,c),h&64&&(e=c.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(c=Jn.bind(null,c),T4(e,c))));break;case 22:if(h=c.memoizedState!==null||Li,!h){a=a!==null&&a.memoizedState!==null||ke,b=Li;var T=ke;Li=h,(ke=a)&&!T?Gi(e,c,(c.subtreeFlags&8772)!==0):Ka(e,c),Li=b,ke=T}break;case 30:break;default:Ka(e,c)}}function tu(e){var a=e.alternate;a!==null&&(e.alternate=null,tu(a)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(a=e.stateNode,a!==null&&bn(a)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var qe=null,se=!1;function De(e,a,c){for(c=c.child;c!==null;)Mn(e,a,c),c=c.sibling}function Mn(e,a,c){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(dn,c)}catch{}switch(c.tag){case 26:ke||Ai(c,a),De(e,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:ke||Ai(c,a);var h=qe,b=se;Vl(c.type)&&(qe=c.stateNode,se=!1),De(e,a,c),Uh(c.stateNode),qe=h,se=b;break;case 5:ke||Ai(c,a);case 6:if(h=qe,b=se,qe=null,De(e,a,c),qe=h,se=b,qe!==null)if(se)try{(qe.nodeType===9?qe.body:qe.nodeName==="HTML"?qe.ownerDocument.body:qe).removeChild(c.stateNode)}catch(T){It(c,a,T)}else try{qe.removeChild(c.stateNode)}catch(T){It(c,a,T)}break;case 18:qe!==null&&(se?(e=qe,xv(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,c.stateNode),Ic(e)):xv(qe,c.stateNode));break;case 4:h=qe,b=se,qe=c.stateNode.containerInfo,se=!0,De(e,a,c),qe=h,se=b;break;case 0:case 11:case 14:case 15:$i(2,c,a),ke||$i(4,c,a),De(e,a,c);break;case 1:ke||(Ai(c,a),h=c.stateNode,typeof h.componentWillUnmount=="function"&&xc(c,a,h)),De(e,a,c);break;case 21:De(e,a,c);break;case 22:ke=(h=ke)||c.memoizedState!==null,De(e,a,c),ke=h;break;default:De(e,a,c)}}function eu(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Ic(e)}catch(c){It(a,a.return,c)}}}function qs(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ic(e)}catch(c){It(a,a.return,c)}}function Vs(e){switch(e.tag){case 31:case 13:case 19:var a=e.stateNode;return a===null&&(a=e.stateNode=new Mc),a;case 22:return e=e.stateNode,a=e._retryCache,a===null&&(a=e._retryCache=new Mc),a;default:throw Error(i(435,e.tag))}}function Ys(e,a){var c=Vs(e);a.forEach(function(h){if(!c.has(h)){c.add(h);var b=Ie.bind(null,e,h);h.then(b,b)}})}function Xn(e,a){var c=a.deletions;if(c!==null)for(var h=0;h<c.length;h++){var b=c[h],T=e,k=a,W=k;t:for(;W!==null;){switch(W.tag){case 27:if(Vl(W.type)){qe=W.stateNode,se=!1;break t}break;case 5:qe=W.stateNode,se=!1;break t;case 3:case 4:qe=W.stateNode.containerInfo,se=!0;break t}W=W.return}if(qe===null)throw Error(i(160));Mn(T,k,b),qe=null,se=!1,T=b.alternate,T!==null&&(T.return=null),b.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)_0(a,e),a=a.sibling}var gi=null;function _0(e,a){var c=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Xn(a,e),li(e),h&4&&($i(3,e,e.return),Hs(3,e),$i(5,e,e.return));break;case 1:Xn(a,e),li(e),h&512&&(ke||c===null||Ai(c,c.return)),h&64&&Li&&(e=e.updateQueue,e!==null&&(h=e.callbacks,h!==null&&(c=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var b=gi;if(Xn(a,e),li(e),h&512&&(ke||c===null||Ai(c,c.return)),h&4){var T=c!==null?c.memoizedState:null;if(h=e.memoizedState,c===null)if(h===null)if(e.stateNode===null){t:{h=e.type,c=e.memoizedProps,b=b.ownerDocument||b;e:switch(h){case"title":T=b.getElementsByTagName("title")[0],(!T||T[fs]||T[Pn]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=b.createElement(h),b.head.insertBefore(T,b.querySelector("head > title"))),wi(T,h,c),T[Pn]=e,Yn(T),h=T;break t;case"link":var k=Pv("link","href",b).get(h+(c.href||""));if(k){for(var W=0;W<k.length;W++)if(T=k[W],T.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&T.getAttribute("rel")===(c.rel==null?null:c.rel)&&T.getAttribute("title")===(c.title==null?null:c.title)&&T.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice(W,1);break e}}T=b.createElement(h),wi(T,h,c),b.head.appendChild(T);break;case"meta":if(k=Pv("meta","content",b).get(h+(c.content||""))){for(W=0;W<k.length;W++)if(T=k[W],T.getAttribute("content")===(c.content==null?null:""+c.content)&&T.getAttribute("name")===(c.name==null?null:c.name)&&T.getAttribute("property")===(c.property==null?null:c.property)&&T.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&T.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice(W,1);break e}}T=b.createElement(h),wi(T,h,c),b.head.appendChild(T);break;default:throw Error(i(468,h))}T[Pn]=e,Yn(T),h=T}e.stateNode=h}else Iv(b,e.type,e.stateNode);else e.stateNode=Hv(b,h,e.memoizedProps);else T!==h?(T===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):T.count--,h===null?Iv(b,e.type,e.stateNode):Hv(b,h,e.memoizedProps)):h===null&&e.stateNode!==null&&Cr(e,e.memoizedProps,c.memoizedProps)}break;case 27:Xn(a,e),li(e),h&512&&(ke||c===null||Ai(c,c.return)),c!==null&&h&4&&Cr(e,e.memoizedProps,c.memoizedProps);break;case 5:if(Xn(a,e),li(e),h&512&&(ke||c===null||Ai(c,c.return)),e.flags&32){b=e.stateNode;try{Br(b,"")}catch(Zt){It(e,e.return,Zt)}}h&4&&e.stateNode!=null&&(b=e.memoizedProps,Cr(e,b,c!==null?c.memoizedProps:b)),h&1024&&(ns=!0);break;case 6:if(Xn(a,e),li(e),h&4){if(e.stateNode===null)throw Error(i(162));h=e.memoizedProps,c=e.stateNode;try{c.nodeValue=h}catch(Zt){It(e,e.return,Zt)}}break;case 3:if(x0=null,b=gi,gi=R0(a.containerInfo),Xn(a,e),gi=b,li(e),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Ic(a.containerInfo)}catch(Zt){It(e,e.return,Zt)}ns&&(ns=!1,xh(e));break;case 4:h=gi,gi=R0(e.stateNode.containerInfo),Xn(a,e),li(e),gi=h;break;case 12:Xn(a,e),li(e);break;case 31:Xn(a,e),li(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ys(e,h)));break;case 13:Xn(a,e),li(e),e.child.flags&8192&&e.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Ar=ae()),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ys(e,h)));break;case 22:b=e.memoizedState!==null;var lt=c!==null&&c.memoizedState!==null,yt=Li,At=ke;if(Li=yt||b,ke=At||lt,Xn(a,e),ke=At,Li=yt,li(e),h&8192)t:for(a=e.stateNode,a._visibility=b?a._visibility&-2:a._visibility|1,b&&(c===null||lt||Li||ke||Ks(e)),c=null,a=e;;){if(a.tag===5||a.tag===26){if(c===null){lt=c=a;try{if(T=lt.stateNode,b)k=T.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{W=lt.stateNode;var wt=lt.memoizedProps.style,_t=wt!=null&&wt.hasOwnProperty("display")?wt.display:null;W.style.display=_t==null||typeof _t=="boolean"?"":(""+_t).trim()}}catch(Zt){It(lt,lt.return,Zt)}}}else if(a.tag===6){if(c===null){lt=a;try{lt.stateNode.nodeValue=b?"":lt.memoizedProps}catch(Zt){It(lt,lt.return,Zt)}}}else if(a.tag===18){if(c===null){lt=a;try{var Ct=lt.stateNode;b?Mv(Ct,!0):Mv(lt.stateNode,!1)}catch(Zt){It(lt,lt.return,Zt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===e)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break t;for(;a.sibling===null;){if(a.return===null||a.return===e)break t;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=e.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Ys(e,c))));break;case 19:Xn(a,e),li(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ys(e,h)));break;case 30:break;case 21:break;default:Xn(a,e),li(e)}}function li(e){var a=e.flags;if(a&2){try{for(var c,h=e.return;h!==null;){if(b0(h)){c=h;break}h=h.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var b=c.stateNode,T=Ps(e);Is(e,T,b);break;case 5:var k=c.stateNode;c.flags&32&&(Br(k,""),c.flags&=-33);var W=Ps(e);Is(e,W,k);break;case 3:case 4:var lt=c.stateNode.containerInfo,yt=Ps(e);Wo(e,yt,lt);break;default:throw Error(i(161))}}catch(At){It(e,e.return,At)}e.flags&=-3}a&4096&&(e.flags&=-4097)}function xh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var a=e;xh(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),e=e.sibling}}function Ka(e,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)ks(e,a.alternate,a),a=a.sibling}function Ks(e){for(e=e.child;e!==null;){var a=e;switch(a.tag){case 0:case 11:case 14:case 15:$i(4,a,a.return),Ks(a);break;case 1:Ai(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&xc(a,a.return,c),Ks(a);break;case 27:Uh(a.stateNode);case 26:case 5:Ai(a,a.return),Ks(a);break;case 22:a.memoizedState===null&&Ks(a);break;case 30:Ks(a);break;default:Ks(a)}e=e.sibling}}function Gi(e,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,b=e,T=a,k=T.flags;switch(T.tag){case 0:case 11:case 15:Gi(b,T,c),Hs(4,T);break;case 1:if(Gi(b,T,c),h=T,b=h.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(yt){It(h,h.return,yt)}if(h=T,b=h.updateQueue,b!==null){var W=h.stateNode;try{var lt=b.shared.hiddenCallbacks;if(lt!==null)for(b.shared.hiddenCallbacks=null,b=0;b<lt.length;b++)eh(lt[b],W)}catch(yt){It(h,h.return,yt)}}c&&k&64&&Gl(T),Ya(T,T.return);break;case 27:$o(T);case 26:case 5:Gi(b,T,c),c&&h===null&&k&4&&Rh(T),Ya(T,T.return);break;case 12:Gi(b,T,c);break;case 31:Gi(b,T,c),c&&k&4&&eu(b,T);break;case 13:Gi(b,T,c),c&&k&4&&qs(b,T);break;case 22:T.memoizedState===null&&Gi(b,T,c),Ya(T,T.return);break;case 30:break;default:Gi(b,T,c)}a=a.sibling}}function Qs(e,a){var c=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),e=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(e=a.memoizedState.cachePool.pool),e!==c&&(e!=null&&e.refCount++,c!=null&&wl(c))}function is(e,a){e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&wl(e))}function ua(e,a,c,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ta(e,a,c,h),a=a.sibling}function ta(e,a,c,h){var b=a.flags;switch(a.tag){case 0:case 11:case 15:ua(e,a,c,h),b&2048&&Hs(9,a);break;case 1:ua(e,a,c,h);break;case 3:ua(e,a,c,h),b&2048&&(e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&wl(e)));break;case 12:if(b&2048){ua(e,a,c,h),e=a.stateNode;try{var T=a.memoizedProps,k=T.id,W=T.onPostCommit;typeof W=="function"&&W(k,a.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(lt){It(a,a.return,lt)}}else ua(e,a,c,h);break;case 31:ua(e,a,c,h);break;case 13:ua(e,a,c,h);break;case 23:break;case 22:T=a.stateNode,k=a.alternate,a.memoizedState!==null?T._visibility&2?ua(e,a,c,h):En(e,a):T._visibility&2?ua(e,a,c,h):(T._visibility|=2,Oi(e,a,c,h,(a.subtreeFlags&10256)!==0||!1)),b&2048&&Qs(k,a);break;case 24:ua(e,a,c,h),b&2048&&is(a.alternate,a);break;default:ua(e,a,c,h)}}function Oi(e,a,c,h,b){for(b=b&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var T=e,k=a,W=c,lt=h,yt=k.flags;switch(k.tag){case 0:case 11:case 15:Oi(T,k,W,lt,b),Hs(8,k);break;case 23:break;case 22:var At=k.stateNode;k.memoizedState!==null?At._visibility&2?Oi(T,k,W,lt,b):En(T,k):(At._visibility|=2,Oi(T,k,W,lt,b)),b&&yt&2048&&Qs(k.alternate,k);break;case 24:Oi(T,k,W,lt,b),b&&yt&2048&&is(k.alternate,k);break;default:Oi(T,k,W,lt,b)}a=a.sibling}}function En(e,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=e,h=a,b=h.flags;switch(h.tag){case 22:En(c,h),b&2048&&Qs(h.alternate,h);break;case 24:En(c,h),b&2048&&is(h.alternate,h);break;default:En(c,h)}a=a.sibling}}var Xs=8192;function Fs(e,a,c){if(e.subtreeFlags&Xs)for(e=e.child;e!==null;)Mh(e,a,c),e=e.sibling}function Mh(e,a,c){switch(e.tag){case 26:Fs(e,a,c),e.flags&Xs&&e.memoizedState!==null&&z4(c,gi,e.memoizedState,e.memoizedProps);break;case 5:Fs(e,a,c);break;case 3:case 4:var h=gi;gi=R0(e.stateNode.containerInfo),Fs(e,a,c),gi=h;break;case 22:e.memoizedState===null&&(h=e.alternate,h!==null&&h.memoizedState!==null?(h=Xs,Xs=16777216,Fs(e,a,c),Xs=h):Fs(e,a,c));break;default:Fs(e,a,c)}}function qn(e){var a=e.alternate;if(a!==null&&(e=a.child,e!==null)){a.child=null;do a=e.sibling,e.sibling=null,e=a;while(e!==null)}}function Js(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];un=h,Nc(h,e)}qn(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Qa(e),e=e.sibling}function Qa(e){switch(e.tag){case 0:case 11:case 15:Js(e),e.flags&2048&&$i(9,e,e.return);break;case 3:Js(e);break;case 12:Js(e);break;case 22:var a=e.stateNode;e.memoizedState!==null&&a._visibility&2&&(e.return===null||e.return.tag!==13)?(a._visibility&=-3,pn(e)):Js(e);break;default:Js(e)}}function pn(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];un=h,Nc(h,e)}qn(e)}for(e=e.child;e!==null;){switch(a=e,a.tag){case 0:case 11:case 15:$i(8,a,a.return),pn(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,pn(a));break;default:pn(a)}e=e.sibling}}function Nc(e,a){for(;un!==null;){var c=un;switch(c.tag){case 0:case 11:case 15:$i(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:wl(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,un=h;else t:for(c=e;un!==null;){h=un;var b=h.sibling,T=h.return;if(tu(h),h===c){un=null;break t}if(b!==null){b.return=T,un=b;break t}un=T}}}var E0={getCacheForType:function(e){var a=on(Bn),c=a.data.get(e);return c===void 0&&(c=e(),a.data.set(e,c)),c},cacheSignal:function(){return on(Bn).controller.signal}},Fn=typeof WeakMap=="function"?WeakMap:Map,le=0,Oe=null,de=null,Ce=0,Xe=0,pi=null,Ea=!1,Tr=!1,Hl=!1,ca=0,nn=0,as=0,Te=0,Ze=0,ue=0,Re=0,Le=null,an=null,Xa=!1,Ar=0,Dc=0,fa=1/0,cn=null,Ri=null,fn=0,Fa=null,oi=null,Hi=0,Zs=0,mi=null,jc=null,Ws=0,$s=null;function vi(){return(le&2)!==0&&Ce!==0?Ce&-Ce:j.T!==null?kg():ir()}function Or(){if(ue===0)if((Ce&536870912)===0||Ne){var e=Yt;Yt<<=1,(Yt&3932160)===0&&(Yt=262144),ue=e}else ue=536870912;return e=gn.current,e!==null&&(e.flags|=32),ue}function Ve(e,a,c){(e===Oe&&(Xe===2||Xe===9)||e.cancelPendingCommit!==null)&&(Za(e,0),Ja(e,Ce,ue,!1)),Wn(e,c),((le&2)===0||e!==Oe)&&(e===Oe&&((le&2)===0&&(Te|=c),nn===4&&Ja(e,Ce,ue,!1)),ls(e))}function Rr(e,a,c){if((le&6)!==0)throw Error(i(327));var h=!c&&(a&127)===0&&(a&e.expiredLanes)===0||jn(e,a),b=h?tt(e,a):x(e,a,!0),T=h;do{if(b===0){Tr&&!h&&Ja(e,a,0,!1);break}else{if(c=e.current.alternate,T&&!Pl(c)){b=x(e,a,!1),T=!1;continue}if(b===2){if(T=a,e.errorRecoveryDisabledLanes&T)var k=0;else k=e.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){a=k;t:{var W=e;b=Le;var lt=W.current.memoizedState.isDehydrated;if(lt&&(Za(W,k).flags|=256),k=x(W,k,!1),k!==2){if(Hl&&!lt){W.errorRecoveryDisabledLanes|=T,Te|=T,b=4;break t}T=an,an=b,T!==null&&(an===null?an=T:an.push.apply(an,T))}b=k}if(T=!1,b!==2)continue}}if(b===1){Za(e,0),Ja(e,a,0,!0);break}t:{switch(h=e,T=b,T){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Ja(h,a,ue,!Ea);break t;case 2:an=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(b=Ar+300-ae(),10<b)){if(Ja(h,a,ue,!Ea),qt(h,0,!0)!==0)break t;Hi=a,h.timeoutHandle=Rv(tl.bind(null,h,c,an,cn,Xa,a,ue,Te,Re,Ea,T,"Throttled",-0,0),b);break t}tl(h,c,an,cn,Xa,a,ue,Te,Re,Ea,T,null,-0,0)}}break}while(!0);ls(e)}function tl(e,a,c,h,b,T,k,W,lt,yt,At,wt,_t,Ct){if(e.timeoutHandle=-1,wt=a.subtreeFlags,wt&8192||(wt&16785408)===16785408){wt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mi},Mh(a,T,wt);var Zt=(T&62914560)===T?Ar-ae():(T&4194048)===T?Dc-ae():0;if(Zt=L4(wt,Zt),Zt!==null){Hi=T,e.cancelPendingCommit=Zt(Se.bind(null,e,a,T,c,h,b,k,W,lt,At,wt,null,_t,Ct)),Ja(e,T,k,!yt);return}}Se(e,a,T,c,h,b,k,W,lt)}function Pl(e){for(var a=e;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var b=c[h],T=b.getSnapshot;b=b.value;try{if(!ti(T(),b))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ja(e,a,c,h){a&=~Ze,a&=~Te,e.suspendedLanes|=a,e.pingedLanes&=~a,h&&(e.warmLanes|=a),h=e.expirationTimes;for(var b=a;0<b;){var T=31-hi(b),k=1<<T;h[T]=-1,b&=~k}c!==0&&cs(e,c,a)}function Il(){return(le&6)===0?(Nh(0),!1):!0}function Uc(){if(de!==null){if(Xe===0)var e=de.return;else e=de,ya=je=null,rh(e),Qr=null,Ho=0,e=de;for(;e!==null;)Zo(e.alternate,e),e=e.return;de=null}}function Za(e,a){var c=e.timeoutHandle;c!==-1&&(e.timeoutHandle=-1,S4(c)),c=e.cancelPendingCommit,c!==null&&(e.cancelPendingCommit=null,c()),Hi=0,Uc(),Oe=e,de=c=ga(e.current,null),Ce=a,Xe=0,pi=null,Ea=!1,Tr=jn(e,a),Hl=!1,Re=ue=Ze=Te=as=nn=0,an=Le=null,Xa=!1,(a&8)!==0&&(a|=a&32);var h=e.entangledLanes;if(h!==0)for(e=e.entanglements,h&=a;0<h;){var b=31-hi(h),T=1<<b;a|=e[b],h&=~T}return ca=a,No(),c}function Bc(e,a){ye=null,j.H=Ul,a===Rs||a===sc?(a=oc(),Xe=3):a===Lo?(a=oc(),Xe=4):Xe=a===Eh?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,pi=a,de===null&&(nn=1,Tc(e,Ki(a,e.current)))}function s(){var e=gn.current;return e===null?!0:(Ce&4194048)===Ce?la===null:(Ce&62914560)===Ce||(Ce&536870912)!==0?e===la:!1}function u(){var e=j.H;return j.H=Ul,e===null?Ul:e}function p(){var e=j.A;return j.A=E0,e}function S(){nn=4,Ea||(Ce&4194048)!==Ce&&gn.current!==null||(Tr=!0),(as&134217727)===0&&(Te&134217727)===0||Oe===null||Ja(Oe,Ce,ue,!1)}function x(e,a,c){var h=le;le|=2;var b=u(),T=p();(Oe!==e||Ce!==a)&&(cn=null,Za(e,a)),a=!1;var k=nn;t:do try{if(Xe!==0&&de!==null){var W=de,lt=pi;switch(Xe){case 8:Uc(),k=6;break t;case 3:case 2:case 9:case 6:gn.current===null&&(a=!0);var yt=Xe;if(Xe=0,pi=null,Ut(e,W,lt,yt),c&&Tr){k=0;break t}break;default:yt=Xe,Xe=0,pi=null,Ut(e,W,lt,yt)}}H(),k=nn;break}catch(At){Bc(e,At)}while(!0);return a&&e.shellSuspendCounter++,ya=je=null,le=h,j.H=b,j.A=T,de===null&&(Oe=null,Ce=0,No()),k}function H(){for(;de!==null;)bt(de)}function tt(e,a){var c=le;le|=2;var h=u(),b=p();Oe!==e||Ce!==a?(cn=null,fa=ae()+500,Za(e,a)):Tr=jn(e,a);t:do try{if(Xe!==0&&de!==null){a=de;var T=pi;e:switch(Xe){case 1:Xe=0,pi=null,Ut(e,a,T,1);break;case 2:case 9:if(gr(T)){Xe=0,pi=null,Nt(a);break}a=function(){Xe!==2&&Xe!==9||Oe!==e||(Xe=7),ls(e)},T.then(a,a);break t;case 3:Xe=7;break t;case 4:Xe=5;break t;case 7:gr(T)?(Xe=0,pi=null,Nt(a)):(Xe=0,pi=null,Ut(e,a,T,7));break;case 5:var k=null;switch(de.tag){case 26:k=de.memoizedState;case 5:case 27:var W=de;if(k?kv(k):W.stateNode.complete){Xe=0,pi=null;var lt=W.sibling;if(lt!==null)de=lt;else{var yt=W.return;yt!==null?(de=yt,Vt(yt)):de=null}break e}}Xe=0,pi=null,Ut(e,a,T,5);break;case 6:Xe=0,pi=null,Ut(e,a,T,6);break;case 8:Uc(),nn=6;break t;default:throw Error(i(462))}}ot();break}catch(At){Bc(e,At)}while(!0);return ya=je=null,j.H=h,j.A=b,le=c,de!==null?0:(Oe=null,Ce=0,No(),nn)}function ot(){for(;de!==null&&!$t();)bt(de)}function bt(e){var a=es(e.alternate,e,ca);e.memoizedProps=e.pendingProps,a===null?Vt(e):de=a}function Nt(e){var a=e,c=a.alternate;switch(a.tag){case 15:case 0:a=Wi(c,a,a.pendingProps,a.type,void 0,Ce);break;case 11:a=Wi(c,a,a.pendingProps,a.type.render,a.ref,Ce);break;case 5:rh(a);default:Zo(c,a),a=de=Zu(a,ca),a=es(c,a,ca)}e.memoizedProps=e.pendingProps,a===null?Vt(e):de=a}function Ut(e,a,c,h){ya=je=null,rh(a),Qr=null,Ho=0;var b=a.return;try{if(_h(e,b,a,c,Ce)){nn=1,Tc(e,Ki(c,e.current)),de=null;return}}catch(T){if(b!==null)throw de=b,T;nn=1,Tc(e,Ki(c,e.current)),de=null;return}a.flags&32768?(Ne||h===1?e=!0:Tr||(Ce&536870912)!==0?e=!1:(Ea=e=!0,(h===2||h===9||h===3||h===6)&&(h=gn.current,h!==null&&h.tag===13&&(h.flags|=16384))),Xt(a,e)):Vt(a)}function Vt(e){var a=e;do{if((a.flags&32768)!==0){Xt(a,Ea);return}e=a.return;var c=Ll(a.alternate,a,ca);if(c!==null){de=c;return}if(a=a.sibling,a!==null){de=a;return}de=a=e}while(a!==null);nn===0&&(nn=5)}function Xt(e,a){do{var c=Oh(e.alternate,e);if(c!==null){c.flags&=32767,de=c;return}if(c=e.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(e=e.sibling,e!==null)){de=e;return}de=e=c}while(e!==null);nn=6,de=null}function Se(e,a,c,h,b,T,k,W,lt){e.cancelPendingCommit=null;do dt();while(fn!==0);if((le&6)!==0)throw Error(i(327));if(a!==null){if(a===e.current)throw Error(i(177));if(T=a.lanes|a.childLanes,T|=sa,nr(e,c,T,k,W,lt),e===Oe&&(de=Oe=null,Ce=0),oi=a,Fa=e,Hi=c,Zs=T,mi=b,jc=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,ss(ut,function(){return Et(),null})):(e.callbackNode=null,e.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=j.T,j.T=null,b=I.p,I.p=2,k=le,le|=4;try{wh(e,a,c)}finally{le=k,I.p=b,j.T=h}}fn=1,ea(),kl(),rs()}}function ea(){if(fn===1){fn=0;var e=Fa,a=oi,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=j.T,j.T=null;var h=I.p;I.p=2;var b=le;le|=4;try{_0(a,e);var T=Jg,k=ha(e.containerInfo),W=T.focusedElem,lt=T.selectionRange;if(k!==W&&W&&W.ownerDocument&&bl(W.ownerDocument.documentElement,W)){if(lt!==null&&Qu(W)){var yt=lt.start,At=lt.end;if(At===void 0&&(At=yt),"selectionStart"in W)W.selectionStart=yt,W.selectionEnd=Math.min(At,W.value.length);else{var wt=W.ownerDocument||document,_t=wt&&wt.defaultView||window;if(_t.getSelection){var Ct=_t.getSelection(),Zt=W.textContent.length,ce=Math.min(lt.start,Zt),sn=lt.end===void 0?ce:Math.min(lt.end,Zt);!Ct.extend&&ce>sn&&(k=sn,sn=ce,ce=k);var gt=Gf(W,ce),ct=Gf(W,sn);if(gt&&ct&&(Ct.rangeCount!==1||Ct.anchorNode!==gt.node||Ct.anchorOffset!==gt.offset||Ct.focusNode!==ct.node||Ct.focusOffset!==ct.offset)){var vt=wt.createRange();vt.setStart(gt.node,gt.offset),Ct.removeAllRanges(),ce>sn?(Ct.addRange(vt),Ct.extend(ct.node,ct.offset)):(vt.setEnd(ct.node,ct.offset),Ct.addRange(vt))}}}}for(wt=[],Ct=W;Ct=Ct.parentNode;)Ct.nodeType===1&&wt.push({element:Ct,left:Ct.scrollLeft,top:Ct.scrollTop});for(typeof W.focus=="function"&&W.focus(),W=0;W<wt.length;W++){var Rt=wt[W];Rt.element.scrollLeft=Rt.left,Rt.element.scrollTop=Rt.top}}j0=!!Fg,Jg=Fg=null}finally{le=b,I.p=h,j.T=c}}e.current=a,fn=2}}function kl(){if(fn===2){fn=0;var e=Fa,a=oi,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=j.T,j.T=null;var h=I.p;I.p=2;var b=le;le|=4;try{ks(e,a.alternate,a)}finally{le=b,I.p=h,j.T=c}}fn=3}}function rs(){if(fn===4||fn===3){fn=0,ve();var e=Fa,a=oi,c=Hi,h=jc;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?fn=5:(fn=0,oi=Fa=null,St(e,e.pendingLanes));var b=e.pendingLanes;if(b===0&&(Ri=null),ho(c),a=a.stateNode,An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(dn,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=j.T,b=I.p,I.p=2,j.T=null;try{for(var T=e.onRecoverableError,k=0;k<h.length;k++){var W=h[k];T(W.value,{componentStack:W.stack})}}finally{j.T=a,I.p=b}}(Hi&3)!==0&&dt(),ls(e),b=e.pendingLanes,(c&261930)!==0&&(b&42)!==0?e===$s?Ws++:(Ws=0,$s=e):Ws=0,Nh(0)}}function St(e,a){(e.pooledCacheLanes&=a)===0&&(a=e.pooledCache,a!=null&&(e.pooledCache=null,wl(a)))}function dt(){return ea(),kl(),rs(),Et()}function Et(){if(fn!==5)return!1;var e=Fa,a=Zs;Zs=0;var c=ho(Hi),h=j.T,b=I.p;try{I.p=32>c?32:c,j.T=null,c=mi,mi=null;var T=Fa,k=Hi;if(fn=0,oi=Fa=null,Hi=0,(le&6)!==0)throw Error(i(331));var W=le;if(le|=4,Qa(T.current),ta(T,T.current,k,c),le=W,Nh(0,!1),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(dn,T)}catch{}return!0}finally{I.p=b,j.T=h,St(e,a)}}function Bt(e,a,c){a=Ki(c,a),a=Zi(e.stateNode,a,2),e=Fr(e,a,2),e!==null&&(Wn(e,2),ls(e))}function It(e,a,c){if(e.tag===3)Bt(e,e,c);else for(;a!==null;){if(a.tag===3){Bt(a,e,c);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ri===null||!Ri.has(h))){e=Ki(c,e),c=bh(2),h=Fr(a,c,2),h!==null&&(y0(c,h,a,e),Wn(h,2),ls(h));break}}a=a.return}}function $e(e,a,c){var h=e.pingCache;if(h===null){h=e.pingCache=new Fn;var b=new Set;h.set(a,b)}else b=h.get(a),b===void 0&&(b=new Set,h.set(a,b));b.has(c)||(Hl=!0,b.add(c),e=fe.bind(null,e,a,c),a.then(e,e))}function fe(e,a,c){var h=e.pingCache;h!==null&&h.delete(a),e.pingedLanes|=e.suspendedLanes&c,e.warmLanes&=~c,Oe===e&&(Ce&c)===c&&(nn===4||nn===3&&(Ce&62914560)===Ce&&300>ae()-Ar?(le&2)===0&&Za(e,0):Ze|=c,Re===Ce&&(Re=0)),ls(e)}function Ge(e,a){a===0&&(a=ze()),e=Yi(e,a),e!==null&&(Wn(e,a),ls(e))}function Jn(e){var a=e.memoizedState,c=0;a!==null&&(c=a.retryLane),Ge(e,c)}function Ie(e,a){var c=0;switch(e.tag){case 31:case 13:var h=e.stateNode,b=e.memoizedState;b!==null&&(c=b.retryLane);break;case 19:h=e.stateNode;break;case 22:h=e.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(a),Ge(e,c)}function ss(e,a){return Qt(e,a)}var zc=null,Lc=null,Pg=!1,C0=!1,Ig=!1,ql=0;function ls(e){e!==Lc&&e.next===null&&(Lc===null?zc=Lc=e:Lc=Lc.next=e),C0=!0,Pg||(Pg=!0,o4())}function Nh(e,a){if(!Ig&&C0){Ig=!0;do for(var c=!1,h=zc;h!==null;){if(e!==0){var b=h.pendingLanes;if(b===0)var T=0;else{var k=h.suspendedLanes,W=h.pingedLanes;T=(1<<31-hi(42|e)+1)-1,T&=b&~(k&~W),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(c=!0,mv(h,T))}else T=Ce,T=qt(h,h===Oe?T:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(T&3)===0||jn(h,T)||(c=!0,mv(h,T));h=h.next}while(c);Ig=!1}}function l4(){dv()}function dv(){C0=Pg=!1;var e=0;ql!==0&&y4()&&(e=ql);for(var a=ae(),c=null,h=zc;h!==null;){var b=h.next,T=gv(h,a);T===0?(h.next=null,c===null?zc=b:c.next=b,b===null&&(Lc=c)):(c=h,(e!==0||(T&3)!==0)&&(C0=!0)),h=b}fn!==0&&fn!==5||Nh(e),ql!==0&&(ql=0)}function gv(e,a){for(var c=e.suspendedLanes,h=e.pingedLanes,b=e.expirationTimes,T=e.pendingLanes&-62914561;0<T;){var k=31-hi(T),W=1<<k,lt=b[k];lt===-1?((W&c)===0||(W&h)!==0)&&(b[k]=he(W,a)):lt<=a&&(e.expiredLanes|=W),T&=~W}if(a=Oe,c=Ce,c=qt(e,e===a?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h=e.callbackNode,c===0||e===a&&(Xe===2||Xe===9)||e.cancelPendingCommit!==null)return h!==null&&h!==null&&Jt(h),e.callbackNode=null,e.callbackPriority=0;if((c&3)===0||jn(e,c)){if(a=c&-c,a===e.callbackPriority)return a;switch(h!==null&&Jt(h),ho(c)){case 2:case 8:c=We;break;case 32:c=ut;break;case 268435456:c=Mt;break;default:c=ut}return h=pv.bind(null,e),c=Qt(c,h),e.callbackPriority=a,e.callbackNode=c,a}return h!==null&&h!==null&&Jt(h),e.callbackPriority=2,e.callbackNode=null,2}function pv(e,a){if(fn!==0&&fn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var c=e.callbackNode;if(dt()&&e.callbackNode!==c)return null;var h=Ce;return h=qt(e,e===Oe?h:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h===0?null:(Rr(e,h,a),gv(e,ae()),e.callbackNode!=null&&e.callbackNode===c?pv.bind(null,e):null)}function mv(e,a){if(dt())return null;Rr(e,a,!0)}function o4(){b4(function(){(le&6)!==0?Qt(Sn,l4):dv()})}function kg(){if(ql===0){var e=Ts;e===0&&(e=Gt,Gt<<=1,(Gt&261888)===0&&(Gt=256)),ql=e}return ql}function vv(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:mo(""+e)}function yv(e,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,e.id&&c.setAttribute("form",e.id),a.parentNode.insertBefore(c,a),e=new FormData(e),c.parentNode.removeChild(c),e}function u4(e,a,c,h,b){if(a==="submit"&&c&&c.stateNode===b){var T=vv((b[Vn]||null).action),k=h.submitter;k&&(a=(a=k[Vn]||null)?vv(a.formAction):k.getAttribute("formAction"),a!==null&&(T=a,k=null));var W=new Uu("action","action",null,h,b);e.push({event:W,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(ql!==0){var lt=k?yv(b,k):new FormData(b);_c(c,{pending:!0,data:lt,method:b.method,action:T},null,lt)}}else typeof T=="function"&&(W.preventDefault(),lt=k?yv(b,k):new FormData(b),_c(c,{pending:!0,data:lt,method:b.method,action:T},T,lt))},currentTarget:b}]})}}for(var qg=0;qg<Da.length;qg++){var Vg=Da[qg],c4=Vg.toLowerCase(),f4=Vg[0].toUpperCase()+Vg.slice(1);ni(c4,"on"+f4)}ni(Fu,"onAnimationEnd"),ni(kf,"onAnimationIteration"),ni(zd,"onAnimationStart"),ni("dblclick","onDoubleClick"),ni("focusin","onFocus"),ni("focusout","onBlur"),ni(qf,"onTransitionRun"),ni(Si,"onTransitionStart"),ni(Ld,"onTransitionCancel"),ni(bi,"onTransitionEnd"),In("onMouseEnter",["mouseout","mouseover"]),In("onMouseLeave",["mouseout","mouseover"]),In("onPointerEnter",["pointerout","pointerover"]),In("onPointerLeave",["pointerout","pointerover"]),rr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rr("onBeforeInput",["compositionend","keypress","textInput","paste"]),rr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),h4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Dh));function Sv(e,a){a=(a&4)!==0;for(var c=0;c<e.length;c++){var h=e[c],b=h.event;h=h.listeners;t:{var T=void 0;if(a)for(var k=h.length-1;0<=k;k--){var W=h[k],lt=W.instance,yt=W.currentTarget;if(W=W.listener,lt!==T&&b.isPropagationStopped())break t;T=W,b.currentTarget=yt;try{T(b)}catch(At){da(At)}b.currentTarget=null,T=lt}else for(k=0;k<h.length;k++){if(W=h[k],lt=W.instance,yt=W.currentTarget,W=W.listener,lt!==T&&b.isPropagationStopped())break t;T=W,b.currentTarget=yt;try{T(b)}catch(At){da(At)}b.currentTarget=null,T=lt}}}}function Ue(e,a){var c=a[bu];c===void 0&&(c=a[bu]=new Set);var h=e+"__bubble";c.has(h)||(bv(a,e,2,!1),c.add(h))}function Yg(e,a,c){var h=0;a&&(h|=4),bv(c,e,h,a)}var T0="_reactListening"+Math.random().toString(36).slice(2);function Kg(e){if(!e[T0]){e[T0]=!0,Eu.forEach(function(c){c!=="selectionchange"&&(h4.has(c)||Yg(c,!1,e),Yg(c,!0,e))});var a=e.nodeType===9?e:e.ownerDocument;a===null||a[T0]||(a[T0]=!0,Yg("selectionchange",!1,a))}}function bv(e,a,c,h){switch(Fv(a)){case 2:var b=P4;break;case 8:b=I4;break;default:b=lp}c=b.bind(null,a,c,e),b=void 0,!Nu||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(b=!0),h?b!==void 0?e.addEventListener(a,c,{capture:!0,passive:b}):e.addEventListener(a,c,!0):b!==void 0?e.addEventListener(a,c,{passive:b}):e.addEventListener(a,c,!1)}function Qg(e,a,c,h,b){var T=h;if((a&1)===0&&(a&2)===0&&h!==null)t:for(;;){if(h===null)return;var k=h.tag;if(k===3||k===4){var W=h.stateNode.containerInfo;if(W===b)break;if(k===4)for(k=h.return;k!==null;){var lt=k.tag;if((lt===3||lt===4)&&k.stateNode.containerInfo===b)return;k=k.return}for(;W!==null;){if(k=jr(W),k===null)return;if(lt=k.tag,lt===5||lt===6||lt===26||lt===27){h=T=k;continue t}W=W.parentNode}}h=h.return}Of(function(){var yt=T,At=xu(c),wt=[];t:{var _t=Vf.get(e);if(_t!==void 0){var Ct=Uu,Zt=e;switch(e){case"keypress":if(vo(c)===0)break t;case"keydown":case"keyup":Ct=Mf;break;case"focusin":Zt="focus",Ct=Lu;break;case"focusout":Zt="blur",Ct=Lu;break;case"beforeblur":case"afterblur":Ct=Lu;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ct=wf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ct=Eo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ct=$n;break;case Fu:case kf:case zd:Ct=Gr;break;case bi:Ct=wd;break;case"scroll":case"scrollend":Ct=bd;break;case"wheel":Ct=Md;break;case"copy":case"cut":case"paste":Ct=Hr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ct=Nf;break;case"toggle":case"beforetoggle":Ct=Gu}var ce=(a&4)!==0,sn=!ce&&(e==="scroll"||e==="scrollend"),gt=ce?_t!==null?_t+"Capture":null:_t;ce=[];for(var ct=yt,vt;ct!==null;){var Rt=ct;if(vt=Rt.stateNode,Rt=Rt.tag,Rt!==5&&Rt!==26&&Rt!==27||vt===null||gt===null||(Rt=pl(ct,gt),Rt!=null&&ce.push(jh(ct,Rt,vt))),sn)break;ct=ct.return}0<ce.length&&(_t=new Ct(_t,Zt,null,c,At),wt.push({event:_t,listeners:ce}))}}if((a&7)===0){t:{if(_t=e==="mouseover"||e==="pointerover",Ct=e==="mouseout"||e==="pointerout",_t&&c!==gl&&(Zt=c.relatedTarget||c.fromElement)&&(jr(Zt)||Zt[wa]))break t;if((Ct||_t)&&(_t=At.window===At?At:(_t=At.ownerDocument)?_t.defaultView||_t.parentWindow:window,Ct?(Zt=c.relatedTarget||c.toElement,Ct=yt,Zt=Zt?jr(Zt):null,Zt!==null&&(sn=l(Zt),ce=Zt.tag,Zt!==sn||ce!==5&&ce!==27&&ce!==6)&&(Zt=null)):(Ct=null,Zt=yt),Ct!==Zt)){if(ce=wf,Rt="onMouseLeave",gt="onMouseEnter",ct="mouse",(e==="pointerout"||e==="pointerover")&&(ce=Nf,Rt="onPointerLeave",gt="onPointerEnter",ct="pointer"),sn=Ct==null?_t:fl(Ct),vt=Zt==null?_t:fl(Zt),_t=new ce(Rt,ct+"leave",Ct,c,At),_t.target=sn,_t.relatedTarget=vt,Rt=null,jr(At)===yt&&(ce=new ce(gt,ct+"enter",Zt,c,At),ce.target=vt,ce.relatedTarget=sn,Rt=ce),sn=Rt,Ct&&Zt)e:{for(ce=d4,gt=Ct,ct=Zt,vt=0,Rt=gt;Rt;Rt=ce(Rt))vt++;Rt=0;for(var ie=ct;ie;ie=ce(ie))Rt++;for(;0<vt-Rt;)gt=ce(gt),vt--;for(;0<Rt-vt;)ct=ce(ct),Rt--;for(;vt--;){if(gt===ct||ct!==null&&gt===ct.alternate){ce=gt;break e}gt=ce(gt),ct=ce(ct)}ce=null}else ce=null;Ct!==null&&_v(wt,_t,Ct,ce,!1),Zt!==null&&sn!==null&&_v(wt,sn,Zt,ce,!0)}}t:{if(_t=yt?fl(yt):window,Ct=_t.nodeName&&_t.nodeName.toLowerCase(),Ct==="select"||Ct==="input"&&_t.type==="file")var Ye=Vu;else if(Na(_t))if(Bf)Ye=jg;else{Ye=_n;var te=xo}else Ct=_t.nodeName,!Ct||Ct.toLowerCase()!=="input"||_t.type!=="checkbox"&&_t.type!=="radio"?yt&&wu(yt.elementType)&&(Ye=Vu):Ye=Dg;if(Ye&&(Ye=Ye(e,yt))){qu(wt,Ye,c,At);break t}te&&te(e,_t,yt),e==="focusout"&&yt&&_t.type==="number"&&yt.memoizedProps.value!=null&&bf(_t,"number",_t.value)}switch(te=yt?fl(yt):window,e){case"focusin":(Na(te)||te.contentEditable==="true")&&(vs=te,Mo=yt,ys=null);break;case"focusout":ys=Mo=vs=null;break;case"mousedown":_l=!0;break;case"contextmenu":case"mouseup":case"dragend":_l=!1,Pf(wt,c,At);break;case"selectionchange":if(Hf)break;case"keydown":case"keyup":Pf(wt,c,At)}var we;if(Hu)t:{switch(e){case"compositionstart":var Be="onCompositionStart";break t;case"compositionend":Be="onCompositionEnd";break t;case"compositionupdate":Be="onCompositionUpdate";break t}Be=void 0}else Pr?ku(e,c)&&(Be="onCompositionEnd"):e==="keydown"&&c.keyCode===229&&(Be="onCompositionStart");Be&&(Pu&&c.locale!=="ko"&&(Pr||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&Pr&&(we=Rf()):(lr=At,Du="value"in lr?lr.value:lr.textContent,Pr=!0)),te=A0(yt,Be),0<te.length&&(Be=new Co(Be,e,null,c,At),wt.push({event:Be,listeners:te}),we?Be.data=we:(we=To(c),we!==null&&(Be.data=we)))),(we=Dd?jd(e,c):Uf(e,c))&&(Be=A0(yt,"onBeforeInput"),0<Be.length&&(te=new Co("onBeforeInput","beforeinput",null,c,At),wt.push({event:te,listeners:Be}),te.data=we)),u4(wt,e,yt,c,At)}Sv(wt,a)})}function jh(e,a,c){return{instance:e,listener:a,currentTarget:c}}function A0(e,a){for(var c=a+"Capture",h=[];e!==null;){var b=e,T=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||T===null||(b=pl(e,c),b!=null&&h.unshift(jh(e,b,T)),b=pl(e,a),b!=null&&h.push(jh(e,b,T))),e.tag===3)return h;e=e.return}return[]}function d4(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function _v(e,a,c,h,b){for(var T=a._reactName,k=[];c!==null&&c!==h;){var W=c,lt=W.alternate,yt=W.stateNode;if(W=W.tag,lt!==null&&lt===h)break;W!==5&&W!==26&&W!==27||yt===null||(lt=yt,b?(yt=pl(c,T),yt!=null&&k.unshift(jh(c,yt,lt))):b||(yt=pl(c,T),yt!=null&&k.push(jh(c,yt,lt)))),c=c.return}k.length!==0&&e.push({event:a,listeners:k})}var g4=/\r\n?/g,p4=/\u0000|\uFFFD/g;function Ev(e){return(typeof e=="string"?e:""+e).replace(g4,`
`).replace(p4,"")}function Cv(e,a){return a=Ev(a),Ev(e)===a}function rn(e,a,c,h,b,T){switch(c){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||Br(e,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&Br(e,""+h);break;case"className":ia(e,"class",h);break;case"tabIndex":ia(e,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ia(e,c,h);break;case"style":Tf(e,h,T);break;case"data":if(a!=="object"){ia(e,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||c!=="href")){e.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(c);break}h=mo(""+h),e.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){e.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(c==="formAction"?(a!=="input"&&rn(e,a,"name",b.name,b,null),rn(e,a,"formEncType",b.formEncType,b,null),rn(e,a,"formMethod",b.formMethod,b,null),rn(e,a,"formTarget",b.formTarget,b,null)):(rn(e,a,"encType",b.encType,b,null),rn(e,a,"method",b.method,b,null),rn(e,a,"target",b.target,b,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(c);break}h=mo(""+h),e.setAttribute(c,h);break;case"onClick":h!=null&&(e.onclick=Mi);break;case"onScroll":h!=null&&Ue("scroll",e);break;case"onScrollEnd":h!=null&&Ue("scrollend",e);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(b.children!=null)throw Error(i(60));e.innerHTML=c}}break;case"multiple":e.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":e.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){e.removeAttribute("xlink:href");break}c=mo(""+h),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,""+h):e.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,""):e.removeAttribute(c);break;case"capture":case"download":h===!0?e.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,h):e.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?e.setAttribute(c,h):e.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?e.removeAttribute(c):e.setAttribute(c,h);break;case"popover":Ue("beforetoggle",e),Ue("toggle",e),dl(e,"popover",h);break;case"xlinkActuate":aa(e,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":aa(e,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":aa(e,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":aa(e,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":aa(e,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":aa(e,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":aa(e,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":aa(e,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":aa(e,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":dl(e,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Sd.get(c)||c,dl(e,c,h))}}function Xg(e,a,c,h,b,T){switch(c){case"style":Tf(e,h,T);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(b.children!=null)throw Error(i(60));e.innerHTML=c}}break;case"children":typeof h=="string"?Br(e,h):(typeof h=="number"||typeof h=="bigint")&&Br(e,""+h);break;case"onScroll":h!=null&&Ue("scroll",e);break;case"onScrollEnd":h!=null&&Ue("scrollend",e);break;case"onClick":h!=null&&(e.onclick=Mi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Cu.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(b=c.endsWith("Capture"),a=c.slice(2,b?c.length-7:void 0),T=e[Vn]||null,T=T!=null?T[c]:null,typeof T=="function"&&e.removeEventListener(a,T,b),typeof h=="function")){typeof T!="function"&&T!==null&&(c in e?e[c]=null:e.hasAttribute(c)&&e.removeAttribute(c)),e.addEventListener(a,h,b);break t}c in e?e[c]=h:h===!0?e.setAttribute(c,""):dl(e,c,h)}}}function wi(e,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ue("error",e),Ue("load",e);var h=!1,b=!1,T;for(T in c)if(c.hasOwnProperty(T)){var k=c[T];if(k!=null)switch(T){case"src":h=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:rn(e,a,T,k,c,null)}}b&&rn(e,a,"srcSet",c.srcSet,c,null),h&&rn(e,a,"src",c.src,c,null);return;case"input":Ue("invalid",e);var W=T=k=b=null,lt=null,yt=null;for(h in c)if(c.hasOwnProperty(h)){var At=c[h];if(At!=null)switch(h){case"name":b=At;break;case"type":k=At;break;case"checked":lt=At;break;case"defaultChecked":yt=At;break;case"value":T=At;break;case"defaultValue":W=At;break;case"children":case"dangerouslySetInnerHTML":if(At!=null)throw Error(i(137,a));break;default:rn(e,a,h,At,c,null)}}Sf(e,T,W,lt,yt,k,b,!1);return;case"select":Ue("invalid",e),h=k=T=null;for(b in c)if(c.hasOwnProperty(b)&&(W=c[b],W!=null))switch(b){case"value":T=W;break;case"defaultValue":k=W;break;case"multiple":h=W;default:rn(e,a,b,W,c,null)}a=T,c=k,e.multiple=!!h,a!=null?ds(e,!!h,a,!1):c!=null&&ds(e,!!h,c,!0);return;case"textarea":Ue("invalid",e),T=b=h=null;for(k in c)if(c.hasOwnProperty(k)&&(W=c[k],W!=null))switch(k){case"value":h=W;break;case"defaultValue":b=W;break;case"children":T=W;break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(91));break;default:rn(e,a,k,W,c,null)}Ef(e,h,b,T);return;case"option":for(lt in c)if(c.hasOwnProperty(lt)&&(h=c[lt],h!=null))switch(lt){case"selected":e.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:rn(e,a,lt,h,c,null)}return;case"dialog":Ue("beforetoggle",e),Ue("toggle",e),Ue("cancel",e),Ue("close",e);break;case"iframe":case"object":Ue("load",e);break;case"video":case"audio":for(h=0;h<Dh.length;h++)Ue(Dh[h],e);break;case"image":Ue("error",e),Ue("load",e);break;case"details":Ue("toggle",e);break;case"embed":case"source":case"link":Ue("error",e),Ue("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(yt in c)if(c.hasOwnProperty(yt)&&(h=c[yt],h!=null))switch(yt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:rn(e,a,yt,h,c,null)}return;default:if(wu(a)){for(At in c)c.hasOwnProperty(At)&&(h=c[At],h!==void 0&&Xg(e,a,At,h,c,void 0));return}}for(W in c)c.hasOwnProperty(W)&&(h=c[W],h!=null&&rn(e,a,W,h,c,null))}function m4(e,a,c,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,T=null,k=null,W=null,lt=null,yt=null,At=null;for(Ct in c){var wt=c[Ct];if(c.hasOwnProperty(Ct)&&wt!=null)switch(Ct){case"checked":break;case"value":break;case"defaultValue":lt=wt;default:h.hasOwnProperty(Ct)||rn(e,a,Ct,null,h,wt)}}for(var _t in h){var Ct=h[_t];if(wt=c[_t],h.hasOwnProperty(_t)&&(Ct!=null||wt!=null))switch(_t){case"type":T=Ct;break;case"name":b=Ct;break;case"checked":yt=Ct;break;case"defaultChecked":At=Ct;break;case"value":k=Ct;break;case"defaultValue":W=Ct;break;case"children":case"dangerouslySetInnerHTML":if(Ct!=null)throw Error(i(137,a));break;default:Ct!==wt&&rn(e,a,_t,Ct,h,wt)}}po(e,k,W,lt,yt,At,T,b);return;case"select":Ct=k=W=_t=null;for(T in c)if(lt=c[T],c.hasOwnProperty(T)&&lt!=null)switch(T){case"value":break;case"multiple":Ct=lt;default:h.hasOwnProperty(T)||rn(e,a,T,null,h,lt)}for(b in h)if(T=h[b],lt=c[b],h.hasOwnProperty(b)&&(T!=null||lt!=null))switch(b){case"value":_t=T;break;case"defaultValue":W=T;break;case"multiple":k=T;default:T!==lt&&rn(e,a,b,T,h,lt)}a=W,c=k,h=Ct,_t!=null?ds(e,!!c,_t,!1):!!h!=!!c&&(a!=null?ds(e,!!c,a,!0):ds(e,!!c,c?[]:"",!1));return;case"textarea":Ct=_t=null;for(W in c)if(b=c[W],c.hasOwnProperty(W)&&b!=null&&!h.hasOwnProperty(W))switch(W){case"value":break;case"children":break;default:rn(e,a,W,null,h,b)}for(k in h)if(b=h[k],T=c[k],h.hasOwnProperty(k)&&(b!=null||T!=null))switch(k){case"value":_t=b;break;case"defaultValue":Ct=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(i(91));break;default:b!==T&&rn(e,a,k,b,h,T)}_f(e,_t,Ct);return;case"option":for(var Zt in c)if(_t=c[Zt],c.hasOwnProperty(Zt)&&_t!=null&&!h.hasOwnProperty(Zt))switch(Zt){case"selected":e.selected=!1;break;default:rn(e,a,Zt,null,h,_t)}for(lt in h)if(_t=h[lt],Ct=c[lt],h.hasOwnProperty(lt)&&_t!==Ct&&(_t!=null||Ct!=null))switch(lt){case"selected":e.selected=_t&&typeof _t!="function"&&typeof _t!="symbol";break;default:rn(e,a,lt,_t,h,Ct)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ce in c)_t=c[ce],c.hasOwnProperty(ce)&&_t!=null&&!h.hasOwnProperty(ce)&&rn(e,a,ce,null,h,_t);for(yt in h)if(_t=h[yt],Ct=c[yt],h.hasOwnProperty(yt)&&_t!==Ct&&(_t!=null||Ct!=null))switch(yt){case"children":case"dangerouslySetInnerHTML":if(_t!=null)throw Error(i(137,a));break;default:rn(e,a,yt,_t,h,Ct)}return;default:if(wu(a)){for(var sn in c)_t=c[sn],c.hasOwnProperty(sn)&&_t!==void 0&&!h.hasOwnProperty(sn)&&Xg(e,a,sn,void 0,h,_t);for(At in h)_t=h[At],Ct=c[At],!h.hasOwnProperty(At)||_t===Ct||_t===void 0&&Ct===void 0||Xg(e,a,At,_t,h,Ct);return}}for(var gt in c)_t=c[gt],c.hasOwnProperty(gt)&&_t!=null&&!h.hasOwnProperty(gt)&&rn(e,a,gt,null,h,_t);for(wt in h)_t=h[wt],Ct=c[wt],!h.hasOwnProperty(wt)||_t===Ct||_t==null&&Ct==null||rn(e,a,wt,_t,h,Ct)}function Tv(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function v4(){if(typeof performance.getEntriesByType=="function"){for(var e=0,a=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var b=c[h],T=b.transferSize,k=b.initiatorType,W=b.duration;if(T&&W&&Tv(k)){for(k=0,W=b.responseEnd,h+=1;h<c.length;h++){var lt=c[h],yt=lt.startTime;if(yt>W)break;var At=lt.transferSize,wt=lt.initiatorType;At&&Tv(wt)&&(lt=lt.responseEnd,k+=At*(lt<W?1:(W-yt)/(lt-yt)))}if(--h,a+=8*(T+k)/(b.duration/1e3),e++,10<e)break}}if(0<e)return a/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Fg=null,Jg=null;function O0(e){return e.nodeType===9?e:e.ownerDocument}function Av(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ov(e,a){if(e===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&a==="foreignObject"?0:e}function Zg(e,a){return e==="textarea"||e==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Wg=null;function y4(){var e=window.event;return e&&e.type==="popstate"?e===Wg?!1:(Wg=e,!0):(Wg=null,!1)}var Rv=typeof setTimeout=="function"?setTimeout:void 0,S4=typeof clearTimeout=="function"?clearTimeout:void 0,wv=typeof Promise=="function"?Promise:void 0,b4=typeof queueMicrotask=="function"?queueMicrotask:typeof wv<"u"?function(e){return wv.resolve(null).then(e).catch(_4)}:Rv;function _4(e){setTimeout(function(){throw e})}function Vl(e){return e==="head"}function xv(e,a){var c=a,h=0;do{var b=c.nextSibling;if(e.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"||c==="/&"){if(h===0){e.removeChild(b),Ic(a);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")Uh(e.ownerDocument.documentElement);else if(c==="head"){c=e.ownerDocument.head,Uh(c);for(var T=c.firstChild;T;){var k=T.nextSibling,W=T.nodeName;T[fs]||W==="SCRIPT"||W==="STYLE"||W==="LINK"&&T.rel.toLowerCase()==="stylesheet"||c.removeChild(T),T=k}}else c==="body"&&Uh(e.ownerDocument.body);c=b}while(c);Ic(a)}function Mv(e,a){var c=e;e=0;do{var h=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(e===0)break;e--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||e++;c=h}while(c)}function $g(e){var a=e.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":$g(c),bn(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}e.removeChild(c)}}function E4(e,a,c,h){for(;e.nodeType===1;){var b=c;if(e.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(h){if(!e[fs])switch(a){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(T=e.getAttribute("rel"),T==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(T!==b.rel||e.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||e.getAttribute("title")!==(b.title==null?null:b.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(T=e.getAttribute("src"),(T!==(b.src==null?null:b.src)||e.getAttribute("type")!==(b.type==null?null:b.type)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&T&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(a==="input"&&e.type==="hidden"){var T=b.name==null?null:""+b.name;if(b.type==="hidden"&&e.getAttribute("name")===T)return e}else return e;if(e=Wa(e.nextSibling),e===null)break}return null}function C4(e,a,c){if(a==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!c||(e=Wa(e.nextSibling),e===null))return null;return e}function Nv(e,a){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Wa(e.nextSibling),e===null))return null;return e}function tp(e){return e.data==="$?"||e.data==="$~"}function ep(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function T4(e,a){var c=e.ownerDocument;if(e.data==="$~")e._reactRetry=a;else if(e.data!=="$?"||c.readyState!=="loading")a();else{var h=function(){a(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),e._reactRetry=h}}function Wa(e){for(;e!=null;e=e.nextSibling){var a=e.nodeType;if(a===1||a===3)break;if(a===8){if(a=e.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return e}var np=null;function Dv(e){e=e.nextSibling;for(var a=0;e;){if(e.nodeType===8){var c=e.data;if(c==="/$"||c==="/&"){if(a===0)return Wa(e.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}e=e.nextSibling}return null}function jv(e){e=e.previousSibling;for(var a=0;e;){if(e.nodeType===8){var c=e.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return e;a--}else c!=="/$"&&c!=="/&"||a++}e=e.previousSibling}return null}function Uv(e,a,c){switch(a=O0(c),e){case"html":if(e=a.documentElement,!e)throw Error(i(452));return e;case"head":if(e=a.head,!e)throw Error(i(453));return e;case"body":if(e=a.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Uh(e){for(var a=e.attributes;a.length;)e.removeAttributeNode(a[0]);bn(e)}var $a=new Map,Bv=new Set;function R0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var el=I.d;I.d={f:A4,r:O4,D:R4,C:w4,L:x4,m:M4,X:D4,S:N4,M:j4};function A4(){var e=el.f(),a=Il();return e||a}function O4(e){var a=Ur(e);a!==null&&a.tag===5&&a.type==="form"?h0(a):el.r(e)}var Gc=typeof document>"u"?null:document;function zv(e,a,c){var h=Gc;if(h&&typeof a=="string"&&a){var b=qi(a);b='link[rel="'+e+'"][href="'+b+'"]',typeof c=="string"&&(b+='[crossorigin="'+c+'"]'),Bv.has(b)||(Bv.add(b),e={rel:e,crossOrigin:c,href:a},h.querySelector(b)===null&&(a=h.createElement("link"),wi(a,"link",e),Yn(a),h.head.appendChild(a)))}}function R4(e){el.D(e),zv("dns-prefetch",e,null)}function w4(e,a){el.C(e,a),zv("preconnect",e,a)}function x4(e,a,c){el.L(e,a,c);var h=Gc;if(h&&e&&a){var b='link[rel="preload"][as="'+qi(a)+'"]';a==="image"&&c&&c.imageSrcSet?(b+='[imagesrcset="'+qi(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(b+='[imagesizes="'+qi(c.imageSizes)+'"]')):b+='[href="'+qi(e)+'"]';var T=b;switch(a){case"style":T=Hc(e);break;case"script":T=Pc(e)}$a.has(T)||(e=C({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:e,as:a},c),$a.set(T,e),h.querySelector(b)!==null||a==="style"&&h.querySelector(Bh(T))||a==="script"&&h.querySelector(zh(T))||(a=h.createElement("link"),wi(a,"link",e),Yn(a),h.head.appendChild(a)))}}function M4(e,a){el.m(e,a);var c=Gc;if(c&&e){var h=a&&typeof a.as=="string"?a.as:"script",b='link[rel="modulepreload"][as="'+qi(h)+'"][href="'+qi(e)+'"]',T=b;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Pc(e)}if(!$a.has(T)&&(e=C({rel:"modulepreload",href:e},a),$a.set(T,e),c.querySelector(b)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(zh(T)))return}h=c.createElement("link"),wi(h,"link",e),Yn(h),c.head.appendChild(h)}}}function N4(e,a,c){el.S(e,a,c);var h=Gc;if(h&&e){var b=hs(h).hoistableStyles,T=Hc(e);a=a||"default";var k=b.get(T);if(!k){var W={loading:0,preload:null};if(k=h.querySelector(Bh(T)))W.loading=5;else{e=C({rel:"stylesheet",href:e,"data-precedence":a},c),(c=$a.get(T))&&ip(e,c);var lt=k=h.createElement("link");Yn(lt),wi(lt,"link",e),lt._p=new Promise(function(yt,At){lt.onload=yt,lt.onerror=At}),lt.addEventListener("load",function(){W.loading|=1}),lt.addEventListener("error",function(){W.loading|=2}),W.loading|=4,w0(k,a,h)}k={type:"stylesheet",instance:k,count:1,state:W},b.set(T,k)}}}function D4(e,a){el.X(e,a);var c=Gc;if(c&&e){var h=hs(c).hoistableScripts,b=Pc(e),T=h.get(b);T||(T=c.querySelector(zh(b)),T||(e=C({src:e,async:!0},a),(a=$a.get(b))&&ap(e,a),T=c.createElement("script"),Yn(T),wi(T,"link",e),c.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(b,T))}}function j4(e,a){el.M(e,a);var c=Gc;if(c&&e){var h=hs(c).hoistableScripts,b=Pc(e),T=h.get(b);T||(T=c.querySelector(zh(b)),T||(e=C({src:e,async:!0,type:"module"},a),(a=$a.get(b))&&ap(e,a),T=c.createElement("script"),Yn(T),wi(T,"link",e),c.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(b,T))}}function Lv(e,a,c,h){var b=(b=$.current)?R0(b):null;if(!b)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=Hc(c.href),c=hs(b).hoistableStyles,h=c.get(a),h||(h={type:"style",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){e=Hc(c.href);var T=hs(b).hoistableStyles,k=T.get(e);if(k||(b=b.ownerDocument||b,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(e,k),(T=b.querySelector(Bh(e)))&&!T._p&&(k.instance=T,k.state.loading=5),$a.has(e)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},$a.set(e,c),T||U4(b,e,c,k.state))),a&&h===null)throw Error(i(528,""));return k}if(a&&h!==null)throw Error(i(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Pc(c),c=hs(b).hoistableScripts,h=c.get(a),h||(h={type:"script",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Hc(e){return'href="'+qi(e)+'"'}function Bh(e){return'link[rel="stylesheet"]['+e+"]"}function Gv(e){return C({},e,{"data-precedence":e.precedence,precedence:null})}function U4(e,a,c,h){e.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=e.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),wi(a,"link",c),Yn(a),e.head.appendChild(a))}function Pc(e){return'[src="'+qi(e)+'"]'}function zh(e){return"script[async]"+e}function Hv(e,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var h=e.querySelector('style[data-href~="'+qi(c.href)+'"]');if(h)return a.instance=h,Yn(h),h;var b=C({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(e.ownerDocument||e).createElement("style"),Yn(h),wi(h,"style",b),w0(h,c.precedence,e),a.instance=h;case"stylesheet":b=Hc(c.href);var T=e.querySelector(Bh(b));if(T)return a.state.loading|=4,a.instance=T,Yn(T),T;h=Gv(c),(b=$a.get(b))&&ip(h,b),T=(e.ownerDocument||e).createElement("link"),Yn(T);var k=T;return k._p=new Promise(function(W,lt){k.onload=W,k.onerror=lt}),wi(T,"link",h),a.state.loading|=4,w0(T,c.precedence,e),a.instance=T;case"script":return T=Pc(c.src),(b=e.querySelector(zh(T)))?(a.instance=b,Yn(b),b):(h=c,(b=$a.get(T))&&(h=C({},c),ap(h,b)),e=e.ownerDocument||e,b=e.createElement("script"),Yn(b),wi(b,"link",h),e.head.appendChild(b),a.instance=b);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,w0(h,c.precedence,e));return a.instance}function w0(e,a,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=h.length?h[h.length-1]:null,T=b,k=0;k<h.length;k++){var W=h[k];if(W.dataset.precedence===a)T=W;else if(T!==b)break}T?T.parentNode.insertBefore(e,T.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(e,a.firstChild))}function ip(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.title==null&&(e.title=a.title)}function ap(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.integrity==null&&(e.integrity=a.integrity)}var x0=null;function Pv(e,a,c){if(x0===null){var h=new Map,b=x0=new Map;b.set(c,h)}else b=x0,h=b.get(c),h||(h=new Map,b.set(c,h));if(h.has(e))return h;for(h.set(e,null),c=c.getElementsByTagName(e),b=0;b<c.length;b++){var T=c[b];if(!(T[fs]||T[Pn]||e==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var k=T.getAttribute(a)||"";k=e+k;var W=h.get(k);W?W.push(T):h.set(k,[T])}}return h}function Iv(e,a,c){e=e.ownerDocument||e,e.head.insertBefore(c,a==="title"?e.querySelector("head > title"):null)}function B4(e,a,c){if(c===1||a.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return e=a.disabled,typeof a.precedence=="string"&&e==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function kv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function z4(e,a,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var b=Hc(h.href),T=a.querySelector(Bh(b));if(T){a=T._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(e.count++,e=M0.bind(e),a.then(e,e)),c.state.loading|=4,c.instance=T,Yn(T);return}T=a.ownerDocument||a,h=Gv(h),(b=$a.get(b))&&ip(h,b),T=T.createElement("link"),Yn(T);var k=T;k._p=new Promise(function(W,lt){k.onload=W,k.onerror=lt}),wi(T,"link",h),c.instance=T}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(e.count++,c=M0.bind(e),a.addEventListener("load",c),a.addEventListener("error",c))}}var rp=0;function L4(e,a){return e.stylesheets&&e.count===0&&D0(e,e.stylesheets),0<e.count||0<e.imgCount?function(c){var h=setTimeout(function(){if(e.stylesheets&&D0(e,e.stylesheets),e.unsuspend){var T=e.unsuspend;e.unsuspend=null,T()}},6e4+a);0<e.imgBytes&&rp===0&&(rp=62500*v4());var b=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&D0(e,e.stylesheets),e.unsuspend)){var T=e.unsuspend;e.unsuspend=null,T()}},(e.imgBytes>rp?50:800)+a);return e.unsuspend=c,function(){e.unsuspend=null,clearTimeout(h),clearTimeout(b)}}:null}function M0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)D0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var N0=null;function D0(e,a){e.stylesheets=null,e.unsuspend!==null&&(e.count++,N0=new Map,a.forEach(G4,e),N0=null,M0.call(e))}function G4(e,a){if(!(a.state.loading&4)){var c=N0.get(e);if(c)var h=c.get(null);else{c=new Map,N0.set(e,c);for(var b=e.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<b.length;T++){var k=b[T];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),h=k)}h&&c.set(null,h)}b=a.instance,k=b.getAttribute("data-precedence"),T=c.get(k)||h,T===h&&c.set(null,b),c.set(k,b),this.count++,h=M0.bind(this),b.addEventListener("load",h),b.addEventListener("error",h),T?T.parentNode.insertBefore(b,T.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(b,e.firstChild)),a.state.loading|=4}}var Lh={$$typeof:M,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function H4(e,a,c,h,b,T,k,W,lt){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=me(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.hiddenUpdates=me(null),this.identifierPrefix=h,this.onUncaughtError=b,this.onCaughtError=T,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=lt,this.incompleteTransitions=new Map}function qv(e,a,c,h,b,T,k,W,lt,yt,At,wt){return e=new H4(e,a,c,k,lt,yt,At,wt,W),a=1,T===!0&&(a|=24),T=di(3,null,null,a),e.current=T,T.stateNode=e,a=ic(),a.refCount++,e.pooledCache=a,a.refCount++,T.memoizedState={element:h,isDehydrated:c,cache:a},Ms(T),e}function Vv(e){return e?(e=ja,e):ja}function Yv(e,a,c,h,b,T){b=Vv(b),h.context===null?h.context=b:h.pendingContext=b,h=Xr(a),h.payload={element:c},T=T===void 0?null:T,T!==null&&(h.callback=T),c=Fr(e,h,a),c!==null&&(Ve(c,e,a),ko(c,e,a))}function Kv(e,a){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var c=e.retryLane;e.retryLane=c!==0&&c<a?c:a}}function sp(e,a){Kv(e,a),(e=e.alternate)&&Kv(e,a)}function Qv(e){if(e.tag===13||e.tag===31){var a=Yi(e,67108864);a!==null&&Ve(a,e,67108864),sp(e,67108864)}}function Xv(e){if(e.tag===13||e.tag===31){var a=vi();a=fo(a);var c=Yi(e,a);c!==null&&Ve(c,e,a),sp(e,a)}}var j0=!0;function P4(e,a,c,h){var b=j.T;j.T=null;var T=I.p;try{I.p=2,lp(e,a,c,h)}finally{I.p=T,j.T=b}}function I4(e,a,c,h){var b=j.T;j.T=null;var T=I.p;try{I.p=8,lp(e,a,c,h)}finally{I.p=T,j.T=b}}function lp(e,a,c,h){if(j0){var b=op(h);if(b===null)Qg(e,a,h,U0,c),Jv(e,h);else if(q4(b,e,a,c,h))h.stopPropagation();else if(Jv(e,h),a&4&&-1<k4.indexOf(e)){for(;b!==null;){var T=Ur(b);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var k=Ae(T.pendingLanes);if(k!==0){var W=T;for(W.pendingLanes|=2,W.entangledLanes|=2;k;){var lt=1<<31-hi(k);W.entanglements[1]|=lt,k&=~lt}ls(T),(le&6)===0&&(fa=ae()+500,Nh(0))}}break;case 31:case 13:W=Yi(T,2),W!==null&&Ve(W,T,2),Il(),sp(T,2)}if(T=op(h),T===null&&Qg(e,a,h,U0,c),T===b)break;b=T}b!==null&&h.stopPropagation()}else Qg(e,a,h,null,c)}}function op(e){return e=xu(e),up(e)}var U0=null;function up(e){if(U0=null,e=jr(e),e!==null){var a=l(e);if(a===null)e=null;else{var c=a.tag;if(c===13){if(e=f(a),e!==null)return e;e=null}else if(c===31){if(e=d(a),e!==null)return e;e=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;e=null}else a!==e&&(e=null)}}return U0=e,null}function Fv(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ln()){case Sn:return 2;case We:return 8;case ut:case Ot:return 32;case Mt:return 268435456;default:return 32}default:return 32}}var cp=!1,Yl=null,Kl=null,Ql=null,Gh=new Map,Hh=new Map,Xl=[],k4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jv(e,a){switch(e){case"focusin":case"focusout":Yl=null;break;case"dragenter":case"dragleave":Kl=null;break;case"mouseover":case"mouseout":Ql=null;break;case"pointerover":case"pointerout":Gh.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hh.delete(a.pointerId)}}function Ph(e,a,c,h,b,T){return e===null||e.nativeEvent!==T?(e={blockedOn:a,domEventName:c,eventSystemFlags:h,nativeEvent:T,targetContainers:[b]},a!==null&&(a=Ur(a),a!==null&&Qv(a)),e):(e.eventSystemFlags|=h,a=e.targetContainers,b!==null&&a.indexOf(b)===-1&&a.push(b),e)}function q4(e,a,c,h,b){switch(a){case"focusin":return Yl=Ph(Yl,e,a,c,h,b),!0;case"dragenter":return Kl=Ph(Kl,e,a,c,h,b),!0;case"mouseover":return Ql=Ph(Ql,e,a,c,h,b),!0;case"pointerover":var T=b.pointerId;return Gh.set(T,Ph(Gh.get(T)||null,e,a,c,h,b)),!0;case"gotpointercapture":return T=b.pointerId,Hh.set(T,Ph(Hh.get(T)||null,e,a,c,h,b)),!0}return!1}function Zv(e){var a=jr(e.target);if(a!==null){var c=l(a);if(c!==null){if(a=c.tag,a===13){if(a=f(c),a!==null){e.blockedOn=a,ar(e.priority,function(){Xv(c)});return}}else if(a===31){if(a=d(c),a!==null){e.blockedOn=a,ar(e.priority,function(){Xv(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){e.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}e.blockedOn=null}function B0(e){if(e.blockedOn!==null)return!1;for(var a=e.targetContainers;0<a.length;){var c=op(e.nativeEvent);if(c===null){c=e.nativeEvent;var h=new c.constructor(c.type,c);gl=h,c.target.dispatchEvent(h),gl=null}else return a=Ur(c),a!==null&&Qv(a),e.blockedOn=c,!1;a.shift()}return!0}function Wv(e,a,c){B0(e)&&c.delete(a)}function V4(){cp=!1,Yl!==null&&B0(Yl)&&(Yl=null),Kl!==null&&B0(Kl)&&(Kl=null),Ql!==null&&B0(Ql)&&(Ql=null),Gh.forEach(Wv),Hh.forEach(Wv)}function z0(e,a){e.blockedOn===a&&(e.blockedOn=null,cp||(cp=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,V4)))}var L0=null;function $v(e){L0!==e&&(L0=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){L0===e&&(L0=null);for(var a=0;a<e.length;a+=3){var c=e[a],h=e[a+1],b=e[a+2];if(typeof h!="function"){if(up(h||c)===null)continue;break}var T=Ur(c);T!==null&&(e.splice(a,3),a-=3,_c(T,{pending:!0,data:b,method:c.method,action:h},h,b))}}))}function Ic(e){function a(lt){return z0(lt,e)}Yl!==null&&z0(Yl,e),Kl!==null&&z0(Kl,e),Ql!==null&&z0(Ql,e),Gh.forEach(a),Hh.forEach(a);for(var c=0;c<Xl.length;c++){var h=Xl[c];h.blockedOn===e&&(h.blockedOn=null)}for(;0<Xl.length&&(c=Xl[0],c.blockedOn===null);)Zv(c),c.blockedOn===null&&Xl.shift();if(c=(e.ownerDocument||e).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var b=c[h],T=c[h+1],k=b[Vn]||null;if(typeof T=="function")k||$v(c);else if(k){var W=null;if(T&&T.hasAttribute("formAction")){if(b=T,k=T[Vn]||null)W=k.formAction;else if(up(b)!==null)continue}else W=k.action;typeof W=="function"?c[h+1]=W:(c.splice(h,3),h-=3),$v(c)}}}function t1(){function e(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(k){return b=k})},focusReset:"manual",scroll:"manual"})}function a(){b!==null&&(b(),b=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,b=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),b!==null&&(b(),b=null)}}}function fp(e){this._internalRoot=e}G0.prototype.render=fp.prototype.render=function(e){var a=this._internalRoot;if(a===null)throw Error(i(409));var c=a.current,h=vi();Yv(c,h,e,a,null,null)},G0.prototype.unmount=fp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var a=e.containerInfo;Yv(e.current,2,null,e,null,null),Il(),a[wa]=null}};function G0(e){this._internalRoot=e}G0.prototype.unstable_scheduleHydration=function(e){if(e){var a=ir();e={blockedOn:null,target:e,priority:a};for(var c=0;c<Xl.length&&a!==0&&a<Xl[c].priority;c++);Xl.splice(c,0,e),c===0&&Zv(e)}};var e1=t.version;if(e1!=="19.2.0")throw Error(i(527,e1,"19.2.0"));I.findDOMNode=function(e){var a=e._reactInternals;if(a===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(a),e=e!==null?_(e):null,e=e===null?null:e.stateNode,e};var Y4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var H0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!H0.isDisabled&&H0.supportsFiber)try{dn=H0.inject(Y4),An=H0}catch{}}return kh.createRoot=function(e,a){if(!r(e))throw Error(i(299));var c=!1,h="",b=Fo,T=Jo,k=Cc;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(b=a.onUncaughtError),a.onCaughtError!==void 0&&(T=a.onCaughtError),a.onRecoverableError!==void 0&&(k=a.onRecoverableError)),a=qv(e,1,!1,null,null,c,h,null,b,T,k,t1),e[wa]=a.current,Kg(e),new fp(a)},kh.hydrateRoot=function(e,a,c){if(!r(e))throw Error(i(299));var h=!1,b="",T=Fo,k=Jo,W=Cc,lt=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(b=c.identifierPrefix),c.onUncaughtError!==void 0&&(T=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(W=c.onRecoverableError),c.formState!==void 0&&(lt=c.formState)),a=qv(e,1,!0,a,c??null,h,b,lt,T,k,W,t1),a.context=Vv(null),c=a.current,h=vi(),h=fo(h),b=Xr(h),b.callback=null,Fr(c,b,h),c=h,a.current.lanes=c,Wn(a,c),ls(a),e[wa]=a.current,Kg(e),new G0(a)},kh.version="19.2.0",kh}var f1;function n3(){if(f1)return gp.exports;f1=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),gp.exports=e3(),gp.exports}var i3=n3();const a3=cf(i3);h2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sd(){return sd=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},sd.apply(this,arguments)}var io;(function(o){o.Pop="POP",o.Push="PUSH",o.Replace="REPLACE"})(io||(io={}));const h1="popstate";function r3(o){o===void 0&&(o={});function t(i,r){let{pathname:l,search:f,hash:d}=i.location;return ym("",{pathname:l,search:f,hash:d},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:g2(r)}return l3(t,n,null,o)}function ci(o,t){if(o===!1||o===null||typeof o>"u")throw new Error(t)}function d2(o,t){if(!o){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function s3(){return Math.random().toString(36).substr(2,8)}function d1(o,t){return{usr:o.state,key:o.key,idx:t}}function ym(o,t,n,i){return n===void 0&&(n=null),sd({pathname:typeof o=="string"?o:o.pathname,search:"",hash:""},typeof t=="string"?ff(t):t,{state:n,key:t&&t.key||i||s3()})}function g2(o){let{pathname:t="/",search:n="",hash:i=""}=o;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function ff(o){let t={};if(o){let n=o.indexOf("#");n>=0&&(t.hash=o.substr(n),o=o.substr(0,n));let i=o.indexOf("?");i>=0&&(t.search=o.substr(i),o=o.substr(0,i)),o&&(t.pathname=o)}return t}function l3(o,t,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:l=!1}=i,f=r.history,d=io.Pop,g=null,m=_();m==null&&(m=0,f.replaceState(sd({},f.state,{idx:m}),""));function _(){return(f.state||{idx:null}).idx}function C(){d=io.Pop;let z=_(),G=z==null?null:z-m;m=z,g&&g({action:d,location:D.location,delta:G})}function E(z,G){d=io.Push;let N=ym(D.location,z,G);m=_()+1;let M=d1(N,m),L=D.createHref(N);try{f.pushState(M,"",L)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;r.location.assign(L)}l&&g&&g({action:d,location:D.location,delta:1})}function R(z,G){d=io.Replace;let N=ym(D.location,z,G);m=_();let M=d1(N,m),L=D.createHref(N);f.replaceState(M,"",L),l&&g&&g({action:d,location:D.location,delta:0})}function v(z){let G=r.location.origin!=="null"?r.location.origin:r.location.href,N=typeof z=="string"?z:g2(z);return N=N.replace(/ $/,"%20"),ci(G,"No window.location.(origin|href) available to create URL for href: "+N),new URL(N,G)}let D={get action(){return d},get location(){return o(r,f)},listen(z){if(g)throw new Error("A history only accepts one active listener");return r.addEventListener(h1,C),g=z,()=>{r.removeEventListener(h1,C),g=null}},createHref(z){return t(r,z)},createURL:v,encodeLocation(z){let G=v(z);return{pathname:G.pathname,search:G.search,hash:G.hash}},push:E,replace:R,go(z){return f.go(z)}};return D}var g1;(function(o){o.data="data",o.deferred="deferred",o.redirect="redirect",o.error="error"})(g1||(g1={}));function o3(o,t,n){return n===void 0&&(n="/"),u3(o,t,n)}function u3(o,t,n,i){let r=typeof t=="string"?ff(t):t,l=v2(r.pathname||"/",n);if(l==null)return null;let f=p2(o);c3(f);let d=null;for(let g=0;d==null&&g<f.length;++g){let m=E3(l);d=S3(f[g],m)}return d}function p2(o,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(l,f,d)=>{let g={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:f,route:l};g.relativePath.startsWith("/")&&(ci(g.relativePath.startsWith(i),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(i.length));let m=cu([i,g.relativePath]),_=n.concat(g);l.children&&l.children.length>0&&(ci(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),p2(l.children,t,_,m)),!(l.path==null&&!l.index)&&t.push({path:m,score:v3(m,l.index),routesMeta:_})};return o.forEach((l,f)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))r(l,f);else for(let g of m2(l.path))r(l,f,g)}),t}function m2(o){let t=o.split("/");if(t.length===0)return[];let[n,...i]=t,r=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return r?[l,""]:[l];let f=m2(i.join("/")),d=[];return d.push(...f.map(g=>g===""?l:[l,g].join("/"))),r&&d.push(...f),d.map(g=>o.startsWith("/")&&g===""?"/":g)}function c3(o){o.sort((t,n)=>t.score!==n.score?n.score-t.score:y3(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const f3=/^:[\w-]+$/,h3=3,d3=2,g3=1,p3=10,m3=-2,p1=o=>o==="*";function v3(o,t){let n=o.split("/"),i=n.length;return n.some(p1)&&(i+=m3),t&&(i+=d3),n.filter(r=>!p1(r)).reduce((r,l)=>r+(f3.test(l)?h3:l===""?g3:p3),i)}function y3(o,t){return o.length===t.length&&o.slice(0,-1).every((i,r)=>i===t[r])?o[o.length-1]-t[t.length-1]:0}function S3(o,t,n){let{routesMeta:i}=o,r={},l="/",f=[];for(let d=0;d<i.length;++d){let g=i[d],m=d===i.length-1,_=l==="/"?t:t.slice(l.length)||"/",C=b3({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},_),E=g.route;if(!C)return null;Object.assign(r,C.params),f.push({params:r,pathname:cu([l,C.pathname]),pathnameBase:w3(cu([l,C.pathnameBase])),route:E}),C.pathnameBase!=="/"&&(l=cu([l,C.pathnameBase]))}return f}function b3(o,t){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[n,i]=_3(o.path,o.caseSensitive,o.end),r=t.match(n);if(!r)return null;let l=r[0],f=l.replace(/(.)\/+$/,"$1"),d=r.slice(1);return{params:i.reduce((m,_,C)=>{let{paramName:E,isOptional:R}=_;if(E==="*"){let D=d[C]||"";f=l.slice(0,l.length-D.length).replace(/(.)\/+$/,"$1")}const v=d[C];return R&&!v?m[E]=void 0:m[E]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:f,pattern:o}}function _3(o,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),d2(o==="*"||!o.endsWith("*")||o.endsWith("/*"),'Route path "'+o+'" will be treated as if it were '+('"'+o.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+o.replace(/\*$/,"/*")+'".'));let i=[],r="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,d,g)=>(i.push({paramName:d,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(i.push({paramName:"*"}),r+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":o!==""&&o!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function E3(o){try{return o.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return d2(!1,'The URL path "'+o+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),o}}function v2(o,t){if(t==="/")return o;if(!o.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=o.charAt(n);return i&&i!=="/"?null:o.slice(n)||"/"}function C3(o,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:r=""}=typeof o=="string"?ff(o):o;return{pathname:n?n.startsWith("/")?n:T3(n,t):t,search:x3(i),hash:M3(r)}}function T3(o,t){let n=t.replace(/\/+$/,"").split("/");return o.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function yp(o,t,n,i){return"Cannot include a '"+o+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function A3(o){return o.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function O3(o,t){let n=A3(o);return t?n.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function R3(o,t,n,i){i===void 0&&(i=!1);let r;typeof o=="string"?r=ff(o):(r=sd({},o),ci(!r.pathname||!r.pathname.includes("?"),yp("?","pathname","search",r)),ci(!r.pathname||!r.pathname.includes("#"),yp("#","pathname","hash",r)),ci(!r.search||!r.search.includes("#"),yp("#","search","hash",r)));let l=o===""||r.pathname==="",f=l?"/":r.pathname,d;if(f==null)d=n;else{let C=t.length-1;if(!i&&f.startsWith("..")){let E=f.split("/");for(;E[0]==="..";)E.shift(),C-=1;r.pathname=E.join("/")}d=C>=0?t[C]:"/"}let g=C3(r,d),m=f&&f!=="/"&&f.endsWith("/"),_=(l||f===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(m||_)&&(g.pathname+="/"),g}const cu=o=>o.join("/").replace(/\/\/+/g,"/"),w3=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),x3=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,M3=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function N3(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}const y2=["post","put","patch","delete"];new Set(y2);const D3=["get",...y2];new Set(D3);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ld(){return ld=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},ld.apply(this,arguments)}const Ym=mt.createContext(null),j3=mt.createContext(null),bg=mt.createContext(null),_g=mt.createContext(null),hf=mt.createContext({outlet:null,matches:[],isDataRoute:!1}),S2=mt.createContext(null);function Eg(){return mt.useContext(_g)!=null}function Km(){return Eg()||ci(!1),mt.useContext(_g).location}function b2(o){mt.useContext(bg).static||mt.useLayoutEffect(o)}function Qm(){let{isDataRoute:o}=mt.useContext(hf);return o?K3():U3()}function U3(){Eg()||ci(!1);let o=mt.useContext(Ym),{basename:t,future:n,navigator:i}=mt.useContext(bg),{matches:r}=mt.useContext(hf),{pathname:l}=Km(),f=JSON.stringify(O3(r,n.v7_relativeSplatPath)),d=mt.useRef(!1);return b2(()=>{d.current=!0}),mt.useCallback(function(m,_){if(_===void 0&&(_={}),!d.current)return;if(typeof m=="number"){i.go(m);return}let C=R3(m,JSON.parse(f),l,_.relative==="path");o==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:cu([t,C.pathname])),(_.replace?i.replace:i.push)(C,_.state,_)},[t,i,f,l,o])}function B3(o,t){return z3(o,t)}function z3(o,t,n,i){Eg()||ci(!1);let{navigator:r}=mt.useContext(bg),{matches:l}=mt.useContext(hf),f=l[l.length-1],d=f?f.params:{};f&&f.pathname;let g=f?f.pathnameBase:"/";f&&f.route;let m=Km(),_;if(t){var C;let z=typeof t=="string"?ff(t):t;g==="/"||(C=z.pathname)!=null&&C.startsWith(g)||ci(!1),_=z}else _=m;let E=_.pathname||"/",R=E;if(g!=="/"){let z=g.replace(/^\//,"").split("/");R="/"+E.replace(/^\//,"").split("/").slice(z.length).join("/")}let v=o3(o,{pathname:R}),D=I3(v&&v.map(z=>Object.assign({},z,{params:Object.assign({},d,z.params),pathname:cu([g,r.encodeLocation?r.encodeLocation(z.pathname).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?g:cu([g,r.encodeLocation?r.encodeLocation(z.pathnameBase).pathname:z.pathnameBase])})),l,n,i);return t&&D?mt.createElement(_g.Provider,{value:{location:ld({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:io.Pop}},D):D}function L3(){let o=Y3(),t=N3(o)?o.status+" "+o.statusText:o instanceof Error?o.message:JSON.stringify(o),n=o instanceof Error?o.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return mt.createElement(mt.Fragment,null,mt.createElement("h2",null,"Unexpected Application Error!"),mt.createElement("h3",{style:{fontStyle:"italic"}},t),n?mt.createElement("pre",{style:r},n):null,null)}const G3=mt.createElement(L3,null);class H3 extends mt.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?mt.createElement(hf.Provider,{value:this.props.routeContext},mt.createElement(S2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function P3(o){let{routeContext:t,match:n,children:i}=o,r=mt.useContext(Ym);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),mt.createElement(hf.Provider,{value:t},i)}function I3(o,t,n,i){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),o==null){var l;if(!n)return null;if(n.errors)o=n.matches;else if((l=i)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)o=n.matches;else return null}let f=o,d=(r=n)==null?void 0:r.errors;if(d!=null){let _=f.findIndex(C=>C.route.id&&(d==null?void 0:d[C.route.id])!==void 0);_>=0||ci(!1),f=f.slice(0,Math.min(f.length,_+1))}let g=!1,m=-1;if(n&&i&&i.v7_partialHydration)for(let _=0;_<f.length;_++){let C=f[_];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(m=_),C.route.id){let{loaderData:E,errors:R}=n,v=C.route.loader&&E[C.route.id]===void 0&&(!R||R[C.route.id]===void 0);if(C.route.lazy||v){g=!0,m>=0?f=f.slice(0,m+1):f=[f[0]];break}}}return f.reduceRight((_,C,E)=>{let R,v=!1,D=null,z=null;n&&(R=d&&C.route.id?d[C.route.id]:void 0,D=C.route.errorElement||G3,g&&(m<0&&E===0?(Q3("route-fallback"),v=!0,z=null):m===E&&(v=!0,z=C.route.hydrateFallbackElement||null)));let G=t.concat(f.slice(0,E+1)),N=()=>{let M;return R?M=D:v?M=z:C.route.Component?M=mt.createElement(C.route.Component,null):C.route.element?M=C.route.element:M=_,mt.createElement(P3,{match:C,routeContext:{outlet:_,matches:G,isDataRoute:n!=null},children:M})};return n&&(C.route.ErrorBoundary||C.route.errorElement||E===0)?mt.createElement(H3,{location:n.location,revalidation:n.revalidation,component:D,error:R,children:N(),routeContext:{outlet:null,matches:G,isDataRoute:!0}}):N()},null)}var _2=(function(o){return o.UseBlocker="useBlocker",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o})(_2||{}),E2=(function(o){return o.UseBlocker="useBlocker",o.UseLoaderData="useLoaderData",o.UseActionData="useActionData",o.UseRouteError="useRouteError",o.UseNavigation="useNavigation",o.UseRouteLoaderData="useRouteLoaderData",o.UseMatches="useMatches",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o.UseRouteId="useRouteId",o})(E2||{});function k3(o){let t=mt.useContext(Ym);return t||ci(!1),t}function q3(o){let t=mt.useContext(j3);return t||ci(!1),t}function V3(o){let t=mt.useContext(hf);return t||ci(!1),t}function C2(o){let t=V3(),n=t.matches[t.matches.length-1];return n.route.id||ci(!1),n.route.id}function Y3(){var o;let t=mt.useContext(S2),n=q3(),i=C2();return t!==void 0?t:(o=n.errors)==null?void 0:o[i]}function K3(){let{router:o}=k3(_2.UseNavigateStable),t=C2(E2.UseNavigateStable),n=mt.useRef(!1);return b2(()=>{n.current=!0}),mt.useCallback(function(r,l){l===void 0&&(l={}),n.current&&(typeof r=="number"?o.navigate(r):o.navigate(r,ld({fromRouteId:t},l)))},[o,t])}const m1={};function Q3(o,t,n){m1[o]||(m1[o]=!0)}function X3(o,t){o==null||o.v7_startTransition,o==null||o.v7_relativeSplatPath}function ug(o){ci(!1)}function F3(o){let{basename:t="/",children:n=null,location:i,navigationType:r=io.Pop,navigator:l,static:f=!1,future:d}=o;Eg()&&ci(!1);let g=t.replace(/^\/*/,"/"),m=mt.useMemo(()=>({basename:g,navigator:l,static:f,future:ld({v7_relativeSplatPath:!1},d)}),[g,d,l,f]);typeof i=="string"&&(i=ff(i));let{pathname:_="/",search:C="",hash:E="",state:R=null,key:v="default"}=i,D=mt.useMemo(()=>{let z=v2(_,g);return z==null?null:{location:{pathname:z,search:C,hash:E,state:R,key:v},navigationType:r}},[g,_,C,E,R,v,r]);return D==null?null:mt.createElement(bg.Provider,{value:m},mt.createElement(_g.Provider,{children:n,value:D}))}function J3(o){let{children:t,location:n}=o;return B3(Sm(t),n)}new Promise(()=>{});function Sm(o,t){t===void 0&&(t=[]);let n=[];return mt.Children.forEach(o,(i,r)=>{if(!mt.isValidElement(i))return;let l=[...t,r];if(i.type===mt.Fragment){n.push.apply(n,Sm(i.props.children,l));return}i.type!==ug&&ci(!1),!i.props.index||!i.props.children||ci(!1);let f={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(f.children=Sm(i.props.children,l)),n.push(f)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bm(o){return o===void 0&&(o=""),new URLSearchParams(typeof o=="string"||Array.isArray(o)||o instanceof URLSearchParams?o:Object.keys(o).reduce((t,n)=>{let i=o[n];return t.concat(Array.isArray(i)?i.map(r=>[n,r]):[[n,i]])},[]))}function Z3(o,t){let n=bm(o);return t&&t.forEach((i,r)=>{n.has(r)||t.getAll(r).forEach(l=>{n.append(r,l)})}),n}const W3="6";try{window.__reactRouterVersion=W3}catch{}const $3="startTransition",v1=Z4[$3];function tb(o){let{basename:t,children:n,future:i,window:r}=o,l=mt.useRef();l.current==null&&(l.current=r3({window:r,v5Compat:!0}));let f=l.current,[d,g]=mt.useState({action:f.action,location:f.location}),{v7_startTransition:m}=i||{},_=mt.useCallback(C=>{m&&v1?v1(()=>g(C)):g(C)},[g,m]);return mt.useLayoutEffect(()=>f.listen(_),[f,_]),mt.useEffect(()=>X3(i),[i]),mt.createElement(F3,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:f,future:i})}var y1;(function(o){o.UseScrollRestoration="useScrollRestoration",o.UseSubmit="useSubmit",o.UseSubmitFetcher="useSubmitFetcher",o.UseFetcher="useFetcher",o.useViewTransitionState="useViewTransitionState"})(y1||(y1={}));var S1;(function(o){o.UseFetcher="useFetcher",o.UseFetchers="useFetchers",o.UseScrollRestoration="useScrollRestoration"})(S1||(S1={}));function T2(o){let t=mt.useRef(bm(o)),n=mt.useRef(!1),i=Km(),r=mt.useMemo(()=>Z3(i.search,n.current?null:t.current),[i.search]),l=Qm(),f=mt.useCallback((d,g)=>{const m=bm(typeof d=="function"?d(r):d);n.current=!0,l("?"+m,g)},[l,r]);return[r,f]}function eb(){const o=Qm(),[t,n]=mt.useState(!1),[i,r]=mt.useState(""),[l,f]=mt.useState("demo"),d=g=>{g.preventDefault(),i.trim()&&l.trim()&&o(`/student?room=${l}&name=${encodeURIComponent(i.trim())}`)};return t?et.jsxs("div",{className:"landing-page",children:[et.jsxs("div",{className:"background-decorations",children:[et.jsx("div",{className:"bg-blob bg-blob-1"}),et.jsx("div",{className:"bg-blob bg-blob-2"}),et.jsx("div",{className:"bg-gradient-overlay"})]}),et.jsx("main",{className:"landing-main",children:et.jsx("div",{className:"glass-surface landing-container",style:{maxWidth:"500px"},children:et.jsxs("div",{className:"landing-content",children:[et.jsx("span",{className:"glass-pill landing-badge",children:et.jsx("span",{children:"FEATHER"})}),et.jsxs("div",{className:"landing-header",children:[et.jsx("h1",{className:"landing-title",style:{fontSize:"2rem"},children:"Join as Student"}),et.jsx("p",{className:"landing-description",children:"Enter your name and room code to start drawing"})]}),et.jsxs("form",{onSubmit:d,style:{width:"100%",marginTop:"2rem"},children:[et.jsxs("div",{style:{marginBottom:"1.5rem"},children:[et.jsx("label",{htmlFor:"studentName",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Your Name"}),et.jsx("input",{id:"studentName",type:"text",value:i,onChange:g=>r(g.target.value),placeholder:"Enter your name",autoFocus:!0,required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),et.jsxs("div",{style:{marginBottom:"1.5rem"},children:[et.jsx("label",{htmlFor:"roomCode",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Room Code"}),et.jsx("input",{id:"roomCode",type:"text",value:l,onChange:g=>f(g.target.value.toUpperCase()),placeholder:"Enter room code",required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s",fontFamily:"monospace",letterSpacing:"2px"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),et.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[et.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"2px solid #ddd",borderRadius:"8px",background:"white",cursor:"pointer",transition:"all 0.2s"},children:"← Back"}),et.jsx("button",{type:"submit",style:{flex:2,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:g=>g.target.style.transform="translateY(-2px)",onMouseOut:g=>g.target.style.transform="translateY(0)",children:"Join Room →"})]})]})]})})})]}):et.jsxs("div",{className:"landing-page",children:[et.jsxs("div",{className:"background-decorations",children:[et.jsx("div",{className:"bg-blob bg-blob-1"}),et.jsx("div",{className:"bg-blob bg-blob-2"}),et.jsx("div",{className:"bg-gradient-overlay"})]}),et.jsx("main",{className:"landing-main",children:et.jsxs("div",{className:"glass-surface landing-container",children:[et.jsxs("div",{className:"landing-content",children:[et.jsx("span",{className:"glass-pill landing-badge",children:et.jsx("span",{children:"FEATHER"})}),et.jsxs("div",{className:"landing-header",children:[et.jsx("h1",{className:"landing-title",children:"Teach visually. Collaborate instantly."}),et.jsx("p",{className:"landing-description",children:"Feather streams pencil-perfect strokes between teachers and students in real time. Instant sync, buttery smooth annotation tools, and delightful classroom-ready controls built for iPad and stylus workflows."})]}),et.jsxs("dl",{className:"features",children:[et.jsxs("div",{className:"feature-card",children:[et.jsx("dt",{className:"feature-title",children:"Palm rejection"}),et.jsx("dd",{className:"feature-subtitle",children:"Silky palm drawing"})]}),et.jsxs("div",{className:"feature-card",children:[et.jsx("dt",{className:"feature-title",children:"Frameless logos"}),et.jsx("dd",{className:"feature-subtitle",children:"Delightful annotations"})]}),et.jsxs("div",{className:"feature-card",children:[et.jsx("dt",{className:"feature-title",children:"Realtime sync"}),et.jsx("dd",{className:"feature-subtitle",children:"Sub-second latency"})]})]})]}),et.jsxs("div",{className:"workspace-section",children:[et.jsx("p",{className:"workspace-label",children:"PICK YOUR WORKSPACE"}),et.jsxs("div",{className:"workspace-cards",children:[et.jsxs("a",{onClick:()=>o("/teacher?room=demo"),className:"glass-button teacher-card",children:[et.jsxs("div",{children:[et.jsx("p",{className:"workspace-title",children:"Teacher dashboard"}),et.jsx("p",{className:"workspace-description",children:"Monitor your students, sync views, and annotate the board. Assign templates/images, and manage the class."})]}),et.jsx("span",{className:"workspace-emoji",children:"👩‍🏫"})]}),et.jsxs("a",{onClick:()=>n(!0),className:"glass-button student-card",children:[et.jsxs("div",{children:[et.jsx("p",{className:"workspace-title",children:"Student workspace"}),et.jsx("p",{className:"workspace-description",children:"Sketch on a public or draw alongside the class, with undo/redo, templates, and stylus-first controls."})]}),et.jsx("span",{className:"workspace-emoji",children:"👩‍🎓"})]})]})]})]})})]})}const nb=Math.PI/180;function ib(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const ou=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},kt={_global:ou,version:"10.0.7",isBrowser:ib(),isUnminified:/param/.test((function(o){}).toString()),dblClickWindow:400,getAngle(o){return kt.angleDeg?o*nb:o},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return kt.DD.isDragging},isTransforming(){var o,t;return(t=(o=kt.Transformer)===null||o===void 0?void 0:o.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!kt.DD.node},releaseCanvasOnDestroy:!0,document:ou.document,_injectGlobal(o){typeof ou.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),ou.Konva=o}},Dn=o=>{kt[o.prototype.getClassName()]=o};kt._injectGlobal(kt);const ab=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,b1=()=>{if(typeof document>"u")throw new Error(ab)};class Ta{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Ta(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const n=this.m;return{x:n[0]*t.x+n[2]*t.y+n[4],y:n[1]*t.x+n[3]*t.y+n[5]}}translate(t,n){return this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n,this}scale(t,n){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n,this}rotate(t){const n=Math.cos(t),i=Math.sin(t),r=this.m[0]*n+this.m[2]*i,l=this.m[1]*n+this.m[3]*i,f=this.m[0]*-i+this.m[2]*n,d=this.m[1]*-i+this.m[3]*n;return this.m[0]=r,this.m[1]=l,this.m[2]=f,this.m[3]=d,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,n){const i=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,l=this.m[2]+this.m[0]*t,f=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=r,this.m[2]=l,this.m[3]=f,this}multiply(t){const n=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],l=this.m[1]*t.m[2]+this.m[3]*t.m[3],f=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],d=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=l,this.m[4]=f,this.m[5]=d,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,i=-this.m[1]*t,r=-this.m[2]*t,l=this.m[0]*t,f=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),d=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=l,this.m[4]=f,this.m[5]=d,this}getMatrix(){return this.m}decompose(){const t=this.m[0],n=this.m[1],i=this.m[2],r=this.m[3],l=this.m[4],f=this.m[5],d=t*r-n*i,g={x:l,y:f,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){const m=Math.sqrt(t*t+n*n);g.rotation=n>0?Math.acos(t/m):-Math.acos(t/m),g.scaleX=m,g.scaleY=d/m,g.skewX=(t*i+n*r)/d,g.skewY=0}else if(i!=0||r!=0){const m=Math.sqrt(i*i+r*r);g.rotation=Math.PI/2-(r>0?Math.acos(-i/m):-Math.acos(i/m)),g.scaleX=d/m,g.scaleY=m,g.skewX=0,g.skewY=(t*i+n*r)/d}return g.rotation=pt._getRotation(g.rotation),g}}const rb="[object Array]",sb="[object Number]",lb="[object String]",ob="[object Boolean]",ub=Math.PI/180,cb=180/Math.PI,Sp="#",fb="",hb="0",db="Konva warning: ",_1="Konva error: ",gb="rgb(",bp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},pb=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let P0=[];const mb=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(o){setTimeout(o,60)},pt={_isElement(o){return!!(o&&o.nodeType==1)},_isFunction(o){return!!(o&&o.constructor&&o.call&&o.apply)},_isPlainObject(o){return!!o&&o.constructor===Object},_isArray(o){return Object.prototype.toString.call(o)===rb},_isNumber(o){return Object.prototype.toString.call(o)===sb&&!isNaN(o)&&isFinite(o)},_isString(o){return Object.prototype.toString.call(o)===lb},_isBoolean(o){return Object.prototype.toString.call(o)===ob},isObject(o){return o instanceof Object},isValidSelector(o){if(typeof o!="string")return!1;const t=o[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(o){return o===0||o>0?1:-1},requestAnimFrame(o){P0.push(o),P0.length===1&&mb(function(){const t=P0;P0=[],t.forEach(function(n){n()})})},createCanvasElement(){b1();const o=document.createElement("canvas");try{o.style=o.style||{}}catch{}return o},createImageElement(){return b1(),document.createElement("img")},_isInDocument(o){for(;o=o.parentNode;)if(o==document)return!0;return!1},_urlToImage(o,t){const n=pt.createImageElement();n.onload=function(){t(n)},n.src=o},_rgbToHex(o,t,n){return((1<<24)+(o<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(o){o=o.replace(Sp,fb);const t=parseInt(o,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let o=(Math.random()*16777215<<0).toString(16);for(;o.length<6;)o=hb+o;return Sp+o},getRGB(o){let t;return o in bp?(t=bp[o],{r:t[0],g:t[1],b:t[2]}):o[0]===Sp?this._hexToRgb(o.substring(1)):o.substr(0,4)===gb?(t=pb.exec(o.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(o){return o=o||"black",pt._namedColorToRBA(o)||pt._hex3ColorToRGBA(o)||pt._hex4ColorToRGBA(o)||pt._hex6ColorToRGBA(o)||pt._hex8ColorToRGBA(o)||pt._rgbColorToRGBA(o)||pt._rgbaColorToRGBA(o)||pt._hslColorToRGBA(o)},_namedColorToRBA(o){const t=bp[o.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(o){if(o.indexOf("rgb(")===0){o=o.match(/rgb\(([^)]+)\)/)[1];const t=o.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(o){if(o.indexOf("rgba(")===0){o=o.match(/rgba\(([^)]+)\)/)[1];const t=o.split(/ *, */).map((n,i)=>n.slice(-1)==="%"?i===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(o){if(o[0]==="#"&&o.length===9)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:parseInt(o.slice(7,9),16)/255}},_hex6ColorToRGBA(o){if(o[0]==="#"&&o.length===7)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:1}},_hex4ColorToRGBA(o){if(o[0]==="#"&&o.length===5)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:parseInt(o[4]+o[4],16)/255}},_hex3ColorToRGBA(o){if(o[0]==="#"&&o.length===4)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:1}},_hslColorToRGBA(o){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(o)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o),i=Number(n[0])/360,r=Number(n[1])/100,l=Number(n[2])/100;let f,d,g;if(r===0)return g=l*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};l<.5?f=l*(1+r):f=l+r-l*r;const m=2*l-f,_=[0,0,0];for(let C=0;C<3;C++)d=i+1/3*-(C-1),d<0&&d++,d>1&&d--,6*d<1?g=m+(f-m)*6*d:2*d<1?g=f:3*d<2?g=m+(f-m)*(2/3-d)*6:g=m,_[C]=g*255;return{r:Math.round(_[0]),g:Math.round(_[1]),b:Math.round(_[2]),a:1}}},haveIntersection(o,t){return!(t.x>o.x+o.width||t.x+t.width<o.x||t.y>o.y+o.height||t.y+t.height<o.y)},cloneObject(o){const t={};for(const n in o)this._isPlainObject(o[n])?t[n]=this.cloneObject(o[n]):this._isArray(o[n])?t[n]=this.cloneArray(o[n]):t[n]=o[n];return t},cloneArray(o){return o.slice(0)},degToRad(o){return o*ub},radToDeg(o){return o*cb},_degToRad(o){return pt.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),pt.degToRad(o)},_radToDeg(o){return pt.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),pt.radToDeg(o)},_getRotation(o){return kt.angleDeg?pt.radToDeg(o):o},_capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},throw(o){throw new Error(_1+o)},error(o){console.error(_1+o)},warn(o){kt.showWarnings&&console.warn(db+o)},each(o,t){for(const n in o)t(n,o[n])},_inRange(o,t,n){return t<=o&&o<n},_getProjectionToSegment(o,t,n,i,r,l){let f,d,g;const m=(o-n)*(o-n)+(t-i)*(t-i);if(m==0)f=o,d=t,g=(r-n)*(r-n)+(l-i)*(l-i);else{const _=((r-o)*(n-o)+(l-t)*(i-t))/m;_<0?(f=o,d=t,g=(o-r)*(o-r)+(t-l)*(t-l)):_>1?(f=n,d=i,g=(n-r)*(n-r)+(i-l)*(i-l)):(f=o+_*(n-o),d=t+_*(i-t),g=(f-r)*(f-r)+(d-l)*(d-l))}return[f,d,g]},_getProjectionToLine(o,t,n){const i=pt.cloneObject(o);let r=Number.MAX_VALUE;return t.forEach(function(l,f){if(!n&&f===t.length-1)return;const d=t[(f+1)%t.length],g=pt._getProjectionToSegment(l.x,l.y,d.x,d.y,o.x,o.y),m=g[0],_=g[1],C=g[2];C<r&&(i.x=m,i.y=_,r=C)}),i},_prepareArrayForTween(o,t,n){const i=[],r=[];if(o.length>t.length){const f=t;t=o,o=f}for(let f=0;f<o.length;f+=2)i.push({x:o[f],y:o[f+1]});for(let f=0;f<t.length;f+=2)r.push({x:t[f],y:t[f+1]});const l=[];return r.forEach(function(f){const d=pt._getProjectionToLine(f,i,n);l.push(d.x),l.push(d.y)}),l},_prepareToStringify(o){let t;o.visitedByCircularReferenceRemoval=!0;for(const n in o)if(o.hasOwnProperty(n)&&o[n]&&typeof o[n]=="object"){if(t=Object.getOwnPropertyDescriptor(o,n),o[n].visitedByCircularReferenceRemoval||pt._isElement(o[n]))if(t.configurable)delete o[n];else return null;else if(pt._prepareToStringify(o[n])===null)if(t.configurable)delete o[n];else return null}return delete o.visitedByCircularReferenceRemoval,o},_assign(o,t){for(const n in t)o[n]=t[n];return o},_getFirstPointerId(o){return o.touches?o.changedTouches[0].identifier:o.pointerId||999},releaseCanvas(...o){kt.releaseCanvasOnDestroy&&o.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(o,t,n,i){let r=t<0?t:0,l=n<0?n:0;t=Math.abs(t),n=Math.abs(n);let f=0,d=0,g=0,m=0;typeof i=="number"?f=d=g=m=Math.min(i,t/2,n/2):(f=Math.min(i[0]||0,t/2,n/2),d=Math.min(i[1]||0,t/2,n/2),m=Math.min(i[2]||0,t/2,n/2),g=Math.min(i[3]||0,t/2,n/2)),o.moveTo(r+f,l),o.lineTo(r+t-d,l),o.arc(r+t-d,l+d,d,Math.PI*3/2,0,!1),o.lineTo(r+t,l+n-m),o.arc(r+t-m,l+n-m,m,0,Math.PI/2,!1),o.lineTo(r+g,l+n),o.arc(r+g,l+n-g,g,Math.PI/2,Math.PI,!1),o.lineTo(r,l+f),o.arc(r+f,l+f,f,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(o,t,n,i,r){i=Math.abs(i);for(let l=0;l<n;l++){const f=t[(l-1+n)%n],d=t[l],g=t[(l+1)%n],m={x:d.x-f.x,y:d.y-f.y},_={x:g.x-d.x,y:g.y-d.y},C=Math.hypot(m.x,m.y),E=Math.hypot(_.x,_.y);let R;typeof r=="number"?R=r:R=l<r.length?r[l]:0,R=i*Math.cos(Math.PI/n)*Math.min(1,R/i*2);const D={x:m.x/C,y:m.y/C},z={x:_.x/E,y:_.y/E},G={x:d.x-D.x*R,y:d.y-D.y*R},N={x:d.x+z.x*R,y:d.y+z.y*R};l===0?o.moveTo(G.x,G.y):o.lineTo(G.x,G.y),o.arcTo(d.x,d.y,N.x,N.y,R)}}};function vb(o){const t=[],n=o.length,i=pt;for(let r=0;r<n;r++){let l=o[r];i._isNumber(l)?l=Math.round(l*1e3)/1e3:i._isString(l)||(l=l+""),t.push(l)}return t}const E1=",",yb="(",Sb=")",bb="([",_b="])",Eb=";",Cb="()",Tb="=",C1=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],Ab=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],Ob=100;let I0=null;function T1(){if(I0!==null)return I0;try{const t=pt.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(I0=!1,!1)}catch{return I0=!1,!1}}class Cg{constructor(t){this.canvas=t,kt.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,n){let i=this.traceArr,r=i.length,l="",f,d,g,m;for(f=0;f<r;f++)d=i[f],g=d.method,g?(m=d.args,l+=g,t?l+=Cb:pt._isArray(m[0])?l+=bb+m.join(E1)+_b:(n&&(m=m.map(_=>typeof _=="number"?Math.floor(_):_)),l+=yb+m.join(E1)+Sb)):(l+=d.property,t||(l+=Tb+d.val)),l+=Eb;return l}clearTrace(){this.traceArr=[]}_trace(t){let n=this.traceArr,i;n.push(t),i=n.length,i>=Ob&&n.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const n=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(t){const n=t.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(t){const n=t.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(t){const n=t.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(t){const n=t.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(t,n){this._context[t]=n}arc(t,n,i,r,l,f){this._context.arc(t,n,i,r,l,f)}arcTo(t,n,i,r,l){this._context.arcTo(t,n,i,r,l)}beginPath(){this._context.beginPath()}bezierCurveTo(t,n,i,r,l,f){this._context.bezierCurveTo(t,n,i,r,l,f)}clearRect(t,n,i,r){this._context.clearRect(t,n,i,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,n){const i=arguments;if(i.length===2)return this._context.createImageData(t,n);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,n,i,r){return this._context.createLinearGradient(t,n,i,r)}createPattern(t,n){return this._context.createPattern(t,n)}createRadialGradient(t,n,i,r,l,f){return this._context.createRadialGradient(t,n,i,r,l,f)}drawImage(t,n,i,r,l,f,d,g,m){const _=arguments,C=this._context;_.length===3?C.drawImage(t,n,i):_.length===5?C.drawImage(t,n,i,r,l):_.length===9&&C.drawImage(t,n,i,r,l,f,d,g,m)}ellipse(t,n,i,r,l,f,d,g){this._context.ellipse(t,n,i,r,l,f,d,g)}isPointInPath(t,n,i,r){return i?this._context.isPointInPath(i,t,n,r):this._context.isPointInPath(t,n,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,n,i,r){this._context.fillRect(t,n,i,r)}strokeRect(t,n,i,r){this._context.strokeRect(t,n,i,r)}fillText(t,n,i,r){r?this._context.fillText(t,n,i,r):this._context.fillText(t,n,i)}measureText(t){return this._context.measureText(t)}getImageData(t,n,i,r){return this._context.getImageData(t,n,i,r)}lineTo(t,n){this._context.lineTo(t,n)}moveTo(t,n){this._context.moveTo(t,n)}rect(t,n,i,r){this._context.rect(t,n,i,r)}roundRect(t,n,i,r,l){this._context.roundRect(t,n,i,r,l)}putImageData(t,n,i){this._context.putImageData(t,n,i)}quadraticCurveTo(t,n,i,r){this._context.quadraticCurveTo(t,n,i,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,n){this._context.scale(t,n)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,n,i,r,l,f){this._context.setTransform(t,n,i,r,l,f)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,n,i,r){this._context.strokeText(t,n,i,r)}transform(t,n,i,r,l,f){this._context.transform(t,n,i,r,l,f)}translate(t,n){this._context.translate(t,n)}_enableTrace(){let t=this,n=C1.length,i=this.setAttr,r,l;const f=function(d){let g=t[d],m;t[d]=function(){return l=vb(Array.prototype.slice.call(arguments,0)),m=g.apply(t,arguments),t._trace({method:d,args:l}),m}};for(r=0;r<n;r++)f(C1[r]);t.setAttr=function(){i.apply(t,arguments);const d=arguments[0];let g=arguments[1];(d==="shadowOffsetX"||d==="shadowOffsetY"||d==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),t._trace({property:d,val:g})}}_applyGlobalCompositeOperation(t){const n=t.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}Ab.forEach(function(o){Object.defineProperty(Cg.prototype,o,{get(){return this._context[o]},set(t){this._context[o]=t}})});class Rb extends Cg{constructor(t,{willReadFrequently:n=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(t){const n=t.fill();this.setAttr("fillStyle",n),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const n=t._getLinearGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fillRadialGradient(t){const n=t._getRadialGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fill(t){const n=t.fill(),i=t.getFillPriority();if(n&&i==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&i==="pattern"){this._fillPattern(t);return}const l=t.getFillLinearGradientColorStops();if(l&&i==="linear-gradient"){this._fillLinearGradient(t);return}const f=t.getFillRadialGradientColorStops();if(f&&i==="radial-gradient"){this._fillRadialGradient(t);return}n?this._fillColor(t):r?this._fillPattern(t):l?this._fillLinearGradient(t):f&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const n=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),l=this.createLinearGradient(n.x,n.y,i.x,i.y);if(r){for(let f=0;f<r.length;f+=2)l.addColorStop(r[f],r[f+1]);this.setAttr("strokeStyle",l)}}_stroke(t){const n=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t),n&&t.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var n,i,r;const l=(n=t.getShadowRGBA())!==null&&n!==void 0?n:"black",f=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,d=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},g=t.getAbsoluteScale(),m=this.canvas.getPixelRatio(),_=g.x*m,C=g.y*m;this.setAttr("shadowColor",l),this.setAttr("shadowBlur",f*Math.min(Math.abs(_),Math.abs(C))),this.setAttr("shadowOffsetX",d.x*_),this.setAttr("shadowOffsetY",d.y*C)}}class wb extends Cg{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const n=t.getStrokeScaleEnabled();if(!n){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t);const i=t.hitStrokeWidth(),r=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),n||this.restore()}}}let k0;function xb(){if(k0)return k0;const o=pt.createCanvasElement(),t=o.getContext("2d");return k0=(function(){const n=kt._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i})(),pt.releaseCanvas(o),k0}class Xm{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const i=(t||{}).pixelRatio||kt.pixelRatio||xb();this.pixelRatio=i,this._canvas=pt.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const n=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,n){this.setWidth(t||0),this.setHeight(n||0)}toDataURL(t,n){try{return this._canvas.toDataURL(t,n)}catch{try{return this._canvas.toDataURL()}catch(r){return pt.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class eo extends Xm{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new Rb(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function A1(){const o=pt.createCanvasElement();o.width=1,o.height=1;const t=o.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data;return!(n[0]===255&&n[1]===0&&n[2]===255&&n[3]===255)}function O1(){var o,t;return typeof navigator>"u"?!1:(t=(o=navigator.brave)===null||o===void 0?void 0:o.isBrave())!==null&&t!==void 0?t:!1}let R1=!1;function Mb(){return O1()&&A1()&&!R1&&(R1=!0,pt.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),O1()&&A1()}class Fm extends Xm{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new wb(this),this.setSize(t.width,t.height),Mb()}}const Fe={get isDragging(){let o=!1;return Fe._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(o=!0)}),o},justDragged:!1,get node(){let o;return Fe._dragElements.forEach(t=>{o=t.node}),o},_dragElements:new Map,_drag(o){const t=[];Fe._dragElements.forEach((n,i)=>{const{node:r}=n,l=r.getStage();l.setPointersPositions(o),n.pointerId===void 0&&(n.pointerId=pt._getFirstPointerId(o));const f=l._changedPointerPositions.find(d=>d.id===n.pointerId);if(f){if(n.dragStatus!=="dragging"){const d=r.dragDistance();if(Math.max(Math.abs(f.x-n.startPointerPos.x),Math.abs(f.y-n.startPointerPos.y))<d||(r.startDrag({evt:o}),!r.isDragging()))return}r._setDragPosition(o,n),t.push(r)}}),t.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:o},!0)})},_endDragBefore(o){const t=[];Fe._dragElements.forEach(n=>{const{node:i}=n,r=i.getStage();if(o&&r.setPointersPositions(o),!r._changedPointerPositions.find(d=>d.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(Fe.justDragged=!0,kt._mouseListenClick=!1,kt._touchListenClick=!1,kt._pointerListenClick=!1,n.dragStatus="stopped");const f=n.node.getLayer()||n.node instanceof kt.Stage&&n.node;f&&t.indexOf(f)===-1&&t.push(f)}),t.forEach(n=>{n.draw()})},_endDragAfter(o){Fe._dragElements.forEach((t,n)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:o},!0),t.dragStatus!=="dragging"&&Fe._dragElements.delete(n)})}};kt.isBrowser&&(window.addEventListener("mouseup",Fe._endDragBefore,!0),window.addEventListener("touchend",Fe._endDragBefore,!0),window.addEventListener("touchcancel",Fe._endDragBefore,!0),window.addEventListener("mousemove",Fe._drag),window.addEventListener("touchmove",Fe._drag),window.addEventListener("mouseup",Fe._endDragAfter,!1),window.addEventListener("touchend",Fe._endDragAfter,!1),window.addEventListener("touchcancel",Fe._endDragAfter,!1));function ao(o){return pt._isString(o)?'"'+o+'"':Object.prototype.toString.call(o)==="[object Number]"||pt._isBoolean(o)?o:Object.prototype.toString.call(o)}function A2(o){return o>255?255:o<0?0:Math.round(o)}function Ht(){if(kt.isUnminified)return function(o,t){return pt._isNumber(o)||pt.warn(ao(o)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),o}}function Tg(o){if(kt.isUnminified)return function(t,n){let i=pt._isNumber(t),r=pt._isArray(t)&&t.length==o;return!i&&!r&&pt.warn(ao(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+o+")"),t}}function Jm(){if(kt.isUnminified)return function(o,t){return pt._isNumber(o)||o==="auto"||pt.warn(ao(o)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),o}}function fu(){if(kt.isUnminified)return function(o,t){return pt._isString(o)||pt.warn(ao(o)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),o}}function O2(){if(kt.isUnminified)return function(o,t){const n=pt._isString(o),i=Object.prototype.toString.call(o)==="[object CanvasGradient]"||o&&o.addColorStop;return n||i||pt.warn(ao(o)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),o}}function Nb(){if(kt.isUnminified)return function(o,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&o instanceof n||(pt._isArray(o)?o.forEach(function(i){pt._isNumber(i)||pt.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):pt.warn(ao(o)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),o}}function Nr(){if(kt.isUnminified)return function(o,t){return o===!0||o===!1||pt.warn(ao(o)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),o}}function Db(o){if(kt.isUnminified)return function(t,n){return t==null||pt.isObject(t)||pt.warn(ao(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+o),t}}const qh="get",Vh="set",st={addGetterSetter(o,t,n,i,r){st.addGetter(o,t,n),st.addSetter(o,t,i,r),st.addOverloadedGetterSetter(o,t)},addGetter(o,t,n){const i=qh+pt._capitalize(t);o.prototype[i]=o.prototype[i]||function(){const r=this.attrs[t];return r===void 0?n:r}},addSetter(o,t,n,i){const r=Vh+pt._capitalize(t);o.prototype[r]||st.overWriteSetter(o,t,n,i)},overWriteSetter(o,t,n,i){const r=Vh+pt._capitalize(t);o.prototype[r]=function(l){return n&&l!==void 0&&l!==null&&(l=n.call(this,l,t)),this._setAttr(t,l),i&&i.call(this),this}},addComponentsGetterSetter(o,t,n,i,r){const l=n.length,f=pt._capitalize,d=qh+f(t),g=Vh+f(t);o.prototype[d]=function(){const _={};for(let C=0;C<l;C++){const E=n[C];_[E]=this.getAttr(t+f(E))}return _};const m=Db(n);o.prototype[g]=function(_){const C=this.attrs[t];i&&(_=i.call(this,_,t)),m&&m.call(this,_,t);for(const E in _)_.hasOwnProperty(E)&&this._setAttr(t+f(E),_[E]);return _||n.forEach(E=>{this._setAttr(t+f(E),void 0)}),this._fireChangeEvent(t,C,_),r&&r.call(this),this},st.addOverloadedGetterSetter(o,t)},addOverloadedGetterSetter(o,t){const n=pt._capitalize(t),i=Vh+n,r=qh+n;o.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(o,t,n,i){pt.error("Adding deprecated "+t);const r=qh+pt._capitalize(t),l=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[r]=function(){pt.error(l);const f=this.attrs[t];return f===void 0?n:f},st.addSetter(o,t,i,function(){pt.error(l)}),st.addOverloadedGetterSetter(o,t)},backCompat(o,t){pt.each(t,function(n,i){const r=o.prototype[i],l=qh+pt._capitalize(n),f=Vh+pt._capitalize(n);function d(){r.apply(this,arguments),pt.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}o.prototype[n]=d,o.prototype[l]=d,o.prototype[f]=d})},afterSetFilter(){this._filterUpToDate=!1}};function jb(o){const t=/(\w+)\(([^)]+)\)/g;let n;for(;(n=t.exec(o))!==null;){const[,i,r]=n;switch(i){case"blur":{const l=parseFloat(r.replace("px",""));return function(f){this.blurRadius(l*.5);const d=kt.Filters;d&&d.Blur&&d.Blur.call(this,f)}}case"brightness":{const l=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(f){this.brightness(l);const d=kt.Filters;d&&d.Brightness&&d.Brightness.call(this,f)}}case"contrast":{const l=parseFloat(r);return function(f){const d=100*(Math.sqrt(l)-1);this.contrast(d);const g=kt.Filters;g&&g.Contrast&&g.Contrast.call(this,f)}}case"grayscale":return function(l){const f=kt.Filters;f&&f.Grayscale&&f.Grayscale.call(this,l)};case"sepia":return function(l){const f=kt.Filters;f&&f.Sepia&&f.Sepia.call(this,l)};case"invert":return function(l){const f=kt.Filters;f&&f.Invert&&f.Invert.call(this,l)};default:pt.warn(`CSS filter "${i}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const cg="absoluteOpacity",q0="allEventListeners",al="absoluteTransform",w1="absoluteScale",nu="canvas",Ub="Change",Bb="children",zb="konva",_m="listening",Lb="mouseenter",Gb="mouseleave",Hb="pointerenter",Pb="pointerleave",Ib="touchenter",kb="touchleave",x1="set",M1="Shape",fg=" ",N1="stage",Wl="transform",qb="Stage",Em="visible",Vb=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(fg);let Yb=1;class Lt{constructor(t){this._id=Yb++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===Wl||t===al)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,n){let i=this._cache.get(t);return(i===void 0||(t===Wl||t===al)&&i.dirty===!0)&&(i=n.call(this),this._cache.set(t,i)),i}_calculate(t,n,i){if(!this._attachedDepsListeners.get(t)){const r=n.map(l=>l+"Change.konva").join(fg);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(nu)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===al&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(nu)){const{scene:t,filter:n,hit:i,buffer:r}=this._cache.get(nu);pt.releaseCanvas(t,n,i,r),this._cache.delete(nu)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const n=t||{};let i={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(n.width||i.width),l=Math.ceil(n.height||i.height),f=n.pixelRatio,d=n.x===void 0?Math.floor(i.x):n.x,g=n.y===void 0?Math.floor(i.y):n.y,m=n.offset||0,_=n.drawBorder||!1,C=n.hitCanvasPixelRatio||1;if(!r||!l){pt.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const E=Math.abs(Math.round(i.x)-d)>.5?1:0,R=Math.abs(Math.round(i.y)-g)>.5?1:0;r+=m*2+E,l+=m*2+R,d-=m,g-=m;const v=new eo({pixelRatio:f,width:r,height:l}),D=new eo({pixelRatio:f,width:0,height:0,willReadFrequently:!0}),z=new Fm({pixelRatio:C,width:r,height:l}),G=v.getContext(),N=z.getContext(),M=new eo({width:v.width/v.pixelRatio+Math.abs(d),height:v.height/v.pixelRatio+Math.abs(g),pixelRatio:v.pixelRatio}),L=M.getContext();return z.isCache=!0,v.isCache=!0,this._cache.delete(nu),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,D.getContext()._context.imageSmoothingEnabled=!1),G.save(),N.save(),L.save(),G.translate(-d,-g),N.translate(-d,-g),L.translate(-d,-g),M.x=d,M.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(cg),this._clearSelfAndDescendantCache(w1),this.drawScene(v,this,M),this.drawHit(z,this),this._isUnderCache=!1,G.restore(),N.restore(),_&&(G.save(),G.beginPath(),G.rect(0,0,r,l),G.closePath(),G.setAttr("strokeStyle","red"),G.setAttr("lineWidth",5),G.stroke(),G.restore()),this._cache.set(nu,{scene:v,filter:D,hit:z,buffer:M,x:d,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(nu)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,n){const i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,l=1/0,f=-1/0,d=-1/0;const g=this.getAbsoluteTransform(n);return i.forEach(function(m){const _=g.point(m);r===void 0&&(r=f=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),f=Math.max(f,_.x),d=Math.max(d,_.y)}),{x:r,y:l,width:f-r,height:d-l}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();t.translate(n.x,n.y);const i=this._getCachedSceneCanvas(),r=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/r,i.height/r),t.restore()}_drawCachedHitCanvas(t){const n=this._getCanvasCache(),i=n.hit;t.save(),t.translate(n.x,n.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),n=this._getCanvasCache(),i=n.scene,r=n.filter,l=r.getContext(),f,d,g,m;if(!t||t.length===0)return i;if(this._filterUpToDate)return r;let _=!0;for(let E=0;E<t.length;E++)if(typeof t[E]=="string"&&T1(),typeof t[E]!="string"||!T1()){_=!1;break}const C=i.pixelRatio;if(r.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio),_){const E=t.join(" ");return l.save(),l.setAttr("filter",E),l.drawImage(i._canvas,0,0,i.getWidth()/C,i.getHeight()/C),l.restore(),this._filterUpToDate=!0,r}try{for(f=t.length,l.clear(),l.drawImage(i._canvas,0,0,i.getWidth()/C,i.getHeight()/C),d=l.getImageData(0,0,r.getWidth(),r.getHeight()),g=0;g<f;g++)m=t[g],typeof m=="string"&&(m=jb(m)),m.call(this,d),l.putImageData(d,0,0)}catch(E){pt.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,n){if(this._cache&&this._cache.delete(q0),arguments.length===3)return this._delegate.apply(this,arguments);const i=t.split(fg);for(let r=0;r<i.length;r++){const f=i[r].split("."),d=f[0],g=f[1]||"";this.eventListeners[d]||(this.eventListeners[d]=[]),this.eventListeners[d].push({name:g,handler:n})}return this}off(t,n){let i=(t||"").split(fg),r=i.length,l,f,d,g,m,_;if(this._cache&&this._cache.delete(q0),!t)for(f in this.eventListeners)this._off(f);for(l=0;l<r;l++)if(d=i[l],g=d.split("."),m=g[0],_=g[1],m)this.eventListeners[m]&&this._off(m,_,n);else for(f in this.eventListeners)this._off(f,_,n);return this}dispatchEvent(t){const n={target:this,type:t.type,evt:t};return this.fire(t.type,n),this}addEventListener(t,n){return this.on(t,function(i){n.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,n,i){const r=this;this.on(t,function(l){const f=l.target.findAncestors(n,!0,r);for(let d=0;d<f.length;d++)l=pt.cloneObject(l),l.currentTarget=f[d],i.call(f[d],l)})}remove(){return this.isDragging()&&this.stopDrag(),Fe._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(al),this._clearSelfAndDescendantCache(cg),this._clearSelfAndDescendantCache(w1),this._clearSelfAndDescendantCache(N1),this._clearSelfAndDescendantCache(Em),this._clearSelfAndDescendantCache(_m)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const n="get"+pt._capitalize(t);return pt._isFunction(this[n])?this[n]():this.attrs[t]}getAncestors(){let t=this.getParent(),n=[];for(;t;)n.push(t),t=t.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let n,i;if(!t)return this;for(n in t)n!==Bb&&(i=x1+pt._capitalize(n),pt._isFunction(this[i])?this[i](t[n]):this._setAttr(n,t[n]))}),this}isListening(){return this._getCache(_m,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(Em,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,n=!1){if(t)return this._isVisible(t)&&this._isListening(t);const i=this.getLayer();let r=!1;Fe._dragElements.forEach(f=>{f.dragStatus==="dragging"&&(f.node.nodeType==="Stage"||f.node.getLayer()===i)&&(r=!0)});const l=!n&&!kt.hitOnDragEnabled&&(r||kt.isTransforming());return this.isListening()&&this.isVisible()&&!l}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),n=this,i=0,r,l,f,d;function g(_){for(r=[],l=_.length,f=0;f<l;f++)d=_[f],i++,d.nodeType!==M1&&(r=r.concat(d.getChildren().slice())),d._id===n._id&&(f=l);r.length>0&&r[0].getDepth()<=t&&g(r)}const m=this.getStage();return n.nodeType!==qb&&m&&g(m.getChildren()),i}getDepth(){let t=0,n=this.parent;for(;n;)t++,n=n.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Wl),this._clearSelfAndDescendantCache(al)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const n=t.getPointerPosition();if(!n)return null;const i=this.getAbsoluteTransform().copy();return i.invert(),i.point(n)}getAbsolutePosition(t){let n=!1,i=this.parent;for(;i;){if(i.isCached()){n=!0;break}i=i.parent}n&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),l=new Ta,f=this.offset();return l.m=r.slice(),l.translate(f.x,f.y),l.getTranslation()}setAbsolutePosition(t){const{x:n,y:i,...r}=this._clearTransform();this.attrs.x=n,this.attrs.y=i,this._clearCache(Wl);const l=this._getAbsoluteTransform().copy();return l.invert(),l.translate(t.x,t.y),t={x:this.attrs.x+l.getTranslation().x,y:this.attrs.y+l.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(Wl),this._clearSelfAndDescendantCache(al),this}_setTransform(t){let n;for(n in t)this.attrs[n]=t[n]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let n=t.x,i=t.y,r=this.x(),l=this.y();return n!==void 0&&(r+=n),i!==void 0&&(l+=i),this.setPosition({x:r,y:l}),this}_eachAncestorReverse(t,n){let i=[],r=this.getParent(),l,f;if(!(n&&n._id===this._id)){for(i.unshift(this);r&&(!n||r._id!==n._id);)i.unshift(r),r=r.parent;for(l=i.length,f=0;f<l;f++)t(i[f])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return pt.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return pt.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return pt.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return pt.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return pt.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&pt.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(cg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(t*=n.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),n,i,r,l,f;const d={attrs:{},className:this.getClassName()};for(n in t)i=t[n],f=pt.isObject(i)&&!pt._isPlainObject(i)&&!pt._isArray(i),!f&&(r=typeof this[n]=="function"&&this[n],delete t[n],l=r?r.call(this):null,t[n]=i,l!==i&&(d.attrs[n]=i));return pt._prepareToStringify(d)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,n,i){const r=[];n&&this._isMatch(t)&&r.push(this);let l=this.parent;for(;l;){if(l===i)return r;l._isMatch(t)&&r.push(l),l=l.parent}return r}isAncestorOf(t){return!1}findAncestor(t,n,i){return this.findAncestors(t,n,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let n=t.replace(/ /g,"").split(","),i=n.length,r,l;for(r=0;r<i;r++)if(l=n[r],pt.isValidSelector(l)||(pt.warn('Selector "'+l+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),pt.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),pt.warn("Konva is awesome, right?")),l.charAt(0)==="#"){if(this.id()===l.slice(1))return!0}else if(l.charAt(0)==="."){if(this.hasName(l.slice(1)))return!0}else if(this.className===l||this.nodeType===l)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(N1,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,n={},i){return n.target=n.target||this,i?this._fireAndBubble(t,n):this._fire(t,n),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(al,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let n;if(t)return n=new Ta,this._eachAncestorReverse(function(i){const r=i.transformsEnabled();r==="all"?n.multiply(i.getTransform()):r==="position"&&n.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},t),n;{n=this._cache.get(al)||new Ta,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const i=this.transformsEnabled();if(i==="all")n.multiply(this.getTransform());else if(i==="position"){const r=this.attrs.x||0,l=this.attrs.y||0,f=this.attrs.offsetX||0,d=this.attrs.offsetY||0;n.translate(r-f,l-d)}return n.dirty=!1,n}}getAbsoluteScale(t){let n=this;for(;n;)n._isUnderCache&&(t=n),n=n.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Wl,this._getTransform)}_getTransform(){var t,n;const i=this._cache.get(Wl)||new Ta;i.reset();const r=this.x(),l=this.y(),f=kt.getAngle(this.rotation()),d=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,_=this.attrs.skewY||0,C=this.attrs.offsetX||0,E=this.attrs.offsetY||0;return(r!==0||l!==0)&&i.translate(r,l),f!==0&&i.rotate(f),(m!==0||_!==0)&&i.skew(m,_),(d!==1||g!==1)&&i.scale(d,g),(C!==0||E!==0)&&i.translate(-1*C,-1*E),i.dirty=!1,i}clone(t){let n=pt.cloneObject(this.attrs),i,r,l,f,d;for(i in t)n[i]=t[i];const g=new this.constructor(n);for(i in this.eventListeners)for(r=this.eventListeners[i],l=r.length,f=0;f<l;f++)d=r[f],d.name.indexOf(zb)<0&&(g.eventListeners[i]||(g.eventListeners[i]=[]),g.eventListeners[i].push(d));return g}_toKonvaCanvas(t){t=t||{};const n=this.getClientRect(),i=this.getStage(),r=t.x!==void 0?t.x:Math.floor(n.x),l=t.y!==void 0?t.y:Math.floor(n.y),f=t.pixelRatio||1,d=new eo({width:t.width||Math.ceil(n.width)||(i?i.width():0),height:t.height||Math.ceil(n.height)||(i?i.height():0),pixelRatio:f}),g=d.getContext(),m=new eo({width:d.width/d.pixelRatio+Math.abs(r),height:d.height/d.pixelRatio+Math.abs(l),pixelRatio:d.pixelRatio});return t.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(r||l)&&g.translate(-1*r,-1*l),this.drawScene(d,void 0,m),g.restore(),d}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const n=t.mimeType||null,i=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(n,i);return t.callback&&t.callback(r),r}toImage(t){return new Promise((n,i)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,pt._urlToImage(this.toDataURL(t),function(l){n(l),r==null||r(l)})}catch(r){i(r)}})}toBlob(t){return new Promise((n,i)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(l=>{n(l),r==null||r(l)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(r){i(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():kt.dragDistance}_off(t,n,i){let r=this.eventListeners[t],l,f,d;for(l=0;l<r.length;l++)if(f=r[l].name,d=r[l].handler,(f!=="konva"||n==="konva")&&(!n||f===n)&&(!i||i===d)){if(r.splice(l,1),r.length===0){delete this.eventListeners[t];break}l--}}_fireChangeEvent(t,n,i){this._fire(t+Ub,{oldVal:n,newVal:i})}addName(t){if(!this.hasName(t)){const n=this.name(),i=n?n+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const n=(this.name()||"").split(/\s/g),i=n.indexOf(t);return i!==-1&&(n.splice(i,1),this.name(n.join(" "))),this}setAttr(t,n){const i=this[x1+pt._capitalize(t)];return pt._isFunction(i)?i.call(this,n):this._setAttr(t,n),this}_requestDraw(){if(kt.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,n){const i=this.attrs[t];i===n&&!pt.isObject(n)||(n==null?delete this.attrs[t]:this.attrs[t]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,n),this._requestDraw())}_setComponentAttr(t,n,i){let r;i!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][n]=i,this._fireChangeEvent(t,r,i))}_fireAndBubble(t,n,i){n&&this.nodeType===M1&&(n.target=this);const r=[Lb,Gb,Hb,Pb,Ib,kb];if(!(r.indexOf(t)!==-1&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i))){this._fire(t,n);const f=r.indexOf(t)!==-1&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!f&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,n,i):this._fireAndBubble.call(this.parent,t,n))}}_getProtoListeners(t){var n,i,r;const l=(n=this._cache.get(q0))!==null&&n!==void 0?n:{};let f=l==null?void 0:l[t];if(f===void 0){f=[];let d=Object.getPrototypeOf(this);for(;d;){const g=(r=(i=d.eventListeners)===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:[];f.push(...g),d=Object.getPrototypeOf(d)}l[t]=f,this._cache.set(q0,l)}return f}_fire(t,n){n=n||{},n.currentTarget=this,n.type=t;const i=this._getProtoListeners(t);if(i)for(let l=0;l<i.length;l++)i[l].handler.call(this,n);const r=this.eventListeners[t];if(r)for(let l=0;l<r.length;l++)r[l].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const n=t?t.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition();if(!i)return;const l=i._getPointerById(n)||i._changedPointerPositions[0]||r;Fe._dragElements.set(this._id,{node:this,startPointerPos:l,offset:{x:l.x-r.x,y:l.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(t,n=!0){Fe._dragElements.has(this._id)||this._createDragElement(t);const i=Fe._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},n)}_setDragPosition(t,n){const i=this.getStage()._getPointerById(n.pointerId);if(!i)return;let r={x:i.x-n.offset.x,y:i.y-n.offset.y};const l=this.dragBoundFunc();if(l!==void 0){const f=l.call(this,r,t);f?r=f:pt.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const n=Fe._dragElements.get(this._id);n&&(n.dragStatus="stopped"),Fe._endDragBefore(t),Fe._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=Fe._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||kt.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;Fe._dragElements.forEach(l=>{this.isAncestorOf(l.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=Fe._dragElements.get(this._id),i=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";i?this.stopDrag():r&&Fe._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const n=this.getStage();if(!n)return!1;const i={x:-t.x,y:-t.y,width:n.width()+2*t.x,height:n.height()+2*t.y};return pt.haveIntersection(i,this.getClientRect())}static create(t,n){return pt._isString(t)&&(t=JSON.parse(t)),this._createNode(t,n)}static _createNode(t,n){let i=Lt.prototype.getClassName.call(t),r=t.children,l,f,d;n&&(t.attrs.container=n),kt[i]||(pt.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const g=kt[i];if(l=new g(t.attrs),r)for(f=r.length,d=0;d<f;d++)l.add(Lt._createNode(r[d]));return l}}Lt.prototype.nodeType="Node";Lt.prototype._attrsAffectingSize=[];Lt.prototype.eventListeners={};Lt.prototype.on.call(Lt.prototype,Vb,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Wl),this._clearSelfAndDescendantCache(al)});Lt.prototype.on.call(Lt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Em)});Lt.prototype.on.call(Lt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(_m)});Lt.prototype.on.call(Lt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(cg)});const hn=st.addGetterSetter;hn(Lt,"zIndex");hn(Lt,"absolutePosition");hn(Lt,"position");hn(Lt,"x",0,Ht());hn(Lt,"y",0,Ht());hn(Lt,"globalCompositeOperation","source-over",fu());hn(Lt,"opacity",1,Ht());hn(Lt,"name","",fu());hn(Lt,"id","",fu());hn(Lt,"rotation",0,Ht());st.addComponentsGetterSetter(Lt,"scale",["x","y"]);hn(Lt,"scaleX",1,Ht());hn(Lt,"scaleY",1,Ht());st.addComponentsGetterSetter(Lt,"skew",["x","y"]);hn(Lt,"skewX",0,Ht());hn(Lt,"skewY",0,Ht());st.addComponentsGetterSetter(Lt,"offset",["x","y"]);hn(Lt,"offsetX",0,Ht());hn(Lt,"offsetY",0,Ht());hn(Lt,"dragDistance",void 0,Ht());hn(Lt,"width",0,Ht());hn(Lt,"height",0,Ht());hn(Lt,"listening",!0,Nr());hn(Lt,"preventDefault",!0,Nr());hn(Lt,"filters",void 0,function(o){return this._filterUpToDate=!1,o});hn(Lt,"visible",!0,Nr());hn(Lt,"transformsEnabled","all",fu());hn(Lt,"size");hn(Lt,"dragBoundFunc");hn(Lt,"draggable",!1,Nr());st.backCompat(Lt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Ra extends Lt{constructor(){super(...arguments),this.children=[]}getChildren(t){const n=this.children||[];return t?n.filter(t):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let i=0;i<t.length;i++)this.add(t[i]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const n=this._generalFind(t,!0);return n.length>0?n[0]:void 0}_generalFind(t,n){const i=[];return this._descendants(r=>{const l=r._isMatch(t);return l&&i.push(r),!!(l&&n)}),i}_descendants(t){let n=!1;const i=this.getChildren();for(const r of i){if(n=t(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(t),n))return!0}return!1}toObject(){const t=Lt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(n=>{t.children.push(n.toObject())}),t}isAncestorOf(t){let n=t.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(t){const n=Lt.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){n.add(i.clone())}),n}getAllIntersections(t){const n=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&n.push(i)}),n}_clearSelfAndDescendantCache(t){var n;super._clearSelfAndDescendantCache(t),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(n,i){n.index=i}),this._requestDraw()}drawScene(t,n,i){const r=this.getLayer(),l=t||r&&r.getCanvas(),f=l&&l.getContext(),d=this._getCanvasCache(),g=d&&d.scene,m=l&&l.isCache;if(!this.isVisible()&&!m)return this;if(g){f.save();const _=this.getAbsoluteTransform(n).getMatrix();f.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",l,n,i);return this}drawHit(t,n){if(!this.shouldDrawHit(n))return this;const i=this.getLayer(),r=t||i&&i.hitCanvas,l=r&&r.getContext(),f=this._getCanvasCache();if(f&&f.hit){l.save();const g=this.getAbsoluteTransform(n).getMatrix();l.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(l),l.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(t,n,i,r){var l;const f=n&&n.getContext(),d=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),_=typeof d=="number"&&typeof g=="number"||m,C=i===this;if(_){f.save();const R=this.getAbsoluteTransform(i);let v=R.getMatrix();f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),f.beginPath();let D;if(m)D=m.call(this,f,this);else{const z=this.clipX(),G=this.clipY();f.rect(z||0,G||0,d,g)}f.clip.apply(f,D),v=R.copy().invert().getMatrix(),f.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const E=!C&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(f.save(),f._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(R){R[t](n,i,r)}),E&&f.restore(),_&&f.restore()}getClientRect(t={}){var n;const i=t.skipTransform,r=t.relativeTo;let l,f,d,g,m={x:1/0,y:1/0,width:0,height:0};const _=this;(n=this.children)===null||n===void 0||n.forEach(function(R){if(!R.visible())return;const v=R.getClientRect({relativeTo:_,skipShadow:t.skipShadow,skipStroke:t.skipStroke});v.width===0&&v.height===0||(l===void 0?(l=v.x,f=v.y,d=v.x+v.width,g=v.y+v.height):(l=Math.min(l,v.x),f=Math.min(f,v.y),d=Math.max(d,v.x+v.width),g=Math.max(g,v.y+v.height)))});const C=this.find("Shape");let E=!1;for(let R=0;R<C.length;R++)if(C[R]._isVisible(this)){E=!0;break}return E&&l!==void 0?m={x:l,y:f,width:d-l,height:g-f}:m={x:0,y:0,width:0,height:0},i?m:this._transformedRect(m,r)}}st.addComponentsGetterSetter(Ra,"clip",["x","y","width","height"]);st.addGetterSetter(Ra,"clipX",void 0,Ht());st.addGetterSetter(Ra,"clipY",void 0,Ht());st.addGetterSetter(Ra,"clipWidth",void 0,Ht());st.addGetterSetter(Ra,"clipHeight",void 0,Ht());st.addGetterSetter(Ra,"clipFunc");const od=new Map,R2=kt._global.PointerEvent!==void 0;function _p(o){return od.get(o)}function Zm(o){return{evt:o,pointerId:o.pointerId}}function w2(o,t){return od.get(o)===t}function x2(o,t){$h(o),t.getStage()&&(od.set(o,t),R2&&t._fire("gotpointercapture",Zm(new PointerEvent("gotpointercapture"))))}function $h(o,t){const n=od.get(o);if(!n)return;const i=n.getStage();i&&i.content,od.delete(o),R2&&n._fire("lostpointercapture",Zm(new PointerEvent("lostpointercapture")))}const Kb="Stage",Qb="string",D1="px",Xb="mouseout",M2="mouseleave",N2="mouseover",D2="mouseenter",j2="mousemove",U2="mousedown",B2="mouseup",Qh="pointermove",Xh="pointerdown",nf="pointerup",Fh="pointercancel",Fb="lostpointercapture",V0="pointerout",Jh="pointerleave",Y0="pointerover",K0="pointerenter",Cm="contextmenu",z2="touchstart",L2="touchend",G2="touchmove",H2="touchcancel",Tm="wheel",Jb=5,Zb=[[D2,"_pointerenter"],[U2,"_pointerdown"],[j2,"_pointermove"],[B2,"_pointerup"],[M2,"_pointerleave"],[z2,"_pointerdown"],[G2,"_pointermove"],[L2,"_pointerup"],[H2,"_pointercancel"],[N2,"_pointerover"],[Tm,"_wheel"],[Cm,"_contextmenu"],[Xh,"_pointerdown"],[Qh,"_pointermove"],[nf,"_pointerup"],[Fh,"_pointercancel"],[Jh,"_pointerleave"],[Fb,"_lostpointercapture"]],Ep={mouse:{[V0]:Xb,[Jh]:M2,[Y0]:N2,[K0]:D2,[Qh]:j2,[Xh]:U2,[nf]:B2,[Fh]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[V0]:"touchout",[Jh]:"touchleave",[Y0]:"touchover",[K0]:"touchenter",[Qh]:G2,[Xh]:z2,[nf]:L2,[Fh]:H2,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[V0]:V0,[Jh]:Jh,[Y0]:Y0,[K0]:K0,[Qh]:Qh,[Xh]:Xh,[nf]:nf,[Fh]:Fh,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Zh=o=>o.indexOf("pointer")>=0?"pointer":o.indexOf("touch")>=0?"touch":"mouse",kc=o=>{const t=Zh(o);if(t==="pointer")return kt.pointerEventsEnabled&&Ep.pointer;if(t==="touch")return Ep.touch;if(t==="mouse")return Ep.mouse};function j1(o={}){return(o.clipFunc||o.clipWidth||o.clipHeight)&&pt.warn("Stage does not support clipping. Please use clip for Layers or Groups."),o}const Wb="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",td=[];let Ag=class extends Ra{constructor(t){super(j1(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),td.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{j1(this.attrs)}),this._checkVisibility()}_validateAdd(t){const n=t.getType()==="Layer",i=t.getType()==="FastLayer";n||i||pt.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===Qb){let n;if(t.charAt(0)==="."){const i=t.slice(1);t=document.getElementsByClassName(i)[0]}else t.charAt(0)!=="#"?n=t:n=t.slice(1),t=document.getElementById(n);if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,n=t.length;for(let i=0;i<n;i++)t[i].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),Ra.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&pt._isInDocument(t)&&this.container().removeChild(t);const n=td.indexOf(this);return n>-1&&td.splice(n,1),pt.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(pt.warn(Wb),null)}_getPointerById(t){return this._pointerPositions.find(n=>n.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const n=new eo({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=n.getContext()._context,r=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),r.forEach(function(l){if(!l.isVisible())return;const f=l._toKonvaCanvas(t);i.drawImage(f._canvas,t.x,t.y,f.getWidth()/f.getPixelRatio(),f.getHeight()/f.getPixelRatio())}),n}getIntersection(t){if(!t)return null;const n=this.children,i=n.length,r=i-1;for(let l=r;l>=0;l--){const f=n[l].getIntersection(t);if(f)return f}return null}_resizeDOM(){const t=this.width(),n=this.height();this.content&&(this.content.style.width=t+D1,this.content.style.height=n+D1),this.bufferCanvas.setSize(t,n),this.bufferHitCanvas.setSize(t,n),this.children.forEach(i=>{i.setSize({width:t,height:n}),i.draw()})}add(t,...n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const i=this.children.length;return i>Jb&&pt.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),kt.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return w2(t,this)}setPointerCapture(t){x2(t,this)}releaseCapture(t){$h(t)}getLayers(){return this.children}_bindContentEvents(){kt.isBrowser&&Zb.forEach(([t,n])=>{this.content.addEventListener(t,i=>{this[n](i)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const n=kc(t.type);n&&this._fire(n.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const n=kc(t.type);n&&this._fire(n.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let n=this[t+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(t){const n=kc(t.type),i=Zh(t.type);if(!n)return;this.setPointersPositions(t);const r=this._getTargetShape(i),l=!(kt.isDragging()||kt.isTransforming())||kt.hitOnDragEnabled;r&&l?(r._fireAndBubble(n.pointerout,{evt:t}),r._fireAndBubble(n.pointerleave,{evt:t}),this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):l&&(this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const n=kc(t.type),i=Zh(t.type);if(!n)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(l=>{const f=this.getIntersection(l);if(Fe.justDragged=!1,kt["_"+i+"ListenClick"]=!0,!f||!f.isListening()){this[i+"ClickStartShape"]=void 0;return}kt.capturePointerEventsEnabled&&f.setPointerCapture(l.id),this[i+"ClickStartShape"]=f,f._fireAndBubble(n.pointerdown,{evt:t,pointerId:l.id}),r=!0;const d=t.type.indexOf("touch")>=0;f.preventDefault()&&t.cancelable&&d&&t.preventDefault()}),r||this._fire(n.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const n=kc(t.type),i=Zh(t.type);if(!n)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(kt.isDragging()&&Fe.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(kt.isDragging()||kt.isTransforming())||kt.hitOnDragEnabled))return;const f={};let d=!1;const g=this._getTargetShape(i);this._changedPointerPositions.forEach(m=>{const _=_p(m.id)||this.getIntersection(m),C=m.id,E={evt:t,pointerId:C},R=g!==_;if(R&&g&&(g._fireAndBubble(n.pointerout,{...E},_),g._fireAndBubble(n.pointerleave,{...E},_)),_){if(f[_._id])return;f[_._id]=!0}_&&_.isListening()?(d=!0,R&&(_._fireAndBubble(n.pointerover,{...E},g),_._fireAndBubble(n.pointerenter,{...E},g),this[i+"targetShape"]=_),_._fireAndBubble(n.pointermove,{...E})):g&&(this._fire(n.pointerover,{evt:t,target:this,currentTarget:this,pointerId:C}),this[i+"targetShape"]=null)}),d||this._fire(n.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const n=kc(t.type),i=Zh(t.type);if(!n)return;this.setPointersPositions(t);const r=this[i+"ClickStartShape"],l=this[i+"ClickEndShape"],f={};let d=!1;this._changedPointerPositions.forEach(g=>{const m=_p(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),f[m._id])return;f[m._id]=!0}const _=g.id,C={evt:t,pointerId:_};let E=!1;kt["_"+i+"InDblClickWindow"]?(E=!0,clearTimeout(this[i+"DblTimeout"])):Fe.justDragged||(kt["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){kt["_"+i+"InDblClickWindow"]=!1},kt.dblClickWindow),m&&m.isListening()?(d=!0,this[i+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...C}),kt["_"+i+"ListenClick"]&&r&&r===m&&(m._fireAndBubble(n.pointerclick,{...C}),E&&l&&l===m&&m._fireAndBubble(n.pointerdblclick,{...C}))):(this[i+"ClickEndShape"]=null,d||(this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),d=!0),kt["_"+i+"ListenClick"]&&this._fire(n.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:_}),E&&this._fire(n.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:_}))}),d||this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),kt["_"+i+"ListenClick"]=!1,t.cancelable&&i!=="touch"&&i!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Cm,{evt:t}):this._fire(Cm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Tm,{evt:t}):this._fire(Tm,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const n=_p(t.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(nf,Zm(t)),$h(t.pointerId)}_lostpointercapture(t){$h(t.pointerId)}setPointersPositions(t){const n=this._getContentPosition();let i=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,l=>{this._pointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,l=>{this._changedPointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})})):(i=(t.clientX-n.left)/n.scaleX,r=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:i,y:r},this._pointerPositions=[{x:i,y:r,id:pt._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:r,id:pt._getFirstPointerId(t)}])}_setPointerPosition(t){pt.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new eo({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Fm({pixelRatio:1,width:this.width(),height:this.height()}),!kt.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return pt.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Ag.prototype.nodeType=Kb;Dn(Ag);st.addGetterSetter(Ag,"container");kt.isBrowser&&document.addEventListener("visibilitychange",()=>{td.forEach(o=>{o.batchDraw()})});const P2="hasShadow",I2="shadowRGBA",k2="patternImage",q2="linearGradient",V2="radialGradient";let Q0;function Cp(){return Q0||(Q0=pt.createCanvasElement().getContext("2d"),Q0)}const ed={};function $b(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function t5(o){o.stroke()}function e5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function n5(o){o.stroke()}function i5(){this._clearCache(P2)}function a5(){this._clearCache(I2)}function r5(){this._clearCache(k2)}function s5(){this._clearCache(q2)}function l5(){this._clearCache(V2)}class Dt extends Lt{constructor(t){super(t);let n;for(;n=pt.getRandomColor(),!(n&&!(n in ed)););this.colorKey=n,ed[n]=this}getContext(){return pt.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return pt.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(P2,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(k2,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Cp().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const i=new Ta;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(kt.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=i.getMatrix(),l=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(l)}return n}}_getLinearGradient(){return this._getCache(q2,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const n=Cp(),i=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),l=n.createLinearGradient(i.x,i.y,r.x,r.y);for(let f=0;f<t.length;f+=2)l.addColorStop(t[f],t[f+1]);return l}}_getRadialGradient(){return this._getCache(V2,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const n=Cp(),i=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),l=n.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let f=0;f<t.length;f+=2)l.addColorStop(t[f],t[f+1]);return l}}getShadowRGBA(){return this._getCache(I2,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=pt.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const n=this.getStage();if(!n)return!1;const i=n.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,void 0,!0),i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return Lt.prototype.destroy.call(this),delete ed[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=t||this.hasFill(),l=this.hasStroke(),f=this.getAbsoluteOpacity()!==1;if(r&&l&&f)return!0;const d=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(r&&l&&d&&g)}setStrokeHitEnabled(t){pt.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let n=!1,i=this.getParent();for(;i;){if(i.isCached()){n=!0;break}i=i.getParent()}const r=t.skipTransform,l=t.relativeTo||n&&this.getStage()||void 0,f=this.getSelfRect(),g=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=f.width+g,_=f.height+g,C=!t.skipShadow&&this.hasShadow(),E=C?this.shadowOffsetX():0,R=C?this.shadowOffsetY():0,v=m+Math.abs(E),D=_+Math.abs(R),z=C&&this.shadowBlur()||0,G=v+z*2,N=D+z*2,M={width:G,height:N,x:-(g/2+z)+Math.min(E,0)+f.x,y:-(g/2+z)+Math.min(R,0)+f.y};return r?M:this._transformedRect(M,l)}drawScene(t,n,i){const r=this.getLayer(),l=t||r.getCanvas(),f=l.getContext(),d=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let _;const C=n===this;if(!this.isVisible()&&!C)return this;if(d){f.save();const E=this.getAbsoluteTransform(n).getMatrix();return f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedSceneCanvas(f),f.restore(),this}if(!g)return this;if(f.save(),this._useBufferCanvas()){_=this.getStage();const E=i||_.bufferCanvas,R=E.getContext();R.clear(),R.save(),R._applyLineJoin(this),R._applyMiterLimit(this);const v=this.getAbsoluteTransform(n).getMatrix();R.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.call(this,R,this),R.restore();const D=E.pixelRatio;m&&f._applyShadow(this),f._applyOpacity(this),f._applyGlobalCompositeOperation(this),f.drawImage(E._canvas,E.x||0,E.y||0,E.width/D,E.height/D)}else{if(f._applyLineJoin(this),f._applyMiterLimit(this),!C){const E=this.getAbsoluteTransform(n).getMatrix();f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),f._applyOpacity(this),f._applyGlobalCompositeOperation(this)}m&&f._applyShadow(this),g.call(this,f,this)}return f.restore(),this}drawHit(t,n,i=!1){if(!this.shouldDrawHit(n,i))return this;const r=this.getLayer(),l=t||r.hitCanvas,f=l&&l.getContext(),d=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||pt.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){f.save();const C=this.getAbsoluteTransform(n).getMatrix();return f.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._drawCachedHitCanvas(f),f.restore(),this}if(!d)return this;if(f.save(),f._applyLineJoin(this),f._applyMiterLimit(this),!(this===n)){const C=this.getAbsoluteTransform(n).getMatrix();f.transform(C[0],C[1],C[2],C[3],C[4],C[5])}return d.call(this,f,this),f.restore(),this}drawHitFromCache(t=0){const n=this._getCanvasCache(),i=this._getCachedSceneCanvas(),r=n.hit,l=r.getContext(),f=r.getWidth(),d=r.getHeight();l.clear(),l.drawImage(i._canvas,0,0,f,d);try{const g=l.getImageData(0,0,f,d),m=g.data,_=m.length,C=pt._hexToRgb(this.colorKey);for(let E=0;E<_;E+=4)m[E+3]>t?(m[E]=C.r,m[E+1]=C.g,m[E+2]=C.b,m[E+3]=255):m[E+3]=0;l.putImageData(g,0,0)}catch(g){pt.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return w2(t,this)}setPointerCapture(t){x2(t,this)}releaseCapture(t){$h(t)}}Dt.prototype._fillFunc=$b;Dt.prototype._strokeFunc=t5;Dt.prototype._fillFuncHit=e5;Dt.prototype._strokeFuncHit=n5;Dt.prototype._centroid=!1;Dt.prototype.nodeType="Shape";Dn(Dt);Dt.prototype.eventListeners={};Dt.prototype.on.call(Dt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",i5);Dt.prototype.on.call(Dt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",a5);Dt.prototype.on.call(Dt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",r5);Dt.prototype.on.call(Dt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",s5);Dt.prototype.on.call(Dt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",l5);st.addGetterSetter(Dt,"stroke",void 0,O2());st.addGetterSetter(Dt,"strokeWidth",2,Ht());st.addGetterSetter(Dt,"fillAfterStrokeEnabled",!1);st.addGetterSetter(Dt,"hitStrokeWidth","auto",Jm());st.addGetterSetter(Dt,"strokeHitEnabled",!0,Nr());st.addGetterSetter(Dt,"perfectDrawEnabled",!0,Nr());st.addGetterSetter(Dt,"shadowForStrokeEnabled",!0,Nr());st.addGetterSetter(Dt,"lineJoin");st.addGetterSetter(Dt,"lineCap");st.addGetterSetter(Dt,"miterLimit");st.addGetterSetter(Dt,"sceneFunc");st.addGetterSetter(Dt,"hitFunc");st.addGetterSetter(Dt,"dash");st.addGetterSetter(Dt,"dashOffset",0,Ht());st.addGetterSetter(Dt,"shadowColor",void 0,fu());st.addGetterSetter(Dt,"shadowBlur",0,Ht());st.addGetterSetter(Dt,"shadowOpacity",1,Ht());st.addComponentsGetterSetter(Dt,"shadowOffset",["x","y"]);st.addGetterSetter(Dt,"shadowOffsetX",0,Ht());st.addGetterSetter(Dt,"shadowOffsetY",0,Ht());st.addGetterSetter(Dt,"fillPatternImage");st.addGetterSetter(Dt,"fill",void 0,O2());st.addGetterSetter(Dt,"fillPatternX",0,Ht());st.addGetterSetter(Dt,"fillPatternY",0,Ht());st.addGetterSetter(Dt,"fillLinearGradientColorStops");st.addGetterSetter(Dt,"strokeLinearGradientColorStops");st.addGetterSetter(Dt,"fillRadialGradientStartRadius",0);st.addGetterSetter(Dt,"fillRadialGradientEndRadius",0);st.addGetterSetter(Dt,"fillRadialGradientColorStops");st.addGetterSetter(Dt,"fillPatternRepeat","repeat");st.addGetterSetter(Dt,"fillEnabled",!0);st.addGetterSetter(Dt,"strokeEnabled",!0);st.addGetterSetter(Dt,"shadowEnabled",!0);st.addGetterSetter(Dt,"dashEnabled",!0);st.addGetterSetter(Dt,"strokeScaleEnabled",!0);st.addGetterSetter(Dt,"fillPriority","color");st.addComponentsGetterSetter(Dt,"fillPatternOffset",["x","y"]);st.addGetterSetter(Dt,"fillPatternOffsetX",0,Ht());st.addGetterSetter(Dt,"fillPatternOffsetY",0,Ht());st.addComponentsGetterSetter(Dt,"fillPatternScale",["x","y"]);st.addGetterSetter(Dt,"fillPatternScaleX",1,Ht());st.addGetterSetter(Dt,"fillPatternScaleY",1,Ht());st.addComponentsGetterSetter(Dt,"fillLinearGradientStartPoint",["x","y"]);st.addComponentsGetterSetter(Dt,"strokeLinearGradientStartPoint",["x","y"]);st.addGetterSetter(Dt,"fillLinearGradientStartPointX",0);st.addGetterSetter(Dt,"strokeLinearGradientStartPointX",0);st.addGetterSetter(Dt,"fillLinearGradientStartPointY",0);st.addGetterSetter(Dt,"strokeLinearGradientStartPointY",0);st.addComponentsGetterSetter(Dt,"fillLinearGradientEndPoint",["x","y"]);st.addComponentsGetterSetter(Dt,"strokeLinearGradientEndPoint",["x","y"]);st.addGetterSetter(Dt,"fillLinearGradientEndPointX",0);st.addGetterSetter(Dt,"strokeLinearGradientEndPointX",0);st.addGetterSetter(Dt,"fillLinearGradientEndPointY",0);st.addGetterSetter(Dt,"strokeLinearGradientEndPointY",0);st.addComponentsGetterSetter(Dt,"fillRadialGradientStartPoint",["x","y"]);st.addGetterSetter(Dt,"fillRadialGradientStartPointX",0);st.addGetterSetter(Dt,"fillRadialGradientStartPointY",0);st.addComponentsGetterSetter(Dt,"fillRadialGradientEndPoint",["x","y"]);st.addGetterSetter(Dt,"fillRadialGradientEndPointX",0);st.addGetterSetter(Dt,"fillRadialGradientEndPointY",0);st.addGetterSetter(Dt,"fillPatternRotation",0);st.addGetterSetter(Dt,"fillRule",void 0,fu());st.backCompat(Dt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const o5="#",u5="beforeDraw",c5="draw",Y2=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],f5=Y2.length;let hu=class extends Ra{constructor(t){super(t),this.canvas=new eo,this.hitCanvas=new Fm({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),t<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[t+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Lt.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Lt.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Lt.prototype.moveDown.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Lt.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return Lt.prototype.remove.call(this),t&&t.parentNode&&pt._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:n}){return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&pt.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Lt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){pt.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){pt.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,pt.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let n=1,i=!1;for(;;){for(let r=0;r<f5;r++){const l=Y2[r],f=this._getIntersection({x:t.x+l.x*n,y:t.y+l.y*n}),d=f.shape;if(d)return d;if(i=!!f.antialiased,!f.antialiased)break}if(i)n+=1;else return null}}_getIntersection(t){const n=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*n),Math.round(t.y*n),1,1).data,r=i[3];if(r===255){const l=pt._rgbToHex(i[0],i[1],i[2]),f=ed[o5+l];return f?{shape:f}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,n,i){const r=this.getLayer(),l=t||r&&r.getCanvas();return this._fire(u5,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),Ra.prototype.drawScene.call(this,l,n,i),this._fire(c5,{node:this}),this}drawHit(t,n){const i=this.getLayer(),r=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),Ra.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){pt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return pt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return pt.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};hu.prototype.nodeType="Layer";Dn(hu);st.addGetterSetter(hu,"imageSmoothingEnabled",!0);st.addGetterSetter(hu,"clearBeforeDraw",!0);st.addGetterSetter(hu,"hitGraphEnabled",!0,Nr());class Wm extends hu{constructor(t){super(t),this.listening(!1),pt.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Wm.prototype.nodeType="FastLayer";Dn(Wm);class rf extends Ra{_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&pt.throw("You may only add groups and shapes to groups.")}}rf.prototype.nodeType="Group";Dn(rf);const Tp=(function(){return ou.performance&&ou.performance.now?function(){return ou.performance.now()}:function(){return new Date().getTime()}})();class tr{constructor(t,n){this.id=tr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Tp(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(t){let n=[];return t&&(n=Array.isArray(t)?t:[t]),this.layers=n,this}getLayers(){return this.layers}addLayer(t){const n=this.layers,i=n.length;for(let r=0;r<i;r++)if(n[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const n=tr.animations,i=n.length;for(let r=0;r<i;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Tp(),tr._addAnimation(this),this}stop(){return tr._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const n=t.id,i=this.animations,r=i.length;for(let l=0;l<r;l++)if(i[l].id===n){this.animations.splice(l,1);break}}static _runFrames(){const t={},n=this.animations;for(let i=0;i<n.length;i++){const r=n[i],l=r.layers,f=r.func;r._updateFrameObject(Tp());const d=l.length;let g;if(f?g=f.call(r,r.frame)!==!1:g=!0,!!g)for(let m=0;m<d;m++){const _=l[m];_._id!==void 0&&(t[_._id]=_)}}for(const i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=tr;t.animations.length?(t._runFrames(),pt.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,pt.requestAnimFrame(this._animationLoop))}}tr.animations=[];tr.animIdCounter=0;tr.animRunning=!1;const h5={node:1,duration:1,easing:1,onFinish:1,yoyo:1},d5=1,U1=2,B1=3,z1=["fill","stroke","shadowColor"];let g5=0;class p5{constructor(t,n,i,r,l,f,d){this.prop=t,this.propFunc=n,this.begin=r,this._pos=r,this.duration=f,this._change=0,this.prevPos=0,this.yoyo=d,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=l-this.begin,this.pause()}fire(t){const n=this[t];n&&n()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=U1,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=B1,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===U1?this.setTime(t):this.state===B1&&this.setTime(this.duration-t)}pause(){this.state=d5,this.fire("onPause")}getTimer(){return new Date().getTime()}}class vn{constructor(t){const n=this,i=t.node,r=i._id,l=t.easing||nd.Linear,f=!!t.yoyo;let d,g;typeof t.duration>"u"?d=.3:t.duration===0?d=.001:d=t.duration,this.node=i,this._id=g5++;const m=i.getLayer()||(i instanceof kt.Stage?i.getLayers():null);m||pt.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new tr(function(){n.tween.onEnterFrame()},m),this.tween=new p5(g,function(_){n._tweenFunc(_)},l,0,1,d*1e3,f),this._addListeners(),vn.attrs[r]||(vn.attrs[r]={}),vn.attrs[r][this._id]||(vn.attrs[r][this._id]={}),vn.tweens[r]||(vn.tweens[r]={});for(g in t)h5[g]===void 0&&this._addAttr(g,t[g]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,n){const i=this.node,r=i._id;let l,f,d,g,m;const _=vn.tweens[r][t];_&&delete vn.attrs[r][_][t];let C=i.getAttr(t);if(pt._isArray(n))if(l=[],f=Math.max(n.length,C.length),t==="points"&&n.length!==C.length&&(n.length>C.length?(g=C,C=pt._prepareArrayForTween(C,n,i.closed())):(d=n,n=pt._prepareArrayForTween(n,C,i.closed()))),t.indexOf("fill")===0)for(let E=0;E<f;E++)if(E%2===0)l.push(n[E]-C[E]);else{const R=pt.colorToRGBA(C[E]);m=pt.colorToRGBA(n[E]),C[E]=R,l.push({r:m.r-R.r,g:m.g-R.g,b:m.b-R.b,a:m.a-R.a})}else for(let E=0;E<f;E++)l.push(n[E]-C[E]);else z1.indexOf(t)!==-1?(C=pt.colorToRGBA(C),m=pt.colorToRGBA(n),l={r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a}):l=n-C;vn.attrs[r][this._id][t]={start:C,diff:l,end:n,trueEnd:d,trueStart:g},vn.tweens[r][t]=this._id}_tweenFunc(t){const n=this.node,i=vn.attrs[n._id][this._id];let r,l,f,d,g,m,_,C;for(r in i){if(l=i[r],f=l.start,d=l.diff,C=l.end,pt._isArray(f))if(g=[],_=Math.max(f.length,C.length),r.indexOf("fill")===0)for(m=0;m<_;m++)m%2===0?g.push((f[m]||0)+d[m]*t):g.push("rgba("+Math.round(f[m].r+d[m].r*t)+","+Math.round(f[m].g+d[m].g*t)+","+Math.round(f[m].b+d[m].b*t)+","+(f[m].a+d[m].a*t)+")");else for(m=0;m<_;m++)g.push((f[m]||0)+d[m]*t);else z1.indexOf(r)!==-1?g="rgba("+Math.round(f.r+d.r*t)+","+Math.round(f.g+d.g*t)+","+Math.round(f.b+d.b*t)+","+(f.a+d.a*t)+")":g=f+d*t;n.setAttr(r,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,n=vn.attrs[t._id][this._id];n.points&&n.points.trueEnd&&t.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,n=vn.attrs[t._id][this._id];n.points&&n.points.trueStart&&t.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,n=this._id,i=vn.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in i)delete vn.tweens[t][r];delete vn.attrs[t][n],vn.tweens[t]&&(Object.keys(vn.tweens[t]).length===0&&delete vn.tweens[t],Object.keys(vn.attrs[t]).length===0&&delete vn.attrs[t])}}vn.attrs={};vn.tweens={};Lt.prototype.to=function(o){const t=o.onFinish;o.node=this,o.onFinish=function(){this.destroy(),t&&t()},new vn(o).play()};const nd={BackEaseIn(o,t,n,i){return n*(o/=i)*o*((1.70158+1)*o-1.70158)+t},BackEaseOut(o,t,n,i){return n*((o=o/i-1)*o*((1.70158+1)*o+1.70158)+1)+t},BackEaseInOut(o,t,n,i){let r=1.70158;return(o/=i/2)<1?n/2*(o*o*(((r*=1.525)+1)*o-r))+t:n/2*((o-=2)*o*(((r*=1.525)+1)*o+r)+2)+t},ElasticEaseIn(o,t,n,i,r,l){let f=0;return o===0?t:(o/=i)===1?t+n:(l||(l=i*.3),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(o-=1))*Math.sin((o*i-f)*(2*Math.PI)/l))+t)},ElasticEaseOut(o,t,n,i,r,l){let f=0;return o===0?t:(o/=i)===1?t+n:(l||(l=i*.3),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*o)*Math.sin((o*i-f)*(2*Math.PI)/l)+n+t)},ElasticEaseInOut(o,t,n,i,r,l){let f=0;return o===0?t:(o/=i/2)===2?t+n:(l||(l=i*(.3*1.5)),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),o<1?-.5*(r*Math.pow(2,10*(o-=1))*Math.sin((o*i-f)*(2*Math.PI)/l))+t:r*Math.pow(2,-10*(o-=1))*Math.sin((o*i-f)*(2*Math.PI)/l)*.5+n+t)},BounceEaseOut(o,t,n,i){return(o/=i)<1/2.75?n*(7.5625*o*o)+t:o<2/2.75?n*(7.5625*(o-=1.5/2.75)*o+.75)+t:o<2.5/2.75?n*(7.5625*(o-=2.25/2.75)*o+.9375)+t:n*(7.5625*(o-=2.625/2.75)*o+.984375)+t},BounceEaseIn(o,t,n,i){return n-nd.BounceEaseOut(i-o,0,n,i)+t},BounceEaseInOut(o,t,n,i){return o<i/2?nd.BounceEaseIn(o*2,0,n,i)*.5+t:nd.BounceEaseOut(o*2-i,0,n,i)*.5+n*.5+t},EaseIn(o,t,n,i){return n*(o/=i)*o+t},EaseOut(o,t,n,i){return-n*(o/=i)*(o-2)+t},EaseInOut(o,t,n,i){return(o/=i/2)<1?n/2*o*o+t:-n/2*(--o*(o-2)-1)+t},StrongEaseIn(o,t,n,i){return n*(o/=i)*o*o*o*o+t},StrongEaseOut(o,t,n,i){return n*((o=o/i-1)*o*o*o*o+1)+t},StrongEaseInOut(o,t,n,i){return(o/=i/2)<1?n/2*o*o*o*o*o+t:n/2*((o-=2)*o*o*o*o+2)+t},Linear(o,t,n,i){return n*o/i+t}},sf=pt._assign(kt,{Util:pt,Transform:Ta,Node:Lt,Container:Ra,Stage:Ag,stages:td,Layer:hu,FastLayer:Wm,Group:rf,DD:Fe,Shape:Dt,shapes:ed,Animation:tr,Tween:vn,Easings:nd,Context:Cg,Canvas:Xm});class ll extends Dt{_sceneFunc(t){const n=kt.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,n,i),t.arc(0,0,this.innerRadius(),n,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),n=this.outerRadius(),i=this.clockwise(),r=kt.getAngle(i?360-this.angle():this.angle()),l=Math.cos(Math.min(r,Math.PI)),f=1,d=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),g=Math.sin(Math.min(r,Math.PI/2)),m=l*(l>0?t:n),_=f*n,C=d*(d>0?t:n),E=g*(g>0?n:t);return{x:m,y:i?-1*E:C,width:_-m,height:E-C}}}ll.prototype._centroid=!0;ll.prototype.className="Arc";ll.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];Dn(ll);st.addGetterSetter(ll,"innerRadius",0,Ht());st.addGetterSetter(ll,"outerRadius",0,Ht());st.addGetterSetter(ll,"angle",0,Ht());st.addGetterSetter(ll,"clockwise",!1,Nr());function Am(o,t,n,i,r,l,f){const d=Math.sqrt(Math.pow(n-o,2)+Math.pow(i-t,2)),g=Math.sqrt(Math.pow(r-n,2)+Math.pow(l-i,2)),m=f*d/(d+g),_=f*g/(d+g),C=n-m*(r-o),E=i-m*(l-t),R=n+_*(r-o),v=i+_*(l-t);return[C,E,R,v]}function L1(o,t){const n=o.length,i=[];for(let r=2;r<n-2;r+=2){const l=Am(o[r-2],o[r-1],o[r],o[r+1],o[r+2],o[r+3],t);isNaN(l[0])||(i.push(l[0]),i.push(l[1]),i.push(o[r]),i.push(o[r+1]),i.push(l[2]),i.push(l[3]))}return i}let ol=class extends Dt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const n=this.points(),i=n.length,r=this.tension(),l=this.closed(),f=this.bezier();if(!i)return;let d=0;if(t.beginPath(),t.moveTo(n[0],n[1]),r!==0&&i>4){const g=this.getTensionPoints(),m=g.length;for(d=l?0:4,l||t.quadraticCurveTo(g[0],g[1],g[2],g[3]);d<m-2;)t.bezierCurveTo(g[d++],g[d++],g[d++],g[d++],g[d++],g[d++]);l||t.quadraticCurveTo(g[m-2],g[m-1],n[i-2],n[i-1])}else if(f)for(d=2;d<i;)t.bezierCurveTo(n[d++],n[d++],n[d++],n[d++],n[d++],n[d++]);else for(d=2;d<i;d+=2)t.lineTo(n[d],n[d+1]);l?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():L1(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),n=t.length,i=this.tension(),r=Am(t[n-2],t[n-1],t[0],t[1],t[2],t[3],i),l=Am(t[n-4],t[n-3],t[n-2],t[n-1],t[0],t[1],i),f=L1(t,i);return[r[2],r[3]].concat(f).concat([l[0],l[1],t[n-2],t[n-1],l[2],l[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let n=t[0],i=t[0],r=t[1],l=t[1],f,d;for(let g=0;g<t.length/2;g++)f=t[g*2],d=t[g*2+1],n=Math.min(n,f),i=Math.max(i,f),r=Math.min(r,d),l=Math.max(l,d);return{x:n,y:r,width:i-n,height:l-r}}};ol.prototype.className="Line";ol.prototype._attrsAffectingSize=["points","bezier","tension"];Dn(ol);st.addGetterSetter(ol,"closed",!1);st.addGetterSetter(ol,"bezier",!1);st.addGetterSetter(ol,"tension",0,Ht());st.addGetterSetter(ol,"points",[],Nb());const m5=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],v5=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],y5=[[1],[1,1],[1,2,1],[1,3,3,1]],G1=(o,t,n)=>{let i,r;const f=n/2;i=0;for(let d=0;d<20;d++)r=f*m5[20][d]+f,i+=v5[20][d]*S5(o,t,r);return f*i},H1=(o,t,n)=>{n===void 0&&(n=1);const i=o[0]-2*o[1]+o[2],r=t[0]-2*t[1]+t[2],l=2*o[1]-2*o[0],f=2*t[1]-2*t[0],d=4*(i*i+r*r),g=4*(i*l+r*f),m=l*l+f*f;if(d===0)return n*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(t[2]-t[0],2));const _=g/(2*d),C=m/d,E=n+_,R=C-_*_,v=E*E+R>0?Math.sqrt(E*E+R):0,D=_*_+R>0?Math.sqrt(_*_+R):0,z=_+Math.sqrt(_*_+R)!==0?R*Math.log(Math.abs((E+v)/(_+D))):0;return Math.sqrt(d)/2*(E*v-_*D+z)};function S5(o,t,n){const i=Om(1,n,o),r=Om(1,n,t),l=i*i+r*r;return Math.sqrt(l)}const Om=(o,t,n)=>{const i=n.length-1;let r,l;if(i===0)return 0;if(o===0){l=0;for(let f=0;f<=i;f++)l+=y5[i][f]*Math.pow(1-t,i-f)*Math.pow(t,f)*n[f];return l}else{r=new Array(i);for(let f=0;f<i;f++)r[f]=i*(n[f+1]-n[f]);return Om(o-1,t,r)}},P1=(o,t,n)=>{let i=1,r=o/t,l=(o-n(r))/t,f=0;for(;i>.001;){const d=n(r+l),g=Math.abs(o-d)/t;if(g<i)i=g,r+=l;else{const m=n(r-l),_=Math.abs(o-m)/t;_<i?(i=_,r-=l):l/=2}if(f++,f>500)break}return r};class yn extends Dt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=yn.parsePathData(this.data()),this.pathLength=yn.getPathLength(this.dataArray)}_sceneFunc(t){const n=this.dataArray;t.beginPath();let i=!1;for(let r=0;r<n.length;r++){const l=n[r].command,f=n[r].points;switch(l){case"L":t.lineTo(f[0],f[1]);break;case"M":t.moveTo(f[0],f[1]);break;case"C":t.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":t.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const d=f[0],g=f[1],m=f[2],_=f[3],C=f[4],E=f[5],R=f[6],v=f[7],D=m>_?m:_,z=m>_?1:m/_,G=m>_?_/m:1;t.translate(d,g),t.rotate(R),t.scale(z,G),t.arc(0,0,D,C,C+E,1-v),t.scale(1/z,1/G),t.rotate(-R),t.translate(-d,-g);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],_=g.points[5],C=g.points[4]+_;let E=Math.PI/180;if(Math.abs(m-C)<E&&(E=Math.abs(m-C)),_<0)for(let R=m-E;R>C;R-=E){const v=yn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}else for(let R=m+E;R<C;R+=E){const v=yn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const _=yn.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);t.push(_.x,_.y)}else t=t.concat(g.points)});let n=t[0],i=t[0],r=t[1],l=t[1],f,d;for(let g=0;g<t.length/2;g++)f=t[g*2],d=t[g*2+1],isNaN(f)||(n=Math.min(n,f),i=Math.max(i,f)),isNaN(d)||(r=Math.min(r,d),l=Math.max(l,d));return{x:n,y:r,width:i-n,height:l-r}}getLength(){return this.pathLength}getPointAtLength(t){return yn.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,n,i,r){return Math.sqrt((i-t)*(i-t)+(r-n)*(r-n))}static getPathLength(t){let n=0;for(let i=0;i<t.length;++i)n+=t[i].pathLength;return n}static getPointAtLengthOfDataArray(t,n){let i,r=0,l=n.length;if(!l)return null;for(;r<l&&t>n[r].pathLength;)t-=n[r].pathLength,++r;if(r===l)return i=n[r-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return n[r].command==="M"?(i=n[r].points.slice(0,2),{x:i[0],y:i[1]}):{x:n[r].start.x,y:n[r].start.y};const f=n[r],d=f.points;switch(f.command){case"L":return yn.getPointOnLine(t,f.start.x,f.start.y,d[0],d[1]);case"C":return yn.getPointOnCubicBezier(P1(t,yn.getPathLength(n),D=>G1([f.start.x,d[0],d[2],d[4]],[f.start.y,d[1],d[3],d[5]],D)),f.start.x,f.start.y,d[0],d[1],d[2],d[3],d[4],d[5]);case"Q":return yn.getPointOnQuadraticBezier(P1(t,yn.getPathLength(n),D=>H1([f.start.x,d[0],d[2]],[f.start.y,d[1],d[3]],D)),f.start.x,f.start.y,d[0],d[1],d[2],d[3]);case"A":const g=d[0],m=d[1],_=d[2],C=d[3],E=d[5],R=d[6];let v=d[4];return v+=E*t/f.pathLength,yn.getPointOnEllipticalArc(g,m,_,C,v,R)}return null}static getPointOnLine(t,n,i,r,l,f,d){f=f??n,d=d??i;const g=this.getLineLength(n,i,r,l);if(g<1e-10)return{x:n,y:i};if(r===n)return{x:f,y:d+(l>i?t:-t)};const m=(l-i)/(r-n),_=Math.sqrt(t*t/(1+m*m))*(r<n?-1:1),C=m*_;if(Math.abs(d-i-m*(f-n))<1e-10)return{x:f+_,y:d+C};const E=((f-n)*(r-n)+(d-i)*(l-i))/(g*g),R=n+E*(r-n),v=i+E*(l-i),D=this.getLineLength(f,d,R,v),z=Math.sqrt(t*t-D*D),G=Math.sqrt(z*z/(1+m*m))*(r<n?-1:1),N=m*G;return{x:R+G,y:v+N}}static getPointOnCubicBezier(t,n,i,r,l,f,d,g,m){function _(z){return z*z*z}function C(z){return 3*z*z*(1-z)}function E(z){return 3*z*(1-z)*(1-z)}function R(z){return(1-z)*(1-z)*(1-z)}const v=g*_(t)+f*C(t)+r*E(t)+n*R(t),D=m*_(t)+d*C(t)+l*E(t)+i*R(t);return{x:v,y:D}}static getPointOnQuadraticBezier(t,n,i,r,l,f,d){function g(R){return R*R}function m(R){return 2*R*(1-R)}function _(R){return(1-R)*(1-R)}const C=f*g(t)+r*m(t)+n*_(t),E=d*g(t)+l*m(t)+i*_(t);return{x:C,y:E}}static getPointOnEllipticalArc(t,n,i,r,l,f){const d=Math.cos(f),g=Math.sin(f),m={x:i*Math.cos(l),y:r*Math.sin(l)};return{x:t+(m.x*d-m.y*g),y:n+(m.x*g+m.y*d)}}static parsePathData(t){if(!t)return[];let n=t;const i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let C=0;C<i.length;C++)n=n.replace(new RegExp(i[C],"g"),"|"+i[C]);const r=n.split("|"),l=[],f=[];let d=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let C=1;C<r.length;C++){let E=r[C],R=E.charAt(0);for(E=E.slice(1),f.length=0;_=m.exec(E);)f.push(_[0]);let v=[],D=R==="A"||R==="a"?0:-1;for(let z=0,G=f.length;z<G;z++){const N=f[z];if(N==="00"){v.push(0,0),D>=0&&(D+=2,D>=7&&(D-=7));continue}if(D>=0){if(D===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(N)){v.push(parseInt(N[0],10)),v.push(parseInt(N[1],10)),v.push(parseFloat(N.slice(2))),D+=3,D>=7&&(D-=7);continue}if(N==="11"||N==="10"||N==="01"){v.push(parseInt(N[0],10)),v.push(parseInt(N[1],10)),D+=2,D>=7&&(D-=7);continue}if(N==="0"||N==="1"){v.push(parseInt(N,10)),D+=1,D>=7&&(D-=7);continue}}else if(D===4){if(/^[01]\d+(?:\.\d+)?$/.test(N)){v.push(parseInt(N[0],10)),v.push(parseFloat(N.slice(1))),D+=2,D>=7&&(D-=7);continue}if(N==="0"||N==="1"){v.push(parseInt(N,10)),D+=1,D>=7&&(D-=7);continue}}const M=parseFloat(N);isNaN(M)?v.push(0):v.push(M),D+=1,D>=7&&(D-=7)}else{const M=parseFloat(N);isNaN(M)?v.push(0):v.push(M)}}for(;v.length>0&&!isNaN(v[0]);){let z="",G=[];const N=d,M=g;let L,w,A,O,y,B,U,P,K,Y;switch(R){case"l":d+=v.shift(),g+=v.shift(),z="L",G.push(d,g);break;case"L":d=v.shift(),g=v.shift(),G.push(d,g);break;case"m":const Q=v.shift(),V=v.shift();if(d+=Q,g+=V,z="M",l.length>2&&l[l.length-1].command==="z"){for(let j=l.length-2;j>=0;j--)if(l[j].command==="M"){d=l[j].points[0]+Q,g=l[j].points[1]+V;break}}G.push(d,g),R="l";break;case"M":d=v.shift(),g=v.shift(),z="M",G.push(d,g),R="L";break;case"h":d+=v.shift(),z="L",G.push(d,g);break;case"H":d=v.shift(),z="L",G.push(d,g);break;case"v":g+=v.shift(),z="L",G.push(d,g);break;case"V":g=v.shift(),z="L",G.push(d,g);break;case"C":G.push(v.shift(),v.shift(),v.shift(),v.shift()),d=v.shift(),g=v.shift(),G.push(d,g);break;case"c":G.push(d+v.shift(),g+v.shift(),d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="C",G.push(d,g);break;case"S":w=d,A=g,L=l[l.length-1],L.command==="C"&&(w=d+(d-L.points[2]),A=g+(g-L.points[3])),G.push(w,A,v.shift(),v.shift()),d=v.shift(),g=v.shift(),z="C",G.push(d,g);break;case"s":w=d,A=g,L=l[l.length-1],L.command==="C"&&(w=d+(d-L.points[2]),A=g+(g-L.points[3])),G.push(w,A,d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="C",G.push(d,g);break;case"Q":G.push(v.shift(),v.shift()),d=v.shift(),g=v.shift(),G.push(d,g);break;case"q":G.push(d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="Q",G.push(d,g);break;case"T":w=d,A=g,L=l[l.length-1],L.command==="Q"&&(w=d+(d-L.points[0]),A=g+(g-L.points[1])),d=v.shift(),g=v.shift(),z="Q",G.push(w,A,d,g);break;case"t":w=d,A=g,L=l[l.length-1],L.command==="Q"&&(w=d+(d-L.points[0]),A=g+(g-L.points[1])),d+=v.shift(),g+=v.shift(),z="Q",G.push(w,A,d,g);break;case"A":O=v.shift(),y=v.shift(),B=v.shift(),U=v.shift(),P=v.shift(),K=d,Y=g,d=v.shift(),g=v.shift(),z="A",G=this.convertEndpointToCenterParameterization(K,Y,d,g,U,P,O,y,B);break;case"a":O=v.shift(),y=v.shift(),B=v.shift(),U=v.shift(),P=v.shift(),K=d,Y=g,d+=v.shift(),g+=v.shift(),z="A",G=this.convertEndpointToCenterParameterization(K,Y,d,g,U,P,O,y,B);break}l.push({command:z||R,points:G,start:{x:N,y:M},pathLength:this.calcLength(N,M,z||R,G)})}(R==="z"||R==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(t,n,i,r){let l,f,d,g;const m=yn;switch(i){case"L":return m.getLineLength(t,n,r[0],r[1]);case"C":return G1([t,r[0],r[2],r[4]],[n,r[1],r[3],r[5]],1);case"Q":return H1([t,r[0],r[2]],[n,r[1],r[3]],1);case"A":l=0;const _=r[4],C=r[5],E=r[4]+C;let R=Math.PI/180;if(Math.abs(_-E)<R&&(R=Math.abs(_-E)),f=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],_,0),C<0)for(g=_-R;g>E;g-=R)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),f=d;else for(g=_+R;g<E;g+=R)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),f=d;return d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],E,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),l}return 0}static convertEndpointToCenterParameterization(t,n,i,r,l,f,d,g,m){const _=m*(Math.PI/180),C=Math.cos(_)*(t-i)/2+Math.sin(_)*(n-r)/2,E=-1*Math.sin(_)*(t-i)/2+Math.cos(_)*(n-r)/2,R=C*C/(d*d)+E*E/(g*g);R>1&&(d*=Math.sqrt(R),g*=Math.sqrt(R));let v=Math.sqrt((d*d*(g*g)-d*d*(E*E)-g*g*(C*C))/(d*d*(E*E)+g*g*(C*C)));l===f&&(v*=-1),isNaN(v)&&(v=0);const D=v*d*E/g,z=v*-g*C/d,G=(t+i)/2+Math.cos(_)*D-Math.sin(_)*z,N=(n+r)/2+Math.sin(_)*D+Math.cos(_)*z,M=function(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1])},L=function(U,P){return(U[0]*P[0]+U[1]*P[1])/(M(U)*M(P))},w=function(U,P){return(U[0]*P[1]<U[1]*P[0]?-1:1)*Math.acos(L(U,P))},A=w([1,0],[(C-D)/d,(E-z)/g]),O=[(C-D)/d,(E-z)/g],y=[(-1*C-D)/d,(-1*E-z)/g];let B=w(O,y);return L(O,y)<=-1&&(B=Math.PI),L(O,y)>=1&&(B=0),f===0&&B>0&&(B=B-2*Math.PI),f===1&&B<0&&(B=B+2*Math.PI),[G,N,d,g,A,B,_,f]}}yn.prototype.className="Path";yn.prototype._attrsAffectingSize=["data"];Dn(yn);st.addGetterSetter(yn,"data");class du extends ol{_sceneFunc(t){super._sceneFunc(t);const n=Math.PI*2,i=this.points();let r=i;const l=this.tension()!==0&&i.length>4;l&&(r=this.getTensionPoints());const f=this.pointerLength(),d=i.length;let g,m;if(l){const E=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],i[d-2],i[d-1]],R=yn.calcLength(r[r.length-4],r[r.length-3],"C",E),v=yn.getPointOnQuadraticBezier(Math.min(1,1-f/R),E[0],E[1],E[2],E[3],E[4],E[5]);g=i[d-2]-v.x,m=i[d-1]-v.y}else g=i[d-2]-i[d-4],m=i[d-1]-i[d-3];const _=(Math.atan2(m,g)+n)%n,C=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[d-2],i[d-1]),t.rotate(_),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),l?(g=(r[0]+r[2])/2-i[0],m=(r[1]+r[3])/2-i[1]):(g=i[2]-i[0],m=i[3]-i[1]),t.rotate((Math.atan2(-m,-g)+n)%n),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),n=this.pointerWidth()/2;return{x:t.x,y:t.y-n,width:t.width,height:t.height+n*2}}}du.prototype.className="Arrow";Dn(du);st.addGetterSetter(du,"pointerLength",10,Ht());st.addGetterSetter(du,"pointerWidth",10,Ht());st.addGetterSetter(du,"pointerAtBeginning",!1);st.addGetterSetter(du,"pointerAtEnding",!0);class df extends Dt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}df.prototype._centroid=!0;df.prototype.className="Circle";df.prototype._attrsAffectingSize=["radius"];Dn(df);st.addGetterSetter(df,"radius",0,Ht());class ro extends Dt{_sceneFunc(t){const n=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),n!==i&&t.scale(1,i/n),t.arc(0,0,n,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}ro.prototype.className="Ellipse";ro.prototype._centroid=!0;ro.prototype._attrsAffectingSize=["radiusX","radiusY"];Dn(ro);st.addComponentsGetterSetter(ro,"radius",["x","y"]);st.addGetterSetter(ro,"radiusX",0,Ht());st.addGetterSetter(ro,"radiusY",0,Ht());let Dr=class K2 extends Dt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),n=this.hasShadow();return t&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const n=this.getWidth(),i=this.getHeight(),r=this.cornerRadius(),l=this.attrs.image;let f;if(l){const d=this.attrs.cropWidth,g=this.attrs.cropHeight;d&&g?f=[l,this.cropX(),this.cropY(),d,g,0,0,n,i]:f=[l,0,0,n,i]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?pt.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)),l&&(r&&t.clip(),t.drawImage.apply(t,f))}_hitFunc(t){const n=this.width(),i=this.height(),r=this.cornerRadius();t.beginPath(),r?pt.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,n,i;return(i=(t=this.attrs.width)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&i!==void 0?i:0}getHeight(){var t,n,i;return(i=(t=this.attrs.height)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&i!==void 0?i:0}static fromURL(t,n,i=null){const r=pt.createImageElement();r.onload=function(){const l=new K2({image:r});n(l)},r.onerror=i,r.crossOrigin="Anonymous",r.src=t}};Dr.prototype.className="Image";Dr.prototype._attrsAffectingSize=["image"];Dn(Dr);st.addGetterSetter(Dr,"cornerRadius",0,Tg(4));st.addGetterSetter(Dr,"image");st.addComponentsGetterSetter(Dr,"crop",["x","y","width","height"]);st.addGetterSetter(Dr,"cropX",0,Ht());st.addGetterSetter(Dr,"cropY",0,Ht());st.addGetterSetter(Dr,"cropWidth",0,Ht());st.addGetterSetter(Dr,"cropHeight",0,Ht());const Q2=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],b5="Change.konva",_5="none",Rm="up",wm="right",xm="down",Mm="left",E5=Q2.length;class $m extends rf{constructor(t){super(t),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let n=this,i;const r=function(){n._sync()};for(i=0;i<E5;i++)t.on(Q2[i]+b5,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),n=this.getTag(),i,r,l,f,d,g,m;if(t&&n){switch(i=t.width(),r=t.height(),l=n.pointerDirection(),f=n.pointerWidth(),m=n.pointerHeight(),d=0,g=0,l){case Rm:d=i/2,g=-1*m;break;case wm:d=i+f,g=r/2;break;case xm:d=i/2,g=r+m;break;case Mm:d=-1*f,g=r/2;break}n.setAttrs({x:-1*d,y:-1*g,width:i,height:r}),t.setAttrs({x:-1*d,y:-1*g})}}}$m.prototype.className="Label";Dn($m);class gu extends Dt{_sceneFunc(t){const n=this.width(),i=this.height(),r=this.pointerDirection(),l=this.pointerWidth(),f=this.pointerHeight(),d=this.cornerRadius();let g=0,m=0,_=0,C=0;typeof d=="number"?g=m=_=C=Math.min(d,n/2,i/2):(g=Math.min(d[0]||0,n/2,i/2),m=Math.min(d[1]||0,n/2,i/2),C=Math.min(d[2]||0,n/2,i/2),_=Math.min(d[3]||0,n/2,i/2)),t.beginPath(),t.moveTo(g,0),r===Rm&&(t.lineTo((n-l)/2,0),t.lineTo(n/2,-1*f),t.lineTo((n+l)/2,0)),t.lineTo(n-m,0),t.arc(n-m,m,m,Math.PI*3/2,0,!1),r===wm&&(t.lineTo(n,(i-f)/2),t.lineTo(n+l,i/2),t.lineTo(n,(i+f)/2)),t.lineTo(n,i-C),t.arc(n-C,i-C,C,0,Math.PI/2,!1),r===xm&&(t.lineTo((n+l)/2,i),t.lineTo(n/2,i+f),t.lineTo((n-l)/2,i)),t.lineTo(_,i),t.arc(_,i-_,_,Math.PI/2,Math.PI,!1),r===Mm&&(t.lineTo(0,(i+f)/2),t.lineTo(-1*l,i/2),t.lineTo(0,(i-f)/2)),t.lineTo(0,g),t.arc(g,g,g,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,n=0,i=this.pointerWidth(),r=this.pointerHeight(),l=this.pointerDirection(),f=this.width(),d=this.height();return l===Rm?(n-=r,d+=r):l===xm?d+=r:l===Mm?(t-=i*1.5,f+=i):l===wm&&(f+=i*1.5),{x:t,y:n,width:f,height:d}}}gu.prototype.className="Tag";Dn(gu);st.addGetterSetter(gu,"pointerDirection",_5);st.addGetterSetter(gu,"pointerWidth",0,Ht());st.addGetterSetter(gu,"pointerHeight",0,Ht());st.addGetterSetter(gu,"cornerRadius",0,Tg(4));class hd extends Dt{_sceneFunc(t){const n=this.cornerRadius(),i=this.width(),r=this.height();t.beginPath(),n?pt.drawRoundedRectPath(t,i,r,n):t.rect(0,0,i,r),t.closePath(),t.fillStrokeShape(this)}}hd.prototype.className="Rect";Dn(hd);st.addGetterSetter(hd,"cornerRadius",0,Tg(4));class so extends Dt{_sceneFunc(t){const n=this._getPoints(),i=this.radius(),r=this.sides(),l=this.cornerRadius();if(t.beginPath(),l)pt.drawRoundedPolygonPath(t,n,r,i,l);else{t.moveTo(n[0].x,n[0].y);for(let f=1;f<n.length;f++)t.lineTo(n[f].x,n[f].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,n=this.attrs.radius||0,i=[];for(let r=0;r<t;r++)i.push({x:n*Math.sin(r*2*Math.PI/t),y:-1*n*Math.cos(r*2*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();let n=t[0].x,i=t[0].y,r=t[0].x,l=t[0].y;return t.forEach(f=>{n=Math.min(n,f.x),i=Math.max(i,f.x),r=Math.min(r,f.y),l=Math.max(l,f.y)}),{x:n,y:r,width:i-n,height:l-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}so.prototype.className="RegularPolygon";so.prototype._centroid=!0;so.prototype._attrsAffectingSize=["radius"];Dn(so);st.addGetterSetter(so,"radius",0,Ht());st.addGetterSetter(so,"sides",0,Ht());st.addGetterSetter(so,"cornerRadius",0,Tg(4));const I1=Math.PI*2;class pu extends Dt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,I1,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),I1,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}pu.prototype.className="Ring";pu.prototype._centroid=!0;pu.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Dn(pu);st.addGetterSetter(pu,"innerRadius",0,Ht());st.addGetterSetter(pu,"outerRadius",0,Ht());class us extends Dt{constructor(t){super(t),this._updated=!0,this.anim=new tr(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const n=this.animation(),i=this.frameIndex(),r=i*4,l=this.animations()[n],f=this.frameOffsets(),d=l[r+0],g=l[r+1],m=l[r+2],_=l[r+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,m,_),t.closePath(),t.fillStrokeShape(this)),C)if(f){const E=f[n],R=i*2;t.drawImage(C,d,g,m,_,E[R+0],E[R+1],m,_)}else t.drawImage(C,d,g,m,_,0,0,m,_)}_hitFunc(t){const n=this.animation(),i=this.frameIndex(),r=i*4,l=this.animations()[n],f=this.frameOffsets(),d=l[r+2],g=l[r+3];if(t.beginPath(),f){const m=f[n],_=i*2;t.rect(m[_+0],m[_+1],d,g)}else t.rect(0,0,d,g);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),n=this.animation(),i=this.animations(),r=i[n],l=r.length/4;t<l-1?this.frameIndex(t+1):this.frameIndex(0)}}us.prototype.className="Sprite";Dn(us);st.addGetterSetter(us,"animation");st.addGetterSetter(us,"animations");st.addGetterSetter(us,"frameOffsets");st.addGetterSetter(us,"image");st.addGetterSetter(us,"frameIndex",0,Ht());st.addGetterSetter(us,"frameRate",17,Ht());st.backCompat(us,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class lo extends Dt{_sceneFunc(t){const n=this.innerRadius(),i=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(let l=1;l<r*2;l++){const f=l%2===0?i:n,d=f*Math.sin(l*Math.PI/r),g=-1*f*Math.cos(l*Math.PI/r);t.lineTo(d,g)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}lo.prototype.className="Star";lo.prototype._centroid=!0;lo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Dn(lo);st.addGetterSetter(lo,"numPoints",5,Ht());st.addGetterSetter(lo,"innerRadius",0,Ht());st.addGetterSetter(lo,"outerRadius",0,Ht());function $l(o){return[...o].reduce((t,n,i,r)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const l=r[i+1];l&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(l)?(t.push(n+l),r[i+1]=""):t.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(r[i+1]||""))?t.push(n+r[i+1]):i>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?t[t.length-1]+=n:n&&t.push(n);return t},[])}const qc="auto",C5="center",X2="inherit",Vc="justify",T5="Change.konva",A5="2d",k1="-",F2="left",O5="text",R5="Text",w5="top",x5="bottom",q1="middle",J2="normal",M5="px ",X0=" ",N5="right",V1="rtl",D5="word",j5="char",Y1="none",Ap="…",Z2=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],U5=Z2.length;function B5(o){return o.split(",").map(t=>{t=t.trim();const n=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return n&&!i&&(t=`"${t}"`),t}).join(", ")}let F0;function Op(){return F0||(F0=pt.createCanvasElement().getContext(A5),F0)}function z5(o){o.fillText(this._partialText,this._partialTextX,this._partialTextY)}function L5(o){o.setAttr("miterLimit",2),o.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function G5(o){return o=o||{},!o.fillLinearGradientColorStops&&!o.fillRadialGradientColorStops&&!o.fillPatternImage&&(o.fill=o.fill||"black"),o}class Cn extends Dt{constructor(t){super(G5(t)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<U5;n++)this.on(Z2[n]+T5,this._setTextData);this._setTextData()}_sceneFunc(t){var n,i;const r=this.textArr,l=r.length;if(!this.text())return;let f=this.padding(),d=this.fontSize(),g=this.lineHeight()*d,m=this.verticalAlign(),_=this.direction(),C=0,E=this.align(),R=this.getWidth(),v=this.letterSpacing(),D=this.charRenderFunc(),z=this.fill(),G=this.textDecoration(),N=G.indexOf("underline")!==-1,M=G.indexOf("line-through")!==-1,L;_=_===X2?t.direction:_;let w=g/2,A=q1;if(!kt.legacyTextRendering){const O=this.measureSize("M");A="alphabetic";const y=(n=O.fontBoundingBoxAscent)!==null&&n!==void 0?n:O.actualBoundingBoxAscent,B=(i=O.fontBoundingBoxDescent)!==null&&i!==void 0?i:O.actualBoundingBoxDescent;w=(y-B)/2+g/2}for(_===V1&&t.setAttr("direction",_),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",A),t.setAttr("textAlign",F2),m===q1?C=(this.getHeight()-l*g-f*2)/2:m===x5&&(C=this.getHeight()-l*g-f*2),t.translate(f,C+f),L=0;L<l;L++){let O=0,y=0;const B=r[L],U=B.text,P=B.width,K=B.lastInParagraph;if(t.save(),E===N5?O+=R-P-f*2:E===C5&&(O+=(R-P-f*2)/2),N){t.save(),t.beginPath();const Y=kt.legacyTextRendering?Math.round(d/2):Math.round(d/4),Q=O,V=w+y+Y;t.moveTo(Q,V);const j=E===Vc&&!K?R-f*2:P;t.lineTo(Q+Math.round(j),V),t.lineWidth=d/15;const I=this._getLinearGradient();t.strokeStyle=I||z,t.stroke(),t.restore()}if(_!==V1&&(v!==0||E===Vc||D)){const Y=U.split(" ").length-1,Q=$l(U);for(let V=0;V<Q.length;V++){const j=Q[V];if(j===" "&&!K&&E===Vc&&(O+=(R-f*2-P)/Y),this._partialTextX=O,this._partialTextY=w+y,this._partialText=j,D){t.save();const X=r.slice(0,L).reduce((at,J)=>at+$l(J.text).length,0),Z=V+X;D({char:j,index:Z,x:O,y:w+y,lineIndex:L,column:V,isLastInLine:K,width:this.measureSize(j).width,context:t})}t.fillStrokeShape(this),D&&t.restore(),O+=this.measureSize(j).width+v}}else v!==0&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=O,this._partialTextY=w+y,this._partialText=U,t.fillStrokeShape(this);if(M){t.save(),t.beginPath();const Y=kt.legacyTextRendering?0:-Math.round(d/4),Q=E===Vc?0:O;t.moveTo(Q,w+y+Y);const V=E===Vc&&!K?R-f*2:P;t.lineTo(Q+Math.round(V),w+y+Y),t.lineWidth=d/15;const j=this._getLinearGradient();t.strokeStyle=j||z,t.stroke(),t.restore()}t.restore(),l>1&&(w+=g)}}_hitFunc(t){const n=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}setText(t){const n=pt._isString(t)?t:t==null?"":t+"";return this._setAttr(O5,n),this}getWidth(){return this.attrs.width===qc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===qc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return pt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var n,i,r,l,f,d,g,m,_,C,E;let R=Op(),v=this.fontSize(),D;R.save(),R.font=this._getContextFont(),D=R.measureText(t),R.restore();const z=v/100;return{actualBoundingBoxAscent:(n=D.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*z,actualBoundingBoxDescent:(i=D.actualBoundingBoxDescent)!==null&&i!==void 0?i:0,actualBoundingBoxLeft:(r=D.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*z,actualBoundingBoxRight:(l=D.actualBoundingBoxRight)!==null&&l!==void 0?l:75.732421875*z,alphabeticBaseline:(f=D.alphabeticBaseline)!==null&&f!==void 0?f:0,emHeightAscent:(d=D.emHeightAscent)!==null&&d!==void 0?d:100*z,emHeightDescent:(g=D.emHeightDescent)!==null&&g!==void 0?g:-20*z,fontBoundingBoxAscent:(m=D.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*z,fontBoundingBoxDescent:(_=D.fontBoundingBoxDescent)!==null&&_!==void 0?_:21*z,hangingBaseline:(C=D.hangingBaseline)!==null&&C!==void 0?C:72.80000305175781*z,ideographicBaseline:(E=D.ideographicBaseline)!==null&&E!==void 0?E:-21*z,width:D.width,height:v}}_getContextFont(){return this.fontStyle()+X0+this.fontVariant()+X0+(this.fontSize()+M5)+B5(this.fontFamily())}_addTextLine(t){this.align()===Vc&&(t=t.trim());const i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){const n=this.letterSpacing(),i=t.length;return Op().measureText(t).width+n*i}_setTextData(){let t=this.text().split(`
`),n=+this.fontSize(),i=0,r=this.lineHeight()*n,l=this.attrs.width,f=this.attrs.height,d=l!==qc&&l!==void 0,g=f!==qc&&f!==void 0,m=this.padding(),_=l-m*2,C=f-m*2,E=0,R=this.wrap(),v=R!==Y1,D=R!==j5&&v,z=this.ellipsis();this.textArr=[],Op().font=this._getContextFont();const G=z?this._getTextWidth(Ap):0;for(let N=0,M=t.length;N<M;++N){let L=t[N],w=this._getTextWidth(L);if(d&&w>_)for(;L.length>0;){let A=0,O=$l(L).length,y="",B=0;for(;A<O;){const U=A+O>>>1,P=$l(L),K=P.slice(0,U+1).join(""),Y=this._getTextWidth(K);(z&&g&&E+r>C?Y+G:Y)<=_?(A=U+1,y=K,B=Y):O=U}if(y){if(D){const K=$l(L),Y=$l(y),Q=K[Y.length],V=Q===X0||Q===k1;let j;if(V&&B<=_)j=Y.length;else{const I=Y.lastIndexOf(X0),X=Y.lastIndexOf(k1);j=Math.max(I,X)+1}j>0&&(A=j,y=K.slice(0,A).join(""),B=this._getTextWidth(y))}if(y=y.trimRight(),this._addTextLine(y),i=Math.max(i,B),E+=r,this._shouldHandleEllipsis(E)){this._tryToAddEllipsisToLastLine();break}if(L=$l(L).slice(A).join("").trimLeft(),L.length>0&&(w=this._getTextWidth(L),w<=_)){this._addTextLine(L),E+=r,i=Math.max(i,w);break}}else break}else this._addTextLine(L),E+=r,i=Math.max(i,w),this._shouldHandleEllipsis(E)&&N<M-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&E+r>C)break}this.textHeight=n,this.textWidth=i}_shouldHandleEllipsis(t){const n=+this.fontSize(),i=this.lineHeight()*n,r=this.attrs.height,l=r!==qc&&r!==void 0,f=this.padding(),d=r-f*2;return!(this.wrap()!==Y1)||l&&t+i>d}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,n=t!==qc&&t!==void 0,i=this.padding(),r=t-i*2,l=this.ellipsis(),f=this.textArr[this.textArr.length-1];!f||!l||(n&&(this._getTextWidth(f.text+Ap)<r||(f.text=f.text.slice(0,f.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(f.text+Ap))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return t&&n?!0:super._useBufferCanvas()}}Cn.prototype._fillFunc=z5;Cn.prototype._strokeFunc=L5;Cn.prototype.className=R5;Cn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Dn(Cn);st.overWriteSetter(Cn,"width",Jm());st.overWriteSetter(Cn,"height",Jm());st.addGetterSetter(Cn,"direction",X2);st.addGetterSetter(Cn,"fontFamily","Arial");st.addGetterSetter(Cn,"fontSize",12,Ht());st.addGetterSetter(Cn,"fontStyle",J2);st.addGetterSetter(Cn,"fontVariant",J2);st.addGetterSetter(Cn,"padding",0,Ht());st.addGetterSetter(Cn,"align",F2);st.addGetterSetter(Cn,"verticalAlign",w5);st.addGetterSetter(Cn,"lineHeight",1,Ht());st.addGetterSetter(Cn,"wrap",D5);st.addGetterSetter(Cn,"ellipsis",!1,Nr());st.addGetterSetter(Cn,"letterSpacing",0,Ht());st.addGetterSetter(Cn,"text","",fu());st.addGetterSetter(Cn,"textDecoration","");st.addGetterSetter(Cn,"charRenderFunc",void 0);const H5="",W2="normal";function $2(o){o.fillText(this.partialText,0,0)}function tS(o){o.strokeText(this.partialText,0,0)}class fi extends Dt{constructor(t){super(t),this.dummyCanvas=pt.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return yn.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const n=this.pathLength;return t>n?null:yn.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=yn.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const n=this.textDecoration(),i=this.fill(),r=this.fontSize(),l=this.glyphInfo,f=n.indexOf("underline")!==-1,d=n.indexOf("line-through")!==-1;f&&t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),this.partialText=l[g].text,t.fillStrokeShape(this),f&&(g===0&&t.moveTo(0,r/2+1),t.lineTo(l[g].width,r/2+1)),t.restore()}if(f&&(t.strokeStyle=i,t.lineWidth=r/20,t.stroke()),d){t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),g===0&&t.moveTo(0,0),t.lineTo(l[g].width,0),t.restore()}t.strokeStyle=i,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const n=this.glyphInfo;if(n.length>=1){const i=n[0].p0;t.moveTo(i.x,i.y)}for(let i=0;i<n.length;i++){const r=n[i].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return pt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Cn.prototype.setText.call(this,t)}_getContextFont(){return Cn.prototype._getContextFont.call(this)}_getTextSize(t){const i=this.dummyCanvas.getContext("2d");i.save(),i.font=this._getContextFont();const r=i.measureText(t);return i.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=$l(this.text()),n=[];let i=0;for(let C=0;C<t.length;C++)n.push({char:t[C],width:this._getTextSize(t[C]).width}),i+=n[C].width;const{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=i,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const l=this.letterSpacing(),f=this.align(),d=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*l,0);let m=0;f==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),f==="right"&&(m=Math.max(0,this.pathLength-g));let _=m;for(let C=0;C<n.length;C++){const E=this._getPointAtLength(_);if(!E)return;const R=n[C].char;let v=n[C].width+l;if(R===" "&&f==="justify"){const L=this.text().split(" ").length-1;v+=(this.pathLength-g)/L}const D=this._getPointAtLength(_+v);if(!D)return;const z=yn.getLineLength(E.x,E.y,D.x,D.y);let G=0;if(d)try{G=d(n[C-1].char,R)*this.fontSize()}catch{G=0}E.x+=G,D.x+=G,this.textWidth+=G;const N=yn.getPointOnLine(G+z/2,E.x,E.y,D.x,D.y),M=Math.atan2(D.y-E.y,D.x-E.x);this.glyphInfo.push({transposeX:N.x,transposeY:N.y,text:t[C],rotation:M,p0:E,p1:D,width:z}),_+=v}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});let n=t[0]||0,i=t[0]||0,r=t[1]||0,l=t[1]||0,f,d;for(let m=0;m<t.length/2;m++)f=t[m*2],d=t[m*2+1],n=Math.min(n,f),i=Math.max(i,f),r=Math.min(r,d),l=Math.max(l,d);const g=this.fontSize();return{x:n-g/2,y:r-g/2,width:i-n+g,height:l-r+g}}destroy(){return pt.releaseCanvas(this.dummyCanvas),super.destroy()}}fi.prototype._fillFunc=$2;fi.prototype._strokeFunc=tS;fi.prototype._fillFuncHit=$2;fi.prototype._strokeFuncHit=tS;fi.prototype.className="TextPath";fi.prototype._attrsAffectingSize=["text","fontSize","data"];Dn(fi);st.addGetterSetter(fi,"data");st.addGetterSetter(fi,"fontFamily","Arial");st.addGetterSetter(fi,"fontSize",12,Ht());st.addGetterSetter(fi,"fontStyle",W2);st.addGetterSetter(fi,"align","left");st.addGetterSetter(fi,"letterSpacing",0,Ht());st.addGetterSetter(fi,"textBaseline","middle");st.addGetterSetter(fi,"fontVariant",W2);st.addGetterSetter(fi,"text",H5);st.addGetterSetter(fi,"textDecoration","");st.addGetterSetter(fi,"kerningFunc",void 0);const eS="tr-konva",P5=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(o=>o+`.${eS}`).join(" "),K1="nodesRect",I5=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],k5={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},q5="ontouchstart"in kt._global;function V5(o,t,n){if(o==="rotater")return n;t+=pt.degToRad(k5[o]||0);const i=(pt.radToDeg(t)%360+360)%360;return pt._inRange(i,315+22.5,360)||pt._inRange(i,0,22.5)?"ns-resize":pt._inRange(i,45-22.5,45+22.5)?"nesw-resize":pt._inRange(i,90-22.5,90+22.5)?"ew-resize":pt._inRange(i,135-22.5,135+22.5)?"nwse-resize":pt._inRange(i,180-22.5,180+22.5)?"ns-resize":pt._inRange(i,225-22.5,225+22.5)?"nesw-resize":pt._inRange(i,270-22.5,270+22.5)?"ew-resize":pt._inRange(i,315-22.5,315+22.5)?"nwse-resize":(pt.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}const hg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function Y5(o){return{x:o.x+o.width/2*Math.cos(o.rotation)+o.height/2*Math.sin(-o.rotation),y:o.y+o.height/2*Math.cos(o.rotation)+o.width/2*Math.sin(o.rotation)}}function nS(o,t,n){const i=n.x+(o.x-n.x)*Math.cos(t)-(o.y-n.y)*Math.sin(t),r=n.y+(o.x-n.x)*Math.sin(t)+(o.y-n.y)*Math.cos(t);return{...o,rotation:o.rotation+t,x:i,y:r}}function K5(o,t){const n=Y5(o);return nS(o,t,n)}function Q5(o,t,n){let i=t;for(let r=0;r<o.length;r++){const l=kt.getAngle(o[r]),f=Math.abs(l-t)%(Math.PI*2);Math.min(f,Math.PI*2-f)<n&&(i=l)}return i}let Nm=0;class He extends rf{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(P5,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return pt.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return eS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const n=t.filter(r=>r.isAncestorOf(this)?(pt.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=n,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){const f=r._attrsAffectingSize.map(d=>d+"Change."+this._getEventNamespace()).join(" ");r.on(f,l)}r.on(I5.map(f=>f+`.${this._getEventNamespace()}`).join(" "),l),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let n;t.on(`dragstart.${this._getEventNamespace()}`,i=>{n=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(i,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!n)return;const r=t.getAbsolutePosition(),l=r.x-n.x,f=r.y-n.y;this.nodes().forEach(d=>{if(d===t||d.isDragging())return;const g=d.getAbsolutePosition();d.setAbsolutePosition({x:g.x+l,y:g.y+f}),d.startDrag(i)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(K1),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(K1,this.__getNodeRect)}__getNodeShape(t,n=this.rotation(),i){const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=t.getAbsoluteScale(i),f=t.getAbsolutePosition(i),d=r.x*l.x-t.offsetX()*l.x,g=r.y*l.y-t.offsetY()*l.y,m=(kt.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),_={x:f.x+d*Math.cos(m)+g*Math.sin(-m),y:f.y+g*Math.cos(m)+d*Math.sin(m),width:r.width*l.x,height:r.height*l.y,rotation:m};return nS(_,-kt.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const _=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),C=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}],E=m.getAbsoluteTransform();C.forEach(function(R){const v=E.point(R);n.push(v)})});const i=new Ta;i.rotate(-kt.getAngle(this.rotation()));let r=1/0,l=1/0,f=-1/0,d=-1/0;n.forEach(function(m){const _=i.point(m);r===void 0&&(r=f=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),f=Math.max(f,_.x),d=Math.max(d,_.y)}),i.invert();const g=i.point({x:r,y:l});return{x:g.x,y:g.y,width:f-r,height:d-l,rotation:kt.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),hg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const n=new hd({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:q5?10:"auto"}),i=this;n.on("mousedown touchstart",function(r){i._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{const r=kt.getAngle(this.rotation()),l=this.rotateAnchorCursor(),f=V5(t,r,l);n.getStage().content&&(n.getStage().content.style.cursor=f),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const t=new Dt({name:"back",width:0,height:0,sceneFunc(n,i){const r=i.getParent(),l=r.padding();n.beginPath(),n.rect(-l,-l,i.width()+l*2,i.height()+l*2),n.moveTo(i.width()/2,-l),r.rotateEnabled()&&r.rotateLineVisible()&&n.lineTo(i.width()/2,-r.rotateAnchorOffset()*pt._sign(i.height())-l),n.fillStrokeShape(i)},hitFunc:(n,i)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();n.beginPath(),n.rect(-r,-r,i.width()+r*2,i.height()+r*2),n.fillStrokeShape(i)}});this.add(t),this._proxyDrag(t),t.on("dragstart",n=>{n.cancelBubble=!0}),t.on("dragmove",n=>{n.cancelBubble=!0}),t.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const n=this._getNodeRect(),i=n.width,r=n.height,l=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));this.sin=Math.abs(r/l),this.cos=Math.abs(i/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const f=t.target.getAbsolutePosition(),d=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:d.x-f.x,y:d.y-f.y},Nm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:t.evt,target:g})})}_handleMouseMove(t){let n,i,r;const l=this.findOne("."+this._movingAnchorName),f=l.getStage();f.setPointersPositions(t);const d=f.getPointerPosition();let g={x:d.x-this._anchorDragOffset.x,y:d.y-this._anchorDragOffset.y};const m=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,t)),l.setAbsolutePosition(g);const _=l.getAbsolutePosition();if(m.x===_.x&&m.y===_.y)return;if(this._movingAnchorName==="rotater"){const N=this._getNodeRect();n=l.x()-N.width/2,i=-l.y()+N.height/2;let M=Math.atan2(-i,n)+Math.PI/2;N.height<0&&(M-=Math.PI);const w=kt.getAngle(this.rotation())+M,A=kt.getAngle(this.rotationSnapTolerance()),y=Q5(this.rotationSnaps(),w,A)-N.rotation,B=K5(N,y);this._fitNodesInto(B,t);return}const C=this.shiftBehavior();let E;C==="inverted"?E=this.keepRatio()&&!t.shiftKey:C==="none"?E=this.keepRatio():E=this.keepRatio()||t.shiftKey;let R=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(N.x-l.x(),2)+Math.pow(N.y-l.y(),2));const M=this.findOne(".top-left").x()>N.x?-1:1,L=this.findOne(".top-left").y()>N.y?-1:1;n=r*this.cos*M,i=r*this.sin*L,this.findOne(".top-left").x(N.x-n),this.findOne(".top-left").y(N.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(l.x()-N.x,2)+Math.pow(N.y-l.y(),2));const M=this.findOne(".top-right").x()<N.x?-1:1,L=this.findOne(".top-right").y()>N.y?-1:1;n=r*this.cos*M,i=r*this.sin*L,this.findOne(".top-right").x(N.x+n),this.findOne(".top-right").y(N.y-i)}var v=l.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(N.x-l.x(),2)+Math.pow(l.y()-N.y,2));const M=N.x<l.x()?-1:1,L=l.y()<N.y?-1:1;n=r*this.cos*M,i=r*this.sin*L,l.x(N.x-n),l.y(N.y+i)}v=l.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(l.x()-N.x,2)+Math.pow(l.y()-N.y,2));const M=this.findOne(".bottom-right").x()<N.x?-1:1,L=this.findOne(".bottom-right").y()<N.y?-1:1;n=r*this.cos*M,i=r*this.sin*L,this.findOne(".bottom-right").x(N.x+n),this.findOne(".bottom-right").y(N.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(R=this.centeredScaling()||t.altKey,R){const N=this.findOne(".top-left"),M=this.findOne(".bottom-right"),L=N.x(),w=N.y(),A=this.getWidth()-M.x(),O=this.getHeight()-M.y();M.move({x:-L,y:-w}),N.move({x:A,y:O})}const D=this.findOne(".top-left").getAbsolutePosition();n=D.x,i=D.y;const z=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),G=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:i,width:z,height:G,rotation:kt.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const i=this.getNode();Nm--,this._fire("transformend",{evt:t,target:i}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),i&&this._nodes.forEach(r=>{var l;r._fire("transformend",{evt:t,target:r}),(l=r.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,n){const i=this._getNodeRect(),r=1;if(pt._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(pt._inRange(t.height,-this.padding()*2-r,r)){this.update();return}const l=new Ta;if(l.rotate(kt.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=l.point({x:-this.padding()*2,y:0});t.x+=E.x,t.y+=E.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=l.point({x:0,y:-this.padding()*2});t.x+=E.x,t.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(i,t);E?t=E:pt.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const f=1e7,d=new Ta;d.translate(i.x,i.y),d.rotate(i.rotation),d.scale(i.width/f,i.height/f);const g=new Ta,m=t.width/f,_=t.height/f;this.flipEnabled()===!1?(g.translate(t.x,t.y),g.rotate(t.rotation),g.translate(t.width<0?t.width:0,t.height<0?t.height:0),g.scale(Math.abs(m),Math.abs(_))):(g.translate(t.x,t.y),g.rotate(t.rotation),g.scale(m,_));const C=g.multiply(d.invert());this._nodes.forEach(E=>{var R;if(!E.getStage())return;const v=E.getParent().getAbsoluteTransform(),D=E.getTransform().copy();D.translate(E.offsetX(),E.offsetY());const z=new Ta;z.multiply(v.copy().invert()).multiply(C).multiply(v).multiply(D);const G=z.decompose();E.setAttrs(G),(R=E.getLayer())===null||R===void 0||R.batchDraw()}),this.rotation(pt._getRotation(t.rotation)),this._nodes.forEach(E=>{this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,n){this.findOne(t).setAttrs(n)}update(){var t;const n=this._getNodeRect();this.rotation(pt._getRotation(n.rotation));const i=n.width,r=n.height,l=this.enabledAnchors(),f=this.resizeEnabled(),d=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(C=>{C.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+d,offsetY:g/2+d,visible:f&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:g/2+d,visible:f&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:g/2-d,offsetY:g/2+d,visible:f&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:g/2+d,visible:f&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:r/2,offsetX:g/2-d,visible:f&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:g/2+d,offsetY:g/2-d,visible:f&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:r,offsetY:g/2-d,visible:f&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:r,offsetX:g/2-d,offsetY:g/2-d,visible:f&&l.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*pt._sign(r)-d,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(C=>C.draggable()),x:0,y:0});const _=this.anchorStyleFunc();_&&m.forEach(C=>{_(C)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),rf.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Lt.prototype.toObject.call(this)}clone(t){return Lt.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}He.isTransforming=()=>Nm>0;function X5(o){return o instanceof Array||pt.warn("enabledAnchors value should be an array"),o instanceof Array&&o.forEach(function(t){hg.indexOf(t)===-1&&pt.warn("Unknown anchor name: "+t+". Available names are: "+hg.join(", "))}),o||[]}He.prototype.className="Transformer";Dn(He);st.addGetterSetter(He,"enabledAnchors",hg,X5);st.addGetterSetter(He,"flipEnabled",!0,Nr());st.addGetterSetter(He,"resizeEnabled",!0);st.addGetterSetter(He,"anchorSize",10,Ht());st.addGetterSetter(He,"rotateEnabled",!0);st.addGetterSetter(He,"rotateLineVisible",!0);st.addGetterSetter(He,"rotationSnaps",[]);st.addGetterSetter(He,"rotateAnchorOffset",50,Ht());st.addGetterSetter(He,"rotateAnchorCursor","crosshair");st.addGetterSetter(He,"rotationSnapTolerance",5,Ht());st.addGetterSetter(He,"borderEnabled",!0);st.addGetterSetter(He,"anchorStroke","rgb(0, 161, 255)");st.addGetterSetter(He,"anchorStrokeWidth",1,Ht());st.addGetterSetter(He,"anchorFill","white");st.addGetterSetter(He,"anchorCornerRadius",0,Ht());st.addGetterSetter(He,"borderStroke","rgb(0, 161, 255)");st.addGetterSetter(He,"borderStrokeWidth",1,Ht());st.addGetterSetter(He,"borderDash");st.addGetterSetter(He,"keepRatio",!0);st.addGetterSetter(He,"shiftBehavior","default");st.addGetterSetter(He,"centeredScaling",!1);st.addGetterSetter(He,"ignoreStroke",!1);st.addGetterSetter(He,"padding",0,Ht());st.addGetterSetter(He,"nodes");st.addGetterSetter(He,"node");st.addGetterSetter(He,"boundBoxFunc");st.addGetterSetter(He,"anchorDragBoundFunc");st.addGetterSetter(He,"anchorStyleFunc");st.addGetterSetter(He,"shouldOverdrawWholeArea",!1);st.addGetterSetter(He,"useSingleNodeRotation",!0);st.backCompat(He,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class ul extends Dt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,kt.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}ul.prototype.className="Wedge";ul.prototype._centroid=!0;ul.prototype._attrsAffectingSize=["radius"];Dn(ul);st.addGetterSetter(ul,"radius",0,Ht());st.addGetterSetter(ul,"angle",0,Ht());st.addGetterSetter(ul,"clockwise",!1);st.backCompat(ul,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Q1(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const F5=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],J5=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Z5(o,t){const n=o.data,i=o.width,r=o.height;let l,f,d,g,m,_,C,E,R,v,D,z,G,N,M,L,w,A,O,y;const B=t+t+1,U=i-1,P=r-1,K=t+1,Y=K*(K+1)/2,Q=new Q1,V=F5[t],j=J5[t];let I=null,X=Q,Z=null,at=null;for(let J=1;J<B;J++)X=X.next=new Q1,J===K&&(I=X);X.next=Q,d=f=0;for(let J=0;J<r;J++){z=G=N=M=g=m=_=C=0,E=K*(L=n[f]),R=K*(w=n[f+1]),v=K*(A=n[f+2]),D=K*(O=n[f+3]),g+=Y*L,m+=Y*w,_+=Y*A,C+=Y*O,X=Q;for(let rt=0;rt<K;rt++)X.r=L,X.g=w,X.b=A,X.a=O,X=X.next;for(let rt=1;rt<K;rt++)l=f+((U<rt?U:rt)<<2),g+=(X.r=L=n[l])*(y=K-rt),m+=(X.g=w=n[l+1])*y,_+=(X.b=A=n[l+2])*y,C+=(X.a=O=n[l+3])*y,z+=L,G+=w,N+=A,M+=O,X=X.next;Z=Q,at=I;for(let rt=0;rt<i;rt++)n[f+3]=O=C*V>>j,O!==0?(O=255/O,n[f]=(g*V>>j)*O,n[f+1]=(m*V>>j)*O,n[f+2]=(_*V>>j)*O):n[f]=n[f+1]=n[f+2]=0,g-=E,m-=R,_-=v,C-=D,E-=Z.r,R-=Z.g,v-=Z.b,D-=Z.a,l=d+((l=rt+t+1)<U?l:U)<<2,z+=Z.r=n[l],G+=Z.g=n[l+1],N+=Z.b=n[l+2],M+=Z.a=n[l+3],g+=z,m+=G,_+=N,C+=M,Z=Z.next,E+=L=at.r,R+=w=at.g,v+=A=at.b,D+=O=at.a,z-=L,G-=w,N-=A,M-=O,at=at.next,f+=4;d+=i}for(let J=0;J<i;J++){G=N=M=z=m=_=C=g=0,f=J<<2,E=K*(L=n[f]),R=K*(w=n[f+1]),v=K*(A=n[f+2]),D=K*(O=n[f+3]),g+=Y*L,m+=Y*w,_+=Y*A,C+=Y*O,X=Q;for(let it=0;it<K;it++)X.r=L,X.g=w,X.b=A,X.a=O,X=X.next;let rt=i;for(let it=1;it<=t;it++)f=rt+J<<2,g+=(X.r=L=n[f])*(y=K-it),m+=(X.g=w=n[f+1])*y,_+=(X.b=A=n[f+2])*y,C+=(X.a=O=n[f+3])*y,z+=L,G+=w,N+=A,M+=O,X=X.next,it<P&&(rt+=i);f=J,Z=Q,at=I;for(let it=0;it<r;it++)l=f<<2,n[l+3]=O=C*V>>j,O>0?(O=255/O,n[l]=(g*V>>j)*O,n[l+1]=(m*V>>j)*O,n[l+2]=(_*V>>j)*O):n[l]=n[l+1]=n[l+2]=0,g-=E,m-=R,_-=v,C-=D,E-=Z.r,R-=Z.g,v-=Z.b,D-=Z.a,l=J+((l=it+K)<P?l:P)*i<<2,g+=z+=Z.r=n[l],m+=G+=Z.g=n[l+1],_+=N+=Z.b=n[l+2],C+=M+=Z.a=n[l+3],Z=Z.next,E+=L=at.r,R+=w=at.g,v+=A=at.b,D+=O=at.a,z-=L,G-=w,N-=A,M-=O,at=at.next,f+=i}}const W5=function(t){const n=Math.round(this.blurRadius());n>0&&Z5(t,n)};st.addGetterSetter(Lt,"blurRadius",0,Ht(),st.afterSetFilter);const $5=function(o){const t=this.brightness()*255,n=o.data,i=n.length;for(let r=0;r<i;r+=4)n[r]+=t,n[r+1]+=t,n[r+2]+=t};st.addGetterSetter(Lt,"brightness",0,Ht(),st.afterSetFilter);const t6=function(o){const t=this.brightness(),n=o.data,i=n.length;for(let r=0;r<i;r+=4)n[r]=Math.min(255,n[r]*t),n[r+1]=Math.min(255,n[r+1]*t),n[r+2]=Math.min(255,n[r+2]*t)},e6=function(o){const t=Math.pow((this.contrast()+100)/100,2),n=o.data,i=n.length;let r=150,l=150,f=150;for(let d=0;d<i;d+=4)r=n[d],l=n[d+1],f=n[d+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,l/=255,l-=.5,l*=t,l+=.5,l*=255,f/=255,f-=.5,f*=t,f+=.5,f*=255,r=r<0?0:r>255?255:r,l=l<0?0:l>255?255:l,f=f<0?0:f>255?255:f,n[d]=r,n[d+1]=l,n[d+2]=f};st.addGetterSetter(Lt,"contrast",0,Ht(),st.afterSetFilter);const n6=function(o){var t,n,i,r,l,f,d,g,m;const _=o.data,C=o.width,E=o.height,R=Math.min(1,Math.max(0,(n=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:.5)),v=Math.min(1,Math.max(0,(r=(i=this.embossWhiteLevel)===null||i===void 0?void 0:i.call(this))!==null&&r!==void 0?r:.5)),z=(d={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(f=(l=this.embossDirection)===null||l===void 0?void 0:l.call(this))!==null&&f!==void 0?f:"top-left"])!==null&&d!==void 0?d:315,G=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),N=R*10,M=v*255,L=z*Math.PI/180,w=Math.cos(L),A=Math.sin(L),O=128/1020*N,y=new Uint8ClampedArray(_),B=new Float32Array(C*E);for(let Q=0,V=0;V<_.length;V+=4,Q++)B[Q]=.2126*y[V]+.7152*y[V+1]+.0722*y[V+2];const U=[-1,0,1,-2,0,2,-1,0,1],P=[-1,-2,-1,0,0,0,1,2,1],K=[-C-1,-C,-C+1,-1,0,1,C-1,C,C+1],Y=Q=>Q<0?0:Q>255?255:Q;for(let Q=1;Q<E-1;Q++)for(let V=1;V<C-1;V++){const j=Q*C+V;let I=0,X=0;I+=B[j+K[0]]*U[0],X+=B[j+K[0]]*P[0],I+=B[j+K[1]]*U[1],X+=B[j+K[1]]*P[1],I+=B[j+K[2]]*U[2],X+=B[j+K[2]]*P[2],I+=B[j+K[3]]*U[3],X+=B[j+K[3]]*P[3],I+=B[j+K[5]]*U[5],X+=B[j+K[5]]*P[5],I+=B[j+K[6]]*U[6],X+=B[j+K[6]]*P[6],I+=B[j+K[7]]*U[7],X+=B[j+K[7]]*P[7],I+=B[j+K[8]]*U[8],X+=B[j+K[8]]*P[8];const Z=w*I+A*X,at=Y(M+Z*O),J=j*4;if(G){const rt=at-M;_[J]=Y(y[J]+rt),_[J+1]=Y(y[J+1]+rt),_[J+2]=Y(y[J+2]+rt),_[J+3]=y[J+3]}else _[J]=_[J+1]=_[J+2]=at,_[J+3]=y[J+3]}for(let Q=0;Q<C;Q++){let V=Q*4,j=((E-1)*C+Q)*4;_[V]=y[V],_[V+1]=y[V+1],_[V+2]=y[V+2],_[V+3]=y[V+3],_[j]=y[j],_[j+1]=y[j+1],_[j+2]=y[j+2],_[j+3]=y[j+3]}for(let Q=1;Q<E-1;Q++){let V=Q*C*4,j=(Q*C+(C-1))*4;_[V]=y[V],_[V+1]=y[V+1],_[V+2]=y[V+2],_[V+3]=y[V+3],_[j]=y[j],_[j+1]=y[j+1],_[j+2]=y[j+2],_[j+3]=y[j+3]}return o};st.addGetterSetter(Lt,"embossStrength",.5,Ht(),st.afterSetFilter);st.addGetterSetter(Lt,"embossWhiteLevel",.5,Ht(),st.afterSetFilter);st.addGetterSetter(Lt,"embossDirection","top-left",void 0,st.afterSetFilter);st.addGetterSetter(Lt,"embossBlend",!1,void 0,st.afterSetFilter);function Rp(o,t,n,i,r){const l=n-t,f=r-i;if(l===0)return i+f/2;if(f===0)return i;let d=(o-t)/l;return d=f*d+i,d}const i6=function(o){const t=o.data,n=t.length;let i=t[0],r=i,l,f=t[1],d=f,g,m=t[2],_=m,C;const E=this.enhance();if(E===0)return;for(let M=0;M<n;M+=4)l=t[M+0],l<i?i=l:l>r&&(r=l),g=t[M+1],g<f?f=g:g>d&&(d=g),C=t[M+2],C<m?m=C:C>_&&(_=C);r===i&&(r=255,i=0),d===f&&(d=255,f=0),_===m&&(_=255,m=0);let R,v,D,z,G,N;if(E>0)R=r+E*(255-r),v=i-E*(i-0),D=d+E*(255-d),z=f-E*(f-0),G=_+E*(255-_),N=m-E*(m-0);else{const M=(r+i)*.5;R=r+E*(r-M),v=i+E*(i-M);const L=(d+f)*.5;D=d+E*(d-L),z=f+E*(f-L);const w=(_+m)*.5;G=_+E*(_-w),N=m+E*(m-w)}for(let M=0;M<n;M+=4)t[M+0]=Rp(t[M+0],i,r,v,R),t[M+1]=Rp(t[M+1],f,d,z,D),t[M+2]=Rp(t[M+2],m,_,N,G)};st.addGetterSetter(Lt,"enhance",0,Ht(),st.afterSetFilter);const a6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4){const r=.34*t[i]+.5*t[i+1]+.16*t[i+2];t[i]=r,t[i+1]=r,t[i+2]=r}};st.addGetterSetter(Lt,"hue",0,Ht(),st.afterSetFilter);st.addGetterSetter(Lt,"saturation",0,Ht(),st.afterSetFilter);st.addGetterSetter(Lt,"luminance",0,Ht(),st.afterSetFilter);const r6=function(o){const t=o.data,n=t.length,i=1,r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,f=this.luminance()*127,d=i*r*Math.cos(l*Math.PI/180),g=i*r*Math.sin(l*Math.PI/180),m=.299*i+.701*d+.167*g,_=.587*i-.587*d+.33*g,C=.114*i-.114*d-.497*g,E=.299*i-.299*d-.328*g,R=.587*i+.413*d+.035*g,v=.114*i-.114*d+.293*g,D=.299*i-.3*d+1.25*g,z=.587*i-.586*d-1.05*g,G=.114*i+.886*d-.2*g;let N,M,L,w;for(let A=0;A<n;A+=4)N=t[A+0],M=t[A+1],L=t[A+2],w=t[A+3],t[A+0]=m*N+_*M+C*L+f,t[A+1]=E*N+R*M+v*L+f,t[A+2]=D*N+z*M+G*L+f,t[A+3]=w},s6=function(o){const t=o.data,n=t.length,i=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,f=i*r*Math.cos(l*Math.PI/180),d=i*r*Math.sin(l*Math.PI/180),g=.299*i+.701*f+.167*d,m=.587*i-.587*f+.33*d,_=.114*i-.114*f-.497*d,C=.299*i-.299*f-.328*d,E=.587*i+.413*f+.035*d,R=.114*i-.114*f+.293*d,v=.299*i-.3*f+1.25*d,D=.587*i-.586*f-1.05*d,z=.114*i+.886*f-.2*d;for(let G=0;G<n;G+=4){const N=t[G+0],M=t[G+1],L=t[G+2],w=t[G+3];t[G+0]=g*N+m*M+_*L,t[G+1]=C*N+E*M+R*L,t[G+2]=v*N+D*M+z*L,t[G+3]=w}};st.addGetterSetter(Lt,"hue",0,Ht(),st.afterSetFilter);st.addGetterSetter(Lt,"saturation",0,Ht(),st.afterSetFilter);st.addGetterSetter(Lt,"value",0,Ht(),st.afterSetFilter);const l6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]},o6=function(o,t,n){const i=o.data,r=t.data,l=o.width,f=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||f/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=l,D=360/v*Math.PI/180;for(let z=0;z<v;z+=1){const G=Math.sin(z*D),N=Math.cos(z*D);for(let M=0;M<R;M+=1){_=Math.floor(d+m*M/R*N),C=Math.floor(g+m*M/R*G);let L=(C*l+_)*4;const w=i[L+0],A=i[L+1],O=i[L+2],y=i[L+3];L=(z+M*l)*4,r[L+0]=w,r[L+1]=A,r[L+2]=O,r[L+3]=y}}},u6=function(o,t,n){const i=o.data,r=t.data,l=o.width,f=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||f/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=l,D=0;let z,G;for(_=0;_<l;_+=1)for(C=0;C<f;C+=1){const N=_-d,M=C-g,L=Math.sqrt(N*N+M*M)*R/m;let w=(Math.atan2(M,N)*180/Math.PI+360+D)%360;w=w*v/360,z=Math.floor(w),G=Math.floor(L);let A=(G*l+z)*4;const O=i[A+0],y=i[A+1],B=i[A+2],U=i[A+3];A=(C*l+_)*4,r[A+0]=O,r[A+1]=y,r[A+2]=B,r[A+3]=U}},c6=function(o){const t=o.width,n=o.height;let i,r,l,f,d,g,m,_,C,E,R=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),D=Math.floor(t*(v%360)/360);if(R<1)return;const z=pt.createCanvasElement();z.width=t,z.height=n;const G=z.getContext("2d").getImageData(0,0,t,n);pt.releaseCanvas(z),o6(o,G,{polarCenterX:t/2,polarCenterY:n/2});let N=t/Math.pow(2,R);for(;N<=8;)N=N*2,R-=1;N=Math.ceil(N);let M=N,L=0,w=M,A=1;for(D+N>t&&(L=M,w=0,A=-1),r=0;r<n;r+=1)for(i=L;i!==w;i+=A)l=Math.round(i+D)%t,C=(t*r+l)*4,d=G.data[C+0],g=G.data[C+1],m=G.data[C+2],_=G.data[C+3],E=(t*r+i)*4,G.data[E+0]=d,G.data[E+1]=g,G.data[E+2]=m,G.data[E+3]=_;for(r=0;r<n;r+=1)for(M=Math.floor(N),f=0;f<R;f+=1){for(i=0;i<M+1;i+=1)C=(t*r+i)*4,d=G.data[C+0],g=G.data[C+1],m=G.data[C+2],_=G.data[C+3],E=(t*r+M*2-i-1)*4,G.data[E+0]=d,G.data[E+1]=g,G.data[E+2]=m,G.data[E+3]=_;M*=2}u6(G,o,{})};st.addGetterSetter(Lt,"kaleidoscopePower",2,Ht(),st.afterSetFilter);st.addGetterSetter(Lt,"kaleidoscopeAngle",0,Ht(),st.afterSetFilter);function J0(o,t,n){let i=(n*o.width+t)*4;const r=[];return r.push(o.data[i++],o.data[i++],o.data[i++],o.data[i++]),r}function Yh(o,t){return Math.sqrt(Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)+Math.pow(o[2]-t[2],2))}function f6(o){const t=[0,0,0];for(let n=0;n<o.length;n++)t[0]+=o[n][0],t[1]+=o[n][1],t[2]+=o[n][2];return t[0]/=o.length,t[1]/=o.length,t[2]/=o.length,t}function h6(o,t){const n=J0(o,0,0),i=J0(o,o.width-1,0),r=J0(o,0,o.height-1),l=J0(o,o.width-1,o.height-1),f=t||10;if(Yh(n,i)<f&&Yh(i,l)<f&&Yh(l,r)<f&&Yh(r,n)<f){const d=f6([i,n,l,r]),g=[];for(let m=0;m<o.width*o.height;m++){const _=Yh(d,[o.data[m*4],o.data[m*4+1],o.data[m*4+2]]);g[m]=_<f?0:255}return g}}function d6(o,t){for(let n=0;n<o.width*o.height;n++)o.data[4*n+3]=t[n]}function g6(o,t,n){const i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,z=i[C*r+E];_+=o[D]*z}}f[m]=_===2040?255:0}return f}function p6(o,t,n){const i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,z=i[C*r+E];_+=o[D]*z}}f[m]=_>=1020?255:0}return f}function m6(o,t,n){const i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,z=i[C*r+E];_+=o[D]*z}}f[m]=_}return f}const v6=function(o){const t=this.threshold();let n=h6(o,t);return n&&(n=g6(n,o.width,o.height),n=p6(n,o.width,o.height),n=m6(n,o.width,o.height),d6(o,n)),o};st.addGetterSetter(Lt,"threshold",0,Ht(),st.afterSetFilter);const y6=function(o){const t=this.noise()*255,n=o.data,i=n.length,r=t/2;for(let l=0;l<i;l+=4)n[l+0]+=r-2*r*Math.random(),n[l+1]+=r-2*r*Math.random(),n[l+2]+=r-2*r*Math.random()};st.addGetterSetter(Lt,"noise",.2,Ht(),st.afterSetFilter);const S6=function(o){let t=Math.ceil(this.pixelSize()),n=o.width,i=o.height,r=Math.ceil(n/t),l=Math.ceil(i/t),f=o.data;if(t<=0){pt.error("pixelSize value can not be <= 0");return}for(let d=0;d<r;d+=1)for(let g=0;g<l;g+=1){let m=0,_=0,C=0,E=0;const R=d*t,v=R+t,D=g*t,z=D+t;let G=0;for(let N=R;N<v;N+=1)if(!(N>=n))for(let M=D;M<z;M+=1){if(M>=i)continue;const L=(n*M+N)*4;m+=f[L+0],_+=f[L+1],C+=f[L+2],E+=f[L+3],G+=1}m=m/G,_=_/G,C=C/G,E=E/G;for(let N=R;N<v;N+=1)if(!(N>=n))for(let M=D;M<z;M+=1){if(M>=i)continue;const L=(n*M+N)*4;f[L+0]=m,f[L+1]=_,f[L+2]=C,f[L+3]=E}}};st.addGetterSetter(Lt,"pixelSize",8,Ht(),st.afterSetFilter);const b6=function(o){const t=Math.round(this.levels()*254)+1,n=o.data,i=n.length,r=255/t;for(let l=0;l<i;l+=1)n[l]=Math.floor(n[l]/r)*r};st.addGetterSetter(Lt,"levels",.5,Ht(),st.afterSetFilter);const _6=function(o){const t=o.data,n=t.length,i=this.red(),r=this.green(),l=this.blue();for(let f=0;f<n;f+=4){const d=(.34*t[f]+.5*t[f+1]+.16*t[f+2])/255;t[f]=d*i,t[f+1]=d*r,t[f+2]=d*l,t[f+3]=t[f+3]}};st.addGetterSetter(Lt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Lt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Lt,"blue",0,A2,st.afterSetFilter);const E6=function(o){const t=o.data,n=t.length,i=this.red(),r=this.green(),l=this.blue(),f=this.alpha();for(let d=0;d<n;d+=4){const g=1-f;t[d]=i*f+t[d]*g,t[d+1]=r*f+t[d+1]*g,t[d+2]=l*f+t[d+2]*g}};st.addGetterSetter(Lt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Lt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Lt,"blue",0,A2,st.afterSetFilter);st.addGetterSetter(Lt,"alpha",1,function(o){return this._filterUpToDate=!1,o>1?1:o<0?0:o});const C6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4){const r=t[i+0],l=t[i+1],f=t[i+2];t[i+0]=Math.min(255,r*.393+l*.769+f*.189),t[i+1]=Math.min(255,r*.349+l*.686+f*.168),t[i+2]=Math.min(255,r*.272+l*.534+f*.131)}},T6=function(o){const n=o.data;for(let i=0;i<n.length;i+=4){const r=n[i],l=n[i+1],f=n[i+2];.2126*r+.7152*l+.0722*f>=128&&(n[i]=255-r,n[i+1]=255-l,n[i+2]=255-f)}return o},A6=function(o){const t=this.threshold()*255,n=o.data,i=n.length;for(let r=0;r<i;r+=1)n[r]=n[r]<t?0:255};st.addGetterSetter(Lt,"threshold",.5,Ht(),st.afterSetFilter);sf.Util._assign(sf,{Arc:ll,Arrow:du,Circle:df,Ellipse:ro,Image:Dr,Label:$m,Tag:gu,Line:ol,Path:yn,Rect:hd,RegularPolygon:so,Ring:pu,Sprite:us,Star:lo,Text:Cn,TextPath:fi,Transformer:He,Wedge:ul,Filters:{Blur:W5,Brightness:t6,Brighten:$5,Contrast:e6,Emboss:n6,Enhance:i6,Grayscale:a6,HSL:r6,HSV:s6,Invert:l6,Kaleidoscope:c6,Mask:v6,Noise:y6,Pixelate:S6,Posterize:b6,RGB:_6,RGBA:E6,Sepia:C6,Solarize:T6,Threshold:A6}});var wp={exports:{}},xp={exports:{}},Mp={exports:{}},Np={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X1;function O6(){return X1||(X1=1,(function(o){function t(j,I){var X=j.length;j.push(I);t:for(;0<X;){var Z=X-1>>>1,at=j[Z];if(0<r(at,I))j[Z]=I,j[X]=at,X=Z;else break t}}function n(j){return j.length===0?null:j[0]}function i(j){if(j.length===0)return null;var I=j[0],X=j.pop();if(X!==I){j[0]=X;t:for(var Z=0,at=j.length,J=at>>>1;Z<J;){var rt=2*(Z+1)-1,it=j[rt],q=rt+1,F=j[q];if(0>r(it,X))q<at&&0>r(F,it)?(j[Z]=F,j[q]=X,Z=q):(j[Z]=it,j[rt]=X,Z=rt);else if(q<at&&0>r(F,X))j[Z]=F,j[q]=X,Z=q;else break t}}return I}function r(j,I){var X=j.sortIndex-I.sortIndex;return X!==0?X:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,z=!1,G=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function L(j){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=j)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function w(j){if(D=!1,L(j),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&V(w,I.startTime-j)}}var A=!1,O=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,A){var j=o.unstable_now();B=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(O),O=-1),R=!0;var X=E;try{e:{for(L(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var Z=C.callback;if(typeof Z=="function"){C.callback=null,E=C.priorityLevel;var at=Z(C.expirationTime<=j);if(j=o.unstable_now(),typeof at=="function"){C.callback=at,L(j),I=!0;break e}C===n(g)&&i(g),L(j)}else i(g);C=n(g)}if(C!==null)I=!0;else{var J=n(m);J!==null&&V(w,J.startTime-j),I=!1}}break t}finally{C=null,E=X,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Q=Y.port2;Y.port1.onmessage=P,K=function(){Q.postMessage(null)}}else K=function(){G(P,0)};function V(j,I){O=G(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var X=E;E=I;try{return j()}finally{E=X}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=E;E=j;try{return I()}finally{E=X}},o.unstable_scheduleCallback=function(j,I,X){var Z=o.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Z+X:Z):X=Z,j){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=X+at,j={id:_++,callback:I,priorityLevel:j,startTime:X,expirationTime:at,sortIndex:-1},X>Z?(j.sortIndex=X,t(m,j),n(g)===null&&j===n(m)&&(D?(N(O),O=-1):D=!0,V(w,X-Z))):(j.sortIndex=at,t(g,j),v||R||(v=!0,A||(A=!0,K()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var X=E;E=I;try{return j.apply(this,arguments)}finally{E=X}}}})(Np)),Np}var F1;function R6(){return F1||(F1=1,Mp.exports=O6()),Mp.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J1;function w6(){return J1||(J1=1,(function(o){o.exports=function(t){function n(s,u,p,S){return new nc(s,u,p,S)}function i(){}function r(s){var u="https://react.dev/errors/"+s;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){var u=s,p=s;if(s.alternate)for(;u.return;)u=u.return;else{s=u;do u=s,(u.flags&4098)!==0&&(p=u.return),s=u.return;while(s)}return u.tag===3?p:null}function f(s){if(l(s)!==s)throw Error(r(188))}function d(s){var u=s.alternate;if(!u){if(u=l(s),u===null)throw Error(r(188));return u!==s?null:s}for(var p=s,S=u;;){var x=p.return;if(x===null)break;var H=x.alternate;if(H===null){if(S=x.return,S!==null){p=S;continue}break}if(x.child===H.child){for(H=x.child;H;){if(H===p)return f(x),s;if(H===S)return f(x),u;H=H.sibling}throw Error(r(188))}if(p.return!==S.return)p=x,S=H;else{for(var tt=!1,ot=x.child;ot;){if(ot===p){tt=!0,p=x,S=H;break}if(ot===S){tt=!0,S=x,p=H;break}ot=ot.sibling}if(!tt){for(ot=H.child;ot;){if(ot===p){tt=!0,p=H,S=x;break}if(ot===S){tt=!0,S=H,p=x;break}ot=ot.sibling}if(!tt)throw Error(r(189))}}if(p.alternate!==S)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:u}function g(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(u=g(s),u!==null)return u;s=s.sibling}return null}function m(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(s.tag!==4&&(u=m(s),u!==null))return u;s=s.sibling}return null}function _(s){return s===null||typeof s!="object"?null:(s=Po&&s[Po]||s["@@iterator"],typeof s=="function"?s:null)}function C(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Io?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case Os:return"Fragment";case Lo:return"Profiler";case Rs:return"StrictMode";case pr:return"Suspense";case mr:return"SuspenseList";case Qr:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case dr:return"Portal";case gr:return(s.displayName||"Context")+".Provider";case Go:return(s._context.displayName||"Context")+".Consumer";case lc:var u=s.render;return s=s.displayName,s||(s=u.displayName||u.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case oc:return u=s.displayName||null,u!==null?u:C(s.type)||"Memo";case vr:u=s._payload,s=s._init;try{return C(s(u))}catch{}}return null}function E(s){return{current:s}}function R(s){0>Us||(s.current=Xo[Us],Xo[Us]=null,Us--)}function v(s,u){Us++,Xo[Us]=s.current,s.current=u}function D(s){return s>>>=0,s===0?32:31-(p0(s)/m0|0)|0}function z(s){var u=s&42;if(u!==0)return u;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function G(s,u,p){var S=s.pendingLanes;if(S===0)return 0;var x=0,H=s.suspendedLanes,tt=s.pingedLanes;s=s.warmLanes;var ot=S&134217727;return ot!==0?(S=ot&~H,S!==0?x=z(S):(tt&=ot,tt!==0?x=z(tt):p||(p=ot&~s,p!==0&&(x=z(p))))):(ot=S&~H,ot!==0?x=z(ot):tt!==0?x=z(tt):p||(p=S&~s,p!==0&&(x=z(p)))),x===0?0:u!==0&&u!==x&&(u&H)===0&&(H=x&-x,p=u&-u,H>=p||H===32&&(p&4194048)!==0)?u:x}function N(s,u){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&u)===0}function M(s,u){switch(s){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L(){var s=qa;return qa<<=1,(qa&4194048)===0&&(qa=256),s}function w(){var s=Fo;return Fo<<=1,(Fo&62914560)===0&&(Fo=4194304),s}function A(s){for(var u=[],p=0;31>p;p++)u.push(s);return u}function O(s,u){s.pendingLanes|=u,u!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function y(s,u,p,S,x,H){var tt=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ot=s.entanglements,bt=s.expirationTimes,Nt=s.hiddenUpdates;for(p=tt&~p;0<p;){var Ut=31-Ci(p),Vt=1<<Ut;ot[Ut]=0,bt[Ut]=-1;var Xt=Nt[Ut];if(Xt!==null)for(Nt[Ut]=null,Ut=0;Ut<Xt.length;Ut++){var Se=Xt[Ut];Se!==null&&(Se.lane&=-536870913)}p&=~Vt}S!==0&&B(s,S,0),H!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=H&~(tt&~u))}function B(s,u,p){s.pendingLanes|=u,s.suspendedLanes&=~u;var S=31-Ci(u);s.entangledLanes|=u,s.entanglements[S]=s.entanglements[S]|1073741824|p&4194090}function U(s,u){var p=s.entangledLanes|=u;for(s=s.entanglements;p;){var S=31-Ci(p),x=1<<S;x&u|s[S]&u&&(s[S]|=u),p&=~x}}function P(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function K(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Y(s){if(typeof Gn=="function"&&ri(s),Bi&&typeof Bi.setStrictMode=="function")try{Bi.setStrictMode(Bl,s)}catch{}}function Q(s){if(Ac===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Ac=u&&u[1]||"",Ch=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ac+s+Ch}function V(s,u){if(!s||Bs)return"";Bs=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(u){var Vt=function(){throw Error()};if(Object.defineProperty(Vt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Vt,[])}catch(Se){var Xt=Se}Reflect.construct(s,[],Vt)}else{try{Vt.call()}catch(Se){Xt=Se}s.call(Vt.prototype)}}else{try{throw Error()}catch(Se){Xt=Se}(Vt=s())&&typeof Vt.catch=="function"&&Vt.catch(function(){})}}catch(Se){if(Se&&Xt&&typeof Se.stack=="string")return[Se.stack,Xt.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var H=S.DetermineComponentFrameRoot(),tt=H[0],ot=H[1];if(tt&&ot){var bt=tt.split(`
`),Nt=ot.split(`
`);for(x=S=0;S<bt.length&&!bt[S].includes("DetermineComponentFrameRoot");)S++;for(;x<Nt.length&&!Nt[x].includes("DetermineComponentFrameRoot");)x++;if(S===bt.length||x===Nt.length)for(S=bt.length-1,x=Nt.length-1;1<=S&&0<=x&&bt[S]!==Nt[x];)x--;for(;1<=S&&0<=x;S--,x--)if(bt[S]!==Nt[x]){if(S!==1||x!==1)do if(S--,x--,0>x||bt[S]!==Nt[x]){var Ut=`
`+bt[S].replace(" at new "," at ");return s.displayName&&Ut.includes("<anonymous>")&&(Ut=Ut.replace("<anonymous>",s.displayName)),Ut}while(1<=S&&0<=x);break}}}finally{Bs=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?Q(p):""}function j(s){switch(s.tag){case 26:case 27:case 5:return Q(s.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 15:return V(s.type,!1);case 11:return V(s.type.render,!1);case 1:return V(s.type,!0);case 31:return Q("Activity");default:return""}}function I(s){try{var u="";do u+=j(s),s=s.return;while(s);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function X(s,u){if(typeof s=="object"&&s!==null){var p=Th.get(s);return p!==void 0?p:(u={value:s,source:u,stack:I(u)},Th.set(s,u),u)}return{value:s,source:u,stack:I(u)}}function Z(s,u){br[zs++]=Ls,br[zs++]=Oc,Oc=s,Ls=u}function at(s,u,p){zi[Wi++]=Va,zi[Wi++]=Sa,zi[Wi++]=ts,ts=s;var S=Va;s=Sa;var x=32-Ci(S)-1;S&=~(1<<x),p+=1;var H=32-Ci(u)+x;if(30<H){var tt=x-x%5;H=(S&(1<<tt)-1).toString(32),S>>=tt,x-=tt,Va=1<<32-Ci(u)+x|p<<x|S,Sa=H+s}else Va=1<<H|p<<x|S,Sa=s}function J(s){s.return!==null&&(Z(s,1),at(s,1,0))}function rt(s){for(;s===Oc;)Oc=br[--zs],br[zs]=null,Ls=br[--zs],br[zs]=null;for(;s===ts;)ts=zi[--Wi],zi[Wi]=null,Sa=zi[--Wi],zi[Wi]=null,Va=zi[--Wi],zi[Wi]=null}function it(s,u){v(_r,u),v(Gs,s),v(kn,null),s=$f(u),R(kn),v(kn,s)}function q(){R(kn),R(Gs),R(_r)}function F(s){s.memoizedState!==null&&v(zl,s);var u=kn.current,p=Xr(u,s.type);u!==p&&(v(Gs,s),v(kn,p))}function $(s){Gs.current===s&&(R(kn),R(Gs)),zl.current===s&&(R(zl),La?oa._currentValue=Sr:oa._currentValue2=Sr)}function nt(s){var u=Error(r(418,""));throw ge(X(u,s)),_a}function ht(s,u){if(!gn)throw Error(r(175));i0(s.stateNode,s.type,s.memoizedProps,u,s)||nt(s)}function Tt(s){for(Qn=s.return;Qn;)switch(Qn.tag){case 5:case 13:ba=!1;return;case 27:case 3:ba=!0;return;default:Qn=Qn.return}}function jt(s){if(!gn||s!==Qn)return!1;if(!Pe)return Tt(s),Pe=!0,!1;var u=s.tag;if(wn?u!==3&&u!==27&&(u!==5||Sc(s.type)&&!Jr(s.type,s.memoizedProps))&&xn&&nt(s):u!==3&&(u!==5||Sc(s.type)&&!Jr(s.type,s.memoizedProps))&&xn&&nt(s),Tt(s),u===13){if(!gn)throw Error(r(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));xn=a0(s)}else xn=wn&&u===27?$d(s.type,xn):Qn?dh(s.stateNode):null;return!0}function Kt(){gn&&(xn=Qn=null,Pe=!1)}function Wt(){var s=Er;return s!==null&&(mi===null?mi=s:mi.push.apply(mi,s),Er=null),s}function ge(s){Er===null?Er=[s]:Er.push(s)}function Pt(s,u){return s===u&&(s!==0||1/s===1/u)||s!==s&&u!==u}function pe(s,u,p){La?(v(Rc,u._currentValue),u._currentValue=p):(v(Rc,u._currentValue2),u._currentValue2=p)}function xe(s){var u=Rc.current;La?s._currentValue=u:s._currentValue2=u,R(Rc)}function zt(s,u,p){for(;s!==null;){var S=s.alternate;if((s.childLanes&u)!==u?(s.childLanes|=u,S!==null&&(S.childLanes|=u)):S!==null&&(S.childLanes&u)!==u&&(S.childLanes|=u),s===p)break;s=s.return}}function ft(s,u,p,S){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var H=x.dependencies;if(H!==null){var tt=x.child;H=H.firstContext;t:for(;H!==null;){var ot=H;H=x;for(var bt=0;bt<u.length;bt++)if(ot.context===u[bt]){H.lanes|=p,ot=H.alternate,ot!==null&&(ot.lanes|=p),zt(H.return,p,s),S||(tt=null);break t}H=ot.next}}else if(x.tag===18){if(tt=x.return,tt===null)throw Error(r(341));tt.lanes|=p,H=tt.alternate,H!==null&&(H.lanes|=p),zt(tt,p,s),tt=null}else tt=x.child;if(tt!==null)tt.return=x;else for(tt=x;tt!==null;){if(tt===s){tt=null;break}if(x=tt.sibling,x!==null){x.return=tt.return,tt=x;break}tt=tt.return}x=tt}}function xt(s,u,p,S){s=null;for(var x=u,H=!1;x!==null;){if(!H){if((x.flags&524288)!==0)H=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var tt=x.alternate;if(tt===null)throw Error(r(387));if(tt=tt.memoizedProps,tt!==null){var ot=x.type;Ti(x.pendingProps.value,tt.value)||(s!==null?s.push(ot):s=[ot])}}else if(x===zl.current){if(tt=x.alternate,tt===null)throw Error(r(387));tt.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(oa):s=[oa])}x=x.return}s!==null&&ft(u,s,p,S),u.flags|=262144}function Qt(s){for(s=s.firstContext;s!==null;){var u=s.context;if(!Ti(La?u._currentValue:u._currentValue2,s.memoizedValue))return!0;s=s.next}return!1}function Jt(s){es=s,si=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function $t(s){return ae(es,s)}function ve(s,u){return es===null&&Jt(s),ae(s,u)}function ae(s,u){var p=La?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},si===null){if(s===null)throw Error(r(308));si=u,s.dependencies={lanes:0,firstContext:u},s.flags|=524288}else si=si.next=u;return p}function ln(){return{controller:new Ah,data:new Map,refCount:0}}function Sn(s){s.refCount--,s.refCount===0&&S0(wc,function(){s.controller.abort()})}function We(s){s!==Ll&&s.next===null&&(Ll===null?Je=Ll=s:Ll=Ll.next=s),Zo=!0,Oh||(Oh=!0,An())}function ut(s,u){if(!Hs&&Zo){Hs=!0;do for(var p=!1,S=Je;S!==null;){if(s!==0){var x=S.pendingLanes;if(x===0)var H=0;else{var tt=S.suspendedLanes,ot=S.pingedLanes;H=(1<<31-Ci(42|s)+1)-1,H&=x&~(tt&~ot),H=H&201326741?H&201326741|1:H?H|2:0}H!==0&&(p=!0,dn(S,H))}else H=Re,H=G(S,S===Ze?H:0,S.cancelPendingCommit!==null||S.timeoutHandle!==za),(H&3)===0||N(S,H)||(p=!0,dn(S,H));S=S.next}while(p);Hs=!1}}function Ot(){Mt()}function Mt(){Zo=Oh=!1;var s=0;$i!==0&&(Fi()&&(s=$i),$i=0);for(var u=Zi(),p=null,S=Je;S!==null;){var x=S.next,H=Ft(S,u);H===0?(S.next=null,p===null?Je=x:p.next=x,x===null&&(Ll=p)):(p=S,(s!==0||(H&3)!==0)&&(Zo=!0)),S=x}ut(s)}function Ft(s,u){for(var p=s.suspendedLanes,S=s.pingedLanes,x=s.expirationTimes,H=s.pendingLanes&-62914561;0<H;){var tt=31-Ci(H),ot=1<<tt,bt=x[tt];bt===-1?((ot&p)===0||(ot&S)!==0)&&(x[tt]=M(ot,u)):bt<=u&&(s.expiredLanes|=ot),H&=~ot}if(u=Ze,p=Re,p=G(s,s===u?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==za),S=s.callbackNode,p===0||s===u&&(Le===2||Le===9)||s.cancelPendingCommit!==null)return S!==null&&S!==null&&Cc(S),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||N(s,p)){if(u=p&-p,u===s.callbackPriority)return u;switch(S!==null&&Cc(S),K(p)){case 2:case 8:p=y0;break;case 32:p=_h;break;case 268435456:p=Eh;break;default:p=_h}return S=Ee.bind(null,s),p=Jo(p,S),s.callbackPriority=u,s.callbackNode=p,u}return S!==null&&S!==null&&Cc(S),s.callbackPriority=2,s.callbackNode=null,2}function Ee(s,u){if(Ve!==0&&Ve!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(Es()&&s.callbackNode!==p)return null;var S=Re;return S=G(s,s===Ze?S:0,s.cancelPendingCommit!==null||s.timeoutHandle!==za),S===0?null:(Ki(s,S,u),Ft(s,Zi()),s.callbackNode!=null&&s.callbackNode===p?Ee.bind(null,s):null)}function dn(s,u){if(Es())return null;Ki(s,u,!0)}function An(){cc?Vo(function(){(Te&6)!==0?Jo(bh,Ot):Mt()}):Jo(bh,Ot)}function ki(){return $i===0&&($i=L()),$i}function hi(s,u){if(Gl===null){var p=Gl=[];xc=0,Ya=ki(),Ai={status:"pending",value:void 0,then:function(S){p.push(S)}}}return xc++,u.then(Su,Su),u}function Su(){if(--xc===0&&Gl!==null){Ai!==null&&(Ai.status="fulfilled");var s=Gl;Gl=null,Ya=0,Ai=null;for(var u=0;u<s.length;u++)(0,s[u])()}}function er(s,u){var p=[],S={status:"pending",value:null,reason:null,then:function(x){p.push(x)}};return s.then(function(){S.status="fulfilled",S.value=u;for(var x=0;x<p.length;x++)(0,p[x])(u)},function(x){for(S.status="rejected",S.reason=x,x=0;x<p.length;x++)(0,p[x])(void 0)}),S}function cl(){var s=Cr.current;return s!==null?s:Ze.pooledCache}function Gt(s,u){u===null?v(Cr,Cr.current):v(Cr,u.pool)}function Yt(){var s=cl();return s===null?null:{parent:La?en._currentValue:en._currentValue2,pool:s}}function ne(s,u){if(Ti(s,u))return!0;if(typeof s!="object"||s===null||typeof u!="object"||u===null)return!1;var p=Object.keys(s),S=Object.keys(u);if(p.length!==S.length)return!1;for(S=0;S<p.length;S++){var x=p[S];if(!b0.call(u,x)||!Ti(s[x],u[x]))return!1}return!0}function Ae(s){return s=s.status,s==="fulfilled"||s==="rejected"}function qt(){}function jn(s,u,p){switch(p=s[p],p===void 0?s.push(u):p!==u&&(u.then(qt,qt),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,ze(s),s;default:if(typeof u.status=="string")u.then(qt,qt);else{if(s=Ze,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=u,s.status="pending",s.then(function(S){if(u.status==="pending"){var x=u;x.status="fulfilled",x.value=S}},function(S){if(u.status==="pending"){var x=u;x.status="rejected",x.reason=S}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,ze(s),s}throw Li=u,Ps}}function he(){if(Li===null)throw Error(r(459));var s=Li;return Li=null,s}function ze(s){if(s===Ps||s===Is)throw Error(r(483))}function me(){for(var s=ns,u=Mc=ns=0;u<s;){var p=ke[u];ke[u++]=null;var S=ke[u];ke[u++]=null;var x=ke[u];ke[u++]=null;var H=ke[u];if(ke[u++]=null,S!==null&&x!==null){var tt=S.pending;tt===null?x.next=x:(x.next=tt.next,tt.next=x),S.pending=x}H!==0&&vf(p,x,H)}}function Wn(s,u,p,S){ke[ns++]=s,ke[ns++]=u,ke[ns++]=p,ke[ns++]=S,Mc|=S,s.lanes|=S,s=s.alternate,s!==null&&(s.lanes|=S)}function nr(s,u,p,S){return Wn(s,u,p,S),co(s)}function cs(s,u){return Wn(s,null,null,u),co(s)}function vf(s,u,p){s.lanes|=p;var S=s.alternate;S!==null&&(S.lanes|=p);for(var x=!1,H=s.return;H!==null;)H.childLanes|=p,S=H.alternate,S!==null&&(S.childLanes|=p),H.tag===22&&(s=H.stateNode,s===null||s._visibility&1||(x=!0)),s=H,H=H.return;return s.tag===3?(H=s.stateNode,x&&u!==null&&(x=31-Ci(p),s=H.hiddenUpdates,S=s[x],S===null?s[x]=[u]:S.push(u),u.lane=p|536870912),H):null}function co(s){if(50<Za)throw Za=0,Bc=null,Error(r(185));for(var u=s.return;u!==null;)s=u,u=s.return;return s.tag===3?s.stateNode:null}function fo(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ho(s,u){s=s.updateQueue,u.updateQueue===s&&(u.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ir(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ar(s,u,p){var S=s.updateQueue;if(S===null)return null;if(S=S.shared,(Te&2)!==0){var x=S.pending;return x===null?u.next=u:(u.next=x.next,x.next=u),S.pending=u,u=co(s),vf(s,null,p),u}return Wn(s,S,u,p),co(s)}function na(s,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function Pn(s,u){var p=s.updateQueue,S=s.alternate;if(S!==null&&(S=S.updateQueue,p===S)){var x=null,H=null;if(p=p.firstBaseUpdate,p!==null){do{var tt={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};H===null?x=H=tt:H=H.next=tt,p=p.next}while(p!==null);H===null?x=H=u:H=H.next=u}else x=H=u;p={baseState:S.baseState,firstBaseUpdate:x,lastBaseUpdate:H,shared:S.shared,callbacks:S.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=u:s.next=u,p.lastBaseUpdate=u}function Vn(){if(wh){var s=Ai;if(s!==null)throw s}}function wa(s,u,p,S){wh=!1;var x=s.updateQueue;un=!1;var H=x.firstBaseUpdate,tt=x.lastBaseUpdate,ot=x.shared.pending;if(ot!==null){x.shared.pending=null;var bt=ot,Nt=bt.next;bt.next=null,tt===null?H=Nt:tt.next=Nt,tt=bt;var Ut=s.alternate;Ut!==null&&(Ut=Ut.updateQueue,ot=Ut.lastBaseUpdate,ot!==tt&&(ot===null?Ut.firstBaseUpdate=Nt:ot.next=Nt,Ut.lastBaseUpdate=bt))}if(H!==null){var Vt=x.baseState;tt=0,Ut=Nt=bt=null,ot=H;do{var Xt=ot.lane&-536870913,Se=Xt!==ot.lane;if(Se?(Re&Xt)===Xt:(S&Xt)===Xt){Xt!==0&&Xt===Ya&&(wh=!0),Ut!==null&&(Ut=Ut.next={lane:0,tag:ot.tag,payload:ot.payload,callback:null,next:null});t:{var ea=s,kl=ot;Xt=u;var rs=p;switch(kl.tag){case 1:if(ea=kl.payload,typeof ea=="function"){Vt=ea.call(rs,Vt,Xt);break t}Vt=ea;break t;case 3:ea.flags=ea.flags&-65537|128;case 0:if(ea=kl.payload,Xt=typeof ea=="function"?ea.call(rs,Vt,Xt):ea,Xt==null)break t;Vt=rc({},Vt,Xt);break t;case 2:un=!0}}Xt=ot.callback,Xt!==null&&(s.flags|=64,Se&&(s.flags|=8192),Se=x.callbacks,Se===null?x.callbacks=[Xt]:Se.push(Xt))}else Se={lane:Xt,tag:ot.tag,payload:ot.payload,callback:ot.callback,next:null},Ut===null?(Nt=Ut=Se,bt=Vt):Ut=Ut.next=Se,tt|=Xt;if(ot=ot.next,ot===null){if(ot=x.shared.pending,ot===null)break;Se=ot,ot=Se.next,Se.next=null,x.lastBaseUpdate=Se,x.shared.pending=null}}while(!0);Ut===null&&(bt=Vt),x.baseState=bt,x.firstBaseUpdate=Nt,x.lastBaseUpdate=Ut,H===null&&(x.shared.lanes=0),Ri|=tt,s.lanes=tt,s.memoizedState=Vt}}function bu(s,u){if(typeof s!="function")throw Error(r(191,s));s.call(u)}function gd(s,u){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)bu(p[s],u)}function pd(s,u){s=fa,v(tu,s),v(ks,u),fa=s|u.baseLanes}function _u(){v(tu,fa),v(ks,ks.current)}function fs(){fa=tu.current,R(ks),R(tu)}function bn(){throw Error(r(321))}function jr(s,u){if(u===null)return!1;for(var p=0;p<u.length&&p<s.length;p++)if(!Ti(s[p],u[p]))return!1;return!0}function Ur(s,u,p,S,x,H){return qe=H,se=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,re.H=s===null||s.memoizedState===null?xh:Ka,Vs=!1,H=p(S,x),Vs=!1,qs&&(H=hs(u,p,S,x)),fl(s),H}function fl(s){re.H=li;var u=De!==null&&De.next!==null;if(qe=0,Mn=De=se=null,eu=!1,Xn=0,gi=null,u)throw Error(r(300));s===null||qn||(s=s.dependencies,s!==null&&Qt(s)&&(qn=!0))}function hs(s,u,p,S){se=s;var x=0;do{if(qs&&(gi=null),Xn=0,qs=!1,25<=x)throw Error(r(301));if(x+=1,Mn=De=null,s.updateQueue!=null){var H=s.updateQueue;H.lastEffect=null,H.events=null,H.stores=null,H.memoCache!=null&&(H.memoCache.index=0)}re.H=Ks,H=u(p,S)}while(qs);return H}function Yn(){var s=re.H,u=s.useState()[0];return u=typeof u.then=="function"?hl(u):u,s=s.useState()[0],(De!==null?De.memoizedState:null)!==s&&(se.flags|=1024),u}function Eu(){var s=Ys!==0;return Ys=0,s}function Cu(s,u,p){u.updateQueue=s.updateQueue,u.flags&=-2053,s.lanes&=~p}function rr(s){if(eu){for(s=s.memoizedState;s!==null;){var u=s.queue;u!==null&&(u.pending=null),s=s.next}eu=!1}qe=0,Mn=De=se=null,qs=!1,Xn=Ys=0,gi=null}function In(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?se.memoizedState=Mn=s:Mn=Mn.next=s,Mn}function Un(){if(De===null){var s=se.alternate;s=s!==null?s.memoizedState:null}else s=De.next;var u=Mn===null?se.memoizedState:Mn.next;if(u!==null)Mn=u,De=s;else{if(s===null)throw se.alternate===null?Error(r(467)):Error(r(310));De=s,s={memoizedState:De.memoizedState,baseState:De.baseState,baseQueue:De.baseQueue,queue:De.queue,next:null},Mn===null?se.memoizedState=Mn=s:Mn=Mn.next=s}return Mn}function Tu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function hl(s){var u=Xn;return Xn+=1,gi===null&&(gi=[]),s=jn(gi,s,u),u=se,(Mn===null?u.memoizedState:Mn.next)===null&&(u=u.alternate,re.H=u===null||u.memoizedState===null?xh:Ka),s}function Au(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return hl(s);if(s.$$typeof===gr)return $t(s)}throw Error(r(438,String(s)))}function dl(s){var u=null,p=se.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var S=se.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(u={data:S.data.map(function(x){return x.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Tu(),se.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(s),S=0;S<s;S++)p[S]=Ho;return u.index++,p}function ia(s,u){return typeof u=="function"?u(s):u}function aa(s){var u=Un();return xi(u,De,s)}function xi(s,u,p){var S=s.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=p;var x=s.baseQueue,H=S.pending;if(H!==null){if(x!==null){var tt=x.next;x.next=H.next,H.next=tt}u.baseQueue=x=H,S.pending=null}if(H=s.baseState,x===null)s.memoizedState=H;else{u=x.next;var ot=tt=null,bt=null,Nt=u,Ut=!1;do{var Vt=Nt.lane&-536870913;if(Vt!==Nt.lane?(Re&Vt)===Vt:(qe&Vt)===Vt){var Xt=Nt.revertLane;if(Xt===0)bt!==null&&(bt=bt.next={lane:0,revertLane:0,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null}),Vt===Ya&&(Ut=!0);else if((qe&Xt)===Xt){Nt=Nt.next,Xt===Ya&&(Ut=!0);continue}else Vt={lane:0,revertLane:Nt.revertLane,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null},bt===null?(ot=bt=Vt,tt=H):bt=bt.next=Vt,se.lanes|=Xt,Ri|=Xt;Vt=Nt.action,Vs&&p(H,Vt),H=Nt.hasEagerState?Nt.eagerState:p(H,Vt)}else Xt={lane:Vt,revertLane:Nt.revertLane,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null},bt===null?(ot=bt=Xt,tt=H):bt=bt.next=Xt,se.lanes|=Vt,Ri|=Vt;Nt=Nt.next}while(Nt!==null&&Nt!==u);if(bt===null?tt=H:bt.next=ot,!Ti(H,s.memoizedState)&&(qn=!0,Ut&&(p=Ai,p!==null)))throw p;s.memoizedState=H,s.baseState=tt,s.baseQueue=bt,S.lastRenderedState=H}return x===null&&(S.lanes=0),[s.memoizedState,S.dispatch]}function Ou(s){var u=Un(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var S=p.dispatch,x=p.pending,H=u.memoizedState;if(x!==null){p.pending=null;var tt=x=x.next;do H=s(H,tt.action),tt=tt.next;while(tt!==x);Ti(H,u.memoizedState)||(qn=!0),u.memoizedState=H,u.baseQueue===null&&(u.baseState=H),p.lastRenderedState=H}return[H,S]}function md(s,u,p){var S=se,x=Un(),H=Pe;if(H){if(p===void 0)throw Error(r(407));p=p()}else p=u();var tt=!Ti((De||x).memoizedState,p);tt&&(x.memoizedState=p,qn=!0),x=x.queue;var ot=go.bind(null,S,x,s);if(xa(2048,8,ot,[s]),x.getSnapshot!==u||tt||Mn!==null&&Mn.memoizedState.tag&1){if(S.flags|=2048,Mi(9,gl(),yf.bind(null,S,x,p,u),null),Ze===null)throw Error(r(349));H||(qe&124)!==0||Ru(S,u,p)}return p}function Ru(s,u,p){s.flags|=16384,s={getSnapshot:u,value:p},u=se.updateQueue,u===null?(u=Tu(),se.updateQueue=u,u.stores=[s]):(p=u.stores,p===null?u.stores=[s]:p.push(s))}function yf(s,u,p,S){u.value=p,u.getSnapshot=S,vd(u)&&qi(s)}function go(s,u,p){return p(function(){vd(u)&&qi(s)})}function vd(s){var u=s.getSnapshot;s=s.value;try{var p=u();return!Ti(s,p)}catch{return!0}}function qi(s){var u=cs(s,2);u!==null&&ji(u,s,2)}function po(s){var u=In();if(typeof s=="function"){var p=s;if(s=p(),Vs){Y(!0);try{p()}finally{Y(!1)}}}return u.memoizedState=u.baseState=s,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:s},u}function Sf(s,u,p,S){return s.baseState=p,xi(s,De,typeof S=="function"?S:ia)}function bf(s,u,p,S,x){if(Lr(s))throw Error(r(485));if(s=u.action,s!==null){var H={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(tt){H.listeners.push(tt)}};re.T!==null?p(!0):H.isTransition=!1,S(H),p=u.pending,p===null?(H.next=u.pending=H,ds(u,H)):(H.next=p.next,u.pending=p.next=H)}}function ds(s,u){var p=u.action,S=u.payload,x=s.state;if(u.isTransition){var H=re.T,tt={};re.T=tt;try{var ot=p(x,S),bt=re.S;bt!==null&&bt(tt,ot),_f(s,u,ot)}catch(Nt){Br(s,u,Nt)}finally{re.T=H}}else try{H=p(x,S),_f(s,u,H)}catch(Nt){Br(s,u,Nt)}}function _f(s,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(S){Ef(s,u,S)},function(S){return Br(s,u,S)}):Ef(s,u,p)}function Ef(s,u,p){u.status="fulfilled",u.value=p,yd(u),s.state=p,u=s.pending,u!==null&&(p=u.next,p===u?s.pending=null:(p=p.next,u.next=p,ds(s,p)))}function Br(s,u,p){var S=s.pending;if(s.pending=null,S!==null){S=S.next;do u.status="rejected",u.reason=p,yd(u),u=u.next;while(u!==S)}s.action=null}function yd(s){s=s.listeners;for(var u=0;u<s.length;u++)(0,s[u])()}function Cf(s,u){return u}function Tf(s,u){if(Pe){var p=Ze.formState;if(p!==null){t:{var S=se;if(Pe){if(xn){var x=Zd(xn,ba);if(x){xn=dh(x),S=Wd(x);break t}}nt(S)}S=!1}S&&(u=p[0])}}p=In(),p.memoizedState=p.baseState=u,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cf,lastRenderedState:u},p.queue=S,p=bd.bind(null,se,S),S.dispatch=p,S=po(!1);var H=bo.bind(null,se,!1,S.queue);return S=In(),x={state:u,dispatch:null,action:s,pending:null},S.queue=x,p=bf.bind(null,se,x,H,p),x.dispatch=p,S.memoizedState=s,[u,p,!1]}function wu(s){var u=Un();return Sd(u,De,s)}function Sd(s,u,p){if(u=xi(s,u,Cf)[0],s=aa(ia)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var S=hl(u)}catch(tt){throw tt===Ps?Is:tt}else S=u;u=Un();var x=u.queue,H=x.dispatch;return p!==u.memoizedState&&(se.flags|=2048,Mi(9,gl(),Mg.bind(null,x,p),null)),[S,H,s]}function Mg(s,u){s.action=u}function mo(s){var u=Un(),p=De;if(p!==null)return Sd(u,p,s);Un(),u=u.memoizedState,p=Un();var S=p.queue.dispatch;return p.memoizedState=s,[u,S,!1]}function Mi(s,u,p,S){return s={tag:s,create:p,deps:S,inst:u,next:null},u=se.updateQueue,u===null&&(u=Tu(),se.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=s.next=s:(S=p.next,p.next=s,s.next=S,u.lastEffect=s),s}function gl(){return{destroy:void 0,resource:void 0}}function xu(){return Un().memoizedState}function sr(s,u,p,S){var x=In();S=S===void 0?null:S,se.flags|=s,x.memoizedState=Mi(1|u,gl(),p,S)}function xa(s,u,p,S){var x=Un();S=S===void 0?null:S;var H=x.memoizedState.inst;De!==null&&S!==null&&jr(S,De.memoizedState.deps)?x.memoizedState=Mi(u,H,p,S):(se.flags|=s,x.memoizedState=Mi(1|u,H,p,S))}function Af(s,u){sr(8390656,8,s,u)}function Mu(s,u){xa(2048,8,s,u)}function Of(s,u){return xa(4,2,s,u)}function pl(s,u){return xa(4,4,s,u)}function Ma(s,u){if(typeof u=="function"){s=s();var p=u(s);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return s=s(),u.current=s,function(){u.current=null}}function Nu(s,u,p){p=p!=null?p.concat([s]):null,xa(4,4,Ma.bind(null,u,s),p)}function gs(){}function lr(s,u){var p=Un();u=u===void 0?null:u;var S=p.memoizedState;return u!==null&&jr(u,S[1])?S[0]:(p.memoizedState=[s,u],s)}function Du(s,u){var p=Un();u=u===void 0?null:u;var S=p.memoizedState;if(u!==null&&jr(u,S[1]))return S[0];if(S=s(),Vs){Y(!0);try{s()}finally{Y(!1)}}return p.memoizedState=[S,u],S}function ml(s,u,p){return p===void 0||(qe&1073741824)!==0?s.memoizedState=u:(s.memoizedState=p,s=Wu(),se.lanes|=s,Ri|=s,p)}function Rf(s,u,p,S){return Ti(p,u)?p:ks.current!==null?(s=ml(s,p,S),Ti(s,u)||(qn=!0),s):(qe&42)===0?(qn=!0,s.memoizedState=p):(s=Wu(),se.lanes|=s,Ri|=s,u)}function vo(s,u,p,S,x){var H=Ha();zn(H!==0&&8>H?H:8);var tt=re.T,ot={};re.T=ot,bo(s,!1,u,p);try{var bt=x(),Nt=re.S;if(Nt!==null&&Nt(ot,bt),bt!==null&&typeof bt=="object"&&typeof bt.then=="function"){var Ut=er(bt,S);ps(s,u,Ut,Di(s))}else ps(s,u,S,Di(s))}catch(Vt){ps(s,u,{then:function(){},status:"rejected",reason:Vt},Di())}finally{zn(H),re.T=tt}}function yo(s){var u=s.memoizedState;if(u!==null)return u;u={memoizedState:Sr,baseState:Sr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:Sr},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:p},next:null},s.memoizedState=u,s=s.alternate,s!==null&&(s.memoizedState=u),u}function ju(){return $t(oa)}function yi(){return Un().memoizedState}function zr(){return Un().memoizedState}function Uu(s){for(var u=s.return;u!==null;){switch(u.tag){case 24:case 3:var p=Di();s=ir(p);var S=ar(u,s,p);S!==null&&(ji(S,u,p),na(S,u,p)),u={cache:ln()},s.payload=u;return}u=u.return}}function So(s,u,p){var S=Di();p={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Lr(s)?_o(u,p):(p=nr(s,u,p,S),p!==null&&(ji(p,s,S),wf(p,u,S)))}function bd(s,u,p){var S=Di();ps(s,u,p,S)}function ps(s,u,p,S){var x={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Lr(s))_o(u,x);else{var H=s.alternate;if(s.lanes===0&&(H===null||H.lanes===0)&&(H=u.lastRenderedReducer,H!==null))try{var tt=u.lastRenderedState,ot=H(tt,p);if(x.hasEagerState=!0,x.eagerState=ot,Ti(ot,tt))return Wn(s,u,x,0),Ze===null&&me(),!1}catch{}finally{}if(p=nr(s,u,x,S),p!==null)return ji(p,s,S),wf(p,u,S),!0}return!1}function bo(s,u,p,S){if(S={lane:2,revertLane:ki(),action:S,hasEagerState:!1,eagerState:null,next:null},Lr(s)){if(u)throw Error(r(479))}else u=nr(s,p,S,2),u!==null&&ji(u,s,2)}function Lr(s){var u=s.alternate;return s===se||u!==null&&u===se}function _o(s,u){qs=eu=!0;var p=s.pending;p===null?u.next=u:(u.next=p.next,p.next=u),s.pending=u}function wf(s,u,p){if((p&4194048)!==0){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function Bu(s){var u=Qs;return Qs+=1,Gi===null&&(Gi=[]),jn(Gi,s,u)}function Eo(s,u){u=u.props.ref,s.ref=u!==void 0?u:null}function zu(s,u){throw u.$$typeof===As?Error(r(525)):(s=Object.prototype.toString.call(u),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":s)))}function Lu(s){var u=s._init;return u(s._payload)}function _d(s){function u(St,dt){if(s){var Et=St.deletions;Et===null?(St.deletions=[dt],St.flags|=16):Et.push(dt)}}function p(St,dt){if(!s)return null;for(;dt!==null;)u(St,dt),dt=dt.sibling;return null}function S(St){for(var dt=new Map;St!==null;)St.key!==null?dt.set(St.key,St):dt.set(St.index,St),St=St.sibling;return dt}function x(St,dt){return St=on(St,dt),St.index=0,St.sibling=null,St}function H(St,dt,Et){return St.index=Et,s?(Et=St.alternate,Et!==null?(Et=Et.index,Et<dt?(St.flags|=67108866,dt):Et):(St.flags|=67108866,dt)):(St.flags|=1048576,dt)}function tt(St){return s&&St.alternate===null&&(St.flags|=67108866),St}function ot(St,dt,Et,Bt){return dt===null||dt.tag!==6?(dt=Zf(Et,St.mode,Bt),dt.return=St,dt):(dt=x(dt,Et),dt.return=St,dt)}function bt(St,dt,Et,Bt){var It=Et.type;return It===Os?Ut(St,dt,Et.props.children,Bt,Et.key):dt!==null&&(dt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===vr&&Lu(It)===dt.type)?(dt=x(dt,Et.props),Eo(dt,Et),dt.return=St,dt):(dt=zo(Et.type,Et.key,Et.props,null,St.mode,Bt),Eo(dt,Et),dt.return=St,dt)}function Nt(St,dt,Et,Bt){return dt===null||dt.tag!==4||dt.stateNode.containerInfo!==Et.containerInfo||dt.stateNode.implementation!==Et.implementation?(dt=Wf(Et,St.mode,Bt),dt.return=St,dt):(dt=x(dt,Et.children||[]),dt.return=St,dt)}function Ut(St,dt,Et,Bt,It){return dt===null||dt.tag!==7?(dt=Cs(Et,St.mode,Bt,It),dt.return=St,dt):(dt=x(dt,Et),dt.return=St,dt)}function Vt(St,dt,Et){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return dt=Zf(""+dt,St.mode,Et),dt.return=St,dt;if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case Ml:return Et=zo(dt.type,dt.key,dt.props,null,St.mode,Et),Eo(Et,dt),Et.return=St,Et;case dr:return dt=Wf(dt,St.mode,Et),dt.return=St,dt;case vr:var Bt=dt._init;return dt=Bt(dt._payload),Vt(St,dt,Et)}if(ws(dt)||_(dt))return dt=Cs(dt,St.mode,Et,null),dt.return=St,dt;if(typeof dt.then=="function")return Vt(St,Bu(dt),Et);if(dt.$$typeof===gr)return Vt(St,ve(St,dt),Et);zu(St,dt)}return null}function Xt(St,dt,Et,Bt){var It=dt!==null?dt.key:null;if(typeof Et=="string"&&Et!==""||typeof Et=="number"||typeof Et=="bigint")return It!==null?null:ot(St,dt,""+Et,Bt);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case Ml:return Et.key===It?bt(St,dt,Et,Bt):null;case dr:return Et.key===It?Nt(St,dt,Et,Bt):null;case vr:return It=Et._init,Et=It(Et._payload),Xt(St,dt,Et,Bt)}if(ws(Et)||_(Et))return It!==null?null:Ut(St,dt,Et,Bt,null);if(typeof Et.then=="function")return Xt(St,dt,Bu(Et),Bt);if(Et.$$typeof===gr)return Xt(St,dt,ve(St,Et),Bt);zu(St,Et)}return null}function Se(St,dt,Et,Bt,It){if(typeof Bt=="string"&&Bt!==""||typeof Bt=="number"||typeof Bt=="bigint")return St=St.get(Et)||null,ot(dt,St,""+Bt,It);if(typeof Bt=="object"&&Bt!==null){switch(Bt.$$typeof){case Ml:return St=St.get(Bt.key===null?Et:Bt.key)||null,bt(dt,St,Bt,It);case dr:return St=St.get(Bt.key===null?Et:Bt.key)||null,Nt(dt,St,Bt,It);case vr:var $e=Bt._init;return Bt=$e(Bt._payload),Se(St,dt,Et,Bt,It)}if(ws(Bt)||_(Bt))return St=St.get(Et)||null,Ut(dt,St,Bt,It,null);if(typeof Bt.then=="function")return Se(St,dt,Et,Bu(Bt),It);if(Bt.$$typeof===gr)return Se(St,dt,Et,ve(dt,Bt),It);zu(dt,Bt)}return null}function ea(St,dt,Et,Bt){for(var It=null,$e=null,fe=dt,Ge=dt=0,Jn=null;fe!==null&&Ge<Et.length;Ge++){fe.index>Ge?(Jn=fe,fe=null):Jn=fe.sibling;var Ie=Xt(St,fe,Et[Ge],Bt);if(Ie===null){fe===null&&(fe=Jn);break}s&&fe&&Ie.alternate===null&&u(St,fe),dt=H(Ie,dt,Ge),$e===null?It=Ie:$e.sibling=Ie,$e=Ie,fe=Jn}if(Ge===Et.length)return p(St,fe),Pe&&Z(St,Ge),It;if(fe===null){for(;Ge<Et.length;Ge++)fe=Vt(St,Et[Ge],Bt),fe!==null&&(dt=H(fe,dt,Ge),$e===null?It=fe:$e.sibling=fe,$e=fe);return Pe&&Z(St,Ge),It}for(fe=S(fe);Ge<Et.length;Ge++)Jn=Se(fe,St,Ge,Et[Ge],Bt),Jn!==null&&(s&&Jn.alternate!==null&&fe.delete(Jn.key===null?Ge:Jn.key),dt=H(Jn,dt,Ge),$e===null?It=Jn:$e.sibling=Jn,$e=Jn);return s&&fe.forEach(function(ss){return u(St,ss)}),Pe&&Z(St,Ge),It}function kl(St,dt,Et,Bt){if(Et==null)throw Error(r(151));for(var It=null,$e=null,fe=dt,Ge=dt=0,Jn=null,Ie=Et.next();fe!==null&&!Ie.done;Ge++,Ie=Et.next()){fe.index>Ge?(Jn=fe,fe=null):Jn=fe.sibling;var ss=Xt(St,fe,Ie.value,Bt);if(ss===null){fe===null&&(fe=Jn);break}s&&fe&&ss.alternate===null&&u(St,fe),dt=H(ss,dt,Ge),$e===null?It=ss:$e.sibling=ss,$e=ss,fe=Jn}if(Ie.done)return p(St,fe),Pe&&Z(St,Ge),It;if(fe===null){for(;!Ie.done;Ge++,Ie=Et.next())Ie=Vt(St,Ie.value,Bt),Ie!==null&&(dt=H(Ie,dt,Ge),$e===null?It=Ie:$e.sibling=Ie,$e=Ie);return Pe&&Z(St,Ge),It}for(fe=S(fe);!Ie.done;Ge++,Ie=Et.next())Ie=Se(fe,St,Ge,Ie.value,Bt),Ie!==null&&(s&&Ie.alternate!==null&&fe.delete(Ie.key===null?Ge:Ie.key),dt=H(Ie,dt,Ge),$e===null?It=Ie:$e.sibling=Ie,$e=Ie);return s&&fe.forEach(function(zc){return u(St,zc)}),Pe&&Z(St,Ge),It}function rs(St,dt,Et,Bt){if(typeof Et=="object"&&Et!==null&&Et.type===Os&&Et.key===null&&(Et=Et.props.children),typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case Ml:t:{for(var It=Et.key;dt!==null;){if(dt.key===It){if(It=Et.type,It===Os){if(dt.tag===7){p(St,dt.sibling),Bt=x(dt,Et.props.children),Bt.return=St,St=Bt;break t}}else if(dt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===vr&&Lu(It)===dt.type){p(St,dt.sibling),Bt=x(dt,Et.props),Eo(Bt,Et),Bt.return=St,St=Bt;break t}p(St,dt);break}else u(St,dt);dt=dt.sibling}Et.type===Os?(Bt=Cs(Et.props.children,St.mode,Bt,Et.key),Bt.return=St,St=Bt):(Bt=zo(Et.type,Et.key,Et.props,null,St.mode,Bt),Eo(Bt,Et),Bt.return=St,St=Bt)}return tt(St);case dr:t:{for(It=Et.key;dt!==null;){if(dt.key===It)if(dt.tag===4&&dt.stateNode.containerInfo===Et.containerInfo&&dt.stateNode.implementation===Et.implementation){p(St,dt.sibling),Bt=x(dt,Et.children||[]),Bt.return=St,St=Bt;break t}else{p(St,dt);break}else u(St,dt);dt=dt.sibling}Bt=Wf(Et,St.mode,Bt),Bt.return=St,St=Bt}return tt(St);case vr:return It=Et._init,Et=It(Et._payload),rs(St,dt,Et,Bt)}if(ws(Et))return ea(St,dt,Et,Bt);if(_(Et)){if(It=_(Et),typeof It!="function")throw Error(r(150));return Et=It.call(Et),kl(St,dt,Et,Bt)}if(typeof Et.then=="function")return rs(St,dt,Bu(Et),Bt);if(Et.$$typeof===gr)return rs(St,dt,ve(St,Et),Bt);zu(St,Et)}return typeof Et=="string"&&Et!==""||typeof Et=="number"||typeof Et=="bigint"?(Et=""+Et,dt!==null&&dt.tag===6?(p(St,dt.sibling),Bt=x(dt,Et),Bt.return=St,St=Bt):(p(St,dt),Bt=Zf(Et,St.mode,Bt),Bt.return=St,St=Bt),tt(St)):p(St,dt)}return function(St,dt,Et,Bt){try{Qs=0;var It=rs(St,dt,Et,Bt);return Gi=null,It}catch(fe){if(fe===Ps||fe===Is)throw fe;var $e=n(29,fe,null,St.mode);return $e.lanes=Bt,$e.return=St,$e}finally{}}}function Gr(s){var u=s.alternate;v(En,En.current&1),v(ta,s),Oi===null&&(u===null||ks.current!==null||u.memoizedState!==null)&&(Oi=s)}function Ed(s){if(s.tag===22){if(v(En,En.current),v(ta,s),Oi===null){var u=s.alternate;u!==null&&u.memoizedState!==null&&(Oi=s)}}else Hr()}function Hr(){v(En,En.current),v(ta,ta.current)}function or(s){R(ta),Oi===s&&(Oi=null),R(En)}function Co(s){for(var u=s;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||pc(p)||mc(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function xf(s,u,p,S){u=s.memoizedState,p=p(S,u),p=p==null?u:rc({},u,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}function Cd(s,u,p,S,x,H,tt){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(S,H,tt):u.prototype&&u.prototype.isPureReactComponent?!ne(p,S)||!ne(x,H):!0}function Td(s,u,p,S){s=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,S),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,S),u.state!==s&&Xs.enqueueReplaceState(u,u.state,null)}function ms(s,u){var p=u;if("ref"in u){p={};for(var S in u)S!=="ref"&&(p[S]=u[S])}if(s=s.defaultProps){p===u&&(p=rc({},p));for(var x in s)p[x]===void 0&&(p[x]=s[x])}return p}function vl(s,u){try{var p=s.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(S){setTimeout(function(){throw S})}}function Ad(s,u,p){try{var S=s.onCaughtError;S(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Mf(s,u,p){return p=ir(p),p.tag=3,p.payload={element:null},p.callback=function(){vl(s,u)},p}function Od(s){return s=ir(s),s.tag=3,s}function Nf(s,u,p,S){var x=p.type.getDerivedStateFromError;if(typeof x=="function"){var H=S.value;s.payload=function(){return x(H)},s.callback=function(){Ad(u,p,S)}}var tt=p.stateNode;tt!==null&&typeof tt.componentDidCatch=="function"&&(s.callback=function(){Ad(u,p,S),typeof x!="function"&&(Or===null?Or=new Set([this]):Or.add(this));var ot=S.stack;this.componentDidCatch(S.value,{componentStack:ot!==null?ot:""})})}function Ng(s,u,p,S,x){if(p.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(u=p.alternate,u!==null&&xt(u,p,x,!0),p=ta.current,p!==null){switch(p.tag){case 13:return Oi===null?$u():p.alternate===null&&cn===0&&(cn=3),p.flags&=-257,p.flags|=65536,p.lanes=x,S===$o?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([S]):u.add(S),ya(s,S,x)),!1;case 22:return p.flags|=65536,S===$o?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([S])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([S]):p.add(S)),ya(s,S,x)),!1}throw Error(r(435,p.tag))}return ya(s,S,x),$u(),!1}if(Pe)return u=ta.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=x,S!==_a&&(s=Error(r(422),{cause:S}),ge(X(s,p)))):(S!==_a&&(u=Error(r(423),{cause:S}),ge(X(u,p))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,S=X(S,p),x=Mf(s.stateNode,S,x),Pn(s,x),cn!==4&&(cn=2)),!1;var H=Error(r(520),{cause:S});if(H=X(H,p),Zs===null?Zs=[H]:Zs.push(H),cn!==4&&(cn=2),u===null)return!0;S=X(S,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,s=x&-x,p.lanes|=s,s=Mf(p.stateNode,S,s),Pn(p,s),!1;case 1:if(u=p.type,H=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Or===null||!Or.has(H))))return p.flags|=65536,x&=-x,p.lanes|=x,x=Od(x),Nf(x,s,p,S),Pn(p,x),!1}p=p.return}while(p!==null);return!1}function $n(s,u,p,S){u.child=s===null?ua(u,null,p,S):is(u,s.child,p,S)}function Rd(s,u,p,S,x){p=p.render;var H=u.ref;if("ref"in S){var tt={};for(var ot in S)ot!=="ref"&&(tt[ot]=S[ot])}else tt=S;return Jt(u),S=Ur(s,u,p,tt,H,x),ot=Eu(),s!==null&&!qn?(Cu(s,u,x),Na(s,u,x)):(Pe&&ot&&J(u),u.flags|=1,$n(s,u,S,x),u.child)}function wd(s,u,p,S,x){if(s===null){var H=p.type;return typeof H=="function"&&!hr(H)&&H.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=H,xd(s,u,H,S,x)):(s=zo(p.type,null,S,u,u.mode,x),s.ref=u.ref,s.return=u,u.child=s)}if(H=s.child,!qu(s,x)){var tt=H.memoizedProps;if(p=p.compare,p=p!==null?p:ne,p(tt,S)&&s.ref===u.ref)return Na(s,u,x)}return u.flags|=1,s=on(H,S),s.ref=u.ref,s.return=u,u.child=s}function xd(s,u,p,S,x){if(s!==null){var H=s.memoizedProps;if(ne(H,S)&&s.ref===u.ref)if(qn=!1,u.pendingProps=S=H,qu(s,x))(s.flags&131072)!==0&&(qn=!0);else return u.lanes=s.lanes,Na(s,u,x)}return Df(s,u,p,S,x)}function Md(s,u,p){var S=u.pendingProps,x=S.children,H=s!==null?s.memoizedState:null;if(S.mode==="hidden"){if((u.flags&128)!==0){if(S=H!==null?H.baseLanes|p:p,s!==null){for(x=u.child=s.child,H=0;x!==null;)H=H|x.lanes|x.childLanes,x=x.sibling;u.childLanes=H&~S}else u.childLanes=0,u.child=null;return Nd(s,u,S,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},s!==null&&Gt(u,H!==null?H.cachePool:null),H!==null?pd(u,H):_u(),Ed(u);else return u.lanes=u.childLanes=536870912,Nd(s,u,H!==null?H.baseLanes|p:p,p)}else H!==null?(Gt(u,H.cachePool),pd(u,H),Hr(),u.memoizedState=null):(s!==null&&Gt(u,null),_u(),Hr());return $n(s,u,x,p),u.child}function Nd(s,u,p,S){var x=cl();return x=x===null?null:{parent:La?en._currentValue:en._currentValue2,pool:x},u.memoizedState={baseLanes:p,cachePool:x},s!==null&&Gt(u,null),_u(),Ed(u),s!==null&&xt(s,u,S,!0),null}function Gu(s,u){var p=u.ref;if(p===null)s!==null&&s.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(u.flags|=4194816)}}function Df(s,u,p,S,x){return Jt(u),p=Ur(s,u,p,S,void 0,x),S=Eu(),s!==null&&!qn?(Cu(s,u,x),Na(s,u,x)):(Pe&&S&&J(u),u.flags|=1,$n(s,u,p,x),u.child)}function Hu(s,u,p,S,x,H){return Jt(u),u.updateQueue=null,p=hs(u,S,p,x),fl(s),S=Eu(),s!==null&&!qn?(Cu(s,u,H),Na(s,u,H)):(Pe&&S&&J(u),u.flags|=1,$n(s,u,p,H),u.child)}function yl(s,u,p,S,x){if(Jt(u),u.stateNode===null){var H=$r,tt=p.contextType;typeof tt=="object"&&tt!==null&&(H=$t(tt)),H=new p(S,H),u.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,H.updater=Xs,u.stateNode=H,H._reactInternals=u,H=u.stateNode,H.props=S,H.state=u.memoizedState,H.refs={},fo(u),tt=p.contextType,H.context=typeof tt=="object"&&tt!==null?$t(tt):$r,H.state=u.memoizedState,tt=p.getDerivedStateFromProps,typeof tt=="function"&&(xf(u,p,tt,S),H.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(tt=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),tt!==H.state&&Xs.enqueueReplaceState(H,H.state,null),wa(u,S,H,x),Vn(),H.state=u.memoizedState),typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!0}else if(s===null){H=u.stateNode;var ot=u.memoizedProps,bt=ms(p,ot);H.props=bt;var Nt=H.context,Ut=p.contextType;tt=$r,typeof Ut=="object"&&Ut!==null&&(tt=$t(Ut));var Vt=p.getDerivedStateFromProps;Ut=typeof Vt=="function"||typeof H.getSnapshotBeforeUpdate=="function",ot=u.pendingProps!==ot,Ut||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ot||Nt!==tt)&&Td(u,H,S,tt),un=!1;var Xt=u.memoizedState;H.state=Xt,wa(u,S,H,x),Vn(),Nt=u.memoizedState,ot||Xt!==Nt||un?(typeof Vt=="function"&&(xf(u,p,Vt,S),Nt=u.memoizedState),(bt=un||Cd(u,p,bt,S,Xt,Nt,tt))?(Ut||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(u.flags|=4194308)):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=S,u.memoizedState=Nt),H.props=S,H.state=Nt,H.context=tt,S=bt):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!1)}else{H=u.stateNode,ho(s,u),tt=u.memoizedProps,Ut=ms(p,tt),H.props=Ut,Vt=u.pendingProps,Xt=H.context,Nt=p.contextType,bt=$r,typeof Nt=="object"&&Nt!==null&&(bt=$t(Nt)),ot=p.getDerivedStateFromProps,(Nt=typeof ot=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(tt!==Vt||Xt!==bt)&&Td(u,H,S,bt),un=!1,Xt=u.memoizedState,H.state=Xt,wa(u,S,H,x),Vn();var Se=u.memoizedState;tt!==Vt||Xt!==Se||un||s!==null&&s.dependencies!==null&&Qt(s.dependencies)?(typeof ot=="function"&&(xf(u,p,ot,S),Se=u.memoizedState),(Ut=un||Cd(u,p,Ut,S,Xt,Se,bt)||s!==null&&s.dependencies!==null&&Qt(s.dependencies))?(Nt||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(S,Se,bt),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(S,Se,bt)),typeof H.componentDidUpdate=="function"&&(u.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof H.componentDidUpdate!="function"||tt===s.memoizedProps&&Xt===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||tt===s.memoizedProps&&Xt===s.memoizedState||(u.flags|=1024),u.memoizedProps=S,u.memoizedState=Se),H.props=S,H.state=Se,H.context=bt,S=Ut):(typeof H.componentDidUpdate!="function"||tt===s.memoizedProps&&Xt===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||tt===s.memoizedProps&&Xt===s.memoizedState||(u.flags|=1024),S=!1)}return H=S,Gu(s,u),S=(u.flags&128)!==0,H||S?(H=u.stateNode,p=S&&typeof p.getDerivedStateFromError!="function"?null:H.render(),u.flags|=1,s!==null&&S?(u.child=is(u,s.child,null,x),u.child=is(u,null,p,x)):$n(s,u,p,x),u.memoizedState=H.state,s=u.child):s=Na(s,u,x),s}function Dd(s,u,p,S){return Kt(),u.flags|=256,$n(s,u,p,S),u.child}function Pu(s){return{baseLanes:s,cachePool:Yt()}}function Iu(s,u,p){return s=s!==null?s.childLanes&~p:0,u&&(s|=oi),s}function jf(s,u,p){var S=u.pendingProps,x=!1,H=(u.flags&128)!==0,tt;if((tt=H)||(tt=s!==null&&s.memoizedState===null?!1:(En.current&2)!==0),tt&&(x=!0,u.flags&=-129),tt=(u.flags&32)!==0,u.flags&=-33,s===null){if(Pe){if(x?Gr(u):Hr(),Pe){var ot=xn,bt;(bt=ot)&&(ot=yc(ot,ba),ot!==null?(u.memoizedState={dehydrated:ot,treeContext:ts!==null?{id:Va,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},bt=n(18,null,null,0),bt.stateNode=ot,bt.return=u,u.child=bt,Qn=u,xn=null,bt=!0):bt=!1),bt||nt(u)}if(ot=u.memoizedState,ot!==null&&(ot=ot.dehydrated,ot!==null))return mc(ot)?u.lanes=32:u.lanes=536870912,null;or(u)}return ot=S.children,S=S.fallback,x?(Hr(),x=u.mode,ot=To({mode:"hidden",children:ot},x),S=Cs(S,x,p,null),ot.return=u,S.return=u,ot.sibling=S,u.child=ot,x=u.child,x.memoizedState=Pu(p),x.childLanes=Iu(s,tt,p),u.memoizedState=Js,S):(Gr(u),ku(u,ot))}if(bt=s.memoizedState,bt!==null&&(ot=bt.dehydrated,ot!==null)){if(H)u.flags&256?(Gr(u),u.flags&=-257,u=Pr(s,u,p)):u.memoizedState!==null?(Hr(),u.child=s.child,u.flags|=128,u=null):(Hr(),x=S.fallback,ot=u.mode,S=To({mode:"visible",children:S.children},ot),x=Cs(x,ot,p,null),x.flags|=2,S.return=u,x.return=u,S.sibling=x,u.child=S,is(u,s.child,null,p),S=u.child,S.memoizedState=Pu(p),S.childLanes=Iu(s,tt,p),u.memoizedState=Js,u=x);else if(Gr(u),mc(ot))tt=Jd(ot).digest,S=Error(r(419)),S.stack="",S.digest=tt,ge({value:S,source:null,stack:null}),u=Pr(s,u,p);else if(qn||xt(s,u,p,!1),tt=(p&s.childLanes)!==0,qn||tt){if(tt=Ze,tt!==null&&(S=p&-p,S=(S&42)!==0?1:P(S),S=(S&(tt.suspendedLanes|p))!==0?0:S,S!==0&&S!==bt.retryLane))throw bt.retryLane=S,cs(s,S),ji(tt,s,S),Mh;pc(ot)||$u(),u=Pr(s,u,p)}else pc(ot)?(u.flags|=192,u.child=s.child,u=null):(s=bt.treeContext,gn&&(xn=e0(ot),Qn=u,Pe=!0,Er=null,ba=!1,s!==null&&(zi[Wi++]=Va,zi[Wi++]=Sa,zi[Wi++]=ts,Va=s.id,Sa=s.overflow,ts=u)),u=ku(u,S.children),u.flags|=4096);return u}return x?(Hr(),x=S.fallback,ot=u.mode,bt=s.child,H=bt.sibling,S=on(bt,{mode:"hidden",children:S.children}),S.subtreeFlags=bt.subtreeFlags&65011712,H!==null?x=on(H,x):(x=Cs(x,ot,p,null),x.flags|=2),x.return=u,S.return=u,S.sibling=x,u.child=S,S=x,x=u.child,ot=s.child.memoizedState,ot===null?ot=Pu(p):(bt=ot.cachePool,bt!==null?(H=La?en._currentValue:en._currentValue2,bt=bt.parent!==H?{parent:H,pool:H}:bt):bt=Yt(),ot={baseLanes:ot.baseLanes|p,cachePool:bt}),x.memoizedState=ot,x.childLanes=Iu(s,tt,p),u.memoizedState=Js,S):(Gr(u),p=s.child,s=p.sibling,p=on(p,{mode:"visible",children:S.children}),p.return=u,p.sibling=null,s!==null&&(tt=u.deletions,tt===null?(u.deletions=[s],u.flags|=16):tt.push(s)),u.child=p,u.memoizedState=null,p)}function ku(s,u){return u=To({mode:"visible",children:u},s.mode),u.return=s,s.child=u}function To(s,u){return s=n(22,s,null,u),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Pr(s,u,p){return is(u,s.child,null,p),s=ku(u,u.pendingProps.children),s.flags|=2,u.memoizedState=null,s}function jd(s,u,p){s.lanes|=u;var S=s.alternate;S!==null&&(S.lanes|=u),zt(s.return,u,p)}function Uf(s,u,p,S,x){var H=s.memoizedState;H===null?s.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:S,tail:p,tailMode:x}:(H.isBackwards=u,H.rendering=null,H.renderingStartTime=0,H.last=S,H.tail=p,H.tailMode=x)}function Ud(s,u,p){var S=u.pendingProps,x=S.revealOrder,H=S.tail;if($n(s,u,S.children,p),S=En.current,(S&2)!==0)S=S&1|2,u.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=u.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&jd(s,p,u);else if(s.tag===19)jd(s,p,u);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===u)break t;for(;s.sibling===null;){if(s.return===null||s.return===u)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}S&=1}switch(v(En,S),x){case"forwards":for(p=u.child,x=null;p!==null;)s=p.alternate,s!==null&&Co(s)===null&&(x=p),p=p.sibling;p=x,p===null?(x=u.child,u.child=null):(x=p.sibling,p.sibling=null),Uf(u,!1,x,p,H);break;case"backwards":for(p=null,x=u.child,u.child=null;x!==null;){if(s=x.alternate,s!==null&&Co(s)===null){u.child=x;break}s=x.sibling,x.sibling=p,p=x,x=s}Uf(u,!0,p,null,H);break;case"together":Uf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Na(s,u,p){if(s!==null&&(u.dependencies=s.dependencies),Ri|=u.lanes,(p&u.childLanes)===0)if(s!==null){if(xt(s,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(s!==null&&u.child!==s.child)throw Error(r(153));if(u.child!==null){for(s=u.child,p=on(s,s.pendingProps),u.child=p,p.return=u;s.sibling!==null;)s=s.sibling,p=p.sibling=on(s,s.pendingProps),p.return=u;p.sibling=null}return u.child}function qu(s,u){return(s.lanes&u)!==0?!0:(s=s.dependencies,!!(s!==null&&Qt(s)))}function Ao(s,u,p){switch(u.tag){case 3:it(u,u.stateNode.containerInfo),pe(u,en,s.memoizedState.cache),Kt();break;case 27:case 5:F(u);break;case 4:it(u,u.stateNode.containerInfo);break;case 10:pe(u,u.type,u.memoizedProps.value);break;case 13:var S=u.memoizedState;if(S!==null)return S.dehydrated!==null?(Gr(u),u.flags|=128,null):(p&u.child.childLanes)!==0?jf(s,u,p):(Gr(u),s=Na(s,u,p),s!==null?s.sibling:null);Gr(u);break;case 19:var x=(s.flags&128)!==0;if(S=(p&u.childLanes)!==0,S||(xt(s,u,p,!1),S=(p&u.childLanes)!==0),x){if(S)return Ud(s,u,p);u.flags|=128}if(x=u.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),v(En,En.current),S)break;return null;case 22:case 23:return u.lanes=0,Md(s,u,p);case 24:pe(u,en,s.memoizedState.cache)}return Na(s,u,p)}function Sl(s,u,p){if(s!==null)if(s.memoizedProps!==u.pendingProps)qn=!0;else{if(!qu(s,p)&&(u.flags&128)===0)return qn=!1,Ao(s,u,p);qn=(s.flags&131072)!==0}else qn=!1,Pe&&(u.flags&1048576)!==0&&at(u,Ls,u.index);switch(u.lanes=0,u.tag){case 16:t:{s=u.pendingProps;var S=u.elementType,x=S._init;if(S=x(S._payload),u.type=S,typeof S=="function")hr(S)?(s=ms(S,s),u.tag=1,u=yl(null,u,S,s,p)):(u.tag=0,u=Df(null,u,S,s,p));else{if(S!=null){if(x=S.$$typeof,x===lc){u.tag=11,u=Rd(null,u,S,s,p);break t}else if(x===oc){u.tag=14,u=wd(null,u,S,s,p);break t}}throw u=C(S)||S,Error(r(306,u,""))}}return u;case 0:return Df(s,u,u.type,u.pendingProps,p);case 1:return S=u.type,x=ms(S,u.pendingProps),yl(s,u,S,x,p);case 3:t:{if(it(u,u.stateNode.containerInfo),s===null)throw Error(r(387));var H=u.pendingProps;x=u.memoizedState,S=x.element,ho(s,u),wa(u,H,null,p);var tt=u.memoizedState;if(H=tt.cache,pe(u,en,H),H!==x.cache&&ft(u,[en],p,!0),Vn(),H=tt.element,gn&&x.isDehydrated)if(x={element:H,isDehydrated:!1,cache:tt.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=Dd(s,u,H,p);break t}else if(H!==S){S=X(Error(r(424)),u),ge(S),u=Dd(s,u,H,p);break t}else for(gn&&(xn=zg(u.stateNode.containerInfo),Qn=u,Pe=!0,Er=null,ba=!0),p=ua(u,null,H,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Kt(),H===S){u=Na(s,u,p);break t}$n(s,u,H,p)}u=u.child}return u;case 26:if(Ji)return Gu(s,u),s===null?(p=f0(u.type,null,u.pendingProps,null))?u.memoizedState=p:Pe||(u.stateNode=d0(u.type,u.pendingProps,_r.current,u)):u.memoizedState=f0(u.type,s.memoizedProps,u.pendingProps,s.memoizedState),null;case 27:if(wn)return F(u),s===null&&wn&&Pe&&(S=u.stateNode=Qo(u.type,u.pendingProps,_r.current,kn.current,!1),Qn=u,ba=!0,xn=jl(u.type,S,xn)),$n(s,u,u.pendingProps.children,p),Gu(s,u),s===null&&(u.flags|=4194304),u.child;case 5:return s===null&&Pe&&(u0(u.type,u.pendingProps,kn.current),(x=S=xn)&&(S=n0(S,u.type,u.pendingProps,ba),S!==null?(u.stateNode=S,Qn=u,xn=t0(S),ba=!1,x=!0):x=!1),x||nt(u)),F(u),x=u.type,H=u.pendingProps,tt=s!==null?s.memoizedProps:null,S=H.children,Jr(x,H)?S=null:tt!==null&&Jr(x,tt)&&(u.flags|=32),u.memoizedState!==null&&(x=Ur(s,u,Yn,null,null,p),La?oa._currentValue=x:oa._currentValue2=x),Gu(s,u),$n(s,u,S,p),u.child;case 6:return s===null&&Pe&&(c0(u.pendingProps,kn.current),(s=p=xn)&&(p=vc(p,u.pendingProps,ba),p!==null?(u.stateNode=p,Qn=u,xn=null,s=!0):s=!1),s||nt(u)),null;case 13:return jf(s,u,p);case 4:return it(u,u.stateNode.containerInfo),S=u.pendingProps,s===null?u.child=is(u,null,S,p):$n(s,u,S,p),u.child;case 11:return Rd(s,u,u.type,u.pendingProps,p);case 7:return $n(s,u,u.pendingProps,p),u.child;case 8:return $n(s,u,u.pendingProps.children,p),u.child;case 12:return $n(s,u,u.pendingProps.children,p),u.child;case 10:return S=u.pendingProps,pe(u,u.type,S.value),$n(s,u,S.children,p),u.child;case 9:return x=u.type._context,S=u.pendingProps.children,Jt(u),x=$t(x),S=S(x),u.flags|=1,$n(s,u,S,p),u.child;case 14:return wd(s,u,u.type,u.pendingProps,p);case 15:return xd(s,u,u.type,u.pendingProps,p);case 19:return Ud(s,u,p);case 31:return S=u.pendingProps,p=u.mode,S={mode:S.mode,children:S.children},s===null?(p=To(S,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=on(s.child,S),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return Md(s,u,p);case 24:return Jt(u),S=$t(en),s===null?(x=cl(),x===null&&(x=Ze,H=ln(),x.pooledCache=H,H.refCount++,H!==null&&(x.pooledCacheLanes|=p),x=H),u.memoizedState={parent:S,cache:x},fo(u),pe(u,en,x)):((s.lanes&p)!==0&&(ho(s,u),wa(u,null,null,p),Vn()),x=s.memoizedState,H=u.memoizedState,x.parent!==S?(x={parent:S,cache:S},u.memoizedState=x,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=x),pe(u,en,S)):(S=H.cache,pe(u,en,S),S!==x.cache&&ft(u,[en],p,!0))),$n(s,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function Vi(s){s.flags|=4}function Oo(s,u){if(s!==null&&s.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(s=u.child;s!==null;){if((s.flags&13878)!==0||(s.subtreeFlags&13878)!==0)return!0;s=s.sibling}return!1}function Vu(s,u,p,S){if(Kn)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)qo(s,p.stateNode);else if(!(p.tag===4||wn&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(Ga)for(var x=u.child;x!==null;){if(x.tag===5){var H=x.stateNode;p&&S&&(H=fh(H,x.type,x.memoizedProps)),qo(s,H)}else if(x.tag===6)H=x.stateNode,p&&S&&(H=Fd(H,x.memoizedProps)),qo(s,H);else if(x.tag!==4){if(x.tag===22&&x.memoizedState!==null)H=x.child,H!==null&&(H.return=x),Vu(s,x,!0,!0);else if(x.child!==null){x.child.return=x,x=x.child;continue}}if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return}x.sibling.return=x.return,x=x.sibling}}function Bf(s,u,p,S){var x=!1;if(Ga)for(var H=u.child;H!==null;){if(H.tag===5){var tt=H.stateNode;p&&S&&(tt=fh(tt,H.type,H.memoizedProps)),ch(s,tt)}else if(H.tag===6)tt=H.stateNode,p&&S&&(tt=Fd(tt,H.memoizedProps)),ch(s,tt);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)x=H.child,x!==null&&(x.return=H),Bf(s,H,!0,!0),x=!0;else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===u)break;for(;H.sibling===null;){if(H.return===null||H.return===u)return x;H=H.return}H.sibling.return=H.return,H=H.sibling}return x}function Yu(s,u){if(Ga&&Oo(s,u)){s=u.stateNode;var p=s.containerInfo,S=uh();Bf(S,u,!1,!1),s.pendingChildren=S,Vi(u),Xd(p,S)}}function Ro(s,u,p,S){if(Kn)s.memoizedProps!==S&&Vi(u);else if(Ga){var x=s.stateNode,H=s.memoizedProps;if((s=Oo(s,u))||H!==S){var tt=kn.current;H=Qd(x,p,H,S,!s,null),H===x?u.stateNode=x:(Nl(H,p,S,tt)&&Vi(u),u.stateNode=H,s?Vu(H,u,!1,!1):Vi(u))}else u.stateNode=x}}function Ku(s,u,p){if(uc(u,p)){if(s.flags|=16777216,!Pa(u,p))if(ma())s.flags|=8192;else throw Li=$o,Wo}else s.flags&=-16777217}function zf(s,u){if(Hg(u)){if(s.flags|=16777216,!yh(u))if(ma())s.flags|=8192;else throw Li=$o,Wo}else s.flags&=-16777217}function wo(s,u){u!==null&&(s.flags|=4),s.flags&16384&&(u=s.tag!==22?w():536870912,s.lanes|=u,Hi|=u)}function xo(s,u){if(!Pe)switch(s.tailMode){case"hidden":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?u||s.tail===null?s.tail=null:s.tail.sibling=null:S.sibling=null}}function _n(s){var u=s.alternate!==null&&s.alternate.child===s.child,p=0,S=0;if(u)for(var x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags&65011712,S|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags,S|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=S,s.childLanes=p,u}function Dg(s,u,p){var S=u.pendingProps;switch(rt(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(u),null;case 1:return _n(u),null;case 3:return p=u.stateNode,S=null,s!==null&&(S=s.memoizedState.cache),u.memoizedState.cache!==S&&(u.flags|=2048),xe(en),q(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(jt(u)?Vi(u):s===null||s.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Wt())),Yu(s,u),_n(u),null;case 26:if(Ji){p=u.type;var x=u.memoizedState;return s===null?(Vi(u),x!==null?(_n(u),zf(u,x)):(_n(u),Ku(u,p,S))):x?x!==s.memoizedState?(Vi(u),_n(u),zf(u,x)):(_n(u),u.flags&=-16777217):(Kn?s.memoizedProps!==S&&Vi(u):Ro(s,u,p,S),_n(u),Ku(u,p,S)),null}case 27:if(wn){if($(u),p=_r.current,x=u.type,s!==null&&u.stateNode!=null)Kn?s.memoizedProps!==S&&Vi(u):Ro(s,u,x,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return _n(u),null}s=kn.current,jt(u)?ht(u,s):(s=Qo(x,S,p,s,!0),u.stateNode=s,Vi(u))}return _n(u),null}case 5:if($(u),p=u.type,s!==null&&u.stateNode!=null)Ro(s,u,p,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return _n(u),null}s=kn.current,jt(u)?ht(u,s):(x=th(p,S,_r.current,s,u),Vu(x,u,!1,!1),u.stateNode=x,Nl(x,p,S,s)&&Vi(u))}return _n(u),Ku(u,u.type,u.pendingProps),null;case 6:if(s&&u.stateNode!=null)p=s.memoizedProps,Kn?p!==S&&Vi(u):Ga&&(p!==S?(u.stateNode=eh(S,_r.current,kn.current,u),Vi(u)):u.stateNode=s.stateNode);else{if(typeof S!="string"&&u.stateNode===null)throw Error(r(166));if(s=_r.current,p=kn.current,jt(u)){if(!gn)throw Error(r(176));if(s=u.stateNode,p=u.memoizedProps,S=null,x=Qn,x!==null)switch(x.tag){case 27:case 5:S=x.memoizedProps}gh(s,p,u,S)||nt(u)}else u.stateNode=eh(S,s,p,u)}return _n(u),null;case 13:if(S=u.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=jt(u),S!==null&&S.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(!gn)throw Error(r(344));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));Lg(x,u)}else Kt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;_n(u),x=!1}else x=Wt(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return u.flags&256?(or(u),u):(or(u),null)}if(or(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=S!==null,s=s!==null&&s.memoizedState!==null,p){S=u.child,x=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(x=S.alternate.memoizedState.cachePool.pool);var H=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(H=S.memoizedState.cachePool.pool),H!==x&&(S.flags|=2048)}return p!==s&&p&&(u.child.flags|=8192),wo(u,u.updateQueue),_n(u),null;case 4:return q(),Yu(s,u),s===null&&Zr(u.stateNode.containerInfo),_n(u),null;case 10:return xe(u.type),_n(u),null;case 19:if(R(En),x=u.memoizedState,x===null)return _n(u),null;if(S=(u.flags&128)!==0,H=x.rendering,H===null)if(S)xo(x,!1);else{if(cn!==0||s!==null&&(s.flags&128)!==0)for(s=u.child;s!==null;){if(H=Co(s),H!==null){for(u.flags|=128,xo(x,!1),s=H.updateQueue,u.updateQueue=s,wo(u,s),u.subtreeFlags=0,s=p,p=u.child;p!==null;)Bo(p,s),p=p.sibling;return v(En,En.current&1|2),u.child}s=s.sibling}x.tail!==null&&Zi()>$s&&(u.flags|=128,S=!0,xo(x,!1),u.lanes=4194304)}else{if(!S)if(s=Co(H),s!==null){if(u.flags|=128,S=!0,s=s.updateQueue,u.updateQueue=s,wo(u,s),xo(x,!0),x.tail===null&&x.tailMode==="hidden"&&!H.alternate&&!Pe)return _n(u),null}else 2*Zi()-x.renderingStartTime>$s&&p!==536870912&&(u.flags|=128,S=!0,xo(x,!1),u.lanes=4194304);x.isBackwards?(H.sibling=u.child,u.child=H):(s=x.last,s!==null?s.sibling=H:u.child=H,x.last=H)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=Zi(),u.sibling=null,s=En.current,v(En,S?s&1|2:s&1),u):(_n(u),null);case 22:case 23:return or(u),fs(),S=u.memoizedState!==null,s!==null?s.memoizedState!==null!==S&&(u.flags|=8192):S&&(u.flags|=8192),S?(p&536870912)!==0&&(u.flags&128)===0&&(_n(u),u.subtreeFlags&6&&(u.flags|=8192)):_n(u),p=u.updateQueue,p!==null&&wo(u,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),S=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(S=u.memoizedState.cachePool.pool),S!==p&&(u.flags|=2048),s!==null&&R(Cr),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),xe(en),_n(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function jg(s,u){switch(rt(u),u.tag){case 1:return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 3:return xe(en),q(),s=u.flags,(s&65536)!==0&&(s&128)===0?(u.flags=s&-65537|128,u):null;case 26:case 27:case 5:return $(u),null;case 13:if(or(u),s=u.memoizedState,s!==null&&s.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Kt()}return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 19:return R(En),null;case 4:return q(),null;case 10:return xe(u.type),null;case 22:case 23:return or(u),fs(),s!==null&&R(Cr),s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 24:return xe(en),null;case 25:return null;default:return null}}function Bd(s,u){switch(rt(u),u.tag){case 3:xe(en),q();break;case 26:case 27:case 5:$(u);break;case 4:q();break;case 13:or(u);break;case 19:R(En);break;case 10:xe(u.type);break;case 22:case 23:or(u),fs(),s!==null&&R(Cr);break;case 24:xe(en)}}function ti(s,u){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var x=S.next;p=x;do{if((p.tag&s)===s){S=void 0;var H=p.create,tt=p.inst;S=H(),tt.destroy=S}p=p.next}while(p!==x)}}catch(ot){je(u,u.return,ot)}}function ra(s,u,p){try{var S=u.updateQueue,x=S!==null?S.lastEffect:null;if(x!==null){var H=x.next;S=H;do{if((S.tag&s)===s){var tt=S.inst,ot=tt.destroy;if(ot!==void 0){tt.destroy=void 0,x=u;var bt=p,Nt=ot;try{Nt()}catch(Ut){je(x,bt,Ut)}}}S=S.next}while(S!==H)}}catch(Ut){je(u,u.return,Ut)}}function Lf(s){var u=s.updateQueue;if(u!==null){var p=s.stateNode;try{gd(u,p)}catch(S){je(s,s.return,S)}}}function Gf(s,u,p){p.props=ms(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(S){je(s,u,S)}}function bl(s,u){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var S=Ms(s.stateNode);break;case 30:S=s.stateNode;break;default:S=s.stateNode}typeof p=="function"?s.refCleanup=p(S):p.current=S}}catch(x){je(s,u,x)}}function ha(s,u){var p=s.ref,S=s.refCleanup;if(p!==null)if(typeof S=="function")try{S()}catch(x){je(s,u,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(x){je(s,u,x)}else p.current=null}function Qu(s){var u=s.type,p=s.memoizedProps,S=s.stateNode;try{Ei(S,u,p,s)}catch(x){je(s,s.return,x)}}function Hf(s,u,p){try{Rn(s.stateNode,s.type,p,u,s)}catch(S){je(s,s.return,S)}}function vs(s){return s.tag===5||s.tag===3||(Ji?s.tag===26:!1)||(wn?s.tag===27&&js(s.type):!1)||s.tag===4}function Mo(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||vs(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(wn&&s.tag===27&&js(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ys(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?Yo(p,s,u):ah(p,s);else if(S!==4&&(wn&&S===27&&js(s.type)&&(p=s.stateNode,u=null),s=s.child,s!==null))for(ys(s,u,p),s=s.sibling;s!==null;)ys(s,u,p),s=s.sibling}function _l(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?fc(p,s,u):ih(p,s);else if(S!==4&&(wn&&S===27&&js(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(_l(s,u,p),s=s.sibling;s!==null;)_l(s,u,p),s=s.sibling}function Pf(s,u,p){s=s.containerInfo;try{gc(s,p)}catch(S){je(u,u.return,S)}}function Ir(s){var u=s.stateNode,p=s.memoizedProps;try{g0(s.type,p,u,s)}catch(S){je(s,s.return,S)}}function El(s,u){for(Fr(s.containerInfo),Fn=u;Fn!==null;)if(s=Fn,u=s.child,(s.subtreeFlags&1024)!==0&&u!==null)u.return=s,Fn=u;else for(;Fn!==null;){s=Fn;var p=s.alternate;switch(u=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0;var S=s,x=p.memoizedProps;p=p.memoizedState;var H=S.stateNode;try{var tt=ms(S.type,x,S.elementType===S.type);u=H.getSnapshotBeforeUpdate(tt,p),H.__reactInternalSnapshotBeforeUpdate=u}catch(ot){je(S,S.return,ot)}}break;case 3:(u&1024)!==0&&Kn&&Kd(s.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=s.sibling,u!==null){u.return=s.return,Fn=u;break}Fn=s.return}}function Xu(s,u,p){var S=p.flags;switch(p.tag){case 0:case 11:case 15:Da(s,p),S&4&&ti(5,p);break;case 1:if(Da(s,p),S&4)if(s=p.stateNode,u===null)try{s.componentDidMount()}catch(tt){je(p,p.return,tt)}else{var x=ms(p.type,u.memoizedProps);u=u.memoizedState;try{s.componentDidUpdate(x,u,s.__reactInternalSnapshotBeforeUpdate)}catch(tt){je(p,p.return,tt)}}S&64&&Lf(p),S&512&&bl(p,p.return);break;case 3:if(Da(s,p),S&64&&(s=p.updateQueue,s!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=Ms(p.child.stateNode);break;case 1:u=p.child.stateNode}try{gd(s,u)}catch(tt){je(p,p.return,tt)}}break;case 27:wn&&u===null&&S&4&&Ir(p);case 26:case 5:Da(s,p),u===null&&S&4&&Qu(p),S&512&&bl(p,p.return);break;case 12:Da(s,p);break;case 13:Da(s,p),S&4&&kf(s,p),S&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Ff.bind(null,p),hh(s,p))));break;case 22:if(S=p.memoizedState!==null||Qa,!S){u=u!==null&&u.memoizedState!==null||pn,x=Qa;var H=pn;Qa=S,(pn=u)&&!H?da(s,p,(p.subtreeFlags&8772)!==0):Da(s,p),Qa=x,pn=H}break;case 30:break;default:Da(s,p)}}function If(s){var u=s.alternate;u!==null&&(s.alternate=null,If(u)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(u=s.stateNode,u!==null&&On(u)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function ei(s,u,p){for(p=p.child;p!==null;)Fu(s,u,p),p=p.sibling}function Fu(s,u,p){if(Bi&&typeof Bi.onCommitFiberUnmount=="function")try{Bi.onCommitFiberUnmount(Bl,p)}catch{}switch(p.tag){case 26:if(Ji){pn||ha(p,u),ei(s,u,p),p.memoizedState?mh(p.memoizedState):p.stateNode&&vh(p.stateNode);break}case 27:if(wn){pn||ha(p,u);var S=le,x=Oe;js(p.type)&&(le=p.stateNode,Oe=!1),ei(s,u,p),Sh(p.stateNode),le=S,Oe=x;break}case 5:pn||ha(p,u);case 6:if(Kn){if(S=le,x=Oe,le=null,ei(s,u,p),le=S,Oe=x,le!==null)if(Oe)try{sh(le,p.stateNode)}catch(H){je(p,u,H)}else try{hc(le,p.stateNode)}catch(H){je(p,u,H)}}else ei(s,u,p);break;case 18:Kn&&le!==null&&(Oe?o0(le,p.stateNode):l0(le,p.stateNode));break;case 4:Kn?(S=le,x=Oe,le=p.stateNode.containerInfo,Oe=!0,ei(s,u,p),le=S,Oe=x):(Ga&&Pf(p.stateNode,p,uh()),ei(s,u,p));break;case 0:case 11:case 14:case 15:pn||ra(2,p,u),pn||ra(4,p,u),ei(s,u,p);break;case 1:pn||(ha(p,u),S=p.stateNode,typeof S.componentWillUnmount=="function"&&Gf(p,u,S)),ei(s,u,p);break;case 21:ei(s,u,p);break;case 22:pn=(S=pn)||p.memoizedState!==null,ei(s,u,p),pn=S;break;default:ei(s,u,p)}}function kf(s,u){if(gn&&u.memoizedState===null&&(s=u.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{s0(s)}catch(p){je(u,u.return,p)}}function zd(s){switch(s.tag){case 13:case 19:var u=s.stateNode;return u===null&&(u=s.stateNode=new E0),u;case 22:return s=s.stateNode,u=s._retryCache,u===null&&(u=s._retryCache=new E0),u;default:throw Error(r(435,s.tag))}}function qf(s,u){var p=zd(s);u.forEach(function(S){var x=Jf.bind(null,s,S);p.has(S)||(p.add(S),S.then(x,x))})}function Si(s,u){var p=u.deletions;if(p!==null)for(var S=0;S<p.length;S++){var x=p[S],H=s,tt=u;if(Kn){var ot=tt;t:for(;ot!==null;){switch(ot.tag){case 27:if(wn){if(js(ot.type)){le=ot.stateNode,Oe=!1;break t}break}case 5:le=ot.stateNode,Oe=!1;break t;case 3:case 4:le=ot.stateNode.containerInfo,Oe=!0;break t}ot=ot.return}if(le===null)throw Error(r(160));Fu(H,tt,x),le=null,Oe=!1}else Fu(H,tt,x);H=x.alternate,H!==null&&(H.return=null),x.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Ld(u,s),u=u.sibling}function Ld(s,u){var p=s.alternate,S=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Si(u,s),bi(s),S&4&&(ra(3,s,s.return),ti(3,s),ra(5,s,s.return));break;case 1:Si(u,s),bi(s),S&512&&(pn||p===null||ha(p,p.return)),S&64&&Qa&&(s=s.updateQueue,s!==null&&(S=s.callbacks,S!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?S:p.concat(S))));break;case 26:if(Ji){var x=de;if(Si(u,s),bi(s),S&512&&(pn||p===null||ha(p,p.return)),S&4){S=p!==null?p.memoizedState:null;var H=s.memoizedState;p===null?H===null?s.stateNode===null?s.stateNode=h0(x,s.type,s.memoizedProps,s):Ec(x,s.type,s.stateNode):s.stateNode=_c(x,H,s.memoizedProps):S!==H?(S===null?p.stateNode!==null&&vh(p.stateNode):mh(S),H===null?Ec(x,s.type,s.stateNode):_c(x,H,s.memoizedProps)):H===null&&s.stateNode!==null&&Hf(s,s.memoizedProps,p.memoizedProps)}break}case 27:if(wn){Si(u,s),bi(s),S&512&&(pn||p===null||ha(p,p.return)),p!==null&&S&4&&Hf(s,s.memoizedProps,p.memoizedProps);break}case 5:if(Si(u,s),bi(s),S&512&&(pn||p===null||ha(p,p.return)),Kn){if(s.flags&32){x=s.stateNode;try{ka(x)}catch(Ut){je(s,s.return,Ut)}}S&4&&s.stateNode!=null&&(x=s.memoizedProps,Hf(s,x,p!==null?p.memoizedProps:x)),S&1024&&(Nc=!0)}break;case 6:if(Si(u,s),bi(s),S&4&&Kn){if(s.stateNode===null)throw Error(r(162));S=s.memoizedProps,p=p!==null?p.memoizedProps:S,x=s.stateNode;try{rh(x,p,S)}catch(Ut){je(s,s.return,Ut)}}break;case 3:if(Ji?(Gg(),x=de,de=bc(u.containerInfo),Si(u,s),de=x):Si(u,s),bi(s),S&4){if(Kn&&gn&&p!==null&&p.memoizedState.isDehydrated)try{r0(u.containerInfo)}catch(Ut){je(s,s.return,Ut)}if(Ga){S=u.containerInfo,p=u.pendingChildren;try{gc(S,p)}catch(Ut){je(s,s.return,Ut)}}}Nc&&(Nc=!1,Vf(s));break;case 4:Ji?(p=de,de=bc(s.stateNode.containerInfo),Si(u,s),bi(s),de=p):(Si(u,s),bi(s)),S&4&&Ga&&Pf(s.stateNode,s,s.stateNode.pendingChildren);break;case 12:Si(u,s),bi(s);break;case 13:Si(u,s),bi(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Ws=Zi()),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,qf(s,S)));break;case 22:x=s.memoizedState!==null;var tt=p!==null&&p.memoizedState!==null,ot=Qa,bt=pn;if(Qa=ot||x,pn=bt||tt,Si(u,s),pn=bt,Qa=ot,bi(s),S&8192&&(u=s.stateNode,u._visibility=x?u._visibility&-2:u._visibility|1,x&&(p===null||tt||Qa||pn||ni(s)),Kn)){t:if(p=null,Kn)for(u=s;;){if(u.tag===5||Ji&&u.tag===26){if(p===null){tt=p=u;try{H=tt.stateNode,x?dc(H):oh(tt.stateNode,tt.memoizedProps)}catch(Ut){je(tt,tt.return,Ut)}}}else if(u.tag===6){if(p===null){tt=u;try{var Nt=tt.stateNode;x?lh(Nt):Yd(Nt,tt.memoizedProps)}catch(Ut){je(tt,tt.return,Ut)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===s)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break t;for(;u.sibling===null;){if(u.return===null||u.return===s)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}S&4&&(S=s.updateQueue,S!==null&&(p=S.retryQueue,p!==null&&(S.retryQueue=null,qf(s,p))));break;case 19:Si(u,s),bi(s),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,qf(s,S)));break;case 30:break;case 21:break;default:Si(u,s),bi(s)}}function bi(s){var u=s.flags;if(u&2){try{if(Kn){for(var p,S=s.return;S!==null;){if(vs(S)){p=S;break}S=S.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:if(wn){var x=p.stateNode,H=Mo(s);_l(s,H,x);break}case 5:var tt=p.stateNode;p.flags&32&&(ka(tt),p.flags&=-33);var ot=Mo(s);_l(s,ot,tt);break;case 3:case 4:var bt=p.stateNode.containerInfo,Nt=Mo(s);ys(s,Nt,bt);break;default:throw Error(r(161))}}}catch(Ut){je(s,s.return,Ut)}s.flags&=-3}u&4096&&(s.flags&=-4097)}function Vf(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var u=s;Vf(u),u.tag===5&&u.flags&1024&&Ns(u.stateNode),s=s.sibling}}function Da(s,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Xu(s,u.alternate,u),u=u.sibling}function ni(s){for(s=s.child;s!==null;){var u=s;switch(u.tag){case 0:case 11:case 14:case 15:ra(4,u,u.return),ni(u);break;case 1:ha(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&Gf(u,u.return,p),ni(u);break;case 27:wn&&Sh(u.stateNode);case 26:case 5:ha(u,u.return),ni(u);break;case 22:u.memoizedState===null&&ni(u);break;case 30:ni(u);break;default:ni(u)}s=s.sibling}}function da(s,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var S=u.alternate,x=s,H=u,tt=H.flags;switch(H.tag){case 0:case 11:case 15:da(x,H,p),ti(4,H);break;case 1:if(da(x,H,p),S=H,x=S.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Nt){je(S,S.return,Nt)}if(S=H,x=S.updateQueue,x!==null){var ot=S.stateNode;try{var bt=x.shared.hiddenCallbacks;if(bt!==null)for(x.shared.hiddenCallbacks=null,x=0;x<bt.length;x++)bu(bt[x],ot)}catch(Nt){je(S,S.return,Nt)}}p&&tt&64&&Lf(H),bl(H,H.return);break;case 27:wn&&Ir(H);case 26:case 5:da(x,H,p),p&&S===null&&tt&4&&Qu(H),bl(H,H.return);break;case 12:da(x,H,p);break;case 13:da(x,H,p),p&&tt&4&&kf(x,H);break;case 22:H.memoizedState===null&&da(x,H,p),bl(H,H.return);break;case 30:break;default:da(x,H,p)}u=u.sibling}}function Ni(s,u){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(s=u.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&Sn(p))}function kr(s,u){s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&Sn(s))}function sa(s,u,p,S){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)No(s,u,p,S),u=u.sibling}function No(s,u,p,S){var x=u.flags;switch(u.tag){case 0:case 11:case 15:sa(s,u,p,S),x&2048&&ti(9,u);break;case 1:sa(s,u,p,S);break;case 3:sa(s,u,p,S),x&2048&&(s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&Sn(s)));break;case 12:if(x&2048){sa(s,u,p,S),s=u.stateNode;try{var H=u.memoizedProps,tt=H.id,ot=H.onPostCommit;typeof ot=="function"&&ot(tt,u.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(bt){je(u,u.return,bt)}}else sa(s,u,p,S);break;case 13:sa(s,u,p,S);break;case 23:break;case 22:H=u.stateNode,tt=u.alternate,u.memoizedState!==null?H._visibility&2?sa(s,u,p,S):Ss(s,u):H._visibility&2?sa(s,u,p,S):(H._visibility|=2,ur(s,u,p,S,(u.subtreeFlags&10256)!==0)),x&2048&&Ni(tt,u);break;case 24:sa(s,u,p,S),x&2048&&kr(u.alternate,u);break;default:sa(s,u,p,S)}}function ur(s,u,p,S,x){for(x=x&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var H=s,tt=u,ot=p,bt=S,Nt=tt.flags;switch(tt.tag){case 0:case 11:case 15:ur(H,tt,ot,bt,x),ti(8,tt);break;case 23:break;case 22:var Ut=tt.stateNode;tt.memoizedState!==null?Ut._visibility&2?ur(H,tt,ot,bt,x):Ss(H,tt):(Ut._visibility|=2,ur(H,tt,ot,bt,x)),x&&Nt&2048&&Ni(tt.alternate,tt);break;case 24:ur(H,tt,ot,bt,x),x&&Nt&2048&&kr(tt.alternate,tt);break;default:ur(H,tt,ot,bt,x)}u=u.sibling}}function Ss(s,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=s,S=u,x=S.flags;switch(S.tag){case 22:Ss(p,S),x&2048&&Ni(S.alternate,S);break;case 24:Ss(p,S),x&2048&&kr(S.alternate,S);break;default:Ss(p,S)}u=u.sibling}}function Yi(s){if(s.subtreeFlags&Ce)for(s=s.child;s!==null;)Yf(s),s=s.sibling}function Yf(s){switch(s.tag){case 26:Yi(s),s.flags&Ce&&(s.memoizedState!==null?Ko(de,s.memoizedState,s.memoizedProps):Qe(s.type,s.memoizedProps));break;case 5:Yi(s),s.flags&Ce&&Qe(s.type,s.memoizedProps);break;case 3:case 4:if(Ji){var u=de;de=bc(s.stateNode.containerInfo),Yi(s),de=u}else Yi(s);break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Ce,Ce=16777216,Yi(s),Ce=u):Yi(s));break;default:Yi(s)}}function Do(s){var u=s.alternate;if(u!==null&&(s=u.child,s!==null)){u.child=null;do u=s.sibling,s.sibling=null,s=u;while(s!==null)}}function ja(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];Fn=S,Ju(S,s)}Do(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Gd(s),s=s.sibling}function Gd(s){switch(s.tag){case 0:case 11:case 15:ja(s),s.flags&2048&&ra(9,s,s.return);break;case 3:ja(s);break;case 12:ja(s);break;case 22:var u=s.stateNode;s.memoizedState!==null&&u._visibility&2&&(s.return===null||s.return.tag!==13)?(u._visibility&=-3,di(s)):ja(s);break;default:ja(s)}}function di(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];Fn=S,Ju(S,s)}Do(s)}for(s=s.child;s!==null;){switch(u=s,u.tag){case 0:case 11:case 15:ra(8,u,u.return),di(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,di(u));break;default:di(u)}s=s.sibling}}function Ju(s,u){for(;Fn!==null;){var p=Fn;switch(p.tag){case 0:case 11:case 15:ra(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var S=p.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:Sn(p.memoizedState.cache)}if(S=p.child,S!==null)S.return=p,Fn=S;else t:for(p=s;Fn!==null;){S=Fn;var x=S.sibling,H=S.return;if(If(S),S===p){Fn=null;break t}if(x!==null){x.return=H,Fn=x;break t}Fn=H}}}function ga(s){var u=la(s);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(r(364));return u}if(s=Ug(s),s===null)throw Error(r(362));return s.stateNode.current}function Zu(s,u){var p=s.tag;switch(u.$$typeof){case pi:if(s.type===u.value)return!0;break;case Ea:t:{for(u=u.value,s=[s,0],p=0;p<s.length;){var S=s[p++],x=S.tag,H=s[p++],tt=u[H];if(x!==5&&x!==26&&x!==27||!Ds(S)){for(;tt!=null&&Zu(S,tt);)H++,tt=u[H];if(H===u.length){u=!0;break t}else for(S=S.child;S!==null;)s.push(S,H),S=S.sibling}}u=!1}return u;case Tr:if((p===5||p===26||p===27)&&qd(s.stateNode,u.value))return!0;break;case ca:if((p===5||p===6||p===26||p===27)&&(s=nh(s),s!==null&&0<=s.indexOf(u.value)))return!0;break;case Hl:if((p===5||p===26||p===27)&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Cl(s){switch(s.$$typeof){case pi:return"<"+(C(s.value)||"Unknown")+">";case Ea:return":has("+(Cl(s)||"")+")";case Tr:return'[role="'+s.value+'"]';case ca:return'"'+s.value+'"';case Hl:return'[data-testname="'+s.value+'"]';default:throw Error(r(365))}}function qr(s,u){var p=[];s=[s,0];for(var S=0;S<s.length;){var x=s[S++],H=x.tag,tt=s[S++],ot=u[tt];if(H!==5&&H!==26&&H!==27||!Ds(x)){for(;ot!=null&&Zu(x,ot);)tt++,ot=u[tt];if(tt===u.length)p.push(x);else for(x=x.child;x!==null;)s.push(x,tt),x=x.sibling}}return p}function jo(s,u){if(!Ia)throw Error(r(363));s=ga(s),s=qr(s,u),u=[],s=Array.from(s);for(var p=0;p<s.length;){var S=s[p++],x=S.tag;if(x===5||x===26||x===27)Ds(S)||u.push(S.stateNode);else for(S=S.child;S!==null;)s.push(S),S=S.sibling}return u}function Di(){if((Te&2)!==0&&Re!==0)return Re&-Re;if(re.T!==null){var s=Ya;return s!==0?s:ki()}return Wr()}function Wu(){oi===0&&(oi=(Re&536870912)===0||Pe?L():536870912);var s=ta.current;return s!==null&&(s.flags|=32),oi}function ji(s,u,p){(s===Ze&&(Le===2||Le===9)||s.cancelPendingCommit!==null)&&(ii(s,0),pa(s,Re,oi,!1)),O(s,p),((Te&2)===0||s!==Ze)&&(s===Ze&&((Te&2)===0&&(fn|=p),cn===4&&pa(s,Re,oi,!1)),We(s))}function Ki(s,u,p){if((Te&6)!==0)throw Error(r(327));var S=!p&&(u&124)===0&&(u&s.expiredLanes)===0||N(s,u),x=S?Hd(s,u):Uo(s,u,!0),H=S;do{if(x===0){Ar&&!S&&pa(s,u,0,!1);break}else{if(p=s.current.alternate,H&&!Tl(p)){x=Uo(s,u,!1),H=!1;continue}if(x===2){if(H=u,s.errorRecoveryDisabledLanes&H)var tt=0;else tt=s.pendingLanes&-536870913,tt=tt!==0?tt:tt&536870912?536870912:0;if(tt!==0){u=tt;t:{var ot=s;x=Zs;var bt=gn&&ot.current.memoizedState.isDehydrated;if(bt&&(ii(ot,tt).flags|=256),tt=Uo(ot,tt,!1),tt!==2){if(Dc&&!bt){ot.errorRecoveryDisabledLanes|=H,fn|=H,x=4;break t}H=mi,mi=x,H!==null&&(mi===null?mi=H:mi.push.apply(mi,H))}x=tt}if(H=!1,x!==2)continue}}if(x===1){ii(s,0),pa(s,u,0,!0);break}t:{switch(S=s,H=x,H){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:pa(S,u,oi,!Xa);break t;case 2:mi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(x=Ws+300-Zi(),10<x)){if(pa(S,u,oi,!Xa),G(S,0,!0)!==0)break t;S.timeoutHandle=kd(bs.bind(null,S,p,mi,vi,jc,u,oi,fn,Hi,Xa,H,2,-0,0),x);break t}bs(S,p,mi,vi,jc,u,oi,fn,Hi,Xa,H,0,-0,0)}}break}while(!0);We(s)}function bs(s,u,p,S,x,H,tt,ot,bt,Nt,Ut,Vt,Xt,Se){if(s.timeoutHandle=za,Vt=u.subtreeFlags,(Vt&8192||(Vt&16785408)===16785408)&&(ye(),Yf(u),Vt=Ln(),Vt!==null)){s.cancelPendingCommit=Vt(fr.bind(null,s,u,H,p,S,x,tt,ot,bt,Ut,1,Xt,Se)),pa(s,H,tt,!Nt);return}fr(s,u,H,p,S,x,tt,ot,bt)}function Tl(s){for(var u=s;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var S=0;S<p.length;S++){var x=p[S],H=x.getSnapshot;x=x.value;try{if(!Ti(H(),x))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function pa(s,u,p,S){u&=~Fa,u&=~fn,s.suspendedLanes|=u,s.pingedLanes&=~u,S&&(s.warmLanes|=u),S=s.expirationTimes;for(var x=u;0<x;){var H=31-Ci(x),tt=1<<H;S[H]=-1,x&=~tt}p!==0&&B(s,p,u)}function Al(){return(Te&6)===0?(ut(0),!1):!0}function Ui(){if(ue!==null){if(Le===0)var s=ue.return;else s=ue,si=es=null,rr(s),Gi=null,Qs=0,s=ue;for(;s!==null;)Bd(s.alternate,s),s=s.return;ue=null}}function ii(s,u){var p=s.timeoutHandle;p!==za&&(s.timeoutHandle=za,Dl(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Ui(),Ze=s,ue=p=on(s.current,null),Re=u,Le=0,an=null,Xa=!1,Ar=N(s,u),Dc=!1,Hi=oi=Fa=fn=Ri=cn=0,mi=Zs=null,jc=!1,(u&8)!==0&&(u|=u&32);var S=s.entangledLanes;if(S!==0)for(s=s.entanglements,S&=u;0<S;){var x=31-Ci(S),H=1<<x;u|=s[x],S&=~H}return fa=u,me(),p}function cr(s,u){se=null,re.H=li,u===Ps||u===Is?(u=he(),Le=3):u===Wo?(u=he(),Le=4):Le=u===Mh?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,an=u,ue===null&&(cn=1,vl(s,X(u,s.current)))}function ma(){var s=ta.current;return s===null?!0:(Re&4194048)===Re?Oi===null:(Re&62914560)===Re||(Re&536870912)!==0?s===Oi:!1}function va(){var s=re.H;return re.H=li,s===null?li:s}function Ua(){var s=re.A;return re.A=Xe,s}function $u(){cn=4,Xa||(Re&4194048)!==Re&&ta.current!==null||(Ar=!0),(Ri&134217727)===0&&(fn&134217727)===0||Ze===null||pa(Ze,Re,oi,!1)}function Uo(s,u,p){var S=Te;Te|=2;var x=va(),H=Ua();(Ze!==s||Re!==u)&&(vi=null,ii(s,u)),u=!1;var tt=cn;t:do try{if(Le!==0&&ue!==null){var ot=ue,bt=an;switch(Le){case 8:Ui(),tt=6;break t;case 3:case 2:case 9:case 6:ta.current===null&&(u=!0);var Nt=Le;if(Le=0,an=null,Qi(s,ot,bt,Nt),p&&Ar){tt=0;break t}break;default:Nt=Le,Le=0,an=null,Qi(s,ot,bt,Nt)}}Kf(),tt=cn;break}catch(Ut){cr(s,Ut)}while(!0);return u&&s.shellSuspendCounter++,si=es=null,Te=S,re.H=x,re.A=H,ue===null&&(Ze=null,Re=0,me()),tt}function Kf(){for(;ue!==null;)tn(ue)}function Hd(s,u){var p=Te;Te|=2;var S=va(),x=Ua();Ze!==s||Re!==u?(vi=null,$s=Zi()+500,ii(s,u)):Ar=N(s,u);t:do try{if(Le!==0&&ue!==null){u=ue;var H=an;e:switch(Le){case 1:Le=0,an=null,Qi(s,u,H,1);break;case 2:case 9:if(Ae(H)){Le=0,an=null,Ne(u);break}u=function(){Le!==2&&Le!==9||Ze!==s||(Le=7),We(s)},H.then(u,u);break t;case 3:Le=7;break t;case 4:Le=5;break t;case 7:Ae(H)?(Le=0,an=null,Ne(u)):(Le=0,an=null,Qi(s,u,H,7));break;case 5:var tt=null;switch(ue.tag){case 26:tt=ue.memoizedState;case 5:case 27:var ot=ue,bt=ot.type,Nt=ot.pendingProps;if(tt?yh(tt):Pa(bt,Nt)){Le=0,an=null;var Ut=ot.sibling;if(Ut!==null)ue=Ut;else{var Vt=ot.return;Vt!==null?(ue=Vt,_i(Vt)):ue=null}break e}}Le=0,an=null,Qi(s,u,H,5);break;case 6:Le=0,an=null,Qi(s,u,H,6);break;case 8:Ui(),cn=6;break t;default:throw Error(r(462))}}ai();break}catch(Xt){cr(s,Xt)}while(!0);return si=es=null,re.H=S,re.A=x,Te=p,ue!==null?0:(Ze=null,Re=0,me(),cn)}function ai(){for(;ue!==null&&!Tc();)tn(ue)}function tn(s){var u=Sl(s.alternate,s,fa);s.memoizedProps=s.pendingProps,u===null?_i(s):ue=u}function Ne(s){var u=s,p=u.alternate;switch(u.tag){case 15:case 0:u=Hu(p,u,u.pendingProps,u.type,void 0,Re);break;case 11:u=Hu(p,u,u.pendingProps,u.type.render,u.ref,Re);break;case 5:rr(u);default:Bd(p,u),u=ue=Bo(u,fa),u=Sl(p,u,fa)}s.memoizedProps=s.pendingProps,u===null?_i(s):ue=u}function Qi(s,u,p,S){si=es=null,rr(u),Gi=null,Qs=0;var x=u.return;try{if(Ng(s,x,u,p,Re)){cn=1,vl(s,X(p,s.current)),ue=null;return}}catch(H){if(x!==null)throw ue=x,H;cn=1,vl(s,X(p,s.current)),ue=null;return}u.flags&32768?(Pe||S===1?s=!0:Ar||(Re&536870912)!==0?s=!1:(Xa=s=!0,(S===2||S===9||S===3||S===6)&&(S=ta.current,S!==null&&S.tag===13&&(S.flags|=16384))),tc(u,s)):_i(u)}function _i(s){var u=s;do{if((u.flags&32768)!==0){tc(u,Xa);return}s=u.return;var p=Dg(u.alternate,u,fa);if(p!==null){ue=p;return}if(u=u.sibling,u!==null){ue=u;return}ue=u=s}while(u!==null);cn===0&&(cn=5)}function tc(s,u){do{var p=jg(s.alternate,s);if(p!==null){p.flags&=32767,ue=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(s=s.sibling,s!==null)){ue=s;return}ue=s=p}while(s!==null);cn=6,ue=null}function fr(s,u,p,S,x,H,tt,ot,bt){s.cancelPendingCommit=null;do Es();while(Ve!==0);if((Te&6)!==0)throw Error(r(327));if(u!==null){if(u===s.current)throw Error(r(177));if(H=u.lanes|u.childLanes,H|=Mc,y(s,p,H,tt,ot,bt),s===Ze&&(ue=Ze=null,Re=0),tl=u,Rr=s,Pl=p,Ja=H,Il=x,Uc=S,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Rl(_h,function(){return Ol(),null})):(s.callbackNode=null,s.callbackPriority=0),S=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||S){S=re.T,re.T=null,x=Ha(),zn(2),tt=Te,Te|=4;try{El(s,u,p)}finally{Te=tt,zn(x),re.T=S}}Ve=1,Qf(),Xf(),_s()}}function Qf(){if(Ve===1){Ve=0;var s=Rr,u=tl,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=re.T,re.T=null;var S=Ha();zn(2);var x=Te;Te|=4;try{Ld(u,s),ko(s.containerInfo)}finally{Te=x,zn(S),re.T=p}}s.current=u,Ve=2}}function Xf(){if(Ve===2){Ve=0;var s=Rr,u=tl,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=re.T,re.T=null;var S=Ha();zn(2);var x=Te;Te|=4;try{Xu(s,u.alternate,u)}finally{Te=x,zn(S),re.T=p}}Ve=3}}function _s(){if(Ve===4||Ve===3){Ve=0,v0();var s=Rr,u=tl,p=Pl,S=Uc;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Ve=5:(Ve=0,tl=Rr=null,Vr(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(Or=null),K(p),u=u.stateNode,Bi&&typeof Bi.onCommitFiberRoot=="function")try{Bi.onCommitFiberRoot(Bl,u,void 0,(u.current.flags&128)===128)}catch{}if(S!==null){u=re.T,x=Ha(),zn(2),re.T=null;try{for(var H=s.onRecoverableError,tt=0;tt<S.length;tt++){var ot=S[tt];H(ot.value,{componentStack:ot.stack})}}finally{re.T=u,zn(x)}}(Pl&3)!==0&&Es(),We(s),x=s.pendingLanes,(p&4194090)!==0&&(x&42)!==0?s===Bc?Za++:(Za=0,Bc=s):Za=0,ut(0)}}function Vr(s,u){(s.pooledCacheLanes&=u)===0&&(u=s.pooledCache,u!=null&&(s.pooledCache=null,Sn(u)))}function Es(s){return Qf(),Xf(),_s(),Ol()}function Ol(){if(Ve!==5)return!1;var s=Rr,u=Ja;Ja=0;var p=K(Pl),S=32>p?32:p;p=re.T;var x=Ha();try{zn(S),re.T=null,S=Il,Il=null;var H=Rr,tt=Pl;if(Ve=0,tl=Rr=null,Pl=0,(Te&6)!==0)throw Error(r(331));var ot=Te;if(Te|=4,Gd(H.current),No(H,H.current,tt,S),Te=ot,ut(0,!1),Bi&&typeof Bi.onPostCommitFiberRoot=="function")try{Bi.onPostCommitFiberRoot(Bl,H)}catch{}return!0}finally{zn(x),re.T=p,Vr(s,u)}}function ec(s,u,p){u=X(p,u),u=Mf(s.stateNode,u,2),s=ar(s,u,2),s!==null&&(O(s,2),We(s))}function je(s,u,p){if(s.tag===3)ec(s,s,p);else for(;u!==null;){if(u.tag===3){ec(u,s,p);break}else if(u.tag===1){var S=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Or===null||!Or.has(S))){s=X(p,s),p=Od(2),S=ar(u,p,2),S!==null&&(Nf(p,S,u,s),O(S,2),We(S));break}}u=u.return}}function ya(s,u,p){var S=s.pingCache;if(S===null){S=s.pingCache=new as;var x=new Set;S.set(u,x)}else x=S.get(u),x===void 0&&(x=new Set,S.set(u,x));x.has(p)||(Dc=!0,x.add(p),s=Yr.bind(null,s,u,p),u.then(s,s))}function Yr(s,u,p){var S=s.pingCache;S!==null&&S.delete(u),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,Ze===s&&(Re&p)===p&&(cn===4||cn===3&&(Re&62914560)===Re&&300>Zi()-Ws?(Te&2)===0&&ii(s,0):Fa|=p,Hi===Re&&(Hi=0)),We(s)}function Ba(s,u){u===0&&(u=w()),s=cs(s,u),s!==null&&(O(s,u),We(s))}function Ff(s){var u=s.memoizedState,p=0;u!==null&&(p=u.retryLane),Ba(s,p)}function Jf(s,u){var p=0;switch(s.tag){case 13:var S=s.stateNode,x=s.memoizedState;x!==null&&(p=x.retryLane);break;case 19:S=s.stateNode;break;case 22:S=s.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(u),Ba(s,p)}function Rl(s,u){return Jo(s,u)}function nc(s,u,p,S){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function on(s,u){var p=s.alternate;return p===null?(p=n(s.tag,u,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=u,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,u=s.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Bo(s,u){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,u=p.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),s}function zo(s,u,p,S,x,H){var tt=0;if(S=s,typeof s=="function")hr(s)&&(tt=1);else if(typeof s=="string")tt=Ji&&wn?ph(s,p,kn.current)?26:Ul(s)?27:5:Ji?ph(s,p,kn.current)?26:5:wn&&Ul(s)?27:5;else t:switch(s){case Qr:return s=n(31,p,u,x),s.elementType=Qr,s.lanes=H,s;case Os:return Cs(p.children,x,H,u);case Rs:tt=8,x|=24;break;case Lo:return s=n(12,p,u,x|2),s.elementType=Lo,s.lanes=H,s;case pr:return s=n(13,p,u,x),s.elementType=pr,s.lanes=H,s;case mr:return s=n(19,p,u,x),s.elementType=mr,s.lanes=H,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case sc:case gr:tt=10;break t;case Go:tt=9;break t;case lc:tt=11;break t;case oc:tt=14;break t;case vr:tt=16,S=null;break t}tt=29,p=Error(r(130,s===null?"null":typeof s,"")),S=null}return u=n(tt,p,u,x),u.elementType=s,u.type=S,u.lanes=H,u}function Cs(s,u,p,S){return s=n(7,s,S,u),s.lanes=p,s}function Zf(s,u,p){return s=n(6,s,null,u),s.lanes=p,s}function Wf(s,u,p){return u=n(4,s.children!==null?s.children:[],s.key,u),u.lanes=p,u.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},u}function Bn(s,u,p,S,x,H,tt,ot){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=za,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=A(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=A(0),this.hiddenUpdates=A(null),this.identifierPrefix=S,this.onUncaughtError=x,this.onCaughtError=H,this.onRecoverableError=tt,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ot,this.incompleteTransitions=new Map}function ic(s,u,p,S,x,H,tt,ot,bt,Nt,Ut,Vt){return s=new Bn(s,u,p,tt,ot,bt,Nt,Vt),u=1,H===!0&&(u|=24),H=n(3,null,null,u),s.current=H,H.stateNode=s,u=ln(),u.refCount++,s.pooledCache=u,u.refCount++,H.memoizedState={element:S,isDehydrated:p,cache:u},fo(H),s}function wl(s){return s?(s=$r,s):$r}function xl(s){var u=s._reactInternals;if(u===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(u),s=s!==null?g(s):null,s===null?null:Ms(s.stateNode)}function ac(s,u,p,S,x,H){x=wl(x),S.context===null?S.context=x:S.pendingContext=x,S=ir(u),S.payload={element:p},H=H===void 0?null:H,H!==null&&(S.callback=H),p=ar(s,S,u),p!==null&&(ji(p,s,u),na(p,s,u))}function Ts(s,u){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<u?p:u}}function Kr(s,u){Ts(s,u),(s=s.alternate)&&Ts(s,u)}var Me={},Pd=Sg(),Xi=R6(),rc=Object.assign,As=Symbol.for("react.element"),Ml=Symbol.for("react.transitional.element"),dr=Symbol.for("react.portal"),Os=Symbol.for("react.fragment"),Rs=Symbol.for("react.strict_mode"),Lo=Symbol.for("react.profiler"),sc=Symbol.for("react.provider"),Go=Symbol.for("react.consumer"),gr=Symbol.for("react.context"),lc=Symbol.for("react.forward_ref"),pr=Symbol.for("react.suspense"),mr=Symbol.for("react.suspense_list"),oc=Symbol.for("react.memo"),vr=Symbol.for("react.lazy"),Qr=Symbol.for("react.activity"),Ho=Symbol.for("react.memo_cache_sentinel"),Po=Symbol.iterator,Io=Symbol.for("react.client.reference"),ws=Array.isArray,re=Pd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xs=t.rendererVersion,Id=t.rendererPackageName,yr=t.extraDevToolsConfig,Ms=t.getPublicInstance,$f=t.getRootHostContext,Xr=t.getChildHostContext,Fr=t.prepareForCommit,ko=t.resetAfterCommit,th=t.createInstance;t.cloneMutableInstance;var qo=t.appendInitialChild,Nl=t.finalizeInitialChildren,Jr=t.shouldSetTextContent,eh=t.createTextInstance;t.cloneMutableTextInstance;var kd=t.scheduleTimeout,Dl=t.cancelTimeout,za=t.noTimeout,La=t.isPrimaryRenderer;t.warnsIfNotActing;var Kn=t.supportsMutation,Ga=t.supportsPersistence,gn=t.supportsHydration,la=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var Zr=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var zn=t.setCurrentUpdatePriority,Ha=t.getCurrentUpdatePriority,Wr=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var Fi=t.shouldAttemptEagerTransition,On=t.detachDeletedInstance;t.requestPostPaintCallback;var uc=t.maySuspendCommit,Pa=t.preloadInstance,ye=t.startSuspendingCommit,Qe=t.suspendInstance;t.suspendOnActiveViewTransition;var Ln=t.waitForCommitToBeReady,Sr=t.NotPendingTransition,oa=t.HostTransitionContext,Ns=t.resetFormInstance;t.bindToConsole;var cc=t.supportsMicrotasks,Vo=t.scheduleMicrotask,Ia=t.supportsTestSelectors,Ug=t.findFiberRoot,Tn=t.getBoundingRect,nh=t.getTextContent,Ds=t.isHiddenSubtree,qd=t.matchAccessibilityRole,Vd=t.setFocusIfFocusable,Bg=t.setupIntersectionObserver,ih=t.appendChild,ah=t.appendChildToContainer,rh=t.commitTextUpdate,Ei=t.commitMount,Rn=t.commitUpdate,fc=t.insertBefore,Yo=t.insertInContainerBefore,hc=t.removeChild,sh=t.removeChildFromContainer,ka=t.resetTextContent,dc=t.hideInstance,lh=t.hideTextInstance,oh=t.unhideInstance,Yd=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopGestureTransition,t.getCurrentGestureOffset,t.subscribeToGestureDirection,t.createViewTransitionInstance;var Kd=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var Qd=t.cloneInstance,uh=t.createContainerChildSet,ch=t.appendChildToContainerChildSet,Xd=t.finalizeContainerChildren,gc=t.replaceContainerChildren,fh=t.cloneHiddenInstance,Fd=t.cloneHiddenTextInstance,pc=t.isSuspenseInstancePending,mc=t.isSuspenseInstanceFallback,Jd=t.getSuspenseInstanceFallbackErrorDetails,hh=t.registerSuspenseInstanceRetry,Zd=t.canHydrateFormStateMarker,Wd=t.isFormStateMarkerMatching,dh=t.getNextHydratableSibling,$d=t.getNextHydratableSiblingAfterSingleton,t0=t.getFirstHydratableChild,zg=t.getFirstHydratableChildWithinContainer,e0=t.getFirstHydratableChildWithinSuspenseInstance,jl=t.getFirstHydratableChildWithinSingleton,n0=t.canHydrateInstance,vc=t.canHydrateTextInstance,yc=t.canHydrateSuspenseInstance,i0=t.hydrateInstance,gh=t.hydrateTextInstance,Lg=t.hydrateSuspenseInstance,a0=t.getNextHydratableInstanceAfterSuspenseInstance,r0=t.commitHydratedContainer,s0=t.commitHydratedSuspenseInstance,l0=t.clearSuspenseBoundary,o0=t.clearSuspenseBoundaryFromContainer,Sc=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var u0=t.validateHydratableInstance,c0=t.validateHydratableTextInstance,Ji=t.supportsResources,ph=t.isHostHoistableType,bc=t.getHoistableRoot,f0=t.getResource,_c=t.acquireResource,mh=t.releaseResource,h0=t.hydrateHoistable,Ec=t.mountHoistable,vh=t.unmountHoistable,d0=t.createHoistableInstance,Gg=t.prepareToCommitHoistables,Hg=t.mayResourceSuspendCommit,yh=t.preloadResource,Ko=t.suspendResource,wn=t.supportsSingletons,Qo=t.resolveSingletonInstance,g0=t.acquireSingletonInstance,Sh=t.releaseSingletonInstance,Ul=t.isHostSingletonType,js=t.isSingletonScope,Xo=[],Us=-1,$r={},Ci=Math.clz32?Math.clz32:D,p0=Math.log,m0=Math.LN2,qa=256,Fo=4194304,Jo=Xi.unstable_scheduleCallback,Cc=Xi.unstable_cancelCallback,Tc=Xi.unstable_shouldYield,v0=Xi.unstable_requestPaint,Zi=Xi.unstable_now,bh=Xi.unstable_ImmediatePriority,y0=Xi.unstable_UserBlockingPriority,_h=Xi.unstable_NormalPriority,Eh=Xi.unstable_IdlePriority,Gn=Xi.log,ri=Xi.unstable_setDisableYieldValue,Bl=null,Bi=null,Ac,Ch,Bs=!1,Th=new WeakMap,br=[],zs=0,Oc=null,Ls=0,zi=[],Wi=0,ts=null,Va=1,Sa="",kn=E(null),Gs=E(null),_r=E(null),zl=E(null),Qn=null,xn=null,Pe=!1,Er=null,ba=!1,_a=Error(r(519)),Ti=typeof Object.is=="function"?Object.is:Pt,Rc=E(null),es=null,si=null,Ah=typeof AbortController<"u"?AbortController:function(){var s=[],u=this.signal={aborted:!1,addEventListener:function(p,S){s.push(S)}};this.abort=function(){u.aborted=!0,s.forEach(function(p){return p()})}},S0=Xi.unstable_scheduleCallback,wc=Xi.unstable_NormalPriority,en={$$typeof:gr,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Je=null,Ll=null,Oh=!1,Zo=!1,Hs=!1,$i=0,Gl=null,xc=0,Ya=0,Ai=null,Rh=re.S;re.S=function(s,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&hi(s,u),Rh!==null&&Rh(s,u)};var Cr=E(null),b0=Object.prototype.hasOwnProperty,Ps=Error(r(460)),Wo=Error(r(474)),Is=Error(r(542)),$o={then:function(){}},Li=null,ke=[],ns=0,Mc=0,un=!1,wh=!1,ks=E(null),tu=E(0),qe=0,se=null,De=null,Mn=null,eu=!1,qs=!1,Vs=!1,Ys=0,Xn=0,gi=null,_0=0,li={readContext:$t,use:Au,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn,useHostTransitionStatus:bn,useFormState:bn,useActionState:bn,useOptimistic:bn,useMemoCache:bn,useCacheRefresh:bn},xh={readContext:$t,use:Au,useCallback:function(s,u){return In().memoizedState=[s,u===void 0?null:u],s},useContext:$t,useEffect:Af,useImperativeHandle:function(s,u,p){p=p!=null?p.concat([s]):null,sr(4194308,4,Ma.bind(null,u,s),p)},useLayoutEffect:function(s,u){return sr(4194308,4,s,u)},useInsertionEffect:function(s,u){sr(4,2,s,u)},useMemo:function(s,u){var p=In();u=u===void 0?null:u;var S=s();if(Vs){Y(!0);try{s()}finally{Y(!1)}}return p.memoizedState=[S,u],S},useReducer:function(s,u,p){var S=In();if(p!==void 0){var x=p(u);if(Vs){Y(!0);try{p(u)}finally{Y(!1)}}}else x=u;return S.memoizedState=S.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},S.queue=s,s=s.dispatch=So.bind(null,se,s),[S.memoizedState,s]},useRef:function(s){var u=In();return s={current:s},u.memoizedState=s},useState:function(s){s=po(s);var u=s.queue,p=bd.bind(null,se,u);return u.dispatch=p,[s.memoizedState,p]},useDebugValue:gs,useDeferredValue:function(s,u){var p=In();return ml(p,s,u)},useTransition:function(){var s=po(!1);return s=vo.bind(null,se,s.queue,!0,!1),In().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,u,p){var S=se,x=In();if(Pe){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),Ze===null)throw Error(r(349));(Re&124)!==0||Ru(S,u,p)}x.memoizedState=p;var H={value:p,getSnapshot:u};return x.queue=H,Af(go.bind(null,S,H,s),[s]),S.flags|=2048,Mi(9,gl(),yf.bind(null,S,H,p,u),null),p},useId:function(){var s=In(),u=Ze.identifierPrefix;if(Pe){var p=Sa,S=Va;p=(S&~(1<<32-Ci(S)-1)).toString(32)+p,u="«"+u+"R"+p,p=Ys++,0<p&&(u+="H"+p.toString(32)),u+="»"}else p=_0++,u="«"+u+"r"+p.toString(32)+"»";return s.memoizedState=u},useHostTransitionStatus:ju,useFormState:Tf,useActionState:Tf,useOptimistic:function(s){var u=In();u.memoizedState=u.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=bo.bind(null,se,!0,p),p.dispatch=u,[s,u]},useMemoCache:dl,useCacheRefresh:function(){return In().memoizedState=Uu.bind(null,se)}},Ka={readContext:$t,use:Au,useCallback:lr,useContext:$t,useEffect:Mu,useImperativeHandle:Nu,useInsertionEffect:Of,useLayoutEffect:pl,useMemo:Du,useReducer:aa,useRef:xu,useState:function(){return aa(ia)},useDebugValue:gs,useDeferredValue:function(s,u){var p=Un();return Rf(p,De.memoizedState,s,u)},useTransition:function(){var s=aa(ia)[0],u=Un().memoizedState;return[typeof s=="boolean"?s:hl(s),u]},useSyncExternalStore:md,useId:yi,useHostTransitionStatus:ju,useFormState:wu,useActionState:wu,useOptimistic:function(s,u){var p=Un();return Sf(p,De,s,u)},useMemoCache:dl,useCacheRefresh:zr},Ks={readContext:$t,use:Au,useCallback:lr,useContext:$t,useEffect:Mu,useImperativeHandle:Nu,useInsertionEffect:Of,useLayoutEffect:pl,useMemo:Du,useReducer:Ou,useRef:xu,useState:function(){return Ou(ia)},useDebugValue:gs,useDeferredValue:function(s,u){var p=Un();return De===null?ml(p,s,u):Rf(p,De.memoizedState,s,u)},useTransition:function(){var s=Ou(ia)[0],u=Un().memoizedState;return[typeof s=="boolean"?s:hl(s),u]},useSyncExternalStore:md,useId:yi,useHostTransitionStatus:ju,useFormState:mo,useActionState:mo,useOptimistic:function(s,u){var p=Un();return De!==null?Sf(p,De,s,u):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:dl,useCacheRefresh:zr},Gi=null,Qs=0,is=_d(!0),ua=_d(!1),ta=E(null),Oi=null,En=E(0),Xs={enqueueSetState:function(s,u,p){s=s._reactInternals;var S=Di(),x=ir(S);x.payload=u,p!=null&&(x.callback=p),u=ar(s,x,S),u!==null&&(ji(u,s,S),na(u,s,S))},enqueueReplaceState:function(s,u,p){s=s._reactInternals;var S=Di(),x=ir(S);x.tag=1,x.payload=u,p!=null&&(x.callback=p),u=ar(s,x,S),u!==null&&(ji(u,s,S),na(u,s,S))},enqueueForceUpdate:function(s,u){s=s._reactInternals;var p=Di(),S=ir(p);S.tag=2,u!=null&&(S.callback=u),u=ar(s,S,p),u!==null&&(ji(u,s,p),na(u,s,p))}},Fs=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Mh=Error(r(461)),qn=!1,Js={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},Qa=!1,pn=!1,Nc=!1,E0=typeof WeakSet=="function"?WeakSet:Set,Fn=null,le=null,Oe=!1,de=null,Ce=8192,Xe={getCacheForType:function(s){var u=$t(en),p=u.data.get(s);return p===void 0&&(p=s(),u.data.set(s,p)),p}},pi=0,Ea=1,Tr=2,Hl=3,ca=4;if(typeof Symbol=="function"&&Symbol.for){var nn=Symbol.for;pi=nn("selector.component"),Ea=nn("selector.has_pseudo_class"),Tr=nn("selector.role"),Hl=nn("selector.test_id"),ca=nn("selector.text")}var as=typeof WeakMap=="function"?WeakMap:Map,Te=0,Ze=null,ue=null,Re=0,Le=0,an=null,Xa=!1,Ar=!1,Dc=!1,fa=0,cn=0,Ri=0,fn=0,Fa=0,oi=0,Hi=0,Zs=null,mi=null,jc=!1,Ws=0,$s=1/0,vi=null,Or=null,Ve=0,Rr=null,tl=null,Pl=0,Ja=0,Il=null,Uc=null,Za=0,Bc=null;return Me.attemptContinuousHydration=function(s){if(s.tag===13){var u=cs(s,67108864);u!==null&&ji(u,s,67108864),Kr(s,67108864)}},Me.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var u=Di();u=P(u);var p=cs(s,u);p!==null&&ji(p,s,u),Kr(s,u)}},Me.attemptSynchronousHydration=function(s){switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var u=z(s.pendingLanes);if(u!==0){for(s.pendingLanes|=2,s.entangledLanes|=2;u;){var p=1<<31-Ci(u);s.entanglements[1]|=p,u&=~p}We(s),(Te&6)===0&&($s=Zi()+500,ut(0))}}break;case 13:u=cs(s,2),u!==null&&ji(u,s,2),Al(),Kr(s,2)}},Me.batchedUpdates=function(s,u){return s(u)},Me.createComponentSelector=function(s){return{$$typeof:pi,value:s}},Me.createContainer=function(s,u,p,S,x,H,tt,ot,bt,Nt){return ic(s,u,!1,null,p,S,H,tt,ot,bt,Nt,null)},Me.createHasPseudoClassSelector=function(s){return{$$typeof:Ea,value:s}},Me.createHydrationContainer=function(s,u,p,S,x,H,tt,ot,bt,Nt,Ut,Vt,Xt){return s=ic(p,S,!0,s,x,H,ot,bt,Nt,Ut,Vt,Xt),s.context=wl(null),p=s.current,S=Di(),S=P(S),x=ir(S),x.callback=u??null,ar(p,x,S),u=S,s.current.lanes=u,O(s,u),We(s),s},Me.createPortal=function(s,u,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dr,key:S==null?null:""+S,children:s,containerInfo:u,implementation:p}},Me.createRoleSelector=function(s){return{$$typeof:Tr,value:s}},Me.createTestNameSelector=function(s){return{$$typeof:Hl,value:s}},Me.createTextSelector=function(s){return{$$typeof:ca,value:s}},Me.defaultOnCaughtError=function(s){console.error(s)},Me.defaultOnRecoverableError=function(s){Fs(s)},Me.defaultOnUncaughtError=function(s){Fs(s)},Me.deferredUpdates=function(s){var u=re.T,p=Ha();try{return zn(32),re.T=null,s()}finally{zn(p),re.T=u}},Me.discreteUpdates=function(s,u,p,S,x){var H=re.T,tt=Ha();try{return zn(2),re.T=null,s(u,p,S,x)}finally{zn(tt),re.T=H,Te===0&&($s=Zi()+500)}},Me.findAllNodes=jo,Me.findBoundingRects=function(s,u){if(!Ia)throw Error(r(363));u=jo(s,u),s=[];for(var p=0;p<u.length;p++)s.push(Tn(u[p]));for(u=s.length-1;0<u;u--){p=s[u];for(var S=p.x,x=S+p.width,H=p.y,tt=H+p.height,ot=u-1;0<=ot;ot--)if(u!==ot){var bt=s[ot],Nt=bt.x,Ut=Nt+bt.width,Vt=bt.y,Xt=Vt+bt.height;if(S>=Nt&&H>=Vt&&x<=Ut&&tt<=Xt){s.splice(u,1);break}else if(S!==Nt||p.width!==bt.width||Xt<H||Vt>tt){if(!(H!==Vt||p.height!==bt.height||Ut<S||Nt>x)){Nt>S&&(bt.width+=Nt-S,bt.x=S),Ut<x&&(bt.width=x-Nt),s.splice(u,1);break}}else{Vt>H&&(bt.height+=Vt-H,bt.y=H),Xt<tt&&(bt.height=tt-Vt),s.splice(u,1);break}}}return s},Me.findHostInstance=xl,Me.findHostInstanceWithNoPortals=function(s){return s=d(s),s=s!==null?m(s):null,s===null?null:Ms(s.stateNode)},Me.findHostInstanceWithWarning=function(s){return xl(s)},Me.flushPassiveEffects=Es,Me.flushSyncFromReconciler=function(s){var u=Te;Te|=1;var p=re.T,S=Ha();try{if(zn(2),re.T=null,s)return s()}finally{zn(S),re.T=p,Te=u,(Te&6)===0&&ut(0)}},Me.flushSyncWork=Al,Me.focusWithin=function(s,u){if(!Ia)throw Error(r(363));for(s=ga(s),u=qr(s,u),u=Array.from(u),s=0;s<u.length;){var p=u[s++],S=p.tag;if(!Ds(p)){if((S===5||S===26||S===27)&&Vd(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},Me.getFindAllNodesFailureDescription=function(s,u){if(!Ia)throw Error(r(363));var p=0,S=[];s=[ga(s),0];for(var x=0;x<s.length;){var H=s[x++],tt=H.tag,ot=s[x++],bt=u[ot];if((tt!==5&&tt!==26&&tt!==27||!Ds(H))&&(Zu(H,bt)&&(S.push(Cl(bt)),ot++,ot>p&&(p=ot)),ot<u.length))for(H=H.child;H!==null;)s.push(H,ot),H=H.sibling}if(p<u.length){for(s=[];p<u.length;p++)s.push(Cl(u[p]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},Me.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 27:case 5:return Ms(s.child.stateNode);default:return s.child.stateNode}},Me.injectIntoDevTools=function(){var s={bundleType:0,version:xs,rendererPackageName:Id,currentDispatcherRef:re,reconcilerVersion:"19.1.0"};if(yr!==null&&(s.rendererConfig=yr),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)s=!0;else{try{Bl=u.inject(s),Bi=u}catch{}s=!!u.checkDCE}}return s},Me.isAlreadyRendering=function(){return(Te&6)!==0},Me.observeVisibleRects=function(s,u,p,S){if(!Ia)throw Error(r(363));s=jo(s,u);var x=Bg(s,p,S).disconnect;return{disconnect:function(){x()}}},Me.shouldError=function(){return null},Me.shouldSuspend=function(){return!1},Me.startHostTransition=function(s,u,p,S){if(s.tag!==5)throw Error(r(476));var x=yo(s).queue;vo(s,x,u,Sr,p===null?i:function(){var H=yo(s).next.queue;return ps(s,H,{},Di()),p(S)})},Me.updateContainer=function(s,u,p,S){var x=u.current,H=Di();return ac(x,H,s,u,p,S),H},Me.updateContainerSync=function(s,u,p,S){return ac(u.current,2,s,u,p,S),2},Me},o.exports.default=o.exports,Object.defineProperty(o.exports,"__esModule",{value:!0})})(xp)),xp.exports}var Z1;function x6(){return Z1||(Z1=1,wp.exports=w6()),wp.exports}var M6=x6();const N6=cf(M6);var Dp={exports:{}},nl={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W1;function D6(){return W1||(W1=1,nl.ConcurrentRoot=1,nl.ContinuousEventPriority=8,nl.DefaultEventPriority=32,nl.DiscreteEventPriority=2,nl.IdleEventPriority=268435456,nl.LegacyRoot=0,nl.NoEventPriority=0),nl}var $1;function j6(){return $1||($1=1,Dp.exports=D6()),Dp.exports}var Og=j6();const ty={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let ey=!1,ny=!1;const dg=".react-konva-event",U6=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,B6=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,z6={};function Rg(o,t,n=z6){if(!ey&&"zIndex"in t&&(console.warn(B6),ey=!0),!ny&&t.draggable){var i=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;i&&!r&&(console.warn(U6),ny=!0)}for(var l in n)if(!ty[l]){var f=l.slice(0,2)==="on",d=n[l]!==t[l];if(f&&d){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),o.off(g,n[l])}var m=!t.hasOwnProperty(l);m&&o.setAttr(l,void 0)}var _=t._useStrictMode,C={},E=!1;const R={};for(var l in t)if(!ty[l]){var f=l.slice(0,2)==="on",v=n[l]!==t[l];if(f&&v){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),t[l]&&(R[g]=t[l])}!f&&(t[l]!==n[l]||_&&t[l]!==o.getAttr(l))&&(E=!0,C[l]=t[l])}E&&(o.setAttrs(C),oo(o));for(var g in R)o.off(g+dg),o.on(g+dg,R[g])}function oo(o){if(!kt.autoDrawEnabled){var t=o.getLayer()||o.getStage();t&&t.batchDraw()}}var jp={exports:{}},Up={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iy;function L6(){return iy||(iy=1,(function(o){function t(j,I){var X=j.length;j.push(I);t:for(;0<X;){var Z=X-1>>>1,at=j[Z];if(0<r(at,I))j[Z]=I,j[X]=at,X=Z;else break t}}function n(j){return j.length===0?null:j[0]}function i(j){if(j.length===0)return null;var I=j[0],X=j.pop();if(X!==I){j[0]=X;t:for(var Z=0,at=j.length,J=at>>>1;Z<J;){var rt=2*(Z+1)-1,it=j[rt],q=rt+1,F=j[q];if(0>r(it,X))q<at&&0>r(F,it)?(j[Z]=F,j[q]=X,Z=q):(j[Z]=it,j[rt]=X,Z=rt);else if(q<at&&0>r(F,X))j[Z]=F,j[q]=X,Z=q;else break t}}return I}function r(j,I){var X=j.sortIndex-I.sortIndex;return X!==0?X:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,z=!1,G=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function L(j){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=j)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function w(j){if(D=!1,L(j),!v)if(n(g)!==null)v=!0,A||(A=!0,K());else{var I=n(m);I!==null&&V(w,I.startTime-j)}}var A=!1,O=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,A){var j=o.unstable_now();B=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(O),O=-1),R=!0;var X=E;try{e:{for(L(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var Z=C.callback;if(typeof Z=="function"){C.callback=null,E=C.priorityLevel;var at=Z(C.expirationTime<=j);if(j=o.unstable_now(),typeof at=="function"){C.callback=at,L(j),I=!0;break e}C===n(g)&&i(g),L(j)}else i(g);C=n(g)}if(C!==null)I=!0;else{var J=n(m);J!==null&&V(w,J.startTime-j),I=!1}}break t}finally{C=null,E=X,R=!1}I=void 0}}finally{I?K():A=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Q=Y.port2;Y.port1.onmessage=P,K=function(){Q.postMessage(null)}}else K=function(){G(P,0)};function V(j,I){O=G(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var X=E;E=I;try{return j()}finally{E=X}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=E;E=j;try{return I()}finally{E=X}},o.unstable_scheduleCallback=function(j,I,X){var Z=o.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Z+X:Z):X=Z,j){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=X+at,j={id:_++,callback:I,priorityLevel:j,startTime:X,expirationTime:at,sortIndex:-1},X>Z?(j.sortIndex=X,t(m,j),n(g)===null&&j===n(m)&&(D?(N(O),O=-1):D=!0,V(w,X-Z))):(j.sortIndex=at,t(g,j),v||R||(v=!0,A||(A=!0,K()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var X=E;E=I;try{return j.apply(this,arguments)}finally{E=X}}}})(Up)),Up}var ay;function G6(){return ay||(ay=1,jp.exports=L6()),jp.exports}var Bp=G6();const iS={},H6={};sf.Node.prototype._applyProps=Rg;let aS=Og.DefaultEventPriority;function P6(o,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}o.add(t),oo(o)}function I6(o,t,n){let i=sf[o];i||(console.error(`Konva has no node with the type ${o}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${o}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),i=sf.Group);const r={},l={};for(var f in t)if(f!=="ref"){var d=f.slice(0,2)==="on";d?l[f]=t[f]:r[f]=t[f]}const g=new i(r);return Rg(g,l),g}function k6(o,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${o}"`)}function q6(o,t,n){return!1}function V6(o){return o}function Y6(){return null}function K6(){return null}function Q6(o,t,n,i){return H6}function X6(){}function F6(o){}function J6(o,t){return!1}function Z6(){return iS}function W6(){return iS}const $6=setTimeout,t8=clearTimeout,e8=!0,n8=o=>{o()},i8=-1;function a8(o,t){return!1}const r8=!1,s8=!1,l8=!0,o8=!1,u8=!1;function c8(o,t){t.parent===o?t.moveToTop():o.add(t),oo(o)}function f8(o,t){t.parent===o?t.moveToTop():o.add(t),oo(o)}function rS(o,t,n){t._remove(),o.add(t),t.setZIndex(n.getZIndex()),oo(o)}function h8(o,t,n){rS(o,t,n)}function d8(o,t){t.destroy(),t.off(dg),oo(o)}function g8(o,t){t.destroy(),t.off(dg),oo(o)}function p8(o,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function m8(o,t,n){}function v8(o,t,n,i){Rg(o,i,n)}function y8(o){o.hide(),oo(o)}function S8(o){}function b8(o,t){(t.visible==null||t.visible)&&o.show()}function _8(o,t){}function E8(o){}function C8(){}function T8(){return Og.DefaultEventPriority}function A8(){}function O8(){return null}function R8(o){aS=o}function w8(){return aS}function x8(){return Og.DiscreteEventPriority}function M8(){return!1}function N8(){}function D8(){return!1}function j8(){return!0}function U8(){}function B8(){}function z8(){return null}const L8=null;function G8(){}const H8=Object.freeze(Object.defineProperty({__proto__:null,NotPendingTransition:L8,appendChild:c8,appendChildToContainer:f8,appendInitialChild:P6,cancelTimeout:t8,clearContainer:E8,commitMount:m8,commitTextUpdate:p8,commitUpdate:v8,createInstance:I6,createTextInstance:k6,detachDeletedInstance:C8,finalizeInitialChildren:q6,getChildHostContext:W6,getCurrentEventPriority:T8,getCurrentUpdatePriority:w8,getInstanceFromScope:O8,getPublicInstance:V6,getRootHostContext:Z6,hideInstance:y8,hideTextInstance:S8,idlePriority:Bp.unstable_IdlePriority,insertBefore:rS,insertInContainerBefore:h8,isPrimaryRenderer:r8,maySuspendCommit:D8,noTimeout:i8,now:Bp.unstable_now,preloadInstance:j8,prepareForCommit:Y6,preparePortalMount:K6,prepareScopeUpdate:A8,prepareUpdate:Q6,removeChild:d8,removeChildFromContainer:g8,requestPostPaintCallback:N8,resetAfterCommit:X6,resetFormInstance:G8,resetTextContent:F6,resolveUpdatePriority:x8,run:Bp.unstable_runWithPriority,scheduleMicrotask:n8,scheduleTimeout:$6,setCurrentUpdatePriority:R8,shouldAttemptEagerTransition:M8,shouldDeprioritizeSubtree:J6,shouldSetTextContent:a8,startSuspendingCommit:U8,supportsHydration:u8,supportsMicrotasks:e8,supportsMutation:l8,supportsPersistence:o8,suspendInstance:B8,unhideInstance:b8,unhideTextInstance:_8,waitForCommitToBeReady:z8,warnsIfNotActing:s8},Symbol.toStringTag,{value:"Module"}));function sS(o,t,n){if(!o)return;if(n(o)===!0)return o;let i=o.child;for(;i;){const r=sS(i,t,n);if(r)return r;i=i.sibling}}function lS(o){try{return Object.defineProperties(o,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return o}}const tv=lS(mt.createContext(null));class oS extends mt.Component{render(){return mt.createElement(tv.Provider,{value:this._reactInternals},this.props.children)}}function P8(){const o=mt.useContext(tv);if(o===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=mt.useId();return mt.useMemo(()=>{for(const n of[o,o==null?void 0:o.alternate]){if(!n)continue;const i=sS(n,!1,r=>{let l=r.memoizedState;for(;l;){if(l.memoizedState===t)return!0;l=l.next}});if(i)return i}},[o,t])}const I8=Symbol.for("react.context"),k8=o=>o!==null&&typeof o=="object"&&"$$typeof"in o&&o.$$typeof===I8;function q8(){const o=P8(),[t]=mt.useState(()=>new Map);t.clear();let n=o;for(;n;){const i=n.type;k8(i)&&i!==tv&&!t.has(i)&&t.set(i,mt.use(lS(i))),n=n.return}return t}function V8(){const o=q8();return mt.useMemo(()=>Array.from(o.keys()).reduce((t,n)=>i=>mt.createElement(t,null,mt.createElement(n.Provider,{...i,value:o.get(n)})),t=>mt.createElement(oS,{...t})),[o])}if(Hn.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function Y8(o){const t=Hn.useRef({});return Hn.useLayoutEffect(()=>{t.current=o}),Hn.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const K8=()=>{const o=Hn.useRef(0);return Hn.useMemo(()=>{o.current++},[]),o.current>1},Q8=o=>{const t=Hn.useRef(null),n=Hn.useRef(null),i=Hn.useRef(null),r=Y8(o),l=V8(),f=Hn.useRef(!1),d=m=>{const{forwardedRef:_}=o;_&&(typeof _=="function"?_(m):_.current=m)},g=K8();return Hn.useLayoutEffect(()=>f.current&&g?()=>{f.current=!1,d(null),$c.updateContainer(null,i.current,null),n.current.destroy()}:(f.current=!0,n.current=new sf.Stage({width:o.width,height:o.height,container:t.current}),d(n.current),i.current=$c.createContainer(n.current,Og.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),$c.updateContainer(Hn.createElement(l,{},o.children),i.current,null,()=>{}),()=>{g||(d(null),$c.updateContainer(null,i.current,null),n.current.destroy())}),[]),Hn.useLayoutEffect(()=>{d(n.current),Rg(n.current,o,r),$c.updateContainer(Hn.createElement(l,{},o.children),i.current,null)}),Hn.createElement("div",{ref:t,id:o.id,accessKey:o.accessKey,className:o.className,role:o.role,style:o.style,tabIndex:o.tabIndex,title:o.title})},sl="Layer",lf="Line",ev="Image",$c=N6(H8);$c.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Hn.version,rendererPackageName:"react-konva"});const nv=Hn.forwardRef((o,t)=>Hn.createElement(oS,{},Hn.createElement(Q8,{...o,forwardedRef:t})));var zp={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var ry;function uS(){return ry||(ry=1,(function(o,t){(function(i,r){o.exports=r()})(window,function(){return(function(n){var i={};function r(l){if(i[l])return i[l].exports;var f=i[l]={i:l,l:!1,exports:{}};return n[l].call(f.exports,f,f.exports,r),f.l=!0,f.exports}return r.m=n,r.c=i,r.d=function(l,f,d){r.o(l,f)||Object.defineProperty(l,f,{enumerable:!0,get:d})},r.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},r.t=function(l,f){if(f&1&&(l=r(l)),f&8||f&4&&typeof l=="object"&&l&&l.__esModule)return l;var d=Object.create(null);if(r.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:l}),f&2&&typeof l!="string")for(var g in l)r.d(d,g,(function(m){return l[m]}).bind(null,g));return d},r.n=function(l){var f=l&&l.__esModule?function(){return l.default}:function(){return l};return r.d(f,"a",f),f},r.o=function(l,f){return Object.prototype.hasOwnProperty.call(l,f)},r.p="",r(r.s=42)})([(function(n,i,r){r.r(i),r.d(i,"__extends",function(){return f}),r.d(i,"__assign",function(){return d}),r.d(i,"__rest",function(){return g}),r.d(i,"__decorate",function(){return m}),r.d(i,"__param",function(){return _}),r.d(i,"__metadata",function(){return C}),r.d(i,"__awaiter",function(){return E}),r.d(i,"__generator",function(){return R}),r.d(i,"__createBinding",function(){return v}),r.d(i,"__exportStar",function(){return D}),r.d(i,"__values",function(){return z}),r.d(i,"__read",function(){return G}),r.d(i,"__spread",function(){return N}),r.d(i,"__spreadArrays",function(){return M}),r.d(i,"__spreadArray",function(){return L}),r.d(i,"__await",function(){return w}),r.d(i,"__asyncGenerator",function(){return A}),r.d(i,"__asyncDelegator",function(){return O}),r.d(i,"__asyncValues",function(){return y}),r.d(i,"__makeTemplateObject",function(){return B}),r.d(i,"__importStar",function(){return P}),r.d(i,"__importDefault",function(){return K}),r.d(i,"__classPrivateFieldGet",function(){return Y}),r.d(i,"__classPrivateFieldSet",function(){return Q});/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */var l=function(V,j){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,X){I.__proto__=X}||function(I,X){for(var Z in X)Object.prototype.hasOwnProperty.call(X,Z)&&(I[Z]=X[Z])},l(V,j)};function f(V,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");l(V,j);function I(){this.constructor=V}V.prototype=j===null?Object.create(j):(I.prototype=j.prototype,new I)}var d=function(){return d=Object.assign||function(j){for(var I,X=1,Z=arguments.length;X<Z;X++){I=arguments[X];for(var at in I)Object.prototype.hasOwnProperty.call(I,at)&&(j[at]=I[at])}return j},d.apply(this,arguments)};function g(V,j){var I={};for(var X in V)Object.prototype.hasOwnProperty.call(V,X)&&j.indexOf(X)<0&&(I[X]=V[X]);if(V!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Z=0,X=Object.getOwnPropertySymbols(V);Z<X.length;Z++)j.indexOf(X[Z])<0&&Object.prototype.propertyIsEnumerable.call(V,X[Z])&&(I[X[Z]]=V[X[Z]]);return I}function m(V,j,I,X){var Z=arguments.length,at=Z<3?j:X===null?X=Object.getOwnPropertyDescriptor(j,I):X,J;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")at=Reflect.decorate(V,j,I,X);else for(var rt=V.length-1;rt>=0;rt--)(J=V[rt])&&(at=(Z<3?J(at):Z>3?J(j,I,at):J(j,I))||at);return Z>3&&at&&Object.defineProperty(j,I,at),at}function _(V,j){return function(I,X){j(I,X,V)}}function C(V,j){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(V,j)}function E(V,j,I,X){function Z(at){return at instanceof I?at:new I(function(J){J(at)})}return new(I||(I=Promise))(function(at,J){function rt(F){try{q(X.next(F))}catch($){J($)}}function it(F){try{q(X.throw(F))}catch($){J($)}}function q(F){F.done?at(F.value):Z(F.value).then(rt,it)}q((X=X.apply(V,j||[])).next())})}function R(V,j){var I={label:0,sent:function(){if(at[0]&1)throw at[1];return at[1]},trys:[],ops:[]},X,Z,at,J;return J={next:rt(0),throw:rt(1),return:rt(2)},typeof Symbol=="function"&&(J[Symbol.iterator]=function(){return this}),J;function rt(q){return function(F){return it([q,F])}}function it(q){if(X)throw new TypeError("Generator is already executing.");for(;I;)try{if(X=1,Z&&(at=q[0]&2?Z.return:q[0]?Z.throw||((at=Z.return)&&at.call(Z),0):Z.next)&&!(at=at.call(Z,q[1])).done)return at;switch(Z=0,at&&(q=[q[0]&2,at.value]),q[0]){case 0:case 1:at=q;break;case 4:return I.label++,{value:q[1],done:!1};case 5:I.label++,Z=q[1],q=[0];continue;case 7:q=I.ops.pop(),I.trys.pop();continue;default:if(at=I.trys,!(at=at.length>0&&at[at.length-1])&&(q[0]===6||q[0]===2)){I=0;continue}if(q[0]===3&&(!at||q[1]>at[0]&&q[1]<at[3])){I.label=q[1];break}if(q[0]===6&&I.label<at[1]){I.label=at[1],at=q;break}if(at&&I.label<at[2]){I.label=at[2],I.ops.push(q);break}at[2]&&I.ops.pop(),I.trys.pop();continue}q=j.call(V,I)}catch(F){q=[6,F],Z=0}finally{X=at=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}var v=Object.create?(function(V,j,I,X){X===void 0&&(X=I),Object.defineProperty(V,X,{enumerable:!0,get:function(){return j[I]}})}):(function(V,j,I,X){X===void 0&&(X=I),V[X]=j[I]});function D(V,j){for(var I in V)I!=="default"&&!Object.prototype.hasOwnProperty.call(j,I)&&v(j,V,I)}function z(V){var j=typeof Symbol=="function"&&Symbol.iterator,I=j&&V[j],X=0;if(I)return I.call(V);if(V&&typeof V.length=="number")return{next:function(){return V&&X>=V.length&&(V=void 0),{value:V&&V[X++],done:!V}}};throw new TypeError(j?"Object is not iterable.":"Symbol.iterator is not defined.")}function G(V,j){var I=typeof Symbol=="function"&&V[Symbol.iterator];if(!I)return V;var X=I.call(V),Z,at=[],J;try{for(;(j===void 0||j-- >0)&&!(Z=X.next()).done;)at.push(Z.value)}catch(rt){J={error:rt}}finally{try{Z&&!Z.done&&(I=X.return)&&I.call(X)}finally{if(J)throw J.error}}return at}function N(){for(var V=[],j=0;j<arguments.length;j++)V=V.concat(G(arguments[j]));return V}function M(){for(var V=0,j=0,I=arguments.length;j<I;j++)V+=arguments[j].length;for(var X=Array(V),Z=0,j=0;j<I;j++)for(var at=arguments[j],J=0,rt=at.length;J<rt;J++,Z++)X[Z]=at[J];return X}function L(V,j,I){if(I||arguments.length===2)for(var X=0,Z=j.length,at;X<Z;X++)(at||!(X in j))&&(at||(at=Array.prototype.slice.call(j,0,X)),at[X]=j[X]);return V.concat(at||Array.prototype.slice.call(j))}function w(V){return this instanceof w?(this.v=V,this):new w(V)}function A(V,j,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var X=I.apply(V,j||[]),Z,at=[];return Z={},J("next"),J("throw"),J("return"),Z[Symbol.asyncIterator]=function(){return this},Z;function J(nt){X[nt]&&(Z[nt]=function(ht){return new Promise(function(Tt,jt){at.push([nt,ht,Tt,jt])>1||rt(nt,ht)})})}function rt(nt,ht){try{it(X[nt](ht))}catch(Tt){$(at[0][3],Tt)}}function it(nt){nt.value instanceof w?Promise.resolve(nt.value.v).then(q,F):$(at[0][2],nt)}function q(nt){rt("next",nt)}function F(nt){rt("throw",nt)}function $(nt,ht){nt(ht),at.shift(),at.length&&rt(at[0][0],at[0][1])}}function O(V){var j,I;return j={},X("next"),X("throw",function(Z){throw Z}),X("return"),j[Symbol.iterator]=function(){return this},j;function X(Z,at){j[Z]=V[Z]?function(J){return(I=!I)?{value:w(V[Z](J)),done:Z==="return"}:at?at(J):J}:at}}function y(V){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var j=V[Symbol.asyncIterator],I;return j?j.call(V):(V=typeof z=="function"?z(V):V[Symbol.iterator](),I={},X("next"),X("throw"),X("return"),I[Symbol.asyncIterator]=function(){return this},I);function X(at){I[at]=V[at]&&function(J){return new Promise(function(rt,it){J=V[at](J),Z(rt,it,J.done,J.value)})}}function Z(at,J,rt,it){Promise.resolve(it).then(function(q){at({value:q,done:rt})},J)}}function B(V,j){return Object.defineProperty?Object.defineProperty(V,"raw",{value:j}):V.raw=j,V}var U=Object.create?(function(V,j){Object.defineProperty(V,"default",{enumerable:!0,value:j})}):function(V,j){V.default=j};function P(V){if(V&&V.__esModule)return V;var j={};if(V!=null)for(var I in V)I!=="default"&&Object.prototype.hasOwnProperty.call(V,I)&&v(j,V,I);return U(j,V),j}function K(V){return V&&V.__esModule?V:{default:V}}function Y(V,j,I,X){if(I==="a"&&!X)throw new TypeError("Private accessor was defined without a getter");if(typeof j=="function"?V!==j||!X:!j.has(V))throw new TypeError("Cannot read private member from an object whose class did not declare it");return I==="m"?X:I==="a"?X.call(V):X?X.value:j.get(V)}function Q(V,j,I,X,Z){if(X==="m")throw new TypeError("Private method is not writable");if(X==="a"&&!Z)throw new TypeError("Private accessor was defined without a setter");if(typeof j=="function"?V!==j||!Z:!j.has(V))throw new TypeError("Cannot write private member to an object whose class did not declare it");return X==="a"?Z.call(V,I):Z?Z.value=I:j.set(V,I),I}}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0}),i.allToUpperCase=i.allToLowerCase=i.encodeBody=i.decodeBody=i.Format=i.promisify=i.trim=i.arrChooseN=i.randomHexString=i.randomString=i.cheapRandStr=i.dataSizeBytes=i.inspectBody=i.inspectError=i.isErrorInfoOrPartialErrorInfo=i.now=i.parseQueryString=i.toQueryString=i.arrPopRandomElement=i.defaultPostHeaders=i.defaultGetHeaders=i.allSame=i.arrEvery=i.arrFilter=i.arrMap=i.safeArrForEach=i.arrForEach=i.forInOwnNonNullProperties=i.valuesArray=i.keysArray=i.arrWithoutValue=i.arrDeleteValue=i.arrIn=i.arrIndexOf=i.arrSubtract=i.arrIntersectOb=i.arrIntersect=i.intersect=i.containsValue=i.inherits=i.prototypicalClone=i.shallowClone=i.isEmptyArg=i.isOnlyPropIn=i.isEmpty=i.isObject=i.ensureArray=i.isArray=i.copy=i.mixin=void 0,i.arrEquals=i.toBase64=i.matchDerivedChannel=i.shallowEquals=i.getGlobalObject=i.getRetryTime=i.getJitterCoefficient=i.getBackoffCoefficient=void 0;var f=r(0),d=f.__importDefault(r(3)),g=f.__importStar(r(8)),m=f.__importDefault(r(4)),_=r(11),C=r(31);function E(ut){return Math.floor(Math.random()*ut.length)}function R(ut){for(var Ot=[],Mt=1;Mt<arguments.length;Mt++)Ot[Mt-1]=arguments[Mt];for(var Ft=0;Ft<Ot.length;Ft++){var Ee=Ot[Ft];if(!Ee)break;var dn=Object.prototype.hasOwnProperty;for(var An in Ee)(!dn||dn.call(Ee,An))&&(ut[An]=Ee[An])}return ut}i.mixin=R;function v(ut){return R({},ut)}i.copy=v,i.isArray=Array.isArray||function(ut){return Object.prototype.toString.call(ut)=="[object Array]"};function D(ut){return M(ut)?[]:(0,i.isArray)(ut)?ut:[ut]}i.ensureArray=D;function z(ut){return Object.prototype.toString.call(ut)=="[object Object]"}i.isObject=z;function G(ut){for(var Ot in ut)return!1;return!0}i.isEmpty=G;function N(ut,Ot){for(var Mt in ut)if(Mt!==Ot)return!1;return!0}i.isOnlyPropIn=N;function M(ut){return ut==null}i.isEmptyArg=M;function L(ut){var Ot=new Object;for(var Mt in ut)Ot[Mt]=ut[Mt];return Ot}i.shallowClone=L;function w(ut,Ot){var Mt=(function(){function Ee(){}return Ee})();Mt.prototype=ut;var Ft=new Mt;return Ot&&R(Ft,Ot),Ft}i.prototypicalClone=w;var A=function(ut,Ot){if(d.default.Config.inherits){d.default.Config.inherits(ut,Ot);return}ut.super_=Ot,ut.prototype=w(Ot.prototype,{constructor:ut})};i.inherits=A;function O(ut,Ot){for(var Mt in ut)if(ut[Mt]==Ot)return!0;return!1}i.containsValue=O;function y(ut,Ot){return(0,i.isArray)(Ot)?B(ut,Ot):U(ut,Ot)}i.intersect=y;function B(ut,Ot){for(var Mt=[],Ft=0;Ft<ut.length;Ft++){var Ee=ut[Ft];(0,i.arrIndexOf)(Ot,Ee)!=-1&&Mt.push(Ee)}return Mt}i.arrIntersect=B;function U(ut,Ot){for(var Mt=[],Ft=0;Ft<ut.length;Ft++){var Ee=ut[Ft];Ee in Ot&&Mt.push(Ee)}return Mt}i.arrIntersectOb=U;function P(ut,Ot){for(var Mt=[],Ft=0;Ft<ut.length;Ft++){var Ee=ut[Ft];(0,i.arrIndexOf)(Ot,Ee)==-1&&Mt.push(Ee)}return Mt}i.arrSubtract=P,i.arrIndexOf=Array.prototype.indexOf?function(ut,Ot,Mt){return ut.indexOf(Ot,Mt)}:function(ut,Ot,Mt){Mt=Mt||0;for(var Ft=ut.length;Mt<Ft;Mt++)if(ut[Mt]===Ot)return Mt;return-1};function K(ut,Ot){return(0,i.arrIndexOf)(ut,Ot)!==-1}i.arrIn=K;function Y(ut,Ot){var Mt=(0,i.arrIndexOf)(ut,Ot),Ft=Mt!=-1;return Ft&&ut.splice(Mt,1),Ft}i.arrDeleteValue=Y;function Q(ut,Ot){var Mt=ut.slice();return Y(Mt,Ot),Mt}i.arrWithoutValue=Q;function V(ut,Ot){var Mt=[];for(var Ft in ut)Ot&&!Object.prototype.hasOwnProperty.call(ut,Ft)||Mt.push(Ft);return Mt}i.keysArray=V;function j(ut,Ot){var Mt=[];for(var Ft in ut)Ot&&!Object.prototype.hasOwnProperty.call(ut,Ft)||Mt.push(ut[Ft]);return Mt}i.valuesArray=j;function I(ut,Ot){for(var Mt in ut)Object.prototype.hasOwnProperty.call(ut,Mt)&&ut[Mt]&&Ot(Mt)}i.forInOwnNonNullProperties=I,i.arrForEach=Array.prototype.forEach?function(ut,Ot){ut.forEach(Ot)}:function(ut,Ot){for(var Mt=ut.length,Ft=0;Ft<Mt;Ft++)Ot(ut[Ft],Ft,ut)};function X(ut,Ot){return(0,i.arrForEach)(ut.slice(),Ot)}i.safeArrForEach=X,i.arrMap=Array.prototype.map?function(ut,Ot){return ut.map(Ot)}:function(ut,Ot){for(var Mt=[],Ft=ut.length,Ee=0;Ee<Ft;Ee++)Mt.push(Ot(ut[Ee],Ee,ut));return Mt},i.arrFilter=Array.prototype.filter?function(ut,Ot){return ut.filter(Ot)}:function(ut,Ot){for(var Mt=[],Ft=ut.length,Ee=0;Ee<Ft;Ee++)Ot(ut[Ee])&&Mt.push(ut[Ee]);return Mt},i.arrEvery=Array.prototype.every?function(ut,Ot){return ut.every(Ot)}:function(ut,Ot){for(var Mt=ut.length,Ft=0;Ft<Mt;Ft++)if(!Ot(ut[Ft],Ft,ut))return!1;return!0};function Z(ut,Ot){if(ut.length===0)return!0;var Mt=ut[0][Ot];return(0,i.arrEvery)(ut,function(Ft){return Ft[Ot]===Mt})}i.allSame=Z;var at={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function J(ut,Ot){var Mt=at[Ot||pe.json];return{accept:Mt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ut)}}i.defaultGetHeaders=J;function rt(ut,Ot){var Mt,Ft=Mt=at[Ot||pe.json];return{accept:Ft,"content-type":Mt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ut)}}i.defaultPostHeaders=rt;function it(ut){return ut.splice(E(ut),1)[0]}i.arrPopRandomElement=it;function q(ut){var Ot=[];if(ut)for(var Mt in ut)Ot.push(encodeURIComponent(Mt)+"="+encodeURIComponent(ut[Mt]));return Ot.length?"?"+Ot.join("&"):""}i.toQueryString=q;function F(ut){for(var Ot,Mt=/([^?&=]+)=?([^&]*)/g,Ft={};Ot=Mt.exec(ut);)Ft[decodeURIComponent(Ot[1])]=decodeURIComponent(Ot[2]);return Ft}i.parseQueryString=F,i.now=Date.now||function(){return new Date().getTime()};function $(ut){return typeof ut=="object"&&ut!==null&&(ut.constructor.name=="ErrorInfo"||ut.constructor.name=="PartialErrorInfo")}i.isErrorInfoOrPartialErrorInfo=$;function nt(ut){var Ot,Mt;return ut instanceof Error||((Ot=ut==null?void 0:ut.constructor)===null||Ot===void 0?void 0:Ot.name)==="ErrorInfo"||((Mt=ut==null?void 0:ut.constructor)===null||Mt===void 0?void 0:Mt.name)==="PartialErrorInfo"?ut.toString():d.default.Config.inspect(ut)}i.inspectError=nt;function ht(ut){return d.default.BufferUtils.isBuffer(ut)?ut.toString():typeof ut=="string"?ut:d.default.Config.inspect(ut)}i.inspectBody=ht;function Tt(ut){if(d.default.BufferUtils.isBuffer(ut))return d.default.BufferUtils.byteLength(ut);if(typeof ut=="string")return d.default.Config.stringByteSize(ut);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof ut)}i.dataSizeBytes=Tt;function jt(){return String(Math.random()).substr(2)}i.cheapRandStr=jt;var Kt=function(ut){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var Ot=new Uint8Array(ut);return d.default.Config.getRandomValues(Ot),d.default.BufferUtils.base64Encode(Ot)}for(var Mt=d.default.BufferUtils.base64CharSet,Ft=Math.round(ut*4/3),Ee="",dn=0;dn<Ft;dn++)Ee+=Mt[E(Mt)];return Ee};i.randomString=Kt;var Wt=function(ut){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var Ot=new Uint8Array(ut);return d.default.Config.getRandomValues(Ot),d.default.BufferUtils.hexEncode(Ot)}for(var Mt=d.default.BufferUtils.hexCharSet,Ft=ut*2,Ee="",dn=0;dn<Ft;dn++)Ee+=Mt[E(Mt)];return Ee};i.randomHexString=Wt;function ge(ut,Ot){for(var Mt=Math.min(Ot,ut.length),Ft=ut.slice(),Ee=[],dn=0;dn<Mt;dn++)Ee.push(it(Ft));return Ee}i.arrChooseN=ge,i.trim=String.prototype.trim?function(ut){return ut.trim()}:function(ut){return ut.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function Pt(ut,Ot,Mt){return new Promise(function(Ft,Ee){ut[Ot].apply(ut,f.__spreadArray(f.__spreadArray([],Mt,!1),[function(dn,An){dn?Ee(dn):Ft(An)}],!1))})}i.promisify=Pt;var pe;(function(ut){ut.msgpack="msgpack",ut.json="json"})(pe=i.Format||(i.Format={}));function xe(ut,Ot){return Ot=="msgpack"?d.default.Config.msgpack.decode(ut):JSON.parse(String(ut))}i.decodeBody=xe;function zt(ut,Ot){return Ot=="msgpack"?d.default.Config.msgpack.encode(ut,!0):JSON.stringify(ut)}i.encodeBody=zt;function ft(ut){return ut.map(function(Ot){return Ot&&Ot.toLowerCase()})}i.allToLowerCase=ft;function xt(ut){return ut.map(function(Ot){return Ot&&Ot.toUpperCase()})}i.allToUpperCase=xt;function Qt(ut){return Math.min((ut+2)/3,2)}i.getBackoffCoefficient=Qt;function Jt(){return 1-Math.random()*.2}i.getJitterCoefficient=Jt;function $t(ut,Ot){return ut*Qt(Ot)*Jt()}i.getRetryTime=$t;function ve(){return l||(typeof window<"u"?window:self)}i.getGlobalObject=ve;function ae(ut,Ot){return Object.keys(ut).every(function(Mt){return ut[Mt]===Ot[Mt]})&&Object.keys(Ot).every(function(Mt){return Ot[Mt]===ut[Mt]})}i.shallowEquals=ae;function ln(ut){var Ot=/^(\[([^?]*)(?:(.*))\])?(.+)$/,Mt=ut.match(Ot);if(!Mt||!Mt.length||Mt.length<5)throw new m.default("regex match failed",400,40010);if(Mt[2])throw new m.default("cannot use a derived option with a ".concat(Mt[2]," channel"),400,40010);return{qualifierParam:Mt[3]||"",channelName:Mt[4]}}i.matchDerivedChannel=ln;function Sn(ut){return d.default.Config.createHmac?Buffer.from(ut,"ascii").toString("base64"):(0,_.stringify)((0,C.parse)(ut))}i.toBase64=Sn;function We(ut,Ot){return ut.length===Ot.length&&(0,i.arrEvery)(ut,function(Mt,Ft){return Mt===Ot[Ft]})}i.arrEquals=We}).call(this,r(13))}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),d=f.__importDefault(r(3)),g=l||(typeof window<"u"?window:self),m;(function(v){v[v.None=0]="None",v[v.Error=1]="Error",v[v.Major=2]="Major",v[v.Minor=3]="Minor",v[v.Micro=4]="Micro"})(m||(m={}));function _(v,D){return"".concat(v).padStart(D?3:2,"0")}function C(v){return d.default.Config.logTimestamps?function(D){var z=new Date;v(_(z.getHours())+":"+_(z.getMinutes())+":"+_(z.getSeconds())+"."+_(z.getMilliseconds(),1)+" "+D)}:v}var E=function(){var v,D,z,G;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((D=(v=g==null?void 0:g.console)===null||v===void 0?void 0:v.log)===null||D===void 0?void 0:D.apply)=="function"?(z=function(){for(var N=[],M=0;M<arguments.length;M++)N[M]=arguments[M];console.log.apply(console,N)},G=console.warn?function(){for(var N=[],M=0;M<arguments.length;M++)N[M]=arguments[M];console.warn.apply(console,N)}:z):g!=null&&g.console.log?z=G=function(){Function.prototype.apply.call(console.log,console,arguments)}:z=G=function(){},[z,G].map(C)},R=(function(){function v(){v.logLevel=v.LOG_DEFAULT}return v.initLogHandlers=function(){var D=E(),z=D[0],G=D[1];this.logHandler=z,this.logErrorHandler=G},v.renamedClientOption=function(D,z){v.deprecationWarning("The `".concat(D,"` client option has been renamed to `").concat(z,"`. Please update your code to use `").concat(z,"` instead. `").concat(D,"` will be removed in a future version."))},v.renamedMethod=function(D,z,G){v.deprecationWarning("`".concat(D,"`’s `").concat(z,"` method has been renamed to `").concat(G,"`. Please update your code to use `").concat(G,"` instead. `").concat(z,"` will be removed in a future version."))},v.deprecationWarning=function(D){v.shouldLog(m.Error)&&v.logErrorHandler("Ably: Deprecation warning - ".concat(D))},v.logLevel=m.Error,v.LOG_NONE=m.None,v.LOG_ERROR=m.Error,v.LOG_MAJOR=m.Major,v.LOG_MINOR=m.Minor,v.LOG_MICRO=m.Micro,v.LOG_DEFAULT=m.Error,v.LOG_DEBUG=m.Micro,v.logAction=function(D,z,G){v.shouldLog(D)&&(D===m.Error?v.logErrorHandler:v.logHandler)("Ably: "+z+": "+G)},v.deprecated=function(D,z){v.deprecationWarning("".concat(D," is deprecated and will be removed in a future version. ").concat(z))},v.shouldLog=function(D){return D<=v.logLevel},v.setLog=function(D,z){D!==void 0&&(v.logLevel=D),z!==void 0&&(v.logHandler=v.logErrorHandler=z)},v})();i.default=R}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function f(){}return f})();i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.PartialErrorInfo=void 0;var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1));function g(C){var E="["+C.constructor.name;return C.message&&(E+=": "+C.message),C.statusCode&&(E+="; statusCode="+C.statusCode),C.code&&(E+="; code="+C.code),C.cause&&(E+="; cause="+d.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(E+="; see "+C.href+" "),E+="]",E}var m=(function(C){l.__extends(E,C);function E(R,v,D,z){var G=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(G,E.prototype),G.code=v,G.statusCode=D,G.cause=z,G}return E.prototype.toString=function(){return g(this)},E.fromValues=function(R){var v=R,D=v.message,z=v.code,G=v.statusCode;if(typeof D!="string"||typeof z!="number"||typeof G!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+f.default.Config.inspect(R));var N=Object.assign(new E(D,z,G),R);return N.code&&!N.href&&(N.href="https://help.ably.io/error/"+N.code),N},E})(Error);i.default=m;var _=(function(C){l.__extends(E,C);function E(R,v,D,z){var G=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(G,E.prototype),G.code=v,G.statusCode=D,G.cause=z,G}return E.prototype.toString=function(){return g(this)},E})(Error);i.PartialErrorInfo=_}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){if(typeof ArrayBuffer=="function"){var f=l,d=f.lib,g=d.WordArray,m=g.init,_=g.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var E=C.byteLength,R=[],v=0;v<E;v++)R[v>>>2]|=C[v]<<24-v%4*8;m.call(this,R,E)}else m.apply(this,arguments)};_.prototype=g}})(),l.lib.WordArray})}),(function(n,i,r){(function(l){(function(f,d){n.exports=d()})(this,function(){var f=f||(function(d,g){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof l<"u"&&l.crypto&&(m=l.crypto),!m)try{m=r(44)}catch{}var _=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||(function(){function A(){}return function(O){var y;return A.prototype=O,y=new A,A.prototype=null,y}})(),E={},R=E.lib={},v=R.Base=(function(){return{extend:function(A){var O=C(this);return A&&O.mixIn(A),(!O.hasOwnProperty("init")||this.init===O.init)&&(O.init=function(){O.$super.init.apply(this,arguments)}),O.init.prototype=O,O.$super=this,O},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var O in A)A.hasOwnProperty(O)&&(this[O]=A[O]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),D=R.WordArray=v.extend({init:function(A,O){A=this.words=A||[],O!=g?this.sigBytes=O:this.sigBytes=A.length*4},toString:function(A){return(A||G).stringify(this)},concat:function(A){var O=this.words,y=A.words,B=this.sigBytes,U=A.sigBytes;if(this.clamp(),B%4)for(var P=0;P<U;P++){var K=y[P>>>2]>>>24-P%4*8&255;O[B+P>>>2]|=K<<24-(B+P)%4*8}else for(var P=0;P<U;P+=4)O[B+P>>>2]=y[P>>>2];return this.sigBytes+=U,this},clamp:function(){var A=this.words,O=this.sigBytes;A[O>>>2]&=4294967295<<32-O%4*8,A.length=d.ceil(O/4)},clone:function(){var A=v.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var O=[],y=0;y<A;y+=4)O.push(_());return new D.init(O,A)}}),z=E.enc={},G=z.Hex={stringify:function(A){for(var O=A.words,y=A.sigBytes,B=[],U=0;U<y;U++){var P=O[U>>>2]>>>24-U%4*8&255;B.push((P>>>4).toString(16)),B.push((P&15).toString(16))}return B.join("")},parse:function(A){for(var O=A.length,y=[],B=0;B<O;B+=2)y[B>>>3]|=parseInt(A.substr(B,2),16)<<24-B%8*4;return new D.init(y,O/2)}},N=z.Latin1={stringify:function(A){for(var O=A.words,y=A.sigBytes,B=[],U=0;U<y;U++){var P=O[U>>>2]>>>24-U%4*8&255;B.push(String.fromCharCode(P))}return B.join("")},parse:function(A){for(var O=A.length,y=[],B=0;B<O;B++)y[B>>>2]|=(A.charCodeAt(B)&255)<<24-B%4*8;return new D.init(y,O)}},M=z.Utf8={stringify:function(A){try{return decodeURIComponent(escape(N.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return N.parse(unescape(encodeURIComponent(A)))}},L=R.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new D.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=M.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var O,y=this._data,B=y.words,U=y.sigBytes,P=this.blockSize,K=P*4,Y=U/K;A?Y=d.ceil(Y):Y=d.max((Y|0)-this._minBufferSize,0);var Q=Y*P,V=d.min(Q*4,U);if(Q){for(var j=0;j<Q;j+=P)this._doProcessBlock(B,j);O=B.splice(0,Q),y.sigBytes-=V}return new D.init(O,V)},clone:function(){var A=v.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});R.Hasher=L.extend({cfg:v.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){L.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var O=this._doFinalize();return O},blockSize:16,_createHelper:function(A){return function(O,y){return new A.init(y).finalize(O)}},_createHmacHelper:function(A){return function(O,y){return new w.HMAC.init(A,y).finalize(O)}}});var w=E.algo={};return E})(Math);return f})}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(3));function m(E,R,v){try{R.apply(E,v)}catch(D){d.default.logAction(d.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+D+"; stack = "+(D&&D.stack))}}function _(E,R,v){for(var D,z,G,N=0;N<E.length;N++)if(D=E[N],v&&(D=D[v]),f.isArray(D)){for(;(z=f.arrIndexOf(D,R))!==-1;)D.splice(z,1);v&&D.length===0&&delete E[N][v]}else if(f.isObject(D))for(G in D)Object.prototype.hasOwnProperty.call(D,G)&&f.isArray(D[G])&&_([D],R,G)}var C=(function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var R=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];if(v.length===1){var z=v[0];if(typeof z=="function")this.any.push(z);else throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v))}if(v.length===2){var G=v[0],N=v[1];if(typeof N!="function")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));if(f.isEmptyArg(G))this.any.push(N);else if(f.isArray(G))G.forEach(function(L){R.on(L,N)});else{if(typeof G!="string")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));var M=this.events[G]||(this.events[G]=[]);M.push(N)}}},E.prototype.off=function(){for(var R,v=this,D=[],z=0;z<arguments.length;z++)D[z]=arguments[z];if(D.length==0||f.isEmptyArg(D[0])&&f.isEmptyArg(D[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var G=D[0],N=D[1],M=null,L=null;if(D.length===1||!N)typeof G=="function"?M=G:L=G;else{if(typeof N!="function")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));R=[G,N],L=R[0],M=R[1]}if(M&&f.isEmptyArg(L)){_([this.any,this.events,this.anyOnce,this.eventsOnce],M);return}if(f.isArray(L)){L.forEach(function(w){v.off(w,M)});return}if(typeof L!="string")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));M?_([this.events,this.eventsOnce],M,L):(delete this.events[L],delete this.eventsOnce[L])},E.prototype.listeners=function(R){if(R){var v=this.events[R]||[];return this.eventsOnce[R]&&Array.prototype.push.apply(v,this.eventsOnce[R]),v.length?v:null}return this.any.length?this.any:null},E.prototype.emit=function(R){for(var v=[],D=1;D<arguments.length;D++)v[D-1]=arguments[D];var z={event:R},G=[];this.anyOnce.length&&(Array.prototype.push.apply(G,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(G,this.any);var N=this.eventsOnce[R];N&&(Array.prototype.push.apply(G,N),delete this.eventsOnce[R]);var M=this.events[R];M&&Array.prototype.push.apply(G,M),f.arrForEach(G,function(L){m(z,L,v)})},E.prototype.once=function(){for(var R=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];var z=v.length;if((z===0||z===1&&typeof v[0]!="function")&&g.default.Config.Promise){var G=v[0];return new g.default.Config.Promise(function(O){R.once(G,O)})}var N=v[0],M=v[1];if(v.length===1&&typeof N=="function")this.anyOnce.push(N);else if(f.isEmptyArg(N)){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));this.anyOnce.push(M)}else if(f.isArray(N)){var L=this,w=function(){var O=Array.prototype.slice.call(arguments);if(f.arrForEach(N,function(y){L.off(y,w)}),typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));M.apply(this,O)};f.arrForEach(N,function(O){L.on(O,w)})}else{if(typeof N!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));var A=this.eventsOnce[N]||(this.eventsOnce[N]=[]);if(M){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));A.push(M)}}},E.prototype.whenState=function(R,v,D){for(var z=this,G=[],N=3;N<arguments.length;N++)G[N-3]=arguments[N];var M={event:R};if(typeof R!="string"||typeof v!="string")throw"whenState requires a valid event String argument";if(typeof D!="function"&&g.default.Config.Promise)return new g.default.Config.Promise(function(L){E.prototype.whenState.apply(z,[R,v,L].concat(G))});R===v?m(M,D,G):this.once(R,D)},E})();i.default=C}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.getDefaults=i.normaliseOptions=i.objectifyOptions=i.getAgentString=i.getHosts=i.getFallbackHosts=i.environmentFallbackHosts=i.getHttpScheme=i.getPort=i.getHost=void 0;var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(4)),_=r(43),C="ably-js/"+_.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:_.version,protocolVersion:2,agent:C,getHost:R,getPort:v,getHttpScheme:D,environmentFallbackHosts:z,getFallbackHosts:G,getHosts:N,checkHost:M,objectifyOptions:O,normaliseOptions:y};function R(U,P,K){return K?P=P==U.restHost&&U.realtimeHost||P||U.realtimeHost:P=P||U.restHost,P}i.getHost=R;function v(U,P){return P||U.tls?U.tlsPort:U.port}i.getPort=v;function D(U){return U.tls?"https://":"http://"}i.getHttpScheme=D;function z(U){return[U+"-a-fallback.ably-realtime.com",U+"-b-fallback.ably-realtime.com",U+"-c-fallback.ably-realtime.com",U+"-d-fallback.ably-realtime.com",U+"-e-fallback.ably-realtime.com"]}i.environmentFallbackHosts=z;function G(U){var P=U.fallbackHosts,K=typeof U.httpMaxRetryCount<"u"?U.httpMaxRetryCount:E.httpMaxRetryCount;return P?d.arrChooseN(P,K):[]}i.getFallbackHosts=G;function N(U){return[U.restHost].concat(G(U))}i.getHosts=N;function M(U){if(typeof U!="string")throw new m.default("host must be a string; was a "+typeof U,4e4,400);if(!U.length)throw new m.default("host must not be zero-length",4e4,400)}function L(U,P,K){return U.realtimeHost?U.realtimeHost:U.restHost?(g.default.logAction(g.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+U.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+U.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),U.restHost):P?E.REALTIME_HOST:K+"-"+E.REALTIME_HOST}function w(U){var P={};for(var K in E.TIMEOUTS)P[K]=U[K]||E.TIMEOUTS[K];return P}function A(U){var P=E.agent;if(U.agents)for(var K in U.agents)P+=" "+K+"/"+U.agents[K];return P}i.getAgentString=A;function O(U){return typeof U=="string"?U.indexOf(":")==-1?{token:U}:{key:U}:U}i.objectifyOptions=O;function y(U){if(U.host&&(g.default.renamedClientOption("host","restHost"),U.restHost=U.host),U.wsHost&&(g.default.renamedClientOption("wsHost","realtimeHost"),U.realtimeHost=U.wsHost),U.queueEvents&&(g.default.renamedClientOption("queueEvents","queueMessages"),U.queueMessages=U.queueEvents),U.headers&&g.default.deprecated("the `headers` client option",""),U.fallbackHostsUseDefault){if(U.fallbackHosts){var P="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}if(U.port||U.tlsPort){var P="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}U.environment?g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),U.fallbackHosts=E.FALLBACK_HOSTS}U.recover===!0&&(g.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),U.recover=function(it,q){q(!0)}),typeof U.recover=="function"&&U.closeOnUnload===!0&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),U.recover=void 0),"closeOnUnload"in U||(U.closeOnUnload=!U.recover),U.transports&&d.arrIn(U.transports,"xhr")&&(g.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),d.arrDeleteValue(U.transports,"xhr"),U.transports.push("xhr_streaming")),"queueMessages"in U||(U.queueMessages=!0);var K=U.environment&&String(U.environment).toLowerCase()||E.ENVIRONMENT,Y=!K||K==="production";!U.fallbackHosts&&!U.restHost&&!U.realtimeHost&&!U.port&&!U.tlsPort&&(U.fallbackHosts=Y?E.FALLBACK_HOSTS:z(K));var Q=U.restHost||(Y?E.REST_HOST:K+"-"+E.REST_HOST),V=L(U,Y,K);d.arrForEach((U.fallbackHosts||[]).concat(Q,V),M),U.port=U.port||E.PORT,U.tlsPort=U.tlsPort||E.TLS_PORT,"tls"in U||(U.tls=!0);var j=w(U);if("useBinaryProtocol"in U?U.useBinaryProtocol=f.default.Config.supportsBinary&&U.useBinaryProtocol:U.useBinaryProtocol=f.default.Config.preferBinary,U.clientId){var I=U.headers=U.headers||{};I["X-Ably-ClientId"]=f.default.BufferUtils.base64Encode(f.default.BufferUtils.utf8Encode(U.clientId))}"idempotentRestPublishing"in U||(U.idempotentRestPublishing=!0),U.promises&&!f.default.Config.Promise&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),U.promises=!1);var X=null,Z=U.connectivityCheckUrl;if(U.connectivityCheckUrl){var at=U.connectivityCheckUrl.split("?"),J=at[0],rt=at[1];X=rt?d.parseQueryString(rt):{},J.indexOf("://")===-1&&(J="https://"+J),Z=J}return l.__assign(l.__assign({},U),{useBinaryProtocol:"useBinaryProtocol"in U?f.default.Config.supportsBinary&&U.useBinaryProtocol:f.default.Config.preferBinary,realtimeHost:V,restHost:Q,maxMessageSize:U.maxMessageSize||E.maxMessageSize,timeouts:j,connectivityCheckParams:X,connectivityCheckUrl:Z})}i.normaliseOptions=y,i.default=E;function B(U){return Object.assign(E,U)}i.getDefaults=B}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importDefault(r(2)),g=l.__importDefault(r(4)),m=l.__importStar(r(1));function _(v){return!v||!v.channelOptions?{channelOptions:v,plugins:{},baseEncodedPreviousPayload:void 0}:v}function C(v){if(v&&v.cipher){if(!f.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var D=f.default.Crypto.getCipher(v.cipher);return{cipher:D.cipherParams,channelCipher:D.cipher}}return v??{}}function E(v){var D=0;return v.name&&(D+=v.name.length),v.clientId&&(D+=v.clientId.length),v.extras&&(D+=JSON.stringify(v.extras).length),v.data&&(D+=m.dataSizeBytes(v.data)),D}var R=(function(){function v(){}return v.prototype.toJSON=function(){var D=this.encoding,z=this.data;return z&&f.default.BufferUtils.isBuffer(z)&&(arguments.length>0?(D=D?D+"/base64":"base64",z=f.default.BufferUtils.base64Encode(z)):z=f.default.BufferUtils.toBuffer(z)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:D,data:z}},v.prototype.toString=function(){var D="[Message";return this.name&&(D+="; name="+this.name),this.id&&(D+="; id="+this.id),this.timestamp&&(D+="; timestamp="+this.timestamp),this.clientId&&(D+="; clientId="+this.clientId),this.connectionId&&(D+="; connectionId="+this.connectionId),this.encoding&&(D+="; encoding="+this.encoding),this.extras&&(D+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?D+="; data="+this.data:f.default.BufferUtils.isBuffer(this.data)?D+="; data (buffer)="+f.default.BufferUtils.base64Encode(this.data):D+="; data (json)="+JSON.stringify(this.data)),this.extras&&(D+="; extras="+JSON.stringify(this.extras)),D+="]",D},v.encrypt=function(D,z,G){var N=D.data,M=D.encoding,L=z.channelCipher;M=M?M+"/":"",f.default.BufferUtils.isBuffer(N)||(N=f.default.BufferUtils.utf8Encode(String(N)),M=M+"utf-8/"),L.encrypt(N,function(w,A){if(w){G(w);return}D.data=A,D.encoding=M+"cipher+"+L.algorithm,G(null,D)})},v.encode=function(D,z,G){var N=D.data,M=typeof N=="string"||f.default.BufferUtils.isBuffer(N)||N===null||N===void 0;if(!M)if(m.isObject(N)||m.isArray(N))D.data=JSON.stringify(N),D.encoding=D.encoding?D.encoding+"/json":"json";else throw new g.default("Data type is unsupported",40013,400);z!=null&&z.cipher?v.encrypt(D,z,G):G(null,D)},v.encodeArray=function(D,z,G){for(var N=0,M=0;M<D.length;M++)v.encode(D[M],z,function(L){if(L){G(L);return}N++,N==D.length&&G(null,D)})},v.decode=function(D,z){var G=_(z),N=D.data,M=D.encoding;if(M){var L=M.split("/"),w=void 0,A=L.length,O=D.data,y="";try{for(;(w=A)>0;){var B=L[--A].match(/([-\w]+)(\+([\w-]+))?/);if(!B)break;switch(y=B[1],y){case"base64":O=f.default.BufferUtils.base64Decode(String(O)),w==L.length&&(N=O);continue;case"utf-8":O=f.default.BufferUtils.utf8Decode(O);continue;case"json":O=JSON.parse(O);continue;case"cipher":if(G.channelOptions!=null&&G.channelOptions.cipher&&G.channelOptions.channelCipher){var U=B[3],P=G.channelOptions.channelCipher;if(U!=P.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");O=P.decrypt(O);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!G.plugins||!G.plugins.vcdiff)throw new g.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new g.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var K=G.baseEncodedPreviousPayload;typeof K=="string"&&(K=f.default.BufferUtils.utf8Encode(K)),K=f.default.BufferUtils.toBuffer(K),O=f.default.BufferUtils.toBuffer(O),O=f.default.BufferUtils.typedArrayToBuffer(G.plugins.vcdiff.decode(O,K)),N=O}catch(Q){throw new g.default("Vcdiff delta decode failed with "+Q,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(Q){var Y=Q;throw new g.default("Error processing the "+y+" encoding, decoder returned ‘"+Y.message+"’",Y.code||40013,400)}finally{D.encoding=w<=0?null:L.slice(0,w).join("/"),D.data=O}}G.baseEncodedPreviousPayload=N},v.fromResponseBody=function(D,z,G){G&&(D=m.decodeBody(D,G));for(var N=0;N<D.length;N++){var M=D[N]=v.fromValues(D[N]);try{v.decode(M,z)}catch(L){d.default.logAction(d.default.LOG_ERROR,"Message.fromResponseBody()",L.toString())}}return D},v.fromValues=function(D){return Object.assign(new v,D)},v.fromValuesArray=function(D){for(var z=D.length,G=new Array(z),N=0;N<z;N++)G[N]=v.fromValues(D[N]);return G},v.fromEncoded=function(D,z){var G=v.fromValues(D),N=C(z??null);try{v.decode(G,N)}catch(M){d.default.logAction(d.default.LOG_ERROR,"Message.fromEncoded()",M.toString())}return G},v.fromEncodedArray=function(D,z){return D.map(function(G){return v.fromEncoded(G,z)})},v.getMessagesSize=function(D){for(var z,G=0,N=0;N<D.length;N++)z=D[N],G+=z.size||(z.size=E(z));return G},v.serialize=m.encodeBody,v})();i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(4)),g=l.__importDefault(r(9)),m=l.__importDefault(r(16)),_={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(_).forEach(function(G){C[_[G]]=G});var E={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},R=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function v(G){var N=[];if(G)for(var M=0;M<G.length;M++)N.push(G[M].toString());return"[ "+N.join(", ")+" ]"}var D="id channel channelSerial connectionId count msgSerial timestamp".split(" "),z=(function(){function G(){var N=this;this.hasFlag=function(M){return(N.flags&E[M])>0}}return G.prototype.setFlag=function(N){return this.flags=this.flags|E[N]},G.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},G.prototype.encodeModesToFlags=function(N){var M=this;N.forEach(function(L){return M.setFlag(L)})},G.prototype.decodeModesFromFlags=function(){var N=this,M=[];return G.channelModes.forEach(function(L){N.hasFlag(L)&&M.push(L)}),M.length>0?M:void 0},G.fromValues=function(N){return Object.assign(new G,N)},G.Action=_,G.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],G.ActionName=C,G.serialize=f.encodeBody,G.deserialize=function(N,M){var L=f.decodeBody(N,M);return G.fromDeserialized(L)},G.fromDeserialized=function(N){var M=N.error;M&&(N.error=d.default.fromValues(M));var L=N.messages;if(L)for(var w=0;w<L.length;w++)L[w]=g.default.fromValues(L[w]);var A=N.presence;if(A)for(var w=0;w<A.length;w++)A[w]=m.default.fromValues(A[w],!0);return Object.assign(new G,N)},G.stringify=function(N){var M="[ProtocolMessage";N.action!==void 0&&(M+="; action="+G.ActionName[N.action]||!1);for(var L,w=0;w<D.length;w++)L=D[w],N[L]!==void 0&&(M+="; "+L+"="+N[L]);if(N.messages&&(M+="; messages="+v(g.default.fromValuesArray(N.messages))),N.presence&&(M+="; presence="+v(m.default.fromValuesArray(N.presence))),N.error&&(M+="; error="+d.default.fromValues(N.error).toString()),N.auth&&N.auth.accessToken&&(M+="; token="+N.auth.accessToken),N.flags&&(M+="; flags="+R.filter(N.hasFlag).join(",")),N.params){var A="";f.forInOwnNonNullProperties(N.params,function(O){A.length>0&&(A+="; "),A+=O+"="+N.params[O]}),A.length>0&&(M+="; params=["+A+"]")}return M+="]",M},G})();i.default=z}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=f.enc;m.Base64={stringify:function(C){var E=C.words,R=C.sigBytes,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var D=[],z=0;z<R;z+=3)for(var G=E[z>>>2]>>>24-z%4*8&255,N=E[z+1>>>2]>>>24-(z+1)%4*8&255,M=E[z+2>>>2]>>>24-(z+2)%4*8&255,L=G<<16|N<<8|M,w=0;w<4&&z+w*.75<R;w++)D.push(v.charAt(L>>>6*(3-w)&63));var A=v.charAt(64);if(A)for(;D.length%4;)D.push(A);return D.join("")},parse:function(C){var E=C.length,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var D=0;D<R.length;D++)v[R.charCodeAt(D)]=D}var z=R.charAt(64);if(z){var G=C.indexOf(z);G!==-1&&(E=G)}return _(C,E,v)}};function _(C,E,R){for(var v=[],D=0,z=0;z<E;z++)if(z%4){var G=R[C.charCodeAt(z-1)]<<z%4*2,N=R[C.charCodeAt(z)]>>>6-z%4*2,M=G|N;v[D>>>2]|=M<<24-D%4*8,D++}return g.create(v,D)}})(),l.enc.Base64})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(10)),g=l.__importDefault(r(26)),m=l.__importDefault(r(2)),_=l.__importDefault(r(8)),C=l.__importDefault(r(21)),E=l.__importDefault(r(18)),R=l.__importDefault(r(4)),v=l.__importDefault(r(22)),D=l.__importDefault(r(3));function z(M){var L=[80015,80017,80030];return M.code?E.default.isTokenErr(M)?!1:f.arrIn(L,M.code)?!0:M.code>=4e4&&M.code<5e4:!1}function G(M){return z(M)?[d.default.fromValues({action:d.default.Action.ERROR,error:M})]:[d.default.fromValues({action:d.default.Action.DISCONNECTED,error:M})]}var N=(function(M){l.__extends(L,M);function L(w,A,O){var y=M.call(this,w,A,O,!0)||this;return y.onAuthUpdated=function(B){y.authParams={access_token:B.token}},y.stream="stream"in O?O.stream:!0,y.sendRequest=null,y.recvRequest=null,y.pendingCallback=null,y.pendingItems=null,y}return L.prototype.connect=function(){var w=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","starting"),g.default.prototype.connect.call(this);var A=this.params,O=A.options,y=_.default.getHost(O,A.host),B=_.default.getPort(O),U=O.tls?"https://":"http://";this.baseUri=U+y+":"+B+"/comet/";var P=this.baseUri+"connect";m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","uri: "+P),this.auth.getAuthParams(function(K,Y){if(K){w.disconnect(K);return}if(!w.isDisposed){w.authParams=Y;var Q=w.params.getConnectParams(Y);"stream"in Q&&(w.stream=Q.stream),m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+f.toQueryString(Q));var V=!1,j=w.recvRequest=w.createRequest(P,null,Q,null,w.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV);j.on("data",function(I){w.recvRequest&&(V||(V=!0,w.emit("preconnect")),w.onData(I))}),j.on("complete",function(I){if(w.recvRequest||(I=I||new R.default("Request cancelled",80003,400)),w.recvRequest=null,!V&&!I&&(V=!0,w.emit("preconnect")),w.onActivity(),I){I.code?w.onData(G(I)):w.disconnect(I);return}D.default.Config.nextTick(function(){w.recv()})}),j.exec()}})},L.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},L.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},L.prototype._requestCloseOrDisconnect=function(w){var A=this,O=w?this.closeUri:this.disconnectUri;if(O){var y=this.createRequest(O,null,this.authParams,null,v.default.REQ_SEND);y.on("complete",function(B){B&&(m.default.logAction(m.default.LOG_ERROR,"CometTransport.request"+(w?"Close()":"Disconnect()"),"request returned err = "+f.inspectError(B)),A.finish("disconnected",B))}),y.exec()}},L.prototype.dispose=function(){var w=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),D.default.Config.nextTick(function(){w.emit("disposed")}))},L.prototype.onConnect=function(w){var A;if(!this.isDisposed){var O=(A=w.connectionDetails)===null||A===void 0?void 0:A.connectionKey;g.default.prototype.onConnect.call(this,w);var y=this.baseUri+O;m.default.logAction(m.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+y),this.sendUri=y+"/send",this.recvUri=y+"/recv",this.closeUri=y+"/close",this.disconnectUri=y+"/disconnect"}},L.prototype.send=function(w){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(w);return}var A=this.pendingItems||[];A.push(w),this.pendingItems=null,this.sendItems(A)},L.prototype.sendAnyPending=function(){var w=this.pendingItems;w&&(this.pendingItems=null,this.sendItems(w))},L.prototype.sendItems=function(w){var A=this,O=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(w),v.default.REQ_SEND);O.on("complete",function(y,B){if(y&&m.default.logAction(m.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+f.inspectError(y)),A.sendRequest=null,y){y.code?A.onData(G(y)):A.disconnect(y);return}B&&A.onData(B),A.pendingItems&&D.default.Config.nextTick(function(){A.sendRequest||A.sendAnyPending()})}),O.exec()},L.prototype.recv=function(){var w=this;if(!this.recvRequest&&this.isConnected){var A=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV_POLL);A.on("data",function(O){w.onData(O)}),A.on("complete",function(O){if(w.recvRequest=null,w.onActivity(),O){O.code?w.onData(G(O)):w.disconnect(O);return}D.default.Config.nextTick(function(){w.recv()})}),A.exec()}},L.prototype.onData=function(w){try{var A=this.decodeResponse(w);if(A&&A.length)for(var O=0;O<A.length;O++)this.onProtocolMessage(d.default.fromDeserialized(A[O]))}catch(y){m.default.logAction(m.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+y.stack)}},L.prototype.encodeRequest=function(w){return JSON.stringify(w)},L.prototype.decodeResponse=function(w){return typeof w=="string"?JSON.parse(w):w},L})(g.default);i.default=N}),(function(n,i){var r;r=(function(){return this})();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.isSuccessCode=void 0;var l;(function(d){d[d.Success=200]="Success",d[d.NoContent=204]="NoContent",d[d.BadRequest=400]="BadRequest",d[d.Unauthorized=401]="Unauthorized",d[d.Forbidden=403]="Forbidden",d[d.RequestTimeout=408]="RequestTimeout",d[d.InternalServerError=500]="InternalServerError"})(l||(l={}));function f(d){return d>=l.Success&&d<l.BadRequest}i.isSuccessCode=f,i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(18)),_=l.__importDefault(r(19)),C=r(4),E=l.__importDefault(r(14));function R(M,L,w,A,O){M.http.supportsAuthHeaders?M.auth.getAuthHeaders(function(y,B){y?A(y):O(d.mixin(B,L),w)}):M.auth.getAuthParams(function(y,B){y?A(y):O(L,d.mixin(B,w))})}function v(M,L){return function(w,A,O,y,B){if(w&&!A){M(w);return}if(B===E.default.NoContent){M(w,[],O,!0,B);return}if(!y)try{A=d.decodeBody(A,L)}catch(V){d.isErrorInfoOrPartialErrorInfo(V)?M(V):M(new C.PartialErrorInfo(d.inspectError(V),null));return}if(!A){M(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var U=A,P=U.statusCode,K=U.response,Y=U.headers;if(P===void 0){M(w,A,O,!0,B);return}if(P<200||P>=300){var Q=K&&K.error||w;Q||(Q=new Error("Error in unenveloping "+A),Q.statusCode=P),M(Q,K,Y,!0,P);return}M(w,K,Y,!0,P)}}function D(M){var L=[];if(M)for(var w in M)L.push(w+"="+M[w]);return L.join("&")}function z(M,L){return M+(L?"?":"")+D(L)}function G(M,L,w,A){return function(O,y,B,U,P){O?g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Received Error; "+z(w,A)+"; Error: "+d.inspectError(O)):g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Received; "+z(w,A)+"; Headers: "+D(B)+"; StatusCode: "+P+"; Body: "+(f.default.BufferUtils.isBuffer(y)?y.toString():y)),M&&M(O,y,B,U,P)}}var N=(function(){function M(){}return M.get=function(L,w,A,O,y,B){M.do(_.default.Get,L,w,null,A,O,y,B)},M.delete=function(L,w,A,O,y,B){M.do(_.default.Delete,L,w,null,A,O,y,B)},M.post=function(L,w,A,O,y,B,U){M.do(_.default.Post,L,w,A,O,y,B,U)},M.patch=function(L,w,A,O,y,B,U){M.do(_.default.Patch,L,w,A,O,y,B,U)},M.put=function(L,w,A,O,y,B,U){M.do(_.default.Put,L,w,A,O,y,B,U)},M.do=function(L,w,A,O,y,B,U,P){g.default.shouldLog(g.default.LOG_MICRO)&&(P=G(P,L,A,B)),U&&(P=P&&v(P,U),(B=B||{}).envelope=U);function K(Y,Q){var V;if(g.default.shouldLog(g.default.LOG_MICRO)&&g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Sending; "+z(A,Q)),g.default.shouldLog(g.default.LOG_MICRO)){var j=O;if(((V=Y["content-type"])===null||V===void 0?void 0:V.indexOf("msgpack"))>0)try{j=f.default.Config.msgpack.decode(O)}catch(I){g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Sending MsgPack Decoding Error: "+d.inspectError(I))}g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Sending; "+z(A,Q)+"; Body: "+j)}w.http.do(L,w,A,Y,O,Q,function(I,X,Z,at,J){if(I&&m.default.isTokenErr(I)){w.auth.authorize(null,null,function(rt){if(rt){P(rt);return}R(w,Y,Q,P,K)});return}P(I,X,Z,at,J)})}R(w,y,B,P,K)},M})();i.default=N}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=l.__importDefault(r(3)),g=l.__importDefault(r(9)),m=l.__importStar(r(1));function _(E){return C.Actions.indexOf(E)}var C=(function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var R=this.id.split(":");return{connectionId:R[0],msgSerial:parseInt(R[1],10),index:parseInt(R[2],10)}},E.prototype.toJSON=function(){var R=this.data,v=this.encoding;return R&&d.default.BufferUtils.isBuffer(R)&&(arguments.length>0?(v=v?v+"/base64":"base64",R=d.default.BufferUtils.base64Encode(R)):R=d.default.BufferUtils.toBuffer(R)),{id:this.id,clientId:this.clientId,action:_(this.action),data:R,encoding:v,extras:this.extras}},E.prototype.toString=function(){var R="[PresenceMessage";return R+="; action="+this.action,this.id&&(R+="; id="+this.id),this.timestamp&&(R+="; timestamp="+this.timestamp),this.clientId&&(R+="; clientId="+this.clientId),this.connectionId&&(R+="; connectionId="+this.connectionId),this.encoding&&(R+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?R+="; data="+this.data:d.default.BufferUtils.isBuffer(this.data)?R+="; data (buffer)="+d.default.BufferUtils.base64Encode(this.data):R+="; data (json)="+JSON.stringify(this.data)),this.extras&&(R+="; extras="+JSON.stringify(this.extras)),R+="]",R},E.fromResponseBody=function(R,v,D){var z=[];D&&(R=m.decodeBody(R,D));for(var G=0;G<R.length;G++){var N=z[G]=E.fromValues(R[G],!0);try{E.decode(N,v)}catch(M){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",M.toString())}}return z},E.fromValues=function(R,v){return v&&(R.action=E.Actions[R.action]),Object.assign(new E,R)},E.fromValuesArray=function(R){for(var v=R.length,D=new Array(v),z=0;z<v;z++)D[z]=E.fromValues(R[z]);return D},E.fromEncoded=function(R,v){var D=E.fromValues(R,!0);try{E.decode(D,v??{})}catch(z){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromEncoded()",z.toString())}return D},E.fromEncodedArray=function(R,v){return R.map(function(D){return E.fromEncoded(D,v)})},E.fromData=function(R){return R instanceof E?R:E.fromValues({data:R})},E.Actions=["absent","present","enter","leave","update"],E.encode=g.default.encode,E.decode=g.default.decode,E.getMessagesSize=g.default.getMessagesSize,E})();i.default=C}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),d=f.__importStar(r(1)),g=f.__importDefault(r(7)),m=f.__importStar(r(4)),_=f.__importDefault(r(2)),C=f.__importDefault(r(8)),E=f.__importDefault(r(22)),R=f.__importDefault(r(3));function v(U,P){return d.arrIn(d.allToLowerCase(d.keysArray(P)),"x-ably-errorcode")}function D(U,P){if(v(U,P))return U.error&&m.default.fromValues(U.error)}var z=function(){},G=0,N={},M=typeof l<"u"&&l.XDomainRequest;function L(){var U=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return U&&Number(U[1])}function w(){var U;return M&&(U=L())&&U===10}function A(U,P){return U.getResponseHeader&&U.getResponseHeader(P)}function O(U){return U.getResponseHeader&&(U.getResponseHeader("transfer-encoding")||!U.getResponseHeader("content-length"))}function y(U){for(var P=d.trim(U.getAllResponseHeaders()).split(`\r
`),K={},Y=0;Y<P.length;Y++){var Q=P[Y].split(":").map(d.trim);K[Q[0].toLowerCase()]=Q[1]}return K}var B=(function(U){f.__extends(P,U);function P(K,Y,Q,V,j,I,X){var Z=U.call(this)||this;return Q=Q||{},Q.rnd=d.cheapRandStr(),w()&&!Q.envelope&&(Q.envelope="json"),Z.uri=K+d.toQueryString(Q),Z.headers=Y||{},Z.body=V,Z.method=X?X.toUpperCase():d.isEmptyArg(V)?"GET":"POST",Z.requestMode=j,Z.timeouts=I,Z.timedOut=!1,Z.requestComplete=!1,Z.id=String(++G),N[Z.id]=Z,Z}return P.createRequest=function(K,Y,Q,V,j,I,X){var Z=I||C.default.TIMEOUTS;return new P(K,Y,d.copy(Q),V,j,Z,X)},P.prototype.complete=function(K,Y,Q,V,j){this.requestComplete||(this.requestComplete=!0,!K&&Y&&this.emit("data",Y),this.emit("complete",K,Y,Q,V,j),this.dispose())},P.prototype.abort=function(){this.dispose()},P.prototype.exec=function(){var K=this,Y=this.headers,Q=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,V=this.timer=setTimeout(function(){K.timedOut=!0,I.abort()},Q),j=this.method,I=this.xhr=new XMLHttpRequest,X=Y.accept,Z=this.body,at="text";if(X?X.indexOf("application/x-msgpack")===0&&(at="arraybuffer"):Y.accept="application/json",Z){var J=Y["content-type"]||(Y["content-type"]="application/json");J.indexOf("application/json")>-1&&typeof Z!="string"&&(Z=JSON.stringify(Z))}I.open(j,this.uri,!0),I.responseType=at,"authorization"in Y&&(I.withCredentials=!0);for(var rt in Y)I.setRequestHeader(rt,Y[rt]);var it=function(Pt,pe,xe,zt){var ft,xt=pe+" (event type: "+Pt.type+")";!((ft=K==null?void 0:K.xhr)===null||ft===void 0)&&ft.statusText&&(xt+=", current statusText is "+K.xhr.statusText),_.default.logAction(_.default.LOG_ERROR,"Request.on"+Pt.type+"()",xt),K.complete(new m.PartialErrorInfo(xt,xe,zt))};I.onerror=function(Pt){it(Pt,"XHR error occurred",null,400)},I.onabort=function(Pt){K.timedOut?it(Pt,"Request aborted due to request timeout expiring",null,408):it(Pt,"Request cancelled",null,400)},I.ontimeout=function(Pt){it(Pt,"Request timed out",null,408)};var q,F,$,nt=0,ht=!1,Tt=function(){if(clearTimeout(V),$=F<400,F==204){K.complete(null,null,null,null,F);return}q=K.requestMode==E.default.REQ_RECV_STREAM&&$&&O(I)},jt=function(){var Pt;try{var pe=A(I,"content-type"),xe=pe?pe.indexOf("application/json")>=0:I.responseType=="text";if(xe){var zt=I.responseType==="arraybuffer"?R.default.BufferUtils.utf8Decode(I.response):String(I.responseText);zt.length?Pt=JSON.parse(zt):Pt=zt,ht=!0}else Pt=I.response;Pt.response!==void 0?(F=Pt.statusCode,$=F<400,Y=Pt.headers,Pt=Pt.response):Y=y(I)}catch(xt){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+xt.message,null,400));return}if($||d.isArray(Pt)){K.complete(null,Pt,Y,ht,F);return}var ft=D(Pt,Y);ft||(ft=new m.PartialErrorInfo("Error response received from server: "+F+" body was: "+R.default.Config.inspect(Pt),null,F)),K.complete(ft,Pt,Y,ht,F)};function Kt(){for(var Pt=I.responseText,pe=Pt.length-1,xe,zt;nt<pe&&(xe=Pt.indexOf(`
`,nt))>-1;)zt=Pt.slice(nt,xe),nt=xe+1,Wt(zt)}var Wt=function(Pt){try{Pt=JSON.parse(Pt)}catch(pe){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+pe.message,null,400));return}K.emit("data",Pt)},ge=function(){Kt(),K.streamComplete=!0,R.default.Config.nextTick(function(){K.complete()})};I.onreadystatechange=function(){var Pt=I.readyState;Pt<3||I.status!==0&&(F===void 0&&(F=I.status,F===1223&&(F=204),Tt()),Pt==3&&q?Kt():Pt==4&&(q?ge():jt()))},I.send(Z)},P.prototype.dispose=function(){var K=this.xhr;if(K){K.onreadystatechange=K.onerror=K.onabort=K.ontimeout=z,this.xhr=null;var Y=this.timer;Y&&(clearTimeout(Y),this.timer=null),this.requestComplete||K.abort()}delete N[this.id]},P})(g.default);i.default=B}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=l.__importStar(r(1)),g=l.__importDefault(r(24)),m=l.__importDefault(r(4)),_=l.__importDefault(r(45)),C=r(11),E=l.__importDefault(r(19)),R=l.__importDefault(r(14)),v=l.__importDefault(r(3)),D=l.__importDefault(r(15)),z=Math.pow(2,17);function G(){}function N(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function M(Q){return!!Q.connection}function L(Q){return d.isErrorInfoOrPartialErrorInfo(Q)?(Q.code||(Q.statusCode===403?Q.code=40300:(Q.code=40170,Q.statusCode=401)),Q):new m.default(d.inspectError(Q),Q.code||40170,Q.statusCode||401)}var w=function(Q,V){if(v.default.Config.createHmac){var j=v.default.Config.createHmac("SHA256",V);return j.update(Q),j.digest("base64")}return(0,C.stringify)((0,_.default)(Q,V))};function A(Q){if(!Q)return"";typeof Q=="string"&&(Q=JSON.parse(Q));var V=Object.create(null),j=d.keysArray(Q,!0);if(!j)return"";j.sort();for(var I=0;I<j.length;I++)V[j[I]]=Q[j[I]].sort();return JSON.stringify(V)}function O(Q){if(Q.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(Q.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(Q.key)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(Q.tokenDetails)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var V="authOptions must include valid authentication parameters";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",V),new Error(V)}}function y(Q){return"useTokenAuth"in Q&&!Q.useTokenAuth}function B(Q){return Q.useTokenAuth||!y(Q)&&(Q.authCallback||Q.authUrl||Q.token||Q.tokenDetails)}function U(Q){return!Q.key&&!Q.authCallback&&!Q.authUrl}var P=0;function K(){return P++}var Y=(function(){function Q(V,j){if(this.authOptions={},this.client=V,this.tokenParams=j.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,B(j)){if(j.key&&!w){var I="client-side token request signing not supported";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new Error(I)}U(j)&&f.default.logAction(f.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(j.defaultTokenParams,j),O(this.authOptions)}else{if(!j.key){var I="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new m.default(I,40160,401)}f.default.logAction(f.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(j)}}return Q.prototype.authorize=function(V,j,I){var X=this,Z;if(typeof V=="function"&&!I?(I=V,Z=V=null):typeof j=="function"&&!I?(I=j,Z=null):Z=j,!I&&this.client.options.promises)return d.promisify(this,"authorize",arguments);if(Z&&Z.key&&this.authOptions.key!==Z.key)throw new m.default("Unable to update auth options with incompatible key",40102,401);Z&&"force"in Z&&(f.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),d.isOnlyPropIn(Z,"force")&&(Z=null)),this._forceNewToken(V,Z,function(at,J){if(at){X.client.connection&&at.statusCode===R.default.Forbidden&&X.client.connection.connectionManager.actOnErrorFromAuthorize(at),I==null||I(at);return}M(X.client)?X.client.connection.connectionManager.onAuthUpdated(J,I||G):I==null||I(null,J)})},Q.prototype.authorise=function(V,j,I){f.default.renamedMethod("Auth","authorise","authorize"),this.authorize(V,j,I)},Q.prototype._forceNewToken=function(V,j,I){var X=this;this.tokenDetails=null,this._saveTokenOptions(V,j),O(this.authOptions),this._ensureValidAuthCredentials(!0,function(Z,at){delete X.tokenParams.timestamp,delete X.authOptions.queryTime,I(Z,at)})},Q.prototype.requestToken=function(V,j,I){var X=this;if(typeof V=="function"&&!I?(I=V,j=V=null):typeof j=="function"&&!I&&(I=j,j=null),!I&&this.client.options.promises)return d.promisify(this,"requestToken",arguments);j=j||this.authOptions,V=V||d.copy(this.tokenParams);var Z=I||G,at,J=this.client;if(j.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),at=j.authCallback;else if(j.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),at=function(nt,ht){var Tt=d.mixin({accept:"application/json, text/plain"},j.authHeaders),jt=j.authMethod&&j.authMethod.toLowerCase()==="post",Kt,Wt=j.authUrl.indexOf("?");Wt>-1&&(Kt=d.parseQueryString(j.authUrl.slice(Wt)),j.authUrl=j.authUrl.slice(0,Wt),jt||(j.authParams=d.mixin(Kt,j.authParams)));var ge=d.mixin({},j.authParams||{},nt),Pt=function(zt,ft,xt,Qt){var Jt;if(zt?f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+d.inspectError(zt)):(Jt=xt["content-type"],f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+Jt+"; body: "+d.inspectBody(ft))),zt||Qt)return ht(zt,ft);if(v.default.BufferUtils.isBuffer(ft)&&(ft=ft.toString()),!Jt){ht(new m.default("authUrl response is missing a content-type header",40170,401));return}var $t=Jt.indexOf("application/json")>-1,ve=Jt.indexOf("text/plain")>-1||Jt.indexOf("application/jwt")>-1;if(!$t&&!ve){ht(new m.default("authUrl responded with unacceptable content-type "+Jt+", should be either text/plain, application/jwt or application/json",40170,401));return}if($t){if(ft.length>z){ht(new m.default("authUrl response exceeded max permitted length",40170,401));return}try{ft=JSON.parse(ft)}catch(ae){ht(new m.default("Unexpected error processing authURL response; err = "+ae.message,40170,401));return}}ht(null,ft,Jt)};if(f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+j.authUrl+"; Params: "+JSON.stringify(ge)+"; method: "+(jt?"POST":"GET")),jt){var pe=Tt||{};pe["content-type"]="application/x-www-form-urlencoded";var xe=d.toQueryString(ge).slice(1);X.client.http.doUri(E.default.Post,J,j.authUrl,pe,xe,Kt,Pt)}else X.client.http.doUri(E.default.Get,J,j.authUrl,Tt||{},null,ge,Pt)};else if(j.key)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),at=function(nt,ht){X.createTokenRequest(nt,j,ht)};else{var rt="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";f.default.logAction(f.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),Z(new m.default(rt,40171,403));return}"capability"in V&&(V.capability=A(V.capability));var it=function(nt,ht){var Tt=nt.keyName,jt="/keys/"+Tt+"/requestToken",Kt=function(ge){return J.baseUri(ge)+jt},Wt=d.defaultPostHeaders(X.client.options);j.requestHeaders&&d.mixin(Wt,j.requestHeaders),f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+jt+"; Token params: "+JSON.stringify(nt)),X.client.http.do(E.default.Post,J,Kt,Wt,JSON.stringify(nt),null,ht)},q=!1,F=this.client.options.timeouts.realtimeRequestTimeout,$=setTimeout(function(){q=!0;var nt="Token request callback timed out after "+F/1e3+" seconds";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",nt),Z(new m.default(nt,40170,401))},F);at(V,function(nt,ht,Tt){if(!q){if(clearTimeout($),nt){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+d.inspectError(nt)),Z(L(nt));return}if(typeof ht=="string"){ht.length===0?Z(new m.default("Token string is empty",40170,401)):ht.length>z?Z(new m.default("Token string exceeded max permitted length (was "+ht.length+" bytes)",40170,401)):ht==="undefined"||ht==="null"?Z(new m.default("Token string was literal null/undefined",40170,401)):ht[0]==="{"&&!(Tt&&Tt.indexOf("application/jwt")>-1)?Z(new m.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):Z(null,{token:ht});return}if(typeof ht!="object"){var jt="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof ht;f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",jt),Z(new m.default(jt,40170,401));return}var Kt=JSON.stringify(ht).length;if(Kt>z&&!j.suppressMaxLengthCheck){Z(new m.default("Token request/details object exceeded max permitted stringified size (was "+Kt+" bytes)",40170,401));return}if("issued"in ht){Z(null,ht);return}if(!("keyName"in ht)){var jt="Expected token request callback to call back with a token string, token request object, or token details object";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",jt),Z(new m.default(jt,40170,401));return}it(ht,function(Wt,ge,Pt,pe){if(Wt){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+d.inspectError(Wt)),Z(L(Wt));return}pe||(ge=JSON.parse(ge)),f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","token received"),Z(null,ge)})}})},Q.prototype.createTokenRequest=function(V,j,I){var X=this;if(typeof V=="function"&&!I?(I=V,j=V=null):typeof j=="function"&&!I&&(I=j,j=null),!I&&this.client.options.promises)return d.promisify(this,"createTokenRequest",arguments);j=j||this.authOptions,V=V||d.copy(this.tokenParams);var Z=j.key;if(!Z){I(new m.default("No key specified",40101,403));return}var at=Z.split(":"),J=at[0],rt=at[1];if(!rt){I(new m.default("Invalid key specified",40101,403));return}if(V.clientId===""){I(new m.default("clientId can’t be an empty string",40012,400));return}"capability"in V&&(V.capability=A(V.capability));var it=d.mixin({keyName:J},V),q=V.clientId||"",F=V.ttl||"",$=V.capability||"";(function(nt){if(it.timestamp){nt();return}X.getTimestamp(j&&j.queryTime,function(ht,Tt){if(ht){I(ht);return}it.timestamp=Tt,nt()})})(function(){var nt=it.nonce||(it.nonce=N()),ht=it.timestamp,Tt=it.keyName+`
`+F+`
`+$+`
`+q+`
`+ht+`
`+nt+`
`;it.mac=it.mac||w(Tt,rt),f.default.logAction(f.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),I(null,it)})},Q.prototype.getAuthParams=function(V){this.method=="basic"?V(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(j,I){if(j){V(j);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{access_token:I.token})})},Q.prototype.getAuthHeaders=function(V){this.method=="basic"?V(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(j,I){if(j){V(j);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{authorization:"Bearer "+d.toBase64(I.token)})})},Q.prototype.getTimestamp=function(V,j){!this.isTimeOffsetSet()&&(V||this.authOptions.queryTime)?this.client.time(j):j(null,this.getTimestampUsingOffset())},Q.prototype.getTimestampUsingOffset=function(){return d.now()+(this.client.serverTimeOffset||0)},Q.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},Q.prototype._saveBasicOptions=function(V){this.method="basic",this.key=V.key,this.basicKey=d.toBase64(V.key),this.authOptions=V||{},"clientId"in V&&this._userSetClientId(V.clientId)},Q.prototype._saveTokenOptions=function(V,j){this.method="token",V&&(this.tokenParams=V),j&&(j.token&&(j.tokenDetails=typeof j.token=="string"?{token:j.token}:j.token),j.tokenDetails&&(this.tokenDetails=j.tokenDetails),"clientId"in j&&this._userSetClientId(j.clientId),this.authOptions=j)},Q.prototype._ensureValidAuthCredentials=function(V,j){var I=this,X=this.tokenDetails;if(X){if(this._tokenClientIdMismatch(X.clientId)){j(new m.default("Mismatch between clientId in token ("+X.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!X.expires||X.expires>=this.getTimestampUsingOffset()){f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+X.expires),j(null,X);return}f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=g.default.create())).push(j),!(this.currentTokenRequestId!==null&&!V)){var Z=this.currentTokenRequestId=K();this.requestToken(this.tokenParams,this.authOptions,function(at,J){if(I.currentTokenRequestId>Z){f.default.logAction(f.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}I.currentTokenRequestId=null;var rt=I.waitingForTokenRequest||G;if(I.waitingForTokenRequest=null,at){rt(at);return}rt(null,I.tokenDetails=J)})}},Q.prototype._userSetClientId=function(V){if(typeof V=="string"||V===null){if(V==="*")throw new m.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var j=this._uncheckedSetClientId(V);if(j)throw j}else throw new m.default("clientId must be either a string or null",40012,400)},Q.prototype._uncheckedSetClientId=function(V){if(this._tokenClientIdMismatch(V)){var j="Unexpected clientId mismatch: client has "+this.clientId+", requested "+V,I=new m.default(j,40102,401);return f.default.logAction(f.default.LOG_ERROR,"Auth._uncheckedSetClientId()",j),I}else return this.clientId=this.tokenParams.clientId=V,null},Q.prototype._tokenClientIdMismatch=function(V){return!!(this.clientId&&this.clientId!=="*"&&V&&V!=="*"&&this.clientId!==V)},Q.isTokenErr=function(V){return V.code&&V.code>=40140&&V.code<40150},Q.prototype.revokeTokens=function(V,j,I){if(B(this.client.options))throw new m.default("Cannot revoke tokens when using token auth",40162,401);var X=this.client.options.keyName,Z;if(typeof j=="function"?(I=j,Z={}):Z=j??{},I===void 0){if(this.client.options.promises)return d.promisify(this,"revokeTokens",[V,Z]);I=G}var at=I,J=l.__assign({targets:V.map(function(F){return"".concat(F.type,":").concat(F.value)})},Z),rt=this.client.options.useBinaryProtocol?d.Format.msgpack:d.Format.json,it=d.defaultPostHeaders(this.client.options,rt);this.client.options.headers&&d.mixin(it,this.client.options.headers);var q=d.encodeBody(J,rt);D.default.post(this.client,"/keys/".concat(X,"/revokeTokens"),q,it,{newBatchResponse:"true"},null,function(F,$,nt,ht){if(F){at(F);return}var Tt=ht?$:d.decodeBody($,rt);at(null,Tt)})},Q})();i.default=Y}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(f){f.Get="get",f.Delete="delete",f.Post="post",f.Put="put",f.Patch="patch"})(l||(l={})),i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.HttpPaginatedResponse=i.PaginatedResult=void 0;var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(15)),m=l.__importDefault(r(14));function _(z){var G=z.match(/^\.\/(\w+)\?(.*)$/);return G&&G[2]&&f.parseQueryString(G[2])}function C(z){typeof z=="string"&&(z=z.split(","));for(var G={},N=0;N<z.length;N++){var M=z[N].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(M){var L=_(M[1]);L&&(G[M[2]]=L)}}return G}function E(z,G,N){return!(N&&(G||typeof z.code=="number"))}var R=(function(){function z(G,N,M,L,w,A){this.rest=G,this.path=N,this.headers=M,this.envelope=L??null,this.bodyHandler=w,this.useHttpPaginatedResponse=A||!1}return z.prototype.get=function(G,N){var M=this;g.default.get(this.rest,this.path,this.headers,G,this.envelope,function(L,w,A,O,y){M.handlePage(L,w,A,O,y,N)})},z.prototype.delete=function(G,N){var M=this;g.default.delete(this.rest,this.path,this.headers,G,this.envelope,function(L,w,A,O,y){M.handlePage(L,w,A,O,y,N)})},z.prototype.post=function(G,N,M){var L=this;g.default.post(this.rest,this.path,N,this.headers,G,this.envelope,function(w,A,O,y,B){M&&L.handlePage(w,A,O,y,B,M)})},z.prototype.put=function(G,N,M){var L=this;g.default.put(this.rest,this.path,N,this.headers,G,this.envelope,function(w,A,O,y,B){M&&L.handlePage(w,A,O,y,B,M)})},z.prototype.patch=function(G,N,M){var L=this;g.default.patch(this.rest,this.path,N,this.headers,G,this.envelope,function(w,A,O,y,B){M&&L.handlePage(w,A,O,y,B,M)})},z.prototype.handlePage=function(G,N,M,L,w,A){if(G&&E(G,N,this.useHttpPaginatedResponse)){d.default.logAction(d.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+f.inspectError(G)),A==null||A(G);return}var O,y,B;try{O=w==m.default.NoContent?[]:this.bodyHandler(N,M||{},L)}catch(U){A==null||A(G||U);return}M&&(y=M.Link||M.link)&&(B=C(y)),this.useHttpPaginatedResponse?A(null,new D(this,O,M||{},w,B,G)):A(null,new v(this,O,B))},z})(),v=(function(){function z(G,N,M){var L=this;this.resource=G,this.items=N;var w=this;M&&("first"in M&&(this.first=function(A){if(!A&&w.resource.rest.options.promises)return f.promisify(w,"first",[]);w.get(M.first,A)}),"current"in M&&(this.current=function(A){if(!A&&w.resource.rest.options.promises)return f.promisify(w,"current",[]);w.get(M.current,A)}),this.next=function(A){if(!A&&w.resource.rest.options.promises)return f.promisify(w,"next",[]);"next"in M?w.get(M.next,A):A(null,null)},this.hasNext=function(){return"next"in M},this.isLast=function(){var A;return!(!((A=L.hasNext)===null||A===void 0)&&A.call(L))})}return z.prototype.get=function(G,N){var M=this.resource;g.default.get(M.rest,M.path,M.headers,G,M.envelope,function(L,w,A,O,y){M.handlePage(L,w,A,O,y,N)})},z})();i.PaginatedResult=v;var D=(function(z){l.__extends(G,z);function G(N,M,L,w,A,O){var y=z.call(this,N,M,A)||this;return y.statusCode=w,y.success=w<300&&w>=200,y.headers=L,y.errorCode=O&&O.code,y.errorMessage=O&&O.message,y}return G.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},G})(v);i.HttpPaginatedResponse=D,i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.isRetriable=void 0;var l=r(0),f=l.__importDefault(r(4)),d={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},g={disconnected:function(){return f.default.fromValues({statusCode:400,code:d.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return f.default.fromValues({statusCode:400,code:d.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return f.default.fromValues({statusCode:400,code:d.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return f.default.fromValues({statusCode:400,code:d.CLOSING,message:"Connection closing"})},closed:function(){return f.default.fromValues({statusCode:400,code:d.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return f.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return f.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function m(_){return!_.statusCode||!_.code||_.statusCode>=500?!0:Object.values(d).includes(_.code)}i.isRetriable=m,i.default=g}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(f){f[f.REQ_SEND=0]="REQ_SEND",f[f.REQ_RECV=1]="REQ_RECV",f[f.REQ_RECV_POLL=2]="REQ_RECV_POLL",f[f.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(l||(l={})),i.default=l}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(l){return l})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=(function(){function g(m){this.members=m||[]}return g.prototype.call=function(){for(var m=[],_=0;_<arguments.length;_++)m[_]=arguments[_];for(var C=0,E=this.members;C<E.length;C++){var R=E[C];if(R)try{R.apply(void 0,m)}catch(v){f.default.logAction(f.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+v+"; stack = "+v.stack)}}},g.prototype.push=function(){for(var m,_=[],C=0;C<arguments.length;C++)_[C]=arguments[C];(m=this.members).push.apply(m,_)},g.create=function(m){var _=new g(m);return Object.assign(function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];return _.call.apply(_,C)},{push:function(C){return _.push(C)}})},g})();i.default=d}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){(function(){var f=l,d=f.lib,g=d.Base,m=f.enc,_=m.Utf8,C=f.algo;C.HMAC=g.extend({init:function(E,R){E=this._hasher=new E.init,typeof R=="string"&&(R=_.parse(R));var v=E.blockSize,D=v*4;R.sigBytes>D&&(R=E.finalize(R)),R.clamp();for(var z=this._oKey=R.clone(),G=this._iKey=R.clone(),N=z.words,M=G.words,L=0;L<v;L++)N[L]^=1549556828,M[L]^=909522486;z.sigBytes=G.sigBytes=D,this.reset()},reset:function(){var E=this._hasher;E.reset(),E.update(this._iKey)},update:function(E){return this._hasher.update(E),this},finalize:function(E){var R=this._hasher,v=R.finalize(E);R.reset();var D=R.finalize(this._oKey.clone().concat(v));return D}})})()})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(21)),C=l.__importDefault(r(4)),E=l.__importDefault(r(3)),R=f.default.Action,v=f.default.fromValues({action:R.CLOSE}),D=f.default.fromValues({action:R.DISCONNECT}),z=(function(G){l.__extends(N,G);function N(M,L,w,A){var O=G.call(this)||this;return A&&(w.format=void 0,w.heartbeats=!0),O.connectionManager=M,M.registerProposedTransport(O),O.auth=L,O.params=w,O.timeouts=w.options.timeouts,O.format=w.format,O.isConnected=!1,O.isFinished=!1,O.isDisposed=!1,O.maxIdleInterval=null,O.idleTimer=null,O.lastActivity=null,O}return N.prototype.connect=function(){},N.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",_.default.closed())},N.prototype.disconnect=function(M){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",M||_.default.disconnected())},N.prototype.fail=function(M){this.isConnected&&this.requestDisconnect(),this.finish("failed",M||_.default.failed())},N.prototype.finish=function(M,L){var w;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((w=this.idleTimer)!==null&&w!==void 0?w:void 0),this.idleTimer=null,this.emit(M,L),this.dispose())},N.prototype.onProtocolMessage=function(M){switch(m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+f.default.stringify(M)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),M.action){case R.HEARTBEAT:m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",M.id);break;case R.CONNECTED:this.onConnect(M),this.emit("connected",M.error,M.connectionId,M.connectionDetails,M);break;case R.CLOSED:this.onClose(M);break;case R.DISCONNECTED:this.onDisconnect(M);break;case R.ACK:this.emit("ack",M.msgSerial,M.count);break;case R.NACK:this.emit("nack",M.msgSerial,M.count,M.error);break;case R.SYNC:this.connectionManager.onChannelMessage(M,this);break;case R.ACTIVATE:break;case R.AUTH:this.auth.authorize(function(L){L&&m.default.logAction(m.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+d.inspectError(L))});break;case R.ERROR:if(m.default.logAction(m.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(M.error)+(M.channel?", channel: "+M.channel:"")),M.channel===void 0){this.onFatalError(M);break}this.connectionManager.onChannelMessage(M,this);break;default:this.connectionManager.onChannelMessage(M,this)}},N.prototype.onConnect=function(M){if(this.isConnected=!0,!M.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var L=M.connectionDetails.maxIdleInterval;L&&(this.maxIdleInterval=L+this.timeouts.realtimeRequestTimeout,this.onActivity())},N.prototype.onDisconnect=function(M){var L=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onDisconnect()","err = "+d.inspectError(L)),this.finish("disconnected",L)},N.prototype.onFatalError=function(M){var L=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onFatalError()","err = "+d.inspectError(L)),this.finish("failed",L)},N.prototype.onClose=function(M){var L=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onClose()","err = "+d.inspectError(L)),this.finish("closed",L)},N.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestClose()",""),this.send(v)},N.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(D)},N.prototype.ping=function(M){var L={action:f.default.Action.HEARTBEAT};M&&(L.id=M),this.send(f.default.fromValues(L))},N.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},N.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=d.now(),this.setIdleTimer(this.maxIdleInterval+100))},N.prototype.setIdleTimer=function(M){var L=this;this.idleTimer||(this.idleTimer=setTimeout(function(){L.onIdleTimerExpire()},M))},N.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var M=d.now()-this.lastActivity,L=this.maxIdleInterval-M;if(L<=0){var w="No activity seen from realtime in "+M+"ms; assuming connection has dropped";m.default.logAction(m.default.LOG_ERROR,"Transport.onIdleTimerExpire()",w),this.disconnect(new C.default(w,80003,408))}else this.setIdleTimer(L+100)},N.tryConnect=function(M,L,w,A,O){var y=new M(L,w,A),B,U=function(K){clearTimeout(B),O({event:this.event,error:K})},P=L.options.timeouts.realtimeRequestTimeout;B=setTimeout(function(){y.off(["preconnect","disconnected","failed"]),y.dispose(),U.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},P),y.on(["failed","disconnected"],U),y.on("preconnect",function(){m.default.logAction(m.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+y),clearTimeout(B),y.off(["failed","disconnected"],U),O(null,y)}),y.connect()},N})(g.default);i.default=z}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(40),r(25))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.Base,m=d.WordArray,_=f.algo,C=_.MD5,E=_.EvpKDF=g.extend({cfg:g.extend({keySize:128/32,hasher:C,iterations:1}),init:function(R){this.cfg=this.cfg.extend(R)},compute:function(R,v){for(var D,z=this.cfg,G=z.hasher.create(),N=m.create(),M=N.words,L=z.keySize,w=z.iterations;M.length<L;){D&&G.update(D),D=G.update(R).finalize(v),G.reset();for(var A=1;A<w;A++)D=G.finalize(D),G.reset();N.concat(D)}return N.sigBytes=L*4,N}});f.EvpKDF=function(R,v,D){return E.create(D).compute(R,v)}})(),l.EvpKDF})}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(27))})(this,function(l){l.lib.Cipher||(function(f){var d=l,g=d.lib,m=g.Base,_=g.WordArray,C=g.BufferedBlockAlgorithm,E=d.enc;E.Utf8;var R=E.Base64,v=d.algo,D=v.EvpKDF,z=g.Cipher=C.extend({cfg:m.extend(),createEncryptor:function(Y,Q){return this.create(this._ENC_XFORM_MODE,Y,Q)},createDecryptor:function(Y,Q){return this.create(this._DEC_XFORM_MODE,Y,Q)},init:function(Y,Q,V){this.cfg=this.cfg.extend(V),this._xformMode=Y,this._key=Q,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(Y){return this._append(Y),this._process()},finalize:function(Y){Y&&this._append(Y);var Q=this._doFinalize();return Q},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function Y(Q){return typeof Q=="string"?K:B}return function(Q){return{encrypt:function(V,j,I){return Y(j).encrypt(Q,V,j,I)},decrypt:function(V,j,I){return Y(j).decrypt(Q,V,j,I)}}}})()});g.StreamCipher=z.extend({_doFinalize:function(){var Y=this._process(!0);return Y},blockSize:1});var G=d.mode={},N=g.BlockCipherMode=m.extend({createEncryptor:function(Y,Q){return this.Encryptor.create(Y,Q)},createDecryptor:function(Y,Q){return this.Decryptor.create(Y,Q)},init:function(Y,Q){this._cipher=Y,this._iv=Q}}),M=G.CBC=(function(){var Y=N.extend();Y.Encryptor=Y.extend({processBlock:function(V,j){var I=this._cipher,X=I.blockSize;Q.call(this,V,j,X),I.encryptBlock(V,j),this._prevBlock=V.slice(j,j+X)}}),Y.Decryptor=Y.extend({processBlock:function(V,j){var I=this._cipher,X=I.blockSize,Z=V.slice(j,j+X);I.decryptBlock(V,j),Q.call(this,V,j,X),this._prevBlock=Z}});function Q(V,j,I){var X,Z=this._iv;Z?(X=Z,this._iv=f):X=this._prevBlock;for(var at=0;at<I;at++)V[j+at]^=X[at]}return Y})(),L=d.pad={},w=L.Pkcs7={pad:function(Y,Q){for(var V=Q*4,j=V-Y.sigBytes%V,I=j<<24|j<<16|j<<8|j,X=[],Z=0;Z<j;Z+=4)X.push(I);var at=_.create(X,j);Y.concat(at)},unpad:function(Y){var Q=Y.words[Y.sigBytes-1>>>2]&255;Y.sigBytes-=Q}};g.BlockCipher=z.extend({cfg:z.cfg.extend({mode:M,padding:w}),reset:function(){var Y;z.reset.call(this);var Q=this.cfg,V=Q.iv,j=Q.mode;this._xformMode==this._ENC_XFORM_MODE?Y=j.createEncryptor:(Y=j.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Y?this._mode.init(this,V&&V.words):(this._mode=Y.call(j,this,V&&V.words),this._mode.__creator=Y)},_doProcessBlock:function(Y,Q){this._mode.processBlock(Y,Q)},_doFinalize:function(){var Y,Q=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Q.pad(this._data,this.blockSize),Y=this._process(!0)):(Y=this._process(!0),Q.unpad(Y)),Y},blockSize:128/32});var A=g.CipherParams=m.extend({init:function(Y){this.mixIn(Y)},toString:function(Y){return(Y||this.formatter).stringify(this)}}),O=d.format={},y=O.OpenSSL={stringify:function(Y){var Q,V=Y.ciphertext,j=Y.salt;return j?Q=_.create([1398893684,1701076831]).concat(j).concat(V):Q=V,Q.toString(R)},parse:function(Y){var Q,V=R.parse(Y),j=V.words;return j[0]==1398893684&&j[1]==1701076831&&(Q=_.create(j.slice(2,4)),j.splice(0,4),V.sigBytes-=16),A.create({ciphertext:V,salt:Q})}},B=g.SerializableCipher=m.extend({cfg:m.extend({format:y}),encrypt:function(Y,Q,V,j){j=this.cfg.extend(j);var I=Y.createEncryptor(V,j),X=I.finalize(Q),Z=I.cfg;return A.create({ciphertext:X,key:V,iv:Z.iv,algorithm:Y,mode:Z.mode,padding:Z.padding,blockSize:Y.blockSize,formatter:j.format})},decrypt:function(Y,Q,V,j){j=this.cfg.extend(j),Q=this._parse(Q,j.format);var I=Y.createDecryptor(V,j).finalize(Q.ciphertext);return I},_parse:function(Y,Q){return typeof Y=="string"?Q.parse(Y,this):Y}}),U=d.kdf={},P=U.OpenSSL={execute:function(Y,Q,V,j){j||(j=_.random(64/8));var I=D.create({keySize:Q+V}).compute(Y,j),X=_.create(I.words.slice(Q),V*4);return I.sigBytes=Q*4,A.create({key:I,iv:X,salt:j})}},K=g.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:P}),encrypt:function(Y,Q,V,j){j=this.cfg.extend(j);var I=j.kdf.execute(V,Y.keySize,Y.ivSize);j.iv=I.iv;var X=B.encrypt.call(this,Y,Q,I.key,j);return X.mixIn(I),X},decrypt:function(Y,Q,V,j){j=this.cfg.extend(j),Q=this._parse(Q,j.format);var I=j.kdf.execute(V,Y.keySize,Y.ivSize,Q.salt);j.iv=I.iv;var X=B.decrypt.call(this,Y,Q,I.key,j);return X}})})()})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.Request=i.createRequest=void 0;var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(12)),g=l.__importDefault(r(3)),m=l.__importDefault(r(7)),_=r(4),C=l.__importDefault(r(8)),E=l.__importDefault(r(2)),R=l.__importDefault(r(22)),v=f.getGlobalObject(),D=function(){},z=v._ablyjs_jsonp={};z._=function(O){return z["_"+O]||D};var G=1,N="jsonp";function M(O,y,B,U,P,K,Y){return K=K||C.default.TIMEOUTS,new w(void 0,O,y,f.copy(B),U,P,K,Y)}i.createRequest=M;var L=(function(O){l.__extends(y,O);function y(B,U,P){var K=O.call(this,B,U,P)||this;return K.shortName=N,P.stream=!1,K}return y.isAvailable=function(){return g.default.Config.jsonpSupported&&g.default.Config.allowComet},y.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},y.prototype.createRequest=function(B,U,P,K,Y,Q,V){return Q=(this===null||this===void 0?void 0:this.timeouts)||Q||C.default.TIMEOUTS,M(B,U,P,K,Y,Q,V)},y})(d.default),w=(function(O){l.__extends(y,O);function y(B,U,P,K,Y,Q,V,j){var I=O.call(this)||this;return B===void 0&&(B=G++),I.id=B,I.uri=U,I.params=K||{},I.params.rnd=f.cheapRandStr(),P&&(P["X-Ably-Version"]&&(I.params.v=P["X-Ably-Version"]),P["X-Ably-Lib"]&&(I.params.lib=P["X-Ably-Lib"])),I.body=Y,I.method=j,I.requestMode=Q,I.timeouts=V,I.requestComplete=!1,I}return y.prototype.exec=function(){var B=this,U=this.id,P=this.body,K=this.method,Y=this.uri,Q=this.params;Q.callback="_ablyjs_jsonp._("+U+")",Q.envelope="jsonp",P&&(Q.body=P),K&&K!=="get"&&(Q.method=K);var V=this.script=document.createElement("script"),j=Y+f.toQueryString(Q);V.src=j,V.src.split("/").slice(-1)[0]!==j.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),V.async=!0,V.type="text/javascript",V.charset="UTF-8",V.onerror=function(Z){B.complete(new _.PartialErrorInfo("JSONP script error (event: "+g.default.Config.inspect(Z)+")",null,400))},z["_"+U]=function(Z){if(Z.statusCode){var at=Z.response;if(Z.statusCode==204)B.complete(null,null,null,Z.statusCode);else if(!at)B.complete(new _.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(Z.statusCode<400||f.isArray(at))B.complete(null,at,Z.headers,Z.statusCode);else{var J=at.error||new _.PartialErrorInfo("Error response received from server",null,Z.statusCode);B.complete(J)}}else B.complete(null,Z)};var I=this.requestMode==R.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),I);var X=document.getElementsByTagName("head")[0];X.insertBefore(V,X.firstChild)},y.prototype.complete=function(B,U,P,K){if(P=P||{},!this.requestComplete){this.requestComplete=!0;var Y=void 0;U&&(Y=typeof U=="string"?"text/plain":"application/json",P["content-type"]=Y,this.emit("data",U)),this.emit("complete",B,U,P,!0,K),this.dispose()}},y.prototype.abort=function(){this.dispose()},y.prototype.dispose=function(){var B=this.timer;B&&(clearTimeout(B),this.timer=null);var U=this.script;U.parentNode&&U.parentNode.removeChild(U),delete z[this.id],this.emit("disposed")},y})(m.default);i.Request=w;function A(O){return v.JSONPTransport=L,L.isAvailable()&&(O.supportedTransports[N]=L),L}i.default=A}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(8)),m=l.__importDefault(r(18)),_=l.__importDefault(r(46)),C=l.__importDefault(r(20)),E=l.__importDefault(r(33)),R=l.__importDefault(r(4)),v=l.__importDefault(r(49)),D=l.__importDefault(r(19)),z=l.__importDefault(r(3)),G=l.__importDefault(r(9)),N=l.__importDefault(r(16)),M=l.__importDefault(r(15)),L=function(){},w=(function(){function O(y){if(!y){var B="no options provided";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new Error(B)}var U=g.default.objectifyOptions(y);U.log?(d.default.setLog(U.log.level,U.log.handler),d.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):d.default.setLog(U.logLevel,U.logHandler),d.default.logAction(d.default.LOG_MICRO,"Rest()","initialized with clientOptions "+z.default.Config.inspect(y));var P=this.options=g.default.normaliseOptions(U);if(P.key){var K=P.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!K){var B="invalid key parameter";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new R.default(B,40400,404)}P.keyName=K[1],P.keySecret=K[2]}if("clientId"in P)if(typeof P.clientId=="string"||P.clientId===null){if(P.clientId==="*")throw new R.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new R.default("clientId must be either a string or null",40012,400);d.default.logAction(d.default.LOG_MINOR,"Rest()","started; version = "+g.default.version),this.baseUri=this.authority=function(Y){return g.default.getHttpScheme(P)+Y+":"+g.default.getPort(P,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new z.default.Http(P),this.auth=new m.default(this,P),this.channels=new A(this),this.push=new _.default(this)}return O.prototype.stats=function(y,B){if(B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.options.promises)return f.promisify(this,"stats",[y]);B=L}var U=f.defaultGetHeaders(this.options),P=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,K=this.http.supportsLinkHeaders?void 0:P;this.options.headers&&f.mixin(U,this.options.headers),new C.default(this,"/stats",U,K,function(Y,Q,V){for(var j=V?Y:JSON.parse(Y),I=0;I<j.length;I++)j[I]=v.default.fromValues(j[I]);return j}).get(y,B)},O.prototype.time=function(y,B){var U=this;if(B===void 0){if(typeof y=="function")B=y,y=null;else if(this.options.promises)return f.promisify(this,"time",[y])}var P=B||L,K=f.defaultGetHeaders(this.options);this.options.headers&&f.mixin(K,this.options.headers);var Y=function(Q){return U.authority(Q)+"/time"};this.http.do(D.default.Get,this,Y,K,null,y,function(Q,V,j,I){if(Q){P(Q);return}I||(V=JSON.parse(V));var X=V[0];if(!X){P(new R.default("Internal error (unexpected result type from GET /time)",5e4,500));return}U.serverTimeOffset=X-f.now(),P(null,X)})},O.prototype.request=function(y,B,U,P,K,Y){var Q=this.options.useBinaryProtocol,V=Q?z.default.Config.msgpack.encode:JSON.stringify,j=Q?z.default.Config.msgpack.decode:JSON.parse,I=Q?f.Format.msgpack:f.Format.json,X=this.http.supportsLinkHeaders?void 0:I;U=U||{};var Z=y.toLowerCase(),at=Z=="get"?f.defaultGetHeaders(this.options,I):f.defaultPostHeaders(this.options,I);if(Y===void 0){if(this.options.promises)return f.promisify(this,"request",[y,B,U,P,K]);Y=L}typeof P!="string"&&(P=V(P)),this.options.headers&&f.mixin(at,this.options.headers),K&&f.mixin(at,K);var J=new C.default(this,B,at,X,function(rt,it,q){return f.ensureArray(q?rt:j(rt))},!0);if(!f.arrIn(z.default.Http.methods,Z))throw new R.default("Unsupported method "+Z,40500,405);f.arrIn(z.default.Http.methodsWithBody,Z)?J[Z](U,P,Y):J[Z](U,Y)},O.prototype.batchPublish=function(y,B){if(B===void 0){if(this.options.promises)return f.promisify(this,"batchPublish",[y]);B=L}var U=B,P,K;f.isArray(y)?(P=y,K=!1):(P=[y],K=!0);var Y=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,Q=f.defaultPostHeaders(this.options,Y);this.options.headers&&f.mixin(Q,this.options.headers);var V=f.encodeBody(P,Y);M.default.post(this,"/messages",V,Q,{newBatchResponse:"true"},null,function(j,I,X,Z){if(j){U(j);return}var at=Z?I:f.decodeBody(I,Y);K?U(null,at[0]):U(null,at)})},O.prototype.batchPresence=function(y,B){if(B===void 0){if(this.options.promises)return f.promisify(this,"batchPresence",[y]);B=L}var U=B,P=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,K=f.defaultPostHeaders(this.options,P);this.options.headers&&f.mixin(K,this.options.headers);var Y=y.join(",");M.default.get(this,"/presence",K,{newBatchResponse:"true",channels:Y},null,function(Q,V,j,I){if(Q){U(Q);return}var X=I?V:f.decodeBody(V,P);U(null,X)})},O.prototype.setLog=function(y){d.default.setLog(y.level,y.handler)},O.Promise=function(y){return y=g.default.objectifyOptions(y),y.promises=!0,new O(y)},O.Callbacks=O,O.Platform=z.default,O.Message=G.default,O.PresenceMessage=N.default,O})(),A=(function(){function O(y){this.rest=y,this.all=Object.create(null)}return O.prototype.get=function(y,B){y=String(y);var U=this.all[y];return U?B&&U.setOptions(B):this.all[y]=U=new E.default(this.rest,y,B),U},O.prototype.release=function(y){delete this.all[String(y)]},O})();i.default=w}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return l.enc.Utf8})}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[],R=[];(function(){function z(L){for(var w=f.sqrt(L),A=2;A<=w;A++)if(!(L%A))return!1;return!0}function G(L){return(L-(L|0))*4294967296|0}for(var N=2,M=0;M<64;)z(N)&&(M<8&&(E[M]=G(f.pow(N,1/2))),R[M]=G(f.pow(N,1/3)),M++),N++})();var v=[],D=C.SHA256=_.extend({_doReset:function(){this._hash=new m.init(E.slice(0))},_doProcessBlock:function(z,G){for(var N=this._hash.words,M=N[0],L=N[1],w=N[2],A=N[3],O=N[4],y=N[5],B=N[6],U=N[7],P=0;P<64;P++){if(P<16)v[P]=z[G+P]|0;else{var K=v[P-15],Y=(K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3,Q=v[P-2],V=(Q<<15|Q>>>17)^(Q<<13|Q>>>19)^Q>>>10;v[P]=Y+v[P-7]+V+v[P-16]}var j=O&y^~O&B,I=M&L^M&w^L&w,X=(M<<30|M>>>2)^(M<<19|M>>>13)^(M<<10|M>>>22),Z=(O<<26|O>>>6)^(O<<21|O>>>11)^(O<<7|O>>>25),at=U+Z+j+R[P]+v[P],J=X+I;U=B,B=y,y=O,O=A+at|0,A=w,w=L,L=M,M=at+J|0}N[0]=N[0]+M|0,N[1]=N[1]+L|0,N[2]=N[2]+w|0,N[3]=N[3]+A|0,N[4]=N[4]+O|0,N[5]=N[5]+y|0,N[6]=N[6]+B|0,N[7]=N[7]+U|0},_doFinalize:function(){var z=this._data,G=z.words,N=this._nDataBytes*8,M=z.sigBytes*8;return G[M>>>5]|=128<<24-M%32,G[(M+64>>>9<<4)+14]=f.floor(N/4294967296),G[(M+64>>>9<<4)+15]=N,z.sigBytes=G.length*4,this._process(),this._hash},clone:function(){var z=_.clone.call(this);return z._hash=this._hash.clone(),z}});d.SHA256=_._createHelper(D),d.HmacSHA256=_._createHmacHelper(D)})(Math),l.SHA256})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(34)),_=l.__importDefault(r(9)),C=l.__importDefault(r(4)),E=l.__importDefault(r(20)),R=l.__importDefault(r(15)),v=l.__importDefault(r(3));function D(){}var z=9;function G(L){return f.arrEvery(L,function(w){return!w.id})}function N(L){var w=L||{};if(w.cipher){if(!v.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var A=v.default.Crypto.getCipher(w.cipher);w.cipher=A.cipherParams,w.channelCipher=A.cipher}else"cipher"in w&&(w.cipher=void 0,w.channelCipher=null);return w}var M=(function(L){l.__extends(w,L);function w(A,O,y){var B=L.call(this)||this;return g.default.logAction(g.default.LOG_MINOR,"Channel()","started; name = "+O),B.rest=A,B.name=O,B.basePath="/channels/"+encodeURIComponent(O),B.presence=new m.default(B),B.channelOptions=N(y),B}return w.prototype.setOptions=function(A){this.channelOptions=N(A)},w.prototype.history=function(A,O){if(g.default.logAction(g.default.LOG_MICRO,"Channel.history()","channel = "+this.name),O===void 0)if(typeof A=="function")O=A,A=null;else{if(this.rest.options.promises)return f.promisify(this,"history",arguments);O=D}this._history(A,O)},w.prototype._history=function(A,O){var y=this.rest,B=y.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,U=this.rest.http.supportsLinkHeaders?void 0:B,P=f.defaultGetHeaders(y.options,B);y.options.headers&&f.mixin(P,y.options.headers);var K=this.channelOptions;new E.default(y,this.basePath+"/messages",P,U,function(Y,Q,V){return _.default.fromResponseBody(Y,K,V?void 0:B)}).get(A,O)},w.prototype.publish=function(){var A=this,O=arguments.length,y=arguments[0],B=arguments[1],U=arguments[O-1],P,K;if(typeof U!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);U=D}if(typeof y=="string"||y===null)P=[_.default.fromValues({name:y,data:B})],K=arguments[2];else if(f.isObject(y))P=[_.default.fromValues(y)],K=arguments[1];else if(f.isArray(y))P=_.default.fromValuesArray(y),K=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof K!="object"||!K)&&(K={});var Y=this.rest,Q=Y.options,V=Q.useBinaryProtocol?f.Format.msgpack:f.Format.json,j=Y.options.idempotentRestPublishing,I=f.defaultPostHeaders(Y.options,V);if(Q.headers&&f.mixin(I,Q.headers),j&&G(P)){var X=f.randomString(z);f.arrForEach(P,function(Z,at){Z.id=X+":"+at.toString()})}_.default.encodeArray(P,this.channelOptions,function(Z){if(Z){U(Z);return}var at=_.default.getMessagesSize(P),J=Q.maxMessageSize;if(at>J){U(new C.default("Maximum size of messages that can be published at once exceeded ( was "+at+" bytes; limit is "+J+" bytes)",40009,400));return}A._publish(_.default.serialize(P,V),I,K,U)})},w.prototype._publish=function(A,O,y,B){R.default.post(this.rest,this.basePath+"/messages",A,O,y,null,B)},w.prototype.status=function(A){if(typeof A!="function"&&this.rest.options.promises)return f.promisify(this,"status",[]);var O=this.rest.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,y=f.defaultPostHeaders(this.rest.options,O);R.default.get(this.rest,this.basePath,y,{},O,A||D)},w})(d.default);i.default=M}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(20)),_=l.__importDefault(r(16));function C(){}var E=(function(R){l.__extends(v,R);function v(D){var z=R.call(this)||this;return z.channel=D,z.basePath=D.basePath+"/presence",z}return v.prototype.get=function(D,z){if(g.default.logAction(g.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),z===void 0)if(typeof D=="function")z=D,D=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"get",arguments);z=C}var G=this.channel.rest,N=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:N,L=f.defaultGetHeaders(G.options,N);G.options.headers&&f.mixin(L,G.options.headers);var w=this.channel.channelOptions;new m.default(G,this.basePath,L,M,function(A,O,y){return _.default.fromResponseBody(A,w,y?void 0:N)}).get(D,z)},v.prototype.history=function(D,z){return g.default.logAction(g.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(D,z)},v.prototype._history=function(D,z){if(z===void 0)if(typeof D=="function")z=D,D=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"_history",[D]);z=C}var G=this.channel.rest,N=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:N,L=f.defaultGetHeaders(G.options,N);G.options.headers&&f.mixin(L,G.options.headers);var w=this.channel.channelOptions;new m.default(G,this.basePath+"/history",L,M,function(A,O,y){return _.default.fromResponseBody(A,w,y?void 0:N)}).get(D,z)},v})(d.default);i.default=E}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0}),i.TransportParams=void 0;var f=r(0),d=f.__importDefault(r(10)),g=f.__importStar(r(1)),m=f.__importStar(r(52)),_=f.__importStar(r(8)),C=f.__importDefault(r(3)),E=f.__importDefault(r(7)),R=f.__importDefault(r(36)),v=f.__importDefault(r(2)),D=f.__importDefault(r(37)),z=f.__importStar(r(21)),G=f.__importStar(r(4)),N=f.__importDefault(r(18)),M=f.__importDefault(r(9)),L=f.__importDefault(r(24)),w=f.__importDefault(r(53)),A=f.__importDefault(r(26)),O=f.__importDefault(r(14)),y=function(){var rt;return typeof C.default.WebStorage<"u"&&((rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.localSupported)},B=function(){var rt;return typeof C.default.WebStorage<"u"&&((rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.sessionSupported)},U=d.default.Action,P=function(){},K="ably-transport-preference",Y="ably-connection-recovery";function Q(){var rt,it;return B()&&((it=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.getSession)===null||it===void 0?void 0:it.call(rt,Y))}function V(rt){var it,q;return B()&&((q=(it=C.default.WebStorage)===null||it===void 0?void 0:it.setSession)===null||q===void 0?void 0:q.call(it,Y,rt))}function j(){var rt,it;return B()&&((it=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.removeSession)===null||it===void 0?void 0:it.call(rt,Y))}function I(rt,it){return g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,rt.shortName)>g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,it.shortName)}function X(rt,it,q){var F;if(rt.channel!==it.channel||(F=rt.action)!==U.PRESENCE&&F!==U.MESSAGE||F!==it.action)return!1;var $=F===U.PRESENCE?"presence":"messages",nt=rt[$].concat(it[$]),ht=M.default.getMessagesSize(nt);return ht>q||!g.allSame(nt,"clientId")||!g.arrEvery(nt,function(Tt){return!Tt.id})?!1:(rt[$]=nt,!0)}function Z(rt){try{return JSON.parse(rt)}catch{return null}}var at=(function(){function rt(it,q,F,$){this.options=it,this.host=q,this.mode=F,this.connectionKey=$,this.format=it.useBinaryProtocol?g.Format.msgpack:g.Format.json}return rt.prototype.getConnectParams=function(it){var q=it?g.copy(it):{},F=this.options;switch(this.mode){case"upgrade":q.upgrade=this.connectionKey;break;case"resume":q.resume=this.connectionKey;break;case"recover":{var $=Z(F.recover);$&&(q.recover=$.connectionKey);break}}return F.clientId!==void 0&&(q.clientId=F.clientId),F.echoMessages===!1&&(q.echo="false"),this.format!==void 0&&(q.format=this.format),this.stream!==void 0&&(q.stream=this.stream),this.heartbeats!==void 0&&(q.heartbeats=this.heartbeats),q.v=_.default.protocolVersion,q.agent=(0,_.getAgentString)(this.options),F.transportParams!==void 0&&g.mixin(q,F.transportParams),q},rt.prototype.toString=function(){var it="[mode="+this.mode;return this.host&&(it+=",host="+this.host),this.connectionKey&&(it+=",connectionKey="+this.connectionKey),this.format&&(it+=",format="+this.format),it+="]",it},rt})();i.TransportParams=at;var J=(function(rt){f.__extends(it,rt);function it(q,F){var $=rt.call(this)||this;$.disconnectedRetryCount=0,it.initTransports(),$.realtime=q,$.options=F;var nt=F.timeouts,ht=nt.preferenceConnectTimeout+nt.realtimeRequestTimeout;if($.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:ht,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:nt.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},$.state=$.states.initialized,$.errorReason=null,$.queuedMessages=new R.default,$.msgSerial=0,$.connectionDetails=void 0,$.connectionId=void 0,$.connectionKey=void 0,$.connectionStateTtl=nt.connectionStateTtl,$.maxIdleInterval=null,$.transports=g.intersect(F.transports||_.default.defaultTransports,it.supportedTransports),$.baseTransport=g.intersect(_.default.baseTransportOrder,$.transports)[0],$.upgradeTransports=g.intersect($.transports,_.default.upgradeTransports),$.transportPreference=null,$.httpHosts=_.default.getHosts(F),$.activeProtocol=null,$.proposedTransports=[],$.pendingTransports=[],$.host=null,$.lastAutoReconnectAttempt=null,$.lastActivity=null,$.forceFallbackHost=!1,$.connectCounter=0,v.default.logAction(v.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(F.transports||_.default.defaultTransports)+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+$.transports+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+$.httpHosts+"]"),!$.transports.length){var Tt="no requested transports available";throw v.default.logAction(v.default.LOG_ERROR,"realtime.ConnectionManager()",Tt),new Error(Tt)}var jt=C.default.Config.addEventListener;return jt&&(B()&&typeof F.recover=="function"&&jt("beforeunload",$.persistConnection.bind($)),F.closeOnUnload===!0&&jt("beforeunload",function(){v.default.logAction(v.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),$.requestState({state:"closing"})}),jt("online",function(){$.state==$.states.disconnected||$.state==$.states.suspended?(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),$.requestState({state:"connecting"})):$.state==$.states.connecting&&($.pendingTransports.forEach(function(Kt){Kt.off()}),$.disconnectAllTransports(),$.startConnect())}),jt("offline",function(){$.state==$.states.connected&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),$.disconnectAllTransports())})),$}return it.initTransports=function(){(0,w.default)(it),g.arrForEach(C.default.Transports,function(q){q(it)})},it.prototype.createTransportParams=function(q,F){return new at(this.options,q,F,this.connectionKey)},it.prototype.getTransportParams=function(q){var F=this,$=function(nt){if(F.connectionKey){nt("resume");return}if(typeof F.options.recover=="string"){nt("recover");return}var ht=F.options.recover,Tt=Q();if(Tt&&typeof ht=="function"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),ht(Tt,function(jt){jt?(F.options.recover=Tt.recoveryKey,nt("recover")):nt("clean")});return}nt("clean")};$(function(nt){var ht=F.createTransportParams(null,nt);if(nt==="recover"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+F.options.recover);var Tt=Z(F.options.recover);Tt&&(F.msgSerial=Tt.msgSerial)}else v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+ht.toString());q(ht)})},it.prototype.tryATransport=function(q,F,$){var nt=this;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+F),A.default.tryConnect(it.supportedTransports[F],this,this.realtime.auth,q,function(ht,Tt){var jt=nt.state;if(jt==nt.states.closing||jt==nt.states.closed||jt==nt.states.failed){Tt&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+jt.state+" while we were attempting the transport; closing "+Tt),Tt.close()),$(!0);return}if(ht){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+F+" "+ht.event+", err: "+ht.error.toString()),N.default.isTokenErr(ht.error)&&!(nt.errorReason&&N.default.isTokenErr(nt.errorReason))?(nt.errorReason=ht.error,nt.realtime.auth._forceNewToken(null,null,function(Kt){if(Kt){nt.actOnErrorFromAuthorize(Kt);return}nt.tryATransport(q,F,$)})):ht.event==="failed"?(nt.notifyState({state:"failed",error:ht.error}),$(!0)):ht.event==="disconnected"&&((0,z.isRetriable)(ht.error)?$(!1):(nt.notifyState({state:nt.states.connecting.failState,error:ht.error}),$(!0)));return}v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+F+"; setting pending"),nt.setTransportPending(Tt,q),$(null,Tt)})},it.prototype.setTransportPending=function(q,F){var $=this,nt=F.mode;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+q+"; mode = "+nt),g.arrDeleteValue(this.proposedTransports,q),this.pendingTransports.push(q);var ht=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];q.once("connected",function(jt,Kt,Wt){nt=="upgrade"&&$.activeProtocol?q.shortName!==ht&&g.arrIn($.getUpgradePossibilities(),ht)&&$.activeProtocol?setTimeout(function(){$.scheduleTransportActivation(jt,q,Kt,Wt)},$.options.timeouts.parallelUpgradeDelay):$.scheduleTransportActivation(jt,q,Kt,Wt):($.activateTransport(jt,q,Kt,Wt),C.default.Config.nextTick(function(){$.connectImpl(F)})),nt==="recover"&&$.options.recover&&($.options.recover=null,$.unpersistConnection())});var Tt=this;q.on(["disconnected","closed","failed"],function(jt){Tt.deactivateTransport(q,this.event,jt)}),this.emit("transport.pending",q)},it.prototype.scheduleTransportActivation=function(q,F,$,nt){var ht=this,Tt=this.activeProtocol&&this.activeProtocol.getTransport(),jt=function(){F.disconnect(),g.arrDeleteValue(ht.pendingTransports,F)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+F.shortName),jt();return}if(Tt&&!I(F,Tt)){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+F.shortName+" is no better than current active transport "+Tt.shortName+" - abandoning upgrade"),jt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+F);var Kt=null;if(!F.isConnected){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+F.shortName+"is no longer connected; abandoning upgrade"),jt();return}if(this.state===this.states.connected)v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,Kt=this.activeProtocol;else if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+F.shortName),jt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+F);var Wt=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+F),F.send(d.default.fromValues({action:U.ACTIVATE})),ht.activateTransport(q,F,$,nt),ht.state===ht.states.synchronizing?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+F),ht.state=ht.states.connected):v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+ht.state.state+", so leaving unchanged"),ht.state.sendEvents&&ht.sendQueuedMessages()};Kt?Kt.onceIdle(Wt):Wt()},it.prototype.activateTransport=function(q,F,$,nt){var ht=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+F),q&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+q),$&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+$),nt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(nt)),this.persistTransportPreference(F);var Tt=this.state,jt=this.states.connected.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+Tt.state),Tt.state==this.states.closing.state||Tt.state==this.states.closed.state||Tt.state==this.states.failed.state)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),F.disconnect(),!1;if(g.arrDeleteValue(this.pendingTransports,F),!F.isConnected)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+F+" since it appears to no longer be connected"),!1;var Kt=this.activeProtocol;this.activeProtocol=new m.default(F),this.host=F.params.host;var Wt=nt.connectionKey;if(Wt&&this.connectionKey!=Wt&&this.setConnection($,nt,!!q),this.onConnectionDetailsUpdate(nt,F),C.default.Config.nextTick(function(){F.on("connected",function(Pt,pe,xe){ht.onConnectionDetailsUpdate(xe,F),ht.emit("update",new D.default(jt,jt,null,Pt))})}),Tt.state===this.states.connected.state?q&&(this.errorReason=this.realtime.connection.errorReason=q,this.emit("update",new D.default(jt,jt,null,q))):(this.notifyState({state:"connected",error:q}),this.errorReason=this.realtime.connection.errorReason=q||null),this.emit("transport.active",F),Kt)if(Kt.messageQueue.count()>0&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+Kt.transport.shortName+", new one is "+F.shortName+") finishing with "+Kt.messageQueue.count()+" messages still pending"),Kt.transport===F){var ge="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+F.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",ge)}else Kt.finish();return g.safeArrForEach(this.pendingTransports,function(Pt){if(Pt===F){var pe="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+F.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",pe),g.arrDeleteValue(ht.pendingTransports,F)}else Pt.disconnect()}),g.safeArrForEach(this.proposedTransports,function(Pt){Pt===F?(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+F.shortName+"; stack = "+new Error().stack),g.arrDeleteValue(ht.proposedTransports,F)):Pt.dispose()}),!0},it.prototype.deactivateTransport=function(q,F,$){var nt=this.activeProtocol,ht=nt&&nt.getTransport()===q,Tt=g.arrDeleteValue(this.pendingTransports,q),jt=g.arrDeleteValue(this.proposedTransports,q),Kt=this.noTransportsScheduledForActivation();if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+q),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+F+(ht?"; was active":Tt?"; was pending":jt?"; was proposed":"")+(Kt?"":"; another transport is scheduled for activation")),$&&$.message&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+$.message),ht&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(nt.getPendingMessages()),C.default.Config.nextTick(function(){nt.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",q),ht&&Kt||ht&&F==="failed"||F==="closed"||nt===null&&Tt&&this.pendingTransports.length===0){if(F==="disconnected"&&$&&$.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:F,error:$,retryImmediately:!0});return}var Wt=F==="failed"&&N.default.isTokenErr($)?"disconnected":F;this.notifyState({state:Wt,error:$});return}ht&&F==="disconnected"&&this.state!==this.states.synchronizing&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:$}))},it.prototype.noTransportsScheduledForActivation=function(){return g.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(q){return!q.isConnected})},it.prototype.setConnection=function(q,F,$){var nt=this.connectionId,ht=nt&&nt!==q,Tt=!nt&&$;(ht||Tt)&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==q&&v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=q,this.realtime.connection.key=this.connectionKey=F.connectionKey},it.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},it.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},it.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var q=g.now()-this.lastActivity;q>this.connectionStateTtl+this.maxIdleInterval&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+q+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},it.prototype.persistConnection=function(){if(B()){var q=this.createRecoveryKey();q&&V({recoveryKey:q,disconnectedAt:g.now(),location:l.location,clientId:this.realtime.auth.clientId})}},it.prototype.unpersistConnection=function(){j()},it.prototype.getError=function(){return this.errorReason||this.getStateError()},it.prototype.getStateError=function(){var q,F;return(F=(q=z.default)[this.state.state])===null||F===void 0?void 0:F.call(q)},it.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},it.prototype.enactStateChange=function(q){var F=q.current==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(F,"Connection state",q.current+(q.reason?"; reason: "+q.reason:"")),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+q.current+"; reason = "+(q.reason&&q.reason.message));var $=this.state=this.states[q.current];q.reason&&(this.errorReason=q.reason,this.realtime.connection.errorReason=q.reason),($.terminal||$.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",q)},it.prototype.startTransitionTimer=function(q){var F=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+q.state),this.transitionTimer&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){F.transitionTimer&&(F.transitionTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager "+q.state+" timer expired","requesting new state: "+q.failState),F.notifyState({state:q.failState}))},q.retryDelay)},it.prototype.cancelTransitionTimer=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},it.prototype.startSuspendTimer=function(){var q=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){q.suspendTimer&&(q.suspendTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),q.states.connecting.failState="suspended",q.notifyState({state:"suspended"}))},this.connectionStateTtl))},it.prototype.checkSuspendTimer=function(q){q!=="disconnected"&&q!=="suspended"&&q!=="connecting"&&this.cancelSuspendTimer()},it.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},it.prototype.startRetryTimer=function(q){var F=this;this.retryTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),F.retryTimer=null,F.requestState({state:"connecting"})},q)},it.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},it.prototype.notifyState=function(q){var F=this,$,nt,ht=q.state,Tt=ht==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||q.retryImmediately||this.state===this.states.connecting&&q.error&&N.default.isTokenErr(q.error)&&!(this.errorReason&&N.default.isTokenErr(this.errorReason)));if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+ht+(Tt?"; will retry connection immediately":"")),ht!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(q.state),(ht==="suspended"||ht==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var jt=this.states[q.state],Kt=jt.retryDelay;jt.state==="disconnected"&&(this.disconnectedRetryCount++,Kt=g.getRetryTime(jt.retryDelay,this.disconnectedRetryCount));var Wt=new D.default(this.state.state,jt.state,Kt,q.error||((nt=($=z.default)[jt.state])===null||nt===void 0?void 0:nt.call($)));if(Tt){var ge=function(){F.state===F.states.disconnected&&(F.lastAutoReconnectAttempt=g.now(),F.requestState({state:"connecting"}))},Pt=this.lastAutoReconnectAttempt&&g.now()-this.lastAutoReconnectAttempt+1;Pt&&Pt<1e3?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+Pt+"ms ago, waiting another "+(1e3-Pt)+"ms before trying again"),setTimeout(ge,1e3-Pt)):C.default.Config.nextTick(ge)}else(ht==="disconnected"||ht==="suspended")&&this.startRetryTimer(Kt);(ht==="disconnected"&&!Tt||ht==="suspended"||jt.terminal)&&C.default.Config.nextTick(function(){F.disconnectAllTransports()}),ht=="connected"&&!this.activeProtocol&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(Wt),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(ht,Wt.reason),this.failQueuedMessages(Wt.reason))}},it.prototype.requestState=function(q){var F=this,$,nt,ht=q.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+ht+"; current state: "+this.state.state),ht!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(ht),!(ht=="connecting"&&this.state.state=="connected")&&!(ht=="closing"&&this.state.state=="closed"))){var Tt=this.states[ht],jt=new D.default(this.state.state,Tt.state,null,q.error||((nt=($=z.default)[Tt.state])===null||nt===void 0?void 0:nt.call($)));this.enactStateChange(jt),ht=="connecting"&&C.default.Config.nextTick(function(){F.startConnect()}),ht=="closing"&&this.closeImpl()}},it.prototype.startConnect=function(){var q=this;if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var F=this.realtime.auth,$=++this.connectCounter,nt=function(){q.checkConnectionStateFreshness(),q.getTransportParams(function(Tt){if(Tt.mode==="recover"&&Tt.options.recover){var jt=Z(Tt.options.recover);jt&&q.realtime.channels.recoverChannels(jt.channelSerials)}$===q.connectCounter&&q.connectImpl(Tt,$)})};if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),F.method==="basic")nt();else{var ht=function(Tt){$===q.connectCounter&&(Tt?q.actOnErrorFromAuthorize(Tt):nt())};this.errorReason&&N.default.isTokenErr(this.errorReason)?F._forceNewToken(null,null,ht):F._ensureValidAuthCredentials(!1,ht)}},it.prototype.connectImpl=function(q,F){var $=this.state.state;$!==this.states.connecting.state&&$!==this.states.connected.state?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+$):this.pendingTransports.length?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):$==this.states.connected.state?this.upgradeIfNeeded(q):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(q,F):this.connectBase(q,F)},it.prototype.connectPreference=function(q,F){var $=this,nt=this.getTransportPreference(),ht=!1;g.arrIn(this.transports,nt)||(this.unpersistTransportPreference(),this.connectImpl(q,F)),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+nt);var Tt=setTimeout(function(){ht=!0,$.state.state!==$.states.connected.state&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+nt+" failed; clearing preference and trying from scratch"),$.disconnectAllTransports(),$.unpersistTransportPreference()),$.connectImpl(q,F)},this.options.timeouts.preferenceConnectTimeout);q.host=this.httpHosts[0],this.tryATransport(q,nt,function(jt,Kt){clearTimeout(Tt),ht&&Kt?(Kt.off(),Kt.disconnect(),g.arrDeleteValue($.pendingTransports,Kt)):!Kt&&!jt&&($.unpersistTransportPreference(),$.connectImpl(q,F))})},it.prototype.connectBase=function(q,F){var $=this,nt=function(Wt){$.notifyState({state:$.states.connecting.failState,error:Wt})},ht=this.httpHosts.slice(),Tt=function(Wt,ge){F===$.connectCounter&&!ge&&!Wt&&Kt()};v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var jt=ht.shift();if(!jt){nt(new G.default("Unable to connect (no available host)",80003,404));return}q.host=jt;var Kt=function(){if(!ht.length){nt(new G.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!$.realtime.http.checkConnectivity){nt(new G.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}$.realtime.http.checkConnectivity(function(Wt,ge){if(F===$.connectCounter){if(Wt){nt(Wt);return}if(!ge){nt(new G.default("Unable to connect (network unreachable)",80003,404));return}q.host=g.arrPopRandomElement(ht),$.tryATransport(q,$.baseTransport,Tt)}})};if(this.forceFallbackHost&&ht.length){this.forceFallbackHost=!1,Kt();return}this.tryATransport(q,this.baseTransport,Tt)},it.prototype.getUpgradePossibilities=function(){var q=this.activeProtocol.getTransport().shortName,F=g.arrIndexOf(this.upgradeTransports,q);return this.upgradeTransports.slice(F+1)},it.prototype.upgradeIfNeeded=function(q){var F=this,$=this.getUpgradePossibilities();v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect($)),$.length&&g.arrForEach($,function(nt){var ht=F.createTransportParams(q.host,"upgrade");F.tryATransport(ht,nt,P)})},it.prototype.closeImpl=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),g.safeArrForEach(this.pendingTransports,function(q){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+q),q&&q.close()}),g.safeArrForEach(this.proposedTransports,function(q){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+q),q&&q.dispose()}),this.activeProtocol&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},it.prototype.onAuthUpdated=function(q,F){var $=this,nt;switch(this.state.state){case"connected":{if(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var ht=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){$.state.state==="connected"&&$.upgradeIfNeeded(ht)})}var Tt=(nt=this.activeProtocol)===null||nt===void 0?void 0:nt.getTransport();Tt&&Tt.onAuthUpdated&&Tt.onAuthUpdated(q);var jt=d.default.fromValues({action:U.AUTH,auth:{accessToken:q.token}});this.send(jt);var Kt=function(){$.off(Wt),F(null,q)},Wt=function(Pt){Pt.current==="failed"&&($.off(Kt),$.off(Wt),F(Pt.reason||$.getStateError()))};this.once("connectiondetails",Kt),this.on("connectionstate",Wt);break}case"connecting":v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var ge=function(Pt){switch(Pt.current){case"connected":$.off(ge),F(null,q);break;case"failed":case"closed":case"suspended":$.off(ge),F(Pt.reason||$.getStateError());break}};this.on("connectionstate",ge),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},it.prototype.disconnectAllTransports=function(q){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(q?" except the active transport":"")),this.connectCounter++,g.safeArrForEach(this.pendingTransports,function(F){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+F),F&&F.disconnect()}),this.pendingTransports=[],g.safeArrForEach(this.proposedTransports,function(F){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+F),F&&F.dispose()}),this.proposedTransports=[],this.activeProtocol&&!q&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},it.prototype.send=function(q,F,$){$=$||P;var nt=this.state;if(nt.sendEvents){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new m.PendingMessage(q,$));return}var ht=F&&nt.queueEvents||nt.forceQueueEvents;if(!ht){var Tt="rejecting event, queueEvent was "+F+", state was "+nt.state;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()",Tt),$(this.errorReason||new G.default(Tt,9e4,400));return}v.default.shouldLog(v.default.LOG_MICRO)&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+d.default.stringify(q)),this.queue(q,$)},it.prototype.sendImpl=function(q){var F=q.message;q.ackRequired&&!q.sendAttempted&&(F.msgSerial=this.msgSerial++);try{this.activeProtocol.send(q)}catch($){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+$.stack)}},it.prototype.queue=function(q,F){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var $=this.queuedMessages.last(),nt=this.options.maxMessageSize;$&&!$.sendAttempted&&X($.message,q,nt)?($.merged||($.callback=L.default.create([$.callback]),$.merged=!0),$.callback.push(F)):this.queuedMessages.push(new m.PendingMessage(q,F))},it.prototype.sendQueuedMessages=function(){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var q;q=this.queuedMessages.shift();)this.sendImpl(q)},it.prototype.queuePendingMessages=function(q){q&&q.length&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+q.length+" pending messages"),this.queuedMessages.prepend(q))},it.prototype.failQueuedMessages=function(q){var F=this.queuedMessages.count();F>0&&(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+F+" queued messages, err = "+g.inspectError(q)),this.queuedMessages.completeAllMessages(q))},it.prototype.onChannelMessage=function(q,F){var $=this.activeProtocol&&F===this.activeProtocol.getTransport(),nt=g.arrIn(this.pendingTransports,F)&&this.state==this.states.synchronizing;$||nt?this.realtime.channels.onChannelMessage(q):g.arrIndexOf([U.ACK,U.NACK,U.ERROR],q.action)>-1?this.realtime.channels.onChannelMessage(q):v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(q)+"on defunct transport; discarding")},it.prototype.ping=function(q,F){var $=this;if(q){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+q);var nt=function(){q.off("heartbeat",jt),F(new G.default("Timeout waiting for heartbeat response",5e4,500))},ht=g.now(),Tt=g.cheapRandStr(),jt=function(pe){if(pe===Tt){q.off("heartbeat",jt),clearTimeout(Kt);var xe=g.now()-ht;F(null,xe)}},Kt=setTimeout(nt,this.options.timeouts.realtimeRequestTimeout);q.on("heartbeat",jt),q.ping(Tt);return}if(this.state.state!=="connected"){F(new G.default("Unable to ping service; not connected",4e4,400));return}var Wt=!1,ge=function(pe,xe){$.off("transport.active",Pt),Wt||(Wt=!0,F(pe,xe))},Pt=function(){Wt||(Wt=!0,C.default.Config.nextTick(function(){$.ping(null,F)}))};this.on("transport.active",Pt),this.ping(this.activeProtocol.getTransport(),ge)},it.prototype.abort=function(q){this.activeProtocol.getTransport().fail(q)},it.prototype.registerProposedTransport=function(q){this.proposedTransports.push(q)},it.prototype.getTransportPreference=function(){var q,F;return this.transportPreference||y()&&((F=(q=C.default.WebStorage)===null||q===void 0?void 0:q.get)===null||F===void 0?void 0:F.call(q,K))},it.prototype.persistTransportPreference=function(q){var F,$;g.arrIn(_.default.upgradeTransports,q.shortName)&&(this.transportPreference=q.shortName,y()&&(($=(F=C.default.WebStorage)===null||F===void 0?void 0:F.set)===null||$===void 0||$.call(F,K,q.shortName)))},it.prototype.unpersistTransportPreference=function(){var q,F;this.transportPreference=null,y()&&((F=(q=C.default.WebStorage)===null||q===void 0?void 0:q.remove)===null||F===void 0||F.call(q,K))},it.prototype.actOnErrorFromAuthorize=function(q){if(q.code===40171)this.notifyState({state:"failed",error:q});else if(q.code===40102)this.notifyState({state:"failed",error:q});else if(q.statusCode===O.default.Forbidden){var F="Client configured authentication provider returned 403; failing the connection";v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",F),this.notifyState({state:"failed",error:new G.default(F,80019,403,q)})}else{var F="Client configured authentication provider request failed";v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",F),this.notifyState({state:this.state.failState,error:new G.default(F,80019,401,q)})}},it.prototype.onConnectionDetailsUpdate=function(q,F){if(q){this.connectionDetails=q,q.maxMessageSize&&(this.options.maxMessageSize=q.maxMessageSize);var $=q.clientId;if($){var nt=this.realtime.auth._uncheckedSetClientId($);if(nt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",nt.message),F.fail(nt);return}}var ht=q.connectionStateTtl;ht&&(this.connectionStateTtl=ht),this.maxIdleInterval=q.maxIdleInterval,this.emit("connectiondetails",q)}},it.supportedTransports={},it})(E.default);i.default=J}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(7)),d=l.__importDefault(r(2)),g=(function(m){l.__extends(_,m);function _(){var C=m.call(this)||this;return C.messages=[],C}return _.prototype.count=function(){return this.messages.length},_.prototype.push=function(C){this.messages.push(C)},_.prototype.shift=function(){return this.messages.shift()},_.prototype.last=function(){return this.messages[this.messages.length-1]},_.prototype.copyAll=function(){return this.messages.slice()},_.prototype.append=function(C){this.messages.push.apply(this.messages,C)},_.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},_.prototype.completeMessages=function(C,E,R){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+E),R=R||null;var v=this.messages;if(v.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var D=v[0];if(D){var z=D.message.msgSerial,G=C+E;if(G>z)for(var N=v.splice(0,G-z),M=0,L=N;M<L.length;M++){var w=L[M];w.callback(R)}v.length==0&&this.emit("idle")}},_.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},_.prototype.resetSendAttempted=function(){for(var C=0,E=this.messages;C<E.length;C++){var R=E[C];R.sendAttempted=!1}},_.prototype.clear=function(){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},_})(f.default);i.default=g}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function f(d,g,m,_){this.previous=d,this.current=g,m&&(this.retryIn=m),_&&(this.reason=_)}return f})();i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(10)),d=l.__importDefault(r(7)),g=l.__importStar(r(1)),m=l.__importDefault(r(33)),_=l.__importDefault(r(2)),C=l.__importDefault(r(54)),E=l.__importDefault(r(9)),R=l.__importDefault(r(39)),v=l.__importStar(r(4)),D=l.__importDefault(r(16)),z=l.__importDefault(r(21)),G=f.default.Action,N=function(){};function M(A){if(A&&"params"in A&&!g.isObject(A.params))return new v.default("options.params must be an object",4e4,400);if(A&&"modes"in A){if(!g.isArray(A.modes))return new v.default("options.modes must be an array",4e4,400);for(var O=0;O<A.modes.length;O++){var y=A.modes[O];if(!y||typeof y!="string"||!g.arrIn(f.default.channelModes,String.prototype.toUpperCase.call(y)))return new v.default("Invalid channel mode: "+y,4e4,400)}}}var L=(function(A){l.__extends(O,A);function O(y,B,U){var P=A.call(this,y,B,U)||this;return P.retryCount=0,P.history=function(K,Y){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),Y===void 0)if(typeof K=="function")Y=K,K=null;else{if(this.rest.options.promises)return g.promisify(this,"history",arguments);Y=N}if(K&&K.untilAttach){if(this.state!=="attached"){Y(new v.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){Y(new v.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete K.untilAttach,K.from_serial=this.properties.attachSerial}m.default.prototype._history.call(this,K,Y)},P.whenState=(function(K,Y){return d.default.prototype.whenState.call(P,K,P.state,Y)}),_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel()","started; name = "+B),P.realtime=y,P.presence=new C.default(P),P.connectionManager=y.connection.connectionManager,P.state="initialized",P.subscriptions=new d.default,P.syncChannelSerial=void 0,P.properties={attachSerial:void 0,channelSerial:void 0},P.setOptions(U),P.errorReason=null,P._requestedFlags=null,P._mode=null,P._attachResume=!1,P._decodingContext={channelOptions:P.channelOptions,plugins:y.options.plugins||{},baseEncodedPreviousPayload:void 0},P._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},P._allChannelChanges=new d.default,P}return O.prototype.invalidStateError=function(){return new v.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},O.processListenerArgs=function(y){return y=Array.prototype.slice.call(y),typeof y[0]=="function"&&y.unshift(null),y[y.length-1]==null&&y.pop(),y},O.prototype.setOptions=function(y,B){var U=this.channelOptions;if(!B&&this.rest.options.promises)return g.promisify(this,"setOptions",arguments);var P=B||function(Y){Y&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+Y.toString())},K=M(y);if(K){P(K);return}m.default.prototype.setOptions.call(this,y),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(y,U)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(Y){switch(this.event){case"update":case"attached":P==null||P(null);return;default:P==null||P(Y.reason);return}})):P()},O.prototype._shouldReattachToSetOptions=function(y,B){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(y!=null&&y.params){var U=w(y.params),P=w(B.params);if(Object.keys(U).length!==Object.keys(P).length||!g.shallowEquals(P,U))return!0}return!!(y!=null&&y.modes&&(!B.modes||!g.arrEquals(y.modes,B.modes)))},O.prototype.publish=function(){for(var y=this,B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];var P=B[0],K=B.length,Y=B[K-1];if(typeof Y!="function"){if(this.realtime.options.promises)return g.promisify(this,"publish",arguments);Y=N,++K}if(!this.connectionManager.activeState()){Y(this.connectionManager.getError());return}if(K==2)if(g.isObject(P))P=[E.default.fromValues(P)];else if(g.isArray(P))P=E.default.fromValuesArray(P);else throw new v.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else P=[E.default.fromValues({name:B[0],data:B[1]})];var Q=this.realtime.options.maxMessageSize;E.default.encodeArray(P,this.channelOptions,function(V){if(V){Y(V);return}var j=E.default.getMessagesSize(P);if(j>Q){Y(new v.default("Maximum size of messages that can be published at once exceeded ( was "+j+" bytes; limit is "+Q+" bytes)",40009,400));return}y.__publish(P,Y)})},O.prototype.__publish=function(y,B){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+y.length);var U=this.state;switch(U){case"failed":case"suspended":B(v.default.fromValues(this.invalidStateError()));break;default:{_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+U);var P=new f.default;P.action=G.MESSAGE,P.channel=this.name,P.messages=y,this.sendMessage(P,B);break}}},O.prototype.onEvent=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var B=this.subscriptions,U=0;U<y.length;U++){var P=y[U];B.emit(P.name,P)}},O.prototype.attach=function(y,B){var U;if(typeof y=="function"?(B=y,U=null):U=y,!B){if(this.realtime.options.promises)return g.promisify(this,"attach",arguments);B=function(P){P&&_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+P.toString())}}if(U)_.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=U;else if(this.state==="attached"){B(null,null);return}this._attach(!1,null,B)},O.prototype._attach=function(y,B,U){U||(U=function(K){K&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+K.toString())});var P=this.connectionManager;if(!P.activeState()){U(P.getError());return}(this.state!=="attaching"||y)&&this.requestState("attaching",B),this.once(function(K){switch(this.event){case"attached":U==null||U(null,K);break;case"detached":case"suspended":case"failed":U==null||U(K.reason||P.getError()||new v.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":U==null||U(new v.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},O.prototype.attachImpl=function(){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var y=f.default.fromValues({action:G.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?y.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&y.encodeModesToFlags(g.allToUpperCase(this.channelOptions.modes)),this._attachResume&&y.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(y.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(y,N)},O.prototype.detach=function(y){if(!y){if(this.realtime.options.promises)return g.promisify(this,"detach",arguments);y=N}var B=this.connectionManager;if(!B.activeState()){y(B.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),y();break;case"detached":y();break;case"failed":y(new v.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(U){switch(this.event){case"detached":y();break;case"attached":case"suspended":case"failed":y(U.reason||B.getError()||new v.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":y(new v.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},O.prototype.detachImpl=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var B=f.default.fromValues({action:G.DETACH,channel:this.name});this.sendMessage(B,y||N)},O.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=O.processListenerArgs(y),P=U[0],K=U[1],Y=U[2];if(!Y&&this.realtime.options.promises)return g.promisify(this,"subscribe",[P,K]);if(this.state==="failed"){Y==null||Y(v.default.fromValues(this.invalidStateError()));return}return P&&typeof P=="object"&&!Array.isArray(P)?this._subscribeFilter(P,K):this.subscriptions.on(P,K),this.attach(Y||N)},O.prototype._subscribeFilter=function(y,B){var U=function(P){var K,Y,Q,V,j,I,X={name:P.name,refTimeserial:(Y=(K=P.extras)===null||K===void 0?void 0:K.ref)===null||Y===void 0?void 0:Y.timeserial,refType:(V=(Q=P.extras)===null||Q===void 0?void 0:Q.ref)===null||V===void 0?void 0:V.type,isRef:!!(!((I=(j=P.extras)===null||j===void 0?void 0:j.ref)===null||I===void 0)&&I.timeserial),clientId:P.clientId};Object.entries(y).find(function(Z){var at=Z[0],J=Z[1];return J!==void 0?X[at]!==J:!1})||B(P)};this._addFilteredSubscription(y,B,U),this.subscriptions.on(U)},O.prototype._addFilteredSubscription=function(y,B,U){var P;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(B)){var K=this.filteredSubscriptions.get(B);K.set(y,((P=K==null?void 0:K.get(y))===null||P===void 0?void 0:P.concat(U))||[U])}else this.filteredSubscriptions.set(B,new Map([[y,[U]]]))},O.prototype._getAndDeleteFilteredSubscriptions=function(y,B){var U=this;if(!this.filteredSubscriptions)return[];if(!B&&y)return Array.from(this.filteredSubscriptions.entries()).map(function(Q){var V,j=Q[0],I=Q[1],X=I.get(y);return I.delete(y),I.size===0&&((V=U.filteredSubscriptions)===null||V===void 0||V.delete(j)),X}).reduce(function(Q,V){var j;return V?(j=Q).concat.apply(j,V):Q},[]);if(!B||!this.filteredSubscriptions.has(B))return[];var P=this.filteredSubscriptions.get(B);if(!y){var K=Array.from(P.values()).reduce(function(Q,V){return Q.concat.apply(Q,V)},[]);return this.filteredSubscriptions.delete(B),K}var Y=P.get(y);return P.delete(y),Y||[]},O.prototype.unsubscribe=function(){for(var y=this,B,U=[],P=0;P<arguments.length;P++)U[P]=arguments[P];var K=O.processListenerArgs(U),Y=K[0],Q=K[1];if(typeof Y=="object"&&!Q||!((B=this.filteredSubscriptions)===null||B===void 0)&&B.has(Q)){this._getAndDeleteFilteredSubscriptions(Y,Q).forEach(function(V){return y.subscriptions.off(V)});return}this.subscriptions.off(Y,Q)},O.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new v.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var y=this.connectionManager;if(!y.activeState())throw y.getError();var B=f.default.fromValues({action:G.SYNC,channel:this.name});this.syncChannelSerial&&(B.channelSerial=this.syncChannelSerial),y.send(B)},O.prototype.sendMessage=function(y,B){this.connectionManager.send(y,this.realtime.options.queueMessages,B)},O.prototype.sendPresence=function(y,B){var U=f.default.fromValues({action:G.PRESENCE,channel:this.name,presence:g.isArray(y)?D.default.fromValuesArray(y):[D.default.fromValues(y)]});this.sendMessage(U,B)},O.prototype.onMessage=function(y){(y.action===G.ATTACHED||y.action===G.MESSAGE||y.action===G.PRESENCE)&&this.setChannelSerial(y.channelSerial);var B,U=!1;switch(y.action){case G.ATTACHED:{this.properties.attachSerial=y.channelSerial,this._mode=y.getMode(),this.params=y.params||{};var P=y.decodeModesFromFlags();this.modes=P&&g.allToLowerCase(P)||void 0;var K=y.hasFlag("RESUMED"),Y=y.hasFlag("HAS_PRESENCE"),Q=y.hasFlag("HAS_BACKLOG");if(this.state==="attached"){K||this.presence.onAttached(Y);var V=new R.default(this.state,this.state,K,Q,y.error);this._allChannelChanges.emit("update",V),(!K||this.channelOptions.updateOnAttached)&&this.emit("update",V)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",y.error,K,Y,Q);break}case G.DETACHED:{var j=y.error?v.default.fromValues(y.error):new v.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",j):this.state==="attaching"?this.notifyState("suspended",j):this.requestState("attaching",j);break}case G.SYNC:if(U=!0,B=this.syncChannelSerial=y.channelSerial,!y.presence)break;case G.PRESENCE:{for(var I=y.presence,X=y.id,Z=y.connectionId,at=y.timestamp,J=this.channelOptions,rt=void 0,it=0;it<I.length;it++)try{rt=I[it],D.default.decode(rt,J),rt.connectionId||(rt.connectionId=Z),rt.timestamp||(rt.timestamp=at),rt.id||(rt.id=X+":"+it)}catch(Tt){_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",Tt.toString())}this.presence.setPresence(I,U,B);break}case G.MESSAGE:{if(this.state!=="attached"){_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+y.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var q=y.messages,F=q[0],$=q[q.length-1],X=y.id,Z=y.connectionId,at=y.timestamp;if(F.extras&&F.extras.delta&&F.extras.delta.from!==this._lastPayload.messageId){var nt='Delta message decode failure - previous message not available for message "'+y.id+'" on this channel "'+this.name+'".';_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",nt),this._startDecodeFailureRecovery(new v.default(nt,40018,400));break}for(var it=0;it<q.length;it++){var nt=q[it];try{E.default.decode(nt,this._decodingContext)}catch(Pt){switch(_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",Pt.toString()),Pt.code){case 40018:this._startDecodeFailureRecovery(Pt);return;case 40019:case 40021:this.notifyState("failed",Pt);return}}nt.connectionId||(nt.connectionId=Z),nt.timestamp||(nt.timestamp=at),nt.id||(nt.id=X+":"+it)}this._lastPayload.messageId=$.id,this._lastPayload.protocolMessageChannelSerial=y.channelSerial,this.onEvent(q);break}case G.ERROR:{var ht=y.error;ht&&ht.code==80016?this.checkPendingState():this.notifyState("failed",v.default.fromValues(ht));break}default:_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+y.action+")"),this.connectionManager.abort(z.default.unknownChannelErr())}},O.prototype._startDecodeFailureRecovery=function(y){var B=this;this._lastPayload.decodeFailureRecoveryInProgress||(_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,y,function(){B._lastPayload.decodeFailureRecoveryInProgress=!1}))},O.prototype.onAttached=function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},O.prototype.notifyState=function(y,B,U,P,K){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+y),this.clearStateTimer(),g.arrIn(["detached","suspended","failed"],y)&&(this.properties.channelSerial=null),y!==this.state){this.presence.actOnChannelState(y,P,B),y==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),B&&(this.errorReason=B);var Y=new R.default(this.state,y,U,K,B),Q=y==="failed"?_.default.LOG_ERROR:_.default.LOG_MAJOR;_.default.logAction(Q,'Channel state for channel "'+this.name+'"',y+(B?"; reason: "+B:"")),y!=="attaching"&&y!=="suspended"&&(this.retryCount=0),y==="attached"&&this.onAttached(),y==="attached"?this._attachResume=!0:(y==="detaching"||y==="failed")&&(this._attachResume=!1),this.state=y,this._allChannelChanges.emit(y,Y),this.emit(y,Y)}},O.prototype.requestState=function(y,B){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+y),this.notifyState(y,B),this.checkPendingState()},O.prototype.checkPendingState=function(){var y=this.connectionManager.state;if(!(y.sendEvents||y.forceQueueEvents)){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},O.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var y=new v.default("Channel attach timed out",90007,408);this.notifyState("suspended",y);break}case"detaching":{var y=new v.default("Channel detach timed out",90007,408);this.notifyState("attached",y);break}default:this.checkPendingState();break}},O.prototype.startStateTimerIfNotRunning=function(){var y=this;this.stateTimer||(this.stateTimer=setTimeout(function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),y.stateTimer=null,y.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},O.prototype.clearStateTimer=function(){var y=this.stateTimer;y&&(clearTimeout(y),this.stateTimer=null)},O.prototype.startRetryTimer=function(){var y=this;if(!this.retryTimer){this.retryCount++;var B=g.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){y.state==="suspended"&&y.connectionManager.state.sendEvents&&(y.retryTimer=null,_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),y.requestState("attaching"))},B)}},O.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},O.prototype.getReleaseErr=function(){var y=this.state;return y==="initialized"||y==="detached"||y==="failed"?null:new v.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+y,90001,400)},O.prototype.setChannelSerial=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+y+"; previous = "+this.properties.channelSerial),y&&(this.properties.channelSerial=y)},O})(m.default);function w(A){var O=A||{};O.agent;var y=l.__rest(O,["agent"]);return y}i.default=L}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function f(d,g,m,_,C){this.previous=d,this.current=g,g==="attached"&&(this.resumed=m,this.hasBacklog=_),C&&(this.reason=C)}return f})();i.default=l}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=d.Hasher,_=f.algo,C=[],E=_.SHA1=m.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(R,v){for(var D=this._hash.words,z=D[0],G=D[1],N=D[2],M=D[3],L=D[4],w=0;w<80;w++){if(w<16)C[w]=R[v+w]|0;else{var A=C[w-3]^C[w-8]^C[w-14]^C[w-16];C[w]=A<<1|A>>>31}var O=(z<<5|z>>>27)+L+C[w];w<20?O+=(G&N|~G&M)+1518500249:w<40?O+=(G^N^M)+1859775393:w<60?O+=(G&N|G&M|N&M)-1894007588:O+=(G^N^M)-899497514,L=M,M=N,N=G<<30|G>>>2,G=z,z=O}D[0]=D[0]+z|0,D[1]=D[1]+G|0,D[2]=D[2]+N|0,D[3]=D[3]+M|0,D[4]=D[4]+L|0},_doFinalize:function(){var R=this._data,v=R.words,D=this._nDataBytes*8,z=R.sigBytes*8;return v[z>>>5]|=128<<24-z%32,v[(z+64>>>9<<4)+14]=Math.floor(D/4294967296),v[(z+64>>>9<<4)+15]=D,R.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var R=m.clone.call(this);return R._hash=this._hash.clone(),R}});f.SHA1=m._createHelper(E),f.HmacSHA1=m._createHmacHelper(E)})(),l.SHA1})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});function l(w){if(w===void 0)return"undefined";var A,O;if(w instanceof ArrayBuffer?(O="ArrayBuffer",A=new DataView(w)):w instanceof DataView&&(O="DataView",A=w),!A)return JSON.stringify(w);for(var y=[],B=0;B<w.byteLength;B++){if(B>20){y.push("...");break}var U=A.getUint8(B).toString(16);U.length===1&&(U="0"+U),y.push(U)}return"<"+O+" "+y.join(" ")+">"}function f(w,A,O){for(var y=0,B=O.length;y<B;y++){var U=O.charCodeAt(y);if(U<128){w.setUint8(A++,U>>>0&127|0);continue}if(U<2048){w.setUint8(A++,U>>>6&31|192),w.setUint8(A++,U>>>0&63|128);continue}if(U<65536){w.setUint8(A++,U>>>12&15|224),w.setUint8(A++,U>>>6&63|128),w.setUint8(A++,U>>>0&63|128);continue}if(U<1114112){w.setUint8(A++,U>>>18&7|240),w.setUint8(A++,U>>>12&63|128),w.setUint8(A++,U>>>6&63|128),w.setUint8(A++,U>>>0&63|128);continue}throw new Error("bad codepoint "+U)}}function d(w,A,O){for(var y="",B=A,U=A+O;B<U;B++){var P=w.getUint8(B);if((P&128)===0){y+=String.fromCharCode(P);continue}if((P&224)===192){y+=String.fromCharCode((P&15)<<6|w.getUint8(++B)&63);continue}if((P&240)===224){y+=String.fromCharCode((P&15)<<12|(w.getUint8(++B)&63)<<6|(w.getUint8(++B)&63)<<0);continue}if((P&248)===240){y+=String.fromCharCode((P&7)<<18|(w.getUint8(++B)&63)<<12|(w.getUint8(++B)&63)<<6|(w.getUint8(++B)&63)<<0);continue}throw new Error("Invalid byte "+P.toString(16))}return y}function g(w){for(var A=0,O=0,y=w.length;O<y;O++){var B=w.charCodeAt(O);if(B<128){A+=1;continue}if(B<2048){A+=2;continue}if(B<65536){A+=3;continue}if(B<1114112){A+=4;continue}throw new Error("bad codepoint "+B)}return A}function m(w,A){var O=L(w,A);if(O!==0){var y=new ArrayBuffer(O),B=new DataView(y);return M(w,B,0,A),y}}var _=65536*65536,C=1/_;function E(w,A){return A=A||0,w.getInt32(A)*_+w.getUint32(A+4)}function R(w,A){return A=A||0,w.getUint32(A)*_+w.getUint32(A+4)}function v(w,A,O){O<9223372036854776e3?(w.setInt32(A,Math.floor(O*C)),w.setInt32(A+4,O&-1)):(w.setUint32(A,2147483647),w.setUint32(A+4,2147483647))}function D(w,A,O){O<18446744073709552e3?(w.setUint32(A,Math.floor(O*C)),w.setInt32(A+4,O&-1)):(w.setUint32(A,4294967295),w.setUint32(A+4,4294967295))}var z=(function(){function w(A,O){var y=this;this.map=function(B){for(var U={},P=0;P<B;P++){var K=y.parse();U[K]=y.parse()}return U},this.bin=function(B){var U=new ArrayBuffer(B);return new Uint8Array(U).set(new Uint8Array(y.view.buffer,y.offset,B),0),y.offset+=B,U},this.buf=this.bin,this.str=function(B){var U=d(y.view,y.offset,B);return y.offset+=B,U},this.array=function(B){for(var U=new Array(B),P=0;P<B;P++)U[P]=y.parse();return U},this.ext=function(B){return y.offset+=B,{type:y.view.getInt8(y.offset),data:y.buf(B)}},this.parse=function(){var B=y.view.getUint8(y.offset),U,P;if((B&128)===0)return y.offset++,B;if((B&240)===128)return P=B&15,y.offset++,y.map(P);if((B&240)===144)return P=B&15,y.offset++,y.array(P);if((B&224)===160)return P=B&31,y.offset++,y.str(P);if((B&224)===224)return U=y.view.getInt8(y.offset),y.offset++,U;switch(B){case 192:return y.offset++,null;case 193:y.offset++;return;case 194:return y.offset++,!1;case 195:return y.offset++,!0;case 196:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.bin(P);case 197:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.bin(P);case 198:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.bin(P);case 199:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.ext(P);case 200:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.ext(P);case 201:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.ext(P);case 202:return U=y.view.getFloat32(y.offset+1),y.offset+=5,U;case 203:return U=y.view.getFloat64(y.offset+1),y.offset+=9,U;case 204:return U=y.view.getUint8(y.offset+1),y.offset+=2,U;case 205:return U=y.view.getUint16(y.offset+1),y.offset+=3,U;case 206:return U=y.view.getUint32(y.offset+1),y.offset+=5,U;case 207:return U=R(y.view,y.offset+1),y.offset+=9,U;case 208:return U=y.view.getInt8(y.offset+1),y.offset+=2,U;case 209:return U=y.view.getInt16(y.offset+1),y.offset+=3,U;case 210:return U=y.view.getInt32(y.offset+1),y.offset+=5,U;case 211:return U=E(y.view,y.offset+1),y.offset+=9,U;case 212:return P=1,y.offset++,y.ext(P);case 213:return P=2,y.offset++,y.ext(P);case 214:return P=4,y.offset++,y.ext(P);case 215:return P=8,y.offset++,y.ext(P);case 216:return P=16,y.offset++,y.ext(P);case 217:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.str(P);case 218:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.str(P);case 219:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.str(P);case 220:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.array(P);case 221:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.array(P);case 222:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.map(P);case 223:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.map(P)}throw new Error("Unknown type 0x"+B.toString(16))},this.offset=O||0,this.view=A}return w})();function G(w){var A=new DataView(w),O=new z(A),y=O.parse();if(O.offset!==w.byteLength)throw new Error(w.byteLength-O.offset+" trailing bytes");return y}function N(w,A){return Object.keys(w).filter(function(O){var y=w[O],B=typeof y;return(!A||y!=null)&&(B!=="function"||!!y.toJSON)})}function M(w,A,O,y){var B=typeof w;if(typeof w=="string"){var U=g(w);if(U<32)return A.setUint8(O,U|160),f(A,O+1,w),1+U;if(U<256)return A.setUint8(O,217),A.setUint8(O+1,U),f(A,O+2,w),2+U;if(U<65536)return A.setUint8(O,218),A.setUint16(O+1,U),f(A,O+3,w),3+U;if(U<4294967296)return A.setUint8(O,219),A.setUint32(O+1,U),f(A,O+5,w),5+U}if(ArrayBuffer.isView&&ArrayBuffer.isView(w)&&(w=w.buffer),w instanceof ArrayBuffer){var P=w.byteLength;if(P<256)return A.setUint8(O,196),A.setUint8(O+1,P),new Uint8Array(A.buffer).set(new Uint8Array(w),O+2),2+P;if(P<65536)return A.setUint8(O,197),A.setUint16(O+1,P),new Uint8Array(A.buffer).set(new Uint8Array(w),O+3),3+P;if(P<4294967296)return A.setUint8(O,198),A.setUint32(O+1,P),new Uint8Array(A.buffer).set(new Uint8Array(w),O+5),5+P}if(typeof w=="number"){if(Math.floor(w)!==w)return A.setUint8(O,203),A.setFloat64(O+1,w),9;if(w>=0){if(w<128)return A.setUint8(O,w),1;if(w<256)return A.setUint8(O,204),A.setUint8(O+1,w),2;if(w<65536)return A.setUint8(O,205),A.setUint16(O+1,w),3;if(w<4294967296)return A.setUint8(O,206),A.setUint32(O+1,w),5;if(w<18446744073709552e3)return A.setUint8(O,207),D(A,O+1,w),9;throw new Error("Number too big 0x"+w.toString(16))}if(w>=-32)return A.setInt8(O,w),1;if(w>=-128)return A.setUint8(O,208),A.setInt8(O+1,w),2;if(w>=-32768)return A.setUint8(O,209),A.setInt16(O+1,w),3;if(w>=-2147483648)return A.setUint8(O,210),A.setInt32(O+1,w),5;if(w>=-9223372036854776e3)return A.setUint8(O,211),v(A,O+1,w),9;throw new Error("Number too small -0x"+(-w).toString(16).substr(1))}if(B==="undefined")return y?0:(A.setUint8(O,212),A.setUint8(O+1,0),A.setUint8(O+2,0),3);if(w===null)return y?0:(A.setUint8(O,192),1);if(B==="boolean")return A.setUint8(O,w?195:194),1;if(typeof w.toJSON=="function")return M(w.toJSON(),A,O,y);if(B==="object"){var K,Y=0,Q=void 0,V=Array.isArray(w);if(V?K=w.length:(Q=N(w,y),K=Q.length),K<16?(A.setUint8(O,K|(V?144:128)),Y=1):K<65536?(A.setUint8(O,V?220:222),A.setUint16(O+1,K),Y=3):K<4294967296&&(A.setUint8(O,V?221:223),A.setUint32(O+1,K),Y=5),V)for(var j=0;j<K;j++)Y+=M(w[j],A,O+Y,y);else if(Q)for(var j=0;j<K;j++){var I=Q[j];Y+=M(I,A,O+Y),Y+=M(w[I],A,O+Y,y)}return Y}if(B==="function")return 0;throw new Error("Unknown type "+B)}function L(w,A){var O=typeof w;if(O==="string"){var y=g(w);if(y<32)return 1+y;if(y<256)return 2+y;if(y<65536)return 3+y;if(y<4294967296)return 5+y}if(ArrayBuffer.isView&&ArrayBuffer.isView(w)&&(w=w.buffer),w instanceof ArrayBuffer){var B=w.byteLength;if(B<256)return 2+B;if(B<65536)return 3+B;if(B<4294967296)return 5+B}if(typeof w=="number"){if(Math.floor(w)!==w)return 9;if(w>=0){if(w<128)return 1;if(w<256)return 2;if(w<65536)return 3;if(w<4294967296)return 5;if(w<18446744073709552e3)return 9;throw new Error("Number too big 0x"+w.toString(16))}if(w>=-32)return 1;if(w>=-128)return 2;if(w>=-32768)return 3;if(w>=-2147483648)return 5;if(w>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+w.toString(16).substr(1))}if(O==="boolean")return 1;if(w===null)return A?0:1;if(w===void 0)return A?0:3;if(typeof w.toJSON=="function")return L(w.toJSON(),A);if(O==="object"){var U,P=0;if(Array.isArray(w)){U=w.length;for(var K=0;K<U;K++)P+=L(w[K],A)}else{var Y=N(w,A);U=Y.length;for(var K=0;K<U;K++){var Q=Y[K];P+=L(Q)+L(w[Q],A)}}if(U<16)return 1+P;if(U<65536)return 3+P;if(U<4294967296)return 5+P;throw new Error("Array or object too long 0x"+U.toString(16))}if(O==="function")return 0;throw new Error("Unknown type "+O)}i.default={encode:m,decode:G,inspect:l,utf8Write:f,utf8Read:d,utf8ByteCount:g}}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(30)),d=l.__importDefault(r(50)),g=l.__importDefault(r(3)),m=l.__importDefault(r(4)),_=l.__importDefault(r(55)),C=l.__importDefault(r(57)),E=l.__importDefault(r(62)),R=l.__importDefault(r(64)),v=l.__importDefault(r(68)),D=l.__importDefault(r(2)),z=r(8),G=l.__importDefault(r(65)),N=l.__importDefault(r(66)),M=l.__importDefault(r(41)),L=(0,C.default)(R.default,_.default);g.default.Crypto=L,g.default.BufferUtils=_.default,g.default.Http=E.default,g.default.Config=R.default,g.default.Transports=v.default,g.default.WebStorage=G.default,f.default.Crypto=L,d.default.Crypto=L,D.default.initLogHandlers(),g.default.Defaults=(0,z.getDefaults)(N.default),g.default.Config.agent&&(g.default.Defaults.agent+=" "+g.default.Config.agent),g.default.Config.noUpgrade&&(g.default.Defaults.upgradeTransports=[]),i.default={ErrorInfo:m.default,Rest:f.default,Realtime:d.default,msgpack:M.default}}),(function(n){n.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')}),(function(n,i){}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(32),r(25))})(this,function(l){return l.HmacSHA256})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(47)),g=l.__importDefault(r(15)),m=l.__importDefault(r(20)),_=l.__importDefault(r(4)),C=l.__importDefault(r(48)),E=function(){},R=(function(){function G(N){this.rest=N,this.admin=new v(N)}return G})(),v=(function(){function G(N){this.rest=N,this.deviceRegistrations=new D(N),this.channelSubscriptions=new z(N)}return G.prototype.publish=function(N,M,L){var w=this.rest,A=w.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=f.defaultPostHeaders(w.options,A),y={},B=f.mixin({recipient:N},M);if(typeof L!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);L=E}w.options.headers&&f.mixin(O,w.options.headers),w.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var U=f.encodeBody(B,A);g.default.post(w,"/push/publish",U,O,y,null,function(P){return L(P)})},G})(),D=(function(){function G(N){this.rest=N}return G.prototype.save=function(N,M){var L=this.rest,w=d.default.fromValues(N),A=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=f.defaultPostHeaders(L.options,A),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}L.options.headers&&f.mixin(O,L.options.headers),L.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var B=f.encodeBody(w,A);g.default.put(L,"/push/deviceRegistrations/"+encodeURIComponent(N.id),B,O,y,null,function(U,P,K,Y){M(U,U?void 0:d.default.fromResponseBody(P,Y?void 0:A))})},G.prototype.get=function(N,M){var L=this.rest,w=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(L.options,w),O=N.id||N;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"get",arguments);M=E}if(typeof O!="string"||!O.length){M(new _.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}L.options.headers&&f.mixin(A,L.options.headers),g.default.get(L,"/push/deviceRegistrations/"+encodeURIComponent(O),A,{},null,function(y,B,U,P){M(y,y?void 0:d.default.fromResponseBody(B,P?void 0:w))})},G.prototype.list=function(N,M){var L=this.rest,w=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:w,O=f.defaultGetHeaders(L.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}L.options.headers&&f.mixin(O,L.options.headers),new m.default(L,"/push/deviceRegistrations",O,A,function(y,B,U){return d.default.fromResponseBody(y,U?void 0:w)}).get(N,M)},G.prototype.remove=function(N,M){var L=this.rest,w=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(L.options,w),O={},y=N.id||N;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"remove",arguments);M=E}if(typeof y!="string"||!y.length){M(new _.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}L.options.headers&&f.mixin(A,L.options.headers),L.options.pushFullWait&&f.mixin(O,{fullWait:"true"}),g.default.delete(L,"/push/deviceRegistrations/"+encodeURIComponent(y),A,O,null,function(B){return M(B)})},G.prototype.removeWhere=function(N,M){var L=this.rest,w=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(L.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}L.options.headers&&f.mixin(A,L.options.headers),L.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),g.default.delete(L,"/push/deviceRegistrations",A,N,null,function(O){return M(O)})},G})(),z=(function(){function G(N){this.remove=G.prototype.removeWhere,this.rest=N}return G.prototype.save=function(N,M){var L=this.rest,w=C.default.fromValues(N),A=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=f.defaultPostHeaders(L.options,A),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}L.options.headers&&f.mixin(O,L.options.headers),L.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var B=f.encodeBody(w,A);g.default.post(L,"/push/channelSubscriptions",B,O,y,null,function(U,P,K,Y){M(U,!U&&C.default.fromResponseBody(P,Y?void 0:A))})},G.prototype.list=function(N,M){var L=this.rest,w=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:w,O=f.defaultGetHeaders(L.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}L.options.headers&&f.mixin(O,L.options.headers),new m.default(L,"/push/channelSubscriptions",O,A,function(y,B,U){return C.default.fromResponseBody(y,U?void 0:w)}).get(N,M)},G.prototype.removeWhere=function(N,M){var L=this.rest,w=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultGetHeaders(L.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}L.options.headers&&f.mixin(A,L.options.headers),L.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),g.default.delete(L,"/push/channelSubscriptions",A,N,null,function(O){return M(O)})},G.prototype.listChannels=function(N,M){var L=this.rest,w=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:w,O=f.defaultGetHeaders(L.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"listChannels",arguments);M=E}L.options.headers&&f.mixin(O,L.options.headers),L.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),new m.default(L,"/push/channels",O,A,function(y,B,U){for(var P=!U&&w?f.decodeBody(y,w):y,K=0;K<P.length;K++)P[K]=String(P[K]);return P}).get(N,M)},G})();i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(4)),g;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(g||(g={}));var m;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(m||(m={}));var _=(function(){function C(){}return C.prototype.toJSON=function(){var E,R,v;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(R=this.push)===null||R===void 0?void 0:R.state,error:(v=this.push)===null||v===void 0?void 0:v.error}}},C.prototype.toString=function(){var E,R,v,D,z="[DeviceDetails";return this.id&&(z+="; id="+this.id),this.platform&&(z+="; platform="+this.platform),this.formFactor&&(z+="; formFactor="+this.formFactor),this.clientId&&(z+="; clientId="+this.clientId),this.metadata&&(z+="; metadata="+this.metadata),this.deviceIdentityToken&&(z+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(z+="; push.recipient="+JSON.stringify(this.push.recipient)),!((R=this.push)===null||R===void 0)&&R.state&&(z+="; push.state="+this.push.state),!((v=this.push)===null||v===void 0)&&v.error&&(z+="; push.error="+JSON.stringify(this.push.error)),!((D=this.push)===null||D===void 0)&&D.metadata&&(z+="; push.metadata="+this.push.metadata),z+="]",z},C.fromResponseBody=function(E,R){return R&&(E=f.decodeBody(E,R)),f.isArray(E)?C.fromValuesArray(E):C.fromValues(E)},C.fromValues=function(E){return E.error=E.error&&d.default.fromValues(E.error),Object.assign(new C,E)},C.fromValuesArray=function(E){for(var R=E.length,v=new Array(R),D=0;D<R;D++)v[D]=C.fromValues(E[D]);return v},C.toRequestBody=f.encodeBody,C})();i.default=_}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=(function(){function g(){}return g.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},g.prototype.toString=function(){var m="[PushChannelSubscription";return this.channel&&(m+="; channel="+this.channel),this.deviceId&&(m+="; deviceId="+this.deviceId),this.clientId&&(m+="; clientId="+this.clientId),m+="]",m},g.fromResponseBody=function(m,_){return _&&(m=f.decodeBody(m,_)),f.isArray(m)?g.fromValuesArray(m):g.fromValues(m)},g.fromValues=function(m){return Object.assign(new g,m)},g.fromValuesArray=function(m){for(var _=m.length,C=new Array(_),E=0;E<_;E++)C[E]=g.fromValues(m[E]);return C},g.toRequestBody=f.encodeBody,g})();i.default=d}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=(function(){function L(w){this.count=w&&w.count||0,this.data=w&&w.data||0,this.uncompressedData=w&&w.uncompressedData||0,this.failed=w&&w.failed||0,this.refused=w&&w.refused||0}return L})(),g=(function(L){l.__extends(w,L);function w(A){var O=L.call(this,A)||this;return A&&A.category&&(O.category={},f.forInOwnNonNullProperties(A.category,function(y){O.category[y]=new d(A.category[y])})),O}return w})(d),m=(function(){function L(w){this.peak=w&&w.peak||0,this.min=w&&w.min||0,this.mean=w&&w.mean||0,this.opened=w&&w.opened||0,this.refused=w&&w.refused||0}return L})(),_=(function(){function L(w){this.succeeded=w&&w.succeeded||0,this.failed=w&&w.failed||0,this.refused=w&&w.refused||0}return L})(),C=(function(){function L(w){this.plain=new m(w&&w.plain),this.tls=new m(w&&w.tls),this.all=new m(w&&w.all)}return L})(),E=(function(){function L(w){this.messages=new g(w&&w.messages),this.presence=new g(w&&w.presence),this.all=new g(w&&w.all)}return L})(),R=(function(){function L(w){this.realtime=new E(w&&w.realtime),this.rest=new E(w&&w.rest),this.webhook=new E(w&&w.webhook),this.sharedQueue=new E(w&&w.sharedQueue),this.externalQueue=new E(w&&w.externalQueue),this.httpEvent=new E(w&&w.httpEvent),this.push=new E(w&&w.push),this.all=new E(w&&w.all)}return L})(),v=(function(){function L(w){this.all=new E(w&&w.all),this.inbound=new R(w&&w.inbound),this.outbound=new R(w&&w.outbound)}return L})(),D=(function(){function L(w){this.all=new E(w&&w.all),this.producerPaid=new v(w&&w.producerPaid),this.consumerPaid=new v(w&&w.consumerPaid)}return L})(),z=(function(){function L(w){this.messages=w&&w.messages||0;var A=w&&w.notifications;this.notifications={invalid:A&&A.invalid||0,attempted:A&&A.attempted||0,successful:A&&A.successful||0,failed:A&&A.failed||0},this.directPublishes=w&&w.directPublishes||0}return L})(),G=(function(){function L(w){this.succeeded=w&&w.succeeded||0,this.skipped=w&&w.skipped||0,this.failed=w&&w.failed||0}return L})(),N=(function(){function L(w){var A=this;this.delta=void 0,w&&w.delta&&(this.delta={},f.forInOwnNonNullProperties(w.delta,function(O){A.delta[O]=new G(w.delta[O])}))}return L})(),M=(function(L){l.__extends(w,L);function w(A){var O=L.call(this,A)||this;return O.persisted=new E(A&&A.persisted),O.connections=new C(A&&A.connections),O.channels=new m(A&&A.channels),O.apiRequests=new _(A&&A.apiRequests),O.tokenRequests=new _(A&&A.tokenRequests),O.xchgProducer=new D(A&&A.xchgProducer),O.xchgConsumer=new D(A&&A.xchgConsumer),O.push=new z(A&&A.pushStats),O.processed=new N(A&&A.processed),O.inProgress=A&&A.inProgress||void 0,O.unit=A&&A.unit||void 0,O.intervalId=A&&A.intervalId||void 0,O}return w.fromValues=function(A){return new w(A)},w})(v);i.default=M}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(30)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(51)),C=l.__importDefault(r(38)),E=l.__importDefault(r(8)),R=l.__importDefault(r(4)),v=l.__importDefault(r(10)),D=l.__importDefault(r(35)),z=l.__importDefault(r(3)),G=l.__importDefault(r(9)),N=(function(L){l.__extends(w,L);function w(A){var O=L.call(this,A)||this;return m.default.logAction(m.default.LOG_MINOR,"Realtime()",""),O.connection=new _.default(O,O.options),O.channels=new M(O),A.autoConnect!==!1&&O.connect(),O}return w.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},w.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},w.Promise=function(A){return A=E.default.objectifyOptions(A),A.promises=!0,new w(A)},w.Callbacks=w,w.Utils=f,w.ConnectionManager=D.default,w.Platform=z.default,w.ProtocolMessage=v.default,w.Message=G.default,w})(d.default),M=(function(L){l.__extends(w,L);function w(A){var O=L.call(this)||this;return O.realtime=A,O.all=Object.create(null),A.connection.connectionManager.on("transport.active",function(){O.onTransportActive()}),O}return w.prototype.channelSerials=function(){for(var A={},O=0,y=f.keysArray(this.all,!0);O<y.length;O++){var B=y[O],U=this.all[B];U.properties.channelSerial&&(A[B]=U.properties.channelSerial)}return A},w.prototype.recoverChannels=function(A){for(var O=0,y=f.keysArray(A,!0);O<y.length;O++){var B=y[O],U=this.get(B);U.properties.channelSerial=A[B]}},w.prototype.onChannelMessage=function(A){var O=A.channel;if(O===void 0){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+A.action);return}var y=this.all[O];if(!y){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+O);return}y.onMessage(A)},w.prototype.onTransportActive=function(){for(var A in this.all){var O=this.all[A];O.state==="attaching"||O.state==="detaching"?O.checkPendingState():O.state==="suspended"?O._attach(!1,null):O.state==="attached"&&O.requestState("attaching")}},w.prototype.propogateConnectionInterruption=function(A,O){var y={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},B=["attaching","attached","detaching","suspended"],U=y[A];for(var P in this.all){var K=this.all[P];f.arrIn(B,K.state)&&K.notifyState(U,O)}},w.prototype.get=function(A,O){A=String(A);var y=this.all[A];if(!y)y=this.all[A]=new C.default(this.realtime,A,O);else if(O){if(y._shouldReattachToSetOptions(O,y.channelOptions))throw new R.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);y.setOptions(O)}return y},w.prototype.getDerived=function(A,O,y){if(O.filter){var B=f.toBase64(O.filter),U=f.matchDerivedChannel(A);A="[filter=".concat(B).concat(U.qualifierParam,"]").concat(U.channelName)}return this.get(A,y)},w.prototype.release=function(A){A=String(A);var O=this.all[A];if(O){var y=O.getReleaseErr();if(y)throw y;delete this.all[A]}},w})(g.default);i.default=N}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(35)),m=l.__importDefault(r(2)),_=l.__importDefault(r(37)),C=l.__importDefault(r(3));function E(){}var R=(function(v){l.__extends(D,v);function D(z,G){var N=v.call(this)||this;return N.whenState=(function(M,L){return d.default.prototype.whenState.call(N,M,N.state,L,new _.default(void 0,M))}),N.ably=z,N.connectionManager=new g.default(z,G),N.state=N.connectionManager.state.state,N.key=void 0,N.id=void 0,N.errorReason=null,N.connectionManager.on("connectionstate",function(M){var L=N.state=M.current;C.default.Config.nextTick(function(){N.emit(L,M)})}),N.connectionManager.on("update",function(M){C.default.Config.nextTick(function(){N.emit("update",M)})}),N}return D.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},D.prototype.ping=function(z){if(m.default.logAction(m.default.LOG_MINOR,"Connection.ping()",""),!z){if(this.ably.options.promises)return f.promisify(this,"ping",arguments);z=E}this.connectionManager.ping(null,z)},D.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(D.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),D.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},D})(d.default);i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.PendingMessage=void 0;var l=r(0),f=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(36)),C=l.__importDefault(r(4)),E=f.default.Action,R=(function(){function D(z,G){this.message=z,this.callback=G,this.merged=!1;var N=z.action;this.sendAttempted=!1,this.ackRequired=N==E.MESSAGE||N==E.PRESENCE}return D})();i.PendingMessage=R;var v=(function(D){l.__extends(z,D);function z(G){var N=D.call(this)||this;return N.transport=G,N.messageQueue=new _.default,G.on("ack",function(M,L){N.onAck(M,L)}),G.on("nack",function(M,L,w){N.onNack(M,L,w)}),N}return z.prototype.onAck=function(G,N){m.default.logAction(m.default.LOG_MICRO,"Protocol.onAck()","serial = "+G+"; count = "+N),this.messageQueue.completeMessages(G,N)},z.prototype.onNack=function(G,N,M){m.default.logAction(m.default.LOG_ERROR,"Protocol.onNack()","serial = "+G+"; count = "+N+"; err = "+d.inspectError(M)),M||(M=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(G,N,M)},z.prototype.onceIdle=function(G){var N=this.messageQueue;if(N.count()===0){G();return}N.once("idle",G)},z.prototype.send=function(G){G.ackRequired&&this.messageQueue.push(G),m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Protocol.send()","sending msg; "+f.default.stringify(G.message)),G.sendAttempted=!0,this.transport.send(G.message)},z.prototype.getTransport=function(){return this.transport},z.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},z.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},z.prototype.finish=function(){var G=this.transport;this.onceIdle(function(){G.disconnect()})},z})(g.default);i.default=v}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(26)),m=l.__importDefault(r(8)),_=l.__importDefault(r(2)),C=l.__importDefault(r(10)),E=l.__importDefault(r(4)),R="web_socket";function v(G){return!!G.on}var D=(function(G){l.__extends(N,G);function N(M,L,w){var A=G.call(this,M,L,w)||this;return A.shortName=R,w.heartbeats=f.default.Config.useProtocolHeartbeats,A.wsHost=m.default.getHost(w.options,w.host,!0),A}return N.isAvailable=function(){return!!f.default.Config.WebSocket},N.prototype.createWebSocket=function(M,L){return this.uri=M+d.toQueryString(L),new f.default.Config.WebSocket(this.uri)},N.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},N.prototype.connect=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),g.default.prototype.connect.call(this);var M=this,L=this.params,w=L.options,A=w.tls?"wss://":"ws://",O=A+this.wsHost+":"+m.default.getPort(w)+"/";_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+O),this.auth.getAuthParams(function(y,B){if(!M.isDisposed){var U="";for(var P in B)U+=" "+P+": "+B[P]+";";if(_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+U+" err: "+y),y){M.disconnect(y);return}var K=L.getConnectParams(B);try{var Y=M.wsConnection=M.createWebSocket(O,K);Y.binaryType=f.default.Config.binaryType,Y.onopen=function(){M.onWsOpen()},Y.onclose=function(Q){M.onWsClose(Q)},Y.onmessage=function(Q){M.onWsData(Q.data)},Y.onerror=function(Q){M.onWsError(Q)},v(Y)&&Y.on("ping",function(){M.onActivity()})}catch(Q){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(Q.stack||Q.message)),M.disconnect(Q)}}})},N.prototype.send=function(M){var L=this.wsConnection;if(!L){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{L.send(C.default.serialize(M,this.params.format))}catch(A){var w="Exception from ws connection when trying to send: "+d.inspectError(A);_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()",w),this.finish("disconnected",new E.default(w,5e4,500))}},N.prototype.onWsData=function(M){_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+M.length+"; type = "+typeof M);try{this.onProtocolMessage(C.default.deserialize(M,this.format))}catch(L){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+L.stack)}},N.prototype.onWsOpen=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},N.prototype.onWsClose=function(M){var L,w;if(typeof M=="object"?(w=M.code,L=M.wasClean||w===1e3):(w=M,L=w==1e3),delete this.wsConnection,L){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var A=new E.default("Websocket closed",80003,400);this.finish("disconnected",A)}else{var O="Unclean disconnection of WebSocket ; code = "+w,A=new E.default(O,80003,400);_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()",O),this.finish("disconnected",A)}this.emit("disposed")},N.prototype.onWsError=function(M){var L=this;_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+M.message),f.default.Config.nextTick(function(){L.disconnect(Error(M.message))})},N.prototype.dispose=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var M=this.wsConnection;M&&(M.onmessage=function(){},delete this.wsConnection,f.default.Config.nextTick(function(){if(_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!M)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");M.close()}))},N})(g.default);function z(G){return D.isAvailable()&&(G.supportedTransports[R]=D),D}i.default=z}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(34)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(16)),C=l.__importStar(r(4)),E=l.__importDefault(r(38)),R=l.__importDefault(r(24)),v=l.__importDefault(r(39)),D=function(){};function z(A){return A.channel.realtime.auth.clientId}function G(A){var O=A.channel.realtime,y=O.auth.clientId;return(!y||y==="*")&&O.connection.state==="connected"}function N(A,O,y){switch(A.state){case"attached":case"suspended":y();break;case"initialized":case"detached":case"detaching":case"attaching":A.attach(function(B){B?O(B):y()});break;default:O(C.default.fromValues(A.invalidStateError()))}}function M(A,O){if(A.isSynthesized()||O.isSynthesized())return A.timestamp>=O.timestamp;var y=A.parseId(),B=O.parseId();return y.msgSerial===B.msgSerial?y.index>B.index:y.msgSerial>B.msgSerial}var L=(function(A){l.__extends(O,A);function O(y){var B=A.call(this,y)||this;return B.channel=y,B.syncComplete=!1,B.members=new w(B,function(U){return U.clientId+":"+U.connectionId}),B._myMembers=new w(B,function(U){return U.clientId}),B.subscriptions=new g.default,B.pendingPresence=[],B}return O.prototype.enter=function(y,B){if(G(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"enter",B)},O.prototype.update=function(y,B){if(G(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"update",B)},O.prototype.enterClient=function(y,B,U){return this._enterOrUpdateClient(void 0,y,B,"enter",U)},O.prototype.updateClient=function(y,B,U){return this._enterOrUpdateClient(void 0,y,B,"update",U)},O.prototype._enterOrUpdateClient=function(y,B,U,P,K){var Y=this;if(!K)if(typeof U=="function")K=U,U=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"_enterOrUpdateClient",[y,B,U,P]);K=D}var Q=this.channel;if(!Q.connectionManager.activeState()){K(Q.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence."+P+"Client()","channel = "+Q.name+", id = "+y+", client = "+(B||"(implicit) "+z(this)));var V=_.default.fromData(U);V.action=P,y&&(V.id=y),B&&(V.clientId=B),_.default.encode(V,Q.channelOptions,function(j){if(j){K(j);return}switch(Q.state){case"attached":Q.sendPresence(V,K);break;case"initialized":case"detached":Q.attach();case"attaching":Y.pendingPresence.push({presence:V,callback:K});break;default:j=new C.PartialErrorInfo("Unable to "+P+" presence channel while in "+Q.state+" state",90001),j.code=90001,K(j)}})},O.prototype.leave=function(y,B){if(G(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,y,B)},O.prototype.leaveClient=function(y,B,U){if(!U)if(typeof B=="function")U=B,B=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"leaveClient",[y,B]);U=D}var P=this.channel;if(!P.connectionManager.activeState()){U==null||U(P.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+y);var K=_.default.fromData(B);switch(K.action="leave",y&&(K.clientId=y),P.state){case"attached":P.sendPresence(K,U);break;case"attaching":this.pendingPresence.push({presence:K,callback:U});break;case"initialized":case"failed":{var Y=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);U==null||U(Y);break}default:U==null||U(P.invalidStateError())}},O.prototype.get=function(y,B){var U=this,P=Array.prototype.slice.call(arguments);P.length==1&&typeof P[0]=="function"&&P.unshift(null),y=P[0],B=P[1];var K=!y||("waitForSync"in y?y.waitForSync:!0);if(!B){if(this.channel.realtime.options.promises)return f.promisify(this,"get",P);B=D}function Y(Q){B(null,y?Q.list(y):Q.values())}if(this.channel.state==="suspended"){K?B(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):Y(this.members);return}N(this.channel,B,function(){var Q=U.members;K?Q.waitSync(function(){Y(Q)}):Y(Q)})},O.prototype.history=function(y,B){if(m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"history",arguments);B=D}y&&y.untilAttach&&(this.channel.state==="attached"?(delete y.untilAttach,y.from_serial=this.channel.properties.attachSerial):B(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),d.default.prototype._history.call(this,y,B)},O.prototype.setPresence=function(y,B,U){m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+y.length+" participants; syncChannelSerial = "+U);var P,K,Y=this.members,Q=this._myMembers,V=[],j=this.channel.connectionManager.connectionId;B&&(this.members.startSync(),U&&(K=U.match(/^[\w-]+:(.*)$/))&&(P=K[1]));for(var I=0;I<y.length;I++){var X=_.default.fromValues(y[I]);switch(X.action){case"leave":Y.remove(X)&&V.push(X),X.connectionId===j&&!X.isSynthesized()&&Q.remove(X);break;case"enter":case"present":case"update":Y.put(X)&&V.push(X),X.connectionId===j&&Q.put(X);break}}B&&!P&&(Y.endSync(),this.channel.syncChannelSerial=null);for(var I=0;I<V.length;I++){var X=V[I];this.subscriptions.emit(X.action,X)}},O.prototype.onAttached=function(y){m.default.logAction(m.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+y),y?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var B=this.pendingPresence,U=B.length;if(U){this.pendingPresence=[];var P=[],K=R.default.create();m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+U+" queued presence messages");for(var Y=0;Y<U;Y++){var Q=B[Y];P.push(Q.presence),K.push(Q.callback)}this.channel.sendPresence(P,K)}},O.prototype.actOnChannelState=function(y,B,U){switch(y){case"attached":this.onAttached(B);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(U);break}},O.prototype.failPendingPresence=function(y){if(this.pendingPresence.length){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+f.inspectError(y));for(var B=0;B<this.pendingPresence.length;B++)try{this.pendingPresence[B].callback(y)}catch{}this.pendingPresence=[]}},O.prototype._clearMyMembers=function(){this._myMembers.clear()},O.prototype._ensureMyMembersPresent=function(){var y=this,B=this._myMembers,U=function(Y){if(Y){var Q="Presence auto-re-enter failed: "+Y.toString(),V=new C.default(Q,91004,400);m.default.logAction(m.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",Q);var j=new v.default(y.channel.state,y.channel.state,!0,!1,V);y.channel.emit("update",j)}};for(var P in B.map){var K=B.map[P];m.default.logAction(m.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+K.clientId+'" into the presence set'),this._enterOrUpdateClient(K.id,K.clientId,K.data,"enter",U)}},O.prototype._synthesizeLeaves=function(y){var B=this.subscriptions;f.arrForEach(y,function(U){var P=_.default.fromValues({action:"leave",connectionId:U.connectionId,clientId:U.clientId,data:U.data,encoding:U.encoding,timestamp:f.now()});B.emit("leave",P)})},O.prototype.on=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,y)},O.prototype.off=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,y)},O.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=E.default.processListenerArgs(y),P=U[0],K=U[1],Y=U[2],Q=this.channel;if(!Y){if(this.channel.realtime.options.promises)return f.promisify(this,"subscribe",[P,K]);Y=D}if(Q.state==="failed"){Y(C.default.fromValues(Q.invalidStateError()));return}this.subscriptions.on(P,K),Q.attach(Y)},O.prototype.unsubscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=E.default.processListenerArgs(y),P=U[0],K=U[1];this.subscriptions.off(P,K)},O})(d.default),w=(function(A){l.__extends(O,A);function O(y,B){var U=A.call(this)||this;return U.presence=y,U.map=Object.create(null),U.syncInProgress=!1,U.residualMembers=null,U.memberKey=B,U}return O.prototype.get=function(y){return this.map[y]},O.prototype.getClient=function(y){var B=this.map,U=[];for(var P in B){var K=B[P];K.clientId==y&&K.action!="absent"&&U.push(K)}return U},O.prototype.list=function(y){var B=this.map,U=y&&y.clientId,P=y&&y.connectionId,K=[];for(var Y in B){var Q=B[Y];Q.action!=="absent"&&(U&&U!=Q.clientId||P&&P!=Q.connectionId||K.push(Q))}return K},O.prototype.put=function(y){(y.action==="enter"||y.action==="update")&&(y=_.default.fromValues(y),y.action="present");var B=this.map,U=this.memberKey(y);this.residualMembers&&delete this.residualMembers[U];var P=B[U];return P&&!M(y,P)?!1:(B[U]=y,!0)},O.prototype.values=function(){var y=this.map,B=[];for(var U in y){var P=y[U];P.action!="absent"&&B.push(P)}return B},O.prototype.remove=function(y){var B=this.map,U=this.memberKey(y),P=B[U];return P&&!M(y,P)?!1:(this.syncInProgress?(y=_.default.fromValues(y),y.action="absent",B[U]=y):delete B[U],!0)},O.prototype.startSync=function(){var y=this.map,B=this.syncInProgress;m.default.logAction(m.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),this.syncInProgress||(this.residualMembers=f.copy(y),this.setInProgress(!0))},O.prototype.endSync=function(){var y=this.map,B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),B){for(var U in y){var P=y[U];P.action==="absent"&&delete y[U]}this.presence._synthesizeLeaves(f.valuesArray(this.residualMembers));for(var U in this.residualMembers)delete y[U];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},O.prototype.waitSync=function(y){var B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),!B){y();return}this.once("sync",y)},O.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},O.prototype.setInProgress=function(y){m.default.logAction(m.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+y),this.syncInProgress=y,this.presence.syncComplete=!y},O})(g.default);i.default=L}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=r(56),d=r(31),g=r(11),m=l.__importDefault(r(5)),_=l.__importDefault(r(3)),C=(function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(R){return R!=null&&R.sigBytes!==void 0},E.prototype.isArrayBuffer=function(R){return R!=null&&R.constructor===ArrayBuffer},E.prototype.isTypedArray=function(R){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(R)},E.prototype.uint8ViewToBase64=function(R){for(var v="",D=this.base64CharSet,z=R.byteLength,G=z%3,N=z-G,M,L,w,A,O,y=0;y<N;y=y+3)O=R[y]<<16|R[y+1]<<8|R[y+2],M=(O&16515072)>>18,L=(O&258048)>>12,w=(O&4032)>>6,A=O&63,v+=D[M]+D[L]+D[w]+D[A];return G==1?(O=R[N],M=(O&252)>>2,L=(O&3)<<4,v+=D[M]+D[L]+"=="):G==2&&(O=R[N]<<8|R[N+1],M=(O&64512)>>10,L=(O&1008)>>4,w=(O&15)<<2,v+=D[M]+D[L]+D[w]+"="),v},E.prototype.base64ToArrayBuffer=function(R){for(var v=atob==null?void 0:atob(R),D=v.length,z=new Uint8Array(D),G=0;G<D;G++){var N=v.charCodeAt(G);z[G]=N}return z.buffer},E.prototype.isBuffer=function(R){return this.isArrayBuffer(R)||this.isWordArray(R)||this.isTypedArray(R)},E.prototype.toBuffer=function(R){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(R))return new Uint8Array(R);if(this.isTypedArray(R))return new Uint8Array(R.buffer);if(this.isWordArray(R)){for(var v=new ArrayBuffer(R.sigBytes),D=new Uint8Array(v),z=0;z<R.sigBytes;z++)D[z]=R.words[z>>>2]>>>24-z%4*8&255;return D}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(R){return this.isArrayBuffer(R)?R:this.toBuffer(R).buffer},E.prototype.toWordArray=function(R){return this.isTypedArray(R)&&(R=R.buffer),this.isWordArray(R)?R:m.default.create(R)},E.prototype.base64Encode=function(R){return this.isWordArray(R)?(0,g.stringify)(R):this.uint8ViewToBase64(this.toBuffer(R))},E.prototype.base64Decode=function(R){return ArrayBuffer&&_.default.Config.atob?this.base64ToArrayBuffer(R):(0,g.parse)(R)},E.prototype.hexEncode=function(R){return(0,f.stringify)(this.toWordArray(R))},E.prototype.hexDecode=function(R){var v=(0,f.parse)(R);return ArrayBuffer?this.toArrayBuffer(v):v},E.prototype.utf8Encode=function(R){return _.default.Config.TextEncoder?new _.default.Config.TextEncoder().encode(R).buffer:(0,d.parse)(R)},E.prototype.utf8Decode=function(R){if(!this.isBuffer(R))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(R)?new TextDecoder().decode(R):(R=this.toWordArray(R),(0,d.stringify)(R))},E.prototype.bufferCompare=function(R,v){if(!R)return-1;if(!v)return 1;var D=this.toWordArray(R),z=this.toWordArray(v);D.clamp(),z.clamp();var G=D.sigBytes-z.sigBytes;if(G!=0)return G;for(var N=D.words,M=z.words,L=0;L<N.length;L++)if(G=N[L]-M[L],G!=0)return G;return 0},E.prototype.byteLength=function(R){return this.isArrayBuffer(R)||this.isTypedArray(R)?R.byteLength:this.isWordArray(R)?R.sigBytes:-1},E.prototype.typedArrayToBuffer=function(R){return R.buffer},E})();i.default=new C}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return l.enc.Hex})}),(function(n,i,r){r.r(i);var l=r(5),f=r.n(l),d=r(11),g=r(23),m=r.n(g),_=r(2),C=r.n(_),E=r(4),R=r.n(E),v=function(D,z){var G="aes",N=256,M="cbc",L=16,w=4,A=4294967296,O=2147483648,y;if(D.getRandomWordArray)y=D.getRandomWordArray;else if(typeof Uint32Array<"u"&&D.getRandomValues){var B=new Uint32Array(w);y=function(I,X){var Z=I/4,at=Z==w?B:new Uint32Array(Z);D.getRandomValues(at,function(J){typeof X<"u"&&X(J,z.toWordArray(at))})}}else y=function(I,X){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var Z=I/4,at=new Array(Z),J=0;J<Z;J++)at[J]=Math.floor(Math.random()*A)-O;X(null,f.a.create(at))};function U(I){return I+L&-L}function P(I){if(I.algorithm==="aes"&&I.mode==="cbc"){if(I.keyLength===128||I.keyLength===256)return;throw new Error("Unsupported key length "+I.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function K(I){return I.replace("_","/").replace("-","+")}var Y=[f.a.create([269488144,269488144,269488144,269488144],16),f.a.create([16777216],1),f.a.create([33685504],2),f.a.create([50529024],3),f.a.create([67372036],4),f.a.create([84215045,83886080],5),f.a.create([101058054,101056512],6),f.a.create([117901063,117901056],7),f.a.create([134744072,134744072],8),f.a.create([151587081,151587081,150994944],9),f.a.create([168430090,168430090,168427520],10),f.a.create([185273099,185273099,185273088],11),f.a.create([202116108,202116108,202116108],12),f.a.create([218959117,218959117,218959117,218103808],13),f.a.create([235802126,235802126,235802126,235798528],14),f.a.create([252645135,252645135,252645135,252645135],15),f.a.create([269488144,269488144,269488144,269488144],16)];function Q(){}function V(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}Q.CipherParams=V,Q.getDefaultParams=function(I){var X;if(typeof I=="function"||typeof I=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof I=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),Q.generateRandomKey(function(at){I(null,Q.getDefaultParams({key:at}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,Q.getDefaultParams({key:I}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!I.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof I.key=="string"?X=Object(d.parse)(K(I.key)):X=z.toWordArray(I.key);var Z=new V;if(Z.key=X,Z.algorithm=I.algorithm||G,Z.keyLength=X.words.length*32,Z.mode=I.mode||M,I.keyLength&&I.keyLength!==Z.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+I.keyLength+" was specified, but the key actually has length "+Z.keyLength);return P(Z),Z},Q.generateRandomKey=function(I,X){arguments.length==1&&typeof I=="function"&&(X=I,I=void 0),y((I||N)/8,function(Z,at){X!==void 0&&X(Z?R.a.fromValues(Z):null,at)})},Q.getCipher=function(I){var X=I instanceof V?I:Q.getDefaultParams(I);return{cipherParams:X,cipher:new j(X,w,I.iv)}};function j(I,X,Z){this.algorithm=I.algorithm+"-"+String(I.keyLength)+"-"+I.mode,this.cjsAlgorithm=I.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=z.toWordArray(I.key),Z&&(this.iv=z.toWordArray(Z).clone()),this.blockLengthWords=X}return j.prototype.encrypt=function(I,X){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),I=z.toWordArray(I);var Z=I.sigBytes,at=U(Z),J=this,rt=function(){J.getIv(function(it,q){if(it){X(it);return}var F=J.encryptCipher.process(I.concat(Y[at-Z])),$=q.concat(F);X(null,$)})};this.encryptCipher?rt():this.iv?(this.encryptCipher=m.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),rt()):y(L,function(it,q){if(it){X(it);return}J.encryptCipher=m.a.algo[J.cjsAlgorithm].createEncryptor(J.key,{iv:q}),J.iv=q,rt()})},j.prototype.decrypt=function(I){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),I=z.toWordArray(I);var X=this.blockLengthWords,Z=I.words,at=f.a.create(Z.slice(0,X)),J=f.a.create(Z.slice(X)),rt=m.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:at}),it=rt.process(J),q=rt.finalize();return rt.reset(),q&&q.sigBytes&&it.concat(q),it},j.prototype.getIv=function(I){if(this.iv){var X=this.iv;this.iv=null,I(null,X);return}var Z=this;y(L,function(at,J){if(at){I(at);return}I(null,Z.encryptCipher.process(J))})},Q};i.default=v}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=f.enc;m.Utf16=m.Utf16BE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],D=0;D<R;D+=2){var z=E[D>>>2]>>>16-D%4*8&65535;v.push(String.fromCharCode(z))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=C.charCodeAt(v)<<16-v%2*16;return g.create(R,E*2)}},m.Utf16LE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],D=0;D<R;D+=2){var z=_(E[D>>>2]>>>16-D%4*8&65535);v.push(String.fromCharCode(z))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=_(C.charCodeAt(v)<<16-v%2*16);return g.create(R,E*2)}};function _(C){return C<<8&4278255360|C>>>8&16711935}})(),l.enc.Utf16})}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(28))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.CipherParams,_=d.enc,C=_.Hex,E=d.format;E.Hex={stringify:function(R){return R.ciphertext.toString(C)},parse:function(R){var v=C.parse(R);return m.create({ciphertext:v})}}})(),l.format.Hex})}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(11),r(61),r(27),r(28))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.BlockCipher,m=f.algo,_=[],C=[],E=[],R=[],v=[],D=[],z=[],G=[],N=[],M=[];(function(){for(var A=[],O=0;O<256;O++)O<128?A[O]=O<<1:A[O]=O<<1^283;for(var y=0,B=0,O=0;O<256;O++){var U=B^B<<1^B<<2^B<<3^B<<4;U=U>>>8^U&255^99,_[y]=U,C[U]=y;var P=A[y],K=A[P],Y=A[K],Q=A[U]*257^U*16843008;E[y]=Q<<24|Q>>>8,R[y]=Q<<16|Q>>>16,v[y]=Q<<8|Q>>>24,D[y]=Q;var Q=Y*16843009^K*65537^P*257^y*16843008;z[U]=Q<<24|Q>>>8,G[U]=Q<<16|Q>>>16,N[U]=Q<<8|Q>>>24,M[U]=Q,y?(y=P^A[A[A[Y^P]]],B^=A[A[B]]):y=B=1}})();var L=[0,1,2,4,8,16,32,64,128,27,54],w=m.AES=g.extend({_doReset:function(){var A;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var O=this._keyPriorReset=this._key,y=O.words,B=O.sigBytes/4,U=this._nRounds=B+6,P=(U+1)*4,K=this._keySchedule=[],Y=0;Y<P;Y++)Y<B?K[Y]=y[Y]:(A=K[Y-1],Y%B?B>6&&Y%B==4&&(A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255]):(A=A<<8|A>>>24,A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255],A^=L[Y/B|0]<<24),K[Y]=K[Y-B]^A);for(var Q=this._invKeySchedule=[],V=0;V<P;V++){var Y=P-V;if(V%4)var A=K[Y];else var A=K[Y-4];V<4||Y<=4?Q[V]=A:Q[V]=z[_[A>>>24]]^G[_[A>>>16&255]]^N[_[A>>>8&255]]^M[_[A&255]]}}},encryptBlock:function(A,O){this._doCryptBlock(A,O,this._keySchedule,E,R,v,D,_)},decryptBlock:function(A,O){var y=A[O+1];A[O+1]=A[O+3],A[O+3]=y,this._doCryptBlock(A,O,this._invKeySchedule,z,G,N,M,C);var y=A[O+1];A[O+1]=A[O+3],A[O+3]=y},_doCryptBlock:function(A,O,y,B,U,P,K,Y){for(var Q=this._nRounds,V=A[O]^y[0],j=A[O+1]^y[1],I=A[O+2]^y[2],X=A[O+3]^y[3],Z=4,at=1;at<Q;at++){var J=B[V>>>24]^U[j>>>16&255]^P[I>>>8&255]^K[X&255]^y[Z++],rt=B[j>>>24]^U[I>>>16&255]^P[X>>>8&255]^K[V&255]^y[Z++],it=B[I>>>24]^U[X>>>16&255]^P[V>>>8&255]^K[j&255]^y[Z++],q=B[X>>>24]^U[V>>>16&255]^P[j>>>8&255]^K[I&255]^y[Z++];V=J,j=rt,I=it,X=q}var J=(Y[V>>>24]<<24|Y[j>>>16&255]<<16|Y[I>>>8&255]<<8|Y[X&255])^y[Z++],rt=(Y[j>>>24]<<24|Y[I>>>16&255]<<16|Y[X>>>8&255]<<8|Y[V&255])^y[Z++],it=(Y[I>>>24]<<24|Y[X>>>16&255]<<16|Y[V>>>8&255]<<8|Y[j&255])^y[Z++],q=(Y[X>>>24]<<24|Y[V>>>16&255]<<16|Y[j>>>8&255]<<8|Y[I&255])^y[Z++];A[O]=J,A[O+1]=rt,A[O+2]=it,A[O+3]=q},keySize:256/32});f.AES=g._createHelper(w)})(),l.AES})}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[];(function(){for(var N=0;N<64;N++)E[N]=f.abs(f.sin(N+1))*4294967296|0})();var R=C.MD5=_.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(N,M){for(var L=0;L<16;L++){var w=M+L,A=N[w];N[w]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var O=this._hash.words,y=N[M+0],B=N[M+1],U=N[M+2],P=N[M+3],K=N[M+4],Y=N[M+5],Q=N[M+6],V=N[M+7],j=N[M+8],I=N[M+9],X=N[M+10],Z=N[M+11],at=N[M+12],J=N[M+13],rt=N[M+14],it=N[M+15],q=O[0],F=O[1],$=O[2],nt=O[3];q=v(q,F,$,nt,y,7,E[0]),nt=v(nt,q,F,$,B,12,E[1]),$=v($,nt,q,F,U,17,E[2]),F=v(F,$,nt,q,P,22,E[3]),q=v(q,F,$,nt,K,7,E[4]),nt=v(nt,q,F,$,Y,12,E[5]),$=v($,nt,q,F,Q,17,E[6]),F=v(F,$,nt,q,V,22,E[7]),q=v(q,F,$,nt,j,7,E[8]),nt=v(nt,q,F,$,I,12,E[9]),$=v($,nt,q,F,X,17,E[10]),F=v(F,$,nt,q,Z,22,E[11]),q=v(q,F,$,nt,at,7,E[12]),nt=v(nt,q,F,$,J,12,E[13]),$=v($,nt,q,F,rt,17,E[14]),F=v(F,$,nt,q,it,22,E[15]),q=D(q,F,$,nt,B,5,E[16]),nt=D(nt,q,F,$,Q,9,E[17]),$=D($,nt,q,F,Z,14,E[18]),F=D(F,$,nt,q,y,20,E[19]),q=D(q,F,$,nt,Y,5,E[20]),nt=D(nt,q,F,$,X,9,E[21]),$=D($,nt,q,F,it,14,E[22]),F=D(F,$,nt,q,K,20,E[23]),q=D(q,F,$,nt,I,5,E[24]),nt=D(nt,q,F,$,rt,9,E[25]),$=D($,nt,q,F,P,14,E[26]),F=D(F,$,nt,q,j,20,E[27]),q=D(q,F,$,nt,J,5,E[28]),nt=D(nt,q,F,$,U,9,E[29]),$=D($,nt,q,F,V,14,E[30]),F=D(F,$,nt,q,at,20,E[31]),q=z(q,F,$,nt,Y,4,E[32]),nt=z(nt,q,F,$,j,11,E[33]),$=z($,nt,q,F,Z,16,E[34]),F=z(F,$,nt,q,rt,23,E[35]),q=z(q,F,$,nt,B,4,E[36]),nt=z(nt,q,F,$,K,11,E[37]),$=z($,nt,q,F,V,16,E[38]),F=z(F,$,nt,q,X,23,E[39]),q=z(q,F,$,nt,J,4,E[40]),nt=z(nt,q,F,$,y,11,E[41]),$=z($,nt,q,F,P,16,E[42]),F=z(F,$,nt,q,Q,23,E[43]),q=z(q,F,$,nt,I,4,E[44]),nt=z(nt,q,F,$,at,11,E[45]),$=z($,nt,q,F,it,16,E[46]),F=z(F,$,nt,q,U,23,E[47]),q=G(q,F,$,nt,y,6,E[48]),nt=G(nt,q,F,$,V,10,E[49]),$=G($,nt,q,F,rt,15,E[50]),F=G(F,$,nt,q,Y,21,E[51]),q=G(q,F,$,nt,at,6,E[52]),nt=G(nt,q,F,$,P,10,E[53]),$=G($,nt,q,F,X,15,E[54]),F=G(F,$,nt,q,B,21,E[55]),q=G(q,F,$,nt,j,6,E[56]),nt=G(nt,q,F,$,it,10,E[57]),$=G($,nt,q,F,Q,15,E[58]),F=G(F,$,nt,q,J,21,E[59]),q=G(q,F,$,nt,K,6,E[60]),nt=G(nt,q,F,$,Z,10,E[61]),$=G($,nt,q,F,U,15,E[62]),F=G(F,$,nt,q,I,21,E[63]),O[0]=O[0]+q|0,O[1]=O[1]+F|0,O[2]=O[2]+$|0,O[3]=O[3]+nt|0},_doFinalize:function(){var N=this._data,M=N.words,L=this._nDataBytes*8,w=N.sigBytes*8;M[w>>>5]|=128<<24-w%32;var A=f.floor(L/4294967296),O=L;M[(w+64>>>9<<4)+15]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,M[(w+64>>>9<<4)+14]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,N.sigBytes=(M.length+1)*4,this._process();for(var y=this._hash,B=y.words,U=0;U<4;U++){var P=B[U];B[U]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return y},clone:function(){var N=_.clone.call(this);return N._hash=this._hash.clone(),N}});function v(N,M,L,w,A,O,y){var B=N+(M&L|~M&w)+A+y;return(B<<O|B>>>32-O)+M}function D(N,M,L,w,A,O,y){var B=N+(M&w|L&~w)+A+y;return(B<<O|B>>>32-O)+M}function z(N,M,L,w,A,O,y){var B=N+(M^L^w)+A+y;return(B<<O|B>>>32-O)+M}function G(N,M,L,w,A,O,y){var B=N+(L^(M|~w))+A+y;return(B<<O|B>>>32-O)+M}d.MD5=_._createHelper(R),d.HmacMD5=_._createHmacHelper(R)})(Math),l.MD5})}),(function(n,i,r){var l;Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),d=f.__importDefault(r(3)),g=f.__importStar(r(1)),m=f.__importDefault(r(8)),_=r(4),C=f.__importDefault(r(19)),E=f.__importDefault(r(17)),R=f.__importDefault(r(22)),v=f.__importDefault(r(2)),D=r(29),z=f.__importDefault(r(63)),G=r(14);function N(w){var A=w.statusCode;return A===408&&!w.code||A===400&&!w.code||A>=500&&A<=504}function M(w){var A=w.connection,O=A&&A.connectionManager.host;return O?[O].concat(m.default.getFallbackHosts(w.options)):m.default.getHosts(w.options)}var L=(l=(function(){function w(A){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=M,this.options=A||{};var O=this.options.connectivityCheckUrl||m.default.connectivityCheckUrl,y=this.options.connectivityCheckParams,B=!this.options.connectivityCheckUrl;d.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(U,P,K,Y,Q,V,j){var I=E.default.createRequest(K,Y,Q,V,R.default.REQ_SEND,P&&P.options.timeouts,U);return I.once("complete",j),I.exec(),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+O),this.doUri(C.default.Get,null,O,null,null,y,function(P,K,Y,Q,V){var j=!1;B?j=!P&&(K==null?void 0:K.replace(/\n/,""))=="yes":j=!P&&(0,G.isSuccessCode)(V),v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+j),U(null,j)})}):d.default.Config.jsonpSupported?(this.Request=function(U,P,K,Y,Q,V,j){var I=(0,D.createRequest)(K,Y,Q,V,R.default.REQ_SEND,P&&P.options.timeouts,U);return I.once("complete",j),d.default.Config.nextTick(function(){I.exec()}),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){var P=this,K=m.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(U);return}this.checksInProgress=[U],v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+K);var Y=new D.Request("isTheInternetUp",K,null,null,null,R.default.REQ_SEND,m.default.TIMEOUTS);Y.once("complete",function(Q,V){var j=!Q&&V;v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+j);for(var I=0;I<P.checksInProgress.length;I++)P.checksInProgress[I](null,j);P.checksInProgress=null}),d.default.Config.nextTick(function(){Y.exec()})}):d.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=z.default,this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+O),this.doUri(C.default.Get,null,O,null,null,null,function(P,K){var Y=!P&&(K==null?void 0:K.replace(/\n/,""))=="yes";v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+Y),U(null,Y)})}):this.Request=function(U,P,K,Y,Q,V,j){j(new _.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return w.prototype.do=function(A,O,y,B,U,P,K){var Y=this,Q=typeof y=="function"?y:function(X){return O.baseUri(X)+y},V=O._currentFallback;if(V)if(V.validUntil>g.now()){if(!this.Request){K==null||K(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,O,Q(V.host),B,P,U,function(X){for(var Z=[],at=1;at<arguments.length;at++)Z[at-1]=arguments[at];if(X&&N(X)){O._currentFallback=null,Y.do(A,O,y,B,U,P,K);return}K==null||K.apply(void 0,f.__spreadArray([X],Z,!1))});return}else O._currentFallback=null;var j=M(O);if(j.length===1){this.doUri(A,O,Q(j[0]),B,U,P,K);return}var I=function(X,Z){var at=X.shift();Y.doUri(A,O,Q(at),B,U,P,function(J){for(var rt=[],it=1;it<arguments.length;it++)rt[it-1]=arguments[it];if(J&&N(J)&&X.length){I(X,!0);return}Z&&(O._currentFallback={host:at,validUntil:g.now()+O.options.timeouts.fallbackRetryTimeout}),K==null||K.apply(void 0,f.__spreadArray([J],rt,!1))})};I(j)},w.prototype.doUri=function(A,O,y,B,U,P,K){if(!this.Request){K(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,O,y,B,P,U,K)},w})(),l.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],l.methodsWithoutBody=[C.default.Get,C.default.Delete],l.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],l);i.default=L}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(4)),d=l.__importDefault(r(3)),g=l.__importDefault(r(8)),m=l.__importStar(r(1)),_=r(1);function C(v,D){return!!D.get("x-ably-errorcode")}function E(v,D){if(C(v,D))return v.error&&f.default.fromValues(v.error)}function R(v,D,z,G,N,M,L){var w=new Headers(G||{}),A=v?v.toUpperCase():m.isEmptyArg(M)?"GET":"POST",O=new AbortController,y=setTimeout(function(){O.abort(),L(new f.PartialErrorInfo("Request timed out",null,408))},D?D.options.timeouts.httpRequestTimeout:g.default.TIMEOUTS.httpRequestTimeout),B={method:A,headers:w,body:M};d.default.Config.isWebworker||(B.credentials=w.has("authorization")?"include":"same-origin"),(0,_.getGlobalObject)().fetch(z+"?"+new URLSearchParams(N||{}),B).then(function(U){clearTimeout(y);var P=U.headers.get("Content-Type"),K;P&&P.indexOf("application/x-msgpack")>-1?K=U.arrayBuffer():P&&P.indexOf("application/json")>-1?K=U.json():K=U.text(),K.then(function(Y){var Q=!!P&&P.indexOf("application/x-msgpack")===-1;if(U.ok)L(null,Y,U.headers,Q,U.status);else{var V=E(Y,U.headers)||new f.PartialErrorInfo("Error response received from server: "+U.status+" body was: "+d.default.Config.inspect(Y),null,U.status);L(V,Y,U.headers,Q,U.status)}})}).catch(function(U){clearTimeout(y),L(U)})}i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(41)),d=l.__importStar(r(1)),g=d.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function m(){var R=g.location;return!g.WebSocket||!R||!R.origin||R.origin.indexOf("http")>-1}var _=g.navigator&&g.navigator.userAgent.toString(),C=g.location&&g.location.href,E={agent:"browser",logTimestamps:!0,userAgent:_,currentUrl:C,noUpgrade:_&&!!_.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:g.WebSocket,fetchSupported:!!g.fetch,xhrSupported:g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:m(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:f.default,supportsBinary:!!g.TextDecoder,preferBinary:!1,ArrayBuffer:g.ArrayBuffer,atob:g.atob,nextTick:typeof g.setImmediate<"u"?g.setImmediate.bind(g):function(R){setTimeout(R,0)},addEventListener:g.addEventListener,inspect:JSON.stringify,stringByteSize:function(R){return g.TextDecoder&&new g.TextEncoder().encode(R).length||R.length},TextEncoder:g.TextEncoder,TextDecoder:g.TextDecoder,Promise:g.Promise,getRandomValues:(function(R){if(R!==void 0)return function(v,D){R.getRandomValues(v),D&&D(null)}})(g.crypto||msCrypto)};i.default=E}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),d=f.__importStar(r(1)),g="ablyjs-storage-test",m=(function(){function _(){try{l.sessionStorage.setItem(g,g),l.sessionStorage.removeItem(g),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{l.localStorage.setItem(g,g),l.localStorage.removeItem(g),this.localSupported=!0}catch{this.localSupported=!1}}return _.prototype.get=function(C){return this._get(C,!1)},_.prototype.getSession=function(C){return this._get(C,!0)},_.prototype.remove=function(C){return this._remove(C,!1)},_.prototype.removeSession=function(C){return this._remove(C,!0)},_.prototype.set=function(C,E,R){return this._set(C,E,R,!1)},_.prototype.setSession=function(C,E,R){return this._set(C,E,R,!0)},_.prototype._set=function(C,E,R,v){var D={value:E};return R&&(D.expires=d.now()+R),this.storageInterface(v).setItem(C,JSON.stringify(D))},_.prototype._get=function(C,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var R=this.storageInterface(E).getItem(C);if(!R)return null;var v=JSON.parse(R);return v.expires&&v.expires<d.now()?(this.storageInterface(E).removeItem(C),null):v.value},_.prototype._remove=function(C,E){return this.storageInterface(E).removeItem(C)},_.prototype.storageInterface=function(C){return C?l.sessionStorage:l.localStorage},_})();i.default=new m}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(67)),d={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],baseTransportOrder:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],transportPreferenceOrder:[f.default.JsonP,f.default.XhrPolling,f.default.XhrStreaming,f.default.WebSocket],upgradeTransports:[f.default.XhrStreaming,f.default.WebSocket]};i.default=d}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(f){f.WebSocket="web_socket",f.Comet="comet",f.XhrStreaming="xhr_streaming",f.XhrPolling="xhr_polling",f.JsonP="jsonp"})(l||(l={})),i.default=l}),(function(n,i,r){r.r(i);var l=r(29),f=r.n(l),d=r(1),g=r(3),m=r.n(g),_=r(12),C=r.n(_),E=r(17),R=r.n(E),v=function(N){var M="xhr_polling";function L(w,A,O){O.stream=!1,C.a.call(this,w,A,O),this.shortName=M}return d.inherits(L,C.a),L.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.allowComet},L.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},L.prototype.createRequest=function(w,A,O,y,B){return R.a.createRequest(w,A,O,y,B,this.timeouts)},typeof N<"u"&&L.isAvailable()&&(N.supportedTransports[M]=L),L},D=v,z=function(N){var M="xhr_streaming";function L(w,A,O){C.a.call(this,w,A,O),this.shortName=M}return d.inherits(L,C.a),L.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.streamingSupported&&m.a.Config.allowComet},L.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},L.prototype.createRequest=function(w,A,O,y,B){return R.a.createRequest(w,A,O,y,B,this.timeouts)},typeof N<"u"&&L.isAvailable()&&(N.supportedTransports[M]=L),L},G=z;i.default=[f.a,D,G]})]).default})})(zp)),zp.exports}var X8=uS();const il={width:800,height:600},F8=.65,J8=2.2,Z0="studentCanvasPrefs",Lp=2,Z8=({sharedImage:o,canvasWidth:t,canvasHeight:n})=>{const[i,r]=mt.useState(null);if(mt.useEffect(()=>{if(!o){r(null);return}const C=new window.Image;C.src=o.dataUrl,C.onload=()=>{r(C)}},[o]),!o||!i)return null;const l=o.width/o.height,f=t/n;let d,g,m,_;return l>f?(d=t,g=t/l,m=0,_=(n-g)/2):(g=n,d=n*l,m=(t-d)/2,_=0),et.jsx(ev,{image:i,x:m,y:_,width:d,height:g,listening:!1})};function W8(){const[o]=T2(),t=o.get("room")||"demo",n=o.get("name")||"Anonymous",[i,r]=mt.useState(null),[l]=mt.useState(`student-${Math.random().toString(36).substr(2,9)}`),[f,d]=mt.useState(!1),[g,m]=mt.useState([]),[_,C]=mt.useState([]),[E,R]=mt.useState(null),[v,D]=mt.useState("pen"),[z,G]=mt.useState("black"),[N,M]=mt.useState(3),[L,w]=mt.useState(!1),[A,O]=mt.useState("stylus-only"),[y,B]=mt.useState("left");mt.useEffect(()=>{if(!(typeof window>"u")){console.log("🔵 [STUDENT] Loading preferences from localStorage...");try{const zt=localStorage.getItem(Z0);if(zt){const ft=JSON.parse(zt);if(console.log("🔵 [STUDENT] Found stored preferences:",ft),ft.version!==Lp){console.log("🔵 [STUDENT] Version mismatch! Expected:",Lp,"Got:",ft.version),console.log("🔵 [STUDENT] Clearing old preferences..."),localStorage.removeItem(Z0);return}console.log("🔵 [STUDENT] Applying preferences..."),ft.tool&&D(ft.tool),ft.color&&G(ft.color),typeof ft.brushSize=="number"&&M(ft.brushSize),ft.inputMode&&O(ft.inputMode),ft.toolbarPosition&&B(ft.toolbarPosition),console.log("🔵 [STUDENT] Preferences loaded successfully!")}else console.log("🔵 [STUDENT] No stored preferences found, using defaults")}catch(zt){console.warn("🔵 [STUDENT] Failed to load student prefs",zt),localStorage.removeItem(Z0)}}},[]),mt.useEffect(()=>{if(typeof window>"u")return;if(K.current){K.current=!1,console.log("💾 [STUDENT] Skipping save on first render");return}const zt={version:Lp,tool:v,color:z,brushSize:N,inputMode:A,toolbarPosition:y};console.log("💾 [STUDENT] Saving preferences to localStorage:",zt),localStorage.setItem(Z0,JSON.stringify(zt))},[v,z,N,A,y]);const U=mt.useRef([]),P=mt.useRef([]),K=mt.useRef(!0),Y=mt.useRef(!1),Q=mt.useRef(!1),V=mt.useRef(null),j=mt.useRef(null);mt.useEffect(()=>()=>{j.current&&cancelAnimationFrame(j.current)},[]),mt.useEffect(()=>{const zt=Qt=>{Qt.preventDefault()},ft=Qt=>{Qt.preventDefault()},xt=Qt=>{if(L)return Qt.preventDefault(),!1};return document.addEventListener("touchstart",zt,{passive:!1}),document.addEventListener("touchmove",zt,{passive:!1}),document.addEventListener("gesturestart",ft,{passive:!1}),document.addEventListener("gesturechange",ft,{passive:!1}),document.addEventListener("selectstart",xt),()=>{document.removeEventListener("touchstart",zt),document.removeEventListener("touchmove",zt),document.removeEventListener("gesturestart",ft),document.removeEventListener("gesturechange",ft),document.removeEventListener("selectstart",xt)}},[L]);const I=mt.useRef(null),X=mt.useRef(null),[Z,at]=mt.useState(il),J=mt.useMemo(()=>il.width?Z.width/il.width:1,[Z.width]);mt.useEffect(()=>{(async()=>{try{const ft=new X8.Realtime({authUrl:"/api/token",authParams:{clientId:l}});ft.connection.on("connected",()=>{console.log("Connected to Ably"),d(!0)}),ft.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),d(!1)});const xt=ft.channels.get(`room-${t}`);return xt.subscribe("student-layer",Qt=>{Qt.clientId===l&&(Y.current=!0,m(Qt.data.lines||[]),setTimeout(()=>{Y.current=!1},100))}),xt.subscribe("teacher-annotation",Qt=>{Qt.data.targetStudentId===l&&(Y.current=!0,C(Qt.data.annotations||[]),setTimeout(()=>{Y.current=!1},100))}),xt.subscribe("teacher-image",Qt=>{var Jt,$t,ve,ae;R({dataUrl:(Jt=Qt.data)==null?void 0:Jt.dataUrl,width:($t=Qt.data)==null?void 0:$t.width,height:(ve=Qt.data)==null?void 0:ve.height,timestamp:(ae=Qt.data)==null?void 0:ae.timestamp})}),xt.subscribe("teacher-template",Qt=>{var Jt,$t,ve,ae,ln;R({dataUrl:(Jt=Qt.data)==null?void 0:Jt.dataUrl,width:($t=Qt.data)==null?void 0:$t.width,height:(ve=Qt.data)==null?void 0:ve.height,type:(ae=Qt.data)==null?void 0:ae.type,timestamp:(ln=Qt.data)==null?void 0:ln.timestamp})}),xt.subscribe("teacher-clear",Qt=>{R(null)}),xt.subscribe("clear-all-drawings",Qt=>{console.log("📝 Clearing all drawings (teacher sent new content)"),Y.current=!0,m([]),C([]),setTimeout(()=>{Y.current=!1},100)}),xt.presence.enter({name:n}),console.log(`Joined room ${t} as ${n}`),r(xt),()=>{ft.close()}}catch(ft){console.error("Failed to initialize Ably:",ft)}})()},[l,t]),mt.useEffect(()=>{const zt=I.current;if(!zt)return;const ft=()=>{if(!I.current)return;const Qt=I.current.getBoundingClientRect(),Jt=48,$t=Math.max(320,Qt.width-Jt),ve=Math.max(240,Qt.height-Jt),ae=$t/il.width,ln=ve/il.height,Sn=Math.min(ae,ln),We=Math.max(F8,Math.min(J8,Sn)),ut=Math.round(We*20)/20;at({width:Math.round(il.width*ut),height:Math.round(il.height*ut)})};ft(),window.addEventListener("resize",ft);let xt;return window.ResizeObserver&&(xt=new ResizeObserver(()=>ft()),xt.observe(zt)),()=>{window.removeEventListener("resize",ft),xt&&xt.disconnect()}},[y]),mt.useEffect(()=>{if(!Y.current&&i){const zt=setTimeout(()=>{i.publish("student-layer",{lines:g,clientId:l,meta:{base:il,display:Z,scale:J}}),console.log("Published student layer:",g.length,"lines")},150);return()=>clearTimeout(zt)}},[g,i,l,Z,J]);const rt=zt=>A!=="stylus-only"?!0:(zt==null?void 0:zt.pointerType)==="pen",it=zt=>{const ft=zt.evt;if(!rt(ft)){ft!=null&&ft.preventDefault&&ft.preventDefault();return}const xt=zt.target.getStage();if(xt&&ft.pointerId!==void 0){const Qt=xt.content;if(Qt&&Qt.setPointerCapture)try{Qt.setPointerCapture(ft.pointerId)}catch{}}if(v==="pen"){w(!0);const Qt=xt.getPointerPosition(),Jt=Qt.x/J,$t=Qt.y/J,ve={tool:v,points:[Jt,$t],color:z,strokeWidth:N/J};V.current=ve,U.current.push([...g]),P.current=[],m([...g,ve])}else v==="eraser"&&(w(!0),Q.current=!1);ft.preventDefault&&ft.preventDefault(),ft.stopPropagation&&ft.stopPropagation()},q=zt=>{if(!L)return;const ft=zt.evt;if(!rt(ft)){ft!=null&&ft.preventDefault&&ft.preventDefault();return}const Qt=zt.target.getStage().getPointerPosition();if(v==="pen"){if(V.current){const Jt=Qt.x/J,$t=Qt.y/J;V.current.points=V.current.points.concat([Jt,$t]);const ve=V.current;j.current&&cancelAnimationFrame(j.current),j.current=requestAnimationFrame(()=>{ve&&m(ae=>ae.length>0?[...ae.slice(0,-1),ve]:ae)})}}else if(v==="eraser"){const Jt=g.length,$t=Qt.x,ve=Qt.y,ae=20,ln=g.filter(Sn=>{for(let We=0;We<Sn.points.length;We+=2){const ut=Sn.points[We]*J,Ot=Sn.points[We+1]*J;if(Math.sqrt(Math.pow(ut-$t,2)+Math.pow(Ot-ve,2))<ae)return!1}return!0});ln.length<Jt&&!Q.current&&(U.current.push([...g]),P.current=[],Q.current=!0),m(ln)}ft!=null&&ft.preventDefault&&ft.preventDefault(),ft!=null&&ft.stopPropagation&&ft.stopPropagation()},F=zt=>{const ft=zt==null?void 0:zt.evt;if(!rt(ft)){ft!=null&&ft.preventDefault&&ft.preventDefault();return}w(!1),V.current=null},$=()=>{if(U.current.length>0){const zt=U.current.pop();P.current.push([...g]),m(zt)}},nt=()=>{if(P.current.length>0){const zt=P.current.pop();U.current.push([...g]),m(zt)}},ht=async()=>{U.current.push([...g]),P.current=[],m([]),i&&(await i.publish("student-layer",{lines:[],clientId:l,meta:{base:il,display:Z,scale:J}}),console.log("Published student clear"))},Tt=()=>{var zt;return((zt=l.split("-")[1])==null?void 0:zt.substring(0,3))||l},jt=()=>{O(zt=>zt==="stylus-only"?"all":"stylus-only")},Kt=()=>{B(zt=>zt==="left"?"right":"left")},Wt=()=>`Connected as ${n!=="Anonymous"?n:Tt()}`,ge=f?"Connected":"Reconnecting…",Pt=f?"online":"offline",pe=zt=>zt.map((ft,xt)=>ft*J),xe=zt=>(zt.strokeWidth||3)*J;return et.jsx("div",{className:"student-canvas-page",children:et.jsxs("div",{className:"student-canvas-container",children:[et.jsxs("div",{className:"student-status-bar",children:[et.jsxs("div",{className:"student-status-text",children:[et.jsx("h1",{children:"Student Canvas"}),et.jsx("p",{children:Wt()})]}),et.jsxs("div",{className:"student-status-actions",children:[et.jsx("div",{className:"tool-status-indicator",children:et.jsxs("span",{className:"tool-status-text",children:[et.jsx("i",{className:v==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",A==="all"?"All inputs":"Stylus only"]})}),et.jsxs("div",{className:`connection-pill ${Pt}`,"aria-live":"polite",children:[et.jsx("span",{className:"connection-indicator-dot"}),et.jsx("span",{children:ge})]}),et.jsxs("button",{className:"move-toolbar-btn",onClick:Kt,children:["Move toolbar to ",y==="left"?"right":"left"]})]})]}),et.jsxs("div",{className:`student-workspace ${y==="right"?"toolbar-right":""}`,children:[et.jsxs("div",{className:"student-sidebar",children:[et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"COLORS"}),et.jsxs("div",{className:"color-buttons",children:[et.jsx("button",{onClick:()=>G("black"),className:`color-button ${z==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),et.jsx("button",{onClick:()=>G("#0066FF"),className:`color-button ${z==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),et.jsx("button",{onClick:()=>G("#00AA00"),className:`color-button ${z==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),et.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[et.jsxs("button",{onClick:()=>D("pen"),className:`tool-icon-button ${v==="pen"?"active":""}`,title:"Pen",children:[et.jsx("i",{className:"pi pi-pencil tool-icon"}),et.jsx("span",{className:"tool-label",children:"Pen"})]}),et.jsxs("button",{onClick:()=>D("eraser"),className:`tool-icon-button ${v==="eraser"?"active":""}`,title:"Eraser",children:[et.jsx("i",{className:"pi pi-eraser tool-icon"}),et.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),et.jsx("div",{className:"brush-size-control",children:et.jsxs("div",{className:"brush-slider-container",children:[et.jsx("input",{type:"range",min:"1",max:"10",value:N,onChange:zt=>M(parseInt(zt.target.value)),className:"brush-slider"}),et.jsx("span",{className:"brush-value",children:N})]})})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),et.jsx("button",{className:`input-mode-toggle ${A==="all"?"all-inputs":""}`,onClick:jt,children:A==="stylus-only"?"Stylus mode (pen only)":"All inputs"})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),et.jsxs("div",{className:"history-buttons",children:[et.jsx("button",{onClick:$,className:"history-button",disabled:U.current.length===0,children:"Undo"}),et.jsx("button",{onClick:nt,className:"history-button",disabled:P.current.length===0,children:"Redo"}),et.jsx("button",{onClick:ht,className:"history-button danger",children:"Clear"})]})]})]}),et.jsx("div",{className:"student-canvas-panel",ref:I,children:et.jsx("div",{className:"student-canvas-frame",children:et.jsx("div",{className:"student-canvas-surface",style:{width:`${Z.width}px`,height:`${Z.height}px`},children:et.jsxs(nv,{ref:X,width:Z.width,height:Z.height,onPointerDown:it,onPointerMove:q,onPointerUp:F,onPointerLeave:F,onTouchStart:zt=>{var ft,xt;(xt=(ft=zt.evt)==null?void 0:ft.preventDefault)==null||xt.call(ft)},onTouchMove:zt=>{var ft,xt;(xt=(ft=zt.evt)==null?void 0:ft.preventDefault)==null||xt.call(ft)},onTouchEnd:zt=>{var ft,xt;(xt=(ft=zt.evt)==null?void 0:ft.preventDefault)==null||xt.call(ft)},className:"canvas-stage",style:{touchAction:"none"},perfectDrawEnabled:!1,children:[et.jsx(sl,{listening:!1,children:et.jsx(Z8,{sharedImage:E,canvasWidth:Z.width,canvasHeight:Z.height})}),et.jsx(sl,{children:g.map((zt,ft)=>et.jsx(lf,{points:pe(zt.points),stroke:zt.color,strokeWidth:xe(zt),tension:.5,lineCap:"round",lineJoin:"round"},`student-${ft}`))}),et.jsx(sl,{listening:!1,children:_.map((zt,ft)=>et.jsx(lf,{points:pe(zt.points),stroke:zt.color,strokeWidth:xe(zt),tension:.5,lineCap:"round",lineJoin:"round"},`teacher-${ft}`))})]})})})})]})]})})}var Gp,sy;function $8(){if(sy)return Gp;sy=1;function o(l){return typeof l=="string"&&(l=l.indexOf(":")==-1?{token:l}:{key:l}),l.promises=!0,l}var t=uS(),n=function(l,f,d,g){return new t.ErrorInfo(l,f,d,g)},i=function(l){return new t.Rest(o(l))};Object.assign(i,t.Rest);var r=function(l){return new t.Realtime(o(l))};return Object.assign(r,t.Realtime),Gp={ErrorInfo:n,Rest:i,Realtime:r},Gp}var t_=$8();const e_=cf(t_);var Yc={},Hp,ly;function n_(){return ly||(ly=1,Hp=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Hp}var Pp={},Jl={},oy;function mu(){if(oy)return Jl;oy=1;let o;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Jl.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},Jl.getSymbolTotalCodewords=function(i){return t[i]},Jl.getBCHDigit=function(n){let i=0;for(;n!==0;)i++,n>>>=1;return i},Jl.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');o=i},Jl.isKanjiModeEnabled=function(){return typeof o<"u"},Jl.toSJIS=function(i){return o(i)},Jl}var Ip={},uy;function iv(){return uy||(uy=1,(function(o){o.L={bit:1},o.M={bit:0},o.Q={bit:3},o.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return o.L;case"m":case"medium":return o.M;case"q":case"quartile":return o.Q;case"h":case"high":return o.H;default:throw new Error("Unknown EC Level: "+n)}}o.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},o.from=function(i,r){if(o.isValid(i))return i;try{return t(i)}catch{return r}}})(Ip)),Ip}var kp,cy;function i_(){if(cy)return kp;cy=1;function o(){this.buffer=[],this.length=0}return o.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let i=0;i<n;i++)this.putBit((t>>>n-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},kp=o,kp}var qp,fy;function a_(){if(fy)return qp;fy=1;function o(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return o.prototype.set=function(t,n,i,r){const l=t*this.size+n;this.data[l]=i,r&&(this.reservedBit[l]=!0)},o.prototype.get=function(t,n){return this.data[t*this.size+n]},o.prototype.xor=function(t,n,i){this.data[t*this.size+n]^=i},o.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},qp=o,qp}var Vp={},hy;function r_(){return hy||(hy=1,(function(o){const t=mu().getSymbolSize;o.getRowColCoords=function(i){if(i===1)return[];const r=Math.floor(i/7)+2,l=t(i),f=l===145?26:Math.ceil((l-13)/(2*r-2))*2,d=[l-7];for(let g=1;g<r-1;g++)d[g]=d[g-1]-f;return d.push(6),d.reverse()},o.getPositions=function(i){const r=[],l=o.getRowColCoords(i),f=l.length;for(let d=0;d<f;d++)for(let g=0;g<f;g++)d===0&&g===0||d===0&&g===f-1||d===f-1&&g===0||r.push([l[d],l[g]]);return r}})(Vp)),Vp}var Yp={},dy;function s_(){if(dy)return Yp;dy=1;const o=mu().getSymbolSize,t=7;return Yp.getPositions=function(i){const r=o(i);return[[0,0],[r-t,0],[0,r-t]]},Yp}var Kp={},gy;function l_(){return gy||(gy=1,(function(o){o.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};o.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},o.from=function(r){return o.isValid(r)?parseInt(r,10):void 0},o.getPenaltyN1=function(r){const l=r.size;let f=0,d=0,g=0,m=null,_=null;for(let C=0;C<l;C++){d=g=0,m=_=null;for(let E=0;E<l;E++){let R=r.get(C,E);R===m?d++:(d>=5&&(f+=t.N1+(d-5)),m=R,d=1),R=r.get(E,C),R===_?g++:(g>=5&&(f+=t.N1+(g-5)),_=R,g=1)}d>=5&&(f+=t.N1+(d-5)),g>=5&&(f+=t.N1+(g-5))}return f},o.getPenaltyN2=function(r){const l=r.size;let f=0;for(let d=0;d<l-1;d++)for(let g=0;g<l-1;g++){const m=r.get(d,g)+r.get(d,g+1)+r.get(d+1,g)+r.get(d+1,g+1);(m===4||m===0)&&f++}return f*t.N2},o.getPenaltyN3=function(r){const l=r.size;let f=0,d=0,g=0;for(let m=0;m<l;m++){d=g=0;for(let _=0;_<l;_++)d=d<<1&2047|r.get(m,_),_>=10&&(d===1488||d===93)&&f++,g=g<<1&2047|r.get(_,m),_>=10&&(g===1488||g===93)&&f++}return f*t.N3},o.getPenaltyN4=function(r){let l=0;const f=r.data.length;for(let g=0;g<f;g++)l+=r.data[g];return Math.abs(Math.ceil(l*100/f/5)-10)*t.N4};function n(i,r,l){switch(i){case o.Patterns.PATTERN000:return(r+l)%2===0;case o.Patterns.PATTERN001:return r%2===0;case o.Patterns.PATTERN010:return l%3===0;case o.Patterns.PATTERN011:return(r+l)%3===0;case o.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(l/3))%2===0;case o.Patterns.PATTERN101:return r*l%2+r*l%3===0;case o.Patterns.PATTERN110:return(r*l%2+r*l%3)%2===0;case o.Patterns.PATTERN111:return(r*l%3+(r+l)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}o.applyMask=function(r,l){const f=l.size;for(let d=0;d<f;d++)for(let g=0;g<f;g++)l.isReserved(g,d)||l.xor(g,d,n(r,g,d))},o.getBestMask=function(r,l){const f=Object.keys(o.Patterns).length;let d=0,g=1/0;for(let m=0;m<f;m++){l(m),o.applyMask(m,r);const _=o.getPenaltyN1(r)+o.getPenaltyN2(r)+o.getPenaltyN3(r)+o.getPenaltyN4(r);o.applyMask(m,r),_<g&&(g=_,d=m)}return d}})(Kp)),Kp}var W0={},py;function cS(){if(py)return W0;py=1;const o=iv(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return W0.getBlocksCount=function(r,l){switch(l){case o.L:return t[(r-1)*4+0];case o.M:return t[(r-1)*4+1];case o.Q:return t[(r-1)*4+2];case o.H:return t[(r-1)*4+3];default:return}},W0.getTotalCodewordsCount=function(r,l){switch(l){case o.L:return n[(r-1)*4+0];case o.M:return n[(r-1)*4+1];case o.Q:return n[(r-1)*4+2];case o.H:return n[(r-1)*4+3];default:return}},W0}var Qp={},Kh={},my;function o_(){if(my)return Kh;my=1;const o=new Uint8Array(512),t=new Uint8Array(256);return(function(){let i=1;for(let r=0;r<255;r++)o[r]=i,t[i]=r,i<<=1,i&256&&(i^=285);for(let r=255;r<512;r++)o[r]=o[r-255]})(),Kh.log=function(i){if(i<1)throw new Error("log("+i+")");return t[i]},Kh.exp=function(i){return o[i]},Kh.mul=function(i,r){return i===0||r===0?0:o[t[i]+t[r]]},Kh}var vy;function u_(){return vy||(vy=1,(function(o){const t=o_();o.mul=function(i,r){const l=new Uint8Array(i.length+r.length-1);for(let f=0;f<i.length;f++)for(let d=0;d<r.length;d++)l[f+d]^=t.mul(i[f],r[d]);return l},o.mod=function(i,r){let l=new Uint8Array(i);for(;l.length-r.length>=0;){const f=l[0];for(let g=0;g<r.length;g++)l[g]^=t.mul(r[g],f);let d=0;for(;d<l.length&&l[d]===0;)d++;l=l.slice(d)}return l},o.generateECPolynomial=function(i){let r=new Uint8Array([1]);for(let l=0;l<i;l++)r=o.mul(r,new Uint8Array([1,t.exp(l)]));return r}})(Qp)),Qp}var Xp,yy;function c_(){if(yy)return Xp;yy=1;const o=u_();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(i){this.degree=i,this.genPoly=o.generateECPolynomial(this.degree)},t.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(i.length+this.degree);r.set(i);const l=o.mod(r,this.genPoly),f=this.degree-l.length;if(f>0){const d=new Uint8Array(this.degree);return d.set(l,f),d}return l},Xp=t,Xp}var Fp={},Jp={},Zp={},Sy;function fS(){return Sy||(Sy=1,Zp.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),Zp}var os={},by;function hS(){if(by)return os;by=1;const o="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;os.KANJI=new RegExp(n,"g"),os.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),os.BYTE=new RegExp(i,"g"),os.NUMERIC=new RegExp(o,"g"),os.ALPHANUMERIC=new RegExp(t,"g");const r=new RegExp("^"+n+"$"),l=new RegExp("^"+o+"$"),f=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return os.testKanji=function(g){return r.test(g)},os.testNumeric=function(g){return l.test(g)},os.testAlphanumeric=function(g){return f.test(g)},os}var _y;function vu(){return _y||(_y=1,(function(o){const t=fS(),n=hS();o.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},o.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},o.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},o.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},o.MIXED={bit:-1},o.getCharCountIndicator=function(l,f){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!t.isValid(f))throw new Error("Invalid version: "+f);return f>=1&&f<10?l.ccBits[0]:f<27?l.ccBits[1]:l.ccBits[2]},o.getBestModeForData=function(l){return n.testNumeric(l)?o.NUMERIC:n.testAlphanumeric(l)?o.ALPHANUMERIC:n.testKanji(l)?o.KANJI:o.BYTE},o.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},o.isValid=function(l){return l&&l.bit&&l.ccBits};function i(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return o.NUMERIC;case"alphanumeric":return o.ALPHANUMERIC;case"kanji":return o.KANJI;case"byte":return o.BYTE;default:throw new Error("Unknown mode: "+r)}}o.from=function(l,f){if(o.isValid(l))return l;try{return i(l)}catch{return f}}})(Jp)),Jp}var Ey;function f_(){return Ey||(Ey=1,(function(o){const t=mu(),n=cS(),i=iv(),r=vu(),l=fS(),f=7973,d=t.getBCHDigit(f);function g(E,R,v){for(let D=1;D<=40;D++)if(R<=o.getCapacity(D,v,E))return D}function m(E,R){return r.getCharCountIndicator(E,R)+4}function _(E,R){let v=0;return E.forEach(function(D){const z=m(D.mode,R);v+=z+D.getBitsLength()}),v}function C(E,R){for(let v=1;v<=40;v++)if(_(E,v)<=o.getCapacity(v,R,r.MIXED))return v}o.from=function(R,v){return l.isValid(R)?parseInt(R,10):v},o.getCapacity=function(R,v,D){if(!l.isValid(R))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=r.BYTE);const z=t.getSymbolTotalCodewords(R),G=n.getTotalCodewordsCount(R,v),N=(z-G)*8;if(D===r.MIXED)return N;const M=N-m(D,R);switch(D){case r.NUMERIC:return Math.floor(M/10*3);case r.ALPHANUMERIC:return Math.floor(M/11*2);case r.KANJI:return Math.floor(M/13);case r.BYTE:default:return Math.floor(M/8)}},o.getBestVersionForData=function(R,v){let D;const z=i.from(v,i.M);if(Array.isArray(R)){if(R.length>1)return C(R,z);if(R.length===0)return 1;D=R[0]}else D=R;return g(D.mode,D.getLength(),z)},o.getEncodedBits=function(R){if(!l.isValid(R)||R<7)throw new Error("Invalid QR Code version");let v=R<<12;for(;t.getBCHDigit(v)-d>=0;)v^=f<<t.getBCHDigit(v)-d;return R<<12|v}})(Fp)),Fp}var Wp={},Cy;function h_(){if(Cy)return Wp;Cy=1;const o=mu(),t=1335,n=21522,i=o.getBCHDigit(t);return Wp.getEncodedBits=function(l,f){const d=l.bit<<3|f;let g=d<<10;for(;o.getBCHDigit(g)-i>=0;)g^=t<<o.getBCHDigit(g)-i;return(d<<10|g)^n},Wp}var $p={},tm,Ty;function d_(){if(Ty)return tm;Ty=1;const o=vu();function t(n){this.mode=o.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(i){let r,l,f;for(r=0;r+3<=this.data.length;r+=3)l=this.data.substr(r,3),f=parseInt(l,10),i.put(f,10);const d=this.data.length-r;d>0&&(l=this.data.substr(r),f=parseInt(l,10),i.put(f,d*3+1))},tm=t,tm}var em,Ay;function g_(){if(Ay)return em;Ay=1;const o=vu(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(i){this.mode=o.ALPHANUMERIC,this.data=i}return n.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let l;for(l=0;l+2<=this.data.length;l+=2){let f=t.indexOf(this.data[l])*45;f+=t.indexOf(this.data[l+1]),r.put(f,11)}this.data.length%2&&r.put(t.indexOf(this.data[l]),6)},em=n,em}var nm,Oy;function p_(){if(Oy)return nm;Oy=1;const o=vu();function t(n){this.mode=o.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(i){return i*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let i=0,r=this.data.length;i<r;i++)n.put(this.data[i],8)},nm=t,nm}var im,Ry;function m_(){if(Ry)return im;Ry=1;const o=vu(),t=mu();function n(i){this.mode=o.KANJI,this.data=i}return n.getBitsLength=function(r){return r*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(i){let r;for(r=0;r<this.data.length;r++){let l=t.toSJIS(this.data[r]);if(l>=33088&&l<=40956)l-=33088;else if(l>=57408&&l<=60351)l-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);l=(l>>>8&255)*192+(l&255),i.put(l,13)}},im=n,im}var am={exports:{}},wy;function v_(){return wy||(wy=1,(function(o){var t={single_source_shortest_paths:function(n,i,r){var l={},f={};f[i]=0;var d=t.PriorityQueue.make();d.push(i,0);for(var g,m,_,C,E,R,v,D,z;!d.empty();){g=d.pop(),m=g.value,C=g.cost,E=n[m]||{};for(_ in E)E.hasOwnProperty(_)&&(R=E[_],v=C+R,D=f[_],z=typeof f[_]>"u",(z||D>v)&&(f[_]=v,d.push(_,v),l[_]=m))}if(typeof r<"u"&&typeof f[r]>"u"){var G=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(G)}return l},extract_shortest_path_from_predecessor_list:function(n,i){for(var r=[],l=i;l;)r.push(l),n[l],l=n[l];return r.reverse(),r},find_path:function(n,i,r){var l=t.single_source_shortest_paths(n,i,r);return t.extract_shortest_path_from_predecessor_list(l,r)},PriorityQueue:{make:function(n){var i=t.PriorityQueue,r={},l;n=n||{};for(l in i)i.hasOwnProperty(l)&&(r[l]=i[l]);return r.queue=[],r.sorter=n.sorter||i.default_sorter,r},default_sorter:function(n,i){return n.cost-i.cost},push:function(n,i){var r={value:n,cost:i};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};o.exports=t})(am)),am.exports}var xy;function y_(){return xy||(xy=1,(function(o){const t=vu(),n=d_(),i=g_(),r=p_(),l=m_(),f=hS(),d=mu(),g=v_();function m(G){return unescape(encodeURIComponent(G)).length}function _(G,N,M){const L=[];let w;for(;(w=G.exec(M))!==null;)L.push({data:w[0],index:w.index,mode:N,length:w[0].length});return L}function C(G){const N=_(f.NUMERIC,t.NUMERIC,G),M=_(f.ALPHANUMERIC,t.ALPHANUMERIC,G);let L,w;return d.isKanjiModeEnabled()?(L=_(f.BYTE,t.BYTE,G),w=_(f.KANJI,t.KANJI,G)):(L=_(f.BYTE_KANJI,t.BYTE,G),w=[]),N.concat(M,L,w).sort(function(O,y){return O.index-y.index}).map(function(O){return{data:O.data,mode:O.mode,length:O.length}})}function E(G,N){switch(N){case t.NUMERIC:return n.getBitsLength(G);case t.ALPHANUMERIC:return i.getBitsLength(G);case t.KANJI:return l.getBitsLength(G);case t.BYTE:return r.getBitsLength(G)}}function R(G){return G.reduce(function(N,M){const L=N.length-1>=0?N[N.length-1]:null;return L&&L.mode===M.mode?(N[N.length-1].data+=M.data,N):(N.push(M),N)},[])}function v(G){const N=[];for(let M=0;M<G.length;M++){const L=G[M];switch(L.mode){case t.NUMERIC:N.push([L,{data:L.data,mode:t.ALPHANUMERIC,length:L.length},{data:L.data,mode:t.BYTE,length:L.length}]);break;case t.ALPHANUMERIC:N.push([L,{data:L.data,mode:t.BYTE,length:L.length}]);break;case t.KANJI:N.push([L,{data:L.data,mode:t.BYTE,length:m(L.data)}]);break;case t.BYTE:N.push([{data:L.data,mode:t.BYTE,length:m(L.data)}])}}return N}function D(G,N){const M={},L={start:{}};let w=["start"];for(let A=0;A<G.length;A++){const O=G[A],y=[];for(let B=0;B<O.length;B++){const U=O[B],P=""+A+B;y.push(P),M[P]={node:U,lastCount:0},L[P]={};for(let K=0;K<w.length;K++){const Y=w[K];M[Y]&&M[Y].node.mode===U.mode?(L[Y][P]=E(M[Y].lastCount+U.length,U.mode)-E(M[Y].lastCount,U.mode),M[Y].lastCount+=U.length):(M[Y]&&(M[Y].lastCount=U.length),L[Y][P]=E(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,N))}}w=y}for(let A=0;A<w.length;A++)L[w[A]].end=0;return{map:L,table:M}}function z(G,N){let M;const L=t.getBestModeForData(G);if(M=t.from(N,L),M!==t.BYTE&&M.bit<L.bit)throw new Error('"'+G+'" cannot be encoded with mode '+t.toString(M)+`.
 Suggested mode is: `+t.toString(L));switch(M===t.KANJI&&!d.isKanjiModeEnabled()&&(M=t.BYTE),M){case t.NUMERIC:return new n(G);case t.ALPHANUMERIC:return new i(G);case t.KANJI:return new l(G);case t.BYTE:return new r(G)}}o.fromArray=function(N){return N.reduce(function(M,L){return typeof L=="string"?M.push(z(L,null)):L.data&&M.push(z(L.data,L.mode)),M},[])},o.fromString=function(N,M){const L=C(N,d.isKanjiModeEnabled()),w=v(L),A=D(w,M),O=g.find_path(A.map,"start","end"),y=[];for(let B=1;B<O.length-1;B++)y.push(A.table[O[B]].node);return o.fromArray(R(y))},o.rawSplit=function(N){return o.fromArray(C(N,d.isKanjiModeEnabled()))}})($p)),$p}var My;function S_(){if(My)return Pp;My=1;const o=mu(),t=iv(),n=i_(),i=a_(),r=r_(),l=s_(),f=l_(),d=cS(),g=c_(),m=f_(),_=h_(),C=vu(),E=y_();function R(A,O){const y=A.size,B=l.getPositions(O);for(let U=0;U<B.length;U++){const P=B[U][0],K=B[U][1];for(let Y=-1;Y<=7;Y++)if(!(P+Y<=-1||y<=P+Y))for(let Q=-1;Q<=7;Q++)K+Q<=-1||y<=K+Q||(Y>=0&&Y<=6&&(Q===0||Q===6)||Q>=0&&Q<=6&&(Y===0||Y===6)||Y>=2&&Y<=4&&Q>=2&&Q<=4?A.set(P+Y,K+Q,!0,!0):A.set(P+Y,K+Q,!1,!0))}}function v(A){const O=A.size;for(let y=8;y<O-8;y++){const B=y%2===0;A.set(y,6,B,!0),A.set(6,y,B,!0)}}function D(A,O){const y=r.getPositions(O);for(let B=0;B<y.length;B++){const U=y[B][0],P=y[B][1];for(let K=-2;K<=2;K++)for(let Y=-2;Y<=2;Y++)K===-2||K===2||Y===-2||Y===2||K===0&&Y===0?A.set(U+K,P+Y,!0,!0):A.set(U+K,P+Y,!1,!0)}}function z(A,O){const y=A.size,B=m.getEncodedBits(O);let U,P,K;for(let Y=0;Y<18;Y++)U=Math.floor(Y/3),P=Y%3+y-8-3,K=(B>>Y&1)===1,A.set(U,P,K,!0),A.set(P,U,K,!0)}function G(A,O,y){const B=A.size,U=_.getEncodedBits(O,y);let P,K;for(P=0;P<15;P++)K=(U>>P&1)===1,P<6?A.set(P,8,K,!0):P<8?A.set(P+1,8,K,!0):A.set(B-15+P,8,K,!0),P<8?A.set(8,B-P-1,K,!0):P<9?A.set(8,15-P-1+1,K,!0):A.set(8,15-P-1,K,!0);A.set(B-8,8,1,!0)}function N(A,O){const y=A.size;let B=-1,U=y-1,P=7,K=0;for(let Y=y-1;Y>0;Y-=2)for(Y===6&&Y--;;){for(let Q=0;Q<2;Q++)if(!A.isReserved(U,Y-Q)){let V=!1;K<O.length&&(V=(O[K]>>>P&1)===1),A.set(U,Y-Q,V),P--,P===-1&&(K++,P=7)}if(U+=B,U<0||y<=U){U-=B,B=-B;break}}}function M(A,O,y){const B=new n;y.forEach(function(Q){B.put(Q.mode.bit,4),B.put(Q.getLength(),C.getCharCountIndicator(Q.mode,A)),Q.write(B)});const U=o.getSymbolTotalCodewords(A),P=d.getTotalCodewordsCount(A,O),K=(U-P)*8;for(B.getLengthInBits()+4<=K&&B.put(0,4);B.getLengthInBits()%8!==0;)B.putBit(0);const Y=(K-B.getLengthInBits())/8;for(let Q=0;Q<Y;Q++)B.put(Q%2?17:236,8);return L(B,A,O)}function L(A,O,y){const B=o.getSymbolTotalCodewords(O),U=d.getTotalCodewordsCount(O,y),P=B-U,K=d.getBlocksCount(O,y),Y=B%K,Q=K-Y,V=Math.floor(B/K),j=Math.floor(P/K),I=j+1,X=V-j,Z=new g(X);let at=0;const J=new Array(K),rt=new Array(K);let it=0;const q=new Uint8Array(A.buffer);for(let Tt=0;Tt<K;Tt++){const jt=Tt<Q?j:I;J[Tt]=q.slice(at,at+jt),rt[Tt]=Z.encode(J[Tt]),at+=jt,it=Math.max(it,jt)}const F=new Uint8Array(B);let $=0,nt,ht;for(nt=0;nt<it;nt++)for(ht=0;ht<K;ht++)nt<J[ht].length&&(F[$++]=J[ht][nt]);for(nt=0;nt<X;nt++)for(ht=0;ht<K;ht++)F[$++]=rt[ht][nt];return F}function w(A,O,y,B){let U;if(Array.isArray(A))U=E.fromArray(A);else if(typeof A=="string"){let V=O;if(!V){const j=E.rawSplit(A);V=m.getBestVersionForData(j,y)}U=E.fromString(A,V||40)}else throw new Error("Invalid data");const P=m.getBestVersionForData(U,y);if(!P)throw new Error("The amount of data is too big to be stored in a QR Code");if(!O)O=P;else if(O<P)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+P+`.
`);const K=M(O,y,U),Y=o.getSymbolSize(O),Q=new i(Y);return R(Q,O),v(Q),D(Q,O),G(Q,y,0),O>=7&&z(Q,O),N(Q,K),isNaN(B)&&(B=f.getBestMask(Q,G.bind(null,Q,y))),f.applyMask(B,Q),G(Q,y,B),{modules:Q,version:O,errorCorrectionLevel:y,maskPattern:B,segments:U}}return Pp.create=function(O,y){if(typeof O>"u"||O==="")throw new Error("No input text");let B=t.M,U,P;return typeof y<"u"&&(B=t.from(y.errorCorrectionLevel,t.M),U=m.from(y.version),P=f.from(y.maskPattern),y.toSJISFunc&&o.setToSJISFunction(y.toSJISFunc)),w(O,U,B,P)},Pp}var rm={},sm={},Ny;function dS(){return Ny||(Ny=1,(function(o){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let i=n.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+n);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(l){return[l,l]}))),i.length===6&&i.push("F","F");const r=parseInt(i.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+i.slice(0,6).join("")}}o.getOptions=function(i){i||(i={}),i.color||(i.color={});const r=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,l=i.width&&i.width>=21?i.width:void 0,f=i.scale||4;return{width:l,scale:l?4:f,margin:r,color:{dark:t(i.color.dark||"#000000ff"),light:t(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},o.getScale=function(i,r){return r.width&&r.width>=i+r.margin*2?r.width/(i+r.margin*2):r.scale},o.getImageWidth=function(i,r){const l=o.getScale(i,r);return Math.floor((i+r.margin*2)*l)},o.qrToImageData=function(i,r,l){const f=r.modules.size,d=r.modules.data,g=o.getScale(f,l),m=Math.floor((f+l.margin*2)*g),_=l.margin*g,C=[l.color.light,l.color.dark];for(let E=0;E<m;E++)for(let R=0;R<m;R++){let v=(E*m+R)*4,D=l.color.light;if(E>=_&&R>=_&&E<m-_&&R<m-_){const z=Math.floor((E-_)/g),G=Math.floor((R-_)/g);D=C[d[z*f+G]?1:0]}i[v++]=D.r,i[v++]=D.g,i[v++]=D.b,i[v]=D.a}}})(sm)),sm}var Dy;function b_(){return Dy||(Dy=1,(function(o){const t=dS();function n(r,l,f){r.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=f,l.width=f,l.style.height=f+"px",l.style.width=f+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}o.render=function(l,f,d){let g=d,m=f;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),f||(m=i()),g=t.getOptions(g);const _=t.getImageWidth(l.modules.size,g),C=m.getContext("2d"),E=C.createImageData(_,_);return t.qrToImageData(E.data,l,g),n(C,m,_),C.putImageData(E,0,0),m},o.renderToDataURL=function(l,f,d){let g=d;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),g||(g={});const m=o.render(l,f,g),_=g.type||"image/png",C=g.rendererOpts||{};return m.toDataURL(_,C.quality)}})(rm)),rm}var lm={},jy;function __(){if(jy)return lm;jy=1;const o=dS();function t(r,l){const f=r.a/255,d=l+'="'+r.hex+'"';return f<1?d+" "+l+'-opacity="'+f.toFixed(2).slice(1)+'"':d}function n(r,l,f){let d=r+l;return typeof f<"u"&&(d+=" "+f),d}function i(r,l,f){let d="",g=0,m=!1,_=0;for(let C=0;C<r.length;C++){const E=Math.floor(C%l),R=Math.floor(C/l);!E&&!m&&(m=!0),r[C]?(_++,C>0&&E>0&&r[C-1]||(d+=m?n("M",E+f,.5+R+f):n("m",g,0),g=0,m=!1),E+1<l&&r[C+1]||(d+=n("h",_),_=0)):g++}return d}return lm.render=function(l,f,d){const g=o.getOptions(f),m=l.modules.size,_=l.modules.data,C=m+g.margin*2,E=g.color.light.a?"<path "+t(g.color.light,"fill")+' d="M0 0h'+C+"v"+C+'H0z"/>':"",R="<path "+t(g.color.dark,"stroke")+' d="'+i(_,m,g.margin)+'"/>',v='viewBox="0 0 '+C+" "+C+'"',z='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+v+' shape-rendering="crispEdges">'+E+R+`</svg>
`;return typeof d=="function"&&d(null,z),z},lm}var Uy;function E_(){if(Uy)return Yc;Uy=1;const o=n_(),t=S_(),n=b_(),i=__();function r(l,f,d,g,m){const _=[].slice.call(arguments,1),C=_.length,E=typeof _[C-1]=="function";if(!E&&!o())throw new Error("Callback required as last argument");if(E){if(C<2)throw new Error("Too few arguments provided");C===2?(m=d,d=f,f=g=void 0):C===3&&(f.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=d,d=f,f=void 0))}else{if(C<1)throw new Error("Too few arguments provided");return C===1?(d=f,f=g=void 0):C===2&&!f.getContext&&(g=d,d=f,f=void 0),new Promise(function(R,v){try{const D=t.create(d,g);R(l(D,f,g))}catch(D){v(D)}})}try{const R=t.create(d,g);m(null,l(R,f,g))}catch(R){m(R)}}return Yc.create=t.create,Yc.toCanvas=r.bind(null,n.render),Yc.toDataURL=r.bind(null,n.renderToDataURL),Yc.toString=r.bind(null,function(l,f,d){return i.render(l,d)}),Yc}var C_=E_();const T_=cf(C_),gS=({active:o=!1,size:t=20})=>{const n=o?"#ff4d4f":"#b8c1cc",i=o?"#ff4d4f":"transparent";return et.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[et.jsx("path",{d:"M5 2.5V17.5",stroke:n,strokeWidth:"1.6",strokeLinecap:"round"}),et.jsx("path",{d:"M5 3h10l-2 3 2 3H5V3Z",fill:i,stroke:n,strokeWidth:"1.4",strokeLinejoin:"round"})]})},A_=({student:o,onClick:t,onToggleFlag:n,teacherAnnotations:i=[],sharedImage:r,hideNames:l=!1})=>{var L,w,A,O;const f=mt.useRef(null),d=mt.useRef(null),[g,m]=mt.useState(null),[_,C]=mt.useState(300);mt.useEffect(()=>{if(!r){m(null);return}const y=new window.Image;y.src=r.dataUrl,y.onload=()=>{m(y)}},[r]),mt.useEffect(()=>{if(!d.current)return;const y=()=>{d.current&&C(d.current.clientWidth)};y();const B=new ResizeObserver(y);return B.observe(d.current),()=>B.disconnect()},[]);const E=()=>{if(o!=null&&o.name)return o.name;if(!(o!=null&&o.clientId))return"Unknown Student";const y=o.clientId.match(/student-(\d+)/);return y?`Student ${y[1]}`:o.clientId},R=()=>{if(!o.lastUpdate)return"Just joined";const y=Math.floor((Date.now()-o.lastUpdate)/1e3);return y<5?"Just now":y<60?`${y}s ago`:`${Math.floor(y/60)}m ago`},v=((w=(L=o.meta)==null?void 0:L.base)==null?void 0:w.width)||800,D=((O=(A=o.meta)==null?void 0:A.base)==null?void 0:O.height)||600,z=_/v,G=y=>{y.stopPropagation(),n&&n(o.clientId)},M=(()=>{if(!r||!g)return null;const y=r.width/r.height,B=v/D;let U,P,K,Y;return y>B?(U=v,P=v/y,K=0,Y=(D-P)/2):(P=D,U=D*y,K=(v-U)/2,Y=0),{x:K,y:Y,width:U,height:P}})();return et.jsxs("div",{className:`student-card ${o.isActive?"active":"inactive"}`,onClick:()=>t(o),children:[et.jsxs("div",{className:"student-card-header",children:[et.jsxs("div",{className:"student-name",children:[et.jsx("span",{className:"student-icon",children:"👤"}),l?"•••":E()]}),et.jsxs("div",{className:"student-header-actions",children:[et.jsx("button",{className:`flag-button ${o.isFlagged?"active":""}`,onClick:G,"aria-label":o.isFlagged?"Remove flag":"Flag student",title:o.isFlagged?"Remove flag":"Flag student",children:et.jsx(gS,{active:o.isFlagged,size:18})}),et.jsx("div",{className:"student-status",children:et.jsx("span",{className:`status-dot ${o.isActive?"online":"offline"}`})})]})]}),et.jsxs("div",{className:"student-card-canvas",ref:d,children:[et.jsxs(nv,{ref:f,width:v,height:D,scaleX:z,scaleY:z,style:{transformOrigin:"top left",width:"100%",height:"100%"},children:[M&&et.jsx(sl,{listening:!1,children:et.jsx(ev,{image:g,x:M.x,y:M.y,width:M.width,height:M.height})}),et.jsx(sl,{children:o.lines&&o.lines.map((y,B)=>et.jsx(lf,{points:y.points,stroke:y.color||"black",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`preview-${o.clientId}-${B}`))}),et.jsx(sl,{children:i.map((y,B)=>et.jsx(lf,{points:y.points,stroke:y.color||"#FF0000",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${o.clientId}-${B}`))})]}),(!o.lines||o.lines.length===0)&&et.jsxs("div",{className:"no-drawing",children:[et.jsx("span",{children:"✏️"}),et.jsx("p",{children:"No drawing yet"})]}),o.lines&&o.lines.length>0&&et.jsxs("div",{className:"stroke-count",children:[o.lines.length," stroke",o.lines.length!==1?"s":""]})]}),et.jsxs("div",{className:"student-card-footer",children:[et.jsx("span",{className:"last-update",children:R()}),et.jsx("span",{className:"click-hint",children:"Click to annotate →"})]})]})},Kc={width:800,height:600},$0="teacherAnnotationPrefs",om=2,By=[{label:"Red",value:"#FF3B30"},{label:"Purple",value:"#7C3AED"},{label:"Teal",value:"#0EA5E9"}],O_=({student:o,isOpen:t,onClose:n,onAnnotate:i,existingAnnotations:r=[],isFlagged:l=!1,onToggleFlag:f,sharedImage:d})=>{const[g,m]=mt.useState("pen"),[_,C]=mt.useState(By[0].value),[E,R]=mt.useState(3),[v,D]=mt.useState(!1),[z,G]=mt.useState([]),[N,M]=mt.useState("stylus-only"),[L,w]=mt.useState("left"),[A,O]=mt.useState(null),y=mt.useRef([]),B=mt.useRef([]),U=mt.useRef(!1),P=mt.useRef(null),K=mt.useRef(!0),Y=mt.useRef(null),Q=mt.useRef(null);mt.useEffect(()=>{if(!d){O(null);return}const ft=new window.Image;ft.src=d.dataUrl,ft.onload=()=>{O(ft)}},[d]);const V=mt.useRef(null),j=mt.useRef(null),[I,X]=mt.useState({width:960,height:720}),Z=mt.useMemo(()=>({x:I.width/Kc.width,y:I.height/Kc.height}),[I]);mt.useEffect(()=>{if(!(typeof window>"u")){console.log("🟣 [TEACHER ANNOTATION] Loading preferences from localStorage...");try{const ft=localStorage.getItem($0);if(ft){const xt=JSON.parse(ft);if(console.log("🟣 [TEACHER ANNOTATION] Found stored preferences:",xt),xt.version!==om){console.log("🟣 [TEACHER ANNOTATION] Version mismatch! Expected:",om,"Got:",xt.version),console.log("🟣 [TEACHER ANNOTATION] Clearing old preferences..."),localStorage.removeItem($0);return}console.log("🟣 [TEACHER ANNOTATION] Applying preferences..."),xt.tool&&m(xt.tool),xt.color&&C(xt.color),typeof xt.brushSize=="number"&&R(xt.brushSize),xt.inputMode&&M(xt.inputMode),xt.toolbarPosition&&w(xt.toolbarPosition),console.log("🟣 [TEACHER ANNOTATION] Preferences loaded successfully!")}else console.log("🟣 [TEACHER ANNOTATION] No stored preferences found, using defaults")}catch(ft){console.warn("🟣 [TEACHER ANNOTATION] Failed to load teacher annotation prefs",ft),localStorage.removeItem($0)}}},[]),mt.useEffect(()=>{if(typeof window>"u")return;if(K.current){K.current=!1,console.log("💾 [TEACHER ANNOTATION] Skipping save on first render");return}const ft={version:om,tool:g,color:_,brushSize:E,inputMode:N,toolbarPosition:L};console.log("💾 [TEACHER ANNOTATION] Saving preferences to localStorage:",ft),localStorage.setItem($0,JSON.stringify(ft))},[g,_,E,N,L]),mt.useEffect(()=>{t&&o&&o.clientId!==P.current&&(P.current=o.clientId,G(r),y.current=[],B.current=[])},[t,o,r]),mt.useEffect(()=>{t&&o&&G(r)},[r,t,o]),mt.useEffect(()=>()=>{Q.current&&cancelAnimationFrame(Q.current)},[]),mt.useEffect(()=>{if(t){const ft=document.body.style.overflow,xt=document.body.style.position,Qt=document.body.style.touchAction;document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.touchAction="none";const Jt=ae=>{ae.preventDefault()},$t=ae=>{ae.preventDefault()},ve=ae=>{if(v)return ae.preventDefault(),!1};return document.addEventListener("touchstart",Jt,{passive:!1}),document.addEventListener("touchmove",Jt,{passive:!1}),document.addEventListener("gesturestart",$t,{passive:!1}),document.addEventListener("gesturechange",$t,{passive:!1}),document.addEventListener("selectstart",ve),()=>{document.body.style.overflow=ft,document.body.style.position=xt,document.body.style.touchAction=Qt,document.removeEventListener("touchstart",Jt),document.removeEventListener("touchmove",Jt),document.removeEventListener("gesturestart",$t),document.removeEventListener("gesturechange",$t),document.removeEventListener("selectstart",ve)}}},[t,v]),mt.useEffect(()=>{if(!t)return;const ft=()=>{if(!V.current)return;const xt=V.current.getBoundingClientRect(),$t=24+4,ve=Math.max(320,xt.width-$t),ae=Math.max(240,xt.height-$t),ln=ve/Kc.width,Sn=ae/Kc.height,We=Math.min(ln,Sn);X({width:Math.round(Kc.width*We),height:Math.round(Kc.height*We)})};return ft(),window.addEventListener("resize",ft),()=>window.removeEventListener("resize",ft)},[L,t]);const at=()=>{if(!d||!A)return null;const ft=d.width/d.height,xt=I.width/I.height;let Qt,Jt,$t,ve;return ft>xt?(Qt=I.width,Jt=I.width/ft,$t=0,ve=(I.height-Jt)/2):(Jt=I.height,Qt=I.height*ft,$t=(I.width-Qt)/2,ve=0),{x:$t,y:ve,width:Qt,height:Jt}};if(!t||!o)return null;const J=at(),rt=()=>{if(o.name)return o.name;const ft=o.clientId.match(/student-(\d+)/)||o.clientId.match(/load-test-student-(\d+)/);return ft?`Student ${ft[1]}`:o.clientId},it=ft=>N!=="stylus-only"?!0:(ft==null?void 0:ft.pointerType)==="pen",q=(ft=[])=>ft.map((xt,Qt)=>Qt%2===0?xt*Z.x:xt*Z.y),F=ft=>({x:ft.x/Z.x,y:ft.y/Z.y}),$=ft=>(ft.strokeWidth||3)*Z.x,nt=ft=>{const xt=ft.evt;if(xt!=null&&xt.preventDefault&&xt.preventDefault(),xt!=null&&xt.stopPropagation&&xt.stopPropagation(),!it(xt))return;const Qt=ft.target.getStage();if(Qt&&xt.pointerId!==void 0){const Jt=Qt.content;if(Jt&&Jt.setPointerCapture)try{Jt.setPointerCapture(xt.pointerId)}catch{}}if(g==="pen"){D(!0);const Jt=Qt.getPointerPosition(),{x:$t,y:ve}=F(Jt),ae={tool:"pen",points:[$t,ve],color:_,strokeWidth:E};y.current.push([...z]),B.current=[],Y.current=ae,G([...z,ae])}else g==="eraser"&&(D(!0),U.current=!1)},ht=ft=>{const xt=ft.evt;if(xt!=null&&xt.preventDefault&&xt.preventDefault(),xt!=null&&xt.stopPropagation&&xt.stopPropagation(),!v||!it(xt))return;const Jt=ft.target.getStage().getPointerPosition();if(g==="pen"){if(Y.current){const{x:$t,y:ve}=F(Jt);Y.current.points=Y.current.points.concat([$t,ve]);const ae=Y.current;Q.current&&cancelAnimationFrame(Q.current),Q.current=requestAnimationFrame(()=>{ae&&G(ln=>ln.length===0?ln:[...ln.slice(0,-1),ae])})}}else if(g==="eraser"){const $t=z.length,ve=20,ae=z.filter(ln=>{for(let Sn=0;Sn<ln.points.length;Sn+=2){const We=ln.points[Sn]*Z.x,ut=ln.points[Sn+1]*Z.y;if(Math.sqrt(Math.pow(We-Jt.x,2)+Math.pow(ut-Jt.y,2))<ve)return!1}return!0});ae.length<$t&&!U.current&&(y.current.push([...z]),B.current=[],U.current=!0),G(ae)}},Tt=ft=>{const xt=ft==null?void 0:ft.evt;if(!it(xt)){xt!=null&&xt.preventDefault&&xt.preventDefault();return}if(D(!1),Q.current&&(cancelAnimationFrame(Q.current),Q.current=null),Y.current&&g==="pen"){const Qt=Y.current;G(Jt=>{if(Jt.length===0)return Jt;const $t=[...Jt.slice(0,-1),Qt];return setTimeout(()=>i($t),0),$t}),Y.current=null}else setTimeout(()=>i(z),0)},jt=()=>{if(y.current.length>0){const ft=y.current.pop();B.current.push([...z]),G(ft),i(ft)}},Kt=()=>{if(B.current.length>0){const ft=B.current.pop();y.current.push([...z]),G(ft),i(ft)}},Wt=()=>{y.current.push([...z]),B.current=[];const ft=[];G(ft),i(ft)},ge=()=>{f&&f(o.clientId)},Pt=()=>{D(!1),n()},pe=()=>{M(ft=>ft==="stylus-only"?"all":"stylus-only")},xe=()=>{w(ft=>ft==="left"?"right":"left")},zt=ft=>{ft.preventDefault(),ft.stopPropagation()};return et.jsx("div",{className:"annotation-modal-overlay",onTouchMove:zt,onTouchStart:zt,children:et.jsx("div",{className:"annotation-modal student-console",children:et.jsxs("div",{className:"annotation-console",children:[et.jsxs("div",{className:"annotation-status-bar",children:[et.jsxs("div",{className:"annotation-status-text",children:[et.jsx("h1",{children:"Annotate Student"}),et.jsx("p",{children:rt()})]}),et.jsxs("div",{className:"annotation-status-actions",children:[et.jsx("div",{className:"tool-status-indicator",children:et.jsxs("span",{className:"tool-status-text",children:[et.jsx("i",{className:g==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",N==="all"?"All inputs":"Stylus only"]})}),et.jsxs("button",{className:`flag-pill ${l?"active":""}`,onClick:ge,children:[et.jsx(gS,{active:l,size:16}),l?"Flagged":"Flag"]}),et.jsxs("button",{className:"status-badge",onClick:xe,children:["Move toolbar to ",L==="left"?"right":"left"]}),et.jsx("button",{className:"status-badge danger",onClick:Pt,children:"✕ Close"})]})]}),et.jsxs("div",{className:`annotation-workspace ${L==="right"?"toolbar-right":""}`,children:[et.jsxs("div",{className:"annotation-sidebar",children:[et.jsxs("div",{className:"sidebar-header",children:[et.jsx("h2",{children:"Annotation Console"}),et.jsx("p",{children:"Mirror of student workspace"})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"COLORS"}),et.jsx("div",{className:"color-row",children:By.map(ft=>et.jsx("button",{className:`color-button ${_===ft.value?"active":""}`,style:{background:ft.value},onClick:()=>C(ft.value),"aria-label":ft.label},ft.value))})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),et.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[et.jsxs("button",{onClick:()=>m("pen"),className:`tool-icon-button ${g==="pen"?"active":""}`,title:"Pen",children:[et.jsx("i",{className:"pi pi-pencil tool-icon"}),et.jsx("span",{className:"tool-label",children:"Pen"})]}),et.jsxs("button",{onClick:()=>m("eraser"),className:`tool-icon-button ${g==="eraser"?"active":""}`,title:"Eraser",children:[et.jsx("i",{className:"pi pi-eraser tool-icon"}),et.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),et.jsxs("div",{className:"brush-size-control",children:[et.jsx("input",{type:"range",min:"1",max:"10",value:E,onChange:ft=>R(parseInt(ft.target.value)),className:"brush-slider"}),et.jsx("span",{className:"brush-value",children:E})]})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),et.jsx("button",{className:`input-mode-toggle ${N==="all"?"all":""}`,onClick:pe,children:N==="stylus-only"?"Stylus only":"All inputs"})]}),et.jsxs("div",{className:"sidebar-section",children:[et.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),et.jsxs("div",{className:"history-buttons",children:[et.jsx("button",{onClick:jt,className:"history-button",disabled:y.current.length===0,children:"Undo"}),et.jsx("button",{onClick:Kt,className:"history-button",disabled:B.current.length===0,children:"Redo"}),et.jsx("button",{onClick:Wt,className:"history-button danger",children:"Clear"})]})]})]}),et.jsx("div",{className:"annotation-canvas-panel",children:et.jsx("div",{className:"annotation-canvas-frame",ref:V,onTouchMove:ft=>ft.preventDefault(),onTouchStart:ft=>ft.preventDefault(),children:et.jsxs(nv,{ref:j,width:I.width,height:I.height,onPointerDown:nt,onPointerMove:ht,onPointerUp:Tt,onPointerLeave:Tt,onTouchStart:ft=>ft.preventDefault(),onTouchMove:ft=>ft.preventDefault(),onTouchEnd:ft=>ft.preventDefault(),className:"annotation-stage",perfectDrawEnabled:!1,children:[J&&et.jsx(sl,{listening:!1,children:et.jsx(ev,{image:A,x:J.x,y:J.y,width:J.width,height:J.height})}),et.jsx(sl,{listening:!1,children:o.lines&&o.lines.map((ft,xt)=>et.jsx(lf,{points:q(ft.points),stroke:ft.color||"black",strokeWidth:(ft.strokeWidth||3)*Z.x,tension:.5,lineCap:"round",lineJoin:"round"},`student-${xt}`))}),et.jsx(sl,{children:z.map((ft,xt)=>et.jsx(lf,{points:q(ft.points),stroke:ft.color,strokeWidth:$(ft),tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${xt}`))})]})})})]})]})})})},R_=async(o,t=800,n=600,i=.7)=>{const r=await createImageBitmap(o),l=Math.min(t/r.width,n/r.height,1),f=Math.round(r.width*l),d=Math.round(r.height*l),g=document.createElement("canvas");g.width=f,g.height=d,g.getContext("2d").drawImage(r,0,0,f,d);const _=await new Promise((E,R)=>{g.toBlob(v=>{v?E(v):R(new Error("Failed to compress image"))},"image/jpeg",i)}),C=await new Promise((E,R)=>{const v=new FileReader;v.onload=()=>E(v.result),v.onerror=R,v.readAsDataURL(_)});return{blob:_,dataUrl:C,width:f,height:d,size:_.size}};var Dm=function(o,t){return Dm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},Dm(o,t)};function pS(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Dm(o,t);function n(){this.constructor=o}o.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var gg=function(){return gg=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},gg.apply(this,arguments)};function gf(o,t){var n={};for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&t.indexOf(i)<0&&(n[i]=o[i]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(o);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(o,i[r])&&(n[i[r]]=o[i[r]]);return n}function mS(o,t,n,i){var r=arguments.length,l=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,t,n,i);else for(var d=o.length-1;d>=0;d--)(f=o[d])&&(l=(r<3?f(l):r>3?f(t,n,l):f(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l}function vS(o,t){return function(n,i){t(n,i,o)}}function yS(o,t,n,i,r,l){function f(G){if(G!==void 0&&typeof G!="function")throw new TypeError("Function expected");return G}for(var d=i.kind,g=d==="getter"?"get":d==="setter"?"set":"value",m=!t&&o?i.static?o:o.prototype:null,_=t||(m?Object.getOwnPropertyDescriptor(m,i.name):{}),C,E=!1,R=n.length-1;R>=0;R--){var v={};for(var D in i)v[D]=D==="access"?{}:i[D];for(var D in i.access)v.access[D]=i.access[D];v.addInitializer=function(G){if(E)throw new TypeError("Cannot add initializers after decoration has completed");l.push(f(G||null))};var z=(0,n[R])(d==="accessor"?{get:_.get,set:_.set}:_[g],v);if(d==="accessor"){if(z===void 0)continue;if(z===null||typeof z!="object")throw new TypeError("Object expected");(C=f(z.get))&&(_.get=C),(C=f(z.set))&&(_.set=C),(C=f(z.init))&&r.unshift(C)}else(C=f(z))&&(d==="field"?r.unshift(C):_[g]=C)}m&&Object.defineProperty(m,i.name,_),E=!0}function SS(o,t,n){for(var i=arguments.length>2,r=0;r<t.length;r++)n=i?t[r].call(o,n):t[r].call(o);return i?n:void 0}function bS(o){return typeof o=="symbol"?o:"".concat(o)}function _S(o,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function ES(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function ee(o,t,n,i){function r(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function d(_){try{m(i.next(_))}catch(C){f(C)}}function g(_){try{m(i.throw(_))}catch(C){f(C)}}function m(_){_.done?l(_.value):r(_.value).then(d,g)}m((i=i.apply(o,t||[])).next())})}function CS(o,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,r,l,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=d(0),f.throw=d(1),f.return=d(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function d(m){return function(_){return g([m,_])}}function g(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,r&&(l=m[0]&2?r.return:m[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,m[1])).done)return l;switch(r=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(o,n)}catch(_){m=[6,_],r=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var wg=Object.create?(function(o,t,n,i){i===void 0&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(o,i,r)}):(function(o,t,n,i){i===void 0&&(i=n),o[i]=t[n]});function TS(o,t){for(var n in o)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&wg(t,o,n)}function pg(o){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&o[t],i=0;if(n)return n.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function av(o,t){var n=typeof Symbol=="function"&&o[Symbol.iterator];if(!n)return o;var i=n.call(o),r,l=[],f;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(f)throw f.error}}return l}function AS(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(av(arguments[t]));return o}function OS(){for(var o=0,t=0,n=arguments.length;t<n;t++)o+=arguments[t].length;for(var i=Array(o),r=0,t=0;t<n;t++)for(var l=arguments[t],f=0,d=l.length;f<d;f++,r++)i[r]=l[f];return i}function RS(o,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,l;i<r;i++)(l||!(i in t))&&(l||(l=Array.prototype.slice.call(t,0,i)),l[i]=t[i]);return o.concat(l||Array.prototype.slice.call(t))}function of(o){return this instanceof of?(this.v=o,this):new of(o)}function wS(o,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(o,t||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",f),r[Symbol.asyncIterator]=function(){return this},r;function f(R){return function(v){return Promise.resolve(v).then(R,C)}}function d(R,v){i[R]&&(r[R]=function(D){return new Promise(function(z,G){l.push([R,D,z,G])>1||g(R,D)})},v&&(r[R]=v(r[R])))}function g(R,v){try{m(i[R](v))}catch(D){E(l[0][3],D)}}function m(R){R.value instanceof of?Promise.resolve(R.value.v).then(_,C):E(l[0][2],R)}function _(R){g("next",R)}function C(R){g("throw",R)}function E(R,v){R(v),l.shift(),l.length&&g(l[0][0],l[0][1])}}function xS(o){var t,n;return t={},i("next"),i("throw",function(r){throw r}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(r,l){t[r]=o[r]?function(f){return(n=!n)?{value:of(o[r](f)),done:!1}:l?l(f):f}:l}}function MS(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],n;return t?t.call(o):(o=typeof pg=="function"?pg(o):o[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(l){n[l]=o[l]&&function(f){return new Promise(function(d,g){f=o[l](f),r(d,g,f.done,f.value)})}}function r(l,f,d,g){Promise.resolve(g).then(function(m){l({value:m,done:d})},f)}}function NS(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}var w_=Object.create?(function(o,t){Object.defineProperty(o,"default",{enumerable:!0,value:t})}):function(o,t){o.default=t},jm=function(o){return jm=Object.getOwnPropertyNames||function(t){var n=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[n.length]=i);return n},jm(o)};function DS(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var n=jm(o),i=0;i<n.length;i++)n[i]!=="default"&&wg(t,o,n[i]);return w_(t,o),t}function jS(o){return o&&o.__esModule?o:{default:o}}function US(o,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!i:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(o):i?i.value:t.get(o)}function BS(o,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!r:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(o,n):r?r.value=n:t.set(o,n),n}function zS(o,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?t===o:o.has(t)}function LS(o,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var i,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],n&&(r=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");r&&(i=function(){try{r.call(this)}catch(l){return Promise.reject(l)}}),o.stack.push({value:t,dispose:i,async:n})}else n&&o.stack.push({async:!0});return t}var x_=typeof SuppressedError=="function"?SuppressedError:function(o,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=o,i.suppressed=t,i};function GS(o){function t(l){o.error=o.hasError?new x_(l,o.error,"An error was suppressed during disposal."):l,o.hasError=!0}var n,i=0;function r(){for(;n=o.stack.pop();)try{if(!n.async&&i===1)return i=0,o.stack.push(n),Promise.resolve().then(r);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(l).then(r,function(f){return t(f),r()})}else i|=1}catch(f){t(f)}if(i===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return r()}function HS(o,t){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,i,r,l,f){return i?t?".jsx":".js":r&&(!l||!f)?n:r+l+"."+f.toLowerCase()+"js"}):o}const M_={__extends:pS,__assign:gg,__rest:gf,__decorate:mS,__param:vS,__esDecorate:yS,__runInitializers:SS,__propKey:bS,__setFunctionName:_S,__metadata:ES,__awaiter:ee,__generator:CS,__createBinding:wg,__exportStar:TS,__values:pg,__read:av,__spread:AS,__spreadArrays:OS,__spreadArray:RS,__await:of,__asyncGenerator:wS,__asyncDelegator:xS,__asyncValues:MS,__makeTemplateObject:NS,__importStar:DS,__importDefault:jS,__classPrivateFieldGet:US,__classPrivateFieldSet:BS,__classPrivateFieldIn:zS,__addDisposableResource:LS,__disposeResources:GS,__rewriteRelativeImportExtension:HS},N_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:LS,get __assign(){return gg},__asyncDelegator:xS,__asyncGenerator:wS,__asyncValues:MS,__await:of,__awaiter:ee,__classPrivateFieldGet:US,__classPrivateFieldIn:zS,__classPrivateFieldSet:BS,__createBinding:wg,__decorate:mS,__disposeResources:GS,__esDecorate:yS,__exportStar:TS,__extends:pS,__generator:CS,__importDefault:jS,__importStar:DS,__makeTemplateObject:NS,__metadata:ES,__param:vS,__propKey:bS,__read:av,__rest:gf,__rewriteRelativeImportExtension:HS,__runInitializers:SS,__setFunctionName:_S,__spread:AS,__spreadArray:RS,__spreadArrays:OS,__values:pg,default:M_},Symbol.toStringTag,{value:"Module"})),D_="modulepreload",j_=function(o){return"/"+o},zy={},pf=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){let f=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=f(n.map(m=>{if(m=j_(m),m in zy)return;zy[m]=!0;const _=m.endsWith(".css"),C=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${C}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":D_,_||(E.as="script"),E.crossOrigin="",E.href=m,g&&E.setAttribute("nonce",g),document.head.appendChild(E),_)return new Promise((R,v)=>{E.addEventListener("load",R),E.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(f){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=f,window.dispatchEvent(d),!d.defaultPrevented)throw f}return r.then(f=>{for(const d of f||[])d.status==="rejected"&&l(d.reason);return t().catch(l)})},U_=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>pf(async()=>{const{default:i}=await Promise.resolve().then(()=>yu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)};class rv extends Error{constructor(t,n="FunctionsError",i){super(t),this.name=n,this.context=i}}class Ly extends rv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Gy extends rv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Hy extends rv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Um;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Um||(Um={}));class B_{constructor(t,{headers:n={},customFetch:i,region:r=Um.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=U_(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return ee(this,arguments,void 0,function*(n,i={}){var r;try{const{headers:l,method:f,body:d,signal:g}=i;let m={},{region:_}=i;_||(_=this.region);const C=new URL(`${this.url}/${n}`);_&&_!=="any"&&(m["x-region"]=_,C.searchParams.set("forceFunctionRegion",_));let E;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=d):typeof d=="string"?(m["Content-Type"]="text/plain",E=d):typeof FormData<"u"&&d instanceof FormData?E=d:(m["Content-Type"]="application/json",E=JSON.stringify(d)):E=d;const R=yield this.fetch(C.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),l),body:E,signal:g}).catch(G=>{throw G.name==="AbortError"?G:new Ly(G)}),v=R.headers.get("x-relay-error");if(v&&v==="true")throw new Gy(R);if(!R.ok)throw new Hy(R);let D=((r=R.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),z;return D==="application/json"?z=yield R.json():D==="application/octet-stream"||D==="application/pdf"?z=yield R.blob():D==="text/event-stream"?z=R:D==="multipart/form-data"?z=yield R.formData():z=yield R.text(),{data:z,error:null,response:R}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new Ly(l)}:{data:null,error:l,response:l instanceof Hy||l instanceof Gy?l.context:void 0}}})}}var Ii={};const mf=f2(N_);var tg={},eg={},ng={},ig={},ag={},z_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},uf=z_();const L_=uf.fetch,PS=uf.fetch.bind(uf),IS=uf.Headers,G_=uf.Request,H_=uf.Response,yu=Object.freeze(Object.defineProperty({__proto__:null,Headers:IS,Request:G_,Response:H_,default:PS,fetch:L_},Symbol.toStringTag,{value:"Module"})),P_=f2(yu);var rg={},Py;function kS(){if(Py)return rg;Py=1,Object.defineProperty(rg,"__esModule",{value:!0});class o extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return rg.default=o,rg}var Iy;function qS(){if(Iy)return ag;Iy=1,Object.defineProperty(ag,"__esModule",{value:!0});const o=mf,t=o.__importDefault(P_),n=o.__importDefault(kS());class i{constructor(l){var f,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(f=l.shouldThrowOnError)!==null&&f!==void 0?f:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,f){return this.headers=new Headers(this.headers),this.headers.set(l,f),this}then(l,f){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let g=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var _,C,E,R;let v=null,D=null,z=null,G=m.status,N=m.statusText;if(m.ok){if(this.method!=="HEAD"){const A=await m.text();A===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((_=this.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?D=A:D=JSON.parse(A))}const L=(C=this.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),w=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");L&&w&&w.length>1&&(z=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(D)&&(D.length>1?(v={code:"PGRST116",details:`Results contain ${D.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},D=null,z=null,G=406,N="Not Acceptable"):D.length===1?D=D[0]:D=null)}else{const L=await m.text();try{v=JSON.parse(L),Array.isArray(v)&&m.status===404&&(D=[],v=null,G=200,N="OK")}catch{m.status===404&&L===""?(G=204,N="No Content"):v={message:L}}if(v&&this.isMaybeSingle&&(!((R=v==null?void 0:v.details)===null||R===void 0)&&R.includes("0 rows"))&&(v=null,G=200,N="OK"),v&&this.shouldThrowOnError)throw new n.default(v)}return{error:v,data:D,count:z,status:G,statusText:N}});return this.shouldThrowOnError||(g=g.catch(m=>{var _,C,E;return{error:{message:`${(_=m==null?void 0:m.name)!==null&&_!==void 0?_:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(C=m==null?void 0:m.stack)!==null&&C!==void 0?C:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),g.then(l,f)}returns(){return this}overrideTypes(){return this}}return ag.default=i,ag}var ky;function VS(){if(ky)return ig;ky=1,Object.defineProperty(ig,"__esModule",{value:!0});const t=mf.__importDefault(qS());class n extends t.default{select(r){let l=!1;const f=(r??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:l=!0,nullsFirst:f,foreignTable:d,referencedTable:g=d}={}){const m=g?`${g}.order`:"order",_=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${_?`${_},`:""}${r}.${l?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:l,referencedTable:f=l}={}){const d=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(d,`${r}`),this}range(r,l,{foreignTable:f,referencedTable:d=f}={}){const g=typeof d>"u"?"offset":`${d}.offset`,m=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(g,`${r}`),this.url.searchParams.set(m,`${l-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:l=!1,settings:f=!1,buffers:d=!1,wal:g=!1,format:m="text"}={}){var _;const C=[r?"analyze":null,l?"verbose":null,f?"settings":null,d?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${C};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return ig.default=n,ig}var qy;function sv(){if(qy)return ng;qy=1,Object.defineProperty(ng,"__esModule",{value:!0});const t=mf.__importDefault(VS());class n extends t.default{eq(r,l){return this.url.searchParams.append(r,`eq.${l}`),this}neq(r,l){return this.url.searchParams.append(r,`neq.${l}`),this}gt(r,l){return this.url.searchParams.append(r,`gt.${l}`),this}gte(r,l){return this.url.searchParams.append(r,`gte.${l}`),this}lt(r,l){return this.url.searchParams.append(r,`lt.${l}`),this}lte(r,l){return this.url.searchParams.append(r,`lte.${l}`),this}like(r,l){return this.url.searchParams.append(r,`like.${l}`),this}likeAllOf(r,l){return this.url.searchParams.append(r,`like(all).{${l.join(",")}}`),this}likeAnyOf(r,l){return this.url.searchParams.append(r,`like(any).{${l.join(",")}}`),this}ilike(r,l){return this.url.searchParams.append(r,`ilike.${l}`),this}ilikeAllOf(r,l){return this.url.searchParams.append(r,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(r,l){return this.url.searchParams.append(r,`ilike(any).{${l.join(",")}}`),this}is(r,l){return this.url.searchParams.append(r,`is.${l}`),this}in(r,l){const f=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(r,`in.(${f})`),this}contains(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cs.{${l.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(l)}`),this}containedBy(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cd.{${l.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(l)}`),this}rangeGt(r,l){return this.url.searchParams.append(r,`sr.${l}`),this}rangeGte(r,l){return this.url.searchParams.append(r,`nxl.${l}`),this}rangeLt(r,l){return this.url.searchParams.append(r,`sl.${l}`),this}rangeLte(r,l){return this.url.searchParams.append(r,`nxr.${l}`),this}rangeAdjacent(r,l){return this.url.searchParams.append(r,`adj.${l}`),this}overlaps(r,l){return typeof l=="string"?this.url.searchParams.append(r,`ov.${l}`):this.url.searchParams.append(r,`ov.{${l.join(",")}}`),this}textSearch(r,l,{config:f,type:d}={}){let g="";d==="plain"?g="pl":d==="phrase"?g="ph":d==="websearch"&&(g="w");const m=f===void 0?"":`(${f})`;return this.url.searchParams.append(r,`${g}fts${m}.${l}`),this}match(r){return Object.entries(r).forEach(([l,f])=>{this.url.searchParams.append(l,`eq.${f}`)}),this}not(r,l,f){return this.url.searchParams.append(r,`not.${l}.${f}`),this}or(r,{foreignTable:l,referencedTable:f=l}={}){const d=f?`${f}.or`:"or";return this.url.searchParams.append(d,`(${r})`),this}filter(r,l,f){return this.url.searchParams.append(r,`${l}.${f}`),this}}return ng.default=n,ng}var Vy;function YS(){if(Vy)return eg;Vy=1,Object.defineProperty(eg,"__esModule",{value:!0});const t=mf.__importDefault(sv());class n{constructor(r,{headers:l={},schema:f,fetch:d}){this.url=r,this.headers=new Headers(l),this.schema=f,this.fetch=d}select(r,l){const{head:f=!1,count:d}=l??{},g=f?"HEAD":"GET";let m=!1;const _=(r??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",_),d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:l,defaultToNull:f=!0}={}){var d;const g="POST";if(l&&this.headers.append("Prefer",`count=${l}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((_,C)=>_.concat(Object.keys(C)),[]);if(m.length>0){const _=[...new Set(m)].map(C=>`"${C}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(r,{onConflict:l,ignoreDuplicates:f=!1,count:d,defaultToNull:g=!0}={}){var m;const _="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const C=r.reduce((E,R)=>E.concat(Object.keys(R)),[]);if(C.length>0){const E=[...new Set(C)].map(R=>`"${R}"`);this.url.searchParams.set("columns",E.join(","))}}return new t.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:l}={}){var f;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:r}={}){var l;const f="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return eg.default=n,eg}var Yy;function I_(){if(Yy)return tg;Yy=1,Object.defineProperty(tg,"__esModule",{value:!0});const o=mf,t=o.__importDefault(YS()),n=o.__importDefault(sv());class i{constructor(l,{headers:f={},schema:d,fetch:g}={}){this.url=l,this.headers=new Headers(f),this.schemaName=d,this.fetch=g}from(l){const f=new URL(`${this.url}/${l}`);return new t.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new i(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,f={},{head:d=!1,get:g=!1,count:m}={}){var _;let C;const E=new URL(`${this.url}/rpc/${l}`);let R;d||g?(C=d?"HEAD":"GET",Object.entries(f).filter(([D,z])=>z!==void 0).map(([D,z])=>[D,Array.isArray(z)?`{${z.join(",")}}`:`${z}`]).forEach(([D,z])=>{E.searchParams.append(D,z)})):(C="POST",R=f);const v=new Headers(this.headers);return m&&v.set("Prefer",`count=${m}`),new n.default({method:C,url:E,headers:v,schema:this.schemaName,body:R,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}}return tg.default=i,tg}var Ky;function k_(){if(Ky)return Ii;Ky=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.PostgrestError=Ii.PostgrestBuilder=Ii.PostgrestTransformBuilder=Ii.PostgrestFilterBuilder=Ii.PostgrestQueryBuilder=Ii.PostgrestClient=void 0;const o=mf,t=o.__importDefault(I_());Ii.PostgrestClient=t.default;const n=o.__importDefault(YS());Ii.PostgrestQueryBuilder=n.default;const i=o.__importDefault(sv());Ii.PostgrestFilterBuilder=i.default;const r=o.__importDefault(VS());Ii.PostgrestTransformBuilder=r.default;const l=o.__importDefault(qS());Ii.PostgrestBuilder=l.default;const f=o.__importDefault(kS());return Ii.PostgrestError=f.default,Ii.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:l.default,PostgrestError:f.default},Ii}var q_=k_();const V_=cf(q_),{PostgrestClient:Y_,PostgrestQueryBuilder:lT,PostgrestFilterBuilder:oT,PostgrestTransformBuilder:uT,PostgrestBuilder:cT,PostgrestError:fT}=V_;class K_{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const i=n.node,r=parseInt(i.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const i=this.getWebSocketConstructor();return new i(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Q_="2.76.1",X_=`realtime-js/${Q_}`,F_="1.0.0",Bm=1e4,J_=1e3,Z_=100;var id;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(id||(id={}));var ui;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(ui||(ui={}));var Mr;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(Mr||(Mr={}));var zm;(function(o){o.websocket="websocket"})(zm||(zm={}));var su;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(su||(su={}));class W_{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,n,i)}_decodeBroadcast(t,n,i){const r=n.getUint8(1),l=n.getUint8(2);let f=this.HEADER_LENGTH+2;const d=i.decode(t.slice(f,f+r));f=f+r;const g=i.decode(t.slice(f,f+l));f=f+l;const m=JSON.parse(i.decode(t.slice(f,t.byteLength)));return{ref:null,topic:d,event:g,payload:m}}}class KS{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var mn;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(mn||(mn={}));const Qy=(o,t,n={})=>{var i;const r=(i=n.skipTypes)!==null&&i!==void 0?i:[];return t?Object.keys(t).reduce((l,f)=>(l[f]=$_(f,o,t,r),l),{}):{}},$_=(o,t,n,i)=>{const r=t.find(d=>d.name===o),l=r==null?void 0:r.type,f=n[o];return l&&!i.includes(l)?QS(l,f):Lm(f)},QS=(o,t)=>{if(o.charAt(0)==="_"){const n=o.slice(1,o.length);return iE(t,n)}switch(o){case mn.bool:return tE(t);case mn.float4:case mn.float8:case mn.int2:case mn.int4:case mn.int8:case mn.numeric:case mn.oid:return eE(t);case mn.json:case mn.jsonb:return nE(t);case mn.timestamp:return aE(t);case mn.abstime:case mn.date:case mn.daterange:case mn.int4range:case mn.int8range:case mn.money:case mn.reltime:case mn.text:case mn.time:case mn.timestamptz:case mn.timetz:case mn.tsrange:case mn.tstzrange:return Lm(t);default:return Lm(t)}},Lm=o=>o,tE=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},eE=o=>{if(typeof o=="string"){const t=parseFloat(o);if(!Number.isNaN(t))return t}return o},nE=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(t){return console.log(`JSON parse error: ${t}`),o}return o},iE=(o,t)=>{if(typeof o!="string")return o;const n=o.length-1,i=o[n];if(o[0]==="{"&&i==="}"){let l;const f=o.slice(1,n);try{l=JSON.parse("["+f+"]")}catch{l=f?f.split(","):[]}return l.map(d=>QS(t,d))}return o},aE=o=>typeof o=="string"?o.replace(" ","T"):o,XS=o=>{const t=new URL(o);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class um{constructor(t,n,i={},r=Bm){this.channel=t,this.event=n,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var i;return this._hasReceived(t)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Xy;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Xy||(Xy={}));class ad{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:l,onLeave:f,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ad.syncState(this.state,r,l,f),this.pendingDiffs.forEach(g=>{this.state=ad.syncDiff(this.state,g,l,f)}),this.pendingDiffs=[],d()}),this.channel._on(i.diff,{},r=>{const{onJoin:l,onLeave:f,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=ad.syncDiff(this.state,r,l,f),d())}),this.onJoin((r,l,f)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:l,newPresences:f})}),this.onLeave((r,l,f)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:l,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,i,r){const l=this.cloneDeep(t),f=this.transformState(n),d={},g={};return this.map(l,(m,_)=>{f[m]||(g[m]=_)}),this.map(f,(m,_)=>{const C=l[m];if(C){const E=_.map(z=>z.presence_ref),R=C.map(z=>z.presence_ref),v=_.filter(z=>R.indexOf(z.presence_ref)<0),D=C.filter(z=>E.indexOf(z.presence_ref)<0);v.length>0&&(d[m]=v),D.length>0&&(g[m]=D)}else d[m]=_}),this.syncDiff(l,{joins:d,leaves:g},i,r)}static syncDiff(t,n,i,r){const{joins:l,leaves:f}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(l,(d,g)=>{var m;const _=(m=t[d])!==null&&m!==void 0?m:[];if(t[d]=this.cloneDeep(g),_.length>0){const C=t[d].map(R=>R.presence_ref),E=_.filter(R=>C.indexOf(R.presence_ref)<0);t[d].unshift(...E)}i(d,_,g)}),this.map(f,(d,g)=>{let m=t[d];if(!m)return;const _=g.map(C=>C.presence_ref);m=m.filter(C=>_.indexOf(C.presence_ref)<0),t[d]=m,r(d,m,g),m.length===0&&delete t[d]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(i=>n(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,i)=>{const r=t[i];return"metas"in r?n[i]=r.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[i]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Fy;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Fy||(Fy={}));var rd;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(rd||(rd={}));var rl;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(rl||(rl={}));class lv{constructor(t,n={config:{}},i){var r,l;if(this.topic=t,this.params=n,this.socket=i,this.bindings={},this.state=ui.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new um(this,Mr.join,this.params,this.timeout),this.rejoinTimer=new KS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ui.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ui.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=ui.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ui.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=ui.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Mr.reply,{},(f,d)=>{this._trigger(this._replyEventName(d),f)}),this.presence=new ad(this),this.broadcastEndpointURL=XS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var i,r,l;if(this.socket.isConnected()||this.socket.connect(),this.state==ui.closed){const{config:{broadcast:f,presence:d,private:g}}=this.params,m=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(R=>R.filter))!==null&&r!==void 0?r:[],_=!!this.bindings[rd.PRESENCE]&&this.bindings[rd.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,C={},E={broadcast:f,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(R=>t==null?void 0:t(rl.CHANNEL_ERROR,R)),this._onClose(()=>t==null?void 0:t(rl.CLOSED)),this.updateJoinPayload(Object.assign({config:E},C)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:R})=>{var v;if(this.socket.setAuth(),R===void 0){t==null||t(rl.SUBSCRIBED);return}else{const D=this.bindings.postgres_changes,z=(v=D==null?void 0:D.length)!==null&&v!==void 0?v:0,G=[];for(let N=0;N<z;N++){const M=D[N],{filter:{event:L,schema:w,table:A,filter:O}}=M,y=R&&R[N];if(y&&y.event===L&&y.schema===w&&y.table===A&&y.filter===O)G.push(Object.assign(Object.assign({},M),{id:y.id}));else{this.unsubscribe(),this.state=ui.errored,t==null||t(rl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=G,t&&t(rl.SUBSCRIBED);return}}).receive("error",R=>{this.state=ui.errored,t==null||t(rl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(R).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(rl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,i){return this.state===ui.joined&&t===rd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,i)}async httpSend(t,n,i={}){var r;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(r=i.timeout)!==null&&r!==void 0?r:this.timeout);if(d.status===202)return{success:!0};let g=d.statusText;try{const m=await d.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(t,n={}){var i,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:f}=t,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var f,d,g;const m=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((g=(d=(f=this.params)===null||f===void 0?void 0:f.config)===null||d===void 0?void 0:d.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ui.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Mr.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new um(this,Mr.leave,{},t),i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ui.closed,this.bindings={}}async _fetchWithTimeout(t,n,i){const r=new AbortController,l=setTimeout(()=>r.abort(),i),f=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(l),f}_push(t,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new um(this,t,n,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Z_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,i){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,i){var r,l;const f=t.toLocaleLowerCase(),{close:d,error:g,leave:m,join:_}=Mr;if(i&&[d,g,m,_].indexOf(f)>=0&&i!==this._joinRef())return;let E=this._onMessage(f,n,i);if(n&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(R=>{var v,D,z;return((v=R.filter)===null||v===void 0?void 0:v.event)==="*"||((z=(D=R.filter)===null||D===void 0?void 0:D.event)===null||z===void 0?void 0:z.toLocaleLowerCase())===f}).map(R=>R.callback(E,i)):(l=this.bindings[f])===null||l===void 0||l.filter(R=>{var v,D,z,G,N,M;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in R){const L=R.id,w=(v=R.filter)===null||v===void 0?void 0:v.event;return L&&((D=n.ids)===null||D===void 0?void 0:D.includes(L))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((z=n.data)===null||z===void 0?void 0:z.type.toLocaleLowerCase()))}else{const L=(N=(G=R==null?void 0:R.filter)===null||G===void 0?void 0:G.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return L==="*"||L===((M=n==null?void 0:n.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===f}).map(R=>{if(typeof E=="object"&&"ids"in E){const v=E.data,{schema:D,table:z,commit_timestamp:G,type:N,errors:M}=v;E=Object.assign(Object.assign({},{schema:D,table:z,commit_timestamp:G,eventType:N,new:{},old:{},errors:M}),this._getPayloadRecords(v))}R.callback(E,i)})}_isClosed(){return this.state===ui.closed}_isJoined(){return this.state===ui.joined}_isJoining(){return this.state===ui.joining}_isLeaving(){return this.state===ui.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,i){const r=t.toLocaleLowerCase(),l={type:r,filter:n,callback:i};return this.bindings[r]?this.bindings[r].push(l):this.bindings[r]=[l],this}_off(t,n){const i=t.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var l;return!(((l=r.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&lv.isEqual(r.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(t[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Mr.close,{},t)}_onError(t){this._on(Mr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ui.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=Qy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=Qy(t.columns,t.old_record)),n}}const cm=()=>{},sg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},rE=[1e3,2e3,5e3,1e4],sE=1e4,lE=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class oE{constructor(t,n){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bm,this.transport=null,this.heartbeatIntervalMs=sg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cm,this.ref=0,this.reconnectTimer=null,this.logger=cm,this.conn=null,this.sendBuffer=[],this.serializer=new W_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let l;return r?l=r:typeof fetch>"u"?l=(...f)=>pf(async()=>{const{default:d}=await Promise.resolve().then(()=>yu);return{default:d}},void 0).then(({default:d})=>d(...f)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...f)=>l(...f)},!(!((i=n==null?void 0:n.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${zm.websocket}`,this.httpEndpoint=XS(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=K_.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:F_}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,i){this.logger(t,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case id.connecting:return su.Connecting;case id.open:return su.Open;case id.closing:return su.Closing;default:return su.Closed}}isConnected(){return this.connectionState()===su.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const i=`realtime:${t}`,r=this.getChannels().find(l=>l.topic===i);if(r)return r;{const l=new lv(`realtime:${t}`,n,this);return this.channels.push(l),l}}push(t){const{topic:n,event:i,payload:r,ref:l}=t,f=()=>{this.encode(t,d=>{var g;(g=this.conn)===null||g===void 0||g.send(d)})};this.log("push",`${n} ${i} (${l})`,r),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(J_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},sg.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:l,ref:f}=n,d=f?`(${f})`:"",g=l.status||"";this.log("receive",`${g} ${i} ${r} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(r,l,f)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Mr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const i=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${i}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const i=new Blob([lE],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(i=>{const r={access_token:n,version:X_};n&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Mr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(i=>{try{i(n)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(i){this.log("error",`error triggering ${t} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new KS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},sg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,i,r,l,f,d,g,m,_;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(i=t==null?void 0:t.timeout)!==null&&i!==void 0?i:Bm,this.heartbeatIntervalMs=(r=t==null?void 0:t.heartbeatIntervalMs)!==null&&r!==void 0?r:sg.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(f=t==null?void 0:t.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(d=t==null?void 0:t.heartbeatCallback)!==null&&d!==void 0?d:cm,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(C=>rE[C-1]||sE),this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((C,E)=>E(JSON.stringify(C))),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ov extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Nn(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class uE extends ov{constructor(t,n,i){super(t),this.name="StorageApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Gm extends ov{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const uv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>pf(async()=>{const{default:i}=await Promise.resolve().then(()=>yu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},cE=()=>ee(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield pf(()=>Promise.resolve().then(()=>yu),void 0)).Response:Response}),Hm=o=>{if(Array.isArray(o))return o.map(n=>Hm(n));if(typeof o=="function"||o!==Object(o))return o;const t={};return Object.entries(o).forEach(([n,i])=>{const r=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[r]=Hm(i)}),t},fE=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},fm=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),hE=(o,t,n)=>ee(void 0,void 0,void 0,function*(){const i=yield cE();o instanceof i&&!(n!=null&&n.noResolveJson)?o.json().then(r=>{const l=o.status||500,f=(r==null?void 0:r.statusCode)||l+"";t(new uE(fm(r),l,f))}).catch(r=>{t(new Gm(fm(r),r))}):t(new Gm(fm(o),o))}),dE=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"||!i?r:(fE(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,t!=null&&t.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),n))};function dd(o,t,n,i,r,l){return ee(this,void 0,void 0,function*(){return new Promise((f,d)=>{o(n,dE(t,i,r,l)).then(g=>{if(!g.ok)throw g;return i!=null&&i.noResolveJson?g:g.json()}).then(g=>f(g)).catch(g=>hE(g,d,i))})})}function ud(o,t,n,i){return ee(this,void 0,void 0,function*(){return dd(o,"GET",t,n,i)})}function xr(o,t,n,i,r){return ee(this,void 0,void 0,function*(){return dd(o,"POST",t,i,r,n)})}function Pm(o,t,n,i,r){return ee(this,void 0,void 0,function*(){return dd(o,"PUT",t,i,r,n)})}function gE(o,t,n,i){return ee(this,void 0,void 0,function*(){return dd(o,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function cv(o,t,n,i,r){return ee(this,void 0,void 0,function*(){return dd(o,"DELETE",t,i,r,n)})}class pE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return ee(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nn(t))return{data:null,error:t};throw t}})}}var FS;class mE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[FS]="BlobDownloadBuilder",this.promise=null}asStream(){return new pE(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return ee(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nn(t))return{data:null,error:t};throw t}})}}FS=Symbol.toStringTag;const vE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class yE{constructor(t,n={},i,r){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=i,this.fetch=uv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,i,r){return ee(this,void 0,void 0,function*(){try{let l;const f=Object.assign(Object.assign({},Jy),r);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(f.upsert)});const g=f.metadata;typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",f.cacheControl),g&&l.append("metadata",this.encodeMetadata(g)),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.append("cacheControl",f.cacheControl),g&&l.append("metadata",this.encodeMetadata(g))):(l=i,d["cache-control"]=`max-age=${f.cacheControl}`,d["content-type"]=f.contentType,g&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),r!=null&&r.headers&&(d=Object.assign(Object.assign({},d),r.headers));const m=this._removeEmptyFolders(n),_=this._getFinalPath(m),C=yield(t=="PUT"?Pm:xr)(this.fetch,`${this.url}/object/${_}`,l,Object.assign({headers:d},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:C.Id,fullPath:C.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Nn(l))return{data:null,error:l};throw l}})}upload(t,n,i){return ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,i)})}uploadToSignedUrl(t,n,i,r){return ee(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),f=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${f}`);d.searchParams.set("token",n);try{let g;const m=Object.assign({upsert:Jy.upsert},r),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&i instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",i)):typeof FormData<"u"&&i instanceof FormData?(g=i,g.append("cacheControl",m.cacheControl)):(g=i,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType);const C=yield Pm(this.fetch,d.toString(),g,{headers:_});return{data:{path:l,fullPath:C.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(Nn(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(t,n){return ee(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const l=yield xr(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),f=new URL(this.url+l.url),d=f.searchParams.get("token");if(!d)throw new ov("No token returned by API");return{data:{signedUrl:f.toString(),path:t,token:d},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Nn(i))return{data:null,error:i};throw i}})}update(t,n,i){return ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,i)})}move(t,n,i){return ee(this,void 0,void 0,function*(){try{return{data:yield xr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nn(r))return{data:null,error:r};throw r}})}copy(t,n,i){return ee(this,void 0,void 0,function*(){try{return{data:{path:(yield xr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nn(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,i){return ee(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),l=yield xr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const f=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${f}`)},{data:l,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nn(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,i){return ee(this,void 0,void 0,function*(){try{const r=yield xr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),l=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${l}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nn(r))return{data:null,error:r};throw r}})}download(t,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),f=l?`?${l}`:"",d=this._getFinalPath(t),g=()=>ud(this.fetch,`${this.url}/${r}/${d}${f}`,{headers:this.headers,noResolveJson:!0});return new mE(g,this.shouldThrowOnError)}info(t){return ee(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const i=yield ud(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Hm(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Nn(i))return{data:null,error:i};throw i}})}exists(t){return ee(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield gE(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Nn(i)&&i instanceof Gm){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,n){const i=this._getFinalPath(t),r=[],l=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&r.push(l);const d=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});g!==""&&r.push(g);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${i}${m}`)}}}remove(t){return ee(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}list(t,n,i){return ee(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},vE),n),{prefix:t||""});return{data:yield xr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nn(r))return{data:null,error:r};throw r}})}listV2(t,n){return ee(this,void 0,void 0,function*(){try{const i=Object.assign({},t);return{data:yield xr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Nn(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const JS="2.76.1",ZS={"X-Client-Info":`storage-js/${JS}`};class SE{constructor(t,n={},i,r){this.shouldThrowOnError=!1;const l=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ZS),n),this.fetch=uv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ee(this,void 0,void 0,function*(){try{return{data:yield ud(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nn(t))return{data:null,error:t};throw t}})}getBucket(t){return ee(this,void 0,void 0,function*(){try{return{data:yield ud(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}createBucket(t){return ee(this,arguments,void 0,function*(n,i={public:!1}){try{return{data:yield xr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nn(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return ee(this,void 0,void 0,function*(){try{return{data:yield Pm(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Nn(i))return{data:null,error:i};throw i}})}emptyBucket(t){return ee(this,void 0,void 0,function*(){try{return{data:yield xr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return ee(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}}class bE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ZS),n),this.fetch=uv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return ee(this,void 0,void 0,function*(){try{return{data:yield xr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}listBuckets(t){return ee(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const i=n.toString(),r=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`,l=yield ud(this.fetch,r,{headers:this.headers});return{data:Array.isArray(l)?l.filter(d=>d.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return ee(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}}const fv={"X-Client-Info":`storage-js/${JS}`,"Content-Type":"application/json"};class WS extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Aa(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class hm extends WS{constructor(t,n,i){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class _E extends WS{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var Zy;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Zy||(Zy={}));const hv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>pf(async()=>{const{default:i}=await Promise.resolve().then(()=>yu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},EE=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Wy=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),CE=(o,t,n)=>ee(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!(n!=null&&n.noResolveJson)){const r=o.status||500,l=o;if(typeof l.json=="function")l.json().then(f=>{const d=(f==null?void 0:f.statusCode)||(f==null?void 0:f.code)||r+"";t(new hm(Wy(f),r,d))}).catch(()=>{const f=r+"",d=l.statusText||`HTTP ${r} error`;t(new hm(d,r,f))});else{const f=r+"",d=l.statusText||`HTTP ${r} error`;t(new hm(d,r,f))}}else t(new _E(Wy(o),o))}),TE=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return i?(EE(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),n)):r};function AE(o,t,n,i,r,l){return ee(this,void 0,void 0,function*(){return new Promise((f,d)=>{o(n,TE(t,i,r,l)).then(g=>{if(!g.ok)throw g;if(i!=null&&i.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>f(g)).catch(g=>CE(g,d,i))})})}function Oa(o,t,n,i,r){return ee(this,void 0,void 0,function*(){return AE(o,"POST",t,i,r,n)})}class OE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return ee(this,void 0,void 0,function*(){try{return{data:(yield Oa(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}getIndex(t,n){return ee(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Aa(i))return{data:null,error:i};throw i}})}listIndexes(t){return ee(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return ee(this,void 0,void 0,function*(){try{return{data:(yield Oa(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Aa(i))return{data:null,error:i};throw i}})}}class RE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return ee(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Oa(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}getVectors(t){return ee(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}listVectors(t){return ee(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Oa(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}queryVectors(t){return ee(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}deleteVectors(t){return ee(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Oa(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}}class wE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return ee(this,void 0,void 0,function*(){try{return{data:(yield Oa(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}getBucket(t){return ee(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}listBuckets(){return ee(this,arguments,void 0,function*(t={}){try{return{data:yield Oa(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}deleteBucket(t){return ee(this,void 0,void 0,function*(){try{return{data:(yield Oa(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Aa(n))return{data:null,error:n};throw n}})}}class xE extends wE{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new ME(this.url,this.headers,t,this.fetch)}}class ME extends OE{constructor(t,n,i,r){super(t,n,r),this.vectorBucketName=i}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return ee(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return ee(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return ee(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return ee(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new NE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class NE extends RE{constructor(t,n,i,r,l){super(t,n,l),this.vectorBucketName=i,this.indexName=r}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return ee(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return ee(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return ee(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return ee(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return ee(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class DE extends SE{constructor(t,n={},i,r){super(t,n,i,r)}from(t){return new yE(this.url,this.headers,t,this.fetch)}get vectors(){return new xE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new bE(this.url+"/iceberg",this.headers,this.fetch)}}const jE="2.76.1";let Wh="";typeof Deno<"u"?Wh="deno":typeof document<"u"?Wh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Wh="react-native":Wh="node";const UE={"X-Client-Info":`supabase-js-${Wh}/${jE}`},BE={headers:UE},zE={schema:"public"},LE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},GE={},HE=o=>{let t;return o?t=o:typeof fetch>"u"?t=PS:t=fetch,(...n)=>t(...n)},PE=()=>typeof Headers>"u"?IS:Headers,IE=(o,t,n)=>{const i=HE(n),r=PE();return async(l,f)=>{var d;const g=(d=await t())!==null&&d!==void 0?d:o;let m=new r(f==null?void 0:f.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),i(l,Object.assign(Object.assign({},f),{headers:m}))}};function kE(o){return o.endsWith("/")?o:o+"/"}function qE(o,t){var n,i;const{db:r,auth:l,realtime:f,global:d}=o,{db:g,auth:m,realtime:_,global:C}=t,E={db:Object.assign(Object.assign({},g),r),auth:Object.assign(Object.assign({},m),l),realtime:Object.assign(Object.assign({},_),f),storage:{},global:Object.assign(Object.assign(Object.assign({},C),d),{headers:Object.assign(Object.assign({},(n=C==null?void 0:C.headers)!==null&&n!==void 0?n:{}),(i=d==null?void 0:d.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return o.accessToken?E.accessToken=o.accessToken:delete E.accessToken,E}function VE(o){const t=o==null?void 0:o.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(kE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const $S="2.76.1",tf=30*1e3,Im=3,dm=Im*tf,YE="http://localhost:9999",KE="supabase.auth.token",QE={"X-Client-Info":`gotrue-js/${$S}`},km="X-Supabase-Api-Version",t4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},XE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,FE=600*1e3;class cd extends Error{constructor(t,n,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function oe(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class JE extends cd{constructor(t,n,i){super(t,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function ZE(o){return oe(o)&&o.name==="AuthApiError"}class lu extends cd{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class uo extends cd{constructor(t,n,i,r){super(t,i,r),this.name=n,this.status=i}}class to extends uo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function WE(o){return oe(o)&&o.name==="AuthSessionMissingError"}class Qc extends uo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class lg extends uo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class og extends uo{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $E(o){return oe(o)&&o.name==="AuthImplicitGrantRedirectError"}class $y extends uo{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class qm extends uo{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function gm(o){return oe(o)&&o.name==="AuthRetryableFetchError"}class t2 extends uo{constructor(t,n,i){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}class Vm extends uo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const mg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),e2=` 	
\r=`.split(""),tC=(()=>{const o=new Array(128);for(let t=0;t<o.length;t+=1)o[t]=-1;for(let t=0;t<e2.length;t+=1)o[e2[t].charCodeAt(0)]=-2;for(let t=0;t<mg.length;t+=1)o[mg[t].charCodeAt(0)]=t;return o})();function n2(o,t,n){if(o!==null)for(t.queue=t.queue<<8|o,t.queuedBits+=8;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(mg[i]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(mg[i]),t.queuedBits-=6}}function e4(o,t,n){const i=tC[o];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function i2(o){const t=[],n=f=>{t.push(String.fromCodePoint(f))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},l=f=>{iC(f,i,n)};for(let f=0;f<o.length;f+=1)e4(o.charCodeAt(f),r,l);return t.join("")}function eC(o,t){if(o<=127){t(o);return}else if(o<=2047){t(192|o>>6),t(128|o&63);return}else if(o<=65535){t(224|o>>12),t(128|o>>6&63),t(128|o&63);return}else if(o<=1114111){t(240|o>>18),t(128|o>>12&63),t(128|o>>6&63),t(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function nC(o,t){for(let n=0;n<o.length;n+=1){let i=o.charCodeAt(n);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(o.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}eC(i,t)}}function iC(o,t,n){if(t.utf8seq===0){if(o<=127){n(o);return}for(let i=1;i<6;i+=1)if((o>>7-i&1)===0){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=o&31;else if(t.utf8seq===3)t.codepoint=o&15;else if(t.utf8seq===4)t.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|o&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function af(o){const t=[],n={queue:0,queuedBits:0},i=r=>{t.push(r)};for(let r=0;r<o.length;r+=1)e4(o.charCodeAt(r),n,i);return new Uint8Array(t)}function aC(o){const t=[];return nC(o,n=>t.push(n)),new Uint8Array(t)}function uu(o){const t=[],n={queue:0,queuedBits:0},i=r=>{t.push(r)};return o.forEach(r=>n2(r,n,i)),n2(null,n,i),t.join("")}function rC(o){return Math.round(Date.now()/1e3)+o}function sC(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o=="x"?t:t&3|8).toString(16)})}const Ca=()=>typeof window<"u"&&typeof document<"u",iu={tested:!1,writable:!1},n4=()=>{if(!Ca())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(iu.tested)return iu.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),iu.tested=!0,iu.writable=!0}catch{iu.tested=!0,iu.writable=!1}return iu.writable};function lC(o){const t={},n=new URL(o);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,l)=>{t[l]=r})}catch{}return n.searchParams.forEach((i,r)=>{t[r]=i}),t}const i4=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>pf(async()=>{const{default:i}=await Promise.resolve().then(()=>yu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},oC=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",ef=async(o,t,n)=>{await o.setItem(t,JSON.stringify(n))},au=async(o,t)=>{const n=await o.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Zl=async(o,t)=>{await o.removeItem(t)};class xg{constructor(){this.promise=new xg.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}xg.promiseConstructor=Promise;function pm(o){const t=o.split(".");if(t.length!==3)throw new Vm("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!XE.test(t[i]))throw new Vm("JWT not in base64url format");return{header:JSON.parse(i2(t[0])),payload:JSON.parse(i2(t[1])),signature:af(t[2]),raw:{header:t[0],payload:t[1]}}}async function uC(o){return await new Promise(t=>{setTimeout(()=>t(null),o)})}function cC(o,t){return new Promise((i,r)=>{(async()=>{for(let l=0;l<1/0;l++)try{const f=await o(l);if(!t(l,null,f)){i(f);return}}catch(f){if(!t(l,f)){r(f);return}}})()})}function fC(o){return("0"+o.toString(16)).substr(-2)}function hC(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let r="";for(let l=0;l<56;l++)r+=n.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(t),Array.from(t,fC).join("")}async function dC(o){const n=new TextEncoder().encode(o),i=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(i);return Array.from(r).map(l=>String.fromCharCode(l)).join("")}async function gC(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const n=await dC(o);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Xc(o,t,n=!1){const i=hC();let r=i;n&&(r+="/PASSWORD_RECOVERY"),await ef(o,`${t}-code-verifier`,r);const l=await gC(i);return[l,i===l?"plain":"s256"]}const pC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mC(o){const t=o.headers.get(km);if(!t||!t.match(pC))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function vC(o){if(!o)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(o<=t)throw new Error("JWT has expired")}function yC(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const SC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Fc(o){if(!SC.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function mm(){const o={};return new Proxy(o,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function a2(o){return JSON.parse(JSON.stringify(o))}const ru=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),bC=[502,503,504];async function r2(o){var t;if(!oC(o))throw new qm(ru(o),0);if(bC.includes(o.status))throw new qm(ru(o),o.status);let n;try{n=await o.json()}catch(l){throw new lu(ru(l),l)}let i;const r=mC(o);if(r&&r.getTime()>=t4["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new t2(ru(n),o.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new to}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,f)=>l&&typeof f=="string",!0))throw new t2(ru(n),o.status,n.weak_password.reasons);throw new JE(ru(n),o.status||500,i)}const _C=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))};async function _e(o,t,n,i){var r;const l=Object.assign({},i==null?void 0:i.headers);l[km]||(l[km]=t4["2024-01-01"].name),i!=null&&i.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const f=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(f.redirect_to=i.redirectTo);const d=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",g=await EC(o,t,n+d,{headers:l,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(g):{data:Object.assign({},g),error:null}}async function EC(o,t,n,i,r,l){const f=_C(t,i,r,l);let d;try{d=await o(n,Object.assign({},f))}catch(g){throw console.error(g),new qm(ru(g),0)}if(d.ok||await r2(d),i!=null&&i.noResolveJson)return d;try{return await d.json()}catch(g){await r2(g)}}function wr(o){var t;let n=null;AC(o)&&(n=Object.assign({},o),o.expires_at||(n.expires_at=rC(o.expires_in)));const i=(t=o.user)!==null&&t!==void 0?t:o;return{data:{session:n,user:i},error:null}}function s2(o){const t=wr(o);return!t.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(t.data.weak_password=o.weak_password),t}function no(o){var t;return{data:{user:(t=o.user)!==null&&t!==void 0?t:o},error:null}}function CC(o){return{data:o,error:null}}function TC(o){const{action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:l}=o,f=gf(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:l},g=Object.assign({},f);return{data:{properties:d,user:g},error:null}}function l2(o){return o}function AC(o){return o.access_token&&o.refresh_token&&o.expires_in}const vm=["global","local","others"];class OC{constructor({url:t="",headers:n={},fetch:i}){this.url=t,this.headers=n,this.fetch=i4(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=vm[0]){if(vm.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${vm.join(", ")}`);try{return await _e(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(oe(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,n={}){try{return await _e(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:no})}catch(i){if(oe(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:n}=t,i=gf(t,["options"]),r=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await _e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:TC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(oe(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:no})}catch(n){if(oe(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,i,r,l,f,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await _e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:l2});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(v.split(";")[1].split("=")[1]);m[`${z}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(oe(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){Fc(t);try{return await _e(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:no})}catch(n){if(oe(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Fc(t);try{return await _e(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:no})}catch(i){if(oe(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,n=!1){Fc(t);try{return await _e(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:no})}catch(i){if(oe(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){Fc(t.userId);try{const{data:n,error:i}=await _e(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:i}}catch(n){if(oe(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Fc(t.userId),Fc(t.id);try{return{data:await _e(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,i,r,l,f,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:l2});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(v.split(";")[1].split("=")[1]);m[`${z}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(oe(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(oe(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(oe(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await _e(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(oe(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(oe(n))return{data:null,error:n};throw n}}}function o2(o={}){return{getItem:t=>o[t]||null,setItem:(t,n)=>{o[t]=n},removeItem:t=>{delete o[t]}}}const Jc={debug:!!(globalThis&&n4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class a4 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class RC extends a4{}async function wC(o,t,n){Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,r.name);try{return await n()}finally{Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,r.name)}}else{if(t===0)throw Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new RC(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Jc.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function xC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function r4(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function MC(o){return parseInt(o,16)}function NC(o){const t=new TextEncoder().encode(o);return"0x"+Array.from(t,i=>i.toString(16).padStart(2,"0")).join("")}function DC(o){var t;const{chainId:n,domain:i,expirationTime:r,issuedAt:l=new Date,nonce:f,notBefore:d,requestId:g,resources:m,scheme:_,uri:C,version:E}=o;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((t=o.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const R=r4(o.address),v=_?`${_}://${i}`:i,D=o.statement?`${o.statement}
`:"",z=`${v} wants you to sign in with your Ethereum account:
${R}

${D}`;let G=`URI: ${C}
Version: ${E}
Chain ID: ${n}${f?`
Nonce: ${f}`:""}
Issued At: ${l.toISOString()}`;if(r&&(G+=`
Expiration Time: ${r.toISOString()}`),d&&(G+=`
Not Before: ${d.toISOString()}`),g&&(G+=`
Request ID: ${g}`),m){let N=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);N+=`
- ${M}`}G+=N}return`${z}
${G}`}class Zn extends Error{constructor({message:t,code:n,cause:i,name:r}){var l;super(t,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=r??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class vg extends Zn{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function jC({error:o,options:t}){var n,i,r;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Zn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Zn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(t.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Zn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Zn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Zn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Zn({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Zn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Zn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const f=window.location.hostname;if(s4(f)){if(l.rp.id!==f)return new Zn({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Zn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Zn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Zn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Zn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function UC({error:o,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Zn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Zn({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const i=window.location.hostname;if(s4(i)){if(n.rpId!==i)return new Zn({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Zn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Zn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Zn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class BC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const zC=new BC;function LC(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:t,user:n,excludeCredentials:i}=o,r=gf(o,["challenge","user","excludeCredentials"]),l=af(t).buffer,f=Object.assign(Object.assign({},n),{id:af(n.id).buffer}),d=Object.assign(Object.assign({},r),{challenge:l,user:f});if(i&&i.length>0){d.excludeCredentials=new Array(i.length);for(let g=0;g<i.length;g++){const m=i[g];d.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:af(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function GC(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:t,allowCredentials:n}=o,i=gf(o,["challenge","allowCredentials"]),r=af(t).buffer,l=Object.assign(Object.assign({},i),{challenge:r});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const d=n[f];l.allowCredentials[f]=Object.assign(Object.assign({},d),{id:af(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function HC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o;return{id:o.id,rawId:o.id,response:{attestationObject:uu(new Uint8Array(o.response.attestationObject)),clientDataJSON:uu(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function PC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o,i=o.getClientExtensionResults(),r=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:uu(new Uint8Array(r.authenticatorData)),clientDataJSON:uu(new Uint8Array(r.clientDataJSON)),signature:uu(new Uint8Array(r.signature)),userHandle:r.userHandle?uu(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function s4(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function u2(){var o,t;return!!(Ca()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator==null?void 0:navigator.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function IC(o){try{const t=await navigator.credentials.create(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new vg("Browser returned unexpected credential type",t)}:{data:null,error:new vg("Empty credential response",t)}}catch(t){return{data:null,error:jC({error:t,options:o})}}}async function kC(o){try{const t=await navigator.credentials.get(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new vg("Browser returned unexpected credential type",t)}:{data:null,error:new vg("Empty credential response",t)}}catch(t){return{data:null,error:UC({error:t,options:o})}}}const qC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},VC={userVerification:"preferred",hints:["security-key"]};function yg(...o){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),i={};for(const r of o)if(r)for(const l in r){const f=r[l];if(f!==void 0)if(Array.isArray(f))i[l]=f;else if(n(f))i[l]=f;else if(t(f)){const d=i[l];t(d)?i[l]=yg(d,f):i[l]=yg(f)}else i[l]=f}return i}function YC(o,t){return yg(qC,o,t||{})}function KC(o,t){return yg(VC,o,t||{})}class QC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:i,signal:r},l){try{const{data:f,error:d}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!f)return{data:null,error:d};const g=r??zC.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=YC(f.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:C}=await IC({publicKey:m,signal:g});return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}case"request":{const m=KC(f.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:C}=await kC(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}}}catch(f){return oe(f)?{data:null,error:f}:{data:null,error:new lu("Unexpected error in challenge",f)}}}async _verify({challengeId:t,factorId:n,webauthn:i}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:i})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r}},l){if(!n)return{data:null,error:new cd("rpId is required for WebAuthn authentication")};try{if(!u2())return{data:null,error:new lu("Browser does not support WebAuthn",null)};const{data:f,error:d}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:i},signal:r},{request:l});if(!f)return{data:null,error:d};const{webauthn:g}=f;return this._verify({factorId:t,challengeId:f.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:i,credential_response:g.credential_response}})}catch(f){return oe(f)?{data:null,error:f}:{data:null,error:new lu("Unexpected error in authenticate",f)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r},l){if(!n)return{data:null,error:new cd("rpId is required for WebAuthn registration")};try{if(!u2())return{data:null,error:new lu("Browser does not support WebAuthn",null)};const{data:f,error:d}=await this._enroll({friendlyName:t});if(!f)return await this.client.mfa.listFactors().then(_=>{var C;return(C=_.data)===null||C===void 0?void 0:C.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===t&&E.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:d};const{data:g,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:n,rpOrigins:i},signal:r},{create:l});return g?this._verify({factorId:f.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:i,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(f){return oe(f)?{data:null,error:f}:{data:null,error:new lu("Unexpected error in register",f)}}}}xC();const XC={url:YE,storageKey:KE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:QE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function c2(o,t,n){return await n()}const Zc={};class fd{get jwks(){var t,n;return(n=(t=Zc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Zc[this.storageKey]=Object.assign(Object.assign({},Zc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Zc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Zc[this.storageKey]=Object.assign(Object.assign({},Zc[this.storageKey]),{cachedAt:t})}constructor(t){var n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=fd.nextInstanceID,fd.nextInstanceID+=1,this.instanceID>0&&Ca()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},XC),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new OC({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=i4(r.fetch),this.lock=r.lock||c2,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ca()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=wC:this.lock=c2,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new QC(this)},this.persistSession?(r.storage?this.storage=r.storage:n4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=o2(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=o2(this.memoryStorage)),Ca()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${$S}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=lC(window.location.href);let i="none";if(this._isImplicitGrantCallback(n)?i="implicit":await this._isPKCECallback(n)&&(i="pkce"),Ca()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:l}=await this._getSessionFromURL(n,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),$E(l)){const g=(t=l.details)===null||t===void 0?void 0:t.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:f,redirectType:d}=r;return this._debug("#_initialize()","detected session in URL",f,"redirect type",d),await this._saveSession(f),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return oe(n)?{error:n}:{error:new lu("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,i,r;try{const l=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:wr}),{data:f,error:d}=l;if(d||!f)return{data:{user:null,session:null},error:d};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(oe(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var n,i,r;try{let l;if("email"in t){const{email:_,password:C,options:E}=t;let R=null,v=null;this.flowType==="pkce"&&([R,v]=await Xc(this.storage,this.storageKey)),l=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:_,password:C,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:R,code_challenge_method:v},xform:wr})}else if("phone"in t){const{phone:_,password:C,options:E}=t;l=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:C,data:(i=E==null?void 0:E.data)!==null&&i!==void 0?i:{},channel:(r=E==null?void 0:E.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:wr})}else throw new lg("You must provide either an email or phone number and a password");const{data:f,error:d}=l;if(d||!f)return{data:{user:null,session:null},error:d};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(oe(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:f,options:d}=t;n=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:f,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:s2})}else if("phone"in t){const{phone:l,password:f,options:d}=t;n=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:f,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:s2})}else throw new lg("You must provide either an email or phone number and a password");const{data:i,error:r}=n;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Qc}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(n){if(oe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,i,r,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,i,r,l,f,d,g,m,_,C,E;let R,v;if("message"in t)R=t.message,v=t.signature;else{const{chain:D,wallet:z,statement:G,options:N}=t;let M;if(Ca())if(typeof z=="object")M=z;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")M=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof z!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=z}const L=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href),w=await M.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!w||w.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=r4(w[0]);let O=(i=N==null?void 0:N.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!O){const B=await M.request({method:"eth_chainId"});O=MC(B)}const y={domain:L.host,address:A,statement:G,uri:L.href,version:"1",chainId:O,nonce:(r=N==null?void 0:N.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(f=(l=N==null?void 0:N.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(d=N==null?void 0:N.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(g=N==null?void 0:N.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=N==null?void 0:N.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=N==null?void 0:N.signInWithEthereum)===null||_===void 0?void 0:_.resources};R=DC(y),v=await M.request({method:"personal_sign",params:[NC(R),A]})}try{const{data:D,error:z}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:R,signature:v},!((C=t.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(E=t.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:wr});if(z)throw z;return!D||!D.session||!D.user?{data:{user:null,session:null},error:new Qc}:(D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),{data:Object.assign({},D),error:z})}catch(D){if(oe(D))return{data:{user:null,session:null},error:D};throw D}}async signInWithSolana(t){var n,i,r,l,f,d,g,m,_,C,E,R;let v,D;if("message"in t)v=t.message,D=t.signature;else{const{chain:z,wallet:G,statement:N,options:M}=t;let L;if(Ca())if(typeof G=="object")L=G;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))L=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof G!="object"||!(M!=null&&M.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=G}const w=new URL((n=M==null?void 0:M.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in L&&L.signIn){const A=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M==null?void 0:M.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),N?{statement:N}:null));let O;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")O=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)O=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)v=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),D=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${w.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${(r=(i=M==null?void 0:M.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((l=M==null?void 0:M.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((f=M==null?void 0:M.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((d=M==null?void 0:M.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((g=M==null?void 0:M.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M==null?void 0:M.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((C=(_=M==null?void 0:M.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||C===void 0)&&C.length?["Resources",...M.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const A=await L.signMessage(new TextEncoder().encode(v),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=A}}try{const{data:z,error:G}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:uu(D)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(R=t.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:wr});if(G)throw G;return!z||!z.session||!z.user?{data:{user:null,session:null},error:new Qc}:(z.session&&(await this._saveSession(z.session),await this._notifyAllSubscribers("SIGNED_IN",z.session)),{data:Object.assign({},z),error:G})}catch(z){if(oe(z))return{data:{user:null,session:null},error:z};throw z}}async _exchangeCodeForSession(t){const n=await au(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(n??"").split("/");try{const{data:l,error:f}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:wr});if(await Zl(this.storage,`${this.storageKey}-code-verifier`),f)throw f;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Qc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:r??null}),error:f})}catch(l){if(oe(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:n,provider:i,token:r,access_token:l,nonce:f}=t,d=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:l,nonce:f,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:wr}),{data:g,error:m}=d;return m?{data:{user:null,session:null},error:m}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Qc}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:m})}catch(n){if(oe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,i,r,l,f;try{if("email"in t){const{email:d,options:g}=t;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await Xc(this.storage,this.storageKey));const{error:C}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(i=g==null?void 0:g.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:d,options:g}=t,{data:m,error:_}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(f=g==null?void 0:g.channel)!==null&&f!==void 0?f:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_}}throw new lg("You must provide either an email or phone number.")}catch(d){if(oe(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(t){var n,i;try{let r,l;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:f,error:d}=await _e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:r,xform:wr});if(d)throw d;if(!f)throw new Error("An error occurred on token verification.");const g=f.session,m=f.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(r){if(oe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,i,r;try{let l=null,f=null;return this.flowType==="pkce"&&([l,f]=await Xc(this.storage,this.storageKey)),await _e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:f}),headers:this.headers,xform:CC})}catch(l){if(oe(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;if(i)throw i;if(!n)throw new to;const{error:r}=await _e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(oe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:i,type:r,options:l}=t,{error:f}=await _e(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}else if("phone"in t){const{phone:i,type:r,options:l}=t,{data:f,error:d}=await _e(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:d}}throw new lg("You must provide either an email or phone number and a type")}catch(n){if(oe(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await au(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at*1e3-Date.now()<dm:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.userStorage){const f=await au(this.userStorage,this.storageKey+"-user");f!=null&&f.user?t.user=f.user:t.user=mm()}if(this.storage.isServer&&t.user){let f=this.suppressGetSessionWarning;t=new Proxy(t,{get:(g,m,_)=>(!f&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),f=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,m,_))})}return{data:{session:t},error:null}}const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:no}):await this._useSession(async n=>{var i,r,l;const{data:f,error:d}=n;if(d)throw d;return!(!((i=f.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new to}:await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(r=f.session)===null||r===void 0?void 0:r.access_token)!==null&&l!==void 0?l:void 0,xform:no})})}catch(n){if(oe(n))return WE(n)&&(await this._removeSession(),await Zl(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async i=>{const{data:r,error:l}=i;if(l)throw l;if(!r.session)throw new to;const f=r.session;let d=null,g=null;this.flowType==="pkce"&&t.email!=null&&([d,g]=await Xc(this.storage,this.storageKey));const{data:m,error:_}=await _e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:g}),jwt:f.access_token,xform:no});if(_)throw _;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(i){if(oe(i))return{data:{user:null},error:i};throw i}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new to;const n=Date.now()/1e3;let i=n,r=!0,l=null;const{payload:f}=pm(t.access_token);if(f.exp&&(i=f.exp,r=i<=n),r){const{data:d,error:g}=await this._callRefreshToken(t.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:g}=await this._getUser(t.access_token);if(g)throw g;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(n){if(oe(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var i;if(!t){const{data:f,error:d}=n;if(d)throw d;t=(i=f.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new to;const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(oe(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Ca())throw new og("No browser detected.");if(t.error||t.error_description||t.error_code)throw new og(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new $y("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new og("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new $y("No code detected.");const{data:N,error:M}=await this._exchangeCodeForSession(t.code);if(M)throw M;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:l,refresh_token:f,expires_in:d,expires_at:g,token_type:m}=t;if(!l||!d||!f||!m)throw new og("No session defined in URL");const _=Math.round(Date.now()/1e3),C=parseInt(d);let E=_+C;g&&(E=parseInt(g));const R=E-_;R*1e3<=tf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${C}s`);const v=E-C;_-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,E,_):_-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,E,_);const{data:D,error:z}=await this._getUser(l);if(z)throw z;const G={provider_token:i,provider_refresh_token:r,access_token:l,expires_in:C,expires_at:E,refresh_token:f,token_type:m,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:G,redirectType:t.type},error:null}}catch(i){if(oe(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await au(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{error:l};const f=(i=r.session)===null||i===void 0?void 0:i.access_token;if(f){const{error:d}=await this.admin.signOut(f,t);if(d&&!(ZE(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return t!=="others"&&(await this._removeSession(),await Zl(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=sC(),i={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async n=>{var i,r;try{const{data:{session:l},error:f}=n;if(f)throw f;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await Xc(this.storage,this.storageKey,!0));try{return await _e(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(oe(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:i,error:r}=await this._useSession(async l=>{var f,d,g,m,_;const{data:C,error:E}=l;if(E)throw E;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(f=t.options)===null||f===void 0?void 0:f.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=t.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await _e(this.fetch,"GET",R,{headers:this.headers,jwt:(_=(m=C.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(r)throw r;return Ca()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(oe(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var i;try{const{error:r,data:{session:l}}=n;if(r)throw r;const{options:f,provider:d,token:g,access_token:m,nonce:_}=t,C=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l==null?void 0:l.access_token)!==null&&i!==void 0?i:void 0,body:{provider:d,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:wr}),{data:E,error:R}=C;return R?{data:{user:null,session:null},error:R}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new Qc}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:R})}catch(r){if(oe(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var i,r;const{data:l,error:f}=n;if(f)throw f;return await _e(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(oe(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await cC(async r=>(r>0&&await uC(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await _e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:wr})),(r,l)=>{const f=200*Math.pow(2,r);return l&&gm(l)&&Date.now()+f-i<tf})}catch(i){if(this._debug(n,"error",i),oe(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",i),Ca()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t,n;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await au(this.storage,this.storageKey);if(r&&this.userStorage){let f=await au(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:r.user},await ef(this.userStorage,this.storageKey+"-user",f)),r.user=(t=f==null?void 0:f.user)!==null&&t!==void 0?t:mm()}else if(r&&!r.user&&!r.user){const f=await au(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(r.user=f.user,await Zl(this.storage,this.storageKey+"-user"),await ef(this.storage,this.storageKey,r)):r.user=mm()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const l=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<dm;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${dm}s`),l){if(this.autoRefreshToken&&r.refresh_token){const{error:f}=await this._callRefreshToken(r.refresh_token);f&&(console.error(f),gm(f)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:d}=await this._getUser(r.access_token);!d&&(f!=null&&f.user)?(r.user=f.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(i,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(t){var n,i;if(!t)throw new to;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new xg;const{data:l,error:f}=await this._refreshAccessToken(t);if(f)throw f;if(!l.session)throw new to;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(r,"error",l),oe(l)){const f={data:null,error:l};return gm(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(f),f}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,i=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],f=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,n)}catch(g){l.push(g)}});if(await Promise.all(f),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),i=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&n.user&&await ef(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const l=a2(r);await ef(this.storage,this.storageKey,l)}else{const r=a2(n);await ef(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await Zl(this.storage,this.storageKey),await Zl(this.storage,this.storageKey+"-code-verifier"),await Zl(this.storage,this.storageKey+"-user"),this.userStorage&&await Zl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ca()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),tf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-t)/tf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${tf}ms, refresh threshold is ${Im} ticks`),r<=Im&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof a4)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ca()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,i){const r=[`provider=${encodeURIComponent(n)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,f]=await Xc(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(f)}`});r.push(d.toString())}if(i!=null&&i.queryParams){const l=new URLSearchParams(i.queryParams);r.push(l.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;return l?{data:null,error:l}:await _e(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(oe(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var i,r;const{data:l,error:f}=n;if(f)return{data:null,error:f};const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:g,error:m}=await _e(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return m?{data:null,error:m}:(t.factorType==="totp"&&g.type==="totp"&&(!((r=g==null?void 0:g.totp)===null||r===void 0)&&r.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(n){if(oe(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{data:null,error:l};const f=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?HC(t.webauthn.credential_response):PC(t.webauthn.credential_response)})}:{code:t.code}),{data:d,error:g}=await _e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:f,headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:g})})}catch(n){if(oe(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{data:null,error:l};const f=await _e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});if(f.error)return f;const{data:d}=f;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:LC(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:GC(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(oe(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:i}=await this.getUser();if(i)return{data:null,error:i};const r={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])r.all.push(l),l.status==="verified"&&r[l.factor_type].push(l);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,i;const{data:{session:r},error:l}=t;if(l)return{data:null,error:l};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=pm(r.access_token);let d=null;f.aal&&(d=f.aal);let g=d;((i=(n=r.user.factors)===null||n===void 0?void 0:n.filter(C=>C.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(g="aal2");const _=f.amr||[];return{data:{currentLevel:d,nextLevel:g,currentAuthenticationMethods:_},error:null}}))}async fetchJwk(t,n={keys:[]}){let i=n.keys.find(d=>d.kid===t);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(d=>d.kid===t),i&&this.jwks_cached_at+FE>r)return i;const{data:l,error:f}=await _e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=r,i=l.keys.find(d=>d.kid===t),!i)?null:i}async getClaims(t,n={}){try{let i=t;if(!i){const{data:R,error:v}=await this.getSession();if(v||!R.session)return{data:null,error:v};i=R.session.access_token}const{header:r,payload:l,signature:f,raw:{header:d,payload:g}}=pm(i);n!=null&&n.allowExpired||vC(l.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!m){const{error:R}=await this.getUser(i);if(R)throw R;return{data:{claims:l,header:r,signature:f},error:null}}const _=yC(r.alg),C=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,C,f,aC(`${d}.${g}`)))throw new Vm("Invalid JWT signature");return{data:{claims:l,header:r,signature:f},error:null}}catch(i){if(oe(i))return{data:null,error:i};throw i}}}fd.nextInstanceID=0;const FC=fd;class JC extends FC{constructor(t){super(t)}}class ZC{constructor(t,n,i){var r,l,f;this.supabaseUrl=t,this.supabaseKey=n;const d=VE(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const g=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:zE,realtime:GE,auth:Object.assign(Object.assign({},LE),{storageKey:g}),global:BE},_=qE(i??{},m);this.storageKey=(r=_.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(l=_.global.headers)!==null&&l!==void 0?l:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(C,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=_.auth)!==null&&f!==void 0?f:{},this.headers,_.global.fetch),this.fetch=IE(n,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new Y_(new URL("rest/v1",d).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new DE(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new B_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,i)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:i}=await this.auth.getSession();return(n=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:l,storageKey:f,flowType:d,lock:g,debug:m},_,C){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new JC({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),_),storageKey:f,autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:l,flowType:d,lock:g,debug:m,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(R=>R.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new oE(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,n,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const WC=(o,t,n)=>new ZC(o,t,n);function $C(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const t=o.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}$C()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const tT=void 0,eT=void 0;console.error("Missing Supabase environment variables. Please check your .env file.");const Wc=WC(tT,eT),nT=()=>{const[o,t]=T2(),n=Qm(),i=()=>{const Gt="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let Yt="";for(let ne=0;ne<6;ne++)Yt+=Gt.charAt(Math.floor(Math.random()*Gt.length));return Yt},r=()=>{const Gt=o.get("room");if(Gt)return Gt;const Yt=i();return t({room:Yt}),Yt},[l]=Hn.useState(r),[f,d]=mt.useState(null),[g,m]=mt.useState(null),[_,C]=mt.useState(null),[E,R]=mt.useState(0),[v,D]=mt.useState("created"),[z,G]=mt.useState(null),[N,M]=mt.useState(null),[L,w]=mt.useState(!1),[A]=mt.useState(`teacher-${Math.random().toString(36).substring(7)}`),[O,y]=mt.useState(()=>{const Gt=parseInt(o.get("bot"))||0,Yt={};if(Gt>0)for(let ne=1;ne<=Gt;ne++){const Ae=`bot-${ne}`;Yt[Ae]={clientId:Ae,name:`Bot ${ne}`,lines:[],lastUpdate:Date.now()-ne*1e3,isActive:!0,isFlagged:!1}}return Yt}),[B,U]=mt.useState(null),[P,K]=mt.useState({}),[Y,Q]=mt.useState(""),[V,j]=mt.useState("all"),[I,X]=mt.useState(()=>{const Gt=localStorage.getItem("teacherDashboardHideNames");return Gt?JSON.parse(Gt):!1}),[Z,at]=mt.useState(()=>{const Gt=localStorage.getItem("teacherDashboardCardsPerRow");return Gt?parseInt(Gt):3}),[J,rt]=mt.useState("blank"),[it,q]=mt.useState(null),[F,$]=mt.useState(null),[nt,ht]=mt.useState(""),[Tt,jt]=mt.useState(!1),[Kt,Wt]=mt.useState(null),ge=mt.useRef(null),[Pt,pe]=mt.useState(!1),[xe,zt]=mt.useState(""),ft=mt.useRef(!1);mt.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(I))},[I]),mt.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",Z.toString())},[Z]),mt.useEffect(()=>{(async()=>{try{console.log("📝 Creating session in Supabase with room code:",l);const{data:Yt,error:ne}=await Wc.from("sessions").insert([{room_code:l,status:"created"}]).select().single();if(ne){console.error("Failed to create session:",ne);return}console.log("✅ Session created:",Yt),d(Yt.id),D(Yt.status)}catch(Yt){console.error("Error creating session:",Yt)}})()},[l]),mt.useEffect(()=>(f&&(async()=>{try{const Yt=`/api/token?clientId=${A}`,Ae=await(await fetch(Yt)).json(),qt=new e_.Realtime({authCallback:async(he,ze)=>{ze(null,Ae)},clientId:A});qt.connection.on("connected",()=>{console.log("Connected to Ably"),w(!0)}),qt.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),w(!1)}),G(qt);const jn=qt.channels.get(`room-${l}`);if(jn.subscribe("student-layer",he=>{console.log("📥 Teacher received student layer from",he.clientId),ft.current=!0,y(ze=>{var me,Wn,nr;return{...ze,[he.clientId]:{...ze[he.clientId]||{},clientId:he.clientId,name:((me=ze[he.clientId])==null?void 0:me.name)||xt(he.clientId),lines:he.data.lines||[],meta:he.data.meta||((Wn=ze[he.clientId])==null?void 0:Wn.meta)||null,lastUpdate:Date.now(),isActive:!0,isFlagged:((nr=ze[he.clientId])==null?void 0:nr.isFlagged)||!1}}}),setTimeout(()=>{ft.current=!1},100)}),jn.presence.subscribe("enter",he=>{var ze;he.clientId!==A&&he.clientId.includes("student")&&(console.log("👋 Student joined:",he.clientId,"Name:",(ze=he.data)==null?void 0:ze.name),y(me=>{var Wn,nr;return{...me,[he.clientId]:{...me[he.clientId]||{},clientId:he.clientId,name:((Wn=he.data)==null?void 0:Wn.name)||xt(he.clientId),isActive:!0,lastUpdate:Date.now(),isFlagged:((nr=me[he.clientId])==null?void 0:nr.isFlagged)||!1}}}))}),jn.presence.subscribe("leave",he=>{he.clientId!==A&&he.clientId.includes("student")&&(console.log("👋 Student left:",he.clientId),y(ze=>{var me;return{...ze,[he.clientId]:{...ze[he.clientId]||{},isActive:!1,isFlagged:((me=ze[he.clientId])==null?void 0:me.isFlagged)||!1}}}))}),jn.subscribe("teacher-image",he=>{console.log("📸 Teacher dashboard received shared image"),Wt(he.data)}),await jn.presence.enter(),M(jn),f)try{const{data:he,error:ze}=await Wc.from("participants").insert([{session_id:f,client_id:A,role:"teacher"}]).select().single();ze?console.error("Failed to create teacher participant:",ze):(console.log("✅ Teacher participant created:",he),m(he.id))}catch(he){console.error("Error creating teacher participant:",he)}}catch(Yt){console.error("Failed to connect to Ably:",Yt)}})(),()=>{z&&z.close()}),[l,A,f]),mt.useEffect(()=>{const Gt=async Yt=>{if((v==="active"||v==="created")&&(Yt.preventDefault(),Yt.returnValue="This will end the session for all students. Are you sure?",f))try{await Wc.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",f),N&&await N.publish("session-ended",{timestamp:Date.now(),reason:"teacher_left"}),console.log("✅ Session ended")}catch(ne){console.error("Error ending session:",ne)}};return window.addEventListener("beforeunload",Gt),()=>{window.removeEventListener("beforeunload",Gt)}},[v,f,N]);const xt=Gt=>{const Yt=Gt.match(/student-(\d+)/)||Gt.match(/student-([\w]+)/);return Yt?`Student ${Yt[1]}`:Gt},Qt=Gt=>{U(O[Gt.clientId]||Gt)},Jt=()=>{U(null)},$t=Gt=>{if(!B||!N)return;const Yt=B.clientId;K(ne=>({...ne,[Yt]:Gt})),N.publish("teacher-annotation",{targetStudentId:Yt,annotations:Gt,teacherId:A,timestamp:Date.now()}),console.log("📤 Published annotations for",Yt)},ve=Gt=>{y(Yt=>{const ne=Yt[Gt];return ne?{...Yt,[Gt]:{...ne,isFlagged:!ne.isFlagged}}:Yt}),U(Yt=>Yt&&Yt.clientId===Gt?{...Yt,isFlagged:!Yt.isFlagged}:Yt)},ae=()=>{ge.current&&(ge.current.value="",ge.current.click())},ln=async Gt=>{var ne;const Yt=(ne=Gt.target.files)==null?void 0:ne[0];if(!Yt){ht("No file selected.");return}jt(!0),ht("");try{const{dataUrl:Ae,width:qt,height:jn}=await R_(Yt),he={dataUrl:Ae,width:qt,height:jn,filename:Yt.name,timestamp:Date.now()};$(he),ht("Image ready to send.")}catch(Ae){console.error("Failed to upload image from dashboard:",Ae),ht("Upload failed. Please try again.")}finally{jt(!1)}},Sn=()=>{$(null),ht(""),ge.current&&(ge.current.value="")},We=Gt=>{const Yt=document.createElement("canvas"),ne=800,Ae=600;Yt.width=ne,Yt.height=Ae;const qt=Yt.getContext("2d");if(qt.fillStyle="#FFFFFF",qt.fillRect(0,0,ne,Ae),Gt==="hanzi"){const ze=(ne-450)/2,me=(Ae-450)/2;qt.strokeStyle="#0F9D83",qt.lineWidth=4,qt.strokeRect(ze,me,450,450),qt.strokeStyle="#B0E8D8",qt.lineWidth=2,qt.setLineDash([8,8]),qt.beginPath(),qt.moveTo(ne/2,me),qt.lineTo(ne/2,me+450),qt.stroke(),qt.beginPath(),qt.moveTo(ze,Ae/2),qt.lineTo(ze+450,Ae/2),qt.stroke()}else if(Gt==="graph-corner"){qt.strokeStyle="#E0E0E0",qt.lineWidth=1,qt.setLineDash([]);for(let me=80;me<=ne-80;me+=40)qt.beginPath(),qt.moveTo(me,80),qt.lineTo(me,Ae-80),qt.stroke();for(let me=80;me<=Ae-80;me+=40)qt.beginPath(),qt.moveTo(80,me),qt.lineTo(ne-80,me),qt.stroke();qt.strokeStyle="#5B9BD5",qt.lineWidth=3,qt.beginPath(),qt.moveTo(80,Ae-80),qt.lineTo(ne-80,Ae-80),qt.stroke(),qt.beginPath(),qt.moveTo(80,80),qt.lineTo(80,Ae-80),qt.stroke()}else if(Gt==="graph-cross"){qt.strokeStyle="#E0E0E0",qt.lineWidth=1,qt.setLineDash([]);for(let me=80;me<=ne-80;me+=40)qt.beginPath(),qt.moveTo(me,80),qt.lineTo(me,Ae-80),qt.stroke();for(let me=80;me<=Ae-80;me+=40)qt.beginPath(),qt.moveTo(80,me),qt.lineTo(ne-80,me),qt.stroke();qt.strokeStyle="#5B9BD5",qt.lineWidth=3,qt.beginPath(),qt.moveTo(80,Ae/2),qt.lineTo(ne-80,Ae/2),qt.stroke(),qt.beginPath(),qt.moveTo(ne/2,80),qt.lineTo(ne/2,Ae-80),qt.stroke()}const jn=Yt.toDataURL("image/png");return{type:Gt,dataUrl:jn,width:ne,height:Ae,timestamp:Date.now()}},ut=Gt=>{const Yt=We(Gt);q(Yt),ht(`Template ready: ${Gt}`)},Ot=async()=>{if(!(!N||!f))try{if(v==="created"){console.log("🎬 Starting session...");const{error:ze}=await Wc.from("sessions").update({status:"active",started_at:new Date().toISOString()}).eq("id",f);if(ze){console.error("Failed to start session:",ze),ht("Failed to start session. Please try again.");return}D("active"),await N.publish("session-started",{timestamp:Date.now(),sessionId:f}),console.log("✅ Session started!")}const Yt=E+1;R(Yt);let ne="blank",Ae=null,qt=null;J==="templates"&&it?(ne="template",Ae=it.type,qt={dataUrl:it.dataUrl,width:it.width,height:it.height}):J==="image"&&F&&(ne="image",qt={dataUrl:F.dataUrl,width:F.width,height:F.height,filename:F.filename});const{data:jn,error:he}=await Wc.from("questions").insert([{session_id:f,question_number:Yt,content_type:ne,template_type:Ae,image_data:qt}]).select().single();if(he){console.error("Failed to create question:",he),ht("Failed to save question. Please try again.");return}console.log("✅ Question created:",jn),C(jn.id),await N.publish("clear-all-drawings",{timestamp:Date.now()}),y(ze=>{const me={};return Object.keys(ze).forEach(Wn=>{me[Wn]={...ze[Wn],lines:[]}}),me}),K({}),J==="blank"?(await N.publish("teacher-clear",{timestamp:Date.now()}),Wt(null),q(null),ht(`Question ${Yt}: Blank canvas sent to all students.`)):J==="templates"&&it?(await N.publish("teacher-template",it),Wt(it),ht(`Question ${Yt}: Template sent to all students.`)):J==="image"&&F&&(await N.publish("teacher-image",F),Wt(F),ht(`Question ${Yt}: Image sent to all students.`))}catch(Gt){console.error("Failed to send to class:",Gt),ht("Failed to send. Please try again.")}},Mt=async()=>{if(f&&(v==="active"||v==="created"))try{await Wc.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",f),N&&await N.publish("session-ended",{timestamp:Date.now(),reason:"teacher_ended"}),console.log("✅ Session ended")}catch(Gt){console.error("Error ending session:",Gt)}z&&z.close(),n("/")},Ft=async()=>{const Gt=`${window.location.origin}/student?room=${l}`;try{const Yt=await T_.toDataURL(Gt,{width:300,margin:2,color:{dark:"#0F172A",light:"#FFFFFF"}});zt(Yt),pe(!0)}catch(Yt){console.error("Failed to generate QR code:",Yt)}},Ee=async()=>{const Gt=`${window.location.origin}/student?room=${l}`;try{await navigator.clipboard.writeText(Gt),alert("Link copied to clipboard!")}catch(Yt){console.error("Failed to copy link:",Yt),alert("Failed to copy link. Please copy manually.")}},dn=()=>Object.values(O).sort((Gt,Yt)=>Gt.isActive&&!Yt.isActive?-1:!Gt.isActive&&Yt.isActive?1:(Yt.lastUpdate||0)-(Gt.lastUpdate||0)),An=()=>{const Gt=dn(),Yt=Y.trim().toLowerCase();return Gt.filter(ne=>{const Ae=Yt?(ne.name||ne.clientId).toLowerCase().includes(Yt):!0,qt=V==="all"||V==="flagged"&&ne.isFlagged;return Ae&&qt})},ki=dn(),hi=An(),Su=ki.filter(Gt=>Gt.isActive).length,er=B?O[B.clientId]||B:null,cl=nt?!/fail|no file/i.test(nt):!1;return et.jsxs("div",{className:"teacher-dashboard",children:[et.jsxs("div",{className:"dashboard-shell",children:[et.jsx("button",{className:"back-link",onClick:Mt,children:"← Exit class"}),et.jsxs("section",{className:"hero-card glass-panel",children:[et.jsxs("div",{className:"hero-top",children:[et.jsxs("div",{className:"hero-copy",children:[et.jsx("p",{className:"eyebrow",children:"Teacher dashboard"}),et.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),et.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),et.jsxs("div",{className:"session-info",children:[et.jsxs("div",{className:"session-code-pill clickable",onClick:Ft,style:{cursor:"pointer"},children:[et.jsx("span",{className:"pill-label",children:"Session code"}),et.jsx("span",{className:"pill-value",children:l})]}),et.jsxs("div",{className:"status-group",children:[et.jsx("span",{className:"status-pill session-pill",children:"Session live"}),et.jsx("span",{className:`status-pill connection-pill ${L?"online":"offline"}`,children:L?"Connected":"Disconnected"}),et.jsxs("span",{className:"status-pill count-pill",children:[et.jsx("strong",{children:Su}),et.jsx("span",{children:"online"})]})]})]})]}),et.jsxs("div",{className:"hero-controls",children:[et.jsxs("div",{className:"search-input-wrapper",children:[et.jsx("span",{className:"search-icon",children:"🔍"}),et.jsx("input",{type:"text",placeholder:"Filter students",value:Y,onChange:Gt=>Q(Gt.target.value),className:"search-input"}),Y&&et.jsx("button",{className:"clear-search-btn",onClick:()=>Q(""),title:"Clear search",children:"✕"})]}),et.jsxs("div",{className:"control-set",children:[et.jsxs("label",{className:"hide-names-checkbox",children:[et.jsx("input",{type:"checkbox",checked:I,onChange:Gt=>X(Gt.target.checked)}),et.jsx("span",{children:"Hide names"})]}),et.jsx("button",{type:"button",className:`chip-button ${V==="flagged"?"active":""}`,onClick:()=>j(Gt=>Gt==="flagged"?"all":"flagged"),children:"Flagged only"}),et.jsxs("div",{className:"cards-select",children:[et.jsx("span",{children:"Cards/row"}),et.jsxs("select",{value:Z,onChange:Gt=>at(Number(Gt.target.value)),children:[et.jsx("option",{value:2,children:"2"}),et.jsx("option",{value:3,children:"3"}),et.jsx("option",{value:4,children:"4"})]})]})]})]})]}),et.jsxs("section",{className:"prep-card glass-panel",children:[et.jsxs("div",{className:"prep-header",children:[et.jsxs("div",{children:[et.jsx("p",{className:"eyebrow",children:"Prepare next question"}),it&&et.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",it.type==="hanzi"?"Hanzi":it.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),et.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),et.jsx("button",{className:"send-to-class-btn",onClick:Ot,disabled:J==="image"&&!F,children:"Send to class"})]}),et.jsxs("div",{className:"prep-controls",children:[et.jsxs("div",{className:"prep-tabs",children:[et.jsx("button",{type:"button",className:`prep-tab ${J==="blank"?"active":""}`,onClick:()=>{rt("blank"),q(null),$(null)},children:"Blank canvas"}),et.jsx("button",{type:"button",className:`prep-tab ${J==="templates"?"active":""}`,onClick:()=>{rt("templates"),$(null)},children:"Templates"}),et.jsx("button",{type:"button",className:`prep-tab ${J==="image"?"active":""} ${F?"ready":""}`,onClick:()=>{rt("image"),q(null)},disabled:Tt,children:Tt?"Uploading…":"Send image"})]}),et.jsx("input",{ref:ge,type:"file",accept:"image/*",onChange:ln,style:{display:"none"}}),J==="templates"&&et.jsxs("div",{className:"template-selector",children:[et.jsxs("div",{className:"template-buttons",children:[et.jsx("button",{type:"button",className:`template-btn ${(it==null?void 0:it.type)==="hanzi"?"active":""}`,onClick:()=>ut("hanzi"),children:"Hanzi box"}),et.jsx("button",{type:"button",className:`template-btn ${(it==null?void 0:it.type)==="graph-corner"?"active":""}`,onClick:()=>ut("graph-corner"),children:"Graph (corner)"}),et.jsx("button",{type:"button",className:`template-btn ${(it==null?void 0:it.type)==="graph-cross"?"active":""}`,onClick:()=>ut("graph-cross"),children:"Graph (cross)"})]}),it&&et.jsxs("div",{className:"template-preview",children:[et.jsx("img",{src:it.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),et.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),J==="image"&&et.jsx(et.Fragment,{children:F?et.jsxs("div",{className:"image-preview-surface",children:[et.jsx("img",{src:F.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),et.jsxs("div",{className:"preview-meta",children:[et.jsx("p",{className:"preview-title",children:F.filename||"Prepared image"}),et.jsx("p",{className:"preview-subtitle",children:F.width&&F.height?`${Math.round(F.width)} × ${Math.round(F.height)} px`:"Ready to send"}),et.jsxs("div",{className:"image-actions",children:[et.jsx("button",{className:"ghost-btn",onClick:ae,children:"Choose another"}),et.jsx("button",{className:"ghost-btn",onClick:Sn,children:"Clear"})]}),nt&&et.jsx("span",{className:`image-message ${cl?"success":"error"}`,children:nt})]})]}):et.jsxs("button",{type:"button",className:"image-dropzone",onClick:ae,children:[et.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),et.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),et.jsx("span",{children:"Click to upload an image"}),nt&&et.jsx("span",{className:`image-message ${cl?"success":"error"}`,children:nt})]})}),J==="blank"&&et.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:et.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),et.jsx("section",{className:"students-panel",children:et.jsx("div",{className:"students-surface glass-panel",children:ki.length===0?et.jsxs("div",{className:"waiting-card",children:[et.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),et.jsx("h2",{children:"Waiting for students to join…"}),et.jsxs("p",{children:["Share the ",et.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):hi.length===0?et.jsxs("div",{className:"no-results",children:[et.jsx("div",{className:"no-results-icon",children:"🔍"}),et.jsx("h3",{children:"No students found"}),et.jsxs("p",{children:['No students match "',Y,'"']}),et.jsx("button",{className:"clear-filter-btn",onClick:()=>Q(""),children:"Clear filter"})]}):et.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${Z}, 1fr)`},children:hi.filter(Gt=>Gt&&Gt.clientId).map(Gt=>et.jsx(A_,{student:Gt,onClick:Qt,onToggleFlag:ve,teacherAnnotations:P[Gt.clientId]||[],sharedImage:Kt,hideNames:I},Gt.clientId))})})})]}),et.jsx(O_,{student:er,isOpen:!!er,isFlagged:er==null?void 0:er.isFlagged,onToggleFlag:ve,onClose:Jt,onAnnotate:$t,existingAnnotations:er?P[er.clientId]||[]:[],sharedImage:Kt}),et.jsx("div",{className:"dashboard-footer",children:et.jsxs("p",{children:["💡 ",et.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),Pt&&et.jsx("div",{className:"qr-modal-overlay",onClick:()=>pe(!1),children:et.jsxs("div",{className:"qr-modal",onClick:Gt=>Gt.stopPropagation(),children:[et.jsxs("div",{className:"qr-modal-header",children:[et.jsxs("h2",{children:["Join Session: ",l]}),et.jsx("button",{className:"qr-close-btn",onClick:()=>pe(!1),children:"✕"})]}),et.jsxs("div",{className:"qr-modal-content",children:[et.jsx("div",{className:"qr-code-container",children:xe&&et.jsx("img",{src:xe,alt:"QR Code",className:"qr-code-image"})}),et.jsxs("div",{className:"qr-instructions",children:[et.jsxs("p",{className:"qr-instruction-text",children:[et.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),et.jsxs("div",{className:"qr-link-box",children:[et.jsx("input",{type:"text",value:`${window.location.origin}/student?room=${l}`,readOnly:!0,className:"qr-link-input"}),et.jsx("button",{className:"qr-copy-btn",onClick:Ee,children:"Copy Link"})]})]})]})]})})]})};function iT(){return et.jsx(tb,{children:et.jsxs(J3,{children:[et.jsx(ug,{path:"/",element:et.jsx(eb,{})}),et.jsx(ug,{path:"/student",element:et.jsx(W8,{})}),et.jsx(ug,{path:"/teacher",element:et.jsx(nT,{})})]})})}a3.createRoot(document.getElementById("root")).render(et.jsx(Hn.StrictMode,{children:et.jsx(iT,{})}));
