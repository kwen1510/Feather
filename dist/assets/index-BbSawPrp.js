function h4(l,t){for(var n=0;n<t.length;n++){const a=t[n];if(typeof a!="string"&&!Array.isArray(a)){for(const r in a)if(r!=="default"&&!(r in l)){const o=Object.getOwnPropertyDescriptor(a,r);o&&Object.defineProperty(l,r,o.get?o:{enumerable:!0,get:()=>a[r]})}}}return Object.freeze(Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function pf(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function b2(l){if(Object.prototype.hasOwnProperty.call(l,"__esModule"))return l;var t=l.default;if(typeof t=="function"){var n=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(l).forEach(function(a){var r=Object.getOwnPropertyDescriptor(l,a);Object.defineProperty(n,a,r.get?r:{enumerable:!0,get:function(){return l[a]}})}),n}var mp={exports:{}},Kh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iy;function d4(){if(iy)return Kh;iy=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(a,r,o){var f=null;if(o!==void 0&&(f=""+o),r.key!==void 0&&(f=""+r.key),"key"in r){o={};for(var h in r)h!=="key"&&(o[h]=r[h])}else o=r;return r=o.ref,{$$typeof:l,type:a,key:f,ref:r!==void 0?r:null,props:o}}return Kh.Fragment=t,Kh.jsx=n,Kh.jsxs=n,Kh}var ry;function g4(){return ry||(ry=1,mp.exports=d4()),mp.exports}var k=g4(),vp={exports:{}},xe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sy;function p4(){if(sy)return xe;sy=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),E=Symbol.iterator;function R(Z){return Z===null||typeof Z!="object"?null:(Z=E&&Z[E]||Z["@@iterator"],typeof Z=="function"?Z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,B={};function L(Z,it,rt){this.props=Z,this.context=it,this.refs=B,this.updater=rt||v}L.prototype.isReactComponent={},L.prototype.setState=function(Z,it){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,it,"setState")},L.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function N(){}N.prototype=L.prototype;function M(Z,it,rt){this.props=Z,this.context=it,this.refs=B,this.updater=rt||v}var G=M.prototype=new N;G.constructor=M,D(G,L.prototype),G.isPureReactComponent=!0;var O=Array.isArray;function w(){}var T={H:null,A:null,T:null,S:null},y=Object.prototype.hasOwnProperty;function z(Z,it,rt){var V=rt.ref;return{$$typeof:l,type:Z,key:it,ref:V!==void 0?V:null,props:rt}}function U(Z,it){return z(Z.type,it,Z.props)}function P(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===l}function K(Z){var it={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(rt){return it[rt]})}var Q=/\/+/g;function X(Z,it){return typeof Z=="object"&&Z!==null&&Z.key!=null?K(""+Z.key):it.toString(36)}function Y(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(w,w):(Z.status="pending",Z.then(function(it){Z.status==="pending"&&(Z.status="fulfilled",Z.value=it)},function(it){Z.status==="pending"&&(Z.status="rejected",Z.reason=it)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function j(Z,it,rt,V,J){var $=typeof Z;($==="undefined"||$==="boolean")&&(Z=null);var at=!1;if(Z===null)at=!0;else switch($){case"bigint":case"string":case"number":at=!0;break;case"object":switch(Z.$$typeof){case l:case t:at=!0;break;case _:return at=Z._init,j(at(Z._payload),it,rt,V,J)}}if(at)return J=J(Z),at=V===""?"."+X(Z,0):V,O(J)?(rt="",at!=null&&(rt=at.replace(Q,"$&/")+"/"),j(J,it,rt,"",function(zt){return zt})):J!=null&&(P(J)&&(J=U(J,rt+(J.key==null||Z&&Z.key===J.key?"":(""+J.key).replace(Q,"$&/")+"/")+at)),it.push(J)),1;at=0;var ht=V===""?".":V+":";if(O(Z))for(var Rt=0;Rt<Z.length;Rt++)V=Z[Rt],$=ht+X(V,Rt),at+=j(V,it,rt,$,J);else if(Rt=R(Z),typeof Rt=="function")for(Z=Rt.call(Z),Rt=0;!(V=Z.next()).done;)V=V.value,$=ht+X(V,Rt++),at+=j(V,it,rt,$,J);else if($==="object"){if(typeof Z.then=="function")return j(Y(Z),it,rt,V,J);throw it=String(Z),Error("Objects are not valid as a React child (found: "+(it==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":it)+"). If you meant to render a collection of children, use an array instead.")}return at}function I(Z,it,rt){if(Z==null)return Z;var V=[],J=0;return j(Z,V,"","",function($){return it.call(rt,$,J++)}),V}function F(Z){if(Z._status===-1){var it=Z._result;it=it(),it.then(function(rt){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=rt)},function(rt){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=rt)}),Z._status===-1&&(Z._status=0,Z._result=it)}if(Z._status===1)return Z._result.default;throw Z._result}var W=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var it=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(it))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},nt={map:I,forEach:function(Z,it,rt){I(Z,function(){it.apply(this,arguments)},rt)},count:function(Z){var it=0;return I(Z,function(){it++}),it},toArray:function(Z){return I(Z,function(it){return it})||[]},only:function(Z){if(!P(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return xe.Activity=C,xe.Children=nt,xe.Component=L,xe.Fragment=n,xe.Profiler=r,xe.PureComponent=M,xe.StrictMode=a,xe.Suspense=g,xe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,xe.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return T.H.useMemoCache(Z)}},xe.cache=function(Z){return function(){return Z.apply(null,arguments)}},xe.cacheSignal=function(){return null},xe.cloneElement=function(Z,it,rt){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var V=D({},Z.props),J=Z.key;if(it!=null)for($ in it.key!==void 0&&(J=""+it.key),it)!y.call(it,$)||$==="key"||$==="__self"||$==="__source"||$==="ref"&&it.ref===void 0||(V[$]=it[$]);var $=arguments.length-2;if($===1)V.children=rt;else if(1<$){for(var at=Array($),ht=0;ht<$;ht++)at[ht]=arguments[ht+2];V.children=at}return z(Z.type,J,V)},xe.createContext=function(Z){return Z={$$typeof:f,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:o,_context:Z},Z},xe.createElement=function(Z,it,rt){var V,J={},$=null;if(it!=null)for(V in it.key!==void 0&&($=""+it.key),it)y.call(it,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(J[V]=it[V]);var at=arguments.length-2;if(at===1)J.children=rt;else if(1<at){for(var ht=Array(at),Rt=0;Rt<at;Rt++)ht[Rt]=arguments[Rt+2];J.children=ht}if(Z&&Z.defaultProps)for(V in at=Z.defaultProps,at)J[V]===void 0&&(J[V]=at[V]);return z(Z,$,J)},xe.createRef=function(){return{current:null}},xe.forwardRef=function(Z){return{$$typeof:h,render:Z}},xe.isValidElement=P,xe.lazy=function(Z){return{$$typeof:_,_payload:{_status:-1,_result:Z},_init:F}},xe.memo=function(Z,it){return{$$typeof:m,type:Z,compare:it===void 0?null:it}},xe.startTransition=function(Z){var it=T.T,rt={};T.T=rt;try{var V=Z(),J=T.S;J!==null&&J(rt,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(w,W)}catch($){W($)}finally{it!==null&&rt.types!==null&&(it.types=rt.types),T.T=it}},xe.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},xe.use=function(Z){return T.H.use(Z)},xe.useActionState=function(Z,it,rt){return T.H.useActionState(Z,it,rt)},xe.useCallback=function(Z,it){return T.H.useCallback(Z,it)},xe.useContext=function(Z){return T.H.useContext(Z)},xe.useDebugValue=function(){},xe.useDeferredValue=function(Z,it){return T.H.useDeferredValue(Z,it)},xe.useEffect=function(Z,it){return T.H.useEffect(Z,it)},xe.useEffectEvent=function(Z){return T.H.useEffectEvent(Z)},xe.useId=function(){return T.H.useId()},xe.useImperativeHandle=function(Z,it,rt){return T.H.useImperativeHandle(Z,it,rt)},xe.useInsertionEffect=function(Z,it){return T.H.useInsertionEffect(Z,it)},xe.useLayoutEffect=function(Z,it){return T.H.useLayoutEffect(Z,it)},xe.useMemo=function(Z,it){return T.H.useMemo(Z,it)},xe.useOptimistic=function(Z,it){return T.H.useOptimistic(Z,it)},xe.useReducer=function(Z,it,rt){return T.H.useReducer(Z,it,rt)},xe.useRef=function(Z){return T.H.useRef(Z)},xe.useState=function(Z){return T.H.useState(Z)},xe.useSyncExternalStore=function(Z,it,rt){return T.H.useSyncExternalStore(Z,it,rt)},xe.useTransition=function(){return T.H.useTransition()},xe.version="19.2.0",xe}var ly;function Eg(){return ly||(ly=1,vp.exports=p4()),vp.exports}var st=Eg();const ta=pf(st),m4=h4({__proto__:null,default:ta},[st]);var yp={exports:{}},Qh={},Sp={exports:{}},bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy;function v4(){return oy||(oy=1,(function(l){function t(j,I){var F=j.length;j.push(I);t:for(;0<F;){var W=F-1>>>1,nt=j[W];if(0<r(nt,I))j[W]=I,j[F]=nt,F=W;else break t}}function n(j){return j.length===0?null:j[0]}function a(j){if(j.length===0)return null;var I=j[0],F=j.pop();if(F!==I){j[0]=F;t:for(var W=0,nt=j.length,Z=nt>>>1;W<Z;){var it=2*(W+1)-1,rt=j[it],V=it+1,J=j[V];if(0>r(rt,F))V<nt&&0>r(J,rt)?(j[W]=J,j[V]=F,W=V):(j[W]=rt,j[it]=F,W=it);else if(V<nt&&0>r(J,F))j[W]=J,j[V]=F,W=V;else break t}}return I}function r(j,I){var F=j.sortIndex-I.sortIndex;return F!==0?F:j.id-I.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;l.unstable_now=function(){return o.now()}}else{var f=Date,h=f.now();l.unstable_now=function(){return f.now()-h}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,B=!1,L=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(j){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=j)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(j){if(D=!1,G(j),!v)if(n(g)!==null)v=!0,w||(w=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-j)}}var w=!1,T=-1,y=5,z=-1;function U(){return B?!0:!(l.unstable_now()-z<y)}function P(){if(B=!1,w){var j=l.unstable_now();z=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(T),T=-1),R=!0;var F=E;try{e:{for(G(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var nt=W(C.expirationTime<=j);if(j=l.unstable_now(),typeof nt=="function"){C.callback=nt,G(j),I=!0;break e}C===n(g)&&a(g),G(j)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-j),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():w=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=P,K=function(){X.postMessage(null)}}else K=function(){L(P,0)};function Y(j,I){T=L(function(){j(l.unstable_now())},I)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(j){j.callback=null},l.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},l.unstable_getCurrentPriorityLevel=function(){return E},l.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return j()}finally{E=F}},l.unstable_requestPaint=function(){B=!0},l.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var F=E;E=j;try{return I()}finally{E=F}},l.unstable_scheduleCallback=function(j,I,F){var W=l.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,j){case 1:var nt=-1;break;case 2:nt=250;break;case 5:nt=1073741823;break;case 4:nt=1e4;break;default:nt=5e3}return nt=F+nt,j={id:_++,callback:I,priorityLevel:j,startTime:F,expirationTime:nt,sortIndex:-1},F>W?(j.sortIndex=F,t(m,j),n(g)===null&&j===n(m)&&(D?(N(T),T=-1):D=!0,Y(O,F-W))):(j.sortIndex=nt,t(g,j),v||R||(v=!0,w||(w=!0,K()))),j},l.unstable_shouldYield=U,l.unstable_wrapCallback=function(j){var I=E;return function(){var F=E;E=I;try{return j.apply(this,arguments)}finally{E=F}}}})(bp)),bp}var uy;function y4(){return uy||(uy=1,Sp.exports=v4()),Sp.exports}var _p={exports:{}},ti={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy;function S4(){if(cy)return ti;cy=1;var l=Eg();function t(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var a={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(g,m,_){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:C==null?null:""+C,children:g,containerInfo:m,implementation:_}}var f=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return ti.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,ti.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return o(g,m,null,_)},ti.flushSync=function(g){var m=f.T,_=a.p;try{if(f.T=null,a.p=2,g)return g()}finally{f.T=m,a.p=_,a.d.f()}},ti.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(g,m))},ti.prefetchDNS=function(g){typeof g=="string"&&a.d.D(g)},ti.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,C=h(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,R=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?a.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:C,integrity:E,fetchPriority:R}):_==="script"&&a.d.X(g,{crossOrigin:C,integrity:E,fetchPriority:R,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},ti.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=h(m.as,m.crossOrigin);a.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(g)},ti.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,C=h(_,m.crossOrigin);a.d.L(g,_,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},ti.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=h(m.as,m.crossOrigin);a.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(g)},ti.requestFormReset=function(g){a.d.r(g)},ti.unstable_batchedUpdates=function(g,m){return g(m)},ti.useFormState=function(g,m,_){return f.H.useFormState(g,m,_)},ti.useFormStatus=function(){return f.H.useHostTransitionStatus()},ti.version="19.2.0",ti}var fy;function _2(){if(fy)return _p.exports;fy=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),_p.exports=S4(),_p.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function b4(){if(hy)return Qh;hy=1;var l=y4(),t=Eg(),n=_2();function a(e){var i="https://react.dev/errors/"+e;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var i=e,c=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,(i.flags&4098)!==0&&(c=i.return),e=i.return;while(e)}return i.tag===3?c:null}function f(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function h(e){if(e.tag===31){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function g(e){if(o(e)!==e)throw Error(a(188))}function m(e){var i=e.alternate;if(!i){if(i=o(e),i===null)throw Error(a(188));return i!==e?null:e}for(var c=e,d=i;;){var b=c.return;if(b===null)break;var A=b.alternate;if(A===null){if(d=b.return,d!==null){c=d;continue}break}if(b.child===A.child){for(A=b.child;A;){if(A===c)return g(b),e;if(A===d)return g(b),i;A=A.sibling}throw Error(a(188))}if(c.return!==d.return)c=b,d=A;else{for(var q=!1,tt=b.child;tt;){if(tt===c){q=!0,c=b,d=A;break}if(tt===d){q=!0,d=b,c=A;break}tt=tt.sibling}if(!q){for(tt=A.child;tt;){if(tt===c){q=!0,c=A,d=b;break}if(tt===d){q=!0,d=A,c=b;break}tt=tt.sibling}if(!q)throw Error(a(189))}}if(c.alternate!==d)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?e:i}function _(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e;for(e=e.child;e!==null;){if(i=_(e),i!==null)return i;e=e.sibling}return null}var C=Object.assign,E=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),M=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function K(e){return e===null||typeof e!="object"?null:(e=P&&e[P]||e["@@iterator"],typeof e=="function"?e:null)}var Q=Symbol.for("react.client.reference");function X(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case D:return"Fragment";case L:return"Profiler";case B:return"StrictMode";case O:return"Suspense";case w:return"SuspenseList";case z:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case M:return e.displayName||"Context";case N:return(e._context.displayName||"Context")+".Consumer";case G:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case T:return i=e.displayName||null,i!==null?i:X(e.type)||"Memo";case y:i=e._payload,e=e._init;try{return X(e(i))}catch{}}return null}var Y=Array.isArray,j=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},W=[],nt=-1;function Z(e){return{current:e}}function it(e){0>nt||(e.current=W[nt],W[nt]=null,nt--)}function rt(e,i){nt++,W[nt]=e.current,e.current=i}var V=Z(null),J=Z(null),$=Z(null),at=Z(null);function ht(e,i){switch(rt($,i),rt(J,e),rt(V,null),i.nodeType){case 9:case 11:e=(e=i.documentElement)&&(e=e.namespaceURI)?Rv(e):0;break;default:if(e=i.tagName,i=i.namespaceURI)i=Rv(i),e=Ov(i,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}it(V),rt(V,e)}function Rt(){it(V),it(J),it($)}function zt(e){e.memoizedState!==null&&rt(at,e);var i=V.current,c=Ov(i,e.type);i!==c&&(rt(J,e),rt(V,c))}function Wt(e){J.current===e&&(it(V),it(J)),at.current===e&&(it(at),kh._currentValue=F)}var It,pe;function Bt(e){if(It===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);It=i&&i[1]||"",pe=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+It+e+pe}var Te=!1;function ze(e,i){if(!e||Te)return"";Te=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Nt=function(){throw Error()};if(Object.defineProperty(Nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Nt,[])}catch(Tt){var Et=Tt}Reflect.construct(e,[],Nt)}else{try{Nt.call()}catch(Tt){Et=Tt}e.call(Nt.prototype)}}else{try{throw Error()}catch(Tt){Et=Tt}(Nt=e())&&typeof Nt.catch=="function"&&Nt.catch(function(){})}}catch(Tt){if(Tt&&Et&&typeof Tt.stack=="string")return[Tt.stack,Et.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=d.DetermineComponentFrameRoot(),q=A[0],tt=A[1];if(q&&tt){var ot=q.split(`
`),St=tt.split(`
`);for(b=d=0;d<ot.length&&!ot[d].includes("DetermineComponentFrameRoot");)d++;for(;b<St.length&&!St[b].includes("DetermineComponentFrameRoot");)b++;if(d===ot.length||b===St.length)for(d=ot.length-1,b=St.length-1;1<=d&&0<=b&&ot[d]!==St[b];)b--;for(;1<=d&&0<=b;d--,b--)if(ot[d]!==St[b]){if(d!==1||b!==1)do if(d--,b--,0>b||ot[d]!==St[b]){var Ot=`
`+ot[d].replace(" at new "," at ");return e.displayName&&Ot.includes("<anonymous>")&&(Ot=Ot.replace("<anonymous>",e.displayName)),Ot}while(1<=d&&0<=b);break}}}finally{Te=!1,Error.prepareStackTrace=c}return(c=e?e.displayName||e.name:"")?Bt(c):""}function Xe(e,i){switch(e.tag){case 26:case 27:case 5:return Bt(e.type);case 16:return Bt("Lazy");case 13:return e.child!==i&&i!==null?Bt("Suspense Fallback"):Bt("Suspense");case 19:return Bt("SuspenseList");case 0:case 15:return ze(e.type,!1);case 11:return ze(e.type.render,!1);case 1:return ze(e.type,!0);case 31:return Bt("Activity");default:return""}}function ke(e){try{var i="",c=null;do i+=Xe(e,c),c=e,e=e.return;while(e);return i}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var hn=Object.prototype.hasOwnProperty,Un=l.unstable_scheduleCallback,wt=l.unstable_cancelCallback,Yt=l.unstable_shouldYield,Fe=l.unstable_requestPaint,Se=l.unstable_now,we=l.unstable_getCurrentPriorityLevel,$e=l.unstable_ImmediatePriority,Ae=l.unstable_UserBlockingPriority,ct=l.unstable_NormalPriority,At=l.unstable_LowPriority,xt=l.unstable_IdlePriority,kt=l.log,le=l.unstable_setDisableYieldValue,Lt=null,vt=null;function gt(e){if(typeof kt=="function"&&le(e),vt&&typeof vt.setStrictMode=="function")try{vt.setStrictMode(Lt,e)}catch{}}var Jt=Math.clz32?Math.clz32:Ce,se=Math.log,Kt=Math.LN2;function Ce(e){return e>>>=0,e===0?32:31-(se(e)/Kt|0)|0}var fe=256,_e=262144,Pe=4194304;function En(e){var i=e&42;if(i!==0)return i;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Aa(e,i,c){var d=e.pendingLanes;if(d===0)return 0;var b=0,A=e.suspendedLanes,q=e.pingedLanes;e=e.warmLanes;var tt=d&134217727;return tt!==0?(d=tt&~A,d!==0?b=En(d):(q&=tt,q!==0?b=En(q):c||(c=tt&~e,c!==0&&(b=En(c))))):(tt=d&~A,tt!==0?b=En(tt):q!==0?b=En(q):c||(c=d&~e,c!==0&&(b=En(c)))),b===0?0:i!==0&&i!==b&&(i&A)===0&&(A=b&-b,c=i&-i,A>=c||A===32&&(c&4194048)!==0)?i:b}function pi(e,i){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&i)===0}function Na(e,i){switch(e){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _s(){var e=Pe;return Pe<<=1,(Pe&62914560)===0&&(Pe=4194304),e}function Dt(e){for(var i=[],c=0;31>c;c++)i.push(e);return i}function jt(e,i){e.pendingLanes|=i,i!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function te(e,i,c,d,b,A){var q=e.pendingLanes;e.pendingLanes=c,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=c,e.entangledLanes&=c,e.errorRecoveryDisabledLanes&=c,e.shellSuspendCounter=0;var tt=e.entanglements,ot=e.expirationTimes,St=e.hiddenUpdates;for(c=q&~c;0<c;){var Ot=31-Jt(c),Nt=1<<Ot;tt[Ot]=0,ot[Ot]=-1;var Et=St[Ot];if(Et!==null)for(St[Ot]=null,Ot=0;Ot<Et.length;Ot++){var Tt=Et[Ot];Tt!==null&&(Tt.lane&=-536870913)}c&=~Nt}d!==0&&ae(e,d,0),A!==0&&b===0&&e.tag!==0&&(e.suspendedLanes|=A&~(q&~i))}function ae(e,i,c){e.pendingLanes|=i,e.suspendedLanes&=~i;var d=31-Jt(i);e.entangledLanes|=i,e.entanglements[d]=e.entanglements[d]|1073741824|c&261930}function Ft(e,i){var c=e.entangledLanes|=i;for(e=e.entanglements;c;){var d=31-Jt(c),b=1<<d;b&i|e[d]&i&&(e[d]|=i),c&=~b}}function On(e,i){var c=i&-i;return c=(c&42)!==0?1:Xn(c),(c&(e.suspendedLanes|i))!==0?0:c}function Xn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Pn(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Ee(){var e=I.p;return e!==0?e:(e=window.event,e===void 0?32:Zv(e.type))}function ee(e,i){var c=I.p;try{return I.p=e,i()}finally{I.p=c}}var He=Math.random().toString(36).slice(2),he="__reactFiber$"+He,Ne="__reactProps$"+He,Ue="__reactContainer$"+He,rn="__reactEvents$"+He,ia="__reactListeners$"+He,mi="__reactHandles$"+He,Es="__reactResources$"+He,ki="__reactMarker$"+He;function Bn(e){delete e[he],delete e[Ne],delete e[rn],delete e[ia],delete e[mi]}function Vr(e){var i=e[he];if(i)return i;for(var c=e.parentNode;c;){if(i=c[Ue]||c[he]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(e=Bv(e);e!==null;){if(c=e[he])return c;e=Bv(e)}return i}e=c,c=e.parentNode}return null}function Yr(e){if(e=e[he]||e[Ue]){var i=e.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return e}return null}function Sl(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e.stateNode;throw Error(a(33))}function Cs(e){var i=e[Es];return i||(i=e[Es]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ra(e){e[ki]=!0}var xu=new Set,Mu={};function pr(e,i){ea(e,i),ea(e+"Capture",i)}function ea(e,i){for(Mu[e]=i,e=0;e<i.length;e++)xu.add(i[e])}var Fn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nu={},bl={};function Du(e){return hn.call(bl,e)?!0:hn.call(Nu,e)?!1:Fn.test(e)?bl[e]=!0:(Nu[e]=!0,!1)}function _l(e,i,c){if(Du(i))if(c===null)e.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":e.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){e.removeAttribute(i);return}}e.setAttribute(i,""+c)}}function vi(e,i,c){if(c===null)e.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttribute(i,""+c)}}function yi(e,i,c,d){if(d===null)e.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(c);return}e.setAttributeNS(i,c,""+d)}}function qa(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ju(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function bd(e,i,c){var d=Object.getOwnPropertyDescriptor(e.constructor.prototype,i);if(!e.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var b=d.get,A=d.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return b.call(this)},set:function(q){c=""+q,A.call(this,q)}}),Object.defineProperty(e,i,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(q){c=""+q},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Uu(e){if(!e._valueTracker){var i=ju(e)?"checked":"value";e._valueTracker=bd(e,i,""+e[i])}}function Cf(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var c=i.getValue(),d="";return e&&(d=ju(e)?e.checked?"true":"false":e.value),e=d,e!==c?(i.setValue(e),!0):!1}function bo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var _d=/[\n"\\]/g;function ni(e){return e.replace(_d,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function _o(e,i,c,d,b,A,q,tt){e.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?e.type=q:e.removeAttribute("type"),i!=null?q==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+qa(i)):e.value!==""+qa(i)&&(e.value=""+qa(i)):q!=="submit"&&q!=="reset"||e.removeAttribute("value"),i!=null?Af(e,q,qa(i)):c!=null?Af(e,q,qa(c)):d!=null&&e.removeAttribute("value"),b==null&&A!=null&&(e.defaultChecked=!!A),b!=null&&(e.checked=b&&typeof b!="function"&&typeof b!="symbol"),tt!=null&&typeof tt!="function"&&typeof tt!="symbol"&&typeof tt!="boolean"?e.name=""+qa(tt):e.removeAttribute("name")}function Tf(e,i,c,d,b,A,q,tt){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(e.type=A),i!=null||c!=null){if(!(A!=="submit"&&A!=="reset"||i!=null)){Uu(e);return}c=c!=null?""+qa(c):"",i=i!=null?""+qa(i):c,tt||i===e.value||(e.value=i),e.defaultValue=i}d=d??b,d=typeof d!="function"&&typeof d!="symbol"&&!!d,e.checked=tt?e.checked:!!d,e.defaultChecked=!!d,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(e.name=q),Uu(e)}function Af(e,i,c){i==="number"&&bo(e.ownerDocument)===e||e.defaultValue===""+c||(e.defaultValue=""+c)}function Ts(e,i,c,d){if(e=e.options,i){i={};for(var b=0;b<c.length;b++)i["$"+c[b]]=!0;for(c=0;c<e.length;c++)b=i.hasOwnProperty("$"+e[c].value),e[c].selected!==b&&(e[c].selected=b),b&&d&&(e[c].defaultSelected=!0)}else{for(c=""+qa(c),i=null,b=0;b<e.length;b++){if(e[b].value===c){e[b].selected=!0,d&&(e[b].defaultSelected=!0);return}i!==null||e[b].disabled||(i=e[b])}i!==null&&(i.selected=!0)}}function wf(e,i,c){if(i!=null&&(i=""+qa(i),i!==e.value&&(e.value=i),c==null)){e.defaultValue!==i&&(e.defaultValue=i);return}e.defaultValue=c!=null?""+qa(c):""}function Rf(e,i,c,d){if(i==null){if(d!=null){if(c!=null)throw Error(a(92));if(Y(d)){if(1<d.length)throw Error(a(93));d=d[0]}c=d}c==null&&(c=""),i=c}c=qa(i),e.defaultValue=c,d=e.textContent,d===c&&d!==""&&d!==null&&(e.value=d),Uu(e)}function Kr(e,i){if(i){var c=e.firstChild;if(c&&c===e.lastChild&&c.nodeType===3){c.nodeValue=i;return}}e.textContent=i}var Ed=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Of(e,i,c){var d=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="":d?e.setProperty(i,c):typeof c!="number"||c===0||Ed.has(i)?i==="float"?e.cssFloat=c:e[i]=(""+c).trim():e[i]=c+"px"}function xf(e,i,c){if(i!=null&&typeof i!="object")throw Error(a(62));if(e=e.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?e.setProperty(d,""):d==="float"?e.cssFloat="":e[d]="");for(var b in i)d=i[b],i.hasOwnProperty(b)&&c[b]!==d&&Of(e,b,d)}else for(var A in i)i.hasOwnProperty(A)&&Of(e,A,i[A])}function Bu(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ug=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Eo(e){return Ug.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Va(){}var El=null;function zu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var mr=null,qi=null;function Mf(e){var i=Yr(e);if(i&&(e=i.stateNode)){var c=e[Ne]||null;t:switch(e=i.stateNode,i.type){case"input":if(_o(e,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=e;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ni(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var d=c[i];if(d!==e&&d.form===e.form){var b=d[Ne]||null;if(!b)throw Error(a(90));_o(d,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(i=0;i<c.length;i++)d=c[i],d.form===e.form&&Cf(d)}break t;case"textarea":wf(e,c.value,c.defaultValue);break t;case"select":i=c.value,i!=null&&Ts(e,!!c.multiple,i,!1)}}}var Lu=!1;function Nf(e,i,c){if(Lu)return e(i,c);Lu=!0;try{var d=e(i);return d}finally{if(Lu=!1,(mr!==null||qi!==null)&&(Fl(),mr&&(i=mr,e=qi,qi=mr=null,Mf(i),e)))for(i=0;i<e.length;i++)Mf(e[i])}}function Cl(e,i){var c=e.stateNode;if(c===null)return null;var d=c[Ne]||null;if(d===null)return null;c=d[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(e=e.type,d=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!d;break t;default:e=!1}if(e)return null;if(c&&typeof c!="function")throw Error(a(231,i,typeof c));return c}var Vi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gu=!1;if(Vi)try{var As={};Object.defineProperty(As,"passive",{get:function(){Gu=!0}}),window.addEventListener("test",As,As),window.removeEventListener("test",As,As)}catch{Gu=!1}var vr=null,Pu=null,Tl=null;function Df(){if(Tl)return Tl;var e,i=Pu,c=i.length,d,b="value"in vr?vr.value:vr.textContent,A=b.length;for(e=0;e<c&&i[e]===b[e];e++);var q=c-e;for(d=1;d<=q&&i[c-d]===b[A-d];d++);return Tl=b.slice(e,1<d?1-d:void 0)}function Co(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function To(){return!0}function Hu(){return!1}function Da(e){function i(c,d,b,A,q){this._reactName=c,this._targetInst=b,this.type=d,this.nativeEvent=A,this.target=q,this.currentTarget=null;for(var tt in e)e.hasOwnProperty(tt)&&(c=e[tt],this[tt]=c?c(A):A[tt]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?To:Hu,this.isPropagationStopped=Hu,this}return C(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=To)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=To)},persist:function(){},isPersistent:To}),i}var Qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Iu=Da(Qr),Ao=C({},Qr,{view:0,detail:0}),Td=Da(Ao),ws,wo,Xr,Ro=C({},Ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Al,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xr&&(Xr&&e.type==="mousemove"?(ws=e.screenX-Xr.screenX,wo=e.screenY-Xr.screenY):wo=ws=0,Xr=e),ws)},movementY:function(e){return"movementY"in e?e.movementY:wo}}),jf=Da(Ro),ku=C({},Ro,{dataTransfer:0}),Oo=Da(ku),qu=C({},Ao,{relatedTarget:0}),Vu=Da(qu),Ad=C({},Qr,{animationName:0,elapsedTime:0,pseudoElement:0}),Fr=Da(Ad),wd=C({},Qr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jr=Da(wd),yr=C({},Qr,{data:0}),xo=Da(yr),Uf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rs(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od[e])?!!i[e]:!1}function Al(){return Rs}var xd=C({},Ao,{key:function(e){if(e.key){var i=Uf[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=Co(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Rd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Al,charCode:function(e){return e.type==="keypress"?Co(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Co(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Bf=Da(xd),Md=C({},Ro,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zf=Da(Md),Bg=C({},Ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Al}),ha=Da(Bg),Nd=C({},Qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dd=Da(Nd),jd=C({},Ro,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ud=Da(jd),Bd=C({},Qr,{newState:0,oldState:0}),Yu=Da(Bd),Lf=[9,13,27,32],Ku=Vi&&"CompositionEvent"in window,wl=null;Vi&&"documentMode"in document&&(wl=document.documentMode);var zd=Vi&&"TextEvent"in window&&!wl,Qu=Vi&&(!Ku||wl&&8<wl&&11>=wl),Xu=" ",Gf=!1;function Fu(e,i){switch(e){case"keyup":return Lf.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mo(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zr=!1;function Ld(e,i){switch(e){case"compositionend":return Mo(i);case"keypress":return i.which!==32?null:(Gf=!0,Xu);case"textInput":return e=i.data,e===Xu&&Gf?null:e;default:return null}}function Pf(e,i){if(Zr)return e==="compositionend"||!Ku&&Fu(e,i)?(e=Df(),Tl=Pu=vr=null,Zr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Qu&&i.locale!=="ko"?null:i.data;default:return null}}var Gd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yi(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!Gd[e.type]:i==="textarea"}function Ju(e,i,c,d){mr?qi?qi.push(d):qi=[d]:mr=d,i=x0(i,"onChange"),0<i.length&&(c=new Iu("onChange","change",null,c,d),e.push({event:c,listeners:i}))}var No=null,Rl=null;function ai(e){_v(e,0)}function Do(e){var i=Sl(e);if(Cf(i))return e}function Zu(e,i){if(e==="change")return i}var Hf=!1;if(Vi){var Wu;if(Vi){var jo="oninput"in document;if(!jo){var $u=document.createElement("div");$u.setAttribute("oninput","return;"),jo=typeof $u.oninput=="function"}Wu=jo}else Wu=!1;Hf=Wu&&(!document.documentMode||9<document.documentMode)}function If(){No&&(No.detachEvent("onpropertychange",Uo),Rl=No=null)}function Uo(e){if(e.propertyName==="value"&&Do(Rl)){var i=[];Ju(i,Rl,e,zu(e)),Nf(ai,i)}}function Bo(e,i,c){e==="focusin"?(If(),No=i,Rl=c,No.attachEvent("onpropertychange",Uo)):e==="focusout"&&If()}function zn(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Do(Rl)}function zg(e,i){if(e==="click")return Do(i)}function Lg(e,i){if(e==="input"||e==="change")return Do(i)}function Pd(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var da=typeof Object.is=="function"?Object.is:Pd;function Si(e,i){if(da(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var c=Object.keys(e),d=Object.keys(i);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var b=c[d];if(!hn.call(i,b)||!da(e[b],i[b]))return!1}return!0}function kf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qf(e,i){var c=kf(e);e=0;for(var d;c;){if(c.nodeType===3){if(d=e+c.textContent.length,e<=i&&d>=i)return{node:c,offset:i-e};e=d}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=kf(c)}}function Ol(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Ol(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function wi(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var i=bo(e.document);i instanceof e.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)e=i.contentWindow;else break;i=bo(e.document)}return i}function tc(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}var Vf=Vi&&"documentMode"in document&&11>=document.documentMode,Os=null,zo=null,xs=null,xl=!1;function Yf(e,i,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;xl||Os==null||Os!==bo(d)||(d=Os,"selectionStart"in d&&tc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),xs&&Si(xs,d)||(xs=d,d=x0(zo,"onSelect"),0<d.length&&(i=new Iu("onSelect","select",null,i,c),e.push({event:i,listeners:d}),i.target=Os)))}function Wr(e,i){var c={};return c[e.toLowerCase()]=i.toLowerCase(),c["Webkit"+e]="webkit"+i,c["Moz"+e]="moz"+i,c}var Ml={animationend:Wr("Animation","AnimationEnd"),animationiteration:Wr("Animation","AnimationIteration"),animationstart:Wr("Animation","AnimationStart"),transitionrun:Wr("Transition","TransitionRun"),transitionstart:Wr("Transition","TransitionStart"),transitioncancel:Wr("Transition","TransitionCancel"),transitionend:Wr("Transition","TransitionEnd")},ec={},Kf={};Vi&&(Kf=document.createElement("div").style,"AnimationEvent"in window||(delete Ml.animationend.animation,delete Ml.animationiteration.animation,delete Ml.animationstart.animation),"TransitionEvent"in window||delete Ml.transitionend.transition);function ga(e){if(ec[e])return ec[e];if(!Ml[e])return e;var i=Ml[e],c;for(c in i)if(i.hasOwnProperty(c)&&c in Kf)return ec[e]=i[c];return e}var nc=ga("animationend"),Qf=ga("animationiteration"),Hd=ga("animationstart"),Xf=ga("transitionrun"),ja=ga("transitionstart"),Id=ga("transitioncancel"),Ua=ga("transitionend"),Ff=new Map,Ki="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ki.push("scrollEnd");function pa(e,i){Ff.set(e,i),pr(i,[e])}var Ri=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ya=[],$r=0,bi=0;function Lo(){for(var e=$r,i=bi=$r=0;i<e;){var c=Ya[i];Ya[i++]=null;var d=Ya[i];Ya[i++]=null;var b=Ya[i];Ya[i++]=null;var A=Ya[i];if(Ya[i++]=null,d!==null&&b!==null){var q=d.pending;q===null?b.next=b:(b.next=q.next,q.next=b),d.pending=b}A!==0&&Jf(c,b,A)}}function Sr(e,i,c,d){Ya[$r++]=e,Ya[$r++]=i,Ya[$r++]=c,Ya[$r++]=d,bi|=d,e.lanes|=d,e=e.alternate,e!==null&&(e.lanes|=d)}function Ms(e,i,c,d){return Sr(e,i,c,d),Go(e)}function ii(e,i){return Sr(e,null,null,i),Go(e)}function Jf(e,i,c){e.lanes|=c;var d=e.alternate;d!==null&&(d.lanes|=c);for(var b=!1,A=e.return;A!==null;)A.childLanes|=c,d=A.alternate,d!==null&&(d.childLanes|=c),A.tag===22&&(e=A.stateNode,e===null||e._visibility&1||(b=!0)),e=A,A=A.return;return e.tag===3?(A=e.stateNode,b&&i!==null&&(b=31-Jt(c),e=A.hiddenUpdates,d=e[b],d===null?e[b]=[i]:d.push(i),i.lane=c|536870912),A):null}function Go(e){if(50<ul)throw ul=0,cl=null,Error(a(185));for(var i=e.return;i!==null;)e=i,i=e.return;return e.tag===3?e.stateNode:null}var Qi={};function kd(e,i,c,d){this.tag=e,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wa(e,i,c,d){return new kd(e,i,c,d)}function ac(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Oi(e,i){var c=e.alternate;return c===null?(c=wa(e.tag,i,e.key,e.mode),c.elementType=e.elementType,c.type=e.type,c.stateNode=e.stateNode,c.alternate=e,e.alternate=c):(c.pendingProps=i,c.type=e.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=e.flags&65011712,c.childLanes=e.childLanes,c.lanes=e.lanes,c.child=e.child,c.memoizedProps=e.memoizedProps,c.memoizedState=e.memoizedState,c.updateQueue=e.updateQueue,i=e.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=e.sibling,c.index=e.index,c.ref=e.ref,c.refCleanup=e.refCleanup,c}function ic(e,i){e.flags&=65011714;var c=e.alternate;return c===null?(e.childLanes=0,e.lanes=i,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=c.childLanes,e.lanes=c.lanes,e.child=c.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=c.memoizedProps,e.memoizedState=c.memoizedState,e.updateQueue=c.updateQueue,e.type=c.type,i=c.dependencies,e.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),e}function Nl(e,i,c,d,b,A){var q=0;if(d=e,typeof e=="function")ac(e)&&(q=1);else if(typeof e=="string")q=t4(e,c,V.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case z:return e=wa(31,c,i,b),e.elementType=z,e.lanes=A,e;case D:return ts(c.children,b,A,i);case B:q=8,b|=24;break;case L:return e=wa(12,c,i,b|2),e.elementType=L,e.lanes=A,e;case O:return e=wa(13,c,i,b),e.elementType=O,e.lanes=A,e;case w:return e=wa(19,c,i,b),e.elementType=w,e.lanes=A,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:q=10;break t;case N:q=9;break t;case G:q=11;break t;case T:q=14;break t;case y:q=16,d=null;break t}q=29,c=Error(a(130,e===null?"null":typeof e,"")),d=null}return i=wa(q,c,i,b),i.elementType=e,i.type=d,i.lanes=A,i}function ts(e,i,c,d){return e=wa(7,e,d,i),e.lanes=c,e}function Po(e,i,c){return e=wa(6,e,null,i),e.lanes=c,e}function Ka(e){var i=wa(18,null,null,0);return i.stateNode=e,i}function rc(e,i,c){return i=wa(4,e.children!==null?e.children:[],e.key,i),i.lanes=c,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}var Qa=new WeakMap;function ri(e,i){if(typeof e=="object"&&e!==null){var c=Qa.get(e);return c!==void 0?c:(i={value:e,source:i,stack:ke(i)},Qa.set(e,i),i)}return{value:e,source:i,stack:ke(i)}}var Ns=[],Dl=0,xi=null,jl=0,Xa=[],ma=0,br=null,Mi=1,Ni="";function Xi(e,i){Ns[Dl++]=jl,Ns[Dl++]=xi,xi=e,jl=i}function sc(e,i,c){Xa[ma++]=Mi,Xa[ma++]=Ni,Xa[ma++]=br,br=e;var d=Mi;e=Ni;var b=32-Jt(d)-1;d&=~(1<<b),c+=1;var A=32-Jt(i)+b;if(30<A){var q=b-b%5;A=(d&(1<<q)-1).toString(32),d>>=q,b-=q,Mi=1<<32-Jt(i)+b|c<<b|d,Ni=A+e}else Mi=1<<A|c<<b|d,Ni=e}function Ho(e){e.return!==null&&(Xi(e,1),sc(e,1,0))}function Zf(e){for(;e===xi;)xi=Ns[--Dl],Ns[Dl]=null,jl=Ns[--Dl],Ns[Dl]=null;for(;e===br;)br=Xa[--ma],Xa[ma]=null,Ni=Xa[--ma],Xa[ma]=null,Mi=Xa[--ma],Xa[ma]=null}function qd(e,i){Xa[ma++]=Mi,Xa[ma++]=Ni,Xa[ma++]=br,Mi=i.id,Ni=i.overflow,br=e}var va=null,mn=null,qe=!1,si=null,Ba=!1,lc=Error(a(519));function _r(e){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ul(ri(i,e)),lc}function Wf(e){var i=e.stateNode,c=e.type,d=e.memoizedProps;switch(i[he]=e,i[Ne]=d,c){case"dialog":Ke("cancel",i),Ke("close",i);break;case"iframe":case"object":case"embed":Ke("load",i);break;case"video":case"audio":for(c=0;c<Lh.length;c++)Ke(Lh[c],i);break;case"source":Ke("error",i);break;case"img":case"image":case"link":Ke("error",i),Ke("load",i);break;case"details":Ke("toggle",i);break;case"input":Ke("invalid",i),Tf(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Ke("invalid",i);break;case"textarea":Ke("invalid",i),Rf(i,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||d.suppressHydrationWarning===!0||Av(i.textContent,c)?(d.popover!=null&&(Ke("beforetoggle",i),Ke("toggle",i)),d.onScroll!=null&&Ke("scroll",i),d.onScrollEnd!=null&&Ke("scrollend",i),d.onClick!=null&&(i.onclick=Va),i=!0):i=!1,i||_r(e,!0)}function $f(e){for(va=e.return;va;)switch(va.tag){case 5:case 31:case 13:Ba=!1;return;case 27:case 3:Ba=!0;return;default:va=va.return}}function Ds(e){if(e!==va)return!1;if(!qe)return $f(e),qe=!0,!1;var i=e.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=e.type,c=!(c!=="form"&&c!=="button")||ep(e.type,e.memoizedProps)),c=!c),c&&mn&&_r(e),$f(e),i===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));mn=Uv(e)}else if(i===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));mn=Uv(e)}else i===27?(i=mn,Wl(e.type)?(e=sp,sp=null,mn=e):mn=i):mn=va?hr(e.stateNode.nextSibling):null;return!0}function es(){mn=va=null,qe=!1}function js(){var e=si;return e!==null&&(Sn===null?Sn=e:Sn.push.apply(Sn,e),si=null),e}function Ul(e){si===null?si=[e]:si.push(e)}var oc=Z(null),Ye=null,Di=null;function ns(e,i,c){rt(oc,i._currentValue),i._currentValue=c}function Fi(e){e._currentValue=oc.current,it(oc)}function th(e,i,c){for(;e!==null;){var d=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),e===c)break;e=e.return}}function eh(e,i,c,d){var b=e.child;for(b!==null&&(b.return=e);b!==null;){var A=b.dependencies;if(A!==null){var q=b.child;A=A.firstContext;t:for(;A!==null;){var tt=A;A=b;for(var ot=0;ot<i.length;ot++)if(tt.context===i[ot]){A.lanes|=c,tt=A.alternate,tt!==null&&(tt.lanes|=c),th(A.return,c,e),d||(q=null);break t}A=tt.next}}else if(b.tag===18){if(q=b.return,q===null)throw Error(a(341));q.lanes|=c,A=q.alternate,A!==null&&(A.lanes|=c),th(q,c,e),q=null}else q=b.child;if(q!==null)q.return=b;else for(q=b;q!==null;){if(q===e){q=null;break}if(b=q.sibling,b!==null){b.return=q.return,q=b;break}q=q.return}b=q}}function Bl(e,i,c,d){e=null;for(var b=i,A=!1;b!==null;){if(!A){if((b.flags&524288)!==0)A=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var q=b.alternate;if(q===null)throw Error(a(387));if(q=q.memoizedProps,q!==null){var tt=b.type;da(b.pendingProps.value,q.value)||(e!==null?e.push(tt):e=[tt])}}else if(b===at.current){if(q=b.alternate,q===null)throw Error(a(387));q.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(e!==null?e.push(kh):e=[kh])}b=b.return}e!==null&&eh(i,e,c,d),i.flags|=262144}function uc(e){for(e=e.firstContext;e!==null;){if(!da(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Er(e){Ye=e,Di=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Cn(e){return ko(Ye,e)}function Io(e,i){return Ye===null&&Er(e),ko(e,i)}function ko(e,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},Di===null){if(e===null)throw Error(a(308));Di=i,e.dependencies={lanes:0,firstContext:i},e.flags|=524288}else Di=Di.next=i;return c}var Us=typeof AbortController<"u"?AbortController:function(){var e=[],i=this.signal={aborted:!1,addEventListener:function(c,d){e.push(d)}};this.abort=function(){i.aborted=!0,e.forEach(function(c){return c()})}},nh=l.unstable_scheduleCallback,ah=l.unstable_NormalPriority,Jn={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function cc(){return{controller:new Us,data:new Map,refCount:0}}function zl(e){e.refCount--,e.refCount===0&&nh(ah,function(){e.controller.abort()})}var Ll=null,fc=0,Bs=0,as=null;function Ie(e,i){if(Ll===null){var c=Ll=[];fc=0,Bs=Kg(),as={status:"pending",value:void 0,then:function(d){c.push(d)}}}return fc++,i.then(Vd,Vd),i}function Vd(){if(--fc===0&&Ll!==null){as!==null&&(as.status="fulfilled");var e=Ll;Ll=null,Bs=0,as=null;for(var i=0;i<e.length;i++)(0,e[i])()}}function li(e,i){var c=[],d={status:"pending",value:null,reason:null,then:function(b){c.push(b)}};return e.then(function(){d.status="fulfilled",d.value=i;for(var b=0;b<c.length;b++)(0,c[b])(i)},function(b){for(d.status="rejected",d.reason=b,b=0;b<c.length;b++)(0,c[b])(void 0)}),d}var hc=j.S;j.S=function(e,i){Pc=Se(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&Ie(e,i),hc!==null&&hc(e,i)};var zs=Z(null);function Gl(){var e=zs.current;return e!==null?e:Be.pooledCache}function Cr(e,i){i===null?rt(zs,zs.current):rt(zs,i.pool)}function Ls(){var e=Gl();return e===null?null:{parent:Jn._currentValue,pool:e}}var Gs=Error(a(460)),qo=Error(a(474)),dc=Error(a(542)),Vo={then:function(){}};function Tr(e){return e=e.status,e==="fulfilled"||e==="rejected"}function gc(e,i,c){switch(c=e[c],c===void 0?e.push(i):c!==i&&(i.then(Va,Va),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,Rr(e),e;default:if(typeof i.status=="string")i.then(Va,Va);else{if(e=Be,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=i,e.status="pending",e.then(function(d){if(i.status==="pending"){var b=i;b.status="fulfilled",b.value=d}},function(d){if(i.status==="pending"){var b=i;b.status="rejected",b.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,Rr(e),e}throw wr=i,Gs}}function Ar(e){try{var i=e._init;return i(e._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(wr=c,Gs):c}}var wr=null;function pc(){if(wr===null)throw Error(a(459));var e=wr;return wr=null,e}function Rr(e){if(e===Gs||e===dc)throw Error(a(483))}var is=null,Yo=0;function Ko(e){var i=Yo;return Yo+=1,is===null&&(is=[]),gc(is,e,i)}function Qo(e,i){i=i.props.ref,e.ref=i!==void 0?i:null}function Ps(e,i){throw i.$$typeof===E?Error(a(525)):(e=Object.prototype.toString.call(i),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)))}function ue(e){function i(pt,ft){if(e){var yt=pt.deletions;yt===null?(pt.deletions=[ft],pt.flags|=16):yt.push(ft)}}function c(pt,ft){if(!e)return null;for(;ft!==null;)i(pt,ft),ft=ft.sibling;return null}function d(pt){for(var ft=new Map;pt!==null;)pt.key!==null?ft.set(pt.key,pt):ft.set(pt.index,pt),pt=pt.sibling;return ft}function b(pt,ft){return pt=Oi(pt,ft),pt.index=0,pt.sibling=null,pt}function A(pt,ft,yt){return pt.index=yt,e?(yt=pt.alternate,yt!==null?(yt=yt.index,yt<ft?(pt.flags|=67108866,ft):yt):(pt.flags|=67108866,ft)):(pt.flags|=1048576,ft)}function q(pt){return e&&pt.alternate===null&&(pt.flags|=67108866),pt}function tt(pt,ft,yt,Mt){return ft===null||ft.tag!==6?(ft=Po(yt,pt.mode,Mt),ft.return=pt,ft):(ft=b(ft,yt),ft.return=pt,ft)}function ot(pt,ft,yt,Mt){var oe=yt.type;return oe===D?Ot(pt,ft,yt.props.children,Mt,yt.key):ft!==null&&(ft.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===y&&Ar(oe)===ft.type)?(ft=b(ft,yt.props),Qo(ft,yt),ft.return=pt,ft):(ft=Nl(yt.type,yt.key,yt.props,null,pt.mode,Mt),Qo(ft,yt),ft.return=pt,ft)}function St(pt,ft,yt,Mt){return ft===null||ft.tag!==4||ft.stateNode.containerInfo!==yt.containerInfo||ft.stateNode.implementation!==yt.implementation?(ft=rc(yt,pt.mode,Mt),ft.return=pt,ft):(ft=b(ft,yt.children||[]),ft.return=pt,ft)}function Ot(pt,ft,yt,Mt,oe){return ft===null||ft.tag!==7?(ft=ts(yt,pt.mode,Mt,oe),ft.return=pt,ft):(ft=b(ft,yt),ft.return=pt,ft)}function Nt(pt,ft,yt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return ft=Po(""+ft,pt.mode,yt),ft.return=pt,ft;if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case R:return yt=Nl(ft.type,ft.key,ft.props,null,pt.mode,yt),Qo(yt,ft),yt.return=pt,yt;case v:return ft=rc(ft,pt.mode,yt),ft.return=pt,ft;case y:return ft=Ar(ft),Nt(pt,ft,yt)}if(Y(ft)||K(ft))return ft=ts(ft,pt.mode,yt,null),ft.return=pt,ft;if(typeof ft.then=="function")return Nt(pt,Ko(ft),yt);if(ft.$$typeof===M)return Nt(pt,Io(pt,ft),yt);Ps(pt,ft)}return null}function Et(pt,ft,yt,Mt){var oe=ft!==null?ft.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return oe!==null?null:tt(pt,ft,""+yt,Mt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case R:return yt.key===oe?ot(pt,ft,yt,Mt):null;case v:return yt.key===oe?St(pt,ft,yt,Mt):null;case y:return yt=Ar(yt),Et(pt,ft,yt,Mt)}if(Y(yt)||K(yt))return oe!==null?null:Ot(pt,ft,yt,Mt,null);if(typeof yt.then=="function")return Et(pt,ft,Ko(yt),Mt);if(yt.$$typeof===M)return Et(pt,ft,Io(pt,yt),Mt);Ps(pt,yt)}return null}function Tt(pt,ft,yt,Mt,oe){if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint")return pt=pt.get(yt)||null,tt(ft,pt,""+Mt,oe);if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case R:return pt=pt.get(Mt.key===null?yt:Mt.key)||null,ot(ft,pt,Mt,oe);case v:return pt=pt.get(Mt.key===null?yt:Mt.key)||null,St(ft,pt,Mt,oe);case y:return Mt=Ar(Mt),Tt(pt,ft,yt,Mt,oe)}if(Y(Mt)||K(Mt))return pt=pt.get(yt)||null,Ot(ft,pt,Mt,oe,null);if(typeof Mt.then=="function")return Tt(pt,ft,yt,Ko(Mt),oe);if(Mt.$$typeof===M)return Tt(pt,ft,yt,Io(ft,Mt),oe);Ps(ft,Mt)}return null}function ne(pt,ft,yt,Mt){for(var oe=null,ln=null,ie=ft,Ge=ft=0,Qe=null;ie!==null&&Ge<yt.length;Ge++){ie.index>Ge?(Qe=ie,ie=null):Qe=ie.sibling;var on=Et(pt,ie,yt[Ge],Mt);if(on===null){ie===null&&(ie=Qe);break}e&&ie&&on.alternate===null&&i(pt,ie),ft=A(on,ft,Ge),ln===null?oe=on:ln.sibling=on,ln=on,ie=Qe}if(Ge===yt.length)return c(pt,ie),qe&&Xi(pt,Ge),oe;if(ie===null){for(;Ge<yt.length;Ge++)ie=Nt(pt,yt[Ge],Mt),ie!==null&&(ft=A(ie,ft,Ge),ln===null?oe=ie:ln.sibling=ie,ln=ie);return qe&&Xi(pt,Ge),oe}for(ie=d(ie);Ge<yt.length;Ge++)Qe=Tt(ie,pt,Ge,yt[Ge],Mt),Qe!==null&&(e&&Qe.alternate!==null&&ie.delete(Qe.key===null?Ge:Qe.key),ft=A(Qe,ft,Ge),ln===null?oe=Qe:ln.sibling=Qe,ln=Qe);return e&&ie.forEach(function(ao){return i(pt,ao)}),qe&&Xi(pt,Ge),oe}function ve(pt,ft,yt,Mt){if(yt==null)throw Error(a(151));for(var oe=null,ln=null,ie=ft,Ge=ft=0,Qe=null,on=yt.next();ie!==null&&!on.done;Ge++,on=yt.next()){ie.index>Ge?(Qe=ie,ie=null):Qe=ie.sibling;var ao=Et(pt,ie,on.value,Mt);if(ao===null){ie===null&&(ie=Qe);break}e&&ie&&ao.alternate===null&&i(pt,ie),ft=A(ao,ft,Ge),ln===null?oe=ao:ln.sibling=ao,ln=ao,ie=Qe}if(on.done)return c(pt,ie),qe&&Xi(pt,Ge),oe;if(ie===null){for(;!on.done;Ge++,on=yt.next())on=Nt(pt,on.value,Mt),on!==null&&(ft=A(on,ft,Ge),ln===null?oe=on:ln.sibling=on,ln=on);return qe&&Xi(pt,Ge),oe}for(ie=d(ie);!on.done;Ge++,on=yt.next())on=Tt(ie,pt,Ge,on.value,Mt),on!==null&&(e&&on.alternate!==null&&ie.delete(on.key===null?Ge:on.key),ft=A(on,ft,Ge),ln===null?oe=on:ln.sibling=on,ln=on);return e&&ie.forEach(function(f4){return i(pt,f4)}),qe&&Xi(pt,Ge),oe}function _n(pt,ft,yt,Mt){if(typeof yt=="object"&&yt!==null&&yt.type===D&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case R:t:{for(var oe=yt.key;ft!==null;){if(ft.key===oe){if(oe=yt.type,oe===D){if(ft.tag===7){c(pt,ft.sibling),Mt=b(ft,yt.props.children),Mt.return=pt,pt=Mt;break t}}else if(ft.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===y&&Ar(oe)===ft.type){c(pt,ft.sibling),Mt=b(ft,yt.props),Qo(Mt,yt),Mt.return=pt,pt=Mt;break t}c(pt,ft);break}else i(pt,ft);ft=ft.sibling}yt.type===D?(Mt=ts(yt.props.children,pt.mode,Mt,yt.key),Mt.return=pt,pt=Mt):(Mt=Nl(yt.type,yt.key,yt.props,null,pt.mode,Mt),Qo(Mt,yt),Mt.return=pt,pt=Mt)}return q(pt);case v:t:{for(oe=yt.key;ft!==null;){if(ft.key===oe)if(ft.tag===4&&ft.stateNode.containerInfo===yt.containerInfo&&ft.stateNode.implementation===yt.implementation){c(pt,ft.sibling),Mt=b(ft,yt.children||[]),Mt.return=pt,pt=Mt;break t}else{c(pt,ft);break}else i(pt,ft);ft=ft.sibling}Mt=rc(yt,pt.mode,Mt),Mt.return=pt,pt=Mt}return q(pt);case y:return yt=Ar(yt),_n(pt,ft,yt,Mt)}if(Y(yt))return ne(pt,ft,yt,Mt);if(K(yt)){if(oe=K(yt),typeof oe!="function")throw Error(a(150));return yt=oe.call(yt),ve(pt,ft,yt,Mt)}if(typeof yt.then=="function")return _n(pt,ft,Ko(yt),Mt);if(yt.$$typeof===M)return _n(pt,ft,Io(pt,yt),Mt);Ps(pt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint"?(yt=""+yt,ft!==null&&ft.tag===6?(c(pt,ft.sibling),Mt=b(ft,yt),Mt.return=pt,pt=Mt):(c(pt,ft),Mt=Po(yt,pt.mode,Mt),Mt.return=pt,pt=Mt),q(pt)):c(pt,ft)}return function(pt,ft,yt,Mt){try{Yo=0;var oe=_n(pt,ft,yt,Mt);return is=null,oe}catch(ie){if(ie===Gs||ie===dc)throw ie;var ln=wa(29,ie,null,pt.mode);return ln.lanes=Mt,ln.return=pt,ln}finally{}}}var Hs=ue(!0),Yd=ue(!1),Or=!1;function Is(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ih(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function rs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ss(e,i,c){var d=e.updateQueue;if(d===null)return null;if(d=d.shared,(de&2)!==0){var b=d.pending;return b===null?i.next=i:(i.next=b.next,b.next=i),d.pending=i,i=Go(e),Jf(e,null,c),i}return Sr(e,d,i,c),Go(e)}function Xo(e,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var d=i.lanes;d&=e.pendingLanes,c|=d,i.lanes=c,Ft(e,c)}}function rh(e,i){var c=e.updateQueue,d=e.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var b=null,A=null;if(c=c.firstBaseUpdate,c!==null){do{var q={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};A===null?b=A=q:A=A.next=q,c=c.next}while(c!==null);A===null?b=A=i:A=A.next=i}else b=A=i;c={baseState:d.baseState,firstBaseUpdate:b,lastBaseUpdate:A,shared:d.shared,callbacks:d.callbacks},e.updateQueue=c;return}e=c.lastBaseUpdate,e===null?c.firstBaseUpdate=i:e.next=i,c.lastBaseUpdate=i}var Fo=!1;function Pl(){if(Fo){var e=as;if(e!==null)throw e}}function ls(e,i,c,d){Fo=!1;var b=e.updateQueue;Or=!1;var A=b.firstBaseUpdate,q=b.lastBaseUpdate,tt=b.shared.pending;if(tt!==null){b.shared.pending=null;var ot=tt,St=ot.next;ot.next=null,q===null?A=St:q.next=St,q=ot;var Ot=e.alternate;Ot!==null&&(Ot=Ot.updateQueue,tt=Ot.lastBaseUpdate,tt!==q&&(tt===null?Ot.firstBaseUpdate=St:tt.next=St,Ot.lastBaseUpdate=ot))}if(A!==null){var Nt=b.baseState;q=0,Ot=St=ot=null,tt=A;do{var Et=tt.lane&-536870913,Tt=Et!==tt.lane;if(Tt?(De&Et)===Et:(d&Et)===Et){Et!==0&&Et===Bs&&(Fo=!0),Ot!==null&&(Ot=Ot.next={lane:0,tag:tt.tag,payload:tt.payload,callback:null,next:null});t:{var ne=e,ve=tt;Et=i;var _n=c;switch(ve.tag){case 1:if(ne=ve.payload,typeof ne=="function"){Nt=ne.call(_n,Nt,Et);break t}Nt=ne;break t;case 3:ne.flags=ne.flags&-65537|128;case 0:if(ne=ve.payload,Et=typeof ne=="function"?ne.call(_n,Nt,Et):ne,Et==null)break t;Nt=C({},Nt,Et);break t;case 2:Or=!0}}Et=tt.callback,Et!==null&&(e.flags|=64,Tt&&(e.flags|=8192),Tt=b.callbacks,Tt===null?b.callbacks=[Et]:Tt.push(Et))}else Tt={lane:Et,tag:tt.tag,payload:tt.payload,callback:tt.callback,next:null},Ot===null?(St=Ot=Tt,ot=Nt):Ot=Ot.next=Tt,q|=Et;if(tt=tt.next,tt===null){if(tt=b.shared.pending,tt===null)break;Tt=tt,tt=Tt.next,Tt.next=null,b.lastBaseUpdate=Tt,b.shared.pending=null}}while(!0);Ot===null&&(ot=Nt),b.baseState=ot,b.firstBaseUpdate=St,b.lastBaseUpdate=Ot,A===null&&(b.shared.lanes=0),ps|=q,e.lanes=q,e.memoizedState=Nt}}function sh(e,i){if(typeof e!="function")throw Error(a(191,e));e.call(i)}function Kd(e,i){var c=e.callbacks;if(c!==null)for(e.callbacks=null,e=0;e<c.length;e++)sh(c[e],i)}var Hl=Z(null),Ji=Z(0);function Zi(e,i){e=Ti,rt(Ji,e),rt(Hl,i),Ti=e|i.baseLanes}function sa(){rt(Ji,Ti),rt(Hl,Hl.current)}function Wi(){Ti=Ji.current,it(Hl),it(Ji)}var xn=Z(null),_i=null;function os(e){var i=e.alternate;rt(In,In.current&1),rt(xn,e),_i===null&&(i===null||Hl.current!==null||i.memoizedState!==null)&&(_i=e)}function Zn(e){rt(In,In.current),rt(xn,e),_i===null&&(_i=e)}function $i(e){e.tag===22?(rt(In,In.current),rt(xn,e),_i===null&&(_i=e)):us()}function us(){rt(In,In.current),rt(xn,xn.current)}function oi(e){it(xn),_i===e&&(_i=null),it(In)}var In=Z(0);function mc(e){for(var i=e;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||ip(c)||rp(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var tr=0,Re=null,un=null,Wn=null,xr=!1,Ei=!1,ks=!1,vc=0,Jo=0,er=null,Gg=0;function Hn(){throw Error(a(321))}function lh(e,i){if(i===null)return!1;for(var c=0;c<i.length&&c<e.length;c++)if(!da(e[c],i[c]))return!1;return!0}function qs(e,i,c,d,b,A){return tr=A,Re=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,j.H=e===null||e.memoizedState===null?Vs:tu,ks=!1,A=c(d,b),ks=!1,Ei&&(A=Xd(i,c,d,b)),Qd(e),A}function Qd(e){j.H=kl;var i=un!==null&&un.next!==null;if(tr=0,Wn=un=Re=null,xr=!1,Jo=0,er=null,i)throw Error(a(300));e===null||$n||(e=e.dependencies,e!==null&&uc(e)&&($n=!0))}function Xd(e,i,c,d){Re=e;var b=0;do{if(Ei&&(er=null),Jo=0,Ei=!1,25<=b)throw Error(a(301));if(b+=1,Wn=un=null,e.updateQueue!=null){var A=e.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}j.H=Ys,A=i(c,d)}while(Ei);return A}function Pg(){var e=j.H,i=e.useState()[0];return i=typeof i.then=="function"?Zo(i):i,e=e.useState()[0],(un!==null?un.memoizedState:null)!==e&&(Re.flags|=1024),i}function oh(){var e=vc!==0;return vc=0,e}function uh(e,i,c){i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~c}function ch(e){if(xr){for(e=e.memoizedState;e!==null;){var i=e.queue;i!==null&&(i.pending=null),e=e.next}xr=!1}tr=0,Wn=un=Re=null,Ei=!1,Jo=vc=0,er=null}function za(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?Re.memoizedState=Wn=e:Wn=Wn.next=e,Wn}function kn(){if(un===null){var e=Re.alternate;e=e!==null?e.memoizedState:null}else e=un.next;var i=Wn===null?Re.memoizedState:Wn.next;if(i!==null)Wn=i,un=e;else{if(e===null)throw Re.alternate===null?Error(a(467)):Error(a(310));un=e,e={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},Wn===null?Re.memoizedState=Wn=e:Wn=Wn.next=e}return Wn}function yc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zo(e){var i=Jo;return Jo+=1,er===null&&(er=[]),e=gc(er,e,i),i=Re,(Wn===null?i.memoizedState:Wn.next)===null&&(i=i.alternate,j.H=i===null||i.memoizedState===null?Vs:tu),e}function Sc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Zo(e);if(e.$$typeof===M)return Cn(e)}throw Error(a(438,String(e)))}function fh(e){var i=null,c=Re.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var d=Re.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(b){return b.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=yc(),Re.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(e),d=0;d<e;d++)c[d]=U;return i.index++,c}function nr(e,i){return typeof i=="function"?i(e):i}function bc(e){var i=kn();return hh(i,un,e)}function hh(e,i,c){var d=e.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=c;var b=e.baseQueue,A=d.pending;if(A!==null){if(b!==null){var q=b.next;b.next=A.next,A.next=q}i.baseQueue=b=A,d.pending=null}if(A=e.baseState,b===null)e.memoizedState=A;else{i=b.next;var tt=q=null,ot=null,St=i,Ot=!1;do{var Nt=St.lane&-536870913;if(Nt!==St.lane?(De&Nt)===Nt:(tr&Nt)===Nt){var Et=St.revertLane;if(Et===0)ot!==null&&(ot=ot.next={lane:0,revertLane:0,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),Nt===Bs&&(Ot=!0);else if((tr&Et)===Et){St=St.next,Et===Bs&&(Ot=!0);continue}else Nt={lane:0,revertLane:St.revertLane,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ot===null?(tt=ot=Nt,q=A):ot=ot.next=Nt,Re.lanes|=Et,ps|=Et;Nt=St.action,ks&&c(A,Nt),A=St.hasEagerState?St.eagerState:c(A,Nt)}else Et={lane:Nt,revertLane:St.revertLane,gesture:St.gesture,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ot===null?(tt=ot=Et,q=A):ot=ot.next=Et,Re.lanes|=Nt,ps|=Nt;St=St.next}while(St!==null&&St!==i);if(ot===null?q=A:ot.next=tt,!da(A,e.memoizedState)&&($n=!0,Ot&&(c=as,c!==null)))throw c;e.memoizedState=A,e.baseState=q,e.baseQueue=ot,d.lastRenderedState=A}return b===null&&(d.lanes=0),[e.memoizedState,d.dispatch]}function dh(e){var i=kn(),c=i.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=e;var d=c.dispatch,b=c.pending,A=i.memoizedState;if(b!==null){c.pending=null;var q=b=b.next;do A=e(A,q.action),q=q.next;while(q!==b);da(A,i.memoizedState)||($n=!0),i.memoizedState=A,i.baseQueue===null&&(i.baseState=A),c.lastRenderedState=A}return[A,d]}function Fd(e,i,c){var d=Re,b=kn(),A=qe;if(A){if(c===void 0)throw Error(a(407));c=c()}else c=i();var q=!da((un||b).memoizedState,c);if(q&&(b.memoizedState=c,$n=!0),b=b.queue,Sh(gh.bind(null,d,b,e),[e]),b.getSnapshot!==i||q||Wn!==null&&Wn.memoizedState.tag&1){if(d.flags|=2048,Il(9,{destroy:void 0},Zd.bind(null,d,b,c,i),null),Be===null)throw Error(a(349));A||(tr&127)!==0||Jd(d,i,c)}return c}function Jd(e,i,c){e.flags|=16384,e={getSnapshot:i,value:c},i=Re.updateQueue,i===null?(i=yc(),Re.updateQueue=i,i.stores=[e]):(c=i.stores,c===null?i.stores=[e]:c.push(e))}function Zd(e,i,c,d){i.value=c,i.getSnapshot=d,ph(i)&&Wd(e)}function gh(e,i,c){return c(function(){ph(i)&&Wd(e)})}function ph(e){var i=e.getSnapshot;e=e.value;try{var c=i();return!da(e,c)}catch{return!0}}function Wd(e){var i=ii(e,2);i!==null&&sn(i,e,2)}function _c(e){var i=za();if(typeof e=="function"){var c=e;if(e=c(),ks){gt(!0);try{c()}finally{gt(!1)}}}return i.memoizedState=i.baseState=e,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:e},i}function mh(e,i,c,d){return e.baseState=c,hh(e,un,typeof d=="function"?d:nr)}function $d(e,i,c,d,b){if($o(e))throw Error(a(485));if(e=i.action,e!==null){var A={payload:b,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){A.listeners.push(q)}};j.T!==null?c(!0):A.isTransition=!1,d(A),c=i.pending,c===null?(A.next=i.pending=A,Ec(i,A)):(A.next=c.next,i.pending=c.next=A)}}function Ec(e,i){var c=i.action,d=i.payload,b=e.state;if(i.isTransition){var A=j.T,q={};j.T=q;try{var tt=c(b,d),ot=j.S;ot!==null&&ot(q,tt),Cc(e,i,tt)}catch(St){vh(e,i,St)}finally{A!==null&&q.types!==null&&(A.types=q.types),j.T=A}}else try{A=c(b,d),Cc(e,i,A)}catch(St){vh(e,i,St)}}function Cc(e,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){t0(e,i,d)},function(d){return vh(e,i,d)}):t0(e,i,c)}function t0(e,i,c){i.status="fulfilled",i.value=c,e0(i),e.state=c,i=e.pending,i!==null&&(c=i.next,c===i?e.pending=null:(c=c.next,i.next=c,Ec(e,c)))}function vh(e,i,c){var d=e.pending;if(e.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=c,e0(i),i=i.next;while(i!==d)}e.action=null}function e0(e){e=e.listeners;for(var i=0;i<e.length;i++)(0,e[i])()}function n0(e,i){return i}function yh(e,i){if(qe){var c=Be.formState;if(c!==null){t:{var d=Re;if(qe){if(mn){e:{for(var b=mn,A=Ba;b.nodeType!==8;){if(!A){b=null;break e}if(b=hr(b.nextSibling),b===null){b=null;break e}}A=b.data,b=A==="F!"||A==="F"?b:null}if(b){mn=hr(b.nextSibling),d=b.data==="F!";break t}}_r(d)}d=!1}d&&(i=c[0])}}return c=za(),c.memoizedState=c.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n0,lastRenderedState:i},c.queue=d,c=Ch.bind(null,Re,d),d.dispatch=c,d=_c(!1),A=qn.bind(null,Re,!1,d.queue),d=za(),b={state:i,dispatch:null,action:e,pending:null},d.queue=b,c=$d.bind(null,Re,b,A,c),b.dispatch=c,d.memoizedState=e,[i,c,!1]}function a0(e){var i=kn();return i0(i,un,e)}function i0(e,i,c){if(i=hh(e,i,n0)[0],e=bc(nr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=Zo(i)}catch(q){throw q===Gs?dc:q}else d=i;i=kn();var b=i.queue,A=b.dispatch;return c!==i.memoizedState&&(Re.flags|=2048,Il(9,{destroy:void 0},Hg.bind(null,b,c),null)),[d,A,e]}function Hg(e,i){e.action=i}function r0(e){var i=kn(),c=un;if(c!==null)return i0(i,c,e);kn(),i=i.memoizedState,c=kn();var d=c.queue.dispatch;return c.memoizedState=e,[i,d,!1]}function Il(e,i,c,d){return e={tag:e,create:c,deps:d,inst:i,next:null},i=Re.updateQueue,i===null&&(i=yc(),Re.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=e.next=e:(d=c.next,c.next=e,e.next=d,i.lastEffect=e),e}function s0(){return kn().memoizedState}function Tc(e,i,c,d){var b=za();Re.flags|=e,b.memoizedState=Il(1|i,{destroy:void 0},c,d===void 0?null:d)}function Ac(e,i,c,d){var b=kn();d=d===void 0?null:d;var A=b.memoizedState.inst;un!==null&&d!==null&&lh(d,un.memoizedState.deps)?b.memoizedState=Il(i,A,c,d):(Re.flags|=e,b.memoizedState=Il(1|i,A,c,d))}function l0(e,i){Tc(8390656,8,e,i)}function Sh(e,i){Ac(2048,8,e,i)}function Ig(e){Re.flags|=4;var i=Re.updateQueue;if(i===null)i=yc(),Re.updateQueue=i,i.events=[e];else{var c=i.events;c===null?i.events=[e]:c.push(e)}}function o0(e){var i=kn().memoizedState;return Ig({ref:i,nextImpl:e}),function(){if((de&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function u0(e,i){return Ac(4,2,e,i)}function c0(e,i){return Ac(4,4,e,i)}function f0(e,i){if(typeof i=="function"){e=e();var c=i(e);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function h0(e,i,c){c=c!=null?c.concat([e]):null,Ac(4,4,f0.bind(null,i,e),c)}function wc(){}function d0(e,i){var c=kn();i=i===void 0?null:i;var d=c.memoizedState;return i!==null&&lh(i,d[1])?d[0]:(c.memoizedState=[e,i],e)}function g0(e,i){var c=kn();i=i===void 0?null:i;var d=c.memoizedState;if(i!==null&&lh(i,d[1]))return d[0];if(d=e(),ks){gt(!0);try{e()}finally{gt(!1)}}return c.memoizedState=[d,i],d}function ui(e,i,c){return c===void 0||(tr&1073741824)!==0&&(De&261930)===0?e.memoizedState=i:(e.memoizedState=c,e=zr(),Re.lanes|=e,ps|=e,c)}function bh(e,i,c,d){return da(c,i)?c:Hl.current!==null?(e=ui(e,c,d),da(e,i)||($n=!0),e):(tr&42)===0||(tr&1073741824)!==0&&(De&261930)===0?($n=!0,e.memoizedState=c):(e=zr(),Re.lanes|=e,ps|=e,i)}function Rc(e,i,c,d,b){var A=I.p;I.p=A!==0&&8>A?A:8;var q=j.T,tt={};j.T=tt,qn(e,!1,i,c);try{var ot=b(),St=j.S;if(St!==null&&St(tt,ot),ot!==null&&typeof ot=="object"&&typeof ot.then=="function"){var Ot=li(ot,d);Wo(e,i,Ot,Ma(e))}else Wo(e,i,d,Ma(e))}catch(Nt){Wo(e,i,{then:function(){},status:"rejected",reason:Nt},Ma())}finally{I.p=A,q!==null&&tt.types!==null&&(q.types=tt.types),j.T=q}}function p0(){}function Oc(e,i,c,d){if(e.tag!==5)throw Error(a(476));var b=_h(e).queue;Rc(e,b,i,F,c===null?p0:function(){return m0(e),c(d)})}function _h(e){var i=e.memoizedState;if(i!==null)return i;i={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:F},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:c},next:null},e.memoizedState=i,e=e.alternate,e!==null&&(e.memoizedState=i),i}function m0(e){var i=_h(e);i.next===null&&(i=e.alternate.memoizedState),Wo(e,i.next.queue,{},Ma())}function xc(){return Cn(kh)}function Eh(){return kn().memoizedState}function v0(){return kn().memoizedState}function kg(e){for(var i=e.return;i!==null;){switch(i.tag){case 24:case 3:var c=Ma();e=rs(c);var d=ss(i,e,c);d!==null&&(sn(d,i,c),Xo(d,i,c)),i={cache:cc()},e.payload=i;return}i=i.return}}function qg(e,i,c){var d=Ma();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},$o(e)?y0(i,c):(c=Ms(e,i,c,d),c!==null&&(sn(c,e,d),Th(c,i,d)))}function Ch(e,i,c){var d=Ma();Wo(e,i,c,d)}function Wo(e,i,c,d){var b={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if($o(e))y0(i,b);else{var A=e.alternate;if(e.lanes===0&&(A===null||A.lanes===0)&&(A=i.lastRenderedReducer,A!==null))try{var q=i.lastRenderedState,tt=A(q,c);if(b.hasEagerState=!0,b.eagerState=tt,da(tt,q))return Sr(e,i,b,0),Be===null&&Lo(),!1}catch{}finally{}if(c=Ms(e,i,b,d),c!==null)return sn(c,e,d),Th(c,i,d),!0}return!1}function qn(e,i,c,d){if(d={lane:2,revertLane:Kg(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},$o(e)){if(i)throw Error(a(479))}else i=Ms(e,c,d,2),i!==null&&sn(i,e,2)}function $o(e){var i=e.alternate;return e===Re||i!==null&&i===Re}function y0(e,i){Ei=xr=!0;var c=e.pending;c===null?i.next=i:(i.next=c.next,c.next=i),e.pending=i}function Th(e,i,c){if((c&4194048)!==0){var d=i.lanes;d&=e.pendingLanes,c|=d,i.lanes=c,Ft(e,c)}}var kl={readContext:Cn,use:Sc,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useLayoutEffect:Hn,useInsertionEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useSyncExternalStore:Hn,useId:Hn,useHostTransitionStatus:Hn,useFormState:Hn,useActionState:Hn,useOptimistic:Hn,useMemoCache:Hn,useCacheRefresh:Hn};kl.useEffectEvent=Hn;var Vs={readContext:Cn,use:Sc,useCallback:function(e,i){return za().memoizedState=[e,i===void 0?null:i],e},useContext:Cn,useEffect:l0,useImperativeHandle:function(e,i,c){c=c!=null?c.concat([e]):null,Tc(4194308,4,f0.bind(null,i,e),c)},useLayoutEffect:function(e,i){return Tc(4194308,4,e,i)},useInsertionEffect:function(e,i){Tc(4,2,e,i)},useMemo:function(e,i){var c=za();i=i===void 0?null:i;var d=e();if(ks){gt(!0);try{e()}finally{gt(!1)}}return c.memoizedState=[d,i],d},useReducer:function(e,i,c){var d=za();if(c!==void 0){var b=c(i);if(ks){gt(!0);try{c(i)}finally{gt(!1)}}}else b=i;return d.memoizedState=d.baseState=b,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:b},d.queue=e,e=e.dispatch=qg.bind(null,Re,e),[d.memoizedState,e]},useRef:function(e){var i=za();return e={current:e},i.memoizedState=e},useState:function(e){e=_c(e);var i=e.queue,c=Ch.bind(null,Re,i);return i.dispatch=c,[e.memoizedState,c]},useDebugValue:wc,useDeferredValue:function(e,i){var c=za();return ui(c,e,i)},useTransition:function(){var e=_c(!1);return e=Rc.bind(null,Re,e.queue,!0,!1),za().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,i,c){var d=Re,b=za();if(qe){if(c===void 0)throw Error(a(407));c=c()}else{if(c=i(),Be===null)throw Error(a(349));(De&127)!==0||Jd(d,i,c)}b.memoizedState=c;var A={value:c,getSnapshot:i};return b.queue=A,l0(gh.bind(null,d,A,e),[e]),d.flags|=2048,Il(9,{destroy:void 0},Zd.bind(null,d,A,c,i),null),c},useId:function(){var e=za(),i=Be.identifierPrefix;if(qe){var c=Ni,d=Mi;c=(d&~(1<<32-Jt(d)-1)).toString(32)+c,i="_"+i+"R_"+c,c=vc++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=Gg++,i="_"+i+"r_"+c.toString(32)+"_";return e.memoizedState=i},useHostTransitionStatus:xc,useFormState:yh,useActionState:yh,useOptimistic:function(e){var i=za();i.memoizedState=i.baseState=e;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=qn.bind(null,Re,!0,c),c.dispatch=i,[e,i]},useMemoCache:fh,useCacheRefresh:function(){return za().memoizedState=kg.bind(null,Re)},useEffectEvent:function(e){var i=za(),c={impl:e};return i.memoizedState=c,function(){if((de&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}},tu={readContext:Cn,use:Sc,useCallback:d0,useContext:Cn,useEffect:Sh,useImperativeHandle:h0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:g0,useReducer:bc,useRef:s0,useState:function(){return bc(nr)},useDebugValue:wc,useDeferredValue:function(e,i){var c=kn();return bh(c,un.memoizedState,e,i)},useTransition:function(){var e=bc(nr)[0],i=kn().memoizedState;return[typeof e=="boolean"?e:Zo(e),i]},useSyncExternalStore:Fd,useId:Eh,useHostTransitionStatus:xc,useFormState:a0,useActionState:a0,useOptimistic:function(e,i){var c=kn();return mh(c,un,e,i)},useMemoCache:fh,useCacheRefresh:v0};tu.useEffectEvent=o0;var Ys={readContext:Cn,use:Sc,useCallback:d0,useContext:Cn,useEffect:Sh,useImperativeHandle:h0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:g0,useReducer:dh,useRef:s0,useState:function(){return dh(nr)},useDebugValue:wc,useDeferredValue:function(e,i){var c=kn();return un===null?ui(c,e,i):bh(c,un.memoizedState,e,i)},useTransition:function(){var e=dh(nr)[0],i=kn().memoizedState;return[typeof e=="boolean"?e:Zo(e),i]},useSyncExternalStore:Fd,useId:Eh,useHostTransitionStatus:xc,useFormState:r0,useActionState:r0,useOptimistic:function(e,i){var c=kn();return un!==null?mh(c,un,e,i):(c.baseState=e,[e,c.queue.dispatch])},useMemoCache:fh,useCacheRefresh:v0};Ys.useEffectEvent=o0;function cs(e,i,c,d){i=e.memoizedState,c=c(d,i),c=c==null?i:C({},i,c),e.memoizedState=c,e.lanes===0&&(e.updateQueue.baseState=c)}var La={enqueueSetState:function(e,i,c){e=e._reactInternals;var d=Ma(),b=rs(d);b.payload=i,c!=null&&(b.callback=c),i=ss(e,b,d),i!==null&&(sn(i,e,d),Xo(i,e,d))},enqueueReplaceState:function(e,i,c){e=e._reactInternals;var d=Ma(),b=rs(d);b.tag=1,b.payload=i,c!=null&&(b.callback=c),i=ss(e,b,d),i!==null&&(sn(i,e,d),Xo(i,e,d))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var c=Ma(),d=rs(c);d.tag=2,i!=null&&(d.callback=i),i=ss(e,d,c),i!==null&&(sn(i,e,c),Xo(i,e,c))}};function S0(e,i,c,d,b,A,q){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(d,A,q):i.prototype&&i.prototype.isPureReactComponent?!Si(c,d)||!Si(b,A):!0}function b0(e,i,c,d){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,d),i.state!==e&&La.enqueueReplaceState(i,i.state,null)}function ar(e,i){var c=i;if("ref"in i){c={};for(var d in i)d!=="ref"&&(c[d]=i[d])}if(e=e.defaultProps){c===i&&(c=C({},c));for(var b in e)c[b]===void 0&&(c[b]=e[b])}return c}function eu(e){Ri(e)}function nu(e){console.error(e)}function Mc(e){Ri(e)}function Nc(e,i){try{var c=e.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function _0(e,i,c){try{var d=e.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function ci(e,i,c){return c=rs(c),c.tag=3,c.payload={element:null},c.callback=function(){Nc(e,i)},c}function Ah(e){return e=rs(e),e.tag=3,e}function E0(e,i,c,d){var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var A=d.value;e.payload=function(){return b(A)},e.callback=function(){_0(i,c,d)}}var q=c.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(e.callback=function(){_0(i,c,d),typeof b!="function"&&(Ia===null?Ia=new Set([this]):Ia.add(this));var tt=d.stack;this.componentDidCatch(d.value,{componentStack:tt!==null?tt:""})})}function wh(e,i,c,d,b){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=c.alternate,i!==null&&Bl(i,c,b,!0),c=xn.current,c!==null){switch(c.tag){case 31:case 13:return _i===null?S():c.alternate===null&&yn===0&&(yn=3),c.flags&=-257,c.flags|=65536,c.lanes=b,d===Vo?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([d]):i.add(d),pn(e,d,b)),!1;case 22:return c.flags|=65536,d===Vo?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([d]):c.add(d)),pn(e,d,b)),!1}throw Error(a(435,c.tag))}return pn(e,d,b),S(),!1}if(qe)return i=xn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=b,d!==lc&&(e=Error(a(422),{cause:d}),Ul(ri(e,c)))):(d!==lc&&(i=Error(a(423),{cause:d}),Ul(ri(i,c))),e=e.current.alternate,e.flags|=65536,b&=-b,e.lanes|=b,d=ri(d,c),b=ci(e.stateNode,d,b),rh(e,b),yn!==4&&(yn=2)),!1;var A=Error(a(520),{cause:d});if(A=ri(A,c),Je===null?Je=[A]:Je.push(A),yn!==4&&(yn=2),i===null)return!0;d=ri(d,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,e=b&-b,c.lanes|=e,e=ci(c.stateNode,d,e),rh(c,e),!1;case 1:if(i=c.type,A=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ia===null||!Ia.has(A))))return c.flags|=65536,b&=-b,c.lanes|=b,b=Ah(b),E0(b,e,c,d),rh(c,b),!1}c=c.return}while(c!==null);return!1}var Rh=Error(a(461)),$n=!1;function ya(e,i,c,d){i.child=e===null?Yd(i,null,c,d):Hs(i,e.child,c,d)}function ql(e,i,c,d,b){c=c.render;var A=i.ref;if("ref"in d){var q={};for(var tt in d)tt!=="ref"&&(q[tt]=d[tt])}else q=d;return Er(i),d=qs(e,i,c,q,A,b),tt=oh(),e!==null&&!$n?(uh(e,i,b),Bi(e,i,b)):(qe&&tt&&Ho(i),i.flags|=1,ya(e,i,d,b),i.child)}function Fa(e,i,c,d,b){if(e===null){var A=c.type;return typeof A=="function"&&!ac(A)&&A.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=A,Dc(e,i,A,d,b)):(e=Nl(c.type,null,d,i,i.mode,b),e.ref=i.ref,e.return=i,i.child=e)}if(A=e.child,!Ga(e,b)){var q=A.memoizedProps;if(c=c.compare,c=c!==null?c:Si,c(q,d)&&e.ref===i.ref)return Bi(e,i,b)}return i.flags|=1,e=Oi(A,d),e.ref=i.ref,e.return=i,i.child=e}function Dc(e,i,c,d,b){if(e!==null){var A=e.memoizedProps;if(Si(A,d)&&e.ref===i.ref)if($n=!1,i.pendingProps=d=A,Ga(e,b))(e.flags&131072)!==0&&($n=!0);else return i.lanes=e.lanes,Bi(e,i,b)}return Ja(e,i,c,d,b)}function Oh(e,i,c,d){var b=d.children,A=e!==null?e.memoizedState:null;if(e===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((i.flags&128)!==0){if(A=A!==null?A.baseLanes|c:c,e!==null){for(d=i.child=e.child,b=0;d!==null;)b=b|d.lanes|d.childLanes,d=d.sibling;d=b&~A}else d=0,i.child=null;return xh(e,i,A,c,d)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},e!==null&&Cr(i,A!==null?A.cachePool:null),A!==null?Zi(i,A):sa(),$i(i);else return d=i.lanes=536870912,xh(e,i,A!==null?A.baseLanes|c:c,c,d)}else A!==null?(Cr(i,A.cachePool),Zi(i,A),us(),i.memoizedState=null):(e!==null&&Cr(i,null),sa(),us());return ya(e,i,b,c),i.child}function Ks(e,i){return e!==null&&e.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function xh(e,i,c,d,b){var A=Gl();return A=A===null?null:{parent:Jn._currentValue,pool:A},i.memoizedState={baseLanes:c,cachePool:A},e!==null&&Cr(i,null),sa(),$i(i),e!==null&&Bl(e,i,d,!0),i.childLanes=b,null}function Mr(e,i){return i=la({mode:i.mode,children:i.children},e.mode),i.ref=e.ref,e.child=i,i.return=e,i}function Qs(e,i,c){return Hs(i,e.child,null,c),e=Mr(i,i.pendingProps),e.flags|=2,oi(i),i.memoizedState=null,e}function jc(e,i,c){var d=i.pendingProps,b=(i.flags&128)!==0;if(i.flags&=-129,e===null){if(qe){if(d.mode==="hidden")return e=Mr(i,d),i.lanes=536870912,Ks(null,e);if(Zn(i),(e=mn)?(e=jv(e,Ba),e=e!==null&&e.data==="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:br!==null?{id:Mi,overflow:Ni}:null,retryLane:536870912,hydrationErrors:null},c=Ka(e),c.return=i,i.child=c,va=i,mn=null)):e=null,e===null)throw _r(i);return i.lanes=536870912,null}return Mr(i,d)}var A=e.memoizedState;if(A!==null){var q=A.dehydrated;if(Zn(i),b)if(i.flags&256)i.flags&=-257,i=Qs(e,i,c);else if(i.memoizedState!==null)i.child=e.child,i.flags|=128,i=null;else throw Error(a(558));else if($n||Bl(e,i,c,!1),b=(c&e.childLanes)!==0,$n||b){if(d=Be,d!==null&&(q=On(d,c),q!==0&&q!==A.retryLane))throw A.retryLane=q,ii(e,q),sn(d,e,q),Rh;S(),i=Qs(e,i,c)}else e=A.treeContext,mn=hr(q.nextSibling),va=i,qe=!0,si=null,Ba=!1,e!==null&&qd(i,e),i=Mr(i,d),i.flags|=4096;return i}return e=Oi(e.child,{mode:d.mode,children:d.children}),e.ref=i.ref,i.child=e,e.return=i,e}function Xs(e,i){var c=i.ref;if(c===null)e!==null&&e.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(e===null||e.ref!==c)&&(i.flags|=4194816)}}function Ja(e,i,c,d,b){return Er(i),c=qs(e,i,c,d,void 0,b),d=oh(),e!==null&&!$n?(uh(e,i,b),Bi(e,i,b)):(qe&&d&&Ho(i),i.flags|=1,ya(e,i,c,b),i.child)}function fi(e,i,c,d,b,A){return Er(i),i.updateQueue=null,c=Xd(i,d,c,b),Qd(e),d=oh(),e!==null&&!$n?(uh(e,i,A),Bi(e,i,A)):(qe&&d&&Ho(i),i.flags|=1,ya(e,i,c,A),i.child)}function fs(e,i,c,d,b){if(Er(i),i.stateNode===null){var A=Qi,q=c.contextType;typeof q=="object"&&q!==null&&(A=Cn(q)),A=new c(d,A),i.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=La,i.stateNode=A,A._reactInternals=i,A=i.stateNode,A.props=d,A.state=i.memoizedState,A.refs={},Is(i),q=c.contextType,A.context=typeof q=="object"&&q!==null?Cn(q):Qi,A.state=i.memoizedState,q=c.getDerivedStateFromProps,typeof q=="function"&&(cs(i,c,q,d),A.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(q=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),q!==A.state&&La.enqueueReplaceState(A,A.state,null),ls(i,d,A,b),Pl(),A.state=i.memoizedState),typeof A.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(e===null){A=i.stateNode;var tt=i.memoizedProps,ot=ar(c,tt);A.props=ot;var St=A.context,Ot=c.contextType;q=Qi,typeof Ot=="object"&&Ot!==null&&(q=Cn(Ot));var Nt=c.getDerivedStateFromProps;Ot=typeof Nt=="function"||typeof A.getSnapshotBeforeUpdate=="function",tt=i.pendingProps!==tt,Ot||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(tt||St!==q)&&b0(i,A,d,q),Or=!1;var Et=i.memoizedState;A.state=Et,ls(i,d,A,b),Pl(),St=i.memoizedState,tt||Et!==St||Or?(typeof Nt=="function"&&(cs(i,c,Nt,d),St=i.memoizedState),(ot=Or||S0(i,c,ot,d,Et,St,q))?(Ot||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(i.flags|=4194308)):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=St),A.props=d,A.state=St,A.context=q,d=ot):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{A=i.stateNode,ih(e,i),q=i.memoizedProps,Ot=ar(c,q),A.props=Ot,Nt=i.pendingProps,Et=A.context,St=c.contextType,ot=Qi,typeof St=="object"&&St!==null&&(ot=Cn(St)),tt=c.getDerivedStateFromProps,(St=typeof tt=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(q!==Nt||Et!==ot)&&b0(i,A,d,ot),Or=!1,Et=i.memoizedState,A.state=Et,ls(i,d,A,b),Pl();var Tt=i.memoizedState;q!==Nt||Et!==Tt||Or||e!==null&&e.dependencies!==null&&uc(e.dependencies)?(typeof tt=="function"&&(cs(i,c,tt,d),Tt=i.memoizedState),(Ot=Or||S0(i,c,Ot,d,Et,Tt,ot)||e!==null&&e.dependencies!==null&&uc(e.dependencies))?(St||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(d,Tt,ot),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(d,Tt,ot)),typeof A.componentDidUpdate=="function"&&(i.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof A.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=Tt),A.props=d,A.state=Tt,A.context=ot,d=Ot):(typeof A.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=1024),d=!1)}return A=d,Xs(e,i),d=(i.flags&128)!==0,A||d?(A=i.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:A.render(),i.flags|=1,e!==null&&d?(i.child=Hs(i,e.child,null,b),i.child=Hs(i,null,c,b)):ya(e,i,c,b),i.memoizedState=A.state,e=i.child):e=Bi(e,i,b),e}function ir(e,i,c,d){return es(),i.flags|=256,ya(e,i,c,d),i.child}var ji={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function na(e){return{baseLanes:e,cachePool:Ls()}}function Fs(e,i,c){return e=e!==null?e.childLanes&~c:0,i&&(e|=me),e}function Nr(e,i,c){var d=i.pendingProps,b=!1,A=(i.flags&128)!==0,q;if((q=A)||(q=e!==null&&e.memoizedState===null?!1:(In.current&2)!==0),q&&(b=!0,i.flags&=-129),q=(i.flags&32)!==0,i.flags&=-33,e===null){if(qe){if(b?os(i):us(),(e=mn)?(e=jv(e,Ba),e=e!==null&&e.data!=="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:br!==null?{id:Mi,overflow:Ni}:null,retryLane:536870912,hydrationErrors:null},c=Ka(e),c.return=i,i.child=c,va=i,mn=null)):e=null,e===null)throw _r(i);return rp(e)?i.lanes=32:i.lanes=536870912,null}var tt=d.children;return d=d.fallback,b?(us(),b=i.mode,tt=la({mode:"hidden",children:tt},b),d=ts(d,b,c,null),tt.return=i,d.return=i,tt.sibling=d,i.child=tt,d=i.child,d.memoizedState=na(c),d.childLanes=Fs(e,q,c),i.memoizedState=ji,Ks(null,d)):(os(i),Vl(i,tt))}var ot=e.memoizedState;if(ot!==null&&(tt=ot.dehydrated,tt!==null)){if(A)i.flags&256?(os(i),i.flags&=-257,i=Vn(e,i,c)):i.memoizedState!==null?(us(),i.child=e.child,i.flags|=128,i=null):(us(),tt=d.fallback,b=i.mode,d=la({mode:"visible",children:d.children},b),tt=ts(tt,b,c,null),tt.flags|=2,d.return=i,tt.return=i,d.sibling=tt,i.child=d,Hs(i,e.child,null,c),d=i.child,d.memoizedState=na(c),d.childLanes=Fs(e,q,c),i.memoizedState=ji,i=Ks(null,d));else if(os(i),rp(tt)){if(q=tt.nextSibling&&tt.nextSibling.dataset,q)var St=q.dgst;q=St,d=Error(a(419)),d.stack="",d.digest=q,Ul({value:d,source:null,stack:null}),i=Vn(e,i,c)}else if($n||Bl(e,i,c,!1),q=(c&e.childLanes)!==0,$n||q){if(q=Be,q!==null&&(d=On(q,c),d!==0&&d!==ot.retryLane))throw ot.retryLane=d,ii(e,d),sn(q,e,d),Rh;ip(tt)||S(),i=Vn(e,i,c)}else ip(tt)?(i.flags|=192,i.child=e.child,i=null):(e=ot.treeContext,mn=hr(tt.nextSibling),va=i,qe=!0,si=null,Ba=!1,e!==null&&qd(i,e),i=Vl(i,d.children),i.flags|=4096);return i}return b?(us(),tt=d.fallback,b=i.mode,ot=e.child,St=ot.sibling,d=Oi(ot,{mode:"hidden",children:d.children}),d.subtreeFlags=ot.subtreeFlags&65011712,St!==null?tt=Oi(St,tt):(tt=ts(tt,b,c,null),tt.flags|=2),tt.return=i,d.return=i,d.sibling=tt,i.child=d,Ks(null,d),d=i.child,tt=e.child.memoizedState,tt===null?tt=na(c):(b=tt.cachePool,b!==null?(ot=Jn._currentValue,b=b.parent!==ot?{parent:ot,pool:ot}:b):b=Ls(),tt={baseLanes:tt.baseLanes|c,cachePool:b}),d.memoizedState=tt,d.childLanes=Fs(e,q,c),i.memoizedState=ji,Ks(e.child,d)):(os(i),c=e.child,e=c.sibling,c=Oi(c,{mode:"visible",children:d.children}),c.return=i,c.sibling=null,e!==null&&(q=i.deletions,q===null?(i.deletions=[e],i.flags|=16):q.push(e)),i.child=c,i.memoizedState=null,c)}function Vl(e,i){return i=la({mode:"visible",children:i},e.mode),i.return=e,e.child=i}function la(e,i){return e=wa(22,e,null,i),e.lanes=0,e}function Vn(e,i,c){return Hs(i,e.child,null,c),e=Vl(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function tn(e,i,c){e.lanes|=i;var d=e.alternate;d!==null&&(d.lanes|=i),th(e.return,i,c)}function Dr(e,i,c,d,b,A){var q=e.memoizedState;q===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:b,treeForkCount:A}:(q.isBackwards=i,q.rendering=null,q.renderingStartTime=0,q.last=d,q.tail=c,q.tailMode=b,q.treeForkCount=A)}function Ui(e,i,c){var d=i.pendingProps,b=d.revealOrder,A=d.tail;d=d.children;var q=In.current,tt=(q&2)!==0;if(tt?(q=q&1|2,i.flags|=128):q&=1,rt(In,q),ya(e,i,d,c),d=qe?jl:0,!tt&&e!==null&&(e.flags&128)!==0)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&tn(e,c,i);else if(e.tag===19)tn(e,c,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(b){case"forwards":for(c=i.child,b=null;c!==null;)e=c.alternate,e!==null&&mc(e)===null&&(b=c),c=c.sibling;c=b,c===null?(b=i.child,i.child=null):(b=c.sibling,c.sibling=null),Dr(i,!1,b,c,A,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,b=i.child,i.child=null;b!==null;){if(e=b.alternate,e!==null&&mc(e)===null){i.child=b;break}e=b.sibling,b.sibling=c,c=b,b=e}Dr(i,!0,c,null,A,d);break;case"together":Dr(i,!1,null,null,void 0,d);break;default:i.memoizedState=null}return i.child}function Bi(e,i,c){if(e!==null&&(i.dependencies=e.dependencies),ps|=i.lanes,(c&i.childLanes)===0)if(e!==null){if(Bl(e,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(e!==null&&i.child!==e.child)throw Error(a(153));if(i.child!==null){for(e=i.child,c=Oi(e,e.pendingProps),i.child=c,c.return=i;e.sibling!==null;)e=e.sibling,c=c.sibling=Oi(e,e.pendingProps),c.return=i;c.sibling=null}return i.child}function Ga(e,i){return(e.lanes&i)!==0?!0:(e=e.dependencies,!!(e!==null&&uc(e)))}function Uc(e,i,c){switch(i.tag){case 3:ht(i,i.stateNode.containerInfo),ns(i,Jn,e.memoizedState.cache),es();break;case 27:case 5:zt(i);break;case 4:ht(i,i.stateNode.containerInfo);break;case 10:ns(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Zn(i),null;break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(os(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Nr(e,i,c):(os(i),e=Bi(e,i,c),e!==null?e.sibling:null);os(i);break;case 19:var b=(e.flags&128)!==0;if(d=(c&i.childLanes)!==0,d||(Bl(e,i,c,!1),d=(c&i.childLanes)!==0),b){if(d)return Ui(e,i,c);i.flags|=128}if(b=i.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),rt(In,In.current),d)break;return null;case 22:return i.lanes=0,Oh(e,i,c,i.pendingProps);case 24:ns(i,Jn,e.memoizedState.cache)}return Bi(e,i,c)}function hs(e,i,c){if(e!==null)if(e.memoizedProps!==i.pendingProps)$n=!0;else{if(!Ga(e,c)&&(i.flags&128)===0)return $n=!1,Uc(e,i,c);$n=(e.flags&131072)!==0}else $n=!1,qe&&(i.flags&1048576)!==0&&sc(i,jl,i.index);switch(i.lanes=0,i.tag){case 16:t:{var d=i.pendingProps;if(e=Ar(i.elementType),i.type=e,typeof e=="function")ac(e)?(d=ar(e,d),i.tag=1,i=fs(null,i,e,d,c)):(i.tag=0,i=Ja(null,i,e,d,c));else{if(e!=null){var b=e.$$typeof;if(b===G){i.tag=11,i=ql(null,i,e,d,c);break t}else if(b===T){i.tag=14,i=Fa(null,i,e,d,c);break t}}throw i=X(e)||e,Error(a(306,i,""))}}return i;case 0:return Ja(e,i,i.type,i.pendingProps,c);case 1:return d=i.type,b=ar(d,i.pendingProps),fs(e,i,d,b,c);case 3:t:{if(ht(i,i.stateNode.containerInfo),e===null)throw Error(a(387));d=i.pendingProps;var A=i.memoizedState;b=A.element,ih(e,i),ls(i,d,null,c);var q=i.memoizedState;if(d=q.cache,ns(i,Jn,d),d!==A.cache&&eh(i,[Jn],c,!0),Pl(),d=q.element,A.isDehydrated)if(A={element:d,isDehydrated:!1,cache:q.cache},i.updateQueue.baseState=A,i.memoizedState=A,i.flags&256){i=ir(e,i,d,c);break t}else if(d!==b){b=ri(Error(a(424)),i),Ul(b),i=ir(e,i,d,c);break t}else{switch(e=i.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(mn=hr(e.firstChild),va=i,qe=!0,si=null,Ba=!0,c=Yd(i,null,d,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(es(),d===b){i=Bi(e,i,c);break t}ya(e,i,d,c)}i=i.child}return i;case 26:return Xs(e,i),e===null?(c=Pv(i.type,null,i.pendingProps,null))?i.memoizedState=c:qe||(c=i.type,e=i.pendingProps,d=M0($.current).createElement(c),d[he]=i,d[Ne]=e,ka(d,c,e),ra(d),i.stateNode=d):i.memoizedState=Pv(i.type,e.memoizedProps,i.pendingProps,e.memoizedState),null;case 27:return zt(i),e===null&&qe&&(d=i.stateNode=zv(i.type,i.pendingProps,$.current),va=i,Ba=!0,b=mn,Wl(i.type)?(sp=b,mn=hr(d.firstChild)):mn=b),ya(e,i,i.pendingProps.children,c),Xs(e,i),e===null&&(i.flags|=4194304),i.child;case 5:return e===null&&qe&&((b=d=mn)&&(d=Ib(d,i.type,i.pendingProps,Ba),d!==null?(i.stateNode=d,va=i,mn=hr(d.firstChild),Ba=!1,b=!0):b=!1),b||_r(i)),zt(i),b=i.type,A=i.pendingProps,q=e!==null?e.memoizedProps:null,d=A.children,ep(b,A)?d=null:q!==null&&ep(b,q)&&(i.flags|=32),i.memoizedState!==null&&(b=qs(e,i,Pg,null,null,c),kh._currentValue=b),Xs(e,i),ya(e,i,d,c),i.child;case 6:return e===null&&qe&&((e=c=mn)&&(c=kb(c,i.pendingProps,Ba),c!==null?(i.stateNode=c,va=i,mn=null,e=!0):e=!1),e||_r(i)),null;case 13:return Nr(e,i,c);case 4:return ht(i,i.stateNode.containerInfo),d=i.pendingProps,e===null?i.child=Hs(i,null,d,c):ya(e,i,d,c),i.child;case 11:return ql(e,i,i.type,i.pendingProps,c);case 7:return ya(e,i,i.pendingProps,c),i.child;case 8:return ya(e,i,i.pendingProps.children,c),i.child;case 12:return ya(e,i,i.pendingProps.children,c),i.child;case 10:return d=i.pendingProps,ns(i,i.type,d.value),ya(e,i,d.children,c),i.child;case 9:return b=i.type._context,d=i.pendingProps.children,Er(i),b=Cn(b),d=d(b),i.flags|=1,ya(e,i,d,c),i.child;case 14:return Fa(e,i,i.type,i.pendingProps,c);case 15:return Dc(e,i,i.type,i.pendingProps,c);case 19:return Ui(e,i,c);case 31:return jc(e,i,c);case 22:return Oh(e,i,c,i.pendingProps);case 24:return Er(i),d=Cn(Jn),e===null?(b=Gl(),b===null&&(b=Be,A=cc(),b.pooledCache=A,A.refCount++,A!==null&&(b.pooledCacheLanes|=c),b=A),i.memoizedState={parent:d,cache:b},Is(i),ns(i,Jn,b)):((e.lanes&c)!==0&&(ih(e,i),ls(i,null,null,c),Pl()),b=e.memoizedState,A=i.memoizedState,b.parent!==d?(b={parent:d,cache:d},i.memoizedState=b,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=b),ns(i,Jn,d)):(d=A.cache,ns(i,Jn,d),d!==b.cache&&eh(i,[Jn],c,!0))),ya(e,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Sa(e){e.flags|=4}function Mh(e,i,c,d,b){if((i=(e.mode&32)!==0)&&(i=!1),i){if(e.flags|=16777216,(b&335544128)===b)if(e.stateNode.complete)e.flags|=8192;else if(s())e.flags|=8192;else throw wr=Vo,qo}else e.flags&=-16777217}function C0(e,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Vv(i))if(s())e.flags|=8192;else throw wr=Vo,qo}function Bc(e,i){i!==null&&(e.flags|=4),e.flags&16384&&(i=e.tag!==22?_s():536870912,e.lanes|=i,Le|=i)}function vn(e,i){if(!qe)switch(e.tailMode){case"hidden":i=e.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?e.tail=null:c.sibling=null;break;case"collapsed":c=e.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:d.sibling=null}}function dn(e){var i=e.alternate!==null&&e.alternate.child===e.child,c=0,d=0;if(i)for(var b=e.child;b!==null;)c|=b.lanes|b.childLanes,d|=b.subtreeFlags&65011712,d|=b.flags&65011712,b.return=e,b=b.sibling;else for(b=e.child;b!==null;)c|=b.lanes|b.childLanes,d|=b.subtreeFlags,d|=b.flags,b.return=e,b=b.sibling;return e.subtreeFlags|=d,e.childLanes=c,i}function Yl(e,i,c){var d=i.pendingProps;switch(Zf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(i),null;case 1:return dn(i),null;case 3:return c=i.stateNode,d=null,e!==null&&(d=e.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),Fi(Jn),Rt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(Ds(i)?Sa(i):e===null||e.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,js())),dn(i),null;case 26:var b=i.type,A=i.memoizedState;return e===null?(Sa(i),A!==null?(dn(i),C0(i,A)):(dn(i),Mh(i,b,null,d,c))):A?A!==e.memoizedState?(Sa(i),dn(i),C0(i,A)):(dn(i),i.flags&=-16777217):(e=e.memoizedProps,e!==d&&Sa(i),dn(i),Mh(i,b,e,d,c)),null;case 27:if(Wt(i),c=$.current,b=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==d&&Sa(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return dn(i),null}e=V.current,Ds(i)?Wf(i):(e=zv(b,d,c),i.stateNode=e,Sa(i))}return dn(i),null;case 5:if(Wt(i),b=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==d&&Sa(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return dn(i),null}if(A=V.current,Ds(i))Wf(i);else{var q=M0($.current);switch(A){case 1:A=q.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:A=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":A=q.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":A=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":A=q.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof d.is=="string"?q.createElement("select",{is:d.is}):q.createElement("select"),d.multiple?A.multiple=!0:d.size&&(A.size=d.size);break;default:A=typeof d.is=="string"?q.createElement(b,{is:d.is}):q.createElement(b)}}A[he]=i,A[Ne]=d;t:for(q=i.child;q!==null;){if(q.tag===5||q.tag===6)A.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===i)break t;for(;q.sibling===null;){if(q.return===null||q.return===i)break t;q=q.return}q.sibling.return=q.return,q=q.sibling}i.stateNode=A;t:switch(ka(A,b,d),b){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break t;case"img":d=!0;break t;default:d=!1}d&&Sa(i)}}return dn(i),Mh(i,i.type,e===null?null:e.memoizedProps,i.pendingProps,c),null;case 6:if(e&&i.stateNode!=null)e.memoizedProps!==d&&Sa(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(a(166));if(e=$.current,Ds(i)){if(e=i.stateNode,c=i.memoizedProps,d=null,b=va,b!==null)switch(b.tag){case 27:case 5:d=b.memoizedProps}e[he]=i,e=!!(e.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||Av(e.nodeValue,c)),e||_r(i,!0)}else e=M0(e).createTextNode(d),e[he]=i,i.stateNode=e}return dn(i),null;case 31:if(c=i.memoizedState,e===null||e.memoizedState!==null){if(d=Ds(i),c!==null){if(e===null){if(!d)throw Error(a(318));if(e=i.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(557));e[he]=i}else es(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;dn(i),e=!1}else c=js(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),e=!0;if(!e)return i.flags&256?(oi(i),i):(oi(i),null);if((i.flags&128)!==0)throw Error(a(558))}return dn(i),null;case 13:if(d=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(b=Ds(i),d!==null&&d.dehydrated!==null){if(e===null){if(!b)throw Error(a(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(a(317));b[he]=i}else es(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;dn(i),b=!1}else b=js(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=b),b=!0;if(!b)return i.flags&256?(oi(i),i):(oi(i),null)}return oi(i),(i.flags&128)!==0?(i.lanes=c,i):(c=d!==null,e=e!==null&&e.memoizedState!==null,c&&(d=i.child,b=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(b=d.alternate.memoizedState.cachePool.pool),A=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(A=d.memoizedState.cachePool.pool),A!==b&&(d.flags|=2048)),c!==e&&c&&(i.child.flags|=8192),Bc(i,i.updateQueue),dn(i),null);case 4:return Rt(),e===null&&Jg(i.stateNode.containerInfo),dn(i),null;case 10:return Fi(i.type),dn(i),null;case 19:if(it(In),d=i.memoizedState,d===null)return dn(i),null;if(b=(i.flags&128)!==0,A=d.rendering,A===null)if(b)vn(d,!1);else{if(yn!==0||e!==null&&(e.flags&128)!==0)for(e=i.child;e!==null;){if(A=mc(e),A!==null){for(i.flags|=128,vn(d,!1),e=A.updateQueue,i.updateQueue=e,Bc(i,e),i.subtreeFlags=0,e=c,c=i.child;c!==null;)ic(c,e),c=c.sibling;return rt(In,In.current&1|2),qe&&Xi(i,d.treeForkCount),i.child}e=e.sibling}d.tail!==null&&Se()>Ai&&(i.flags|=128,b=!0,vn(d,!1),i.lanes=4194304)}else{if(!b)if(e=mc(A),e!==null){if(i.flags|=128,b=!0,e=e.updateQueue,i.updateQueue=e,Bc(i,e),vn(d,!0),d.tail===null&&d.tailMode==="hidden"&&!A.alternate&&!qe)return dn(i),null}else 2*Se()-d.renderingStartTime>Ai&&c!==536870912&&(i.flags|=128,b=!0,vn(d,!1),i.lanes=4194304);d.isBackwards?(A.sibling=i.child,i.child=A):(e=d.last,e!==null?e.sibling=A:i.child=A,d.last=A)}return d.tail!==null?(e=d.tail,d.rendering=e,d.tail=e.sibling,d.renderingStartTime=Se(),e.sibling=null,c=In.current,rt(In,b?c&1|2:c&1),qe&&Xi(i,d.treeForkCount),e):(dn(i),null);case 22:case 23:return oi(i),Wi(),d=i.memoizedState!==null,e!==null?e.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(c&536870912)!==0&&(i.flags&128)===0&&(dn(i),i.subtreeFlags&6&&(i.flags|=8192)):dn(i),c=i.updateQueue,c!==null&&Bc(i,c.retryQueue),c=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==c&&(i.flags|=2048),e!==null&&it(zs),null;case 24:return c=null,e!==null&&(c=e.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Fi(Jn),dn(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function Nh(e,i){switch(Zf(i),i.tag){case 1:return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return Fi(Jn),Rt(),e=i.flags,(e&65536)!==0&&(e&128)===0?(i.flags=e&-65537|128,i):null;case 26:case 27:case 5:return Wt(i),null;case 31:if(i.memoizedState!==null){if(oi(i),i.alternate===null)throw Error(a(340));es()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 13:if(oi(i),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(a(340));es()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return it(In),null;case 4:return Rt(),null;case 10:return Fi(i.type),null;case 22:case 23:return oi(i),Wi(),e!==null&&it(zs),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 24:return Fi(Jn),null;case 25:return null;default:return null}}function au(e,i){switch(Zf(i),i.tag){case 3:Fi(Jn),Rt();break;case 26:case 27:case 5:Wt(i);break;case 4:Rt();break;case 31:i.memoizedState!==null&&oi(i);break;case 13:oi(i);break;case 19:it(In);break;case 10:Fi(i.type);break;case 22:case 23:oi(i),Wi(),e!==null&&it(zs);break;case 24:Fi(Jn)}}function Js(e,i){try{var c=i.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var b=d.next;c=b;do{if((c.tag&e)===e){d=void 0;var A=c.create,q=c.inst;d=A(),q.destroy=d}c=c.next}while(c!==b)}}catch(tt){Qt(i,i.return,tt)}}function hi(e,i,c){try{var d=i.updateQueue,b=d!==null?d.lastEffect:null;if(b!==null){var A=b.next;d=A;do{if((d.tag&e)===e){var q=d.inst,tt=q.destroy;if(tt!==void 0){q.destroy=void 0,b=i;var ot=c,St=tt;try{St()}catch(Ot){Qt(b,ot,Ot)}}}d=d.next}while(d!==A)}}catch(Ot){Qt(i,i.return,Ot)}}function Kl(e){var i=e.updateQueue;if(i!==null){var c=e.stateNode;try{Kd(i,c)}catch(d){Qt(e,e.return,d)}}}function zc(e,i,c){c.props=ar(e.type,e.memoizedProps),c.state=e.memoizedState;try{c.componentWillUnmount()}catch(d){Qt(e,i,d)}}function rr(e,i){try{var c=e.ref;if(c!==null){switch(e.tag){case 26:case 27:case 5:var d=e.stateNode;break;case 30:d=e.stateNode;break;default:d=e.stateNode}typeof c=="function"?e.refCleanup=c(d):c.current=d}}catch(b){Qt(e,i,b)}}function Pa(e,i){var c=e.ref,d=e.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(b){Qt(e,i,b)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(b){Qt(e,i,b)}else c.current=null}function Dh(e){var i=e.type,c=e.memoizedProps,d=e.stateNode;try{t:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break t;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(b){Qt(e,e.return,b)}}function jr(e,i,c){try{var d=e.stateNode;Bb(d,e.type,c,i),d[Ne]=i}catch(b){Qt(e,e.return,b)}}function T0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Wl(e.type)||e.tag===4}function Zs(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||T0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Wl(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function iu(e,i,c){var d=e.tag;if(d===5||d===6)e=e.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(e,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(e),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Va));else if(d!==4&&(d===27&&Wl(e.type)&&(c=e.stateNode,i=null),e=e.child,e!==null))for(iu(e,i,c),e=e.sibling;e!==null;)iu(e,i,c),e=e.sibling}function Ws(e,i,c){var d=e.tag;if(d===5||d===6)e=e.stateNode,i?c.insertBefore(e,i):c.appendChild(e);else if(d!==4&&(d===27&&Wl(e.type)&&(c=e.stateNode),e=e.child,e!==null))for(Ws(e,i,c),e=e.sibling;e!==null;)Ws(e,i,c),e=e.sibling}function ru(e){var i=e.stateNode,c=e.memoizedProps;try{for(var d=e.type,b=i.attributes;b.length;)i.removeAttributeNode(b[0]);ka(i,d,c),i[he]=e,i[Ne]=c}catch(A){Qt(e,e.return,A)}}var Za=!1,nn=!1,ds=!1,Lc=typeof WeakSet=="function"?WeakSet:Set,Tn=null;function jh(e,i){if(e=e.containerInfo,$g=L0,e=wi(e),tc(e)){if("selectionStart"in e)var c={start:e.selectionStart,end:e.selectionEnd};else t:{c=(c=e.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var b=d.anchorOffset,A=d.focusNode;d=d.focusOffset;try{c.nodeType,A.nodeType}catch{c=null;break t}var q=0,tt=-1,ot=-1,St=0,Ot=0,Nt=e,Et=null;e:for(;;){for(var Tt;Nt!==c||b!==0&&Nt.nodeType!==3||(tt=q+b),Nt!==A||d!==0&&Nt.nodeType!==3||(ot=q+d),Nt.nodeType===3&&(q+=Nt.nodeValue.length),(Tt=Nt.firstChild)!==null;)Et=Nt,Nt=Tt;for(;;){if(Nt===e)break e;if(Et===c&&++St===b&&(tt=q),Et===A&&++Ot===d&&(ot=q),(Tt=Nt.nextSibling)!==null)break;Nt=Et,Et=Nt.parentNode}Nt=Tt}c=tt===-1||ot===-1?null:{start:tt,end:ot}}else c=null}c=c||{start:0,end:0}}else c=null;for(tp={focusedElem:e,selectionRange:c},L0=!1,Tn=i;Tn!==null;)if(i=Tn,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,Tn=e;else for(;Tn!==null;){switch(i=Tn,A=i.alternate,e=i.flags,i.tag){case 0:if((e&4)!==0&&(e=i.updateQueue,e=e!==null?e.events:null,e!==null))for(c=0;c<e.length;c++)b=e[c],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&A!==null){e=void 0,c=i,b=A.memoizedProps,A=A.memoizedState,d=c.stateNode;try{var ne=ar(c.type,b);e=d.getSnapshotBeforeUpdate(ne,A),d.__reactInternalSnapshotBeforeUpdate=e}catch(ve){Qt(c,c.return,ve)}}break;case 3:if((e&1024)!==0){if(e=i.stateNode.containerInfo,c=e.nodeType,c===9)ap(e);else if(c===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ap(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=i.sibling,e!==null){e.return=i.return,Tn=e;break}Tn=i.return}}function $s(e,i,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:sr(e,c),d&4&&Js(5,c);break;case 1:if(sr(e,c),d&4)if(e=c.stateNode,i===null)try{e.componentDidMount()}catch(q){Qt(c,c.return,q)}else{var b=ar(c.type,i.memoizedProps);i=i.memoizedState;try{e.componentDidUpdate(b,i,e.__reactInternalSnapshotBeforeUpdate)}catch(q){Qt(c,c.return,q)}}d&64&&Kl(c),d&512&&rr(c,c.return);break;case 3:if(sr(e,c),d&64&&(e=c.updateQueue,e!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Kd(e,i)}catch(q){Qt(c,c.return,q)}}break;case 27:i===null&&d&4&&ru(c);case 26:case 5:sr(e,c),i===null&&d&4&&Dh(c),d&512&&rr(c,c.return);break;case 12:sr(e,c);break;case 31:sr(e,c),d&4&&lu(e,c);break;case 13:sr(e,c),d&4&&tl(e,c),d&64&&(e=c.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(c=ca.bind(null,c),qb(e,c))));break;case 22:if(d=c.memoizedState!==null||Za,!d){i=i!==null&&i.memoizedState!==null||nn,b=Za;var A=nn;Za=d,(nn=i)&&!A?Wa(e,c,(c.subtreeFlags&8772)!==0):sr(e,c),Za=b,nn=A}break;case 30:break;default:sr(e,c)}}function su(e){var i=e.alternate;i!==null&&(e.alternate=null,su(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&Bn(i)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var an=null,ce=!1;function Ve(e,i,c){for(c=c.child;c!==null;)Yn(e,i,c),c=c.sibling}function Yn(e,i,c){if(vt&&typeof vt.onCommitFiberUnmount=="function")try{vt.onCommitFiberUnmount(Lt,c)}catch{}switch(c.tag){case 26:nn||Pa(c,i),Ve(e,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:nn||Pa(c,i);var d=an,b=ce;Wl(c.type)&&(an=c.stateNode,ce=!1),Ve(e,i,c),Ph(c.stateNode),an=d,ce=b;break;case 5:nn||Pa(c,i);case 6:if(d=an,b=ce,an=null,Ve(e,i,c),an=d,ce=b,an!==null)if(ce)try{(an.nodeType===9?an.body:an.nodeName==="HTML"?an.ownerDocument.body:an).removeChild(c.stateNode)}catch(A){Qt(c,i,A)}else try{an.removeChild(c.stateNode)}catch(A){Qt(c,i,A)}break;case 18:an!==null&&(ce?(e=an,Nv(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,c.stateNode),Xc(e)):Nv(an,c.stateNode));break;case 4:d=an,b=ce,an=c.stateNode.containerInfo,ce=!0,Ve(e,i,c),an=d,ce=b;break;case 0:case 11:case 14:case 15:hi(2,c,i),nn||hi(4,c,i),Ve(e,i,c);break;case 1:nn||(Pa(c,i),d=c.stateNode,typeof d.componentWillUnmount=="function"&&zc(c,i,d)),Ve(e,i,c);break;case 21:Ve(e,i,c);break;case 22:nn=(d=nn)||c.memoizedState!==null,Ve(e,i,c),nn=d;break;default:Ve(e,i,c)}}function lu(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Xc(e)}catch(c){Qt(i,i.return,c)}}}function tl(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Xc(e)}catch(c){Qt(i,i.return,c)}}function el(e){switch(e.tag){case 31:case 13:case 19:var i=e.stateNode;return i===null&&(i=e.stateNode=new Lc),i;case 22:return e=e.stateNode,i=e._retryCache,i===null&&(i=e._retryCache=new Lc),i;default:throw Error(a(435,e.tag))}}function nl(e,i){var c=el(e);i.forEach(function(d){if(!c.has(d)){c.add(d);var b=en.bind(null,e,d);d.then(b,b)}})}function oa(e,i){var c=i.deletions;if(c!==null)for(var d=0;d<c.length;d++){var b=c[d],A=e,q=i,tt=q;t:for(;tt!==null;){switch(tt.tag){case 27:if(Wl(tt.type)){an=tt.stateNode,ce=!1;break t}break;case 5:an=tt.stateNode,ce=!1;break t;case 3:case 4:an=tt.stateNode.containerInfo,ce=!0;break t}tt=tt.return}if(an===null)throw Error(a(160));Yn(A,q,b),an=null,ce=!1,A=b.alternate,A!==null&&(A.return=null),b.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)A0(i,e),i=i.sibling}var Ra=null;function A0(e,i){var c=e.alternate,d=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:oa(i,e),ba(e),d&4&&(hi(3,e,e.return),Js(3,e),hi(5,e,e.return));break;case 1:oa(i,e),ba(e),d&512&&(nn||c===null||Pa(c,c.return)),d&64&&Za&&(e=e.updateQueue,e!==null&&(d=e.callbacks,d!==null&&(c=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var b=Ra;if(oa(i,e),ba(e),d&512&&(nn||c===null||Pa(c,c.return)),d&4){var A=c!==null?c.memoizedState:null;if(d=e.memoizedState,c===null)if(d===null)if(e.stateNode===null){t:{d=e.type,c=e.memoizedProps,b=b.ownerDocument||b;e:switch(d){case"title":A=b.getElementsByTagName("title")[0],(!A||A[ki]||A[he]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=b.createElement(d),b.head.insertBefore(A,b.querySelector("head > title"))),ka(A,d,c),A[he]=e,ra(A),d=A;break t;case"link":var q=kv("link","href",b).get(d+(c.href||""));if(q){for(var tt=0;tt<q.length;tt++)if(A=q[tt],A.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&A.getAttribute("rel")===(c.rel==null?null:c.rel)&&A.getAttribute("title")===(c.title==null?null:c.title)&&A.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){q.splice(tt,1);break e}}A=b.createElement(d),ka(A,d,c),b.head.appendChild(A);break;case"meta":if(q=kv("meta","content",b).get(d+(c.content||""))){for(tt=0;tt<q.length;tt++)if(A=q[tt],A.getAttribute("content")===(c.content==null?null:""+c.content)&&A.getAttribute("name")===(c.name==null?null:c.name)&&A.getAttribute("property")===(c.property==null?null:c.property)&&A.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&A.getAttribute("charset")===(c.charSet==null?null:c.charSet)){q.splice(tt,1);break e}}A=b.createElement(d),ka(A,d,c),b.head.appendChild(A);break;default:throw Error(a(468,d))}A[he]=e,ra(A),d=A}e.stateNode=d}else qv(b,e.type,e.stateNode);else e.stateNode=Iv(b,d,e.memoizedProps);else A!==d?(A===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):A.count--,d===null?qv(b,e.type,e.stateNode):Iv(b,d,e.memoizedProps)):d===null&&e.stateNode!==null&&jr(e,e.memoizedProps,c.memoizedProps)}break;case 27:oa(i,e),ba(e),d&512&&(nn||c===null||Pa(c,c.return)),c!==null&&d&4&&jr(e,e.memoizedProps,c.memoizedProps);break;case 5:if(oa(i,e),ba(e),d&512&&(nn||c===null||Pa(c,c.return)),e.flags&32){b=e.stateNode;try{Kr(b,"")}catch(ne){Qt(e,e.return,ne)}}d&4&&e.stateNode!=null&&(b=e.memoizedProps,jr(e,b,c!==null?c.memoizedProps:b)),d&1024&&(ds=!0);break;case 6:if(oa(i,e),ba(e),d&4){if(e.stateNode===null)throw Error(a(162));d=e.memoizedProps,c=e.stateNode;try{c.nodeValue=d}catch(ne){Qt(e,e.return,ne)}}break;case 3:if(j0=null,b=Ra,Ra=N0(i.containerInfo),oa(i,e),Ra=b,ba(e),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Xc(i.containerInfo)}catch(ne){Qt(e,e.return,ne)}ds&&(ds=!1,Uh(e));break;case 4:d=Ra,Ra=N0(e.stateNode.containerInfo),oa(i,e),ba(e),Ra=d;break;case 12:oa(i,e),ba(e);break;case 31:oa(i,e),ba(e),d&4&&(d=e.updateQueue,d!==null&&(e.updateQueue=null,nl(e,d)));break;case 13:oa(i,e),ba(e),e.child.flags&8192&&e.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Br=Se()),d&4&&(d=e.updateQueue,d!==null&&(e.updateQueue=null,nl(e,d)));break;case 22:b=e.memoizedState!==null;var ot=c!==null&&c.memoizedState!==null,St=Za,Ot=nn;if(Za=St||b,nn=Ot||ot,oa(i,e),nn=Ot,Za=St,ba(e),d&8192)t:for(i=e.stateNode,i._visibility=b?i._visibility&-2:i._visibility|1,b&&(c===null||ot||Za||nn||al(e)),c=null,i=e;;){if(i.tag===5||i.tag===26){if(c===null){ot=c=i;try{if(A=ot.stateNode,b)q=A.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{tt=ot.stateNode;var Nt=ot.memoizedProps.style,Et=Nt!=null&&Nt.hasOwnProperty("display")?Nt.display:null;tt.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(ne){Qt(ot,ot.return,ne)}}}else if(i.tag===6){if(c===null){ot=i;try{ot.stateNode.nodeValue=b?"":ot.memoizedProps}catch(ne){Qt(ot,ot.return,ne)}}}else if(i.tag===18){if(c===null){ot=i;try{var Tt=ot.stateNode;b?Dv(Tt,!0):Dv(ot.stateNode,!1)}catch(ne){Qt(ot,ot.return,ne)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break t;for(;i.sibling===null;){if(i.return===null||i.return===e)break t;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=e.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,nl(e,c))));break;case 19:oa(i,e),ba(e),d&4&&(d=e.updateQueue,d!==null&&(e.updateQueue=null,nl(e,d)));break;case 30:break;case 21:break;default:oa(i,e),ba(e)}}function ba(e){var i=e.flags;if(i&2){try{for(var c,d=e.return;d!==null;){if(T0(d)){c=d;break}d=d.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var b=c.stateNode,A=Zs(e);Ws(e,A,b);break;case 5:var q=c.stateNode;c.flags&32&&(Kr(q,""),c.flags&=-33);var tt=Zs(e);Ws(e,tt,q);break;case 3:case 4:var ot=c.stateNode.containerInfo,St=Zs(e);iu(e,St,ot);break;default:throw Error(a(161))}}catch(Ot){Qt(e,e.return,Ot)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function Uh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var i=e;Uh(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),e=e.sibling}}function sr(e,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)$s(e,i.alternate,i),i=i.sibling}function al(e){for(e=e.child;e!==null;){var i=e;switch(i.tag){case 0:case 11:case 14:case 15:hi(4,i,i.return),al(i);break;case 1:Pa(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&zc(i,i.return,c),al(i);break;case 27:Ph(i.stateNode);case 26:case 5:Pa(i,i.return),al(i);break;case 22:i.memoizedState===null&&al(i);break;case 30:al(i);break;default:al(i)}e=e.sibling}}function Wa(e,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,b=e,A=i,q=A.flags;switch(A.tag){case 0:case 11:case 15:Wa(b,A,c),Js(4,A);break;case 1:if(Wa(b,A,c),d=A,b=d.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(St){Qt(d,d.return,St)}if(d=A,b=d.updateQueue,b!==null){var tt=d.stateNode;try{var ot=b.shared.hiddenCallbacks;if(ot!==null)for(b.shared.hiddenCallbacks=null,b=0;b<ot.length;b++)sh(ot[b],tt)}catch(St){Qt(d,d.return,St)}}c&&q&64&&Kl(A),rr(A,A.return);break;case 27:ru(A);case 26:case 5:Wa(b,A,c),c&&d===null&&q&4&&Dh(A),rr(A,A.return);break;case 12:Wa(b,A,c);break;case 31:Wa(b,A,c),c&&q&4&&lu(b,A);break;case 13:Wa(b,A,c),c&&q&4&&tl(b,A);break;case 22:A.memoizedState===null&&Wa(b,A,c),rr(A,A.return);break;case 30:break;default:Wa(b,A,c)}i=i.sibling}}function il(e,i){var c=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),e=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(e=i.memoizedState.cachePool.pool),e!==c&&(e!=null&&e.refCount++,c!=null&&zl(c))}function gs(e,i){e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&zl(e))}function Ci(e,i,c,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)di(e,i,c,d),i=i.sibling}function di(e,i,c,d){var b=i.flags;switch(i.tag){case 0:case 11:case 15:Ci(e,i,c,d),b&2048&&Js(9,i);break;case 1:Ci(e,i,c,d);break;case 3:Ci(e,i,c,d),b&2048&&(e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&zl(e)));break;case 12:if(b&2048){Ci(e,i,c,d),e=i.stateNode;try{var A=i.memoizedProps,q=A.id,tt=A.onPostCommit;typeof tt=="function"&&tt(q,i.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(ot){Qt(i,i.return,ot)}}else Ci(e,i,c,d);break;case 31:Ci(e,i,c,d);break;case 13:Ci(e,i,c,d);break;case 23:break;case 22:A=i.stateNode,q=i.alternate,i.memoizedState!==null?A._visibility&2?Ci(e,i,c,d):Ln(e,i):A._visibility&2?Ci(e,i,c,d):(A._visibility|=2,Ha(e,i,c,d,(i.subtreeFlags&10256)!==0||!1)),b&2048&&il(q,i);break;case 24:Ci(e,i,c,d),b&2048&&gs(i.alternate,i);break;default:Ci(e,i,c,d)}}function Ha(e,i,c,d,b){for(b=b&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var A=e,q=i,tt=c,ot=d,St=q.flags;switch(q.tag){case 0:case 11:case 15:Ha(A,q,tt,ot,b),Js(8,q);break;case 23:break;case 22:var Ot=q.stateNode;q.memoizedState!==null?Ot._visibility&2?Ha(A,q,tt,ot,b):Ln(A,q):(Ot._visibility|=2,Ha(A,q,tt,ot,b)),b&&St&2048&&il(q.alternate,q);break;case 24:Ha(A,q,tt,ot,b),b&&St&2048&&gs(q.alternate,q);break;default:Ha(A,q,tt,ot,b)}i=i.sibling}}function Ln(e,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=e,d=i,b=d.flags;switch(d.tag){case 22:Ln(c,d),b&2048&&il(d.alternate,d);break;case 24:Ln(c,d),b&2048&&gs(d.alternate,d);break;default:Ln(c,d)}i=i.sibling}}var rl=8192;function sl(e,i,c){if(e.subtreeFlags&rl)for(e=e.child;e!==null;)Bh(e,i,c),e=e.sibling}function Bh(e,i,c){switch(e.tag){case 26:sl(e,i,c),e.flags&rl&&e.memoizedState!==null&&e4(c,Ra,e.memoizedState,e.memoizedProps);break;case 5:sl(e,i,c);break;case 3:case 4:var d=Ra;Ra=N0(e.stateNode.containerInfo),sl(e,i,c),Ra=d;break;case 22:e.memoizedState===null&&(d=e.alternate,d!==null&&d.memoizedState!==null?(d=rl,rl=16777216,sl(e,i,c),rl=d):sl(e,i,c));break;default:sl(e,i,c)}}function aa(e){var i=e.alternate;if(i!==null&&(e=i.child,e!==null)){i.child=null;do i=e.sibling,e.sibling=null,e=i;while(e!==null)}}function ll(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];Tn=d,Gc(d,e)}aa(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)lr(e),e=e.sibling}function lr(e){switch(e.tag){case 0:case 11:case 15:ll(e),e.flags&2048&&hi(9,e,e.return);break;case 3:ll(e);break;case 12:ll(e);break;case 22:var i=e.stateNode;e.memoizedState!==null&&i._visibility&2&&(e.return===null||e.return.tag!==13)?(i._visibility&=-3,Mn(e)):ll(e);break;default:ll(e)}}function Mn(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];Tn=d,Gc(d,e)}aa(e)}for(e=e.child;e!==null;){switch(i=e,i.tag){case 0:case 11:case 15:hi(8,i,i.return),Mn(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,Mn(i));break;default:Mn(i)}e=e.sibling}}function Gc(e,i){for(;Tn!==null;){var c=Tn;switch(c.tag){case 0:case 11:case 15:hi(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:zl(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,Tn=d;else t:for(c=e;Tn!==null;){d=Tn;var b=d.sibling,A=d.return;if(su(d),d===c){Tn=null;break t}if(b!==null){b.return=A,Tn=b;break t}Tn=A}}}var w0={getCacheForType:function(e){var i=Cn(Jn),c=i.data.get(e);return c===void 0&&(c=e(),i.data.set(e,c)),c},cacheSignal:function(){return Cn(Jn).controller.signal}},ua=typeof WeakMap=="function"?WeakMap:Map,de=0,Be=null,be=null,De=0,cn=0,Oa=null,zi=!1,Ur=!1,Ql=!1,Ti=0,yn=0,ps=0,je=0,gn=0,me=0,Le=0,Je=null,Sn=null,or=!1,Br=0,Pc=0,Ai=1/0,An=null,Ia=null,wn=0,ur=null,_a=null,$a=0,ol=0,xa=null,Hc=null,ul=0,cl=null;function Ma(){return(de&2)!==0&&De!==0?De&-De:j.T!==null?Kg():Ee()}function zr(){if(me===0)if((De&536870912)===0||qe){var e=_e;_e<<=1,(_e&3932160)===0&&(_e=262144),me=e}else me=536870912;return e=xn.current,e!==null&&(e.flags|=32),me}function sn(e,i,c){(e===Be&&(cn===2||cn===9)||e.cancelPendingCommit!==null)&&(fr(e,0),cr(e,De,me,!1)),jt(e,c),((de&2)===0||e!==Be)&&(e===Be&&((de&2)===0&&(je|=c),yn===4&&cr(e,De,me,!1)),ys(e))}function Lr(e,i,c){if((de&6)!==0)throw Error(a(327));var d=!c&&(i&127)===0&&(i&e.expiredLanes)===0||pi(e,i),b=d?et(e,i):x(e,i,!0),A=d;do{if(b===0){Ur&&!d&&cr(e,i,0,!1);break}else{if(c=e.current.alternate,A&&!Xl(c)){b=x(e,i,!1),A=!1;continue}if(b===2){if(A=i,e.errorRecoveryDisabledLanes&A)var q=0;else q=e.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){i=q;t:{var tt=e;b=Je;var ot=tt.current.memoizedState.isDehydrated;if(ot&&(fr(tt,q).flags|=256),q=x(tt,q,!1),q!==2){if(Ql&&!ot){tt.errorRecoveryDisabledLanes|=A,je|=A,b=4;break t}A=Sn,Sn=b,A!==null&&(Sn===null?Sn=A:Sn.push.apply(Sn,A))}b=q}if(A=!1,b!==2)continue}}if(b===1){fr(e,0),cr(e,i,0,!0);break}t:{switch(d=e,A=b,A){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:cr(d,i,me,!zi);break t;case 2:Sn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(b=Br+300-Se(),10<b)){if(cr(d,i,me,!zi),Aa(d,0,!0)!==0)break t;$a=i,d.timeoutHandle=xv(fl.bind(null,d,c,Sn,An,or,i,me,je,Le,zi,A,"Throttled",-0,0),b);break t}fl(d,c,Sn,An,or,i,me,je,Le,zi,A,null,-0,0)}}break}while(!0);ys(e)}function fl(e,i,c,d,b,A,q,tt,ot,St,Ot,Nt,Et,Tt){if(e.timeoutHandle=-1,Nt=i.subtreeFlags,Nt&8192||(Nt&16785408)===16785408){Nt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Va},Bh(i,A,Nt);var ne=(A&62914560)===A?Br-Se():(A&4194048)===A?Pc-Se():0;if(ne=n4(Nt,ne),ne!==null){$a=A,e.cancelPendingCommit=ne(Oe.bind(null,e,i,A,c,d,b,q,tt,ot,Ot,Nt,null,Et,Tt)),cr(e,A,q,!St);return}}Oe(e,i,A,c,d,b,q,tt,ot)}function Xl(e){for(var i=e;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var b=c[d],A=b.getSnapshot;b=b.value;try{if(!da(A(),b))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function cr(e,i,c,d){i&=~gn,i&=~je,e.suspendedLanes|=i,e.pingedLanes&=~i,d&&(e.warmLanes|=i),d=e.expirationTimes;for(var b=i;0<b;){var A=31-Jt(b),q=1<<A;d[A]=-1,b&=~q}c!==0&&ae(e,c,i)}function Fl(){return(de&6)===0?(zh(0),!1):!0}function Ic(){if(be!==null){if(cn===0)var e=be.return;else e=be,Di=Ye=null,ch(e),is=null,Yo=0,e=be;for(;e!==null;)au(e.alternate,e),e=e.return;be=null}}function fr(e,i){var c=e.timeoutHandle;c!==-1&&(e.timeoutHandle=-1,Gb(c)),c=e.cancelPendingCommit,c!==null&&(e.cancelPendingCommit=null,c()),$a=0,Ic(),Be=e,be=c=Oi(e.current,null),De=i,cn=0,Oa=null,zi=!1,Ur=pi(e,i),Ql=!1,Le=me=gn=je=ps=yn=0,Sn=Je=null,or=!1,(i&8)!==0&&(i|=i&32);var d=e.entangledLanes;if(d!==0)for(e=e.entanglements,d&=i;0<d;){var b=31-Jt(d),A=1<<b;i|=e[b],d&=~A}return Ti=i,Lo(),c}function kc(e,i){Re=null,j.H=kl,i===Gs||i===dc?(i=pc(),cn=3):i===qo?(i=pc(),cn=4):cn=i===Rh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Oa=i,be===null&&(yn=1,Nc(e,ri(i,e.current)))}function s(){var e=xn.current;return e===null?!0:(De&4194048)===De?_i===null:(De&62914560)===De||(De&536870912)!==0?e===_i:!1}function u(){var e=j.H;return j.H=kl,e===null?kl:e}function p(){var e=j.A;return j.A=w0,e}function S(){yn=4,zi||(De&4194048)!==De&&xn.current!==null||(Ur=!0),(ps&134217727)===0&&(je&134217727)===0||Be===null||cr(Be,De,me,!1)}function x(e,i,c){var d=de;de|=2;var b=u(),A=p();(Be!==e||De!==i)&&(An=null,fr(e,i)),i=!1;var q=yn;t:do try{if(cn!==0&&be!==null){var tt=be,ot=Oa;switch(cn){case 8:Ic(),q=6;break t;case 3:case 2:case 9:case 6:xn.current===null&&(i=!0);var St=cn;if(cn=0,Oa=null,Pt(e,tt,ot,St),c&&Ur){q=0;break t}break;default:St=cn,cn=0,Oa=null,Pt(e,tt,ot,St)}}H(),q=yn;break}catch(Ot){kc(e,Ot)}while(!0);return i&&e.shellSuspendCounter++,Di=Ye=null,de=d,j.H=b,j.A=A,be===null&&(Be=null,De=0,Lo()),q}function H(){for(;be!==null;)_t(be)}function et(e,i){var c=de;de|=2;var d=u(),b=p();Be!==e||De!==i?(An=null,Ai=Se()+500,fr(e,i)):Ur=pi(e,i);t:do try{if(cn!==0&&be!==null){i=be;var A=Oa;e:switch(cn){case 1:cn=0,Oa=null,Pt(e,i,A,1);break;case 2:case 9:if(Tr(A)){cn=0,Oa=null,Ut(i);break}i=function(){cn!==2&&cn!==9||Be!==e||(cn=7),ys(e)},A.then(i,i);break t;case 3:cn=7;break t;case 4:cn=5;break t;case 7:Tr(A)?(cn=0,Oa=null,Ut(i)):(cn=0,Oa=null,Pt(e,i,A,7));break;case 5:var q=null;switch(be.tag){case 26:q=be.memoizedState;case 5:case 27:var tt=be;if(q?Vv(q):tt.stateNode.complete){cn=0,Oa=null;var ot=tt.sibling;if(ot!==null)be=ot;else{var St=tt.return;St!==null?(be=St,Zt(St)):be=null}break e}}cn=0,Oa=null,Pt(e,i,A,5);break;case 6:cn=0,Oa=null,Pt(e,i,A,6);break;case 8:Ic(),yn=6;break t;default:throw Error(a(462))}}ut();break}catch(Ot){kc(e,Ot)}while(!0);return Di=Ye=null,j.H=d,j.A=b,de=c,be!==null?0:(Be=null,De=0,Lo(),yn)}function ut(){for(;be!==null&&!Yt();)_t(be)}function _t(e){var i=hs(e.alternate,e,Ti);e.memoizedProps=e.pendingProps,i===null?Zt(e):be=i}function Ut(e){var i=e,c=i.alternate;switch(i.tag){case 15:case 0:i=fi(c,i,i.pendingProps,i.type,void 0,De);break;case 11:i=fi(c,i,i.pendingProps,i.type.render,i.ref,De);break;case 5:ch(i);default:au(c,i),i=be=ic(i,Ti),i=hs(c,i,Ti)}e.memoizedProps=e.pendingProps,i===null?Zt(e):be=i}function Pt(e,i,c,d){Di=Ye=null,ch(i),is=null,Yo=0;var b=i.return;try{if(wh(e,b,i,c,De)){yn=1,Nc(e,ri(c,e.current)),be=null;return}}catch(A){if(b!==null)throw be=b,A;yn=1,Nc(e,ri(c,e.current)),be=null;return}i.flags&32768?(qe||d===1?e=!0:Ur||(De&536870912)!==0?e=!1:(zi=e=!0,(d===2||d===9||d===3||d===6)&&(d=xn.current,d!==null&&d.tag===13&&(d.flags|=16384))),$t(i,e)):Zt(i)}function Zt(e){var i=e;do{if((i.flags&32768)!==0){$t(i,zi);return}e=i.return;var c=Yl(i.alternate,i,Ti);if(c!==null){be=c;return}if(i=i.sibling,i!==null){be=i;return}be=i=e}while(i!==null);yn===0&&(yn=5)}function $t(e,i){do{var c=Nh(e.alternate,e);if(c!==null){c.flags&=32767,be=c;return}if(c=e.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(e=e.sibling,e!==null)){be=e;return}be=e=c}while(e!==null);yn=6,be=null}function Oe(e,i,c,d,b,A,q,tt,ot){e.cancelPendingCommit=null;do dt();while(wn!==0);if((de&6)!==0)throw Error(a(327));if(i!==null){if(i===e.current)throw Error(a(177));if(A=i.lanes|i.childLanes,A|=bi,te(e,c,A,q,tt,ot),e===Be&&(be=Be=null,De=0),_a=i,ur=e,$a=c,ol=A,xa=b,Hc=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,vs(ct,function(){return Ct(),null})):(e.callbackNode=null,e.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=j.T,j.T=null,b=I.p,I.p=2,q=de,de|=4;try{jh(e,i,c)}finally{de=q,I.p=b,j.T=d}}wn=1,gi(),Jl(),ms()}}function gi(){if(wn===1){wn=0;var e=ur,i=_a,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=j.T,j.T=null;var d=I.p;I.p=2;var b=de;de|=4;try{A0(i,e);var A=tp,q=wi(e.containerInfo),tt=A.focusedElem,ot=A.selectionRange;if(q!==tt&&tt&&tt.ownerDocument&&Ol(tt.ownerDocument.documentElement,tt)){if(ot!==null&&tc(tt)){var St=ot.start,Ot=ot.end;if(Ot===void 0&&(Ot=St),"selectionStart"in tt)tt.selectionStart=St,tt.selectionEnd=Math.min(Ot,tt.value.length);else{var Nt=tt.ownerDocument||document,Et=Nt&&Nt.defaultView||window;if(Et.getSelection){var Tt=Et.getSelection(),ne=tt.textContent.length,ve=Math.min(ot.start,ne),_n=ot.end===void 0?ve:Math.min(ot.end,ne);!Tt.extend&&ve>_n&&(q=_n,_n=ve,ve=q);var pt=qf(tt,ve),ft=qf(tt,_n);if(pt&&ft&&(Tt.rangeCount!==1||Tt.anchorNode!==pt.node||Tt.anchorOffset!==pt.offset||Tt.focusNode!==ft.node||Tt.focusOffset!==ft.offset)){var yt=Nt.createRange();yt.setStart(pt.node,pt.offset),Tt.removeAllRanges(),ve>_n?(Tt.addRange(yt),Tt.extend(ft.node,ft.offset)):(yt.setEnd(ft.node,ft.offset),Tt.addRange(yt))}}}}for(Nt=[],Tt=tt;Tt=Tt.parentNode;)Tt.nodeType===1&&Nt.push({element:Tt,left:Tt.scrollLeft,top:Tt.scrollTop});for(typeof tt.focus=="function"&&tt.focus(),tt=0;tt<Nt.length;tt++){var Mt=Nt[tt];Mt.element.scrollLeft=Mt.left,Mt.element.scrollTop=Mt.top}}L0=!!$g,tp=$g=null}finally{de=b,I.p=d,j.T=c}}e.current=i,wn=2}}function Jl(){if(wn===2){wn=0;var e=ur,i=_a,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=j.T,j.T=null;var d=I.p;I.p=2;var b=de;de|=4;try{$s(e,i.alternate,i)}finally{de=b,I.p=d,j.T=c}}wn=3}}function ms(){if(wn===4||wn===3){wn=0,Fe();var e=ur,i=_a,c=$a,d=Hc;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?wn=5:(wn=0,_a=ur=null,bt(e,e.pendingLanes));var b=e.pendingLanes;if(b===0&&(Ia=null),Pn(c),i=i.stateNode,vt&&typeof vt.onCommitFiberRoot=="function")try{vt.onCommitFiberRoot(Lt,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=j.T,b=I.p,I.p=2,j.T=null;try{for(var A=e.onRecoverableError,q=0;q<d.length;q++){var tt=d[q];A(tt.value,{componentStack:tt.stack})}}finally{j.T=i,I.p=b}}($a&3)!==0&&dt(),ys(e),b=e.pendingLanes,(c&261930)!==0&&(b&42)!==0?e===cl?ul++:(ul=0,cl=e):ul=0,zh(0)}}function bt(e,i){(e.pooledCacheLanes&=i)===0&&(i=e.pooledCache,i!=null&&(e.pooledCache=null,zl(i)))}function dt(){return gi(),Jl(),ms(),Ct()}function Ct(){if(wn!==5)return!1;var e=ur,i=ol;ol=0;var c=Pn($a),d=j.T,b=I.p;try{I.p=32>c?32:c,j.T=null,c=xa,xa=null;var A=ur,q=$a;if(wn=0,_a=ur=null,$a=0,(de&6)!==0)throw Error(a(331));var tt=de;if(de|=4,lr(A.current),di(A,A.current,q,c),de=tt,zh(0,!1),vt&&typeof vt.onPostCommitFiberRoot=="function")try{vt.onPostCommitFiberRoot(Lt,A)}catch{}return!0}finally{I.p=b,j.T=d,bt(e,i)}}function Ht(e,i,c){i=ri(c,i),i=ci(e.stateNode,i,2),e=ss(e,i,2),e!==null&&(jt(e,2),ys(e))}function Qt(e,i,c){if(e.tag===3)Ht(e,e,c);else for(;i!==null;){if(i.tag===3){Ht(i,e,c);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ia===null||!Ia.has(d))){e=ri(c,e),c=Ah(2),d=ss(i,c,2),d!==null&&(E0(c,d,i,e),jt(d,2),ys(d));break}}i=i.return}}function pn(e,i,c){var d=e.pingCache;if(d===null){d=e.pingCache=new ua;var b=new Set;d.set(i,b)}else b=d.get(i),b===void 0&&(b=new Set,d.set(i,b));b.has(c)||(Ql=!0,b.add(c),e=ye.bind(null,e,i,c),i.then(e,e))}function ye(e,i,c){var d=e.pingCache;d!==null&&d.delete(i),e.pingedLanes|=e.suspendedLanes&c,e.warmLanes&=~c,Be===e&&(De&c)===c&&(yn===4||yn===3&&(De&62914560)===De&&300>Se()-Br?(de&2)===0&&fr(e,0):gn|=c,Le===De&&(Le=0)),ys(e)}function Ze(e,i){i===0&&(i=_s()),e=ii(e,i),e!==null&&(jt(e,i),ys(e))}function ca(e){var i=e.memoizedState,c=0;i!==null&&(c=i.retryLane),Ze(e,c)}function en(e,i){var c=0;switch(e.tag){case 31:case 13:var d=e.stateNode,b=e.memoizedState;b!==null&&(c=b.retryLane);break;case 19:d=e.stateNode;break;case 22:d=e.stateNode._retryCache;break;default:throw Error(a(314))}d!==null&&d.delete(i),Ze(e,c)}function vs(e,i){return Un(e,i)}var qc=null,Vc=null,Vg=!1,R0=!1,Yg=!1,Zl=0;function ys(e){e!==Vc&&e.next===null&&(Vc===null?qc=Vc=e:Vc=Vc.next=e),R0=!0,Vg||(Vg=!0,Rb())}function zh(e,i){if(!Yg&&R0){Yg=!0;do for(var c=!1,d=qc;d!==null;){if(e!==0){var b=d.pendingLanes;if(b===0)var A=0;else{var q=d.suspendedLanes,tt=d.pingedLanes;A=(1<<31-Jt(42|e)+1)-1,A&=b&~(q&~tt),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(c=!0,yv(d,A))}else A=De,A=Aa(d,d===Be?A:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(A&3)===0||pi(d,A)||(c=!0,yv(d,A));d=d.next}while(c);Yg=!1}}function wb(){pv()}function pv(){R0=Vg=!1;var e=0;Zl!==0&&Lb()&&(e=Zl);for(var i=Se(),c=null,d=qc;d!==null;){var b=d.next,A=mv(d,i);A===0?(d.next=null,c===null?qc=b:c.next=b,b===null&&(Vc=c)):(c=d,(e!==0||(A&3)!==0)&&(R0=!0)),d=b}wn!==0&&wn!==5||zh(e),Zl!==0&&(Zl=0)}function mv(e,i){for(var c=e.suspendedLanes,d=e.pingedLanes,b=e.expirationTimes,A=e.pendingLanes&-62914561;0<A;){var q=31-Jt(A),tt=1<<q,ot=b[q];ot===-1?((tt&c)===0||(tt&d)!==0)&&(b[q]=Na(tt,i)):ot<=i&&(e.expiredLanes|=tt),A&=~tt}if(i=Be,c=De,c=Aa(e,e===i?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),d=e.callbackNode,c===0||e===i&&(cn===2||cn===9)||e.cancelPendingCommit!==null)return d!==null&&d!==null&&wt(d),e.callbackNode=null,e.callbackPriority=0;if((c&3)===0||pi(e,c)){if(i=c&-c,i===e.callbackPriority)return i;switch(d!==null&&wt(d),Pn(c)){case 2:case 8:c=Ae;break;case 32:c=ct;break;case 268435456:c=xt;break;default:c=ct}return d=vv.bind(null,e),c=Un(c,d),e.callbackPriority=i,e.callbackNode=c,i}return d!==null&&d!==null&&wt(d),e.callbackPriority=2,e.callbackNode=null,2}function vv(e,i){if(wn!==0&&wn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var c=e.callbackNode;if(dt()&&e.callbackNode!==c)return null;var d=De;return d=Aa(e,e===Be?d:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),d===0?null:(Lr(e,d,i),mv(e,Se()),e.callbackNode!=null&&e.callbackNode===c?vv.bind(null,e):null)}function yv(e,i){if(dt())return null;Lr(e,i,!0)}function Rb(){Pb(function(){(de&6)!==0?Un($e,wb):pv()})}function Kg(){if(Zl===0){var e=Bs;e===0&&(e=fe,fe<<=1,(fe&261888)===0&&(fe=256)),Zl=e}return Zl}function Sv(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Eo(""+e)}function bv(e,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,e.id&&c.setAttribute("form",e.id),i.parentNode.insertBefore(c,i),e=new FormData(e),c.parentNode.removeChild(c),e}function Ob(e,i,c,d,b){if(i==="submit"&&c&&c.stateNode===b){var A=Sv((b[Ne]||null).action),q=d.submitter;q&&(i=(i=q[Ne]||null)?Sv(i.formAction):q.getAttribute("formAction"),i!==null&&(A=i,q=null));var tt=new Iu("action","action",null,d,b);e.push({event:tt,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Zl!==0){var ot=q?bv(b,q):new FormData(b);Oc(c,{pending:!0,data:ot,method:b.method,action:A},null,ot)}}else typeof A=="function"&&(tt.preventDefault(),ot=q?bv(b,q):new FormData(b),Oc(c,{pending:!0,data:ot,method:b.method,action:A},A,ot))},currentTarget:b}]})}}for(var Qg=0;Qg<Ki.length;Qg++){var Xg=Ki[Qg],xb=Xg.toLowerCase(),Mb=Xg[0].toUpperCase()+Xg.slice(1);pa(xb,"on"+Mb)}pa(nc,"onAnimationEnd"),pa(Qf,"onAnimationIteration"),pa(Hd,"onAnimationStart"),pa("dblclick","onDoubleClick"),pa("focusin","onFocus"),pa("focusout","onBlur"),pa(Xf,"onTransitionRun"),pa(ja,"onTransitionStart"),pa(Id,"onTransitionCancel"),pa(Ua,"onTransitionEnd"),ea("onMouseEnter",["mouseout","mouseover"]),ea("onMouseLeave",["mouseout","mouseover"]),ea("onPointerEnter",["pointerout","pointerover"]),ea("onPointerLeave",["pointerout","pointerover"]),pr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),pr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),pr("onBeforeInput",["compositionend","keypress","textInput","paste"]),pr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),pr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),pr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lh));function _v(e,i){i=(i&4)!==0;for(var c=0;c<e.length;c++){var d=e[c],b=d.event;d=d.listeners;t:{var A=void 0;if(i)for(var q=d.length-1;0<=q;q--){var tt=d[q],ot=tt.instance,St=tt.currentTarget;if(tt=tt.listener,ot!==A&&b.isPropagationStopped())break t;A=tt,b.currentTarget=St;try{A(b)}catch(Ot){Ri(Ot)}b.currentTarget=null,A=ot}else for(q=0;q<d.length;q++){if(tt=d[q],ot=tt.instance,St=tt.currentTarget,tt=tt.listener,ot!==A&&b.isPropagationStopped())break t;A=tt,b.currentTarget=St;try{A(b)}catch(Ot){Ri(Ot)}b.currentTarget=null,A=ot}}}}function Ke(e,i){var c=i[rn];c===void 0&&(c=i[rn]=new Set);var d=e+"__bubble";c.has(d)||(Ev(i,e,2,!1),c.add(d))}function Fg(e,i,c){var d=0;i&&(d|=4),Ev(c,e,d,i)}var O0="_reactListening"+Math.random().toString(36).slice(2);function Jg(e){if(!e[O0]){e[O0]=!0,xu.forEach(function(c){c!=="selectionchange"&&(Nb.has(c)||Fg(c,!1,e),Fg(c,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[O0]||(i[O0]=!0,Fg("selectionchange",!1,i))}}function Ev(e,i,c,d){switch(Zv(i)){case 2:var b=r4;break;case 8:b=s4;break;default:b=fp}c=b.bind(null,i,c,e),b=void 0,!Gu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(b=!0),d?b!==void 0?e.addEventListener(i,c,{capture:!0,passive:b}):e.addEventListener(i,c,!0):b!==void 0?e.addEventListener(i,c,{passive:b}):e.addEventListener(i,c,!1)}function Zg(e,i,c,d,b){var A=d;if((i&1)===0&&(i&2)===0&&d!==null)t:for(;;){if(d===null)return;var q=d.tag;if(q===3||q===4){var tt=d.stateNode.containerInfo;if(tt===b)break;if(q===4)for(q=d.return;q!==null;){var ot=q.tag;if((ot===3||ot===4)&&q.stateNode.containerInfo===b)return;q=q.return}for(;tt!==null;){if(q=Vr(tt),q===null)return;if(ot=q.tag,ot===5||ot===6||ot===26||ot===27){d=A=q;continue t}tt=tt.parentNode}}d=d.return}Nf(function(){var St=A,Ot=zu(c),Nt=[];t:{var Et=Ff.get(e);if(Et!==void 0){var Tt=Iu,ne=e;switch(e){case"keypress":if(Co(c)===0)break t;case"keydown":case"keyup":Tt=Bf;break;case"focusin":ne="focus",Tt=Vu;break;case"focusout":ne="blur",Tt=Vu;break;case"beforeblur":case"afterblur":Tt=Vu;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Tt=jf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Tt=Oo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Tt=ha;break;case nc:case Qf:case Hd:Tt=Fr;break;case Ua:Tt=Dd;break;case"scroll":case"scrollend":Tt=Td;break;case"wheel":Tt=Ud;break;case"copy":case"cut":case"paste":Tt=Jr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Tt=zf;break;case"toggle":case"beforetoggle":Tt=Yu}var ve=(i&4)!==0,_n=!ve&&(e==="scroll"||e==="scrollend"),pt=ve?Et!==null?Et+"Capture":null:Et;ve=[];for(var ft=St,yt;ft!==null;){var Mt=ft;if(yt=Mt.stateNode,Mt=Mt.tag,Mt!==5&&Mt!==26&&Mt!==27||yt===null||pt===null||(Mt=Cl(ft,pt),Mt!=null&&ve.push(Gh(ft,Mt,yt))),_n)break;ft=ft.return}0<ve.length&&(Et=new Tt(Et,ne,null,c,Ot),Nt.push({event:Et,listeners:ve}))}}if((i&7)===0){t:{if(Et=e==="mouseover"||e==="pointerover",Tt=e==="mouseout"||e==="pointerout",Et&&c!==El&&(ne=c.relatedTarget||c.fromElement)&&(Vr(ne)||ne[Ue]))break t;if((Tt||Et)&&(Et=Ot.window===Ot?Ot:(Et=Ot.ownerDocument)?Et.defaultView||Et.parentWindow:window,Tt?(ne=c.relatedTarget||c.toElement,Tt=St,ne=ne?Vr(ne):null,ne!==null&&(_n=o(ne),ve=ne.tag,ne!==_n||ve!==5&&ve!==27&&ve!==6)&&(ne=null)):(Tt=null,ne=St),Tt!==ne)){if(ve=jf,Mt="onMouseLeave",pt="onMouseEnter",ft="mouse",(e==="pointerout"||e==="pointerover")&&(ve=zf,Mt="onPointerLeave",pt="onPointerEnter",ft="pointer"),_n=Tt==null?Et:Sl(Tt),yt=ne==null?Et:Sl(ne),Et=new ve(Mt,ft+"leave",Tt,c,Ot),Et.target=_n,Et.relatedTarget=yt,Mt=null,Vr(Ot)===St&&(ve=new ve(pt,ft+"enter",ne,c,Ot),ve.target=yt,ve.relatedTarget=_n,Mt=ve),_n=Mt,Tt&&ne)e:{for(ve=Db,pt=Tt,ft=ne,yt=0,Mt=pt;Mt;Mt=ve(Mt))yt++;Mt=0;for(var oe=ft;oe;oe=ve(oe))Mt++;for(;0<yt-Mt;)pt=ve(pt),yt--;for(;0<Mt-yt;)ft=ve(ft),Mt--;for(;yt--;){if(pt===ft||ft!==null&&pt===ft.alternate){ve=pt;break e}pt=ve(pt),ft=ve(ft)}ve=null}else ve=null;Tt!==null&&Cv(Nt,Et,Tt,ve,!1),ne!==null&&_n!==null&&Cv(Nt,_n,ne,ve,!0)}}t:{if(Et=St?Sl(St):window,Tt=Et.nodeName&&Et.nodeName.toLowerCase(),Tt==="select"||Tt==="input"&&Et.type==="file")var ln=Zu;else if(Yi(Et))if(Hf)ln=Lg;else{ln=zn;var ie=Bo}else Tt=Et.nodeName,!Tt||Tt.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?St&&Bu(St.elementType)&&(ln=Zu):ln=zg;if(ln&&(ln=ln(e,St))){Ju(Nt,ln,c,Ot);break t}ie&&ie(e,Et,St),e==="focusout"&&St&&Et.type==="number"&&St.memoizedProps.value!=null&&Af(Et,"number",Et.value)}switch(ie=St?Sl(St):window,e){case"focusin":(Yi(ie)||ie.contentEditable==="true")&&(Os=ie,zo=St,xs=null);break;case"focusout":xs=zo=Os=null;break;case"mousedown":xl=!0;break;case"contextmenu":case"mouseup":case"dragend":xl=!1,Yf(Nt,c,Ot);break;case"selectionchange":if(Vf)break;case"keydown":case"keyup":Yf(Nt,c,Ot)}var Ge;if(Ku)t:{switch(e){case"compositionstart":var Qe="onCompositionStart";break t;case"compositionend":Qe="onCompositionEnd";break t;case"compositionupdate":Qe="onCompositionUpdate";break t}Qe=void 0}else Zr?Fu(e,c)&&(Qe="onCompositionEnd"):e==="keydown"&&c.keyCode===229&&(Qe="onCompositionStart");Qe&&(Qu&&c.locale!=="ko"&&(Zr||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&Zr&&(Ge=Df()):(vr=Ot,Pu="value"in vr?vr.value:vr.textContent,Zr=!0)),ie=x0(St,Qe),0<ie.length&&(Qe=new xo(Qe,e,null,c,Ot),Nt.push({event:Qe,listeners:ie}),Ge?Qe.data=Ge:(Ge=Mo(c),Ge!==null&&(Qe.data=Ge)))),(Ge=zd?Ld(e,c):Pf(e,c))&&(Qe=x0(St,"onBeforeInput"),0<Qe.length&&(ie=new xo("onBeforeInput","beforeinput",null,c,Ot),Nt.push({event:ie,listeners:Qe}),ie.data=Ge)),Ob(Nt,e,St,c,Ot)}_v(Nt,i)})}function Gh(e,i,c){return{instance:e,listener:i,currentTarget:c}}function x0(e,i){for(var c=i+"Capture",d=[];e!==null;){var b=e,A=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||A===null||(b=Cl(e,c),b!=null&&d.unshift(Gh(e,b,A)),b=Cl(e,i),b!=null&&d.push(Gh(e,b,A))),e.tag===3)return d;e=e.return}return[]}function Db(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Cv(e,i,c,d,b){for(var A=i._reactName,q=[];c!==null&&c!==d;){var tt=c,ot=tt.alternate,St=tt.stateNode;if(tt=tt.tag,ot!==null&&ot===d)break;tt!==5&&tt!==26&&tt!==27||St===null||(ot=St,b?(St=Cl(c,A),St!=null&&q.unshift(Gh(c,St,ot))):b||(St=Cl(c,A),St!=null&&q.push(Gh(c,St,ot)))),c=c.return}q.length!==0&&e.push({event:i,listeners:q})}var jb=/\r\n?/g,Ub=/\u0000|\uFFFD/g;function Tv(e){return(typeof e=="string"?e:""+e).replace(jb,`
`).replace(Ub,"")}function Av(e,i){return i=Tv(i),Tv(e)===i}function bn(e,i,c,d,b,A){switch(c){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||Kr(e,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&Kr(e,""+d);break;case"className":vi(e,"class",d);break;case"tabIndex":vi(e,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":vi(e,c,d);break;case"style":xf(e,d,A);break;case"data":if(i!=="object"){vi(e,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||c!=="href")){e.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){e.removeAttribute(c);break}d=Eo(""+d),e.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){e.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(c==="formAction"?(i!=="input"&&bn(e,i,"name",b.name,b,null),bn(e,i,"formEncType",b.formEncType,b,null),bn(e,i,"formMethod",b.formMethod,b,null),bn(e,i,"formTarget",b.formTarget,b,null)):(bn(e,i,"encType",b.encType,b,null),bn(e,i,"method",b.method,b,null),bn(e,i,"target",b.target,b,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){e.removeAttribute(c);break}d=Eo(""+d),e.setAttribute(c,d);break;case"onClick":d!=null&&(e.onclick=Va);break;case"onScroll":d!=null&&Ke("scroll",e);break;case"onScrollEnd":d!=null&&Ke("scrollend",e);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(c=d.__html,c!=null){if(b.children!=null)throw Error(a(60));e.innerHTML=c}}break;case"multiple":e.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":e.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){e.removeAttribute("xlink:href");break}c=Eo(""+d),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?e.setAttribute(c,""+d):e.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?e.setAttribute(c,""):e.removeAttribute(c);break;case"capture":case"download":d===!0?e.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?e.setAttribute(c,d):e.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?e.setAttribute(c,d):e.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?e.removeAttribute(c):e.setAttribute(c,d);break;case"popover":Ke("beforetoggle",e),Ke("toggle",e),_l(e,"popover",d);break;case"xlinkActuate":yi(e,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":yi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":yi(e,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":yi(e,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":yi(e,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":yi(e,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":yi(e,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":yi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":yi(e,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":_l(e,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Cd.get(c)||c,_l(e,c,d))}}function Wg(e,i,c,d,b,A){switch(c){case"style":xf(e,d,A);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(c=d.__html,c!=null){if(b.children!=null)throw Error(a(60));e.innerHTML=c}}break;case"children":typeof d=="string"?Kr(e,d):(typeof d=="number"||typeof d=="bigint")&&Kr(e,""+d);break;case"onScroll":d!=null&&Ke("scroll",e);break;case"onScrollEnd":d!=null&&Ke("scrollend",e);break;case"onClick":d!=null&&(e.onclick=Va);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mu.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(b=c.endsWith("Capture"),i=c.slice(2,b?c.length-7:void 0),A=e[Ne]||null,A=A!=null?A[c]:null,typeof A=="function"&&e.removeEventListener(i,A,b),typeof d=="function")){typeof A!="function"&&A!==null&&(c in e?e[c]=null:e.hasAttribute(c)&&e.removeAttribute(c)),e.addEventListener(i,d,b);break t}c in e?e[c]=d:d===!0?e.setAttribute(c,""):_l(e,c,d)}}}function ka(e,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",e),Ke("load",e);var d=!1,b=!1,A;for(A in c)if(c.hasOwnProperty(A)){var q=c[A];if(q!=null)switch(A){case"src":d=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:bn(e,i,A,q,c,null)}}b&&bn(e,i,"srcSet",c.srcSet,c,null),d&&bn(e,i,"src",c.src,c,null);return;case"input":Ke("invalid",e);var tt=A=q=b=null,ot=null,St=null;for(d in c)if(c.hasOwnProperty(d)){var Ot=c[d];if(Ot!=null)switch(d){case"name":b=Ot;break;case"type":q=Ot;break;case"checked":ot=Ot;break;case"defaultChecked":St=Ot;break;case"value":A=Ot;break;case"defaultValue":tt=Ot;break;case"children":case"dangerouslySetInnerHTML":if(Ot!=null)throw Error(a(137,i));break;default:bn(e,i,d,Ot,c,null)}}Tf(e,A,tt,ot,St,q,b,!1);return;case"select":Ke("invalid",e),d=q=A=null;for(b in c)if(c.hasOwnProperty(b)&&(tt=c[b],tt!=null))switch(b){case"value":A=tt;break;case"defaultValue":q=tt;break;case"multiple":d=tt;default:bn(e,i,b,tt,c,null)}i=A,c=q,e.multiple=!!d,i!=null?Ts(e,!!d,i,!1):c!=null&&Ts(e,!!d,c,!0);return;case"textarea":Ke("invalid",e),A=b=d=null;for(q in c)if(c.hasOwnProperty(q)&&(tt=c[q],tt!=null))switch(q){case"value":d=tt;break;case"defaultValue":b=tt;break;case"children":A=tt;break;case"dangerouslySetInnerHTML":if(tt!=null)throw Error(a(91));break;default:bn(e,i,q,tt,c,null)}Rf(e,d,b,A);return;case"option":for(ot in c)if(c.hasOwnProperty(ot)&&(d=c[ot],d!=null))switch(ot){case"selected":e.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:bn(e,i,ot,d,c,null)}return;case"dialog":Ke("beforetoggle",e),Ke("toggle",e),Ke("cancel",e),Ke("close",e);break;case"iframe":case"object":Ke("load",e);break;case"video":case"audio":for(d=0;d<Lh.length;d++)Ke(Lh[d],e);break;case"image":Ke("error",e),Ke("load",e);break;case"details":Ke("toggle",e);break;case"embed":case"source":case"link":Ke("error",e),Ke("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(St in c)if(c.hasOwnProperty(St)&&(d=c[St],d!=null))switch(St){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:bn(e,i,St,d,c,null)}return;default:if(Bu(i)){for(Ot in c)c.hasOwnProperty(Ot)&&(d=c[Ot],d!==void 0&&Wg(e,i,Ot,d,c,void 0));return}}for(tt in c)c.hasOwnProperty(tt)&&(d=c[tt],d!=null&&bn(e,i,tt,d,c,null))}function Bb(e,i,c,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,A=null,q=null,tt=null,ot=null,St=null,Ot=null;for(Tt in c){var Nt=c[Tt];if(c.hasOwnProperty(Tt)&&Nt!=null)switch(Tt){case"checked":break;case"value":break;case"defaultValue":ot=Nt;default:d.hasOwnProperty(Tt)||bn(e,i,Tt,null,d,Nt)}}for(var Et in d){var Tt=d[Et];if(Nt=c[Et],d.hasOwnProperty(Et)&&(Tt!=null||Nt!=null))switch(Et){case"type":A=Tt;break;case"name":b=Tt;break;case"checked":St=Tt;break;case"defaultChecked":Ot=Tt;break;case"value":q=Tt;break;case"defaultValue":tt=Tt;break;case"children":case"dangerouslySetInnerHTML":if(Tt!=null)throw Error(a(137,i));break;default:Tt!==Nt&&bn(e,i,Et,Tt,d,Nt)}}_o(e,q,tt,ot,St,Ot,A,b);return;case"select":Tt=q=tt=Et=null;for(A in c)if(ot=c[A],c.hasOwnProperty(A)&&ot!=null)switch(A){case"value":break;case"multiple":Tt=ot;default:d.hasOwnProperty(A)||bn(e,i,A,null,d,ot)}for(b in d)if(A=d[b],ot=c[b],d.hasOwnProperty(b)&&(A!=null||ot!=null))switch(b){case"value":Et=A;break;case"defaultValue":tt=A;break;case"multiple":q=A;default:A!==ot&&bn(e,i,b,A,d,ot)}i=tt,c=q,d=Tt,Et!=null?Ts(e,!!c,Et,!1):!!d!=!!c&&(i!=null?Ts(e,!!c,i,!0):Ts(e,!!c,c?[]:"",!1));return;case"textarea":Tt=Et=null;for(tt in c)if(b=c[tt],c.hasOwnProperty(tt)&&b!=null&&!d.hasOwnProperty(tt))switch(tt){case"value":break;case"children":break;default:bn(e,i,tt,null,d,b)}for(q in d)if(b=d[q],A=c[q],d.hasOwnProperty(q)&&(b!=null||A!=null))switch(q){case"value":Et=b;break;case"defaultValue":Tt=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(a(91));break;default:b!==A&&bn(e,i,q,b,d,A)}wf(e,Et,Tt);return;case"option":for(var ne in c)if(Et=c[ne],c.hasOwnProperty(ne)&&Et!=null&&!d.hasOwnProperty(ne))switch(ne){case"selected":e.selected=!1;break;default:bn(e,i,ne,null,d,Et)}for(ot in d)if(Et=d[ot],Tt=c[ot],d.hasOwnProperty(ot)&&Et!==Tt&&(Et!=null||Tt!=null))switch(ot){case"selected":e.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:bn(e,i,ot,Et,d,Tt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ve in c)Et=c[ve],c.hasOwnProperty(ve)&&Et!=null&&!d.hasOwnProperty(ve)&&bn(e,i,ve,null,d,Et);for(St in d)if(Et=d[St],Tt=c[St],d.hasOwnProperty(St)&&Et!==Tt&&(Et!=null||Tt!=null))switch(St){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(a(137,i));break;default:bn(e,i,St,Et,d,Tt)}return;default:if(Bu(i)){for(var _n in c)Et=c[_n],c.hasOwnProperty(_n)&&Et!==void 0&&!d.hasOwnProperty(_n)&&Wg(e,i,_n,void 0,d,Et);for(Ot in d)Et=d[Ot],Tt=c[Ot],!d.hasOwnProperty(Ot)||Et===Tt||Et===void 0&&Tt===void 0||Wg(e,i,Ot,Et,d,Tt);return}}for(var pt in c)Et=c[pt],c.hasOwnProperty(pt)&&Et!=null&&!d.hasOwnProperty(pt)&&bn(e,i,pt,null,d,Et);for(Nt in d)Et=d[Nt],Tt=c[Nt],!d.hasOwnProperty(Nt)||Et===Tt||Et==null&&Tt==null||bn(e,i,Nt,Et,d,Tt)}function wv(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,i=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var b=c[d],A=b.transferSize,q=b.initiatorType,tt=b.duration;if(A&&tt&&wv(q)){for(q=0,tt=b.responseEnd,d+=1;d<c.length;d++){var ot=c[d],St=ot.startTime;if(St>tt)break;var Ot=ot.transferSize,Nt=ot.initiatorType;Ot&&wv(Nt)&&(ot=ot.responseEnd,q+=Ot*(ot<tt?1:(tt-St)/(ot-St)))}if(--d,i+=8*(A+q)/(b.duration/1e3),e++,10<e)break}}if(0<e)return i/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var $g=null,tp=null;function M0(e){return e.nodeType===9?e:e.ownerDocument}function Rv(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ov(e,i){if(e===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&i==="foreignObject"?0:e}function ep(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var np=null;function Lb(){var e=window.event;return e&&e.type==="popstate"?e===np?!1:(np=e,!0):(np=null,!1)}var xv=typeof setTimeout=="function"?setTimeout:void 0,Gb=typeof clearTimeout=="function"?clearTimeout:void 0,Mv=typeof Promise=="function"?Promise:void 0,Pb=typeof queueMicrotask=="function"?queueMicrotask:typeof Mv<"u"?function(e){return Mv.resolve(null).then(e).catch(Hb)}:xv;function Hb(e){setTimeout(function(){throw e})}function Wl(e){return e==="head"}function Nv(e,i){var c=i,d=0;do{var b=c.nextSibling;if(e.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"||c==="/&"){if(d===0){e.removeChild(b),Xc(i);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")Ph(e.ownerDocument.documentElement);else if(c==="head"){c=e.ownerDocument.head,Ph(c);for(var A=c.firstChild;A;){var q=A.nextSibling,tt=A.nodeName;A[ki]||tt==="SCRIPT"||tt==="STYLE"||tt==="LINK"&&A.rel.toLowerCase()==="stylesheet"||c.removeChild(A),A=q}}else c==="body"&&Ph(e.ownerDocument.body);c=b}while(c);Xc(i)}function Dv(e,i){var c=e;e=0;do{var d=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(e===0)break;e--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||e++;c=d}while(c)}function ap(e){var i=e.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":ap(c),Bn(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}e.removeChild(c)}}function Ib(e,i,c,d){for(;e.nodeType===1;){var b=c;if(e.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(d){if(!e[ki])switch(i){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(A=e.getAttribute("rel"),A==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(A!==b.rel||e.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||e.getAttribute("title")!==(b.title==null?null:b.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(A=e.getAttribute("src"),(A!==(b.src==null?null:b.src)||e.getAttribute("type")!==(b.type==null?null:b.type)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&A&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(i==="input"&&e.type==="hidden"){var A=b.name==null?null:""+b.name;if(b.type==="hidden"&&e.getAttribute("name")===A)return e}else return e;if(e=hr(e.nextSibling),e===null)break}return null}function kb(e,i,c){if(i==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!c||(e=hr(e.nextSibling),e===null))return null;return e}function jv(e,i){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=hr(e.nextSibling),e===null))return null;return e}function ip(e){return e.data==="$?"||e.data==="$~"}function rp(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function qb(e,i){var c=e.ownerDocument;if(e.data==="$~")e._reactRetry=i;else if(e.data!=="$?"||c.readyState!=="loading")i();else{var d=function(){i(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),e._reactRetry=d}}function hr(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return e}var sp=null;function Uv(e){e=e.nextSibling;for(var i=0;e;){if(e.nodeType===8){var c=e.data;if(c==="/$"||c==="/&"){if(i===0)return hr(e.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}e=e.nextSibling}return null}function Bv(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var c=e.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return e;i--}else c!=="/$"&&c!=="/&"||i++}e=e.previousSibling}return null}function zv(e,i,c){switch(i=M0(c),e){case"html":if(e=i.documentElement,!e)throw Error(a(452));return e;case"head":if(e=i.head,!e)throw Error(a(453));return e;case"body":if(e=i.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function Ph(e){for(var i=e.attributes;i.length;)e.removeAttributeNode(i[0]);Bn(e)}var dr=new Map,Lv=new Set;function N0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var hl=I.d;I.d={f:Vb,r:Yb,D:Kb,C:Qb,L:Xb,m:Fb,X:Zb,S:Jb,M:Wb};function Vb(){var e=hl.f(),i=Fl();return e||i}function Yb(e){var i=Yr(e);i!==null&&i.tag===5&&i.type==="form"?m0(i):hl.r(e)}var Yc=typeof document>"u"?null:document;function Gv(e,i,c){var d=Yc;if(d&&typeof i=="string"&&i){var b=ni(i);b='link[rel="'+e+'"][href="'+b+'"]',typeof c=="string"&&(b+='[crossorigin="'+c+'"]'),Lv.has(b)||(Lv.add(b),e={rel:e,crossOrigin:c,href:i},d.querySelector(b)===null&&(i=d.createElement("link"),ka(i,"link",e),ra(i),d.head.appendChild(i)))}}function Kb(e){hl.D(e),Gv("dns-prefetch",e,null)}function Qb(e,i){hl.C(e,i),Gv("preconnect",e,i)}function Xb(e,i,c){hl.L(e,i,c);var d=Yc;if(d&&e&&i){var b='link[rel="preload"][as="'+ni(i)+'"]';i==="image"&&c&&c.imageSrcSet?(b+='[imagesrcset="'+ni(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(b+='[imagesizes="'+ni(c.imageSizes)+'"]')):b+='[href="'+ni(e)+'"]';var A=b;switch(i){case"style":A=Kc(e);break;case"script":A=Qc(e)}dr.has(A)||(e=C({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:e,as:i},c),dr.set(A,e),d.querySelector(b)!==null||i==="style"&&d.querySelector(Hh(A))||i==="script"&&d.querySelector(Ih(A))||(i=d.createElement("link"),ka(i,"link",e),ra(i),d.head.appendChild(i)))}}function Fb(e,i){hl.m(e,i);var c=Yc;if(c&&e){var d=i&&typeof i.as=="string"?i.as:"script",b='link[rel="modulepreload"][as="'+ni(d)+'"][href="'+ni(e)+'"]',A=b;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Qc(e)}if(!dr.has(A)&&(e=C({rel:"modulepreload",href:e},i),dr.set(A,e),c.querySelector(b)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Ih(A)))return}d=c.createElement("link"),ka(d,"link",e),ra(d),c.head.appendChild(d)}}}function Jb(e,i,c){hl.S(e,i,c);var d=Yc;if(d&&e){var b=Cs(d).hoistableStyles,A=Kc(e);i=i||"default";var q=b.get(A);if(!q){var tt={loading:0,preload:null};if(q=d.querySelector(Hh(A)))tt.loading=5;else{e=C({rel:"stylesheet",href:e,"data-precedence":i},c),(c=dr.get(A))&&lp(e,c);var ot=q=d.createElement("link");ra(ot),ka(ot,"link",e),ot._p=new Promise(function(St,Ot){ot.onload=St,ot.onerror=Ot}),ot.addEventListener("load",function(){tt.loading|=1}),ot.addEventListener("error",function(){tt.loading|=2}),tt.loading|=4,D0(q,i,d)}q={type:"stylesheet",instance:q,count:1,state:tt},b.set(A,q)}}}function Zb(e,i){hl.X(e,i);var c=Yc;if(c&&e){var d=Cs(c).hoistableScripts,b=Qc(e),A=d.get(b);A||(A=c.querySelector(Ih(b)),A||(e=C({src:e,async:!0},i),(i=dr.get(b))&&op(e,i),A=c.createElement("script"),ra(A),ka(A,"link",e),c.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},d.set(b,A))}}function Wb(e,i){hl.M(e,i);var c=Yc;if(c&&e){var d=Cs(c).hoistableScripts,b=Qc(e),A=d.get(b);A||(A=c.querySelector(Ih(b)),A||(e=C({src:e,async:!0,type:"module"},i),(i=dr.get(b))&&op(e,i),A=c.createElement("script"),ra(A),ka(A,"link",e),c.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},d.set(b,A))}}function Pv(e,i,c,d){var b=(b=$.current)?N0(b):null;if(!b)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Kc(c.href),c=Cs(b).hoistableStyles,d=c.get(i),d||(d={type:"style",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){e=Kc(c.href);var A=Cs(b).hoistableStyles,q=A.get(e);if(q||(b=b.ownerDocument||b,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(e,q),(A=b.querySelector(Hh(e)))&&!A._p&&(q.instance=A,q.state.loading=5),dr.has(e)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},dr.set(e,c),A||$b(b,e,c,q.state))),i&&d===null)throw Error(a(528,""));return q}if(i&&d!==null)throw Error(a(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Qc(c),c=Cs(b).hoistableScripts,d=c.get(i),d||(d={type:"script",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Kc(e){return'href="'+ni(e)+'"'}function Hh(e){return'link[rel="stylesheet"]['+e+"]"}function Hv(e){return C({},e,{"data-precedence":e.precedence,precedence:null})}function $b(e,i,c,d){e.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=e.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),ka(i,"link",c),ra(i),e.head.appendChild(i))}function Qc(e){return'[src="'+ni(e)+'"]'}function Ih(e){return"script[async]"+e}function Iv(e,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var d=e.querySelector('style[data-href~="'+ni(c.href)+'"]');if(d)return i.instance=d,ra(d),d;var b=C({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(e.ownerDocument||e).createElement("style"),ra(d),ka(d,"style",b),D0(d,c.precedence,e),i.instance=d;case"stylesheet":b=Kc(c.href);var A=e.querySelector(Hh(b));if(A)return i.state.loading|=4,i.instance=A,ra(A),A;d=Hv(c),(b=dr.get(b))&&lp(d,b),A=(e.ownerDocument||e).createElement("link"),ra(A);var q=A;return q._p=new Promise(function(tt,ot){q.onload=tt,q.onerror=ot}),ka(A,"link",d),i.state.loading|=4,D0(A,c.precedence,e),i.instance=A;case"script":return A=Qc(c.src),(b=e.querySelector(Ih(A)))?(i.instance=b,ra(b),b):(d=c,(b=dr.get(A))&&(d=C({},c),op(d,b)),e=e.ownerDocument||e,b=e.createElement("script"),ra(b),ka(b,"link",d),e.head.appendChild(b),i.instance=b);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,D0(d,c.precedence,e));return i.instance}function D0(e,i,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=d.length?d[d.length-1]:null,A=b,q=0;q<d.length;q++){var tt=d[q];if(tt.dataset.precedence===i)A=tt;else if(A!==b)break}A?A.parentNode.insertBefore(e,A.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(e,i.firstChild))}function lp(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.title==null&&(e.title=i.title)}function op(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.integrity==null&&(e.integrity=i.integrity)}var j0=null;function kv(e,i,c){if(j0===null){var d=new Map,b=j0=new Map;b.set(c,d)}else b=j0,d=b.get(c),d||(d=new Map,b.set(c,d));if(d.has(e))return d;for(d.set(e,null),c=c.getElementsByTagName(e),b=0;b<c.length;b++){var A=c[b];if(!(A[ki]||A[he]||e==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var q=A.getAttribute(i)||"";q=e+q;var tt=d.get(q);tt?tt.push(A):d.set(q,[A])}}return d}function qv(e,i,c){e=e.ownerDocument||e,e.head.insertBefore(c,i==="title"?e.querySelector("head > title"):null)}function t4(e,i,c){if(c===1||i.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return e=i.disabled,typeof i.precedence=="string"&&e==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Vv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function e4(e,i,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var b=Kc(d.href),A=i.querySelector(Hh(b));if(A){i=A._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(e.count++,e=U0.bind(e),i.then(e,e)),c.state.loading|=4,c.instance=A,ra(A);return}A=i.ownerDocument||i,d=Hv(d),(b=dr.get(b))&&lp(d,b),A=A.createElement("link"),ra(A);var q=A;q._p=new Promise(function(tt,ot){q.onload=tt,q.onerror=ot}),ka(A,"link",d),c.instance=A}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(e.count++,c=U0.bind(e),i.addEventListener("load",c),i.addEventListener("error",c))}}var up=0;function n4(e,i){return e.stylesheets&&e.count===0&&z0(e,e.stylesheets),0<e.count||0<e.imgCount?function(c){var d=setTimeout(function(){if(e.stylesheets&&z0(e,e.stylesheets),e.unsuspend){var A=e.unsuspend;e.unsuspend=null,A()}},6e4+i);0<e.imgBytes&&up===0&&(up=62500*zb());var b=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&z0(e,e.stylesheets),e.unsuspend)){var A=e.unsuspend;e.unsuspend=null,A()}},(e.imgBytes>up?50:800)+i);return e.unsuspend=c,function(){e.unsuspend=null,clearTimeout(d),clearTimeout(b)}}:null}function U0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)z0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var B0=null;function z0(e,i){e.stylesheets=null,e.unsuspend!==null&&(e.count++,B0=new Map,i.forEach(a4,e),B0=null,U0.call(e))}function a4(e,i){if(!(i.state.loading&4)){var c=B0.get(e);if(c)var d=c.get(null);else{c=new Map,B0.set(e,c);for(var b=e.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<b.length;A++){var q=b[A];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(c.set(q.dataset.precedence,q),d=q)}d&&c.set(null,d)}b=i.instance,q=b.getAttribute("data-precedence"),A=c.get(q)||d,A===d&&c.set(null,b),c.set(q,b),this.count++,d=U0.bind(this),b.addEventListener("load",d),b.addEventListener("error",d),A?A.parentNode.insertBefore(b,A.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(b,e.firstChild)),i.state.loading|=4}}var kh={$$typeof:M,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function i4(e,i,c,d,b,A,q,tt,ot){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Dt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dt(0),this.hiddenUpdates=Dt(null),this.identifierPrefix=d,this.onUncaughtError=b,this.onCaughtError=A,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ot,this.incompleteTransitions=new Map}function Yv(e,i,c,d,b,A,q,tt,ot,St,Ot,Nt){return e=new i4(e,i,c,q,ot,St,Ot,Nt,tt),i=1,A===!0&&(i|=24),A=wa(3,null,null,i),e.current=A,A.stateNode=e,i=cc(),i.refCount++,e.pooledCache=i,i.refCount++,A.memoizedState={element:d,isDehydrated:c,cache:i},Is(A),e}function Kv(e){return e?(e=Qi,e):Qi}function Qv(e,i,c,d,b,A){b=Kv(b),d.context===null?d.context=b:d.pendingContext=b,d=rs(i),d.payload={element:c},A=A===void 0?null:A,A!==null&&(d.callback=A),c=ss(e,d,i),c!==null&&(sn(c,e,i),Xo(c,e,i))}function Xv(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var c=e.retryLane;e.retryLane=c!==0&&c<i?c:i}}function cp(e,i){Xv(e,i),(e=e.alternate)&&Xv(e,i)}function Fv(e){if(e.tag===13||e.tag===31){var i=ii(e,67108864);i!==null&&sn(i,e,67108864),cp(e,67108864)}}function Jv(e){if(e.tag===13||e.tag===31){var i=Ma();i=Xn(i);var c=ii(e,i);c!==null&&sn(c,e,i),cp(e,i)}}var L0=!0;function r4(e,i,c,d){var b=j.T;j.T=null;var A=I.p;try{I.p=2,fp(e,i,c,d)}finally{I.p=A,j.T=b}}function s4(e,i,c,d){var b=j.T;j.T=null;var A=I.p;try{I.p=8,fp(e,i,c,d)}finally{I.p=A,j.T=b}}function fp(e,i,c,d){if(L0){var b=hp(d);if(b===null)Zg(e,i,d,G0,c),Wv(e,d);else if(o4(b,e,i,c,d))d.stopPropagation();else if(Wv(e,d),i&4&&-1<l4.indexOf(e)){for(;b!==null;){var A=Yr(b);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var q=En(A.pendingLanes);if(q!==0){var tt=A;for(tt.pendingLanes|=2,tt.entangledLanes|=2;q;){var ot=1<<31-Jt(q);tt.entanglements[1]|=ot,q&=~ot}ys(A),(de&6)===0&&(Ai=Se()+500,zh(0))}}break;case 31:case 13:tt=ii(A,2),tt!==null&&sn(tt,A,2),Fl(),cp(A,2)}if(A=hp(d),A===null&&Zg(e,i,d,G0,c),A===b)break;b=A}b!==null&&d.stopPropagation()}else Zg(e,i,d,null,c)}}function hp(e){return e=zu(e),dp(e)}var G0=null;function dp(e){if(G0=null,e=Vr(e),e!==null){var i=o(e);if(i===null)e=null;else{var c=i.tag;if(c===13){if(e=f(i),e!==null)return e;e=null}else if(c===31){if(e=h(i),e!==null)return e;e=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null)}}return G0=e,null}function Zv(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(we()){case $e:return 2;case Ae:return 8;case ct:case At:return 32;case xt:return 268435456;default:return 32}default:return 32}}var gp=!1,$l=null,to=null,eo=null,qh=new Map,Vh=new Map,no=[],l4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Wv(e,i){switch(e){case"focusin":case"focusout":$l=null;break;case"dragenter":case"dragleave":to=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":qh.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vh.delete(i.pointerId)}}function Yh(e,i,c,d,b,A){return e===null||e.nativeEvent!==A?(e={blockedOn:i,domEventName:c,eventSystemFlags:d,nativeEvent:A,targetContainers:[b]},i!==null&&(i=Yr(i),i!==null&&Fv(i)),e):(e.eventSystemFlags|=d,i=e.targetContainers,b!==null&&i.indexOf(b)===-1&&i.push(b),e)}function o4(e,i,c,d,b){switch(i){case"focusin":return $l=Yh($l,e,i,c,d,b),!0;case"dragenter":return to=Yh(to,e,i,c,d,b),!0;case"mouseover":return eo=Yh(eo,e,i,c,d,b),!0;case"pointerover":var A=b.pointerId;return qh.set(A,Yh(qh.get(A)||null,e,i,c,d,b)),!0;case"gotpointercapture":return A=b.pointerId,Vh.set(A,Yh(Vh.get(A)||null,e,i,c,d,b)),!0}return!1}function $v(e){var i=Vr(e.target);if(i!==null){var c=o(i);if(c!==null){if(i=c.tag,i===13){if(i=f(c),i!==null){e.blockedOn=i,ee(e.priority,function(){Jv(c)});return}}else if(i===31){if(i=h(c),i!==null){e.blockedOn=i,ee(e.priority,function(){Jv(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){e.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}e.blockedOn=null}function P0(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var c=hp(e.nativeEvent);if(c===null){c=e.nativeEvent;var d=new c.constructor(c.type,c);El=d,c.target.dispatchEvent(d),El=null}else return i=Yr(c),i!==null&&Fv(i),e.blockedOn=c,!1;i.shift()}return!0}function ty(e,i,c){P0(e)&&c.delete(i)}function u4(){gp=!1,$l!==null&&P0($l)&&($l=null),to!==null&&P0(to)&&(to=null),eo!==null&&P0(eo)&&(eo=null),qh.forEach(ty),Vh.forEach(ty)}function H0(e,i){e.blockedOn===i&&(e.blockedOn=null,gp||(gp=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,u4)))}var I0=null;function ey(e){I0!==e&&(I0=e,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){I0===e&&(I0=null);for(var i=0;i<e.length;i+=3){var c=e[i],d=e[i+1],b=e[i+2];if(typeof d!="function"){if(dp(d||c)===null)continue;break}var A=Yr(c);A!==null&&(e.splice(i,3),i-=3,Oc(A,{pending:!0,data:b,method:c.method,action:d},d,b))}}))}function Xc(e){function i(ot){return H0(ot,e)}$l!==null&&H0($l,e),to!==null&&H0(to,e),eo!==null&&H0(eo,e),qh.forEach(i),Vh.forEach(i);for(var c=0;c<no.length;c++){var d=no[c];d.blockedOn===e&&(d.blockedOn=null)}for(;0<no.length&&(c=no[0],c.blockedOn===null);)$v(c),c.blockedOn===null&&no.shift();if(c=(e.ownerDocument||e).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var b=c[d],A=c[d+1],q=b[Ne]||null;if(typeof A=="function")q||ey(c);else if(q){var tt=null;if(A&&A.hasAttribute("formAction")){if(b=A,q=A[Ne]||null)tt=q.formAction;else if(dp(b)!==null)continue}else tt=q.action;typeof tt=="function"?c[d+1]=tt:(c.splice(d,3),d-=3),ey(c)}}}function ny(){function e(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(q){return b=q})},focusReset:"manual",scroll:"manual"})}function i(){b!==null&&(b(),b=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,b=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),b!==null&&(b(),b=null)}}}function pp(e){this._internalRoot=e}k0.prototype.render=pp.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(a(409));var c=i.current,d=Ma();Qv(c,d,e,i,null,null)},k0.prototype.unmount=pp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Qv(e.current,2,null,e,null,null),Fl(),i[Ue]=null}};function k0(e){this._internalRoot=e}k0.prototype.unstable_scheduleHydration=function(e){if(e){var i=Ee();e={blockedOn:null,target:e,priority:i};for(var c=0;c<no.length&&i!==0&&i<no[c].priority;c++);no.splice(c,0,e),c===0&&$v(e)}};var ay=t.version;if(ay!=="19.2.0")throw Error(a(527,ay,"19.2.0"));I.findDOMNode=function(e){var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=m(i),e=e!==null?_(e):null,e=e===null?null:e.stateNode,e};var c4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var q0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q0.isDisabled&&q0.supportsFiber)try{Lt=q0.inject(c4),vt=q0}catch{}}return Qh.createRoot=function(e,i){if(!r(e))throw Error(a(299));var c=!1,d="",b=eu,A=nu,q=Mc;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(b=i.onUncaughtError),i.onCaughtError!==void 0&&(A=i.onCaughtError),i.onRecoverableError!==void 0&&(q=i.onRecoverableError)),i=Yv(e,1,!1,null,null,c,d,null,b,A,q,ny),e[Ue]=i.current,Jg(e),new pp(i)},Qh.hydrateRoot=function(e,i,c){if(!r(e))throw Error(a(299));var d=!1,b="",A=eu,q=nu,tt=Mc,ot=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(b=c.identifierPrefix),c.onUncaughtError!==void 0&&(A=c.onUncaughtError),c.onCaughtError!==void 0&&(q=c.onCaughtError),c.onRecoverableError!==void 0&&(tt=c.onRecoverableError),c.formState!==void 0&&(ot=c.formState)),i=Yv(e,1,!0,i,c??null,d,b,ot,A,q,tt,ny),i.context=Kv(null),c=i.current,d=Ma(),d=Xn(d),b=rs(d),b.callback=null,ss(c,b,d),c=d,i.current.lanes=c,jt(i,c),ys(i),e[Ue]=i.current,Jg(e),new k0(i)},Qh.version="19.2.0",Qh}var dy;function _4(){if(dy)return yp.exports;dy=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),yp.exports=b4(),yp.exports}var E4=_4();const C4=pf(E4);_2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fd(){return fd=Object.assign?Object.assign.bind():function(l){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(l[a]=n[a])}return l},fd.apply(this,arguments)}var fo;(function(l){l.Pop="POP",l.Push="PUSH",l.Replace="REPLACE"})(fo||(fo={}));const gy="popstate";function T4(l){l===void 0&&(l={});function t(a,r){let{pathname:o,search:f,hash:h}=a.location;return _m("",{pathname:o,search:f,hash:h},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){return typeof r=="string"?r:C2(r)}return w4(t,n,null,l)}function Ca(l,t){if(l===!1||l===null||typeof l>"u")throw new Error(t)}function E2(l,t){if(!l){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function A4(){return Math.random().toString(36).substr(2,8)}function py(l,t){return{usr:l.state,key:l.key,idx:t}}function _m(l,t,n,a){return n===void 0&&(n=null),fd({pathname:typeof l=="string"?l:l.pathname,search:"",hash:""},typeof t=="string"?mf(t):t,{state:n,key:t&&t.key||a||A4()})}function C2(l){let{pathname:t="/",search:n="",hash:a=""}=l;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function mf(l){let t={};if(l){let n=l.indexOf("#");n>=0&&(t.hash=l.substr(n),l=l.substr(0,n));let a=l.indexOf("?");a>=0&&(t.search=l.substr(a),l=l.substr(0,a)),l&&(t.pathname=l)}return t}function w4(l,t,n,a){a===void 0&&(a={});let{window:r=document.defaultView,v5Compat:o=!1}=a,f=r.history,h=fo.Pop,g=null,m=_();m==null&&(m=0,f.replaceState(fd({},f.state,{idx:m}),""));function _(){return(f.state||{idx:null}).idx}function C(){h=fo.Pop;let B=_(),L=B==null?null:B-m;m=B,g&&g({action:h,location:D.location,delta:L})}function E(B,L){h=fo.Push;let N=_m(D.location,B,L);m=_()+1;let M=py(N,m),G=D.createHref(N);try{f.pushState(M,"",G)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;r.location.assign(G)}o&&g&&g({action:h,location:D.location,delta:1})}function R(B,L){h=fo.Replace;let N=_m(D.location,B,L);m=_();let M=py(N,m),G=D.createHref(N);f.replaceState(M,"",G),o&&g&&g({action:h,location:D.location,delta:0})}function v(B){let L=r.location.origin!=="null"?r.location.origin:r.location.href,N=typeof B=="string"?B:C2(B);return N=N.replace(/ $/,"%20"),Ca(L,"No window.location.(origin|href) available to create URL for href: "+N),new URL(N,L)}let D={get action(){return h},get location(){return l(r,f)},listen(B){if(g)throw new Error("A history only accepts one active listener");return r.addEventListener(gy,C),g=B,()=>{r.removeEventListener(gy,C),g=null}},createHref(B){return t(r,B)},createURL:v,encodeLocation(B){let L=v(B);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:E,replace:R,go(B){return f.go(B)}};return D}var my;(function(l){l.data="data",l.deferred="deferred",l.redirect="redirect",l.error="error"})(my||(my={}));function R4(l,t,n){return n===void 0&&(n="/"),O4(l,t,n)}function O4(l,t,n,a){let r=typeof t=="string"?mf(t):t,o=w2(r.pathname||"/",n);if(o==null)return null;let f=T2(l);x4(f);let h=null;for(let g=0;h==null&&g<f.length;++g){let m=I4(o);h=G4(f[g],m)}return h}function T2(l,t,n,a){t===void 0&&(t=[]),n===void 0&&(n=[]),a===void 0&&(a="");let r=(o,f,h)=>{let g={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:f,route:o};g.relativePath.startsWith("/")&&(Ca(g.relativePath.startsWith(a),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(a.length));let m=Su([a,g.relativePath]),_=n.concat(g);o.children&&o.children.length>0&&(Ca(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),T2(o.children,t,_,m)),!(o.path==null&&!o.index)&&t.push({path:m,score:z4(m,o.index),routesMeta:_})};return l.forEach((o,f)=>{var h;if(o.path===""||!((h=o.path)!=null&&h.includes("?")))r(o,f);else for(let g of A2(o.path))r(o,f,g)}),t}function A2(l){let t=l.split("/");if(t.length===0)return[];let[n,...a]=t,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(a.length===0)return r?[o,""]:[o];let f=A2(a.join("/")),h=[];return h.push(...f.map(g=>g===""?o:[o,g].join("/"))),r&&h.push(...f),h.map(g=>l.startsWith("/")&&g===""?"/":g)}function x4(l){l.sort((t,n)=>t.score!==n.score?n.score-t.score:L4(t.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}const M4=/^:[\w-]+$/,N4=3,D4=2,j4=1,U4=10,B4=-2,vy=l=>l==="*";function z4(l,t){let n=l.split("/"),a=n.length;return n.some(vy)&&(a+=B4),t&&(a+=D4),n.filter(r=>!vy(r)).reduce((r,o)=>r+(M4.test(o)?N4:o===""?j4:U4),a)}function L4(l,t){return l.length===t.length&&l.slice(0,-1).every((a,r)=>a===t[r])?l[l.length-1]-t[t.length-1]:0}function G4(l,t,n){let{routesMeta:a}=l,r={},o="/",f=[];for(let h=0;h<a.length;++h){let g=a[h],m=h===a.length-1,_=o==="/"?t:t.slice(o.length)||"/",C=P4({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},_),E=g.route;if(!C)return null;Object.assign(r,C.params),f.push({params:r,pathname:Su([o,C.pathname]),pathnameBase:Q4(Su([o,C.pathnameBase])),route:E}),C.pathnameBase!=="/"&&(o=Su([o,C.pathnameBase]))}return f}function P4(l,t){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[n,a]=H4(l.path,l.caseSensitive,l.end),r=t.match(n);if(!r)return null;let o=r[0],f=o.replace(/(.)\/+$/,"$1"),h=r.slice(1);return{params:a.reduce((m,_,C)=>{let{paramName:E,isOptional:R}=_;if(E==="*"){let D=h[C]||"";f=o.slice(0,o.length-D.length).replace(/(.)\/+$/,"$1")}const v=h[C];return R&&!v?m[E]=void 0:m[E]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:f,pattern:l}}function H4(l,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),E2(l==="*"||!l.endsWith("*")||l.endsWith("/*"),'Route path "'+l+'" will be treated as if it were '+('"'+l.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+l.replace(/\*$/,"/*")+'".'));let a=[],r="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,h,g)=>(a.push({paramName:h,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return l.endsWith("*")?(a.push({paramName:"*"}),r+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":l!==""&&l!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function I4(l){try{return l.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return E2(!1,'The URL path "'+l+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),l}}function w2(l,t){if(t==="/")return l;if(!l.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=l.charAt(n);return a&&a!=="/"?null:l.slice(n)||"/"}function k4(l,t){t===void 0&&(t="/");let{pathname:n,search:a="",hash:r=""}=typeof l=="string"?mf(l):l;return{pathname:n?n.startsWith("/")?n:q4(n,t):t,search:X4(a),hash:F4(r)}}function q4(l,t){let n=t.replace(/\/+$/,"").split("/");return l.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Ep(l,t,n,a){return"Cannot include a '"+l+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function V4(l){return l.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Y4(l,t){let n=V4(l);return t?n.map((a,r)=>r===n.length-1?a.pathname:a.pathnameBase):n.map(a=>a.pathnameBase)}function K4(l,t,n,a){a===void 0&&(a=!1);let r;typeof l=="string"?r=mf(l):(r=fd({},l),Ca(!r.pathname||!r.pathname.includes("?"),Ep("?","pathname","search",r)),Ca(!r.pathname||!r.pathname.includes("#"),Ep("#","pathname","hash",r)),Ca(!r.search||!r.search.includes("#"),Ep("#","search","hash",r)));let o=l===""||r.pathname==="",f=o?"/":r.pathname,h;if(f==null)h=n;else{let C=t.length-1;if(!a&&f.startsWith("..")){let E=f.split("/");for(;E[0]==="..";)E.shift(),C-=1;r.pathname=E.join("/")}h=C>=0?t[C]:"/"}let g=k4(r,h),m=f&&f!=="/"&&f.endsWith("/"),_=(o||f===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(m||_)&&(g.pathname+="/"),g}const Su=l=>l.join("/").replace(/\/\/+/g,"/"),Q4=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),X4=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,F4=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l;function J4(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}const R2=["post","put","patch","delete"];new Set(R2);const Z4=["get",...R2];new Set(Z4);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hd(){return hd=Object.assign?Object.assign.bind():function(l){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(l[a]=n[a])}return l},hd.apply(this,arguments)}const Xm=st.createContext(null),W4=st.createContext(null),Cg=st.createContext(null),Tg=st.createContext(null),vf=st.createContext({outlet:null,matches:[],isDataRoute:!1}),O2=st.createContext(null);function Ag(){return st.useContext(Tg)!=null}function Fm(){return Ag()||Ca(!1),st.useContext(Tg).location}function x2(l){st.useContext(Cg).static||st.useLayoutEffect(l)}function yf(){let{isDataRoute:l}=st.useContext(vf);return l?f3():$4()}function $4(){Ag()||Ca(!1);let l=st.useContext(Xm),{basename:t,future:n,navigator:a}=st.useContext(Cg),{matches:r}=st.useContext(vf),{pathname:o}=Fm(),f=JSON.stringify(Y4(r,n.v7_relativeSplatPath)),h=st.useRef(!1);return x2(()=>{h.current=!0}),st.useCallback(function(m,_){if(_===void 0&&(_={}),!h.current)return;if(typeof m=="number"){a.go(m);return}let C=K4(m,JSON.parse(f),o,_.relative==="path");l==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:Su([t,C.pathname])),(_.replace?a.replace:a.push)(C,_.state,_)},[t,a,f,o,l])}function t3(l,t){return e3(l,t)}function e3(l,t,n,a){Ag()||Ca(!1);let{navigator:r}=st.useContext(Cg),{matches:o}=st.useContext(vf),f=o[o.length-1],h=f?f.params:{};f&&f.pathname;let g=f?f.pathnameBase:"/";f&&f.route;let m=Fm(),_;if(t){var C;let B=typeof t=="string"?mf(t):t;g==="/"||(C=B.pathname)!=null&&C.startsWith(g)||Ca(!1),_=B}else _=m;let E=_.pathname||"/",R=E;if(g!=="/"){let B=g.replace(/^\//,"").split("/");R="/"+E.replace(/^\//,"").split("/").slice(B.length).join("/")}let v=R4(l,{pathname:R}),D=s3(v&&v.map(B=>Object.assign({},B,{params:Object.assign({},h,B.params),pathname:Su([g,r.encodeLocation?r.encodeLocation(B.pathname).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?g:Su([g,r.encodeLocation?r.encodeLocation(B.pathnameBase).pathname:B.pathnameBase])})),o,n,a);return t&&D?st.createElement(Tg.Provider,{value:{location:hd({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:fo.Pop}},D):D}function n3(){let l=c3(),t=J4(l)?l.status+" "+l.statusText:l instanceof Error?l.message:JSON.stringify(l),n=l instanceof Error?l.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return st.createElement(st.Fragment,null,st.createElement("h2",null,"Unexpected Application Error!"),st.createElement("h3",{style:{fontStyle:"italic"}},t),n?st.createElement("pre",{style:r},n):null,null)}const a3=st.createElement(n3,null);class i3 extends st.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?st.createElement(vf.Provider,{value:this.props.routeContext},st.createElement(O2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function r3(l){let{routeContext:t,match:n,children:a}=l,r=st.useContext(Xm);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),st.createElement(vf.Provider,{value:t},a)}function s3(l,t,n,a){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),a===void 0&&(a=null),l==null){var o;if(!n)return null;if(n.errors)l=n.matches;else if((o=a)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)l=n.matches;else return null}let f=l,h=(r=n)==null?void 0:r.errors;if(h!=null){let _=f.findIndex(C=>C.route.id&&(h==null?void 0:h[C.route.id])!==void 0);_>=0||Ca(!1),f=f.slice(0,Math.min(f.length,_+1))}let g=!1,m=-1;if(n&&a&&a.v7_partialHydration)for(let _=0;_<f.length;_++){let C=f[_];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(m=_),C.route.id){let{loaderData:E,errors:R}=n,v=C.route.loader&&E[C.route.id]===void 0&&(!R||R[C.route.id]===void 0);if(C.route.lazy||v){g=!0,m>=0?f=f.slice(0,m+1):f=[f[0]];break}}}return f.reduceRight((_,C,E)=>{let R,v=!1,D=null,B=null;n&&(R=h&&C.route.id?h[C.route.id]:void 0,D=C.route.errorElement||a3,g&&(m<0&&E===0?(h3("route-fallback"),v=!0,B=null):m===E&&(v=!0,B=C.route.hydrateFallbackElement||null)));let L=t.concat(f.slice(0,E+1)),N=()=>{let M;return R?M=D:v?M=B:C.route.Component?M=st.createElement(C.route.Component,null):C.route.element?M=C.route.element:M=_,st.createElement(r3,{match:C,routeContext:{outlet:_,matches:L,isDataRoute:n!=null},children:M})};return n&&(C.route.ErrorBoundary||C.route.errorElement||E===0)?st.createElement(i3,{location:n.location,revalidation:n.revalidation,component:D,error:R,children:N(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):N()},null)}var M2=(function(l){return l.UseBlocker="useBlocker",l.UseRevalidator="useRevalidator",l.UseNavigateStable="useNavigate",l})(M2||{}),N2=(function(l){return l.UseBlocker="useBlocker",l.UseLoaderData="useLoaderData",l.UseActionData="useActionData",l.UseRouteError="useRouteError",l.UseNavigation="useNavigation",l.UseRouteLoaderData="useRouteLoaderData",l.UseMatches="useMatches",l.UseRevalidator="useRevalidator",l.UseNavigateStable="useNavigate",l.UseRouteId="useRouteId",l})(N2||{});function l3(l){let t=st.useContext(Xm);return t||Ca(!1),t}function o3(l){let t=st.useContext(W4);return t||Ca(!1),t}function u3(l){let t=st.useContext(vf);return t||Ca(!1),t}function D2(l){let t=u3(),n=t.matches[t.matches.length-1];return n.route.id||Ca(!1),n.route.id}function c3(){var l;let t=st.useContext(O2),n=o3(),a=D2();return t!==void 0?t:(l=n.errors)==null?void 0:l[a]}function f3(){let{router:l}=l3(M2.UseNavigateStable),t=D2(N2.UseNavigateStable),n=st.useRef(!1);return x2(()=>{n.current=!0}),st.useCallback(function(r,o){o===void 0&&(o={}),n.current&&(typeof r=="number"?l.navigate(r):l.navigate(r,hd({fromRouteId:t},o)))},[l,t])}const yy={};function h3(l,t,n){yy[l]||(yy[l]=!0)}function d3(l,t){l==null||l.v7_startTransition,l==null||l.v7_relativeSplatPath}function hu(l){Ca(!1)}function g3(l){let{basename:t="/",children:n=null,location:a,navigationType:r=fo.Pop,navigator:o,static:f=!1,future:h}=l;Ag()&&Ca(!1);let g=t.replace(/^\/*/,"/"),m=st.useMemo(()=>({basename:g,navigator:o,static:f,future:hd({v7_relativeSplatPath:!1},h)}),[g,h,o,f]);typeof a=="string"&&(a=mf(a));let{pathname:_="/",search:C="",hash:E="",state:R=null,key:v="default"}=a,D=st.useMemo(()=>{let B=w2(_,g);return B==null?null:{location:{pathname:B,search:C,hash:E,state:R,key:v},navigationType:r}},[g,_,C,E,R,v,r]);return D==null?null:st.createElement(Cg.Provider,{value:m},st.createElement(Tg.Provider,{children:n,value:D}))}function p3(l){let{children:t,location:n}=l;return t3(Em(t),n)}new Promise(()=>{});function Em(l,t){t===void 0&&(t=[]);let n=[];return st.Children.forEach(l,(a,r)=>{if(!st.isValidElement(a))return;let o=[...t,r];if(a.type===st.Fragment){n.push.apply(n,Em(a.props.children,o));return}a.type!==hu&&Ca(!1),!a.props.index||!a.props.children||Ca(!1);let f={id:a.props.id||o.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(f.children=Em(a.props.children,o)),n.push(f)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cm(l){return l===void 0&&(l=""),new URLSearchParams(typeof l=="string"||Array.isArray(l)||l instanceof URLSearchParams?l:Object.keys(l).reduce((t,n)=>{let a=l[n];return t.concat(Array.isArray(a)?a.map(r=>[n,r]):[[n,a]])},[]))}function m3(l,t){let n=Cm(l);return t&&t.forEach((a,r)=>{n.has(r)||t.getAll(r).forEach(o=>{n.append(r,o)})}),n}const v3="6";try{window.__reactRouterVersion=v3}catch{}const y3="startTransition",Sy=m4[y3];function S3(l){let{basename:t,children:n,future:a,window:r}=l,o=st.useRef();o.current==null&&(o.current=T4({window:r,v5Compat:!0}));let f=o.current,[h,g]=st.useState({action:f.action,location:f.location}),{v7_startTransition:m}=a||{},_=st.useCallback(C=>{m&&Sy?Sy(()=>g(C)):g(C)},[g,m]);return st.useLayoutEffect(()=>f.listen(_),[f,_]),st.useEffect(()=>d3(a),[a]),st.createElement(g3,{basename:t,children:n,location:h.location,navigationType:h.action,navigator:f,future:a})}var by;(function(l){l.UseScrollRestoration="useScrollRestoration",l.UseSubmit="useSubmit",l.UseSubmitFetcher="useSubmitFetcher",l.UseFetcher="useFetcher",l.useViewTransitionState="useViewTransitionState"})(by||(by={}));var _y;(function(l){l.UseFetcher="useFetcher",l.UseFetchers="useFetchers",l.UseScrollRestoration="useScrollRestoration"})(_y||(_y={}));function vd(l){let t=st.useRef(Cm(l)),n=st.useRef(!1),a=Fm(),r=st.useMemo(()=>m3(a.search,n.current?null:t.current),[a.search]),o=yf(),f=st.useCallback((h,g)=>{const m=Cm(typeof h=="function"?h(r):h);n.current=!0,o("?"+m,g)},[o,r]);return[r,f]}function b3(){const l=yf(),[t,n]=st.useState(!1),[a,r]=st.useState(""),[o,f]=st.useState("demo"),h=g=>{g.preventDefault(),a.trim()&&o.trim()&&l(`/student?room=${o}&name=${encodeURIComponent(a.trim())}`)};return t?k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsx("div",{className:"glass-surface landing-container",style:{maxWidth:"500px"},children:k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",style:{fontSize:"2rem"},children:"Join as Student"}),k.jsx("p",{className:"landing-description",children:"Enter your name and room code to start drawing"})]}),k.jsxs("form",{onSubmit:h,style:{width:"100%",marginTop:"2rem"},children:[k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"studentName",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Your Name"}),k.jsx("input",{id:"studentName",type:"text",value:a,onChange:g=>r(g.target.value),placeholder:"Enter your name",autoFocus:!0,required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"roomCode",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Room Code"}),k.jsx("input",{id:"roomCode",type:"text",value:o,onChange:g=>f(g.target.value.toUpperCase()),placeholder:"Enter room code",required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s",fontFamily:"monospace",letterSpacing:"2px"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[k.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"2px solid #ddd",borderRadius:"8px",background:"white",cursor:"pointer",transition:"all 0.2s"},children:"← Back"}),k.jsx("button",{type:"submit",style:{flex:2,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:g=>g.target.style.transform="translateY(-2px)",onMouseOut:g=>g.target.style.transform="translateY(0)",children:"Join Room →"})]})]})]})})})]}):k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsxs("div",{className:"glass-surface landing-container",children:[k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",children:"Teach visually. Collaborate instantly."}),k.jsx("p",{className:"landing-description",children:"Feather streams pencil-perfect strokes between teachers and students in real time. Instant sync, buttery smooth annotation tools, and delightful classroom-ready controls built for iPad and stylus workflows."})]}),k.jsxs("dl",{className:"features",children:[k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Palm rejection"}),k.jsx("dd",{className:"feature-subtitle",children:"Silky palm drawing"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Frameless logos"}),k.jsx("dd",{className:"feature-subtitle",children:"Delightful annotations"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Realtime sync"}),k.jsx("dd",{className:"feature-subtitle",children:"Sub-second latency"})]})]})]}),k.jsxs("div",{className:"workspace-section",children:[k.jsx("p",{className:"workspace-label",children:"PICK YOUR WORKSPACE"}),k.jsxs("div",{className:"workspace-cards",children:[k.jsxs("a",{onClick:()=>l("/teacher"),className:"glass-button teacher-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Teacher dashboard"}),k.jsx("p",{className:"workspace-description",children:"Monitor your students, sync views, and annotate the board. Assign templates/images, and manage the class."})]}),k.jsx("span",{className:"workspace-emoji",children:"👩‍🏫"})]}),k.jsxs("a",{onClick:()=>l("/student-login"),className:"glass-button student-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Student workspace"}),k.jsx("p",{className:"workspace-description",children:"Sketch on a public or draw alongside the class, with undo/redo, templates, and stylus-first controls."})]}),k.jsx("span",{className:"workspace-emoji",children:"👩‍🎓"})]})]})]})]})})]})}const _3=Math.PI/180;function E3(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const vu=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Xt={_global:vu,version:"10.0.7",isBrowser:E3(),isUnminified:/param/.test((function(l){}).toString()),dblClickWindow:400,getAngle(l){return Xt.angleDeg?l*_3:l},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Xt.DD.isDragging},isTransforming(){var l,t;return(t=(l=Xt.Transformer)===null||l===void 0?void 0:l.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!Xt.DD.node},releaseCanvasOnDestroy:!0,document:vu.document,_injectGlobal(l){typeof vu.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),vu.Konva=l}},Qn=l=>{Xt[l.prototype.getClassName()]=l};Xt._injectGlobal(Xt);const C3=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Ey=()=>{if(typeof document>"u")throw new Error(C3)};class Gi{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Gi(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const n=this.m;return{x:n[0]*t.x+n[2]*t.y+n[4],y:n[1]*t.x+n[3]*t.y+n[5]}}translate(t,n){return this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n,this}scale(t,n){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n,this}rotate(t){const n=Math.cos(t),a=Math.sin(t),r=this.m[0]*n+this.m[2]*a,o=this.m[1]*n+this.m[3]*a,f=this.m[0]*-a+this.m[2]*n,h=this.m[1]*-a+this.m[3]*n;return this.m[0]=r,this.m[1]=o,this.m[2]=f,this.m[3]=h,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,n){const a=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,o=this.m[2]+this.m[0]*t,f=this.m[3]+this.m[1]*t;return this.m[0]=a,this.m[1]=r,this.m[2]=o,this.m[3]=f,this}multiply(t){const n=this.m[0]*t.m[0]+this.m[2]*t.m[1],a=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],o=this.m[1]*t.m[2]+this.m[3]*t.m[3],f=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],h=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=o,this.m[4]=f,this.m[5]=h,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,a=-this.m[1]*t,r=-this.m[2]*t,o=this.m[0]*t,f=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),h=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=o,this.m[4]=f,this.m[5]=h,this}getMatrix(){return this.m}decompose(){const t=this.m[0],n=this.m[1],a=this.m[2],r=this.m[3],o=this.m[4],f=this.m[5],h=t*r-n*a,g={x:o,y:f,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){const m=Math.sqrt(t*t+n*n);g.rotation=n>0?Math.acos(t/m):-Math.acos(t/m),g.scaleX=m,g.scaleY=h/m,g.skewX=(t*a+n*r)/h,g.skewY=0}else if(a!=0||r!=0){const m=Math.sqrt(a*a+r*r);g.rotation=Math.PI/2-(r>0?Math.acos(-a/m):-Math.acos(a/m)),g.scaleX=h/m,g.scaleY=m,g.skewX=0,g.skewY=(t*a+n*r)/h}return g.rotation=mt._getRotation(g.rotation),g}}const T3="[object Array]",A3="[object Number]",w3="[object String]",R3="[object Boolean]",O3=Math.PI/180,x3=180/Math.PI,Cp="#",M3="",N3="0",D3="Konva warning: ",Cy="Konva error: ",j3="rgb(",Tp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},U3=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let V0=[];const B3=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(l){setTimeout(l,60)},mt={_isElement(l){return!!(l&&l.nodeType==1)},_isFunction(l){return!!(l&&l.constructor&&l.call&&l.apply)},_isPlainObject(l){return!!l&&l.constructor===Object},_isArray(l){return Object.prototype.toString.call(l)===T3},_isNumber(l){return Object.prototype.toString.call(l)===A3&&!isNaN(l)&&isFinite(l)},_isString(l){return Object.prototype.toString.call(l)===w3},_isBoolean(l){return Object.prototype.toString.call(l)===R3},isObject(l){return l instanceof Object},isValidSelector(l){if(typeof l!="string")return!1;const t=l[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(l){return l===0||l>0?1:-1},requestAnimFrame(l){V0.push(l),V0.length===1&&B3(function(){const t=V0;V0=[],t.forEach(function(n){n()})})},createCanvasElement(){Ey();const l=document.createElement("canvas");try{l.style=l.style||{}}catch{}return l},createImageElement(){return Ey(),document.createElement("img")},_isInDocument(l){for(;l=l.parentNode;)if(l==document)return!0;return!1},_urlToImage(l,t){const n=mt.createImageElement();n.onload=function(){t(n)},n.src=l},_rgbToHex(l,t,n){return((1<<24)+(l<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(l){l=l.replace(Cp,M3);const t=parseInt(l,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let l=(Math.random()*16777215<<0).toString(16);for(;l.length<6;)l=N3+l;return Cp+l},getRGB(l){let t;return l in Tp?(t=Tp[l],{r:t[0],g:t[1],b:t[2]}):l[0]===Cp?this._hexToRgb(l.substring(1)):l.substr(0,4)===j3?(t=U3.exec(l.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(l){return l=l||"black",mt._namedColorToRBA(l)||mt._hex3ColorToRGBA(l)||mt._hex4ColorToRGBA(l)||mt._hex6ColorToRGBA(l)||mt._hex8ColorToRGBA(l)||mt._rgbColorToRGBA(l)||mt._rgbaColorToRGBA(l)||mt._hslColorToRGBA(l)},_namedColorToRBA(l){const t=Tp[l.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(l){if(l.indexOf("rgb(")===0){l=l.match(/rgb\(([^)]+)\)/)[1];const t=l.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(l){if(l.indexOf("rgba(")===0){l=l.match(/rgba\(([^)]+)\)/)[1];const t=l.split(/ *, */).map((n,a)=>n.slice(-1)==="%"?a===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(l){if(l[0]==="#"&&l.length===9)return{r:parseInt(l.slice(1,3),16),g:parseInt(l.slice(3,5),16),b:parseInt(l.slice(5,7),16),a:parseInt(l.slice(7,9),16)/255}},_hex6ColorToRGBA(l){if(l[0]==="#"&&l.length===7)return{r:parseInt(l.slice(1,3),16),g:parseInt(l.slice(3,5),16),b:parseInt(l.slice(5,7),16),a:1}},_hex4ColorToRGBA(l){if(l[0]==="#"&&l.length===5)return{r:parseInt(l[1]+l[1],16),g:parseInt(l[2]+l[2],16),b:parseInt(l[3]+l[3],16),a:parseInt(l[4]+l[4],16)/255}},_hex3ColorToRGBA(l){if(l[0]==="#"&&l.length===4)return{r:parseInt(l[1]+l[1],16),g:parseInt(l[2]+l[2],16),b:parseInt(l[3]+l[3],16),a:1}},_hslColorToRGBA(l){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(l)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(l),a=Number(n[0])/360,r=Number(n[1])/100,o=Number(n[2])/100;let f,h,g;if(r===0)return g=o*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};o<.5?f=o*(1+r):f=o+r-o*r;const m=2*o-f,_=[0,0,0];for(let C=0;C<3;C++)h=a+1/3*-(C-1),h<0&&h++,h>1&&h--,6*h<1?g=m+(f-m)*6*h:2*h<1?g=f:3*h<2?g=m+(f-m)*(2/3-h)*6:g=m,_[C]=g*255;return{r:Math.round(_[0]),g:Math.round(_[1]),b:Math.round(_[2]),a:1}}},haveIntersection(l,t){return!(t.x>l.x+l.width||t.x+t.width<l.x||t.y>l.y+l.height||t.y+t.height<l.y)},cloneObject(l){const t={};for(const n in l)this._isPlainObject(l[n])?t[n]=this.cloneObject(l[n]):this._isArray(l[n])?t[n]=this.cloneArray(l[n]):t[n]=l[n];return t},cloneArray(l){return l.slice(0)},degToRad(l){return l*O3},radToDeg(l){return l*x3},_degToRad(l){return mt.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),mt.degToRad(l)},_radToDeg(l){return mt.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),mt.radToDeg(l)},_getRotation(l){return Xt.angleDeg?mt.radToDeg(l):l},_capitalize(l){return l.charAt(0).toUpperCase()+l.slice(1)},throw(l){throw new Error(Cy+l)},error(l){console.error(Cy+l)},warn(l){Xt.showWarnings&&console.warn(D3+l)},each(l,t){for(const n in l)t(n,l[n])},_inRange(l,t,n){return t<=l&&l<n},_getProjectionToSegment(l,t,n,a,r,o){let f,h,g;const m=(l-n)*(l-n)+(t-a)*(t-a);if(m==0)f=l,h=t,g=(r-n)*(r-n)+(o-a)*(o-a);else{const _=((r-l)*(n-l)+(o-t)*(a-t))/m;_<0?(f=l,h=t,g=(l-r)*(l-r)+(t-o)*(t-o)):_>1?(f=n,h=a,g=(n-r)*(n-r)+(a-o)*(a-o)):(f=l+_*(n-l),h=t+_*(a-t),g=(f-r)*(f-r)+(h-o)*(h-o))}return[f,h,g]},_getProjectionToLine(l,t,n){const a=mt.cloneObject(l);let r=Number.MAX_VALUE;return t.forEach(function(o,f){if(!n&&f===t.length-1)return;const h=t[(f+1)%t.length],g=mt._getProjectionToSegment(o.x,o.y,h.x,h.y,l.x,l.y),m=g[0],_=g[1],C=g[2];C<r&&(a.x=m,a.y=_,r=C)}),a},_prepareArrayForTween(l,t,n){const a=[],r=[];if(l.length>t.length){const f=t;t=l,l=f}for(let f=0;f<l.length;f+=2)a.push({x:l[f],y:l[f+1]});for(let f=0;f<t.length;f+=2)r.push({x:t[f],y:t[f+1]});const o=[];return r.forEach(function(f){const h=mt._getProjectionToLine(f,a,n);o.push(h.x),o.push(h.y)}),o},_prepareToStringify(l){let t;l.visitedByCircularReferenceRemoval=!0;for(const n in l)if(l.hasOwnProperty(n)&&l[n]&&typeof l[n]=="object"){if(t=Object.getOwnPropertyDescriptor(l,n),l[n].visitedByCircularReferenceRemoval||mt._isElement(l[n]))if(t.configurable)delete l[n];else return null;else if(mt._prepareToStringify(l[n])===null)if(t.configurable)delete l[n];else return null}return delete l.visitedByCircularReferenceRemoval,l},_assign(l,t){for(const n in t)l[n]=t[n];return l},_getFirstPointerId(l){return l.touches?l.changedTouches[0].identifier:l.pointerId||999},releaseCanvas(...l){Xt.releaseCanvasOnDestroy&&l.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(l,t,n,a){let r=t<0?t:0,o=n<0?n:0;t=Math.abs(t),n=Math.abs(n);let f=0,h=0,g=0,m=0;typeof a=="number"?f=h=g=m=Math.min(a,t/2,n/2):(f=Math.min(a[0]||0,t/2,n/2),h=Math.min(a[1]||0,t/2,n/2),m=Math.min(a[2]||0,t/2,n/2),g=Math.min(a[3]||0,t/2,n/2)),l.moveTo(r+f,o),l.lineTo(r+t-h,o),l.arc(r+t-h,o+h,h,Math.PI*3/2,0,!1),l.lineTo(r+t,o+n-m),l.arc(r+t-m,o+n-m,m,0,Math.PI/2,!1),l.lineTo(r+g,o+n),l.arc(r+g,o+n-g,g,Math.PI/2,Math.PI,!1),l.lineTo(r,o+f),l.arc(r+f,o+f,f,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(l,t,n,a,r){a=Math.abs(a);for(let o=0;o<n;o++){const f=t[(o-1+n)%n],h=t[o],g=t[(o+1)%n],m={x:h.x-f.x,y:h.y-f.y},_={x:g.x-h.x,y:g.y-h.y},C=Math.hypot(m.x,m.y),E=Math.hypot(_.x,_.y);let R;typeof r=="number"?R=r:R=o<r.length?r[o]:0,R=a*Math.cos(Math.PI/n)*Math.min(1,R/a*2);const D={x:m.x/C,y:m.y/C},B={x:_.x/E,y:_.y/E},L={x:h.x-D.x*R,y:h.y-D.y*R},N={x:h.x+B.x*R,y:h.y+B.y*R};o===0?l.moveTo(L.x,L.y):l.lineTo(L.x,L.y),l.arcTo(h.x,h.y,N.x,N.y,R)}}};function z3(l){const t=[],n=l.length,a=mt;for(let r=0;r<n;r++){let o=l[r];a._isNumber(o)?o=Math.round(o*1e3)/1e3:a._isString(o)||(o=o+""),t.push(o)}return t}const Ty=",",L3="(",G3=")",P3="([",H3="])",I3=";",k3="()",q3="=",Ay=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],V3=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],Y3=100;let Y0=null;function wy(){if(Y0!==null)return Y0;try{const t=mt.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Y0=!1,!1)}catch{return Y0=!1,!1}}class wg{constructor(t){this.canvas=t,Xt.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,n){let a=this.traceArr,r=a.length,o="",f,h,g,m;for(f=0;f<r;f++)h=a[f],g=h.method,g?(m=h.args,o+=g,t?o+=k3:mt._isArray(m[0])?o+=P3+m.join(Ty)+H3:(n&&(m=m.map(_=>typeof _=="number"?Math.floor(_):_)),o+=L3+m.join(Ty)+G3)):(o+=h.property,t||(o+=q3+h.val)),o+=I3;return o}clearTrace(){this.traceArr=[]}_trace(t){let n=this.traceArr,a;n.push(t),a=n.length,a>=Y3&&n.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const n=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(t){const n=t.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(t){const n=t.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(t){const n=t.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(t){const n=t.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(t,n){this._context[t]=n}arc(t,n,a,r,o,f){this._context.arc(t,n,a,r,o,f)}arcTo(t,n,a,r,o){this._context.arcTo(t,n,a,r,o)}beginPath(){this._context.beginPath()}bezierCurveTo(t,n,a,r,o,f){this._context.bezierCurveTo(t,n,a,r,o,f)}clearRect(t,n,a,r){this._context.clearRect(t,n,a,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,n){const a=arguments;if(a.length===2)return this._context.createImageData(t,n);if(a.length===1)return this._context.createImageData(t)}createLinearGradient(t,n,a,r){return this._context.createLinearGradient(t,n,a,r)}createPattern(t,n){return this._context.createPattern(t,n)}createRadialGradient(t,n,a,r,o,f){return this._context.createRadialGradient(t,n,a,r,o,f)}drawImage(t,n,a,r,o,f,h,g,m){const _=arguments,C=this._context;_.length===3?C.drawImage(t,n,a):_.length===5?C.drawImage(t,n,a,r,o):_.length===9&&C.drawImage(t,n,a,r,o,f,h,g,m)}ellipse(t,n,a,r,o,f,h,g){this._context.ellipse(t,n,a,r,o,f,h,g)}isPointInPath(t,n,a,r){return a?this._context.isPointInPath(a,t,n,r):this._context.isPointInPath(t,n,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,n,a,r){this._context.fillRect(t,n,a,r)}strokeRect(t,n,a,r){this._context.strokeRect(t,n,a,r)}fillText(t,n,a,r){r?this._context.fillText(t,n,a,r):this._context.fillText(t,n,a)}measureText(t){return this._context.measureText(t)}getImageData(t,n,a,r){return this._context.getImageData(t,n,a,r)}lineTo(t,n){this._context.lineTo(t,n)}moveTo(t,n){this._context.moveTo(t,n)}rect(t,n,a,r){this._context.rect(t,n,a,r)}roundRect(t,n,a,r,o){this._context.roundRect(t,n,a,r,o)}putImageData(t,n,a){this._context.putImageData(t,n,a)}quadraticCurveTo(t,n,a,r){this._context.quadraticCurveTo(t,n,a,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,n){this._context.scale(t,n)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,n,a,r,o,f){this._context.setTransform(t,n,a,r,o,f)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,n,a,r){this._context.strokeText(t,n,a,r)}transform(t,n,a,r,o,f){this._context.transform(t,n,a,r,o,f)}translate(t,n){this._context.translate(t,n)}_enableTrace(){let t=this,n=Ay.length,a=this.setAttr,r,o;const f=function(h){let g=t[h],m;t[h]=function(){return o=z3(Array.prototype.slice.call(arguments,0)),m=g.apply(t,arguments),t._trace({method:h,args:o}),m}};for(r=0;r<n;r++)f(Ay[r]);t.setAttr=function(){a.apply(t,arguments);const h=arguments[0];let g=arguments[1];(h==="shadowOffsetX"||h==="shadowOffsetY"||h==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),t._trace({property:h,val:g})}}_applyGlobalCompositeOperation(t){const n=t.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}V3.forEach(function(l){Object.defineProperty(wg.prototype,l,{get(){return this._context[l]},set(t){this._context[l]=t}})});class K3 extends wg{constructor(t,{willReadFrequently:n=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(t){const n=t.fill();this.setAttr("fillStyle",n),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const n=t._getLinearGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fillRadialGradient(t){const n=t._getRadialGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fill(t){const n=t.fill(),a=t.getFillPriority();if(n&&a==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&a==="pattern"){this._fillPattern(t);return}const o=t.getFillLinearGradientColorStops();if(o&&a==="linear-gradient"){this._fillLinearGradient(t);return}const f=t.getFillRadialGradientColorStops();if(f&&a==="radial-gradient"){this._fillRadialGradient(t);return}n?this._fillColor(t):r?this._fillPattern(t):o?this._fillLinearGradient(t):f&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const n=t.getStrokeLinearGradientStartPoint(),a=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(n.x,n.y,a.x,a.y);if(r){for(let f=0;f<r.length;f+=2)o.addColorStop(r[f],r[f+1]);this.setAttr("strokeStyle",o)}}_stroke(t){const n=t.dash(),a=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!a){this.save();const o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(t),n&&t.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),a||this.restore()}}_applyShadow(t){var n,a,r;const o=(n=t.getShadowRGBA())!==null&&n!==void 0?n:"black",f=(a=t.getShadowBlur())!==null&&a!==void 0?a:5,h=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},g=t.getAbsoluteScale(),m=this.canvas.getPixelRatio(),_=g.x*m,C=g.y*m;this.setAttr("shadowColor",o),this.setAttr("shadowBlur",f*Math.min(Math.abs(_),Math.abs(C))),this.setAttr("shadowOffsetX",h.x*_),this.setAttr("shadowOffsetY",h.y*C)}}class Q3 extends wg{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const n=t.getStrokeScaleEnabled();if(!n){this.save();const o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(t);const a=t.hitStrokeWidth(),r=a==="auto"?t.strokeWidth():a;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),n||this.restore()}}}let K0;function X3(){if(K0)return K0;const l=mt.createCanvasElement(),t=l.getContext("2d");return K0=(function(){const n=Xt._global.devicePixelRatio||1,a=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/a})(),mt.releaseCanvas(l),K0}class Jm{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const a=(t||{}).pixelRatio||Xt.pixelRatio||X3();this.pixelRatio=a,this._canvas=mt.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const n=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,n){this.setWidth(t||0),this.setHeight(n||0)}toDataURL(t,n){try{return this._canvas.toDataURL(t,n)}catch{try{return this._canvas.toDataURL()}catch(r){return mt.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class uo extends Jm{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new K3(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function Ry(){const l=mt.createCanvasElement();l.width=1,l.height=1;const t=l.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data;return!(n[0]===255&&n[1]===0&&n[2]===255&&n[3]===255)}function Oy(){var l,t;return typeof navigator>"u"?!1:(t=(l=navigator.brave)===null||l===void 0?void 0:l.isBrave())!==null&&t!==void 0?t:!1}let xy=!1;function F3(){return Oy()&&Ry()&&!xy&&(xy=!0,mt.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),Oy()&&Ry()}class Zm extends Jm{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Q3(this),this.setSize(t.width,t.height),F3()}}const fn={get isDragging(){let l=!1;return fn._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(l=!0)}),l},justDragged:!1,get node(){let l;return fn._dragElements.forEach(t=>{l=t.node}),l},_dragElements:new Map,_drag(l){const t=[];fn._dragElements.forEach((n,a)=>{const{node:r}=n,o=r.getStage();o.setPointersPositions(l),n.pointerId===void 0&&(n.pointerId=mt._getFirstPointerId(l));const f=o._changedPointerPositions.find(h=>h.id===n.pointerId);if(f){if(n.dragStatus!=="dragging"){const h=r.dragDistance();if(Math.max(Math.abs(f.x-n.startPointerPos.x),Math.abs(f.y-n.startPointerPos.y))<h||(r.startDrag({evt:l}),!r.isDragging()))return}r._setDragPosition(l,n),t.push(r)}}),t.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:l},!0)})},_endDragBefore(l){const t=[];fn._dragElements.forEach(n=>{const{node:a}=n,r=a.getStage();if(l&&r.setPointersPositions(l),!r._changedPointerPositions.find(h=>h.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(fn.justDragged=!0,Xt._mouseListenClick=!1,Xt._touchListenClick=!1,Xt._pointerListenClick=!1,n.dragStatus="stopped");const f=n.node.getLayer()||n.node instanceof Xt.Stage&&n.node;f&&t.indexOf(f)===-1&&t.push(f)}),t.forEach(n=>{n.draw()})},_endDragAfter(l){fn._dragElements.forEach((t,n)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:l},!0),t.dragStatus!=="dragging"&&fn._dragElements.delete(n)})}};Xt.isBrowser&&(window.addEventListener("mouseup",fn._endDragBefore,!0),window.addEventListener("touchend",fn._endDragBefore,!0),window.addEventListener("touchcancel",fn._endDragBefore,!0),window.addEventListener("mousemove",fn._drag),window.addEventListener("touchmove",fn._drag),window.addEventListener("mouseup",fn._endDragAfter,!1),window.addEventListener("touchend",fn._endDragAfter,!1),window.addEventListener("touchcancel",fn._endDragAfter,!1));function go(l){return mt._isString(l)?'"'+l+'"':Object.prototype.toString.call(l)==="[object Number]"||mt._isBoolean(l)?l:Object.prototype.toString.call(l)}function j2(l){return l>255?255:l<0?0:Math.round(l)}function Vt(){if(Xt.isUnminified)return function(l,t){return mt._isNumber(l)||mt.warn(go(l)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),l}}function Rg(l){if(Xt.isUnminified)return function(t,n){let a=mt._isNumber(t),r=mt._isArray(t)&&t.length==l;return!a&&!r&&mt.warn(go(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+l+")"),t}}function Wm(){if(Xt.isUnminified)return function(l,t){return mt._isNumber(l)||l==="auto"||mt.warn(go(l)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),l}}function bu(){if(Xt.isUnminified)return function(l,t){return mt._isString(l)||mt.warn(go(l)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),l}}function U2(){if(Xt.isUnminified)return function(l,t){const n=mt._isString(l),a=Object.prototype.toString.call(l)==="[object CanvasGradient]"||l&&l.addColorStop;return n||a||mt.warn(go(l)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),l}}function J3(){if(Xt.isUnminified)return function(l,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&l instanceof n||(mt._isArray(l)?l.forEach(function(a){mt._isNumber(a)||mt.warn('"'+t+'" attribute has non numeric element '+a+". Make sure that all elements are numbers.")}):mt.warn(go(l)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),l}}function kr(){if(Xt.isUnminified)return function(l,t){return l===!0||l===!1||mt.warn(go(l)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),l}}function Z3(l){if(Xt.isUnminified)return function(t,n){return t==null||mt.isObject(t)||mt.warn(go(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+l),t}}const Xh="get",Fh="set",lt={addGetterSetter(l,t,n,a,r){lt.addGetter(l,t,n),lt.addSetter(l,t,a,r),lt.addOverloadedGetterSetter(l,t)},addGetter(l,t,n){const a=Xh+mt._capitalize(t);l.prototype[a]=l.prototype[a]||function(){const r=this.attrs[t];return r===void 0?n:r}},addSetter(l,t,n,a){const r=Fh+mt._capitalize(t);l.prototype[r]||lt.overWriteSetter(l,t,n,a)},overWriteSetter(l,t,n,a){const r=Fh+mt._capitalize(t);l.prototype[r]=function(o){return n&&o!==void 0&&o!==null&&(o=n.call(this,o,t)),this._setAttr(t,o),a&&a.call(this),this}},addComponentsGetterSetter(l,t,n,a,r){const o=n.length,f=mt._capitalize,h=Xh+f(t),g=Fh+f(t);l.prototype[h]=function(){const _={};for(let C=0;C<o;C++){const E=n[C];_[E]=this.getAttr(t+f(E))}return _};const m=Z3(n);l.prototype[g]=function(_){const C=this.attrs[t];a&&(_=a.call(this,_,t)),m&&m.call(this,_,t);for(const E in _)_.hasOwnProperty(E)&&this._setAttr(t+f(E),_[E]);return _||n.forEach(E=>{this._setAttr(t+f(E),void 0)}),this._fireChangeEvent(t,C,_),r&&r.call(this),this},lt.addOverloadedGetterSetter(l,t)},addOverloadedGetterSetter(l,t){const n=mt._capitalize(t),a=Fh+n,r=Xh+n;l.prototype[t]=function(){return arguments.length?(this[a](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(l,t,n,a){mt.error("Adding deprecated "+t);const r=Xh+mt._capitalize(t),o=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";l.prototype[r]=function(){mt.error(o);const f=this.attrs[t];return f===void 0?n:f},lt.addSetter(l,t,a,function(){mt.error(o)}),lt.addOverloadedGetterSetter(l,t)},backCompat(l,t){mt.each(t,function(n,a){const r=l.prototype[a],o=Xh+mt._capitalize(n),f=Fh+mt._capitalize(n);function h(){r.apply(this,arguments),mt.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+a+'" instead.')}l.prototype[n]=h,l.prototype[o]=h,l.prototype[f]=h})},afterSetFilter(){this._filterUpToDate=!1}};function W3(l){const t=/(\w+)\(([^)]+)\)/g;let n;for(;(n=t.exec(l))!==null;){const[,a,r]=n;switch(a){case"blur":{const o=parseFloat(r.replace("px",""));return function(f){this.blurRadius(o*.5);const h=Xt.Filters;h&&h.Blur&&h.Blur.call(this,f)}}case"brightness":{const o=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(f){this.brightness(o);const h=Xt.Filters;h&&h.Brightness&&h.Brightness.call(this,f)}}case"contrast":{const o=parseFloat(r);return function(f){const h=100*(Math.sqrt(o)-1);this.contrast(h);const g=Xt.Filters;g&&g.Contrast&&g.Contrast.call(this,f)}}case"grayscale":return function(o){const f=Xt.Filters;f&&f.Grayscale&&f.Grayscale.call(this,o)};case"sepia":return function(o){const f=Xt.Filters;f&&f.Sepia&&f.Sepia.call(this,o)};case"invert":return function(o){const f=Xt.Filters;f&&f.Invert&&f.Invert.call(this,o)};default:mt.warn(`CSS filter "${a}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const dg="absoluteOpacity",Q0="allEventListeners",gl="absoluteTransform",My="absoluteScale",ou="canvas",$3="Change",t5="children",e5="konva",Tm="listening",n5="mouseenter",a5="mouseleave",i5="pointerenter",r5="pointerleave",s5="touchenter",l5="touchleave",Ny="set",Dy="Shape",gg=" ",jy="stage",so="transform",o5="Stage",Am="visible",u5=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(gg);let c5=1;class qt{constructor(t){this._id=c5++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===so||t===gl)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,n){let a=this._cache.get(t);return(a===void 0||(t===so||t===gl)&&a.dirty===!0)&&(a=n.call(this),this._cache.set(t,a)),a}_calculate(t,n,a){if(!this._attachedDepsListeners.get(t)){const r=n.map(o=>o+"Change.konva").join(gg);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,a)}_getCanvasCache(){return this._cache.get(ou)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===gl&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ou)){const{scene:t,filter:n,hit:a,buffer:r}=this._cache.get(ou);mt.releaseCanvas(t,n,a,r),this._cache.delete(ou)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const n=t||{};let a={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(a=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(n.width||a.width),o=Math.ceil(n.height||a.height),f=n.pixelRatio,h=n.x===void 0?Math.floor(a.x):n.x,g=n.y===void 0?Math.floor(a.y):n.y,m=n.offset||0,_=n.drawBorder||!1,C=n.hitCanvasPixelRatio||1;if(!r||!o){mt.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const E=Math.abs(Math.round(a.x)-h)>.5?1:0,R=Math.abs(Math.round(a.y)-g)>.5?1:0;r+=m*2+E,o+=m*2+R,h-=m,g-=m;const v=new uo({pixelRatio:f,width:r,height:o}),D=new uo({pixelRatio:f,width:0,height:0,willReadFrequently:!0}),B=new Zm({pixelRatio:C,width:r,height:o}),L=v.getContext(),N=B.getContext(),M=new uo({width:v.width/v.pixelRatio+Math.abs(h),height:v.height/v.pixelRatio+Math.abs(g),pixelRatio:v.pixelRatio}),G=M.getContext();return B.isCache=!0,v.isCache=!0,this._cache.delete(ou),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,D.getContext()._context.imageSmoothingEnabled=!1),L.save(),N.save(),G.save(),L.translate(-h,-g),N.translate(-h,-g),G.translate(-h,-g),M.x=h,M.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(dg),this._clearSelfAndDescendantCache(My),this.drawScene(v,this,M),this.drawHit(B,this),this._isUnderCache=!1,L.restore(),N.restore(),_&&(L.save(),L.beginPath(),L.rect(0,0,r,o),L.closePath(),L.setAttr("strokeStyle","red"),L.setAttr("lineWidth",5),L.stroke(),L.restore()),this._cache.set(ou,{scene:v,filter:D,hit:B,buffer:M,x:h,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(ou)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,n){const a=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,o=1/0,f=-1/0,h=-1/0;const g=this.getAbsoluteTransform(n);return a.forEach(function(m){const _=g.point(m);r===void 0&&(r=f=_.x,o=h=_.y),r=Math.min(r,_.x),o=Math.min(o,_.y),f=Math.max(f,_.x),h=Math.max(h,_.y)}),{x:r,y:o,width:f-r,height:h-o}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();t.translate(n.x,n.y);const a=this._getCachedSceneCanvas(),r=a.pixelRatio;t.drawImage(a._canvas,0,0,a.width/r,a.height/r),t.restore()}_drawCachedHitCanvas(t){const n=this._getCanvasCache(),a=n.hit;t.save(),t.translate(n.x,n.y),t.drawImage(a._canvas,0,0,a.width/a.pixelRatio,a.height/a.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),n=this._getCanvasCache(),a=n.scene,r=n.filter,o=r.getContext(),f,h,g,m;if(!t||t.length===0)return a;if(this._filterUpToDate)return r;let _=!0;for(let E=0;E<t.length;E++)if(typeof t[E]=="string"&&wy(),typeof t[E]!="string"||!wy()){_=!1;break}const C=a.pixelRatio;if(r.setSize(a.width/a.pixelRatio,a.height/a.pixelRatio),_){const E=t.join(" ");return o.save(),o.setAttr("filter",E),o.drawImage(a._canvas,0,0,a.getWidth()/C,a.getHeight()/C),o.restore(),this._filterUpToDate=!0,r}try{for(f=t.length,o.clear(),o.drawImage(a._canvas,0,0,a.getWidth()/C,a.getHeight()/C),h=o.getImageData(0,0,r.getWidth(),r.getHeight()),g=0;g<f;g++)m=t[g],typeof m=="string"&&(m=W3(m)),m.call(this,h),o.putImageData(h,0,0)}catch(E){mt.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,n){if(this._cache&&this._cache.delete(Q0),arguments.length===3)return this._delegate.apply(this,arguments);const a=t.split(gg);for(let r=0;r<a.length;r++){const f=a[r].split("."),h=f[0],g=f[1]||"";this.eventListeners[h]||(this.eventListeners[h]=[]),this.eventListeners[h].push({name:g,handler:n})}return this}off(t,n){let a=(t||"").split(gg),r=a.length,o,f,h,g,m,_;if(this._cache&&this._cache.delete(Q0),!t)for(f in this.eventListeners)this._off(f);for(o=0;o<r;o++)if(h=a[o],g=h.split("."),m=g[0],_=g[1],m)this.eventListeners[m]&&this._off(m,_,n);else for(f in this.eventListeners)this._off(f,_,n);return this}dispatchEvent(t){const n={target:this,type:t.type,evt:t};return this.fire(t.type,n),this}addEventListener(t,n){return this.on(t,function(a){n.call(this,a.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,n,a){const r=this;this.on(t,function(o){const f=o.target.findAncestors(n,!0,r);for(let h=0;h<f.length;h++)o=mt.cloneObject(o),o.currentTarget=f[h],a.call(f[h],o)})}remove(){return this.isDragging()&&this.stopDrag(),fn._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(gl),this._clearSelfAndDescendantCache(dg),this._clearSelfAndDescendantCache(My),this._clearSelfAndDescendantCache(jy),this._clearSelfAndDescendantCache(Am),this._clearSelfAndDescendantCache(Tm)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const n="get"+mt._capitalize(t);return mt._isFunction(this[n])?this[n]():this.attrs[t]}getAncestors(){let t=this.getParent(),n=[];for(;t;)n.push(t),t=t.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let n,a;if(!t)return this;for(n in t)n!==t5&&(a=Ny+mt._capitalize(n),mt._isFunction(this[a])?this[a](t[n]):this._setAttr(n,t[n]))}),this}isListening(){return this._getCache(Tm,this._isListening)}_isListening(t){if(!this.listening())return!1;const a=this.getParent();return a&&a!==t&&this!==t?a._isListening(t):!0}isVisible(){return this._getCache(Am,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const a=this.getParent();return a&&a!==t&&this!==t?a._isVisible(t):!0}shouldDrawHit(t,n=!1){if(t)return this._isVisible(t)&&this._isListening(t);const a=this.getLayer();let r=!1;fn._dragElements.forEach(f=>{f.dragStatus==="dragging"&&(f.node.nodeType==="Stage"||f.node.getLayer()===a)&&(r=!0)});const o=!n&&!Xt.hitOnDragEnabled&&(r||Xt.isTransforming());return this.isListening()&&this.isVisible()&&!o}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),n=this,a=0,r,o,f,h;function g(_){for(r=[],o=_.length,f=0;f<o;f++)h=_[f],a++,h.nodeType!==Dy&&(r=r.concat(h.getChildren().slice())),h._id===n._id&&(f=o);r.length>0&&r[0].getDepth()<=t&&g(r)}const m=this.getStage();return n.nodeType!==o5&&m&&g(m.getChildren()),a}getDepth(){let t=0,n=this.parent;for(;n;)t++,n=n.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(so),this._clearSelfAndDescendantCache(gl)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const n=t.getPointerPosition();if(!n)return null;const a=this.getAbsoluteTransform().copy();return a.invert(),a.point(n)}getAbsolutePosition(t){let n=!1,a=this.parent;for(;a;){if(a.isCached()){n=!0;break}a=a.parent}n&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),o=new Gi,f=this.offset();return o.m=r.slice(),o.translate(f.x,f.y),o.getTranslation()}setAbsolutePosition(t){const{x:n,y:a,...r}=this._clearTransform();this.attrs.x=n,this.attrs.y=a,this._clearCache(so);const o=this._getAbsoluteTransform().copy();return o.invert(),o.translate(t.x,t.y),t={x:this.attrs.x+o.getTranslation().x,y:this.attrs.y+o.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(so),this._clearSelfAndDescendantCache(gl),this}_setTransform(t){let n;for(n in t)this.attrs[n]=t[n]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let n=t.x,a=t.y,r=this.x(),o=this.y();return n!==void 0&&(r+=n),a!==void 0&&(o+=a),this.setPosition({x:r,y:o}),this}_eachAncestorReverse(t,n){let a=[],r=this.getParent(),o,f;if(!(n&&n._id===this._id)){for(a.unshift(this);r&&(!n||r._id!==n._id);)a.unshift(r),r=r.parent;for(o=a.length,f=0;f<o;f++)t(a[f])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return mt.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return mt.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return mt.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return mt.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return mt.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&mt.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(dg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(t*=n.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),n,a,r,o,f;const h={attrs:{},className:this.getClassName()};for(n in t)a=t[n],f=mt.isObject(a)&&!mt._isPlainObject(a)&&!mt._isArray(a),!f&&(r=typeof this[n]=="function"&&this[n],delete t[n],o=r?r.call(this):null,t[n]=a,o!==a&&(h.attrs[n]=a));return mt._prepareToStringify(h)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,n,a){const r=[];n&&this._isMatch(t)&&r.push(this);let o=this.parent;for(;o;){if(o===a)return r;o._isMatch(t)&&r.push(o),o=o.parent}return r}isAncestorOf(t){return!1}findAncestor(t,n,a){return this.findAncestors(t,n,a)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let n=t.replace(/ /g,"").split(","),a=n.length,r,o;for(r=0;r<a;r++)if(o=n[r],mt.isValidSelector(o)||(mt.warn('Selector "'+o+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),mt.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),mt.warn("Konva is awesome, right?")),o.charAt(0)==="#"){if(this.id()===o.slice(1))return!0}else if(o.charAt(0)==="."){if(this.hasName(o.slice(1)))return!0}else if(this.className===o||this.nodeType===o)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(jy,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,n={},a){return n.target=n.target||this,a?this._fireAndBubble(t,n):this._fire(t,n),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(gl,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let n;if(t)return n=new Gi,this._eachAncestorReverse(function(a){const r=a.transformsEnabled();r==="all"?n.multiply(a.getTransform()):r==="position"&&n.translate(a.x()-a.offsetX(),a.y()-a.offsetY())},t),n;{n=this._cache.get(gl)||new Gi,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const a=this.transformsEnabled();if(a==="all")n.multiply(this.getTransform());else if(a==="position"){const r=this.attrs.x||0,o=this.attrs.y||0,f=this.attrs.offsetX||0,h=this.attrs.offsetY||0;n.translate(r-f,o-h)}return n.dirty=!1,n}}getAbsoluteScale(t){let n=this;for(;n;)n._isUnderCache&&(t=n),n=n.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(so,this._getTransform)}_getTransform(){var t,n;const a=this._cache.get(so)||new Gi;a.reset();const r=this.x(),o=this.y(),f=Xt.getAngle(this.rotation()),h=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,_=this.attrs.skewY||0,C=this.attrs.offsetX||0,E=this.attrs.offsetY||0;return(r!==0||o!==0)&&a.translate(r,o),f!==0&&a.rotate(f),(m!==0||_!==0)&&a.skew(m,_),(h!==1||g!==1)&&a.scale(h,g),(C!==0||E!==0)&&a.translate(-1*C,-1*E),a.dirty=!1,a}clone(t){let n=mt.cloneObject(this.attrs),a,r,o,f,h;for(a in t)n[a]=t[a];const g=new this.constructor(n);for(a in this.eventListeners)for(r=this.eventListeners[a],o=r.length,f=0;f<o;f++)h=r[f],h.name.indexOf(e5)<0&&(g.eventListeners[a]||(g.eventListeners[a]=[]),g.eventListeners[a].push(h));return g}_toKonvaCanvas(t){t=t||{};const n=this.getClientRect(),a=this.getStage(),r=t.x!==void 0?t.x:Math.floor(n.x),o=t.y!==void 0?t.y:Math.floor(n.y),f=t.pixelRatio||1,h=new uo({width:t.width||Math.ceil(n.width)||(a?a.width():0),height:t.height||Math.ceil(n.height)||(a?a.height():0),pixelRatio:f}),g=h.getContext(),m=new uo({width:h.width/h.pixelRatio+Math.abs(r),height:h.height/h.pixelRatio+Math.abs(o),pixelRatio:h.pixelRatio});return t.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(r||o)&&g.translate(-1*r,-1*o),this.drawScene(h,void 0,m),g.restore(),h}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const n=t.mimeType||null,a=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(n,a);return t.callback&&t.callback(r),r}toImage(t){return new Promise((n,a)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,mt._urlToImage(this.toDataURL(t),function(o){n(o),r==null||r(o)})}catch(r){a(r)}})}toBlob(t){return new Promise((n,a)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(o=>{n(o),r==null||r(o)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(r){a(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Xt.dragDistance}_off(t,n,a){let r=this.eventListeners[t],o,f,h;for(o=0;o<r.length;o++)if(f=r[o].name,h=r[o].handler,(f!=="konva"||n==="konva")&&(!n||f===n)&&(!a||a===h)){if(r.splice(o,1),r.length===0){delete this.eventListeners[t];break}o--}}_fireChangeEvent(t,n,a){this._fire(t+$3,{oldVal:n,newVal:a})}addName(t){if(!this.hasName(t)){const n=this.name(),a=n?n+" "+t:t;this.name(a)}return this}hasName(t){if(!t)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const n=(this.name()||"").split(/\s/g),a=n.indexOf(t);return a!==-1&&(n.splice(a,1),this.name(n.join(" "))),this}setAttr(t,n){const a=this[Ny+mt._capitalize(t)];return mt._isFunction(a)?a.call(this,n):this._setAttr(t,n),this}_requestDraw(){if(Xt.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,n){const a=this.attrs[t];a===n&&!mt.isObject(n)||(n==null?delete this.attrs[t]:this.attrs[t]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(t,a,n),this._requestDraw())}_setComponentAttr(t,n,a){let r;a!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][n]=a,this._fireChangeEvent(t,r,a))}_fireAndBubble(t,n,a){n&&this.nodeType===Dy&&(n.target=this);const r=[n5,a5,i5,r5,s5,l5];if(!(r.indexOf(t)!==-1&&(a&&(this===a||this.isAncestorOf&&this.isAncestorOf(a))||this.nodeType==="Stage"&&!a))){this._fire(t,n);const f=r.indexOf(t)!==-1&&a&&a.isAncestorOf&&a.isAncestorOf(this)&&!a.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!f&&(a&&a.parent?this._fireAndBubble.call(this.parent,t,n,a):this._fireAndBubble.call(this.parent,t,n))}}_getProtoListeners(t){var n,a,r;const o=(n=this._cache.get(Q0))!==null&&n!==void 0?n:{};let f=o==null?void 0:o[t];if(f===void 0){f=[];let h=Object.getPrototypeOf(this);for(;h;){const g=(r=(a=h.eventListeners)===null||a===void 0?void 0:a[t])!==null&&r!==void 0?r:[];f.push(...g),h=Object.getPrototypeOf(h)}o[t]=f,this._cache.set(Q0,o)}return f}_fire(t,n){n=n||{},n.currentTarget=this,n.type=t;const a=this._getProtoListeners(t);if(a)for(let o=0;o<a.length;o++)a[o].handler.call(this,n);const r=this.eventListeners[t];if(r)for(let o=0;o<r.length;o++)r[o].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const n=t?t.pointerId:void 0,a=this.getStage(),r=this.getAbsolutePosition();if(!a)return;const o=a._getPointerById(n)||a._changedPointerPositions[0]||r;fn._dragElements.set(this._id,{node:this,startPointerPos:o,offset:{x:o.x-r.x,y:o.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(t,n=!0){fn._dragElements.has(this._id)||this._createDragElement(t);const a=fn._dragElements.get(this._id);a.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},n)}_setDragPosition(t,n){const a=this.getStage()._getPointerById(n.pointerId);if(!a)return;let r={x:a.x-n.offset.x,y:a.y-n.offset.y};const o=this.dragBoundFunc();if(o!==void 0){const f=o.call(this,r,t);f?r=f:mt.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const n=fn._dragElements.get(this._id);n&&(n.dragStatus="stopped"),fn._endDragBefore(t),fn._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=fn._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Xt.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;fn._dragElements.forEach(o=>{this.isAncestorOf(o.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=fn._dragElements.get(this._id),a=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";a?this.stopDrag():r&&fn._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const n=this.getStage();if(!n)return!1;const a={x:-t.x,y:-t.y,width:n.width()+2*t.x,height:n.height()+2*t.y};return mt.haveIntersection(a,this.getClientRect())}static create(t,n){return mt._isString(t)&&(t=JSON.parse(t)),this._createNode(t,n)}static _createNode(t,n){let a=qt.prototype.getClassName.call(t),r=t.children,o,f,h;n&&(t.attrs.container=n),Xt[a]||(mt.warn('Can not find a node with class name "'+a+'". Fallback to "Shape".'),a="Shape");const g=Xt[a];if(o=new g(t.attrs),r)for(f=r.length,h=0;h<f;h++)o.add(qt._createNode(r[h]));return o}}qt.prototype.nodeType="Node";qt.prototype._attrsAffectingSize=[];qt.prototype.eventListeners={};qt.prototype.on.call(qt.prototype,u5,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(so),this._clearSelfAndDescendantCache(gl)});qt.prototype.on.call(qt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Am)});qt.prototype.on.call(qt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Tm)});qt.prototype.on.call(qt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(dg)});const Rn=lt.addGetterSetter;Rn(qt,"zIndex");Rn(qt,"absolutePosition");Rn(qt,"position");Rn(qt,"x",0,Vt());Rn(qt,"y",0,Vt());Rn(qt,"globalCompositeOperation","source-over",bu());Rn(qt,"opacity",1,Vt());Rn(qt,"name","",bu());Rn(qt,"id","",bu());Rn(qt,"rotation",0,Vt());lt.addComponentsGetterSetter(qt,"scale",["x","y"]);Rn(qt,"scaleX",1,Vt());Rn(qt,"scaleY",1,Vt());lt.addComponentsGetterSetter(qt,"skew",["x","y"]);Rn(qt,"skewX",0,Vt());Rn(qt,"skewY",0,Vt());lt.addComponentsGetterSetter(qt,"offset",["x","y"]);Rn(qt,"offsetX",0,Vt());Rn(qt,"offsetY",0,Vt());Rn(qt,"dragDistance",void 0,Vt());Rn(qt,"width",0,Vt());Rn(qt,"height",0,Vt());Rn(qt,"listening",!0,kr());Rn(qt,"preventDefault",!0,kr());Rn(qt,"filters",void 0,function(l){return this._filterUpToDate=!1,l});Rn(qt,"visible",!0,kr());Rn(qt,"transformsEnabled","all",bu());Rn(qt,"size");Rn(qt,"dragBoundFunc");Rn(qt,"draggable",!1,kr());lt.backCompat(qt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Ii extends qt{constructor(){super(...arguments),this.children=[]}getChildren(t){const n=this.children||[];return t?n.filter(t):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let a=0;a<t.length;a++)this.add(t[a]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const n=this._generalFind(t,!0);return n.length>0?n[0]:void 0}_generalFind(t,n){const a=[];return this._descendants(r=>{const o=r._isMatch(t);return o&&a.push(r),!!(o&&n)}),a}_descendants(t){let n=!1;const a=this.getChildren();for(const r of a){if(n=t(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(t),n))return!0}return!1}toObject(){const t=qt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(n=>{t.children.push(n.toObject())}),t}isAncestorOf(t){let n=t.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(t){const n=qt.prototype.clone.call(this,t);return this.getChildren().forEach(function(a){n.add(a.clone())}),n}getAllIntersections(t){const n=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(t)&&n.push(a)}),n}_clearSelfAndDescendantCache(t){var n;super._clearSelfAndDescendantCache(t),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(a){a._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(n,a){n.index=a}),this._requestDraw()}drawScene(t,n,a){const r=this.getLayer(),o=t||r&&r.getCanvas(),f=o&&o.getContext(),h=this._getCanvasCache(),g=h&&h.scene,m=o&&o.isCache;if(!this.isVisible()&&!m)return this;if(g){f.save();const _=this.getAbsoluteTransform(n).getMatrix();f.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",o,n,a);return this}drawHit(t,n){if(!this.shouldDrawHit(n))return this;const a=this.getLayer(),r=t||a&&a.hitCanvas,o=r&&r.getContext(),f=this._getCanvasCache();if(f&&f.hit){o.save();const g=this.getAbsoluteTransform(n).getMatrix();o.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(o),o.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(t,n,a,r){var o;const f=n&&n.getContext(),h=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),_=typeof h=="number"&&typeof g=="number"||m,C=a===this;if(_){f.save();const R=this.getAbsoluteTransform(a);let v=R.getMatrix();f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),f.beginPath();let D;if(m)D=m.call(this,f,this);else{const B=this.clipX(),L=this.clipY();f.rect(B||0,L||0,h,g)}f.clip.apply(f,D),v=R.copy().invert().getMatrix(),f.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const E=!C&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(f.save(),f._applyGlobalCompositeOperation(this)),(o=this.children)===null||o===void 0||o.forEach(function(R){R[t](n,a,r)}),E&&f.restore(),_&&f.restore()}getClientRect(t={}){var n;const a=t.skipTransform,r=t.relativeTo;let o,f,h,g,m={x:1/0,y:1/0,width:0,height:0};const _=this;(n=this.children)===null||n===void 0||n.forEach(function(R){if(!R.visible())return;const v=R.getClientRect({relativeTo:_,skipShadow:t.skipShadow,skipStroke:t.skipStroke});v.width===0&&v.height===0||(o===void 0?(o=v.x,f=v.y,h=v.x+v.width,g=v.y+v.height):(o=Math.min(o,v.x),f=Math.min(f,v.y),h=Math.max(h,v.x+v.width),g=Math.max(g,v.y+v.height)))});const C=this.find("Shape");let E=!1;for(let R=0;R<C.length;R++)if(C[R]._isVisible(this)){E=!0;break}return E&&o!==void 0?m={x:o,y:f,width:h-o,height:g-f}:m={x:0,y:0,width:0,height:0},a?m:this._transformedRect(m,r)}}lt.addComponentsGetterSetter(Ii,"clip",["x","y","width","height"]);lt.addGetterSetter(Ii,"clipX",void 0,Vt());lt.addGetterSetter(Ii,"clipY",void 0,Vt());lt.addGetterSetter(Ii,"clipWidth",void 0,Vt());lt.addGetterSetter(Ii,"clipHeight",void 0,Vt());lt.addGetterSetter(Ii,"clipFunc");const dd=new Map,B2=Xt._global.PointerEvent!==void 0;function Ap(l){return dd.get(l)}function $m(l){return{evt:l,pointerId:l.pointerId}}function z2(l,t){return dd.get(l)===t}function L2(l,t){id(l),t.getStage()&&(dd.set(l,t),B2&&t._fire("gotpointercapture",$m(new PointerEvent("gotpointercapture"))))}function id(l,t){const n=dd.get(l);if(!n)return;const a=n.getStage();a&&a.content,dd.delete(l),B2&&n._fire("lostpointercapture",$m(new PointerEvent("lostpointercapture")))}const f5="Stage",h5="string",Uy="px",d5="mouseout",G2="mouseleave",P2="mouseover",H2="mouseenter",I2="mousemove",k2="mousedown",q2="mouseup",Wh="pointermove",$h="pointerdown",uf="pointerup",td="pointercancel",g5="lostpointercapture",X0="pointerout",ed="pointerleave",F0="pointerover",J0="pointerenter",wm="contextmenu",V2="touchstart",Y2="touchend",K2="touchmove",Q2="touchcancel",Rm="wheel",p5=5,m5=[[H2,"_pointerenter"],[k2,"_pointerdown"],[I2,"_pointermove"],[q2,"_pointerup"],[G2,"_pointerleave"],[V2,"_pointerdown"],[K2,"_pointermove"],[Y2,"_pointerup"],[Q2,"_pointercancel"],[P2,"_pointerover"],[Rm,"_wheel"],[wm,"_contextmenu"],[$h,"_pointerdown"],[Wh,"_pointermove"],[uf,"_pointerup"],[td,"_pointercancel"],[ed,"_pointerleave"],[g5,"_lostpointercapture"]],wp={mouse:{[X0]:d5,[ed]:G2,[F0]:P2,[J0]:H2,[Wh]:I2,[$h]:k2,[uf]:q2,[td]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[X0]:"touchout",[ed]:"touchleave",[F0]:"touchover",[J0]:"touchenter",[Wh]:K2,[$h]:V2,[uf]:Y2,[td]:Q2,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[X0]:X0,[ed]:ed,[F0]:F0,[J0]:J0,[Wh]:Wh,[$h]:$h,[uf]:uf,[td]:td,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},nd=l=>l.indexOf("pointer")>=0?"pointer":l.indexOf("touch")>=0?"touch":"mouse",Fc=l=>{const t=nd(l);if(t==="pointer")return Xt.pointerEventsEnabled&&wp.pointer;if(t==="touch")return wp.touch;if(t==="mouse")return wp.mouse};function By(l={}){return(l.clipFunc||l.clipWidth||l.clipHeight)&&mt.warn("Stage does not support clipping. Please use clip for Layers or Groups."),l}const v5="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",rd=[];let Og=class extends Ii{constructor(t){super(By(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),rd.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{By(this.attrs)}),this._checkVisibility()}_validateAdd(t){const n=t.getType()==="Layer",a=t.getType()==="FastLayer";n||a||mt.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===h5){let n;if(t.charAt(0)==="."){const a=t.slice(1);t=document.getElementsByClassName(a)[0]}else t.charAt(0)!=="#"?n=t:n=t.slice(1),t=document.getElementById(n);if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,n=t.length;for(let a=0;a<n;a++)t[a].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),Ii.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&mt._isInDocument(t)&&this.container().removeChild(t);const n=rd.indexOf(this);return n>-1&&rd.splice(n,1),mt.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(mt.warn(v5),null)}_getPointerById(t){return this._pointerPositions.find(n=>n.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const n=new uo({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),a=n.getContext()._context,r=this.children;return(t.x||t.y)&&a.translate(-1*t.x,-1*t.y),r.forEach(function(o){if(!o.isVisible())return;const f=o._toKonvaCanvas(t);a.drawImage(f._canvas,t.x,t.y,f.getWidth()/f.getPixelRatio(),f.getHeight()/f.getPixelRatio())}),n}getIntersection(t){if(!t)return null;const n=this.children,a=n.length,r=a-1;for(let o=r;o>=0;o--){const f=n[o].getIntersection(t);if(f)return f}return null}_resizeDOM(){const t=this.width(),n=this.height();this.content&&(this.content.style.width=t+Uy,this.content.style.height=n+Uy),this.bufferCanvas.setSize(t,n),this.bufferHitCanvas.setSize(t,n),this.children.forEach(a=>{a.setSize({width:t,height:n}),a.draw()})}add(t,...n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const a=this.children.length;return a>p5&&mt.warn("The stage has "+a+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Xt.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return z2(t,this)}setPointerCapture(t){L2(t,this)}releaseCapture(t){id(t)}getLayers(){return this.children}_bindContentEvents(){Xt.isBrowser&&m5.forEach(([t,n])=>{this.content.addEventListener(t,a=>{this[n](a)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const n=Fc(t.type);n&&this._fire(n.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const n=Fc(t.type);n&&this._fire(n.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let n=this[t+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(t){const n=Fc(t.type),a=nd(t.type);if(!n)return;this.setPointersPositions(t);const r=this._getTargetShape(a),o=!(Xt.isDragging()||Xt.isTransforming())||Xt.hitOnDragEnabled;r&&o?(r._fireAndBubble(n.pointerout,{evt:t}),r._fireAndBubble(n.pointerleave,{evt:t}),this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this[a+"targetShape"]=null):o&&(this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const n=Fc(t.type),a=nd(t.type);if(!n)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(o=>{const f=this.getIntersection(o);if(fn.justDragged=!1,Xt["_"+a+"ListenClick"]=!0,!f||!f.isListening()){this[a+"ClickStartShape"]=void 0;return}Xt.capturePointerEventsEnabled&&f.setPointerCapture(o.id),this[a+"ClickStartShape"]=f,f._fireAndBubble(n.pointerdown,{evt:t,pointerId:o.id}),r=!0;const h=t.type.indexOf("touch")>=0;f.preventDefault()&&t.cancelable&&h&&t.preventDefault()}),r||this._fire(n.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const n=Fc(t.type),a=nd(t.type);if(!n)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(Xt.isDragging()&&fn.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(Xt.isDragging()||Xt.isTransforming())||Xt.hitOnDragEnabled))return;const f={};let h=!1;const g=this._getTargetShape(a);this._changedPointerPositions.forEach(m=>{const _=Ap(m.id)||this.getIntersection(m),C=m.id,E={evt:t,pointerId:C},R=g!==_;if(R&&g&&(g._fireAndBubble(n.pointerout,{...E},_),g._fireAndBubble(n.pointerleave,{...E},_)),_){if(f[_._id])return;f[_._id]=!0}_&&_.isListening()?(h=!0,R&&(_._fireAndBubble(n.pointerover,{...E},g),_._fireAndBubble(n.pointerenter,{...E},g),this[a+"targetShape"]=_),_._fireAndBubble(n.pointermove,{...E})):g&&(this._fire(n.pointerover,{evt:t,target:this,currentTarget:this,pointerId:C}),this[a+"targetShape"]=null)}),h||this._fire(n.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const n=Fc(t.type),a=nd(t.type);if(!n)return;this.setPointersPositions(t);const r=this[a+"ClickStartShape"],o=this[a+"ClickEndShape"],f={};let h=!1;this._changedPointerPositions.forEach(g=>{const m=Ap(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),f[m._id])return;f[m._id]=!0}const _=g.id,C={evt:t,pointerId:_};let E=!1;Xt["_"+a+"InDblClickWindow"]?(E=!0,clearTimeout(this[a+"DblTimeout"])):fn.justDragged||(Xt["_"+a+"InDblClickWindow"]=!0,clearTimeout(this[a+"DblTimeout"])),this[a+"DblTimeout"]=setTimeout(function(){Xt["_"+a+"InDblClickWindow"]=!1},Xt.dblClickWindow),m&&m.isListening()?(h=!0,this[a+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...C}),Xt["_"+a+"ListenClick"]&&r&&r===m&&(m._fireAndBubble(n.pointerclick,{...C}),E&&o&&o===m&&m._fireAndBubble(n.pointerdblclick,{...C}))):(this[a+"ClickEndShape"]=null,h||(this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),h=!0),Xt["_"+a+"ListenClick"]&&this._fire(n.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:_}),E&&this._fire(n.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:_}))}),h||this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Xt["_"+a+"ListenClick"]=!1,t.cancelable&&a!=="touch"&&a!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(wm,{evt:t}):this._fire(wm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Rm,{evt:t}):this._fire(Rm,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const n=Ap(t.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(uf,$m(t)),id(t.pointerId)}_lostpointercapture(t){id(t.pointerId)}setPointersPositions(t){const n=this._getContentPosition();let a=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,o=>{this._pointerPositions.push({id:o.identifier,x:(o.clientX-n.left)/n.scaleX,y:(o.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,o=>{this._changedPointerPositions.push({id:o.identifier,x:(o.clientX-n.left)/n.scaleX,y:(o.clientY-n.top)/n.scaleY})})):(a=(t.clientX-n.left)/n.scaleX,r=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:a,y:r},this._pointerPositions=[{x:a,y:r,id:mt._getFirstPointerId(t)}],this._changedPointerPositions=[{x:a,y:r,id:mt._getFirstPointerId(t)}])}_setPointerPosition(t){mt.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new uo({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Zm({pixelRatio:1,width:this.width(),height:this.height()}),!Xt.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return mt.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Og.prototype.nodeType=f5;Qn(Og);lt.addGetterSetter(Og,"container");Xt.isBrowser&&document.addEventListener("visibilitychange",()=>{rd.forEach(l=>{l.batchDraw()})});const X2="hasShadow",F2="shadowRGBA",J2="patternImage",Z2="linearGradient",W2="radialGradient";let Z0;function Rp(){return Z0||(Z0=mt.createCanvasElement().getContext("2d"),Z0)}const sd={};function y5(l){const t=this.attrs.fillRule;t?l.fill(t):l.fill()}function S5(l){l.stroke()}function b5(l){const t=this.attrs.fillRule;t?l.fill(t):l.fill()}function _5(l){l.stroke()}function E5(){this._clearCache(X2)}function C5(){this._clearCache(F2)}function T5(){this._clearCache(J2)}function A5(){this._clearCache(Z2)}function w5(){this._clearCache(W2)}class Gt extends qt{constructor(t){super(t);let n;for(;n=mt.getRandomColor(),!(n&&!(n in sd)););this.colorKey=n,sd[n]=this}getContext(){return mt.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return mt.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(X2,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(J2,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Rp().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const a=new Gi;a.translate(this.fillPatternX(),this.fillPatternY()),a.rotate(Xt.getAngle(this.fillPatternRotation())),a.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),a.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=a.getMatrix(),o=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(o)}return n}}_getLinearGradient(){return this._getCache(Z2,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const n=Rp(),a=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),o=n.createLinearGradient(a.x,a.y,r.x,r.y);for(let f=0;f<t.length;f+=2)o.addColorStop(t[f],t[f+1]);return o}}_getRadialGradient(){return this._getCache(W2,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const n=Rp(),a=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),o=n.createRadialGradient(a.x,a.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let f=0;f<t.length;f+=2)o.addColorStop(t[f],t[f+1]);return o}}getShadowRGBA(){return this._getCache(F2,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=mt.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const n=this.getStage();if(!n)return!1;const a=n.bufferHitCanvas;return a.getContext().clear(),this.drawHit(a,void 0,!0),a.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return qt.prototype.destroy.call(this),delete sd[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=t||this.hasFill(),o=this.hasStroke(),f=this.getAbsoluteOpacity()!==1;if(r&&o&&f)return!0;const h=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(r&&o&&h&&g)}setStrokeHitEnabled(t){mt.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let n=!1,a=this.getParent();for(;a;){if(a.isCached()){n=!0;break}a=a.getParent()}const r=t.skipTransform,o=t.relativeTo||n&&this.getStage()||void 0,f=this.getSelfRect(),g=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=f.width+g,_=f.height+g,C=!t.skipShadow&&this.hasShadow(),E=C?this.shadowOffsetX():0,R=C?this.shadowOffsetY():0,v=m+Math.abs(E),D=_+Math.abs(R),B=C&&this.shadowBlur()||0,L=v+B*2,N=D+B*2,M={width:L,height:N,x:-(g/2+B)+Math.min(E,0)+f.x,y:-(g/2+B)+Math.min(R,0)+f.y};return r?M:this._transformedRect(M,o)}drawScene(t,n,a){const r=this.getLayer(),o=t||r.getCanvas(),f=o.getContext(),h=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let _;const C=n===this;if(!this.isVisible()&&!C)return this;if(h){f.save();const E=this.getAbsoluteTransform(n).getMatrix();return f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedSceneCanvas(f),f.restore(),this}if(!g)return this;if(f.save(),this._useBufferCanvas()){_=this.getStage();const E=a||_.bufferCanvas,R=E.getContext();R.clear(),R.save(),R._applyLineJoin(this),R._applyMiterLimit(this);const v=this.getAbsoluteTransform(n).getMatrix();R.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.call(this,R,this),R.restore();const D=E.pixelRatio;m&&f._applyShadow(this),f._applyOpacity(this),f._applyGlobalCompositeOperation(this),f.drawImage(E._canvas,E.x||0,E.y||0,E.width/D,E.height/D)}else{if(f._applyLineJoin(this),f._applyMiterLimit(this),!C){const E=this.getAbsoluteTransform(n).getMatrix();f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),f._applyOpacity(this),f._applyGlobalCompositeOperation(this)}m&&f._applyShadow(this),g.call(this,f,this)}return f.restore(),this}drawHit(t,n,a=!1){if(!this.shouldDrawHit(n,a))return this;const r=this.getLayer(),o=t||r.hitCanvas,f=o&&o.getContext(),h=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||mt.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){f.save();const C=this.getAbsoluteTransform(n).getMatrix();return f.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._drawCachedHitCanvas(f),f.restore(),this}if(!h)return this;if(f.save(),f._applyLineJoin(this),f._applyMiterLimit(this),!(this===n)){const C=this.getAbsoluteTransform(n).getMatrix();f.transform(C[0],C[1],C[2],C[3],C[4],C[5])}return h.call(this,f,this),f.restore(),this}drawHitFromCache(t=0){const n=this._getCanvasCache(),a=this._getCachedSceneCanvas(),r=n.hit,o=r.getContext(),f=r.getWidth(),h=r.getHeight();o.clear(),o.drawImage(a._canvas,0,0,f,h);try{const g=o.getImageData(0,0,f,h),m=g.data,_=m.length,C=mt._hexToRgb(this.colorKey);for(let E=0;E<_;E+=4)m[E+3]>t?(m[E]=C.r,m[E+1]=C.g,m[E+2]=C.b,m[E+3]=255):m[E+3]=0;o.putImageData(g,0,0)}catch(g){mt.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return z2(t,this)}setPointerCapture(t){L2(t,this)}releaseCapture(t){id(t)}}Gt.prototype._fillFunc=y5;Gt.prototype._strokeFunc=S5;Gt.prototype._fillFuncHit=b5;Gt.prototype._strokeFuncHit=_5;Gt.prototype._centroid=!1;Gt.prototype.nodeType="Shape";Qn(Gt);Gt.prototype.eventListeners={};Gt.prototype.on.call(Gt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",E5);Gt.prototype.on.call(Gt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",C5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",T5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",A5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",w5);lt.addGetterSetter(Gt,"stroke",void 0,U2());lt.addGetterSetter(Gt,"strokeWidth",2,Vt());lt.addGetterSetter(Gt,"fillAfterStrokeEnabled",!1);lt.addGetterSetter(Gt,"hitStrokeWidth","auto",Wm());lt.addGetterSetter(Gt,"strokeHitEnabled",!0,kr());lt.addGetterSetter(Gt,"perfectDrawEnabled",!0,kr());lt.addGetterSetter(Gt,"shadowForStrokeEnabled",!0,kr());lt.addGetterSetter(Gt,"lineJoin");lt.addGetterSetter(Gt,"lineCap");lt.addGetterSetter(Gt,"miterLimit");lt.addGetterSetter(Gt,"sceneFunc");lt.addGetterSetter(Gt,"hitFunc");lt.addGetterSetter(Gt,"dash");lt.addGetterSetter(Gt,"dashOffset",0,Vt());lt.addGetterSetter(Gt,"shadowColor",void 0,bu());lt.addGetterSetter(Gt,"shadowBlur",0,Vt());lt.addGetterSetter(Gt,"shadowOpacity",1,Vt());lt.addComponentsGetterSetter(Gt,"shadowOffset",["x","y"]);lt.addGetterSetter(Gt,"shadowOffsetX",0,Vt());lt.addGetterSetter(Gt,"shadowOffsetY",0,Vt());lt.addGetterSetter(Gt,"fillPatternImage");lt.addGetterSetter(Gt,"fill",void 0,U2());lt.addGetterSetter(Gt,"fillPatternX",0,Vt());lt.addGetterSetter(Gt,"fillPatternY",0,Vt());lt.addGetterSetter(Gt,"fillLinearGradientColorStops");lt.addGetterSetter(Gt,"strokeLinearGradientColorStops");lt.addGetterSetter(Gt,"fillRadialGradientStartRadius",0);lt.addGetterSetter(Gt,"fillRadialGradientEndRadius",0);lt.addGetterSetter(Gt,"fillRadialGradientColorStops");lt.addGetterSetter(Gt,"fillPatternRepeat","repeat");lt.addGetterSetter(Gt,"fillEnabled",!0);lt.addGetterSetter(Gt,"strokeEnabled",!0);lt.addGetterSetter(Gt,"shadowEnabled",!0);lt.addGetterSetter(Gt,"dashEnabled",!0);lt.addGetterSetter(Gt,"strokeScaleEnabled",!0);lt.addGetterSetter(Gt,"fillPriority","color");lt.addComponentsGetterSetter(Gt,"fillPatternOffset",["x","y"]);lt.addGetterSetter(Gt,"fillPatternOffsetX",0,Vt());lt.addGetterSetter(Gt,"fillPatternOffsetY",0,Vt());lt.addComponentsGetterSetter(Gt,"fillPatternScale",["x","y"]);lt.addGetterSetter(Gt,"fillPatternScaleX",1,Vt());lt.addGetterSetter(Gt,"fillPatternScaleY",1,Vt());lt.addComponentsGetterSetter(Gt,"fillLinearGradientStartPoint",["x","y"]);lt.addComponentsGetterSetter(Gt,"strokeLinearGradientStartPoint",["x","y"]);lt.addGetterSetter(Gt,"fillLinearGradientStartPointX",0);lt.addGetterSetter(Gt,"strokeLinearGradientStartPointX",0);lt.addGetterSetter(Gt,"fillLinearGradientStartPointY",0);lt.addGetterSetter(Gt,"strokeLinearGradientStartPointY",0);lt.addComponentsGetterSetter(Gt,"fillLinearGradientEndPoint",["x","y"]);lt.addComponentsGetterSetter(Gt,"strokeLinearGradientEndPoint",["x","y"]);lt.addGetterSetter(Gt,"fillLinearGradientEndPointX",0);lt.addGetterSetter(Gt,"strokeLinearGradientEndPointX",0);lt.addGetterSetter(Gt,"fillLinearGradientEndPointY",0);lt.addGetterSetter(Gt,"strokeLinearGradientEndPointY",0);lt.addComponentsGetterSetter(Gt,"fillRadialGradientStartPoint",["x","y"]);lt.addGetterSetter(Gt,"fillRadialGradientStartPointX",0);lt.addGetterSetter(Gt,"fillRadialGradientStartPointY",0);lt.addComponentsGetterSetter(Gt,"fillRadialGradientEndPoint",["x","y"]);lt.addGetterSetter(Gt,"fillRadialGradientEndPointX",0);lt.addGetterSetter(Gt,"fillRadialGradientEndPointY",0);lt.addGetterSetter(Gt,"fillPatternRotation",0);lt.addGetterSetter(Gt,"fillRule",void 0,bu());lt.backCompat(Gt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const R5="#",O5="beforeDraw",x5="draw",$2=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],M5=$2.length;let _u=class extends Ii{constructor(t){super(t),this.canvas=new uo,this.hitCanvas=new Zm({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),t<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[t+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){qt.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!qt.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(qt.prototype.moveDown.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(qt.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return qt.prototype.remove.call(this),t&&t.parentNode&&mt._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:n}){return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&mt.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),qt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){mt.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){mt.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,mt.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let n=1,a=!1;for(;;){for(let r=0;r<M5;r++){const o=$2[r],f=this._getIntersection({x:t.x+o.x*n,y:t.y+o.y*n}),h=f.shape;if(h)return h;if(a=!!f.antialiased,!f.antialiased)break}if(a)n+=1;else return null}}_getIntersection(t){const n=this.hitCanvas.pixelRatio,a=this.hitCanvas.context.getImageData(Math.round(t.x*n),Math.round(t.y*n),1,1).data,r=a[3];if(r===255){const o=mt._rgbToHex(a[0],a[1],a[2]),f=sd[R5+o];return f?{shape:f}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,n,a){const r=this.getLayer(),o=t||r&&r.getCanvas();return this._fire(O5,{node:this}),this.clearBeforeDraw()&&o.getContext().clear(),Ii.prototype.drawScene.call(this,o,n,a),this._fire(x5,{node:this}),this}drawHit(t,n){const a=this.getLayer(),r=t||a&&a.hitCanvas;return a&&a.clearBeforeDraw()&&a.getHitCanvas().getContext().clear(),Ii.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){mt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return mt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return mt.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};_u.prototype.nodeType="Layer";Qn(_u);lt.addGetterSetter(_u,"imageSmoothingEnabled",!0);lt.addGetterSetter(_u,"clearBeforeDraw",!0);lt.addGetterSetter(_u,"hitGraphEnabled",!0,kr());class tv extends _u{constructor(t){super(t),this.listening(!1),mt.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}tv.prototype.nodeType="FastLayer";Qn(tv);class ff extends Ii{_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&mt.throw("You may only add groups and shapes to groups.")}}ff.prototype.nodeType="Group";Qn(ff);const Op=(function(){return vu.performance&&vu.performance.now?function(){return vu.performance.now()}:function(){return new Date().getTime()}})();class gr{constructor(t,n){this.id=gr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Op(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(t){let n=[];return t&&(n=Array.isArray(t)?t:[t]),this.layers=n,this}getLayers(){return this.layers}addLayer(t){const n=this.layers,a=n.length;for(let r=0;r<a;r++)if(n[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const n=gr.animations,a=n.length;for(let r=0;r<a;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Op(),gr._addAnimation(this),this}stop(){return gr._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const n=t.id,a=this.animations,r=a.length;for(let o=0;o<r;o++)if(a[o].id===n){this.animations.splice(o,1);break}}static _runFrames(){const t={},n=this.animations;for(let a=0;a<n.length;a++){const r=n[a],o=r.layers,f=r.func;r._updateFrameObject(Op());const h=o.length;let g;if(f?g=f.call(r,r.frame)!==!1:g=!0,!!g)for(let m=0;m<h;m++){const _=o[m];_._id!==void 0&&(t[_._id]=_)}}for(const a in t)t.hasOwnProperty(a)&&t[a].batchDraw()}static _animationLoop(){const t=gr;t.animations.length?(t._runFrames(),mt.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,mt.requestAnimFrame(this._animationLoop))}}gr.animations=[];gr.animIdCounter=0;gr.animRunning=!1;const N5={node:1,duration:1,easing:1,onFinish:1,yoyo:1},D5=1,zy=2,Ly=3,Gy=["fill","stroke","shadowColor"];let j5=0;class U5{constructor(t,n,a,r,o,f,h){this.prop=t,this.propFunc=n,this.begin=r,this._pos=r,this.duration=f,this._change=0,this.prevPos=0,this.yoyo=h,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=a,this._change=o-this.begin,this.pause()}fire(t){const n=this[t];n&&n()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=zy,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Ly,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===zy?this.setTime(t):this.state===Ly&&this.setTime(this.duration-t)}pause(){this.state=D5,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Dn{constructor(t){const n=this,a=t.node,r=a._id,o=t.easing||ld.Linear,f=!!t.yoyo;let h,g;typeof t.duration>"u"?h=.3:t.duration===0?h=.001:h=t.duration,this.node=a,this._id=j5++;const m=a.getLayer()||(a instanceof Xt.Stage?a.getLayers():null);m||mt.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new gr(function(){n.tween.onEnterFrame()},m),this.tween=new U5(g,function(_){n._tweenFunc(_)},o,0,1,h*1e3,f),this._addListeners(),Dn.attrs[r]||(Dn.attrs[r]={}),Dn.attrs[r][this._id]||(Dn.attrs[r][this._id]={}),Dn.tweens[r]||(Dn.tweens[r]={});for(g in t)N5[g]===void 0&&this._addAttr(g,t[g]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,n){const a=this.node,r=a._id;let o,f,h,g,m;const _=Dn.tweens[r][t];_&&delete Dn.attrs[r][_][t];let C=a.getAttr(t);if(mt._isArray(n))if(o=[],f=Math.max(n.length,C.length),t==="points"&&n.length!==C.length&&(n.length>C.length?(g=C,C=mt._prepareArrayForTween(C,n,a.closed())):(h=n,n=mt._prepareArrayForTween(n,C,a.closed()))),t.indexOf("fill")===0)for(let E=0;E<f;E++)if(E%2===0)o.push(n[E]-C[E]);else{const R=mt.colorToRGBA(C[E]);m=mt.colorToRGBA(n[E]),C[E]=R,o.push({r:m.r-R.r,g:m.g-R.g,b:m.b-R.b,a:m.a-R.a})}else for(let E=0;E<f;E++)o.push(n[E]-C[E]);else Gy.indexOf(t)!==-1?(C=mt.colorToRGBA(C),m=mt.colorToRGBA(n),o={r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a}):o=n-C;Dn.attrs[r][this._id][t]={start:C,diff:o,end:n,trueEnd:h,trueStart:g},Dn.tweens[r][t]=this._id}_tweenFunc(t){const n=this.node,a=Dn.attrs[n._id][this._id];let r,o,f,h,g,m,_,C;for(r in a){if(o=a[r],f=o.start,h=o.diff,C=o.end,mt._isArray(f))if(g=[],_=Math.max(f.length,C.length),r.indexOf("fill")===0)for(m=0;m<_;m++)m%2===0?g.push((f[m]||0)+h[m]*t):g.push("rgba("+Math.round(f[m].r+h[m].r*t)+","+Math.round(f[m].g+h[m].g*t)+","+Math.round(f[m].b+h[m].b*t)+","+(f[m].a+h[m].a*t)+")");else for(m=0;m<_;m++)g.push((f[m]||0)+h[m]*t);else Gy.indexOf(r)!==-1?g="rgba("+Math.round(f.r+h.r*t)+","+Math.round(f.g+h.g*t)+","+Math.round(f.b+h.b*t)+","+(f.a+h.a*t)+")":g=f+h*t;n.setAttr(r,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,n=Dn.attrs[t._id][this._id];n.points&&n.points.trueEnd&&t.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,n=Dn.attrs[t._id][this._id];n.points&&n.points.trueStart&&t.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,n=this._id,a=Dn.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in a)delete Dn.tweens[t][r];delete Dn.attrs[t][n],Dn.tweens[t]&&(Object.keys(Dn.tweens[t]).length===0&&delete Dn.tweens[t],Object.keys(Dn.attrs[t]).length===0&&delete Dn.attrs[t])}}Dn.attrs={};Dn.tweens={};qt.prototype.to=function(l){const t=l.onFinish;l.node=this,l.onFinish=function(){this.destroy(),t&&t()},new Dn(l).play()};const ld={BackEaseIn(l,t,n,a){return n*(l/=a)*l*((1.70158+1)*l-1.70158)+t},BackEaseOut(l,t,n,a){return n*((l=l/a-1)*l*((1.70158+1)*l+1.70158)+1)+t},BackEaseInOut(l,t,n,a){let r=1.70158;return(l/=a/2)<1?n/2*(l*l*(((r*=1.525)+1)*l-r))+t:n/2*((l-=2)*l*(((r*=1.525)+1)*l+r)+2)+t},ElasticEaseIn(l,t,n,a,r,o){let f=0;return l===0?t:(l/=a)===1?t+n:(o||(o=a*.3),!r||r<Math.abs(n)?(r=n,f=o/4):f=o/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(l-=1))*Math.sin((l*a-f)*(2*Math.PI)/o))+t)},ElasticEaseOut(l,t,n,a,r,o){let f=0;return l===0?t:(l/=a)===1?t+n:(o||(o=a*.3),!r||r<Math.abs(n)?(r=n,f=o/4):f=o/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*l)*Math.sin((l*a-f)*(2*Math.PI)/o)+n+t)},ElasticEaseInOut(l,t,n,a,r,o){let f=0;return l===0?t:(l/=a/2)===2?t+n:(o||(o=a*(.3*1.5)),!r||r<Math.abs(n)?(r=n,f=o/4):f=o/(2*Math.PI)*Math.asin(n/r),l<1?-.5*(r*Math.pow(2,10*(l-=1))*Math.sin((l*a-f)*(2*Math.PI)/o))+t:r*Math.pow(2,-10*(l-=1))*Math.sin((l*a-f)*(2*Math.PI)/o)*.5+n+t)},BounceEaseOut(l,t,n,a){return(l/=a)<1/2.75?n*(7.5625*l*l)+t:l<2/2.75?n*(7.5625*(l-=1.5/2.75)*l+.75)+t:l<2.5/2.75?n*(7.5625*(l-=2.25/2.75)*l+.9375)+t:n*(7.5625*(l-=2.625/2.75)*l+.984375)+t},BounceEaseIn(l,t,n,a){return n-ld.BounceEaseOut(a-l,0,n,a)+t},BounceEaseInOut(l,t,n,a){return l<a/2?ld.BounceEaseIn(l*2,0,n,a)*.5+t:ld.BounceEaseOut(l*2-a,0,n,a)*.5+n*.5+t},EaseIn(l,t,n,a){return n*(l/=a)*l+t},EaseOut(l,t,n,a){return-n*(l/=a)*(l-2)+t},EaseInOut(l,t,n,a){return(l/=a/2)<1?n/2*l*l+t:-n/2*(--l*(l-2)-1)+t},StrongEaseIn(l,t,n,a){return n*(l/=a)*l*l*l*l+t},StrongEaseOut(l,t,n,a){return n*((l=l/a-1)*l*l*l*l+1)+t},StrongEaseInOut(l,t,n,a){return(l/=a/2)<1?n/2*l*l*l*l*l+t:n/2*((l-=2)*l*l*l*l+2)+t},Linear(l,t,n,a){return n*l/a+t}},hf=mt._assign(Xt,{Util:mt,Transform:Gi,Node:qt,Container:Ii,Stage:Og,stages:rd,Layer:_u,FastLayer:tv,Group:ff,DD:fn,Shape:Gt,shapes:sd,Animation:gr,Tween:Dn,Easings:ld,Context:wg,Canvas:Jm});class ml extends Gt{_sceneFunc(t){const n=Xt.getAngle(this.angle()),a=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,n,a),t.arc(0,0,this.innerRadius(),n,0,!a),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),n=this.outerRadius(),a=this.clockwise(),r=Xt.getAngle(a?360-this.angle():this.angle()),o=Math.cos(Math.min(r,Math.PI)),f=1,h=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),g=Math.sin(Math.min(r,Math.PI/2)),m=o*(o>0?t:n),_=f*n,C=h*(h>0?t:n),E=g*(g>0?n:t);return{x:m,y:a?-1*E:C,width:_-m,height:E-C}}}ml.prototype._centroid=!0;ml.prototype.className="Arc";ml.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];Qn(ml);lt.addGetterSetter(ml,"innerRadius",0,Vt());lt.addGetterSetter(ml,"outerRadius",0,Vt());lt.addGetterSetter(ml,"angle",0,Vt());lt.addGetterSetter(ml,"clockwise",!1,kr());function Om(l,t,n,a,r,o,f){const h=Math.sqrt(Math.pow(n-l,2)+Math.pow(a-t,2)),g=Math.sqrt(Math.pow(r-n,2)+Math.pow(o-a,2)),m=f*h/(h+g),_=f*g/(h+g),C=n-m*(r-l),E=a-m*(o-t),R=n+_*(r-l),v=a+_*(o-t);return[C,E,R,v]}function Py(l,t){const n=l.length,a=[];for(let r=2;r<n-2;r+=2){const o=Om(l[r-2],l[r-1],l[r],l[r+1],l[r+2],l[r+3],t);isNaN(o[0])||(a.push(o[0]),a.push(o[1]),a.push(l[r]),a.push(l[r+1]),a.push(o[2]),a.push(o[3]))}return a}let vl=class extends Gt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const n=this.points(),a=n.length,r=this.tension(),o=this.closed(),f=this.bezier();if(!a)return;let h=0;if(t.beginPath(),t.moveTo(n[0],n[1]),r!==0&&a>4){const g=this.getTensionPoints(),m=g.length;for(h=o?0:4,o||t.quadraticCurveTo(g[0],g[1],g[2],g[3]);h<m-2;)t.bezierCurveTo(g[h++],g[h++],g[h++],g[h++],g[h++],g[h++]);o||t.quadraticCurveTo(g[m-2],g[m-1],n[a-2],n[a-1])}else if(f)for(h=2;h<a;)t.bezierCurveTo(n[h++],n[h++],n[h++],n[h++],n[h++],n[h++]);else for(h=2;h<a;h+=2)t.lineTo(n[h],n[h+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Py(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),n=t.length,a=this.tension(),r=Om(t[n-2],t[n-1],t[0],t[1],t[2],t[3],a),o=Om(t[n-4],t[n-3],t[n-2],t[n-1],t[0],t[1],a),f=Py(t,a);return[r[2],r[3]].concat(f).concat([o[0],o[1],t[n-2],t[n-1],o[2],o[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let n=t[0],a=t[0],r=t[1],o=t[1],f,h;for(let g=0;g<t.length/2;g++)f=t[g*2],h=t[g*2+1],n=Math.min(n,f),a=Math.max(a,f),r=Math.min(r,h),o=Math.max(o,h);return{x:n,y:r,width:a-n,height:o-r}}};vl.prototype.className="Line";vl.prototype._attrsAffectingSize=["points","bezier","tension"];Qn(vl);lt.addGetterSetter(vl,"closed",!1);lt.addGetterSetter(vl,"bezier",!1);lt.addGetterSetter(vl,"tension",0,Vt());lt.addGetterSetter(vl,"points",[],J3());const B5=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],z5=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],L5=[[1],[1,1],[1,2,1],[1,3,3,1]],Hy=(l,t,n)=>{let a,r;const f=n/2;a=0;for(let h=0;h<20;h++)r=f*B5[20][h]+f,a+=z5[20][h]*G5(l,t,r);return f*a},Iy=(l,t,n)=>{n===void 0&&(n=1);const a=l[0]-2*l[1]+l[2],r=t[0]-2*t[1]+t[2],o=2*l[1]-2*l[0],f=2*t[1]-2*t[0],h=4*(a*a+r*r),g=4*(a*o+r*f),m=o*o+f*f;if(h===0)return n*Math.sqrt(Math.pow(l[2]-l[0],2)+Math.pow(t[2]-t[0],2));const _=g/(2*h),C=m/h,E=n+_,R=C-_*_,v=E*E+R>0?Math.sqrt(E*E+R):0,D=_*_+R>0?Math.sqrt(_*_+R):0,B=_+Math.sqrt(_*_+R)!==0?R*Math.log(Math.abs((E+v)/(_+D))):0;return Math.sqrt(h)/2*(E*v-_*D+B)};function G5(l,t,n){const a=xm(1,n,l),r=xm(1,n,t),o=a*a+r*r;return Math.sqrt(o)}const xm=(l,t,n)=>{const a=n.length-1;let r,o;if(a===0)return 0;if(l===0){o=0;for(let f=0;f<=a;f++)o+=L5[a][f]*Math.pow(1-t,a-f)*Math.pow(t,f)*n[f];return o}else{r=new Array(a);for(let f=0;f<a;f++)r[f]=a*(n[f+1]-n[f]);return xm(l-1,t,r)}},ky=(l,t,n)=>{let a=1,r=l/t,o=(l-n(r))/t,f=0;for(;a>.001;){const h=n(r+o),g=Math.abs(l-h)/t;if(g<a)a=g,r+=o;else{const m=n(r-o),_=Math.abs(l-m)/t;_<a?(a=_,r-=o):o/=2}if(f++,f>500)break}return r};class jn extends Gt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=jn.parsePathData(this.data()),this.pathLength=jn.getPathLength(this.dataArray)}_sceneFunc(t){const n=this.dataArray;t.beginPath();let a=!1;for(let r=0;r<n.length;r++){const o=n[r].command,f=n[r].points;switch(o){case"L":t.lineTo(f[0],f[1]);break;case"M":t.moveTo(f[0],f[1]);break;case"C":t.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":t.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const h=f[0],g=f[1],m=f[2],_=f[3],C=f[4],E=f[5],R=f[6],v=f[7],D=m>_?m:_,B=m>_?1:m/_,L=m>_?_/m:1;t.translate(h,g),t.rotate(R),t.scale(B,L),t.arc(0,0,D,C,C+E,1-v),t.scale(1/B,1/L),t.rotate(-R),t.translate(-h,-g);break;case"z":a=!0,t.closePath();break}}!a&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],_=g.points[5],C=g.points[4]+_;let E=Math.PI/180;if(Math.abs(m-C)<E&&(E=Math.abs(m-C)),_<0)for(let R=m-E;R>C;R-=E){const v=jn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}else for(let R=m+E;R<C;R+=E){const v=jn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const _=jn.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);t.push(_.x,_.y)}else t=t.concat(g.points)});let n=t[0],a=t[0],r=t[1],o=t[1],f,h;for(let g=0;g<t.length/2;g++)f=t[g*2],h=t[g*2+1],isNaN(f)||(n=Math.min(n,f),a=Math.max(a,f)),isNaN(h)||(r=Math.min(r,h),o=Math.max(o,h));return{x:n,y:r,width:a-n,height:o-r}}getLength(){return this.pathLength}getPointAtLength(t){return jn.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,n,a,r){return Math.sqrt((a-t)*(a-t)+(r-n)*(r-n))}static getPathLength(t){let n=0;for(let a=0;a<t.length;++a)n+=t[a].pathLength;return n}static getPointAtLengthOfDataArray(t,n){let a,r=0,o=n.length;if(!o)return null;for(;r<o&&t>n[r].pathLength;)t-=n[r].pathLength,++r;if(r===o)return a=n[r-1].points.slice(-2),{x:a[0],y:a[1]};if(t<.01)return n[r].command==="M"?(a=n[r].points.slice(0,2),{x:a[0],y:a[1]}):{x:n[r].start.x,y:n[r].start.y};const f=n[r],h=f.points;switch(f.command){case"L":return jn.getPointOnLine(t,f.start.x,f.start.y,h[0],h[1]);case"C":return jn.getPointOnCubicBezier(ky(t,jn.getPathLength(n),D=>Hy([f.start.x,h[0],h[2],h[4]],[f.start.y,h[1],h[3],h[5]],D)),f.start.x,f.start.y,h[0],h[1],h[2],h[3],h[4],h[5]);case"Q":return jn.getPointOnQuadraticBezier(ky(t,jn.getPathLength(n),D=>Iy([f.start.x,h[0],h[2]],[f.start.y,h[1],h[3]],D)),f.start.x,f.start.y,h[0],h[1],h[2],h[3]);case"A":const g=h[0],m=h[1],_=h[2],C=h[3],E=h[5],R=h[6];let v=h[4];return v+=E*t/f.pathLength,jn.getPointOnEllipticalArc(g,m,_,C,v,R)}return null}static getPointOnLine(t,n,a,r,o,f,h){f=f??n,h=h??a;const g=this.getLineLength(n,a,r,o);if(g<1e-10)return{x:n,y:a};if(r===n)return{x:f,y:h+(o>a?t:-t)};const m=(o-a)/(r-n),_=Math.sqrt(t*t/(1+m*m))*(r<n?-1:1),C=m*_;if(Math.abs(h-a-m*(f-n))<1e-10)return{x:f+_,y:h+C};const E=((f-n)*(r-n)+(h-a)*(o-a))/(g*g),R=n+E*(r-n),v=a+E*(o-a),D=this.getLineLength(f,h,R,v),B=Math.sqrt(t*t-D*D),L=Math.sqrt(B*B/(1+m*m))*(r<n?-1:1),N=m*L;return{x:R+L,y:v+N}}static getPointOnCubicBezier(t,n,a,r,o,f,h,g,m){function _(B){return B*B*B}function C(B){return 3*B*B*(1-B)}function E(B){return 3*B*(1-B)*(1-B)}function R(B){return(1-B)*(1-B)*(1-B)}const v=g*_(t)+f*C(t)+r*E(t)+n*R(t),D=m*_(t)+h*C(t)+o*E(t)+a*R(t);return{x:v,y:D}}static getPointOnQuadraticBezier(t,n,a,r,o,f,h){function g(R){return R*R}function m(R){return 2*R*(1-R)}function _(R){return(1-R)*(1-R)}const C=f*g(t)+r*m(t)+n*_(t),E=h*g(t)+o*m(t)+a*_(t);return{x:C,y:E}}static getPointOnEllipticalArc(t,n,a,r,o,f){const h=Math.cos(f),g=Math.sin(f),m={x:a*Math.cos(o),y:r*Math.sin(o)};return{x:t+(m.x*h-m.y*g),y:n+(m.x*g+m.y*h)}}static parsePathData(t){if(!t)return[];let n=t;const a=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let C=0;C<a.length;C++)n=n.replace(new RegExp(a[C],"g"),"|"+a[C]);const r=n.split("|"),o=[],f=[];let h=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let C=1;C<r.length;C++){let E=r[C],R=E.charAt(0);for(E=E.slice(1),f.length=0;_=m.exec(E);)f.push(_[0]);let v=[],D=R==="A"||R==="a"?0:-1;for(let B=0,L=f.length;B<L;B++){const N=f[B];if(N==="00"){v.push(0,0),D>=0&&(D+=2,D>=7&&(D-=7));continue}if(D>=0){if(D===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(N)){v.push(parseInt(N[0],10)),v.push(parseInt(N[1],10)),v.push(parseFloat(N.slice(2))),D+=3,D>=7&&(D-=7);continue}if(N==="11"||N==="10"||N==="01"){v.push(parseInt(N[0],10)),v.push(parseInt(N[1],10)),D+=2,D>=7&&(D-=7);continue}if(N==="0"||N==="1"){v.push(parseInt(N,10)),D+=1,D>=7&&(D-=7);continue}}else if(D===4){if(/^[01]\d+(?:\.\d+)?$/.test(N)){v.push(parseInt(N[0],10)),v.push(parseFloat(N.slice(1))),D+=2,D>=7&&(D-=7);continue}if(N==="0"||N==="1"){v.push(parseInt(N,10)),D+=1,D>=7&&(D-=7);continue}}const M=parseFloat(N);isNaN(M)?v.push(0):v.push(M),D+=1,D>=7&&(D-=7)}else{const M=parseFloat(N);isNaN(M)?v.push(0):v.push(M)}}for(;v.length>0&&!isNaN(v[0]);){let B="",L=[];const N=h,M=g;let G,O,w,T,y,z,U,P,K,Q;switch(R){case"l":h+=v.shift(),g+=v.shift(),B="L",L.push(h,g);break;case"L":h=v.shift(),g=v.shift(),L.push(h,g);break;case"m":const X=v.shift(),Y=v.shift();if(h+=X,g+=Y,B="M",o.length>2&&o[o.length-1].command==="z"){for(let j=o.length-2;j>=0;j--)if(o[j].command==="M"){h=o[j].points[0]+X,g=o[j].points[1]+Y;break}}L.push(h,g),R="l";break;case"M":h=v.shift(),g=v.shift(),B="M",L.push(h,g),R="L";break;case"h":h+=v.shift(),B="L",L.push(h,g);break;case"H":h=v.shift(),B="L",L.push(h,g);break;case"v":g+=v.shift(),B="L",L.push(h,g);break;case"V":g=v.shift(),B="L",L.push(h,g);break;case"C":L.push(v.shift(),v.shift(),v.shift(),v.shift()),h=v.shift(),g=v.shift(),L.push(h,g);break;case"c":L.push(h+v.shift(),g+v.shift(),h+v.shift(),g+v.shift()),h+=v.shift(),g+=v.shift(),B="C",L.push(h,g);break;case"S":O=h,w=g,G=o[o.length-1],G.command==="C"&&(O=h+(h-G.points[2]),w=g+(g-G.points[3])),L.push(O,w,v.shift(),v.shift()),h=v.shift(),g=v.shift(),B="C",L.push(h,g);break;case"s":O=h,w=g,G=o[o.length-1],G.command==="C"&&(O=h+(h-G.points[2]),w=g+(g-G.points[3])),L.push(O,w,h+v.shift(),g+v.shift()),h+=v.shift(),g+=v.shift(),B="C",L.push(h,g);break;case"Q":L.push(v.shift(),v.shift()),h=v.shift(),g=v.shift(),L.push(h,g);break;case"q":L.push(h+v.shift(),g+v.shift()),h+=v.shift(),g+=v.shift(),B="Q",L.push(h,g);break;case"T":O=h,w=g,G=o[o.length-1],G.command==="Q"&&(O=h+(h-G.points[0]),w=g+(g-G.points[1])),h=v.shift(),g=v.shift(),B="Q",L.push(O,w,h,g);break;case"t":O=h,w=g,G=o[o.length-1],G.command==="Q"&&(O=h+(h-G.points[0]),w=g+(g-G.points[1])),h+=v.shift(),g+=v.shift(),B="Q",L.push(O,w,h,g);break;case"A":T=v.shift(),y=v.shift(),z=v.shift(),U=v.shift(),P=v.shift(),K=h,Q=g,h=v.shift(),g=v.shift(),B="A",L=this.convertEndpointToCenterParameterization(K,Q,h,g,U,P,T,y,z);break;case"a":T=v.shift(),y=v.shift(),z=v.shift(),U=v.shift(),P=v.shift(),K=h,Q=g,h+=v.shift(),g+=v.shift(),B="A",L=this.convertEndpointToCenterParameterization(K,Q,h,g,U,P,T,y,z);break}o.push({command:B||R,points:L,start:{x:N,y:M},pathLength:this.calcLength(N,M,B||R,L)})}(R==="z"||R==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,n,a,r){let o,f,h,g;const m=jn;switch(a){case"L":return m.getLineLength(t,n,r[0],r[1]);case"C":return Hy([t,r[0],r[2],r[4]],[n,r[1],r[3],r[5]],1);case"Q":return Iy([t,r[0],r[2]],[n,r[1],r[3]],1);case"A":o=0;const _=r[4],C=r[5],E=r[4]+C;let R=Math.PI/180;if(Math.abs(_-E)<R&&(R=Math.abs(_-E)),f=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],_,0),C<0)for(g=_-R;g>E;g-=R)h=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),o+=m.getLineLength(f.x,f.y,h.x,h.y),f=h;else for(g=_+R;g<E;g+=R)h=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),o+=m.getLineLength(f.x,f.y,h.x,h.y),f=h;return h=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],E,0),o+=m.getLineLength(f.x,f.y,h.x,h.y),o}return 0}static convertEndpointToCenterParameterization(t,n,a,r,o,f,h,g,m){const _=m*(Math.PI/180),C=Math.cos(_)*(t-a)/2+Math.sin(_)*(n-r)/2,E=-1*Math.sin(_)*(t-a)/2+Math.cos(_)*(n-r)/2,R=C*C/(h*h)+E*E/(g*g);R>1&&(h*=Math.sqrt(R),g*=Math.sqrt(R));let v=Math.sqrt((h*h*(g*g)-h*h*(E*E)-g*g*(C*C))/(h*h*(E*E)+g*g*(C*C)));o===f&&(v*=-1),isNaN(v)&&(v=0);const D=v*h*E/g,B=v*-g*C/h,L=(t+a)/2+Math.cos(_)*D-Math.sin(_)*B,N=(n+r)/2+Math.sin(_)*D+Math.cos(_)*B,M=function(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1])},G=function(U,P){return(U[0]*P[0]+U[1]*P[1])/(M(U)*M(P))},O=function(U,P){return(U[0]*P[1]<U[1]*P[0]?-1:1)*Math.acos(G(U,P))},w=O([1,0],[(C-D)/h,(E-B)/g]),T=[(C-D)/h,(E-B)/g],y=[(-1*C-D)/h,(-1*E-B)/g];let z=O(T,y);return G(T,y)<=-1&&(z=Math.PI),G(T,y)>=1&&(z=0),f===0&&z>0&&(z=z-2*Math.PI),f===1&&z<0&&(z=z+2*Math.PI),[L,N,h,g,w,z,_,f]}}jn.prototype.className="Path";jn.prototype._attrsAffectingSize=["data"];Qn(jn);lt.addGetterSetter(jn,"data");class Eu extends vl{_sceneFunc(t){super._sceneFunc(t);const n=Math.PI*2,a=this.points();let r=a;const o=this.tension()!==0&&a.length>4;o&&(r=this.getTensionPoints());const f=this.pointerLength(),h=a.length;let g,m;if(o){const E=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],a[h-2],a[h-1]],R=jn.calcLength(r[r.length-4],r[r.length-3],"C",E),v=jn.getPointOnQuadraticBezier(Math.min(1,1-f/R),E[0],E[1],E[2],E[3],E[4],E[5]);g=a[h-2]-v.x,m=a[h-1]-v.y}else g=a[h-2]-a[h-4],m=a[h-1]-a[h-3];const _=(Math.atan2(m,g)+n)%n,C=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(a[h-2],a[h-1]),t.rotate(_),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(a[0],a[1]),o?(g=(r[0]+r[2])/2-a[0],m=(r[1]+r[3])/2-a[1]):(g=a[2]-a[0],m=a[3]-a[1]),t.rotate((Math.atan2(-m,-g)+n)%n),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),n=this.pointerWidth()/2;return{x:t.x,y:t.y-n,width:t.width,height:t.height+n*2}}}Eu.prototype.className="Arrow";Qn(Eu);lt.addGetterSetter(Eu,"pointerLength",10,Vt());lt.addGetterSetter(Eu,"pointerWidth",10,Vt());lt.addGetterSetter(Eu,"pointerAtBeginning",!1);lt.addGetterSetter(Eu,"pointerAtEnding",!0);class Sf extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}Sf.prototype._centroid=!0;Sf.prototype.className="Circle";Sf.prototype._attrsAffectingSize=["radius"];Qn(Sf);lt.addGetterSetter(Sf,"radius",0,Vt());class po extends Gt{_sceneFunc(t){const n=this.radiusX(),a=this.radiusY();t.beginPath(),t.save(),n!==a&&t.scale(1,a/n),t.arc(0,0,n,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}po.prototype.className="Ellipse";po.prototype._centroid=!0;po.prototype._attrsAffectingSize=["radiusX","radiusY"];Qn(po);lt.addComponentsGetterSetter(po,"radius",["x","y"]);lt.addGetterSetter(po,"radiusX",0,Vt());lt.addGetterSetter(po,"radiusY",0,Vt());let qr=class tS extends Gt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),n=this.hasShadow();return t&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const n=this.getWidth(),a=this.getHeight(),r=this.cornerRadius(),o=this.attrs.image;let f;if(o){const h=this.attrs.cropWidth,g=this.attrs.cropHeight;h&&g?f=[o,this.cropX(),this.cropY(),h,g,0,0,n,a]:f=[o,0,0,n,a]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?mt.drawRoundedRectPath(t,n,a,r):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)),o&&(r&&t.clip(),t.drawImage.apply(t,f))}_hitFunc(t){const n=this.width(),a=this.height(),r=this.cornerRadius();t.beginPath(),r?mt.drawRoundedRectPath(t,n,a,r):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,n,a;return(a=(t=this.attrs.width)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&a!==void 0?a:0}getHeight(){var t,n,a;return(a=(t=this.attrs.height)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&a!==void 0?a:0}static fromURL(t,n,a=null){const r=mt.createImageElement();r.onload=function(){const o=new tS({image:r});n(o)},r.onerror=a,r.crossOrigin="Anonymous",r.src=t}};qr.prototype.className="Image";qr.prototype._attrsAffectingSize=["image"];Qn(qr);lt.addGetterSetter(qr,"cornerRadius",0,Rg(4));lt.addGetterSetter(qr,"image");lt.addComponentsGetterSetter(qr,"crop",["x","y","width","height"]);lt.addGetterSetter(qr,"cropX",0,Vt());lt.addGetterSetter(qr,"cropY",0,Vt());lt.addGetterSetter(qr,"cropWidth",0,Vt());lt.addGetterSetter(qr,"cropHeight",0,Vt());const eS=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],P5="Change.konva",H5="none",Mm="up",Nm="right",Dm="down",jm="left",I5=eS.length;class ev extends ff{constructor(t){super(t),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let n=this,a;const r=function(){n._sync()};for(a=0;a<I5;a++)t.on(eS[a]+P5,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),n=this.getTag(),a,r,o,f,h,g,m;if(t&&n){switch(a=t.width(),r=t.height(),o=n.pointerDirection(),f=n.pointerWidth(),m=n.pointerHeight(),h=0,g=0,o){case Mm:h=a/2,g=-1*m;break;case Nm:h=a+f,g=r/2;break;case Dm:h=a/2,g=r+m;break;case jm:h=-1*f,g=r/2;break}n.setAttrs({x:-1*h,y:-1*g,width:a,height:r}),t.setAttrs({x:-1*h,y:-1*g})}}}ev.prototype.className="Label";Qn(ev);class Cu extends Gt{_sceneFunc(t){const n=this.width(),a=this.height(),r=this.pointerDirection(),o=this.pointerWidth(),f=this.pointerHeight(),h=this.cornerRadius();let g=0,m=0,_=0,C=0;typeof h=="number"?g=m=_=C=Math.min(h,n/2,a/2):(g=Math.min(h[0]||0,n/2,a/2),m=Math.min(h[1]||0,n/2,a/2),C=Math.min(h[2]||0,n/2,a/2),_=Math.min(h[3]||0,n/2,a/2)),t.beginPath(),t.moveTo(g,0),r===Mm&&(t.lineTo((n-o)/2,0),t.lineTo(n/2,-1*f),t.lineTo((n+o)/2,0)),t.lineTo(n-m,0),t.arc(n-m,m,m,Math.PI*3/2,0,!1),r===Nm&&(t.lineTo(n,(a-f)/2),t.lineTo(n+o,a/2),t.lineTo(n,(a+f)/2)),t.lineTo(n,a-C),t.arc(n-C,a-C,C,0,Math.PI/2,!1),r===Dm&&(t.lineTo((n+o)/2,a),t.lineTo(n/2,a+f),t.lineTo((n-o)/2,a)),t.lineTo(_,a),t.arc(_,a-_,_,Math.PI/2,Math.PI,!1),r===jm&&(t.lineTo(0,(a+f)/2),t.lineTo(-1*o,a/2),t.lineTo(0,(a-f)/2)),t.lineTo(0,g),t.arc(g,g,g,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,n=0,a=this.pointerWidth(),r=this.pointerHeight(),o=this.pointerDirection(),f=this.width(),h=this.height();return o===Mm?(n-=r,h+=r):o===Dm?h+=r:o===jm?(t-=a*1.5,f+=a):o===Nm&&(f+=a*1.5),{x:t,y:n,width:f,height:h}}}Cu.prototype.className="Tag";Qn(Cu);lt.addGetterSetter(Cu,"pointerDirection",H5);lt.addGetterSetter(Cu,"pointerWidth",0,Vt());lt.addGetterSetter(Cu,"pointerHeight",0,Vt());lt.addGetterSetter(Cu,"cornerRadius",0,Rg(4));class yd extends Gt{_sceneFunc(t){const n=this.cornerRadius(),a=this.width(),r=this.height();t.beginPath(),n?mt.drawRoundedRectPath(t,a,r,n):t.rect(0,0,a,r),t.closePath(),t.fillStrokeShape(this)}}yd.prototype.className="Rect";Qn(yd);lt.addGetterSetter(yd,"cornerRadius",0,Rg(4));class mo extends Gt{_sceneFunc(t){const n=this._getPoints(),a=this.radius(),r=this.sides(),o=this.cornerRadius();if(t.beginPath(),o)mt.drawRoundedPolygonPath(t,n,r,a,o);else{t.moveTo(n[0].x,n[0].y);for(let f=1;f<n.length;f++)t.lineTo(n[f].x,n[f].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,n=this.attrs.radius||0,a=[];for(let r=0;r<t;r++)a.push({x:n*Math.sin(r*2*Math.PI/t),y:-1*n*Math.cos(r*2*Math.PI/t)});return a}getSelfRect(){const t=this._getPoints();let n=t[0].x,a=t[0].y,r=t[0].x,o=t[0].y;return t.forEach(f=>{n=Math.min(n,f.x),a=Math.max(a,f.x),r=Math.min(r,f.y),o=Math.max(o,f.y)}),{x:n,y:r,width:a-n,height:o-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}mo.prototype.className="RegularPolygon";mo.prototype._centroid=!0;mo.prototype._attrsAffectingSize=["radius"];Qn(mo);lt.addGetterSetter(mo,"radius",0,Vt());lt.addGetterSetter(mo,"sides",0,Vt());lt.addGetterSetter(mo,"cornerRadius",0,Rg(4));const qy=Math.PI*2;class Tu extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,qy,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),qy,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Tu.prototype.className="Ring";Tu.prototype._centroid=!0;Tu.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Qn(Tu);lt.addGetterSetter(Tu,"innerRadius",0,Vt());lt.addGetterSetter(Tu,"outerRadius",0,Vt());class bs extends Gt{constructor(t){super(t),this._updated=!0,this.anim=new gr(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const n=this.animation(),a=this.frameIndex(),r=a*4,o=this.animations()[n],f=this.frameOffsets(),h=o[r+0],g=o[r+1],m=o[r+2],_=o[r+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,m,_),t.closePath(),t.fillStrokeShape(this)),C)if(f){const E=f[n],R=a*2;t.drawImage(C,h,g,m,_,E[R+0],E[R+1],m,_)}else t.drawImage(C,h,g,m,_,0,0,m,_)}_hitFunc(t){const n=this.animation(),a=this.frameIndex(),r=a*4,o=this.animations()[n],f=this.frameOffsets(),h=o[r+2],g=o[r+3];if(t.beginPath(),f){const m=f[n],_=a*2;t.rect(m[_+0],m[_+1],h,g)}else t.rect(0,0,h,g);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),n=this.animation(),a=this.animations(),r=a[n],o=r.length/4;t<o-1?this.frameIndex(t+1):this.frameIndex(0)}}bs.prototype.className="Sprite";Qn(bs);lt.addGetterSetter(bs,"animation");lt.addGetterSetter(bs,"animations");lt.addGetterSetter(bs,"frameOffsets");lt.addGetterSetter(bs,"image");lt.addGetterSetter(bs,"frameIndex",0,Vt());lt.addGetterSetter(bs,"frameRate",17,Vt());lt.backCompat(bs,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class vo extends Gt{_sceneFunc(t){const n=this.innerRadius(),a=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-a);for(let o=1;o<r*2;o++){const f=o%2===0?a:n,h=f*Math.sin(o*Math.PI/r),g=-1*f*Math.cos(o*Math.PI/r);t.lineTo(h,g)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}vo.prototype.className="Star";vo.prototype._centroid=!0;vo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Qn(vo);lt.addGetterSetter(vo,"numPoints",5,Vt());lt.addGetterSetter(vo,"innerRadius",0,Vt());lt.addGetterSetter(vo,"outerRadius",0,Vt());function lo(l){return[...l].reduce((t,n,a,r)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const o=r[a+1];o&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(o)?(t.push(n+o),r[a+1]=""):t.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(r[a+1]||""))?t.push(n+r[a+1]):a>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?t[t.length-1]+=n:n&&t.push(n);return t},[])}const Jc="auto",k5="center",nS="inherit",Zc="justify",q5="Change.konva",V5="2d",Vy="-",aS="left",Y5="text",K5="Text",Q5="top",X5="bottom",Yy="middle",iS="normal",F5="px ",W0=" ",J5="right",Ky="rtl",Z5="word",W5="char",Qy="none",xp="…",rS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],$5=rS.length;function t6(l){return l.split(",").map(t=>{t=t.trim();const n=t.indexOf(" ")>=0,a=t.indexOf('"')>=0||t.indexOf("'")>=0;return n&&!a&&(t=`"${t}"`),t}).join(", ")}let $0;function Mp(){return $0||($0=mt.createCanvasElement().getContext(V5),$0)}function e6(l){l.fillText(this._partialText,this._partialTextX,this._partialTextY)}function n6(l){l.setAttr("miterLimit",2),l.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function a6(l){return l=l||{},!l.fillLinearGradientColorStops&&!l.fillRadialGradientColorStops&&!l.fillPatternImage&&(l.fill=l.fill||"black"),l}class Gn extends Gt{constructor(t){super(a6(t)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<$5;n++)this.on(rS[n]+q5,this._setTextData);this._setTextData()}_sceneFunc(t){var n,a;const r=this.textArr,o=r.length;if(!this.text())return;let f=this.padding(),h=this.fontSize(),g=this.lineHeight()*h,m=this.verticalAlign(),_=this.direction(),C=0,E=this.align(),R=this.getWidth(),v=this.letterSpacing(),D=this.charRenderFunc(),B=this.fill(),L=this.textDecoration(),N=L.indexOf("underline")!==-1,M=L.indexOf("line-through")!==-1,G;_=_===nS?t.direction:_;let O=g/2,w=Yy;if(!Xt.legacyTextRendering){const T=this.measureSize("M");w="alphabetic";const y=(n=T.fontBoundingBoxAscent)!==null&&n!==void 0?n:T.actualBoundingBoxAscent,z=(a=T.fontBoundingBoxDescent)!==null&&a!==void 0?a:T.actualBoundingBoxDescent;O=(y-z)/2+g/2}for(_===Ky&&t.setAttr("direction",_),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",w),t.setAttr("textAlign",aS),m===Yy?C=(this.getHeight()-o*g-f*2)/2:m===X5&&(C=this.getHeight()-o*g-f*2),t.translate(f,C+f),G=0;G<o;G++){let T=0,y=0;const z=r[G],U=z.text,P=z.width,K=z.lastInParagraph;if(t.save(),E===J5?T+=R-P-f*2:E===k5&&(T+=(R-P-f*2)/2),N){t.save(),t.beginPath();const Q=Xt.legacyTextRendering?Math.round(h/2):Math.round(h/4),X=T,Y=O+y+Q;t.moveTo(X,Y);const j=E===Zc&&!K?R-f*2:P;t.lineTo(X+Math.round(j),Y),t.lineWidth=h/15;const I=this._getLinearGradient();t.strokeStyle=I||B,t.stroke(),t.restore()}if(_!==Ky&&(v!==0||E===Zc||D)){const Q=U.split(" ").length-1,X=lo(U);for(let Y=0;Y<X.length;Y++){const j=X[Y];if(j===" "&&!K&&E===Zc&&(T+=(R-f*2-P)/Q),this._partialTextX=T,this._partialTextY=O+y,this._partialText=j,D){t.save();const F=r.slice(0,G).reduce((nt,Z)=>nt+lo(Z.text).length,0),W=Y+F;D({char:j,index:W,x:T,y:O+y,lineIndex:G,column:Y,isLastInLine:K,width:this.measureSize(j).width,context:t})}t.fillStrokeShape(this),D&&t.restore(),T+=this.measureSize(j).width+v}}else v!==0&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=T,this._partialTextY=O+y,this._partialText=U,t.fillStrokeShape(this);if(M){t.save(),t.beginPath();const Q=Xt.legacyTextRendering?0:-Math.round(h/4),X=E===Zc?0:T;t.moveTo(X,O+y+Q);const Y=E===Zc&&!K?R-f*2:P;t.lineTo(X+Math.round(Y),O+y+Q),t.lineWidth=h/15;const j=this._getLinearGradient();t.strokeStyle=j||B,t.stroke(),t.restore()}t.restore(),o>1&&(O+=g)}}_hitFunc(t){const n=this.getWidth(),a=this.getHeight();t.beginPath(),t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}setText(t){const n=mt._isString(t)?t:t==null?"":t+"";return this._setAttr(Y5,n),this}getWidth(){return this.attrs.width===Jc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Jc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return mt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var n,a,r,o,f,h,g,m,_,C,E;let R=Mp(),v=this.fontSize(),D;R.save(),R.font=this._getContextFont(),D=R.measureText(t),R.restore();const B=v/100;return{actualBoundingBoxAscent:(n=D.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*B,actualBoundingBoxDescent:(a=D.actualBoundingBoxDescent)!==null&&a!==void 0?a:0,actualBoundingBoxLeft:(r=D.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*B,actualBoundingBoxRight:(o=D.actualBoundingBoxRight)!==null&&o!==void 0?o:75.732421875*B,alphabeticBaseline:(f=D.alphabeticBaseline)!==null&&f!==void 0?f:0,emHeightAscent:(h=D.emHeightAscent)!==null&&h!==void 0?h:100*B,emHeightDescent:(g=D.emHeightDescent)!==null&&g!==void 0?g:-20*B,fontBoundingBoxAscent:(m=D.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*B,fontBoundingBoxDescent:(_=D.fontBoundingBoxDescent)!==null&&_!==void 0?_:21*B,hangingBaseline:(C=D.hangingBaseline)!==null&&C!==void 0?C:72.80000305175781*B,ideographicBaseline:(E=D.ideographicBaseline)!==null&&E!==void 0?E:-21*B,width:D.width,height:v}}_getContextFont(){return this.fontStyle()+W0+this.fontVariant()+W0+(this.fontSize()+F5)+t6(this.fontFamily())}_addTextLine(t){this.align()===Zc&&(t=t.trim());const a=this._getTextWidth(t);return this.textArr.push({text:t,width:a,lastInParagraph:!1})}_getTextWidth(t){const n=this.letterSpacing(),a=t.length;return Mp().measureText(t).width+n*a}_setTextData(){let t=this.text().split(`
`),n=+this.fontSize(),a=0,r=this.lineHeight()*n,o=this.attrs.width,f=this.attrs.height,h=o!==Jc&&o!==void 0,g=f!==Jc&&f!==void 0,m=this.padding(),_=o-m*2,C=f-m*2,E=0,R=this.wrap(),v=R!==Qy,D=R!==W5&&v,B=this.ellipsis();this.textArr=[],Mp().font=this._getContextFont();const L=B?this._getTextWidth(xp):0;for(let N=0,M=t.length;N<M;++N){let G=t[N],O=this._getTextWidth(G);if(h&&O>_)for(;G.length>0;){let w=0,T=lo(G).length,y="",z=0;for(;w<T;){const U=w+T>>>1,P=lo(G),K=P.slice(0,U+1).join(""),Q=this._getTextWidth(K);(B&&g&&E+r>C?Q+L:Q)<=_?(w=U+1,y=K,z=Q):T=U}if(y){if(D){const K=lo(G),Q=lo(y),X=K[Q.length],Y=X===W0||X===Vy;let j;if(Y&&z<=_)j=Q.length;else{const I=Q.lastIndexOf(W0),F=Q.lastIndexOf(Vy);j=Math.max(I,F)+1}j>0&&(w=j,y=K.slice(0,w).join(""),z=this._getTextWidth(y))}if(y=y.trimRight(),this._addTextLine(y),a=Math.max(a,z),E+=r,this._shouldHandleEllipsis(E)){this._tryToAddEllipsisToLastLine();break}if(G=lo(G).slice(w).join("").trimLeft(),G.length>0&&(O=this._getTextWidth(G),O<=_)){this._addTextLine(G),E+=r,a=Math.max(a,O);break}}else break}else this._addTextLine(G),E+=r,a=Math.max(a,O),this._shouldHandleEllipsis(E)&&N<M-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&E+r>C)break}this.textHeight=n,this.textWidth=a}_shouldHandleEllipsis(t){const n=+this.fontSize(),a=this.lineHeight()*n,r=this.attrs.height,o=r!==Jc&&r!==void 0,f=this.padding(),h=r-f*2;return!(this.wrap()!==Qy)||o&&t+a>h}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,n=t!==Jc&&t!==void 0,a=this.padding(),r=t-a*2,o=this.ellipsis(),f=this.textArr[this.textArr.length-1];!f||!o||(n&&(this._getTextWidth(f.text+xp)<r||(f.text=f.text.slice(0,f.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(f.text+xp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return t&&n?!0:super._useBufferCanvas()}}Gn.prototype._fillFunc=e6;Gn.prototype._strokeFunc=n6;Gn.prototype.className=K5;Gn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Qn(Gn);lt.overWriteSetter(Gn,"width",Wm());lt.overWriteSetter(Gn,"height",Wm());lt.addGetterSetter(Gn,"direction",nS);lt.addGetterSetter(Gn,"fontFamily","Arial");lt.addGetterSetter(Gn,"fontSize",12,Vt());lt.addGetterSetter(Gn,"fontStyle",iS);lt.addGetterSetter(Gn,"fontVariant",iS);lt.addGetterSetter(Gn,"padding",0,Vt());lt.addGetterSetter(Gn,"align",aS);lt.addGetterSetter(Gn,"verticalAlign",Q5);lt.addGetterSetter(Gn,"lineHeight",1,Vt());lt.addGetterSetter(Gn,"wrap",Z5);lt.addGetterSetter(Gn,"ellipsis",!1,kr());lt.addGetterSetter(Gn,"letterSpacing",0,Vt());lt.addGetterSetter(Gn,"text","",bu());lt.addGetterSetter(Gn,"textDecoration","");lt.addGetterSetter(Gn,"charRenderFunc",void 0);const i6="",sS="normal";function lS(l){l.fillText(this.partialText,0,0)}function oS(l){l.strokeText(this.partialText,0,0)}class Ta extends Gt{constructor(t){super(t),this.dummyCanvas=mt.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return jn.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const n=this.pathLength;return t>n?null:jn.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=jn.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const n=this.textDecoration(),a=this.fill(),r=this.fontSize(),o=this.glyphInfo,f=n.indexOf("underline")!==-1,h=n.indexOf("line-through")!==-1;f&&t.beginPath();for(let g=0;g<o.length;g++){t.save();const m=o[g].p0;t.translate(m.x,m.y),t.rotate(o[g].rotation),this.partialText=o[g].text,t.fillStrokeShape(this),f&&(g===0&&t.moveTo(0,r/2+1),t.lineTo(o[g].width,r/2+1)),t.restore()}if(f&&(t.strokeStyle=a,t.lineWidth=r/20,t.stroke()),h){t.beginPath();for(let g=0;g<o.length;g++){t.save();const m=o[g].p0;t.translate(m.x,m.y),t.rotate(o[g].rotation),g===0&&t.moveTo(0,0),t.lineTo(o[g].width,0),t.restore()}t.strokeStyle=a,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const n=this.glyphInfo;if(n.length>=1){const a=n[0].p0;t.moveTo(a.x,a.y)}for(let a=0;a<n.length;a++){const r=n[a].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return mt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Gn.prototype.setText.call(this,t)}_getContextFont(){return Gn.prototype._getContextFont.call(this)}_getTextSize(t){const a=this.dummyCanvas.getContext("2d");a.save(),a.font=this._getContextFont();const r=a.measureText(t);return a.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=lo(this.text()),n=[];let a=0;for(let C=0;C<t.length;C++)n.push({char:t[C],width:this._getTextSize(t[C]).width}),a+=n[C].width;const{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=a,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const o=this.letterSpacing(),f=this.align(),h=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*o,0);let m=0;f==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),f==="right"&&(m=Math.max(0,this.pathLength-g));let _=m;for(let C=0;C<n.length;C++){const E=this._getPointAtLength(_);if(!E)return;const R=n[C].char;let v=n[C].width+o;if(R===" "&&f==="justify"){const G=this.text().split(" ").length-1;v+=(this.pathLength-g)/G}const D=this._getPointAtLength(_+v);if(!D)return;const B=jn.getLineLength(E.x,E.y,D.x,D.y);let L=0;if(h)try{L=h(n[C-1].char,R)*this.fontSize()}catch{L=0}E.x+=L,D.x+=L,this.textWidth+=L;const N=jn.getPointOnLine(L+B/2,E.x,E.y,D.x,D.y),M=Math.atan2(D.y-E.y,D.x-E.x);this.glyphInfo.push({transposeX:N.x,transposeY:N.y,text:t[C],rotation:M,p0:E,p1:D,width:B}),_+=v}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});let n=t[0]||0,a=t[0]||0,r=t[1]||0,o=t[1]||0,f,h;for(let m=0;m<t.length/2;m++)f=t[m*2],h=t[m*2+1],n=Math.min(n,f),a=Math.max(a,f),r=Math.min(r,h),o=Math.max(o,h);const g=this.fontSize();return{x:n-g/2,y:r-g/2,width:a-n+g,height:o-r+g}}destroy(){return mt.releaseCanvas(this.dummyCanvas),super.destroy()}}Ta.prototype._fillFunc=lS;Ta.prototype._strokeFunc=oS;Ta.prototype._fillFuncHit=lS;Ta.prototype._strokeFuncHit=oS;Ta.prototype.className="TextPath";Ta.prototype._attrsAffectingSize=["text","fontSize","data"];Qn(Ta);lt.addGetterSetter(Ta,"data");lt.addGetterSetter(Ta,"fontFamily","Arial");lt.addGetterSetter(Ta,"fontSize",12,Vt());lt.addGetterSetter(Ta,"fontStyle",sS);lt.addGetterSetter(Ta,"align","left");lt.addGetterSetter(Ta,"letterSpacing",0,Vt());lt.addGetterSetter(Ta,"textBaseline","middle");lt.addGetterSetter(Ta,"fontVariant",sS);lt.addGetterSetter(Ta,"text",i6);lt.addGetterSetter(Ta,"textDecoration","");lt.addGetterSetter(Ta,"kerningFunc",void 0);const uS="tr-konva",r6=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(l=>l+`.${uS}`).join(" "),Xy="nodesRect",s6=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],l6={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},o6="ontouchstart"in Xt._global;function u6(l,t,n){if(l==="rotater")return n;t+=mt.degToRad(l6[l]||0);const a=(mt.radToDeg(t)%360+360)%360;return mt._inRange(a,315+22.5,360)||mt._inRange(a,0,22.5)?"ns-resize":mt._inRange(a,45-22.5,45+22.5)?"nesw-resize":mt._inRange(a,90-22.5,90+22.5)?"ew-resize":mt._inRange(a,135-22.5,135+22.5)?"nwse-resize":mt._inRange(a,180-22.5,180+22.5)?"ns-resize":mt._inRange(a,225-22.5,225+22.5)?"nesw-resize":mt._inRange(a,270-22.5,270+22.5)?"ew-resize":mt._inRange(a,315-22.5,315+22.5)?"nwse-resize":(mt.error("Transformer has unknown angle for cursor detection: "+a),"pointer")}const pg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function c6(l){return{x:l.x+l.width/2*Math.cos(l.rotation)+l.height/2*Math.sin(-l.rotation),y:l.y+l.height/2*Math.cos(l.rotation)+l.width/2*Math.sin(l.rotation)}}function cS(l,t,n){const a=n.x+(l.x-n.x)*Math.cos(t)-(l.y-n.y)*Math.sin(t),r=n.y+(l.x-n.x)*Math.sin(t)+(l.y-n.y)*Math.cos(t);return{...l,rotation:l.rotation+t,x:a,y:r}}function f6(l,t){const n=c6(l);return cS(l,t,n)}function h6(l,t,n){let a=t;for(let r=0;r<l.length;r++){const o=Xt.getAngle(l[r]),f=Math.abs(o-t)%(Math.PI*2);Math.min(f,Math.PI*2-f)<n&&(a=o)}return a}let Um=0;class We extends ff{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(r6,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return mt.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return uS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const n=t.filter(r=>r.isAncestorOf(this)?(mt.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=n,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const o=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){const f=r._attrsAffectingSize.map(h=>h+"Change."+this._getEventNamespace()).join(" ");r.on(f,o)}r.on(s6.map(f=>f+`.${this._getEventNamespace()}`).join(" "),o),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,o),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let n;t.on(`dragstart.${this._getEventNamespace()}`,a=>{n=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(a,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,a=>{if(!n)return;const r=t.getAbsolutePosition(),o=r.x-n.x,f=r.y-n.y;this.nodes().forEach(h=>{if(h===t||h.isDragging())return;const g=h.getAbsolutePosition();h.setAbsolutePosition({x:g.x+o,y:g.y+f}),h.startDrag(a)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Xy),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Xy,this.__getNodeRect)}__getNodeShape(t,n=this.rotation(),a){const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=t.getAbsoluteScale(a),f=t.getAbsolutePosition(a),h=r.x*o.x-t.offsetX()*o.x,g=r.y*o.y-t.offsetY()*o.y,m=(Xt.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),_={x:f.x+h*Math.cos(m)+g*Math.sin(-m),y:f.y+g*Math.cos(m)+h*Math.sin(m),width:r.width*o.x,height:r.height*o.y,rotation:m};return cS(_,-Xt.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const _=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),C=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}],E=m.getAbsoluteTransform();C.forEach(function(R){const v=E.point(R);n.push(v)})});const a=new Gi;a.rotate(-Xt.getAngle(this.rotation()));let r=1/0,o=1/0,f=-1/0,h=-1/0;n.forEach(function(m){const _=a.point(m);r===void 0&&(r=f=_.x,o=h=_.y),r=Math.min(r,_.x),o=Math.min(o,_.y),f=Math.max(f,_.x),h=Math.max(h,_.y)}),a.invert();const g=a.point({x:r,y:o});return{x:g.x,y:g.y,width:f-r,height:h-o,rotation:Xt.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),pg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const n=new yd({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:o6?10:"auto"}),a=this;n.on("mousedown touchstart",function(r){a._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{const r=Xt.getAngle(this.rotation()),o=this.rotateAnchorCursor(),f=u6(t,r,o);n.getStage().content&&(n.getStage().content.style.cursor=f),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const t=new Gt({name:"back",width:0,height:0,sceneFunc(n,a){const r=a.getParent(),o=r.padding();n.beginPath(),n.rect(-o,-o,a.width()+o*2,a.height()+o*2),n.moveTo(a.width()/2,-o),r.rotateEnabled()&&r.rotateLineVisible()&&n.lineTo(a.width()/2,-r.rotateAnchorOffset()*mt._sign(a.height())-o),n.fillStrokeShape(a)},hitFunc:(n,a)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();n.beginPath(),n.rect(-r,-r,a.width()+r*2,a.height()+r*2),n.fillStrokeShape(a)}});this.add(t),this._proxyDrag(t),t.on("dragstart",n=>{n.cancelBubble=!0}),t.on("dragmove",n=>{n.cancelBubble=!0}),t.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const n=this._getNodeRect(),a=n.width,r=n.height,o=Math.sqrt(Math.pow(a,2)+Math.pow(r,2));this.sin=Math.abs(r/o),this.cos=Math.abs(a/o),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const f=t.target.getAbsolutePosition(),h=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:h.x-f.x,y:h.y-f.y},Um++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:t.evt,target:g})})}_handleMouseMove(t){let n,a,r;const o=this.findOne("."+this._movingAnchorName),f=o.getStage();f.setPointersPositions(t);const h=f.getPointerPosition();let g={x:h.x-this._anchorDragOffset.x,y:h.y-this._anchorDragOffset.y};const m=o.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,t)),o.setAbsolutePosition(g);const _=o.getAbsolutePosition();if(m.x===_.x&&m.y===_.y)return;if(this._movingAnchorName==="rotater"){const N=this._getNodeRect();n=o.x()-N.width/2,a=-o.y()+N.height/2;let M=Math.atan2(-a,n)+Math.PI/2;N.height<0&&(M-=Math.PI);const O=Xt.getAngle(this.rotation())+M,w=Xt.getAngle(this.rotationSnapTolerance()),y=h6(this.rotationSnaps(),O,w)-N.rotation,z=f6(N,y);this._fitNodesInto(z,t);return}const C=this.shiftBehavior();let E;C==="inverted"?E=this.keepRatio()&&!t.shiftKey:C==="none"?E=this.keepRatio():E=this.keepRatio()||t.shiftKey;let R=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(N.x-o.x(),2)+Math.pow(N.y-o.y(),2));const M=this.findOne(".top-left").x()>N.x?-1:1,G=this.findOne(".top-left").y()>N.y?-1:1;n=r*this.cos*M,a=r*this.sin*G,this.findOne(".top-left").x(N.x-n),this.findOne(".top-left").y(N.y-a)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(o.y());else if(this._movingAnchorName==="top-right"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(o.x()-N.x,2)+Math.pow(N.y-o.y(),2));const M=this.findOne(".top-right").x()<N.x?-1:1,G=this.findOne(".top-right").y()>N.y?-1:1;n=r*this.cos*M,a=r*this.sin*G,this.findOne(".top-right").x(N.x+n),this.findOne(".top-right").y(N.y-a)}var v=o.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(o.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(o.x());else if(this._movingAnchorName==="bottom-left"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(N.x-o.x(),2)+Math.pow(o.y()-N.y,2));const M=N.x<o.x()?-1:1,G=o.y()<N.y?-1:1;n=r*this.cos*M,a=r*this.sin*G,o.x(N.x-n),o.y(N.y+a)}v=o.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(o.y());else if(this._movingAnchorName==="bottom-right"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(o.x()-N.x,2)+Math.pow(o.y()-N.y,2));const M=this.findOne(".bottom-right").x()<N.x?-1:1,G=this.findOne(".bottom-right").y()<N.y?-1:1;n=r*this.cos*M,a=r*this.sin*G,this.findOne(".bottom-right").x(N.x+n),this.findOne(".bottom-right").y(N.y+a)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(R=this.centeredScaling()||t.altKey,R){const N=this.findOne(".top-left"),M=this.findOne(".bottom-right"),G=N.x(),O=N.y(),w=this.getWidth()-M.x(),T=this.getHeight()-M.y();M.move({x:-G,y:-O}),N.move({x:w,y:T})}const D=this.findOne(".top-left").getAbsolutePosition();n=D.x,a=D.y;const B=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),L=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:a,width:B,height:L,rotation:Xt.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const a=this.getNode();Um--,this._fire("transformend",{evt:t,target:a}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),a&&this._nodes.forEach(r=>{var o;r._fire("transformend",{evt:t,target:r}),(o=r.getLayer())===null||o===void 0||o.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,n){const a=this._getNodeRect(),r=1;if(mt._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(mt._inRange(t.height,-this.padding()*2-r,r)){this.update();return}const o=new Gi;if(o.rotate(Xt.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=o.point({x:-this.padding()*2,y:0});t.x+=E.x,t.y+=E.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=o.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=o.point({x:0,y:-this.padding()*2});t.x+=E.x,t.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=o.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(a,t);E?t=E:mt.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const f=1e7,h=new Gi;h.translate(a.x,a.y),h.rotate(a.rotation),h.scale(a.width/f,a.height/f);const g=new Gi,m=t.width/f,_=t.height/f;this.flipEnabled()===!1?(g.translate(t.x,t.y),g.rotate(t.rotation),g.translate(t.width<0?t.width:0,t.height<0?t.height:0),g.scale(Math.abs(m),Math.abs(_))):(g.translate(t.x,t.y),g.rotate(t.rotation),g.scale(m,_));const C=g.multiply(h.invert());this._nodes.forEach(E=>{var R;if(!E.getStage())return;const v=E.getParent().getAbsoluteTransform(),D=E.getTransform().copy();D.translate(E.offsetX(),E.offsetY());const B=new Gi;B.multiply(v.copy().invert()).multiply(C).multiply(v).multiply(D);const L=B.decompose();E.setAttrs(L),(R=E.getLayer())===null||R===void 0||R.batchDraw()}),this.rotation(mt._getRotation(t.rotation)),this._nodes.forEach(E=>{this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,n){this.findOne(t).setAttrs(n)}update(){var t;const n=this._getNodeRect();this.rotation(mt._getRotation(n.rotation));const a=n.width,r=n.height,o=this.enabledAnchors(),f=this.resizeEnabled(),h=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(C=>{C.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+h,offsetY:g/2+h,visible:f&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:a/2,y:0,offsetY:g/2+h,visible:f&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:a,y:0,offsetX:g/2-h,offsetY:g/2+h,visible:f&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:g/2+h,visible:f&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:a,y:r/2,offsetX:g/2-h,visible:f&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:g/2+h,offsetY:g/2-h,visible:f&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:a/2,y:r,offsetY:g/2-h,visible:f&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:a,y:r,offsetX:g/2-h,offsetY:g/2-h,visible:f&&o.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:a/2,y:-this.rotateAnchorOffset()*mt._sign(r)-h,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:a,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(C=>C.draggable()),x:0,y:0});const _=this.anchorStyleFunc();_&&m.forEach(C=>{_(C)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),ff.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return qt.prototype.toObject.call(this)}clone(t){return qt.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}We.isTransforming=()=>Um>0;function d6(l){return l instanceof Array||mt.warn("enabledAnchors value should be an array"),l instanceof Array&&l.forEach(function(t){pg.indexOf(t)===-1&&mt.warn("Unknown anchor name: "+t+". Available names are: "+pg.join(", "))}),l||[]}We.prototype.className="Transformer";Qn(We);lt.addGetterSetter(We,"enabledAnchors",pg,d6);lt.addGetterSetter(We,"flipEnabled",!0,kr());lt.addGetterSetter(We,"resizeEnabled",!0);lt.addGetterSetter(We,"anchorSize",10,Vt());lt.addGetterSetter(We,"rotateEnabled",!0);lt.addGetterSetter(We,"rotateLineVisible",!0);lt.addGetterSetter(We,"rotationSnaps",[]);lt.addGetterSetter(We,"rotateAnchorOffset",50,Vt());lt.addGetterSetter(We,"rotateAnchorCursor","crosshair");lt.addGetterSetter(We,"rotationSnapTolerance",5,Vt());lt.addGetterSetter(We,"borderEnabled",!0);lt.addGetterSetter(We,"anchorStroke","rgb(0, 161, 255)");lt.addGetterSetter(We,"anchorStrokeWidth",1,Vt());lt.addGetterSetter(We,"anchorFill","white");lt.addGetterSetter(We,"anchorCornerRadius",0,Vt());lt.addGetterSetter(We,"borderStroke","rgb(0, 161, 255)");lt.addGetterSetter(We,"borderStrokeWidth",1,Vt());lt.addGetterSetter(We,"borderDash");lt.addGetterSetter(We,"keepRatio",!0);lt.addGetterSetter(We,"shiftBehavior","default");lt.addGetterSetter(We,"centeredScaling",!1);lt.addGetterSetter(We,"ignoreStroke",!1);lt.addGetterSetter(We,"padding",0,Vt());lt.addGetterSetter(We,"nodes");lt.addGetterSetter(We,"node");lt.addGetterSetter(We,"boundBoxFunc");lt.addGetterSetter(We,"anchorDragBoundFunc");lt.addGetterSetter(We,"anchorStyleFunc");lt.addGetterSetter(We,"shouldOverdrawWholeArea",!1);lt.addGetterSetter(We,"useSingleNodeRotation",!0);lt.backCompat(We,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class yl extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Xt.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}yl.prototype.className="Wedge";yl.prototype._centroid=!0;yl.prototype._attrsAffectingSize=["radius"];Qn(yl);lt.addGetterSetter(yl,"radius",0,Vt());lt.addGetterSetter(yl,"angle",0,Vt());lt.addGetterSetter(yl,"clockwise",!1);lt.backCompat(yl,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Fy(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const g6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],p6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function m6(l,t){const n=l.data,a=l.width,r=l.height;let o,f,h,g,m,_,C,E,R,v,D,B,L,N,M,G,O,w,T,y;const z=t+t+1,U=a-1,P=r-1,K=t+1,Q=K*(K+1)/2,X=new Fy,Y=g6[t],j=p6[t];let I=null,F=X,W=null,nt=null;for(let Z=1;Z<z;Z++)F=F.next=new Fy,Z===K&&(I=F);F.next=X,h=f=0;for(let Z=0;Z<r;Z++){B=L=N=M=g=m=_=C=0,E=K*(G=n[f]),R=K*(O=n[f+1]),v=K*(w=n[f+2]),D=K*(T=n[f+3]),g+=Q*G,m+=Q*O,_+=Q*w,C+=Q*T,F=X;for(let it=0;it<K;it++)F.r=G,F.g=O,F.b=w,F.a=T,F=F.next;for(let it=1;it<K;it++)o=f+((U<it?U:it)<<2),g+=(F.r=G=n[o])*(y=K-it),m+=(F.g=O=n[o+1])*y,_+=(F.b=w=n[o+2])*y,C+=(F.a=T=n[o+3])*y,B+=G,L+=O,N+=w,M+=T,F=F.next;W=X,nt=I;for(let it=0;it<a;it++)n[f+3]=T=C*Y>>j,T!==0?(T=255/T,n[f]=(g*Y>>j)*T,n[f+1]=(m*Y>>j)*T,n[f+2]=(_*Y>>j)*T):n[f]=n[f+1]=n[f+2]=0,g-=E,m-=R,_-=v,C-=D,E-=W.r,R-=W.g,v-=W.b,D-=W.a,o=h+((o=it+t+1)<U?o:U)<<2,B+=W.r=n[o],L+=W.g=n[o+1],N+=W.b=n[o+2],M+=W.a=n[o+3],g+=B,m+=L,_+=N,C+=M,W=W.next,E+=G=nt.r,R+=O=nt.g,v+=w=nt.b,D+=T=nt.a,B-=G,L-=O,N-=w,M-=T,nt=nt.next,f+=4;h+=a}for(let Z=0;Z<a;Z++){L=N=M=B=m=_=C=g=0,f=Z<<2,E=K*(G=n[f]),R=K*(O=n[f+1]),v=K*(w=n[f+2]),D=K*(T=n[f+3]),g+=Q*G,m+=Q*O,_+=Q*w,C+=Q*T,F=X;for(let rt=0;rt<K;rt++)F.r=G,F.g=O,F.b=w,F.a=T,F=F.next;let it=a;for(let rt=1;rt<=t;rt++)f=it+Z<<2,g+=(F.r=G=n[f])*(y=K-rt),m+=(F.g=O=n[f+1])*y,_+=(F.b=w=n[f+2])*y,C+=(F.a=T=n[f+3])*y,B+=G,L+=O,N+=w,M+=T,F=F.next,rt<P&&(it+=a);f=Z,W=X,nt=I;for(let rt=0;rt<r;rt++)o=f<<2,n[o+3]=T=C*Y>>j,T>0?(T=255/T,n[o]=(g*Y>>j)*T,n[o+1]=(m*Y>>j)*T,n[o+2]=(_*Y>>j)*T):n[o]=n[o+1]=n[o+2]=0,g-=E,m-=R,_-=v,C-=D,E-=W.r,R-=W.g,v-=W.b,D-=W.a,o=Z+((o=rt+K)<P?o:P)*a<<2,g+=B+=W.r=n[o],m+=L+=W.g=n[o+1],_+=N+=W.b=n[o+2],C+=M+=W.a=n[o+3],W=W.next,E+=G=nt.r,R+=O=nt.g,v+=w=nt.b,D+=T=nt.a,B-=G,L-=O,N-=w,M-=T,nt=nt.next,f+=a}}const v6=function(t){const n=Math.round(this.blurRadius());n>0&&m6(t,n)};lt.addGetterSetter(qt,"blurRadius",0,Vt(),lt.afterSetFilter);const y6=function(l){const t=this.brightness()*255,n=l.data,a=n.length;for(let r=0;r<a;r+=4)n[r]+=t,n[r+1]+=t,n[r+2]+=t};lt.addGetterSetter(qt,"brightness",0,Vt(),lt.afterSetFilter);const S6=function(l){const t=this.brightness(),n=l.data,a=n.length;for(let r=0;r<a;r+=4)n[r]=Math.min(255,n[r]*t),n[r+1]=Math.min(255,n[r+1]*t),n[r+2]=Math.min(255,n[r+2]*t)},b6=function(l){const t=Math.pow((this.contrast()+100)/100,2),n=l.data,a=n.length;let r=150,o=150,f=150;for(let h=0;h<a;h+=4)r=n[h],o=n[h+1],f=n[h+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,f/=255,f-=.5,f*=t,f+=.5,f*=255,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,f=f<0?0:f>255?255:f,n[h]=r,n[h+1]=o,n[h+2]=f};lt.addGetterSetter(qt,"contrast",0,Vt(),lt.afterSetFilter);const _6=function(l){var t,n,a,r,o,f,h,g,m;const _=l.data,C=l.width,E=l.height,R=Math.min(1,Math.max(0,(n=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:.5)),v=Math.min(1,Math.max(0,(r=(a=this.embossWhiteLevel)===null||a===void 0?void 0:a.call(this))!==null&&r!==void 0?r:.5)),B=(h={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(f=(o=this.embossDirection)===null||o===void 0?void 0:o.call(this))!==null&&f!==void 0?f:"top-left"])!==null&&h!==void 0?h:315,L=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),N=R*10,M=v*255,G=B*Math.PI/180,O=Math.cos(G),w=Math.sin(G),T=128/1020*N,y=new Uint8ClampedArray(_),z=new Float32Array(C*E);for(let X=0,Y=0;Y<_.length;Y+=4,X++)z[X]=.2126*y[Y]+.7152*y[Y+1]+.0722*y[Y+2];const U=[-1,0,1,-2,0,2,-1,0,1],P=[-1,-2,-1,0,0,0,1,2,1],K=[-C-1,-C,-C+1,-1,0,1,C-1,C,C+1],Q=X=>X<0?0:X>255?255:X;for(let X=1;X<E-1;X++)for(let Y=1;Y<C-1;Y++){const j=X*C+Y;let I=0,F=0;I+=z[j+K[0]]*U[0],F+=z[j+K[0]]*P[0],I+=z[j+K[1]]*U[1],F+=z[j+K[1]]*P[1],I+=z[j+K[2]]*U[2],F+=z[j+K[2]]*P[2],I+=z[j+K[3]]*U[3],F+=z[j+K[3]]*P[3],I+=z[j+K[5]]*U[5],F+=z[j+K[5]]*P[5],I+=z[j+K[6]]*U[6],F+=z[j+K[6]]*P[6],I+=z[j+K[7]]*U[7],F+=z[j+K[7]]*P[7],I+=z[j+K[8]]*U[8],F+=z[j+K[8]]*P[8];const W=O*I+w*F,nt=Q(M+W*T),Z=j*4;if(L){const it=nt-M;_[Z]=Q(y[Z]+it),_[Z+1]=Q(y[Z+1]+it),_[Z+2]=Q(y[Z+2]+it),_[Z+3]=y[Z+3]}else _[Z]=_[Z+1]=_[Z+2]=nt,_[Z+3]=y[Z+3]}for(let X=0;X<C;X++){let Y=X*4,j=((E-1)*C+X)*4;_[Y]=y[Y],_[Y+1]=y[Y+1],_[Y+2]=y[Y+2],_[Y+3]=y[Y+3],_[j]=y[j],_[j+1]=y[j+1],_[j+2]=y[j+2],_[j+3]=y[j+3]}for(let X=1;X<E-1;X++){let Y=X*C*4,j=(X*C+(C-1))*4;_[Y]=y[Y],_[Y+1]=y[Y+1],_[Y+2]=y[Y+2],_[Y+3]=y[Y+3],_[j]=y[j],_[j+1]=y[j+1],_[j+2]=y[j+2],_[j+3]=y[j+3]}return l};lt.addGetterSetter(qt,"embossStrength",.5,Vt(),lt.afterSetFilter);lt.addGetterSetter(qt,"embossWhiteLevel",.5,Vt(),lt.afterSetFilter);lt.addGetterSetter(qt,"embossDirection","top-left",void 0,lt.afterSetFilter);lt.addGetterSetter(qt,"embossBlend",!1,void 0,lt.afterSetFilter);function Np(l,t,n,a,r){const o=n-t,f=r-a;if(o===0)return a+f/2;if(f===0)return a;let h=(l-t)/o;return h=f*h+a,h}const E6=function(l){const t=l.data,n=t.length;let a=t[0],r=a,o,f=t[1],h=f,g,m=t[2],_=m,C;const E=this.enhance();if(E===0)return;for(let M=0;M<n;M+=4)o=t[M+0],o<a?a=o:o>r&&(r=o),g=t[M+1],g<f?f=g:g>h&&(h=g),C=t[M+2],C<m?m=C:C>_&&(_=C);r===a&&(r=255,a=0),h===f&&(h=255,f=0),_===m&&(_=255,m=0);let R,v,D,B,L,N;if(E>0)R=r+E*(255-r),v=a-E*(a-0),D=h+E*(255-h),B=f-E*(f-0),L=_+E*(255-_),N=m-E*(m-0);else{const M=(r+a)*.5;R=r+E*(r-M),v=a+E*(a-M);const G=(h+f)*.5;D=h+E*(h-G),B=f+E*(f-G);const O=(_+m)*.5;L=_+E*(_-O),N=m+E*(m-O)}for(let M=0;M<n;M+=4)t[M+0]=Np(t[M+0],a,r,v,R),t[M+1]=Np(t[M+1],f,h,B,D),t[M+2]=Np(t[M+2],m,_,N,L)};lt.addGetterSetter(qt,"enhance",0,Vt(),lt.afterSetFilter);const C6=function(l){const t=l.data,n=t.length;for(let a=0;a<n;a+=4){const r=.34*t[a]+.5*t[a+1]+.16*t[a+2];t[a]=r,t[a+1]=r,t[a+2]=r}};lt.addGetterSetter(qt,"hue",0,Vt(),lt.afterSetFilter);lt.addGetterSetter(qt,"saturation",0,Vt(),lt.afterSetFilter);lt.addGetterSetter(qt,"luminance",0,Vt(),lt.afterSetFilter);const T6=function(l){const t=l.data,n=t.length,a=1,r=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,f=this.luminance()*127,h=a*r*Math.cos(o*Math.PI/180),g=a*r*Math.sin(o*Math.PI/180),m=.299*a+.701*h+.167*g,_=.587*a-.587*h+.33*g,C=.114*a-.114*h-.497*g,E=.299*a-.299*h-.328*g,R=.587*a+.413*h+.035*g,v=.114*a-.114*h+.293*g,D=.299*a-.3*h+1.25*g,B=.587*a-.586*h-1.05*g,L=.114*a+.886*h-.2*g;let N,M,G,O;for(let w=0;w<n;w+=4)N=t[w+0],M=t[w+1],G=t[w+2],O=t[w+3],t[w+0]=m*N+_*M+C*G+f,t[w+1]=E*N+R*M+v*G+f,t[w+2]=D*N+B*M+L*G+f,t[w+3]=O},A6=function(l){const t=l.data,n=t.length,a=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,f=a*r*Math.cos(o*Math.PI/180),h=a*r*Math.sin(o*Math.PI/180),g=.299*a+.701*f+.167*h,m=.587*a-.587*f+.33*h,_=.114*a-.114*f-.497*h,C=.299*a-.299*f-.328*h,E=.587*a+.413*f+.035*h,R=.114*a-.114*f+.293*h,v=.299*a-.3*f+1.25*h,D=.587*a-.586*f-1.05*h,B=.114*a+.886*f-.2*h;for(let L=0;L<n;L+=4){const N=t[L+0],M=t[L+1],G=t[L+2],O=t[L+3];t[L+0]=g*N+m*M+_*G,t[L+1]=C*N+E*M+R*G,t[L+2]=v*N+D*M+B*G,t[L+3]=O}};lt.addGetterSetter(qt,"hue",0,Vt(),lt.afterSetFilter);lt.addGetterSetter(qt,"saturation",0,Vt(),lt.afterSetFilter);lt.addGetterSetter(qt,"value",0,Vt(),lt.afterSetFilter);const w6=function(l){const t=l.data,n=t.length;for(let a=0;a<n;a+=4)t[a]=255-t[a],t[a+1]=255-t[a+1],t[a+2]=255-t[a+2]},R6=function(l,t,n){const a=l.data,r=t.data,o=l.width,f=l.height,h=n.polarCenterX||o/2,g=n.polarCenterY||f/2;let m=Math.sqrt(h*h+g*g),_=o-h,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=o,D=360/v*Math.PI/180;for(let B=0;B<v;B+=1){const L=Math.sin(B*D),N=Math.cos(B*D);for(let M=0;M<R;M+=1){_=Math.floor(h+m*M/R*N),C=Math.floor(g+m*M/R*L);let G=(C*o+_)*4;const O=a[G+0],w=a[G+1],T=a[G+2],y=a[G+3];G=(B+M*o)*4,r[G+0]=O,r[G+1]=w,r[G+2]=T,r[G+3]=y}}},O6=function(l,t,n){const a=l.data,r=t.data,o=l.width,f=l.height,h=n.polarCenterX||o/2,g=n.polarCenterY||f/2;let m=Math.sqrt(h*h+g*g),_=o-h,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=o,D=0;let B,L;for(_=0;_<o;_+=1)for(C=0;C<f;C+=1){const N=_-h,M=C-g,G=Math.sqrt(N*N+M*M)*R/m;let O=(Math.atan2(M,N)*180/Math.PI+360+D)%360;O=O*v/360,B=Math.floor(O),L=Math.floor(G);let w=(L*o+B)*4;const T=a[w+0],y=a[w+1],z=a[w+2],U=a[w+3];w=(C*o+_)*4,r[w+0]=T,r[w+1]=y,r[w+2]=z,r[w+3]=U}},x6=function(l){const t=l.width,n=l.height;let a,r,o,f,h,g,m,_,C,E,R=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),D=Math.floor(t*(v%360)/360);if(R<1)return;const B=mt.createCanvasElement();B.width=t,B.height=n;const L=B.getContext("2d").getImageData(0,0,t,n);mt.releaseCanvas(B),R6(l,L,{polarCenterX:t/2,polarCenterY:n/2});let N=t/Math.pow(2,R);for(;N<=8;)N=N*2,R-=1;N=Math.ceil(N);let M=N,G=0,O=M,w=1;for(D+N>t&&(G=M,O=0,w=-1),r=0;r<n;r+=1)for(a=G;a!==O;a+=w)o=Math.round(a+D)%t,C=(t*r+o)*4,h=L.data[C+0],g=L.data[C+1],m=L.data[C+2],_=L.data[C+3],E=(t*r+a)*4,L.data[E+0]=h,L.data[E+1]=g,L.data[E+2]=m,L.data[E+3]=_;for(r=0;r<n;r+=1)for(M=Math.floor(N),f=0;f<R;f+=1){for(a=0;a<M+1;a+=1)C=(t*r+a)*4,h=L.data[C+0],g=L.data[C+1],m=L.data[C+2],_=L.data[C+3],E=(t*r+M*2-a-1)*4,L.data[E+0]=h,L.data[E+1]=g,L.data[E+2]=m,L.data[E+3]=_;M*=2}O6(L,l,{})};lt.addGetterSetter(qt,"kaleidoscopePower",2,Vt(),lt.afterSetFilter);lt.addGetterSetter(qt,"kaleidoscopeAngle",0,Vt(),lt.afterSetFilter);function tg(l,t,n){let a=(n*l.width+t)*4;const r=[];return r.push(l.data[a++],l.data[a++],l.data[a++],l.data[a++]),r}function Jh(l,t){return Math.sqrt(Math.pow(l[0]-t[0],2)+Math.pow(l[1]-t[1],2)+Math.pow(l[2]-t[2],2))}function M6(l){const t=[0,0,0];for(let n=0;n<l.length;n++)t[0]+=l[n][0],t[1]+=l[n][1],t[2]+=l[n][2];return t[0]/=l.length,t[1]/=l.length,t[2]/=l.length,t}function N6(l,t){const n=tg(l,0,0),a=tg(l,l.width-1,0),r=tg(l,0,l.height-1),o=tg(l,l.width-1,l.height-1),f=t||10;if(Jh(n,a)<f&&Jh(a,o)<f&&Jh(o,r)<f&&Jh(r,n)<f){const h=M6([a,n,o,r]),g=[];for(let m=0;m<l.width*l.height;m++){const _=Jh(h,[l.data[m*4],l.data[m*4+1],l.data[m*4+2]]);g[m]=_<f?0:255}return g}}function D6(l,t){for(let n=0;n<l.width*l.height;n++)l.data[4*n+3]=t[n]}function j6(l,t,n){const a=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(a.length)),o=Math.floor(r/2),f=[];for(let h=0;h<n;h++)for(let g=0;g<t;g++){const m=h*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=h+C-o,v=g+E-o;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,B=a[C*r+E];_+=l[D]*B}}f[m]=_===2040?255:0}return f}function U6(l,t,n){const a=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(a.length)),o=Math.floor(r/2),f=[];for(let h=0;h<n;h++)for(let g=0;g<t;g++){const m=h*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=h+C-o,v=g+E-o;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,B=a[C*r+E];_+=l[D]*B}}f[m]=_>=1020?255:0}return f}function B6(l,t,n){const a=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(a.length)),o=Math.floor(r/2),f=[];for(let h=0;h<n;h++)for(let g=0;g<t;g++){const m=h*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=h+C-o,v=g+E-o;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,B=a[C*r+E];_+=l[D]*B}}f[m]=_}return f}const z6=function(l){const t=this.threshold();let n=N6(l,t);return n&&(n=j6(n,l.width,l.height),n=U6(n,l.width,l.height),n=B6(n,l.width,l.height),D6(l,n)),l};lt.addGetterSetter(qt,"threshold",0,Vt(),lt.afterSetFilter);const L6=function(l){const t=this.noise()*255,n=l.data,a=n.length,r=t/2;for(let o=0;o<a;o+=4)n[o+0]+=r-2*r*Math.random(),n[o+1]+=r-2*r*Math.random(),n[o+2]+=r-2*r*Math.random()};lt.addGetterSetter(qt,"noise",.2,Vt(),lt.afterSetFilter);const G6=function(l){let t=Math.ceil(this.pixelSize()),n=l.width,a=l.height,r=Math.ceil(n/t),o=Math.ceil(a/t),f=l.data;if(t<=0){mt.error("pixelSize value can not be <= 0");return}for(let h=0;h<r;h+=1)for(let g=0;g<o;g+=1){let m=0,_=0,C=0,E=0;const R=h*t,v=R+t,D=g*t,B=D+t;let L=0;for(let N=R;N<v;N+=1)if(!(N>=n))for(let M=D;M<B;M+=1){if(M>=a)continue;const G=(n*M+N)*4;m+=f[G+0],_+=f[G+1],C+=f[G+2],E+=f[G+3],L+=1}m=m/L,_=_/L,C=C/L,E=E/L;for(let N=R;N<v;N+=1)if(!(N>=n))for(let M=D;M<B;M+=1){if(M>=a)continue;const G=(n*M+N)*4;f[G+0]=m,f[G+1]=_,f[G+2]=C,f[G+3]=E}}};lt.addGetterSetter(qt,"pixelSize",8,Vt(),lt.afterSetFilter);const P6=function(l){const t=Math.round(this.levels()*254)+1,n=l.data,a=n.length,r=255/t;for(let o=0;o<a;o+=1)n[o]=Math.floor(n[o]/r)*r};lt.addGetterSetter(qt,"levels",.5,Vt(),lt.afterSetFilter);const H6=function(l){const t=l.data,n=t.length,a=this.red(),r=this.green(),o=this.blue();for(let f=0;f<n;f+=4){const h=(.34*t[f]+.5*t[f+1]+.16*t[f+2])/255;t[f]=h*a,t[f+1]=h*r,t[f+2]=h*o,t[f+3]=t[f+3]}};lt.addGetterSetter(qt,"red",0,function(l){return this._filterUpToDate=!1,l>255?255:l<0?0:Math.round(l)});lt.addGetterSetter(qt,"green",0,function(l){return this._filterUpToDate=!1,l>255?255:l<0?0:Math.round(l)});lt.addGetterSetter(qt,"blue",0,j2,lt.afterSetFilter);const I6=function(l){const t=l.data,n=t.length,a=this.red(),r=this.green(),o=this.blue(),f=this.alpha();for(let h=0;h<n;h+=4){const g=1-f;t[h]=a*f+t[h]*g,t[h+1]=r*f+t[h+1]*g,t[h+2]=o*f+t[h+2]*g}};lt.addGetterSetter(qt,"red",0,function(l){return this._filterUpToDate=!1,l>255?255:l<0?0:Math.round(l)});lt.addGetterSetter(qt,"green",0,function(l){return this._filterUpToDate=!1,l>255?255:l<0?0:Math.round(l)});lt.addGetterSetter(qt,"blue",0,j2,lt.afterSetFilter);lt.addGetterSetter(qt,"alpha",1,function(l){return this._filterUpToDate=!1,l>1?1:l<0?0:l});const k6=function(l){const t=l.data,n=t.length;for(let a=0;a<n;a+=4){const r=t[a+0],o=t[a+1],f=t[a+2];t[a+0]=Math.min(255,r*.393+o*.769+f*.189),t[a+1]=Math.min(255,r*.349+o*.686+f*.168),t[a+2]=Math.min(255,r*.272+o*.534+f*.131)}},q6=function(l){const n=l.data;for(let a=0;a<n.length;a+=4){const r=n[a],o=n[a+1],f=n[a+2];.2126*r+.7152*o+.0722*f>=128&&(n[a]=255-r,n[a+1]=255-o,n[a+2]=255-f)}return l},V6=function(l){const t=this.threshold()*255,n=l.data,a=n.length;for(let r=0;r<a;r+=1)n[r]=n[r]<t?0:255};lt.addGetterSetter(qt,"threshold",.5,Vt(),lt.afterSetFilter);hf.Util._assign(hf,{Arc:ml,Arrow:Eu,Circle:Sf,Ellipse:po,Image:qr,Label:ev,Tag:Cu,Line:vl,Path:jn,Rect:yd,RegularPolygon:mo,Ring:Tu,Sprite:bs,Star:vo,Text:Gn,TextPath:Ta,Transformer:We,Wedge:yl,Filters:{Blur:v6,Brightness:S6,Brighten:y6,Contrast:b6,Emboss:_6,Enhance:E6,Grayscale:C6,HSL:T6,HSV:A6,Invert:w6,Kaleidoscope:x6,Mask:z6,Noise:L6,Pixelate:G6,Posterize:P6,RGB:H6,RGBA:I6,Sepia:k6,Solarize:q6,Threshold:V6}});var Dp={exports:{}},jp={exports:{}},Up={exports:{}},Bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy;function Y6(){return Jy||(Jy=1,(function(l){function t(j,I){var F=j.length;j.push(I);t:for(;0<F;){var W=F-1>>>1,nt=j[W];if(0<r(nt,I))j[W]=I,j[F]=nt,F=W;else break t}}function n(j){return j.length===0?null:j[0]}function a(j){if(j.length===0)return null;var I=j[0],F=j.pop();if(F!==I){j[0]=F;t:for(var W=0,nt=j.length,Z=nt>>>1;W<Z;){var it=2*(W+1)-1,rt=j[it],V=it+1,J=j[V];if(0>r(rt,F))V<nt&&0>r(J,rt)?(j[W]=J,j[V]=F,W=V):(j[W]=rt,j[it]=F,W=it);else if(V<nt&&0>r(J,F))j[W]=J,j[V]=F,W=V;else break t}}return I}function r(j,I){var F=j.sortIndex-I.sortIndex;return F!==0?F:j.id-I.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;l.unstable_now=function(){return o.now()}}else{var f=Date,h=f.now();l.unstable_now=function(){return f.now()-h}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,B=!1,L=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(j){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=j)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(j){if(D=!1,G(j),!v)if(n(g)!==null)v=!0,w||(w=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-j)}}var w=!1,T=-1,y=5,z=-1;function U(){return B?!0:!(l.unstable_now()-z<y)}function P(){if(B=!1,w){var j=l.unstable_now();z=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(T),T=-1),R=!0;var F=E;try{e:{for(G(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var nt=W(C.expirationTime<=j);if(j=l.unstable_now(),typeof nt=="function"){C.callback=nt,G(j),I=!0;break e}C===n(g)&&a(g),G(j)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-j),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():w=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=P,K=function(){X.postMessage(null)}}else K=function(){L(P,0)};function Y(j,I){T=L(function(){j(l.unstable_now())},I)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(j){j.callback=null},l.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},l.unstable_getCurrentPriorityLevel=function(){return E},l.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return j()}finally{E=F}},l.unstable_requestPaint=function(){B=!0},l.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var F=E;E=j;try{return I()}finally{E=F}},l.unstable_scheduleCallback=function(j,I,F){var W=l.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,j){case 1:var nt=-1;break;case 2:nt=250;break;case 5:nt=1073741823;break;case 4:nt=1e4;break;default:nt=5e3}return nt=F+nt,j={id:_++,callback:I,priorityLevel:j,startTime:F,expirationTime:nt,sortIndex:-1},F>W?(j.sortIndex=F,t(m,j),n(g)===null&&j===n(m)&&(D?(N(T),T=-1):D=!0,Y(O,F-W))):(j.sortIndex=nt,t(g,j),v||R||(v=!0,w||(w=!0,K()))),j},l.unstable_shouldYield=U,l.unstable_wrapCallback=function(j){var I=E;return function(){var F=E;E=I;try{return j.apply(this,arguments)}finally{E=F}}}})(Bp)),Bp}var Zy;function K6(){return Zy||(Zy=1,Up.exports=Y6()),Up.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function Q6(){return Wy||(Wy=1,(function(l){l.exports=function(t){function n(s,u,p,S){return new uc(s,u,p,S)}function a(){}function r(s){var u="https://react.dev/errors/"+s;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){var u=s,p=s;if(s.alternate)for(;u.return;)u=u.return;else{s=u;do u=s,(u.flags&4098)!==0&&(p=u.return),s=u.return;while(s)}return u.tag===3?p:null}function f(s){if(o(s)!==s)throw Error(r(188))}function h(s){var u=s.alternate;if(!u){if(u=o(s),u===null)throw Error(r(188));return u!==s?null:s}for(var p=s,S=u;;){var x=p.return;if(x===null)break;var H=x.alternate;if(H===null){if(S=x.return,S!==null){p=S;continue}break}if(x.child===H.child){for(H=x.child;H;){if(H===p)return f(x),s;if(H===S)return f(x),u;H=H.sibling}throw Error(r(188))}if(p.return!==S.return)p=x,S=H;else{for(var et=!1,ut=x.child;ut;){if(ut===p){et=!0,p=x,S=H;break}if(ut===S){et=!0,S=x,p=H;break}ut=ut.sibling}if(!et){for(ut=H.child;ut;){if(ut===p){et=!0,p=H,S=x;break}if(ut===S){et=!0,S=H,p=x;break}ut=ut.sibling}if(!et)throw Error(r(189))}}if(p.alternate!==S)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:u}function g(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(u=g(s),u!==null)return u;s=s.sibling}return null}function m(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(s.tag!==4&&(u=m(s),u!==null))return u;s=s.sibling}return null}function _(s){return s===null||typeof s!="object"?null:(s=Ko&&s[Ko]||s["@@iterator"],typeof s=="function"?s:null)}function C(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Qo?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case Ls:return"Fragment";case qo:return"Profiler";case Gs:return"StrictMode";case Ar:return"Suspense";case wr:return"SuspenseList";case is:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case Cr:return"Portal";case Tr:return(s.displayName||"Context")+".Provider";case Vo:return(s._context.displayName||"Context")+".Consumer";case gc:var u=s.render;return s=s.displayName,s||(s=u.displayName||u.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case pc:return u=s.displayName||null,u!==null?u:C(s.type)||"Memo";case Rr:u=s._payload,s=s._init;try{return C(s(u))}catch{}}return null}function E(s){return{current:s}}function R(s){0>Ys||(s.current=tu[Ys],tu[Ys]=null,Ys--)}function v(s,u){Ys++,tu[Ys]=s.current,s.current=u}function D(s){return s>>>=0,s===0?32:31-(S0(s)/b0|0)|0}function B(s){var u=s&42;if(u!==0)return u;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function L(s,u,p){var S=s.pendingLanes;if(S===0)return 0;var x=0,H=s.suspendedLanes,et=s.pingedLanes;s=s.warmLanes;var ut=S&134217727;return ut!==0?(S=ut&~H,S!==0?x=B(S):(et&=ut,et!==0?x=B(et):p||(p=ut&~s,p!==0&&(x=B(p))))):(ut=S&~H,ut!==0?x=B(ut):et!==0?x=B(et):p||(p=S&~s,p!==0&&(x=B(p)))),x===0?0:u!==0&&u!==x&&(u&H)===0&&(H=x&-x,p=u&-u,H>=p||H===32&&(p&4194048)!==0)?u:x}function N(s,u){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&u)===0}function M(s,u){switch(s){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G(){var s=ar;return ar<<=1,(ar&4194048)===0&&(ar=256),s}function O(){var s=eu;return eu<<=1,(eu&62914560)===0&&(eu=4194304),s}function w(s){for(var u=[],p=0;31>p;p++)u.push(s);return u}function T(s,u){s.pendingLanes|=u,u!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function y(s,u,p,S,x,H){var et=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ut=s.entanglements,_t=s.expirationTimes,Ut=s.hiddenUpdates;for(p=et&~p;0<p;){var Pt=31-La(p),Zt=1<<Pt;ut[Pt]=0,_t[Pt]=-1;var $t=Ut[Pt];if($t!==null)for(Ut[Pt]=null,Pt=0;Pt<$t.length;Pt++){var Oe=$t[Pt];Oe!==null&&(Oe.lane&=-536870913)}p&=~Zt}S!==0&&z(s,S,0),H!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=H&~(et&~u))}function z(s,u,p){s.pendingLanes|=u,s.suspendedLanes&=~u;var S=31-La(u);s.entangledLanes|=u,s.entanglements[S]=s.entanglements[S]|1073741824|p&4194090}function U(s,u){var p=s.entangledLanes|=u;for(s=s.entanglements;p;){var S=31-La(p),x=1<<S;x&u|s[S]&u&&(s[S]|=u),p&=~x}}function P(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function K(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Q(s){if(typeof $n=="function"&&ya(s),Fa&&typeof Fa.setStrictMode=="function")try{Fa.setStrictMode(ql,s)}catch{}}function X(s){if(Dc===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Dc=u&&u[1]||"",Oh=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Dc+s+Oh}function Y(s,u){if(!s||Ks)return"";Ks=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(u){var Zt=function(){throw Error()};if(Object.defineProperty(Zt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Zt,[])}catch(Oe){var $t=Oe}Reflect.construct(s,[],Zt)}else{try{Zt.call()}catch(Oe){$t=Oe}s.call(Zt.prototype)}}else{try{throw Error()}catch(Oe){$t=Oe}(Zt=s())&&typeof Zt.catch=="function"&&Zt.catch(function(){})}}catch(Oe){if(Oe&&$t&&typeof Oe.stack=="string")return[Oe.stack,$t.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var H=S.DetermineComponentFrameRoot(),et=H[0],ut=H[1];if(et&&ut){var _t=et.split(`
`),Ut=ut.split(`
`);for(x=S=0;S<_t.length&&!_t[S].includes("DetermineComponentFrameRoot");)S++;for(;x<Ut.length&&!Ut[x].includes("DetermineComponentFrameRoot");)x++;if(S===_t.length||x===Ut.length)for(S=_t.length-1,x=Ut.length-1;1<=S&&0<=x&&_t[S]!==Ut[x];)x--;for(;1<=S&&0<=x;S--,x--)if(_t[S]!==Ut[x]){if(S!==1||x!==1)do if(S--,x--,0>x||_t[S]!==Ut[x]){var Pt=`
`+_t[S].replace(" at new "," at ");return s.displayName&&Pt.includes("<anonymous>")&&(Pt=Pt.replace("<anonymous>",s.displayName)),Pt}while(1<=S&&0<=x);break}}}finally{Ks=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?X(p):""}function j(s){switch(s.tag){case 26:case 27:case 5:return X(s.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return Y(s.type,!1);case 11:return Y(s.type.render,!1);case 1:return Y(s.type,!0);case 31:return X("Activity");default:return""}}function I(s){try{var u="";do u+=j(s),s=s.return;while(s);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function F(s,u){if(typeof s=="object"&&s!==null){var p=xh.get(s);return p!==void 0?p:(u={value:s,source:u,stack:I(u)},xh.set(s,u),u)}return{value:s,source:u,stack:I(u)}}function W(s,u){Mr[Qs++]=Xs,Mr[Qs++]=jc,jc=s,Xs=u}function nt(s,u,p){Ja[fi++]=ir,Ja[fi++]=ji,Ja[fi++]=fs,fs=s;var S=ir;s=ji;var x=32-La(S)-1;S&=~(1<<x),p+=1;var H=32-La(u)+x;if(30<H){var et=x-x%5;H=(S&(1<<et)-1).toString(32),S>>=et,x-=et,ir=1<<32-La(u)+x|p<<x|S,ji=H+s}else ir=1<<H|p<<x|S,ji=s}function Z(s){s.return!==null&&(W(s,1),nt(s,1,0))}function it(s){for(;s===jc;)jc=Mr[--Qs],Mr[Qs]=null,Xs=Mr[--Qs],Mr[Qs]=null;for(;s===fs;)fs=Ja[--fi],Ja[fi]=null,ji=Ja[--fi],Ja[fi]=null,ir=Ja[--fi],Ja[fi]=null}function rt(s,u){v(Nr,u),v(Fs,s),v(na,null),s=ih(u),R(na),v(na,s)}function V(){R(na),R(Fs),R(Nr)}function J(s){s.memoizedState!==null&&v(Vl,s);var u=na.current,p=rs(u,s.type);u!==p&&(v(Fs,s),v(na,p))}function $(s){Fs.current===s&&(R(na),R(Fs)),Vl.current===s&&(R(Vl),Zi?Ei._currentValue=xr:Ei._currentValue2=xr)}function at(s){var u=Error(r(418,""));throw pe(F(u,s)),Bi}function ht(s,u){if(!xn)throw Error(r(175));l0(s.stateNode,s.type,s.memoizedProps,u,s)||at(s)}function Rt(s){for(la=s.return;la;)switch(la.tag){case 5:case 13:Ui=!1;return;case 27:case 3:Ui=!0;return;default:la=la.return}}function zt(s){if(!xn||s!==la)return!1;if(!tn)return Rt(s),tn=!0,!1;var u=s.tag;if(qn?u!==3&&u!==27&&(u!==5||wc(s.type)&&!ls(s.type,s.memoizedProps))&&Vn&&at(s):u!==3&&(u!==5||wc(s.type)&&!ls(s.type,s.memoizedProps))&&Vn&&at(s),Rt(s),u===13){if(!xn)throw Error(r(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Vn=o0(s)}else Vn=qn&&u===27?a0(s.type,Vn):la?yh(s.stateNode):null;return!0}function Wt(){xn&&(Vn=la=null,tn=!1)}function It(){var s=Dr;return s!==null&&(xa===null?xa=s:xa.push.apply(xa,s),Dr=null),s}function pe(s){Dr===null?Dr=[s]:Dr.push(s)}function Bt(s,u){return s===u&&(s!==0||1/s===1/u)||s!==s&&u!==u}function Te(s,u,p){Zi?(v(Uc,u._currentValue),u._currentValue=p):(v(Uc,u._currentValue2),u._currentValue2=p)}function ze(s){var u=Uc.current;Zi?s._currentValue=u:s._currentValue2=u,R(Uc)}function Xe(s,u,p){for(;s!==null;){var S=s.alternate;if((s.childLanes&u)!==u?(s.childLanes|=u,S!==null&&(S.childLanes|=u)):S!==null&&(S.childLanes&u)!==u&&(S.childLanes|=u),s===p)break;s=s.return}}function ke(s,u,p,S){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var H=x.dependencies;if(H!==null){var et=x.child;H=H.firstContext;t:for(;H!==null;){var ut=H;H=x;for(var _t=0;_t<u.length;_t++)if(ut.context===u[_t]){H.lanes|=p,ut=H.alternate,ut!==null&&(ut.lanes|=p),Xe(H.return,p,s),S||(et=null);break t}H=ut.next}}else if(x.tag===18){if(et=x.return,et===null)throw Error(r(341));et.lanes|=p,H=et.alternate,H!==null&&(H.lanes|=p),Xe(et,p,s),et=null}else et=x.child;if(et!==null)et.return=x;else for(et=x;et!==null;){if(et===s){et=null;break}if(x=et.sibling,x!==null){x.return=et.return,et=x;break}et=et.return}x=et}}function hn(s,u,p,S){s=null;for(var x=u,H=!1;x!==null;){if(!H){if((x.flags&524288)!==0)H=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var et=x.alternate;if(et===null)throw Error(r(387));if(et=et.memoizedProps,et!==null){var ut=x.type;Ga(x.pendingProps.value,et.value)||(s!==null?s.push(ut):s=[ut])}}else if(x===Vl.current){if(et=x.alternate,et===null)throw Error(r(387));et.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Ei):s=[Ei])}x=x.return}s!==null&&ke(u,s,p,S),u.flags|=262144}function Un(s){for(s=s.firstContext;s!==null;){var u=s.context;if(!Ga(Zi?u._currentValue:u._currentValue2,s.memoizedValue))return!0;s=s.next}return!1}function wt(s){hs=s,Sa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Yt(s){return Se(hs,s)}function Fe(s,u){return hs===null&&wt(s),Se(s,u)}function Se(s,u){var p=Zi?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},Sa===null){if(s===null)throw Error(r(308));Sa=u,s.dependencies={lanes:0,firstContext:u},s.flags|=524288}else Sa=Sa.next=u;return p}function we(){return{controller:new Mh,data:new Map,refCount:0}}function $e(s){s.refCount--,s.refCount===0&&C0(Bc,function(){s.controller.abort()})}function Ae(s){s!==Yl&&s.next===null&&(Yl===null?dn=Yl=s:Yl=Yl.next=s),au=!0,Nh||(Nh=!0,vt())}function ct(s,u){if(!Js&&au){Js=!0;do for(var p=!1,S=dn;S!==null;){if(s!==0){var x=S.pendingLanes;if(x===0)var H=0;else{var et=S.suspendedLanes,ut=S.pingedLanes;H=(1<<31-La(42|s)+1)-1,H&=x&~(et&~ut),H=H&201326741?H&201326741|1:H?H|2:0}H!==0&&(p=!0,Lt(S,H))}else H=Le,H=L(S,S===gn?H:0,S.cancelPendingCommit!==null||S.timeoutHandle!==Ji),(H&3)===0||N(S,H)||(p=!0,Lt(S,H));S=S.next}while(p);Js=!1}}function At(){xt()}function xt(){au=Nh=!1;var s=0;hi!==0&&(oi()&&(s=hi),hi=0);for(var u=ci(),p=null,S=dn;S!==null;){var x=S.next,H=kt(S,u);H===0?(S.next=null,p===null?dn=x:p.next=x,x===null&&(Yl=p)):(p=S,(s!==0||(H&3)!==0)&&(au=!0)),S=x}ct(s)}function kt(s,u){for(var p=s.suspendedLanes,S=s.pingedLanes,x=s.expirationTimes,H=s.pendingLanes&-62914561;0<H;){var et=31-La(H),ut=1<<et,_t=x[et];_t===-1?((ut&p)===0||(ut&S)!==0)&&(x[et]=M(ut,u)):_t<=u&&(s.expiredLanes|=ut),H&=~ut}if(u=gn,p=Le,p=L(s,s===u?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==Ji),S=s.callbackNode,p===0||s===u&&(Je===2||Je===9)||s.cancelPendingCommit!==null)return S!==null&&S!==null&&Mc(S),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||N(s,p)){if(u=p&-p,u===s.callbackPriority)return u;switch(S!==null&&Mc(S),K(p)){case 2:case 8:p=E0;break;case 32:p=wh;break;case 268435456:p=Rh;break;default:p=wh}return S=le.bind(null,s),p=nu(p,S),s.callbackPriority=u,s.callbackNode=p,u}return S!==null&&S!==null&&Mc(S),s.callbackPriority=2,s.callbackNode=null,2}function le(s,u){if(sn!==0&&sn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(js()&&s.callbackNode!==p)return null;var S=Le;return S=L(s,s===gn?S:0,s.cancelPendingCommit!==null||s.timeoutHandle!==Ji),S===0?null:(ri(s,S,u),kt(s,ci()),s.callbackNode!=null&&s.callbackNode===p?le.bind(null,s):null)}function Lt(s,u){if(js())return null;ri(s,u,!0)}function vt(){vc?Jo(function(){(je&6)!==0?nu(Ah,At):xt()}):nu(Ah,At)}function gt(){return hi===0&&(hi=G()),hi}function Jt(s,u){if(Kl===null){var p=Kl=[];zc=0,rr=gt(),Pa={status:"pending",value:void 0,then:function(S){p.push(S)}}}return zc++,u.then(se,se),u}function se(){if(--zc===0&&Kl!==null){Pa!==null&&(Pa.status="fulfilled");var s=Kl;Kl=null,rr=0,Pa=null;for(var u=0;u<s.length;u++)(0,s[u])()}}function Kt(s,u){var p=[],S={status:"pending",value:null,reason:null,then:function(x){p.push(x)}};return s.then(function(){S.status="fulfilled",S.value=u;for(var x=0;x<p.length;x++)(0,p[x])(u)},function(x){for(S.status="rejected",S.reason=x,x=0;x<p.length;x++)(0,p[x])(void 0)}),S}function Ce(){var s=jr.current;return s!==null?s:gn.pooledCache}function fe(s,u){u===null?v(jr,jr.current):v(jr,u.pool)}function _e(){var s=Ce();return s===null?null:{parent:Zi?vn._currentValue:vn._currentValue2,pool:s}}function Pe(s,u){if(Ga(s,u))return!0;if(typeof s!="object"||s===null||typeof u!="object"||u===null)return!1;var p=Object.keys(s),S=Object.keys(u);if(p.length!==S.length)return!1;for(S=0;S<p.length;S++){var x=p[S];if(!T0.call(u,x)||!Ga(s[x],u[x]))return!1}return!0}function En(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Aa(){}function pi(s,u,p){switch(p=s[p],p===void 0?s.push(u):p!==u&&(u.then(Aa,Aa),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,_s(s),s;default:if(typeof u.status=="string")u.then(Aa,Aa);else{if(s=gn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=u,s.status="pending",s.then(function(S){if(u.status==="pending"){var x=u;x.status="fulfilled",x.value=S}},function(S){if(u.status==="pending"){var x=u;x.status="rejected",x.reason=S}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,_s(s),s}throw Za=u,Zs}}function Na(){if(Za===null)throw Error(r(459));var s=Za;return Za=null,s}function _s(s){if(s===Zs||s===Ws)throw Error(r(483))}function Dt(){for(var s=ds,u=Lc=ds=0;u<s;){var p=nn[u];nn[u++]=null;var S=nn[u];nn[u++]=null;var x=nn[u];nn[u++]=null;var H=nn[u];if(nn[u++]=null,S!==null&&x!==null){var et=S.pending;et===null?x.next=x:(x.next=et.next,et.next=x),S.pending=x}H!==0&&Ft(p,x,H)}}function jt(s,u,p,S){nn[ds++]=s,nn[ds++]=u,nn[ds++]=p,nn[ds++]=S,Lc|=S,s.lanes|=S,s=s.alternate,s!==null&&(s.lanes|=S)}function te(s,u,p,S){return jt(s,u,p,S),On(s)}function ae(s,u){return jt(s,null,null,u),On(s)}function Ft(s,u,p){s.lanes|=p;var S=s.alternate;S!==null&&(S.lanes|=p);for(var x=!1,H=s.return;H!==null;)H.childLanes|=p,S=H.alternate,S!==null&&(S.childLanes|=p),H.tag===22&&(s=H.stateNode,s===null||s._visibility&1||(x=!0)),s=H,H=H.return;return s.tag===3?(H=s.stateNode,x&&u!==null&&(x=31-La(p),s=H.hiddenUpdates,S=s[x],S===null?s[x]=[u]:S.push(u),u.lane=p|536870912),H):null}function On(s){if(50<fr)throw fr=0,kc=null,Error(r(185));for(var u=s.return;u!==null;)s=u,u=s.return;return s.tag===3?s.stateNode:null}function Xn(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pn(s,u){s=s.updateQueue,u.updateQueue===s&&(u.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ee(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ee(s,u,p){var S=s.updateQueue;if(S===null)return null;if(S=S.shared,(je&2)!==0){var x=S.pending;return x===null?u.next=u:(u.next=x.next,x.next=u),S.pending=u,u=On(s),Ft(s,null,p),u}return jt(s,S,u,p),On(s)}function He(s,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function he(s,u){var p=s.updateQueue,S=s.alternate;if(S!==null&&(S=S.updateQueue,p===S)){var x=null,H=null;if(p=p.firstBaseUpdate,p!==null){do{var et={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};H===null?x=H=et:H=H.next=et,p=p.next}while(p!==null);H===null?x=H=u:H=H.next=u}else x=H=u;p={baseState:S.baseState,firstBaseUpdate:x,lastBaseUpdate:H,shared:S.shared,callbacks:S.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=u:s.next=u,p.lastBaseUpdate=u}function Ne(){if(jh){var s=Pa;if(s!==null)throw s}}function Ue(s,u,p,S){jh=!1;var x=s.updateQueue;Tn=!1;var H=x.firstBaseUpdate,et=x.lastBaseUpdate,ut=x.shared.pending;if(ut!==null){x.shared.pending=null;var _t=ut,Ut=_t.next;_t.next=null,et===null?H=Ut:et.next=Ut,et=_t;var Pt=s.alternate;Pt!==null&&(Pt=Pt.updateQueue,ut=Pt.lastBaseUpdate,ut!==et&&(ut===null?Pt.firstBaseUpdate=Ut:ut.next=Ut,Pt.lastBaseUpdate=_t))}if(H!==null){var Zt=x.baseState;et=0,Pt=Ut=_t=null,ut=H;do{var $t=ut.lane&-536870913,Oe=$t!==ut.lane;if(Oe?(Le&$t)===$t:(S&$t)===$t){$t!==0&&$t===rr&&(jh=!0),Pt!==null&&(Pt=Pt.next={lane:0,tag:ut.tag,payload:ut.payload,callback:null,next:null});t:{var gi=s,Jl=ut;$t=u;var ms=p;switch(Jl.tag){case 1:if(gi=Jl.payload,typeof gi=="function"){Zt=gi.call(ms,Zt,$t);break t}Zt=gi;break t;case 3:gi.flags=gi.flags&-65537|128;case 0:if(gi=Jl.payload,$t=typeof gi=="function"?gi.call(ms,Zt,$t):gi,$t==null)break t;Zt=hc({},Zt,$t);break t;case 2:Tn=!0}}$t=ut.callback,$t!==null&&(s.flags|=64,Oe&&(s.flags|=8192),Oe=x.callbacks,Oe===null?x.callbacks=[$t]:Oe.push($t))}else Oe={lane:$t,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null},Pt===null?(Ut=Pt=Oe,_t=Zt):Pt=Pt.next=Oe,et|=$t;if(ut=ut.next,ut===null){if(ut=x.shared.pending,ut===null)break;Oe=ut,ut=Oe.next,Oe.next=null,x.lastBaseUpdate=Oe,x.shared.pending=null}}while(!0);Pt===null&&(_t=Zt),x.baseState=_t,x.firstBaseUpdate=Ut,x.lastBaseUpdate=Pt,H===null&&(x.shared.lanes=0),Ia|=et,s.lanes=et,s.memoizedState=Zt}}function rn(s,u){if(typeof s!="function")throw Error(r(191,s));s.call(u)}function ia(s,u){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)rn(p[s],u)}function mi(s,u){s=Ai,v(su,s),v($s,u),Ai=s|u.baseLanes}function Es(){v(su,Ai),v($s,$s.current)}function ki(){Ai=su.current,R($s),R(su)}function Bn(){throw Error(r(321))}function Vr(s,u){if(u===null)return!1;for(var p=0;p<u.length&&p<s.length;p++)if(!Ga(s[p],u[p]))return!1;return!0}function Yr(s,u,p,S,x,H){return an=H,ce=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ue.H=s===null||s.memoizedState===null?Uh:sr,el=!1,H=p(S,x),el=!1,tl&&(H=Cs(u,p,S,x)),Sl(s),H}function Sl(s){ue.H=ba;var u=Ve!==null&&Ve.next!==null;if(an=0,Yn=Ve=ce=null,lu=!1,oa=0,Ra=null,u)throw Error(r(300));s===null||aa||(s=s.dependencies,s!==null&&Un(s)&&(aa=!0))}function Cs(s,u,p,S){ce=s;var x=0;do{if(tl&&(Ra=null),oa=0,tl=!1,25<=x)throw Error(r(301));if(x+=1,Yn=Ve=null,s.updateQueue!=null){var H=s.updateQueue;H.lastEffect=null,H.events=null,H.stores=null,H.memoCache!=null&&(H.memoCache.index=0)}ue.H=al,H=u(p,S)}while(tl);return H}function ra(){var s=ue.H,u=s.useState()[0];return u=typeof u.then=="function"?bl(u):u,s=s.useState()[0],(Ve!==null?Ve.memoizedState:null)!==s&&(ce.flags|=1024),u}function xu(){var s=nl!==0;return nl=0,s}function Mu(s,u,p){u.updateQueue=s.updateQueue,u.flags&=-2053,s.lanes&=~p}function pr(s){if(lu){for(s=s.memoizedState;s!==null;){var u=s.queue;u!==null&&(u.pending=null),s=s.next}lu=!1}an=0,Yn=Ve=ce=null,tl=!1,oa=nl=0,Ra=null}function ea(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?ce.memoizedState=Yn=s:Yn=Yn.next=s,Yn}function Fn(){if(Ve===null){var s=ce.alternate;s=s!==null?s.memoizedState:null}else s=Ve.next;var u=Yn===null?ce.memoizedState:Yn.next;if(u!==null)Yn=u,Ve=s;else{if(s===null)throw ce.alternate===null?Error(r(467)):Error(r(310));Ve=s,s={memoizedState:Ve.memoizedState,baseState:Ve.baseState,baseQueue:Ve.baseQueue,queue:Ve.queue,next:null},Yn===null?ce.memoizedState=Yn=s:Yn=Yn.next=s}return Yn}function Nu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bl(s){var u=oa;return oa+=1,Ra===null&&(Ra=[]),s=pi(Ra,s,u),u=ce,(Yn===null?u.memoizedState:Yn.next)===null&&(u=u.alternate,ue.H=u===null||u.memoizedState===null?Uh:sr),s}function Du(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return bl(s);if(s.$$typeof===Tr)return Yt(s)}throw Error(r(438,String(s)))}function _l(s){var u=null,p=ce.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var S=ce.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(u={data:S.data.map(function(x){return x.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Nu(),ce.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(s),S=0;S<s;S++)p[S]=Yo;return u.index++,p}function vi(s,u){return typeof u=="function"?u(s):u}function yi(s){var u=Fn();return qa(u,Ve,s)}function qa(s,u,p){var S=s.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=p;var x=s.baseQueue,H=S.pending;if(H!==null){if(x!==null){var et=x.next;x.next=H.next,H.next=et}u.baseQueue=x=H,S.pending=null}if(H=s.baseState,x===null)s.memoizedState=H;else{u=x.next;var ut=et=null,_t=null,Ut=u,Pt=!1;do{var Zt=Ut.lane&-536870913;if(Zt!==Ut.lane?(Le&Zt)===Zt:(an&Zt)===Zt){var $t=Ut.revertLane;if($t===0)_t!==null&&(_t=_t.next={lane:0,revertLane:0,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null}),Zt===rr&&(Pt=!0);else if((an&$t)===$t){Ut=Ut.next,$t===rr&&(Pt=!0);continue}else Zt={lane:0,revertLane:Ut.revertLane,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null},_t===null?(ut=_t=Zt,et=H):_t=_t.next=Zt,ce.lanes|=$t,Ia|=$t;Zt=Ut.action,el&&p(H,Zt),H=Ut.hasEagerState?Ut.eagerState:p(H,Zt)}else $t={lane:Zt,revertLane:Ut.revertLane,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null},_t===null?(ut=_t=$t,et=H):_t=_t.next=$t,ce.lanes|=Zt,Ia|=Zt;Ut=Ut.next}while(Ut!==null&&Ut!==u);if(_t===null?et=H:_t.next=ut,!Ga(H,s.memoizedState)&&(aa=!0,Pt&&(p=Pa,p!==null)))throw p;s.memoizedState=H,s.baseState=et,s.baseQueue=_t,S.lastRenderedState=H}return x===null&&(S.lanes=0),[s.memoizedState,S.dispatch]}function ju(s){var u=Fn(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var S=p.dispatch,x=p.pending,H=u.memoizedState;if(x!==null){p.pending=null;var et=x=x.next;do H=s(H,et.action),et=et.next;while(et!==x);Ga(H,u.memoizedState)||(aa=!0),u.memoizedState=H,u.baseQueue===null&&(u.baseState=H),p.lastRenderedState=H}return[H,S]}function bd(s,u,p){var S=ce,x=Fn(),H=tn;if(H){if(p===void 0)throw Error(r(407));p=p()}else p=u();var et=!Ga((Ve||x).memoizedState,p);et&&(x.memoizedState=p,aa=!0),x=x.queue;var ut=bo.bind(null,S,x,s);if(qi(2048,8,ut,[s]),x.getSnapshot!==u||et||Yn!==null&&Yn.memoizedState.tag&1){if(S.flags|=2048,Va(9,El(),Cf.bind(null,S,x,p,u),null),gn===null)throw Error(r(349));H||(an&124)!==0||Uu(S,u,p)}return p}function Uu(s,u,p){s.flags|=16384,s={getSnapshot:u,value:p},u=ce.updateQueue,u===null?(u=Nu(),ce.updateQueue=u,u.stores=[s]):(p=u.stores,p===null?u.stores=[s]:p.push(s))}function Cf(s,u,p,S){u.value=p,u.getSnapshot=S,_d(u)&&ni(s)}function bo(s,u,p){return p(function(){_d(u)&&ni(s)})}function _d(s){var u=s.getSnapshot;s=s.value;try{var p=u();return!Ga(s,p)}catch{return!0}}function ni(s){var u=ae(s,2);u!==null&&Qa(u,s,2)}function _o(s){var u=ea();if(typeof s=="function"){var p=s;if(s=p(),el){Q(!0);try{p()}finally{Q(!1)}}}return u.memoizedState=u.baseState=s,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:s},u}function Tf(s,u,p,S){return s.baseState=p,qa(s,Ve,typeof S=="function"?S:vi)}function Af(s,u,p,S,x){if(Xr(s))throw Error(r(485));if(s=u.action,s!==null){var H={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(et){H.listeners.push(et)}};ue.T!==null?p(!0):H.isTransition=!1,S(H),p=u.pending,p===null?(H.next=u.pending=H,Ts(u,H)):(H.next=p.next,u.pending=p.next=H)}}function Ts(s,u){var p=u.action,S=u.payload,x=s.state;if(u.isTransition){var H=ue.T,et={};ue.T=et;try{var ut=p(x,S),_t=ue.S;_t!==null&&_t(et,ut),wf(s,u,ut)}catch(Ut){Kr(s,u,Ut)}finally{ue.T=H}}else try{H=p(x,S),wf(s,u,H)}catch(Ut){Kr(s,u,Ut)}}function wf(s,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(S){Rf(s,u,S)},function(S){return Kr(s,u,S)}):Rf(s,u,p)}function Rf(s,u,p){u.status="fulfilled",u.value=p,Ed(u),s.state=p,u=s.pending,u!==null&&(p=u.next,p===u?s.pending=null:(p=p.next,u.next=p,Ts(s,p)))}function Kr(s,u,p){var S=s.pending;if(s.pending=null,S!==null){S=S.next;do u.status="rejected",u.reason=p,Ed(u),u=u.next;while(u!==S)}s.action=null}function Ed(s){s=s.listeners;for(var u=0;u<s.length;u++)(0,s[u])()}function Of(s,u){return u}function xf(s,u){if(tn){var p=gn.formState;if(p!==null){t:{var S=ce;if(tn){if(Vn){var x=e0(Vn,Ui);if(x){Vn=yh(x),S=n0(x);break t}}at(S)}S=!1}S&&(u=p[0])}}p=ea(),p.memoizedState=p.baseState=u,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Of,lastRenderedState:u},p.queue=S,p=Td.bind(null,ce,S),S.dispatch=p,S=_o(!1);var H=wo.bind(null,ce,!1,S.queue);return S=ea(),x={state:u,dispatch:null,action:s,pending:null},S.queue=x,p=Af.bind(null,ce,x,H,p),x.dispatch=p,S.memoizedState=s,[u,p,!1]}function Bu(s){var u=Fn();return Cd(u,Ve,s)}function Cd(s,u,p){if(u=qa(s,u,Of)[0],s=yi(vi)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var S=bl(u)}catch(et){throw et===Zs?Ws:et}else S=u;u=Fn();var x=u.queue,H=x.dispatch;return p!==u.memoizedState&&(ce.flags|=2048,Va(9,El(),Ug.bind(null,x,p),null)),[S,H,s]}function Ug(s,u){s.action=u}function Eo(s){var u=Fn(),p=Ve;if(p!==null)return Cd(u,p,s);Fn(),u=u.memoizedState,p=Fn();var S=p.queue.dispatch;return p.memoizedState=s,[u,S,!1]}function Va(s,u,p,S){return s={tag:s,create:p,deps:S,inst:u,next:null},u=ce.updateQueue,u===null&&(u=Nu(),ce.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=s.next=s:(S=p.next,p.next=s,s.next=S,u.lastEffect=s),s}function El(){return{destroy:void 0,resource:void 0}}function zu(){return Fn().memoizedState}function mr(s,u,p,S){var x=ea();S=S===void 0?null:S,ce.flags|=s,x.memoizedState=Va(1|u,El(),p,S)}function qi(s,u,p,S){var x=Fn();S=S===void 0?null:S;var H=x.memoizedState.inst;Ve!==null&&S!==null&&Vr(S,Ve.memoizedState.deps)?x.memoizedState=Va(u,H,p,S):(ce.flags|=s,x.memoizedState=Va(1|u,H,p,S))}function Mf(s,u){mr(8390656,8,s,u)}function Lu(s,u){qi(2048,8,s,u)}function Nf(s,u){return qi(4,2,s,u)}function Cl(s,u){return qi(4,4,s,u)}function Vi(s,u){if(typeof u=="function"){s=s();var p=u(s);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return s=s(),u.current=s,function(){u.current=null}}function Gu(s,u,p){p=p!=null?p.concat([s]):null,qi(4,4,Vi.bind(null,u,s),p)}function As(){}function vr(s,u){var p=Fn();u=u===void 0?null:u;var S=p.memoizedState;return u!==null&&Vr(u,S[1])?S[0]:(p.memoizedState=[s,u],s)}function Pu(s,u){var p=Fn();u=u===void 0?null:u;var S=p.memoizedState;if(u!==null&&Vr(u,S[1]))return S[0];if(S=s(),el){Q(!0);try{s()}finally{Q(!1)}}return p.memoizedState=[S,u],S}function Tl(s,u,p){return p===void 0||(an&1073741824)!==0?s.memoizedState=u:(s.memoizedState=p,s=rc(),ce.lanes|=s,Ia|=s,p)}function Df(s,u,p,S){return Ga(p,u)?p:$s.current!==null?(s=Tl(s,p,S),Ga(s,u)||(aa=!0),s):(an&42)===0?(aa=!0,s.memoizedState=p):(s=rc(),ce.lanes|=s,Ia|=s,u)}function Co(s,u,p,S,x){var H=$i();Zn(H!==0&&8>H?H:8);var et=ue.T,ut={};ue.T=ut,wo(s,!1,u,p);try{var _t=x(),Ut=ue.S;if(Ut!==null&&Ut(ut,_t),_t!==null&&typeof _t=="object"&&typeof _t.then=="function"){var Pt=Kt(_t,S);ws(s,u,Pt,Ka(s))}else ws(s,u,S,Ka(s))}catch(Zt){ws(s,u,{then:function(){},status:"rejected",reason:Zt},Ka())}finally{Zn(H),ue.T=et}}function To(s){var u=s.memoizedState;if(u!==null)return u;u={memoizedState:xr,baseState:xr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:xr},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:p},next:null},s.memoizedState=u,s=s.alternate,s!==null&&(s.memoizedState=u),u}function Hu(){return Yt(Ei)}function Da(){return Fn().memoizedState}function Qr(){return Fn().memoizedState}function Iu(s){for(var u=s.return;u!==null;){switch(u.tag){case 24:case 3:var p=Ka();s=Ee(p);var S=ee(u,s,p);S!==null&&(Qa(S,u,p),He(S,u,p)),u={cache:we()},s.payload=u;return}u=u.return}}function Ao(s,u,p){var S=Ka();p={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Xr(s)?Ro(u,p):(p=te(s,u,p,S),p!==null&&(Qa(p,s,S),jf(p,u,S)))}function Td(s,u,p){var S=Ka();ws(s,u,p,S)}function ws(s,u,p,S){var x={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Xr(s))Ro(u,x);else{var H=s.alternate;if(s.lanes===0&&(H===null||H.lanes===0)&&(H=u.lastRenderedReducer,H!==null))try{var et=u.lastRenderedState,ut=H(et,p);if(x.hasEagerState=!0,x.eagerState=ut,Ga(ut,et))return jt(s,u,x,0),gn===null&&Dt(),!1}catch{}finally{}if(p=te(s,u,x,S),p!==null)return Qa(p,s,S),jf(p,u,S),!0}return!1}function wo(s,u,p,S){if(S={lane:2,revertLane:gt(),action:S,hasEagerState:!1,eagerState:null,next:null},Xr(s)){if(u)throw Error(r(479))}else u=te(s,p,S,2),u!==null&&Qa(u,s,2)}function Xr(s){var u=s.alternate;return s===ce||u!==null&&u===ce}function Ro(s,u){tl=lu=!0;var p=s.pending;p===null?u.next=u:(u.next=p.next,p.next=u),s.pending=u}function jf(s,u,p){if((p&4194048)!==0){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function ku(s){var u=il;return il+=1,Wa===null&&(Wa=[]),pi(Wa,s,u)}function Oo(s,u){u=u.props.ref,s.ref=u!==void 0?u:null}function qu(s,u){throw u.$$typeof===zs?Error(r(525)):(s=Object.prototype.toString.call(u),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":s)))}function Vu(s){var u=s._init;return u(s._payload)}function Ad(s){function u(bt,dt){if(s){var Ct=bt.deletions;Ct===null?(bt.deletions=[dt],bt.flags|=16):Ct.push(dt)}}function p(bt,dt){if(!s)return null;for(;dt!==null;)u(bt,dt),dt=dt.sibling;return null}function S(bt){for(var dt=new Map;bt!==null;)bt.key!==null?dt.set(bt.key,bt):dt.set(bt.index,bt),bt=bt.sibling;return dt}function x(bt,dt){return bt=Cn(bt,dt),bt.index=0,bt.sibling=null,bt}function H(bt,dt,Ct){return bt.index=Ct,s?(Ct=bt.alternate,Ct!==null?(Ct=Ct.index,Ct<dt?(bt.flags|=67108866,dt):Ct):(bt.flags|=67108866,dt)):(bt.flags|=1048576,dt)}function et(bt){return s&&bt.alternate===null&&(bt.flags|=67108866),bt}function ut(bt,dt,Ct,Ht){return dt===null||dt.tag!==6?(dt=nh(Ct,bt.mode,Ht),dt.return=bt,dt):(dt=x(dt,Ct),dt.return=bt,dt)}function _t(bt,dt,Ct,Ht){var Qt=Ct.type;return Qt===Ls?Pt(bt,dt,Ct.props.children,Ht,Ct.key):dt!==null&&(dt.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===Rr&&Vu(Qt)===dt.type)?(dt=x(dt,Ct.props),Oo(dt,Ct),dt.return=bt,dt):(dt=ko(Ct.type,Ct.key,Ct.props,null,bt.mode,Ht),Oo(dt,Ct),dt.return=bt,dt)}function Ut(bt,dt,Ct,Ht){return dt===null||dt.tag!==4||dt.stateNode.containerInfo!==Ct.containerInfo||dt.stateNode.implementation!==Ct.implementation?(dt=ah(Ct,bt.mode,Ht),dt.return=bt,dt):(dt=x(dt,Ct.children||[]),dt.return=bt,dt)}function Pt(bt,dt,Ct,Ht,Qt){return dt===null||dt.tag!==7?(dt=Us(Ct,bt.mode,Ht,Qt),dt.return=bt,dt):(dt=x(dt,Ct),dt.return=bt,dt)}function Zt(bt,dt,Ct){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return dt=nh(""+dt,bt.mode,Ct),dt.return=bt,dt;if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case Gl:return Ct=ko(dt.type,dt.key,dt.props,null,bt.mode,Ct),Oo(Ct,dt),Ct.return=bt,Ct;case Cr:return dt=ah(dt,bt.mode,Ct),dt.return=bt,dt;case Rr:var Ht=dt._init;return dt=Ht(dt._payload),Zt(bt,dt,Ct)}if(Ps(dt)||_(dt))return dt=Us(dt,bt.mode,Ct,null),dt.return=bt,dt;if(typeof dt.then=="function")return Zt(bt,ku(dt),Ct);if(dt.$$typeof===Tr)return Zt(bt,Fe(bt,dt),Ct);qu(bt,dt)}return null}function $t(bt,dt,Ct,Ht){var Qt=dt!==null?dt.key:null;if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return Qt!==null?null:ut(bt,dt,""+Ct,Ht);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case Gl:return Ct.key===Qt?_t(bt,dt,Ct,Ht):null;case Cr:return Ct.key===Qt?Ut(bt,dt,Ct,Ht):null;case Rr:return Qt=Ct._init,Ct=Qt(Ct._payload),$t(bt,dt,Ct,Ht)}if(Ps(Ct)||_(Ct))return Qt!==null?null:Pt(bt,dt,Ct,Ht,null);if(typeof Ct.then=="function")return $t(bt,dt,ku(Ct),Ht);if(Ct.$$typeof===Tr)return $t(bt,dt,Fe(bt,Ct),Ht);qu(bt,Ct)}return null}function Oe(bt,dt,Ct,Ht,Qt){if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number"||typeof Ht=="bigint")return bt=bt.get(Ct)||null,ut(dt,bt,""+Ht,Qt);if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case Gl:return bt=bt.get(Ht.key===null?Ct:Ht.key)||null,_t(dt,bt,Ht,Qt);case Cr:return bt=bt.get(Ht.key===null?Ct:Ht.key)||null,Ut(dt,bt,Ht,Qt);case Rr:var pn=Ht._init;return Ht=pn(Ht._payload),Oe(bt,dt,Ct,Ht,Qt)}if(Ps(Ht)||_(Ht))return bt=bt.get(Ct)||null,Pt(dt,bt,Ht,Qt,null);if(typeof Ht.then=="function")return Oe(bt,dt,Ct,ku(Ht),Qt);if(Ht.$$typeof===Tr)return Oe(bt,dt,Ct,Fe(dt,Ht),Qt);qu(dt,Ht)}return null}function gi(bt,dt,Ct,Ht){for(var Qt=null,pn=null,ye=dt,Ze=dt=0,ca=null;ye!==null&&Ze<Ct.length;Ze++){ye.index>Ze?(ca=ye,ye=null):ca=ye.sibling;var en=$t(bt,ye,Ct[Ze],Ht);if(en===null){ye===null&&(ye=ca);break}s&&ye&&en.alternate===null&&u(bt,ye),dt=H(en,dt,Ze),pn===null?Qt=en:pn.sibling=en,pn=en,ye=ca}if(Ze===Ct.length)return p(bt,ye),tn&&W(bt,Ze),Qt;if(ye===null){for(;Ze<Ct.length;Ze++)ye=Zt(bt,Ct[Ze],Ht),ye!==null&&(dt=H(ye,dt,Ze),pn===null?Qt=ye:pn.sibling=ye,pn=ye);return tn&&W(bt,Ze),Qt}for(ye=S(ye);Ze<Ct.length;Ze++)ca=Oe(ye,bt,Ze,Ct[Ze],Ht),ca!==null&&(s&&ca.alternate!==null&&ye.delete(ca.key===null?Ze:ca.key),dt=H(ca,dt,Ze),pn===null?Qt=ca:pn.sibling=ca,pn=ca);return s&&ye.forEach(function(vs){return u(bt,vs)}),tn&&W(bt,Ze),Qt}function Jl(bt,dt,Ct,Ht){if(Ct==null)throw Error(r(151));for(var Qt=null,pn=null,ye=dt,Ze=dt=0,ca=null,en=Ct.next();ye!==null&&!en.done;Ze++,en=Ct.next()){ye.index>Ze?(ca=ye,ye=null):ca=ye.sibling;var vs=$t(bt,ye,en.value,Ht);if(vs===null){ye===null&&(ye=ca);break}s&&ye&&vs.alternate===null&&u(bt,ye),dt=H(vs,dt,Ze),pn===null?Qt=vs:pn.sibling=vs,pn=vs,ye=ca}if(en.done)return p(bt,ye),tn&&W(bt,Ze),Qt;if(ye===null){for(;!en.done;Ze++,en=Ct.next())en=Zt(bt,en.value,Ht),en!==null&&(dt=H(en,dt,Ze),pn===null?Qt=en:pn.sibling=en,pn=en);return tn&&W(bt,Ze),Qt}for(ye=S(ye);!en.done;Ze++,en=Ct.next())en=Oe(ye,bt,Ze,en.value,Ht),en!==null&&(s&&en.alternate!==null&&ye.delete(en.key===null?Ze:en.key),dt=H(en,dt,Ze),pn===null?Qt=en:pn.sibling=en,pn=en);return s&&ye.forEach(function(qc){return u(bt,qc)}),tn&&W(bt,Ze),Qt}function ms(bt,dt,Ct,Ht){if(typeof Ct=="object"&&Ct!==null&&Ct.type===Ls&&Ct.key===null&&(Ct=Ct.props.children),typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case Gl:t:{for(var Qt=Ct.key;dt!==null;){if(dt.key===Qt){if(Qt=Ct.type,Qt===Ls){if(dt.tag===7){p(bt,dt.sibling),Ht=x(dt,Ct.props.children),Ht.return=bt,bt=Ht;break t}}else if(dt.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===Rr&&Vu(Qt)===dt.type){p(bt,dt.sibling),Ht=x(dt,Ct.props),Oo(Ht,Ct),Ht.return=bt,bt=Ht;break t}p(bt,dt);break}else u(bt,dt);dt=dt.sibling}Ct.type===Ls?(Ht=Us(Ct.props.children,bt.mode,Ht,Ct.key),Ht.return=bt,bt=Ht):(Ht=ko(Ct.type,Ct.key,Ct.props,null,bt.mode,Ht),Oo(Ht,Ct),Ht.return=bt,bt=Ht)}return et(bt);case Cr:t:{for(Qt=Ct.key;dt!==null;){if(dt.key===Qt)if(dt.tag===4&&dt.stateNode.containerInfo===Ct.containerInfo&&dt.stateNode.implementation===Ct.implementation){p(bt,dt.sibling),Ht=x(dt,Ct.children||[]),Ht.return=bt,bt=Ht;break t}else{p(bt,dt);break}else u(bt,dt);dt=dt.sibling}Ht=ah(Ct,bt.mode,Ht),Ht.return=bt,bt=Ht}return et(bt);case Rr:return Qt=Ct._init,Ct=Qt(Ct._payload),ms(bt,dt,Ct,Ht)}if(Ps(Ct))return gi(bt,dt,Ct,Ht);if(_(Ct)){if(Qt=_(Ct),typeof Qt!="function")throw Error(r(150));return Ct=Qt.call(Ct),Jl(bt,dt,Ct,Ht)}if(typeof Ct.then=="function")return ms(bt,dt,ku(Ct),Ht);if(Ct.$$typeof===Tr)return ms(bt,dt,Fe(bt,Ct),Ht);qu(bt,Ct)}return typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint"?(Ct=""+Ct,dt!==null&&dt.tag===6?(p(bt,dt.sibling),Ht=x(dt,Ct),Ht.return=bt,bt=Ht):(p(bt,dt),Ht=nh(Ct,bt.mode,Ht),Ht.return=bt,bt=Ht),et(bt)):p(bt,dt)}return function(bt,dt,Ct,Ht){try{il=0;var Qt=ms(bt,dt,Ct,Ht);return Wa=null,Qt}catch(ye){if(ye===Zs||ye===Ws)throw ye;var pn=n(29,ye,null,bt.mode);return pn.lanes=Ht,pn.return=bt,pn}finally{}}}function Fr(s){var u=s.alternate;v(Ln,Ln.current&1),v(di,s),Ha===null&&(u===null||$s.current!==null||u.memoizedState!==null)&&(Ha=s)}function wd(s){if(s.tag===22){if(v(Ln,Ln.current),v(di,s),Ha===null){var u=s.alternate;u!==null&&u.memoizedState!==null&&(Ha=s)}}else Jr()}function Jr(){v(Ln,Ln.current),v(di,di.current)}function yr(s){R(di),Ha===s&&(Ha=null),R(Ln)}function xo(s){for(var u=s;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Ec(p)||Cc(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function Uf(s,u,p,S){u=s.memoizedState,p=p(S,u),p=p==null?u:hc({},u,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}function Rd(s,u,p,S,x,H,et){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(S,H,et):u.prototype&&u.prototype.isPureReactComponent?!Pe(p,S)||!Pe(x,H):!0}function Od(s,u,p,S){s=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,S),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,S),u.state!==s&&rl.enqueueReplaceState(u,u.state,null)}function Rs(s,u){var p=u;if("ref"in u){p={};for(var S in u)S!=="ref"&&(p[S]=u[S])}if(s=s.defaultProps){p===u&&(p=hc({},p));for(var x in s)p[x]===void 0&&(p[x]=s[x])}return p}function Al(s,u){try{var p=s.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(S){setTimeout(function(){throw S})}}function xd(s,u,p){try{var S=s.onCaughtError;S(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Bf(s,u,p){return p=Ee(p),p.tag=3,p.payload={element:null},p.callback=function(){Al(s,u)},p}function Md(s){return s=Ee(s),s.tag=3,s}function zf(s,u,p,S){var x=p.type.getDerivedStateFromError;if(typeof x=="function"){var H=S.value;s.payload=function(){return x(H)},s.callback=function(){xd(u,p,S)}}var et=p.stateNode;et!==null&&typeof et.componentDidCatch=="function"&&(s.callback=function(){xd(u,p,S),typeof x!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var ut=S.stack;this.componentDidCatch(S.value,{componentStack:ut!==null?ut:""})})}function Bg(s,u,p,S,x){if(p.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(u=p.alternate,u!==null&&hn(u,p,x,!0),p=di.current,p!==null){switch(p.tag){case 13:return Ha===null?sc():p.alternate===null&&An===0&&(An=3),p.flags&=-257,p.flags|=65536,p.lanes=x,S===ru?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([S]):u.add(S),Di(s,S,x)),!1;case 22:return p.flags|=65536,S===ru?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([S])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([S]):p.add(S)),Di(s,S,x)),!1}throw Error(r(435,p.tag))}return Di(s,S,x),sc(),!1}if(tn)return u=di.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=x,S!==Bi&&(s=Error(r(422),{cause:S}),pe(F(s,p)))):(S!==Bi&&(u=Error(r(423),{cause:S}),pe(F(u,p))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,S=F(S,p),x=Bf(s.stateNode,S,x),he(s,x),An!==4&&(An=2)),!1;var H=Error(r(520),{cause:S});if(H=F(H,p),ol===null?ol=[H]:ol.push(H),An!==4&&(An=2),u===null)return!0;S=F(S,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,s=x&-x,p.lanes|=s,s=Bf(p.stateNode,S,s),he(p,s),!1;case 1:if(u=p.type,H=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(zr===null||!zr.has(H))))return p.flags|=65536,x&=-x,p.lanes|=x,x=Md(x),zf(x,s,p,S),he(p,x),!1}p=p.return}while(p!==null);return!1}function ha(s,u,p,S){u.child=s===null?Ci(u,null,p,S):gs(u,s.child,p,S)}function Nd(s,u,p,S,x){p=p.render;var H=u.ref;if("ref"in S){var et={};for(var ut in S)ut!=="ref"&&(et[ut]=S[ut])}else et=S;return wt(u),S=Yr(s,u,p,et,H,x),ut=xu(),s!==null&&!aa?(Mu(s,u,x),Yi(s,u,x)):(tn&&ut&&Z(u),u.flags|=1,ha(s,u,S,x),u.child)}function Dd(s,u,p,S,x){if(s===null){var H=p.type;return typeof H=="function"&&!Er(H)&&H.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=H,jd(s,u,H,S,x)):(s=ko(p.type,null,S,u,u.mode,x),s.ref=u.ref,s.return=u,u.child=s)}if(H=s.child,!Ju(s,x)){var et=H.memoizedProps;if(p=p.compare,p=p!==null?p:Pe,p(et,S)&&s.ref===u.ref)return Yi(s,u,x)}return u.flags|=1,s=Cn(H,S),s.ref=u.ref,s.return=u,u.child=s}function jd(s,u,p,S,x){if(s!==null){var H=s.memoizedProps;if(Pe(H,S)&&s.ref===u.ref)if(aa=!1,u.pendingProps=S=H,Ju(s,x))(s.flags&131072)!==0&&(aa=!0);else return u.lanes=s.lanes,Yi(s,u,x)}return Lf(s,u,p,S,x)}function Ud(s,u,p){var S=u.pendingProps,x=S.children,H=s!==null?s.memoizedState:null;if(S.mode==="hidden"){if((u.flags&128)!==0){if(S=H!==null?H.baseLanes|p:p,s!==null){for(x=u.child=s.child,H=0;x!==null;)H=H|x.lanes|x.childLanes,x=x.sibling;u.childLanes=H&~S}else u.childLanes=0,u.child=null;return Bd(s,u,S,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},s!==null&&fe(u,H!==null?H.cachePool:null),H!==null?mi(u,H):Es(),wd(u);else return u.lanes=u.childLanes=536870912,Bd(s,u,H!==null?H.baseLanes|p:p,p)}else H!==null?(fe(u,H.cachePool),mi(u,H),Jr(),u.memoizedState=null):(s!==null&&fe(u,null),Es(),Jr());return ha(s,u,x,p),u.child}function Bd(s,u,p,S){var x=Ce();return x=x===null?null:{parent:Zi?vn._currentValue:vn._currentValue2,pool:x},u.memoizedState={baseLanes:p,cachePool:x},s!==null&&fe(u,null),Es(),wd(u),s!==null&&hn(s,u,S,!0),null}function Yu(s,u){var p=u.ref;if(p===null)s!==null&&s.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(u.flags|=4194816)}}function Lf(s,u,p,S,x){return wt(u),p=Yr(s,u,p,S,void 0,x),S=xu(),s!==null&&!aa?(Mu(s,u,x),Yi(s,u,x)):(tn&&S&&Z(u),u.flags|=1,ha(s,u,p,x),u.child)}function Ku(s,u,p,S,x,H){return wt(u),u.updateQueue=null,p=Cs(u,S,p,x),Sl(s),S=xu(),s!==null&&!aa?(Mu(s,u,H),Yi(s,u,H)):(tn&&S&&Z(u),u.flags|=1,ha(s,u,p,H),u.child)}function wl(s,u,p,S,x){if(wt(u),u.stateNode===null){var H=cs,et=p.contextType;typeof et=="object"&&et!==null&&(H=Yt(et)),H=new p(S,H),u.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,H.updater=rl,u.stateNode=H,H._reactInternals=u,H=u.stateNode,H.props=S,H.state=u.memoizedState,H.refs={},Xn(u),et=p.contextType,H.context=typeof et=="object"&&et!==null?Yt(et):cs,H.state=u.memoizedState,et=p.getDerivedStateFromProps,typeof et=="function"&&(Uf(u,p,et,S),H.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(et=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),et!==H.state&&rl.enqueueReplaceState(H,H.state,null),Ue(u,S,H,x),Ne(),H.state=u.memoizedState),typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!0}else if(s===null){H=u.stateNode;var ut=u.memoizedProps,_t=Rs(p,ut);H.props=_t;var Ut=H.context,Pt=p.contextType;et=cs,typeof Pt=="object"&&Pt!==null&&(et=Yt(Pt));var Zt=p.getDerivedStateFromProps;Pt=typeof Zt=="function"||typeof H.getSnapshotBeforeUpdate=="function",ut=u.pendingProps!==ut,Pt||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ut||Ut!==et)&&Od(u,H,S,et),Tn=!1;var $t=u.memoizedState;H.state=$t,Ue(u,S,H,x),Ne(),Ut=u.memoizedState,ut||$t!==Ut||Tn?(typeof Zt=="function"&&(Uf(u,p,Zt,S),Ut=u.memoizedState),(_t=Tn||Rd(u,p,_t,S,$t,Ut,et))?(Pt||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(u.flags|=4194308)):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=S,u.memoizedState=Ut),H.props=S,H.state=Ut,H.context=et,S=_t):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!1)}else{H=u.stateNode,Pn(s,u),et=u.memoizedProps,Pt=Rs(p,et),H.props=Pt,Zt=u.pendingProps,$t=H.context,Ut=p.contextType,_t=cs,typeof Ut=="object"&&Ut!==null&&(_t=Yt(Ut)),ut=p.getDerivedStateFromProps,(Ut=typeof ut=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(et!==Zt||$t!==_t)&&Od(u,H,S,_t),Tn=!1,$t=u.memoizedState,H.state=$t,Ue(u,S,H,x),Ne();var Oe=u.memoizedState;et!==Zt||$t!==Oe||Tn||s!==null&&s.dependencies!==null&&Un(s.dependencies)?(typeof ut=="function"&&(Uf(u,p,ut,S),Oe=u.memoizedState),(Pt=Tn||Rd(u,p,Pt,S,$t,Oe,_t)||s!==null&&s.dependencies!==null&&Un(s.dependencies))?(Ut||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(S,Oe,_t),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(S,Oe,_t)),typeof H.componentDidUpdate=="function"&&(u.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof H.componentDidUpdate!="function"||et===s.memoizedProps&&$t===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&$t===s.memoizedState||(u.flags|=1024),u.memoizedProps=S,u.memoizedState=Oe),H.props=S,H.state=Oe,H.context=_t,S=Pt):(typeof H.componentDidUpdate!="function"||et===s.memoizedProps&&$t===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&$t===s.memoizedState||(u.flags|=1024),S=!1)}return H=S,Yu(s,u),S=(u.flags&128)!==0,H||S?(H=u.stateNode,p=S&&typeof p.getDerivedStateFromError!="function"?null:H.render(),u.flags|=1,s!==null&&S?(u.child=gs(u,s.child,null,x),u.child=gs(u,null,p,x)):ha(s,u,p,x),u.memoizedState=H.state,s=u.child):s=Yi(s,u,x),s}function zd(s,u,p,S){return Wt(),u.flags|=256,ha(s,u,p,S),u.child}function Qu(s){return{baseLanes:s,cachePool:_e()}}function Xu(s,u,p){return s=s!==null?s.childLanes&~p:0,u&&(s|=_a),s}function Gf(s,u,p){var S=u.pendingProps,x=!1,H=(u.flags&128)!==0,et;if((et=H)||(et=s!==null&&s.memoizedState===null?!1:(Ln.current&2)!==0),et&&(x=!0,u.flags&=-129),et=(u.flags&32)!==0,u.flags&=-33,s===null){if(tn){if(x?Fr(u):Jr(),tn){var ut=Vn,_t;(_t=ut)&&(ut=Ac(ut,Ui),ut!==null?(u.memoizedState={dehydrated:ut,treeContext:fs!==null?{id:ir,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},_t=n(18,null,null,0),_t.stateNode=ut,_t.return=u,u.child=_t,la=u,Vn=null,_t=!0):_t=!1),_t||at(u)}if(ut=u.memoizedState,ut!==null&&(ut=ut.dehydrated,ut!==null))return Cc(ut)?u.lanes=32:u.lanes=536870912,null;yr(u)}return ut=S.children,S=S.fallback,x?(Jr(),x=u.mode,ut=Mo({mode:"hidden",children:ut},x),S=Us(S,x,p,null),ut.return=u,S.return=u,ut.sibling=S,u.child=ut,x=u.child,x.memoizedState=Qu(p),x.childLanes=Xu(s,et,p),u.memoizedState=ll,S):(Fr(u),Fu(u,ut))}if(_t=s.memoizedState,_t!==null&&(ut=_t.dehydrated,ut!==null)){if(H)u.flags&256?(Fr(u),u.flags&=-257,u=Zr(s,u,p)):u.memoizedState!==null?(Jr(),u.child=s.child,u.flags|=128,u=null):(Jr(),x=S.fallback,ut=u.mode,S=Mo({mode:"visible",children:S.children},ut),x=Us(x,ut,p,null),x.flags|=2,S.return=u,x.return=u,S.sibling=x,u.child=S,gs(u,s.child,null,p),S=u.child,S.memoizedState=Qu(p),S.childLanes=Xu(s,et,p),u.memoizedState=ll,u=x);else if(Fr(u),Cc(ut))et=t0(ut).digest,S=Error(r(419)),S.stack="",S.digest=et,pe({value:S,source:null,stack:null}),u=Zr(s,u,p);else if(aa||hn(s,u,p,!1),et=(p&s.childLanes)!==0,aa||et){if(et=gn,et!==null&&(S=p&-p,S=(S&42)!==0?1:P(S),S=(S&(et.suspendedLanes|p))!==0?0:S,S!==0&&S!==_t.retryLane))throw _t.retryLane=S,ae(s,S),Qa(et,s,S),Bh;Ec(ut)||sc(),u=Zr(s,u,p)}else Ec(ut)?(u.flags|=192,u.child=s.child,u=null):(s=_t.treeContext,xn&&(Vn=r0(ut),la=u,tn=!0,Dr=null,Ui=!1,s!==null&&(Ja[fi++]=ir,Ja[fi++]=ji,Ja[fi++]=fs,ir=s.id,ji=s.overflow,fs=u)),u=Fu(u,S.children),u.flags|=4096);return u}return x?(Jr(),x=S.fallback,ut=u.mode,_t=s.child,H=_t.sibling,S=Cn(_t,{mode:"hidden",children:S.children}),S.subtreeFlags=_t.subtreeFlags&65011712,H!==null?x=Cn(H,x):(x=Us(x,ut,p,null),x.flags|=2),x.return=u,S.return=u,S.sibling=x,u.child=S,S=x,x=u.child,ut=s.child.memoizedState,ut===null?ut=Qu(p):(_t=ut.cachePool,_t!==null?(H=Zi?vn._currentValue:vn._currentValue2,_t=_t.parent!==H?{parent:H,pool:H}:_t):_t=_e(),ut={baseLanes:ut.baseLanes|p,cachePool:_t}),x.memoizedState=ut,x.childLanes=Xu(s,et,p),u.memoizedState=ll,S):(Fr(u),p=s.child,s=p.sibling,p=Cn(p,{mode:"visible",children:S.children}),p.return=u,p.sibling=null,s!==null&&(et=u.deletions,et===null?(u.deletions=[s],u.flags|=16):et.push(s)),u.child=p,u.memoizedState=null,p)}function Fu(s,u){return u=Mo({mode:"visible",children:u},s.mode),u.return=s,s.child=u}function Mo(s,u){return s=n(22,s,null,u),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Zr(s,u,p){return gs(u,s.child,null,p),s=Fu(u,u.pendingProps.children),s.flags|=2,u.memoizedState=null,s}function Ld(s,u,p){s.lanes|=u;var S=s.alternate;S!==null&&(S.lanes|=u),Xe(s.return,u,p)}function Pf(s,u,p,S,x){var H=s.memoizedState;H===null?s.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:S,tail:p,tailMode:x}:(H.isBackwards=u,H.rendering=null,H.renderingStartTime=0,H.last=S,H.tail=p,H.tailMode=x)}function Gd(s,u,p){var S=u.pendingProps,x=S.revealOrder,H=S.tail;if(ha(s,u,S.children,p),S=Ln.current,(S&2)!==0)S=S&1|2,u.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=u.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ld(s,p,u);else if(s.tag===19)Ld(s,p,u);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===u)break t;for(;s.sibling===null;){if(s.return===null||s.return===u)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}S&=1}switch(v(Ln,S),x){case"forwards":for(p=u.child,x=null;p!==null;)s=p.alternate,s!==null&&xo(s)===null&&(x=p),p=p.sibling;p=x,p===null?(x=u.child,u.child=null):(x=p.sibling,p.sibling=null),Pf(u,!1,x,p,H);break;case"backwards":for(p=null,x=u.child,u.child=null;x!==null;){if(s=x.alternate,s!==null&&xo(s)===null){u.child=x;break}s=x.sibling,x.sibling=p,p=x,x=s}Pf(u,!0,p,null,H);break;case"together":Pf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Yi(s,u,p){if(s!==null&&(u.dependencies=s.dependencies),Ia|=u.lanes,(p&u.childLanes)===0)if(s!==null){if(hn(s,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(s!==null&&u.child!==s.child)throw Error(r(153));if(u.child!==null){for(s=u.child,p=Cn(s,s.pendingProps),u.child=p,p.return=u;s.sibling!==null;)s=s.sibling,p=p.sibling=Cn(s,s.pendingProps),p.return=u;p.sibling=null}return u.child}function Ju(s,u){return(s.lanes&u)!==0?!0:(s=s.dependencies,!!(s!==null&&Un(s)))}function No(s,u,p){switch(u.tag){case 3:rt(u,u.stateNode.containerInfo),Te(u,vn,s.memoizedState.cache),Wt();break;case 27:case 5:J(u);break;case 4:rt(u,u.stateNode.containerInfo);break;case 10:Te(u,u.type,u.memoizedProps.value);break;case 13:var S=u.memoizedState;if(S!==null)return S.dehydrated!==null?(Fr(u),u.flags|=128,null):(p&u.child.childLanes)!==0?Gf(s,u,p):(Fr(u),s=Yi(s,u,p),s!==null?s.sibling:null);Fr(u);break;case 19:var x=(s.flags&128)!==0;if(S=(p&u.childLanes)!==0,S||(hn(s,u,p,!1),S=(p&u.childLanes)!==0),x){if(S)return Gd(s,u,p);u.flags|=128}if(x=u.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),v(Ln,Ln.current),S)break;return null;case 22:case 23:return u.lanes=0,Ud(s,u,p);case 24:Te(u,vn,s.memoizedState.cache)}return Yi(s,u,p)}function Rl(s,u,p){if(s!==null)if(s.memoizedProps!==u.pendingProps)aa=!0;else{if(!Ju(s,p)&&(u.flags&128)===0)return aa=!1,No(s,u,p);aa=(s.flags&131072)!==0}else aa=!1,tn&&(u.flags&1048576)!==0&&nt(u,Xs,u.index);switch(u.lanes=0,u.tag){case 16:t:{s=u.pendingProps;var S=u.elementType,x=S._init;if(S=x(S._payload),u.type=S,typeof S=="function")Er(S)?(s=Rs(S,s),u.tag=1,u=wl(null,u,S,s,p)):(u.tag=0,u=Lf(null,u,S,s,p));else{if(S!=null){if(x=S.$$typeof,x===gc){u.tag=11,u=Nd(null,u,S,s,p);break t}else if(x===pc){u.tag=14,u=Dd(null,u,S,s,p);break t}}throw u=C(S)||S,Error(r(306,u,""))}}return u;case 0:return Lf(s,u,u.type,u.pendingProps,p);case 1:return S=u.type,x=Rs(S,u.pendingProps),wl(s,u,S,x,p);case 3:t:{if(rt(u,u.stateNode.containerInfo),s===null)throw Error(r(387));var H=u.pendingProps;x=u.memoizedState,S=x.element,Pn(s,u),Ue(u,H,null,p);var et=u.memoizedState;if(H=et.cache,Te(u,vn,H),H!==x.cache&&ke(u,[vn],p,!0),Ne(),H=et.element,xn&&x.isDehydrated)if(x={element:H,isDehydrated:!1,cache:et.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=zd(s,u,H,p);break t}else if(H!==S){S=F(Error(r(424)),u),pe(S),u=zd(s,u,H,p);break t}else for(xn&&(Vn=Hg(u.stateNode.containerInfo),la=u,tn=!0,Dr=null,Ui=!0),p=Ci(u,null,H,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Wt(),H===S){u=Yi(s,u,p);break t}ha(s,u,H,p)}u=u.child}return u;case 26:if(ui)return Yu(s,u),s===null?(p=p0(u.type,null,u.pendingProps,null))?u.memoizedState=p:tn||(u.stateNode=v0(u.type,u.pendingProps,Nr.current,u)):u.memoizedState=p0(u.type,s.memoizedProps,u.pendingProps,s.memoizedState),null;case 27:if(qn)return J(u),s===null&&qn&&tn&&(S=u.stateNode=$o(u.type,u.pendingProps,Nr.current,na.current,!1),la=u,Ui=!0,Vn=Il(u.type,S,Vn)),ha(s,u,u.pendingProps.children,p),Yu(s,u),s===null&&(u.flags|=4194304),u.child;case 5:return s===null&&tn&&(d0(u.type,u.pendingProps,na.current),(x=S=Vn)&&(S=s0(S,u.type,u.pendingProps,Ui),S!==null?(u.stateNode=S,la=u,Vn=i0(S),Ui=!1,x=!0):x=!1),x||at(u)),J(u),x=u.type,H=u.pendingProps,et=s!==null?s.memoizedProps:null,S=H.children,ls(x,H)?S=null:et!==null&&ls(x,et)&&(u.flags|=32),u.memoizedState!==null&&(x=Yr(s,u,ra,null,null,p),Zi?Ei._currentValue=x:Ei._currentValue2=x),Yu(s,u),ha(s,u,S,p),u.child;case 6:return s===null&&tn&&(g0(u.pendingProps,na.current),(s=p=Vn)&&(p=Tc(p,u.pendingProps,Ui),p!==null?(u.stateNode=p,la=u,Vn=null,s=!0):s=!1),s||at(u)),null;case 13:return Gf(s,u,p);case 4:return rt(u,u.stateNode.containerInfo),S=u.pendingProps,s===null?u.child=gs(u,null,S,p):ha(s,u,S,p),u.child;case 11:return Nd(s,u,u.type,u.pendingProps,p);case 7:return ha(s,u,u.pendingProps,p),u.child;case 8:return ha(s,u,u.pendingProps.children,p),u.child;case 12:return ha(s,u,u.pendingProps.children,p),u.child;case 10:return S=u.pendingProps,Te(u,u.type,S.value),ha(s,u,S.children,p),u.child;case 9:return x=u.type._context,S=u.pendingProps.children,wt(u),x=Yt(x),S=S(x),u.flags|=1,ha(s,u,S,p),u.child;case 14:return Dd(s,u,u.type,u.pendingProps,p);case 15:return jd(s,u,u.type,u.pendingProps,p);case 19:return Gd(s,u,p);case 31:return S=u.pendingProps,p=u.mode,S={mode:S.mode,children:S.children},s===null?(p=Mo(S,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=Cn(s.child,S),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return Ud(s,u,p);case 24:return wt(u),S=Yt(vn),s===null?(x=Ce(),x===null&&(x=gn,H=we(),x.pooledCache=H,H.refCount++,H!==null&&(x.pooledCacheLanes|=p),x=H),u.memoizedState={parent:S,cache:x},Xn(u),Te(u,vn,x)):((s.lanes&p)!==0&&(Pn(s,u),Ue(u,null,null,p),Ne()),x=s.memoizedState,H=u.memoizedState,x.parent!==S?(x={parent:S,cache:S},u.memoizedState=x,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=x),Te(u,vn,S)):(S=H.cache,Te(u,vn,S),S!==x.cache&&ke(u,[vn],p,!0))),ha(s,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function ai(s){s.flags|=4}function Do(s,u){if(s!==null&&s.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(s=u.child;s!==null;){if((s.flags&13878)!==0||(s.subtreeFlags&13878)!==0)return!0;s=s.sibling}return!1}function Zu(s,u,p,S){if(sa)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)Fo(s,p.stateNode);else if(!(p.tag===4||qn&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(Wi)for(var x=u.child;x!==null;){if(x.tag===5){var H=x.stateNode;p&&S&&(H=mh(H,x.type,x.memoizedProps)),Fo(s,H)}else if(x.tag===6)H=x.stateNode,p&&S&&(H=$d(H,x.memoizedProps)),Fo(s,H);else if(x.tag!==4){if(x.tag===22&&x.memoizedState!==null)H=x.child,H!==null&&(H.return=x),Zu(s,x,!0,!0);else if(x.child!==null){x.child.return=x,x=x.child;continue}}if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return}x.sibling.return=x.return,x=x.sibling}}function Hf(s,u,p,S){var x=!1;if(Wi)for(var H=u.child;H!==null;){if(H.tag===5){var et=H.stateNode;p&&S&&(et=mh(et,H.type,H.memoizedProps)),ph(s,et)}else if(H.tag===6)et=H.stateNode,p&&S&&(et=$d(et,H.memoizedProps)),ph(s,et);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)x=H.child,x!==null&&(x.return=H),Hf(s,H,!0,!0),x=!0;else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===u)break;for(;H.sibling===null;){if(H.return===null||H.return===u)return x;H=H.return}H.sibling.return=H.return,H=H.sibling}return x}function Wu(s,u){if(Wi&&Do(s,u)){s=u.stateNode;var p=s.containerInfo,S=gh();Hf(S,u,!1,!1),s.pendingChildren=S,ai(u),Wd(p,S)}}function jo(s,u,p,S){if(sa)s.memoizedProps!==S&&ai(u);else if(Wi){var x=s.stateNode,H=s.memoizedProps;if((s=Do(s,u))||H!==S){var et=na.current;H=Zd(x,p,H,S,!s,null),H===x?u.stateNode=x:(Pl(H,p,S,et)&&ai(u),u.stateNode=H,s?Zu(H,u,!1,!1):ai(u))}else u.stateNode=x}}function $u(s,u,p){if(mc(u,p)){if(s.flags|=16777216,!tr(u,p))if(Mi())s.flags|=8192;else throw Za=ru,iu}else s.flags&=-16777217}function If(s,u){if(qg(u)){if(s.flags|=16777216,!Ch(u))if(Mi())s.flags|=8192;else throw Za=ru,iu}else s.flags&=-16777217}function Uo(s,u){u!==null&&(s.flags|=4),s.flags&16384&&(u=s.tag!==22?O():536870912,s.lanes|=u,$a|=u)}function Bo(s,u){if(!tn)switch(s.tailMode){case"hidden":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?u||s.tail===null?s.tail=null:s.tail.sibling=null:S.sibling=null}}function zn(s){var u=s.alternate!==null&&s.alternate.child===s.child,p=0,S=0;if(u)for(var x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags&65011712,S|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags,S|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=S,s.childLanes=p,u}function zg(s,u,p){var S=u.pendingProps;switch(it(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(u),null;case 1:return zn(u),null;case 3:return p=u.stateNode,S=null,s!==null&&(S=s.memoizedState.cache),u.memoizedState.cache!==S&&(u.flags|=2048),ze(vn),V(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(zt(u)?ai(u):s===null||s.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,It())),Wu(s,u),zn(u),null;case 26:if(ui){p=u.type;var x=u.memoizedState;return s===null?(ai(u),x!==null?(zn(u),If(u,x)):(zn(u),$u(u,p,S))):x?x!==s.memoizedState?(ai(u),zn(u),If(u,x)):(zn(u),u.flags&=-16777217):(sa?s.memoizedProps!==S&&ai(u):jo(s,u,p,S),zn(u),$u(u,p,S)),null}case 27:if(qn){if($(u),p=Nr.current,x=u.type,s!==null&&u.stateNode!=null)sa?s.memoizedProps!==S&&ai(u):jo(s,u,x,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return zn(u),null}s=na.current,zt(u)?ht(u,s):(s=$o(x,S,p,s,!0),u.stateNode=s,ai(u))}return zn(u),null}case 5:if($(u),p=u.type,s!==null&&u.stateNode!=null)jo(s,u,p,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return zn(u),null}s=na.current,zt(u)?ht(u,s):(x=rh(p,S,Nr.current,s,u),Zu(x,u,!1,!1),u.stateNode=x,Pl(x,p,S,s)&&ai(u))}return zn(u),$u(u,u.type,u.pendingProps),null;case 6:if(s&&u.stateNode!=null)p=s.memoizedProps,sa?p!==S&&ai(u):Wi&&(p!==S?(u.stateNode=sh(S,Nr.current,na.current,u),ai(u)):u.stateNode=s.stateNode);else{if(typeof S!="string"&&u.stateNode===null)throw Error(r(166));if(s=Nr.current,p=na.current,zt(u)){if(!xn)throw Error(r(176));if(s=u.stateNode,p=u.memoizedProps,S=null,x=la,x!==null)switch(x.tag){case 27:case 5:S=x.memoizedProps}Sh(s,p,u,S)||at(u)}else u.stateNode=sh(S,s,p,u)}return zn(u),null;case 13:if(S=u.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=zt(u),S!==null&&S.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(!xn)throw Error(r(344));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));Ig(x,u)}else Wt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;zn(u),x=!1}else x=It(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return u.flags&256?(yr(u),u):(yr(u),null)}if(yr(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=S!==null,s=s!==null&&s.memoizedState!==null,p){S=u.child,x=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(x=S.alternate.memoizedState.cachePool.pool);var H=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(H=S.memoizedState.cachePool.pool),H!==x&&(S.flags|=2048)}return p!==s&&p&&(u.child.flags|=8192),Uo(u,u.updateQueue),zn(u),null;case 4:return V(),Wu(s,u),s===null&&os(u.stateNode.containerInfo),zn(u),null;case 10:return ze(u.type),zn(u),null;case 19:if(R(Ln),x=u.memoizedState,x===null)return zn(u),null;if(S=(u.flags&128)!==0,H=x.rendering,H===null)if(S)Bo(x,!1);else{if(An!==0||s!==null&&(s.flags&128)!==0)for(s=u.child;s!==null;){if(H=xo(s),H!==null){for(u.flags|=128,Bo(x,!1),s=H.updateQueue,u.updateQueue=s,Uo(u,s),u.subtreeFlags=0,s=p,p=u.child;p!==null;)Io(p,s),p=p.sibling;return v(Ln,Ln.current&1|2),u.child}s=s.sibling}x.tail!==null&&ci()>cl&&(u.flags|=128,S=!0,Bo(x,!1),u.lanes=4194304)}else{if(!S)if(s=xo(H),s!==null){if(u.flags|=128,S=!0,s=s.updateQueue,u.updateQueue=s,Uo(u,s),Bo(x,!0),x.tail===null&&x.tailMode==="hidden"&&!H.alternate&&!tn)return zn(u),null}else 2*ci()-x.renderingStartTime>cl&&p!==536870912&&(u.flags|=128,S=!0,Bo(x,!1),u.lanes=4194304);x.isBackwards?(H.sibling=u.child,u.child=H):(s=x.last,s!==null?s.sibling=H:u.child=H,x.last=H)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=ci(),u.sibling=null,s=Ln.current,v(Ln,S?s&1|2:s&1),u):(zn(u),null);case 22:case 23:return yr(u),ki(),S=u.memoizedState!==null,s!==null?s.memoizedState!==null!==S&&(u.flags|=8192):S&&(u.flags|=8192),S?(p&536870912)!==0&&(u.flags&128)===0&&(zn(u),u.subtreeFlags&6&&(u.flags|=8192)):zn(u),p=u.updateQueue,p!==null&&Uo(u,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),S=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(S=u.memoizedState.cachePool.pool),S!==p&&(u.flags|=2048),s!==null&&R(jr),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),ze(vn),zn(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function Lg(s,u){switch(it(u),u.tag){case 1:return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 3:return ze(vn),V(),s=u.flags,(s&65536)!==0&&(s&128)===0?(u.flags=s&-65537|128,u):null;case 26:case 27:case 5:return $(u),null;case 13:if(yr(u),s=u.memoizedState,s!==null&&s.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Wt()}return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 19:return R(Ln),null;case 4:return V(),null;case 10:return ze(u.type),null;case 22:case 23:return yr(u),ki(),s!==null&&R(jr),s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 24:return ze(vn),null;case 25:return null;default:return null}}function Pd(s,u){switch(it(u),u.tag){case 3:ze(vn),V();break;case 26:case 27:case 5:$(u);break;case 4:V();break;case 13:yr(u);break;case 19:R(Ln);break;case 10:ze(u.type);break;case 22:case 23:yr(u),ki(),s!==null&&R(jr);break;case 24:ze(vn)}}function da(s,u){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var x=S.next;p=x;do{if((p.tag&s)===s){S=void 0;var H=p.create,et=p.inst;S=H(),et.destroy=S}p=p.next}while(p!==x)}}catch(ut){Ye(u,u.return,ut)}}function Si(s,u,p){try{var S=u.updateQueue,x=S!==null?S.lastEffect:null;if(x!==null){var H=x.next;S=H;do{if((S.tag&s)===s){var et=S.inst,ut=et.destroy;if(ut!==void 0){et.destroy=void 0,x=u;var _t=p,Ut=ut;try{Ut()}catch(Pt){Ye(x,_t,Pt)}}}S=S.next}while(S!==H)}}catch(Pt){Ye(u,u.return,Pt)}}function kf(s){var u=s.updateQueue;if(u!==null){var p=s.stateNode;try{ia(u,p)}catch(S){Ye(s,s.return,S)}}}function qf(s,u,p){p.props=Rs(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(S){Ye(s,u,S)}}function Ol(s,u){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var S=Is(s.stateNode);break;case 30:S=s.stateNode;break;default:S=s.stateNode}typeof p=="function"?s.refCleanup=p(S):p.current=S}}catch(x){Ye(s,u,x)}}function wi(s,u){var p=s.ref,S=s.refCleanup;if(p!==null)if(typeof S=="function")try{S()}catch(x){Ye(s,u,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(x){Ye(s,u,x)}else p.current=null}function tc(s){var u=s.type,p=s.memoizedProps,S=s.stateNode;try{za(S,u,p,s)}catch(x){Ye(s,s.return,x)}}function Vf(s,u,p){try{kn(s.stateNode,s.type,p,u,s)}catch(S){Ye(s,s.return,S)}}function Os(s){return s.tag===5||s.tag===3||(ui?s.tag===26:!1)||(qn?s.tag===27&&Vs(s.type):!1)||s.tag===4}function zo(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||Os(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(qn&&s.tag===27&&Vs(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function xs(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?Zo(p,s,u):uh(p,s);else if(S!==4&&(qn&&S===27&&Vs(s.type)&&(p=s.stateNode,u=null),s=s.child,s!==null))for(xs(s,u,p),s=s.sibling;s!==null;)xs(s,u,p),s=s.sibling}function xl(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?yc(p,s,u):oh(p,s);else if(S!==4&&(qn&&S===27&&Vs(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(xl(s,u,p),s=s.sibling;s!==null;)xl(s,u,p),s=s.sibling}function Yf(s,u,p){s=s.containerInfo;try{_c(s,p)}catch(S){Ye(u,u.return,S)}}function Wr(s){var u=s.stateNode,p=s.memoizedProps;try{y0(s.type,p,u,s)}catch(S){Ye(s,s.return,S)}}function Ml(s,u){for(ss(s.containerInfo),ua=u;ua!==null;)if(s=ua,u=s.child,(s.subtreeFlags&1024)!==0&&u!==null)u.return=s,ua=u;else for(;ua!==null;){s=ua;var p=s.alternate;switch(u=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0;var S=s,x=p.memoizedProps;p=p.memoizedState;var H=S.stateNode;try{var et=Rs(S.type,x,S.elementType===S.type);u=H.getSnapshotBeforeUpdate(et,p),H.__reactInternalSnapshotBeforeUpdate=u}catch(ut){Ye(S,S.return,ut)}}break;case 3:(u&1024)!==0&&sa&&Jd(s.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=s.sibling,u!==null){u.return=s.return,ua=u;break}ua=s.return}}function ec(s,u,p){var S=p.flags;switch(p.tag){case 0:case 11:case 15:Ki(s,p),S&4&&da(5,p);break;case 1:if(Ki(s,p),S&4)if(s=p.stateNode,u===null)try{s.componentDidMount()}catch(et){Ye(p,p.return,et)}else{var x=Rs(p.type,u.memoizedProps);u=u.memoizedState;try{s.componentDidUpdate(x,u,s.__reactInternalSnapshotBeforeUpdate)}catch(et){Ye(p,p.return,et)}}S&64&&kf(p),S&512&&Ol(p,p.return);break;case 3:if(Ki(s,p),S&64&&(s=p.updateQueue,s!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=Is(p.child.stateNode);break;case 1:u=p.child.stateNode}try{ia(s,u)}catch(et){Ye(p,p.return,et)}}break;case 27:qn&&u===null&&S&4&&Wr(p);case 26:case 5:Ki(s,p),u===null&&S&4&&tc(p),S&512&&Ol(p,p.return);break;case 12:Ki(s,p);break;case 13:Ki(s,p),S&4&&Qf(s,p),S&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=th.bind(null,p),vh(s,p))));break;case 22:if(S=p.memoizedState!==null||lr,!S){u=u!==null&&u.memoizedState!==null||Mn,x=lr;var H=Mn;lr=S,(Mn=u)&&!H?Ri(s,p,(p.subtreeFlags&8772)!==0):Ki(s,p),lr=x,Mn=H}break;case 30:break;default:Ki(s,p)}}function Kf(s){var u=s.alternate;u!==null&&(s.alternate=null,Kf(u)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(u=s.stateNode,u!==null&&In(u)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function ga(s,u,p){for(p=p.child;p!==null;)nc(s,u,p),p=p.sibling}function nc(s,u,p){if(Fa&&typeof Fa.onCommitFiberUnmount=="function")try{Fa.onCommitFiberUnmount(ql,p)}catch{}switch(p.tag){case 26:if(ui){Mn||wi(p,u),ga(s,u,p),p.memoizedState?_h(p.memoizedState):p.stateNode&&Eh(p.stateNode);break}case 27:if(qn){Mn||wi(p,u);var S=de,x=Be;Vs(p.type)&&(de=p.stateNode,Be=!1),ga(s,u,p),Th(p.stateNode),de=S,Be=x;break}case 5:Mn||wi(p,u);case 6:if(sa){if(S=de,x=Be,de=null,ga(s,u,p),de=S,Be=x,de!==null)if(Be)try{fh(de,p.stateNode)}catch(H){Ye(p,u,H)}else try{Sc(de,p.stateNode)}catch(H){Ye(p,u,H)}}else ga(s,u,p);break;case 18:sa&&de!==null&&(Be?h0(de,p.stateNode):f0(de,p.stateNode));break;case 4:sa?(S=de,x=Be,de=p.stateNode.containerInfo,Be=!0,ga(s,u,p),de=S,Be=x):(Wi&&Yf(p.stateNode,p,gh()),ga(s,u,p));break;case 0:case 11:case 14:case 15:Mn||Si(2,p,u),Mn||Si(4,p,u),ga(s,u,p);break;case 1:Mn||(wi(p,u),S=p.stateNode,typeof S.componentWillUnmount=="function"&&qf(p,u,S)),ga(s,u,p);break;case 21:ga(s,u,p);break;case 22:Mn=(S=Mn)||p.memoizedState!==null,ga(s,u,p),Mn=S;break;default:ga(s,u,p)}}function Qf(s,u){if(xn&&u.memoizedState===null&&(s=u.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{c0(s)}catch(p){Ye(u,u.return,p)}}function Hd(s){switch(s.tag){case 13:case 19:var u=s.stateNode;return u===null&&(u=s.stateNode=new w0),u;case 22:return s=s.stateNode,u=s._retryCache,u===null&&(u=s._retryCache=new w0),u;default:throw Error(r(435,s.tag))}}function Xf(s,u){var p=Hd(s);u.forEach(function(S){var x=eh.bind(null,s,S);p.has(S)||(p.add(S),S.then(x,x))})}function ja(s,u){var p=u.deletions;if(p!==null)for(var S=0;S<p.length;S++){var x=p[S],H=s,et=u;if(sa){var ut=et;t:for(;ut!==null;){switch(ut.tag){case 27:if(qn){if(Vs(ut.type)){de=ut.stateNode,Be=!1;break t}break}case 5:de=ut.stateNode,Be=!1;break t;case 3:case 4:de=ut.stateNode.containerInfo,Be=!0;break t}ut=ut.return}if(de===null)throw Error(r(160));nc(H,et,x),de=null,Be=!1}else nc(H,et,x);H=x.alternate,H!==null&&(H.return=null),x.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Id(u,s),u=u.sibling}function Id(s,u){var p=s.alternate,S=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ja(u,s),Ua(s),S&4&&(Si(3,s,s.return),da(3,s),Si(5,s,s.return));break;case 1:ja(u,s),Ua(s),S&512&&(Mn||p===null||wi(p,p.return)),S&64&&lr&&(s=s.updateQueue,s!==null&&(S=s.callbacks,S!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?S:p.concat(S))));break;case 26:if(ui){var x=be;if(ja(u,s),Ua(s),S&512&&(Mn||p===null||wi(p,p.return)),S&4){S=p!==null?p.memoizedState:null;var H=s.memoizedState;p===null?H===null?s.stateNode===null?s.stateNode=m0(x,s.type,s.memoizedProps,s):xc(x,s.type,s.stateNode):s.stateNode=Oc(x,H,s.memoizedProps):S!==H?(S===null?p.stateNode!==null&&Eh(p.stateNode):_h(S),H===null?xc(x,s.type,s.stateNode):Oc(x,H,s.memoizedProps)):H===null&&s.stateNode!==null&&Vf(s,s.memoizedProps,p.memoizedProps)}break}case 27:if(qn){ja(u,s),Ua(s),S&512&&(Mn||p===null||wi(p,p.return)),p!==null&&S&4&&Vf(s,s.memoizedProps,p.memoizedProps);break}case 5:if(ja(u,s),Ua(s),S&512&&(Mn||p===null||wi(p,p.return)),sa){if(s.flags&32){x=s.stateNode;try{nr(x)}catch(Pt){Ye(s,s.return,Pt)}}S&4&&s.stateNode!=null&&(x=s.memoizedProps,Vf(s,x,p!==null?p.memoizedProps:x)),S&1024&&(Gc=!0)}break;case 6:if(ja(u,s),Ua(s),S&4&&sa){if(s.stateNode===null)throw Error(r(162));S=s.memoizedProps,p=p!==null?p.memoizedProps:S,x=s.stateNode;try{ch(x,p,S)}catch(Pt){Ye(s,s.return,Pt)}}break;case 3:if(ui?(kg(),x=be,be=Rc(u.containerInfo),ja(u,s),be=x):ja(u,s),Ua(s),S&4){if(sa&&xn&&p!==null&&p.memoizedState.isDehydrated)try{u0(u.containerInfo)}catch(Pt){Ye(s,s.return,Pt)}if(Wi){S=u.containerInfo,p=u.pendingChildren;try{_c(S,p)}catch(Pt){Ye(s,s.return,Pt)}}}Gc&&(Gc=!1,Ff(s));break;case 4:ui?(p=be,be=Rc(s.stateNode.containerInfo),ja(u,s),Ua(s),be=p):(ja(u,s),Ua(s)),S&4&&Wi&&Yf(s.stateNode,s,s.stateNode.pendingChildren);break;case 12:ja(u,s),Ua(s);break;case 13:ja(u,s),Ua(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(ul=ci()),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Xf(s,S)));break;case 22:x=s.memoizedState!==null;var et=p!==null&&p.memoizedState!==null,ut=lr,_t=Mn;if(lr=ut||x,Mn=_t||et,ja(u,s),Mn=_t,lr=ut,Ua(s),S&8192&&(u=s.stateNode,u._visibility=x?u._visibility&-2:u._visibility|1,x&&(p===null||et||lr||Mn||pa(s)),sa)){t:if(p=null,sa)for(u=s;;){if(u.tag===5||ui&&u.tag===26){if(p===null){et=p=u;try{H=et.stateNode,x?bc(H):dh(et.stateNode,et.memoizedProps)}catch(Pt){Ye(et,et.return,Pt)}}}else if(u.tag===6){if(p===null){et=u;try{var Ut=et.stateNode;x?hh(Ut):Fd(Ut,et.memoizedProps)}catch(Pt){Ye(et,et.return,Pt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===s)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break t;for(;u.sibling===null;){if(u.return===null||u.return===s)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}S&4&&(S=s.updateQueue,S!==null&&(p=S.retryQueue,p!==null&&(S.retryQueue=null,Xf(s,p))));break;case 19:ja(u,s),Ua(s),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Xf(s,S)));break;case 30:break;case 21:break;default:ja(u,s),Ua(s)}}function Ua(s){var u=s.flags;if(u&2){try{if(sa){for(var p,S=s.return;S!==null;){if(Os(S)){p=S;break}S=S.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:if(qn){var x=p.stateNode,H=zo(s);xl(s,H,x);break}case 5:var et=p.stateNode;p.flags&32&&(nr(et),p.flags&=-33);var ut=zo(s);xl(s,ut,et);break;case 3:case 4:var _t=p.stateNode.containerInfo,Ut=zo(s);xs(s,Ut,_t);break;default:throw Error(r(161))}}}catch(Pt){Ye(s,s.return,Pt)}s.flags&=-3}u&4096&&(s.flags&=-4097)}function Ff(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var u=s;Ff(u),u.tag===5&&u.flags&1024&&ks(u.stateNode),s=s.sibling}}function Ki(s,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)ec(s,u.alternate,u),u=u.sibling}function pa(s){for(s=s.child;s!==null;){var u=s;switch(u.tag){case 0:case 11:case 14:case 15:Si(4,u,u.return),pa(u);break;case 1:wi(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&qf(u,u.return,p),pa(u);break;case 27:qn&&Th(u.stateNode);case 26:case 5:wi(u,u.return),pa(u);break;case 22:u.memoizedState===null&&pa(u);break;case 30:pa(u);break;default:pa(u)}s=s.sibling}}function Ri(s,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var S=u.alternate,x=s,H=u,et=H.flags;switch(H.tag){case 0:case 11:case 15:Ri(x,H,p),da(4,H);break;case 1:if(Ri(x,H,p),S=H,x=S.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Ut){Ye(S,S.return,Ut)}if(S=H,x=S.updateQueue,x!==null){var ut=S.stateNode;try{var _t=x.shared.hiddenCallbacks;if(_t!==null)for(x.shared.hiddenCallbacks=null,x=0;x<_t.length;x++)rn(_t[x],ut)}catch(Ut){Ye(S,S.return,Ut)}}p&&et&64&&kf(H),Ol(H,H.return);break;case 27:qn&&Wr(H);case 26:case 5:Ri(x,H,p),p&&S===null&&et&4&&tc(H),Ol(H,H.return);break;case 12:Ri(x,H,p);break;case 13:Ri(x,H,p),p&&et&4&&Qf(x,H);break;case 22:H.memoizedState===null&&Ri(x,H,p),Ol(H,H.return);break;case 30:break;default:Ri(x,H,p)}u=u.sibling}}function Ya(s,u){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(s=u.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&$e(p))}function $r(s,u){s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&$e(s))}function bi(s,u,p,S){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Lo(s,u,p,S),u=u.sibling}function Lo(s,u,p,S){var x=u.flags;switch(u.tag){case 0:case 11:case 15:bi(s,u,p,S),x&2048&&da(9,u);break;case 1:bi(s,u,p,S);break;case 3:bi(s,u,p,S),x&2048&&(s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&$e(s)));break;case 12:if(x&2048){bi(s,u,p,S),s=u.stateNode;try{var H=u.memoizedProps,et=H.id,ut=H.onPostCommit;typeof ut=="function"&&ut(et,u.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(_t){Ye(u,u.return,_t)}}else bi(s,u,p,S);break;case 13:bi(s,u,p,S);break;case 23:break;case 22:H=u.stateNode,et=u.alternate,u.memoizedState!==null?H._visibility&2?bi(s,u,p,S):Ms(s,u):H._visibility&2?bi(s,u,p,S):(H._visibility|=2,Sr(s,u,p,S,(u.subtreeFlags&10256)!==0)),x&2048&&Ya(et,u);break;case 24:bi(s,u,p,S),x&2048&&$r(u.alternate,u);break;default:bi(s,u,p,S)}}function Sr(s,u,p,S,x){for(x=x&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var H=s,et=u,ut=p,_t=S,Ut=et.flags;switch(et.tag){case 0:case 11:case 15:Sr(H,et,ut,_t,x),da(8,et);break;case 23:break;case 22:var Pt=et.stateNode;et.memoizedState!==null?Pt._visibility&2?Sr(H,et,ut,_t,x):Ms(H,et):(Pt._visibility|=2,Sr(H,et,ut,_t,x)),x&&Ut&2048&&Ya(et.alternate,et);break;case 24:Sr(H,et,ut,_t,x),x&&Ut&2048&&$r(et.alternate,et);break;default:Sr(H,et,ut,_t,x)}u=u.sibling}}function Ms(s,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=s,S=u,x=S.flags;switch(S.tag){case 22:Ms(p,S),x&2048&&Ya(S.alternate,S);break;case 24:Ms(p,S),x&2048&&$r(S.alternate,S);break;default:Ms(p,S)}u=u.sibling}}function ii(s){if(s.subtreeFlags&De)for(s=s.child;s!==null;)Jf(s),s=s.sibling}function Jf(s){switch(s.tag){case 26:ii(s),s.flags&De&&(s.memoizedState!==null?Wo(be,s.memoizedState,s.memoizedProps):un(s.type,s.memoizedProps));break;case 5:ii(s),s.flags&De&&un(s.type,s.memoizedProps);break;case 3:case 4:if(ui){var u=be;be=Rc(s.stateNode.containerInfo),ii(s),be=u}else ii(s);break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=De,De=16777216,ii(s),De=u):ii(s));break;default:ii(s)}}function Go(s){var u=s.alternate;if(u!==null&&(s=u.child,s!==null)){u.child=null;do u=s.sibling,s.sibling=null,s=u;while(s!==null)}}function Qi(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];ua=S,ac(S,s)}Go(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)kd(s),s=s.sibling}function kd(s){switch(s.tag){case 0:case 11:case 15:Qi(s),s.flags&2048&&Si(9,s,s.return);break;case 3:Qi(s);break;case 12:Qi(s);break;case 22:var u=s.stateNode;s.memoizedState!==null&&u._visibility&2&&(s.return===null||s.return.tag!==13)?(u._visibility&=-3,wa(s)):Qi(s);break;default:Qi(s)}}function wa(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];ua=S,ac(S,s)}Go(s)}for(s=s.child;s!==null;){switch(u=s,u.tag){case 0:case 11:case 15:Si(8,u,u.return),wa(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,wa(u));break;default:wa(u)}s=s.sibling}}function ac(s,u){for(;ua!==null;){var p=ua;switch(p.tag){case 0:case 11:case 15:Si(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var S=p.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:$e(p.memoizedState.cache)}if(S=p.child,S!==null)S.return=p,ua=S;else t:for(p=s;ua!==null;){S=ua;var x=S.sibling,H=S.return;if(Kf(S),S===p){ua=null;break t}if(x!==null){x.return=H,ua=x;break t}ua=H}}}function Oi(s){var u=_i(s);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(r(364));return u}if(s=Gg(s),s===null)throw Error(r(362));return s.stateNode.current}function ic(s,u){var p=s.tag;switch(u.$$typeof){case Oa:if(s.type===u.value)return!0;break;case zi:t:{for(u=u.value,s=[s,0],p=0;p<s.length;){var S=s[p++],x=S.tag,H=s[p++],et=u[H];if(x!==5&&x!==26&&x!==27||!qs(S)){for(;et!=null&&ic(S,et);)H++,et=u[H];if(H===u.length){u=!0;break t}else for(S=S.child;S!==null;)s.push(S,H),S=S.sibling}}u=!1}return u;case Ur:if((p===5||p===26||p===27)&&Qd(s.stateNode,u.value))return!0;break;case Ti:if((p===5||p===6||p===26||p===27)&&(s=lh(s),s!==null&&0<=s.indexOf(u.value)))return!0;break;case Ql:if((p===5||p===26||p===27)&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Nl(s){switch(s.$$typeof){case Oa:return"<"+(C(s.value)||"Unknown")+">";case zi:return":has("+(Nl(s)||"")+")";case Ur:return'[role="'+s.value+'"]';case Ti:return'"'+s.value+'"';case Ql:return'[data-testname="'+s.value+'"]';default:throw Error(r(365))}}function ts(s,u){var p=[];s=[s,0];for(var S=0;S<s.length;){var x=s[S++],H=x.tag,et=s[S++],ut=u[et];if(H!==5&&H!==26&&H!==27||!qs(x)){for(;ut!=null&&ic(x,ut);)et++,ut=u[et];if(et===u.length)p.push(x);else for(x=x.child;x!==null;)s.push(x,et),x=x.sibling}}return p}function Po(s,u){if(!er)throw Error(r(363));s=Oi(s),s=ts(s,u),u=[],s=Array.from(s);for(var p=0;p<s.length;){var S=s[p++],x=S.tag;if(x===5||x===26||x===27)qs(S)||u.push(S.stateNode);else for(S=S.child;S!==null;)s.push(S),S=S.sibling}return u}function Ka(){if((je&2)!==0&&Le!==0)return Le&-Le;if(ue.T!==null){var s=rr;return s!==0?s:gt()}return us()}function rc(){_a===0&&(_a=(Le&536870912)===0||tn?G():536870912);var s=di.current;return s!==null&&(s.flags|=32),_a}function Qa(s,u,p){(s===gn&&(Je===2||Je===9)||s.cancelPendingCommit!==null)&&(ma(s,0),xi(s,Le,_a,!1)),T(s,p),((je&2)===0||s!==gn)&&(s===gn&&((je&2)===0&&(wn|=p),An===4&&xi(s,Le,_a,!1)),Ae(s))}function ri(s,u,p){if((je&6)!==0)throw Error(r(327));var S=!p&&(u&124)===0&&(u&s.expiredLanes)===0||N(s,u),x=S?qd(s,u):Ho(s,u,!0),H=S;do{if(x===0){Br&&!S&&xi(s,u,0,!1);break}else{if(p=s.current.alternate,H&&!Dl(p)){x=Ho(s,u,!1),H=!1;continue}if(x===2){if(H=u,s.errorRecoveryDisabledLanes&H)var et=0;else et=s.pendingLanes&-536870913,et=et!==0?et:et&536870912?536870912:0;if(et!==0){u=et;t:{var ut=s;x=ol;var _t=xn&&ut.current.memoizedState.isDehydrated;if(_t&&(ma(ut,et).flags|=256),et=Ho(ut,et,!1),et!==2){if(Pc&&!_t){ut.errorRecoveryDisabledLanes|=H,wn|=H,x=4;break t}H=xa,xa=x,H!==null&&(xa===null?xa=H:xa.push.apply(xa,H))}x=et}if(H=!1,x!==2)continue}}if(x===1){ma(s,0),xi(s,u,0,!0);break}t:{switch(S=s,H=x,H){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:xi(S,u,_a,!or);break t;case 2:xa=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(x=ul+300-ci(),10<x)){if(xi(S,u,_a,!or),L(S,0,!0)!==0)break t;S.timeoutHandle=Kd(Ns.bind(null,S,p,xa,Ma,Hc,u,_a,wn,$a,or,H,2,-0,0),x);break t}Ns(S,p,xa,Ma,Hc,u,_a,wn,$a,or,H,0,-0,0)}}break}while(!0);Ae(s)}function Ns(s,u,p,S,x,H,et,ut,_t,Ut,Pt,Zt,$t,Oe){if(s.timeoutHandle=Ji,Zt=u.subtreeFlags,(Zt&8192||(Zt&16785408)===16785408)&&(Re(),Jf(u),Zt=Wn(),Zt!==null)){s.cancelPendingCommit=Zt(_r.bind(null,s,u,H,p,S,x,et,ut,_t,Pt,1,$t,Oe)),xi(s,H,et,!Ut);return}_r(s,u,H,p,S,x,et,ut,_t)}function Dl(s){for(var u=s;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var S=0;S<p.length;S++){var x=p[S],H=x.getSnapshot;x=x.value;try{if(!Ga(H(),x))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function xi(s,u,p,S){u&=~ur,u&=~wn,s.suspendedLanes|=u,s.pingedLanes&=~u,S&&(s.warmLanes|=u),S=s.expirationTimes;for(var x=u;0<x;){var H=31-La(x),et=1<<H;S[H]=-1,x&=~et}p!==0&&z(s,p,u)}function jl(){return(je&6)===0?(ct(0),!1):!0}function Xa(){if(me!==null){if(Je===0)var s=me.return;else s=me,Sa=hs=null,pr(s),Wa=null,il=0,s=me;for(;s!==null;)Pd(s.alternate,s),s=s.return;me=null}}function ma(s,u){var p=s.timeoutHandle;p!==Ji&&(s.timeoutHandle=Ji,Hl(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Xa(),gn=s,me=p=Cn(s.current,null),Le=u,Je=0,Sn=null,or=!1,Br=N(s,u),Pc=!1,$a=_a=ur=wn=Ia=An=0,xa=ol=null,Hc=!1,(u&8)!==0&&(u|=u&32);var S=s.entangledLanes;if(S!==0)for(s=s.entanglements,S&=u;0<S;){var x=31-La(S),H=1<<x;u|=s[x],S&=~H}return Ai=u,Dt(),p}function br(s,u){ce=null,ue.H=ba,u===Zs||u===Ws?(u=Na(),Je=3):u===iu?(u=Na(),Je=4):Je=u===Bh?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Sn=u,me===null&&(An=1,Al(s,F(u,s.current)))}function Mi(){var s=di.current;return s===null?!0:(Le&4194048)===Le?Ha===null:(Le&62914560)===Le||(Le&536870912)!==0?s===Ha:!1}function Ni(){var s=ue.H;return ue.H=ba,s===null?ba:s}function Xi(){var s=ue.A;return ue.A=cn,s}function sc(){An=4,or||(Le&4194048)!==Le&&di.current!==null||(Br=!0),(Ia&134217727)===0&&(wn&134217727)===0||gn===null||xi(gn,Le,_a,!1)}function Ho(s,u,p){var S=je;je|=2;var x=Ni(),H=Xi();(gn!==s||Le!==u)&&(Ma=null,ma(s,u)),u=!1;var et=An;t:do try{if(Je!==0&&me!==null){var ut=me,_t=Sn;switch(Je){case 8:Xa(),et=6;break t;case 3:case 2:case 9:case 6:di.current===null&&(u=!0);var Ut=Je;if(Je=0,Sn=null,si(s,ut,_t,Ut),p&&Br){et=0;break t}break;default:Ut=Je,Je=0,Sn=null,si(s,ut,_t,Ut)}}Zf(),et=An;break}catch(Pt){br(s,Pt)}while(!0);return u&&s.shellSuspendCounter++,Sa=hs=null,je=S,ue.H=x,ue.A=H,me===null&&(gn=null,Le=0,Dt()),et}function Zf(){for(;me!==null;)mn(me)}function qd(s,u){var p=je;je|=2;var S=Ni(),x=Xi();gn!==s||Le!==u?(Ma=null,cl=ci()+500,ma(s,u)):Br=N(s,u);t:do try{if(Je!==0&&me!==null){u=me;var H=Sn;e:switch(Je){case 1:Je=0,Sn=null,si(s,u,H,1);break;case 2:case 9:if(En(H)){Je=0,Sn=null,qe(u);break}u=function(){Je!==2&&Je!==9||gn!==s||(Je=7),Ae(s)},H.then(u,u);break t;case 3:Je=7;break t;case 4:Je=5;break t;case 7:En(H)?(Je=0,Sn=null,qe(u)):(Je=0,Sn=null,si(s,u,H,7));break;case 5:var et=null;switch(me.tag){case 26:et=me.memoizedState;case 5:case 27:var ut=me,_t=ut.type,Ut=ut.pendingProps;if(et?Ch(et):tr(_t,Ut)){Je=0,Sn=null;var Pt=ut.sibling;if(Pt!==null)me=Pt;else{var Zt=ut.return;Zt!==null?(me=Zt,Ba(Zt)):me=null}break e}}Je=0,Sn=null,si(s,u,H,5);break;case 6:Je=0,Sn=null,si(s,u,H,6);break;case 8:Xa(),An=6;break t;default:throw Error(r(462))}}va();break}catch($t){br(s,$t)}while(!0);return Sa=hs=null,ue.H=S,ue.A=x,je=p,me!==null?0:(gn=null,Le=0,Dt(),An)}function va(){for(;me!==null&&!Nc();)mn(me)}function mn(s){var u=Rl(s.alternate,s,Ai);s.memoizedProps=s.pendingProps,u===null?Ba(s):me=u}function qe(s){var u=s,p=u.alternate;switch(u.tag){case 15:case 0:u=Ku(p,u,u.pendingProps,u.type,void 0,Le);break;case 11:u=Ku(p,u,u.pendingProps,u.type.render,u.ref,Le);break;case 5:pr(u);default:Pd(p,u),u=me=Io(u,Ai),u=Rl(p,u,Ai)}s.memoizedProps=s.pendingProps,u===null?Ba(s):me=u}function si(s,u,p,S){Sa=hs=null,pr(u),Wa=null,il=0;var x=u.return;try{if(Bg(s,x,u,p,Le)){An=1,Al(s,F(p,s.current)),me=null;return}}catch(H){if(x!==null)throw me=x,H;An=1,Al(s,F(p,s.current)),me=null;return}u.flags&32768?(tn||S===1?s=!0:Br||(Le&536870912)!==0?s=!1:(or=s=!0,(S===2||S===9||S===3||S===6)&&(S=di.current,S!==null&&S.tag===13&&(S.flags|=16384))),lc(u,s)):Ba(u)}function Ba(s){var u=s;do{if((u.flags&32768)!==0){lc(u,or);return}s=u.return;var p=zg(u.alternate,u,Ai);if(p!==null){me=p;return}if(u=u.sibling,u!==null){me=u;return}me=u=s}while(u!==null);An===0&&(An=5)}function lc(s,u){do{var p=Lg(s.alternate,s);if(p!==null){p.flags&=32767,me=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(s=s.sibling,s!==null)){me=s;return}me=s=p}while(s!==null);An=6,me=null}function _r(s,u,p,S,x,H,et,ut,_t){s.cancelPendingCommit=null;do js();while(sn!==0);if((je&6)!==0)throw Error(r(327));if(u!==null){if(u===s.current)throw Error(r(177));if(H=u.lanes|u.childLanes,H|=Lc,y(s,p,H,et,ut,_t),s===gn&&(me=gn=null,Le=0),fl=u,Lr=s,Xl=p,cr=H,Fl=x,Ic=S,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Bl(wh,function(){return Ul(),null})):(s.callbackNode=null,s.callbackPriority=0),S=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||S){S=ue.T,ue.T=null,x=$i(),Zn(2),et=je,je|=4;try{Ml(s,u,p)}finally{je=et,Zn(x),ue.T=S}}sn=1,Wf(),$f(),Ds()}}function Wf(){if(sn===1){sn=0;var s=Lr,u=fl,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=ue.T,ue.T=null;var S=$i();Zn(2);var x=je;je|=4;try{Id(u,s),Xo(s.containerInfo)}finally{je=x,Zn(S),ue.T=p}}s.current=u,sn=2}}function $f(){if(sn===2){sn=0;var s=Lr,u=fl,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=ue.T,ue.T=null;var S=$i();Zn(2);var x=je;je|=4;try{ec(s,u.alternate,u)}finally{je=x,Zn(S),ue.T=p}}sn=3}}function Ds(){if(sn===4||sn===3){sn=0,_0();var s=Lr,u=fl,p=Xl,S=Ic;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?sn=5:(sn=0,fl=Lr=null,es(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(zr=null),K(p),u=u.stateNode,Fa&&typeof Fa.onCommitFiberRoot=="function")try{Fa.onCommitFiberRoot(ql,u,void 0,(u.current.flags&128)===128)}catch{}if(S!==null){u=ue.T,x=$i(),Zn(2),ue.T=null;try{for(var H=s.onRecoverableError,et=0;et<S.length;et++){var ut=S[et];H(ut.value,{componentStack:ut.stack})}}finally{ue.T=u,Zn(x)}}(Xl&3)!==0&&js(),Ae(s),x=s.pendingLanes,(p&4194090)!==0&&(x&42)!==0?s===kc?fr++:(fr=0,kc=s):fr=0,ct(0)}}function es(s,u){(s.pooledCacheLanes&=u)===0&&(u=s.pooledCache,u!=null&&(s.pooledCache=null,$e(u)))}function js(s){return Wf(),$f(),Ds(),Ul()}function Ul(){if(sn!==5)return!1;var s=Lr,u=cr;cr=0;var p=K(Xl),S=32>p?32:p;p=ue.T;var x=$i();try{Zn(S),ue.T=null,S=Fl,Fl=null;var H=Lr,et=Xl;if(sn=0,fl=Lr=null,Xl=0,(je&6)!==0)throw Error(r(331));var ut=je;if(je|=4,kd(H.current),Lo(H,H.current,et,S),je=ut,ct(0,!1),Fa&&typeof Fa.onPostCommitFiberRoot=="function")try{Fa.onPostCommitFiberRoot(ql,H)}catch{}return!0}finally{Zn(x),ue.T=p,es(s,u)}}function oc(s,u,p){u=F(p,u),u=Bf(s.stateNode,u,2),s=ee(s,u,2),s!==null&&(T(s,2),Ae(s))}function Ye(s,u,p){if(s.tag===3)oc(s,s,p);else for(;u!==null;){if(u.tag===3){oc(u,s,p);break}else if(u.tag===1){var S=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(zr===null||!zr.has(S))){s=F(p,s),p=Md(2),S=ee(u,p,2),S!==null&&(zf(p,S,u,s),T(S,2),Ae(S));break}}u=u.return}}function Di(s,u,p){var S=s.pingCache;if(S===null){S=s.pingCache=new ps;var x=new Set;S.set(u,x)}else x=S.get(u),x===void 0&&(x=new Set,S.set(u,x));x.has(p)||(Pc=!0,x.add(p),s=ns.bind(null,s,u,p),u.then(s,s))}function ns(s,u,p){var S=s.pingCache;S!==null&&S.delete(u),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,gn===s&&(Le&p)===p&&(An===4||An===3&&(Le&62914560)===Le&&300>ci()-ul?(je&2)===0&&ma(s,0):ur|=p,$a===Le&&($a=0)),Ae(s)}function Fi(s,u){u===0&&(u=O()),s=ae(s,u),s!==null&&(T(s,u),Ae(s))}function th(s){var u=s.memoizedState,p=0;u!==null&&(p=u.retryLane),Fi(s,p)}function eh(s,u){var p=0;switch(s.tag){case 13:var S=s.stateNode,x=s.memoizedState;x!==null&&(p=x.retryLane);break;case 19:S=s.stateNode;break;case 22:S=s.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(u),Fi(s,p)}function Bl(s,u){return nu(s,u)}function uc(s,u,p,S){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Cn(s,u){var p=s.alternate;return p===null?(p=n(s.tag,u,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=u,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,u=s.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Io(s,u){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,u=p.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),s}function ko(s,u,p,S,x,H){var et=0;if(S=s,typeof s=="function")Er(s)&&(et=1);else if(typeof s=="string")et=ui&&qn?bh(s,p,na.current)?26:kl(s)?27:5:ui?bh(s,p,na.current)?26:5:qn&&kl(s)?27:5;else t:switch(s){case is:return s=n(31,p,u,x),s.elementType=is,s.lanes=H,s;case Ls:return Us(p.children,x,H,u);case Gs:et=8,x|=24;break;case qo:return s=n(12,p,u,x|2),s.elementType=qo,s.lanes=H,s;case Ar:return s=n(13,p,u,x),s.elementType=Ar,s.lanes=H,s;case wr:return s=n(19,p,u,x),s.elementType=wr,s.lanes=H,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case dc:case Tr:et=10;break t;case Vo:et=9;break t;case gc:et=11;break t;case pc:et=14;break t;case Rr:et=16,S=null;break t}et=29,p=Error(r(130,s===null?"null":typeof s,"")),S=null}return u=n(et,p,u,x),u.elementType=s,u.type=S,u.lanes=H,u}function Us(s,u,p,S){return s=n(7,s,S,u),s.lanes=p,s}function nh(s,u,p){return s=n(6,s,null,u),s.lanes=p,s}function ah(s,u,p){return u=n(4,s.children!==null?s.children:[],s.key,u),u.lanes=p,u.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},u}function Jn(s,u,p,S,x,H,et,ut){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ji,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=w(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=w(0),this.hiddenUpdates=w(null),this.identifierPrefix=S,this.onUncaughtError=x,this.onCaughtError=H,this.onRecoverableError=et,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ut,this.incompleteTransitions=new Map}function cc(s,u,p,S,x,H,et,ut,_t,Ut,Pt,Zt){return s=new Jn(s,u,p,et,ut,_t,Ut,Zt),u=1,H===!0&&(u|=24),H=n(3,null,null,u),s.current=H,H.stateNode=s,u=we(),u.refCount++,s.pooledCache=u,u.refCount++,H.memoizedState={element:S,isDehydrated:p,cache:u},Xn(H),s}function zl(s){return s?(s=cs,s):cs}function Ll(s){var u=s._reactInternals;if(u===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=h(u),s=s!==null?g(s):null,s===null?null:Is(s.stateNode)}function fc(s,u,p,S,x,H){x=zl(x),S.context===null?S.context=x:S.pendingContext=x,S=Ee(u),S.payload={element:p},H=H===void 0?null:H,H!==null&&(S.callback=H),p=ee(s,S,u),p!==null&&(Qa(p,s,u),He(p,s,u))}function Bs(s,u){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<u?p:u}}function as(s,u){Bs(s,u),(s=s.alternate)&&Bs(s,u)}var Ie={},Vd=Eg(),li=K6(),hc=Object.assign,zs=Symbol.for("react.element"),Gl=Symbol.for("react.transitional.element"),Cr=Symbol.for("react.portal"),Ls=Symbol.for("react.fragment"),Gs=Symbol.for("react.strict_mode"),qo=Symbol.for("react.profiler"),dc=Symbol.for("react.provider"),Vo=Symbol.for("react.consumer"),Tr=Symbol.for("react.context"),gc=Symbol.for("react.forward_ref"),Ar=Symbol.for("react.suspense"),wr=Symbol.for("react.suspense_list"),pc=Symbol.for("react.memo"),Rr=Symbol.for("react.lazy"),is=Symbol.for("react.activity"),Yo=Symbol.for("react.memo_cache_sentinel"),Ko=Symbol.iterator,Qo=Symbol.for("react.client.reference"),Ps=Array.isArray,ue=Vd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Hs=t.rendererVersion,Yd=t.rendererPackageName,Or=t.extraDevToolsConfig,Is=t.getPublicInstance,ih=t.getRootHostContext,rs=t.getChildHostContext,ss=t.prepareForCommit,Xo=t.resetAfterCommit,rh=t.createInstance;t.cloneMutableInstance;var Fo=t.appendInitialChild,Pl=t.finalizeInitialChildren,ls=t.shouldSetTextContent,sh=t.createTextInstance;t.cloneMutableTextInstance;var Kd=t.scheduleTimeout,Hl=t.cancelTimeout,Ji=t.noTimeout,Zi=t.isPrimaryRenderer;t.warnsIfNotActing;var sa=t.supportsMutation,Wi=t.supportsPersistence,xn=t.supportsHydration,_i=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var os=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var Zn=t.setCurrentUpdatePriority,$i=t.getCurrentUpdatePriority,us=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var oi=t.shouldAttemptEagerTransition,In=t.detachDeletedInstance;t.requestPostPaintCallback;var mc=t.maySuspendCommit,tr=t.preloadInstance,Re=t.startSuspendingCommit,un=t.suspendInstance;t.suspendOnActiveViewTransition;var Wn=t.waitForCommitToBeReady,xr=t.NotPendingTransition,Ei=t.HostTransitionContext,ks=t.resetFormInstance;t.bindToConsole;var vc=t.supportsMicrotasks,Jo=t.scheduleMicrotask,er=t.supportsTestSelectors,Gg=t.findFiberRoot,Hn=t.getBoundingRect,lh=t.getTextContent,qs=t.isHiddenSubtree,Qd=t.matchAccessibilityRole,Xd=t.setFocusIfFocusable,Pg=t.setupIntersectionObserver,oh=t.appendChild,uh=t.appendChildToContainer,ch=t.commitTextUpdate,za=t.commitMount,kn=t.commitUpdate,yc=t.insertBefore,Zo=t.insertInContainerBefore,Sc=t.removeChild,fh=t.removeChildFromContainer,nr=t.resetTextContent,bc=t.hideInstance,hh=t.hideTextInstance,dh=t.unhideInstance,Fd=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopGestureTransition,t.getCurrentGestureOffset,t.subscribeToGestureDirection,t.createViewTransitionInstance;var Jd=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var Zd=t.cloneInstance,gh=t.createContainerChildSet,ph=t.appendChildToContainerChildSet,Wd=t.finalizeContainerChildren,_c=t.replaceContainerChildren,mh=t.cloneHiddenInstance,$d=t.cloneHiddenTextInstance,Ec=t.isSuspenseInstancePending,Cc=t.isSuspenseInstanceFallback,t0=t.getSuspenseInstanceFallbackErrorDetails,vh=t.registerSuspenseInstanceRetry,e0=t.canHydrateFormStateMarker,n0=t.isFormStateMarkerMatching,yh=t.getNextHydratableSibling,a0=t.getNextHydratableSiblingAfterSingleton,i0=t.getFirstHydratableChild,Hg=t.getFirstHydratableChildWithinContainer,r0=t.getFirstHydratableChildWithinSuspenseInstance,Il=t.getFirstHydratableChildWithinSingleton,s0=t.canHydrateInstance,Tc=t.canHydrateTextInstance,Ac=t.canHydrateSuspenseInstance,l0=t.hydrateInstance,Sh=t.hydrateTextInstance,Ig=t.hydrateSuspenseInstance,o0=t.getNextHydratableInstanceAfterSuspenseInstance,u0=t.commitHydratedContainer,c0=t.commitHydratedSuspenseInstance,f0=t.clearSuspenseBoundary,h0=t.clearSuspenseBoundaryFromContainer,wc=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var d0=t.validateHydratableInstance,g0=t.validateHydratableTextInstance,ui=t.supportsResources,bh=t.isHostHoistableType,Rc=t.getHoistableRoot,p0=t.getResource,Oc=t.acquireResource,_h=t.releaseResource,m0=t.hydrateHoistable,xc=t.mountHoistable,Eh=t.unmountHoistable,v0=t.createHoistableInstance,kg=t.prepareToCommitHoistables,qg=t.mayResourceSuspendCommit,Ch=t.preloadResource,Wo=t.suspendResource,qn=t.supportsSingletons,$o=t.resolveSingletonInstance,y0=t.acquireSingletonInstance,Th=t.releaseSingletonInstance,kl=t.isHostSingletonType,Vs=t.isSingletonScope,tu=[],Ys=-1,cs={},La=Math.clz32?Math.clz32:D,S0=Math.log,b0=Math.LN2,ar=256,eu=4194304,nu=li.unstable_scheduleCallback,Mc=li.unstable_cancelCallback,Nc=li.unstable_shouldYield,_0=li.unstable_requestPaint,ci=li.unstable_now,Ah=li.unstable_ImmediatePriority,E0=li.unstable_UserBlockingPriority,wh=li.unstable_NormalPriority,Rh=li.unstable_IdlePriority,$n=li.log,ya=li.unstable_setDisableYieldValue,ql=null,Fa=null,Dc,Oh,Ks=!1,xh=new WeakMap,Mr=[],Qs=0,jc=null,Xs=0,Ja=[],fi=0,fs=null,ir=1,ji="",na=E(null),Fs=E(null),Nr=E(null),Vl=E(null),la=null,Vn=null,tn=!1,Dr=null,Ui=!1,Bi=Error(r(519)),Ga=typeof Object.is=="function"?Object.is:Bt,Uc=E(null),hs=null,Sa=null,Mh=typeof AbortController<"u"?AbortController:function(){var s=[],u=this.signal={aborted:!1,addEventListener:function(p,S){s.push(S)}};this.abort=function(){u.aborted=!0,s.forEach(function(p){return p()})}},C0=li.unstable_scheduleCallback,Bc=li.unstable_NormalPriority,vn={$$typeof:Tr,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},dn=null,Yl=null,Nh=!1,au=!1,Js=!1,hi=0,Kl=null,zc=0,rr=0,Pa=null,Dh=ue.S;ue.S=function(s,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&Jt(s,u),Dh!==null&&Dh(s,u)};var jr=E(null),T0=Object.prototype.hasOwnProperty,Zs=Error(r(460)),iu=Error(r(474)),Ws=Error(r(542)),ru={then:function(){}},Za=null,nn=[],ds=0,Lc=0,Tn=!1,jh=!1,$s=E(null),su=E(0),an=0,ce=null,Ve=null,Yn=null,lu=!1,tl=!1,el=!1,nl=0,oa=0,Ra=null,A0=0,ba={readContext:Yt,use:Du,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useLayoutEffect:Bn,useInsertionEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useSyncExternalStore:Bn,useId:Bn,useHostTransitionStatus:Bn,useFormState:Bn,useActionState:Bn,useOptimistic:Bn,useMemoCache:Bn,useCacheRefresh:Bn},Uh={readContext:Yt,use:Du,useCallback:function(s,u){return ea().memoizedState=[s,u===void 0?null:u],s},useContext:Yt,useEffect:Mf,useImperativeHandle:function(s,u,p){p=p!=null?p.concat([s]):null,mr(4194308,4,Vi.bind(null,u,s),p)},useLayoutEffect:function(s,u){return mr(4194308,4,s,u)},useInsertionEffect:function(s,u){mr(4,2,s,u)},useMemo:function(s,u){var p=ea();u=u===void 0?null:u;var S=s();if(el){Q(!0);try{s()}finally{Q(!1)}}return p.memoizedState=[S,u],S},useReducer:function(s,u,p){var S=ea();if(p!==void 0){var x=p(u);if(el){Q(!0);try{p(u)}finally{Q(!1)}}}else x=u;return S.memoizedState=S.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},S.queue=s,s=s.dispatch=Ao.bind(null,ce,s),[S.memoizedState,s]},useRef:function(s){var u=ea();return s={current:s},u.memoizedState=s},useState:function(s){s=_o(s);var u=s.queue,p=Td.bind(null,ce,u);return u.dispatch=p,[s.memoizedState,p]},useDebugValue:As,useDeferredValue:function(s,u){var p=ea();return Tl(p,s,u)},useTransition:function(){var s=_o(!1);return s=Co.bind(null,ce,s.queue,!0,!1),ea().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,u,p){var S=ce,x=ea();if(tn){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),gn===null)throw Error(r(349));(Le&124)!==0||Uu(S,u,p)}x.memoizedState=p;var H={value:p,getSnapshot:u};return x.queue=H,Mf(bo.bind(null,S,H,s),[s]),S.flags|=2048,Va(9,El(),Cf.bind(null,S,H,p,u),null),p},useId:function(){var s=ea(),u=gn.identifierPrefix;if(tn){var p=ji,S=ir;p=(S&~(1<<32-La(S)-1)).toString(32)+p,u="«"+u+"R"+p,p=nl++,0<p&&(u+="H"+p.toString(32)),u+="»"}else p=A0++,u="«"+u+"r"+p.toString(32)+"»";return s.memoizedState=u},useHostTransitionStatus:Hu,useFormState:xf,useActionState:xf,useOptimistic:function(s){var u=ea();u.memoizedState=u.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=wo.bind(null,ce,!0,p),p.dispatch=u,[s,u]},useMemoCache:_l,useCacheRefresh:function(){return ea().memoizedState=Iu.bind(null,ce)}},sr={readContext:Yt,use:Du,useCallback:vr,useContext:Yt,useEffect:Lu,useImperativeHandle:Gu,useInsertionEffect:Nf,useLayoutEffect:Cl,useMemo:Pu,useReducer:yi,useRef:zu,useState:function(){return yi(vi)},useDebugValue:As,useDeferredValue:function(s,u){var p=Fn();return Df(p,Ve.memoizedState,s,u)},useTransition:function(){var s=yi(vi)[0],u=Fn().memoizedState;return[typeof s=="boolean"?s:bl(s),u]},useSyncExternalStore:bd,useId:Da,useHostTransitionStatus:Hu,useFormState:Bu,useActionState:Bu,useOptimistic:function(s,u){var p=Fn();return Tf(p,Ve,s,u)},useMemoCache:_l,useCacheRefresh:Qr},al={readContext:Yt,use:Du,useCallback:vr,useContext:Yt,useEffect:Lu,useImperativeHandle:Gu,useInsertionEffect:Nf,useLayoutEffect:Cl,useMemo:Pu,useReducer:ju,useRef:zu,useState:function(){return ju(vi)},useDebugValue:As,useDeferredValue:function(s,u){var p=Fn();return Ve===null?Tl(p,s,u):Df(p,Ve.memoizedState,s,u)},useTransition:function(){var s=ju(vi)[0],u=Fn().memoizedState;return[typeof s=="boolean"?s:bl(s),u]},useSyncExternalStore:bd,useId:Da,useHostTransitionStatus:Hu,useFormState:Eo,useActionState:Eo,useOptimistic:function(s,u){var p=Fn();return Ve!==null?Tf(p,Ve,s,u):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:_l,useCacheRefresh:Qr},Wa=null,il=0,gs=Ad(!0),Ci=Ad(!1),di=E(null),Ha=null,Ln=E(0),rl={enqueueSetState:function(s,u,p){s=s._reactInternals;var S=Ka(),x=Ee(S);x.payload=u,p!=null&&(x.callback=p),u=ee(s,x,S),u!==null&&(Qa(u,s,S),He(u,s,S))},enqueueReplaceState:function(s,u,p){s=s._reactInternals;var S=Ka(),x=Ee(S);x.tag=1,x.payload=u,p!=null&&(x.callback=p),u=ee(s,x,S),u!==null&&(Qa(u,s,S),He(u,s,S))},enqueueForceUpdate:function(s,u){s=s._reactInternals;var p=Ka(),S=Ee(p);S.tag=2,u!=null&&(S.callback=u),u=ee(s,S,p),u!==null&&(Qa(u,s,p),He(u,s,p))}},sl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Bh=Error(r(461)),aa=!1,ll={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},lr=!1,Mn=!1,Gc=!1,w0=typeof WeakSet=="function"?WeakSet:Set,ua=null,de=null,Be=!1,be=null,De=8192,cn={getCacheForType:function(s){var u=Yt(vn),p=u.data.get(s);return p===void 0&&(p=s(),u.data.set(s,p)),p}},Oa=0,zi=1,Ur=2,Ql=3,Ti=4;if(typeof Symbol=="function"&&Symbol.for){var yn=Symbol.for;Oa=yn("selector.component"),zi=yn("selector.has_pseudo_class"),Ur=yn("selector.role"),Ql=yn("selector.test_id"),Ti=yn("selector.text")}var ps=typeof WeakMap=="function"?WeakMap:Map,je=0,gn=null,me=null,Le=0,Je=0,Sn=null,or=!1,Br=!1,Pc=!1,Ai=0,An=0,Ia=0,wn=0,ur=0,_a=0,$a=0,ol=null,xa=null,Hc=!1,ul=0,cl=1/0,Ma=null,zr=null,sn=0,Lr=null,fl=null,Xl=0,cr=0,Fl=null,Ic=null,fr=0,kc=null;return Ie.attemptContinuousHydration=function(s){if(s.tag===13){var u=ae(s,67108864);u!==null&&Qa(u,s,67108864),as(s,67108864)}},Ie.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var u=Ka();u=P(u);var p=ae(s,u);p!==null&&Qa(p,s,u),as(s,u)}},Ie.attemptSynchronousHydration=function(s){switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var u=B(s.pendingLanes);if(u!==0){for(s.pendingLanes|=2,s.entangledLanes|=2;u;){var p=1<<31-La(u);s.entanglements[1]|=p,u&=~p}Ae(s),(je&6)===0&&(cl=ci()+500,ct(0))}}break;case 13:u=ae(s,2),u!==null&&Qa(u,s,2),jl(),as(s,2)}},Ie.batchedUpdates=function(s,u){return s(u)},Ie.createComponentSelector=function(s){return{$$typeof:Oa,value:s}},Ie.createContainer=function(s,u,p,S,x,H,et,ut,_t,Ut){return cc(s,u,!1,null,p,S,H,et,ut,_t,Ut,null)},Ie.createHasPseudoClassSelector=function(s){return{$$typeof:zi,value:s}},Ie.createHydrationContainer=function(s,u,p,S,x,H,et,ut,_t,Ut,Pt,Zt,$t){return s=cc(p,S,!0,s,x,H,ut,_t,Ut,Pt,Zt,$t),s.context=zl(null),p=s.current,S=Ka(),S=P(S),x=Ee(S),x.callback=u??null,ee(p,x,S),u=S,s.current.lanes=u,T(s,u),Ae(s),s},Ie.createPortal=function(s,u,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Cr,key:S==null?null:""+S,children:s,containerInfo:u,implementation:p}},Ie.createRoleSelector=function(s){return{$$typeof:Ur,value:s}},Ie.createTestNameSelector=function(s){return{$$typeof:Ql,value:s}},Ie.createTextSelector=function(s){return{$$typeof:Ti,value:s}},Ie.defaultOnCaughtError=function(s){console.error(s)},Ie.defaultOnRecoverableError=function(s){sl(s)},Ie.defaultOnUncaughtError=function(s){sl(s)},Ie.deferredUpdates=function(s){var u=ue.T,p=$i();try{return Zn(32),ue.T=null,s()}finally{Zn(p),ue.T=u}},Ie.discreteUpdates=function(s,u,p,S,x){var H=ue.T,et=$i();try{return Zn(2),ue.T=null,s(u,p,S,x)}finally{Zn(et),ue.T=H,je===0&&(cl=ci()+500)}},Ie.findAllNodes=Po,Ie.findBoundingRects=function(s,u){if(!er)throw Error(r(363));u=Po(s,u),s=[];for(var p=0;p<u.length;p++)s.push(Hn(u[p]));for(u=s.length-1;0<u;u--){p=s[u];for(var S=p.x,x=S+p.width,H=p.y,et=H+p.height,ut=u-1;0<=ut;ut--)if(u!==ut){var _t=s[ut],Ut=_t.x,Pt=Ut+_t.width,Zt=_t.y,$t=Zt+_t.height;if(S>=Ut&&H>=Zt&&x<=Pt&&et<=$t){s.splice(u,1);break}else if(S!==Ut||p.width!==_t.width||$t<H||Zt>et){if(!(H!==Zt||p.height!==_t.height||Pt<S||Ut>x)){Ut>S&&(_t.width+=Ut-S,_t.x=S),Pt<x&&(_t.width=x-Ut),s.splice(u,1);break}}else{Zt>H&&(_t.height+=Zt-H,_t.y=H),$t<et&&(_t.height=et-Zt),s.splice(u,1);break}}}return s},Ie.findHostInstance=Ll,Ie.findHostInstanceWithNoPortals=function(s){return s=h(s),s=s!==null?m(s):null,s===null?null:Is(s.stateNode)},Ie.findHostInstanceWithWarning=function(s){return Ll(s)},Ie.flushPassiveEffects=js,Ie.flushSyncFromReconciler=function(s){var u=je;je|=1;var p=ue.T,S=$i();try{if(Zn(2),ue.T=null,s)return s()}finally{Zn(S),ue.T=p,je=u,(je&6)===0&&ct(0)}},Ie.flushSyncWork=jl,Ie.focusWithin=function(s,u){if(!er)throw Error(r(363));for(s=Oi(s),u=ts(s,u),u=Array.from(u),s=0;s<u.length;){var p=u[s++],S=p.tag;if(!qs(p)){if((S===5||S===26||S===27)&&Xd(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},Ie.getFindAllNodesFailureDescription=function(s,u){if(!er)throw Error(r(363));var p=0,S=[];s=[Oi(s),0];for(var x=0;x<s.length;){var H=s[x++],et=H.tag,ut=s[x++],_t=u[ut];if((et!==5&&et!==26&&et!==27||!qs(H))&&(ic(H,_t)&&(S.push(Nl(_t)),ut++,ut>p&&(p=ut)),ut<u.length))for(H=H.child;H!==null;)s.push(H,ut),H=H.sibling}if(p<u.length){for(s=[];p<u.length;p++)s.push(Nl(u[p]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},Ie.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 27:case 5:return Is(s.child.stateNode);default:return s.child.stateNode}},Ie.injectIntoDevTools=function(){var s={bundleType:0,version:Hs,rendererPackageName:Yd,currentDispatcherRef:ue,reconcilerVersion:"19.1.0"};if(Or!==null&&(s.rendererConfig=Or),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)s=!0;else{try{ql=u.inject(s),Fa=u}catch{}s=!!u.checkDCE}}return s},Ie.isAlreadyRendering=function(){return(je&6)!==0},Ie.observeVisibleRects=function(s,u,p,S){if(!er)throw Error(r(363));s=Po(s,u);var x=Pg(s,p,S).disconnect;return{disconnect:function(){x()}}},Ie.shouldError=function(){return null},Ie.shouldSuspend=function(){return!1},Ie.startHostTransition=function(s,u,p,S){if(s.tag!==5)throw Error(r(476));var x=To(s).queue;Co(s,x,u,xr,p===null?a:function(){var H=To(s).next.queue;return ws(s,H,{},Ka()),p(S)})},Ie.updateContainer=function(s,u,p,S){var x=u.current,H=Ka();return fc(x,H,s,u,p,S),H},Ie.updateContainerSync=function(s,u,p,S){return fc(u.current,2,s,u,p,S),2},Ie},l.exports.default=l.exports,Object.defineProperty(l.exports,"__esModule",{value:!0})})(jp)),jp.exports}var $y;function X6(){return $y||($y=1,Dp.exports=Q6()),Dp.exports}var F6=X6();const J6=pf(F6);var zp={exports:{}},dl={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function Z6(){return t1||(t1=1,dl.ConcurrentRoot=1,dl.ContinuousEventPriority=8,dl.DefaultEventPriority=32,dl.DiscreteEventPriority=2,dl.IdleEventPriority=268435456,dl.LegacyRoot=0,dl.NoEventPriority=0),dl}var e1;function W6(){return e1||(e1=1,zp.exports=Z6()),zp.exports}var xg=W6();const n1={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let a1=!1,i1=!1;const mg=".react-konva-event",$6=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,t8=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,e8={};function Mg(l,t,n=e8){if(!a1&&"zIndex"in t&&(console.warn(t8),a1=!0),!i1&&t.draggable){var a=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;a&&!r&&(console.warn($6),i1=!0)}for(var o in n)if(!n1[o]){var f=o.slice(0,2)==="on",h=n[o]!==t[o];if(f&&h){var g=o.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),l.off(g,n[o])}var m=!t.hasOwnProperty(o);m&&l.setAttr(o,void 0)}var _=t._useStrictMode,C={},E=!1;const R={};for(var o in t)if(!n1[o]){var f=o.slice(0,2)==="on",v=n[o]!==t[o];if(f&&v){var g=o.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),t[o]&&(R[g]=t[o])}!f&&(t[o]!==n[o]||_&&t[o]!==l.getAttr(o))&&(E=!0,C[o]=t[o])}E&&(l.setAttrs(C),yo(l));for(var g in R)l.off(g+mg),l.on(g+mg,R[g])}function yo(l){if(!Xt.autoDrawEnabled){var t=l.getLayer()||l.getStage();t&&t.batchDraw()}}var Lp={exports:{}},Gp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function n8(){return r1||(r1=1,(function(l){function t(j,I){var F=j.length;j.push(I);t:for(;0<F;){var W=F-1>>>1,nt=j[W];if(0<r(nt,I))j[W]=I,j[F]=nt,F=W;else break t}}function n(j){return j.length===0?null:j[0]}function a(j){if(j.length===0)return null;var I=j[0],F=j.pop();if(F!==I){j[0]=F;t:for(var W=0,nt=j.length,Z=nt>>>1;W<Z;){var it=2*(W+1)-1,rt=j[it],V=it+1,J=j[V];if(0>r(rt,F))V<nt&&0>r(J,rt)?(j[W]=J,j[V]=F,W=V):(j[W]=rt,j[it]=F,W=it);else if(V<nt&&0>r(J,F))j[W]=J,j[V]=F,W=V;else break t}}return I}function r(j,I){var F=j.sortIndex-I.sortIndex;return F!==0?F:j.id-I.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;l.unstable_now=function(){return o.now()}}else{var f=Date,h=f.now();l.unstable_now=function(){return f.now()-h}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,B=!1,L=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(j){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=j)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function O(j){if(D=!1,G(j),!v)if(n(g)!==null)v=!0,w||(w=!0,K());else{var I=n(m);I!==null&&Y(O,I.startTime-j)}}var w=!1,T=-1,y=5,z=-1;function U(){return B?!0:!(l.unstable_now()-z<y)}function P(){if(B=!1,w){var j=l.unstable_now();z=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(T),T=-1),R=!0;var F=E;try{e:{for(G(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var nt=W(C.expirationTime<=j);if(j=l.unstable_now(),typeof nt=="function"){C.callback=nt,G(j),I=!0;break e}C===n(g)&&a(g),G(j)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-j),I=!1}}break t}finally{C=null,E=F,R=!1}I=void 0}}finally{I?K():w=!1}}}var K;if(typeof M=="function")K=function(){M(P)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=P,K=function(){X.postMessage(null)}}else K=function(){L(P,0)};function Y(j,I){T=L(function(){j(l.unstable_now())},I)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(j){j.callback=null},l.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},l.unstable_getCurrentPriorityLevel=function(){return E},l.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return j()}finally{E=F}},l.unstable_requestPaint=function(){B=!0},l.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var F=E;E=j;try{return I()}finally{E=F}},l.unstable_scheduleCallback=function(j,I,F){var W=l.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,j){case 1:var nt=-1;break;case 2:nt=250;break;case 5:nt=1073741823;break;case 4:nt=1e4;break;default:nt=5e3}return nt=F+nt,j={id:_++,callback:I,priorityLevel:j,startTime:F,expirationTime:nt,sortIndex:-1},F>W?(j.sortIndex=F,t(m,j),n(g)===null&&j===n(m)&&(D?(N(T),T=-1):D=!0,Y(O,F-W))):(j.sortIndex=nt,t(g,j),v||R||(v=!0,w||(w=!0,K()))),j},l.unstable_shouldYield=U,l.unstable_wrapCallback=function(j){var I=E;return function(){var F=E;E=I;try{return j.apply(this,arguments)}finally{E=F}}}})(Gp)),Gp}var s1;function a8(){return s1||(s1=1,Lp.exports=n8()),Lp.exports}var Pp=a8();const fS={},i8={};hf.Node.prototype._applyProps=Mg;let hS=xg.DefaultEventPriority;function r8(l,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}l.add(t),yo(l)}function s8(l,t,n){let a=hf[l];a||(console.error(`Konva has no node with the type ${l}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${l}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),a=hf.Group);const r={},o={};for(var f in t)if(f!=="ref"){var h=f.slice(0,2)==="on";h?o[f]=t[f]:r[f]=t[f]}const g=new a(r);return Mg(g,o),g}function l8(l,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${l}"`)}function o8(l,t,n){return!1}function u8(l){return l}function c8(){return null}function f8(){return null}function h8(l,t,n,a){return i8}function d8(){}function g8(l){}function p8(l,t){return!1}function m8(){return fS}function v8(){return fS}const y8=setTimeout,S8=clearTimeout,b8=!0,_8=l=>{l()},E8=-1;function C8(l,t){return!1}const T8=!1,A8=!1,w8=!0,R8=!1,O8=!1;function x8(l,t){t.parent===l?t.moveToTop():l.add(t),yo(l)}function M8(l,t){t.parent===l?t.moveToTop():l.add(t),yo(l)}function dS(l,t,n){t._remove(),l.add(t),t.setZIndex(n.getZIndex()),yo(l)}function N8(l,t,n){dS(l,t,n)}function D8(l,t){t.destroy(),t.off(mg),yo(l)}function j8(l,t){t.destroy(),t.off(mg),yo(l)}function U8(l,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function B8(l,t,n){}function z8(l,t,n,a){Mg(l,a,n)}function L8(l){l.hide(),yo(l)}function G8(l){}function P8(l,t){(t.visible==null||t.visible)&&l.show()}function H8(l,t){}function I8(l){}function k8(){}function q8(){return xg.DefaultEventPriority}function V8(){}function Y8(){return null}function K8(l){hS=l}function Q8(){return hS}function X8(){return xg.DiscreteEventPriority}function F8(){return!1}function J8(){}function Z8(){return!1}function W8(){return!0}function $8(){}function t_(){}function e_(){return null}const n_=null;function a_(){}const i_=Object.freeze(Object.defineProperty({__proto__:null,NotPendingTransition:n_,appendChild:x8,appendChildToContainer:M8,appendInitialChild:r8,cancelTimeout:S8,clearContainer:I8,commitMount:B8,commitTextUpdate:U8,commitUpdate:z8,createInstance:s8,createTextInstance:l8,detachDeletedInstance:k8,finalizeInitialChildren:o8,getChildHostContext:v8,getCurrentEventPriority:q8,getCurrentUpdatePriority:Q8,getInstanceFromScope:Y8,getPublicInstance:u8,getRootHostContext:m8,hideInstance:L8,hideTextInstance:G8,idlePriority:Pp.unstable_IdlePriority,insertBefore:dS,insertInContainerBefore:N8,isPrimaryRenderer:T8,maySuspendCommit:Z8,noTimeout:E8,now:Pp.unstable_now,preloadInstance:W8,prepareForCommit:c8,preparePortalMount:f8,prepareScopeUpdate:V8,prepareUpdate:h8,removeChild:D8,removeChildFromContainer:j8,requestPostPaintCallback:J8,resetAfterCommit:d8,resetFormInstance:a_,resetTextContent:g8,resolveUpdatePriority:X8,run:Pp.unstable_runWithPriority,scheduleMicrotask:_8,scheduleTimeout:y8,setCurrentUpdatePriority:K8,shouldAttemptEagerTransition:F8,shouldDeprioritizeSubtree:p8,shouldSetTextContent:C8,startSuspendingCommit:$8,supportsHydration:O8,supportsMicrotasks:b8,supportsMutation:w8,supportsPersistence:R8,suspendInstance:t_,unhideInstance:P8,unhideTextInstance:H8,waitForCommitToBeReady:e_,warnsIfNotActing:A8},Symbol.toStringTag,{value:"Module"}));function gS(l,t,n){if(!l)return;if(n(l)===!0)return l;let a=l.child;for(;a;){const r=gS(a,t,n);if(r)return r;a=a.sibling}}function pS(l){try{return Object.defineProperties(l,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return l}}const nv=pS(st.createContext(null));class mS extends st.Component{render(){return st.createElement(nv.Provider,{value:this._reactInternals},this.props.children)}}function r_(){const l=st.useContext(nv);if(l===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=st.useId();return st.useMemo(()=>{for(const n of[l,l==null?void 0:l.alternate]){if(!n)continue;const a=gS(n,!1,r=>{let o=r.memoizedState;for(;o;){if(o.memoizedState===t)return!0;o=o.next}});if(a)return a}},[l,t])}const s_=Symbol.for("react.context"),l_=l=>l!==null&&typeof l=="object"&&"$$typeof"in l&&l.$$typeof===s_;function o_(){const l=r_(),[t]=st.useState(()=>new Map);t.clear();let n=l;for(;n;){const a=n.type;l_(a)&&a!==nv&&!t.has(a)&&t.set(a,st.use(pS(a))),n=n.return}return t}function u_(){const l=o_();return st.useMemo(()=>Array.from(l.keys()).reduce((t,n)=>a=>st.createElement(t,null,st.createElement(n.Provider,{...a,value:l.get(n)})),t=>st.createElement(mS,{...t})),[l])}if(ta.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function c_(l){const t=ta.useRef({});return ta.useLayoutEffect(()=>{t.current=l}),ta.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const f_=()=>{const l=ta.useRef(0);return ta.useMemo(()=>{l.current++},[]),l.current>1},h_=l=>{const t=ta.useRef(null),n=ta.useRef(null),a=ta.useRef(null),r=c_(l),o=u_(),f=ta.useRef(!1),h=m=>{const{forwardedRef:_}=l;_&&(typeof _=="function"?_(m):_.current=m)},g=f_();return ta.useLayoutEffect(()=>f.current&&g?()=>{f.current=!1,h(null),sf.updateContainer(null,a.current,null),n.current.destroy()}:(f.current=!0,n.current=new hf.Stage({width:l.width,height:l.height,container:t.current}),h(n.current),a.current=sf.createContainer(n.current,xg.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),sf.updateContainer(ta.createElement(o,{},l.children),a.current,null,()=>{}),()=>{g||(h(null),sf.updateContainer(null,a.current,null),n.current.destroy())}),[]),ta.useLayoutEffect(()=>{h(n.current),Mg(n.current,l,r),sf.updateContainer(ta.createElement(o,{},l.children),a.current,null)}),ta.createElement("div",{ref:t,id:l.id,accessKey:l.accessKey,className:l.className,role:l.role,style:l.style,tabIndex:l.tabIndex,title:l.title})},Ir="Layer",ho="Line",av="Image",sf=J6(i_);sf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:ta.version,rendererPackageName:"react-konva"});const Ng=ta.forwardRef((l,t)=>ta.createElement(mS,{},ta.createElement(h_,{...l,forwardedRef:t})));var Hp={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var l1;function vS(){return l1||(l1=1,(function(l,t){(function(a,r){l.exports=r()})(window,function(){return(function(n){var a={};function r(o){if(a[o])return a[o].exports;var f=a[o]={i:o,l:!1,exports:{}};return n[o].call(f.exports,f,f.exports,r),f.l=!0,f.exports}return r.m=n,r.c=a,r.d=function(o,f,h){r.o(o,f)||Object.defineProperty(o,f,{enumerable:!0,get:h})},r.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,f){if(f&1&&(o=r(o)),f&8||f&4&&typeof o=="object"&&o&&o.__esModule)return o;var h=Object.create(null);if(r.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:o}),f&2&&typeof o!="string")for(var g in o)r.d(h,g,(function(m){return o[m]}).bind(null,g));return h},r.n=function(o){var f=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(f,"a",f),f},r.o=function(o,f){return Object.prototype.hasOwnProperty.call(o,f)},r.p="",r(r.s=42)})([(function(n,a,r){r.r(a),r.d(a,"__extends",function(){return f}),r.d(a,"__assign",function(){return h}),r.d(a,"__rest",function(){return g}),r.d(a,"__decorate",function(){return m}),r.d(a,"__param",function(){return _}),r.d(a,"__metadata",function(){return C}),r.d(a,"__awaiter",function(){return E}),r.d(a,"__generator",function(){return R}),r.d(a,"__createBinding",function(){return v}),r.d(a,"__exportStar",function(){return D}),r.d(a,"__values",function(){return B}),r.d(a,"__read",function(){return L}),r.d(a,"__spread",function(){return N}),r.d(a,"__spreadArrays",function(){return M}),r.d(a,"__spreadArray",function(){return G}),r.d(a,"__await",function(){return O}),r.d(a,"__asyncGenerator",function(){return w}),r.d(a,"__asyncDelegator",function(){return T}),r.d(a,"__asyncValues",function(){return y}),r.d(a,"__makeTemplateObject",function(){return z}),r.d(a,"__importStar",function(){return P}),r.d(a,"__importDefault",function(){return K}),r.d(a,"__classPrivateFieldGet",function(){return Q}),r.d(a,"__classPrivateFieldSet",function(){return X});/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */var o=function(Y,j){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var W in F)Object.prototype.hasOwnProperty.call(F,W)&&(I[W]=F[W])},o(Y,j)};function f(Y,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");o(Y,j);function I(){this.constructor=Y}Y.prototype=j===null?Object.create(j):(I.prototype=j.prototype,new I)}var h=function(){return h=Object.assign||function(j){for(var I,F=1,W=arguments.length;F<W;F++){I=arguments[F];for(var nt in I)Object.prototype.hasOwnProperty.call(I,nt)&&(j[nt]=I[nt])}return j},h.apply(this,arguments)};function g(Y,j){var I={};for(var F in Y)Object.prototype.hasOwnProperty.call(Y,F)&&j.indexOf(F)<0&&(I[F]=Y[F]);if(Y!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,F=Object.getOwnPropertySymbols(Y);W<F.length;W++)j.indexOf(F[W])<0&&Object.prototype.propertyIsEnumerable.call(Y,F[W])&&(I[F[W]]=Y[F[W]]);return I}function m(Y,j,I,F){var W=arguments.length,nt=W<3?j:F===null?F=Object.getOwnPropertyDescriptor(j,I):F,Z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(Y,j,I,F);else for(var it=Y.length-1;it>=0;it--)(Z=Y[it])&&(nt=(W<3?Z(nt):W>3?Z(j,I,nt):Z(j,I))||nt);return W>3&&nt&&Object.defineProperty(j,I,nt),nt}function _(Y,j){return function(I,F){j(I,F,Y)}}function C(Y,j){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Y,j)}function E(Y,j,I,F){function W(nt){return nt instanceof I?nt:new I(function(Z){Z(nt)})}return new(I||(I=Promise))(function(nt,Z){function it(J){try{V(F.next(J))}catch($){Z($)}}function rt(J){try{V(F.throw(J))}catch($){Z($)}}function V(J){J.done?nt(J.value):W(J.value).then(it,rt)}V((F=F.apply(Y,j||[])).next())})}function R(Y,j){var I={label:0,sent:function(){if(nt[0]&1)throw nt[1];return nt[1]},trys:[],ops:[]},F,W,nt,Z;return Z={next:it(0),throw:it(1),return:it(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function it(V){return function(J){return rt([V,J])}}function rt(V){if(F)throw new TypeError("Generator is already executing.");for(;I;)try{if(F=1,W&&(nt=V[0]&2?W.return:V[0]?W.throw||((nt=W.return)&&nt.call(W),0):W.next)&&!(nt=nt.call(W,V[1])).done)return nt;switch(W=0,nt&&(V=[V[0]&2,nt.value]),V[0]){case 0:case 1:nt=V;break;case 4:return I.label++,{value:V[1],done:!1};case 5:I.label++,W=V[1],V=[0];continue;case 7:V=I.ops.pop(),I.trys.pop();continue;default:if(nt=I.trys,!(nt=nt.length>0&&nt[nt.length-1])&&(V[0]===6||V[0]===2)){I=0;continue}if(V[0]===3&&(!nt||V[1]>nt[0]&&V[1]<nt[3])){I.label=V[1];break}if(V[0]===6&&I.label<nt[1]){I.label=nt[1],nt=V;break}if(nt&&I.label<nt[2]){I.label=nt[2],I.ops.push(V);break}nt[2]&&I.ops.pop(),I.trys.pop();continue}V=j.call(Y,I)}catch(J){V=[6,J],W=0}finally{F=nt=0}if(V[0]&5)throw V[1];return{value:V[0]?V[1]:void 0,done:!0}}}var v=Object.create?(function(Y,j,I,F){F===void 0&&(F=I),Object.defineProperty(Y,F,{enumerable:!0,get:function(){return j[I]}})}):(function(Y,j,I,F){F===void 0&&(F=I),Y[F]=j[I]});function D(Y,j){for(var I in Y)I!=="default"&&!Object.prototype.hasOwnProperty.call(j,I)&&v(j,Y,I)}function B(Y){var j=typeof Symbol=="function"&&Symbol.iterator,I=j&&Y[j],F=0;if(I)return I.call(Y);if(Y&&typeof Y.length=="number")return{next:function(){return Y&&F>=Y.length&&(Y=void 0),{value:Y&&Y[F++],done:!Y}}};throw new TypeError(j?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(Y,j){var I=typeof Symbol=="function"&&Y[Symbol.iterator];if(!I)return Y;var F=I.call(Y),W,nt=[],Z;try{for(;(j===void 0||j-- >0)&&!(W=F.next()).done;)nt.push(W.value)}catch(it){Z={error:it}}finally{try{W&&!W.done&&(I=F.return)&&I.call(F)}finally{if(Z)throw Z.error}}return nt}function N(){for(var Y=[],j=0;j<arguments.length;j++)Y=Y.concat(L(arguments[j]));return Y}function M(){for(var Y=0,j=0,I=arguments.length;j<I;j++)Y+=arguments[j].length;for(var F=Array(Y),W=0,j=0;j<I;j++)for(var nt=arguments[j],Z=0,it=nt.length;Z<it;Z++,W++)F[W]=nt[Z];return F}function G(Y,j,I){if(I||arguments.length===2)for(var F=0,W=j.length,nt;F<W;F++)(nt||!(F in j))&&(nt||(nt=Array.prototype.slice.call(j,0,F)),nt[F]=j[F]);return Y.concat(nt||Array.prototype.slice.call(j))}function O(Y){return this instanceof O?(this.v=Y,this):new O(Y)}function w(Y,j,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var F=I.apply(Y,j||[]),W,nt=[];return W={},Z("next"),Z("throw"),Z("return"),W[Symbol.asyncIterator]=function(){return this},W;function Z(at){F[at]&&(W[at]=function(ht){return new Promise(function(Rt,zt){nt.push([at,ht,Rt,zt])>1||it(at,ht)})})}function it(at,ht){try{rt(F[at](ht))}catch(Rt){$(nt[0][3],Rt)}}function rt(at){at.value instanceof O?Promise.resolve(at.value.v).then(V,J):$(nt[0][2],at)}function V(at){it("next",at)}function J(at){it("throw",at)}function $(at,ht){at(ht),nt.shift(),nt.length&&it(nt[0][0],nt[0][1])}}function T(Y){var j,I;return j={},F("next"),F("throw",function(W){throw W}),F("return"),j[Symbol.iterator]=function(){return this},j;function F(W,nt){j[W]=Y[W]?function(Z){return(I=!I)?{value:O(Y[W](Z)),done:W==="return"}:nt?nt(Z):Z}:nt}}function y(Y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var j=Y[Symbol.asyncIterator],I;return j?j.call(Y):(Y=typeof B=="function"?B(Y):Y[Symbol.iterator](),I={},F("next"),F("throw"),F("return"),I[Symbol.asyncIterator]=function(){return this},I);function F(nt){I[nt]=Y[nt]&&function(Z){return new Promise(function(it,rt){Z=Y[nt](Z),W(it,rt,Z.done,Z.value)})}}function W(nt,Z,it,rt){Promise.resolve(rt).then(function(V){nt({value:V,done:it})},Z)}}function z(Y,j){return Object.defineProperty?Object.defineProperty(Y,"raw",{value:j}):Y.raw=j,Y}var U=Object.create?(function(Y,j){Object.defineProperty(Y,"default",{enumerable:!0,value:j})}):function(Y,j){Y.default=j};function P(Y){if(Y&&Y.__esModule)return Y;var j={};if(Y!=null)for(var I in Y)I!=="default"&&Object.prototype.hasOwnProperty.call(Y,I)&&v(j,Y,I);return U(j,Y),j}function K(Y){return Y&&Y.__esModule?Y:{default:Y}}function Q(Y,j,I,F){if(I==="a"&&!F)throw new TypeError("Private accessor was defined without a getter");if(typeof j=="function"?Y!==j||!F:!j.has(Y))throw new TypeError("Cannot read private member from an object whose class did not declare it");return I==="m"?F:I==="a"?F.call(Y):F?F.value:j.get(Y)}function X(Y,j,I,F,W){if(F==="m")throw new TypeError("Private method is not writable");if(F==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof j=="function"?Y!==j||!W:!j.has(Y))throw new TypeError("Cannot write private member to an object whose class did not declare it");return F==="a"?W.call(Y,I):W?W.value=I:j.set(Y,I),I}}),(function(n,a,r){(function(o){Object.defineProperty(a,"__esModule",{value:!0}),a.allToUpperCase=a.allToLowerCase=a.encodeBody=a.decodeBody=a.Format=a.promisify=a.trim=a.arrChooseN=a.randomHexString=a.randomString=a.cheapRandStr=a.dataSizeBytes=a.inspectBody=a.inspectError=a.isErrorInfoOrPartialErrorInfo=a.now=a.parseQueryString=a.toQueryString=a.arrPopRandomElement=a.defaultPostHeaders=a.defaultGetHeaders=a.allSame=a.arrEvery=a.arrFilter=a.arrMap=a.safeArrForEach=a.arrForEach=a.forInOwnNonNullProperties=a.valuesArray=a.keysArray=a.arrWithoutValue=a.arrDeleteValue=a.arrIn=a.arrIndexOf=a.arrSubtract=a.arrIntersectOb=a.arrIntersect=a.intersect=a.containsValue=a.inherits=a.prototypicalClone=a.shallowClone=a.isEmptyArg=a.isOnlyPropIn=a.isEmpty=a.isObject=a.ensureArray=a.isArray=a.copy=a.mixin=void 0,a.arrEquals=a.toBase64=a.matchDerivedChannel=a.shallowEquals=a.getGlobalObject=a.getRetryTime=a.getJitterCoefficient=a.getBackoffCoefficient=void 0;var f=r(0),h=f.__importDefault(r(3)),g=f.__importStar(r(8)),m=f.__importDefault(r(4)),_=r(11),C=r(31);function E(ct){return Math.floor(Math.random()*ct.length)}function R(ct){for(var At=[],xt=1;xt<arguments.length;xt++)At[xt-1]=arguments[xt];for(var kt=0;kt<At.length;kt++){var le=At[kt];if(!le)break;var Lt=Object.prototype.hasOwnProperty;for(var vt in le)(!Lt||Lt.call(le,vt))&&(ct[vt]=le[vt])}return ct}a.mixin=R;function v(ct){return R({},ct)}a.copy=v,a.isArray=Array.isArray||function(ct){return Object.prototype.toString.call(ct)=="[object Array]"};function D(ct){return M(ct)?[]:(0,a.isArray)(ct)?ct:[ct]}a.ensureArray=D;function B(ct){return Object.prototype.toString.call(ct)=="[object Object]"}a.isObject=B;function L(ct){for(var At in ct)return!1;return!0}a.isEmpty=L;function N(ct,At){for(var xt in ct)if(xt!==At)return!1;return!0}a.isOnlyPropIn=N;function M(ct){return ct==null}a.isEmptyArg=M;function G(ct){var At=new Object;for(var xt in ct)At[xt]=ct[xt];return At}a.shallowClone=G;function O(ct,At){var xt=(function(){function le(){}return le})();xt.prototype=ct;var kt=new xt;return At&&R(kt,At),kt}a.prototypicalClone=O;var w=function(ct,At){if(h.default.Config.inherits){h.default.Config.inherits(ct,At);return}ct.super_=At,ct.prototype=O(At.prototype,{constructor:ct})};a.inherits=w;function T(ct,At){for(var xt in ct)if(ct[xt]==At)return!0;return!1}a.containsValue=T;function y(ct,At){return(0,a.isArray)(At)?z(ct,At):U(ct,At)}a.intersect=y;function z(ct,At){for(var xt=[],kt=0;kt<ct.length;kt++){var le=ct[kt];(0,a.arrIndexOf)(At,le)!=-1&&xt.push(le)}return xt}a.arrIntersect=z;function U(ct,At){for(var xt=[],kt=0;kt<ct.length;kt++){var le=ct[kt];le in At&&xt.push(le)}return xt}a.arrIntersectOb=U;function P(ct,At){for(var xt=[],kt=0;kt<ct.length;kt++){var le=ct[kt];(0,a.arrIndexOf)(At,le)==-1&&xt.push(le)}return xt}a.arrSubtract=P,a.arrIndexOf=Array.prototype.indexOf?function(ct,At,xt){return ct.indexOf(At,xt)}:function(ct,At,xt){xt=xt||0;for(var kt=ct.length;xt<kt;xt++)if(ct[xt]===At)return xt;return-1};function K(ct,At){return(0,a.arrIndexOf)(ct,At)!==-1}a.arrIn=K;function Q(ct,At){var xt=(0,a.arrIndexOf)(ct,At),kt=xt!=-1;return kt&&ct.splice(xt,1),kt}a.arrDeleteValue=Q;function X(ct,At){var xt=ct.slice();return Q(xt,At),xt}a.arrWithoutValue=X;function Y(ct,At){var xt=[];for(var kt in ct)At&&!Object.prototype.hasOwnProperty.call(ct,kt)||xt.push(kt);return xt}a.keysArray=Y;function j(ct,At){var xt=[];for(var kt in ct)At&&!Object.prototype.hasOwnProperty.call(ct,kt)||xt.push(ct[kt]);return xt}a.valuesArray=j;function I(ct,At){for(var xt in ct)Object.prototype.hasOwnProperty.call(ct,xt)&&ct[xt]&&At(xt)}a.forInOwnNonNullProperties=I,a.arrForEach=Array.prototype.forEach?function(ct,At){ct.forEach(At)}:function(ct,At){for(var xt=ct.length,kt=0;kt<xt;kt++)At(ct[kt],kt,ct)};function F(ct,At){return(0,a.arrForEach)(ct.slice(),At)}a.safeArrForEach=F,a.arrMap=Array.prototype.map?function(ct,At){return ct.map(At)}:function(ct,At){for(var xt=[],kt=ct.length,le=0;le<kt;le++)xt.push(At(ct[le],le,ct));return xt},a.arrFilter=Array.prototype.filter?function(ct,At){return ct.filter(At)}:function(ct,At){for(var xt=[],kt=ct.length,le=0;le<kt;le++)At(ct[le])&&xt.push(ct[le]);return xt},a.arrEvery=Array.prototype.every?function(ct,At){return ct.every(At)}:function(ct,At){for(var xt=ct.length,kt=0;kt<xt;kt++)if(!At(ct[kt],kt,ct))return!1;return!0};function W(ct,At){if(ct.length===0)return!0;var xt=ct[0][At];return(0,a.arrEvery)(ct,function(kt){return kt[At]===xt})}a.allSame=W;var nt={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function Z(ct,At){var xt=nt[At||Te.json];return{accept:xt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ct)}}a.defaultGetHeaders=Z;function it(ct,At){var xt,kt=xt=nt[At||Te.json];return{accept:kt,"content-type":xt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ct)}}a.defaultPostHeaders=it;function rt(ct){return ct.splice(E(ct),1)[0]}a.arrPopRandomElement=rt;function V(ct){var At=[];if(ct)for(var xt in ct)At.push(encodeURIComponent(xt)+"="+encodeURIComponent(ct[xt]));return At.length?"?"+At.join("&"):""}a.toQueryString=V;function J(ct){for(var At,xt=/([^?&=]+)=?([^&]*)/g,kt={};At=xt.exec(ct);)kt[decodeURIComponent(At[1])]=decodeURIComponent(At[2]);return kt}a.parseQueryString=J,a.now=Date.now||function(){return new Date().getTime()};function $(ct){return typeof ct=="object"&&ct!==null&&(ct.constructor.name=="ErrorInfo"||ct.constructor.name=="PartialErrorInfo")}a.isErrorInfoOrPartialErrorInfo=$;function at(ct){var At,xt;return ct instanceof Error||((At=ct==null?void 0:ct.constructor)===null||At===void 0?void 0:At.name)==="ErrorInfo"||((xt=ct==null?void 0:ct.constructor)===null||xt===void 0?void 0:xt.name)==="PartialErrorInfo"?ct.toString():h.default.Config.inspect(ct)}a.inspectError=at;function ht(ct){return h.default.BufferUtils.isBuffer(ct)?ct.toString():typeof ct=="string"?ct:h.default.Config.inspect(ct)}a.inspectBody=ht;function Rt(ct){if(h.default.BufferUtils.isBuffer(ct))return h.default.BufferUtils.byteLength(ct);if(typeof ct=="string")return h.default.Config.stringByteSize(ct);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof ct)}a.dataSizeBytes=Rt;function zt(){return String(Math.random()).substr(2)}a.cheapRandStr=zt;var Wt=function(ct){if(h.default.Config.getRandomValues&&typeof Uint8Array<"u"){var At=new Uint8Array(ct);return h.default.Config.getRandomValues(At),h.default.BufferUtils.base64Encode(At)}for(var xt=h.default.BufferUtils.base64CharSet,kt=Math.round(ct*4/3),le="",Lt=0;Lt<kt;Lt++)le+=xt[E(xt)];return le};a.randomString=Wt;var It=function(ct){if(h.default.Config.getRandomValues&&typeof Uint8Array<"u"){var At=new Uint8Array(ct);return h.default.Config.getRandomValues(At),h.default.BufferUtils.hexEncode(At)}for(var xt=h.default.BufferUtils.hexCharSet,kt=ct*2,le="",Lt=0;Lt<kt;Lt++)le+=xt[E(xt)];return le};a.randomHexString=It;function pe(ct,At){for(var xt=Math.min(At,ct.length),kt=ct.slice(),le=[],Lt=0;Lt<xt;Lt++)le.push(rt(kt));return le}a.arrChooseN=pe,a.trim=String.prototype.trim?function(ct){return ct.trim()}:function(ct){return ct.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function Bt(ct,At,xt){return new Promise(function(kt,le){ct[At].apply(ct,f.__spreadArray(f.__spreadArray([],xt,!1),[function(Lt,vt){Lt?le(Lt):kt(vt)}],!1))})}a.promisify=Bt;var Te;(function(ct){ct.msgpack="msgpack",ct.json="json"})(Te=a.Format||(a.Format={}));function ze(ct,At){return At=="msgpack"?h.default.Config.msgpack.decode(ct):JSON.parse(String(ct))}a.decodeBody=ze;function Xe(ct,At){return At=="msgpack"?h.default.Config.msgpack.encode(ct,!0):JSON.stringify(ct)}a.encodeBody=Xe;function ke(ct){return ct.map(function(At){return At&&At.toLowerCase()})}a.allToLowerCase=ke;function hn(ct){return ct.map(function(At){return At&&At.toUpperCase()})}a.allToUpperCase=hn;function Un(ct){return Math.min((ct+2)/3,2)}a.getBackoffCoefficient=Un;function wt(){return 1-Math.random()*.2}a.getJitterCoefficient=wt;function Yt(ct,At){return ct*Un(At)*wt()}a.getRetryTime=Yt;function Fe(){return o||(typeof window<"u"?window:self)}a.getGlobalObject=Fe;function Se(ct,At){return Object.keys(ct).every(function(xt){return ct[xt]===At[xt]})&&Object.keys(At).every(function(xt){return At[xt]===ct[xt]})}a.shallowEquals=Se;function we(ct){var At=/^(\[([^?]*)(?:(.*))\])?(.+)$/,xt=ct.match(At);if(!xt||!xt.length||xt.length<5)throw new m.default("regex match failed",400,40010);if(xt[2])throw new m.default("cannot use a derived option with a ".concat(xt[2]," channel"),400,40010);return{qualifierParam:xt[3]||"",channelName:xt[4]}}a.matchDerivedChannel=we;function $e(ct){return h.default.Config.createHmac?Buffer.from(ct,"ascii").toString("base64"):(0,_.stringify)((0,C.parse)(ct))}a.toBase64=$e;function Ae(ct,At){return ct.length===At.length&&(0,a.arrEvery)(ct,function(xt,kt){return xt===At[kt]})}a.arrEquals=Ae}).call(this,r(13))}),(function(n,a,r){(function(o){Object.defineProperty(a,"__esModule",{value:!0});var f=r(0),h=f.__importDefault(r(3)),g=o||(typeof window<"u"?window:self),m;(function(v){v[v.None=0]="None",v[v.Error=1]="Error",v[v.Major=2]="Major",v[v.Minor=3]="Minor",v[v.Micro=4]="Micro"})(m||(m={}));function _(v,D){return"".concat(v).padStart(D?3:2,"0")}function C(v){return h.default.Config.logTimestamps?function(D){var B=new Date;v(_(B.getHours())+":"+_(B.getMinutes())+":"+_(B.getSeconds())+"."+_(B.getMilliseconds(),1)+" "+D)}:v}var E=function(){var v,D,B,L;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((D=(v=g==null?void 0:g.console)===null||v===void 0?void 0:v.log)===null||D===void 0?void 0:D.apply)=="function"?(B=function(){for(var N=[],M=0;M<arguments.length;M++)N[M]=arguments[M];console.log.apply(console,N)},L=console.warn?function(){for(var N=[],M=0;M<arguments.length;M++)N[M]=arguments[M];console.warn.apply(console,N)}:B):g!=null&&g.console.log?B=L=function(){Function.prototype.apply.call(console.log,console,arguments)}:B=L=function(){},[B,L].map(C)},R=(function(){function v(){v.logLevel=v.LOG_DEFAULT}return v.initLogHandlers=function(){var D=E(),B=D[0],L=D[1];this.logHandler=B,this.logErrorHandler=L},v.renamedClientOption=function(D,B){v.deprecationWarning("The `".concat(D,"` client option has been renamed to `").concat(B,"`. Please update your code to use `").concat(B,"` instead. `").concat(D,"` will be removed in a future version."))},v.renamedMethod=function(D,B,L){v.deprecationWarning("`".concat(D,"`’s `").concat(B,"` method has been renamed to `").concat(L,"`. Please update your code to use `").concat(L,"` instead. `").concat(B,"` will be removed in a future version."))},v.deprecationWarning=function(D){v.shouldLog(m.Error)&&v.logErrorHandler("Ably: Deprecation warning - ".concat(D))},v.logLevel=m.Error,v.LOG_NONE=m.None,v.LOG_ERROR=m.Error,v.LOG_MAJOR=m.Major,v.LOG_MINOR=m.Minor,v.LOG_MICRO=m.Micro,v.LOG_DEFAULT=m.Error,v.LOG_DEBUG=m.Micro,v.logAction=function(D,B,L){v.shouldLog(D)&&(D===m.Error?v.logErrorHandler:v.logHandler)("Ably: "+B+": "+L)},v.deprecated=function(D,B){v.deprecationWarning("".concat(D," is deprecated and will be removed in a future version. ").concat(B))},v.shouldLog=function(D){return D<=v.logLevel},v.setLog=function(D,B){D!==void 0&&(v.logLevel=D),B!==void 0&&(v.logHandler=v.logErrorHandler=B)},v})();a.default=R}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=(function(){function f(){}return f})();a.default=o}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.PartialErrorInfo=void 0;var o=r(0),f=o.__importDefault(r(3)),h=o.__importStar(r(1));function g(C){var E="["+C.constructor.name;return C.message&&(E+=": "+C.message),C.statusCode&&(E+="; statusCode="+C.statusCode),C.code&&(E+="; code="+C.code),C.cause&&(E+="; cause="+h.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(E+="; see "+C.href+" "),E+="]",E}var m=(function(C){o.__extends(E,C);function E(R,v,D,B){var L=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(L,E.prototype),L.code=v,L.statusCode=D,L.cause=B,L}return E.prototype.toString=function(){return g(this)},E.fromValues=function(R){var v=R,D=v.message,B=v.code,L=v.statusCode;if(typeof D!="string"||typeof B!="number"||typeof L!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+f.default.Config.inspect(R));var N=Object.assign(new E(D,B,L),R);return N.code&&!N.href&&(N.href="https://help.ably.io/error/"+N.code),N},E})(Error);a.default=m;var _=(function(C){o.__extends(E,C);function E(R,v,D,B){var L=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(L,E.prototype),L.code=v,L.statusCode=D,L.cause=B,L}return E.prototype.toString=function(){return g(this)},E})(Error);a.PartialErrorInfo=_}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(){if(typeof ArrayBuffer=="function"){var f=o,h=f.lib,g=h.WordArray,m=g.init,_=g.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var E=C.byteLength,R=[],v=0;v<E;v++)R[v>>>2]|=C[v]<<24-v%4*8;m.call(this,R,E)}else m.apply(this,arguments)};_.prototype=g}})(),o.lib.WordArray})}),(function(n,a,r){(function(o){(function(f,h){n.exports=h()})(this,function(){var f=f||(function(h,g){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof o<"u"&&o.crypto&&(m=o.crypto),!m)try{m=r(44)}catch{}var _=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||(function(){function w(){}return function(T){var y;return w.prototype=T,y=new w,w.prototype=null,y}})(),E={},R=E.lib={},v=R.Base=(function(){return{extend:function(w){var T=C(this);return w&&T.mixIn(w),(!T.hasOwnProperty("init")||this.init===T.init)&&(T.init=function(){T.$super.init.apply(this,arguments)}),T.init.prototype=T,T.$super=this,T},create:function(){var w=this.extend();return w.init.apply(w,arguments),w},init:function(){},mixIn:function(w){for(var T in w)w.hasOwnProperty(T)&&(this[T]=w[T]);w.hasOwnProperty("toString")&&(this.toString=w.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),D=R.WordArray=v.extend({init:function(w,T){w=this.words=w||[],T!=g?this.sigBytes=T:this.sigBytes=w.length*4},toString:function(w){return(w||L).stringify(this)},concat:function(w){var T=this.words,y=w.words,z=this.sigBytes,U=w.sigBytes;if(this.clamp(),z%4)for(var P=0;P<U;P++){var K=y[P>>>2]>>>24-P%4*8&255;T[z+P>>>2]|=K<<24-(z+P)%4*8}else for(var P=0;P<U;P+=4)T[z+P>>>2]=y[P>>>2];return this.sigBytes+=U,this},clamp:function(){var w=this.words,T=this.sigBytes;w[T>>>2]&=4294967295<<32-T%4*8,w.length=h.ceil(T/4)},clone:function(){var w=v.clone.call(this);return w.words=this.words.slice(0),w},random:function(w){for(var T=[],y=0;y<w;y+=4)T.push(_());return new D.init(T,w)}}),B=E.enc={},L=B.Hex={stringify:function(w){for(var T=w.words,y=w.sigBytes,z=[],U=0;U<y;U++){var P=T[U>>>2]>>>24-U%4*8&255;z.push((P>>>4).toString(16)),z.push((P&15).toString(16))}return z.join("")},parse:function(w){for(var T=w.length,y=[],z=0;z<T;z+=2)y[z>>>3]|=parseInt(w.substr(z,2),16)<<24-z%8*4;return new D.init(y,T/2)}},N=B.Latin1={stringify:function(w){for(var T=w.words,y=w.sigBytes,z=[],U=0;U<y;U++){var P=T[U>>>2]>>>24-U%4*8&255;z.push(String.fromCharCode(P))}return z.join("")},parse:function(w){for(var T=w.length,y=[],z=0;z<T;z++)y[z>>>2]|=(w.charCodeAt(z)&255)<<24-z%4*8;return new D.init(y,T)}},M=B.Utf8={stringify:function(w){try{return decodeURIComponent(escape(N.stringify(w)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(w){return N.parse(unescape(encodeURIComponent(w)))}},G=R.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new D.init,this._nDataBytes=0},_append:function(w){typeof w=="string"&&(w=M.parse(w)),this._data.concat(w),this._nDataBytes+=w.sigBytes},_process:function(w){var T,y=this._data,z=y.words,U=y.sigBytes,P=this.blockSize,K=P*4,Q=U/K;w?Q=h.ceil(Q):Q=h.max((Q|0)-this._minBufferSize,0);var X=Q*P,Y=h.min(X*4,U);if(X){for(var j=0;j<X;j+=P)this._doProcessBlock(z,j);T=z.splice(0,X),y.sigBytes-=Y}return new D.init(T,Y)},clone:function(){var w=v.clone.call(this);return w._data=this._data.clone(),w},_minBufferSize:0});R.Hasher=G.extend({cfg:v.extend(),init:function(w){this.cfg=this.cfg.extend(w),this.reset()},reset:function(){G.reset.call(this),this._doReset()},update:function(w){return this._append(w),this._process(),this},finalize:function(w){w&&this._append(w);var T=this._doFinalize();return T},blockSize:16,_createHelper:function(w){return function(T,y){return new w.init(y).finalize(T)}},_createHmacHelper:function(w){return function(T,y){return new O.HMAC.init(w,y).finalize(T)}}});var O=E.algo={};return E})(Math);return f})}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(2)),g=o.__importDefault(r(3));function m(E,R,v){try{R.apply(E,v)}catch(D){h.default.logAction(h.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+D+"; stack = "+(D&&D.stack))}}function _(E,R,v){for(var D,B,L,N=0;N<E.length;N++)if(D=E[N],v&&(D=D[v]),f.isArray(D)){for(;(B=f.arrIndexOf(D,R))!==-1;)D.splice(B,1);v&&D.length===0&&delete E[N][v]}else if(f.isObject(D))for(L in D)Object.prototype.hasOwnProperty.call(D,L)&&f.isArray(D[L])&&_([D],R,L)}var C=(function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var R=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];if(v.length===1){var B=v[0];if(typeof B=="function")this.any.push(B);else throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v))}if(v.length===2){var L=v[0],N=v[1];if(typeof N!="function")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));if(f.isEmptyArg(L))this.any.push(N);else if(f.isArray(L))L.forEach(function(G){R.on(G,N)});else{if(typeof L!="string")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));var M=this.events[L]||(this.events[L]=[]);M.push(N)}}},E.prototype.off=function(){for(var R,v=this,D=[],B=0;B<arguments.length;B++)D[B]=arguments[B];if(D.length==0||f.isEmptyArg(D[0])&&f.isEmptyArg(D[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var L=D[0],N=D[1],M=null,G=null;if(D.length===1||!N)typeof L=="function"?M=L:G=L;else{if(typeof N!="function")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));R=[L,N],G=R[0],M=R[1]}if(M&&f.isEmptyArg(G)){_([this.any,this.events,this.anyOnce,this.eventsOnce],M);return}if(f.isArray(G)){G.forEach(function(O){v.off(O,M)});return}if(typeof G!="string")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));M?_([this.events,this.eventsOnce],M,G):(delete this.events[G],delete this.eventsOnce[G])},E.prototype.listeners=function(R){if(R){var v=this.events[R]||[];return this.eventsOnce[R]&&Array.prototype.push.apply(v,this.eventsOnce[R]),v.length?v:null}return this.any.length?this.any:null},E.prototype.emit=function(R){for(var v=[],D=1;D<arguments.length;D++)v[D-1]=arguments[D];var B={event:R},L=[];this.anyOnce.length&&(Array.prototype.push.apply(L,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(L,this.any);var N=this.eventsOnce[R];N&&(Array.prototype.push.apply(L,N),delete this.eventsOnce[R]);var M=this.events[R];M&&Array.prototype.push.apply(L,M),f.arrForEach(L,function(G){m(B,G,v)})},E.prototype.once=function(){for(var R=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];var B=v.length;if((B===0||B===1&&typeof v[0]!="function")&&g.default.Config.Promise){var L=v[0];return new g.default.Config.Promise(function(T){R.once(L,T)})}var N=v[0],M=v[1];if(v.length===1&&typeof N=="function")this.anyOnce.push(N);else if(f.isEmptyArg(N)){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));this.anyOnce.push(M)}else if(f.isArray(N)){var G=this,O=function(){var T=Array.prototype.slice.call(arguments);if(f.arrForEach(N,function(y){G.off(y,O)}),typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));M.apply(this,T)};f.arrForEach(N,function(T){G.on(T,O)})}else{if(typeof N!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));var w=this.eventsOnce[N]||(this.eventsOnce[N]=[]);if(M){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));w.push(M)}}},E.prototype.whenState=function(R,v,D){for(var B=this,L=[],N=3;N<arguments.length;N++)L[N-3]=arguments[N];var M={event:R};if(typeof R!="string"||typeof v!="string")throw"whenState requires a valid event String argument";if(typeof D!="function"&&g.default.Config.Promise)return new g.default.Config.Promise(function(G){E.prototype.whenState.apply(B,[R,v,G].concat(L))});R===v?m(M,D,L):this.once(R,D)},E})();a.default=C}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.getDefaults=a.normaliseOptions=a.objectifyOptions=a.getAgentString=a.getHosts=a.getFallbackHosts=a.environmentFallbackHosts=a.getHttpScheme=a.getPort=a.getHost=void 0;var o=r(0),f=o.__importDefault(r(3)),h=o.__importStar(r(1)),g=o.__importDefault(r(2)),m=o.__importDefault(r(4)),_=r(43),C="ably-js/"+_.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:_.version,protocolVersion:2,agent:C,getHost:R,getPort:v,getHttpScheme:D,environmentFallbackHosts:B,getFallbackHosts:L,getHosts:N,checkHost:M,objectifyOptions:T,normaliseOptions:y};function R(U,P,K){return K?P=P==U.restHost&&U.realtimeHost||P||U.realtimeHost:P=P||U.restHost,P}a.getHost=R;function v(U,P){return P||U.tls?U.tlsPort:U.port}a.getPort=v;function D(U){return U.tls?"https://":"http://"}a.getHttpScheme=D;function B(U){return[U+"-a-fallback.ably-realtime.com",U+"-b-fallback.ably-realtime.com",U+"-c-fallback.ably-realtime.com",U+"-d-fallback.ably-realtime.com",U+"-e-fallback.ably-realtime.com"]}a.environmentFallbackHosts=B;function L(U){var P=U.fallbackHosts,K=typeof U.httpMaxRetryCount<"u"?U.httpMaxRetryCount:E.httpMaxRetryCount;return P?h.arrChooseN(P,K):[]}a.getFallbackHosts=L;function N(U){return[U.restHost].concat(L(U))}a.getHosts=N;function M(U){if(typeof U!="string")throw new m.default("host must be a string; was a "+typeof U,4e4,400);if(!U.length)throw new m.default("host must not be zero-length",4e4,400)}function G(U,P,K){return U.realtimeHost?U.realtimeHost:U.restHost?(g.default.logAction(g.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+U.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+U.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),U.restHost):P?E.REALTIME_HOST:K+"-"+E.REALTIME_HOST}function O(U){var P={};for(var K in E.TIMEOUTS)P[K]=U[K]||E.TIMEOUTS[K];return P}function w(U){var P=E.agent;if(U.agents)for(var K in U.agents)P+=" "+K+"/"+U.agents[K];return P}a.getAgentString=w;function T(U){return typeof U=="string"?U.indexOf(":")==-1?{token:U}:{key:U}:U}a.objectifyOptions=T;function y(U){if(U.host&&(g.default.renamedClientOption("host","restHost"),U.restHost=U.host),U.wsHost&&(g.default.renamedClientOption("wsHost","realtimeHost"),U.realtimeHost=U.wsHost),U.queueEvents&&(g.default.renamedClientOption("queueEvents","queueMessages"),U.queueMessages=U.queueEvents),U.headers&&g.default.deprecated("the `headers` client option",""),U.fallbackHostsUseDefault){if(U.fallbackHosts){var P="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}if(U.port||U.tlsPort){var P="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}U.environment?g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),U.fallbackHosts=E.FALLBACK_HOSTS}U.recover===!0&&(g.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),U.recover=function(rt,V){V(!0)}),typeof U.recover=="function"&&U.closeOnUnload===!0&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),U.recover=void 0),"closeOnUnload"in U||(U.closeOnUnload=!U.recover),U.transports&&h.arrIn(U.transports,"xhr")&&(g.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),h.arrDeleteValue(U.transports,"xhr"),U.transports.push("xhr_streaming")),"queueMessages"in U||(U.queueMessages=!0);var K=U.environment&&String(U.environment).toLowerCase()||E.ENVIRONMENT,Q=!K||K==="production";!U.fallbackHosts&&!U.restHost&&!U.realtimeHost&&!U.port&&!U.tlsPort&&(U.fallbackHosts=Q?E.FALLBACK_HOSTS:B(K));var X=U.restHost||(Q?E.REST_HOST:K+"-"+E.REST_HOST),Y=G(U,Q,K);h.arrForEach((U.fallbackHosts||[]).concat(X,Y),M),U.port=U.port||E.PORT,U.tlsPort=U.tlsPort||E.TLS_PORT,"tls"in U||(U.tls=!0);var j=O(U);if("useBinaryProtocol"in U?U.useBinaryProtocol=f.default.Config.supportsBinary&&U.useBinaryProtocol:U.useBinaryProtocol=f.default.Config.preferBinary,U.clientId){var I=U.headers=U.headers||{};I["X-Ably-ClientId"]=f.default.BufferUtils.base64Encode(f.default.BufferUtils.utf8Encode(U.clientId))}"idempotentRestPublishing"in U||(U.idempotentRestPublishing=!0),U.promises&&!f.default.Config.Promise&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),U.promises=!1);var F=null,W=U.connectivityCheckUrl;if(U.connectivityCheckUrl){var nt=U.connectivityCheckUrl.split("?"),Z=nt[0],it=nt[1];F=it?h.parseQueryString(it):{},Z.indexOf("://")===-1&&(Z="https://"+Z),W=Z}return o.__assign(o.__assign({},U),{useBinaryProtocol:"useBinaryProtocol"in U?f.default.Config.supportsBinary&&U.useBinaryProtocol:f.default.Config.preferBinary,realtimeHost:Y,restHost:X,maxMessageSize:U.maxMessageSize||E.maxMessageSize,timeouts:j,connectivityCheckParams:F,connectivityCheckUrl:W})}a.normaliseOptions=y,a.default=E;function z(U){return Object.assign(E,U)}a.getDefaults=z}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(3)),h=o.__importDefault(r(2)),g=o.__importDefault(r(4)),m=o.__importStar(r(1));function _(v){return!v||!v.channelOptions?{channelOptions:v,plugins:{},baseEncodedPreviousPayload:void 0}:v}function C(v){if(v&&v.cipher){if(!f.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var D=f.default.Crypto.getCipher(v.cipher);return{cipher:D.cipherParams,channelCipher:D.cipher}}return v??{}}function E(v){var D=0;return v.name&&(D+=v.name.length),v.clientId&&(D+=v.clientId.length),v.extras&&(D+=JSON.stringify(v.extras).length),v.data&&(D+=m.dataSizeBytes(v.data)),D}var R=(function(){function v(){}return v.prototype.toJSON=function(){var D=this.encoding,B=this.data;return B&&f.default.BufferUtils.isBuffer(B)&&(arguments.length>0?(D=D?D+"/base64":"base64",B=f.default.BufferUtils.base64Encode(B)):B=f.default.BufferUtils.toBuffer(B)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:D,data:B}},v.prototype.toString=function(){var D="[Message";return this.name&&(D+="; name="+this.name),this.id&&(D+="; id="+this.id),this.timestamp&&(D+="; timestamp="+this.timestamp),this.clientId&&(D+="; clientId="+this.clientId),this.connectionId&&(D+="; connectionId="+this.connectionId),this.encoding&&(D+="; encoding="+this.encoding),this.extras&&(D+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?D+="; data="+this.data:f.default.BufferUtils.isBuffer(this.data)?D+="; data (buffer)="+f.default.BufferUtils.base64Encode(this.data):D+="; data (json)="+JSON.stringify(this.data)),this.extras&&(D+="; extras="+JSON.stringify(this.extras)),D+="]",D},v.encrypt=function(D,B,L){var N=D.data,M=D.encoding,G=B.channelCipher;M=M?M+"/":"",f.default.BufferUtils.isBuffer(N)||(N=f.default.BufferUtils.utf8Encode(String(N)),M=M+"utf-8/"),G.encrypt(N,function(O,w){if(O){L(O);return}D.data=w,D.encoding=M+"cipher+"+G.algorithm,L(null,D)})},v.encode=function(D,B,L){var N=D.data,M=typeof N=="string"||f.default.BufferUtils.isBuffer(N)||N===null||N===void 0;if(!M)if(m.isObject(N)||m.isArray(N))D.data=JSON.stringify(N),D.encoding=D.encoding?D.encoding+"/json":"json";else throw new g.default("Data type is unsupported",40013,400);B!=null&&B.cipher?v.encrypt(D,B,L):L(null,D)},v.encodeArray=function(D,B,L){for(var N=0,M=0;M<D.length;M++)v.encode(D[M],B,function(G){if(G){L(G);return}N++,N==D.length&&L(null,D)})},v.decode=function(D,B){var L=_(B),N=D.data,M=D.encoding;if(M){var G=M.split("/"),O=void 0,w=G.length,T=D.data,y="";try{for(;(O=w)>0;){var z=G[--w].match(/([-\w]+)(\+([\w-]+))?/);if(!z)break;switch(y=z[1],y){case"base64":T=f.default.BufferUtils.base64Decode(String(T)),O==G.length&&(N=T);continue;case"utf-8":T=f.default.BufferUtils.utf8Decode(T);continue;case"json":T=JSON.parse(T);continue;case"cipher":if(L.channelOptions!=null&&L.channelOptions.cipher&&L.channelOptions.channelCipher){var U=z[3],P=L.channelOptions.channelCipher;if(U!=P.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");T=P.decrypt(T);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!L.plugins||!L.plugins.vcdiff)throw new g.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new g.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var K=L.baseEncodedPreviousPayload;typeof K=="string"&&(K=f.default.BufferUtils.utf8Encode(K)),K=f.default.BufferUtils.toBuffer(K),T=f.default.BufferUtils.toBuffer(T),T=f.default.BufferUtils.typedArrayToBuffer(L.plugins.vcdiff.decode(T,K)),N=T}catch(X){throw new g.default("Vcdiff delta decode failed with "+X,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(X){var Q=X;throw new g.default("Error processing the "+y+" encoding, decoder returned ‘"+Q.message+"’",Q.code||40013,400)}finally{D.encoding=O<=0?null:G.slice(0,O).join("/"),D.data=T}}L.baseEncodedPreviousPayload=N},v.fromResponseBody=function(D,B,L){L&&(D=m.decodeBody(D,L));for(var N=0;N<D.length;N++){var M=D[N]=v.fromValues(D[N]);try{v.decode(M,B)}catch(G){h.default.logAction(h.default.LOG_ERROR,"Message.fromResponseBody()",G.toString())}}return D},v.fromValues=function(D){return Object.assign(new v,D)},v.fromValuesArray=function(D){for(var B=D.length,L=new Array(B),N=0;N<B;N++)L[N]=v.fromValues(D[N]);return L},v.fromEncoded=function(D,B){var L=v.fromValues(D),N=C(B??null);try{v.decode(L,N)}catch(M){h.default.logAction(h.default.LOG_ERROR,"Message.fromEncoded()",M.toString())}return L},v.fromEncodedArray=function(D,B){return D.map(function(L){return v.fromEncoded(L,B)})},v.getMessagesSize=function(D){for(var B,L=0,N=0;N<D.length;N++)B=D[N],L+=B.size||(B.size=E(B));return L},v.serialize=m.encodeBody,v})();a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(4)),g=o.__importDefault(r(9)),m=o.__importDefault(r(16)),_={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(_).forEach(function(L){C[_[L]]=L});var E={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},R=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function v(L){var N=[];if(L)for(var M=0;M<L.length;M++)N.push(L[M].toString());return"[ "+N.join(", ")+" ]"}var D="id channel channelSerial connectionId count msgSerial timestamp".split(" "),B=(function(){function L(){var N=this;this.hasFlag=function(M){return(N.flags&E[M])>0}}return L.prototype.setFlag=function(N){return this.flags=this.flags|E[N]},L.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},L.prototype.encodeModesToFlags=function(N){var M=this;N.forEach(function(G){return M.setFlag(G)})},L.prototype.decodeModesFromFlags=function(){var N=this,M=[];return L.channelModes.forEach(function(G){N.hasFlag(G)&&M.push(G)}),M.length>0?M:void 0},L.fromValues=function(N){return Object.assign(new L,N)},L.Action=_,L.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],L.ActionName=C,L.serialize=f.encodeBody,L.deserialize=function(N,M){var G=f.decodeBody(N,M);return L.fromDeserialized(G)},L.fromDeserialized=function(N){var M=N.error;M&&(N.error=h.default.fromValues(M));var G=N.messages;if(G)for(var O=0;O<G.length;O++)G[O]=g.default.fromValues(G[O]);var w=N.presence;if(w)for(var O=0;O<w.length;O++)w[O]=m.default.fromValues(w[O],!0);return Object.assign(new L,N)},L.stringify=function(N){var M="[ProtocolMessage";N.action!==void 0&&(M+="; action="+L.ActionName[N.action]||!1);for(var G,O=0;O<D.length;O++)G=D[O],N[G]!==void 0&&(M+="; "+G+"="+N[G]);if(N.messages&&(M+="; messages="+v(g.default.fromValuesArray(N.messages))),N.presence&&(M+="; presence="+v(m.default.fromValuesArray(N.presence))),N.error&&(M+="; error="+h.default.fromValues(N.error).toString()),N.auth&&N.auth.accessToken&&(M+="; token="+N.auth.accessToken),N.flags&&(M+="; flags="+R.filter(N.hasFlag).join(",")),N.params){var w="";f.forInOwnNonNullProperties(N.params,function(T){w.length>0&&(w+="; "),w+=T+"="+N.params[T]}),w.length>0&&(M+="; params=["+w+"]")}return M+="]",M},L})();a.default=B}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.WordArray,m=f.enc;m.Base64={stringify:function(C){var E=C.words,R=C.sigBytes,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var D=[],B=0;B<R;B+=3)for(var L=E[B>>>2]>>>24-B%4*8&255,N=E[B+1>>>2]>>>24-(B+1)%4*8&255,M=E[B+2>>>2]>>>24-(B+2)%4*8&255,G=L<<16|N<<8|M,O=0;O<4&&B+O*.75<R;O++)D.push(v.charAt(G>>>6*(3-O)&63));var w=v.charAt(64);if(w)for(;D.length%4;)D.push(w);return D.join("")},parse:function(C){var E=C.length,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var D=0;D<R.length;D++)v[R.charCodeAt(D)]=D}var B=R.charAt(64);if(B){var L=C.indexOf(B);L!==-1&&(E=L)}return _(C,E,v)}};function _(C,E,R){for(var v=[],D=0,B=0;B<E;B++)if(B%4){var L=R[C.charCodeAt(B-1)]<<B%4*2,N=R[C.charCodeAt(B)]>>>6-B%4*2,M=L|N;v[D>>>2]|=M<<24-D%4*8,D++}return g.create(v,D)}})(),o.enc.Base64})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(10)),g=o.__importDefault(r(26)),m=o.__importDefault(r(2)),_=o.__importDefault(r(8)),C=o.__importDefault(r(21)),E=o.__importDefault(r(18)),R=o.__importDefault(r(4)),v=o.__importDefault(r(22)),D=o.__importDefault(r(3));function B(M){var G=[80015,80017,80030];return M.code?E.default.isTokenErr(M)?!1:f.arrIn(G,M.code)?!0:M.code>=4e4&&M.code<5e4:!1}function L(M){return B(M)?[h.default.fromValues({action:h.default.Action.ERROR,error:M})]:[h.default.fromValues({action:h.default.Action.DISCONNECTED,error:M})]}var N=(function(M){o.__extends(G,M);function G(O,w,T){var y=M.call(this,O,w,T,!0)||this;return y.onAuthUpdated=function(z){y.authParams={access_token:z.token}},y.stream="stream"in T?T.stream:!0,y.sendRequest=null,y.recvRequest=null,y.pendingCallback=null,y.pendingItems=null,y}return G.prototype.connect=function(){var O=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","starting"),g.default.prototype.connect.call(this);var w=this.params,T=w.options,y=_.default.getHost(T,w.host),z=_.default.getPort(T),U=T.tls?"https://":"http://";this.baseUri=U+y+":"+z+"/comet/";var P=this.baseUri+"connect";m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","uri: "+P),this.auth.getAuthParams(function(K,Q){if(K){O.disconnect(K);return}if(!O.isDisposed){O.authParams=Q;var X=O.params.getConnectParams(Q);"stream"in X&&(O.stream=X.stream),m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+f.toQueryString(X));var Y=!1,j=O.recvRequest=O.createRequest(P,null,X,null,O.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV);j.on("data",function(I){O.recvRequest&&(Y||(Y=!0,O.emit("preconnect")),O.onData(I))}),j.on("complete",function(I){if(O.recvRequest||(I=I||new R.default("Request cancelled",80003,400)),O.recvRequest=null,!Y&&!I&&(Y=!0,O.emit("preconnect")),O.onActivity(),I){I.code?O.onData(L(I)):O.disconnect(I);return}D.default.Config.nextTick(function(){O.recv()})}),j.exec()}})},G.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},G.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},G.prototype._requestCloseOrDisconnect=function(O){var w=this,T=O?this.closeUri:this.disconnectUri;if(T){var y=this.createRequest(T,null,this.authParams,null,v.default.REQ_SEND);y.on("complete",function(z){z&&(m.default.logAction(m.default.LOG_ERROR,"CometTransport.request"+(O?"Close()":"Disconnect()"),"request returned err = "+f.inspectError(z)),w.finish("disconnected",z))}),y.exec()}},G.prototype.dispose=function(){var O=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),D.default.Config.nextTick(function(){O.emit("disposed")}))},G.prototype.onConnect=function(O){var w;if(!this.isDisposed){var T=(w=O.connectionDetails)===null||w===void 0?void 0:w.connectionKey;g.default.prototype.onConnect.call(this,O);var y=this.baseUri+T;m.default.logAction(m.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+y),this.sendUri=y+"/send",this.recvUri=y+"/recv",this.closeUri=y+"/close",this.disconnectUri=y+"/disconnect"}},G.prototype.send=function(O){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(O);return}var w=this.pendingItems||[];w.push(O),this.pendingItems=null,this.sendItems(w)},G.prototype.sendAnyPending=function(){var O=this.pendingItems;O&&(this.pendingItems=null,this.sendItems(O))},G.prototype.sendItems=function(O){var w=this,T=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(O),v.default.REQ_SEND);T.on("complete",function(y,z){if(y&&m.default.logAction(m.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+f.inspectError(y)),w.sendRequest=null,y){y.code?w.onData(L(y)):w.disconnect(y);return}z&&w.onData(z),w.pendingItems&&D.default.Config.nextTick(function(){w.sendRequest||w.sendAnyPending()})}),T.exec()},G.prototype.recv=function(){var O=this;if(!this.recvRequest&&this.isConnected){var w=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV_POLL);w.on("data",function(T){O.onData(T)}),w.on("complete",function(T){if(O.recvRequest=null,O.onActivity(),T){T.code?O.onData(L(T)):O.disconnect(T);return}D.default.Config.nextTick(function(){O.recv()})}),w.exec()}},G.prototype.onData=function(O){try{var w=this.decodeResponse(O);if(w&&w.length)for(var T=0;T<w.length;T++)this.onProtocolMessage(h.default.fromDeserialized(w[T]))}catch(y){m.default.logAction(m.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+y.stack)}},G.prototype.encodeRequest=function(O){return JSON.stringify(O)},G.prototype.decodeResponse=function(O){return typeof O=="string"?JSON.parse(O):O},G})(g.default);a.default=N}),(function(n,a){var r;r=(function(){return this})();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.isSuccessCode=void 0;var o;(function(h){h[h.Success=200]="Success",h[h.NoContent=204]="NoContent",h[h.BadRequest=400]="BadRequest",h[h.Unauthorized=401]="Unauthorized",h[h.Forbidden=403]="Forbidden",h[h.RequestTimeout=408]="RequestTimeout",h[h.InternalServerError=500]="InternalServerError"})(o||(o={}));function f(h){return h>=o.Success&&h<o.BadRequest}a.isSuccessCode=f,a.default=o}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(3)),h=o.__importStar(r(1)),g=o.__importDefault(r(2)),m=o.__importDefault(r(18)),_=o.__importDefault(r(19)),C=r(4),E=o.__importDefault(r(14));function R(M,G,O,w,T){M.http.supportsAuthHeaders?M.auth.getAuthHeaders(function(y,z){y?w(y):T(h.mixin(z,G),O)}):M.auth.getAuthParams(function(y,z){y?w(y):T(G,h.mixin(z,O))})}function v(M,G){return function(O,w,T,y,z){if(O&&!w){M(O);return}if(z===E.default.NoContent){M(O,[],T,!0,z);return}if(!y)try{w=h.decodeBody(w,G)}catch(Y){h.isErrorInfoOrPartialErrorInfo(Y)?M(Y):M(new C.PartialErrorInfo(h.inspectError(Y),null));return}if(!w){M(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var U=w,P=U.statusCode,K=U.response,Q=U.headers;if(P===void 0){M(O,w,T,!0,z);return}if(P<200||P>=300){var X=K&&K.error||O;X||(X=new Error("Error in unenveloping "+w),X.statusCode=P),M(X,K,Q,!0,P);return}M(O,K,Q,!0,P)}}function D(M){var G=[];if(M)for(var O in M)G.push(O+"="+M[O]);return G.join("&")}function B(M,G){return M+(G?"?":"")+D(G)}function L(M,G,O,w){return function(T,y,z,U,P){T?g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received Error; "+B(O,w)+"; Error: "+h.inspectError(T)):g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received; "+B(O,w)+"; Headers: "+D(z)+"; StatusCode: "+P+"; Body: "+(f.default.BufferUtils.isBuffer(y)?y.toString():y)),M&&M(T,y,z,U,P)}}var N=(function(){function M(){}return M.get=function(G,O,w,T,y,z){M.do(_.default.Get,G,O,null,w,T,y,z)},M.delete=function(G,O,w,T,y,z){M.do(_.default.Delete,G,O,null,w,T,y,z)},M.post=function(G,O,w,T,y,z,U){M.do(_.default.Post,G,O,w,T,y,z,U)},M.patch=function(G,O,w,T,y,z,U){M.do(_.default.Patch,G,O,w,T,y,z,U)},M.put=function(G,O,w,T,y,z,U){M.do(_.default.Put,G,O,w,T,y,z,U)},M.do=function(G,O,w,T,y,z,U,P){g.default.shouldLog(g.default.LOG_MICRO)&&(P=L(P,G,w,z)),U&&(P=P&&v(P,U),(z=z||{}).envelope=U);function K(Q,X){var Y;if(g.default.shouldLog(g.default.LOG_MICRO)&&g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+B(w,X)),g.default.shouldLog(g.default.LOG_MICRO)){var j=T;if(((Y=Q["content-type"])===null||Y===void 0?void 0:Y.indexOf("msgpack"))>0)try{j=f.default.Config.msgpack.decode(T)}catch(I){g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending MsgPack Decoding Error: "+h.inspectError(I))}g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+B(w,X)+"; Body: "+j)}O.http.do(G,O,w,Q,T,X,function(I,F,W,nt,Z){if(I&&m.default.isTokenErr(I)){O.auth.authorize(null,null,function(it){if(it){P(it);return}R(O,Q,X,P,K)});return}P(I,F,W,nt,Z)})}R(O,y,z,P,K)},M})();a.default=N}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(2)),h=o.__importDefault(r(3)),g=o.__importDefault(r(9)),m=o.__importStar(r(1));function _(E){return C.Actions.indexOf(E)}var C=(function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var R=this.id.split(":");return{connectionId:R[0],msgSerial:parseInt(R[1],10),index:parseInt(R[2],10)}},E.prototype.toJSON=function(){var R=this.data,v=this.encoding;return R&&h.default.BufferUtils.isBuffer(R)&&(arguments.length>0?(v=v?v+"/base64":"base64",R=h.default.BufferUtils.base64Encode(R)):R=h.default.BufferUtils.toBuffer(R)),{id:this.id,clientId:this.clientId,action:_(this.action),data:R,encoding:v,extras:this.extras}},E.prototype.toString=function(){var R="[PresenceMessage";return R+="; action="+this.action,this.id&&(R+="; id="+this.id),this.timestamp&&(R+="; timestamp="+this.timestamp),this.clientId&&(R+="; clientId="+this.clientId),this.connectionId&&(R+="; connectionId="+this.connectionId),this.encoding&&(R+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?R+="; data="+this.data:h.default.BufferUtils.isBuffer(this.data)?R+="; data (buffer)="+h.default.BufferUtils.base64Encode(this.data):R+="; data (json)="+JSON.stringify(this.data)),this.extras&&(R+="; extras="+JSON.stringify(this.extras)),R+="]",R},E.fromResponseBody=function(R,v,D){var B=[];D&&(R=m.decodeBody(R,D));for(var L=0;L<R.length;L++){var N=B[L]=E.fromValues(R[L],!0);try{E.decode(N,v)}catch(M){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",M.toString())}}return B},E.fromValues=function(R,v){return v&&(R.action=E.Actions[R.action]),Object.assign(new E,R)},E.fromValuesArray=function(R){for(var v=R.length,D=new Array(v),B=0;B<v;B++)D[B]=E.fromValues(R[B]);return D},E.fromEncoded=function(R,v){var D=E.fromValues(R,!0);try{E.decode(D,v??{})}catch(B){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromEncoded()",B.toString())}return D},E.fromEncodedArray=function(R,v){return R.map(function(D){return E.fromEncoded(D,v)})},E.fromData=function(R){return R instanceof E?R:E.fromValues({data:R})},E.Actions=["absent","present","enter","leave","update"],E.encode=g.default.encode,E.decode=g.default.decode,E.getMessagesSize=g.default.getMessagesSize,E})();a.default=C}),(function(n,a,r){(function(o){Object.defineProperty(a,"__esModule",{value:!0});var f=r(0),h=f.__importStar(r(1)),g=f.__importDefault(r(7)),m=f.__importStar(r(4)),_=f.__importDefault(r(2)),C=f.__importDefault(r(8)),E=f.__importDefault(r(22)),R=f.__importDefault(r(3));function v(U,P){return h.arrIn(h.allToLowerCase(h.keysArray(P)),"x-ably-errorcode")}function D(U,P){if(v(U,P))return U.error&&m.default.fromValues(U.error)}var B=function(){},L=0,N={},M=typeof o<"u"&&o.XDomainRequest;function G(){var U=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return U&&Number(U[1])}function O(){var U;return M&&(U=G())&&U===10}function w(U,P){return U.getResponseHeader&&U.getResponseHeader(P)}function T(U){return U.getResponseHeader&&(U.getResponseHeader("transfer-encoding")||!U.getResponseHeader("content-length"))}function y(U){for(var P=h.trim(U.getAllResponseHeaders()).split(`\r
`),K={},Q=0;Q<P.length;Q++){var X=P[Q].split(":").map(h.trim);K[X[0].toLowerCase()]=X[1]}return K}var z=(function(U){f.__extends(P,U);function P(K,Q,X,Y,j,I,F){var W=U.call(this)||this;return X=X||{},X.rnd=h.cheapRandStr(),O()&&!X.envelope&&(X.envelope="json"),W.uri=K+h.toQueryString(X),W.headers=Q||{},W.body=Y,W.method=F?F.toUpperCase():h.isEmptyArg(Y)?"GET":"POST",W.requestMode=j,W.timeouts=I,W.timedOut=!1,W.requestComplete=!1,W.id=String(++L),N[W.id]=W,W}return P.createRequest=function(K,Q,X,Y,j,I,F){var W=I||C.default.TIMEOUTS;return new P(K,Q,h.copy(X),Y,j,W,F)},P.prototype.complete=function(K,Q,X,Y,j){this.requestComplete||(this.requestComplete=!0,!K&&Q&&this.emit("data",Q),this.emit("complete",K,Q,X,Y,j),this.dispose())},P.prototype.abort=function(){this.dispose()},P.prototype.exec=function(){var K=this,Q=this.headers,X=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,Y=this.timer=setTimeout(function(){K.timedOut=!0,I.abort()},X),j=this.method,I=this.xhr=new XMLHttpRequest,F=Q.accept,W=this.body,nt="text";if(F?F.indexOf("application/x-msgpack")===0&&(nt="arraybuffer"):Q.accept="application/json",W){var Z=Q["content-type"]||(Q["content-type"]="application/json");Z.indexOf("application/json")>-1&&typeof W!="string"&&(W=JSON.stringify(W))}I.open(j,this.uri,!0),I.responseType=nt,"authorization"in Q&&(I.withCredentials=!0);for(var it in Q)I.setRequestHeader(it,Q[it]);var rt=function(Bt,Te,ze,Xe){var ke,hn=Te+" (event type: "+Bt.type+")";!((ke=K==null?void 0:K.xhr)===null||ke===void 0)&&ke.statusText&&(hn+=", current statusText is "+K.xhr.statusText),_.default.logAction(_.default.LOG_ERROR,"Request.on"+Bt.type+"()",hn),K.complete(new m.PartialErrorInfo(hn,ze,Xe))};I.onerror=function(Bt){rt(Bt,"XHR error occurred",null,400)},I.onabort=function(Bt){K.timedOut?rt(Bt,"Request aborted due to request timeout expiring",null,408):rt(Bt,"Request cancelled",null,400)},I.ontimeout=function(Bt){rt(Bt,"Request timed out",null,408)};var V,J,$,at=0,ht=!1,Rt=function(){if(clearTimeout(Y),$=J<400,J==204){K.complete(null,null,null,null,J);return}V=K.requestMode==E.default.REQ_RECV_STREAM&&$&&T(I)},zt=function(){var Bt;try{var Te=w(I,"content-type"),ze=Te?Te.indexOf("application/json")>=0:I.responseType=="text";if(ze){var Xe=I.responseType==="arraybuffer"?R.default.BufferUtils.utf8Decode(I.response):String(I.responseText);Xe.length?Bt=JSON.parse(Xe):Bt=Xe,ht=!0}else Bt=I.response;Bt.response!==void 0?(J=Bt.statusCode,$=J<400,Q=Bt.headers,Bt=Bt.response):Q=y(I)}catch(hn){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+hn.message,null,400));return}if($||h.isArray(Bt)){K.complete(null,Bt,Q,ht,J);return}var ke=D(Bt,Q);ke||(ke=new m.PartialErrorInfo("Error response received from server: "+J+" body was: "+R.default.Config.inspect(Bt),null,J)),K.complete(ke,Bt,Q,ht,J)};function Wt(){for(var Bt=I.responseText,Te=Bt.length-1,ze,Xe;at<Te&&(ze=Bt.indexOf(`
`,at))>-1;)Xe=Bt.slice(at,ze),at=ze+1,It(Xe)}var It=function(Bt){try{Bt=JSON.parse(Bt)}catch(Te){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+Te.message,null,400));return}K.emit("data",Bt)},pe=function(){Wt(),K.streamComplete=!0,R.default.Config.nextTick(function(){K.complete()})};I.onreadystatechange=function(){var Bt=I.readyState;Bt<3||I.status!==0&&(J===void 0&&(J=I.status,J===1223&&(J=204),Rt()),Bt==3&&V?Wt():Bt==4&&(V?pe():zt()))},I.send(W)},P.prototype.dispose=function(){var K=this.xhr;if(K){K.onreadystatechange=K.onerror=K.onabort=K.ontimeout=B,this.xhr=null;var Q=this.timer;Q&&(clearTimeout(Q),this.timer=null),this.requestComplete||K.abort()}delete N[this.id]},P})(g.default);a.default=z}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(2)),h=o.__importStar(r(1)),g=o.__importDefault(r(24)),m=o.__importDefault(r(4)),_=o.__importDefault(r(45)),C=r(11),E=o.__importDefault(r(19)),R=o.__importDefault(r(14)),v=o.__importDefault(r(3)),D=o.__importDefault(r(15)),B=Math.pow(2,17);function L(){}function N(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function M(X){return!!X.connection}function G(X){return h.isErrorInfoOrPartialErrorInfo(X)?(X.code||(X.statusCode===403?X.code=40300:(X.code=40170,X.statusCode=401)),X):new m.default(h.inspectError(X),X.code||40170,X.statusCode||401)}var O=function(X,Y){if(v.default.Config.createHmac){var j=v.default.Config.createHmac("SHA256",Y);return j.update(X),j.digest("base64")}return(0,C.stringify)((0,_.default)(X,Y))};function w(X){if(!X)return"";typeof X=="string"&&(X=JSON.parse(X));var Y=Object.create(null),j=h.keysArray(X,!0);if(!j)return"";j.sort();for(var I=0;I<j.length;I++)Y[j[I]]=X[j[I]].sort();return JSON.stringify(Y)}function T(X){if(X.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(X.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(X.key)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(X.tokenDetails)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var Y="authOptions must include valid authentication parameters";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",Y),new Error(Y)}}function y(X){return"useTokenAuth"in X&&!X.useTokenAuth}function z(X){return X.useTokenAuth||!y(X)&&(X.authCallback||X.authUrl||X.token||X.tokenDetails)}function U(X){return!X.key&&!X.authCallback&&!X.authUrl}var P=0;function K(){return P++}var Q=(function(){function X(Y,j){if(this.authOptions={},this.client=Y,this.tokenParams=j.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,z(j)){if(j.key&&!O){var I="client-side token request signing not supported";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new Error(I)}U(j)&&f.default.logAction(f.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(j.defaultTokenParams,j),T(this.authOptions)}else{if(!j.key){var I="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new m.default(I,40160,401)}f.default.logAction(f.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(j)}}return X.prototype.authorize=function(Y,j,I){var F=this,W;if(typeof Y=="function"&&!I?(I=Y,W=Y=null):typeof j=="function"&&!I?(I=j,W=null):W=j,!I&&this.client.options.promises)return h.promisify(this,"authorize",arguments);if(W&&W.key&&this.authOptions.key!==W.key)throw new m.default("Unable to update auth options with incompatible key",40102,401);W&&"force"in W&&(f.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),h.isOnlyPropIn(W,"force")&&(W=null)),this._forceNewToken(Y,W,function(nt,Z){if(nt){F.client.connection&&nt.statusCode===R.default.Forbidden&&F.client.connection.connectionManager.actOnErrorFromAuthorize(nt),I==null||I(nt);return}M(F.client)?F.client.connection.connectionManager.onAuthUpdated(Z,I||L):I==null||I(null,Z)})},X.prototype.authorise=function(Y,j,I){f.default.renamedMethod("Auth","authorise","authorize"),this.authorize(Y,j,I)},X.prototype._forceNewToken=function(Y,j,I){var F=this;this.tokenDetails=null,this._saveTokenOptions(Y,j),T(this.authOptions),this._ensureValidAuthCredentials(!0,function(W,nt){delete F.tokenParams.timestamp,delete F.authOptions.queryTime,I(W,nt)})},X.prototype.requestToken=function(Y,j,I){var F=this;if(typeof Y=="function"&&!I?(I=Y,j=Y=null):typeof j=="function"&&!I&&(I=j,j=null),!I&&this.client.options.promises)return h.promisify(this,"requestToken",arguments);j=j||this.authOptions,Y=Y||h.copy(this.tokenParams);var W=I||L,nt,Z=this.client;if(j.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),nt=j.authCallback;else if(j.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),nt=function(at,ht){var Rt=h.mixin({accept:"application/json, text/plain"},j.authHeaders),zt=j.authMethod&&j.authMethod.toLowerCase()==="post",Wt,It=j.authUrl.indexOf("?");It>-1&&(Wt=h.parseQueryString(j.authUrl.slice(It)),j.authUrl=j.authUrl.slice(0,It),zt||(j.authParams=h.mixin(Wt,j.authParams)));var pe=h.mixin({},j.authParams||{},at),Bt=function(Xe,ke,hn,Un){var wt;if(Xe?f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+h.inspectError(Xe)):(wt=hn["content-type"],f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+wt+"; body: "+h.inspectBody(ke))),Xe||Un)return ht(Xe,ke);if(v.default.BufferUtils.isBuffer(ke)&&(ke=ke.toString()),!wt){ht(new m.default("authUrl response is missing a content-type header",40170,401));return}var Yt=wt.indexOf("application/json")>-1,Fe=wt.indexOf("text/plain")>-1||wt.indexOf("application/jwt")>-1;if(!Yt&&!Fe){ht(new m.default("authUrl responded with unacceptable content-type "+wt+", should be either text/plain, application/jwt or application/json",40170,401));return}if(Yt){if(ke.length>B){ht(new m.default("authUrl response exceeded max permitted length",40170,401));return}try{ke=JSON.parse(ke)}catch(Se){ht(new m.default("Unexpected error processing authURL response; err = "+Se.message,40170,401));return}}ht(null,ke,wt)};if(f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+j.authUrl+"; Params: "+JSON.stringify(pe)+"; method: "+(zt?"POST":"GET")),zt){var Te=Rt||{};Te["content-type"]="application/x-www-form-urlencoded";var ze=h.toQueryString(pe).slice(1);F.client.http.doUri(E.default.Post,Z,j.authUrl,Te,ze,Wt,Bt)}else F.client.http.doUri(E.default.Get,Z,j.authUrl,Rt||{},null,pe,Bt)};else if(j.key)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),nt=function(at,ht){F.createTokenRequest(at,j,ht)};else{var it="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";f.default.logAction(f.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),W(new m.default(it,40171,403));return}"capability"in Y&&(Y.capability=w(Y.capability));var rt=function(at,ht){var Rt=at.keyName,zt="/keys/"+Rt+"/requestToken",Wt=function(pe){return Z.baseUri(pe)+zt},It=h.defaultPostHeaders(F.client.options);j.requestHeaders&&h.mixin(It,j.requestHeaders),f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+zt+"; Token params: "+JSON.stringify(at)),F.client.http.do(E.default.Post,Z,Wt,It,JSON.stringify(at),null,ht)},V=!1,J=this.client.options.timeouts.realtimeRequestTimeout,$=setTimeout(function(){V=!0;var at="Token request callback timed out after "+J/1e3+" seconds";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",at),W(new m.default(at,40170,401))},J);nt(Y,function(at,ht,Rt){if(!V){if(clearTimeout($),at){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+h.inspectError(at)),W(G(at));return}if(typeof ht=="string"){ht.length===0?W(new m.default("Token string is empty",40170,401)):ht.length>B?W(new m.default("Token string exceeded max permitted length (was "+ht.length+" bytes)",40170,401)):ht==="undefined"||ht==="null"?W(new m.default("Token string was literal null/undefined",40170,401)):ht[0]==="{"&&!(Rt&&Rt.indexOf("application/jwt")>-1)?W(new m.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):W(null,{token:ht});return}if(typeof ht!="object"){var zt="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof ht;f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",zt),W(new m.default(zt,40170,401));return}var Wt=JSON.stringify(ht).length;if(Wt>B&&!j.suppressMaxLengthCheck){W(new m.default("Token request/details object exceeded max permitted stringified size (was "+Wt+" bytes)",40170,401));return}if("issued"in ht){W(null,ht);return}if(!("keyName"in ht)){var zt="Expected token request callback to call back with a token string, token request object, or token details object";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",zt),W(new m.default(zt,40170,401));return}rt(ht,function(It,pe,Bt,Te){if(It){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+h.inspectError(It)),W(G(It));return}Te||(pe=JSON.parse(pe)),f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","token received"),W(null,pe)})}})},X.prototype.createTokenRequest=function(Y,j,I){var F=this;if(typeof Y=="function"&&!I?(I=Y,j=Y=null):typeof j=="function"&&!I&&(I=j,j=null),!I&&this.client.options.promises)return h.promisify(this,"createTokenRequest",arguments);j=j||this.authOptions,Y=Y||h.copy(this.tokenParams);var W=j.key;if(!W){I(new m.default("No key specified",40101,403));return}var nt=W.split(":"),Z=nt[0],it=nt[1];if(!it){I(new m.default("Invalid key specified",40101,403));return}if(Y.clientId===""){I(new m.default("clientId can’t be an empty string",40012,400));return}"capability"in Y&&(Y.capability=w(Y.capability));var rt=h.mixin({keyName:Z},Y),V=Y.clientId||"",J=Y.ttl||"",$=Y.capability||"";(function(at){if(rt.timestamp){at();return}F.getTimestamp(j&&j.queryTime,function(ht,Rt){if(ht){I(ht);return}rt.timestamp=Rt,at()})})(function(){var at=rt.nonce||(rt.nonce=N()),ht=rt.timestamp,Rt=rt.keyName+`
`+J+`
`+$+`
`+V+`
`+ht+`
`+at+`
`;rt.mac=rt.mac||O(Rt,it),f.default.logAction(f.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),I(null,rt)})},X.prototype.getAuthParams=function(Y){this.method=="basic"?Y(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(j,I){if(j){Y(j);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");Y(null,{access_token:I.token})})},X.prototype.getAuthHeaders=function(Y){this.method=="basic"?Y(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(j,I){if(j){Y(j);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");Y(null,{authorization:"Bearer "+h.toBase64(I.token)})})},X.prototype.getTimestamp=function(Y,j){!this.isTimeOffsetSet()&&(Y||this.authOptions.queryTime)?this.client.time(j):j(null,this.getTimestampUsingOffset())},X.prototype.getTimestampUsingOffset=function(){return h.now()+(this.client.serverTimeOffset||0)},X.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},X.prototype._saveBasicOptions=function(Y){this.method="basic",this.key=Y.key,this.basicKey=h.toBase64(Y.key),this.authOptions=Y||{},"clientId"in Y&&this._userSetClientId(Y.clientId)},X.prototype._saveTokenOptions=function(Y,j){this.method="token",Y&&(this.tokenParams=Y),j&&(j.token&&(j.tokenDetails=typeof j.token=="string"?{token:j.token}:j.token),j.tokenDetails&&(this.tokenDetails=j.tokenDetails),"clientId"in j&&this._userSetClientId(j.clientId),this.authOptions=j)},X.prototype._ensureValidAuthCredentials=function(Y,j){var I=this,F=this.tokenDetails;if(F){if(this._tokenClientIdMismatch(F.clientId)){j(new m.default("Mismatch between clientId in token ("+F.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!F.expires||F.expires>=this.getTimestampUsingOffset()){f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+F.expires),j(null,F);return}f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=g.default.create())).push(j),!(this.currentTokenRequestId!==null&&!Y)){var W=this.currentTokenRequestId=K();this.requestToken(this.tokenParams,this.authOptions,function(nt,Z){if(I.currentTokenRequestId>W){f.default.logAction(f.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}I.currentTokenRequestId=null;var it=I.waitingForTokenRequest||L;if(I.waitingForTokenRequest=null,nt){it(nt);return}it(null,I.tokenDetails=Z)})}},X.prototype._userSetClientId=function(Y){if(typeof Y=="string"||Y===null){if(Y==="*")throw new m.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var j=this._uncheckedSetClientId(Y);if(j)throw j}else throw new m.default("clientId must be either a string or null",40012,400)},X.prototype._uncheckedSetClientId=function(Y){if(this._tokenClientIdMismatch(Y)){var j="Unexpected clientId mismatch: client has "+this.clientId+", requested "+Y,I=new m.default(j,40102,401);return f.default.logAction(f.default.LOG_ERROR,"Auth._uncheckedSetClientId()",j),I}else return this.clientId=this.tokenParams.clientId=Y,null},X.prototype._tokenClientIdMismatch=function(Y){return!!(this.clientId&&this.clientId!=="*"&&Y&&Y!=="*"&&this.clientId!==Y)},X.isTokenErr=function(Y){return Y.code&&Y.code>=40140&&Y.code<40150},X.prototype.revokeTokens=function(Y,j,I){if(z(this.client.options))throw new m.default("Cannot revoke tokens when using token auth",40162,401);var F=this.client.options.keyName,W;if(typeof j=="function"?(I=j,W={}):W=j??{},I===void 0){if(this.client.options.promises)return h.promisify(this,"revokeTokens",[Y,W]);I=L}var nt=I,Z=o.__assign({targets:Y.map(function(J){return"".concat(J.type,":").concat(J.value)})},W),it=this.client.options.useBinaryProtocol?h.Format.msgpack:h.Format.json,rt=h.defaultPostHeaders(this.client.options,it);this.client.options.headers&&h.mixin(rt,this.client.options.headers);var V=h.encodeBody(Z,it);D.default.post(this.client,"/keys/".concat(F,"/revokeTokens"),V,rt,{newBatchResponse:"true"},null,function(J,$,at,ht){if(J){nt(J);return}var Rt=ht?$:h.decodeBody($,it);nt(null,Rt)})},X})();a.default=Q}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o;(function(f){f.Get="get",f.Delete="delete",f.Post="post",f.Put="put",f.Patch="patch"})(o||(o={})),a.default=o}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.HttpPaginatedResponse=a.PaginatedResult=void 0;var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(2)),g=o.__importDefault(r(15)),m=o.__importDefault(r(14));function _(B){var L=B.match(/^\.\/(\w+)\?(.*)$/);return L&&L[2]&&f.parseQueryString(L[2])}function C(B){typeof B=="string"&&(B=B.split(","));for(var L={},N=0;N<B.length;N++){var M=B[N].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(M){var G=_(M[1]);G&&(L[M[2]]=G)}}return L}function E(B,L,N){return!(N&&(L||typeof B.code=="number"))}var R=(function(){function B(L,N,M,G,O,w){this.rest=L,this.path=N,this.headers=M,this.envelope=G??null,this.bodyHandler=O,this.useHttpPaginatedResponse=w||!1}return B.prototype.get=function(L,N){var M=this;g.default.get(this.rest,this.path,this.headers,L,this.envelope,function(G,O,w,T,y){M.handlePage(G,O,w,T,y,N)})},B.prototype.delete=function(L,N){var M=this;g.default.delete(this.rest,this.path,this.headers,L,this.envelope,function(G,O,w,T,y){M.handlePage(G,O,w,T,y,N)})},B.prototype.post=function(L,N,M){var G=this;g.default.post(this.rest,this.path,N,this.headers,L,this.envelope,function(O,w,T,y,z){M&&G.handlePage(O,w,T,y,z,M)})},B.prototype.put=function(L,N,M){var G=this;g.default.put(this.rest,this.path,N,this.headers,L,this.envelope,function(O,w,T,y,z){M&&G.handlePage(O,w,T,y,z,M)})},B.prototype.patch=function(L,N,M){var G=this;g.default.patch(this.rest,this.path,N,this.headers,L,this.envelope,function(O,w,T,y,z){M&&G.handlePage(O,w,T,y,z,M)})},B.prototype.handlePage=function(L,N,M,G,O,w){if(L&&E(L,N,this.useHttpPaginatedResponse)){h.default.logAction(h.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+f.inspectError(L)),w==null||w(L);return}var T,y,z;try{T=O==m.default.NoContent?[]:this.bodyHandler(N,M||{},G)}catch(U){w==null||w(L||U);return}M&&(y=M.Link||M.link)&&(z=C(y)),this.useHttpPaginatedResponse?w(null,new D(this,T,M||{},O,z,L)):w(null,new v(this,T,z))},B})(),v=(function(){function B(L,N,M){var G=this;this.resource=L,this.items=N;var O=this;M&&("first"in M&&(this.first=function(w){if(!w&&O.resource.rest.options.promises)return f.promisify(O,"first",[]);O.get(M.first,w)}),"current"in M&&(this.current=function(w){if(!w&&O.resource.rest.options.promises)return f.promisify(O,"current",[]);O.get(M.current,w)}),this.next=function(w){if(!w&&O.resource.rest.options.promises)return f.promisify(O,"next",[]);"next"in M?O.get(M.next,w):w(null,null)},this.hasNext=function(){return"next"in M},this.isLast=function(){var w;return!(!((w=G.hasNext)===null||w===void 0)&&w.call(G))})}return B.prototype.get=function(L,N){var M=this.resource;g.default.get(M.rest,M.path,M.headers,L,M.envelope,function(G,O,w,T,y){M.handlePage(G,O,w,T,y,N)})},B})();a.PaginatedResult=v;var D=(function(B){o.__extends(L,B);function L(N,M,G,O,w,T){var y=B.call(this,N,M,w)||this;return y.statusCode=O,y.success=O<300&&O>=200,y.headers=G,y.errorCode=T&&T.code,y.errorMessage=T&&T.message,y}return L.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},L})(v);a.HttpPaginatedResponse=D,a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.isRetriable=void 0;var o=r(0),f=o.__importDefault(r(4)),h={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},g={disconnected:function(){return f.default.fromValues({statusCode:400,code:h.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return f.default.fromValues({statusCode:400,code:h.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return f.default.fromValues({statusCode:400,code:h.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return f.default.fromValues({statusCode:400,code:h.CLOSING,message:"Connection closing"})},closed:function(){return f.default.fromValues({statusCode:400,code:h.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return f.default.fromValues({statusCode:500,code:h.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return f.default.fromValues({statusCode:500,code:h.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function m(_){return!_.statusCode||!_.code||_.statusCode>=500?!0:Object.values(h).includes(_.code)}a.isRetriable=m,a.default=g}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o;(function(f){f[f.REQ_SEND=0]="REQ_SEND",f[f.REQ_RECV=1]="REQ_RECV",f[f.REQ_RECV_POLL=2]="REQ_RECV_POLL",f[f.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(o||(o={})),a.default=o}),(function(n,a,r){(function(o,f){n.exports=f(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(o){return o})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(2)),h=(function(){function g(m){this.members=m||[]}return g.prototype.call=function(){for(var m=[],_=0;_<arguments.length;_++)m[_]=arguments[_];for(var C=0,E=this.members;C<E.length;C++){var R=E[C];if(R)try{R.apply(void 0,m)}catch(v){f.default.logAction(f.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+v+"; stack = "+v.stack)}}},g.prototype.push=function(){for(var m,_=[],C=0;C<arguments.length;C++)_[C]=arguments[C];(m=this.members).push.apply(m,_)},g.create=function(m){var _=new g(m);return Object.assign(function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];return _.call.apply(_,C)},{push:function(C){return _.push(C)}})},g})();a.default=h}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){(function(){var f=o,h=f.lib,g=h.Base,m=f.enc,_=m.Utf8,C=f.algo;C.HMAC=g.extend({init:function(E,R){E=this._hasher=new E.init,typeof R=="string"&&(R=_.parse(R));var v=E.blockSize,D=v*4;R.sigBytes>D&&(R=E.finalize(R)),R.clamp();for(var B=this._oKey=R.clone(),L=this._iKey=R.clone(),N=B.words,M=L.words,G=0;G<v;G++)N[G]^=1549556828,M[G]^=909522486;B.sigBytes=L.sigBytes=D,this.reset()},reset:function(){var E=this._hasher;E.reset(),E.update(this._iKey)},update:function(E){return this._hasher.update(E),this},finalize:function(E){var R=this._hasher,v=R.finalize(E);R.reset();var D=R.finalize(this._oKey.clone().concat(v));return D}})})()})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(10)),h=o.__importStar(r(1)),g=o.__importDefault(r(7)),m=o.__importDefault(r(2)),_=o.__importDefault(r(21)),C=o.__importDefault(r(4)),E=o.__importDefault(r(3)),R=f.default.Action,v=f.default.fromValues({action:R.CLOSE}),D=f.default.fromValues({action:R.DISCONNECT}),B=(function(L){o.__extends(N,L);function N(M,G,O,w){var T=L.call(this)||this;return w&&(O.format=void 0,O.heartbeats=!0),T.connectionManager=M,M.registerProposedTransport(T),T.auth=G,T.params=O,T.timeouts=O.options.timeouts,T.format=O.format,T.isConnected=!1,T.isFinished=!1,T.isDisposed=!1,T.maxIdleInterval=null,T.idleTimer=null,T.lastActivity=null,T}return N.prototype.connect=function(){},N.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",_.default.closed())},N.prototype.disconnect=function(M){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",M||_.default.disconnected())},N.prototype.fail=function(M){this.isConnected&&this.requestDisconnect(),this.finish("failed",M||_.default.failed())},N.prototype.finish=function(M,G){var O;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((O=this.idleTimer)!==null&&O!==void 0?O:void 0),this.idleTimer=null,this.emit(M,G),this.dispose())},N.prototype.onProtocolMessage=function(M){switch(m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+f.default.stringify(M)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),M.action){case R.HEARTBEAT:m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",M.id);break;case R.CONNECTED:this.onConnect(M),this.emit("connected",M.error,M.connectionId,M.connectionDetails,M);break;case R.CLOSED:this.onClose(M);break;case R.DISCONNECTED:this.onDisconnect(M);break;case R.ACK:this.emit("ack",M.msgSerial,M.count);break;case R.NACK:this.emit("nack",M.msgSerial,M.count,M.error);break;case R.SYNC:this.connectionManager.onChannelMessage(M,this);break;case R.ACTIVATE:break;case R.AUTH:this.auth.authorize(function(G){G&&m.default.logAction(m.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+h.inspectError(G))});break;case R.ERROR:if(m.default.logAction(m.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(M.error)+(M.channel?", channel: "+M.channel:"")),M.channel===void 0){this.onFatalError(M);break}this.connectionManager.onChannelMessage(M,this);break;default:this.connectionManager.onChannelMessage(M,this)}},N.prototype.onConnect=function(M){if(this.isConnected=!0,!M.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var G=M.connectionDetails.maxIdleInterval;G&&(this.maxIdleInterval=G+this.timeouts.realtimeRequestTimeout,this.onActivity())},N.prototype.onDisconnect=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onDisconnect()","err = "+h.inspectError(G)),this.finish("disconnected",G)},N.prototype.onFatalError=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onFatalError()","err = "+h.inspectError(G)),this.finish("failed",G)},N.prototype.onClose=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onClose()","err = "+h.inspectError(G)),this.finish("closed",G)},N.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestClose()",""),this.send(v)},N.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(D)},N.prototype.ping=function(M){var G={action:f.default.Action.HEARTBEAT};M&&(G.id=M),this.send(f.default.fromValues(G))},N.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},N.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=h.now(),this.setIdleTimer(this.maxIdleInterval+100))},N.prototype.setIdleTimer=function(M){var G=this;this.idleTimer||(this.idleTimer=setTimeout(function(){G.onIdleTimerExpire()},M))},N.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var M=h.now()-this.lastActivity,G=this.maxIdleInterval-M;if(G<=0){var O="No activity seen from realtime in "+M+"ms; assuming connection has dropped";m.default.logAction(m.default.LOG_ERROR,"Transport.onIdleTimerExpire()",O),this.disconnect(new C.default(O,80003,408))}else this.setIdleTimer(G+100)},N.tryConnect=function(M,G,O,w,T){var y=new M(G,O,w),z,U=function(K){clearTimeout(z),T({event:this.event,error:K})},P=G.options.timeouts.realtimeRequestTimeout;z=setTimeout(function(){y.off(["preconnect","disconnected","failed"]),y.dispose(),U.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},P),y.on(["failed","disconnected"],U),y.on("preconnect",function(){m.default.logAction(m.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+y),clearTimeout(z),y.off(["failed","disconnected"],U),T(null,y)}),y.connect()},N})(g.default);a.default=B}),(function(n,a,r){(function(o,f){n.exports=f(r(6),r(40),r(25))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.Base,m=h.WordArray,_=f.algo,C=_.MD5,E=_.EvpKDF=g.extend({cfg:g.extend({keySize:128/32,hasher:C,iterations:1}),init:function(R){this.cfg=this.cfg.extend(R)},compute:function(R,v){for(var D,B=this.cfg,L=B.hasher.create(),N=m.create(),M=N.words,G=B.keySize,O=B.iterations;M.length<G;){D&&L.update(D),D=L.update(R).finalize(v),L.reset();for(var w=1;w<O;w++)D=L.finalize(D),L.reset();N.concat(D)}return N.sigBytes=G*4,N}});f.EvpKDF=function(R,v,D){return E.create(D).compute(R,v)}})(),o.EvpKDF})}),(function(n,a,r){(function(o,f){n.exports=f(r(6),r(27))})(this,function(o){o.lib.Cipher||(function(f){var h=o,g=h.lib,m=g.Base,_=g.WordArray,C=g.BufferedBlockAlgorithm,E=h.enc;E.Utf8;var R=E.Base64,v=h.algo,D=v.EvpKDF,B=g.Cipher=C.extend({cfg:m.extend(),createEncryptor:function(Q,X){return this.create(this._ENC_XFORM_MODE,Q,X)},createDecryptor:function(Q,X){return this.create(this._DEC_XFORM_MODE,Q,X)},init:function(Q,X,Y){this.cfg=this.cfg.extend(Y),this._xformMode=Q,this._key=X,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(Q){return this._append(Q),this._process()},finalize:function(Q){Q&&this._append(Q);var X=this._doFinalize();return X},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function Q(X){return typeof X=="string"?K:z}return function(X){return{encrypt:function(Y,j,I){return Q(j).encrypt(X,Y,j,I)},decrypt:function(Y,j,I){return Q(j).decrypt(X,Y,j,I)}}}})()});g.StreamCipher=B.extend({_doFinalize:function(){var Q=this._process(!0);return Q},blockSize:1});var L=h.mode={},N=g.BlockCipherMode=m.extend({createEncryptor:function(Q,X){return this.Encryptor.create(Q,X)},createDecryptor:function(Q,X){return this.Decryptor.create(Q,X)},init:function(Q,X){this._cipher=Q,this._iv=X}}),M=L.CBC=(function(){var Q=N.extend();Q.Encryptor=Q.extend({processBlock:function(Y,j){var I=this._cipher,F=I.blockSize;X.call(this,Y,j,F),I.encryptBlock(Y,j),this._prevBlock=Y.slice(j,j+F)}}),Q.Decryptor=Q.extend({processBlock:function(Y,j){var I=this._cipher,F=I.blockSize,W=Y.slice(j,j+F);I.decryptBlock(Y,j),X.call(this,Y,j,F),this._prevBlock=W}});function X(Y,j,I){var F,W=this._iv;W?(F=W,this._iv=f):F=this._prevBlock;for(var nt=0;nt<I;nt++)Y[j+nt]^=F[nt]}return Q})(),G=h.pad={},O=G.Pkcs7={pad:function(Q,X){for(var Y=X*4,j=Y-Q.sigBytes%Y,I=j<<24|j<<16|j<<8|j,F=[],W=0;W<j;W+=4)F.push(I);var nt=_.create(F,j);Q.concat(nt)},unpad:function(Q){var X=Q.words[Q.sigBytes-1>>>2]&255;Q.sigBytes-=X}};g.BlockCipher=B.extend({cfg:B.cfg.extend({mode:M,padding:O}),reset:function(){var Q;B.reset.call(this);var X=this.cfg,Y=X.iv,j=X.mode;this._xformMode==this._ENC_XFORM_MODE?Q=j.createEncryptor:(Q=j.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Q?this._mode.init(this,Y&&Y.words):(this._mode=Q.call(j,this,Y&&Y.words),this._mode.__creator=Q)},_doProcessBlock:function(Q,X){this._mode.processBlock(Q,X)},_doFinalize:function(){var Q,X=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(X.pad(this._data,this.blockSize),Q=this._process(!0)):(Q=this._process(!0),X.unpad(Q)),Q},blockSize:128/32});var w=g.CipherParams=m.extend({init:function(Q){this.mixIn(Q)},toString:function(Q){return(Q||this.formatter).stringify(this)}}),T=h.format={},y=T.OpenSSL={stringify:function(Q){var X,Y=Q.ciphertext,j=Q.salt;return j?X=_.create([1398893684,1701076831]).concat(j).concat(Y):X=Y,X.toString(R)},parse:function(Q){var X,Y=R.parse(Q),j=Y.words;return j[0]==1398893684&&j[1]==1701076831&&(X=_.create(j.slice(2,4)),j.splice(0,4),Y.sigBytes-=16),w.create({ciphertext:Y,salt:X})}},z=g.SerializableCipher=m.extend({cfg:m.extend({format:y}),encrypt:function(Q,X,Y,j){j=this.cfg.extend(j);var I=Q.createEncryptor(Y,j),F=I.finalize(X),W=I.cfg;return w.create({ciphertext:F,key:Y,iv:W.iv,algorithm:Q,mode:W.mode,padding:W.padding,blockSize:Q.blockSize,formatter:j.format})},decrypt:function(Q,X,Y,j){j=this.cfg.extend(j),X=this._parse(X,j.format);var I=Q.createDecryptor(Y,j).finalize(X.ciphertext);return I},_parse:function(Q,X){return typeof Q=="string"?X.parse(Q,this):Q}}),U=h.kdf={},P=U.OpenSSL={execute:function(Q,X,Y,j){j||(j=_.random(64/8));var I=D.create({keySize:X+Y}).compute(Q,j),F=_.create(I.words.slice(X),Y*4);return I.sigBytes=X*4,w.create({key:I,iv:F,salt:j})}},K=g.PasswordBasedCipher=z.extend({cfg:z.cfg.extend({kdf:P}),encrypt:function(Q,X,Y,j){j=this.cfg.extend(j);var I=j.kdf.execute(Y,Q.keySize,Q.ivSize);j.iv=I.iv;var F=z.encrypt.call(this,Q,X,I.key,j);return F.mixIn(I),F},decrypt:function(Q,X,Y,j){j=this.cfg.extend(j),X=this._parse(X,j.format);var I=j.kdf.execute(Y,Q.keySize,Q.ivSize,X.salt);j.iv=I.iv;var F=z.decrypt.call(this,Q,X,I.key,j);return F}})})()})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.Request=a.createRequest=void 0;var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(12)),g=o.__importDefault(r(3)),m=o.__importDefault(r(7)),_=r(4),C=o.__importDefault(r(8)),E=o.__importDefault(r(2)),R=o.__importDefault(r(22)),v=f.getGlobalObject(),D=function(){},B=v._ablyjs_jsonp={};B._=function(T){return B["_"+T]||D};var L=1,N="jsonp";function M(T,y,z,U,P,K,Q){return K=K||C.default.TIMEOUTS,new O(void 0,T,y,f.copy(z),U,P,K,Q)}a.createRequest=M;var G=(function(T){o.__extends(y,T);function y(z,U,P){var K=T.call(this,z,U,P)||this;return K.shortName=N,P.stream=!1,K}return y.isAvailable=function(){return g.default.Config.jsonpSupported&&g.default.Config.allowComet},y.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},y.prototype.createRequest=function(z,U,P,K,Q,X,Y){return X=(this===null||this===void 0?void 0:this.timeouts)||X||C.default.TIMEOUTS,M(z,U,P,K,Q,X,Y)},y})(h.default),O=(function(T){o.__extends(y,T);function y(z,U,P,K,Q,X,Y,j){var I=T.call(this)||this;return z===void 0&&(z=L++),I.id=z,I.uri=U,I.params=K||{},I.params.rnd=f.cheapRandStr(),P&&(P["X-Ably-Version"]&&(I.params.v=P["X-Ably-Version"]),P["X-Ably-Lib"]&&(I.params.lib=P["X-Ably-Lib"])),I.body=Q,I.method=j,I.requestMode=X,I.timeouts=Y,I.requestComplete=!1,I}return y.prototype.exec=function(){var z=this,U=this.id,P=this.body,K=this.method,Q=this.uri,X=this.params;X.callback="_ablyjs_jsonp._("+U+")",X.envelope="jsonp",P&&(X.body=P),K&&K!=="get"&&(X.method=K);var Y=this.script=document.createElement("script"),j=Q+f.toQueryString(X);Y.src=j,Y.src.split("/").slice(-1)[0]!==j.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),Y.async=!0,Y.type="text/javascript",Y.charset="UTF-8",Y.onerror=function(W){z.complete(new _.PartialErrorInfo("JSONP script error (event: "+g.default.Config.inspect(W)+")",null,400))},B["_"+U]=function(W){if(W.statusCode){var nt=W.response;if(W.statusCode==204)z.complete(null,null,null,W.statusCode);else if(!nt)z.complete(new _.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(W.statusCode<400||f.isArray(nt))z.complete(null,nt,W.headers,W.statusCode);else{var Z=nt.error||new _.PartialErrorInfo("Error response received from server",null,W.statusCode);z.complete(Z)}}else z.complete(null,W)};var I=this.requestMode==R.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),I);var F=document.getElementsByTagName("head")[0];F.insertBefore(Y,F.firstChild)},y.prototype.complete=function(z,U,P,K){if(P=P||{},!this.requestComplete){this.requestComplete=!0;var Q=void 0;U&&(Q=typeof U=="string"?"text/plain":"application/json",P["content-type"]=Q,this.emit("data",U)),this.emit("complete",z,U,P,!0,K),this.dispose()}},y.prototype.abort=function(){this.dispose()},y.prototype.dispose=function(){var z=this.timer;z&&(clearTimeout(z),this.timer=null);var U=this.script;U.parentNode&&U.parentNode.removeChild(U),delete B[this.id],this.emit("disposed")},y})(m.default);a.Request=O;function w(T){return v.JSONPTransport=G,G.isAvailable()&&(T.supportedTransports[N]=G),G}a.default=w}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(2)),g=o.__importDefault(r(8)),m=o.__importDefault(r(18)),_=o.__importDefault(r(46)),C=o.__importDefault(r(20)),E=o.__importDefault(r(33)),R=o.__importDefault(r(4)),v=o.__importDefault(r(49)),D=o.__importDefault(r(19)),B=o.__importDefault(r(3)),L=o.__importDefault(r(9)),N=o.__importDefault(r(16)),M=o.__importDefault(r(15)),G=function(){},O=(function(){function T(y){if(!y){var z="no options provided";throw h.default.logAction(h.default.LOG_ERROR,"Rest()",z),new Error(z)}var U=g.default.objectifyOptions(y);U.log?(h.default.setLog(U.log.level,U.log.handler),h.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):h.default.setLog(U.logLevel,U.logHandler),h.default.logAction(h.default.LOG_MICRO,"Rest()","initialized with clientOptions "+B.default.Config.inspect(y));var P=this.options=g.default.normaliseOptions(U);if(P.key){var K=P.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!K){var z="invalid key parameter";throw h.default.logAction(h.default.LOG_ERROR,"Rest()",z),new R.default(z,40400,404)}P.keyName=K[1],P.keySecret=K[2]}if("clientId"in P)if(typeof P.clientId=="string"||P.clientId===null){if(P.clientId==="*")throw new R.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new R.default("clientId must be either a string or null",40012,400);h.default.logAction(h.default.LOG_MINOR,"Rest()","started; version = "+g.default.version),this.baseUri=this.authority=function(Q){return g.default.getHttpScheme(P)+Q+":"+g.default.getPort(P,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new B.default.Http(P),this.auth=new m.default(this,P),this.channels=new w(this),this.push=new _.default(this)}return T.prototype.stats=function(y,z){if(z===void 0)if(typeof y=="function")z=y,y=null;else{if(this.options.promises)return f.promisify(this,"stats",[y]);z=G}var U=f.defaultGetHeaders(this.options),P=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,K=this.http.supportsLinkHeaders?void 0:P;this.options.headers&&f.mixin(U,this.options.headers),new C.default(this,"/stats",U,K,function(Q,X,Y){for(var j=Y?Q:JSON.parse(Q),I=0;I<j.length;I++)j[I]=v.default.fromValues(j[I]);return j}).get(y,z)},T.prototype.time=function(y,z){var U=this;if(z===void 0){if(typeof y=="function")z=y,y=null;else if(this.options.promises)return f.promisify(this,"time",[y])}var P=z||G,K=f.defaultGetHeaders(this.options);this.options.headers&&f.mixin(K,this.options.headers);var Q=function(X){return U.authority(X)+"/time"};this.http.do(D.default.Get,this,Q,K,null,y,function(X,Y,j,I){if(X){P(X);return}I||(Y=JSON.parse(Y));var F=Y[0];if(!F){P(new R.default("Internal error (unexpected result type from GET /time)",5e4,500));return}U.serverTimeOffset=F-f.now(),P(null,F)})},T.prototype.request=function(y,z,U,P,K,Q){var X=this.options.useBinaryProtocol,Y=X?B.default.Config.msgpack.encode:JSON.stringify,j=X?B.default.Config.msgpack.decode:JSON.parse,I=X?f.Format.msgpack:f.Format.json,F=this.http.supportsLinkHeaders?void 0:I;U=U||{};var W=y.toLowerCase(),nt=W=="get"?f.defaultGetHeaders(this.options,I):f.defaultPostHeaders(this.options,I);if(Q===void 0){if(this.options.promises)return f.promisify(this,"request",[y,z,U,P,K]);Q=G}typeof P!="string"&&(P=Y(P)),this.options.headers&&f.mixin(nt,this.options.headers),K&&f.mixin(nt,K);var Z=new C.default(this,z,nt,F,function(it,rt,V){return f.ensureArray(V?it:j(it))},!0);if(!f.arrIn(B.default.Http.methods,W))throw new R.default("Unsupported method "+W,40500,405);f.arrIn(B.default.Http.methodsWithBody,W)?Z[W](U,P,Q):Z[W](U,Q)},T.prototype.batchPublish=function(y,z){if(z===void 0){if(this.options.promises)return f.promisify(this,"batchPublish",[y]);z=G}var U=z,P,K;f.isArray(y)?(P=y,K=!1):(P=[y],K=!0);var Q=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,X=f.defaultPostHeaders(this.options,Q);this.options.headers&&f.mixin(X,this.options.headers);var Y=f.encodeBody(P,Q);M.default.post(this,"/messages",Y,X,{newBatchResponse:"true"},null,function(j,I,F,W){if(j){U(j);return}var nt=W?I:f.decodeBody(I,Q);K?U(null,nt[0]):U(null,nt)})},T.prototype.batchPresence=function(y,z){if(z===void 0){if(this.options.promises)return f.promisify(this,"batchPresence",[y]);z=G}var U=z,P=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,K=f.defaultPostHeaders(this.options,P);this.options.headers&&f.mixin(K,this.options.headers);var Q=y.join(",");M.default.get(this,"/presence",K,{newBatchResponse:"true",channels:Q},null,function(X,Y,j,I){if(X){U(X);return}var F=I?Y:f.decodeBody(Y,P);U(null,F)})},T.prototype.setLog=function(y){h.default.setLog(y.level,y.handler)},T.Promise=function(y){return y=g.default.objectifyOptions(y),y.promises=!0,new T(y)},T.Callbacks=T,T.Platform=B.default,T.Message=L.default,T.PresenceMessage=N.default,T})(),w=(function(){function T(y){this.rest=y,this.all=Object.create(null)}return T.prototype.get=function(y,z){y=String(y);var U=this.all[y];return U?z&&U.setOptions(z):this.all[y]=U=new E.default(this.rest,y,z),U},T.prototype.release=function(y){delete this.all[String(y)]},T})();a.default=O}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return o.enc.Utf8})}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(f){var h=o,g=h.lib,m=g.WordArray,_=g.Hasher,C=h.algo,E=[],R=[];(function(){function B(G){for(var O=f.sqrt(G),w=2;w<=O;w++)if(!(G%w))return!1;return!0}function L(G){return(G-(G|0))*4294967296|0}for(var N=2,M=0;M<64;)B(N)&&(M<8&&(E[M]=L(f.pow(N,1/2))),R[M]=L(f.pow(N,1/3)),M++),N++})();var v=[],D=C.SHA256=_.extend({_doReset:function(){this._hash=new m.init(E.slice(0))},_doProcessBlock:function(B,L){for(var N=this._hash.words,M=N[0],G=N[1],O=N[2],w=N[3],T=N[4],y=N[5],z=N[6],U=N[7],P=0;P<64;P++){if(P<16)v[P]=B[L+P]|0;else{var K=v[P-15],Q=(K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3,X=v[P-2],Y=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;v[P]=Q+v[P-7]+Y+v[P-16]}var j=T&y^~T&z,I=M&G^M&O^G&O,F=(M<<30|M>>>2)^(M<<19|M>>>13)^(M<<10|M>>>22),W=(T<<26|T>>>6)^(T<<21|T>>>11)^(T<<7|T>>>25),nt=U+W+j+R[P]+v[P],Z=F+I;U=z,z=y,y=T,T=w+nt|0,w=O,O=G,G=M,M=nt+Z|0}N[0]=N[0]+M|0,N[1]=N[1]+G|0,N[2]=N[2]+O|0,N[3]=N[3]+w|0,N[4]=N[4]+T|0,N[5]=N[5]+y|0,N[6]=N[6]+z|0,N[7]=N[7]+U|0},_doFinalize:function(){var B=this._data,L=B.words,N=this._nDataBytes*8,M=B.sigBytes*8;return L[M>>>5]|=128<<24-M%32,L[(M+64>>>9<<4)+14]=f.floor(N/4294967296),L[(M+64>>>9<<4)+15]=N,B.sigBytes=L.length*4,this._process(),this._hash},clone:function(){var B=_.clone.call(this);return B._hash=this._hash.clone(),B}});h.SHA256=_._createHelper(D),h.HmacSHA256=_._createHmacHelper(D)})(Math),o.SHA256})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(7)),g=o.__importDefault(r(2)),m=o.__importDefault(r(34)),_=o.__importDefault(r(9)),C=o.__importDefault(r(4)),E=o.__importDefault(r(20)),R=o.__importDefault(r(15)),v=o.__importDefault(r(3));function D(){}var B=9;function L(G){return f.arrEvery(G,function(O){return!O.id})}function N(G){var O=G||{};if(O.cipher){if(!v.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var w=v.default.Crypto.getCipher(O.cipher);O.cipher=w.cipherParams,O.channelCipher=w.cipher}else"cipher"in O&&(O.cipher=void 0,O.channelCipher=null);return O}var M=(function(G){o.__extends(O,G);function O(w,T,y){var z=G.call(this)||this;return g.default.logAction(g.default.LOG_MINOR,"Channel()","started; name = "+T),z.rest=w,z.name=T,z.basePath="/channels/"+encodeURIComponent(T),z.presence=new m.default(z),z.channelOptions=N(y),z}return O.prototype.setOptions=function(w){this.channelOptions=N(w)},O.prototype.history=function(w,T){if(g.default.logAction(g.default.LOG_MICRO,"Channel.history()","channel = "+this.name),T===void 0)if(typeof w=="function")T=w,w=null;else{if(this.rest.options.promises)return f.promisify(this,"history",arguments);T=D}this._history(w,T)},O.prototype._history=function(w,T){var y=this.rest,z=y.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,U=this.rest.http.supportsLinkHeaders?void 0:z,P=f.defaultGetHeaders(y.options,z);y.options.headers&&f.mixin(P,y.options.headers);var K=this.channelOptions;new E.default(y,this.basePath+"/messages",P,U,function(Q,X,Y){return _.default.fromResponseBody(Q,K,Y?void 0:z)}).get(w,T)},O.prototype.publish=function(){var w=this,T=arguments.length,y=arguments[0],z=arguments[1],U=arguments[T-1],P,K;if(typeof U!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);U=D}if(typeof y=="string"||y===null)P=[_.default.fromValues({name:y,data:z})],K=arguments[2];else if(f.isObject(y))P=[_.default.fromValues(y)],K=arguments[1];else if(f.isArray(y))P=_.default.fromValuesArray(y),K=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof K!="object"||!K)&&(K={});var Q=this.rest,X=Q.options,Y=X.useBinaryProtocol?f.Format.msgpack:f.Format.json,j=Q.options.idempotentRestPublishing,I=f.defaultPostHeaders(Q.options,Y);if(X.headers&&f.mixin(I,X.headers),j&&L(P)){var F=f.randomString(B);f.arrForEach(P,function(W,nt){W.id=F+":"+nt.toString()})}_.default.encodeArray(P,this.channelOptions,function(W){if(W){U(W);return}var nt=_.default.getMessagesSize(P),Z=X.maxMessageSize;if(nt>Z){U(new C.default("Maximum size of messages that can be published at once exceeded ( was "+nt+" bytes; limit is "+Z+" bytes)",40009,400));return}w._publish(_.default.serialize(P,Y),I,K,U)})},O.prototype._publish=function(w,T,y,z){R.default.post(this.rest,this.basePath+"/messages",w,T,y,null,z)},O.prototype.status=function(w){if(typeof w!="function"&&this.rest.options.promises)return f.promisify(this,"status",[]);var T=this.rest.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,y=f.defaultPostHeaders(this.rest.options,T);R.default.get(this.rest,this.basePath,y,{},T,w||D)},O})(h.default);a.default=M}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(7)),g=o.__importDefault(r(2)),m=o.__importDefault(r(20)),_=o.__importDefault(r(16));function C(){}var E=(function(R){o.__extends(v,R);function v(D){var B=R.call(this)||this;return B.channel=D,B.basePath=D.basePath+"/presence",B}return v.prototype.get=function(D,B){if(g.default.logAction(g.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),B===void 0)if(typeof D=="function")B=D,D=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"get",arguments);B=C}var L=this.channel.rest,N=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:N,G=f.defaultGetHeaders(L.options,N);L.options.headers&&f.mixin(G,L.options.headers);var O=this.channel.channelOptions;new m.default(L,this.basePath,G,M,function(w,T,y){return _.default.fromResponseBody(w,O,y?void 0:N)}).get(D,B)},v.prototype.history=function(D,B){return g.default.logAction(g.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(D,B)},v.prototype._history=function(D,B){if(B===void 0)if(typeof D=="function")B=D,D=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"_history",[D]);B=C}var L=this.channel.rest,N=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:N,G=f.defaultGetHeaders(L.options,N);L.options.headers&&f.mixin(G,L.options.headers);var O=this.channel.channelOptions;new m.default(L,this.basePath+"/history",G,M,function(w,T,y){return _.default.fromResponseBody(w,O,y?void 0:N)}).get(D,B)},v})(h.default);a.default=E}),(function(n,a,r){(function(o){Object.defineProperty(a,"__esModule",{value:!0}),a.TransportParams=void 0;var f=r(0),h=f.__importDefault(r(10)),g=f.__importStar(r(1)),m=f.__importStar(r(52)),_=f.__importStar(r(8)),C=f.__importDefault(r(3)),E=f.__importDefault(r(7)),R=f.__importDefault(r(36)),v=f.__importDefault(r(2)),D=f.__importDefault(r(37)),B=f.__importStar(r(21)),L=f.__importStar(r(4)),N=f.__importDefault(r(18)),M=f.__importDefault(r(9)),G=f.__importDefault(r(24)),O=f.__importDefault(r(53)),w=f.__importDefault(r(26)),T=f.__importDefault(r(14)),y=function(){var it;return typeof C.default.WebStorage<"u"&&((it=C.default.WebStorage)===null||it===void 0?void 0:it.localSupported)},z=function(){var it;return typeof C.default.WebStorage<"u"&&((it=C.default.WebStorage)===null||it===void 0?void 0:it.sessionSupported)},U=h.default.Action,P=function(){},K="ably-transport-preference",Q="ably-connection-recovery";function X(){var it,rt;return z()&&((rt=(it=C.default.WebStorage)===null||it===void 0?void 0:it.getSession)===null||rt===void 0?void 0:rt.call(it,Q))}function Y(it){var rt,V;return z()&&((V=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.setSession)===null||V===void 0?void 0:V.call(rt,Q,it))}function j(){var it,rt;return z()&&((rt=(it=C.default.WebStorage)===null||it===void 0?void 0:it.removeSession)===null||rt===void 0?void 0:rt.call(it,Q))}function I(it,rt){return g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,it.shortName)>g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,rt.shortName)}function F(it,rt,V){var J;if(it.channel!==rt.channel||(J=it.action)!==U.PRESENCE&&J!==U.MESSAGE||J!==rt.action)return!1;var $=J===U.PRESENCE?"presence":"messages",at=it[$].concat(rt[$]),ht=M.default.getMessagesSize(at);return ht>V||!g.allSame(at,"clientId")||!g.arrEvery(at,function(Rt){return!Rt.id})?!1:(it[$]=at,!0)}function W(it){try{return JSON.parse(it)}catch{return null}}var nt=(function(){function it(rt,V,J,$){this.options=rt,this.host=V,this.mode=J,this.connectionKey=$,this.format=rt.useBinaryProtocol?g.Format.msgpack:g.Format.json}return it.prototype.getConnectParams=function(rt){var V=rt?g.copy(rt):{},J=this.options;switch(this.mode){case"upgrade":V.upgrade=this.connectionKey;break;case"resume":V.resume=this.connectionKey;break;case"recover":{var $=W(J.recover);$&&(V.recover=$.connectionKey);break}}return J.clientId!==void 0&&(V.clientId=J.clientId),J.echoMessages===!1&&(V.echo="false"),this.format!==void 0&&(V.format=this.format),this.stream!==void 0&&(V.stream=this.stream),this.heartbeats!==void 0&&(V.heartbeats=this.heartbeats),V.v=_.default.protocolVersion,V.agent=(0,_.getAgentString)(this.options),J.transportParams!==void 0&&g.mixin(V,J.transportParams),V},it.prototype.toString=function(){var rt="[mode="+this.mode;return this.host&&(rt+=",host="+this.host),this.connectionKey&&(rt+=",connectionKey="+this.connectionKey),this.format&&(rt+=",format="+this.format),rt+="]",rt},it})();a.TransportParams=nt;var Z=(function(it){f.__extends(rt,it);function rt(V,J){var $=it.call(this)||this;$.disconnectedRetryCount=0,rt.initTransports(),$.realtime=V,$.options=J;var at=J.timeouts,ht=at.preferenceConnectTimeout+at.realtimeRequestTimeout;if($.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:ht,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:at.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:at.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:at.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},$.state=$.states.initialized,$.errorReason=null,$.queuedMessages=new R.default,$.msgSerial=0,$.connectionDetails=void 0,$.connectionId=void 0,$.connectionKey=void 0,$.connectionStateTtl=at.connectionStateTtl,$.maxIdleInterval=null,$.transports=g.intersect(J.transports||_.default.defaultTransports,rt.supportedTransports),$.baseTransport=g.intersect(_.default.baseTransportOrder,$.transports)[0],$.upgradeTransports=g.intersect($.transports,_.default.upgradeTransports),$.transportPreference=null,$.httpHosts=_.default.getHosts(J),$.activeProtocol=null,$.proposedTransports=[],$.pendingTransports=[],$.host=null,$.lastAutoReconnectAttempt=null,$.lastActivity=null,$.forceFallbackHost=!1,$.connectCounter=0,v.default.logAction(v.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(J.transports||_.default.defaultTransports)+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+$.transports+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+$.httpHosts+"]"),!$.transports.length){var Rt="no requested transports available";throw v.default.logAction(v.default.LOG_ERROR,"realtime.ConnectionManager()",Rt),new Error(Rt)}var zt=C.default.Config.addEventListener;return zt&&(z()&&typeof J.recover=="function"&&zt("beforeunload",$.persistConnection.bind($)),J.closeOnUnload===!0&&zt("beforeunload",function(){v.default.logAction(v.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),$.requestState({state:"closing"})}),zt("online",function(){$.state==$.states.disconnected||$.state==$.states.suspended?(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),$.requestState({state:"connecting"})):$.state==$.states.connecting&&($.pendingTransports.forEach(function(Wt){Wt.off()}),$.disconnectAllTransports(),$.startConnect())}),zt("offline",function(){$.state==$.states.connected&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),$.disconnectAllTransports())})),$}return rt.initTransports=function(){(0,O.default)(rt),g.arrForEach(C.default.Transports,function(V){V(rt)})},rt.prototype.createTransportParams=function(V,J){return new nt(this.options,V,J,this.connectionKey)},rt.prototype.getTransportParams=function(V){var J=this,$=function(at){if(J.connectionKey){at("resume");return}if(typeof J.options.recover=="string"){at("recover");return}var ht=J.options.recover,Rt=X();if(Rt&&typeof ht=="function"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),ht(Rt,function(zt){zt?(J.options.recover=Rt.recoveryKey,at("recover")):at("clean")});return}at("clean")};$(function(at){var ht=J.createTransportParams(null,at);if(at==="recover"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+J.options.recover);var Rt=W(J.options.recover);Rt&&(J.msgSerial=Rt.msgSerial)}else v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+ht.toString());V(ht)})},rt.prototype.tryATransport=function(V,J,$){var at=this;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+J),w.default.tryConnect(rt.supportedTransports[J],this,this.realtime.auth,V,function(ht,Rt){var zt=at.state;if(zt==at.states.closing||zt==at.states.closed||zt==at.states.failed){Rt&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+zt.state+" while we were attempting the transport; closing "+Rt),Rt.close()),$(!0);return}if(ht){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+J+" "+ht.event+", err: "+ht.error.toString()),N.default.isTokenErr(ht.error)&&!(at.errorReason&&N.default.isTokenErr(at.errorReason))?(at.errorReason=ht.error,at.realtime.auth._forceNewToken(null,null,function(Wt){if(Wt){at.actOnErrorFromAuthorize(Wt);return}at.tryATransport(V,J,$)})):ht.event==="failed"?(at.notifyState({state:"failed",error:ht.error}),$(!0)):ht.event==="disconnected"&&((0,B.isRetriable)(ht.error)?$(!1):(at.notifyState({state:at.states.connecting.failState,error:ht.error}),$(!0)));return}v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+J+"; setting pending"),at.setTransportPending(Rt,V),$(null,Rt)})},rt.prototype.setTransportPending=function(V,J){var $=this,at=J.mode;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+V+"; mode = "+at),g.arrDeleteValue(this.proposedTransports,V),this.pendingTransports.push(V);var ht=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];V.once("connected",function(zt,Wt,It){at=="upgrade"&&$.activeProtocol?V.shortName!==ht&&g.arrIn($.getUpgradePossibilities(),ht)&&$.activeProtocol?setTimeout(function(){$.scheduleTransportActivation(zt,V,Wt,It)},$.options.timeouts.parallelUpgradeDelay):$.scheduleTransportActivation(zt,V,Wt,It):($.activateTransport(zt,V,Wt,It),C.default.Config.nextTick(function(){$.connectImpl(J)})),at==="recover"&&$.options.recover&&($.options.recover=null,$.unpersistConnection())});var Rt=this;V.on(["disconnected","closed","failed"],function(zt){Rt.deactivateTransport(V,this.event,zt)}),this.emit("transport.pending",V)},rt.prototype.scheduleTransportActivation=function(V,J,$,at){var ht=this,Rt=this.activeProtocol&&this.activeProtocol.getTransport(),zt=function(){J.disconnect(),g.arrDeleteValue(ht.pendingTransports,J)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),zt();return}if(Rt&&!I(J,Rt)){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+" is no better than current active transport "+Rt.shortName+" - abandoning upgrade"),zt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+J);var Wt=null;if(!J.isConnected){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+"is no longer connected; abandoning upgrade"),zt();return}if(this.state===this.states.connected)v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,Wt=this.activeProtocol;else if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),zt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+J);var It=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+J),J.send(h.default.fromValues({action:U.ACTIVATE})),ht.activateTransport(V,J,$,at),ht.state===ht.states.synchronizing?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+J),ht.state=ht.states.connected):v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+ht.state.state+", so leaving unchanged"),ht.state.sendEvents&&ht.sendQueuedMessages()};Wt?Wt.onceIdle(It):It()},rt.prototype.activateTransport=function(V,J,$,at){var ht=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+J),V&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+V),$&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+$),at&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(at)),this.persistTransportPreference(J);var Rt=this.state,zt=this.states.connected.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+Rt.state),Rt.state==this.states.closing.state||Rt.state==this.states.closed.state||Rt.state==this.states.failed.state)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),J.disconnect(),!1;if(g.arrDeleteValue(this.pendingTransports,J),!J.isConnected)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+J+" since it appears to no longer be connected"),!1;var Wt=this.activeProtocol;this.activeProtocol=new m.default(J),this.host=J.params.host;var It=at.connectionKey;if(It&&this.connectionKey!=It&&this.setConnection($,at,!!V),this.onConnectionDetailsUpdate(at,J),C.default.Config.nextTick(function(){J.on("connected",function(Bt,Te,ze){ht.onConnectionDetailsUpdate(ze,J),ht.emit("update",new D.default(zt,zt,null,Bt))})}),Rt.state===this.states.connected.state?V&&(this.errorReason=this.realtime.connection.errorReason=V,this.emit("update",new D.default(zt,zt,null,V))):(this.notifyState({state:"connected",error:V}),this.errorReason=this.realtime.connection.errorReason=V||null),this.emit("transport.active",J),Wt)if(Wt.messageQueue.count()>0&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+Wt.transport.shortName+", new one is "+J.shortName+") finishing with "+Wt.messageQueue.count()+" messages still pending"),Wt.transport===J){var pe="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",pe)}else Wt.finish();return g.safeArrForEach(this.pendingTransports,function(Bt){if(Bt===J){var Te="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",Te),g.arrDeleteValue(ht.pendingTransports,J)}else Bt.disconnect()}),g.safeArrForEach(this.proposedTransports,function(Bt){Bt===J?(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+J.shortName+"; stack = "+new Error().stack),g.arrDeleteValue(ht.proposedTransports,J)):Bt.dispose()}),!0},rt.prototype.deactivateTransport=function(V,J,$){var at=this.activeProtocol,ht=at&&at.getTransport()===V,Rt=g.arrDeleteValue(this.pendingTransports,V),zt=g.arrDeleteValue(this.proposedTransports,V),Wt=this.noTransportsScheduledForActivation();if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+V),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+J+(ht?"; was active":Rt?"; was pending":zt?"; was proposed":"")+(Wt?"":"; another transport is scheduled for activation")),$&&$.message&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+$.message),ht&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(at.getPendingMessages()),C.default.Config.nextTick(function(){at.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",V),ht&&Wt||ht&&J==="failed"||J==="closed"||at===null&&Rt&&this.pendingTransports.length===0){if(J==="disconnected"&&$&&$.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:J,error:$,retryImmediately:!0});return}var It=J==="failed"&&N.default.isTokenErr($)?"disconnected":J;this.notifyState({state:It,error:$});return}ht&&J==="disconnected"&&this.state!==this.states.synchronizing&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:$}))},rt.prototype.noTransportsScheduledForActivation=function(){return g.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(V){return!V.isConnected})},rt.prototype.setConnection=function(V,J,$){var at=this.connectionId,ht=at&&at!==V,Rt=!at&&$;(ht||Rt)&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==V&&v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=V,this.realtime.connection.key=this.connectionKey=J.connectionKey},rt.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},rt.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},rt.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var V=g.now()-this.lastActivity;V>this.connectionStateTtl+this.maxIdleInterval&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+V+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},rt.prototype.persistConnection=function(){if(z()){var V=this.createRecoveryKey();V&&Y({recoveryKey:V,disconnectedAt:g.now(),location:o.location,clientId:this.realtime.auth.clientId})}},rt.prototype.unpersistConnection=function(){j()},rt.prototype.getError=function(){return this.errorReason||this.getStateError()},rt.prototype.getStateError=function(){var V,J;return(J=(V=B.default)[this.state.state])===null||J===void 0?void 0:J.call(V)},rt.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},rt.prototype.enactStateChange=function(V){var J=V.current==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(J,"Connection state",V.current+(V.reason?"; reason: "+V.reason:"")),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+V.current+"; reason = "+(V.reason&&V.reason.message));var $=this.state=this.states[V.current];V.reason&&(this.errorReason=V.reason,this.realtime.connection.errorReason=V.reason),($.terminal||$.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",V)},rt.prototype.startTransitionTimer=function(V){var J=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+V.state),this.transitionTimer&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){J.transitionTimer&&(J.transitionTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager "+V.state+" timer expired","requesting new state: "+V.failState),J.notifyState({state:V.failState}))},V.retryDelay)},rt.prototype.cancelTransitionTimer=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},rt.prototype.startSuspendTimer=function(){var V=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){V.suspendTimer&&(V.suspendTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),V.states.connecting.failState="suspended",V.notifyState({state:"suspended"}))},this.connectionStateTtl))},rt.prototype.checkSuspendTimer=function(V){V!=="disconnected"&&V!=="suspended"&&V!=="connecting"&&this.cancelSuspendTimer()},rt.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},rt.prototype.startRetryTimer=function(V){var J=this;this.retryTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),J.retryTimer=null,J.requestState({state:"connecting"})},V)},rt.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},rt.prototype.notifyState=function(V){var J=this,$,at,ht=V.state,Rt=ht==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||V.retryImmediately||this.state===this.states.connecting&&V.error&&N.default.isTokenErr(V.error)&&!(this.errorReason&&N.default.isTokenErr(this.errorReason)));if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+ht+(Rt?"; will retry connection immediately":"")),ht!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(V.state),(ht==="suspended"||ht==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var zt=this.states[V.state],Wt=zt.retryDelay;zt.state==="disconnected"&&(this.disconnectedRetryCount++,Wt=g.getRetryTime(zt.retryDelay,this.disconnectedRetryCount));var It=new D.default(this.state.state,zt.state,Wt,V.error||((at=($=B.default)[zt.state])===null||at===void 0?void 0:at.call($)));if(Rt){var pe=function(){J.state===J.states.disconnected&&(J.lastAutoReconnectAttempt=g.now(),J.requestState({state:"connecting"}))},Bt=this.lastAutoReconnectAttempt&&g.now()-this.lastAutoReconnectAttempt+1;Bt&&Bt<1e3?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+Bt+"ms ago, waiting another "+(1e3-Bt)+"ms before trying again"),setTimeout(pe,1e3-Bt)):C.default.Config.nextTick(pe)}else(ht==="disconnected"||ht==="suspended")&&this.startRetryTimer(Wt);(ht==="disconnected"&&!Rt||ht==="suspended"||zt.terminal)&&C.default.Config.nextTick(function(){J.disconnectAllTransports()}),ht=="connected"&&!this.activeProtocol&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(It),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(ht,It.reason),this.failQueuedMessages(It.reason))}},rt.prototype.requestState=function(V){var J=this,$,at,ht=V.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+ht+"; current state: "+this.state.state),ht!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(ht),!(ht=="connecting"&&this.state.state=="connected")&&!(ht=="closing"&&this.state.state=="closed"))){var Rt=this.states[ht],zt=new D.default(this.state.state,Rt.state,null,V.error||((at=($=B.default)[Rt.state])===null||at===void 0?void 0:at.call($)));this.enactStateChange(zt),ht=="connecting"&&C.default.Config.nextTick(function(){J.startConnect()}),ht=="closing"&&this.closeImpl()}},rt.prototype.startConnect=function(){var V=this;if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var J=this.realtime.auth,$=++this.connectCounter,at=function(){V.checkConnectionStateFreshness(),V.getTransportParams(function(Rt){if(Rt.mode==="recover"&&Rt.options.recover){var zt=W(Rt.options.recover);zt&&V.realtime.channels.recoverChannels(zt.channelSerials)}$===V.connectCounter&&V.connectImpl(Rt,$)})};if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),J.method==="basic")at();else{var ht=function(Rt){$===V.connectCounter&&(Rt?V.actOnErrorFromAuthorize(Rt):at())};this.errorReason&&N.default.isTokenErr(this.errorReason)?J._forceNewToken(null,null,ht):J._ensureValidAuthCredentials(!1,ht)}},rt.prototype.connectImpl=function(V,J){var $=this.state.state;$!==this.states.connecting.state&&$!==this.states.connected.state?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+$):this.pendingTransports.length?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):$==this.states.connected.state?this.upgradeIfNeeded(V):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(V,J):this.connectBase(V,J)},rt.prototype.connectPreference=function(V,J){var $=this,at=this.getTransportPreference(),ht=!1;g.arrIn(this.transports,at)||(this.unpersistTransportPreference(),this.connectImpl(V,J)),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+at);var Rt=setTimeout(function(){ht=!0,$.state.state!==$.states.connected.state&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+at+" failed; clearing preference and trying from scratch"),$.disconnectAllTransports(),$.unpersistTransportPreference()),$.connectImpl(V,J)},this.options.timeouts.preferenceConnectTimeout);V.host=this.httpHosts[0],this.tryATransport(V,at,function(zt,Wt){clearTimeout(Rt),ht&&Wt?(Wt.off(),Wt.disconnect(),g.arrDeleteValue($.pendingTransports,Wt)):!Wt&&!zt&&($.unpersistTransportPreference(),$.connectImpl(V,J))})},rt.prototype.connectBase=function(V,J){var $=this,at=function(It){$.notifyState({state:$.states.connecting.failState,error:It})},ht=this.httpHosts.slice(),Rt=function(It,pe){J===$.connectCounter&&!pe&&!It&&Wt()};v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var zt=ht.shift();if(!zt){at(new L.default("Unable to connect (no available host)",80003,404));return}V.host=zt;var Wt=function(){if(!ht.length){at(new L.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!$.realtime.http.checkConnectivity){at(new L.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}$.realtime.http.checkConnectivity(function(It,pe){if(J===$.connectCounter){if(It){at(It);return}if(!pe){at(new L.default("Unable to connect (network unreachable)",80003,404));return}V.host=g.arrPopRandomElement(ht),$.tryATransport(V,$.baseTransport,Rt)}})};if(this.forceFallbackHost&&ht.length){this.forceFallbackHost=!1,Wt();return}this.tryATransport(V,this.baseTransport,Rt)},rt.prototype.getUpgradePossibilities=function(){var V=this.activeProtocol.getTransport().shortName,J=g.arrIndexOf(this.upgradeTransports,V);return this.upgradeTransports.slice(J+1)},rt.prototype.upgradeIfNeeded=function(V){var J=this,$=this.getUpgradePossibilities();v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect($)),$.length&&g.arrForEach($,function(at){var ht=J.createTransportParams(V.host,"upgrade");J.tryATransport(ht,at,P)})},rt.prototype.closeImpl=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),g.safeArrForEach(this.pendingTransports,function(V){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+V),V&&V.close()}),g.safeArrForEach(this.proposedTransports,function(V){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+V),V&&V.dispose()}),this.activeProtocol&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},rt.prototype.onAuthUpdated=function(V,J){var $=this,at;switch(this.state.state){case"connected":{if(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var ht=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){$.state.state==="connected"&&$.upgradeIfNeeded(ht)})}var Rt=(at=this.activeProtocol)===null||at===void 0?void 0:at.getTransport();Rt&&Rt.onAuthUpdated&&Rt.onAuthUpdated(V);var zt=h.default.fromValues({action:U.AUTH,auth:{accessToken:V.token}});this.send(zt);var Wt=function(){$.off(It),J(null,V)},It=function(Bt){Bt.current==="failed"&&($.off(Wt),$.off(It),J(Bt.reason||$.getStateError()))};this.once("connectiondetails",Wt),this.on("connectionstate",It);break}case"connecting":v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var pe=function(Bt){switch(Bt.current){case"connected":$.off(pe),J(null,V);break;case"failed":case"closed":case"suspended":$.off(pe),J(Bt.reason||$.getStateError());break}};this.on("connectionstate",pe),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},rt.prototype.disconnectAllTransports=function(V){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(V?" except the active transport":"")),this.connectCounter++,g.safeArrForEach(this.pendingTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+J),J&&J.disconnect()}),this.pendingTransports=[],g.safeArrForEach(this.proposedTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+J),J&&J.dispose()}),this.proposedTransports=[],this.activeProtocol&&!V&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},rt.prototype.send=function(V,J,$){$=$||P;var at=this.state;if(at.sendEvents){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new m.PendingMessage(V,$));return}var ht=J&&at.queueEvents||at.forceQueueEvents;if(!ht){var Rt="rejecting event, queueEvent was "+J+", state was "+at.state;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()",Rt),$(this.errorReason||new L.default(Rt,9e4,400));return}v.default.shouldLog(v.default.LOG_MICRO)&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+h.default.stringify(V)),this.queue(V,$)},rt.prototype.sendImpl=function(V){var J=V.message;V.ackRequired&&!V.sendAttempted&&(J.msgSerial=this.msgSerial++);try{this.activeProtocol.send(V)}catch($){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+$.stack)}},rt.prototype.queue=function(V,J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var $=this.queuedMessages.last(),at=this.options.maxMessageSize;$&&!$.sendAttempted&&F($.message,V,at)?($.merged||($.callback=G.default.create([$.callback]),$.merged=!0),$.callback.push(J)):this.queuedMessages.push(new m.PendingMessage(V,J))},rt.prototype.sendQueuedMessages=function(){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var V;V=this.queuedMessages.shift();)this.sendImpl(V)},rt.prototype.queuePendingMessages=function(V){V&&V.length&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+V.length+" pending messages"),this.queuedMessages.prepend(V))},rt.prototype.failQueuedMessages=function(V){var J=this.queuedMessages.count();J>0&&(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+J+" queued messages, err = "+g.inspectError(V)),this.queuedMessages.completeAllMessages(V))},rt.prototype.onChannelMessage=function(V,J){var $=this.activeProtocol&&J===this.activeProtocol.getTransport(),at=g.arrIn(this.pendingTransports,J)&&this.state==this.states.synchronizing;$||at?this.realtime.channels.onChannelMessage(V):g.arrIndexOf([U.ACK,U.NACK,U.ERROR],V.action)>-1?this.realtime.channels.onChannelMessage(V):v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(V)+"on defunct transport; discarding")},rt.prototype.ping=function(V,J){var $=this;if(V){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+V);var at=function(){V.off("heartbeat",zt),J(new L.default("Timeout waiting for heartbeat response",5e4,500))},ht=g.now(),Rt=g.cheapRandStr(),zt=function(Te){if(Te===Rt){V.off("heartbeat",zt),clearTimeout(Wt);var ze=g.now()-ht;J(null,ze)}},Wt=setTimeout(at,this.options.timeouts.realtimeRequestTimeout);V.on("heartbeat",zt),V.ping(Rt);return}if(this.state.state!=="connected"){J(new L.default("Unable to ping service; not connected",4e4,400));return}var It=!1,pe=function(Te,ze){$.off("transport.active",Bt),It||(It=!0,J(Te,ze))},Bt=function(){It||(It=!0,C.default.Config.nextTick(function(){$.ping(null,J)}))};this.on("transport.active",Bt),this.ping(this.activeProtocol.getTransport(),pe)},rt.prototype.abort=function(V){this.activeProtocol.getTransport().fail(V)},rt.prototype.registerProposedTransport=function(V){this.proposedTransports.push(V)},rt.prototype.getTransportPreference=function(){var V,J;return this.transportPreference||y()&&((J=(V=C.default.WebStorage)===null||V===void 0?void 0:V.get)===null||J===void 0?void 0:J.call(V,K))},rt.prototype.persistTransportPreference=function(V){var J,$;g.arrIn(_.default.upgradeTransports,V.shortName)&&(this.transportPreference=V.shortName,y()&&(($=(J=C.default.WebStorage)===null||J===void 0?void 0:J.set)===null||$===void 0||$.call(J,K,V.shortName)))},rt.prototype.unpersistTransportPreference=function(){var V,J;this.transportPreference=null,y()&&((J=(V=C.default.WebStorage)===null||V===void 0?void 0:V.remove)===null||J===void 0||J.call(V,K))},rt.prototype.actOnErrorFromAuthorize=function(V){if(V.code===40171)this.notifyState({state:"failed",error:V});else if(V.code===40102)this.notifyState({state:"failed",error:V});else if(V.statusCode===T.default.Forbidden){var J="Client configured authentication provider returned 403; failing the connection";v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",J),this.notifyState({state:"failed",error:new L.default(J,80019,403,V)})}else{var J="Client configured authentication provider request failed";v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",J),this.notifyState({state:this.state.failState,error:new L.default(J,80019,401,V)})}},rt.prototype.onConnectionDetailsUpdate=function(V,J){if(V){this.connectionDetails=V,V.maxMessageSize&&(this.options.maxMessageSize=V.maxMessageSize);var $=V.clientId;if($){var at=this.realtime.auth._uncheckedSetClientId($);if(at){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",at.message),J.fail(at);return}}var ht=V.connectionStateTtl;ht&&(this.connectionStateTtl=ht),this.maxIdleInterval=V.maxIdleInterval,this.emit("connectiondetails",V)}},rt.supportedTransports={},rt})(E.default);a.default=Z}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(7)),h=o.__importDefault(r(2)),g=(function(m){o.__extends(_,m);function _(){var C=m.call(this)||this;return C.messages=[],C}return _.prototype.count=function(){return this.messages.length},_.prototype.push=function(C){this.messages.push(C)},_.prototype.shift=function(){return this.messages.shift()},_.prototype.last=function(){return this.messages[this.messages.length-1]},_.prototype.copyAll=function(){return this.messages.slice()},_.prototype.append=function(C){this.messages.push.apply(this.messages,C)},_.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},_.prototype.completeMessages=function(C,E,R){h.default.logAction(h.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+E),R=R||null;var v=this.messages;if(v.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var D=v[0];if(D){var B=D.message.msgSerial,L=C+E;if(L>B)for(var N=v.splice(0,L-B),M=0,G=N;M<G.length;M++){var O=G[M];O.callback(R)}v.length==0&&this.emit("idle")}},_.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},_.prototype.resetSendAttempted=function(){for(var C=0,E=this.messages;C<E.length;C++){var R=E[C];R.sendAttempted=!1}},_.prototype.clear=function(){h.default.logAction(h.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},_})(f.default);a.default=g}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=(function(){function f(h,g,m,_){this.previous=h,this.current=g,m&&(this.retryIn=m),_&&(this.reason=_)}return f})();a.default=o}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(10)),h=o.__importDefault(r(7)),g=o.__importStar(r(1)),m=o.__importDefault(r(33)),_=o.__importDefault(r(2)),C=o.__importDefault(r(54)),E=o.__importDefault(r(9)),R=o.__importDefault(r(39)),v=o.__importStar(r(4)),D=o.__importDefault(r(16)),B=o.__importDefault(r(21)),L=f.default.Action,N=function(){};function M(w){if(w&&"params"in w&&!g.isObject(w.params))return new v.default("options.params must be an object",4e4,400);if(w&&"modes"in w){if(!g.isArray(w.modes))return new v.default("options.modes must be an array",4e4,400);for(var T=0;T<w.modes.length;T++){var y=w.modes[T];if(!y||typeof y!="string"||!g.arrIn(f.default.channelModes,String.prototype.toUpperCase.call(y)))return new v.default("Invalid channel mode: "+y,4e4,400)}}}var G=(function(w){o.__extends(T,w);function T(y,z,U){var P=w.call(this,y,z,U)||this;return P.retryCount=0,P.history=function(K,Q){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),Q===void 0)if(typeof K=="function")Q=K,K=null;else{if(this.rest.options.promises)return g.promisify(this,"history",arguments);Q=N}if(K&&K.untilAttach){if(this.state!=="attached"){Q(new v.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){Q(new v.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete K.untilAttach,K.from_serial=this.properties.attachSerial}m.default.prototype._history.call(this,K,Q)},P.whenState=(function(K,Q){return h.default.prototype.whenState.call(P,K,P.state,Q)}),_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel()","started; name = "+z),P.realtime=y,P.presence=new C.default(P),P.connectionManager=y.connection.connectionManager,P.state="initialized",P.subscriptions=new h.default,P.syncChannelSerial=void 0,P.properties={attachSerial:void 0,channelSerial:void 0},P.setOptions(U),P.errorReason=null,P._requestedFlags=null,P._mode=null,P._attachResume=!1,P._decodingContext={channelOptions:P.channelOptions,plugins:y.options.plugins||{},baseEncodedPreviousPayload:void 0},P._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},P._allChannelChanges=new h.default,P}return T.prototype.invalidStateError=function(){return new v.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},T.processListenerArgs=function(y){return y=Array.prototype.slice.call(y),typeof y[0]=="function"&&y.unshift(null),y[y.length-1]==null&&y.pop(),y},T.prototype.setOptions=function(y,z){var U=this.channelOptions;if(!z&&this.rest.options.promises)return g.promisify(this,"setOptions",arguments);var P=z||function(Q){Q&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+Q.toString())},K=M(y);if(K){P(K);return}m.default.prototype.setOptions.call(this,y),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(y,U)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(Q){switch(this.event){case"update":case"attached":P==null||P(null);return;default:P==null||P(Q.reason);return}})):P()},T.prototype._shouldReattachToSetOptions=function(y,z){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(y!=null&&y.params){var U=O(y.params),P=O(z.params);if(Object.keys(U).length!==Object.keys(P).length||!g.shallowEquals(P,U))return!0}return!!(y!=null&&y.modes&&(!z.modes||!g.arrEquals(y.modes,z.modes)))},T.prototype.publish=function(){for(var y=this,z=[],U=0;U<arguments.length;U++)z[U]=arguments[U];var P=z[0],K=z.length,Q=z[K-1];if(typeof Q!="function"){if(this.realtime.options.promises)return g.promisify(this,"publish",arguments);Q=N,++K}if(!this.connectionManager.activeState()){Q(this.connectionManager.getError());return}if(K==2)if(g.isObject(P))P=[E.default.fromValues(P)];else if(g.isArray(P))P=E.default.fromValuesArray(P);else throw new v.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else P=[E.default.fromValues({name:z[0],data:z[1]})];var X=this.realtime.options.maxMessageSize;E.default.encodeArray(P,this.channelOptions,function(Y){if(Y){Q(Y);return}var j=E.default.getMessagesSize(P);if(j>X){Q(new v.default("Maximum size of messages that can be published at once exceeded ( was "+j+" bytes; limit is "+X+" bytes)",40009,400));return}y.__publish(P,Q)})},T.prototype.__publish=function(y,z){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+y.length);var U=this.state;switch(U){case"failed":case"suspended":z(v.default.fromValues(this.invalidStateError()));break;default:{_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+U);var P=new f.default;P.action=L.MESSAGE,P.channel=this.name,P.messages=y,this.sendMessage(P,z);break}}},T.prototype.onEvent=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var z=this.subscriptions,U=0;U<y.length;U++){var P=y[U];z.emit(P.name,P)}},T.prototype.attach=function(y,z){var U;if(typeof y=="function"?(z=y,U=null):U=y,!z){if(this.realtime.options.promises)return g.promisify(this,"attach",arguments);z=function(P){P&&_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+P.toString())}}if(U)_.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=U;else if(this.state==="attached"){z(null,null);return}this._attach(!1,null,z)},T.prototype._attach=function(y,z,U){U||(U=function(K){K&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+K.toString())});var P=this.connectionManager;if(!P.activeState()){U(P.getError());return}(this.state!=="attaching"||y)&&this.requestState("attaching",z),this.once(function(K){switch(this.event){case"attached":U==null||U(null,K);break;case"detached":case"suspended":case"failed":U==null||U(K.reason||P.getError()||new v.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":U==null||U(new v.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},T.prototype.attachImpl=function(){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var y=f.default.fromValues({action:L.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?y.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&y.encodeModesToFlags(g.allToUpperCase(this.channelOptions.modes)),this._attachResume&&y.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(y.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(y,N)},T.prototype.detach=function(y){if(!y){if(this.realtime.options.promises)return g.promisify(this,"detach",arguments);y=N}var z=this.connectionManager;if(!z.activeState()){y(z.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),y();break;case"detached":y();break;case"failed":y(new v.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(U){switch(this.event){case"detached":y();break;case"attached":case"suspended":case"failed":y(U.reason||z.getError()||new v.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":y(new v.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},T.prototype.detachImpl=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var z=f.default.fromValues({action:L.DETACH,channel:this.name});this.sendMessage(z,y||N)},T.prototype.subscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=T.processListenerArgs(y),P=U[0],K=U[1],Q=U[2];if(!Q&&this.realtime.options.promises)return g.promisify(this,"subscribe",[P,K]);if(this.state==="failed"){Q==null||Q(v.default.fromValues(this.invalidStateError()));return}return P&&typeof P=="object"&&!Array.isArray(P)?this._subscribeFilter(P,K):this.subscriptions.on(P,K),this.attach(Q||N)},T.prototype._subscribeFilter=function(y,z){var U=function(P){var K,Q,X,Y,j,I,F={name:P.name,refTimeserial:(Q=(K=P.extras)===null||K===void 0?void 0:K.ref)===null||Q===void 0?void 0:Q.timeserial,refType:(Y=(X=P.extras)===null||X===void 0?void 0:X.ref)===null||Y===void 0?void 0:Y.type,isRef:!!(!((I=(j=P.extras)===null||j===void 0?void 0:j.ref)===null||I===void 0)&&I.timeserial),clientId:P.clientId};Object.entries(y).find(function(W){var nt=W[0],Z=W[1];return Z!==void 0?F[nt]!==Z:!1})||z(P)};this._addFilteredSubscription(y,z,U),this.subscriptions.on(U)},T.prototype._addFilteredSubscription=function(y,z,U){var P;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(z)){var K=this.filteredSubscriptions.get(z);K.set(y,((P=K==null?void 0:K.get(y))===null||P===void 0?void 0:P.concat(U))||[U])}else this.filteredSubscriptions.set(z,new Map([[y,[U]]]))},T.prototype._getAndDeleteFilteredSubscriptions=function(y,z){var U=this;if(!this.filteredSubscriptions)return[];if(!z&&y)return Array.from(this.filteredSubscriptions.entries()).map(function(X){var Y,j=X[0],I=X[1],F=I.get(y);return I.delete(y),I.size===0&&((Y=U.filteredSubscriptions)===null||Y===void 0||Y.delete(j)),F}).reduce(function(X,Y){var j;return Y?(j=X).concat.apply(j,Y):X},[]);if(!z||!this.filteredSubscriptions.has(z))return[];var P=this.filteredSubscriptions.get(z);if(!y){var K=Array.from(P.values()).reduce(function(X,Y){return X.concat.apply(X,Y)},[]);return this.filteredSubscriptions.delete(z),K}var Q=P.get(y);return P.delete(y),Q||[]},T.prototype.unsubscribe=function(){for(var y=this,z,U=[],P=0;P<arguments.length;P++)U[P]=arguments[P];var K=T.processListenerArgs(U),Q=K[0],X=K[1];if(typeof Q=="object"&&!X||!((z=this.filteredSubscriptions)===null||z===void 0)&&z.has(X)){this._getAndDeleteFilteredSubscriptions(Q,X).forEach(function(Y){return y.subscriptions.off(Y)});return}this.subscriptions.off(Q,X)},T.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new v.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var y=this.connectionManager;if(!y.activeState())throw y.getError();var z=f.default.fromValues({action:L.SYNC,channel:this.name});this.syncChannelSerial&&(z.channelSerial=this.syncChannelSerial),y.send(z)},T.prototype.sendMessage=function(y,z){this.connectionManager.send(y,this.realtime.options.queueMessages,z)},T.prototype.sendPresence=function(y,z){var U=f.default.fromValues({action:L.PRESENCE,channel:this.name,presence:g.isArray(y)?D.default.fromValuesArray(y):[D.default.fromValues(y)]});this.sendMessage(U,z)},T.prototype.onMessage=function(y){(y.action===L.ATTACHED||y.action===L.MESSAGE||y.action===L.PRESENCE)&&this.setChannelSerial(y.channelSerial);var z,U=!1;switch(y.action){case L.ATTACHED:{this.properties.attachSerial=y.channelSerial,this._mode=y.getMode(),this.params=y.params||{};var P=y.decodeModesFromFlags();this.modes=P&&g.allToLowerCase(P)||void 0;var K=y.hasFlag("RESUMED"),Q=y.hasFlag("HAS_PRESENCE"),X=y.hasFlag("HAS_BACKLOG");if(this.state==="attached"){K||this.presence.onAttached(Q);var Y=new R.default(this.state,this.state,K,X,y.error);this._allChannelChanges.emit("update",Y),(!K||this.channelOptions.updateOnAttached)&&this.emit("update",Y)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",y.error,K,Q,X);break}case L.DETACHED:{var j=y.error?v.default.fromValues(y.error):new v.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",j):this.state==="attaching"?this.notifyState("suspended",j):this.requestState("attaching",j);break}case L.SYNC:if(U=!0,z=this.syncChannelSerial=y.channelSerial,!y.presence)break;case L.PRESENCE:{for(var I=y.presence,F=y.id,W=y.connectionId,nt=y.timestamp,Z=this.channelOptions,it=void 0,rt=0;rt<I.length;rt++)try{it=I[rt],D.default.decode(it,Z),it.connectionId||(it.connectionId=W),it.timestamp||(it.timestamp=nt),it.id||(it.id=F+":"+rt)}catch(Rt){_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",Rt.toString())}this.presence.setPresence(I,U,z);break}case L.MESSAGE:{if(this.state!=="attached"){_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+y.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var V=y.messages,J=V[0],$=V[V.length-1],F=y.id,W=y.connectionId,nt=y.timestamp;if(J.extras&&J.extras.delta&&J.extras.delta.from!==this._lastPayload.messageId){var at='Delta message decode failure - previous message not available for message "'+y.id+'" on this channel "'+this.name+'".';_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",at),this._startDecodeFailureRecovery(new v.default(at,40018,400));break}for(var rt=0;rt<V.length;rt++){var at=V[rt];try{E.default.decode(at,this._decodingContext)}catch(Bt){switch(_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",Bt.toString()),Bt.code){case 40018:this._startDecodeFailureRecovery(Bt);return;case 40019:case 40021:this.notifyState("failed",Bt);return}}at.connectionId||(at.connectionId=W),at.timestamp||(at.timestamp=nt),at.id||(at.id=F+":"+rt)}this._lastPayload.messageId=$.id,this._lastPayload.protocolMessageChannelSerial=y.channelSerial,this.onEvent(V);break}case L.ERROR:{var ht=y.error;ht&&ht.code==80016?this.checkPendingState():this.notifyState("failed",v.default.fromValues(ht));break}default:_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+y.action+")"),this.connectionManager.abort(B.default.unknownChannelErr())}},T.prototype._startDecodeFailureRecovery=function(y){var z=this;this._lastPayload.decodeFailureRecoveryInProgress||(_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,y,function(){z._lastPayload.decodeFailureRecoveryInProgress=!1}))},T.prototype.onAttached=function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},T.prototype.notifyState=function(y,z,U,P,K){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+y),this.clearStateTimer(),g.arrIn(["detached","suspended","failed"],y)&&(this.properties.channelSerial=null),y!==this.state){this.presence.actOnChannelState(y,P,z),y==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),z&&(this.errorReason=z);var Q=new R.default(this.state,y,U,K,z),X=y==="failed"?_.default.LOG_ERROR:_.default.LOG_MAJOR;_.default.logAction(X,'Channel state for channel "'+this.name+'"',y+(z?"; reason: "+z:"")),y!=="attaching"&&y!=="suspended"&&(this.retryCount=0),y==="attached"&&this.onAttached(),y==="attached"?this._attachResume=!0:(y==="detaching"||y==="failed")&&(this._attachResume=!1),this.state=y,this._allChannelChanges.emit(y,Q),this.emit(y,Q)}},T.prototype.requestState=function(y,z){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+y),this.notifyState(y,z),this.checkPendingState()},T.prototype.checkPendingState=function(){var y=this.connectionManager.state;if(!(y.sendEvents||y.forceQueueEvents)){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},T.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var y=new v.default("Channel attach timed out",90007,408);this.notifyState("suspended",y);break}case"detaching":{var y=new v.default("Channel detach timed out",90007,408);this.notifyState("attached",y);break}default:this.checkPendingState();break}},T.prototype.startStateTimerIfNotRunning=function(){var y=this;this.stateTimer||(this.stateTimer=setTimeout(function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),y.stateTimer=null,y.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},T.prototype.clearStateTimer=function(){var y=this.stateTimer;y&&(clearTimeout(y),this.stateTimer=null)},T.prototype.startRetryTimer=function(){var y=this;if(!this.retryTimer){this.retryCount++;var z=g.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){y.state==="suspended"&&y.connectionManager.state.sendEvents&&(y.retryTimer=null,_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),y.requestState("attaching"))},z)}},T.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},T.prototype.getReleaseErr=function(){var y=this.state;return y==="initialized"||y==="detached"||y==="failed"?null:new v.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+y,90001,400)},T.prototype.setChannelSerial=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+y+"; previous = "+this.properties.channelSerial),y&&(this.properties.channelSerial=y)},T})(m.default);function O(w){var T=w||{};T.agent;var y=o.__rest(T,["agent"]);return y}a.default=G}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=(function(){function f(h,g,m,_,C){this.previous=h,this.current=g,g==="attached"&&(this.resumed=m,this.hasBacklog=_),C&&(this.reason=C)}return f})();a.default=o}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.WordArray,m=h.Hasher,_=f.algo,C=[],E=_.SHA1=m.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(R,v){for(var D=this._hash.words,B=D[0],L=D[1],N=D[2],M=D[3],G=D[4],O=0;O<80;O++){if(O<16)C[O]=R[v+O]|0;else{var w=C[O-3]^C[O-8]^C[O-14]^C[O-16];C[O]=w<<1|w>>>31}var T=(B<<5|B>>>27)+G+C[O];O<20?T+=(L&N|~L&M)+1518500249:O<40?T+=(L^N^M)+1859775393:O<60?T+=(L&N|L&M|N&M)-1894007588:T+=(L^N^M)-899497514,G=M,M=N,N=L<<30|L>>>2,L=B,B=T}D[0]=D[0]+B|0,D[1]=D[1]+L|0,D[2]=D[2]+N|0,D[3]=D[3]+M|0,D[4]=D[4]+G|0},_doFinalize:function(){var R=this._data,v=R.words,D=this._nDataBytes*8,B=R.sigBytes*8;return v[B>>>5]|=128<<24-B%32,v[(B+64>>>9<<4)+14]=Math.floor(D/4294967296),v[(B+64>>>9<<4)+15]=D,R.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var R=m.clone.call(this);return R._hash=this._hash.clone(),R}});f.SHA1=m._createHelper(E),f.HmacSHA1=m._createHmacHelper(E)})(),o.SHA1})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});function o(O){if(O===void 0)return"undefined";var w,T;if(O instanceof ArrayBuffer?(T="ArrayBuffer",w=new DataView(O)):O instanceof DataView&&(T="DataView",w=O),!w)return JSON.stringify(O);for(var y=[],z=0;z<O.byteLength;z++){if(z>20){y.push("...");break}var U=w.getUint8(z).toString(16);U.length===1&&(U="0"+U),y.push(U)}return"<"+T+" "+y.join(" ")+">"}function f(O,w,T){for(var y=0,z=T.length;y<z;y++){var U=T.charCodeAt(y);if(U<128){O.setUint8(w++,U>>>0&127|0);continue}if(U<2048){O.setUint8(w++,U>>>6&31|192),O.setUint8(w++,U>>>0&63|128);continue}if(U<65536){O.setUint8(w++,U>>>12&15|224),O.setUint8(w++,U>>>6&63|128),O.setUint8(w++,U>>>0&63|128);continue}if(U<1114112){O.setUint8(w++,U>>>18&7|240),O.setUint8(w++,U>>>12&63|128),O.setUint8(w++,U>>>6&63|128),O.setUint8(w++,U>>>0&63|128);continue}throw new Error("bad codepoint "+U)}}function h(O,w,T){for(var y="",z=w,U=w+T;z<U;z++){var P=O.getUint8(z);if((P&128)===0){y+=String.fromCharCode(P);continue}if((P&224)===192){y+=String.fromCharCode((P&15)<<6|O.getUint8(++z)&63);continue}if((P&240)===224){y+=String.fromCharCode((P&15)<<12|(O.getUint8(++z)&63)<<6|(O.getUint8(++z)&63)<<0);continue}if((P&248)===240){y+=String.fromCharCode((P&7)<<18|(O.getUint8(++z)&63)<<12|(O.getUint8(++z)&63)<<6|(O.getUint8(++z)&63)<<0);continue}throw new Error("Invalid byte "+P.toString(16))}return y}function g(O){for(var w=0,T=0,y=O.length;T<y;T++){var z=O.charCodeAt(T);if(z<128){w+=1;continue}if(z<2048){w+=2;continue}if(z<65536){w+=3;continue}if(z<1114112){w+=4;continue}throw new Error("bad codepoint "+z)}return w}function m(O,w){var T=G(O,w);if(T!==0){var y=new ArrayBuffer(T),z=new DataView(y);return M(O,z,0,w),y}}var _=65536*65536,C=1/_;function E(O,w){return w=w||0,O.getInt32(w)*_+O.getUint32(w+4)}function R(O,w){return w=w||0,O.getUint32(w)*_+O.getUint32(w+4)}function v(O,w,T){T<9223372036854776e3?(O.setInt32(w,Math.floor(T*C)),O.setInt32(w+4,T&-1)):(O.setUint32(w,2147483647),O.setUint32(w+4,2147483647))}function D(O,w,T){T<18446744073709552e3?(O.setUint32(w,Math.floor(T*C)),O.setInt32(w+4,T&-1)):(O.setUint32(w,4294967295),O.setUint32(w+4,4294967295))}var B=(function(){function O(w,T){var y=this;this.map=function(z){for(var U={},P=0;P<z;P++){var K=y.parse();U[K]=y.parse()}return U},this.bin=function(z){var U=new ArrayBuffer(z);return new Uint8Array(U).set(new Uint8Array(y.view.buffer,y.offset,z),0),y.offset+=z,U},this.buf=this.bin,this.str=function(z){var U=h(y.view,y.offset,z);return y.offset+=z,U},this.array=function(z){for(var U=new Array(z),P=0;P<z;P++)U[P]=y.parse();return U},this.ext=function(z){return y.offset+=z,{type:y.view.getInt8(y.offset),data:y.buf(z)}},this.parse=function(){var z=y.view.getUint8(y.offset),U,P;if((z&128)===0)return y.offset++,z;if((z&240)===128)return P=z&15,y.offset++,y.map(P);if((z&240)===144)return P=z&15,y.offset++,y.array(P);if((z&224)===160)return P=z&31,y.offset++,y.str(P);if((z&224)===224)return U=y.view.getInt8(y.offset),y.offset++,U;switch(z){case 192:return y.offset++,null;case 193:y.offset++;return;case 194:return y.offset++,!1;case 195:return y.offset++,!0;case 196:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.bin(P);case 197:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.bin(P);case 198:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.bin(P);case 199:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.ext(P);case 200:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.ext(P);case 201:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.ext(P);case 202:return U=y.view.getFloat32(y.offset+1),y.offset+=5,U;case 203:return U=y.view.getFloat64(y.offset+1),y.offset+=9,U;case 204:return U=y.view.getUint8(y.offset+1),y.offset+=2,U;case 205:return U=y.view.getUint16(y.offset+1),y.offset+=3,U;case 206:return U=y.view.getUint32(y.offset+1),y.offset+=5,U;case 207:return U=R(y.view,y.offset+1),y.offset+=9,U;case 208:return U=y.view.getInt8(y.offset+1),y.offset+=2,U;case 209:return U=y.view.getInt16(y.offset+1),y.offset+=3,U;case 210:return U=y.view.getInt32(y.offset+1),y.offset+=5,U;case 211:return U=E(y.view,y.offset+1),y.offset+=9,U;case 212:return P=1,y.offset++,y.ext(P);case 213:return P=2,y.offset++,y.ext(P);case 214:return P=4,y.offset++,y.ext(P);case 215:return P=8,y.offset++,y.ext(P);case 216:return P=16,y.offset++,y.ext(P);case 217:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.str(P);case 218:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.str(P);case 219:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.str(P);case 220:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.array(P);case 221:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.array(P);case 222:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.map(P);case 223:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.map(P)}throw new Error("Unknown type 0x"+z.toString(16))},this.offset=T||0,this.view=w}return O})();function L(O){var w=new DataView(O),T=new B(w),y=T.parse();if(T.offset!==O.byteLength)throw new Error(O.byteLength-T.offset+" trailing bytes");return y}function N(O,w){return Object.keys(O).filter(function(T){var y=O[T],z=typeof y;return(!w||y!=null)&&(z!=="function"||!!y.toJSON)})}function M(O,w,T,y){var z=typeof O;if(typeof O=="string"){var U=g(O);if(U<32)return w.setUint8(T,U|160),f(w,T+1,O),1+U;if(U<256)return w.setUint8(T,217),w.setUint8(T+1,U),f(w,T+2,O),2+U;if(U<65536)return w.setUint8(T,218),w.setUint16(T+1,U),f(w,T+3,O),3+U;if(U<4294967296)return w.setUint8(T,219),w.setUint32(T+1,U),f(w,T+5,O),5+U}if(ArrayBuffer.isView&&ArrayBuffer.isView(O)&&(O=O.buffer),O instanceof ArrayBuffer){var P=O.byteLength;if(P<256)return w.setUint8(T,196),w.setUint8(T+1,P),new Uint8Array(w.buffer).set(new Uint8Array(O),T+2),2+P;if(P<65536)return w.setUint8(T,197),w.setUint16(T+1,P),new Uint8Array(w.buffer).set(new Uint8Array(O),T+3),3+P;if(P<4294967296)return w.setUint8(T,198),w.setUint32(T+1,P),new Uint8Array(w.buffer).set(new Uint8Array(O),T+5),5+P}if(typeof O=="number"){if(Math.floor(O)!==O)return w.setUint8(T,203),w.setFloat64(T+1,O),9;if(O>=0){if(O<128)return w.setUint8(T,O),1;if(O<256)return w.setUint8(T,204),w.setUint8(T+1,O),2;if(O<65536)return w.setUint8(T,205),w.setUint16(T+1,O),3;if(O<4294967296)return w.setUint8(T,206),w.setUint32(T+1,O),5;if(O<18446744073709552e3)return w.setUint8(T,207),D(w,T+1,O),9;throw new Error("Number too big 0x"+O.toString(16))}if(O>=-32)return w.setInt8(T,O),1;if(O>=-128)return w.setUint8(T,208),w.setInt8(T+1,O),2;if(O>=-32768)return w.setUint8(T,209),w.setInt16(T+1,O),3;if(O>=-2147483648)return w.setUint8(T,210),w.setInt32(T+1,O),5;if(O>=-9223372036854776e3)return w.setUint8(T,211),v(w,T+1,O),9;throw new Error("Number too small -0x"+(-O).toString(16).substr(1))}if(z==="undefined")return y?0:(w.setUint8(T,212),w.setUint8(T+1,0),w.setUint8(T+2,0),3);if(O===null)return y?0:(w.setUint8(T,192),1);if(z==="boolean")return w.setUint8(T,O?195:194),1;if(typeof O.toJSON=="function")return M(O.toJSON(),w,T,y);if(z==="object"){var K,Q=0,X=void 0,Y=Array.isArray(O);if(Y?K=O.length:(X=N(O,y),K=X.length),K<16?(w.setUint8(T,K|(Y?144:128)),Q=1):K<65536?(w.setUint8(T,Y?220:222),w.setUint16(T+1,K),Q=3):K<4294967296&&(w.setUint8(T,Y?221:223),w.setUint32(T+1,K),Q=5),Y)for(var j=0;j<K;j++)Q+=M(O[j],w,T+Q,y);else if(X)for(var j=0;j<K;j++){var I=X[j];Q+=M(I,w,T+Q),Q+=M(O[I],w,T+Q,y)}return Q}if(z==="function")return 0;throw new Error("Unknown type "+z)}function G(O,w){var T=typeof O;if(T==="string"){var y=g(O);if(y<32)return 1+y;if(y<256)return 2+y;if(y<65536)return 3+y;if(y<4294967296)return 5+y}if(ArrayBuffer.isView&&ArrayBuffer.isView(O)&&(O=O.buffer),O instanceof ArrayBuffer){var z=O.byteLength;if(z<256)return 2+z;if(z<65536)return 3+z;if(z<4294967296)return 5+z}if(typeof O=="number"){if(Math.floor(O)!==O)return 9;if(O>=0){if(O<128)return 1;if(O<256)return 2;if(O<65536)return 3;if(O<4294967296)return 5;if(O<18446744073709552e3)return 9;throw new Error("Number too big 0x"+O.toString(16))}if(O>=-32)return 1;if(O>=-128)return 2;if(O>=-32768)return 3;if(O>=-2147483648)return 5;if(O>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+O.toString(16).substr(1))}if(T==="boolean")return 1;if(O===null)return w?0:1;if(O===void 0)return w?0:3;if(typeof O.toJSON=="function")return G(O.toJSON(),w);if(T==="object"){var U,P=0;if(Array.isArray(O)){U=O.length;for(var K=0;K<U;K++)P+=G(O[K],w)}else{var Q=N(O,w);U=Q.length;for(var K=0;K<U;K++){var X=Q[K];P+=G(X)+G(O[X],w)}}if(U<16)return 1+P;if(U<65536)return 3+P;if(U<4294967296)return 5+P;throw new Error("Array or object too long 0x"+U.toString(16))}if(T==="function")return 0;throw new Error("Unknown type "+T)}a.default={encode:m,decode:L,inspect:o,utf8Write:f,utf8Read:h,utf8ByteCount:g}}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(30)),h=o.__importDefault(r(50)),g=o.__importDefault(r(3)),m=o.__importDefault(r(4)),_=o.__importDefault(r(55)),C=o.__importDefault(r(57)),E=o.__importDefault(r(62)),R=o.__importDefault(r(64)),v=o.__importDefault(r(68)),D=o.__importDefault(r(2)),B=r(8),L=o.__importDefault(r(65)),N=o.__importDefault(r(66)),M=o.__importDefault(r(41)),G=(0,C.default)(R.default,_.default);g.default.Crypto=G,g.default.BufferUtils=_.default,g.default.Http=E.default,g.default.Config=R.default,g.default.Transports=v.default,g.default.WebStorage=L.default,f.default.Crypto=G,h.default.Crypto=G,D.default.initLogHandlers(),g.default.Defaults=(0,B.getDefaults)(N.default),g.default.Config.agent&&(g.default.Defaults.agent+=" "+g.default.Config.agent),g.default.Config.noUpgrade&&(g.default.Defaults.upgradeTransports=[]),a.default={ErrorInfo:m.default,Rest:f.default,Realtime:h.default,msgpack:M.default}}),(function(n){n.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')}),(function(n,a){}),(function(n,a,r){(function(o,f){n.exports=f(r(6),r(32),r(25))})(this,function(o){return o.HmacSHA256})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(47)),g=o.__importDefault(r(15)),m=o.__importDefault(r(20)),_=o.__importDefault(r(4)),C=o.__importDefault(r(48)),E=function(){},R=(function(){function L(N){this.rest=N,this.admin=new v(N)}return L})(),v=(function(){function L(N){this.rest=N,this.deviceRegistrations=new D(N),this.channelSubscriptions=new B(N)}return L.prototype.publish=function(N,M,G){var O=this.rest,w=O.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(O.options,w),y={},z=f.mixin({recipient:N},M);if(typeof G!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);G=E}O.options.headers&&f.mixin(T,O.options.headers),O.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var U=f.encodeBody(z,w);g.default.post(O,"/push/publish",U,T,y,null,function(P){return G(P)})},L})(),D=(function(){function L(N){this.rest=N}return L.prototype.save=function(N,M){var G=this.rest,O=h.default.fromValues(N),w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(G.options,w),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),G.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var z=f.encodeBody(O,w);g.default.put(G,"/push/deviceRegistrations/"+encodeURIComponent(N.id),z,T,y,null,function(U,P,K,Q){M(U,U?void 0:h.default.fromResponseBody(P,Q?void 0:w))})},L.prototype.get=function(N,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,w=f.defaultGetHeaders(G.options,O),T=N.id||N;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"get",arguments);M=E}if(typeof T!="string"||!T.length){M(new _.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&f.mixin(w,G.options.headers),g.default.get(G,"/push/deviceRegistrations/"+encodeURIComponent(T),w,{},null,function(y,z,U,P){M(y,y?void 0:h.default.fromResponseBody(z,P?void 0:O))})},L.prototype.list=function(N,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,w=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),new m.default(G,"/push/deviceRegistrations",T,w,function(y,z,U){return h.default.fromResponseBody(y,U?void 0:O)}).get(N,M)},L.prototype.remove=function(N,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,w=f.defaultGetHeaders(G.options,O),T={},y=N.id||N;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"remove",arguments);M=E}if(typeof y!="string"||!y.length){M(new _.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&f.mixin(w,G.options.headers),G.options.pushFullWait&&f.mixin(T,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations/"+encodeURIComponent(y),w,T,null,function(z){return M(z)})},L.prototype.removeWhere=function(N,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,w=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}G.options.headers&&f.mixin(w,G.options.headers),G.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations",w,N,null,function(T){return M(T)})},L})(),B=(function(){function L(N){this.remove=L.prototype.removeWhere,this.rest=N}return L.prototype.save=function(N,M){var G=this.rest,O=C.default.fromValues(N),w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,T=f.defaultPostHeaders(G.options,w),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),G.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var z=f.encodeBody(O,w);g.default.post(G,"/push/channelSubscriptions",z,T,y,null,function(U,P,K,Q){M(U,!U&&C.default.fromResponseBody(P,Q?void 0:w))})},L.prototype.list=function(N,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,w=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),new m.default(G,"/push/channelSubscriptions",T,w,function(y,z,U){return C.default.fromResponseBody(y,U?void 0:O)}).get(N,M)},L.prototype.removeWhere=function(N,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,w=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}G.options.headers&&f.mixin(w,G.options.headers),G.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),g.default.delete(G,"/push/channelSubscriptions",w,N,null,function(T){return M(T)})},L.prototype.listChannels=function(N,M){var G=this.rest,O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,w=this.rest.http.supportsLinkHeaders?void 0:O,T=f.defaultGetHeaders(G.options,O);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"listChannels",arguments);M=E}G.options.headers&&f.mixin(T,G.options.headers),G.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),new m.default(G,"/push/channels",T,w,function(y,z,U){for(var P=!U&&O?f.decodeBody(y,O):y,K=0;K<P.length;K++)P[K]=String(P[K]);return P}).get(N,M)},L})();a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(4)),g;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(g||(g={}));var m;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(m||(m={}));var _=(function(){function C(){}return C.prototype.toJSON=function(){var E,R,v;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(R=this.push)===null||R===void 0?void 0:R.state,error:(v=this.push)===null||v===void 0?void 0:v.error}}},C.prototype.toString=function(){var E,R,v,D,B="[DeviceDetails";return this.id&&(B+="; id="+this.id),this.platform&&(B+="; platform="+this.platform),this.formFactor&&(B+="; formFactor="+this.formFactor),this.clientId&&(B+="; clientId="+this.clientId),this.metadata&&(B+="; metadata="+this.metadata),this.deviceIdentityToken&&(B+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(B+="; push.recipient="+JSON.stringify(this.push.recipient)),!((R=this.push)===null||R===void 0)&&R.state&&(B+="; push.state="+this.push.state),!((v=this.push)===null||v===void 0)&&v.error&&(B+="; push.error="+JSON.stringify(this.push.error)),!((D=this.push)===null||D===void 0)&&D.metadata&&(B+="; push.metadata="+this.push.metadata),B+="]",B},C.fromResponseBody=function(E,R){return R&&(E=f.decodeBody(E,R)),f.isArray(E)?C.fromValuesArray(E):C.fromValues(E)},C.fromValues=function(E){return E.error=E.error&&h.default.fromValues(E.error),Object.assign(new C,E)},C.fromValuesArray=function(E){for(var R=E.length,v=new Array(R),D=0;D<R;D++)v[D]=C.fromValues(E[D]);return v},C.toRequestBody=f.encodeBody,C})();a.default=_}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=(function(){function g(){}return g.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},g.prototype.toString=function(){var m="[PushChannelSubscription";return this.channel&&(m+="; channel="+this.channel),this.deviceId&&(m+="; deviceId="+this.deviceId),this.clientId&&(m+="; clientId="+this.clientId),m+="]",m},g.fromResponseBody=function(m,_){return _&&(m=f.decodeBody(m,_)),f.isArray(m)?g.fromValuesArray(m):g.fromValues(m)},g.fromValues=function(m){return Object.assign(new g,m)},g.fromValuesArray=function(m){for(var _=m.length,C=new Array(_),E=0;E<_;E++)C[E]=g.fromValues(m[E]);return C},g.toRequestBody=f.encodeBody,g})();a.default=h}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=(function(){function G(O){this.count=O&&O.count||0,this.data=O&&O.data||0,this.uncompressedData=O&&O.uncompressedData||0,this.failed=O&&O.failed||0,this.refused=O&&O.refused||0}return G})(),g=(function(G){o.__extends(O,G);function O(w){var T=G.call(this,w)||this;return w&&w.category&&(T.category={},f.forInOwnNonNullProperties(w.category,function(y){T.category[y]=new h(w.category[y])})),T}return O})(h),m=(function(){function G(O){this.peak=O&&O.peak||0,this.min=O&&O.min||0,this.mean=O&&O.mean||0,this.opened=O&&O.opened||0,this.refused=O&&O.refused||0}return G})(),_=(function(){function G(O){this.succeeded=O&&O.succeeded||0,this.failed=O&&O.failed||0,this.refused=O&&O.refused||0}return G})(),C=(function(){function G(O){this.plain=new m(O&&O.plain),this.tls=new m(O&&O.tls),this.all=new m(O&&O.all)}return G})(),E=(function(){function G(O){this.messages=new g(O&&O.messages),this.presence=new g(O&&O.presence),this.all=new g(O&&O.all)}return G})(),R=(function(){function G(O){this.realtime=new E(O&&O.realtime),this.rest=new E(O&&O.rest),this.webhook=new E(O&&O.webhook),this.sharedQueue=new E(O&&O.sharedQueue),this.externalQueue=new E(O&&O.externalQueue),this.httpEvent=new E(O&&O.httpEvent),this.push=new E(O&&O.push),this.all=new E(O&&O.all)}return G})(),v=(function(){function G(O){this.all=new E(O&&O.all),this.inbound=new R(O&&O.inbound),this.outbound=new R(O&&O.outbound)}return G})(),D=(function(){function G(O){this.all=new E(O&&O.all),this.producerPaid=new v(O&&O.producerPaid),this.consumerPaid=new v(O&&O.consumerPaid)}return G})(),B=(function(){function G(O){this.messages=O&&O.messages||0;var w=O&&O.notifications;this.notifications={invalid:w&&w.invalid||0,attempted:w&&w.attempted||0,successful:w&&w.successful||0,failed:w&&w.failed||0},this.directPublishes=O&&O.directPublishes||0}return G})(),L=(function(){function G(O){this.succeeded=O&&O.succeeded||0,this.skipped=O&&O.skipped||0,this.failed=O&&O.failed||0}return G})(),N=(function(){function G(O){var w=this;this.delta=void 0,O&&O.delta&&(this.delta={},f.forInOwnNonNullProperties(O.delta,function(T){w.delta[T]=new L(O.delta[T])}))}return G})(),M=(function(G){o.__extends(O,G);function O(w){var T=G.call(this,w)||this;return T.persisted=new E(w&&w.persisted),T.connections=new C(w&&w.connections),T.channels=new m(w&&w.channels),T.apiRequests=new _(w&&w.apiRequests),T.tokenRequests=new _(w&&w.tokenRequests),T.xchgProducer=new D(w&&w.xchgProducer),T.xchgConsumer=new D(w&&w.xchgConsumer),T.push=new B(w&&w.pushStats),T.processed=new N(w&&w.processed),T.inProgress=w&&w.inProgress||void 0,T.unit=w&&w.unit||void 0,T.intervalId=w&&w.intervalId||void 0,T}return O.fromValues=function(w){return new O(w)},O})(v);a.default=M}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(30)),g=o.__importDefault(r(7)),m=o.__importDefault(r(2)),_=o.__importDefault(r(51)),C=o.__importDefault(r(38)),E=o.__importDefault(r(8)),R=o.__importDefault(r(4)),v=o.__importDefault(r(10)),D=o.__importDefault(r(35)),B=o.__importDefault(r(3)),L=o.__importDefault(r(9)),N=(function(G){o.__extends(O,G);function O(w){var T=G.call(this,w)||this;return m.default.logAction(m.default.LOG_MINOR,"Realtime()",""),T.connection=new _.default(T,T.options),T.channels=new M(T),w.autoConnect!==!1&&T.connect(),T}return O.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},O.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},O.Promise=function(w){return w=E.default.objectifyOptions(w),w.promises=!0,new O(w)},O.Callbacks=O,O.Utils=f,O.ConnectionManager=D.default,O.Platform=B.default,O.ProtocolMessage=v.default,O.Message=L.default,O})(h.default),M=(function(G){o.__extends(O,G);function O(w){var T=G.call(this)||this;return T.realtime=w,T.all=Object.create(null),w.connection.connectionManager.on("transport.active",function(){T.onTransportActive()}),T}return O.prototype.channelSerials=function(){for(var w={},T=0,y=f.keysArray(this.all,!0);T<y.length;T++){var z=y[T],U=this.all[z];U.properties.channelSerial&&(w[z]=U.properties.channelSerial)}return w},O.prototype.recoverChannels=function(w){for(var T=0,y=f.keysArray(w,!0);T<y.length;T++){var z=y[T],U=this.get(z);U.properties.channelSerial=w[z]}},O.prototype.onChannelMessage=function(w){var T=w.channel;if(T===void 0){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+w.action);return}var y=this.all[T];if(!y){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+T);return}y.onMessage(w)},O.prototype.onTransportActive=function(){for(var w in this.all){var T=this.all[w];T.state==="attaching"||T.state==="detaching"?T.checkPendingState():T.state==="suspended"?T._attach(!1,null):T.state==="attached"&&T.requestState("attaching")}},O.prototype.propogateConnectionInterruption=function(w,T){var y={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},z=["attaching","attached","detaching","suspended"],U=y[w];for(var P in this.all){var K=this.all[P];f.arrIn(z,K.state)&&K.notifyState(U,T)}},O.prototype.get=function(w,T){w=String(w);var y=this.all[w];if(!y)y=this.all[w]=new C.default(this.realtime,w,T);else if(T){if(y._shouldReattachToSetOptions(T,y.channelOptions))throw new R.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);y.setOptions(T)}return y},O.prototype.getDerived=function(w,T,y){if(T.filter){var z=f.toBase64(T.filter),U=f.matchDerivedChannel(w);w="[filter=".concat(z).concat(U.qualifierParam,"]").concat(U.channelName)}return this.get(w,y)},O.prototype.release=function(w){w=String(w);var T=this.all[w];if(T){var y=T.getReleaseErr();if(y)throw y;delete this.all[w]}},O})(g.default);a.default=N}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(7)),g=o.__importDefault(r(35)),m=o.__importDefault(r(2)),_=o.__importDefault(r(37)),C=o.__importDefault(r(3));function E(){}var R=(function(v){o.__extends(D,v);function D(B,L){var N=v.call(this)||this;return N.whenState=(function(M,G){return h.default.prototype.whenState.call(N,M,N.state,G,new _.default(void 0,M))}),N.ably=B,N.connectionManager=new g.default(B,L),N.state=N.connectionManager.state.state,N.key=void 0,N.id=void 0,N.errorReason=null,N.connectionManager.on("connectionstate",function(M){var G=N.state=M.current;C.default.Config.nextTick(function(){N.emit(G,M)})}),N.connectionManager.on("update",function(M){C.default.Config.nextTick(function(){N.emit("update",M)})}),N}return D.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},D.prototype.ping=function(B){if(m.default.logAction(m.default.LOG_MINOR,"Connection.ping()",""),!B){if(this.ably.options.promises)return f.promisify(this,"ping",arguments);B=E}this.connectionManager.ping(null,B)},D.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(D.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),D.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},D})(h.default);a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.PendingMessage=void 0;var o=r(0),f=o.__importDefault(r(10)),h=o.__importStar(r(1)),g=o.__importDefault(r(7)),m=o.__importDefault(r(2)),_=o.__importDefault(r(36)),C=o.__importDefault(r(4)),E=f.default.Action,R=(function(){function D(B,L){this.message=B,this.callback=L,this.merged=!1;var N=B.action;this.sendAttempted=!1,this.ackRequired=N==E.MESSAGE||N==E.PRESENCE}return D})();a.PendingMessage=R;var v=(function(D){o.__extends(B,D);function B(L){var N=D.call(this)||this;return N.transport=L,N.messageQueue=new _.default,L.on("ack",function(M,G){N.onAck(M,G)}),L.on("nack",function(M,G,O){N.onNack(M,G,O)}),N}return B.prototype.onAck=function(L,N){m.default.logAction(m.default.LOG_MICRO,"Protocol.onAck()","serial = "+L+"; count = "+N),this.messageQueue.completeMessages(L,N)},B.prototype.onNack=function(L,N,M){m.default.logAction(m.default.LOG_ERROR,"Protocol.onNack()","serial = "+L+"; count = "+N+"; err = "+h.inspectError(M)),M||(M=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(L,N,M)},B.prototype.onceIdle=function(L){var N=this.messageQueue;if(N.count()===0){L();return}N.once("idle",L)},B.prototype.send=function(L){L.ackRequired&&this.messageQueue.push(L),m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Protocol.send()","sending msg; "+f.default.stringify(L.message)),L.sendAttempted=!0,this.transport.send(L.message)},B.prototype.getTransport=function(){return this.transport},B.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},B.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},B.prototype.finish=function(){var L=this.transport;this.onceIdle(function(){L.disconnect()})},B})(g.default);a.default=v}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(3)),h=o.__importStar(r(1)),g=o.__importDefault(r(26)),m=o.__importDefault(r(8)),_=o.__importDefault(r(2)),C=o.__importDefault(r(10)),E=o.__importDefault(r(4)),R="web_socket";function v(L){return!!L.on}var D=(function(L){o.__extends(N,L);function N(M,G,O){var w=L.call(this,M,G,O)||this;return w.shortName=R,O.heartbeats=f.default.Config.useProtocolHeartbeats,w.wsHost=m.default.getHost(O.options,O.host,!0),w}return N.isAvailable=function(){return!!f.default.Config.WebSocket},N.prototype.createWebSocket=function(M,G){return this.uri=M+h.toQueryString(G),new f.default.Config.WebSocket(this.uri)},N.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},N.prototype.connect=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),g.default.prototype.connect.call(this);var M=this,G=this.params,O=G.options,w=O.tls?"wss://":"ws://",T=w+this.wsHost+":"+m.default.getPort(O)+"/";_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+T),this.auth.getAuthParams(function(y,z){if(!M.isDisposed){var U="";for(var P in z)U+=" "+P+": "+z[P]+";";if(_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+U+" err: "+y),y){M.disconnect(y);return}var K=G.getConnectParams(z);try{var Q=M.wsConnection=M.createWebSocket(T,K);Q.binaryType=f.default.Config.binaryType,Q.onopen=function(){M.onWsOpen()},Q.onclose=function(X){M.onWsClose(X)},Q.onmessage=function(X){M.onWsData(X.data)},Q.onerror=function(X){M.onWsError(X)},v(Q)&&Q.on("ping",function(){M.onActivity()})}catch(X){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(X.stack||X.message)),M.disconnect(X)}}})},N.prototype.send=function(M){var G=this.wsConnection;if(!G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{G.send(C.default.serialize(M,this.params.format))}catch(w){var O="Exception from ws connection when trying to send: "+h.inspectError(w);_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()",O),this.finish("disconnected",new E.default(O,5e4,500))}},N.prototype.onWsData=function(M){_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+M.length+"; type = "+typeof M);try{this.onProtocolMessage(C.default.deserialize(M,this.format))}catch(G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+G.stack)}},N.prototype.onWsOpen=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},N.prototype.onWsClose=function(M){var G,O;if(typeof M=="object"?(O=M.code,G=M.wasClean||O===1e3):(O=M,G=O==1e3),delete this.wsConnection,G){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var w=new E.default("Websocket closed",80003,400);this.finish("disconnected",w)}else{var T="Unclean disconnection of WebSocket ; code = "+O,w=new E.default(T,80003,400);_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()",T),this.finish("disconnected",w)}this.emit("disposed")},N.prototype.onWsError=function(M){var G=this;_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+M.message),f.default.Config.nextTick(function(){G.disconnect(Error(M.message))})},N.prototype.dispose=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var M=this.wsConnection;M&&(M.onmessage=function(){},delete this.wsConnection,f.default.Config.nextTick(function(){if(_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!M)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");M.close()}))},N})(g.default);function B(L){return D.isAvailable()&&(L.supportedTransports[R]=D),D}a.default=B}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(1)),h=o.__importDefault(r(34)),g=o.__importDefault(r(7)),m=o.__importDefault(r(2)),_=o.__importDefault(r(16)),C=o.__importStar(r(4)),E=o.__importDefault(r(38)),R=o.__importDefault(r(24)),v=o.__importDefault(r(39)),D=function(){};function B(w){return w.channel.realtime.auth.clientId}function L(w){var T=w.channel.realtime,y=T.auth.clientId;return(!y||y==="*")&&T.connection.state==="connected"}function N(w,T,y){switch(w.state){case"attached":case"suspended":y();break;case"initialized":case"detached":case"detaching":case"attaching":w.attach(function(z){z?T(z):y()});break;default:T(C.default.fromValues(w.invalidStateError()))}}function M(w,T){if(w.isSynthesized()||T.isSynthesized())return w.timestamp>=T.timestamp;var y=w.parseId(),z=T.parseId();return y.msgSerial===z.msgSerial?y.index>z.index:y.msgSerial>z.msgSerial}var G=(function(w){o.__extends(T,w);function T(y){var z=w.call(this,y)||this;return z.channel=y,z.syncComplete=!1,z.members=new O(z,function(U){return U.clientId+":"+U.connectionId}),z._myMembers=new O(z,function(U){return U.clientId}),z.subscriptions=new g.default,z.pendingPresence=[],z}return T.prototype.enter=function(y,z){if(L(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"enter",z)},T.prototype.update=function(y,z){if(L(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"update",z)},T.prototype.enterClient=function(y,z,U){return this._enterOrUpdateClient(void 0,y,z,"enter",U)},T.prototype.updateClient=function(y,z,U){return this._enterOrUpdateClient(void 0,y,z,"update",U)},T.prototype._enterOrUpdateClient=function(y,z,U,P,K){var Q=this;if(!K)if(typeof U=="function")K=U,U=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"_enterOrUpdateClient",[y,z,U,P]);K=D}var X=this.channel;if(!X.connectionManager.activeState()){K(X.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence."+P+"Client()","channel = "+X.name+", id = "+y+", client = "+(z||"(implicit) "+B(this)));var Y=_.default.fromData(U);Y.action=P,y&&(Y.id=y),z&&(Y.clientId=z),_.default.encode(Y,X.channelOptions,function(j){if(j){K(j);return}switch(X.state){case"attached":X.sendPresence(Y,K);break;case"initialized":case"detached":X.attach();case"attaching":Q.pendingPresence.push({presence:Y,callback:K});break;default:j=new C.PartialErrorInfo("Unable to "+P+" presence channel while in "+X.state+" state",90001),j.code=90001,K(j)}})},T.prototype.leave=function(y,z){if(L(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,y,z)},T.prototype.leaveClient=function(y,z,U){if(!U)if(typeof z=="function")U=z,z=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"leaveClient",[y,z]);U=D}var P=this.channel;if(!P.connectionManager.activeState()){U==null||U(P.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+y);var K=_.default.fromData(z);switch(K.action="leave",y&&(K.clientId=y),P.state){case"attached":P.sendPresence(K,U);break;case"attaching":this.pendingPresence.push({presence:K,callback:U});break;case"initialized":case"failed":{var Q=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);U==null||U(Q);break}default:U==null||U(P.invalidStateError())}},T.prototype.get=function(y,z){var U=this,P=Array.prototype.slice.call(arguments);P.length==1&&typeof P[0]=="function"&&P.unshift(null),y=P[0],z=P[1];var K=!y||("waitForSync"in y?y.waitForSync:!0);if(!z){if(this.channel.realtime.options.promises)return f.promisify(this,"get",P);z=D}function Q(X){z(null,y?X.list(y):X.values())}if(this.channel.state==="suspended"){K?z(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):Q(this.members);return}N(this.channel,z,function(){var X=U.members;K?X.waitSync(function(){Q(X)}):Q(X)})},T.prototype.history=function(y,z){if(m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),z===void 0)if(typeof y=="function")z=y,y=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"history",arguments);z=D}y&&y.untilAttach&&(this.channel.state==="attached"?(delete y.untilAttach,y.from_serial=this.channel.properties.attachSerial):z(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),h.default.prototype._history.call(this,y,z)},T.prototype.setPresence=function(y,z,U){m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+y.length+" participants; syncChannelSerial = "+U);var P,K,Q=this.members,X=this._myMembers,Y=[],j=this.channel.connectionManager.connectionId;z&&(this.members.startSync(),U&&(K=U.match(/^[\w-]+:(.*)$/))&&(P=K[1]));for(var I=0;I<y.length;I++){var F=_.default.fromValues(y[I]);switch(F.action){case"leave":Q.remove(F)&&Y.push(F),F.connectionId===j&&!F.isSynthesized()&&X.remove(F);break;case"enter":case"present":case"update":Q.put(F)&&Y.push(F),F.connectionId===j&&X.put(F);break}}z&&!P&&(Q.endSync(),this.channel.syncChannelSerial=null);for(var I=0;I<Y.length;I++){var F=Y[I];this.subscriptions.emit(F.action,F)}},T.prototype.onAttached=function(y){m.default.logAction(m.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+y),y?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var z=this.pendingPresence,U=z.length;if(U){this.pendingPresence=[];var P=[],K=R.default.create();m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+U+" queued presence messages");for(var Q=0;Q<U;Q++){var X=z[Q];P.push(X.presence),K.push(X.callback)}this.channel.sendPresence(P,K)}},T.prototype.actOnChannelState=function(y,z,U){switch(y){case"attached":this.onAttached(z);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(U);break}},T.prototype.failPendingPresence=function(y){if(this.pendingPresence.length){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+f.inspectError(y));for(var z=0;z<this.pendingPresence.length;z++)try{this.pendingPresence[z].callback(y)}catch{}this.pendingPresence=[]}},T.prototype._clearMyMembers=function(){this._myMembers.clear()},T.prototype._ensureMyMembersPresent=function(){var y=this,z=this._myMembers,U=function(Q){if(Q){var X="Presence auto-re-enter failed: "+Q.toString(),Y=new C.default(X,91004,400);m.default.logAction(m.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",X);var j=new v.default(y.channel.state,y.channel.state,!0,!1,Y);y.channel.emit("update",j)}};for(var P in z.map){var K=z.map[P];m.default.logAction(m.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+K.clientId+'" into the presence set'),this._enterOrUpdateClient(K.id,K.clientId,K.data,"enter",U)}},T.prototype._synthesizeLeaves=function(y){var z=this.subscriptions;f.arrForEach(y,function(U){var P=_.default.fromValues({action:"leave",connectionId:U.connectionId,clientId:U.clientId,data:U.data,encoding:U.encoding,timestamp:f.now()});z.emit("leave",P)})},T.prototype.on=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];m.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,y)},T.prototype.off=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];m.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,y)},T.prototype.subscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=E.default.processListenerArgs(y),P=U[0],K=U[1],Q=U[2],X=this.channel;if(!Q){if(this.channel.realtime.options.promises)return f.promisify(this,"subscribe",[P,K]);Q=D}if(X.state==="failed"){Q(C.default.fromValues(X.invalidStateError()));return}this.subscriptions.on(P,K),X.attach(Q)},T.prototype.unsubscribe=function(){for(var y=[],z=0;z<arguments.length;z++)y[z]=arguments[z];var U=E.default.processListenerArgs(y),P=U[0],K=U[1];this.subscriptions.off(P,K)},T})(h.default),O=(function(w){o.__extends(T,w);function T(y,z){var U=w.call(this)||this;return U.presence=y,U.map=Object.create(null),U.syncInProgress=!1,U.residualMembers=null,U.memberKey=z,U}return T.prototype.get=function(y){return this.map[y]},T.prototype.getClient=function(y){var z=this.map,U=[];for(var P in z){var K=z[P];K.clientId==y&&K.action!="absent"&&U.push(K)}return U},T.prototype.list=function(y){var z=this.map,U=y&&y.clientId,P=y&&y.connectionId,K=[];for(var Q in z){var X=z[Q];X.action!=="absent"&&(U&&U!=X.clientId||P&&P!=X.connectionId||K.push(X))}return K},T.prototype.put=function(y){(y.action==="enter"||y.action==="update")&&(y=_.default.fromValues(y),y.action="present");var z=this.map,U=this.memberKey(y);this.residualMembers&&delete this.residualMembers[U];var P=z[U];return P&&!M(y,P)?!1:(z[U]=y,!0)},T.prototype.values=function(){var y=this.map,z=[];for(var U in y){var P=y[U];P.action!="absent"&&z.push(P)}return z},T.prototype.remove=function(y){var z=this.map,U=this.memberKey(y),P=z[U];return P&&!M(y,P)?!1:(this.syncInProgress?(y=_.default.fromValues(y),y.action="absent",z[U]=y):delete z[U],!0)},T.prototype.startSync=function(){var y=this.map,z=this.syncInProgress;m.default.logAction(m.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),this.syncInProgress||(this.residualMembers=f.copy(y),this.setInProgress(!0))},T.prototype.endSync=function(){var y=this.map,z=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),z){for(var U in y){var P=y[U];P.action==="absent"&&delete y[U]}this.presence._synthesizeLeaves(f.valuesArray(this.residualMembers));for(var U in this.residualMembers)delete y[U];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},T.prototype.waitSync=function(y){var z=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+z),!z){y();return}this.once("sync",y)},T.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},T.prototype.setInProgress=function(y){m.default.logAction(m.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+y),this.syncInProgress=y,this.presence.syncComplete=!y},T})(g.default);a.default=G}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=r(56),h=r(31),g=r(11),m=o.__importDefault(r(5)),_=o.__importDefault(r(3)),C=(function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(R){return R!=null&&R.sigBytes!==void 0},E.prototype.isArrayBuffer=function(R){return R!=null&&R.constructor===ArrayBuffer},E.prototype.isTypedArray=function(R){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(R)},E.prototype.uint8ViewToBase64=function(R){for(var v="",D=this.base64CharSet,B=R.byteLength,L=B%3,N=B-L,M,G,O,w,T,y=0;y<N;y=y+3)T=R[y]<<16|R[y+1]<<8|R[y+2],M=(T&16515072)>>18,G=(T&258048)>>12,O=(T&4032)>>6,w=T&63,v+=D[M]+D[G]+D[O]+D[w];return L==1?(T=R[N],M=(T&252)>>2,G=(T&3)<<4,v+=D[M]+D[G]+"=="):L==2&&(T=R[N]<<8|R[N+1],M=(T&64512)>>10,G=(T&1008)>>4,O=(T&15)<<2,v+=D[M]+D[G]+D[O]+"="),v},E.prototype.base64ToArrayBuffer=function(R){for(var v=atob==null?void 0:atob(R),D=v.length,B=new Uint8Array(D),L=0;L<D;L++){var N=v.charCodeAt(L);B[L]=N}return B.buffer},E.prototype.isBuffer=function(R){return this.isArrayBuffer(R)||this.isWordArray(R)||this.isTypedArray(R)},E.prototype.toBuffer=function(R){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(R))return new Uint8Array(R);if(this.isTypedArray(R))return new Uint8Array(R.buffer);if(this.isWordArray(R)){for(var v=new ArrayBuffer(R.sigBytes),D=new Uint8Array(v),B=0;B<R.sigBytes;B++)D[B]=R.words[B>>>2]>>>24-B%4*8&255;return D}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(R){return this.isArrayBuffer(R)?R:this.toBuffer(R).buffer},E.prototype.toWordArray=function(R){return this.isTypedArray(R)&&(R=R.buffer),this.isWordArray(R)?R:m.default.create(R)},E.prototype.base64Encode=function(R){return this.isWordArray(R)?(0,g.stringify)(R):this.uint8ViewToBase64(this.toBuffer(R))},E.prototype.base64Decode=function(R){return ArrayBuffer&&_.default.Config.atob?this.base64ToArrayBuffer(R):(0,g.parse)(R)},E.prototype.hexEncode=function(R){return(0,f.stringify)(this.toWordArray(R))},E.prototype.hexDecode=function(R){var v=(0,f.parse)(R);return ArrayBuffer?this.toArrayBuffer(v):v},E.prototype.utf8Encode=function(R){return _.default.Config.TextEncoder?new _.default.Config.TextEncoder().encode(R).buffer:(0,h.parse)(R)},E.prototype.utf8Decode=function(R){if(!this.isBuffer(R))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(R)?new TextDecoder().decode(R):(R=this.toWordArray(R),(0,h.stringify)(R))},E.prototype.bufferCompare=function(R,v){if(!R)return-1;if(!v)return 1;var D=this.toWordArray(R),B=this.toWordArray(v);D.clamp(),B.clamp();var L=D.sigBytes-B.sigBytes;if(L!=0)return L;for(var N=D.words,M=B.words,G=0;G<N.length;G++)if(L=N[G]-M[G],L!=0)return L;return 0},E.prototype.byteLength=function(R){return this.isArrayBuffer(R)||this.isTypedArray(R)?R.byteLength:this.isWordArray(R)?R.sigBytes:-1},E.prototype.typedArrayToBuffer=function(R){return R.buffer},E})();a.default=new C}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return o.enc.Hex})}),(function(n,a,r){r.r(a);var o=r(5),f=r.n(o),h=r(11),g=r(23),m=r.n(g),_=r(2),C=r.n(_),E=r(4),R=r.n(E),v=function(D,B){var L="aes",N=256,M="cbc",G=16,O=4,w=4294967296,T=2147483648,y;if(D.getRandomWordArray)y=D.getRandomWordArray;else if(typeof Uint32Array<"u"&&D.getRandomValues){var z=new Uint32Array(O);y=function(I,F){var W=I/4,nt=W==O?z:new Uint32Array(W);D.getRandomValues(nt,function(Z){typeof F<"u"&&F(Z,B.toWordArray(nt))})}}else y=function(I,F){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var W=I/4,nt=new Array(W),Z=0;Z<W;Z++)nt[Z]=Math.floor(Math.random()*w)-T;F(null,f.a.create(nt))};function U(I){return I+G&-G}function P(I){if(I.algorithm==="aes"&&I.mode==="cbc"){if(I.keyLength===128||I.keyLength===256)return;throw new Error("Unsupported key length "+I.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function K(I){return I.replace("_","/").replace("-","+")}var Q=[f.a.create([269488144,269488144,269488144,269488144],16),f.a.create([16777216],1),f.a.create([33685504],2),f.a.create([50529024],3),f.a.create([67372036],4),f.a.create([84215045,83886080],5),f.a.create([101058054,101056512],6),f.a.create([117901063,117901056],7),f.a.create([134744072,134744072],8),f.a.create([151587081,151587081,150994944],9),f.a.create([168430090,168430090,168427520],10),f.a.create([185273099,185273099,185273088],11),f.a.create([202116108,202116108,202116108],12),f.a.create([218959117,218959117,218959117,218103808],13),f.a.create([235802126,235802126,235802126,235798528],14),f.a.create([252645135,252645135,252645135,252645135],15),f.a.create([269488144,269488144,269488144,269488144],16)];function X(){}function Y(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}X.CipherParams=Y,X.getDefaultParams=function(I){var F;if(typeof I=="function"||typeof I=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof I=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),X.generateRandomKey(function(nt){I(null,X.getDefaultParams({key:nt}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,X.getDefaultParams({key:I}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!I.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof I.key=="string"?F=Object(h.parse)(K(I.key)):F=B.toWordArray(I.key);var W=new Y;if(W.key=F,W.algorithm=I.algorithm||L,W.keyLength=F.words.length*32,W.mode=I.mode||M,I.keyLength&&I.keyLength!==W.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+I.keyLength+" was specified, but the key actually has length "+W.keyLength);return P(W),W},X.generateRandomKey=function(I,F){arguments.length==1&&typeof I=="function"&&(F=I,I=void 0),y((I||N)/8,function(W,nt){F!==void 0&&F(W?R.a.fromValues(W):null,nt)})},X.getCipher=function(I){var F=I instanceof Y?I:X.getDefaultParams(I);return{cipherParams:F,cipher:new j(F,O,I.iv)}};function j(I,F,W){this.algorithm=I.algorithm+"-"+String(I.keyLength)+"-"+I.mode,this.cjsAlgorithm=I.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=B.toWordArray(I.key),W&&(this.iv=B.toWordArray(W).clone()),this.blockLengthWords=F}return j.prototype.encrypt=function(I,F){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),I=B.toWordArray(I);var W=I.sigBytes,nt=U(W),Z=this,it=function(){Z.getIv(function(rt,V){if(rt){F(rt);return}var J=Z.encryptCipher.process(I.concat(Q[nt-W])),$=V.concat(J);F(null,$)})};this.encryptCipher?it():this.iv?(this.encryptCipher=m.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),it()):y(G,function(rt,V){if(rt){F(rt);return}Z.encryptCipher=m.a.algo[Z.cjsAlgorithm].createEncryptor(Z.key,{iv:V}),Z.iv=V,it()})},j.prototype.decrypt=function(I){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),I=B.toWordArray(I);var F=this.blockLengthWords,W=I.words,nt=f.a.create(W.slice(0,F)),Z=f.a.create(W.slice(F)),it=m.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:nt}),rt=it.process(Z),V=it.finalize();return it.reset(),V&&V.sigBytes&&rt.concat(V),rt},j.prototype.getIv=function(I){if(this.iv){var F=this.iv;this.iv=null,I(null,F);return}var W=this;y(G,function(nt,Z){if(nt){I(nt);return}I(null,W.encryptCipher.process(Z))})},X};a.default=v}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.WordArray,m=f.enc;m.Utf16=m.Utf16BE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],D=0;D<R;D+=2){var B=E[D>>>2]>>>16-D%4*8&65535;v.push(String.fromCharCode(B))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=C.charCodeAt(v)<<16-v%2*16;return g.create(R,E*2)}},m.Utf16LE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],D=0;D<R;D+=2){var B=_(E[D>>>2]>>>16-D%4*8&65535);v.push(String.fromCharCode(B))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=_(C.charCodeAt(v)<<16-v%2*16);return g.create(R,E*2)}};function _(C){return C<<8&4278255360|C>>>8&16711935}})(),o.enc.Utf16})}),(function(n,a,r){(function(o,f){n.exports=f(r(6),r(28))})(this,function(o){return(function(f){var h=o,g=h.lib,m=g.CipherParams,_=h.enc,C=_.Hex,E=h.format;E.Hex={stringify:function(R){return R.ciphertext.toString(C)},parse:function(R){var v=C.parse(R);return m.create({ciphertext:v})}}})(),o.format.Hex})}),(function(n,a,r){(function(o,f){n.exports=f(r(6),r(11),r(61),r(27),r(28))})(this,function(o){return(function(){var f=o,h=f.lib,g=h.BlockCipher,m=f.algo,_=[],C=[],E=[],R=[],v=[],D=[],B=[],L=[],N=[],M=[];(function(){for(var w=[],T=0;T<256;T++)T<128?w[T]=T<<1:w[T]=T<<1^283;for(var y=0,z=0,T=0;T<256;T++){var U=z^z<<1^z<<2^z<<3^z<<4;U=U>>>8^U&255^99,_[y]=U,C[U]=y;var P=w[y],K=w[P],Q=w[K],X=w[U]*257^U*16843008;E[y]=X<<24|X>>>8,R[y]=X<<16|X>>>16,v[y]=X<<8|X>>>24,D[y]=X;var X=Q*16843009^K*65537^P*257^y*16843008;B[U]=X<<24|X>>>8,L[U]=X<<16|X>>>16,N[U]=X<<8|X>>>24,M[U]=X,y?(y=P^w[w[w[Q^P]]],z^=w[w[z]]):y=z=1}})();var G=[0,1,2,4,8,16,32,64,128,27,54],O=m.AES=g.extend({_doReset:function(){var w;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var T=this._keyPriorReset=this._key,y=T.words,z=T.sigBytes/4,U=this._nRounds=z+6,P=(U+1)*4,K=this._keySchedule=[],Q=0;Q<P;Q++)Q<z?K[Q]=y[Q]:(w=K[Q-1],Q%z?z>6&&Q%z==4&&(w=_[w>>>24]<<24|_[w>>>16&255]<<16|_[w>>>8&255]<<8|_[w&255]):(w=w<<8|w>>>24,w=_[w>>>24]<<24|_[w>>>16&255]<<16|_[w>>>8&255]<<8|_[w&255],w^=G[Q/z|0]<<24),K[Q]=K[Q-z]^w);for(var X=this._invKeySchedule=[],Y=0;Y<P;Y++){var Q=P-Y;if(Y%4)var w=K[Q];else var w=K[Q-4];Y<4||Q<=4?X[Y]=w:X[Y]=B[_[w>>>24]]^L[_[w>>>16&255]]^N[_[w>>>8&255]]^M[_[w&255]]}}},encryptBlock:function(w,T){this._doCryptBlock(w,T,this._keySchedule,E,R,v,D,_)},decryptBlock:function(w,T){var y=w[T+1];w[T+1]=w[T+3],w[T+3]=y,this._doCryptBlock(w,T,this._invKeySchedule,B,L,N,M,C);var y=w[T+1];w[T+1]=w[T+3],w[T+3]=y},_doCryptBlock:function(w,T,y,z,U,P,K,Q){for(var X=this._nRounds,Y=w[T]^y[0],j=w[T+1]^y[1],I=w[T+2]^y[2],F=w[T+3]^y[3],W=4,nt=1;nt<X;nt++){var Z=z[Y>>>24]^U[j>>>16&255]^P[I>>>8&255]^K[F&255]^y[W++],it=z[j>>>24]^U[I>>>16&255]^P[F>>>8&255]^K[Y&255]^y[W++],rt=z[I>>>24]^U[F>>>16&255]^P[Y>>>8&255]^K[j&255]^y[W++],V=z[F>>>24]^U[Y>>>16&255]^P[j>>>8&255]^K[I&255]^y[W++];Y=Z,j=it,I=rt,F=V}var Z=(Q[Y>>>24]<<24|Q[j>>>16&255]<<16|Q[I>>>8&255]<<8|Q[F&255])^y[W++],it=(Q[j>>>24]<<24|Q[I>>>16&255]<<16|Q[F>>>8&255]<<8|Q[Y&255])^y[W++],rt=(Q[I>>>24]<<24|Q[F>>>16&255]<<16|Q[Y>>>8&255]<<8|Q[j&255])^y[W++],V=(Q[F>>>24]<<24|Q[Y>>>16&255]<<16|Q[j>>>8&255]<<8|Q[I&255])^y[W++];w[T]=Z,w[T+1]=it,w[T+2]=rt,w[T+3]=V},keySize:256/32});f.AES=g._createHelper(O)})(),o.AES})}),(function(n,a,r){(function(o,f){n.exports=f(r(6))})(this,function(o){return(function(f){var h=o,g=h.lib,m=g.WordArray,_=g.Hasher,C=h.algo,E=[];(function(){for(var N=0;N<64;N++)E[N]=f.abs(f.sin(N+1))*4294967296|0})();var R=C.MD5=_.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(N,M){for(var G=0;G<16;G++){var O=M+G,w=N[O];N[O]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var T=this._hash.words,y=N[M+0],z=N[M+1],U=N[M+2],P=N[M+3],K=N[M+4],Q=N[M+5],X=N[M+6],Y=N[M+7],j=N[M+8],I=N[M+9],F=N[M+10],W=N[M+11],nt=N[M+12],Z=N[M+13],it=N[M+14],rt=N[M+15],V=T[0],J=T[1],$=T[2],at=T[3];V=v(V,J,$,at,y,7,E[0]),at=v(at,V,J,$,z,12,E[1]),$=v($,at,V,J,U,17,E[2]),J=v(J,$,at,V,P,22,E[3]),V=v(V,J,$,at,K,7,E[4]),at=v(at,V,J,$,Q,12,E[5]),$=v($,at,V,J,X,17,E[6]),J=v(J,$,at,V,Y,22,E[7]),V=v(V,J,$,at,j,7,E[8]),at=v(at,V,J,$,I,12,E[9]),$=v($,at,V,J,F,17,E[10]),J=v(J,$,at,V,W,22,E[11]),V=v(V,J,$,at,nt,7,E[12]),at=v(at,V,J,$,Z,12,E[13]),$=v($,at,V,J,it,17,E[14]),J=v(J,$,at,V,rt,22,E[15]),V=D(V,J,$,at,z,5,E[16]),at=D(at,V,J,$,X,9,E[17]),$=D($,at,V,J,W,14,E[18]),J=D(J,$,at,V,y,20,E[19]),V=D(V,J,$,at,Q,5,E[20]),at=D(at,V,J,$,F,9,E[21]),$=D($,at,V,J,rt,14,E[22]),J=D(J,$,at,V,K,20,E[23]),V=D(V,J,$,at,I,5,E[24]),at=D(at,V,J,$,it,9,E[25]),$=D($,at,V,J,P,14,E[26]),J=D(J,$,at,V,j,20,E[27]),V=D(V,J,$,at,Z,5,E[28]),at=D(at,V,J,$,U,9,E[29]),$=D($,at,V,J,Y,14,E[30]),J=D(J,$,at,V,nt,20,E[31]),V=B(V,J,$,at,Q,4,E[32]),at=B(at,V,J,$,j,11,E[33]),$=B($,at,V,J,W,16,E[34]),J=B(J,$,at,V,it,23,E[35]),V=B(V,J,$,at,z,4,E[36]),at=B(at,V,J,$,K,11,E[37]),$=B($,at,V,J,Y,16,E[38]),J=B(J,$,at,V,F,23,E[39]),V=B(V,J,$,at,Z,4,E[40]),at=B(at,V,J,$,y,11,E[41]),$=B($,at,V,J,P,16,E[42]),J=B(J,$,at,V,X,23,E[43]),V=B(V,J,$,at,I,4,E[44]),at=B(at,V,J,$,nt,11,E[45]),$=B($,at,V,J,rt,16,E[46]),J=B(J,$,at,V,U,23,E[47]),V=L(V,J,$,at,y,6,E[48]),at=L(at,V,J,$,Y,10,E[49]),$=L($,at,V,J,it,15,E[50]),J=L(J,$,at,V,Q,21,E[51]),V=L(V,J,$,at,nt,6,E[52]),at=L(at,V,J,$,P,10,E[53]),$=L($,at,V,J,F,15,E[54]),J=L(J,$,at,V,z,21,E[55]),V=L(V,J,$,at,j,6,E[56]),at=L(at,V,J,$,rt,10,E[57]),$=L($,at,V,J,X,15,E[58]),J=L(J,$,at,V,Z,21,E[59]),V=L(V,J,$,at,K,6,E[60]),at=L(at,V,J,$,W,10,E[61]),$=L($,at,V,J,U,15,E[62]),J=L(J,$,at,V,I,21,E[63]),T[0]=T[0]+V|0,T[1]=T[1]+J|0,T[2]=T[2]+$|0,T[3]=T[3]+at|0},_doFinalize:function(){var N=this._data,M=N.words,G=this._nDataBytes*8,O=N.sigBytes*8;M[O>>>5]|=128<<24-O%32;var w=f.floor(G/4294967296),T=G;M[(O+64>>>9<<4)+15]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,M[(O+64>>>9<<4)+14]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,N.sigBytes=(M.length+1)*4,this._process();for(var y=this._hash,z=y.words,U=0;U<4;U++){var P=z[U];z[U]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return y},clone:function(){var N=_.clone.call(this);return N._hash=this._hash.clone(),N}});function v(N,M,G,O,w,T,y){var z=N+(M&G|~M&O)+w+y;return(z<<T|z>>>32-T)+M}function D(N,M,G,O,w,T,y){var z=N+(M&O|G&~O)+w+y;return(z<<T|z>>>32-T)+M}function B(N,M,G,O,w,T,y){var z=N+(M^G^O)+w+y;return(z<<T|z>>>32-T)+M}function L(N,M,G,O,w,T,y){var z=N+(G^(M|~O))+w+y;return(z<<T|z>>>32-T)+M}h.MD5=_._createHelper(R),h.HmacMD5=_._createHmacHelper(R)})(Math),o.MD5})}),(function(n,a,r){var o;Object.defineProperty(a,"__esModule",{value:!0});var f=r(0),h=f.__importDefault(r(3)),g=f.__importStar(r(1)),m=f.__importDefault(r(8)),_=r(4),C=f.__importDefault(r(19)),E=f.__importDefault(r(17)),R=f.__importDefault(r(22)),v=f.__importDefault(r(2)),D=r(29),B=f.__importDefault(r(63)),L=r(14);function N(O){var w=O.statusCode;return w===408&&!O.code||w===400&&!O.code||w>=500&&w<=504}function M(O){var w=O.connection,T=w&&w.connectionManager.host;return T?[T].concat(m.default.getFallbackHosts(O.options)):m.default.getHosts(O.options)}var G=(o=(function(){function O(w){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=M,this.options=w||{};var T=this.options.connectivityCheckUrl||m.default.connectivityCheckUrl,y=this.options.connectivityCheckParams,z=!this.options.connectivityCheckUrl;h.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(U,P,K,Q,X,Y,j){var I=E.default.createRequest(K,Q,X,Y,R.default.REQ_SEND,P&&P.options.timeouts,U);return I.once("complete",j),I.exec(),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,y,function(P,K,Q,X,Y){var j=!1;z?j=!P&&(K==null?void 0:K.replace(/\n/,""))=="yes":j=!P&&(0,L.isSuccessCode)(Y),v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+j),U(null,j)})}):h.default.Config.jsonpSupported?(this.Request=function(U,P,K,Q,X,Y,j){var I=(0,D.createRequest)(K,Q,X,Y,R.default.REQ_SEND,P&&P.options.timeouts,U);return I.once("complete",j),h.default.Config.nextTick(function(){I.exec()}),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){var P=this,K=m.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(U);return}this.checksInProgress=[U],v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+K);var Q=new D.Request("isTheInternetUp",K,null,null,null,R.default.REQ_SEND,m.default.TIMEOUTS);Q.once("complete",function(X,Y){var j=!X&&Y;v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+j);for(var I=0;I<P.checksInProgress.length;I++)P.checksInProgress[I](null,j);P.checksInProgress=null}),h.default.Config.nextTick(function(){Q.exec()})}):h.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=B.default,this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,null,function(P,K){var Q=!P&&(K==null?void 0:K.replace(/\n/,""))=="yes";v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+Q),U(null,Q)})}):this.Request=function(U,P,K,Q,X,Y,j){j(new _.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return O.prototype.do=function(w,T,y,z,U,P,K){var Q=this,X=typeof y=="function"?y:function(F){return T.baseUri(F)+y},Y=T._currentFallback;if(Y)if(Y.validUntil>g.now()){if(!this.Request){K==null||K(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(w,T,X(Y.host),z,P,U,function(F){for(var W=[],nt=1;nt<arguments.length;nt++)W[nt-1]=arguments[nt];if(F&&N(F)){T._currentFallback=null,Q.do(w,T,y,z,U,P,K);return}K==null||K.apply(void 0,f.__spreadArray([F],W,!1))});return}else T._currentFallback=null;var j=M(T);if(j.length===1){this.doUri(w,T,X(j[0]),z,U,P,K);return}var I=function(F,W){var nt=F.shift();Q.doUri(w,T,X(nt),z,U,P,function(Z){for(var it=[],rt=1;rt<arguments.length;rt++)it[rt-1]=arguments[rt];if(Z&&N(Z)&&F.length){I(F,!0);return}W&&(T._currentFallback={host:nt,validUntil:g.now()+T.options.timeouts.fallbackRetryTimeout}),K==null||K.apply(void 0,f.__spreadArray([Z],it,!1))})};I(j)},O.prototype.doUri=function(w,T,y,z,U,P,K){if(!this.Request){K(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(w,T,y,z,P,U,K)},O})(),o.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],o.methodsWithoutBody=[C.default.Get,C.default.Delete],o.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],o);a.default=G}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importStar(r(4)),h=o.__importDefault(r(3)),g=o.__importDefault(r(8)),m=o.__importStar(r(1)),_=r(1);function C(v,D){return!!D.get("x-ably-errorcode")}function E(v,D){if(C(v,D))return v.error&&f.default.fromValues(v.error)}function R(v,D,B,L,N,M,G){var O=new Headers(L||{}),w=v?v.toUpperCase():m.isEmptyArg(M)?"GET":"POST",T=new AbortController,y=setTimeout(function(){T.abort(),G(new f.PartialErrorInfo("Request timed out",null,408))},D?D.options.timeouts.httpRequestTimeout:g.default.TIMEOUTS.httpRequestTimeout),z={method:w,headers:O,body:M};h.default.Config.isWebworker||(z.credentials=O.has("authorization")?"include":"same-origin"),(0,_.getGlobalObject)().fetch(B+"?"+new URLSearchParams(N||{}),z).then(function(U){clearTimeout(y);var P=U.headers.get("Content-Type"),K;P&&P.indexOf("application/x-msgpack")>-1?K=U.arrayBuffer():P&&P.indexOf("application/json")>-1?K=U.json():K=U.text(),K.then(function(Q){var X=!!P&&P.indexOf("application/x-msgpack")===-1;if(U.ok)G(null,Q,U.headers,X,U.status);else{var Y=E(Q,U.headers)||new f.PartialErrorInfo("Error response received from server: "+U.status+" body was: "+h.default.Config.inspect(Q),null,U.status);G(Y,Q,U.headers,X,U.status)}})}).catch(function(U){clearTimeout(y),G(U)})}a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(41)),h=o.__importStar(r(1)),g=h.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function m(){var R=g.location;return!g.WebSocket||!R||!R.origin||R.origin.indexOf("http")>-1}var _=g.navigator&&g.navigator.userAgent.toString(),C=g.location&&g.location.href,E={agent:"browser",logTimestamps:!0,userAgent:_,currentUrl:C,noUpgrade:_&&!!_.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:g.WebSocket,fetchSupported:!!g.fetch,xhrSupported:g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:m(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:f.default,supportsBinary:!!g.TextDecoder,preferBinary:!1,ArrayBuffer:g.ArrayBuffer,atob:g.atob,nextTick:typeof g.setImmediate<"u"?g.setImmediate.bind(g):function(R){setTimeout(R,0)},addEventListener:g.addEventListener,inspect:JSON.stringify,stringByteSize:function(R){return g.TextDecoder&&new g.TextEncoder().encode(R).length||R.length},TextEncoder:g.TextEncoder,TextDecoder:g.TextDecoder,Promise:g.Promise,getRandomValues:(function(R){if(R!==void 0)return function(v,D){R.getRandomValues(v),D&&D(null)}})(g.crypto||msCrypto)};a.default=E}),(function(n,a,r){(function(o){Object.defineProperty(a,"__esModule",{value:!0});var f=r(0),h=f.__importStar(r(1)),g="ablyjs-storage-test",m=(function(){function _(){try{o.sessionStorage.setItem(g,g),o.sessionStorage.removeItem(g),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{o.localStorage.setItem(g,g),o.localStorage.removeItem(g),this.localSupported=!0}catch{this.localSupported=!1}}return _.prototype.get=function(C){return this._get(C,!1)},_.prototype.getSession=function(C){return this._get(C,!0)},_.prototype.remove=function(C){return this._remove(C,!1)},_.prototype.removeSession=function(C){return this._remove(C,!0)},_.prototype.set=function(C,E,R){return this._set(C,E,R,!1)},_.prototype.setSession=function(C,E,R){return this._set(C,E,R,!0)},_.prototype._set=function(C,E,R,v){var D={value:E};return R&&(D.expires=h.now()+R),this.storageInterface(v).setItem(C,JSON.stringify(D))},_.prototype._get=function(C,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var R=this.storageInterface(E).getItem(C);if(!R)return null;var v=JSON.parse(R);return v.expires&&v.expires<h.now()?(this.storageInterface(E).removeItem(C),null):v.value},_.prototype._remove=function(C,E){return this.storageInterface(E).removeItem(C)},_.prototype.storageInterface=function(C){return C?o.sessionStorage:o.localStorage},_})();a.default=new m}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o=r(0),f=o.__importDefault(r(67)),h={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],baseTransportOrder:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],transportPreferenceOrder:[f.default.JsonP,f.default.XhrPolling,f.default.XhrStreaming,f.default.WebSocket],upgradeTransports:[f.default.XhrStreaming,f.default.WebSocket]};a.default=h}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var o;(function(f){f.WebSocket="web_socket",f.Comet="comet",f.XhrStreaming="xhr_streaming",f.XhrPolling="xhr_polling",f.JsonP="jsonp"})(o||(o={})),a.default=o}),(function(n,a,r){r.r(a);var o=r(29),f=r.n(o),h=r(1),g=r(3),m=r.n(g),_=r(12),C=r.n(_),E=r(17),R=r.n(E),v=function(N){var M="xhr_polling";function G(O,w,T){T.stream=!1,C.a.call(this,O,w,T),this.shortName=M}return h.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(O,w,T,y,z){return R.a.createRequest(O,w,T,y,z,this.timeouts)},typeof N<"u"&&G.isAvailable()&&(N.supportedTransports[M]=G),G},D=v,B=function(N){var M="xhr_streaming";function G(O,w,T){C.a.call(this,O,w,T),this.shortName=M}return h.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.streamingSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(O,w,T,y,z){return R.a.createRequest(O,w,T,y,z,this.timeouts)},typeof N<"u"&&G.isAvailable()&&(N.supportedTransports[M]=G),G},L=B;a.default=[f.a,D,L]})]).default})})(Hp)),Hp.exports}var yS=vS(),Bm=function(l,t){return Bm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(n[r]=a[r])},Bm(l,t)};function SS(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Bm(l,t);function n(){this.constructor=l}l.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var vg=function(){return vg=Object.assign||function(t){for(var n,a=1,r=arguments.length;a<r;a++){n=arguments[a];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},vg.apply(this,arguments)};function bf(l,t){var n={};for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&t.indexOf(a)<0&&(n[a]=l[a]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(l);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(l,a[r])&&(n[a[r]]=l[a[r]]);return n}function bS(l,t,n,a){var r=arguments.length,o=r<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,n):a,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,n,a);else for(var h=l.length-1;h>=0;h--)(f=l[h])&&(o=(r<3?f(o):r>3?f(t,n,o):f(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function _S(l,t){return function(n,a){t(n,a,l)}}function ES(l,t,n,a,r,o){function f(L){if(L!==void 0&&typeof L!="function")throw new TypeError("Function expected");return L}for(var h=a.kind,g=h==="getter"?"get":h==="setter"?"set":"value",m=!t&&l?a.static?l:l.prototype:null,_=t||(m?Object.getOwnPropertyDescriptor(m,a.name):{}),C,E=!1,R=n.length-1;R>=0;R--){var v={};for(var D in a)v[D]=D==="access"?{}:a[D];for(var D in a.access)v.access[D]=a.access[D];v.addInitializer=function(L){if(E)throw new TypeError("Cannot add initializers after decoration has completed");o.push(f(L||null))};var B=(0,n[R])(h==="accessor"?{get:_.get,set:_.set}:_[g],v);if(h==="accessor"){if(B===void 0)continue;if(B===null||typeof B!="object")throw new TypeError("Object expected");(C=f(B.get))&&(_.get=C),(C=f(B.set))&&(_.set=C),(C=f(B.init))&&r.unshift(C)}else(C=f(B))&&(h==="field"?r.unshift(C):_[g]=C)}m&&Object.defineProperty(m,a.name,_),E=!0}function CS(l,t,n){for(var a=arguments.length>2,r=0;r<t.length;r++)n=a?t[r].call(l,n):t[r].call(l);return a?n:void 0}function TS(l){return typeof l=="symbol"?l:"".concat(l)}function AS(l,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(l,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function wS(l,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,t)}function re(l,t,n,a){function r(o){return o instanceof n?o:new n(function(f){f(o)})}return new(n||(n=Promise))(function(o,f){function h(_){try{m(a.next(_))}catch(C){f(C)}}function g(_){try{m(a.throw(_))}catch(C){f(C)}}function m(_){_.done?o(_.value):r(_.value).then(h,g)}m((a=a.apply(l,t||[])).next())})}function RS(l,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},a,r,o,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=h(0),f.throw=h(1),f.return=h(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function h(m){return function(_){return g([m,_])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(a=1,r&&(o=m[0]&2?r.return:m[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,m[1])).done)return o;switch(r=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){n.label=m[1];break}if(m[0]===6&&n.label<o[1]){n.label=o[1],o=m;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(m);break}o[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(l,n)}catch(_){m=[6,_],r=0}finally{a=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Dg=Object.create?(function(l,t,n,a){a===void 0&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(l,a,r)}):(function(l,t,n,a){a===void 0&&(a=n),l[a]=t[n]});function OS(l,t){for(var n in l)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Dg(t,l,n)}function yg(l){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&l[t],a=0;if(n)return n.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&a>=l.length&&(l=void 0),{value:l&&l[a++],done:!l}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function iv(l,t){var n=typeof Symbol=="function"&&l[Symbol.iterator];if(!n)return l;var a=n.call(l),r,o=[],f;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(h){f={error:h}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(f)throw f.error}}return o}function xS(){for(var l=[],t=0;t<arguments.length;t++)l=l.concat(iv(arguments[t]));return l}function MS(){for(var l=0,t=0,n=arguments.length;t<n;t++)l+=arguments[t].length;for(var a=Array(l),r=0,t=0;t<n;t++)for(var o=arguments[t],f=0,h=o.length;f<h;f++,r++)a[r]=o[f];return a}function NS(l,t,n){if(n||arguments.length===2)for(var a=0,r=t.length,o;a<r;a++)(o||!(a in t))&&(o||(o=Array.prototype.slice.call(t,0,a)),o[a]=t[a]);return l.concat(o||Array.prototype.slice.call(t))}function df(l){return this instanceof df?(this.v=l,this):new df(l)}function DS(l,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n.apply(l,t||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",f),r[Symbol.asyncIterator]=function(){return this},r;function f(R){return function(v){return Promise.resolve(v).then(R,C)}}function h(R,v){a[R]&&(r[R]=function(D){return new Promise(function(B,L){o.push([R,D,B,L])>1||g(R,D)})},v&&(r[R]=v(r[R])))}function g(R,v){try{m(a[R](v))}catch(D){E(o[0][3],D)}}function m(R){R.value instanceof df?Promise.resolve(R.value.v).then(_,C):E(o[0][2],R)}function _(R){g("next",R)}function C(R){g("throw",R)}function E(R,v){R(v),o.shift(),o.length&&g(o[0][0],o[0][1])}}function jS(l){var t,n;return t={},a("next"),a("throw",function(r){throw r}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(r,o){t[r]=l[r]?function(f){return(n=!n)?{value:df(l[r](f)),done:!1}:o?o(f):f}:o}}function US(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=l[Symbol.asyncIterator],n;return t?t.call(l):(l=typeof yg=="function"?yg(l):l[Symbol.iterator](),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(o){n[o]=l[o]&&function(f){return new Promise(function(h,g){f=l[o](f),r(h,g,f.done,f.value)})}}function r(o,f,h,g){Promise.resolve(g).then(function(m){o({value:m,done:h})},f)}}function BS(l,t){return Object.defineProperty?Object.defineProperty(l,"raw",{value:t}):l.raw=t,l}var d_=Object.create?(function(l,t){Object.defineProperty(l,"default",{enumerable:!0,value:t})}):function(l,t){l.default=t},zm=function(l){return zm=Object.getOwnPropertyNames||function(t){var n=[];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[n.length]=a);return n},zm(l)};function zS(l){if(l&&l.__esModule)return l;var t={};if(l!=null)for(var n=zm(l),a=0;a<n.length;a++)n[a]!=="default"&&Dg(t,l,n[a]);return d_(t,l),t}function LS(l){return l&&l.__esModule?l:{default:l}}function GS(l,t,n,a){if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?l!==t||!a:!t.has(l))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?a:n==="a"?a.call(l):a?a.value:t.get(l)}function PS(l,t,n,a,r){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?l!==t||!r:!t.has(l))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?r.call(l,n):r?r.value=n:t.set(l,n),n}function HS(l,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof l=="function"?t===l:l.has(t)}function IS(l,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var a,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=t[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=t[Symbol.dispose],n&&(r=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");r&&(a=function(){try{r.call(this)}catch(o){return Promise.reject(o)}}),l.stack.push({value:t,dispose:a,async:n})}else n&&l.stack.push({async:!0});return t}var g_=typeof SuppressedError=="function"?SuppressedError:function(l,t,n){var a=new Error(n);return a.name="SuppressedError",a.error=l,a.suppressed=t,a};function kS(l){function t(o){l.error=l.hasError?new g_(o,l.error,"An error was suppressed during disposal."):o,l.hasError=!0}var n,a=0;function r(){for(;n=l.stack.pop();)try{if(!n.async&&a===1)return a=0,l.stack.push(n),Promise.resolve().then(r);if(n.dispose){var o=n.dispose.call(n.value);if(n.async)return a|=2,Promise.resolve(o).then(r,function(f){return t(f),r()})}else a|=1}catch(f){t(f)}if(a===1)return l.hasError?Promise.reject(l.error):Promise.resolve();if(l.hasError)throw l.error}return r()}function qS(l,t){return typeof l=="string"&&/^\.\.?\//.test(l)?l.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,a,r,o,f){return a?t?".jsx":".js":r&&(!o||!f)?n:r+o+"."+f.toLowerCase()+"js"}):l}const p_={__extends:SS,__assign:vg,__rest:bf,__decorate:bS,__param:_S,__esDecorate:ES,__runInitializers:CS,__propKey:TS,__setFunctionName:AS,__metadata:wS,__awaiter:re,__generator:RS,__createBinding:Dg,__exportStar:OS,__values:yg,__read:iv,__spread:xS,__spreadArrays:MS,__spreadArray:NS,__await:df,__asyncGenerator:DS,__asyncDelegator:jS,__asyncValues:US,__makeTemplateObject:BS,__importStar:zS,__importDefault:LS,__classPrivateFieldGet:GS,__classPrivateFieldSet:PS,__classPrivateFieldIn:HS,__addDisposableResource:IS,__disposeResources:kS,__rewriteRelativeImportExtension:qS},m_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:IS,get __assign(){return vg},__asyncDelegator:jS,__asyncGenerator:DS,__asyncValues:US,__await:df,__awaiter:re,__classPrivateFieldGet:GS,__classPrivateFieldIn:HS,__classPrivateFieldSet:PS,__createBinding:Dg,__decorate:bS,__disposeResources:kS,__esDecorate:ES,__exportStar:OS,__extends:SS,__generator:RS,__importDefault:LS,__importStar:zS,__makeTemplateObject:BS,__metadata:wS,__param:_S,__propKey:TS,__read:iv,__rest:bf,__rewriteRelativeImportExtension:qS,__runInitializers:CS,__setFunctionName:AS,__spread:xS,__spreadArray:NS,__spreadArrays:MS,__values:yg,default:p_},Symbol.toStringTag,{value:"Module"})),v_="modulepreload",y_=function(l){return"/"+l},o1={},Au=function(t,n,a){let r=Promise.resolve();if(n&&n.length>0){let f=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),g=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));r=f(n.map(m=>{if(m=y_(m),m in o1)return;o1[m]=!0;const _=m.endsWith(".css"),C=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${C}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":v_,_||(E.as="script"),E.crossOrigin="",E.href=m,g&&E.setAttribute("nonce",g),document.head.appendChild(E),_)return new Promise((R,v)=>{E.addEventListener("load",R),E.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return r.then(f=>{for(const h of f||[])h.status==="rejected"&&o(h.reason);return t().catch(o)})},S_=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...n)=>Au(async()=>{const{default:a}=await Promise.resolve().then(()=>wu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)};class rv extends Error{constructor(t,n="FunctionsError",a){super(t),this.name=n,this.context=a}}class u1 extends rv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class c1 extends rv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class f1 extends rv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Lm;(function(l){l.Any="any",l.ApNortheast1="ap-northeast-1",l.ApNortheast2="ap-northeast-2",l.ApSouth1="ap-south-1",l.ApSoutheast1="ap-southeast-1",l.ApSoutheast2="ap-southeast-2",l.CaCentral1="ca-central-1",l.EuCentral1="eu-central-1",l.EuWest1="eu-west-1",l.EuWest2="eu-west-2",l.EuWest3="eu-west-3",l.SaEast1="sa-east-1",l.UsEast1="us-east-1",l.UsWest1="us-west-1",l.UsWest2="us-west-2"})(Lm||(Lm={}));class b_{constructor(t,{headers:n={},customFetch:a,region:r=Lm.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=S_(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return re(this,arguments,void 0,function*(n,a={}){var r;try{const{headers:o,method:f,body:h,signal:g}=a;let m={},{region:_}=a;_||(_=this.region);const C=new URL(`${this.url}/${n}`);_&&_!=="any"&&(m["x-region"]=_,C.searchParams.set("forceFunctionRegion",_));let E;h&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=h):typeof h=="string"?(m["Content-Type"]="text/plain",E=h):typeof FormData<"u"&&h instanceof FormData?E=h:(m["Content-Type"]="application/json",E=JSON.stringify(h)):E=h;const R=yield this.fetch(C.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),o),body:E,signal:g}).catch(L=>{throw L.name==="AbortError"?L:new u1(L)}),v=R.headers.get("x-relay-error");if(v&&v==="true")throw new c1(R);if(!R.ok)throw new f1(R);let D=((r=R.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),B;return D==="application/json"?B=yield R.json():D==="application/octet-stream"||D==="application/pdf"?B=yield R.blob():D==="text/event-stream"?B=R:D==="multipart/form-data"?B=yield R.formData():B=yield R.text(),{data:B,error:null,response:R}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new u1(o)}:{data:null,error:o,response:o instanceof f1||o instanceof c1?o.context:void 0}}})}}var ei={};const _f=b2(m_);var eg={},ng={},ag={},ig={},rg={},__=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},gf=__();const E_=gf.fetch,VS=gf.fetch.bind(gf),YS=gf.Headers,C_=gf.Request,T_=gf.Response,wu=Object.freeze(Object.defineProperty({__proto__:null,Headers:YS,Request:C_,Response:T_,default:VS,fetch:E_},Symbol.toStringTag,{value:"Module"})),A_=b2(wu);var sg={},h1;function KS(){if(h1)return sg;h1=1,Object.defineProperty(sg,"__esModule",{value:!0});class l extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return sg.default=l,sg}var d1;function QS(){if(d1)return rg;d1=1,Object.defineProperty(rg,"__esModule",{value:!0});const l=_f,t=l.__importDefault(A_),n=l.__importDefault(KS());class a{constructor(o){var f,h;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(f=o.shouldThrowOnError)!==null&&f!==void 0?f:!1,this.signal=o.signal,this.isMaybeSingle=(h=o.isMaybeSingle)!==null&&h!==void 0?h:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,f){return this.headers=new Headers(this.headers),this.headers.set(o,f),this}then(o,f){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let g=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var _,C,E,R;let v=null,D=null,B=null,L=m.status,N=m.statusText;if(m.ok){if(this.method!=="HEAD"){const w=await m.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((_=this.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?D=w:D=JSON.parse(w))}const G=(C=this.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),O=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");G&&O&&O.length>1&&(B=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(D)&&(D.length>1?(v={code:"PGRST116",details:`Results contain ${D.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},D=null,B=null,L=406,N="Not Acceptable"):D.length===1?D=D[0]:D=null)}else{const G=await m.text();try{v=JSON.parse(G),Array.isArray(v)&&m.status===404&&(D=[],v=null,L=200,N="OK")}catch{m.status===404&&G===""?(L=204,N="No Content"):v={message:G}}if(v&&this.isMaybeSingle&&(!((R=v==null?void 0:v.details)===null||R===void 0)&&R.includes("0 rows"))&&(v=null,L=200,N="OK"),v&&this.shouldThrowOnError)throw new n.default(v)}return{error:v,data:D,count:B,status:L,statusText:N}});return this.shouldThrowOnError||(g=g.catch(m=>{var _,C,E;return{error:{message:`${(_=m==null?void 0:m.name)!==null&&_!==void 0?_:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(C=m==null?void 0:m.stack)!==null&&C!==void 0?C:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),g.then(o,f)}returns(){return this}overrideTypes(){return this}}return rg.default=a,rg}var g1;function XS(){if(g1)return ig;g1=1,Object.defineProperty(ig,"__esModule",{value:!0});const t=_f.__importDefault(QS());class n extends t.default{select(r){let o=!1;const f=(r??"*").split("").map(h=>/\s/.test(h)&&!o?"":(h==='"'&&(o=!o),h)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:o=!0,nullsFirst:f,foreignTable:h,referencedTable:g=h}={}){const m=g?`${g}.order`:"order",_=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${_?`${_},`:""}${r}.${o?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:o,referencedTable:f=o}={}){const h=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(h,`${r}`),this}range(r,o,{foreignTable:f,referencedTable:h=f}={}){const g=typeof h>"u"?"offset":`${h}.offset`,m=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${r}`),this.url.searchParams.set(m,`${o-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:o=!1,settings:f=!1,buffers:h=!1,wal:g=!1,format:m="text"}={}){var _;const C=[r?"analyze":null,o?"verbose":null,f?"settings":null,h?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${C};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return ig.default=n,ig}var p1;function sv(){if(p1)return ag;p1=1,Object.defineProperty(ag,"__esModule",{value:!0});const t=_f.__importDefault(XS());class n extends t.default{eq(r,o){return this.url.searchParams.append(r,`eq.${o}`),this}neq(r,o){return this.url.searchParams.append(r,`neq.${o}`),this}gt(r,o){return this.url.searchParams.append(r,`gt.${o}`),this}gte(r,o){return this.url.searchParams.append(r,`gte.${o}`),this}lt(r,o){return this.url.searchParams.append(r,`lt.${o}`),this}lte(r,o){return this.url.searchParams.append(r,`lte.${o}`),this}like(r,o){return this.url.searchParams.append(r,`like.${o}`),this}likeAllOf(r,o){return this.url.searchParams.append(r,`like(all).{${o.join(",")}}`),this}likeAnyOf(r,o){return this.url.searchParams.append(r,`like(any).{${o.join(",")}}`),this}ilike(r,o){return this.url.searchParams.append(r,`ilike.${o}`),this}ilikeAllOf(r,o){return this.url.searchParams.append(r,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(r,o){return this.url.searchParams.append(r,`ilike(any).{${o.join(",")}}`),this}is(r,o){return this.url.searchParams.append(r,`is.${o}`),this}in(r,o){const f=Array.from(new Set(o)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(r,`in.(${f})`),this}contains(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cs.{${o.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(o)}`),this}containedBy(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cd.{${o.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(o)}`),this}rangeGt(r,o){return this.url.searchParams.append(r,`sr.${o}`),this}rangeGte(r,o){return this.url.searchParams.append(r,`nxl.${o}`),this}rangeLt(r,o){return this.url.searchParams.append(r,`sl.${o}`),this}rangeLte(r,o){return this.url.searchParams.append(r,`nxr.${o}`),this}rangeAdjacent(r,o){return this.url.searchParams.append(r,`adj.${o}`),this}overlaps(r,o){return typeof o=="string"?this.url.searchParams.append(r,`ov.${o}`):this.url.searchParams.append(r,`ov.{${o.join(",")}}`),this}textSearch(r,o,{config:f,type:h}={}){let g="";h==="plain"?g="pl":h==="phrase"?g="ph":h==="websearch"&&(g="w");const m=f===void 0?"":`(${f})`;return this.url.searchParams.append(r,`${g}fts${m}.${o}`),this}match(r){return Object.entries(r).forEach(([o,f])=>{this.url.searchParams.append(o,`eq.${f}`)}),this}not(r,o,f){return this.url.searchParams.append(r,`not.${o}.${f}`),this}or(r,{foreignTable:o,referencedTable:f=o}={}){const h=f?`${f}.or`:"or";return this.url.searchParams.append(h,`(${r})`),this}filter(r,o,f){return this.url.searchParams.append(r,`${o}.${f}`),this}}return ag.default=n,ag}var m1;function FS(){if(m1)return ng;m1=1,Object.defineProperty(ng,"__esModule",{value:!0});const t=_f.__importDefault(sv());class n{constructor(r,{headers:o={},schema:f,fetch:h}){this.url=r,this.headers=new Headers(o),this.schema=f,this.fetch=h}select(r,o){const{head:f=!1,count:h}=o??{},g=f?"HEAD":"GET";let m=!1;const _=(r??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",_),h&&this.headers.append("Prefer",`count=${h}`),new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:o,defaultToNull:f=!0}={}){var h;const g="POST";if(o&&this.headers.append("Prefer",`count=${o}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((_,C)=>_.concat(Object.keys(C)),[]);if(m.length>0){const _=[...new Set(m)].map(C=>`"${C}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}upsert(r,{onConflict:o,ignoreDuplicates:f=!1,count:h,defaultToNull:g=!0}={}){var m;const _="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),h&&this.headers.append("Prefer",`count=${h}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const C=r.reduce((E,R)=>E.concat(Object.keys(R)),[]);if(C.length>0){const E=[...new Set(C)].map(R=>`"${R}"`);this.url.searchParams.set("columns",E.join(","))}}return new t.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:o}={}){var f;const h="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:r}={}){var o;const f="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return ng.default=n,ng}var v1;function w_(){if(v1)return eg;v1=1,Object.defineProperty(eg,"__esModule",{value:!0});const l=_f,t=l.__importDefault(FS()),n=l.__importDefault(sv());class a{constructor(o,{headers:f={},schema:h,fetch:g}={}){this.url=o,this.headers=new Headers(f),this.schemaName=h,this.fetch=g}from(o){const f=new URL(`${this.url}/${o}`);return new t.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new a(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,f={},{head:h=!1,get:g=!1,count:m}={}){var _;let C;const E=new URL(`${this.url}/rpc/${o}`);let R;h||g?(C=h?"HEAD":"GET",Object.entries(f).filter(([D,B])=>B!==void 0).map(([D,B])=>[D,Array.isArray(B)?`{${B.join(",")}}`:`${B}`]).forEach(([D,B])=>{E.searchParams.append(D,B)})):(C="POST",R=f);const v=new Headers(this.headers);return m&&v.set("Prefer",`count=${m}`),new n.default({method:C,url:E,headers:v,schema:this.schemaName,body:R,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}}return eg.default=a,eg}var y1;function R_(){if(y1)return ei;y1=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.PostgrestError=ei.PostgrestBuilder=ei.PostgrestTransformBuilder=ei.PostgrestFilterBuilder=ei.PostgrestQueryBuilder=ei.PostgrestClient=void 0;const l=_f,t=l.__importDefault(w_());ei.PostgrestClient=t.default;const n=l.__importDefault(FS());ei.PostgrestQueryBuilder=n.default;const a=l.__importDefault(sv());ei.PostgrestFilterBuilder=a.default;const r=l.__importDefault(XS());ei.PostgrestTransformBuilder=r.default;const o=l.__importDefault(QS());ei.PostgrestBuilder=o.default;const f=l.__importDefault(KS());return ei.PostgrestError=f.default,ei.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:o.default,PostgrestError:f.default},ei}var O_=R_();const x_=pf(O_),{PostgrestClient:M_,PostgrestQueryBuilder:LT,PostgrestFilterBuilder:GT,PostgrestTransformBuilder:PT,PostgrestBuilder:HT,PostgrestError:IT}=x_;class N_{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const a=n.node,r=parseInt(a.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const a=this.getWebSocketConstructor();return new a(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const D_="2.76.1",j_=`realtime-js/${D_}`,U_="1.0.0",Gm=1e4,B_=1e3,z_=100;var od;(function(l){l[l.connecting=0]="connecting",l[l.open=1]="open",l[l.closing=2]="closing",l[l.closed=3]="closed"})(od||(od={}));var Ea;(function(l){l.closed="closed",l.errored="errored",l.joined="joined",l.joining="joining",l.leaving="leaving"})(Ea||(Ea={}));var Hr;(function(l){l.close="phx_close",l.error="phx_error",l.join="phx_join",l.reply="phx_reply",l.leave="phx_leave",l.access_token="access_token"})(Hr||(Hr={}));var Pm;(function(l){l.websocket="websocket"})(Pm||(Pm={}));var pu;(function(l){l.Connecting="connecting",l.Open="open",l.Closing="closing",l.Closed="closed"})(pu||(pu={}));class L_{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,n,a)}_decodeBroadcast(t,n,a){const r=n.getUint8(1),o=n.getUint8(2);let f=this.HEADER_LENGTH+2;const h=a.decode(t.slice(f,f+r));f=f+r;const g=a.decode(t.slice(f,f+o));f=f+o;const m=JSON.parse(a.decode(t.slice(f,t.byteLength)));return{ref:null,topic:h,event:g,payload:m}}}class JS{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Nn;(function(l){l.abstime="abstime",l.bool="bool",l.date="date",l.daterange="daterange",l.float4="float4",l.float8="float8",l.int2="int2",l.int4="int4",l.int4range="int4range",l.int8="int8",l.int8range="int8range",l.json="json",l.jsonb="jsonb",l.money="money",l.numeric="numeric",l.oid="oid",l.reltime="reltime",l.text="text",l.time="time",l.timestamp="timestamp",l.timestamptz="timestamptz",l.timetz="timetz",l.tsrange="tsrange",l.tstzrange="tstzrange"})(Nn||(Nn={}));const S1=(l,t,n={})=>{var a;const r=(a=n.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((o,f)=>(o[f]=G_(f,l,t,r),o),{}):{}},G_=(l,t,n,a)=>{const r=t.find(h=>h.name===l),o=r==null?void 0:r.type,f=n[l];return o&&!a.includes(o)?ZS(o,f):Hm(f)},ZS=(l,t)=>{if(l.charAt(0)==="_"){const n=l.slice(1,l.length);return k_(t,n)}switch(l){case Nn.bool:return P_(t);case Nn.float4:case Nn.float8:case Nn.int2:case Nn.int4:case Nn.int8:case Nn.numeric:case Nn.oid:return H_(t);case Nn.json:case Nn.jsonb:return I_(t);case Nn.timestamp:return q_(t);case Nn.abstime:case Nn.date:case Nn.daterange:case Nn.int4range:case Nn.int8range:case Nn.money:case Nn.reltime:case Nn.text:case Nn.time:case Nn.timestamptz:case Nn.timetz:case Nn.tsrange:case Nn.tstzrange:return Hm(t);default:return Hm(t)}},Hm=l=>l,P_=l=>{switch(l){case"t":return!0;case"f":return!1;default:return l}},H_=l=>{if(typeof l=="string"){const t=parseFloat(l);if(!Number.isNaN(t))return t}return l},I_=l=>{if(typeof l=="string")try{return JSON.parse(l)}catch(t){return console.log(`JSON parse error: ${t}`),l}return l},k_=(l,t)=>{if(typeof l!="string")return l;const n=l.length-1,a=l[n];if(l[0]==="{"&&a==="}"){let o;const f=l.slice(1,n);try{o=JSON.parse("["+f+"]")}catch{o=f?f.split(","):[]}return o.map(h=>ZS(t,h))}return l},q_=l=>typeof l=="string"?l.replace(" ","T"):l,WS=l=>{const t=new URL(l);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Ip{constructor(t,n,a={},r=Gm){this.channel=t,this.event=n,this.payload=a,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var a;return this._hasReceived(t)&&n((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var b1;(function(l){l.SYNC="sync",l.JOIN="join",l.LEAVE="leave"})(b1||(b1={}));class ud{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},r=>{const{onJoin:o,onLeave:f,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ud.syncState(this.state,r,o,f),this.pendingDiffs.forEach(g=>{this.state=ud.syncDiff(this.state,g,o,f)}),this.pendingDiffs=[],h()}),this.channel._on(a.diff,{},r=>{const{onJoin:o,onLeave:f,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=ud.syncDiff(this.state,r,o,f),h())}),this.onJoin((r,o,f)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:o,newPresences:f})}),this.onLeave((r,o,f)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:o,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,a,r){const o=this.cloneDeep(t),f=this.transformState(n),h={},g={};return this.map(o,(m,_)=>{f[m]||(g[m]=_)}),this.map(f,(m,_)=>{const C=o[m];if(C){const E=_.map(B=>B.presence_ref),R=C.map(B=>B.presence_ref),v=_.filter(B=>R.indexOf(B.presence_ref)<0),D=C.filter(B=>E.indexOf(B.presence_ref)<0);v.length>0&&(h[m]=v),D.length>0&&(g[m]=D)}else h[m]=_}),this.syncDiff(o,{joins:h,leaves:g},a,r)}static syncDiff(t,n,a,r){const{joins:o,leaves:f}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return a||(a=()=>{}),r||(r=()=>{}),this.map(o,(h,g)=>{var m;const _=(m=t[h])!==null&&m!==void 0?m:[];if(t[h]=this.cloneDeep(g),_.length>0){const C=t[h].map(R=>R.presence_ref),E=_.filter(R=>C.indexOf(R.presence_ref)<0);t[h].unshift(...E)}a(h,_,g)}),this.map(f,(h,g)=>{let m=t[h];if(!m)return;const _=g.map(C=>C.presence_ref);m=m.filter(C=>_.indexOf(C.presence_ref)<0),t[h]=m,r(h,m,g),m.length===0&&delete t[h]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(a=>n(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,a)=>{const r=t[a];return"metas"in r?n[a]=r.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[a]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _1;(function(l){l.ALL="*",l.INSERT="INSERT",l.UPDATE="UPDATE",l.DELETE="DELETE"})(_1||(_1={}));var cd;(function(l){l.BROADCAST="broadcast",l.PRESENCE="presence",l.POSTGRES_CHANGES="postgres_changes",l.SYSTEM="system"})(cd||(cd={}));var pl;(function(l){l.SUBSCRIBED="SUBSCRIBED",l.TIMED_OUT="TIMED_OUT",l.CLOSED="CLOSED",l.CHANNEL_ERROR="CHANNEL_ERROR"})(pl||(pl={}));class lv{constructor(t,n={config:{}},a){var r,o;if(this.topic=t,this.params=n,this.socket=a,this.bindings={},this.state=Ea.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Ip(this,Hr.join,this.params,this.timeout),this.rejoinTimer=new JS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ea.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ea.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Ea.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ea.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Ea.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Hr.reply,{},(f,h)=>{this._trigger(this._replyEventName(h),f)}),this.presence=new ud(this),this.broadcastEndpointURL=WS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var a,r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Ea.closed){const{config:{broadcast:f,presence:h,private:g}}=this.params,m=(r=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(R=>R.filter))!==null&&r!==void 0?r:[],_=!!this.bindings[cd.PRESENCE]&&this.bindings[cd.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,C={},E={broadcast:f,presence:Object.assign(Object.assign({},h),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(R=>t==null?void 0:t(pl.CHANNEL_ERROR,R)),this._onClose(()=>t==null?void 0:t(pl.CLOSED)),this.updateJoinPayload(Object.assign({config:E},C)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:R})=>{var v;if(this.socket.setAuth(),R===void 0){t==null||t(pl.SUBSCRIBED);return}else{const D=this.bindings.postgres_changes,B=(v=D==null?void 0:D.length)!==null&&v!==void 0?v:0,L=[];for(let N=0;N<B;N++){const M=D[N],{filter:{event:G,schema:O,table:w,filter:T}}=M,y=R&&R[N];if(y&&y.event===G&&y.schema===O&&y.table===w&&y.filter===T)L.push(Object.assign(Object.assign({},M),{id:y.id}));else{this.unsubscribe(),this.state=Ea.errored,t==null||t(pl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,t&&t(pl.SUBSCRIBED);return}}).receive("error",R=>{this.state=Ea.errored,t==null||t(pl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(R).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,a){return this.state===Ea.joined&&t===cd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,a)}async httpSend(t,n,a={}){var r;const o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},h=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(r=a.timeout)!==null&&r!==void 0?r:this.timeout);if(h.status===202)return{success:!0};let g=h.statusText;try{const m=await h.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(t,n={}){var a,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:f}=t,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var f,h,g;const m=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((g=(h=(f=this.params)===null||f===void 0?void 0:f.config)===null||h===void 0?void 0:h.broadcast)===null||g===void 0)&&g.ack)&&o("ok"),m.receive("ok",()=>o("ok")),m.receive("error",()=>o("error")),m.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ea.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Hr.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(r=>{a=new Ip(this,Hr.leave,{},t),a.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ea.closed,this.bindings={}}async _fetchWithTimeout(t,n,a){const r=new AbortController,o=setTimeout(()=>r.abort(),a),f=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(o),f}_push(t,n,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Ip(this,t,n,a);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>z_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,a){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,a){var r,o;const f=t.toLocaleLowerCase(),{close:h,error:g,leave:m,join:_}=Hr;if(a&&[h,g,m,_].indexOf(f)>=0&&a!==this._joinRef())return;let E=this._onMessage(f,n,a);if(n&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(R=>{var v,D,B;return((v=R.filter)===null||v===void 0?void 0:v.event)==="*"||((B=(D=R.filter)===null||D===void 0?void 0:D.event)===null||B===void 0?void 0:B.toLocaleLowerCase())===f}).map(R=>R.callback(E,a)):(o=this.bindings[f])===null||o===void 0||o.filter(R=>{var v,D,B,L,N,M;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in R){const G=R.id,O=(v=R.filter)===null||v===void 0?void 0:v.event;return G&&((D=n.ids)===null||D===void 0?void 0:D.includes(G))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((B=n.data)===null||B===void 0?void 0:B.type.toLocaleLowerCase()))}else{const G=(N=(L=R==null?void 0:R.filter)===null||L===void 0?void 0:L.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return G==="*"||G===((M=n==null?void 0:n.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===f}).map(R=>{if(typeof E=="object"&&"ids"in E){const v=E.data,{schema:D,table:B,commit_timestamp:L,type:N,errors:M}=v;E=Object.assign(Object.assign({},{schema:D,table:B,commit_timestamp:L,eventType:N,new:{},old:{},errors:M}),this._getPayloadRecords(v))}R.callback(E,a)})}_isClosed(){return this.state===Ea.closed}_isJoined(){return this.state===Ea.joined}_isJoining(){return this.state===Ea.joining}_isLeaving(){return this.state===Ea.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,a){const r=t.toLocaleLowerCase(),o={type:r,filter:n,callback:a};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(t,n){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(r=>{var o;return!(((o=r.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===a&&lv.isEqual(r.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const a in t)if(t[a]!==n[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Hr.close,{},t)}_onError(t){this._on(Hr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ea.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=S1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=S1(t.columns,t.old_record)),n}}const kp=()=>{},lg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},V_=[1e3,2e3,5e3,1e4],Y_=1e4,K_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Q_{constructor(t,n){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gm,this.transport=null,this.heartbeatIntervalMs=lg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=kp,this.ref=0,this.reconnectTimer=null,this.logger=kp,this.conn=null,this.sendBuffer=[],this.serializer=new L_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...f)=>Au(async()=>{const{default:h}=await Promise.resolve().then(()=>wu);return{default:h}},void 0).then(({default:h})=>h(...f)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...f)=>o(...f)},!(!((a=n==null?void 0:n.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${Pm.websocket}`,this.httpEndpoint=WS(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=N_.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:U_}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,a){this.logger(t,n,a)}connectionState(){switch(this.conn&&this.conn.readyState){case od.connecting:return pu.Connecting;case od.open:return pu.Open;case od.closing:return pu.Closing;default:return pu.Closed}}isConnected(){return this.connectionState()===pu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const a=`realtime:${t}`,r=this.getChannels().find(o=>o.topic===a);if(r)return r;{const o=new lv(`realtime:${t}`,n,this);return this.channels.push(o),o}}push(t){const{topic:n,event:a,payload:r,ref:o}=t,f=()=>{this.encode(t,h=>{var g;(g=this.conn)===null||g===void 0||g.send(h)})};this.log("push",`${n} ${a} (${o})`,r),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(B_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},lg.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:r,payload:o,ref:f}=n,h=f?`(${f})`:"",g=o.status||"";this.log("receive",`${g} ${a} ${r} ${h}`.trim(),o),this.channels.filter(m=>m._isMember(a)).forEach(m=>m._trigger(r,o,f)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Hr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const a=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${a}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const a=new Blob([K_],{type:"application/javascript"});n=URL.createObjectURL(a)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(a=>{const r={access_token:n,version:j_};n&&a.updateJoinPayload(r),a.joinedOnce&&a._isJoined()&&a._push(Hr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(n)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new JS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,a,r,o,f,h,g,m,_;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:Gm,this.heartbeatIntervalMs=(r=t==null?void 0:t.heartbeatIntervalMs)!==null&&r!==void 0?r:lg.HEARTBEAT_INTERVAL,this.worker=(o=t==null?void 0:t.worker)!==null&&o!==void 0?o:!1,this.accessToken=(f=t==null?void 0:t.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(h=t==null?void 0:t.heartbeatCallback)!==null&&h!==void 0?h:kp,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(C=>V_[C-1]||Y_),this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((C,E)=>E(JSON.stringify(C))),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ov extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Kn(l){return typeof l=="object"&&l!==null&&"__isStorageError"in l}class X_ extends ov{constructor(t,n,a){super(t),this.name="StorageApiError",this.status=n,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Im extends ov{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const uv=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...n)=>Au(async()=>{const{default:a}=await Promise.resolve().then(()=>wu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},F_=()=>re(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Au(()=>Promise.resolve().then(()=>wu),void 0)).Response:Response}),km=l=>{if(Array.isArray(l))return l.map(n=>km(n));if(typeof l=="function"||l!==Object(l))return l;const t={};return Object.entries(l).forEach(([n,a])=>{const r=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[r]=km(a)}),t},J_=l=>{if(typeof l!="object"||l===null)return!1;const t=Object.getPrototypeOf(l);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},qp=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Z_=(l,t,n)=>re(void 0,void 0,void 0,function*(){const a=yield F_();l instanceof a&&!(n!=null&&n.noResolveJson)?l.json().then(r=>{const o=l.status||500,f=(r==null?void 0:r.statusCode)||o+"";t(new X_(qp(r),o,f))}).catch(r=>{t(new Im(qp(r),r))}):t(new Im(qp(l),l))}),W_=(l,t,n,a)=>{const r={method:l,headers:(t==null?void 0:t.headers)||{}};return l==="GET"||!a?r:(J_(a)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,t!=null&&t.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),n))};function Sd(l,t,n,a,r,o){return re(this,void 0,void 0,function*(){return new Promise((f,h)=>{l(n,W_(t,a,r,o)).then(g=>{if(!g.ok)throw g;return a!=null&&a.noResolveJson?g:g.json()}).then(g=>f(g)).catch(g=>Z_(g,h,a))})})}function gd(l,t,n,a){return re(this,void 0,void 0,function*(){return Sd(l,"GET",t,n,a)})}function Pr(l,t,n,a,r){return re(this,void 0,void 0,function*(){return Sd(l,"POST",t,a,r,n)})}function qm(l,t,n,a,r){return re(this,void 0,void 0,function*(){return Sd(l,"PUT",t,a,r,n)})}function $_(l,t,n,a){return re(this,void 0,void 0,function*(){return Sd(l,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),a)})}function cv(l,t,n,a,r){return re(this,void 0,void 0,function*(){return Sd(l,"DELETE",t,a,r,n)})}class tE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return re(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Kn(t))return{data:null,error:t};throw t}})}}var $S;class eE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[$S]="BlobDownloadBuilder",this.promise=null}asStream(){return new tE(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return re(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Kn(t))return{data:null,error:t};throw t}})}}$S=Symbol.toStringTag;const nE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},E1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class aE{constructor(t,n={},a,r){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=a,this.fetch=uv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,a,r){return re(this,void 0,void 0,function*(){try{let o;const f=Object.assign(Object.assign({},E1),r);let h=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(f.upsert)});const g=f.metadata;typeof Blob<"u"&&a instanceof Blob?(o=new FormData,o.append("cacheControl",f.cacheControl),g&&o.append("metadata",this.encodeMetadata(g)),o.append("",a)):typeof FormData<"u"&&a instanceof FormData?(o=a,o.append("cacheControl",f.cacheControl),g&&o.append("metadata",this.encodeMetadata(g))):(o=a,h["cache-control"]=`max-age=${f.cacheControl}`,h["content-type"]=f.contentType,g&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),r!=null&&r.headers&&(h=Object.assign(Object.assign({},h),r.headers));const m=this._removeEmptyFolders(n),_=this._getFinalPath(m),C=yield(t=="PUT"?qm:Pr)(this.fetch,`${this.url}/object/${_}`,o,Object.assign({headers:h},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:C.Id,fullPath:C.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Kn(o))return{data:null,error:o};throw o}})}upload(t,n,a){return re(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,a)})}uploadToSignedUrl(t,n,a,r){return re(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),f=this._getFinalPath(o),h=new URL(this.url+`/object/upload/sign/${f}`);h.searchParams.set("token",n);try{let g;const m=Object.assign({upsert:E1.upsert},r),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&a instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",a)):typeof FormData<"u"&&a instanceof FormData?(g=a,g.append("cacheControl",m.cacheControl)):(g=a,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType);const C=yield qm(this.fetch,h.toString(),g,{headers:_});return{data:{path:o,fullPath:C.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(Kn(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(t,n){return re(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const o=yield Pr(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:r}),f=new URL(this.url+o.url),h=f.searchParams.get("token");if(!h)throw new ov("No token returned by API");return{data:{signedUrl:f.toString(),path:t,token:h},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Kn(a))return{data:null,error:a};throw a}})}update(t,n,a){return re(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,a)})}move(t,n,a){return re(this,void 0,void 0,function*(){try{return{data:yield Pr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Kn(r))return{data:null,error:r};throw r}})}copy(t,n,a){return re(this,void 0,void 0,function*(){try{return{data:{path:(yield Pr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Kn(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,a){return re(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),o=yield Pr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const f=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${f}`)},{data:o,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Kn(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,a){return re(this,void 0,void 0,function*(){try{const r=yield Pr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),o=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:r.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${o}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Kn(r))return{data:null,error:r};throw r}})}download(t,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),f=o?`?${o}`:"",h=this._getFinalPath(t),g=()=>gd(this.fetch,`${this.url}/${r}/${h}${f}`,{headers:this.headers,noResolveJson:!0});return new eE(g,this.shouldThrowOnError)}info(t){return re(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const a=yield gd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:km(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Kn(a))return{data:null,error:a};throw a}})}exists(t){return re(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield $_(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Kn(a)&&a instanceof Im){const r=a.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,n){const a=this._getFinalPath(t),r=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&r.push(o);const h=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});g!==""&&r.push(g);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${a}${m}`)}}}remove(t){return re(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}})}list(t,n,a){return re(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},nE),n),{prefix:t||""});return{data:yield Pr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},a),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Kn(r))return{data:null,error:r};throw r}})}listV2(t,n){return re(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield Pr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Kn(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const tb="2.76.1",eb={"X-Client-Info":`storage-js/${tb}`};class iE{constructor(t,n={},a,r){this.shouldThrowOnError=!1;const o=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},eb),n),this.fetch=uv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return re(this,void 0,void 0,function*(){try{return{data:yield gd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Kn(t))return{data:null,error:t};throw t}})}getBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield gd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}})}createBucket(t){return re(this,arguments,void 0,function*(n,a={public:!1}){try{return{data:yield Pr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Kn(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return re(this,void 0,void 0,function*(){try{return{data:yield qm(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Kn(a))return{data:null,error:a};throw a}})}emptyBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield Pr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}})}}class rE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},eb),n),this.fetch=uv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield Pr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}})}listBuckets(t){return re(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const a=n.toString(),r=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`,o=yield gd(this.fetch,r,{headers:this.headers});return{data:Array.isArray(o)?o.filter(h=>h.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}})}}const fv={"X-Client-Info":`storage-js/${tb}`,"Content-Type":"application/json"};class nb extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Pi(l){return typeof l=="object"&&l!==null&&"__isStorageVectorsError"in l}class Vp extends nb{constructor(t,n,a){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sE extends nb{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var C1;(function(l){l.InternalError="InternalError",l.S3VectorConflictException="S3VectorConflictException",l.S3VectorNotFoundException="S3VectorNotFoundException",l.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",l.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",l.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(C1||(C1={}));const hv=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...n)=>Au(async()=>{const{default:a}=await Promise.resolve().then(()=>wu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},lE=l=>{if(typeof l!="object"||l===null)return!1;const t=Object.getPrototypeOf(l);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},T1=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),oE=(l,t,n)=>re(void 0,void 0,void 0,function*(){if(l&&typeof l=="object"&&"status"in l&&"ok"in l&&typeof l.status=="number"&&!(n!=null&&n.noResolveJson)){const r=l.status||500,o=l;if(typeof o.json=="function")o.json().then(f=>{const h=(f==null?void 0:f.statusCode)||(f==null?void 0:f.code)||r+"";t(new Vp(T1(f),r,h))}).catch(()=>{const f=r+"",h=o.statusText||`HTTP ${r} error`;t(new Vp(h,r,f))});else{const f=r+"",h=o.statusText||`HTTP ${r} error`;t(new Vp(h,r,f))}}else t(new sE(T1(l),l))}),uE=(l,t,n,a)=>{const r={method:l,headers:(t==null?void 0:t.headers)||{}};return a?(lE(a)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,Object.assign(Object.assign({},r),n)):r};function cE(l,t,n,a,r,o){return re(this,void 0,void 0,function*(){return new Promise((f,h)=>{l(n,uE(t,a,r,o)).then(g=>{if(!g.ok)throw g;if(a!=null&&a.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>f(g)).catch(g=>oE(g,h,a))})})}function Hi(l,t,n,a,r){return re(this,void 0,void 0,function*(){return cE(l,"POST",t,a,r,n)})}class fE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return re(this,void 0,void 0,function*(){try{return{data:(yield Hi(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}getIndex(t,n){return re(this,void 0,void 0,function*(){try{return{data:yield Hi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Pi(a))return{data:null,error:a};throw a}})}listIndexes(t){return re(this,void 0,void 0,function*(){try{return{data:yield Hi(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return re(this,void 0,void 0,function*(){try{return{data:(yield Hi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Pi(a))return{data:null,error:a};throw a}})}}class hE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return re(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Hi(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}getVectors(t){return re(this,void 0,void 0,function*(){try{return{data:yield Hi(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}listVectors(t){return re(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Hi(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}queryVectors(t){return re(this,void 0,void 0,function*(){try{return{data:yield Hi(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}deleteVectors(t){return re(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Hi(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}}class dE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fv),n),this.fetch=hv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return re(this,void 0,void 0,function*(){try{return{data:(yield Hi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}getBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield Hi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}listBuckets(){return re(this,arguments,void 0,function*(t={}){try{return{data:yield Hi(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}deleteBucket(t){return re(this,void 0,void 0,function*(){try{return{data:(yield Hi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}})}}class gE extends dE{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new pE(this.url,this.headers,t,this.fetch)}}class pE extends fE{constructor(t,n,a,r){super(t,n,r),this.vectorBucketName=a}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return re(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return re(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return re(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return re(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new mE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class mE extends hE{constructor(t,n,a,r,o){super(t,n,o),this.vectorBucketName=a,this.indexName=r}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return re(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return re(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return re(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return re(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return re(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vE extends iE{constructor(t,n={},a,r){super(t,n,a,r)}from(t){return new aE(this.url,this.headers,t,this.fetch)}get vectors(){return new gE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new rE(this.url+"/iceberg",this.headers,this.fetch)}}const yE="2.76.1";let ad="";typeof Deno<"u"?ad="deno":typeof document<"u"?ad="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ad="react-native":ad="node";const SE={"X-Client-Info":`supabase-js-${ad}/${yE}`},bE={headers:SE},_E={schema:"public"},EE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},CE={},TE=l=>{let t;return l?t=l:typeof fetch>"u"?t=VS:t=fetch,(...n)=>t(...n)},AE=()=>typeof Headers>"u"?YS:Headers,wE=(l,t,n)=>{const a=TE(n),r=AE();return async(o,f)=>{var h;const g=(h=await t())!==null&&h!==void 0?h:l;let m=new r(f==null?void 0:f.headers);return m.has("apikey")||m.set("apikey",l),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),a(o,Object.assign(Object.assign({},f),{headers:m}))}};function RE(l){return l.endsWith("/")?l:l+"/"}function OE(l,t){var n,a;const{db:r,auth:o,realtime:f,global:h}=l,{db:g,auth:m,realtime:_,global:C}=t,E={db:Object.assign(Object.assign({},g),r),auth:Object.assign(Object.assign({},m),o),realtime:Object.assign(Object.assign({},_),f),storage:{},global:Object.assign(Object.assign(Object.assign({},C),h),{headers:Object.assign(Object.assign({},(n=C==null?void 0:C.headers)!==null&&n!==void 0?n:{}),(a=h==null?void 0:h.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return l.accessToken?E.accessToken=l.accessToken:delete E.accessToken,E}function xE(l){const t=l==null?void 0:l.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(RE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const ab="2.76.1",lf=30*1e3,Vm=3,Yp=Vm*lf,ME="http://localhost:9999",NE="supabase.auth.token",DE={"X-Client-Info":`gotrue-js/${ab}`},Ym="X-Supabase-Api-Version",ib={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,UE=600*1e3;class pd extends Error{constructor(t,n,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=a}}function ge(l){return typeof l=="object"&&l!==null&&"__isAuthError"in l}class BE extends pd{constructor(t,n,a){super(t,n,a),this.name="AuthApiError",this.status=n,this.code=a}}function zE(l){return ge(l)&&l.name==="AuthApiError"}class mu extends pd{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class So extends pd{constructor(t,n,a,r){super(t,a,r),this.name=n,this.status=a}}class oo extends So{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function LE(l){return ge(l)&&l.name==="AuthSessionMissingError"}class Wc extends So{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class og extends So{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ug extends So{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function GE(l){return ge(l)&&l.name==="AuthImplicitGrantRedirectError"}class A1 extends So{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Km extends So{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Kp(l){return ge(l)&&l.name==="AuthRetryableFetchError"}class w1 extends So{constructor(t,n,a){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=a}}class Qm extends So{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Sg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),R1=` 	
\r=`.split(""),PE=(()=>{const l=new Array(128);for(let t=0;t<l.length;t+=1)l[t]=-1;for(let t=0;t<R1.length;t+=1)l[R1[t].charCodeAt(0)]=-2;for(let t=0;t<Sg.length;t+=1)l[Sg[t].charCodeAt(0)]=t;return l})();function O1(l,t,n){if(l!==null)for(t.queue=t.queue<<8|l,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;n(Sg[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;n(Sg[a]),t.queuedBits-=6}}function rb(l,t,n){const a=PE[l];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(l)}"`)}}function x1(l){const t=[],n=f=>{t.push(String.fromCodePoint(f))},a={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},o=f=>{kE(f,a,n)};for(let f=0;f<l.length;f+=1)rb(l.charCodeAt(f),r,o);return t.join("")}function HE(l,t){if(l<=127){t(l);return}else if(l<=2047){t(192|l>>6),t(128|l&63);return}else if(l<=65535){t(224|l>>12),t(128|l>>6&63),t(128|l&63);return}else if(l<=1114111){t(240|l>>18),t(128|l>>12&63),t(128|l>>6&63),t(128|l&63);return}throw new Error(`Unrecognized Unicode codepoint: ${l.toString(16)}`)}function IE(l,t){for(let n=0;n<l.length;n+=1){let a=l.charCodeAt(n);if(a>55295&&a<=56319){const r=(a-55296)*1024&65535;a=(l.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}HE(a,t)}}function kE(l,t,n){if(t.utf8seq===0){if(l<=127){n(l);return}for(let a=1;a<6;a+=1)if((l>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=l&31;else if(t.utf8seq===3)t.codepoint=l&15;else if(t.utf8seq===4)t.codepoint=l&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(l<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|l&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function cf(l){const t=[],n={queue:0,queuedBits:0},a=r=>{t.push(r)};for(let r=0;r<l.length;r+=1)rb(l.charCodeAt(r),n,a);return new Uint8Array(t)}function qE(l){const t=[];return IE(l,n=>t.push(n)),new Uint8Array(t)}function yu(l){const t=[],n={queue:0,queuedBits:0},a=r=>{t.push(r)};return l.forEach(r=>O1(r,n,a)),O1(null,n,a),t.join("")}function VE(l){return Math.round(Date.now()/1e3)+l}function YE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){const t=Math.random()*16|0;return(l=="x"?t:t&3|8).toString(16)})}const Li=()=>typeof window<"u"&&typeof document<"u",uu={tested:!1,writable:!1},sb=()=>{if(!Li())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(uu.tested)return uu.writable;const l=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(l,l),globalThis.localStorage.removeItem(l),uu.tested=!0,uu.writable=!0}catch{uu.tested=!0,uu.writable=!1}return uu.writable};function KE(l){const t={},n=new URL(l);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,o)=>{t[o]=r})}catch{}return n.searchParams.forEach((a,r)=>{t[r]=a}),t}const lb=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...n)=>Au(async()=>{const{default:a}=await Promise.resolve().then(()=>wu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},QE=l=>typeof l=="object"&&l!==null&&"status"in l&&"ok"in l&&"json"in l&&typeof l.json=="function",of=async(l,t,n)=>{await l.setItem(t,JSON.stringify(n))},cu=async(l,t)=>{const n=await l.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},io=async(l,t)=>{await l.removeItem(t)};class jg{constructor(){this.promise=new jg.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}jg.promiseConstructor=Promise;function Qp(l){const t=l.split(".");if(t.length!==3)throw new Qm("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!jE.test(t[a]))throw new Qm("JWT not in base64url format");return{header:JSON.parse(x1(t[0])),payload:JSON.parse(x1(t[1])),signature:cf(t[2]),raw:{header:t[0],payload:t[1]}}}async function XE(l){return await new Promise(t=>{setTimeout(()=>t(null),l)})}function FE(l,t){return new Promise((a,r)=>{(async()=>{for(let o=0;o<1/0;o++)try{const f=await l(o);if(!t(o,null,f)){a(f);return}}catch(f){if(!t(o,f)){r(f);return}}})()})}function JE(l){return("0"+l.toString(16)).substr(-2)}function ZE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=n.length;let r="";for(let o=0;o<56;o++)r+=n.charAt(Math.floor(Math.random()*a));return r}return crypto.getRandomValues(t),Array.from(t,JE).join("")}async function WE(l){const n=new TextEncoder().encode(l),a=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(a);return Array.from(r).map(o=>String.fromCharCode(o)).join("")}async function $E(l){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),l;const n=await WE(l);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $c(l,t,n=!1){const a=ZE();let r=a;n&&(r+="/PASSWORD_RECOVERY"),await of(l,`${t}-code-verifier`,r);const o=await $E(a);return[o,a===o?"plain":"s256"]}const tC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function eC(l){const t=l.headers.get(Ym);if(!t||!t.match(tC))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function nC(l){if(!l)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(l<=t)throw new Error("JWT has expired")}function aC(l){switch(l){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const iC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tf(l){if(!iC.test(l))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xp(){const l={};return new Proxy(l,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function M1(l){return JSON.parse(JSON.stringify(l))}const du=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),rC=[502,503,504];async function N1(l){var t;if(!QE(l))throw new Km(du(l),0);if(rC.includes(l.status))throw new Km(du(l),l.status);let n;try{n=await l.json()}catch(o){throw new mu(du(o),o)}let a;const r=eC(l);if(r&&r.getTime()>=ib["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?a=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(a=n.error_code),a){if(a==="weak_password")throw new w1(du(n),l.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new oo}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,f)=>o&&typeof f=="string",!0))throw new w1(du(n),l.status,n.weak_password.reasons);throw new BE(du(n),l.status||500,a)}const sC=(l,t,n,a)=>{const r={method:l,headers:(t==null?void 0:t.headers)||{}};return l==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(a),Object.assign(Object.assign({},r),n))};async function Me(l,t,n,a){var r;const o=Object.assign({},a==null?void 0:a.headers);o[Ym]||(o[Ym]=ib["2024-01-01"].name),a!=null&&a.jwt&&(o.Authorization=`Bearer ${a.jwt}`);const f=(r=a==null?void 0:a.query)!==null&&r!==void 0?r:{};a!=null&&a.redirectTo&&(f.redirect_to=a.redirectTo);const h=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",g=await lC(l,t,n+h,{headers:o,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(g):{data:Object.assign({},g),error:null}}async function lC(l,t,n,a,r,o){const f=sC(t,a,r,o);let h;try{h=await l(n,Object.assign({},f))}catch(g){throw console.error(g),new Km(du(g),0)}if(h.ok||await N1(h),a!=null&&a.noResolveJson)return h;try{return await h.json()}catch(g){await N1(g)}}function Gr(l){var t;let n=null;cC(l)&&(n=Object.assign({},l),l.expires_at||(n.expires_at=VE(l.expires_in)));const a=(t=l.user)!==null&&t!==void 0?t:l;return{data:{session:n,user:a},error:null}}function D1(l){const t=Gr(l);return!t.error&&l.weak_password&&typeof l.weak_password=="object"&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.message&&typeof l.weak_password.message=="string"&&l.weak_password.reasons.reduce((n,a)=>n&&typeof a=="string",!0)&&(t.data.weak_password=l.weak_password),t}function co(l){var t;return{data:{user:(t=l.user)!==null&&t!==void 0?t:l},error:null}}function oC(l){return{data:l,error:null}}function uC(l){const{action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:o}=l,f=bf(l,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:o},g=Object.assign({},f);return{data:{properties:h,user:g},error:null}}function j1(l){return l}function cC(l){return l.access_token&&l.refresh_token&&l.expires_in}const Fp=["global","local","others"];class fC{constructor({url:t="",headers:n={},fetch:a}){this.url=t,this.headers=n,this.fetch=lb(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Fp[0]){if(Fp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fp.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(ge(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,n={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:co})}catch(a){if(ge(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:n}=t,a=bf(t,["options"]),r=Object.assign(Object.assign({},a),n);return"newEmail"in a&&(r.new_email=a==null?void 0:a.newEmail,delete r.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:uC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ge(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:co})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,a,r,o,f,h,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",per_page:(o=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:j1});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(h=_.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(v.split(";")[1].split("=")[1]);m[`${B}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(ge(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){tf(t);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:co})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){tf(t);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:co})}catch(a){if(ge(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,n=!1){tf(t);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:co})}catch(a){if(ge(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){tf(t.userId);try{const{data:n,error:a}=await Me(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:a}}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _deleteFactor(t){tf(t.userId),tf(t.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,a,r,o,f,h,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",per_page:(o=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:j1});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(h=_.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(v.split(";")[1].split("=")[1]);m[`${B}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(ge(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ge(n))return{data:null,error:n};throw n}}}function U1(l={}){return{getItem:t=>l[t]||null,setItem:(t,n)=>{l[t]=n},removeItem:t=>{delete l[t]}}}const ef={debug:!!(globalThis&&sb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ob extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class hC extends ob{}async function dC(l,t,n){ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",l,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),ef.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",l)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(l,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async r=>{if(r){ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",l,r.name);try{return await n()}finally{ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",l,r.name)}}else{if(t===0)throw ef.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",l),new hC(`Acquiring an exclusive Navigator LockManager lock "${l}" immediately failed`);if(ef.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function gC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ub(l){if(!/^0x[a-fA-F0-9]{40}$/.test(l))throw new Error(`@supabase/auth-js: Address "${l}" is invalid.`);return l.toLowerCase()}function pC(l){return parseInt(l,16)}function mC(l){const t=new TextEncoder().encode(l);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function vC(l){var t;const{chainId:n,domain:a,expirationTime:r,issuedAt:o=new Date,nonce:f,notBefore:h,requestId:g,resources:m,scheme:_,uri:C,version:E}=l;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((t=l.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${l.statement}`)}const R=ub(l.address),v=_?`${_}://${a}`:a,D=l.statement?`${l.statement}
`:"",B=`${v} wants you to sign in with your Ethereum account:
${R}

${D}`;let L=`URI: ${C}
Version: ${E}
Chain ID: ${n}${f?`
Nonce: ${f}`:""}
Issued At: ${o.toISOString()}`;if(r&&(L+=`
Expiration Time: ${r.toISOString()}`),h&&(L+=`
Not Before: ${h.toISOString()}`),g&&(L+=`
Request ID: ${g}`),m){let N=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);N+=`
- ${M}`}L+=N}return`${B}
${L}`}class fa extends Error{constructor({message:t,code:n,cause:a,name:r}){var o;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(o=r??(a instanceof Error?a.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=n}}class bg extends fa{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function yC({error:l,options:t}){var n,a,r;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(t.signal instanceof AbortSignal)return new fa({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else if(l.name==="ConstraintError"){if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new fa({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:l});if(t.mediation==="conditional"&&((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new fa({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:l});if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new fa({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:l})}else{if(l.name==="InvalidStateError")return new fa({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:l});if(l.name==="NotAllowedError")return new fa({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="NotSupportedError")return o.pubKeyCredParams.filter(h=>h.type==="public-key").length===0?new fa({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:l}):new fa({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:l});if(l.name==="SecurityError"){const f=window.location.hostname;if(cb(f)){if(o.rp.id!==f)return new fa({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new fa({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new fa({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:l})}else if(l.name==="UnknownError")return new fa({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new fa({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}function SC({error:l,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(t.signal instanceof AbortSignal)return new fa({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else{if(l.name==="NotAllowedError")return new fa({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="SecurityError"){const a=window.location.hostname;if(cb(a)){if(n.rpId!==a)return new fa({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new fa({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="UnknownError")return new fa({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new fa({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}class bC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const _C=new bC;function EC(l){if(!l)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(l);const{challenge:t,user:n,excludeCredentials:a}=l,r=bf(l,["challenge","user","excludeCredentials"]),o=cf(t).buffer,f=Object.assign(Object.assign({},n),{id:cf(n.id).buffer}),h=Object.assign(Object.assign({},r),{challenge:o,user:f});if(a&&a.length>0){h.excludeCredentials=new Array(a.length);for(let g=0;g<a.length;g++){const m=a[g];h.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:cf(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return h}function CC(l){if(!l)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(l);const{challenge:t,allowCredentials:n}=l,a=bf(l,["challenge","allowCredentials"]),r=cf(t).buffer,o=Object.assign(Object.assign({},a),{challenge:r});if(n&&n.length>0){o.allowCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const h=n[f];o.allowCredentials[f]=Object.assign(Object.assign({},h),{id:cf(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return o}function TC(l){var t;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const n=l;return{id:l.id,rawId:l.id,response:{attestationObject:yu(new Uint8Array(l.response.attestationObject)),clientDataJSON:yu(new Uint8Array(l.response.clientDataJSON))},type:"public-key",clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function AC(l){var t;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const n=l,a=l.getClientExtensionResults(),r=l.response;return{id:l.id,rawId:l.id,response:{authenticatorData:yu(new Uint8Array(r.authenticatorData)),clientDataJSON:yu(new Uint8Array(r.clientDataJSON)),signature:yu(new Uint8Array(r.signature)),userHandle:r.userHandle?yu(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function cb(l){return l==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(l)}function B1(){var l,t;return!!(Li()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((l=navigator==null?void 0:navigator.credentials)===null||l===void 0?void 0:l.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function wC(l){try{const t=await navigator.credentials.create(l);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new bg("Browser returned unexpected credential type",t)}:{data:null,error:new bg("Empty credential response",t)}}catch(t){return{data:null,error:yC({error:t,options:l})}}}async function RC(l){try{const t=await navigator.credentials.get(l);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new bg("Browser returned unexpected credential type",t)}:{data:null,error:new bg("Empty credential response",t)}}catch(t){return{data:null,error:SC({error:t,options:l})}}}const OC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},xC={userVerification:"preferred",hints:["security-key"]};function _g(...l){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),a={};for(const r of l)if(r)for(const o in r){const f=r[o];if(f!==void 0)if(Array.isArray(f))a[o]=f;else if(n(f))a[o]=f;else if(t(f)){const h=a[o];t(h)?a[o]=_g(h,f):a[o]=_g(f)}else a[o]=f}return a}function MC(l,t){return _g(OC,l,t||{})}function NC(l,t){return _g(xC,l,t||{})}class DC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:a,signal:r},o){try{const{data:f,error:h}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!f)return{data:null,error:h};const g=r??_C.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${a}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=MC(f.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:_,error:C}=await wC({publicKey:m,signal:g});return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}case"request":{const m=NC(f.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:_,error:C}=await RC(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}}}catch(f){return ge(f)?{data:null,error:f}:{data:null,error:new mu("Unexpected error in challenge",f)}}}async _verify({challengeId:t,factorId:n,webauthn:a}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:r}},o){if(!n)return{data:null,error:new pd("rpId is required for WebAuthn authentication")};try{if(!B1())return{data:null,error:new mu("Browser does not support WebAuthn",null)};const{data:f,error:h}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:a},signal:r},{request:o});if(!f)return{data:null,error:h};const{webauthn:g}=f;return this._verify({factorId:t,challengeId:f.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:a,credential_response:g.credential_response}})}catch(f){return ge(f)?{data:null,error:f}:{data:null,error:new mu("Unexpected error in authenticate",f)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:r},o){if(!n)return{data:null,error:new pd("rpId is required for WebAuthn registration")};try{if(!B1())return{data:null,error:new mu("Browser does not support WebAuthn",null)};const{data:f,error:h}=await this._enroll({friendlyName:t});if(!f)return await this.client.mfa.listFactors().then(_=>{var C;return(C=_.data)===null||C===void 0?void 0:C.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===t&&E.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:h};const{data:g,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:n,rpOrigins:a},signal:r},{create:o});return g?this._verify({factorId:f.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:a,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(f){return ge(f)?{data:null,error:f}:{data:null,error:new mu("Unexpected error in register",f)}}}}gC();const jC={url:ME,storageKey:NE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function z1(l,t,n){return await n()}const nf={};class md{get jwks(){var t,n;return(n=(t=nf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){nf[this.storageKey]=Object.assign(Object.assign({},nf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=nf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){nf[this.storageKey]=Object.assign(Object.assign({},nf[this.storageKey]),{cachedAt:t})}constructor(t){var n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=md.nextInstanceID,md.nextInstanceID+=1,this.instanceID>0&&Li()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},jC),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new fC({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=lb(r.fetch),this.lock=r.lock||z1,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Li()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=dC:this.lock=z1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new DC(this)},this.persistSession?(r.storage?this.storage=r.storage:sb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=U1(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=U1(this.memoryStorage)),Li()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ab}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=KE(window.location.href);let a="none";if(this._isImplicitGrantCallback(n)?a="implicit":await this._isPKCECallback(n)&&(a="pkce"),Li()&&this.detectSessionInUrl&&a!=="none"){const{data:r,error:o}=await this._getSessionFromURL(n,a);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),GE(o)){const g=(t=o.details)===null||t===void 0?void 0:t.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:f,redirectType:h}=r;return this._debug("#_initialize()","detected session in URL",f,"redirect type",h),await this._saveSession(f),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ge(n)?{error:n}:{error:new mu("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,a,r;try{const o=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:Gr}),{data:f,error:h}=o;if(h||!f)return{data:{user:null,session:null},error:h};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(o){if(ge(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(t){var n,a,r;try{let o;if("email"in t){const{email:_,password:C,options:E}=t;let R=null,v=null;this.flowType==="pkce"&&([R,v]=await $c(this.storage,this.storageKey)),o=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:_,password:C,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:R,code_challenge_method:v},xform:Gr})}else if("phone"in t){const{phone:_,password:C,options:E}=t;o=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:C,data:(a=E==null?void 0:E.data)!==null&&a!==void 0?a:{},channel:(r=E==null?void 0:E.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:Gr})}else throw new og("You must provide either an email or phone number and a password");const{data:f,error:h}=o;if(h||!f)return{data:{user:null,session:null},error:h};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(o){if(ge(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(t){try{let n;if("email"in t){const{email:o,password:f,options:h}=t;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:f,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:D1})}else if("phone"in t){const{phone:o,password:f,options:h}=t;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:f,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:D1})}else throw new og("You must provide either an email or phone number and a password");const{data:a,error:r}=n;return r?{data:{user:null,session:null},error:r}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Wc}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:r})}catch(n){if(ge(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,a,r,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,a,r,o,f,h,g,m,_,C,E;let R,v;if("message"in t)R=t.message,v=t.signature;else{const{chain:D,wallet:B,statement:L,options:N}=t;let M;if(Li())if(typeof B=="object")M=B;else{const z=window;if("ethereum"in z&&typeof z.ethereum=="object"&&"request"in z.ethereum&&typeof z.ethereum.request=="function")M=z.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof B!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=B}const G=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href),O=await M.request({method:"eth_requestAccounts"}).then(z=>z).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const w=ub(O[0]);let T=(a=N==null?void 0:N.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!T){const z=await M.request({method:"eth_chainId"});T=pC(z)}const y={domain:G.host,address:w,statement:L,uri:G.href,version:"1",chainId:T,nonce:(r=N==null?void 0:N.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(f=(o=N==null?void 0:N.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(h=N==null?void 0:N.signInWithEthereum)===null||h===void 0?void 0:h.expirationTime,notBefore:(g=N==null?void 0:N.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=N==null?void 0:N.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=N==null?void 0:N.signInWithEthereum)===null||_===void 0?void 0:_.resources};R=vC(y),v=await M.request({method:"personal_sign",params:[mC(R),w]})}try{const{data:D,error:B}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:R,signature:v},!((C=t.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(E=t.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:Gr});if(B)throw B;return!D||!D.session||!D.user?{data:{user:null,session:null},error:new Wc}:(D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),{data:Object.assign({},D),error:B})}catch(D){if(ge(D))return{data:{user:null,session:null},error:D};throw D}}async signInWithSolana(t){var n,a,r,o,f,h,g,m,_,C,E,R;let v,D;if("message"in t)v=t.message,D=t.signature;else{const{chain:B,wallet:L,statement:N,options:M}=t;let G;if(Li())if(typeof L=="object")G=L;else{const w=window;if("solana"in w&&typeof w.solana=="object"&&("signIn"in w.solana&&typeof w.solana.signIn=="function"||"signMessage"in w.solana&&typeof w.solana.signMessage=="function"))G=w.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(M!=null&&M.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=L}const O=new URL((n=M==null?void 0:M.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in G&&G.signIn){const w=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M==null?void 0:M.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),N?{statement:N}:null));let T;if(Array.isArray(w)&&w[0]&&typeof w[0]=="object")T=w[0];else if(w&&typeof w=="object"&&"signedMessage"in w&&"signature"in w)T=w;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)v=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),D=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${O.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(r=(a=M==null?void 0:M.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((o=M==null?void 0:M.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((f=M==null?void 0:M.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((h=M==null?void 0:M.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((g=M==null?void 0:M.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M==null?void 0:M.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((C=(_=M==null?void 0:M.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||C===void 0)&&C.length?["Resources",...M.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const w=await G.signMessage(new TextEncoder().encode(v),"utf8");if(!w||!(w instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=w}}try{const{data:B,error:L}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:yu(D)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(R=t.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:Gr});if(L)throw L;return!B||!B.session||!B.user?{data:{user:null,session:null},error:new Wc}:(B.session&&(await this._saveSession(B.session),await this._notifyAllSubscribers("SIGNED_IN",B.session)),{data:Object.assign({},B),error:L})}catch(B){if(ge(B))return{data:{user:null,session:null},error:B};throw B}}async _exchangeCodeForSession(t){const n=await cu(this.storage,`${this.storageKey}-code-verifier`),[a,r]=(n??"").split("/");try{const{data:o,error:f}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:Gr});if(await io(this.storage,`${this.storageKey}-code-verifier`),f)throw f;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Wc}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:r??null}),error:f})}catch(o){if(ge(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(t){try{const{options:n,provider:a,token:r,access_token:o,nonce:f}=t,h=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:r,access_token:o,nonce:f,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Gr}),{data:g,error:m}=h;return m?{data:{user:null,session:null},error:m}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Wc}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:m})}catch(n){if(ge(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,a,r,o,f;try{if("email"in t){const{email:h,options:g}=t;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await $c(this.storage,this.storageKey));const{error:C}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(a=g==null?void 0:g.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:h,options:g}=t,{data:m,error:_}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},create_user:(o=g==null?void 0:g.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(f=g==null?void 0:g.channel)!==null&&f!==void 0?f:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_}}throw new og("You must provide either an email or phone number.")}catch(h){if(ge(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(t){var n,a;try{let r,o;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,o=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:f,error:h}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:r,xform:Gr});if(h)throw h;if(!f)throw new Error("An error occurred on token verification.");const g=f.session,m=f.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,a,r;try{let o=null,f=null;return this.flowType==="pkce"&&([o,f]=await $c(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&a!==void 0?a:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:f}),headers:this.headers,xform:oC})}catch(o){if(ge(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;if(a)throw a;if(!n)throw new oo;const{error:r}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:a,type:r,options:o}=t,{error:f}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{email:a,type:r,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:f}}else if("phone"in t){const{phone:a,type:r,options:o}=t,{data:f,error:h}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{phone:a,type:r,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:h}}throw new og("You must provide either an email or phone number and a type")}catch(n){if(ge(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await a,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=n();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await cu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<Yp:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const f=await cu(this.userStorage,this.storageKey+"-user");f!=null&&f.user?t.user=f.user:t.user=Xp()}if(this.storage.isServer&&t.user){let f=this.suppressGetSessionWarning;t=new Proxy(t,{get:(g,m,_)=>(!f&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),f=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,m,_))})}return{data:{session:t},error:null}}const{data:r,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:co}):await this._useSession(async n=>{var a,r,o;const{data:f,error:h}=n;if(h)throw h;return!(!((a=f.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new oo}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(r=f.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0,xform:co})})}catch(n){if(ge(n))return LE(n)&&(await this._removeSession(),await io(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async a=>{const{data:r,error:o}=a;if(o)throw o;if(!r.session)throw new oo;const f=r.session;let h=null,g=null;this.flowType==="pkce"&&t.email!=null&&([h,g]=await $c(this.storage,this.storageKey));const{data:m,error:_}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:h,code_challenge_method:g}),jwt:f.access_token,xform:co});if(_)throw _;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(a){if(ge(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new oo;const n=Date.now()/1e3;let a=n,r=!0,o=null;const{payload:f}=Qp(t.access_token);if(f.exp&&(a=f.exp,r=a<=n),r){const{data:h,error:g}=await this._callRefreshToken(t.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!h)return{data:{user:null,session:null},error:null};o=h}else{const{data:h,error:g}=await this._getUser(t.access_token);if(g)throw g;o={access_token:t.access_token,refresh_token:t.refresh_token,user:h.user,token_type:"bearer",expires_in:a-n,expires_at:a},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(ge(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var a;if(!t){const{data:f,error:h}=n;if(h)throw h;t=(a=f.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new oo;const{data:r,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ge(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Li())throw new ug("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ug(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new A1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ug("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new A1("No code detected.");const{data:N,error:M}=await this._exchangeCodeForSession(t.code);if(M)throw M;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:r,access_token:o,refresh_token:f,expires_in:h,expires_at:g,token_type:m}=t;if(!o||!h||!f||!m)throw new ug("No session defined in URL");const _=Math.round(Date.now()/1e3),C=parseInt(h);let E=_+C;g&&(E=parseInt(g));const R=E-_;R*1e3<=lf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${C}s`);const v=E-C;_-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,E,_):_-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,E,_);const{data:D,error:B}=await this._getUser(o);if(B)throw B;const L={provider_token:a,provider_refresh_token:r,access_token:o,expires_in:C,expires_at:E,refresh_token:f,token_type:m,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:L,redirectType:t.type},error:null}}catch(a){if(ge(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await cu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var a;const{data:r,error:o}=n;if(o)return{error:o};const f=(a=r.session)===null||a===void 0?void 0:a.access_token;if(f){const{error:h}=await this.admin.signOut(f,t);if(h&&!(zE(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return t!=="others"&&(await this._removeSession(),await io(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=YE(),a={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async n=>{var a,r;try{const{data:{session:o},error:f}=n;if(f)throw f;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,n={}){let a=null,r=null;this.flowType==="pkce"&&([a,r]=await $c(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(ge(o))return{data:null,error:o};throw o}}async getUserIdentities(){var t;try{const{data:n,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:a,error:r}=await this._useSession(async o=>{var f,h,g,m,_;const{data:C,error:E}=o;if(E)throw E;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(f=t.options)===null||f===void 0?void 0:f.redirectTo,scopes:(h=t.options)===null||h===void 0?void 0:h.scopes,queryParams:(g=t.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",R,{headers:this.headers,jwt:(_=(m=C.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(r)throw r;return Li()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(ge(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var a;try{const{error:r,data:{session:o}}=n;if(r)throw r;const{options:f,provider:h,token:g,access_token:m,nonce:_}=t,C=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=o==null?void 0:o.access_token)!==null&&a!==void 0?a:void 0,body:{provider:h,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Gr}),{data:E,error:R}=C;return R?{data:{user:null,session:null},error:R}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new Wc}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:R})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var a,r;const{data:o,error:f}=n;if(f)throw f;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const a=Date.now();return await FE(async r=>(r>0&&await XE(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Gr})),(r,o)=>{const f=200*Math.pow(2,r);return o&&Kp(o)&&Date.now()+f-a<lf})}catch(a){if(this._debug(n,"error",a),ge(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",a),Li()&&!n.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,n;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const r=await cu(this.storage,this.storageKey);if(r&&this.userStorage){let f=await cu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:r.user},await of(this.userStorage,this.storageKey+"-user",f)),r.user=(t=f==null?void 0:f.user)!==null&&t!==void 0?t:Xp()}else if(r&&!r.user&&!r.user){const f=await cu(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(r.user=f.user,await io(this.storage,this.storageKey+"-user"),await of(this.storage,this.storageKey,r)):r.user=Xp()}if(this._debug(a,"session from storage",r),!this._isValidSession(r)){this._debug(a,"session is not valid"),r!==null&&await this._removeSession();return}const o=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Yp;if(this._debug(a,`session has${o?"":" not"} expired with margin of ${Yp}s`),o){if(this.autoRefreshToken&&r.refresh_token){const{error:f}=await this._callRefreshToken(r.refresh_token);f&&(console.error(f),Kp(f)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:h}=await this._getUser(r.access_token);!h&&(f!=null&&f.user)?(r.user=f.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(a,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(a,"error",r),console.error(r);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var n,a;if(!t)throw new oo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new jg;const{data:o,error:f}=await this._refreshAccessToken(t);if(f)throw f;if(!o.session)throw new oo;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const h={data:o.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(o){if(this._debug(r,"error",o),ge(o)){const f={data:null,error:o};return Kp(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(f),f}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(o),o}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,a=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:n});const o=[],f=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(t,n)}catch(g){o.push(g)}});if(await Promise.all(f),o.length>0){for(let h=0;h<o.length;h+=1)console.error(o[h]);throw o[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),a=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&n.user&&await of(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const o=M1(r);await of(this.storage,this.storageKey,o)}else{const r=M1(n);await of(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await io(this.storage,this.storageKey),await io(this.storage,this.storageKey+"-code-verifier"),await io(this.storage,this.storageKey+"-user"),this.userStorage&&await io(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Li()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),lf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:a}}=n;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((a.expires_at*1e3-t)/lf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${lf}ms, refresh threshold is ${Vm} ticks`),r<=Vm&&await this._callRefreshToken(a.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof ob)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Li()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,a){const r=[`provider=${encodeURIComponent(n)}`];if(a!=null&&a.redirectTo&&r.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&r.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[o,f]=await $c(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(f)}`});r.push(h.toString())}if(a!=null&&a.queryParams){const o=new URLSearchParams(a.queryParams);r.push(o.toString())}return a!=null&&a.skipBrowserRedirect&&r.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var a;const{data:r,error:o}=n;return o?{data:null,error:o}:await Me(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token})})}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var a,r;const{data:o,error:f}=n;if(f)return{data:null,error:f};const h=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:g,error:m}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(a=o==null?void 0:o.session)===null||a===void 0?void 0:a.access_token});return m?{data:null,error:m}:(t.factorType==="totp"&&g.type==="totp"&&(!((r=g==null?void 0:g.totp)===null||r===void 0)&&r.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var a;const{data:r,error:o}=n;if(o)return{data:null,error:o};const f=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?TC(t.webauthn.credential_response):AC(t.webauthn.credential_response)})}:{code:t.code}),{data:h,error:g}=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:f,headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:g})})}catch(n){if(ge(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var a;const{data:r,error:o}=n;if(o)return{data:null,error:o};const f=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token});if(f.error)return f;const{data:h}=f;if(h.type!=="webauthn")return{data:h,error:null};switch(h.webauthn.type){case"create":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:EC(h.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:CC(h.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(ge(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:a}=await this.getUser();if(a)return{data:null,error:a};const r={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])r.all.push(o),o.status==="verified"&&r[o.factor_type].push(o);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,a;const{data:{session:r},error:o}=t;if(o)return{data:null,error:o};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=Qp(r.access_token);let h=null;f.aal&&(h=f.aal);let g=h;((a=(n=r.user.factors)===null||n===void 0?void 0:n.filter(C=>C.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(g="aal2");const _=f.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:_},error:null}}))}async fetchJwk(t,n={keys:[]}){let a=n.keys.find(h=>h.kid===t);if(a)return a;const r=Date.now();if(a=this.jwks.keys.find(h=>h.kid===t),a&&this.jwks_cached_at+UE>r)return a;const{data:o,error:f}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=r,a=o.keys.find(h=>h.kid===t),!a)?null:a}async getClaims(t,n={}){try{let a=t;if(!a){const{data:R,error:v}=await this.getSession();if(v||!R.session)return{data:null,error:v};a=R.session.access_token}const{header:r,payload:o,signature:f,raw:{header:h,payload:g}}=Qp(a);n!=null&&n.allowExpired||nC(o.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!m){const{error:R}=await this.getUser(a);if(R)throw R;return{data:{claims:o,header:r,signature:f},error:null}}const _=aC(r.alg),C=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,C,f,qE(`${h}.${g}`)))throw new Qm("Invalid JWT signature");return{data:{claims:o,header:r,signature:f},error:null}}catch(a){if(ge(a))return{data:null,error:a};throw a}}}md.nextInstanceID=0;const UC=md;class BC extends UC{constructor(t){super(t)}}class zC{constructor(t,n,a){var r,o,f;this.supabaseUrl=t,this.supabaseKey=n;const h=xE(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const g=`sb-${h.hostname.split(".")[0]}-auth-token`,m={db:_E,realtime:CE,auth:Object.assign(Object.assign({},EE),{storageKey:g}),global:bE},_=OE(a??{},m);this.storageKey=(r=_.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=_.global.headers)!==null&&o!==void 0?o:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(C,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=_.auth)!==null&&f!==void 0?f:{},this.headers,_.global.fetch),this.fetch=wE(n,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new M_(new URL("rest/v1",h).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new vE(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new b_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,a)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(n=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:a,storage:r,userStorage:o,storageKey:f,flowType:h,lock:g,debug:m},_,C){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new BC({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),_),storageKey:f,autoRefreshToken:t,persistSession:n,detectSessionInUrl:a,storage:r,userStorage:o,flowType:h,lock:g,debug:m,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(R=>R.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Q_(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,a)=>{this._handleTokenChanged(n,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,n,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const LC=(l,t,n)=>new zC(l,t,n);function GC(){if(typeof window<"u"||typeof process>"u")return!1;const l=process.version;if(l==null)return!1;const t=l.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}GC()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const PC="https://pmlwhqhezvczissdvuyc.supabase.co",HC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtbHdocWhlenZjemlzc2R2dXljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0MTA4MDUsImV4cCI6MjA3Njk4NjgwNX0.3W7AiFmapKzKJENDQ0H_Chz-V_AAw7a20fGOYlcCMb8",gu=LC(PC,HC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),kC=l=>l.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,a)=>a?a.toUpperCase():n.toLowerCase()),L1=l=>{const t=kC(l);return t.charAt(0).toUpperCase()+t.slice(1)},fb=(...l)=>l.filter((t,n,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===n).join(" ").trim(),qC=l=>{for(const t in l)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var VC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=st.forwardRef(({color:l="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:o,iconNode:f,...h},g)=>st.createElement("svg",{ref:g,...VC,width:t,height:t,stroke:l,strokeWidth:a?Number(n)*24/Number(t):n,className:fb("lucide",r),...!o&&!qC(h)&&{"aria-hidden":"true"},...h},[...f.map(([m,_])=>st.createElement(m,_)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=(l,t)=>{const n=st.forwardRef(({className:a,...r},o)=>st.createElement(YC,{ref:o,iconNode:t,className:fb(`lucide-${IC(L1(l))}`,`lucide-${l}`,a),...r}));return n.displayName=L1(l),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],hb=Ef("eraser",KC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]],XC=Ef("feather",QC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],db=Ef("pen",FC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],gb=Ef("redo",JC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],pb=Ef("trash-2",ZC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],mb=Ef("undo",WC),G1="Feather_studentId",P1=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,l=>{const t=Math.random()*16|0;return(l==="x"?t:t&3|8).toString(16)}),$C=()=>{try{let l=sessionStorage.getItem(G1);return l?(console.log("📱 Using existing studentId:",l),l):(l=`student-${P1()}`,sessionStorage.setItem(G1,l),console.log("🆕 Created new studentId:",l),l)}catch{return console.warn("⚠️ sessionStorage unavailable, using memory-only studentId"),`student-temp-${P1()}`}},fu={width:800,height:600},tT=.65,eT=2.2,cg="studentCanvasPrefs",H1=2,I1=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,nT=({sharedImage:l,canvasWidth:t,canvasHeight:n})=>{const[a,r]=st.useState(null);if(st.useEffect(()=>{if(!l){r(null);return}const R=new window.Image;R.src=l.dataUrl,R.onload=()=>{r(R)}},[l]),!l||!a)return null;const o=a.naturalWidth||a.width,f=a.naturalHeight||a.height;if(!o||!f||!t||!n)return null;const h=o/f,g=t/n;let m,_,C,E;return h>g?(m=t,_=t/h,C=0,E=(n-_)/2):(_=n,m=n*h,C=(t-m)/2,E=0),m=Math.min(m,t),_=Math.min(_,n),k.jsx(av,{image:a,x:C,y:E,width:m,height:_,listening:!1})};function aT(){const[l]=vd(),t=yf(),n=l.get("room"),a=l.get("name"),[r,o]=st.useState(null),f=st.useRef({roomId:null,studentName:null,clientId:null}),[h,g]=st.useState(null),[m,_]=st.useState(null),[C,E]=st.useState(!1),R=st.useRef(null),[v,D]=st.useState(null),[B,L]=st.useState("loading"),[N,M]=st.useState([]),[G,O]=st.useState([]),[w,T]=st.useState(null),[y,z]=st.useState("pen"),[U,P]=st.useState("black"),[K,Q]=st.useState(3),[X,Y]=st.useState(!1),[j,I]=st.useState("stylus-only"),[F,W]=st.useState("left"),[nt,Z]=st.useState(I1()),it=st.useRef(!1);st.useEffect(()=>{(!n||!a)&&t(`/student-login${n?`?room=${n}`:""}`)},[n,a,t]),st.useEffect(()=>{if(!n||!a)return;const vt=f.current;if(vt.clientId&&vt.roomId===n&&vt.studentName===a){g(vt.clientId);return}const gt=Math.random().toString(36).substring(2,8),Jt=Math.random().toString(36).substring(2,8),se=Date.now().toString(36).slice(-4),Ce=`student-${`${gt}${Jt}${se}`}`;f.current={roomId:n,studentName:a,clientId:Ce},g(Ce)},[a,n]),st.useEffect(()=>{const vt=$C();_(vt)},[]),st.useEffect(()=>{if(!(!n||!a)&&!(typeof window>"u"))try{const vt=localStorage.getItem(cg);if(vt){const gt=JSON.parse(vt);if(gt.version!==H1){localStorage.removeItem(cg);return}gt.tool&&z(gt.tool),gt.color&&P(gt.color),typeof gt.brushSize=="number"&&Q(gt.brushSize),gt.inputMode&&I(gt.inputMode),gt.toolbarPosition&&W(gt.toolbarPosition)}}catch{localStorage.removeItem(cg)}},[n,a]),st.useEffect(()=>{const vt=()=>{Z(I1())};return window.addEventListener("resize",vt),()=>window.removeEventListener("resize",vt)},[]),st.useEffect(()=>{nt&&(I("all"),Q(3))},[nt]),st.useEffect(()=>{if(!n||!a||typeof window>"u")return;if(J.current){J.current=!1;return}const vt={version:H1,tool:y,color:U,brushSize:K,inputMode:j,toolbarPosition:F};localStorage.setItem(cg,JSON.stringify(vt))},[y,U,K,j,F,n,a]);const rt=st.useRef([]),V=st.useRef([]),J=st.useRef(!0),$=st.useRef(!1),at=st.useRef(!1),ht=st.useRef(N);st.useEffect(()=>{ht.current=N},[N]);const Rt=st.useRef(G);st.useEffect(()=>{Rt.current=G},[G]);const zt=st.useRef(null),Wt=st.useRef(null),[It,pe]=st.useState(fu),Bt=st.useMemo(()=>fu.width?It.width/fu.width:1,[It.width]),Te=st.useRef(It),ze=st.useRef(Bt);st.useEffect(()=>{Te.current=It,ze.current=Bt},[It,Bt]);const Xe=st.useRef(null),ke=st.useRef(null);st.useEffect(()=>{if(!$.current&&r){const vt=setTimeout(()=>{r.publish("student-layer",{lines:N,studentId:m,clientId:h,meta:{display:It,scale:Bt}}),console.log("📤 Published student layer:",N.length,"lines (studentId:",m,")")},150);return()=>clearTimeout(vt)}},[N,r,h,m,It,Bt]),st.useEffect(()=>()=>{ke.current&&cancelAnimationFrame(ke.current)},[]),st.useEffect(()=>{const vt=zt.current;if(!vt)return;const gt=Kt=>{const Ce=Kt.target;Ce.closest("button")||Ce.closest(".student-toolbar")||Ce.closest(".student-topbar")||Kt.preventDefault()},Jt=Kt=>{Kt.preventDefault()},se=Kt=>{if(X)return Kt.preventDefault(),!1};return vt.addEventListener("touchstart",gt,{passive:!1}),vt.addEventListener("touchmove",gt,{passive:!1}),vt.addEventListener("gesturestart",Jt,{passive:!1}),vt.addEventListener("gesturechange",Jt,{passive:!1}),document.addEventListener("selectstart",se),()=>{vt&&(vt.removeEventListener("touchstart",gt),vt.removeEventListener("touchmove",gt),vt.removeEventListener("gesturestart",Jt),vt.removeEventListener("gesturechange",Jt)),document.removeEventListener("selectstart",se)}},[X]),st.useEffect(()=>{if(!n||!a||!h||R.current===n)return;R.current=n;let vt=!1;return(async()=>{try{const{data:Jt,error:se}=await gu.from("sessions").select("*").ilike("room_code",n).order("created_at",{ascending:!1}).limit(1);if(se){console.error("Session query error:",se),L("no-session");return}if(!Jt||Jt.length===0){console.log("No session found for room code:",n),L("no-session");return}const Kt=Jt[0];if(vt)return;if(Kt.status==="ended"){console.log("Session found but already ended"),L("ended"),setTimeout(()=>t("/student-login"),3e3);return}D(Kt.id),L(Kt.status==="active"?"active":"waiting")}catch(Jt){console.error("Error validating session:",Jt),L("no-session"),R.current=null}})(),()=>{vt=!0}},[n,h,a,t]),st.useEffect(()=>{if(!n||!a||!h||!m)return;let vt=null,gt=null,Jt=!0,se=!1;const Kt=[];return(async()=>{try{vt=new yS.Realtime({authUrl:"/api/token",authParams:{clientId:h}}),vt.connection.on("connected",async()=>{if(Jt)if(E(!0),console.log("✅ Student connected to Ably"),se&&gt){console.log("🔄 Reconnected - re-entering presence and syncing state");try{await gt.presence.enter({name:a,studentId:m,isVisible:!document.hidden}),console.log("✅ Re-entered presence as:",a,"with studentId:",m),setTimeout(()=>{Jt&&(console.log("🔄 Requesting full state (question + annotations)"),gt.publish("request-current-state",{clientId:h,studentId:m,timestamp:Date.now()}))},300)}catch(_e){console.error("❌ Error during reconnection:",_e)}}else se=!0}),vt.connection.on("disconnected",()=>{Jt&&E(!1)}),gt=vt.channels.get(`room-${n}`);const fe=(_e,Pe)=>{gt.subscribe(_e,Pe),Kt.push({event:_e,handler:Pe})};if(fe("student-layer",()=>{}),fe("teacher-annotation",_e=>{if(Jt&&(console.log("📨 Received teacher-annotation event. Target:",_e.data.targetStudentId,"My clientId:",h,"Match:",_e.data.targetStudentId===h),_e.data.targetStudentId===h)){const Pe=_e.data.annotations||[];console.log("✅ ClientId matches! Applying",Pe.length,"teacher annotation strokes"),$.current=!0,O(Pe),setTimeout(()=>{$.current=!1},100)}}),fe("sync-full-state",_e=>{if(Jt&&_e.data.targetClientId===h){const{content:Pe=null,annotations:En=[]}=_e.data;console.log("📨 Received sync-full-state:",{hasContent:!!Pe,annotationCount:En.length}),T(Pe||null),En.length>0&&(console.log("✅ Applying",En.length,"teacher annotations from sync"),$.current=!0,O(En),setTimeout(()=>{$.current=!1},100))}}),fe("clear-all-drawings",_e=>{var Pe;Jt&&(console.log("📨 Received clear-all-drawings with content:",_e.data),(Pe=_e.data)!=null&&Pe.content?T(_e.data.content):T(null),$.current=!0,M([]),O([]),setTimeout(()=>{$.current=!1},100))}),fe("session-started",()=>{Jt&&L("active")}),fe("session-ended",()=>{Jt&&(console.log("🔚 Session ended"),L("ended"),t("/student-login"))}),await gt.presence.enter({name:a,studentId:m,isVisible:!document.hidden}),!Jt){await gt.presence.leaveClient(h),vt.close();return}o(gt),setTimeout(()=>{Jt&&gt.publish("request-current-state",{clientId:h,studentId:m,timestamp:Date.now()})},500)}catch(fe){console.error("Failed to initialize Ably:",fe)}})(),()=>{if(Jt=!1,gt){Kt.forEach(({event:fe,handler:_e})=>{gt.unsubscribe(fe,_e)});try{gt.presence.leaveClient(h)}catch(fe){console.error("Error leaving presence:",fe)}}if(o(null),vt)try{vt.close()}catch(fe){console.error("Error closing Ably:",fe)}}},[h,n,a,t,m]),st.useEffect(()=>{if(!r||it.current)return;it.current=!0;const vt=()=>{const gt=!document.hidden;r.presence.update({name:a,studentId:m,isVisible:gt,lastVisibilityChange:Date.now()}),r.publish("student-visibility",{studentId:m,studentName:a,isVisible:gt,timestamp:Date.now()})};return document.addEventListener("visibilitychange",vt),()=>{it.current=!1,document.removeEventListener("visibilitychange",vt)}},[r,h,a]),st.useEffect(()=>{const vt=zt.current;if(!vt)return;const gt=()=>{if(!zt.current)return;const se=zt.current.getBoundingClientRect(),Kt=nt?16:48,Ce=Math.max(280,se.width-Kt),fe=Math.max(210,se.height-Kt),_e=Ce/fu.width,Pe=fe/fu.height,En=Math.min(_e,Pe),pi=Math.max(nt?.35:tT,Math.min(eT,En)),Na=Math.round(pi*20)/20;pe({width:Math.round(fu.width*Na),height:Math.round(fu.height*Na)})};gt(),window.addEventListener("resize",gt);let Jt;return window.ResizeObserver&&(Jt=new ResizeObserver(()=>gt()),Jt.observe(vt)),()=>{window.removeEventListener("resize",gt),Jt&&Jt.disconnect()}},[F,nt]);const hn=vt=>j!=="stylus-only"?!0:(vt==null?void 0:vt.pointerType)==="pen",Un=vt=>{const gt=vt.evt;if(!hn(gt)){gt!=null&&gt.preventDefault&&gt.preventDefault();return}const Jt=vt.target.getStage();if(Jt&&gt.pointerId!==void 0){const se=Jt.content;if(se&&se.setPointerCapture)try{se.setPointerCapture(gt.pointerId)}catch{}}if(y==="pen"){Y(!0);const se=Jt.getPointerPosition(),Kt=se.x/Bt,Ce=se.y/Bt,fe={tool:y,points:[Kt,Ce],color:U,strokeWidth:K/Bt};Xe.current=fe,rt.current.push([...N]),V.current=[],M([...N,fe])}else y==="eraser"&&(Y(!0),at.current=!1);gt.preventDefault&&gt.preventDefault(),gt.stopPropagation&&gt.stopPropagation()},wt=vt=>{if(!X)return;const gt=vt.evt;if(!hn(gt)){gt!=null&&gt.preventDefault&&gt.preventDefault();return}const se=vt.target.getStage().getPointerPosition();if(y==="pen"){if(Xe.current){const Kt=se.x/Bt,Ce=se.y/Bt;Xe.current.points=Xe.current.points.concat([Kt,Ce]);const fe=Xe.current;ke.current&&cancelAnimationFrame(ke.current),ke.current=requestAnimationFrame(()=>{fe&&M(_e=>_e.length>0?[..._e.slice(0,-1),fe]:_e)})}}else if(y==="eraser"){const Kt=N.length,Ce=se.x,fe=se.y,_e=20,Pe=N.filter(En=>{for(let Aa=0;Aa<En.points.length;Aa+=2){const pi=En.points[Aa]*Bt,Na=En.points[Aa+1]*Bt;if(Math.sqrt(Math.pow(pi-Ce,2)+Math.pow(Na-fe,2))<_e)return!1}return!0});Pe.length<Kt&&!at.current&&(rt.current.push([...N]),V.current=[],at.current=!0),M(Pe)}gt!=null&&gt.preventDefault&&gt.preventDefault(),gt!=null&&gt.stopPropagation&&gt.stopPropagation()},Yt=vt=>{const gt=vt==null?void 0:vt.evt;if(!hn(gt)){gt!=null&&gt.preventDefault&&gt.preventDefault();return}Y(!1),Xe.current=null},Fe=()=>{if(rt.current.length>0){const vt=rt.current.pop();V.current.push([...N]),M(vt)}},Se=()=>{if(V.current.length>0){const vt=V.current.pop();rt.current.push([...N]),M(vt)}},we=()=>{rt.current.push([...N]),V.current=[],M([])},$e=()=>{var vt;return h?((vt=h.split("-")[1])==null?void 0:vt.substring(0,3))||h:"---"},Ae=()=>{I(vt=>vt==="stylus-only"?"all":"stylus-only")},ct=()=>{W(vt=>vt==="left"?"right":"left")},At=()=>`Connected as ${a&&a!=="Anonymous"?a:$e()}`,xt=C?"Connected":"Reconnecting…",kt=C?"online":"offline",le=vt=>vt.map((gt,Jt)=>gt*Bt),Lt=vt=>(vt.strokeWidth||3)*Bt;return!n||!a?null:k.jsxs("div",{className:"student-canvas-page",children:[B==="loading"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-spinner"}),k.jsx("h2",{children:"Connecting to session..."}),k.jsx("p",{children:"Please wait while we verify your session"})]})}),B==="waiting"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:"⏳"}),k.jsx("h2",{children:"Waiting for teacher"}),k.jsx("p",{children:"Your teacher hasn't started the session yet. Please wait..."})]})}),B==="no-session"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:"🔍"}),k.jsx("h2",{children:"No session found"}),k.jsxs("p",{children:['There is no active session for room code "',n,'".']}),k.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem"},children:"Please make sure your teacher has started a session, or verify the room code is correct."}),k.jsx("button",{onClick:()=>t("/student-login"),style:{marginTop:"1.5rem",padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"transform 0.2s"},onMouseEnter:vt=>vt.target.style.transform="scale(1.05)",onMouseLeave:vt=>vt.target.style.transform="scale(1)",children:"Back to Login"})]})}),B==="ended"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon ended",children:"✓"}),k.jsx("h2",{children:"Session ended"}),k.jsx("p",{children:"Thank you for participating! The teacher has ended this session."}),k.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",opacity:.8},children:"Redirecting to login..."})]})}),k.jsxs("div",{className:"student-canvas-container",children:[k.jsxs("div",{className:"student-status-bar",children:[k.jsxs("div",{className:"student-status-text",children:[k.jsxs("h1",{children:["Student Canvas",n&&k.jsxs("span",{style:{marginLeft:"0.75rem",fontSize:"0.75rem",fontWeight:"400",color:"rgba(0, 0, 0, 0.4)",letterSpacing:"0.5px"},children:["Session: ",n]})]}),k.jsx("p",{children:At()})]}),k.jsxs("div",{className:"student-status-actions",children:[!nt&&k.jsxs(k.Fragment,{children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:y==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",j==="all"?"All inputs":"Stylus only"]})}),k.jsxs("div",{className:`connection-pill ${kt}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:xt})]}),k.jsxs("button",{className:"move-toolbar-btn",onClick:ct,children:["Move toolbar to ",F==="left"?"right":"left"]})]}),nt&&k.jsxs("div",{className:`connection-pill ${kt}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:xt})]})]})]}),k.jsxs("div",{className:`student-workspace ${F==="right"?"toolbar-right":""} ${nt?"mobile-view":""}`,children:[nt?k.jsxs("div",{className:"mobile-toolbar",children:[k.jsxs("div",{className:"mobile-colors",children:[k.jsx("button",{onClick:()=>P("black"),className:`mobile-color-button ${U==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>P("#0066FF"),className:`mobile-color-button ${U==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>P("#00AA00"),className:`mobile-color-button ${U==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>z("pen"),className:`mobile-tool-button ${y==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(db,{size:20})}),k.jsx("button",{onClick:()=>z("eraser"),className:`mobile-tool-button ${y==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(hb,{size:20})}),k.jsx("button",{onClick:Fe,className:"mobile-tool-button",disabled:rt.current.length===0,"aria-label":"Undo",children:k.jsx(mb,{size:20})}),k.jsx("button",{onClick:Se,className:"mobile-tool-button",disabled:V.current.length===0,"aria-label":"Redo",children:k.jsx(gb,{size:20})}),k.jsx("button",{onClick:we,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(pb,{size:20})})]})]}):k.jsxs("div",{className:"student-sidebar",children:[k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsxs("div",{className:"color-buttons",children:[k.jsx("button",{onClick:()=>P("black"),className:`color-button ${U==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>P("#0066FF"),className:`color-button ${U==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>P("#00AA00"),className:`color-button ${U==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>z("pen"),className:`tool-icon-button ${y==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>z("eraser"),className:`tool-icon-button ${y==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsx("div",{className:"brush-size-control",children:k.jsxs("div",{className:"brush-slider-container",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:K,onChange:vt=>Q(parseInt(vt.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:K})]})})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${j==="all"?"all-inputs":""}`,onClick:Ae,children:j==="stylus-only"?"Stylus mode (pen only)":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:Fe,className:"history-button",disabled:rt.current.length===0,children:"Undo"}),k.jsx("button",{onClick:Se,className:"history-button",disabled:V.current.length===0,children:"Redo"}),k.jsx("button",{onClick:we,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"student-canvas-panel",ref:zt,children:k.jsx("div",{className:"student-canvas-frame",children:k.jsx("div",{className:"student-canvas-surface",style:{width:`${It.width}px`,height:`${It.height}px`},children:k.jsxs(Ng,{ref:Wt,width:It.width,height:It.height,onPointerDown:Un,onPointerMove:wt,onPointerUp:Yt,onPointerLeave:Yt,onTouchStart:vt=>{var gt,Jt;(Jt=(gt=vt.evt)==null?void 0:gt.preventDefault)==null||Jt.call(gt)},onTouchMove:vt=>{var gt,Jt;(Jt=(gt=vt.evt)==null?void 0:gt.preventDefault)==null||Jt.call(gt)},onTouchEnd:vt=>{var gt,Jt;(Jt=(gt=vt.evt)==null?void 0:gt.preventDefault)==null||Jt.call(gt)},className:"canvas-stage",style:{touchAction:"none"},perfectDrawEnabled:!1,children:[k.jsx(Ir,{listening:!1,children:k.jsx(nT,{sharedImage:w,canvasWidth:It.width,canvasHeight:It.height})}),k.jsx(Ir,{children:N.map((vt,gt)=>k.jsx(ho,{points:le(vt.points),stroke:vt.color,strokeWidth:Lt(vt),tension:.5,lineCap:"round",lineJoin:"round"},`student-${gt}`))}),k.jsx(Ir,{listening:!1,children:G.map((vt,gt)=>k.jsx(ho,{points:le(vt.points),stroke:vt.color,strokeWidth:Lt(vt),tension:.5,lineCap:"round",lineJoin:"round"},`teacher-${gt}`))})]})})})})]})]})]})}const k1="Feather_username";function iT(){const[l]=vd(),t=yf(),[n,a]=st.useState(""),[r,o]=st.useState(""),[f,h]=st.useState(""),[g,m]=st.useState(!1);st.useEffect(()=>{const C=localStorage.getItem(k1);C&&a(C);const E=l.get("room");E&&o(E.toUpperCase())},[l]);const _=async C=>{if(C.preventDefault(),!n.trim()){h("Please enter your name");return}if(!r.trim()){h("Please enter a session code");return}m(!0),h(""),localStorage.setItem(k1,n.trim());try{const E=(await Au(async()=>{const{default:L}=await Promise.resolve().then(()=>lT);return{default:L}},void 0)).default,R=new E.Realtime({authUrl:"/api/token",authParams:{clientId:`ping-${Date.now()}`}});await new Promise((L,N)=>{const M=setTimeout(()=>N(new Error("Connection timeout")),8e3);R.connection.once("connected",()=>{clearTimeout(M),L()}),R.connection.once("failed",()=>{clearTimeout(M),N(new Error("Connection failed"))})});const B=(await R.channels.get(`room-${r.trim().toUpperCase()}`).presence.get()).some(L=>L.clientId.startsWith("teacher-"));if(R.close(),!B){h("No active teacher found. Please check your session code."),m(!1);return}t(`/student?room=${r.trim().toUpperCase()}&name=${encodeURIComponent(n.trim())}`)}catch(E){console.error("Failed to connect:",E),h("Failed to connect to session. Please try again."),m(!1)}};return k.jsx("div",{className:"student-login-page",children:k.jsxs("div",{className:"student-login-card",children:[k.jsx("h1",{children:"Student Login"}),k.jsx("p",{className:"login-subtitle",children:"Join your classroom session to start drawing."}),k.jsxs("form",{onSubmit:_,children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"name",children:"Name"}),k.jsx("input",{id:"name",type:"text",placeholder:"Your name",value:n,onChange:C=>{a(C.target.value),h("")},autoFocus:!0,maxLength:50})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"sessionCode",children:"Session code"}),k.jsx("input",{id:"sessionCode",type:"text",placeholder:"SESSION CODE (E.G., ABC123)",value:r,onChange:C=>{o(C.target.value.toUpperCase()),h("")},maxLength:10})]}),f&&k.jsx("div",{className:"login-error",children:f}),k.jsx("button",{type:"submit",className:"join-button",disabled:g,children:g?"Checking session...":"Join Session"})]})]})})}var Jp,q1;function rT(){if(q1)return Jp;q1=1;function l(o){return typeof o=="string"&&(o=o.indexOf(":")==-1?{token:o}:{key:o}),o.promises=!0,o}var t=vS(),n=function(o,f,h,g){return new t.ErrorInfo(o,f,h,g)},a=function(o){return new t.Rest(l(o))};Object.assign(a,t.Rest);var r=function(o){return new t.Realtime(l(o))};return Object.assign(r,t.Realtime),Jp={ErrorInfo:n,Rest:a,Realtime:r},Jp}var sT=rT();const dv=pf(sT),lT=Object.freeze(Object.defineProperty({__proto__:null,default:dv},Symbol.toStringTag,{value:"Module"}));var af={},Zp,V1;function oT(){return V1||(V1=1,Zp=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Zp}var Wp={},ro={},Y1;function Ru(){if(Y1)return ro;Y1=1;let l;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ro.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17},ro.getSymbolTotalCodewords=function(a){return t[a]},ro.getBCHDigit=function(n){let a=0;for(;n!==0;)a++,n>>>=1;return a},ro.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');l=a},ro.isKanjiModeEnabled=function(){return typeof l<"u"},ro.toSJIS=function(a){return l(a)},ro}var $p={},K1;function gv(){return K1||(K1=1,(function(l){l.L={bit:1},l.M={bit:0},l.Q={bit:3},l.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return l.L;case"m":case"medium":return l.M;case"q":case"quartile":return l.Q;case"h":case"high":return l.H;default:throw new Error("Unknown EC Level: "+n)}}l.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},l.from=function(a,r){if(l.isValid(a))return a;try{return t(a)}catch{return r}}})($p)),$p}var tm,Q1;function uT(){if(Q1)return tm;Q1=1;function l(){this.buffer=[],this.length=0}return l.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let a=0;a<n;a++)this.putBit((t>>>n-a-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},tm=l,tm}var em,X1;function cT(){if(X1)return em;X1=1;function l(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return l.prototype.set=function(t,n,a,r){const o=t*this.size+n;this.data[o]=a,r&&(this.reservedBit[o]=!0)},l.prototype.get=function(t,n){return this.data[t*this.size+n]},l.prototype.xor=function(t,n,a){this.data[t*this.size+n]^=a},l.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},em=l,em}var nm={},F1;function fT(){return F1||(F1=1,(function(l){const t=Ru().getSymbolSize;l.getRowColCoords=function(a){if(a===1)return[];const r=Math.floor(a/7)+2,o=t(a),f=o===145?26:Math.ceil((o-13)/(2*r-2))*2,h=[o-7];for(let g=1;g<r-1;g++)h[g]=h[g-1]-f;return h.push(6),h.reverse()},l.getPositions=function(a){const r=[],o=l.getRowColCoords(a),f=o.length;for(let h=0;h<f;h++)for(let g=0;g<f;g++)h===0&&g===0||h===0&&g===f-1||h===f-1&&g===0||r.push([o[h],o[g]]);return r}})(nm)),nm}var am={},J1;function hT(){if(J1)return am;J1=1;const l=Ru().getSymbolSize,t=7;return am.getPositions=function(a){const r=l(a);return[[0,0],[r-t,0],[0,r-t]]},am}var im={},Z1;function dT(){return Z1||(Z1=1,(function(l){l.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};l.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},l.from=function(r){return l.isValid(r)?parseInt(r,10):void 0},l.getPenaltyN1=function(r){const o=r.size;let f=0,h=0,g=0,m=null,_=null;for(let C=0;C<o;C++){h=g=0,m=_=null;for(let E=0;E<o;E++){let R=r.get(C,E);R===m?h++:(h>=5&&(f+=t.N1+(h-5)),m=R,h=1),R=r.get(E,C),R===_?g++:(g>=5&&(f+=t.N1+(g-5)),_=R,g=1)}h>=5&&(f+=t.N1+(h-5)),g>=5&&(f+=t.N1+(g-5))}return f},l.getPenaltyN2=function(r){const o=r.size;let f=0;for(let h=0;h<o-1;h++)for(let g=0;g<o-1;g++){const m=r.get(h,g)+r.get(h,g+1)+r.get(h+1,g)+r.get(h+1,g+1);(m===4||m===0)&&f++}return f*t.N2},l.getPenaltyN3=function(r){const o=r.size;let f=0,h=0,g=0;for(let m=0;m<o;m++){h=g=0;for(let _=0;_<o;_++)h=h<<1&2047|r.get(m,_),_>=10&&(h===1488||h===93)&&f++,g=g<<1&2047|r.get(_,m),_>=10&&(g===1488||g===93)&&f++}return f*t.N3},l.getPenaltyN4=function(r){let o=0;const f=r.data.length;for(let g=0;g<f;g++)o+=r.data[g];return Math.abs(Math.ceil(o*100/f/5)-10)*t.N4};function n(a,r,o){switch(a){case l.Patterns.PATTERN000:return(r+o)%2===0;case l.Patterns.PATTERN001:return r%2===0;case l.Patterns.PATTERN010:return o%3===0;case l.Patterns.PATTERN011:return(r+o)%3===0;case l.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(o/3))%2===0;case l.Patterns.PATTERN101:return r*o%2+r*o%3===0;case l.Patterns.PATTERN110:return(r*o%2+r*o%3)%2===0;case l.Patterns.PATTERN111:return(r*o%3+(r+o)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}l.applyMask=function(r,o){const f=o.size;for(let h=0;h<f;h++)for(let g=0;g<f;g++)o.isReserved(g,h)||o.xor(g,h,n(r,g,h))},l.getBestMask=function(r,o){const f=Object.keys(l.Patterns).length;let h=0,g=1/0;for(let m=0;m<f;m++){o(m),l.applyMask(m,r);const _=l.getPenaltyN1(r)+l.getPenaltyN2(r)+l.getPenaltyN3(r)+l.getPenaltyN4(r);l.applyMask(m,r),_<g&&(g=_,h=m)}return h}})(im)),im}var fg={},W1;function vb(){if(W1)return fg;W1=1;const l=gv(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return fg.getBlocksCount=function(r,o){switch(o){case l.L:return t[(r-1)*4+0];case l.M:return t[(r-1)*4+1];case l.Q:return t[(r-1)*4+2];case l.H:return t[(r-1)*4+3];default:return}},fg.getTotalCodewordsCount=function(r,o){switch(o){case l.L:return n[(r-1)*4+0];case l.M:return n[(r-1)*4+1];case l.Q:return n[(r-1)*4+2];case l.H:return n[(r-1)*4+3];default:return}},fg}var rm={},Zh={},$1;function gT(){if($1)return Zh;$1=1;const l=new Uint8Array(512),t=new Uint8Array(256);return(function(){let a=1;for(let r=0;r<255;r++)l[r]=a,t[a]=r,a<<=1,a&256&&(a^=285);for(let r=255;r<512;r++)l[r]=l[r-255]})(),Zh.log=function(a){if(a<1)throw new Error("log("+a+")");return t[a]},Zh.exp=function(a){return l[a]},Zh.mul=function(a,r){return a===0||r===0?0:l[t[a]+t[r]]},Zh}var t2;function pT(){return t2||(t2=1,(function(l){const t=gT();l.mul=function(a,r){const o=new Uint8Array(a.length+r.length-1);for(let f=0;f<a.length;f++)for(let h=0;h<r.length;h++)o[f+h]^=t.mul(a[f],r[h]);return o},l.mod=function(a,r){let o=new Uint8Array(a);for(;o.length-r.length>=0;){const f=o[0];for(let g=0;g<r.length;g++)o[g]^=t.mul(r[g],f);let h=0;for(;h<o.length&&o[h]===0;)h++;o=o.slice(h)}return o},l.generateECPolynomial=function(a){let r=new Uint8Array([1]);for(let o=0;o<a;o++)r=l.mul(r,new Uint8Array([1,t.exp(o)]));return r}})(rm)),rm}var sm,e2;function mT(){if(e2)return sm;e2=1;const l=pT();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(a){this.degree=a,this.genPoly=l.generateECPolynomial(this.degree)},t.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(a.length+this.degree);r.set(a);const o=l.mod(r,this.genPoly),f=this.degree-o.length;if(f>0){const h=new Uint8Array(this.degree);return h.set(o,f),h}return o},sm=t,sm}var lm={},om={},um={},n2;function yb(){return n2||(n2=1,um.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),um}var Ss={},a2;function Sb(){if(a2)return Ss;a2=1;const l="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Ss.KANJI=new RegExp(n,"g"),Ss.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ss.BYTE=new RegExp(a,"g"),Ss.NUMERIC=new RegExp(l,"g"),Ss.ALPHANUMERIC=new RegExp(t,"g");const r=new RegExp("^"+n+"$"),o=new RegExp("^"+l+"$"),f=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ss.testKanji=function(g){return r.test(g)},Ss.testNumeric=function(g){return o.test(g)},Ss.testAlphanumeric=function(g){return f.test(g)},Ss}var i2;function Ou(){return i2||(i2=1,(function(l){const t=yb(),n=Sb();l.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},l.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},l.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},l.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},l.MIXED={bit:-1},l.getCharCountIndicator=function(o,f){if(!o.ccBits)throw new Error("Invalid mode: "+o);if(!t.isValid(f))throw new Error("Invalid version: "+f);return f>=1&&f<10?o.ccBits[0]:f<27?o.ccBits[1]:o.ccBits[2]},l.getBestModeForData=function(o){return n.testNumeric(o)?l.NUMERIC:n.testAlphanumeric(o)?l.ALPHANUMERIC:n.testKanji(o)?l.KANJI:l.BYTE},l.toString=function(o){if(o&&o.id)return o.id;throw new Error("Invalid mode")},l.isValid=function(o){return o&&o.bit&&o.ccBits};function a(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return l.NUMERIC;case"alphanumeric":return l.ALPHANUMERIC;case"kanji":return l.KANJI;case"byte":return l.BYTE;default:throw new Error("Unknown mode: "+r)}}l.from=function(o,f){if(l.isValid(o))return o;try{return a(o)}catch{return f}}})(om)),om}var r2;function vT(){return r2||(r2=1,(function(l){const t=Ru(),n=vb(),a=gv(),r=Ou(),o=yb(),f=7973,h=t.getBCHDigit(f);function g(E,R,v){for(let D=1;D<=40;D++)if(R<=l.getCapacity(D,v,E))return D}function m(E,R){return r.getCharCountIndicator(E,R)+4}function _(E,R){let v=0;return E.forEach(function(D){const B=m(D.mode,R);v+=B+D.getBitsLength()}),v}function C(E,R){for(let v=1;v<=40;v++)if(_(E,v)<=l.getCapacity(v,R,r.MIXED))return v}l.from=function(R,v){return o.isValid(R)?parseInt(R,10):v},l.getCapacity=function(R,v,D){if(!o.isValid(R))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=r.BYTE);const B=t.getSymbolTotalCodewords(R),L=n.getTotalCodewordsCount(R,v),N=(B-L)*8;if(D===r.MIXED)return N;const M=N-m(D,R);switch(D){case r.NUMERIC:return Math.floor(M/10*3);case r.ALPHANUMERIC:return Math.floor(M/11*2);case r.KANJI:return Math.floor(M/13);case r.BYTE:default:return Math.floor(M/8)}},l.getBestVersionForData=function(R,v){let D;const B=a.from(v,a.M);if(Array.isArray(R)){if(R.length>1)return C(R,B);if(R.length===0)return 1;D=R[0]}else D=R;return g(D.mode,D.getLength(),B)},l.getEncodedBits=function(R){if(!o.isValid(R)||R<7)throw new Error("Invalid QR Code version");let v=R<<12;for(;t.getBCHDigit(v)-h>=0;)v^=f<<t.getBCHDigit(v)-h;return R<<12|v}})(lm)),lm}var cm={},s2;function yT(){if(s2)return cm;s2=1;const l=Ru(),t=1335,n=21522,a=l.getBCHDigit(t);return cm.getEncodedBits=function(o,f){const h=o.bit<<3|f;let g=h<<10;for(;l.getBCHDigit(g)-a>=0;)g^=t<<l.getBCHDigit(g)-a;return(h<<10|g)^n},cm}var fm={},hm,l2;function ST(){if(l2)return hm;l2=1;const l=Ou();function t(n){this.mode=l.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(a){let r,o,f;for(r=0;r+3<=this.data.length;r+=3)o=this.data.substr(r,3),f=parseInt(o,10),a.put(f,10);const h=this.data.length-r;h>0&&(o=this.data.substr(r),f=parseInt(o,10),a.put(f,h*3+1))},hm=t,hm}var dm,o2;function bT(){if(o2)return dm;o2=1;const l=Ou(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(a){this.mode=l.ALPHANUMERIC,this.data=a}return n.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let o;for(o=0;o+2<=this.data.length;o+=2){let f=t.indexOf(this.data[o])*45;f+=t.indexOf(this.data[o+1]),r.put(f,11)}this.data.length%2&&r.put(t.indexOf(this.data[o]),6)},dm=n,dm}var gm,u2;function _T(){if(u2)return gm;u2=1;const l=Ou();function t(n){this.mode=l.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(a){return a*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let a=0,r=this.data.length;a<r;a++)n.put(this.data[a],8)},gm=t,gm}var pm,c2;function ET(){if(c2)return pm;c2=1;const l=Ou(),t=Ru();function n(a){this.mode=l.KANJI,this.data=a}return n.getBitsLength=function(r){return r*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(a){let r;for(r=0;r<this.data.length;r++){let o=t.toSJIS(this.data[r]);if(o>=33088&&o<=40956)o-=33088;else if(o>=57408&&o<=60351)o-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);o=(o>>>8&255)*192+(o&255),a.put(o,13)}},pm=n,pm}var mm={exports:{}},f2;function CT(){return f2||(f2=1,(function(l){var t={single_source_shortest_paths:function(n,a,r){var o={},f={};f[a]=0;var h=t.PriorityQueue.make();h.push(a,0);for(var g,m,_,C,E,R,v,D,B;!h.empty();){g=h.pop(),m=g.value,C=g.cost,E=n[m]||{};for(_ in E)E.hasOwnProperty(_)&&(R=E[_],v=C+R,D=f[_],B=typeof f[_]>"u",(B||D>v)&&(f[_]=v,h.push(_,v),o[_]=m))}if(typeof r<"u"&&typeof f[r]>"u"){var L=["Could not find a path from ",a," to ",r,"."].join("");throw new Error(L)}return o},extract_shortest_path_from_predecessor_list:function(n,a){for(var r=[],o=a;o;)r.push(o),n[o],o=n[o];return r.reverse(),r},find_path:function(n,a,r){var o=t.single_source_shortest_paths(n,a,r);return t.extract_shortest_path_from_predecessor_list(o,r)},PriorityQueue:{make:function(n){var a=t.PriorityQueue,r={},o;n=n||{};for(o in a)a.hasOwnProperty(o)&&(r[o]=a[o]);return r.queue=[],r.sorter=n.sorter||a.default_sorter,r},default_sorter:function(n,a){return n.cost-a.cost},push:function(n,a){var r={value:n,cost:a};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};l.exports=t})(mm)),mm.exports}var h2;function TT(){return h2||(h2=1,(function(l){const t=Ou(),n=ST(),a=bT(),r=_T(),o=ET(),f=Sb(),h=Ru(),g=CT();function m(L){return unescape(encodeURIComponent(L)).length}function _(L,N,M){const G=[];let O;for(;(O=L.exec(M))!==null;)G.push({data:O[0],index:O.index,mode:N,length:O[0].length});return G}function C(L){const N=_(f.NUMERIC,t.NUMERIC,L),M=_(f.ALPHANUMERIC,t.ALPHANUMERIC,L);let G,O;return h.isKanjiModeEnabled()?(G=_(f.BYTE,t.BYTE,L),O=_(f.KANJI,t.KANJI,L)):(G=_(f.BYTE_KANJI,t.BYTE,L),O=[]),N.concat(M,G,O).sort(function(T,y){return T.index-y.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function E(L,N){switch(N){case t.NUMERIC:return n.getBitsLength(L);case t.ALPHANUMERIC:return a.getBitsLength(L);case t.KANJI:return o.getBitsLength(L);case t.BYTE:return r.getBitsLength(L)}}function R(L){return L.reduce(function(N,M){const G=N.length-1>=0?N[N.length-1]:null;return G&&G.mode===M.mode?(N[N.length-1].data+=M.data,N):(N.push(M),N)},[])}function v(L){const N=[];for(let M=0;M<L.length;M++){const G=L[M];switch(G.mode){case t.NUMERIC:N.push([G,{data:G.data,mode:t.ALPHANUMERIC,length:G.length},{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.ALPHANUMERIC:N.push([G,{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.KANJI:N.push([G,{data:G.data,mode:t.BYTE,length:m(G.data)}]);break;case t.BYTE:N.push([{data:G.data,mode:t.BYTE,length:m(G.data)}])}}return N}function D(L,N){const M={},G={start:{}};let O=["start"];for(let w=0;w<L.length;w++){const T=L[w],y=[];for(let z=0;z<T.length;z++){const U=T[z],P=""+w+z;y.push(P),M[P]={node:U,lastCount:0},G[P]={};for(let K=0;K<O.length;K++){const Q=O[K];M[Q]&&M[Q].node.mode===U.mode?(G[Q][P]=E(M[Q].lastCount+U.length,U.mode)-E(M[Q].lastCount,U.mode),M[Q].lastCount+=U.length):(M[Q]&&(M[Q].lastCount=U.length),G[Q][P]=E(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,N))}}O=y}for(let w=0;w<O.length;w++)G[O[w]].end=0;return{map:G,table:M}}function B(L,N){let M;const G=t.getBestModeForData(L);if(M=t.from(N,G),M!==t.BYTE&&M.bit<G.bit)throw new Error('"'+L+'" cannot be encoded with mode '+t.toString(M)+`.
 Suggested mode is: `+t.toString(G));switch(M===t.KANJI&&!h.isKanjiModeEnabled()&&(M=t.BYTE),M){case t.NUMERIC:return new n(L);case t.ALPHANUMERIC:return new a(L);case t.KANJI:return new o(L);case t.BYTE:return new r(L)}}l.fromArray=function(N){return N.reduce(function(M,G){return typeof G=="string"?M.push(B(G,null)):G.data&&M.push(B(G.data,G.mode)),M},[])},l.fromString=function(N,M){const G=C(N,h.isKanjiModeEnabled()),O=v(G),w=D(O,M),T=g.find_path(w.map,"start","end"),y=[];for(let z=1;z<T.length-1;z++)y.push(w.table[T[z]].node);return l.fromArray(R(y))},l.rawSplit=function(N){return l.fromArray(C(N,h.isKanjiModeEnabled()))}})(fm)),fm}var d2;function AT(){if(d2)return Wp;d2=1;const l=Ru(),t=gv(),n=uT(),a=cT(),r=fT(),o=hT(),f=dT(),h=vb(),g=mT(),m=vT(),_=yT(),C=Ou(),E=TT();function R(w,T){const y=w.size,z=o.getPositions(T);for(let U=0;U<z.length;U++){const P=z[U][0],K=z[U][1];for(let Q=-1;Q<=7;Q++)if(!(P+Q<=-1||y<=P+Q))for(let X=-1;X<=7;X++)K+X<=-1||y<=K+X||(Q>=0&&Q<=6&&(X===0||X===6)||X>=0&&X<=6&&(Q===0||Q===6)||Q>=2&&Q<=4&&X>=2&&X<=4?w.set(P+Q,K+X,!0,!0):w.set(P+Q,K+X,!1,!0))}}function v(w){const T=w.size;for(let y=8;y<T-8;y++){const z=y%2===0;w.set(y,6,z,!0),w.set(6,y,z,!0)}}function D(w,T){const y=r.getPositions(T);for(let z=0;z<y.length;z++){const U=y[z][0],P=y[z][1];for(let K=-2;K<=2;K++)for(let Q=-2;Q<=2;Q++)K===-2||K===2||Q===-2||Q===2||K===0&&Q===0?w.set(U+K,P+Q,!0,!0):w.set(U+K,P+Q,!1,!0)}}function B(w,T){const y=w.size,z=m.getEncodedBits(T);let U,P,K;for(let Q=0;Q<18;Q++)U=Math.floor(Q/3),P=Q%3+y-8-3,K=(z>>Q&1)===1,w.set(U,P,K,!0),w.set(P,U,K,!0)}function L(w,T,y){const z=w.size,U=_.getEncodedBits(T,y);let P,K;for(P=0;P<15;P++)K=(U>>P&1)===1,P<6?w.set(P,8,K,!0):P<8?w.set(P+1,8,K,!0):w.set(z-15+P,8,K,!0),P<8?w.set(8,z-P-1,K,!0):P<9?w.set(8,15-P-1+1,K,!0):w.set(8,15-P-1,K,!0);w.set(z-8,8,1,!0)}function N(w,T){const y=w.size;let z=-1,U=y-1,P=7,K=0;for(let Q=y-1;Q>0;Q-=2)for(Q===6&&Q--;;){for(let X=0;X<2;X++)if(!w.isReserved(U,Q-X)){let Y=!1;K<T.length&&(Y=(T[K]>>>P&1)===1),w.set(U,Q-X,Y),P--,P===-1&&(K++,P=7)}if(U+=z,U<0||y<=U){U-=z,z=-z;break}}}function M(w,T,y){const z=new n;y.forEach(function(X){z.put(X.mode.bit,4),z.put(X.getLength(),C.getCharCountIndicator(X.mode,w)),X.write(z)});const U=l.getSymbolTotalCodewords(w),P=h.getTotalCodewordsCount(w,T),K=(U-P)*8;for(z.getLengthInBits()+4<=K&&z.put(0,4);z.getLengthInBits()%8!==0;)z.putBit(0);const Q=(K-z.getLengthInBits())/8;for(let X=0;X<Q;X++)z.put(X%2?17:236,8);return G(z,w,T)}function G(w,T,y){const z=l.getSymbolTotalCodewords(T),U=h.getTotalCodewordsCount(T,y),P=z-U,K=h.getBlocksCount(T,y),Q=z%K,X=K-Q,Y=Math.floor(z/K),j=Math.floor(P/K),I=j+1,F=Y-j,W=new g(F);let nt=0;const Z=new Array(K),it=new Array(K);let rt=0;const V=new Uint8Array(w.buffer);for(let Rt=0;Rt<K;Rt++){const zt=Rt<X?j:I;Z[Rt]=V.slice(nt,nt+zt),it[Rt]=W.encode(Z[Rt]),nt+=zt,rt=Math.max(rt,zt)}const J=new Uint8Array(z);let $=0,at,ht;for(at=0;at<rt;at++)for(ht=0;ht<K;ht++)at<Z[ht].length&&(J[$++]=Z[ht][at]);for(at=0;at<F;at++)for(ht=0;ht<K;ht++)J[$++]=it[ht][at];return J}function O(w,T,y,z){let U;if(Array.isArray(w))U=E.fromArray(w);else if(typeof w=="string"){let Y=T;if(!Y){const j=E.rawSplit(w);Y=m.getBestVersionForData(j,y)}U=E.fromString(w,Y||40)}else throw new Error("Invalid data");const P=m.getBestVersionForData(U,y);if(!P)throw new Error("The amount of data is too big to be stored in a QR Code");if(!T)T=P;else if(T<P)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+P+`.
`);const K=M(T,y,U),Q=l.getSymbolSize(T),X=new a(Q);return R(X,T),v(X),D(X,T),L(X,y,0),T>=7&&B(X,T),N(X,K),isNaN(z)&&(z=f.getBestMask(X,L.bind(null,X,y))),f.applyMask(z,X),L(X,y,z),{modules:X,version:T,errorCorrectionLevel:y,maskPattern:z,segments:U}}return Wp.create=function(T,y){if(typeof T>"u"||T==="")throw new Error("No input text");let z=t.M,U,P;return typeof y<"u"&&(z=t.from(y.errorCorrectionLevel,t.M),U=m.from(y.version),P=f.from(y.maskPattern),y.toSJISFunc&&l.setToSJISFunction(y.toSJISFunc)),O(T,U,z,P)},Wp}var vm={},ym={},g2;function bb(){return g2||(g2=1,(function(l){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let a=n.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+n);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(o){return[o,o]}))),a.length===6&&a.push("F","F");const r=parseInt(a.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+a.slice(0,6).join("")}}l.getOptions=function(a){a||(a={}),a.color||(a.color={});const r=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,o=a.width&&a.width>=21?a.width:void 0,f=a.scale||4;return{width:o,scale:o?4:f,margin:r,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},l.getScale=function(a,r){return r.width&&r.width>=a+r.margin*2?r.width/(a+r.margin*2):r.scale},l.getImageWidth=function(a,r){const o=l.getScale(a,r);return Math.floor((a+r.margin*2)*o)},l.qrToImageData=function(a,r,o){const f=r.modules.size,h=r.modules.data,g=l.getScale(f,o),m=Math.floor((f+o.margin*2)*g),_=o.margin*g,C=[o.color.light,o.color.dark];for(let E=0;E<m;E++)for(let R=0;R<m;R++){let v=(E*m+R)*4,D=o.color.light;if(E>=_&&R>=_&&E<m-_&&R<m-_){const B=Math.floor((E-_)/g),L=Math.floor((R-_)/g);D=C[h[B*f+L]?1:0]}a[v++]=D.r,a[v++]=D.g,a[v++]=D.b,a[v]=D.a}}})(ym)),ym}var p2;function wT(){return p2||(p2=1,(function(l){const t=bb();function n(r,o,f){r.clearRect(0,0,o.width,o.height),o.style||(o.style={}),o.height=f,o.width=f,o.style.height=f+"px",o.style.width=f+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}l.render=function(o,f,h){let g=h,m=f;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),f||(m=a()),g=t.getOptions(g);const _=t.getImageWidth(o.modules.size,g),C=m.getContext("2d"),E=C.createImageData(_,_);return t.qrToImageData(E.data,o,g),n(C,m,_),C.putImageData(E,0,0),m},l.renderToDataURL=function(o,f,h){let g=h;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),g||(g={});const m=l.render(o,f,g),_=g.type||"image/png",C=g.rendererOpts||{};return m.toDataURL(_,C.quality)}})(vm)),vm}var Sm={},m2;function RT(){if(m2)return Sm;m2=1;const l=bb();function t(r,o){const f=r.a/255,h=o+'="'+r.hex+'"';return f<1?h+" "+o+'-opacity="'+f.toFixed(2).slice(1)+'"':h}function n(r,o,f){let h=r+o;return typeof f<"u"&&(h+=" "+f),h}function a(r,o,f){let h="",g=0,m=!1,_=0;for(let C=0;C<r.length;C++){const E=Math.floor(C%o),R=Math.floor(C/o);!E&&!m&&(m=!0),r[C]?(_++,C>0&&E>0&&r[C-1]||(h+=m?n("M",E+f,.5+R+f):n("m",g,0),g=0,m=!1),E+1<o&&r[C+1]||(h+=n("h",_),_=0)):g++}return h}return Sm.render=function(o,f,h){const g=l.getOptions(f),m=o.modules.size,_=o.modules.data,C=m+g.margin*2,E=g.color.light.a?"<path "+t(g.color.light,"fill")+' d="M0 0h'+C+"v"+C+'H0z"/>':"",R="<path "+t(g.color.dark,"stroke")+' d="'+a(_,m,g.margin)+'"/>',v='viewBox="0 0 '+C+" "+C+'"',B='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+v+' shape-rendering="crispEdges">'+E+R+`</svg>
`;return typeof h=="function"&&h(null,B),B},Sm}var v2;function OT(){if(v2)return af;v2=1;const l=oT(),t=AT(),n=wT(),a=RT();function r(o,f,h,g,m){const _=[].slice.call(arguments,1),C=_.length,E=typeof _[C-1]=="function";if(!E&&!l())throw new Error("Callback required as last argument");if(E){if(C<2)throw new Error("Too few arguments provided");C===2?(m=h,h=f,f=g=void 0):C===3&&(f.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=h,h=f,f=void 0))}else{if(C<1)throw new Error("Too few arguments provided");return C===1?(h=f,f=g=void 0):C===2&&!f.getContext&&(g=h,h=f,f=void 0),new Promise(function(R,v){try{const D=t.create(h,g);R(o(D,f,g))}catch(D){v(D)}})}try{const R=t.create(h,g);m(null,o(R,f,g))}catch(R){m(R)}}return af.create=t.create,af.toCanvas=r.bind(null,n.render),af.toDataURL=r.bind(null,n.renderToDataURL),af.toString=r.bind(null,function(o,f,h){return a.render(o,h)}),af}var xT=OT();const _b=pf(xT),Eb=({active:l=!1,size:t=20})=>{const n=l?"#ff4d4f":"#b8c1cc",a=l?"#ff4d4f":"transparent";return k.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[k.jsx("path",{d:"M5 2.5V17.5",stroke:n,strokeWidth:"1.6",strokeLinecap:"round"}),k.jsx("path",{d:"M5 3h10l-2 3 2 3H5V3Z",fill:a,stroke:n,strokeWidth:"1.4",strokeLinejoin:"round"})]})},Cb=({student:l,onClick:t,onToggleFlag:n,teacherAnnotations:a=[],sharedImage:r,hideNames:o=!1})=>{var G,O,w,T;const f=st.useRef(null),h=st.useRef(null),[g,m]=st.useState(null),[_,C]=st.useState(300);st.useEffect(()=>{if(!r){m(null);return}const y=new window.Image;y.src=r.dataUrl,y.onload=()=>{m(y)}},[r]),st.useEffect(()=>{if(!h.current)return;const y=()=>{h.current&&C(h.current.clientWidth)};y();const z=new ResizeObserver(y);return z.observe(h.current),()=>z.disconnect()},[]);const E=()=>{if(l!=null&&l.name)return l.name;if(!(l!=null&&l.clientId))return"Unknown Student";const y=l.clientId.match(/student-(\d+)/);return y?`Student ${y[1]}`:l.clientId},R=()=>{if(!l.lastUpdate)return"Just joined";const y=Math.floor((Date.now()-l.lastUpdate)/1e3);return y<5?"Just now":y<60?`${y}s ago`:`${Math.floor(y/60)}m ago`},v=((O=(G=l.meta)==null?void 0:G.base)==null?void 0:O.width)||800,D=((T=(w=l.meta)==null?void 0:w.base)==null?void 0:T.height)||600,B=_/v,L=y=>{y.stopPropagation(),n&&n(l.clientId)},M=(()=>{if(!r||!g)return null;const y=r.width/r.height,z=v/D;let U,P,K,Q;return y>z?(U=v,P=v/y,K=0,Q=(D-P)/2):(P=D,U=D*y,K=(v-U)/2,Q=0),{x:K,y:Q,width:U,height:P}})();return k.jsxs("div",{className:`student-card ${l.isActive?"active":"inactive"}`,onClick:()=>t(l),children:[k.jsxs("div",{className:"student-card-header",children:[k.jsxs("div",{className:"student-name",children:[k.jsx("span",{className:"student-icon",children:"👤"}),o?"•••":E()]}),k.jsxs("div",{className:"student-header-actions",children:[k.jsx("button",{className:`flag-button ${l.isFlagged?"active":""}`,onClick:L,"aria-label":l.isFlagged?"Remove flag":"Flag student",title:l.isFlagged?"Remove flag":"Flag student",children:k.jsx(Eb,{active:l.isFlagged,size:18})}),k.jsxs("div",{className:"student-status",children:[k.jsx("span",{className:`status-dot ${l.isActive?"online":"offline"}`}),l.isVisible===!1&&l.isActive&&k.jsx("span",{className:"visibility-indicator away",title:"Student is distracted (switched away from tab)",children:"⚠️"})]})]})]}),k.jsxs("div",{className:"student-card-canvas",ref:h,children:[k.jsxs(Ng,{ref:f,width:v,height:D,scaleX:B,scaleY:B,style:{transformOrigin:"top left",width:"100%",height:"100%"},children:[M&&k.jsx(Ir,{listening:!1,children:k.jsx(av,{image:g,x:M.x,y:M.y,width:M.width,height:M.height})}),k.jsx(Ir,{children:l.lines&&l.lines.map((y,z)=>k.jsx(ho,{points:y.points,stroke:y.color||"black",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`preview-${l.clientId}-${z}`))}),k.jsx(Ir,{children:a.map((y,z)=>k.jsx(ho,{points:y.points,stroke:y.color||"#FF0000",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${l.clientId}-${z}`))})]}),(!l.lines||l.lines.length===0)&&k.jsxs("div",{className:"no-drawing",children:[k.jsx("span",{children:"✏️"}),k.jsx("p",{children:"No drawing yet"})]}),l.lines&&l.lines.length>0&&k.jsxs("div",{className:"stroke-count",children:[l.lines.length," stroke",l.lines.length!==1?"s":""]})]}),k.jsxs("div",{className:"student-card-footer",children:[k.jsx("span",{className:"last-update",children:R()}),k.jsx("span",{className:"click-hint",children:"Click to annotate →"})]})]})},rf={width:800,height:600},hg="teacherAnnotationPrefs",y2=2,bm=[{label:"Red",value:"#FF3B30"},{label:"Purple",value:"#7C3AED"},{label:"Teal",value:"#0EA5E9"}],Tb=({student:l,isOpen:t,onClose:n,onAnnotate:a,existingAnnotations:r=[],isFlagged:o=!1,onToggleFlag:f,sharedImage:h})=>{const[g,m]=st.useState("pen"),[_,C]=st.useState(bm[0].value),[E,R]=st.useState(3),[v,D]=st.useState(!1),[B,L]=st.useState([]),[N,M]=st.useState("stylus-only"),[G,O]=st.useState("left"),[w,T]=st.useState(null),[y,z]=st.useState(!1),U=st.useRef([]),P=st.useRef([]),K=st.useRef(!1),Q=st.useRef(null),X=st.useRef(!0),Y=st.useRef(0),j=st.useRef(null),I=st.useRef(null);st.useEffect(()=>{if(!h){T(null);return}const wt=new window.Image;wt.src=h.dataUrl,wt.onload=()=>{T(wt)}},[h]);const F=st.useRef(null),W=st.useRef(null),[nt,Z]=st.useState({width:960,height:720}),it=st.useMemo(()=>({x:nt.width/rf.width,y:nt.height/rf.height}),[nt]);st.useEffect(()=>{const wt=()=>{z(window.innerWidth<=768)};return wt(),window.addEventListener("resize",wt),()=>window.removeEventListener("resize",wt)},[]),st.useEffect(()=>{if(!(typeof window>"u"))try{const wt=localStorage.getItem(hg);if(wt){const Yt=JSON.parse(wt);if(Yt.version!==y2){localStorage.removeItem(hg);return}Yt.tool&&m(Yt.tool),Yt.color&&C(Yt.color),typeof Yt.brushSize=="number"&&R(Yt.brushSize),Yt.inputMode&&M(Yt.inputMode),Yt.toolbarPosition&&O(Yt.toolbarPosition)}}catch{localStorage.removeItem(hg)}},[]),st.useEffect(()=>{if(typeof window>"u")return;if(X.current){X.current=!1;return}const wt={version:y2,tool:g,color:_,brushSize:E,inputMode:N,toolbarPosition:G};localStorage.setItem(hg,JSON.stringify(wt))},[g,_,E,N,G]),st.useEffect(()=>{t&&l&&l.clientId!==Q.current&&(Q.current=l.clientId,L(r),U.current=[],P.current=[])},[t,l,r]),st.useEffect(()=>{t&&l&&L(r)},[r,t,l]),st.useEffect(()=>()=>{I.current&&cancelAnimationFrame(I.current)},[]),st.useEffect(()=>{if(!t)return;const wt=document.body.style.overflow,Yt=document.body.style.position,Fe=document.body.style.touchAction,Se=document.body.style.width,we=document.body.style.top,$e=window.scrollY||document.documentElement.scrollTop||0;Y.current=$e,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${$e}px`,document.body.style.touchAction="none";const Ae=F.current,ct=kt=>{const le=kt.target;le.closest("button")||le.closest(".annotation-sidebar")||le.closest(".annotation-status-actions")||kt.preventDefault()},At=kt=>{kt.preventDefault()},xt=kt=>{if(v)return kt.preventDefault(),!1};return Ae&&(Ae.addEventListener("touchstart",ct,{passive:!1}),Ae.addEventListener("touchmove",ct,{passive:!1}),Ae.addEventListener("gesturestart",At,{passive:!1}),Ae.addEventListener("gesturechange",At,{passive:!1})),document.addEventListener("selectstart",xt),()=>{document.body.style.overflow=wt,document.body.style.position=Yt,document.body.style.width=Se,document.body.style.top=we,document.body.style.touchAction=Fe,Ae&&(Ae.removeEventListener("touchstart",ct),Ae.removeEventListener("touchmove",ct),Ae.removeEventListener("gesturestart",At),Ae.removeEventListener("gesturechange",At)),document.removeEventListener("selectstart",xt),requestAnimationFrame(()=>{window.scrollTo(0,Y.current)})}},[t,v]),st.useEffect(()=>{if(!t)return;const wt=()=>{if(!F.current)return;const Yt=F.current.getBoundingClientRect(),we=24+4,$e=Math.max(320,Yt.width-we),Ae=Math.max(240,Yt.height-we),ct=$e/rf.width,At=Ae/rf.height,xt=Math.min(ct,At);Z({width:Math.round(rf.width*xt),height:Math.round(rf.height*xt)})};return wt(),window.addEventListener("resize",wt),()=>window.removeEventListener("resize",wt)},[G,t]);const rt=()=>{if(!h||!w)return null;const wt=h.width/h.height,Yt=nt.width/nt.height;let Fe,Se,we,$e;return wt>Yt?(Fe=nt.width,Se=nt.width/wt,we=0,$e=(nt.height-Se)/2):(Se=nt.height,Fe=nt.height*wt,we=(nt.width-Fe)/2,$e=0),{x:we,y:$e,width:Fe,height:Se}};if(!t||!l)return null;const V=rt(),J=()=>{if(l.name)return l.name;const wt=l.clientId.match(/student-(\d+)/)||l.clientId.match(/load-test-student-(\d+)/);return wt?`Student ${wt[1]}`:l.clientId},$=wt=>N!=="stylus-only"?!0:(wt==null?void 0:wt.pointerType)==="pen",at=(wt=[])=>wt.map((Yt,Fe)=>Fe%2===0?Yt*it.x:Yt*it.y),ht=wt=>({x:wt.x/it.x,y:wt.y/it.y}),Rt=wt=>(wt.strokeWidth||3)*it.x,zt=wt=>{const Yt=wt.evt;if(Yt!=null&&Yt.preventDefault&&Yt.preventDefault(),Yt!=null&&Yt.stopPropagation&&Yt.stopPropagation(),!$(Yt))return;const Fe=wt.target.getStage();if(Fe&&Yt.pointerId!==void 0){const Se=Fe.content;if(Se&&Se.setPointerCapture)try{Se.setPointerCapture(Yt.pointerId)}catch{}}if(g==="pen"){D(!0);const Se=Fe.getPointerPosition(),{x:we,y:$e}=ht(Se),Ae={tool:"pen",points:[we,$e],color:_,strokeWidth:E};U.current.push([...B]),P.current=[],j.current=Ae,L([...B,Ae])}else g==="eraser"&&(D(!0),K.current=!1)},Wt=wt=>{const Yt=wt.evt;if(Yt!=null&&Yt.preventDefault&&Yt.preventDefault(),Yt!=null&&Yt.stopPropagation&&Yt.stopPropagation(),!v||!$(Yt))return;const Se=wt.target.getStage().getPointerPosition();if(g==="pen"){if(j.current){const{x:we,y:$e}=ht(Se);j.current.points=j.current.points.concat([we,$e]);const Ae=j.current;I.current&&cancelAnimationFrame(I.current),I.current=requestAnimationFrame(()=>{Ae&&L(ct=>ct.length===0?ct:[...ct.slice(0,-1),Ae])})}}else if(g==="eraser"){const we=B.length,$e=20,Ae=B.filter(ct=>{for(let At=0;At<ct.points.length;At+=2){const xt=ct.points[At]*it.x,kt=ct.points[At+1]*it.y;if(Math.sqrt(Math.pow(xt-Se.x,2)+Math.pow(kt-Se.y,2))<$e)return!1}return!0});Ae.length<we&&!K.current&&(U.current.push([...B]),P.current=[],K.current=!0),L(Ae)}},It=wt=>{const Yt=wt==null?void 0:wt.evt;if(!$(Yt)){Yt!=null&&Yt.preventDefault&&Yt.preventDefault();return}if(D(!1),I.current&&(cancelAnimationFrame(I.current),I.current=null),j.current&&g==="pen"){const Fe=j.current;L(Se=>{if(Se.length===0)return Se;const we=[...Se.slice(0,-1),Fe];return setTimeout(()=>a(we),0),we}),j.current=null}else setTimeout(()=>a(B),0)},pe=()=>{if(U.current.length>0){const wt=U.current.pop();P.current.push([...B]),L(wt),a(wt)}},Bt=()=>{if(P.current.length>0){const wt=P.current.pop();U.current.push([...B]),L(wt),a(wt)}},Te=()=>{U.current.push([...B]),P.current=[];const wt=[];L(wt),a(wt)},ze=()=>{f&&f(l.clientId)},Xe=()=>{D(!1),n()},ke=()=>{M(wt=>wt==="stylus-only"?"all":"stylus-only")},hn=()=>{O(wt=>wt==="left"?"right":"left")},Un=wt=>{wt.preventDefault(),wt.stopPropagation()};return k.jsx("div",{className:"annotation-modal-overlay",onTouchMove:Un,onTouchStart:Un,children:k.jsx("div",{className:"annotation-modal student-console",children:k.jsxs("div",{className:"annotation-console",children:[k.jsxs("div",{className:"annotation-status-bar",children:[k.jsxs("div",{className:"annotation-status-text",children:[k.jsx("h1",{children:"Annotate Student"}),k.jsx("p",{children:J()})]}),k.jsxs("div",{className:"annotation-status-actions",children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:g==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",N==="all"?"All inputs":"Stylus only"]})}),k.jsxs("button",{className:`flag-pill ${o?"active":""}`,onClick:ze,children:[k.jsx(Eb,{active:o,size:16}),o?"Flagged":"Flag"]}),k.jsxs("button",{className:"status-badge",onClick:hn,children:["Move toolbar to ",G==="left"?"right":"left"]}),k.jsx("button",{className:"status-badge danger",onClick:Xe,children:"✕ Close"})]})]}),k.jsxs("div",{className:`annotation-workspace ${G==="right"?"toolbar-right":""} ${y?"mobile-view":""}`,children:[y?k.jsxs("div",{className:"mobile-annotation-toolbar",children:[k.jsx("div",{className:"mobile-colors",children:bm.map(wt=>k.jsx("button",{onClick:()=>C(wt.value),className:`mobile-color-button ${_===wt.value?"active":""}`,style:{background:wt.value},"aria-label":wt.label},wt.value))}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>m("pen"),className:`mobile-tool-button ${g==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(db,{size:20})}),k.jsx("button",{onClick:()=>m("eraser"),className:`mobile-tool-button ${g==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(hb,{size:20})}),k.jsx("button",{onClick:pe,className:"mobile-tool-button",disabled:U.current.length===0,"aria-label":"Undo",children:k.jsx(mb,{size:20})}),k.jsx("button",{onClick:Bt,className:"mobile-tool-button",disabled:P.current.length===0,"aria-label":"Redo",children:k.jsx(gb,{size:20})}),k.jsx("button",{onClick:Te,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(pb,{size:20})})]})]}):k.jsxs("div",{className:"annotation-sidebar",children:[k.jsxs("div",{className:"sidebar-header",children:[k.jsx("h2",{children:"Annotation Console"}),k.jsx("p",{children:"Mirror of student workspace"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsx("div",{className:"color-row",children:bm.map(wt=>k.jsx("button",{className:`color-button ${_===wt.value?"active":""}`,style:{background:wt.value},onClick:()=>C(wt.value),"aria-label":wt.label},wt.value))})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>m("pen"),className:`tool-icon-button ${g==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>m("eraser"),className:`tool-icon-button ${g==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsxs("div",{className:"brush-size-control",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:E,onChange:wt=>R(parseInt(wt.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:E})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${N==="all"?"all":""}`,onClick:ke,children:N==="stylus-only"?"Stylus only":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:pe,className:"history-button",disabled:U.current.length===0,children:"Undo"}),k.jsx("button",{onClick:Bt,className:"history-button",disabled:P.current.length===0,children:"Redo"}),k.jsx("button",{onClick:Te,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"annotation-canvas-panel",children:k.jsx("div",{className:"annotation-canvas-frame",ref:F,onTouchMove:wt=>wt.preventDefault(),onTouchStart:wt=>wt.preventDefault(),children:k.jsxs(Ng,{ref:W,width:nt.width,height:nt.height,onPointerDown:zt,onPointerMove:Wt,onPointerUp:It,onPointerLeave:It,onTouchStart:wt=>wt.preventDefault(),onTouchMove:wt=>wt.preventDefault(),onTouchEnd:wt=>wt.preventDefault(),className:"annotation-stage",perfectDrawEnabled:!1,children:[V&&k.jsx(Ir,{listening:!1,children:k.jsx(av,{image:w,x:V.x,y:V.y,width:V.width,height:V.height})}),k.jsx(Ir,{listening:!1,children:l.lines&&l.lines.map((wt,Yt)=>k.jsx(ho,{points:at(wt.points),stroke:wt.color||"black",strokeWidth:(wt.strokeWidth||3)*it.x,tension:.5,lineCap:"round",lineJoin:"round"},`student-${Yt}`))}),k.jsx(Ir,{children:B.map((wt,Yt)=>k.jsx(ho,{points:at(wt.points),stroke:wt.color,strokeWidth:Rt(wt),tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${Yt}`))})]})})})]})]})})})},Ab=async(l,t=800,n=600,a=.7)=>{console.log("📸 Processing image:",l.name,l.type,l.size,"bytes");let r,o,f;if(typeof createImageBitmap=="function")try{console.log("📸 Using createImageBitmap");const v=await createImageBitmap(l);o=v.width,f=v.height,r=v}catch(v){console.warn("📸 createImageBitmap failed, using fallback:",v),r=null}r||(console.log("📸 Using Image() fallback for iOS/Safari"),r=await new Promise((v,D)=>{const B=new Image,L=URL.createObjectURL(l);B.onload=()=>{URL.revokeObjectURL(L),v(B)},B.onerror=N=>{URL.revokeObjectURL(L),console.error("📸 Image load error:",N),D(new Error(`Failed to load image: ${l.name}. File may be corrupted or in unsupported format.`))},B.src=L}),o=r.naturalWidth||r.width,f=r.naturalHeight||r.height);const h=Math.min(t/o,n/f,1),g=Math.round(o*h),m=Math.round(f*h);console.log("📸 Resizing:",o,"x",f,"→",g,"x",m);const _=document.createElement("canvas");_.width=g,_.height=m;const C=_.getContext("2d");C.fillStyle="#FFFFFF",C.fillRect(0,0,g,m),C.drawImage(r,0,0,g,m);const E=await new Promise((v,D)=>{try{_.toBlob(B=>{B?(console.log("📸 Compressed to:",B.size,"bytes"),v(B)):(console.error("📸 Canvas toBlob returned null"),D(new Error("Failed to compress image. Canvas may be too large or device out of memory.")))},"image/jpeg",a)}catch(B){console.error("📸 Canvas toBlob error:",B),D(new Error(`Failed to compress image: ${B.message}`))}}),R=await new Promise((v,D)=>{const B=new FileReader;B.onload=()=>{console.log("📸 Data URL created, length:",B.result.length),v(B.result)},B.onerror=L=>{var N;console.error("📸 Failed to create data URL:",L,B.error),D(new Error(`Failed to create data URL: ${((N=B.error)==null?void 0:N.message)||"Unknown FileReader error"}`))},B.readAsDataURL(E)});return console.log("📸 ✅ Image processing complete"),{blob:E,dataUrl:R,width:g,height:m,size:E.size}},MT=()=>{const[l,t]=vd(),n=yf(),a=()=>{const Dt="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let jt="";for(let te=0;te<6;te++)jt+=Dt.charAt(Math.floor(Math.random()*Dt.length));return jt},[r,o]=st.useState(""),f=st.useRef(!1);st.useEffect(()=>{if(f.current)return;const Dt=l.get("room");if(Dt)o(Dt.toUpperCase());else{const jt=a();o(jt),t({room:jt},{replace:!0})}f.current=!0},[l,t]);const[h,g]=st.useState(null),[m,_]=st.useState("created"),[C,E]=st.useState(null),[R,v]=st.useState(null),[D,B]=st.useState(!1),[L]=st.useState(`teacher-${Math.random().toString(36).substring(7)}`),[N,M]=st.useState(()=>{const Dt=parseInt(l.get("bot"))||0,jt={};if(Dt>0)for(let te=1;te<=Dt;te++){const ae=`bot-student-${te}`;jt[ae]={studentId:ae,clientId:`bot-${te}`,name:`Bot ${te}`,lastUpdate:Date.now()-te*1e3,isActive:!0,isFlagged:!1}}return jt}),[G,O]=st.useState(null),[w,T]=st.useState({}),[y,z]=st.useState(""),[U,P]=st.useState("all"),[K,Q]=st.useState("all"),[X,Y]=st.useState(()=>{const Dt=localStorage.getItem("teacherDashboardHideNames");return Dt?JSON.parse(Dt):!1}),[j,I]=st.useState(()=>{const Dt=localStorage.getItem("teacherDashboardCardsPerRow");return Dt?parseInt(Dt):3}),[F,W]=st.useState("blank"),[nt,Z]=st.useState(null),[it,rt]=st.useState(null),[V,J]=st.useState(""),[$,at]=st.useState(!1),[ht,Rt]=st.useState(null),zt=st.useRef(null),Wt=st.useRef({}),It=st.useRef(null),pe=st.useRef(null),Bt=st.useRef(null),[Te,ze]=st.useState(!1),[Xe,ke]=st.useState(""),[hn,Un]=st.useState([]);st.useRef(!1);const wt=st.useRef({roomId:null,status:"idle"}),Yt=st.useRef(new Set),Fe=st.useRef(!1);st.useEffect(()=>{zt.current=ht},[ht]),st.useEffect(()=>{Wt.current=w},[w]);const Se=st.useRef(0),we=(Dt,jt="info")=>{const te=`${Date.now()}-${Se.current++}`;Un(ae=>[...ae,{id:te,message:Dt,type:jt}]),setTimeout(()=>{Un(ae=>ae.filter(Ft=>Ft.id!==te))},4e3)},$e=st.useCallback(async(Dt="teacher_ended")=>{if(!h||m!=="active"&&m!=="created")return!1;try{return await gu.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",h),R&&await R.publish("session-ended",{timestamp:Date.now(),reason:Dt}),_("ended"),It.current&&(clearTimeout(It.current),It.current=null),!0}catch(jt){return console.error("Error ending session:",jt),!1}},[h,m,R]);st.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(X))},[X]),st.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",j.toString())},[j]),st.useEffect(()=>{if(!r||(wt.current.roomId!==r&&(wt.current={roomId:r,status:"idle"}),wt.current.status==="in-progress"||wt.current.status==="done"))return;wt.current={roomId:r,status:"in-progress"};let Dt=!1;const jt=()=>{const ae=wt.current;!Dt&&ae.roomId===r&&(wt.current={roomId:r,status:"idle"})};return(async()=>{try{const{data:ae,error:Ft}=await gu.from("sessions").select("*").ilike("room_code",r).order("created_at",{ascending:!1}).limit(1);if(Ft){console.error("Failed to query sessions:",Ft),jt();return}let On=null;if(ae&&ae.length>0){const Xn=ae[0];if(Xn.status==="ended"){const{data:Pn,error:Ee}=await gu.from("sessions").update({status:"created",started_at:null,ended_at:null}).eq("id",Xn.id).select().single();if(Ee){console.error("Failed to update session:",Ee),jt();return}On=Pn}else On=Xn}else{const{data:Xn,error:Pn}=await gu.from("sessions").insert([{room_code:r,status:"created"}]).select().single();if(Pn)if(Pn.code==="23505"){const{data:Ee,error:ee}=await gu.from("sessions").select("*").ilike("room_code",r).order("created_at",{ascending:!1}).limit(1);if(ee){console.error("Failed to load existing session after duplicate key error:",ee),jt();return}if(Ee&&Ee.length>0)On=Ee[0];else{console.error("Duplicate key reported but no session found when refetching."),jt();return}}else{console.error("Failed to create session:",Pn),jt();return}else On=Xn}if(Dt)return;On?(g(On.id),_(On.status),Dt||(wt.current={roomId:r,status:"done"})):jt()}catch(ae){console.error("Error initializing session:",ae),jt()}})(),()=>{Dt=!0;const ae=wt.current;ae.roomId===r&&ae.status==="in-progress"&&(wt.current={roomId:r,status:"idle"})}},[r,L]),st.useEffect(()=>{if(!h||typeof window>"u")return;!D&&(m==="active"||m==="created")&&!It.current&&(console.log("⏱️ Teacher disconnected, starting 10-minute auto-logout timer"),It.current=window.setTimeout(async()=>{console.log("⏰ 10-minute timeout reached, automatically ending session"),await $e("teacher_timeout_10min")?console.log("✅ Session ended due to teacher inactivity"):console.warn("Auto-logout timer fired but session was already ended or unavailable"),It.current=null},600*1e3)),D&&It.current&&(console.log("✅ Teacher reconnected, cancelling auto-logout timer"),clearTimeout(It.current),It.current=null)},[D,h,m,$e]),st.useEffect(()=>()=>{It.current&&(clearTimeout(It.current),It.current=null)},[]),st.useEffect(()=>{if(Fe.current||!r||!L)return;Fe.current=!0;let Dt=null,jt=null;return(async()=>{try{const ae=`/api/token?clientId=${L}`,Ft=await fetch(ae),On=await Ft.text();if(!Ft.ok)throw new Error(`Token request failed (${Ft.status} ${Ft.statusText})${On?` – ${On}`:""}`);let Xn;try{Xn=JSON.parse(On)}catch(ee){throw new Error(`Token response was not valid JSON: ${ee.message}`)}Dt=new dv.Realtime({authCallback:async(ee,He)=>{He(null,Xn)},clientId:L}),Dt.connection.on("connected",()=>{B(!0),console.log("✅ Teacher connected to Ably")}),Dt.connection.on("disconnected",()=>{B(!1)}),Dt.connection.on("suspended",()=>{B(!1)}),Dt.connection.on("failed",()=>{B(!1)}),Dt.connection.on("closing",()=>{B(!1)}),Dt.connection.on("closed",()=>{B(!1)}),E(Dt),jt=Dt.channels.get(`room-${r}`),jt.presence.subscribe("enter",ee=>{var He,he;if(ee.clientId!==L&&ee.clientId.includes("student")){const Ne=((He=ee.data)==null?void 0:He.name)||Ae(ee.clientId),Ue=ee.clientId,rn=(he=ee.data)==null?void 0:he.studentId;if(!rn){console.warn("⚠️ Student joined without persistent studentId:",Ue);return}M(ia=>{var Es,ki;const mi=ia[rn];return mi?(console.log("🔄 Student reconnected:",mi.clientId,"→",Ue,"(",Ne,")"),(G==null?void 0:G.studentId)===rn&&O({...mi,clientId:Ue}),{...ia,[rn]:{...mi,clientId:Ue,name:Ne,isActive:!0,isVisible:((Es=ee.data)==null?void 0:Es.isVisible)!==!1,lastUpdate:Date.now()}}):(Yt.current.has(rn)||(Yt.current.add(rn),we(`${Ne} joined`,"success")),{...ia,[rn]:{studentId:rn,clientId:Ue,name:Ne,isActive:!0,isVisible:((ki=ee.data)==null?void 0:ki.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:!1}})}),setTimeout(()=>{var mi;const ia=((mi=Wt.current)==null?void 0:mi[rn])||[];jt.publish("sync-full-state",{targetClientId:Ue,content:zt.current||null,annotations:ia,timestamp:Date.now()}),ia.length>0&&console.log("📤 Sent",ia.length,"teacher annotations to",Ne)},300)}}),jt.presence.subscribe("leave",ee=>{var He;if(ee.clientId!==L&&ee.clientId.includes("student")){const he=(He=ee.data)==null?void 0:He.studentId;M(Ne=>{const Ue=he?Ne[he]:null;if(!Ue)return Ne;const rn=(Ue==null?void 0:Ue.name)||Ae(ee.clientId);Yt.current.has(he)&&we(`${rn} left`,"info");const{[he]:ia,...mi}=Ne;return mi})}}),jt.subscribe("student-visibility",ee=>{const{studentId:He,studentName:he,isVisible:Ne}=ee.data;He&&M(Ue=>{const rn=Ue[He];if(!rn)return Ue;const ia=rn.isVisible===!1;return Ne?ia&&we(`✓ ${he} returned`,"success"):we(`⚠️ ${he} switched away`,"warning"),{...Ue,[He]:{...rn,isVisible:Ne,lastVisibilityChange:Date.now()}}})}),jt.subscribe("student-layer",ee=>{const{lines:He,studentId:he,clientId:Ne}=ee.data;M(Ue=>{const rn=he||Object.keys(Ue).find(ia=>Ue[ia].clientId===Ne);return rn?(console.log("✅ Updating student",rn,"with",(He||[]).length,"lines"),{...Ue,[rn]:{...Ue[rn],lines:He||[]}}):(console.warn("⚠️ Student not found for stroke update. studentId:",he,"clientId:",Ne),console.warn("Available students:",Object.keys(Ue)),Ue)})}),jt.subscribe("teacher-image",ee=>{Rt(ee.data)}),jt.subscribe("request-current-state",ee=>{var he;const He=(he=ee.data)==null?void 0:he.studentId;setTimeout(()=>{var Ue;const Ne=((Ue=Wt.current)==null?void 0:Ue[He])||[];jt.publish("sync-full-state",{targetClientId:ee.clientId,content:zt.current||null,annotations:Ne,timestamp:Date.now()})},100)}),await jt.presence.enter({role:"teacher",timestamp:Date.now()});const Pn=await jt.presence.get(),Ee={...N};Pn.forEach(ee=>{var He,he,Ne;if(ee.clientId!==L&&ee.clientId.includes("student")){const Ue=((He=ee.data)==null?void 0:He.name)||Ae(ee.clientId),rn=(he=ee.data)==null?void 0:he.studentId;if(!rn){console.warn("⚠️ Student in presence without studentId:",ee.clientId);return}const ia=N[rn]||{};Ee[rn]={...ia,studentId:rn,clientId:ee.clientId,name:Ue,isActive:!0,isVisible:((Ne=ee.data)==null?void 0:Ne.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:ia.isFlagged||!1}}}),M(Ee),v(jt)}catch(ae){console.error("Failed to connect to Ably:",ae)}})(),()=>{jt&&(jt.unsubscribe(),jt.presence.unsubscribe()),Dt&&Dt.close()}},[r,L]);const Ae=Dt=>{const jt=Dt.match(/student-(\d+)/)||Dt.match(/student-([\w]+)/);return jt?`Student ${jt[1]}`:Dt},ct=Dt=>{O(N[Dt.studentId]||Dt)},At=()=>{O(null)},xt=async Dt=>{if(!G||!R)return;const jt=G.studentId,te=G.clientId;if(!jt){console.error("❌ Student has no persistent studentId, cannot save annotation");return}T(ae=>({...ae,[jt]:Dt})),R.publish("teacher-annotation",{targetStudentId:te,annotations:Dt,teacherId:L,timestamp:Date.now()})},kt=Dt=>{M(jt=>{const te=jt[Dt];return te?{...jt,[Dt]:{...te,isFlagged:!te.isFlagged}}:jt}),O(jt=>jt&&jt.studentId===Dt?{...jt,isFlagged:!jt.isFlagged}:jt)},le=()=>{pe.current&&(pe.current.value="",pe.current.click())},Lt=async Dt=>{var Ft,On,Xn,Pn,Ee;const jt=(Ft=Dt.target.files)==null?void 0:Ft[0];if(!jt){J("No file selected.");return}const te=(jt.size/(1024*1024)).toFixed(2);if(console.log("📸 File selected:",{name:jt.name,type:jt.type,size:`${te}MB (${jt.size} bytes)`,lastModified:new Date(jt.lastModified).toISOString()}),!jt.type.startsWith("image/")){const ee=`❌ Invalid file type: ${jt.type||"unknown"}. Please select an image file (JPG, PNG, etc.)`;J(ee),console.error(ee),we("Invalid file type","error");return}const ae=25;if(jt.size>ae*1024*1024){const ee=`❌ File too large: ${te}MB. Maximum size is ${ae}MB.`;J(ee),console.error(ee),we("File too large","error");return}at(!0),J(`Processing ${jt.name} (${te}MB)...`);try{const{dataUrl:ee,width:He,height:he,size:Ne}=await Ab(jt),Ue={dataUrl:ee,width:He,height:he,filename:jt.name,timestamp:Date.now()};rt(Ue),J(`✅ Image ready (${He}×${he}, ${Math.round(Ne/1024)}KB)`),console.log("✅ Image processed successfully")}catch(ee){const He={fileName:jt.name,fileType:jt.type,fileSize:`${te}MB`,errorMessage:ee.message||"Unknown error",errorStack:ee.stack};console.error("❌ [TEACHER] Image upload failed:",He);let he=`❌ Upload failed: ${ee.message||"Unknown error"}
`;he+=`File: ${jt.name} (${jt.type})
`,he+=`Size: ${te}MB
`,(On=ee.message)!=null&&On.includes("load")?he+="Error loading image. The file may be corrupted or in an unsupported format.":(Xn=ee.message)!=null&&Xn.includes("compress")?he+="Error compressing image. Try a different image or smaller file.":(Pn=ee.message)!=null&&Pn.includes("memory")||(Ee=ee.message)!=null&&Ee.includes("allocation")?he+="Image too large for device memory. Try a smaller image.":he+="Try a different image or format (JPG/PNG recommended).",J(he),we(`Upload failed: ${ee.message}`,"error")}finally{at(!1)}},vt=()=>{rt(null),J(""),pe.current&&(pe.current.value="")},gt=Dt=>{const jt=document.createElement("canvas"),te=800,ae=600;jt.width=te,jt.height=ae;const Ft=jt.getContext("2d");if(Ft.fillStyle="#FFFFFF",Ft.fillRect(0,0,te,ae),Dt==="hanzi"){const Pn=(te-450)/2,Ee=(ae-450)/2;Ft.strokeStyle="#0F9D83",Ft.lineWidth=4,Ft.strokeRect(Pn,Ee,450,450),Ft.strokeStyle="#B0E8D8",Ft.lineWidth=2,Ft.setLineDash([8,8]),Ft.beginPath(),Ft.moveTo(te/2,Ee),Ft.lineTo(te/2,Ee+450),Ft.stroke(),Ft.beginPath(),Ft.moveTo(Pn,ae/2),Ft.lineTo(Pn+450,ae/2),Ft.stroke()}else if(Dt==="graph-corner"){Ft.strokeStyle="#E0E0E0",Ft.lineWidth=1,Ft.setLineDash([]);for(let Ee=80;Ee<=te-80;Ee+=40)Ft.beginPath(),Ft.moveTo(Ee,80),Ft.lineTo(Ee,ae-80),Ft.stroke();for(let Ee=80;Ee<=ae-80;Ee+=40)Ft.beginPath(),Ft.moveTo(80,Ee),Ft.lineTo(te-80,Ee),Ft.stroke();Ft.strokeStyle="#5B9BD5",Ft.lineWidth=3,Ft.beginPath(),Ft.moveTo(80,ae-80),Ft.lineTo(te-80,ae-80),Ft.stroke(),Ft.beginPath(),Ft.moveTo(80,80),Ft.lineTo(80,ae-80),Ft.stroke()}else if(Dt==="graph-cross"){Ft.strokeStyle="#E0E0E0",Ft.lineWidth=1,Ft.setLineDash([]);for(let Ee=80;Ee<=te-80;Ee+=40)Ft.beginPath(),Ft.moveTo(Ee,80),Ft.lineTo(Ee,ae-80),Ft.stroke();for(let Ee=80;Ee<=ae-80;Ee+=40)Ft.beginPath(),Ft.moveTo(80,Ee),Ft.lineTo(te-80,Ee),Ft.stroke();Ft.strokeStyle="#5B9BD5",Ft.lineWidth=3,Ft.beginPath(),Ft.moveTo(80,ae/2),Ft.lineTo(te-80,ae/2),Ft.stroke(),Ft.beginPath(),Ft.moveTo(te/2,80),Ft.lineTo(te/2,ae-80),Ft.stroke()}const On=jt.toDataURL("image/png");return{type:Dt,dataUrl:On,width:te,height:ae,timestamp:Date.now()}},Jt=Dt=>{const jt=gt(Dt);Z(jt),J(`Template ready: ${Dt}`)},se=async()=>{if(!R||!h||!D){console.error("Cannot send: channel or sessionId missing",{channel:!!R,sessionId:h,isConnected:D}),J("Error: Not connected properly. Please refresh the page."),we("Failed to send: Connection issue","error");return}if(V.includes("sending")){console.log("Already sending, ignoring duplicate click");return}J("Sending to class...");try{if(m==="created"){const{error:te}=await gu.from("sessions").update({status:"active",started_at:new Date().toISOString()}).eq("id",h);if(te){console.error("Failed to start session:",te),J("Failed to start session. Please try again.");return}_("active"),await R.publish("session-started",{timestamp:Date.now(),sessionId:h})}let jt=null;F==="templates"&&nt?jt=nt:F==="image"&&it&&(jt=it),await R.publish("clear-all-drawings",{timestamp:Date.now(),content:jt}),M(te=>{const ae={};return Object.keys(te).forEach(Ft=>{ae[Ft]={...te[Ft],lines:[]}}),ae}),T({}),F==="blank"?(Rt(null),Z(null),J("Blank canvas sent to all students.")):F==="templates"&&nt?(Rt(nt),J("Template sent to all students.")):F==="image"&&it&&(Rt(it),J("Image sent to all students.")),we("Content sent!","success")}catch(Dt){console.error("Failed to send to class:",Dt),J("Failed to send. Please try again."),we("Failed to send content","error")}},Kt=async()=>{window.confirm(`Are you sure you want to end this session?

All students will be logged out and the session will be closed.`)&&(await $e("teacher_ended"),C&&C.close(),n("/"))},Ce=async()=>{const Dt=`${window.location.origin}/student?room=${r}`;try{const jt=await _b.toDataURL(Dt,{width:300,margin:2,color:{dark:"#0F172A",light:"#FFFFFF"}});ke(jt),ze(!0)}catch(jt){console.error("Failed to generate QR code:",jt)}},fe=async()=>{const Dt=`${window.location.origin}/student?room=${r}`,jt=()=>{we("Link copied to clipboard!","success")};if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(Dt),jt();return}catch(te){console.error("Clipboard API failed:",te)}try{const te=Bt.current;if(te&&(te.select(),te.setSelectionRange(0,Dt.length),document.execCommand("copy"))){jt(),window.getSelection().removeAllRanges();return}throw new Error("execCommand failed")}catch(te){console.error("Fallback copy failed:",te),Bt.current&&Bt.current.select(),we("Select the link and press ⌘C/CTRL+C to copy","warning")}},_e=()=>Object.values(N).sort((Dt,jt)=>{const te=(Dt.name||Dt.clientId||"").toLowerCase(),ae=(jt.name||jt.clientId||"").toLowerCase();return te.localeCompare(ae)}),Pe=()=>{const Dt=_e(),jt=y.trim().toLowerCase();return Dt.filter(te=>{const ae=jt?(te.name||te.studentId).toLowerCase().includes(jt):!0,Ft=U==="all"||U==="flagged"&&te.isFlagged,On=K==="all"||K==="distracted"&&te.isVisible===!1&&te.isActive;return ae&&Ft&&On})},En=_e(),Aa=Pe(),pi=En.filter(Dt=>Dt.isActive).length,Na=G?N[G.studentId]||G:null,_s=V?!/fail|no file/i.test(V):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:hn.map(Dt=>k.jsxs("div",{className:`toast toast-${Dt.type}`,children:[Dt.type==="success"&&k.jsx("span",{className:"toast-icon",children:"✓"}),Dt.type==="info"&&k.jsx("span",{className:"toast-icon",children:"ℹ"}),Dt.type==="error"&&k.jsx("span",{className:"toast-icon",children:"✕"}),k.jsx("span",{className:"toast-message",children:Dt.message})]},Dt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsxs("div",{className:"feather-branding",onClick:()=>window.location.reload(),style:{cursor:"pointer"},children:[k.jsx(XC,{size:32,strokeWidth:2}),k.jsx("span",{className:"feather-text",children:"Feather"})]}),k.jsx("section",{className:"hero-card glass-panel",children:k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"Teacher dashboard"}),k.jsx("h1",{children:"Monitor and annotate student canvases live"}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code to invite students. Their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:Ce,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:r})]}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Session live"}),k.jsx("span",{className:`status-pill connection-pill ${D?"online":"offline"}`,children:D?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:pi}),k.jsx("span",{children:"online"})]})]}),k.jsx("button",{className:"end-session-btn",onClick:Kt,title:"End session and logout all students",children:"End Session"})]})]})}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),nt&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",nt.type==="hanzi"?"Hanzi":nt.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:se,disabled:F==="image"&&!it,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${F==="blank"?"active":""}`,onClick:()=>{W("blank"),Z(null),rt(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${F==="templates"?"active":""}`,onClick:()=>{W("templates"),rt(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${F==="image"?"active":""} ${it?"ready":""}`,onClick:()=>{W("image"),Z(null)},disabled:$,children:$?"Uploading…":"Send image"})]}),k.jsx("input",{ref:pe,type:"file",accept:"image/*",onChange:Lt,style:{display:"none"}}),F==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(nt==null?void 0:nt.type)==="hanzi"?"active":""}`,onClick:()=>Jt("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(nt==null?void 0:nt.type)==="graph-corner"?"active":""}`,onClick:()=>Jt("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(nt==null?void 0:nt.type)==="graph-cross"?"active":""}`,onClick:()=>Jt("graph-cross"),children:"Graph (cross)"})]}),nt&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:nt.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),F==="image"&&k.jsx(k.Fragment,{children:it?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:it.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:it.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:it.width&&it.height?`${Math.round(it.width)} × ${Math.round(it.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:le,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:vt,children:"Clear"})]}),V&&k.jsx("span",{className:`image-message ${_s?"success":"error"}`,children:V})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:le,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),V&&k.jsx("span",{className:`image-message ${_s?"success":"error"}`,children:V})]})}),F==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"controls-section glass-panel",children:k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:"🔍"}),k.jsx("input",{type:"text",placeholder:"Filter students",value:y,onChange:Dt=>z(Dt.target.value),className:"search-input"}),y&&k.jsx("button",{className:"clear-search-btn",onClick:()=>z(""),title:"Clear search",children:"✕"})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:X,onChange:Dt=>Y(Dt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${U==="flagged"?"active":""}`,onClick:()=>P(Dt=>Dt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${K==="distracted"?"active":""}`,onClick:()=>Q(Dt=>Dt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:"⚠️ Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:j,onChange:Dt=>I(Number(Dt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:En.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),k.jsx("h2",{children:"Waiting for students to join…"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):Aa.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:"🔍"}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',y,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>z(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${j}, 1fr)`},children:Aa.filter(Dt=>Dt&&Dt.studentId&&Dt.clientId).map(Dt=>k.jsx(Cb,{student:Dt,onClick:ct,onToggleFlag:kt,teacherAnnotations:w[Dt.studentId]||[],sharedImage:ht,hideNames:X},Dt.studentId))})})})]}),k.jsx(Tb,{student:Na,isOpen:!!Na,isFlagged:Na==null?void 0:Na.isFlagged,onToggleFlag:kt,onClose:At,onAnnotate:xt,existingAnnotations:Na?w[Na.studentId]||[]:[],sharedImage:ht}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:["💡 ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),Te&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>ze(!1),children:k.jsxs("div",{className:"qr-modal",onClick:Dt=>Dt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",r]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>ze(!1),children:"✕"})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:Xe&&k.jsx("img",{src:Xe,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:Bt,type:"text",value:`${window.location.origin}/student?room=${r}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:fe,children:"Copy Link"})]})]})]})]})})]})},S2={width:800,height:600};function NT(){const[l]=vd(),t=l.get("room")||"load-test",n=l.get("name")||`TestStudent-${Date.now()}`,[a,r]=st.useState(null),[o]=st.useState(`test-student-${Math.random().toString(36).substr(2,9)}`),[f,h]=st.useState(!1),[g,m]=st.useState([]),[_,C]=st.useState([]),[E,R]=st.useState("pen"),[v,D]=st.useState(!1),B=st.useRef(!1);st.useEffect(()=>{(async()=>{try{const w=new yS.Realtime({authUrl:"/api/token",authParams:{clientId:o}});w.connection.on("connected",()=>{console.log("Connected to Ably"),h(!0)}),w.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),h(!1)});const T=w.channels.get(`room-${t}`);await new Promise((z,U)=>{T.once("attached",z),T.once("failed",U),T.attach()}),console.log("✅ Test Student channel attached");const y={name:n,role:"student",testMode:!0};console.log("📍 Entering presence with data:",y),await T.presence.enter(y),console.log("✅ Test Student entered presence as:",n),T.subscribe("student-layer",z=>{B.current=!0;const U=z.data;U.action==="clear"?m([]):U.lines&&m(P=>[...P,...U.lines]),setTimeout(()=>{B.current=!1},0)}),T.subscribe("teacher-layer",z=>{const U=z.data;U.action==="clear"?C([]):U.lines&&C(P=>[...P,...U.lines])}),r(T)}catch(w){console.error("Failed to initialize Ably:",w)}})()},[o,t,n]);const L=O=>{const w=O.target.getStage().getPointerPosition();if(!w)return;D(!0);const T={tool:E,points:[w.x,w.y],color:"black",strokeWidth:3};m([...g,T])},N=O=>{if(!v)return;const T=O.target.getStage().getPointerPosition();if(!T)return;const y=g[g.length-1];y&&(y.points=y.points.concat([T.x,T.y]),m([...g.slice(0,-1),y]))},M=()=>{if(!v||!a){D(!1);return}D(!1);const O=g[g.length-1];O&&O.points.length>=4&&a.publish("student-layer",{lines:[O]})},G=()=>{m([]),a&&a.publish("student-layer",{action:"clear"})};return k.jsxs("div",{className:"student-container",children:[k.jsxs("div",{className:"student-header",children:[k.jsxs("div",{className:"student-info",children:[k.jsx("span",{className:"student-name",children:n}),k.jsxs("span",{className:"room-code",children:["Room: ",t]}),k.jsx("span",{className:`connection-status ${f?"connected":"disconnected"}`,children:f?"● Connected":"○ Disconnected"})]}),k.jsx("div",{className:"test-badge",children:"TEST MODE"})]}),k.jsxs("div",{className:"toolbar",children:[k.jsx("button",{className:`tool-btn ${E==="pen"?"active":""}`,onClick:()=>R("pen"),title:"Pen",children:"✏️ Pen"}),k.jsx("button",{className:`tool-btn ${E==="eraser"?"active":""}`,onClick:()=>R("eraser"),title:"Eraser",children:"🧹 Eraser"}),k.jsx("button",{className:"tool-btn",onClick:G,title:"Clear Canvas",children:"🗑️ Clear"})]}),k.jsx("div",{className:"canvas-container",children:k.jsxs(Ng,{width:S2.width,height:S2.height,onMouseDown:L,onMousemove:N,onMouseup:M,onTouchStart:L,onTouchMove:N,onTouchEnd:M,className:"konva-stage",children:[k.jsx(Ir,{children:g.map((O,w)=>k.jsx(ho,{points:O.points,stroke:O.tool==="eraser"?"white":O.color,strokeWidth:O.tool==="eraser"?20:O.strokeWidth,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:O.tool==="eraser"?"destination-out":"source-over"},`student-${w}`))}),k.jsx(Ir,{listening:!1,children:_.map((O,w)=>k.jsx(ho,{points:O.points,stroke:"red",strokeWidth:O.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round",opacity:.7},`teacher-${w}`))})]})}),k.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",background:"#f0f0f0",padding:"10px",borderRadius:"8px",fontSize:"12px"},children:[k.jsx("div",{children:k.jsx("strong",{children:"Test Mode Instructions:"})}),k.jsx("div",{children:"• No login required"}),k.jsx("div",{children:"• Draw on canvas to test"}),k.jsx("div",{children:"• Red lines are from teacher"})]})]})}const DT=()=>{const[l]=vd(),t=yf(),n=()=>{const Lt=l.get("room");return Lt?Lt.toUpperCase():"load-test".toUpperCase()},[a]=ta.useState(n),[r,o]=st.useState(null),[f,h]=st.useState(null),[g,m]=st.useState(!1),[_]=st.useState(`test-teacher-${Math.random().toString(36).substring(7)}`),[C,E]=st.useState({}),[R,v]=st.useState(null),[D,B]=st.useState({}),[L,N]=st.useState(""),[M,G]=st.useState("all"),[O,w]=st.useState("all"),[T,y]=st.useState(()=>{const Lt=localStorage.getItem("teacherDashboardHideNames");return Lt?JSON.parse(Lt):!1}),[z,U]=st.useState(()=>{const Lt=localStorage.getItem("teacherDashboardCardsPerRow");return Lt?parseInt(Lt):3}),[P,K]=st.useState("blank"),[Q,X]=st.useState(null),[Y,j]=st.useState(null),[I,F]=st.useState(""),[W,nt]=st.useState(!1),[Z,it]=st.useState(null),rt=st.useRef(null),V=st.useRef(null),J=st.useRef(null),[$,at]=st.useState(!1),[ht,Rt]=st.useState(""),[zt,Wt]=st.useState([]);st.useRef(!1),st.useEffect(()=>{rt.current=Z},[Z]);const It=(Lt,vt="info")=>{const gt=Date.now();Wt(Jt=>[...Jt,{id:gt,message:Lt,type:vt}]),setTimeout(()=>{Wt(Jt=>Jt.filter(se=>se.id!==gt))},4e3)};st.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(T))},[T]),st.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",z.toString())},[z]),st.useEffect(()=>((async()=>{try{const vt=new dv.Realtime({authUrl:"/api/token",authParams:{clientId:_}});vt.connection.on("connected",()=>{console.log("✅ Test Teacher connected to Ably"),m(!0)}),vt.connection.on("disconnected",()=>{console.log("❌ Test Teacher disconnected"),m(!1)});const gt=vt.channels.get(`room-${a}`);await new Promise((Kt,Ce)=>{gt.once("attached",Kt),gt.once("failed",Ce),gt.attach()}),console.log("✅ Channel attached"),gt.presence.subscribe("enter",Kt=>{var Ce,fe;console.log("👤 Member entered:",Kt.clientId,"Role:",(Ce=Kt.data)==null?void 0:Ce.role,"Data:",Kt.data),((fe=Kt.data)==null?void 0:fe.role)==="student"&&(console.log("✅ Adding student to dashboard:",Kt.data.name||Kt.clientId),E(_e=>({..._e,[Kt.clientId]:{clientId:Kt.clientId,name:Kt.data.name||Kt.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,testMode:Kt.data.testMode||!1,meta:{base:{width:800,height:600}}}})))}),gt.presence.subscribe("leave",Kt=>{console.log("👋 Student left:",Kt.clientId),E(Ce=>{const fe={...Ce};return fe[Kt.clientId]&&(fe[Kt.clientId].isActive=!1),fe})}),gt.presence.subscribe("update",Kt=>{var Ce;((Ce=Kt.data)==null?void 0:Ce.isVisible)!==void 0&&E(fe=>{const _e={...fe};return _e[Kt.clientId]&&(_e[Kt.clientId].isVisible=Kt.data.isVisible),_e})});const Jt=await gt.presence.get();console.log(`📋 Found ${Jt.length} members in presence`);const se={};Jt.forEach(Kt=>{var Ce,fe,_e,Pe,En;console.log("  - Member:",Kt.clientId,"Role:",(Ce=Kt.data)==null?void 0:Ce.role,"Name:",(fe=Kt.data)==null?void 0:fe.name),((_e=Kt.data)==null?void 0:_e.role)==="student"&&(console.log("    ✅ Adding existing student:",Kt.data.name||Kt.clientId),se[Kt.clientId]={clientId:Kt.clientId,name:Kt.data.name||Kt.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:((Pe=Kt.data)==null?void 0:Pe.isVisible)!==!1,testMode:((En=Kt.data)==null?void 0:En.testMode)||!1,meta:{base:{width:800,height:600}}})}),console.log(`✅ Initialized with ${Object.keys(se).length} students`),E(se),gt.subscribe("student-layer",Kt=>{const{clientId:Ce}=Kt,fe=Kt.data;E(_e=>{const Pe={..._e};return Pe[Ce]||(Pe[Ce]={clientId:Ce,name:Ce,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,meta:{base:{width:800,height:600}}}),fe.action==="clear"?Pe[Ce].lines=[]:fe.lines&&(Pe[Ce].lines=[...Pe[Ce].lines,...fe.lines]),Pe[Ce].lastUpdate=Date.now(),Pe})}),await gt.presence.enter({role:"teacher",name:"Test Teacher",testMode:!0}),o(vt),h(gt)}catch(vt){console.error("Failed to connect to Ably:",vt)}})(),()=>{f&&f.presence.leave(),r&&r.close()}),[a,_]),st.useEffect(()=>{if($){const Lt=`${window.location.origin}/test/student?room=${a}`;_b.toDataURL(Lt,{width:300,margin:2}).then(vt=>Rt(vt)).catch(vt=>console.error("Failed to generate QR code:",vt))}},[$,a]);const pe=()=>{t("/")},Bt=()=>{at(!0)},Te=()=>{f&&(f.publish("session-ended",{timestamp:Date.now(),reason:"teacher_ended"}),It("Session ended","success"))},ze=Lt=>{v(C[Lt.clientId]||Lt)},Xe=()=>{v(null)},ke=Lt=>{if(!R||!f)return;const vt=R.clientId;B(gt=>({...gt,[vt]:Lt})),f.publish("teacher-annotation",{targetStudentId:vt,annotations:Lt,teacherId:_,timestamp:Date.now()}),console.log("📤 Published annotations for",vt)},hn=Lt=>{E(vt=>{const gt=vt[Lt];return gt?{...vt,[Lt]:{...gt,isFlagged:!gt.isFlagged}}:vt}),v(vt=>vt&&vt.clientId===Lt?{...vt,isFlagged:!vt.isFlagged}:vt)},Un=Lt=>{const vt=document.createElement("canvas");vt.width=800,vt.height=600;const gt=vt.getContext("2d");if(gt.fillStyle="white",gt.fillRect(0,0,800,600),gt.strokeStyle="#ddd",gt.lineWidth=1,Lt==="hanzi")gt.strokeRect(250,150,300,300),gt.beginPath(),gt.moveTo(400,150),gt.lineTo(400,450),gt.moveTo(250,300),gt.lineTo(550,300),gt.stroke();else if(Lt==="graph-corner"){gt.beginPath(),gt.moveTo(100,500),gt.lineTo(100,100),gt.lineTo(700,100),gt.stroke();for(let se=1;se<10;se++){const Kt=100+se*60;gt.beginPath(),gt.moveTo(Kt,100),gt.lineTo(Kt,500),gt.stroke()}for(let se=1;se<8;se++){const Kt=100+se*50;gt.beginPath(),gt.moveTo(100,Kt),gt.lineTo(700,Kt),gt.stroke()}}else if(Lt==="graph-cross"){gt.beginPath(),gt.moveTo(50,300),gt.lineTo(750,300),gt.moveTo(400,50),gt.lineTo(400,550),gt.stroke();for(let se=-6;se<=6;se++){if(se===0)continue;const Kt=400+se*50;gt.beginPath(),gt.moveTo(Kt,50),gt.lineTo(Kt,550),gt.stroke()}for(let se=-5;se<=5;se++){if(se===0)continue;const Kt=300+se*50;gt.beginPath(),gt.moveTo(50,Kt),gt.lineTo(750,Kt),gt.stroke()}}const Jt=vt.toDataURL("image/png");X({type:Lt,dataUrl:Jt,width:800,height:600})},wt=()=>{V.current&&(V.current.value="",V.current.click())},Yt=async Lt=>{var gt;const vt=(gt=Lt.target.files)==null?void 0:gt[0];if(!vt){F("No file selected.");return}nt(!0),F("");try{const{dataUrl:Jt,width:se,height:Kt}=await Ab(vt),Ce={dataUrl:Jt,width:se,height:Kt,filename:vt.name,timestamp:Date.now()};j(Ce),F("Image ready to send.")}catch(Jt){console.error("Failed to upload image:",Jt),F("Upload failed. Please try again.")}finally{nt(!1)}},Fe=()=>{j(null),F("")},Se=()=>{if(!f)return;let Lt=null;P==="templates"&&Q?Lt=Q:P==="image"&&Y&&(Lt=Y),f.publish("teacher-action",{action:"send-blank-canvas",questionNumber:1,sharedImage:Lt,timestamp:Date.now()}),it(Lt||null),It("Sent to all students","success"),console.log("📄 Sent to class:",P)},we=async()=>{const Lt=`${window.location.origin}/test/student?room=${a}`;try{await navigator.clipboard.writeText(Lt),It("Link copied to clipboard","success")}catch(vt){console.error("Clipboard API failed:",vt);try{J.current&&(J.current.select(),document.execCommand("copy"),It("Link copied to clipboard","success"))}catch(gt){console.error("Fallback copy failed:",gt),J.current&&J.current.select(),alert("Please copy the selected link manually")}}},$e=()=>Object.values(C).sort((Lt,vt)=>Lt.isActive&&!vt.isActive?-1:!Lt.isActive&&vt.isActive?1:(vt.lastUpdate||0)-(Lt.lastUpdate||0)),Ae=()=>{const Lt=$e(),vt=L.trim().toLowerCase();return Lt.filter(gt=>{const Jt=vt?(gt.name||gt.clientId).toLowerCase().includes(vt):!0,se=M==="all"||M==="flagged"&&gt.isFlagged,Kt=O==="all"||O==="distracted"&&gt.isVisible===!1&&gt.isActive;return Jt&&se&&Kt})},ct=$e(),At=Ae(),xt=ct.filter(Lt=>Lt.isActive).length,kt=R?C[R.clientId]||R:null,le=I?!/fail|no file/i.test(I):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:zt.map(Lt=>k.jsxs("div",{className:`toast toast-${Lt.type}`,children:[Lt.type==="success"&&k.jsx("span",{className:"toast-icon",children:"✓"}),Lt.type==="info"&&k.jsx("span",{className:"toast-icon",children:"ℹ"}),Lt.type==="error"&&k.jsx("span",{className:"toast-icon",children:"✕"}),k.jsx("span",{className:"toast-message",children:Lt.message})]},Lt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsx("button",{className:"back-link",onClick:pe,children:"← Exit class"}),k.jsxs("section",{className:"hero-card glass-panel",children:[k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"🧪 Test Teacher dashboard"}),k.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:Bt,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:a})]}),k.jsx("button",{className:"end-session-btn",onClick:Te,title:"End session and logout all students",children:"End Session"}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Test mode"}),k.jsx("span",{className:`status-pill connection-pill ${g?"online":"offline"}`,children:g?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:xt}),k.jsx("span",{children:"online"})]})]})]})]}),k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:"🔍"}),k.jsx("input",{type:"text",placeholder:"Filter students",value:L,onChange:Lt=>N(Lt.target.value),className:"search-input"}),L&&k.jsx("button",{className:"clear-search-btn",onClick:()=>N(""),title:"Clear search",children:"✕"})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:T,onChange:Lt=>y(Lt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${M==="flagged"?"active":""}`,onClick:()=>G(Lt=>Lt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${O==="distracted"?"active":""}`,onClick:()=>w(Lt=>Lt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:"⚠️ Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:z,onChange:Lt=>U(Number(Lt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})]}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),Q&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",Q.type==="hanzi"?"Hanzi":Q.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:Se,disabled:P==="image"&&!Y,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${P==="blank"?"active":""}`,onClick:()=>{K("blank"),X(null),j(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${P==="templates"?"active":""}`,onClick:()=>{K("templates"),j(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${P==="image"?"active":""} ${Y?"ready":""}`,onClick:()=>{K("image"),X(null)},disabled:W,children:W?"Uploading…":"Send image"})]}),k.jsx("input",{ref:V,type:"file",accept:"image/*",onChange:Yt,style:{display:"none"}}),P==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="hanzi"?"active":""}`,onClick:()=>Un("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="graph-corner"?"active":""}`,onClick:()=>Un("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="graph-cross"?"active":""}`,onClick:()=>Un("graph-cross"),children:"Graph (cross)"})]}),Q&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:Q.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),P==="image"&&k.jsx(k.Fragment,{children:Y?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:Y.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:Y.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:Y.width&&Y.height?`${Math.round(Y.width)} × ${Math.round(Y.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:wt,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:Fe,children:"Clear"})]}),I&&k.jsx("span",{className:`image-message ${le?"success":"error"}`,children:I})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:wt,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),I&&k.jsx("span",{className:`image-message ${le?"success":"error"}`,children:I})]})}),P==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:ct.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),k.jsx("h2",{children:"Waiting for students to join…"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):At.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:"🔍"}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',L,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>N(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${z}, 1fr)`},children:At.filter(Lt=>Lt&&Lt.clientId).map(Lt=>k.jsx(Cb,{student:Lt,onClick:ze,onToggleFlag:hn,teacherAnnotations:D[Lt.clientId]||[],sharedImage:Z,hideNames:T},Lt.clientId))})})})]}),k.jsx(Tb,{student:kt,isOpen:!!kt,isFlagged:kt==null?void 0:kt.isFlagged,onToggleFlag:hn,onClose:Xe,onAnnotate:ke,existingAnnotations:kt?D[kt.clientId]||[]:[],sharedImage:Z}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:["💡 ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),$&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>at(!1),children:k.jsxs("div",{className:"qr-modal",onClick:Lt=>Lt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",a]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>at(!1),children:"✕"})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:ht&&k.jsx("img",{src:ht,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:J,type:"text",value:`${window.location.origin}/test/student?room=${a}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:we,children:"Copy Link"})]})]})]})]})})]})};function jT(){return k.jsx(S3,{children:k.jsxs(p3,{children:[k.jsx(hu,{path:"/",element:k.jsx(b3,{})}),k.jsx(hu,{path:"/student-login",element:k.jsx(iT,{})}),k.jsx(hu,{path:"/student",element:k.jsx(aT,{})}),k.jsx(hu,{path:"/teacher",element:k.jsx(MT,{})}),k.jsx(hu,{path:"/test/student",element:k.jsx(NT,{})}),k.jsx(hu,{path:"/test/teacher",element:k.jsx(DT,{})})]})})}C4.createRoot(document.getElementById("root")).render(k.jsx(ta.StrictMode,{children:k.jsx(jT,{})}));
