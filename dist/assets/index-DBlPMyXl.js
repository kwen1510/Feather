function E4(o,t){for(var n=0;n<t.length;n++){const a=t[n];if(typeof a!="string"&&!Array.isArray(a)){for(const r in a)if(r!=="default"&&!(r in o)){const l=Object.getOwnPropertyDescriptor(a,r);l&&Object.defineProperty(o,r,l.get?l:{enumerable:!0,get:()=>a[r]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function vf(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function x2(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var t=o.default;if(typeof t=="function"){var n=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(a){var r=Object.getOwnPropertyDescriptor(o,a);Object.defineProperty(n,a,r.get?r:{enumerable:!0,get:function(){return o[a]}})}),n}var bp={exports:{}},Xd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uy;function C4(){if(uy)return Xd;uy=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(a,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var d in r)d!=="key"&&(l[d]=r[d])}else l=r;return r=l.ref,{$$typeof:o,type:a,key:c,ref:r!==void 0?r:null,props:l}}return Xd.Fragment=t,Xd.jsx=n,Xd.jsxs=n,Xd}var cy;function T4(){return cy||(cy=1,bp.exports=C4()),bp.exports}var k=T4(),_p={exports:{}},Ue={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fy;function A4(){if(fy)return Ue;fy=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),E=Symbol.iterator;function R(Z){return Z===null||typeof Z!="object"?null:(Z=E&&Z[E]||Z["@@iterator"],typeof Z=="function"?Z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,z={};function P(Z,it,st){this.props=Z,this.context=it,this.refs=z,this.updater=st||v}P.prototype.isReactComponent={},P.prototype.setState=function(Z,it){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,it,"setState")},P.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function j(){}j.prototype=P.prototype;function x(Z,it,st){this.props=Z,this.context=it,this.refs=z,this.updater=st||v}var L=x.prototype=new j;L.constructor=x,M(L,P.prototype),L.isPureReactComponent=!0;var O=Array.isArray;function T(){}var A={H:null,A:null,T:null,S:null},y=Object.prototype.hasOwnProperty;function B(Z,it,st){var V=st.ref;return{$$typeof:o,type:Z,key:it,ref:V!==void 0?V:null,props:st}}function U(Z,it){return B(Z.type,it,Z.props)}function I(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===o}function K(Z){var it={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(st){return it[st]})}var Q=/\/+/g;function X(Z,it){return typeof Z=="object"&&Z!==null&&Z.key!=null?K(""+Z.key):it.toString(36)}function Y(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(T,T):(Z.status="pending",Z.then(function(it){Z.status==="pending"&&(Z.status="fulfilled",Z.value=it)},function(it){Z.status==="pending"&&(Z.status="rejected",Z.reason=it)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function D(Z,it,st,V,J){var W=typeof Z;(W==="undefined"||W==="boolean")&&(Z=null);var nt=!1;if(Z===null)nt=!0;else switch(W){case"bigint":case"string":case"number":nt=!0;break;case"object":switch(Z.$$typeof){case o:case t:nt=!0;break;case S:return nt=Z._init,D(nt(Z._payload),it,st,V,J)}}if(nt)return J=J(Z),nt=V===""?"."+X(Z,0):V,O(J)?(st="",nt!=null&&(st=nt.replace(Q,"$&/")+"/"),D(J,it,st,"",function(Ut){return Ut})):J!=null&&(I(J)&&(J=U(J,st+(J.key==null||Z&&Z.key===J.key?"":(""+J.key).replace(Q,"$&/")+"/")+nt)),it.push(J)),1;nt=0;var dt=V===""?".":V+":";if(O(Z))for(var Rt=0;Rt<Z.length;Rt++)V=Z[Rt],W=dt+X(V,Rt),nt+=D(V,it,st,W,J);else if(Rt=R(Z),typeof Rt=="function")for(Z=Rt.call(Z),Rt=0;!(V=Z.next()).done;)V=V.value,W=dt+X(V,Rt++),nt+=D(V,it,st,W,J);else if(W==="object"){if(typeof Z.then=="function")return D(Y(Z),it,st,V,J);throw it=String(Z),Error("Objects are not valid as a React child (found: "+(it==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":it)+"). If you meant to render a collection of children, use an array instead.")}return nt}function H(Z,it,st){if(Z==null)return Z;var V=[],J=0;return D(Z,V,"","",function(W){return it.call(st,W,J++)}),V}function F(Z){if(Z._status===-1){var it=Z._result;it=it(),it.then(function(st){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=st)},function(st){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=st)}),Z._status===-1&&(Z._status=0,Z._result=it)}if(Z._status===1)return Z._result.default;throw Z._result}var tt=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var it=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(it))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},at={map:H,forEach:function(Z,it,st){H(Z,function(){it.apply(this,arguments)},st)},count:function(Z){var it=0;return H(Z,function(){it++}),it},toArray:function(Z){return H(Z,function(it){return it})||[]},only:function(Z){if(!I(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return Ue.Activity=C,Ue.Children=at,Ue.Component=P,Ue.Fragment=n,Ue.Profiler=r,Ue.PureComponent=x,Ue.StrictMode=a,Ue.Suspense=g,Ue.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Ue.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return A.H.useMemoCache(Z)}},Ue.cache=function(Z){return function(){return Z.apply(null,arguments)}},Ue.cacheSignal=function(){return null},Ue.cloneElement=function(Z,it,st){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var V=M({},Z.props),J=Z.key;if(it!=null)for(W in it.key!==void 0&&(J=""+it.key),it)!y.call(it,W)||W==="key"||W==="__self"||W==="__source"||W==="ref"&&it.ref===void 0||(V[W]=it[W]);var W=arguments.length-2;if(W===1)V.children=st;else if(1<W){for(var nt=Array(W),dt=0;dt<W;dt++)nt[dt]=arguments[dt+2];V.children=nt}return B(Z.type,J,V)},Ue.createContext=function(Z){return Z={$$typeof:c,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:l,_context:Z},Z},Ue.createElement=function(Z,it,st){var V,J={},W=null;if(it!=null)for(V in it.key!==void 0&&(W=""+it.key),it)y.call(it,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(J[V]=it[V]);var nt=arguments.length-2;if(nt===1)J.children=st;else if(1<nt){for(var dt=Array(nt),Rt=0;Rt<nt;Rt++)dt[Rt]=arguments[Rt+2];J.children=dt}if(Z&&Z.defaultProps)for(V in nt=Z.defaultProps,nt)J[V]===void 0&&(J[V]=nt[V]);return B(Z,W,J)},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(Z){return{$$typeof:d,render:Z}},Ue.isValidElement=I,Ue.lazy=function(Z){return{$$typeof:S,_payload:{_status:-1,_result:Z},_init:F}},Ue.memo=function(Z,it){return{$$typeof:m,type:Z,compare:it===void 0?null:it}},Ue.startTransition=function(Z){var it=A.T,st={};A.T=st;try{var V=Z(),J=A.S;J!==null&&J(st,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(T,tt)}catch(W){tt(W)}finally{it!==null&&st.types!==null&&(it.types=st.types),A.T=it}},Ue.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Ue.use=function(Z){return A.H.use(Z)},Ue.useActionState=function(Z,it,st){return A.H.useActionState(Z,it,st)},Ue.useCallback=function(Z,it){return A.H.useCallback(Z,it)},Ue.useContext=function(Z){return A.H.useContext(Z)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(Z,it){return A.H.useDeferredValue(Z,it)},Ue.useEffect=function(Z,it){return A.H.useEffect(Z,it)},Ue.useEffectEvent=function(Z){return A.H.useEffectEvent(Z)},Ue.useId=function(){return A.H.useId()},Ue.useImperativeHandle=function(Z,it,st){return A.H.useImperativeHandle(Z,it,st)},Ue.useInsertionEffect=function(Z,it){return A.H.useInsertionEffect(Z,it)},Ue.useLayoutEffect=function(Z,it){return A.H.useLayoutEffect(Z,it)},Ue.useMemo=function(Z,it){return A.H.useMemo(Z,it)},Ue.useOptimistic=function(Z,it){return A.H.useOptimistic(Z,it)},Ue.useReducer=function(Z,it,st){return A.H.useReducer(Z,it,st)},Ue.useRef=function(Z){return A.H.useRef(Z)},Ue.useState=function(Z){return A.H.useState(Z)},Ue.useSyncExternalStore=function(Z,it,st){return A.H.useSyncExternalStore(Z,it,st)},Ue.useTransition=function(){return A.H.useTransition()},Ue.version="19.2.0",Ue}var dy;function wg(){return dy||(dy=1,_p.exports=A4()),_p.exports}var rt=wg();const pa=vf(rt),w4=E4({__proto__:null,default:pa},[rt]);var Ep={exports:{}},Fd={},Cp={exports:{}},Tp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function R4(){return hy||(hy=1,(function(o){function t(D,H){var F=D.length;D.push(H);t:for(;0<F;){var tt=F-1>>>1,at=D[tt];if(0<r(at,H))D[tt]=H,D[F]=at,F=tt;else break t}}function n(D){return D.length===0?null:D[0]}function a(D){if(D.length===0)return null;var H=D[0],F=D.pop();if(F!==H){D[0]=F;t:for(var tt=0,at=D.length,Z=at>>>1;tt<Z;){var it=2*(tt+1)-1,st=D[it],V=it+1,J=D[V];if(0>r(st,F))V<at&&0>r(J,st)?(D[tt]=J,D[V]=F,tt=V):(D[tt]=st,D[it]=F,tt=it);else if(V<at&&0>r(J,F))D[tt]=J,D[V]=F,tt=V;else break t}}return H}function r(D,H){var F=D.sortIndex-H.sortIndex;return F!==0?F:D.id-H.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],S=1,C=null,E=3,R=!1,v=!1,M=!1,z=!1,P=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function L(D){for(var H=n(m);H!==null;){if(H.callback===null)a(m);else if(H.startTime<=D)a(m),H.sortIndex=H.expirationTime,t(g,H);else break;H=n(m)}}function O(D){if(M=!1,L(D),!v)if(n(g)!==null)v=!0,T||(T=!0,K());else{var H=n(m);H!==null&&Y(O,H.startTime-D)}}var T=!1,A=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function I(){if(z=!1,T){var D=o.unstable_now();B=D;var H=!0;try{t:{v=!1,M&&(M=!1,j(A),A=-1),R=!0;var F=E;try{e:{for(L(D),C=n(g);C!==null&&!(C.expirationTime>D&&U());){var tt=C.callback;if(typeof tt=="function"){C.callback=null,E=C.priorityLevel;var at=tt(C.expirationTime<=D);if(D=o.unstable_now(),typeof at=="function"){C.callback=at,L(D),H=!0;break e}C===n(g)&&a(g),L(D)}else a(g);C=n(g)}if(C!==null)H=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-D),H=!1}}break t}finally{C=null,E=F,R=!1}H=void 0}}finally{H?K():T=!1}}}var K;if(typeof x=="function")K=function(){x(I)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=I,K=function(){X.postMessage(null)}}else K=function(){P(I,0)};function Y(D,H){A=P(function(){D(o.unstable_now())},H)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(D){D.callback=null},o.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<D?Math.floor(1e3/D):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(D){switch(E){case 1:case 2:case 3:var H=3;break;default:H=E}var F=E;E=H;try{return D()}finally{E=F}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(D,H){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=E;E=D;try{return H()}finally{E=F}},o.unstable_scheduleCallback=function(D,H,F){var tt=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?tt+F:tt):F=tt,D){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=F+at,D={id:S++,callback:H,priorityLevel:D,startTime:F,expirationTime:at,sortIndex:-1},F>tt?(D.sortIndex=F,t(m,D),n(g)===null&&D===n(m)&&(M?(j(A),A=-1):M=!0,Y(O,F-tt))):(D.sortIndex=at,t(g,D),v||R||(v=!0,T||(T=!0,K()))),D},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(D){var H=E;return function(){var F=E;E=H;try{return D.apply(this,arguments)}finally{E=F}}}})(Tp)),Tp}var gy;function O4(){return gy||(gy=1,Cp.exports=R4()),Cp.exports}var Ap={exports:{}},di={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var py;function x4(){if(py)return di;py=1;var o=wg();function t(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)m+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var a={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(g,m,S){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:C==null?null:""+C,children:g,containerInfo:m,implementation:S}}var c=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return di.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,di.createPortal=function(g,m){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(g,m,null,S)},di.flushSync=function(g){var m=c.T,S=a.p;try{if(c.T=null,a.p=2,g)return g()}finally{c.T=m,a.p=S,a.d.f()}},di.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(g,m))},di.prefetchDNS=function(g){typeof g=="string"&&a.d.D(g)},di.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var S=m.as,C=d(S,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,R=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;S==="style"?a.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:C,integrity:E,fetchPriority:R}):S==="script"&&a.d.X(g,{crossOrigin:C,integrity:E,fetchPriority:R,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},di.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var S=d(m.as,m.crossOrigin);a.d.M(g,{crossOrigin:S,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(g)},di.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var S=m.as,C=d(S,m.crossOrigin);a.d.L(g,S,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},di.preloadModule=function(g,m){if(typeof g=="string")if(m){var S=d(m.as,m.crossOrigin);a.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:S,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(g)},di.requestFormReset=function(g){a.d.r(g)},di.unstable_batchedUpdates=function(g,m){return g(m)},di.useFormState=function(g,m,S){return c.H.useFormState(g,m,S)},di.useFormStatus=function(){return c.H.useHostTransitionStatus()},di.version="19.2.0",di}var my;function N2(){if(my)return Ap.exports;my=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),Ap.exports=x4(),Ap.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vy;function N4(){if(vy)return Fd;vy=1;var o=O4(),t=wg(),n=N2();function a(e){var i="https://react.dev/errors/"+e;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)i+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var i=e,f=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,(i.flags&4098)!==0&&(f=i.return),e=i.return;while(e)}return i.tag===3?f:null}function c(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function d(e){if(e.tag===31){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function g(e){if(l(e)!==e)throw Error(a(188))}function m(e){var i=e.alternate;if(!i){if(i=l(e),i===null)throw Error(a(188));return i!==e?null:e}for(var f=e,h=i;;){var _=f.return;if(_===null)break;var w=_.alternate;if(w===null){if(h=_.return,h!==null){f=h;continue}break}if(_.child===w.child){for(w=_.child;w;){if(w===f)return g(_),e;if(w===h)return g(_),i;w=w.sibling}throw Error(a(188))}if(f.return!==h.return)f=_,h=w;else{for(var q=!1,$=_.child;$;){if($===f){q=!0,f=_,h=w;break}if($===h){q=!0,h=_,f=w;break}$=$.sibling}if(!q){for($=w.child;$;){if($===f){q=!0,f=w,h=_;break}if($===h){q=!0,h=w,f=_;break}$=$.sibling}if(!q)throw Error(a(189))}}if(f.alternate!==h)throw Error(a(190))}if(f.tag!==3)throw Error(a(188));return f.stateNode.current===f?e:i}function S(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e;for(e=e.child;e!==null;){if(i=S(e),i!==null)return i;e=e.sibling}return null}var C=Object.assign,E=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),x=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function K(e){return e===null||typeof e!="object"?null:(e=I&&e[I]||e["@@iterator"],typeof e=="function"?e:null)}var Q=Symbol.for("react.client.reference");function X(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case M:return"Fragment";case P:return"Profiler";case z:return"StrictMode";case O:return"Suspense";case T:return"SuspenseList";case B:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case x:return e.displayName||"Context";case j:return(e._context.displayName||"Context")+".Consumer";case L:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case A:return i=e.displayName||null,i!==null?i:X(e.type)||"Memo";case y:i=e._payload,e=e._init;try{return X(e(i))}catch{}}return null}var Y=Array.isArray,D=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},tt=[],at=-1;function Z(e){return{current:e}}function it(e){0>at||(e.current=tt[at],tt[at]=null,at--)}function st(e,i){at++,tt[at]=e.current,e.current=i}var V=Z(null),J=Z(null),W=Z(null),nt=Z(null);function dt(e,i){switch(st(W,i),st(J,e),st(V,null),i.nodeType){case 9:case 11:e=(e=i.documentElement)&&(e=e.namespaceURI)?Dv(e):0;break;default:if(e=i.tagName,i=i.namespaceURI)i=Dv(i),e=jv(i,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}it(V),st(V,e)}function Rt(){it(V),it(J),it(W)}function Ut(e){e.memoizedState!==null&&st(nt,e);var i=V.current,f=jv(i,e.type);i!==f&&(st(J,e),st(V,f))}function Xt(e){J.current===e&&(it(V),it(J)),nt.current===e&&(it(nt),Vd._currentValue=F)}var $t,oe;function kt(e){if($t===void 0)try{throw Error()}catch(f){var i=f.stack.trim().match(/\n( *(at )?)/);$t=i&&i[1]||"",oe=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$t+e+oe}var Re=!1;function Ee(e,i){if(!e||Re)return"";Re=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(i){var jt=function(){throw Error()};if(Object.defineProperty(jt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(jt,[])}catch(Ct){var bt=Ct}Reflect.construct(e,[],jt)}else{try{jt.call()}catch(Ct){bt=Ct}e.call(jt.prototype)}}else{try{throw Error()}catch(Ct){bt=Ct}(jt=e())&&typeof jt.catch=="function"&&jt.catch(function(){})}}catch(Ct){if(Ct&&bt&&typeof Ct.stack=="string")return[Ct.stack,bt.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),q=w[0],$=w[1];if(q&&$){var lt=q.split(`
`),vt=$.split(`
`);for(_=h=0;h<lt.length&&!lt[h].includes("DetermineComponentFrameRoot");)h++;for(;_<vt.length&&!vt[_].includes("DetermineComponentFrameRoot");)_++;if(h===lt.length||_===vt.length)for(h=lt.length-1,_=vt.length-1;1<=h&&0<=_&&lt[h]!==vt[_];)_--;for(;1<=h&&0<=_;h--,_--)if(lt[h]!==vt[_]){if(h!==1||_!==1)do if(h--,_--,0>_||lt[h]!==vt[_]){var xt=`
`+lt[h].replace(" at new "," at ");return e.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",e.displayName)),xt}while(1<=h&&0<=_);break}}}finally{Re=!1,Error.prepareStackTrace=f}return(f=e?e.displayName||e.name:"")?kt(f):""}function ze(e,i){switch(e.tag){case 26:case 27:case 5:return kt(e.type);case 16:return kt("Lazy");case 13:return e.child!==i&&i!==null?kt("Suspense Fallback"):kt("Suspense");case 19:return kt("SuspenseList");case 0:case 15:return Ee(e.type,!1);case 11:return Ee(e.type.render,!1);case 1:return Ee(e.type,!0);case 31:return kt("Activity");default:return""}}function Xe(e){try{var i="",f=null;do i+=ze(e,f),f=e,e=e.return;while(e);return i}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var nn=Object.prototype.hasOwnProperty,fn=o.unstable_scheduleCallback,At=o.unstable_cancelCallback,Ht=o.unstable_shouldYield,me=o.unstable_requestPaint,Se=o.unstable_now,Oe=o.unstable_getCurrentPriorityLevel,$e=o.unstable_ImmediatePriority,xe=o.unstable_UserBlockingPriority,ct=o.unstable_NormalPriority,Tt=o.unstable_LowPriority,Mt=o.unstable_IdlePriority,Pt=o.log,se=o.unstable_setDisableYieldValue,zt=null,ee=null;function qt(e){if(typeof Pt=="function"&&se(e),ee&&typeof ee.setStrictMode=="function")try{ee.setStrictMode(zt,e)}catch{}}var an=Math.clz32?Math.clz32:tn,Ae=Math.log,re=Math.LN2;function tn(e){return e>>>=0,e===0?32:31-(Ae(e)/re|0)|0}var _n=256,ea=262144,Xn=4194304;function Nt(e){var i=e&42;if(i!==0)return i;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ot(e,i,f){var h=e.pendingLanes;if(h===0)return 0;var _=0,w=e.suspendedLanes,q=e.pingedLanes;e=e.warmLanes;var $=h&134217727;return $!==0?(h=$&~w,h!==0?_=Nt(h):(q&=$,q!==0?_=Nt(q):f||(f=$&~e,f!==0&&(_=Nt(f))))):($=h&~w,$!==0?_=Nt($):q!==0?_=Nt(q):f||(f=h&~e,f!==0&&(_=Nt(f)))),_===0?0:i!==0&&i!==_&&(i&w)===0&&(w=_&-_,f=i&-i,w>=f||w===32&&(f&4194048)!==0)?i:_}function Jt(e,i){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&i)===0}function Ge(e,i){switch(e){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function He(){var e=Xn;return Xn<<=1,(Xn&62914560)===0&&(Xn=4194304),e}function Ke(e){for(var i=[],f=0;31>f;f++)i.push(e);return i}function Ne(e,i){e.pendingLanes|=i,i!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ce(e,i,f,h,_,w){var q=e.pendingLanes;e.pendingLanes=f,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=f,e.entangledLanes&=f,e.errorRecoveryDisabledLanes&=f,e.shellSuspendCounter=0;var $=e.entanglements,lt=e.expirationTimes,vt=e.hiddenUpdates;for(f=q&~f;0<f;){var xt=31-an(f),jt=1<<xt;$[xt]=0,lt[xt]=-1;var bt=vt[xt];if(bt!==null)for(vt[xt]=null,xt=0;xt<bt.length;xt++){var Ct=bt[xt];Ct!==null&&(Ct.lane&=-536870913)}f&=~jt}h!==0&&Le(e,h,0),w!==0&&_===0&&e.tag!==0&&(e.suspendedLanes|=w&~(q&~i))}function Le(e,i,f){e.pendingLanes|=i,e.suspendedLanes&=~i;var h=31-an(i);e.entangledLanes|=i,e.entanglements[h]=e.entanglements[h]|1073741824|f&261930}function Rn(e,i){var f=e.entangledLanes|=i;for(e=e.entanglements;f;){var h=31-an(f),_=1<<h;_&i|e[h]&i&&(e[h]|=i),f&=~_}}function On(e,i){var f=i&-i;return f=(f&42)!==0?1:Ta(f),(f&(e.suspendedLanes|i))!==0?0:f}function Ta(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Pa(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function gi(){var e=H.p;return e!==0?e:(e=window.event,e===void 0?32:ny(e.type))}function Li(e,i){var f=H.p;try{return H.p=e,i()}finally{H.p=f}}var ca=Math.random().toString(36).slice(2),$n="__reactFiber$"+ca,wt="__reactProps$"+ca,Et="__reactContainer$"+ca,te="__reactEvents$"+ca,ae="__reactListeners$"+ca,Yt="__reactHandles$"+ca,rn="__reactResources$"+ca,En="__reactMarker$"+ca;function fe(e){delete e[$n],delete e[wt],delete e[te],delete e[ae],delete e[Yt]}function de(e){var i=e[$n];if(i)return i;for(var f=e.parentNode;f;){if(i=f[Et]||f[$n]){if(f=i.alternate,i.child!==null||f!==null&&f.child!==null)for(e=Gv(e);e!==null;){if(f=e[$n])return f;e=Gv(e)}return i}e=f,f=e.parentNode}return null}function Zt(e){if(e=e[$n]||e[Et]){var i=e.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return e}return null}function qe(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e.stateNode;throw Error(a(33))}function Me(e){var i=e[rn];return i||(i=e[rn]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Ce(e){e[En]=!0}var An=new Set,zn={};function kn(e,i){vn(e,i),vn(e+"Capture",i)}function vn(e,i){for(zn[e]=i,e=0;e<i.length;e++)An.add(i[e])}var Fn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ns={},Ro={};function Uu(e){return nn.call(Ro,e)?!0:nn.call(Ns,e)?!1:Fn.test(e)?Ro[e]=!0:(Ns[e]=!0,!1)}function Oo(e,i,f){if(Uu(i))if(f===null)e.removeAttribute(i);else{switch(typeof f){case"undefined":case"function":case"symbol":e.removeAttribute(i);return;case"boolean":var h=i.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){e.removeAttribute(i);return}}e.setAttribute(i,""+f)}}function Oi(e,i,f){if(f===null)e.removeAttribute(i);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttribute(i,""+f)}}function xi(e,i,f,h){if(h===null)e.removeAttribute(f);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(f);return}e.setAttributeNS(i,f,""+h)}}function ei(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Bu(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Eh(e,i,f){var h=Object.getOwnPropertyDescriptor(e.constructor.prototype,i);if(!e.hasOwnProperty(i)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,w=h.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return _.call(this)},set:function(q){f=""+q,w.call(this,q)}}),Object.defineProperty(e,i,{enumerable:h.enumerable}),{getValue:function(){return f},setValue:function(q){f=""+q},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function zu(e){if(!e._valueTracker){var i=Bu(e)?"checked":"value";e._valueTracker=Eh(e,i,""+e[i])}}function Af(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var f=i.getValue(),h="";return e&&(h=Bu(e)?e.checked?"true":"false":e.value),e=h,e!==f?(i.setValue(e),!0):!1}function wl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Ch=/[\n"\\]/g;function pi(e){return e.replace(Ch,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Rl(e,i,f,h,_,w,q,$){e.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?e.type=q:e.removeAttribute("type"),i!=null?q==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+ei(i)):e.value!==""+ei(i)&&(e.value=""+ei(i)):q!=="submit"&&q!=="reset"||e.removeAttribute("value"),i!=null?Rf(e,q,ei(i)):f!=null?Rf(e,q,ei(f)):h!=null&&e.removeAttribute("value"),_==null&&w!=null&&(e.defaultChecked=!!w),_!=null&&(e.checked=_&&typeof _!="function"&&typeof _!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?e.name=""+ei($):e.removeAttribute("name")}function wf(e,i,f,h,_,w,q,$){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.type=w),i!=null||f!=null){if(!(w!=="submit"&&w!=="reset"||i!=null)){zu(e);return}f=f!=null?""+ei(f):"",i=i!=null?""+ei(i):f,$||i===e.value||(e.value=i),e.defaultValue=i}h=h??_,h=typeof h!="function"&&typeof h!="symbol"&&!!h,e.checked=$?e.checked:!!h,e.defaultChecked=!!h,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(e.name=q),zu(e)}function Rf(e,i,f){i==="number"&&wl(e.ownerDocument)===e||e.defaultValue===""+f||(e.defaultValue=""+f)}function Ms(e,i,f,h){if(e=e.options,i){i={};for(var _=0;_<f.length;_++)i["$"+f[_]]=!0;for(f=0;f<e.length;f++)_=i.hasOwnProperty("$"+e[f].value),e[f].selected!==_&&(e[f].selected=_),_&&h&&(e[f].defaultSelected=!0)}else{for(f=""+ei(f),i=null,_=0;_<e.length;_++){if(e[_].value===f){e[_].selected=!0,h&&(e[_].defaultSelected=!0);return}i!==null||e[_].disabled||(i=e[_])}i!==null&&(i.selected=!0)}}function Of(e,i,f){if(i!=null&&(i=""+ei(i),i!==e.value&&(e.value=i),f==null)){e.defaultValue!==i&&(e.defaultValue=i);return}e.defaultValue=f!=null?""+ei(f):""}function xf(e,i,f,h){if(i==null){if(h!=null){if(f!=null)throw Error(a(92));if(Y(h)){if(1<h.length)throw Error(a(93));h=h[0]}f=h}f==null&&(f=""),i=f}f=ei(i),e.defaultValue=f,h=e.textContent,h===f&&h!==""&&h!==null&&(e.value=h),zu(e)}function es(e,i){if(i){var f=e.firstChild;if(f&&f===e.lastChild&&f.nodeType===3){f.nodeValue=i;return}}e.textContent=i}var Th=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nf(e,i,f){var h=i.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?h?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="":h?e.setProperty(i,f):typeof f!="number"||f===0||Th.has(i)?i==="float"?e.cssFloat=f:e[i]=(""+f).trim():e[i]=f+"px"}function Mf(e,i,f){if(i!=null&&typeof i!="object")throw Error(a(62));if(e=e.style,f!=null){for(var h in f)!f.hasOwnProperty(h)||i!=null&&i.hasOwnProperty(h)||(h.indexOf("--")===0?e.setProperty(h,""):h==="float"?e.cssFloat="":e[h]="");for(var _ in i)h=i[_],i.hasOwnProperty(_)&&f[_]!==h&&Nf(e,_,h)}else for(var w in i)i.hasOwnProperty(w)&&Nf(e,w,i[w])}function Lu(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ah=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ol(e){return Pg.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function ni(){}var xo=null;function Pu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wr=null,tr=null;function Df(e){var i=Zt(e);if(i&&(e=i.stateNode)){var f=e[wt]||null;t:switch(e=i.stateNode,i.type){case"input":if(Rl(e,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),i=f.name,f.type==="radio"&&i!=null){for(f=e;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+pi(""+i)+'"][type="radio"]'),i=0;i<f.length;i++){var h=f[i];if(h!==e&&h.form===e.form){var _=h[wt]||null;if(!_)throw Error(a(90));Rl(h,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(i=0;i<f.length;i++)h=f[i],h.form===e.form&&Af(h)}break t;case"textarea":Of(e,f.value,f.defaultValue);break t;case"select":i=f.value,i!=null&&Ms(e,!!f.multiple,i,!1)}}}var Iu=!1;function jf(e,i,f){if(Iu)return e(i,f);Iu=!0;try{var h=e(i);return h}finally{if(Iu=!1,(wr!==null||tr!==null)&&(nl(),wr&&(i=wr,e=tr,tr=wr=null,Df(i),e)))for(i=0;i<e.length;i++)Df(e[i])}}function No(e,i){var f=e.stateNode;if(f===null)return null;var h=f[wt]||null;if(h===null)return null;f=h[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break t;default:e=!1}if(e)return null;if(f&&typeof f!="function")throw Error(a(231,i,typeof f));return f}var er=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gu=!1;if(er)try{var Ds={};Object.defineProperty(Ds,"passive",{get:function(){Gu=!0}}),window.addEventListener("test",Ds,Ds),window.removeEventListener("test",Ds,Ds)}catch{Gu=!1}var Rr=null,Hu=null,Mo=null;function Uf(){if(Mo)return Mo;var e,i=Hu,f=i.length,h,_="value"in Rr?Rr.value:Rr.textContent,w=_.length;for(e=0;e<f&&i[e]===_[e];e++);var q=f-e;for(h=1;h<=q&&i[f-h]===_[w-h];h++);return Mo=_.slice(e,1<h?1-h:void 0)}function xl(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function Nl(){return!0}function ku(){return!1}function Va(e){function i(f,h,_,w,q){this._reactName=f,this._targetInst=_,this.type=h,this.nativeEvent=w,this.target=q,this.currentTarget=null;for(var $ in e)e.hasOwnProperty($)&&(f=e[$],this[$]=f?f(w):w[$]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Nl:ku,this.isPropagationStopped=ku,this}return C(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Nl)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Nl)},persist:function(){},isPersistent:Nl}),i}var ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qu=Va(ns),Ml=C({},ns,{view:0,detail:0}),wh=Va(Ml),js,Dl,as,jl=C({},Ml,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Do,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==as&&(as&&e.type==="mousemove"?(js=e.screenX-as.screenX,Dl=e.screenY-as.screenY):Dl=js=0,as=e),js)},movementY:function(e){return"movementY"in e?e.movementY:Dl}}),Bf=Va(jl),Vu=C({},jl,{dataTransfer:0}),Ul=Va(Vu),Yu=C({},Ml,{relatedTarget:0}),Ku=Va(Yu),Rh=C({},ns,{animationName:0,elapsedTime:0,pseudoElement:0}),is=Va(Rh),Oh=C({},ns,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),rs=Va(Oh),Or=C({},ns,{data:0}),Bl=Va(Or),zf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Us(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Nh[e])?!!i[e]:!1}function Do(){return Us}var Mh=C({},Ml,{key:function(e){if(e.key){var i=zf[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=xl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Do,charCode:function(e){return e.type==="keypress"?xl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lf=Va(Mh),Dh=C({},jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pf=Va(Dh),Ig=C({},Ml,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Do}),Aa=Va(Ig),jh=C({},ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uh=Va(jh),Bh=C({},jl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zh=Va(Bh),Lh=C({},ns,{newState:0,oldState:0}),Qu=Va(Lh),If=[9,13,27,32],Xu=er&&"CompositionEvent"in window,jo=null;er&&"documentMode"in document&&(jo=document.documentMode);var Ph=er&&"TextEvent"in window&&!jo,Fu=er&&(!Xu||jo&&8<jo&&11>=jo),Ju=" ",Gf=!1;function Zu(e,i){switch(e){case"keyup":return If.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zl(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ss=!1;function Ih(e,i){switch(e){case"compositionend":return zl(i);case"keypress":return i.which!==32?null:(Gf=!0,Ju);case"textInput":return e=i.data,e===Ju&&Gf?null:e;default:return null}}function Hf(e,i){if(ss)return e==="compositionend"||!Xu&&Zu(e,i)?(e=Uf(),Mo=Hu=Rr=null,ss=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Fu&&i.locale!=="ko"?null:i.data;default:return null}}var Gh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nr(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!Gh[e.type]:i==="textarea"}function Wu(e,i,f,h){wr?tr?tr.push(h):tr=[h]:wr=h,i=M0(i,"onChange"),0<i.length&&(f=new qu("onChange","change",null,f,h),e.push({event:f,listeners:i}))}var Ll=null,Uo=null;function mi(e){wv(e,0)}function Pl(e){var i=qe(e);if(Af(i))return e}function $u(e,i){if(e==="change")return i}var kf=!1;if(er){var tc;if(er){var Il="oninput"in document;if(!Il){var ec=document.createElement("div");ec.setAttribute("oninput","return;"),Il=typeof ec.oninput=="function"}tc=Il}else tc=!1;kf=tc&&(!document.documentMode||9<document.documentMode)}function qf(){Ll&&(Ll.detachEvent("onpropertychange",Gl),Uo=Ll=null)}function Gl(e){if(e.propertyName==="value"&&Pl(Uo)){var i=[];Wu(i,Uo,e,Pu(e)),jf(mi,i)}}function Hl(e,i,f){e==="focusin"?(qf(),Ll=i,Uo=f,Ll.attachEvent("onpropertychange",Gl)):e==="focusout"&&qf()}function Jn(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Pl(Uo)}function Gg(e,i){if(e==="click")return Pl(i)}function Hg(e,i){if(e==="input"||e==="change")return Pl(i)}function Hh(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var wa=typeof Object.is=="function"?Object.is:Hh;function Ni(e,i){if(wa(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var f=Object.keys(e),h=Object.keys(i);if(f.length!==h.length)return!1;for(h=0;h<f.length;h++){var _=f[h];if(!nn.call(i,_)||!wa(e[_],i[_]))return!1}return!0}function Vf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Yf(e,i){var f=Vf(e);e=0;for(var h;f;){if(f.nodeType===3){if(h=e+f.textContent.length,e<=i&&h>=i)return{node:f,offset:i-e};e=h}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=Vf(f)}}function Bo(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Bo(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Pi(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var i=wl(e.document);i instanceof e.HTMLIFrameElement;){try{var f=typeof i.contentWindow.location.href=="string"}catch{f=!1}if(f)e=i.contentWindow;else break;i=wl(e.document)}return i}function nc(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}var Kf=er&&"documentMode"in document&&11>=document.documentMode,Bs=null,kl=null,zs=null,zo=!1;function Qf(e,i,f){var h=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;zo||Bs==null||Bs!==wl(h)||(h=Bs,"selectionStart"in h&&nc(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),zs&&Ni(zs,h)||(zs=h,h=M0(kl,"onSelect"),0<h.length&&(i=new qu("onSelect","select",null,i,f),e.push({event:i,listeners:h}),i.target=Bs)))}function os(e,i){var f={};return f[e.toLowerCase()]=i.toLowerCase(),f["Webkit"+e]="webkit"+i,f["Moz"+e]="moz"+i,f}var Lo={animationend:os("Animation","AnimationEnd"),animationiteration:os("Animation","AnimationIteration"),animationstart:os("Animation","AnimationStart"),transitionrun:os("Transition","TransitionRun"),transitionstart:os("Transition","TransitionStart"),transitioncancel:os("Transition","TransitionCancel"),transitionend:os("Transition","TransitionEnd")},ac={},Xf={};er&&(Xf=document.createElement("div").style,"AnimationEvent"in window||(delete Lo.animationend.animation,delete Lo.animationiteration.animation,delete Lo.animationstart.animation),"TransitionEvent"in window||delete Lo.transitionend.transition);function Ra(e){if(ac[e])return ac[e];if(!Lo[e])return e;var i=Lo[e],f;for(f in i)if(i.hasOwnProperty(f)&&f in Xf)return ac[e]=i[f];return e}var ic=Ra("animationend"),Ff=Ra("animationiteration"),kh=Ra("animationstart"),Jf=Ra("transitionrun"),Ya=Ra("transitionstart"),qh=Ra("transitioncancel"),Ka=Ra("transitionend"),Zf=new Map,ar="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ar.push("scrollEnd");function Oa(e,i){Zf.set(e,i),kn(i,[e])}var Ii=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ai=[],ls=0,Mi=0;function ql(){for(var e=ls,i=Mi=ls=0;i<e;){var f=ai[i];ai[i++]=null;var h=ai[i];ai[i++]=null;var _=ai[i];ai[i++]=null;var w=ai[i];if(ai[i++]=null,h!==null&&_!==null){var q=h.pending;q===null?_.next=_:(_.next=q.next,q.next=_),h.pending=_}w!==0&&Wf(f,_,w)}}function xr(e,i,f,h){ai[ls++]=e,ai[ls++]=i,ai[ls++]=f,ai[ls++]=h,Mi|=h,e.lanes|=h,e=e.alternate,e!==null&&(e.lanes|=h)}function Ls(e,i,f,h){return xr(e,i,f,h),Vl(e)}function vi(e,i){return xr(e,null,null,i),Vl(e)}function Wf(e,i,f){e.lanes|=f;var h=e.alternate;h!==null&&(h.lanes|=f);for(var _=!1,w=e.return;w!==null;)w.childLanes|=f,h=w.alternate,h!==null&&(h.childLanes|=f),w.tag===22&&(e=w.stateNode,e===null||e._visibility&1||(_=!0)),e=w,w=w.return;return e.tag===3?(w=e.stateNode,_&&i!==null&&(_=31-an(f),e=w.hiddenUpdates,h=e[_],h===null?e[_]=[i]:h.push(i),i.lane=f|536870912),w):null}function Vl(e){if(50<vo)throw vo=0,yo=null,Error(a(185));for(var i=e.return;i!==null;)e=i,i=e.return;return e.tag===3?e.stateNode:null}var ir={};function Vh(e,i,f,h){this.tag=e,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ia(e,i,f,h){return new Vh(e,i,f,h)}function rc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Gi(e,i){var f=e.alternate;return f===null?(f=Ia(e.tag,i,e.key,e.mode),f.elementType=e.elementType,f.type=e.type,f.stateNode=e.stateNode,f.alternate=e,e.alternate=f):(f.pendingProps=i,f.type=e.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=e.flags&65011712,f.childLanes=e.childLanes,f.lanes=e.lanes,f.child=e.child,f.memoizedProps=e.memoizedProps,f.memoizedState=e.memoizedState,f.updateQueue=e.updateQueue,i=e.dependencies,f.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},f.sibling=e.sibling,f.index=e.index,f.ref=e.ref,f.refCleanup=e.refCleanup,f}function sc(e,i){e.flags&=65011714;var f=e.alternate;return f===null?(e.childLanes=0,e.lanes=i,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=f.childLanes,e.lanes=f.lanes,e.child=f.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=f.memoizedProps,e.memoizedState=f.memoizedState,e.updateQueue=f.updateQueue,e.type=f.type,i=f.dependencies,e.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),e}function Po(e,i,f,h,_,w){var q=0;if(h=e,typeof e=="function")rc(e)&&(q=1);else if(typeof e=="string")q=c4(e,f,V.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case B:return e=Ia(31,f,i,_),e.elementType=B,e.lanes=w,e;case M:return us(f.children,_,w,i);case z:q=8,_|=24;break;case P:return e=Ia(12,f,i,_|2),e.elementType=P,e.lanes=w,e;case O:return e=Ia(13,f,i,_),e.elementType=O,e.lanes=w,e;case T:return e=Ia(19,f,i,_),e.elementType=T,e.lanes=w,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case x:q=10;break t;case j:q=9;break t;case L:q=11;break t;case A:q=14;break t;case y:q=16,h=null;break t}q=29,f=Error(a(130,e===null?"null":typeof e,"")),h=null}return i=Ia(q,f,i,_),i.elementType=e,i.type=h,i.lanes=w,i}function us(e,i,f,h){return e=Ia(7,e,h,i),e.lanes=f,e}function Yl(e,i,f){return e=Ia(6,e,null,i),e.lanes=f,e}function ii(e){var i=Ia(18,null,null,0);return i.stateNode=e,i}function oc(e,i,f){return i=Ia(4,e.children!==null?e.children:[],e.key,i),i.lanes=f,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}var ri=new WeakMap;function yi(e,i){if(typeof e=="object"&&e!==null){var f=ri.get(e);return f!==void 0?f:(i={value:e,source:i,stack:Xe(i)},ri.set(e,i),i)}return{value:e,source:i,stack:Xe(i)}}var Ps=[],Io=0,Hi=null,Go=0,si=[],xa=0,Nr=null,ki=1,qi="";function rr(e,i){Ps[Io++]=Go,Ps[Io++]=Hi,Hi=e,Go=i}function lc(e,i,f){si[xa++]=ki,si[xa++]=qi,si[xa++]=Nr,Nr=e;var h=ki;e=qi;var _=32-an(h)-1;h&=~(1<<_),f+=1;var w=32-an(i)+_;if(30<w){var q=_-_%5;w=(h&(1<<q)-1).toString(32),h>>=q,_-=q,ki=1<<32-an(i)+_|f<<_|h,qi=w+e}else ki=1<<w|f<<_|h,qi=e}function Kl(e){e.return!==null&&(rr(e,1),lc(e,1,0))}function $f(e){for(;e===Hi;)Hi=Ps[--Io],Ps[Io]=null,Go=Ps[--Io],Ps[Io]=null;for(;e===Nr;)Nr=si[--xa],si[xa]=null,qi=si[--xa],si[xa]=null,ki=si[--xa],si[xa]=null}function Yh(e,i){si[xa++]=ki,si[xa++]=qi,si[xa++]=Nr,ki=i.id,qi=i.overflow,Nr=e}var Na=null,xn=null,Fe=!1,Si=null,Qa=!1,uc=Error(a(519));function Mr(e){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ho(yi(i,e)),uc}function td(e){var i=e.stateNode,f=e.type,h=e.memoizedProps;switch(i[$n]=e,i[wt]=h,f){case"dialog":We("cancel",i),We("close",i);break;case"iframe":case"object":case"embed":We("load",i);break;case"video":case"audio":for(f=0;f<Id.length;f++)We(Id[f],i);break;case"source":We("error",i);break;case"img":case"image":case"link":We("error",i),We("load",i);break;case"details":We("toggle",i);break;case"input":We("invalid",i),wf(i,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":We("invalid",i);break;case"textarea":We("invalid",i),xf(i,h.value,h.defaultValue,h.children)}f=h.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||i.textContent===""+f||h.suppressHydrationWarning===!0||Nv(i.textContent,f)?(h.popover!=null&&(We("beforetoggle",i),We("toggle",i)),h.onScroll!=null&&We("scroll",i),h.onScrollEnd!=null&&We("scrollend",i),h.onClick!=null&&(i.onclick=ni),i=!0):i=!1,i||Mr(e,!0)}function ed(e){for(Na=e.return;Na;)switch(Na.tag){case 5:case 31:case 13:Qa=!1;return;case 27:case 3:Qa=!0;return;default:Na=Na.return}}function Is(e){if(e!==Na)return!1;if(!Fe)return ed(e),Fe=!0,!1;var i=e.tag,f;if((f=i!==3&&i!==27)&&((f=i===5)&&(f=e.type,f=!(f!=="form"&&f!=="button")||rp(e.type,e.memoizedProps)),f=!f),f&&xn&&Mr(e),ed(e),i===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));xn=Iv(e)}else if(i===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));xn=Iv(e)}else i===27?(i=xn,rl(e.type)?(e=cp,cp=null,xn=e):xn=i):xn=Na?Cr(e.stateNode.nextSibling):null;return!0}function cs(){xn=Na=null,Fe=!1}function Gs(){var e=Si;return e!==null&&(Dn===null?Dn=e:Dn.push.apply(Dn,e),Si=null),e}function Ho(e){Si===null?Si=[e]:Si.push(e)}var cc=Z(null),Ze=null,Vi=null;function fs(e,i,f){st(cc,i._currentValue),i._currentValue=f}function sr(e){e._currentValue=cc.current,it(cc)}function nd(e,i,f){for(;e!==null;){var h=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),e===f)break;e=e.return}}function ad(e,i,f,h){var _=e.child;for(_!==null&&(_.return=e);_!==null;){var w=_.dependencies;if(w!==null){var q=_.child;w=w.firstContext;t:for(;w!==null;){var $=w;w=_;for(var lt=0;lt<i.length;lt++)if($.context===i[lt]){w.lanes|=f,$=w.alternate,$!==null&&($.lanes|=f),nd(w.return,f,e),h||(q=null);break t}w=$.next}}else if(_.tag===18){if(q=_.return,q===null)throw Error(a(341));q.lanes|=f,w=q.alternate,w!==null&&(w.lanes|=f),nd(q,f,e),q=null}else q=_.child;if(q!==null)q.return=_;else for(q=_;q!==null;){if(q===e){q=null;break}if(_=q.sibling,_!==null){_.return=q.return,q=_;break}q=q.return}_=q}}function ko(e,i,f,h){e=null;for(var _=i,w=!1;_!==null;){if(!w){if((_.flags&524288)!==0)w=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var q=_.alternate;if(q===null)throw Error(a(387));if(q=q.memoizedProps,q!==null){var $=_.type;wa(_.pendingProps.value,q.value)||(e!==null?e.push($):e=[$])}}else if(_===nt.current){if(q=_.alternate,q===null)throw Error(a(387));q.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(e!==null?e.push(Vd):e=[Vd])}_=_.return}e!==null&&ad(i,e,f,h),i.flags|=262144}function fc(e){for(e=e.firstContext;e!==null;){if(!wa(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Dr(e){Ze=e,Vi=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ln(e){return Xl(Ze,e)}function Ql(e,i){return Ze===null&&Dr(e),Xl(e,i)}function Xl(e,i){var f=i._currentValue;if(i={context:i,memoizedValue:f,next:null},Vi===null){if(e===null)throw Error(a(308));Vi=i,e.dependencies={lanes:0,firstContext:i},e.flags|=524288}else Vi=Vi.next=i;return f}var Hs=typeof AbortController<"u"?AbortController:function(){var e=[],i=this.signal={aborted:!1,addEventListener:function(f,h){e.push(h)}};this.abort=function(){i.aborted=!0,e.forEach(function(f){return f()})}},id=o.unstable_scheduleCallback,rd=o.unstable_NormalPriority,fa={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dc(){return{controller:new Hs,data:new Map,refCount:0}}function qo(e){e.refCount--,e.refCount===0&&id(rd,function(){e.controller.abort()})}var Vo=null,hc=0,ks=0,ds=null;function Qe(e,i){if(Vo===null){var f=Vo=[];hc=0,ks=Jg(),ds={status:"pending",value:void 0,then:function(h){f.push(h)}}}return hc++,i.then(Kh,Kh),i}function Kh(){if(--hc===0&&Vo!==null){ds!==null&&(ds.status="fulfilled");var e=Vo;Vo=null,ks=0,ds=null;for(var i=0;i<e.length;i++)(0,e[i])()}}function bi(e,i){var f=[],h={status:"pending",value:null,reason:null,then:function(_){f.push(_)}};return e.then(function(){h.status="fulfilled",h.value=i;for(var _=0;_<f.length;_++)(0,f[_])(i)},function(_){for(h.status="rejected",h.reason=_,_=0;_<f.length;_++)(0,f[_])(void 0)}),h}var gc=D.S;D.S=function(e,i){Hc=Se(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&Qe(e,i),gc!==null&&gc(e,i)};var qs=Z(null);function Yo(){var e=qs.current;return e!==null?e:ke.pooledCache}function jr(e,i){i===null?st(qs,qs.current):st(qs,i.pool)}function Vs(){var e=Yo();return e===null?null:{parent:fa._currentValue,pool:e}}var Ys=Error(a(460)),Fl=Error(a(474)),pc=Error(a(542)),Jl={then:function(){}};function Ur(e){return e=e.status,e==="fulfilled"||e==="rejected"}function mc(e,i,f){switch(f=e[f],f===void 0?e.push(i):f!==i&&(i.then(ni,ni),i=f),i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,Lr(e),e;default:if(typeof i.status=="string")i.then(ni,ni);else{if(e=ke,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=i,e.status="pending",e.then(function(h){if(i.status==="pending"){var _=i;_.status="fulfilled",_.value=h}},function(h){if(i.status==="pending"){var _=i;_.status="rejected",_.reason=h}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,Lr(e),e}throw zr=i,Ys}}function Br(e){try{var i=e._init;return i(e._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(zr=f,Ys):f}}var zr=null;function vc(){if(zr===null)throw Error(a(459));var e=zr;return zr=null,e}function Lr(e){if(e===Ys||e===pc)throw Error(a(483))}var hs=null,Zl=0;function Wl(e){var i=Zl;return Zl+=1,hs===null&&(hs=[]),mc(hs,e,i)}function $l(e,i){i=i.props.ref,e.ref=i!==void 0?i:null}function Ks(e,i){throw i.$$typeof===E?Error(a(525)):(e=Object.prototype.toString.call(i),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)))}function ge(e){function i(gt,ft){if(e){var mt=gt.deletions;mt===null?(gt.deletions=[ft],gt.flags|=16):mt.push(ft)}}function f(gt,ft){if(!e)return null;for(;ft!==null;)i(gt,ft),ft=ft.sibling;return null}function h(gt){for(var ft=new Map;gt!==null;)gt.key!==null?ft.set(gt.key,gt):ft.set(gt.index,gt),gt=gt.sibling;return ft}function _(gt,ft){return gt=Gi(gt,ft),gt.index=0,gt.sibling=null,gt}function w(gt,ft,mt){return gt.index=mt,e?(mt=gt.alternate,mt!==null?(mt=mt.index,mt<ft?(gt.flags|=67108866,ft):mt):(gt.flags|=67108866,ft)):(gt.flags|=1048576,ft)}function q(gt){return e&&gt.alternate===null&&(gt.flags|=67108866),gt}function $(gt,ft,mt,Dt){return ft===null||ft.tag!==6?(ft=Yl(mt,gt.mode,Dt),ft.return=gt,ft):(ft=_(ft,mt),ft.return=gt,ft)}function lt(gt,ft,mt,Dt){var he=mt.type;return he===M?xt(gt,ft,mt.props.children,Dt,mt.key):ft!==null&&(ft.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===y&&Br(he)===ft.type)?(ft=_(ft,mt.props),$l(ft,mt),ft.return=gt,ft):(ft=Po(mt.type,mt.key,mt.props,null,gt.mode,Dt),$l(ft,mt),ft.return=gt,ft)}function vt(gt,ft,mt,Dt){return ft===null||ft.tag!==4||ft.stateNode.containerInfo!==mt.containerInfo||ft.stateNode.implementation!==mt.implementation?(ft=oc(mt,gt.mode,Dt),ft.return=gt,ft):(ft=_(ft,mt.children||[]),ft.return=gt,ft)}function xt(gt,ft,mt,Dt,he){return ft===null||ft.tag!==7?(ft=us(mt,gt.mode,Dt,he),ft.return=gt,ft):(ft=_(ft,mt),ft.return=gt,ft)}function jt(gt,ft,mt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return ft=Yl(""+ft,gt.mode,mt),ft.return=gt,ft;if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case R:return mt=Po(ft.type,ft.key,ft.props,null,gt.mode,mt),$l(mt,ft),mt.return=gt,mt;case v:return ft=oc(ft,gt.mode,mt),ft.return=gt,ft;case y:return ft=Br(ft),jt(gt,ft,mt)}if(Y(ft)||K(ft))return ft=us(ft,gt.mode,mt,null),ft.return=gt,ft;if(typeof ft.then=="function")return jt(gt,Wl(ft),mt);if(ft.$$typeof===x)return jt(gt,Ql(gt,ft),mt);Ks(gt,ft)}return null}function bt(gt,ft,mt,Dt){var he=ft!==null?ft.key:null;if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return he!==null?null:$(gt,ft,""+mt,Dt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case R:return mt.key===he?lt(gt,ft,mt,Dt):null;case v:return mt.key===he?vt(gt,ft,mt,Dt):null;case y:return mt=Br(mt),bt(gt,ft,mt,Dt)}if(Y(mt)||K(mt))return he!==null?null:xt(gt,ft,mt,Dt,null);if(typeof mt.then=="function")return bt(gt,ft,Wl(mt),Dt);if(mt.$$typeof===x)return bt(gt,ft,Ql(gt,mt),Dt);Ks(gt,mt)}return null}function Ct(gt,ft,mt,Dt,he){if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint")return gt=gt.get(mt)||null,$(ft,gt,""+Dt,he);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case R:return gt=gt.get(Dt.key===null?mt:Dt.key)||null,lt(ft,gt,Dt,he);case v:return gt=gt.get(Dt.key===null?mt:Dt.key)||null,vt(ft,gt,Dt,he);case y:return Dt=Br(Dt),Ct(gt,ft,mt,Dt,he)}if(Y(Dt)||K(Dt))return gt=gt.get(mt)||null,xt(ft,gt,Dt,he,null);if(typeof Dt.then=="function")return Ct(gt,ft,mt,Wl(Dt),he);if(Dt.$$typeof===x)return Ct(gt,ft,mt,Ql(ft,Dt),he);Ks(ft,Dt)}return null}function ie(gt,ft,mt,Dt){for(var he=null,pn=null,le=ft,Ye=ft=0,en=null;le!==null&&Ye<mt.length;Ye++){le.index>Ye?(en=le,le=null):en=le.sibling;var mn=bt(gt,le,mt[Ye],Dt);if(mn===null){le===null&&(le=en);break}e&&le&&mn.alternate===null&&i(gt,le),ft=w(mn,ft,Ye),pn===null?he=mn:pn.sibling=mn,pn=mn,le=en}if(Ye===mt.length)return f(gt,le),Fe&&rr(gt,Ye),he;if(le===null){for(;Ye<mt.length;Ye++)le=jt(gt,mt[Ye],Dt),le!==null&&(ft=w(le,ft,Ye),pn===null?he=le:pn.sibling=le,pn=le);return Fe&&rr(gt,Ye),he}for(le=h(le);Ye<mt.length;Ye++)en=Ct(le,gt,Ye,mt[Ye],Dt),en!==null&&(e&&en.alternate!==null&&le.delete(en.key===null?Ye:en.key),ft=w(en,ft,Ye),pn===null?he=en:pn.sibling=en,pn=en);return e&&le.forEach(function(cl){return i(gt,cl)}),Fe&&rr(gt,Ye),he}function _e(gt,ft,mt,Dt){if(mt==null)throw Error(a(151));for(var he=null,pn=null,le=ft,Ye=ft=0,en=null,mn=mt.next();le!==null&&!mn.done;Ye++,mn=mt.next()){le.index>Ye?(en=le,le=null):en=le.sibling;var cl=bt(gt,le,mn.value,Dt);if(cl===null){le===null&&(le=en);break}e&&le&&cl.alternate===null&&i(gt,le),ft=w(cl,ft,Ye),pn===null?he=cl:pn.sibling=cl,pn=cl,le=en}if(mn.done)return f(gt,le),Fe&&rr(gt,Ye),he;if(le===null){for(;!mn.done;Ye++,mn=mt.next())mn=jt(gt,mn.value,Dt),mn!==null&&(ft=w(mn,ft,Ye),pn===null?he=mn:pn.sibling=mn,pn=mn);return Fe&&rr(gt,Ye),he}for(le=h(le);!mn.done;Ye++,mn=mt.next())mn=Ct(le,gt,Ye,mn.value,Dt),mn!==null&&(e&&mn.alternate!==null&&le.delete(mn.key===null?Ye:mn.key),ft=w(mn,ft,Ye),pn===null?he=mn:pn.sibling=mn,pn=mn);return e&&le.forEach(function(_4){return i(gt,_4)}),Fe&&rr(gt,Ye),he}function Un(gt,ft,mt,Dt){if(typeof mt=="object"&&mt!==null&&mt.type===M&&mt.key===null&&(mt=mt.props.children),typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case R:t:{for(var he=mt.key;ft!==null;){if(ft.key===he){if(he=mt.type,he===M){if(ft.tag===7){f(gt,ft.sibling),Dt=_(ft,mt.props.children),Dt.return=gt,gt=Dt;break t}}else if(ft.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===y&&Br(he)===ft.type){f(gt,ft.sibling),Dt=_(ft,mt.props),$l(Dt,mt),Dt.return=gt,gt=Dt;break t}f(gt,ft);break}else i(gt,ft);ft=ft.sibling}mt.type===M?(Dt=us(mt.props.children,gt.mode,Dt,mt.key),Dt.return=gt,gt=Dt):(Dt=Po(mt.type,mt.key,mt.props,null,gt.mode,Dt),$l(Dt,mt),Dt.return=gt,gt=Dt)}return q(gt);case v:t:{for(he=mt.key;ft!==null;){if(ft.key===he)if(ft.tag===4&&ft.stateNode.containerInfo===mt.containerInfo&&ft.stateNode.implementation===mt.implementation){f(gt,ft.sibling),Dt=_(ft,mt.children||[]),Dt.return=gt,gt=Dt;break t}else{f(gt,ft);break}else i(gt,ft);ft=ft.sibling}Dt=oc(mt,gt.mode,Dt),Dt.return=gt,gt=Dt}return q(gt);case y:return mt=Br(mt),Un(gt,ft,mt,Dt)}if(Y(mt))return ie(gt,ft,mt,Dt);if(K(mt)){if(he=K(mt),typeof he!="function")throw Error(a(150));return mt=he.call(mt),_e(gt,ft,mt,Dt)}if(typeof mt.then=="function")return Un(gt,ft,Wl(mt),Dt);if(mt.$$typeof===x)return Un(gt,ft,Ql(gt,mt),Dt);Ks(gt,mt)}return typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint"?(mt=""+mt,ft!==null&&ft.tag===6?(f(gt,ft.sibling),Dt=_(ft,mt),Dt.return=gt,gt=Dt):(f(gt,ft),Dt=Yl(mt,gt.mode,Dt),Dt.return=gt,gt=Dt),q(gt)):f(gt,ft)}return function(gt,ft,mt,Dt){try{Zl=0;var he=Un(gt,ft,mt,Dt);return hs=null,he}catch(le){if(le===Ys||le===pc)throw le;var pn=Ia(29,le,null,gt.mode);return pn.lanes=Dt,pn.return=gt,pn}finally{}}}var Qs=ge(!0),Qh=ge(!1),Pr=!1;function Xs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sd(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function gs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ps(e,i,f){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,(ve&2)!==0){var _=h.pending;return _===null?i.next=i:(i.next=_.next,_.next=i),h.pending=i,i=Vl(e),Wf(e,null,f),i}return xr(e,h,i,f),Vl(e)}function tu(e,i,f){if(i=i.updateQueue,i!==null&&(i=i.shared,(f&4194048)!==0)){var h=i.lanes;h&=e.pendingLanes,f|=h,i.lanes=f,Rn(e,f)}}function od(e,i){var f=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,f===h)){var _=null,w=null;if(f=f.firstBaseUpdate,f!==null){do{var q={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};w===null?_=w=q:w=w.next=q,f=f.next}while(f!==null);w===null?_=w=i:w=w.next=i}else _=w=i;f={baseState:h.baseState,firstBaseUpdate:_,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},e.updateQueue=f;return}e=f.lastBaseUpdate,e===null?f.firstBaseUpdate=i:e.next=i,f.lastBaseUpdate=i}var eu=!1;function Ko(){if(eu){var e=ds;if(e!==null)throw e}}function ms(e,i,f,h){eu=!1;var _=e.updateQueue;Pr=!1;var w=_.firstBaseUpdate,q=_.lastBaseUpdate,$=_.shared.pending;if($!==null){_.shared.pending=null;var lt=$,vt=lt.next;lt.next=null,q===null?w=vt:q.next=vt,q=lt;var xt=e.alternate;xt!==null&&(xt=xt.updateQueue,$=xt.lastBaseUpdate,$!==q&&($===null?xt.firstBaseUpdate=vt:$.next=vt,xt.lastBaseUpdate=lt))}if(w!==null){var jt=_.baseState;q=0,xt=vt=lt=null,$=w;do{var bt=$.lane&-536870913,Ct=bt!==$.lane;if(Ct?(Pe&bt)===bt:(h&bt)===bt){bt!==0&&bt===ks&&(eu=!0),xt!==null&&(xt=xt.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});t:{var ie=e,_e=$;bt=i;var Un=f;switch(_e.tag){case 1:if(ie=_e.payload,typeof ie=="function"){jt=ie.call(Un,jt,bt);break t}jt=ie;break t;case 3:ie.flags=ie.flags&-65537|128;case 0:if(ie=_e.payload,bt=typeof ie=="function"?ie.call(Un,jt,bt):ie,bt==null)break t;jt=C({},jt,bt);break t;case 2:Pr=!0}}bt=$.callback,bt!==null&&(e.flags|=64,Ct&&(e.flags|=8192),Ct=_.callbacks,Ct===null?_.callbacks=[bt]:Ct.push(bt))}else Ct={lane:bt,tag:$.tag,payload:$.payload,callback:$.callback,next:null},xt===null?(vt=xt=Ct,lt=jt):xt=xt.next=Ct,q|=bt;if($=$.next,$===null){if($=_.shared.pending,$===null)break;Ct=$,$=Ct.next,Ct.next=null,_.lastBaseUpdate=Ct,_.shared.pending=null}}while(!0);xt===null&&(lt=jt),_.baseState=lt,_.firstBaseUpdate=vt,_.lastBaseUpdate=xt,w===null&&(_.shared.lanes=0),Ts|=q,e.lanes=q,e.memoizedState=jt}}function ld(e,i){if(typeof e!="function")throw Error(a(191,e));e.call(i)}function Xh(e,i){var f=e.callbacks;if(f!==null)for(e.callbacks=null,e=0;e<f.length;e++)ld(f[e],i)}var Qo=Z(null),or=Z(0);function lr(e,i){e=Bi,st(or,e),st(Qo,i),Bi=e|i.baseLanes}function ya(){st(or,Bi),st(Qo,Qo.current)}function ur(){Bi=or.current,it(Qo),it(or)}var qn=Z(null),Di=null;function vs(e){var i=e.alternate;st(na,na.current&1),st(qn,e),Di===null&&(i===null||Qo.current!==null||i.memoizedState!==null)&&(Di=e)}function da(e){st(na,na.current),st(qn,e),Di===null&&(Di=e)}function cr(e){e.tag===22?(st(na,na.current),st(qn,e),Di===null&&(Di=e)):ys()}function ys(){st(na,na.current),st(qn,qn.current)}function _i(e){it(qn),Di===e&&(Di=null),it(na)}var na=Z(0);function yc(e){for(var i=e;i!==null;){if(i.tag===13){var f=i.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||lp(f)||up(f)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var fr=0,De=null,yn=null,ha=null,Ir=!1,ji=!1,Fs=!1,Sc=0,nu=0,dr=null,kg=0;function ta(){throw Error(a(321))}function ud(e,i){if(i===null)return!1;for(var f=0;f<i.length&&f<e.length;f++)if(!wa(e[f],i[f]))return!1;return!0}function Js(e,i,f,h,_,w){return fr=w,De=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,D.H=e===null||e.memoizedState===null?Zs:su,Fs=!1,w=f(h,_),Fs=!1,ji&&(w=Jh(i,f,h,_)),Fh(e),w}function Fh(e){D.H=Fo;var i=yn!==null&&yn.next!==null;if(fr=0,ha=yn=De=null,Ir=!1,nu=0,dr=null,i)throw Error(a(300));e===null||ga||(e=e.dependencies,e!==null&&fc(e)&&(ga=!0))}function Jh(e,i,f,h){De=e;var _=0;do{if(ji&&(dr=null),nu=0,ji=!1,25<=_)throw Error(a(301));if(_+=1,ha=yn=null,e.updateQueue!=null){var w=e.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}D.H=Ws,w=i(f,h)}while(ji);return w}function qg(){var e=D.H,i=e.useState()[0];return i=typeof i.then=="function"?au(i):i,e=e.useState()[0],(yn!==null?yn.memoizedState:null)!==e&&(De.flags|=1024),i}function cd(){var e=Sc!==0;return Sc=0,e}function fd(e,i,f){i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~f}function dd(e){if(Ir){for(e=e.memoizedState;e!==null;){var i=e.queue;i!==null&&(i.pending=null),e=e.next}Ir=!1}fr=0,ha=yn=De=null,ji=!1,nu=Sc=0,dr=null}function Xa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ha===null?De.memoizedState=ha=e:ha=ha.next=e,ha}function aa(){if(yn===null){var e=De.alternate;e=e!==null?e.memoizedState:null}else e=yn.next;var i=ha===null?De.memoizedState:ha.next;if(i!==null)ha=i,yn=e;else{if(e===null)throw De.alternate===null?Error(a(467)):Error(a(310));yn=e,e={memoizedState:yn.memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},ha===null?De.memoizedState=ha=e:ha=ha.next=e}return ha}function bc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function au(e){var i=nu;return nu+=1,dr===null&&(dr=[]),e=mc(dr,e,i),i=De,(ha===null?i.memoizedState:ha.next)===null&&(i=i.alternate,D.H=i===null||i.memoizedState===null?Zs:su),e}function _c(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return au(e);if(e.$$typeof===x)return Ln(e)}throw Error(a(438,String(e)))}function hd(e){var i=null,f=De.updateQueue;if(f!==null&&(i=f.memoCache),i==null){var h=De.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(i={data:h.data.map(function(_){return _.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),f===null&&(f=bc(),De.updateQueue=f),f.memoCache=i,f=i.data[i.index],f===void 0)for(f=i.data[i.index]=Array(e),h=0;h<e;h++)f[h]=U;return i.index++,f}function hr(e,i){return typeof i=="function"?i(e):i}function Ec(e){var i=aa();return gd(i,yn,e)}function gd(e,i,f){var h=e.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=f;var _=e.baseQueue,w=h.pending;if(w!==null){if(_!==null){var q=_.next;_.next=w.next,w.next=q}i.baseQueue=_=w,h.pending=null}if(w=e.baseState,_===null)e.memoizedState=w;else{i=_.next;var $=q=null,lt=null,vt=i,xt=!1;do{var jt=vt.lane&-536870913;if(jt!==vt.lane?(Pe&jt)===jt:(fr&jt)===jt){var bt=vt.revertLane;if(bt===0)lt!==null&&(lt=lt.next={lane:0,revertLane:0,gesture:null,action:vt.action,hasEagerState:vt.hasEagerState,eagerState:vt.eagerState,next:null}),jt===ks&&(xt=!0);else if((fr&bt)===bt){vt=vt.next,bt===ks&&(xt=!0);continue}else jt={lane:0,revertLane:vt.revertLane,gesture:null,action:vt.action,hasEagerState:vt.hasEagerState,eagerState:vt.eagerState,next:null},lt===null?($=lt=jt,q=w):lt=lt.next=jt,De.lanes|=bt,Ts|=bt;jt=vt.action,Fs&&f(w,jt),w=vt.hasEagerState?vt.eagerState:f(w,jt)}else bt={lane:jt,revertLane:vt.revertLane,gesture:vt.gesture,action:vt.action,hasEagerState:vt.hasEagerState,eagerState:vt.eagerState,next:null},lt===null?($=lt=bt,q=w):lt=lt.next=bt,De.lanes|=jt,Ts|=jt;vt=vt.next}while(vt!==null&&vt!==i);if(lt===null?q=w:lt.next=$,!wa(w,e.memoizedState)&&(ga=!0,xt&&(f=ds,f!==null)))throw f;e.memoizedState=w,e.baseState=q,e.baseQueue=lt,h.lastRenderedState=w}return _===null&&(h.lanes=0),[e.memoizedState,h.dispatch]}function pd(e){var i=aa(),f=i.queue;if(f===null)throw Error(a(311));f.lastRenderedReducer=e;var h=f.dispatch,_=f.pending,w=i.memoizedState;if(_!==null){f.pending=null;var q=_=_.next;do w=e(w,q.action),q=q.next;while(q!==_);wa(w,i.memoizedState)||(ga=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),f.lastRenderedState=w}return[w,h]}function Zh(e,i,f){var h=De,_=aa(),w=Fe;if(w){if(f===void 0)throw Error(a(407));f=f()}else f=i();var q=!wa((yn||_).memoizedState,f);if(q&&(_.memoizedState=f,ga=!0),_=_.queue,_d(md.bind(null,h,_,e),[e]),_.getSnapshot!==i||q||ha!==null&&ha.memoizedState.tag&1){if(h.flags|=2048,Xo(9,{destroy:void 0},$h.bind(null,h,_,f,i),null),ke===null)throw Error(a(349));w||(fr&127)!==0||Wh(h,i,f)}return f}function Wh(e,i,f){e.flags|=16384,e={getSnapshot:i,value:f},i=De.updateQueue,i===null?(i=bc(),De.updateQueue=i,i.stores=[e]):(f=i.stores,f===null?i.stores=[e]:f.push(e))}function $h(e,i,f,h){i.value=f,i.getSnapshot=h,vd(i)&&t0(e)}function md(e,i,f){return f(function(){vd(i)&&t0(e)})}function vd(e){var i=e.getSnapshot;e=e.value;try{var f=i();return!wa(e,f)}catch{return!0}}function t0(e){var i=vi(e,2);i!==null&&gn(i,e,2)}function Cc(e){var i=Xa();if(typeof e=="function"){var f=e;if(e=f(),Fs){qt(!0);try{f()}finally{qt(!1)}}}return i.memoizedState=i.baseState=e,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:e},i}function yd(e,i,f,h){return e.baseState=f,gd(e,yn,typeof h=="function"?h:hr)}function e0(e,i,f,h,_){if(ru(e))throw Error(a(485));if(e=i.action,e!==null){var w={payload:_,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){w.listeners.push(q)}};D.T!==null?f(!0):w.isTransition=!1,h(w),f=i.pending,f===null?(w.next=i.pending=w,Tc(i,w)):(w.next=f.next,i.pending=f.next=w)}}function Tc(e,i){var f=i.action,h=i.payload,_=e.state;if(i.isTransition){var w=D.T,q={};D.T=q;try{var $=f(_,h),lt=D.S;lt!==null&&lt(q,$),Ac(e,i,$)}catch(vt){Sd(e,i,vt)}finally{w!==null&&q.types!==null&&(w.types=q.types),D.T=w}}else try{w=f(_,h),Ac(e,i,w)}catch(vt){Sd(e,i,vt)}}function Ac(e,i,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(h){n0(e,i,h)},function(h){return Sd(e,i,h)}):n0(e,i,f)}function n0(e,i,f){i.status="fulfilled",i.value=f,a0(i),e.state=f,i=e.pending,i!==null&&(f=i.next,f===i?e.pending=null:(f=f.next,i.next=f,Tc(e,f)))}function Sd(e,i,f){var h=e.pending;if(e.pending=null,h!==null){h=h.next;do i.status="rejected",i.reason=f,a0(i),i=i.next;while(i!==h)}e.action=null}function a0(e){e=e.listeners;for(var i=0;i<e.length;i++)(0,e[i])()}function i0(e,i){return i}function bd(e,i){if(Fe){var f=ke.formState;if(f!==null){t:{var h=De;if(Fe){if(xn){e:{for(var _=xn,w=Qa;_.nodeType!==8;){if(!w){_=null;break e}if(_=Cr(_.nextSibling),_===null){_=null;break e}}w=_.data,_=w==="F!"||w==="F"?_:null}if(_){xn=Cr(_.nextSibling),h=_.data==="F!";break t}}Mr(h)}h=!1}h&&(i=f[0])}}return f=Xa(),f.memoizedState=f.baseState=i,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i0,lastRenderedState:i},f.queue=h,f=Ad.bind(null,De,h),h.dispatch=f,h=Cc(!1),w=ia.bind(null,De,!1,h.queue),h=Xa(),_={state:i,dispatch:null,action:e,pending:null},h.queue=_,f=e0.bind(null,De,_,w,f),_.dispatch=f,h.memoizedState=e,[i,f,!1]}function r0(e){var i=aa();return s0(i,yn,e)}function s0(e,i,f){if(i=gd(e,i,i0)[0],e=Ec(hr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var h=au(i)}catch(q){throw q===Ys?pc:q}else h=i;i=aa();var _=i.queue,w=_.dispatch;return f!==i.memoizedState&&(De.flags|=2048,Xo(9,{destroy:void 0},Vg.bind(null,_,f),null)),[h,w,e]}function Vg(e,i){e.action=i}function o0(e){var i=aa(),f=yn;if(f!==null)return s0(i,f,e);aa(),i=i.memoizedState,f=aa();var h=f.queue.dispatch;return f.memoizedState=e,[i,h,!1]}function Xo(e,i,f,h){return e={tag:e,create:f,deps:h,inst:i,next:null},i=De.updateQueue,i===null&&(i=bc(),De.updateQueue=i),f=i.lastEffect,f===null?i.lastEffect=e.next=e:(h=f.next,f.next=e,e.next=h,i.lastEffect=e),e}function l0(){return aa().memoizedState}function wc(e,i,f,h){var _=Xa();De.flags|=e,_.memoizedState=Xo(1|i,{destroy:void 0},f,h===void 0?null:h)}function Rc(e,i,f,h){var _=aa();h=h===void 0?null:h;var w=_.memoizedState.inst;yn!==null&&h!==null&&ud(h,yn.memoizedState.deps)?_.memoizedState=Xo(i,w,f,h):(De.flags|=e,_.memoizedState=Xo(1|i,w,f,h))}function u0(e,i){wc(8390656,8,e,i)}function _d(e,i){Rc(2048,8,e,i)}function Yg(e){De.flags|=4;var i=De.updateQueue;if(i===null)i=bc(),De.updateQueue=i,i.events=[e];else{var f=i.events;f===null?i.events=[e]:f.push(e)}}function c0(e){var i=aa().memoizedState;return Yg({ref:i,nextImpl:e}),function(){if((ve&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function f0(e,i){return Rc(4,2,e,i)}function d0(e,i){return Rc(4,4,e,i)}function h0(e,i){if(typeof i=="function"){e=e();var f=i(e);return function(){typeof f=="function"?f():i(null)}}if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function g0(e,i,f){f=f!=null?f.concat([e]):null,Rc(4,4,h0.bind(null,i,e),f)}function Oc(){}function p0(e,i){var f=aa();i=i===void 0?null:i;var h=f.memoizedState;return i!==null&&ud(i,h[1])?h[0]:(f.memoizedState=[e,i],e)}function m0(e,i){var f=aa();i=i===void 0?null:i;var h=f.memoizedState;if(i!==null&&ud(i,h[1]))return h[0];if(h=e(),Fs){qt(!0);try{e()}finally{qt(!1)}}return f.memoizedState=[h,i],h}function Ei(e,i,f){return f===void 0||(fr&1073741824)!==0&&(Pe&261930)===0?e.memoizedState=i:(e.memoizedState=f,e=Kr(),De.lanes|=e,Ts|=e,f)}function Ed(e,i,f,h){return wa(f,i)?f:Qo.current!==null?(e=Ei(e,f,h),wa(e,i)||(ga=!0),e):(fr&42)===0||(fr&1073741824)!==0&&(Pe&261930)===0?(ga=!0,e.memoizedState=f):(e=Kr(),De.lanes|=e,Ts|=e,i)}function xc(e,i,f,h,_){var w=H.p;H.p=w!==0&&8>w?w:8;var q=D.T,$={};D.T=$,ia(e,!1,i,f);try{var lt=_(),vt=D.S;if(vt!==null&&vt($,lt),lt!==null&&typeof lt=="object"&&typeof lt.then=="function"){var xt=bi(lt,h);iu(e,i,xt,qa(e))}else iu(e,i,h,qa(e))}catch(jt){iu(e,i,{then:function(){},status:"rejected",reason:jt},qa())}finally{H.p=w,q!==null&&$.types!==null&&(q.types=$.types),D.T=q}}function v0(){}function Nc(e,i,f,h){if(e.tag!==5)throw Error(a(476));var _=Cd(e).queue;xc(e,_,i,F,f===null?v0:function(){return y0(e),f(h)})}function Cd(e){var i=e.memoizedState;if(i!==null)return i;i={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:F},next:null};var f={};return i.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:f},next:null},e.memoizedState=i,e=e.alternate,e!==null&&(e.memoizedState=i),i}function y0(e){var i=Cd(e);i.next===null&&(i=e.alternate.memoizedState),iu(e,i.next.queue,{},qa())}function Mc(){return Ln(Vd)}function Td(){return aa().memoizedState}function S0(){return aa().memoizedState}function Kg(e){for(var i=e.return;i!==null;){switch(i.tag){case 24:case 3:var f=qa();e=gs(f);var h=ps(i,e,f);h!==null&&(gn(h,i,f),tu(h,i,f)),i={cache:dc()},e.payload=i;return}i=i.return}}function Qg(e,i,f){var h=qa();f={lane:h,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},ru(e)?b0(i,f):(f=Ls(e,i,f,h),f!==null&&(gn(f,e,h),wd(f,i,h)))}function Ad(e,i,f){var h=qa();iu(e,i,f,h)}function iu(e,i,f,h){var _={lane:h,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(ru(e))b0(i,_);else{var w=e.alternate;if(e.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var q=i.lastRenderedState,$=w(q,f);if(_.hasEagerState=!0,_.eagerState=$,wa($,q))return xr(e,i,_,0),ke===null&&ql(),!1}catch{}finally{}if(f=Ls(e,i,_,h),f!==null)return gn(f,e,h),wd(f,i,h),!0}return!1}function ia(e,i,f,h){if(h={lane:2,revertLane:Jg(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},ru(e)){if(i)throw Error(a(479))}else i=Ls(e,f,h,2),i!==null&&gn(i,e,2)}function ru(e){var i=e.alternate;return e===De||i!==null&&i===De}function b0(e,i){ji=Ir=!0;var f=e.pending;f===null?i.next=i:(i.next=f.next,f.next=i),e.pending=i}function wd(e,i,f){if((f&4194048)!==0){var h=i.lanes;h&=e.pendingLanes,f|=h,i.lanes=f,Rn(e,f)}}var Fo={readContext:Ln,use:_c,useCallback:ta,useContext:ta,useEffect:ta,useImperativeHandle:ta,useLayoutEffect:ta,useInsertionEffect:ta,useMemo:ta,useReducer:ta,useRef:ta,useState:ta,useDebugValue:ta,useDeferredValue:ta,useTransition:ta,useSyncExternalStore:ta,useId:ta,useHostTransitionStatus:ta,useFormState:ta,useActionState:ta,useOptimistic:ta,useMemoCache:ta,useCacheRefresh:ta};Fo.useEffectEvent=ta;var Zs={readContext:Ln,use:_c,useCallback:function(e,i){return Xa().memoizedState=[e,i===void 0?null:i],e},useContext:Ln,useEffect:u0,useImperativeHandle:function(e,i,f){f=f!=null?f.concat([e]):null,wc(4194308,4,h0.bind(null,i,e),f)},useLayoutEffect:function(e,i){return wc(4194308,4,e,i)},useInsertionEffect:function(e,i){wc(4,2,e,i)},useMemo:function(e,i){var f=Xa();i=i===void 0?null:i;var h=e();if(Fs){qt(!0);try{e()}finally{qt(!1)}}return f.memoizedState=[h,i],h},useReducer:function(e,i,f){var h=Xa();if(f!==void 0){var _=f(i);if(Fs){qt(!0);try{f(i)}finally{qt(!1)}}}else _=i;return h.memoizedState=h.baseState=_,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:_},h.queue=e,e=e.dispatch=Qg.bind(null,De,e),[h.memoizedState,e]},useRef:function(e){var i=Xa();return e={current:e},i.memoizedState=e},useState:function(e){e=Cc(e);var i=e.queue,f=Ad.bind(null,De,i);return i.dispatch=f,[e.memoizedState,f]},useDebugValue:Oc,useDeferredValue:function(e,i){var f=Xa();return Ei(f,e,i)},useTransition:function(){var e=Cc(!1);return e=xc.bind(null,De,e.queue,!0,!1),Xa().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,i,f){var h=De,_=Xa();if(Fe){if(f===void 0)throw Error(a(407));f=f()}else{if(f=i(),ke===null)throw Error(a(349));(Pe&127)!==0||Wh(h,i,f)}_.memoizedState=f;var w={value:f,getSnapshot:i};return _.queue=w,u0(md.bind(null,h,w,e),[e]),h.flags|=2048,Xo(9,{destroy:void 0},$h.bind(null,h,w,f,i),null),f},useId:function(){var e=Xa(),i=ke.identifierPrefix;if(Fe){var f=qi,h=ki;f=(h&~(1<<32-an(h)-1)).toString(32)+f,i="_"+i+"R_"+f,f=Sc++,0<f&&(i+="H"+f.toString(32)),i+="_"}else f=kg++,i="_"+i+"r_"+f.toString(32)+"_";return e.memoizedState=i},useHostTransitionStatus:Mc,useFormState:bd,useActionState:bd,useOptimistic:function(e){var i=Xa();i.memoizedState=i.baseState=e;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=f,i=ia.bind(null,De,!0,f),f.dispatch=i,[e,i]},useMemoCache:hd,useCacheRefresh:function(){return Xa().memoizedState=Kg.bind(null,De)},useEffectEvent:function(e){var i=Xa(),f={impl:e};return i.memoizedState=f,function(){if((ve&2)!==0)throw Error(a(440));return f.impl.apply(void 0,arguments)}}},su={readContext:Ln,use:_c,useCallback:p0,useContext:Ln,useEffect:_d,useImperativeHandle:g0,useInsertionEffect:f0,useLayoutEffect:d0,useMemo:m0,useReducer:Ec,useRef:l0,useState:function(){return Ec(hr)},useDebugValue:Oc,useDeferredValue:function(e,i){var f=aa();return Ed(f,yn.memoizedState,e,i)},useTransition:function(){var e=Ec(hr)[0],i=aa().memoizedState;return[typeof e=="boolean"?e:au(e),i]},useSyncExternalStore:Zh,useId:Td,useHostTransitionStatus:Mc,useFormState:r0,useActionState:r0,useOptimistic:function(e,i){var f=aa();return yd(f,yn,e,i)},useMemoCache:hd,useCacheRefresh:S0};su.useEffectEvent=c0;var Ws={readContext:Ln,use:_c,useCallback:p0,useContext:Ln,useEffect:_d,useImperativeHandle:g0,useInsertionEffect:f0,useLayoutEffect:d0,useMemo:m0,useReducer:pd,useRef:l0,useState:function(){return pd(hr)},useDebugValue:Oc,useDeferredValue:function(e,i){var f=aa();return yn===null?Ei(f,e,i):Ed(f,yn.memoizedState,e,i)},useTransition:function(){var e=pd(hr)[0],i=aa().memoizedState;return[typeof e=="boolean"?e:au(e),i]},useSyncExternalStore:Zh,useId:Td,useHostTransitionStatus:Mc,useFormState:o0,useActionState:o0,useOptimistic:function(e,i){var f=aa();return yn!==null?yd(f,yn,e,i):(f.baseState=e,[e,f.queue.dispatch])},useMemoCache:hd,useCacheRefresh:S0};Ws.useEffectEvent=c0;function Ss(e,i,f,h){i=e.memoizedState,f=f(h,i),f=f==null?i:C({},i,f),e.memoizedState=f,e.lanes===0&&(e.updateQueue.baseState=f)}var Fa={enqueueSetState:function(e,i,f){e=e._reactInternals;var h=qa(),_=gs(h);_.payload=i,f!=null&&(_.callback=f),i=ps(e,_,h),i!==null&&(gn(i,e,h),tu(i,e,h))},enqueueReplaceState:function(e,i,f){e=e._reactInternals;var h=qa(),_=gs(h);_.tag=1,_.payload=i,f!=null&&(_.callback=f),i=ps(e,_,h),i!==null&&(gn(i,e,h),tu(i,e,h))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var f=qa(),h=gs(f);h.tag=2,i!=null&&(h.callback=i),i=ps(e,h,f),i!==null&&(gn(i,e,f),tu(i,e,f))}};function _0(e,i,f,h,_,w,q){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,w,q):i.prototype&&i.prototype.isPureReactComponent?!Ni(f,h)||!Ni(_,w):!0}function E0(e,i,f,h){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(f,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(f,h),i.state!==e&&Fa.enqueueReplaceState(i,i.state,null)}function gr(e,i){var f=i;if("ref"in i){f={};for(var h in i)h!=="ref"&&(f[h]=i[h])}if(e=e.defaultProps){f===i&&(f=C({},f));for(var _ in e)f[_]===void 0&&(f[_]=e[_])}return f}function ou(e){Ii(e)}function lu(e){console.error(e)}function Dc(e){Ii(e)}function jc(e,i){try{var f=e.onUncaughtError;f(i.value,{componentStack:i.stack})}catch(h){setTimeout(function(){throw h})}}function C0(e,i,f){try{var h=e.onCaughtError;h(f.value,{componentStack:f.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function Ci(e,i,f){return f=gs(f),f.tag=3,f.payload={element:null},f.callback=function(){jc(e,i)},f}function Rd(e){return e=gs(e),e.tag=3,e}function T0(e,i,f,h){var _=f.type.getDerivedStateFromError;if(typeof _=="function"){var w=h.value;e.payload=function(){return _(w)},e.callback=function(){C0(i,f,h)}}var q=f.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(e.callback=function(){C0(i,f,h),typeof _!="function"&&($a===null?$a=new Set([this]):$a.add(this));var $=h.stack;this.componentDidCatch(h.value,{componentStack:$!==null?$:""})})}function Od(e,i,f,h,_){if(f.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(i=f.alternate,i!==null&&ko(i,f,_,!0),f=qn.current,f!==null){switch(f.tag){case 31:case 13:return Di===null?b():f.alternate===null&&Mn===0&&(Mn=3),f.flags&=-257,f.flags|=65536,f.lanes=_,h===Jl?f.flags|=16384:(i=f.updateQueue,i===null?f.updateQueue=new Set([h]):i.add(h),wn(e,h,_)),!1;case 22:return f.flags|=65536,h===Jl?f.flags|=16384:(i=f.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([h])},f.updateQueue=i):(f=i.retryQueue,f===null?i.retryQueue=new Set([h]):f.add(h)),wn(e,h,_)),!1}throw Error(a(435,f.tag))}return wn(e,h,_),b(),!1}if(Fe)return i=qn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=_,h!==uc&&(e=Error(a(422),{cause:h}),Ho(yi(e,f)))):(h!==uc&&(i=Error(a(423),{cause:h}),Ho(yi(i,f))),e=e.current.alternate,e.flags|=65536,_&=-_,e.lanes|=_,h=yi(h,f),_=Ci(e.stateNode,h,_),od(e,_),Mn!==4&&(Mn=2)),!1;var w=Error(a(520),{cause:h});if(w=yi(w,f),sn===null?sn=[w]:sn.push(w),Mn!==4&&(Mn=2),i===null)return!0;h=yi(h,f),f=i;do{switch(f.tag){case 3:return f.flags|=65536,e=_&-_,f.lanes|=e,e=Ci(f.stateNode,h,e),od(f,e),!1;case 1:if(i=f.type,w=f.stateNode,(f.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&($a===null||!$a.has(w))))return f.flags|=65536,_&=-_,f.lanes|=_,_=Rd(_),T0(_,e,f,h),od(f,_),!1}f=f.return}while(f!==null);return!1}var xd=Error(a(461)),ga=!1;function Ma(e,i,f,h){i.child=e===null?Qh(i,null,f,h):Qs(i,e.child,f,h)}function Jo(e,i,f,h,_){f=f.render;var w=i.ref;if("ref"in h){var q={};for(var $ in h)$!=="ref"&&(q[$]=h[$])}else q=h;return Dr(i),h=Js(e,i,f,q,w,_),$=cd(),e!==null&&!ga?(fd(e,i,_),Qi(e,i,_)):(Fe&&$&&Kl(i),i.flags|=1,Ma(e,i,h,_),i.child)}function oi(e,i,f,h,_){if(e===null){var w=f.type;return typeof w=="function"&&!rc(w)&&w.defaultProps===void 0&&f.compare===null?(i.tag=15,i.type=w,Uc(e,i,w,h,_)):(e=Po(f.type,null,h,i,i.mode,_),e.ref=i.ref,e.return=i,i.child=e)}if(w=e.child,!Ja(e,_)){var q=w.memoizedProps;if(f=f.compare,f=f!==null?f:Ni,f(q,h)&&e.ref===i.ref)return Qi(e,i,_)}return i.flags|=1,e=Gi(w,h),e.ref=i.ref,e.return=i,i.child=e}function Uc(e,i,f,h,_){if(e!==null){var w=e.memoizedProps;if(Ni(w,h)&&e.ref===i.ref)if(ga=!1,i.pendingProps=h=w,Ja(e,_))(e.flags&131072)!==0&&(ga=!0);else return i.lanes=e.lanes,Qi(e,i,_)}return li(e,i,f,h,_)}function Nd(e,i,f,h){var _=h.children,w=e!==null?e.memoizedState:null;if(e===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((i.flags&128)!==0){if(w=w!==null?w.baseLanes|f:f,e!==null){for(h=i.child=e.child,_=0;h!==null;)_=_|h.lanes|h.childLanes,h=h.sibling;h=_&~w}else h=0,i.child=null;return Md(e,i,w,f,h)}if((f&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},e!==null&&jr(i,w!==null?w.cachePool:null),w!==null?lr(i,w):ya(),cr(i);else return h=i.lanes=536870912,Md(e,i,w!==null?w.baseLanes|f:f,f,h)}else w!==null?(jr(i,w.cachePool),lr(i,w),ys(),i.memoizedState=null):(e!==null&&jr(i,null),ya(),ys());return Ma(e,i,_,f),i.child}function $s(e,i){return e!==null&&e.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Md(e,i,f,h,_){var w=Yo();return w=w===null?null:{parent:fa._currentValue,pool:w},i.memoizedState={baseLanes:f,cachePool:w},e!==null&&jr(i,null),ya(),cr(i),e!==null&&ko(e,i,h,!0),i.childLanes=_,null}function Gr(e,i){return i=Sa({mode:i.mode,children:i.children},e.mode),i.ref=e.ref,e.child=i,i.return=e,i}function to(e,i,f){return Qs(i,e.child,null,f),e=Gr(i,i.pendingProps),e.flags|=2,_i(i),i.memoizedState=null,e}function Bc(e,i,f){var h=i.pendingProps,_=(i.flags&128)!==0;if(i.flags&=-129,e===null){if(Fe){if(h.mode==="hidden")return e=Gr(i,h),i.lanes=536870912,$s(null,e);if(da(i),(e=xn)?(e=Pv(e,Qa),e=e!==null&&e.data==="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:Nr!==null?{id:ki,overflow:qi}:null,retryLane:536870912,hydrationErrors:null},f=ii(e),f.return=i,i.child=f,Na=i,xn=null)):e=null,e===null)throw Mr(i);return i.lanes=536870912,null}return Gr(i,h)}var w=e.memoizedState;if(w!==null){var q=w.dehydrated;if(da(i),_)if(i.flags&256)i.flags&=-257,i=to(e,i,f);else if(i.memoizedState!==null)i.child=e.child,i.flags|=128,i=null;else throw Error(a(558));else if(ga||ko(e,i,f,!1),_=(f&e.childLanes)!==0,ga||_){if(h=ke,h!==null&&(q=On(h,f),q!==0&&q!==w.retryLane))throw w.retryLane=q,vi(e,q),gn(h,e,q),xd;b(),i=to(e,i,f)}else e=w.treeContext,xn=Cr(q.nextSibling),Na=i,Fe=!0,Si=null,Qa=!1,e!==null&&Yh(i,e),i=Gr(i,h),i.flags|=4096;return i}return e=Gi(e.child,{mode:h.mode,children:h.children}),e.ref=i.ref,i.child=e,e.return=i,e}function eo(e,i){var f=i.ref;if(f===null)e!==null&&e.ref!==null&&(i.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(a(284));(e===null||e.ref!==f)&&(i.flags|=4194816)}}function li(e,i,f,h,_){return Dr(i),f=Js(e,i,f,h,void 0,_),h=cd(),e!==null&&!ga?(fd(e,i,_),Qi(e,i,_)):(Fe&&h&&Kl(i),i.flags|=1,Ma(e,i,f,_),i.child)}function Ti(e,i,f,h,_,w){return Dr(i),i.updateQueue=null,f=Jh(i,h,f,_),Fh(e),h=cd(),e!==null&&!ga?(fd(e,i,w),Qi(e,i,w)):(Fe&&h&&Kl(i),i.flags|=1,Ma(e,i,f,w),i.child)}function bs(e,i,f,h,_){if(Dr(i),i.stateNode===null){var w=ir,q=f.contextType;typeof q=="object"&&q!==null&&(w=Ln(q)),w=new f(h,w),i.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Fa,i.stateNode=w,w._reactInternals=i,w=i.stateNode,w.props=h,w.state=i.memoizedState,w.refs={},Xs(i),q=f.contextType,w.context=typeof q=="object"&&q!==null?Ln(q):ir,w.state=i.memoizedState,q=f.getDerivedStateFromProps,typeof q=="function"&&(Ss(i,f,q,h),w.state=i.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(q=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),q!==w.state&&Fa.enqueueReplaceState(w,w.state,null),ms(i,h,w,_),Ko(),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308),h=!0}else if(e===null){w=i.stateNode;var $=i.memoizedProps,lt=gr(f,$);w.props=lt;var vt=w.context,xt=f.contextType;q=ir,typeof xt=="object"&&xt!==null&&(q=Ln(xt));var jt=f.getDerivedStateFromProps;xt=typeof jt=="function"||typeof w.getSnapshotBeforeUpdate=="function",$=i.pendingProps!==$,xt||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||($||vt!==q)&&E0(i,w,h,q),Pr=!1;var bt=i.memoizedState;w.state=bt,ms(i,h,w,_),Ko(),vt=i.memoizedState,$||bt!==vt||Pr?(typeof jt=="function"&&(Ss(i,f,jt,h),vt=i.memoizedState),(lt=Pr||_0(i,f,lt,h,bt,vt,q))?(xt||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(i.flags|=4194308)):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=vt),w.props=h,w.state=vt,w.context=q,h=lt):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{w=i.stateNode,sd(e,i),q=i.memoizedProps,xt=gr(f,q),w.props=xt,jt=i.pendingProps,bt=w.context,vt=f.contextType,lt=ir,typeof vt=="object"&&vt!==null&&(lt=Ln(vt)),$=f.getDerivedStateFromProps,(vt=typeof $=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(q!==jt||bt!==lt)&&E0(i,w,h,lt),Pr=!1,bt=i.memoizedState,w.state=bt,ms(i,h,w,_),Ko();var Ct=i.memoizedState;q!==jt||bt!==Ct||Pr||e!==null&&e.dependencies!==null&&fc(e.dependencies)?(typeof $=="function"&&(Ss(i,f,$,h),Ct=i.memoizedState),(xt=Pr||_0(i,f,xt,h,bt,Ct,lt)||e!==null&&e.dependencies!==null&&fc(e.dependencies))?(vt||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,Ct,lt),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,Ct,lt)),typeof w.componentDidUpdate=="function"&&(i.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&bt===e.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&bt===e.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Ct),w.props=h,w.state=Ct,w.context=lt,h=xt):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&bt===e.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&bt===e.memoizedState||(i.flags|=1024),h=!1)}return w=h,eo(e,i),h=(i.flags&128)!==0,w||h?(w=i.stateNode,f=h&&typeof f.getDerivedStateFromError!="function"?null:w.render(),i.flags|=1,e!==null&&h?(i.child=Qs(i,e.child,null,_),i.child=Qs(i,null,f,_)):Ma(e,i,f,_),i.memoizedState=w.state,e=i.child):e=Qi(e,i,_),e}function pr(e,i,f,h){return cs(),i.flags|=256,Ma(e,i,f,h),i.child}var Yi={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ma(e){return{baseLanes:e,cachePool:Vs()}}function no(e,i,f){return e=e!==null?e.childLanes&~f:0,i&&(e|=be),e}function Hr(e,i,f){var h=i.pendingProps,_=!1,w=(i.flags&128)!==0,q;if((q=w)||(q=e!==null&&e.memoizedState===null?!1:(na.current&2)!==0),q&&(_=!0,i.flags&=-129),q=(i.flags&32)!==0,i.flags&=-33,e===null){if(Fe){if(_?vs(i):ys(),(e=xn)?(e=Pv(e,Qa),e=e!==null&&e.data!=="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:Nr!==null?{id:ki,overflow:qi}:null,retryLane:536870912,hydrationErrors:null},f=ii(e),f.return=i,i.child=f,Na=i,xn=null)):e=null,e===null)throw Mr(i);return up(e)?i.lanes=32:i.lanes=536870912,null}var $=h.children;return h=h.fallback,_?(ys(),_=i.mode,$=Sa({mode:"hidden",children:$},_),h=us(h,_,f,null),$.return=i,h.return=i,$.sibling=h,i.child=$,h=i.child,h.memoizedState=ma(f),h.childLanes=no(e,q,f),i.memoizedState=Yi,$s(null,h)):(vs(i),Zo(i,$))}var lt=e.memoizedState;if(lt!==null&&($=lt.dehydrated,$!==null)){if(w)i.flags&256?(vs(i),i.flags&=-257,i=ra(e,i,f)):i.memoizedState!==null?(ys(),i.child=e.child,i.flags|=128,i=null):(ys(),$=h.fallback,_=i.mode,h=Sa({mode:"visible",children:h.children},_),$=us($,_,f,null),$.flags|=2,h.return=i,$.return=i,h.sibling=$,i.child=h,Qs(i,e.child,null,f),h=i.child,h.memoizedState=ma(f),h.childLanes=no(e,q,f),i.memoizedState=Yi,i=$s(null,h));else if(vs(i),up($)){if(q=$.nextSibling&&$.nextSibling.dataset,q)var vt=q.dgst;q=vt,h=Error(a(419)),h.stack="",h.digest=q,Ho({value:h,source:null,stack:null}),i=ra(e,i,f)}else if(ga||ko(e,i,f,!1),q=(f&e.childLanes)!==0,ga||q){if(q=ke,q!==null&&(h=On(q,f),h!==0&&h!==lt.retryLane))throw lt.retryLane=h,vi(e,h),gn(q,e,h),xd;lp($)||b(),i=ra(e,i,f)}else lp($)?(i.flags|=192,i.child=e.child,i=null):(e=lt.treeContext,xn=Cr($.nextSibling),Na=i,Fe=!0,Si=null,Qa=!1,e!==null&&Yh(i,e),i=Zo(i,h.children),i.flags|=4096);return i}return _?(ys(),$=h.fallback,_=i.mode,lt=e.child,vt=lt.sibling,h=Gi(lt,{mode:"hidden",children:h.children}),h.subtreeFlags=lt.subtreeFlags&65011712,vt!==null?$=Gi(vt,$):($=us($,_,f,null),$.flags|=2),$.return=i,h.return=i,h.sibling=$,i.child=h,$s(null,h),h=i.child,$=e.child.memoizedState,$===null?$=ma(f):(_=$.cachePool,_!==null?(lt=fa._currentValue,_=_.parent!==lt?{parent:lt,pool:lt}:_):_=Vs(),$={baseLanes:$.baseLanes|f,cachePool:_}),h.memoizedState=$,h.childLanes=no(e,q,f),i.memoizedState=Yi,$s(e.child,h)):(vs(i),f=e.child,e=f.sibling,f=Gi(f,{mode:"visible",children:h.children}),f.return=i,f.sibling=null,e!==null&&(q=i.deletions,q===null?(i.deletions=[e],i.flags|=16):q.push(e)),i.child=f,i.memoizedState=null,f)}function Zo(e,i){return i=Sa({mode:"visible",children:i},e.mode),i.return=e,e.child=i}function Sa(e,i){return e=Ia(22,e,null,i),e.lanes=0,e}function ra(e,i,f){return Qs(i,e.child,null,f),e=Zo(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function un(e,i,f){e.lanes|=i;var h=e.alternate;h!==null&&(h.lanes|=i),nd(e.return,i,f)}function kr(e,i,f,h,_,w){var q=e.memoizedState;q===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:f,tailMode:_,treeForkCount:w}:(q.isBackwards=i,q.rendering=null,q.renderingStartTime=0,q.last=h,q.tail=f,q.tailMode=_,q.treeForkCount=w)}function Ki(e,i,f){var h=i.pendingProps,_=h.revealOrder,w=h.tail;h=h.children;var q=na.current,$=(q&2)!==0;if($?(q=q&1|2,i.flags|=128):q&=1,st(na,q),Ma(e,i,h,f),h=Fe?Go:0,!$&&e!==null&&(e.flags&128)!==0)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&un(e,f,i);else if(e.tag===19)un(e,f,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(_){case"forwards":for(f=i.child,_=null;f!==null;)e=f.alternate,e!==null&&yc(e)===null&&(_=f),f=f.sibling;f=_,f===null?(_=i.child,i.child=null):(_=f.sibling,f.sibling=null),kr(i,!1,_,f,w,h);break;case"backwards":case"unstable_legacy-backwards":for(f=null,_=i.child,i.child=null;_!==null;){if(e=_.alternate,e!==null&&yc(e)===null){i.child=_;break}e=_.sibling,_.sibling=f,f=_,_=e}kr(i,!0,f,null,w,h);break;case"together":kr(i,!1,null,null,void 0,h);break;default:i.memoizedState=null}return i.child}function Qi(e,i,f){if(e!==null&&(i.dependencies=e.dependencies),Ts|=i.lanes,(f&i.childLanes)===0)if(e!==null){if(ko(e,i,f,!1),(f&i.childLanes)===0)return null}else return null;if(e!==null&&i.child!==e.child)throw Error(a(153));if(i.child!==null){for(e=i.child,f=Gi(e,e.pendingProps),i.child=f,f.return=i;e.sibling!==null;)e=e.sibling,f=f.sibling=Gi(e,e.pendingProps),f.return=i;f.sibling=null}return i.child}function Ja(e,i){return(e.lanes&i)!==0?!0:(e=e.dependencies,!!(e!==null&&fc(e)))}function zc(e,i,f){switch(i.tag){case 3:dt(i,i.stateNode.containerInfo),fs(i,fa,e.memoizedState.cache),cs();break;case 27:case 5:Ut(i);break;case 4:dt(i,i.stateNode.containerInfo);break;case 10:fs(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,da(i),null;break;case 13:var h=i.memoizedState;if(h!==null)return h.dehydrated!==null?(vs(i),i.flags|=128,null):(f&i.child.childLanes)!==0?Hr(e,i,f):(vs(i),e=Qi(e,i,f),e!==null?e.sibling:null);vs(i);break;case 19:var _=(e.flags&128)!==0;if(h=(f&i.childLanes)!==0,h||(ko(e,i,f,!1),h=(f&i.childLanes)!==0),_){if(h)return Ki(e,i,f);i.flags|=128}if(_=i.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),st(na,na.current),h)break;return null;case 22:return i.lanes=0,Nd(e,i,f,i.pendingProps);case 24:fs(i,fa,e.memoizedState.cache)}return Qi(e,i,f)}function _s(e,i,f){if(e!==null)if(e.memoizedProps!==i.pendingProps)ga=!0;else{if(!Ja(e,f)&&(i.flags&128)===0)return ga=!1,zc(e,i,f);ga=(e.flags&131072)!==0}else ga=!1,Fe&&(i.flags&1048576)!==0&&lc(i,Go,i.index);switch(i.lanes=0,i.tag){case 16:t:{var h=i.pendingProps;if(e=Br(i.elementType),i.type=e,typeof e=="function")rc(e)?(h=gr(e,h),i.tag=1,i=bs(null,i,e,h,f)):(i.tag=0,i=li(null,i,e,h,f));else{if(e!=null){var _=e.$$typeof;if(_===L){i.tag=11,i=Jo(null,i,e,h,f);break t}else if(_===A){i.tag=14,i=oi(null,i,e,h,f);break t}}throw i=X(e)||e,Error(a(306,i,""))}}return i;case 0:return li(e,i,i.type,i.pendingProps,f);case 1:return h=i.type,_=gr(h,i.pendingProps),bs(e,i,h,_,f);case 3:t:{if(dt(i,i.stateNode.containerInfo),e===null)throw Error(a(387));h=i.pendingProps;var w=i.memoizedState;_=w.element,sd(e,i),ms(i,h,null,f);var q=i.memoizedState;if(h=q.cache,fs(i,fa,h),h!==w.cache&&ad(i,[fa],f,!0),Ko(),h=q.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:q.cache},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){i=pr(e,i,h,f);break t}else if(h!==_){_=yi(Error(a(424)),i),Ho(_),i=pr(e,i,h,f);break t}else{switch(e=i.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(xn=Cr(e.firstChild),Na=i,Fe=!0,Si=null,Qa=!0,f=Qh(i,null,h,f),i.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(cs(),h===_){i=Qi(e,i,f);break t}Ma(e,i,h,f)}i=i.child}return i;case 26:return eo(e,i),e===null?(f=Vv(i.type,null,i.pendingProps,null))?i.memoizedState=f:Fe||(f=i.type,e=i.pendingProps,h=D0(W.current).createElement(f),h[$n]=i,h[wt]=e,ti(h,f,e),Ce(h),i.stateNode=h):i.memoizedState=Vv(i.type,e.memoizedProps,i.pendingProps,e.memoizedState),null;case 27:return Ut(i),e===null&&Fe&&(h=i.stateNode=Hv(i.type,i.pendingProps,W.current),Na=i,Qa=!0,_=xn,rl(i.type)?(cp=_,xn=Cr(h.firstChild)):xn=_),Ma(e,i,i.pendingProps.children,f),eo(e,i),e===null&&(i.flags|=4194304),i.child;case 5:return e===null&&Fe&&((_=h=xn)&&(h=Zb(h,i.type,i.pendingProps,Qa),h!==null?(i.stateNode=h,Na=i,xn=Cr(h.firstChild),Qa=!1,_=!0):_=!1),_||Mr(i)),Ut(i),_=i.type,w=i.pendingProps,q=e!==null?e.memoizedProps:null,h=w.children,rp(_,w)?h=null:q!==null&&rp(_,q)&&(i.flags|=32),i.memoizedState!==null&&(_=Js(e,i,qg,null,null,f),Vd._currentValue=_),eo(e,i),Ma(e,i,h,f),i.child;case 6:return e===null&&Fe&&((e=f=xn)&&(f=Wb(f,i.pendingProps,Qa),f!==null?(i.stateNode=f,Na=i,xn=null,e=!0):e=!1),e||Mr(i)),null;case 13:return Hr(e,i,f);case 4:return dt(i,i.stateNode.containerInfo),h=i.pendingProps,e===null?i.child=Qs(i,null,h,f):Ma(e,i,h,f),i.child;case 11:return Jo(e,i,i.type,i.pendingProps,f);case 7:return Ma(e,i,i.pendingProps,f),i.child;case 8:return Ma(e,i,i.pendingProps.children,f),i.child;case 12:return Ma(e,i,i.pendingProps.children,f),i.child;case 10:return h=i.pendingProps,fs(i,i.type,h.value),Ma(e,i,h.children,f),i.child;case 9:return _=i.type._context,h=i.pendingProps.children,Dr(i),_=Ln(_),h=h(_),i.flags|=1,Ma(e,i,h,f),i.child;case 14:return oi(e,i,i.type,i.pendingProps,f);case 15:return Uc(e,i,i.type,i.pendingProps,f);case 19:return Ki(e,i,f);case 31:return Bc(e,i,f);case 22:return Nd(e,i,f,i.pendingProps);case 24:return Dr(i),h=Ln(fa),e===null?(_=Yo(),_===null&&(_=ke,w=dc(),_.pooledCache=w,w.refCount++,w!==null&&(_.pooledCacheLanes|=f),_=w),i.memoizedState={parent:h,cache:_},Xs(i),fs(i,fa,_)):((e.lanes&f)!==0&&(sd(e,i),ms(i,null,null,f),Ko()),_=e.memoizedState,w=i.memoizedState,_.parent!==h?(_={parent:h,cache:h},i.memoizedState=_,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=_),fs(i,fa,h)):(h=w.cache,fs(i,fa,h),h!==_.cache&&ad(i,[fa],f,!0))),Ma(e,i,i.pendingProps.children,f),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Da(e){e.flags|=4}function Dd(e,i,f,h,_){if((i=(e.mode&32)!==0)&&(i=!1),i){if(e.flags|=16777216,(_&335544128)===_)if(e.stateNode.complete)e.flags|=8192;else if(s())e.flags|=8192;else throw zr=Jl,Fl}else e.flags&=-16777217}function A0(e,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Fv(i))if(s())e.flags|=8192;else throw zr=Jl,Fl}function Lc(e,i){i!==null&&(e.flags|=4),e.flags&16384&&(i=e.tag!==22?He():536870912,e.lanes|=i,Ve|=i)}function Nn(e,i){if(!Fe)switch(e.tailMode){case"hidden":i=e.tail;for(var f=null;i!==null;)i.alternate!==null&&(f=i),i=i.sibling;f===null?e.tail=null:f.sibling=null;break;case"collapsed":f=e.tail;for(var h=null;f!==null;)f.alternate!==null&&(h=f),f=f.sibling;h===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function Cn(e){var i=e.alternate!==null&&e.alternate.child===e.child,f=0,h=0;if(i)for(var _=e.child;_!==null;)f|=_.lanes|_.childLanes,h|=_.subtreeFlags&65011712,h|=_.flags&65011712,_.return=e,_=_.sibling;else for(_=e.child;_!==null;)f|=_.lanes|_.childLanes,h|=_.subtreeFlags,h|=_.flags,_.return=e,_=_.sibling;return e.subtreeFlags|=h,e.childLanes=f,i}function Wo(e,i,f){var h=i.pendingProps;switch($f(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cn(i),null;case 1:return Cn(i),null;case 3:return f=i.stateNode,h=null,e!==null&&(h=e.memoizedState.cache),i.memoizedState.cache!==h&&(i.flags|=2048),sr(fa),Rt(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(e===null||e.child===null)&&(Is(i)?Da(i):e===null||e.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Gs())),Cn(i),null;case 26:var _=i.type,w=i.memoizedState;return e===null?(Da(i),w!==null?(Cn(i),A0(i,w)):(Cn(i),Dd(i,_,null,h,f))):w?w!==e.memoizedState?(Da(i),Cn(i),A0(i,w)):(Cn(i),i.flags&=-16777217):(e=e.memoizedProps,e!==h&&Da(i),Cn(i),Dd(i,_,e,h,f)),null;case 27:if(Xt(i),f=W.current,_=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==h&&Da(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return Cn(i),null}e=V.current,Is(i)?td(i):(e=Hv(_,h,f),i.stateNode=e,Da(i))}return Cn(i),null;case 5:if(Xt(i),_=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==h&&Da(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return Cn(i),null}if(w=V.current,Is(i))td(i);else{var q=D0(W.current);switch(w){case 1:w=q.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:w=q.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":w=q.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":w=q.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":w=q.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof h.is=="string"?q.createElement("select",{is:h.is}):q.createElement("select"),h.multiple?w.multiple=!0:h.size&&(w.size=h.size);break;default:w=typeof h.is=="string"?q.createElement(_,{is:h.is}):q.createElement(_)}}w[$n]=i,w[wt]=h;t:for(q=i.child;q!==null;){if(q.tag===5||q.tag===6)w.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===i)break t;for(;q.sibling===null;){if(q.return===null||q.return===i)break t;q=q.return}q.sibling.return=q.return,q=q.sibling}i.stateNode=w;t:switch(ti(w,_,h),_){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&Da(i)}}return Cn(i),Dd(i,i.type,e===null?null:e.memoizedProps,i.pendingProps,f),null;case 6:if(e&&i.stateNode!=null)e.memoizedProps!==h&&Da(i);else{if(typeof h!="string"&&i.stateNode===null)throw Error(a(166));if(e=W.current,Is(i)){if(e=i.stateNode,f=i.memoizedProps,h=null,_=Na,_!==null)switch(_.tag){case 27:case 5:h=_.memoizedProps}e[$n]=i,e=!!(e.nodeValue===f||h!==null&&h.suppressHydrationWarning===!0||Nv(e.nodeValue,f)),e||Mr(i,!0)}else e=D0(e).createTextNode(h),e[$n]=i,i.stateNode=e}return Cn(i),null;case 31:if(f=i.memoizedState,e===null||e.memoizedState!==null){if(h=Is(i),f!==null){if(e===null){if(!h)throw Error(a(318));if(e=i.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(557));e[$n]=i}else cs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Cn(i),e=!1}else f=Gs(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),e=!0;if(!e)return i.flags&256?(_i(i),i):(_i(i),null);if((i.flags&128)!==0)throw Error(a(558))}return Cn(i),null;case 13:if(h=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_=Is(i),h!==null&&h.dehydrated!==null){if(e===null){if(!_)throw Error(a(318));if(_=i.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(a(317));_[$n]=i}else cs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Cn(i),_=!1}else _=Gs(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=_),_=!0;if(!_)return i.flags&256?(_i(i),i):(_i(i),null)}return _i(i),(i.flags&128)!==0?(i.lanes=f,i):(f=h!==null,e=e!==null&&e.memoizedState!==null,f&&(h=i.child,_=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(_=h.alternate.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==_&&(h.flags|=2048)),f!==e&&f&&(i.child.flags|=8192),Lc(i,i.updateQueue),Cn(i),null);case 4:return Rt(),e===null&&tp(i.stateNode.containerInfo),Cn(i),null;case 10:return sr(i.type),Cn(i),null;case 19:if(it(na),h=i.memoizedState,h===null)return Cn(i),null;if(_=(i.flags&128)!==0,w=h.rendering,w===null)if(_)Nn(h,!1);else{if(Mn!==0||e!==null&&(e.flags&128)!==0)for(e=i.child;e!==null;){if(w=yc(e),w!==null){for(i.flags|=128,Nn(h,!1),e=w.updateQueue,i.updateQueue=e,Lc(i,e),i.subtreeFlags=0,e=f,f=i.child;f!==null;)sc(f,e),f=f.sibling;return st(na,na.current&1|2),Fe&&rr(i,h.treeForkCount),i.child}e=e.sibling}h.tail!==null&&Se()>zi&&(i.flags|=128,_=!0,Nn(h,!1),i.lanes=4194304)}else{if(!_)if(e=yc(w),e!==null){if(i.flags|=128,_=!0,e=e.updateQueue,i.updateQueue=e,Lc(i,e),Nn(h,!0),h.tail===null&&h.tailMode==="hidden"&&!w.alternate&&!Fe)return Cn(i),null}else 2*Se()-h.renderingStartTime>zi&&f!==536870912&&(i.flags|=128,_=!0,Nn(h,!1),i.lanes=4194304);h.isBackwards?(w.sibling=i.child,i.child=w):(e=h.last,e!==null?e.sibling=w:i.child=w,h.last=w)}return h.tail!==null?(e=h.tail,h.rendering=e,h.tail=e.sibling,h.renderingStartTime=Se(),e.sibling=null,f=na.current,st(na,_?f&1|2:f&1),Fe&&rr(i,h.treeForkCount),e):(Cn(i),null);case 22:case 23:return _i(i),ur(),h=i.memoizedState!==null,e!==null?e.memoizedState!==null!==h&&(i.flags|=8192):h&&(i.flags|=8192),h?(f&536870912)!==0&&(i.flags&128)===0&&(Cn(i),i.subtreeFlags&6&&(i.flags|=8192)):Cn(i),f=i.updateQueue,f!==null&&Lc(i,f.retryQueue),f=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(f=e.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==f&&(i.flags|=2048),e!==null&&it(qs),null;case 24:return f=null,e!==null&&(f=e.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),sr(fa),Cn(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function jd(e,i){switch($f(i),i.tag){case 1:return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return sr(fa),Rt(),e=i.flags,(e&65536)!==0&&(e&128)===0?(i.flags=e&-65537|128,i):null;case 26:case 27:case 5:return Xt(i),null;case 31:if(i.memoizedState!==null){if(_i(i),i.alternate===null)throw Error(a(340));cs()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 13:if(_i(i),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(a(340));cs()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return it(na),null;case 4:return Rt(),null;case 10:return sr(i.type),null;case 22:case 23:return _i(i),ur(),e!==null&&it(qs),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 24:return sr(fa),null;case 25:return null;default:return null}}function uu(e,i){switch($f(i),i.tag){case 3:sr(fa),Rt();break;case 26:case 27:case 5:Xt(i);break;case 4:Rt();break;case 31:i.memoizedState!==null&&_i(i);break;case 13:_i(i);break;case 19:it(na);break;case 10:sr(i.type);break;case 22:case 23:_i(i),ur(),e!==null&&it(qs);break;case 24:sr(fa)}}function ao(e,i){try{var f=i.updateQueue,h=f!==null?f.lastEffect:null;if(h!==null){var _=h.next;f=_;do{if((f.tag&e)===e){h=void 0;var w=f.create,q=f.inst;h=w(),q.destroy=h}f=f.next}while(f!==_)}}catch($){Qt(i,i.return,$)}}function Ai(e,i,f){try{var h=i.updateQueue,_=h!==null?h.lastEffect:null;if(_!==null){var w=_.next;h=w;do{if((h.tag&e)===e){var q=h.inst,$=q.destroy;if($!==void 0){q.destroy=void 0,_=i;var lt=f,vt=$;try{vt()}catch(xt){Qt(_,lt,xt)}}}h=h.next}while(h!==w)}}catch(xt){Qt(i,i.return,xt)}}function $o(e){var i=e.updateQueue;if(i!==null){var f=e.stateNode;try{Xh(i,f)}catch(h){Qt(e,e.return,h)}}}function Pc(e,i,f){f.props=gr(e.type,e.memoizedProps),f.state=e.memoizedState;try{f.componentWillUnmount()}catch(h){Qt(e,i,h)}}function mr(e,i){try{var f=e.ref;if(f!==null){switch(e.tag){case 26:case 27:case 5:var h=e.stateNode;break;case 30:h=e.stateNode;break;default:h=e.stateNode}typeof f=="function"?e.refCleanup=f(h):f.current=h}}catch(_){Qt(e,i,_)}}function Za(e,i){var f=e.ref,h=e.refCleanup;if(f!==null)if(typeof h=="function")try{h()}catch(_){Qt(e,i,_)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(_){Qt(e,i,_)}else f.current=null}function Ud(e){var i=e.type,f=e.memoizedProps,h=e.stateNode;try{t:switch(i){case"button":case"input":case"select":case"textarea":f.autoFocus&&h.focus();break t;case"img":f.src?h.src=f.src:f.srcSet&&(h.srcset=f.srcSet)}}catch(_){Qt(e,e.return,_)}}function qr(e,i,f){try{var h=e.stateNode;Yb(h,e.type,f,i),h[wt]=i}catch(_){Qt(e,e.return,_)}}function w0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&rl(e.type)||e.tag===4}function io(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||w0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&rl(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cu(e,i,f){var h=e.tag;if(h===5||h===6)e=e.stateNode,i?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(e,i):(i=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,i.appendChild(e),f=f._reactRootContainer,f!=null||i.onclick!==null||(i.onclick=ni));else if(h!==4&&(h===27&&rl(e.type)&&(f=e.stateNode,i=null),e=e.child,e!==null))for(cu(e,i,f),e=e.sibling;e!==null;)cu(e,i,f),e=e.sibling}function ro(e,i,f){var h=e.tag;if(h===5||h===6)e=e.stateNode,i?f.insertBefore(e,i):f.appendChild(e);else if(h!==4&&(h===27&&rl(e.type)&&(f=e.stateNode),e=e.child,e!==null))for(ro(e,i,f),e=e.sibling;e!==null;)ro(e,i,f),e=e.sibling}function fu(e){var i=e.stateNode,f=e.memoizedProps;try{for(var h=e.type,_=i.attributes;_.length;)i.removeAttributeNode(_[0]);ti(i,h,f),i[$n]=e,i[wt]=f}catch(w){Qt(e,e.return,w)}}var ui=!1,dn=!1,Es=!1,Ic=typeof WeakSet=="function"?WeakSet:Set,Pn=null;function Bd(e,i){if(e=e.containerInfo,ap=I0,e=Pi(e),nc(e)){if("selectionStart"in e)var f={start:e.selectionStart,end:e.selectionEnd};else t:{f=(f=e.ownerDocument)&&f.defaultView||window;var h=f.getSelection&&f.getSelection();if(h&&h.rangeCount!==0){f=h.anchorNode;var _=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{f.nodeType,w.nodeType}catch{f=null;break t}var q=0,$=-1,lt=-1,vt=0,xt=0,jt=e,bt=null;e:for(;;){for(var Ct;jt!==f||_!==0&&jt.nodeType!==3||($=q+_),jt!==w||h!==0&&jt.nodeType!==3||(lt=q+h),jt.nodeType===3&&(q+=jt.nodeValue.length),(Ct=jt.firstChild)!==null;)bt=jt,jt=Ct;for(;;){if(jt===e)break e;if(bt===f&&++vt===_&&($=q),bt===w&&++xt===h&&(lt=q),(Ct=jt.nextSibling)!==null)break;jt=bt,bt=jt.parentNode}jt=Ct}f=$===-1||lt===-1?null:{start:$,end:lt}}else f=null}f=f||{start:0,end:0}}else f=null;for(ip={focusedElem:e,selectionRange:f},I0=!1,Pn=i;Pn!==null;)if(i=Pn,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,Pn=e;else for(;Pn!==null;){switch(i=Pn,w=i.alternate,e=i.flags,i.tag){case 0:if((e&4)!==0&&(e=i.updateQueue,e=e!==null?e.events:null,e!==null))for(f=0;f<e.length;f++)_=e[f],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&w!==null){e=void 0,f=i,_=w.memoizedProps,w=w.memoizedState,h=f.stateNode;try{var ie=gr(f.type,_);e=h.getSnapshotBeforeUpdate(ie,w),h.__reactInternalSnapshotBeforeUpdate=e}catch(_e){Qt(f,f.return,_e)}}break;case 3:if((e&1024)!==0){if(e=i.stateNode.containerInfo,f=e.nodeType,f===9)op(e);else if(f===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":op(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=i.sibling,e!==null){e.return=i.return,Pn=e;break}Pn=i.return}}function so(e,i,f){var h=f.flags;switch(f.tag){case 0:case 11:case 15:vr(e,f),h&4&&ao(5,f);break;case 1:if(vr(e,f),h&4)if(e=f.stateNode,i===null)try{e.componentDidMount()}catch(q){Qt(f,f.return,q)}else{var _=gr(f.type,i.memoizedProps);i=i.memoizedState;try{e.componentDidUpdate(_,i,e.__reactInternalSnapshotBeforeUpdate)}catch(q){Qt(f,f.return,q)}}h&64&&$o(f),h&512&&mr(f,f.return);break;case 3:if(vr(e,f),h&64&&(e=f.updateQueue,e!==null)){if(i=null,f.child!==null)switch(f.child.tag){case 27:case 5:i=f.child.stateNode;break;case 1:i=f.child.stateNode}try{Xh(e,i)}catch(q){Qt(f,f.return,q)}}break;case 27:i===null&&h&4&&fu(f);case 26:case 5:vr(e,f),i===null&&h&4&&Ud(f),h&512&&mr(f,f.return);break;case 12:vr(e,f);break;case 31:vr(e,f),h&4&&hu(e,f);break;case 13:vr(e,f),h&4&&oo(e,f),h&64&&(e=f.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(f=Ea.bind(null,f),$b(e,f))));break;case 22:if(h=f.memoizedState!==null||ui,!h){i=i!==null&&i.memoizedState!==null||dn,_=ui;var w=dn;ui=h,(dn=i)&&!w?ci(e,f,(f.subtreeFlags&8772)!==0):vr(e,f),ui=_,dn=w}break;case 30:break;default:vr(e,f)}}function du(e){var i=e.alternate;i!==null&&(e.alternate=null,du(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&fe(i)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var hn=null,pe=!1;function Je(e,i,f){for(f=f.child;f!==null;)sa(e,i,f),f=f.sibling}function sa(e,i,f){if(ee&&typeof ee.onCommitFiberUnmount=="function")try{ee.onCommitFiberUnmount(zt,f)}catch{}switch(f.tag){case 26:dn||Za(f,i),Je(e,i,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:dn||Za(f,i);var h=hn,_=pe;rl(f.type)&&(hn=f.stateNode,pe=!1),Je(e,i,f),Hd(f.stateNode),hn=h,pe=_;break;case 5:dn||Za(f,i);case 6:if(h=hn,_=pe,hn=null,Je(e,i,f),hn=h,pe=_,hn!==null)if(pe)try{(hn.nodeType===9?hn.body:hn.nodeName==="HTML"?hn.ownerDocument.body:hn).removeChild(f.stateNode)}catch(w){Qt(f,i,w)}else try{hn.removeChild(f.stateNode)}catch(w){Qt(f,i,w)}break;case 18:hn!==null&&(pe?(e=hn,zv(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,f.stateNode),Jc(e)):zv(hn,f.stateNode));break;case 4:h=hn,_=pe,hn=f.stateNode.containerInfo,pe=!0,Je(e,i,f),hn=h,pe=_;break;case 0:case 11:case 14:case 15:Ai(2,f,i),dn||Ai(4,f,i),Je(e,i,f);break;case 1:dn||(Za(f,i),h=f.stateNode,typeof h.componentWillUnmount=="function"&&Pc(f,i,h)),Je(e,i,f);break;case 21:Je(e,i,f);break;case 22:dn=(h=dn)||f.memoizedState!==null,Je(e,i,f),dn=h;break;default:Je(e,i,f)}}function hu(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Jc(e)}catch(f){Qt(i,i.return,f)}}}function oo(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Jc(e)}catch(f){Qt(i,i.return,f)}}function lo(e){switch(e.tag){case 31:case 13:case 19:var i=e.stateNode;return i===null&&(i=e.stateNode=new Ic),i;case 22:return e=e.stateNode,i=e._retryCache,i===null&&(i=e._retryCache=new Ic),i;default:throw Error(a(435,e.tag))}}function uo(e,i){var f=lo(e);i.forEach(function(h){if(!f.has(h)){f.add(h);var _=cn.bind(null,e,h);h.then(_,_)}})}function ba(e,i){var f=i.deletions;if(f!==null)for(var h=0;h<f.length;h++){var _=f[h],w=e,q=i,$=q;t:for(;$!==null;){switch($.tag){case 27:if(rl($.type)){hn=$.stateNode,pe=!1;break t}break;case 5:hn=$.stateNode,pe=!1;break t;case 3:case 4:hn=$.stateNode.containerInfo,pe=!0;break t}$=$.return}if(hn===null)throw Error(a(160));sa(w,q,_),hn=null,pe=!1,w=_.alternate,w!==null&&(w.return=null),_.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)R0(i,e),i=i.sibling}var Ga=null;function R0(e,i){var f=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ba(i,e),ja(e),h&4&&(Ai(3,e,e.return),ao(3,e),Ai(5,e,e.return));break;case 1:ba(i,e),ja(e),h&512&&(dn||f===null||Za(f,f.return)),h&64&&ui&&(e=e.updateQueue,e!==null&&(h=e.callbacks,h!==null&&(f=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=f===null?h:f.concat(h))));break;case 26:var _=Ga;if(ba(i,e),ja(e),h&512&&(dn||f===null||Za(f,f.return)),h&4){var w=f!==null?f.memoizedState:null;if(h=e.memoizedState,f===null)if(h===null)if(e.stateNode===null){t:{h=e.type,f=e.memoizedProps,_=_.ownerDocument||_;e:switch(h){case"title":w=_.getElementsByTagName("title")[0],(!w||w[En]||w[$n]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=_.createElement(h),_.head.insertBefore(w,_.querySelector("head > title"))),ti(w,h,f),w[$n]=e,Ce(w),h=w;break t;case"link":var q=Qv("link","href",_).get(h+(f.href||""));if(q){for(var $=0;$<q.length;$++)if(w=q[$],w.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&w.getAttribute("rel")===(f.rel==null?null:f.rel)&&w.getAttribute("title")===(f.title==null?null:f.title)&&w.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){q.splice($,1);break e}}w=_.createElement(h),ti(w,h,f),_.head.appendChild(w);break;case"meta":if(q=Qv("meta","content",_).get(h+(f.content||""))){for($=0;$<q.length;$++)if(w=q[$],w.getAttribute("content")===(f.content==null?null:""+f.content)&&w.getAttribute("name")===(f.name==null?null:f.name)&&w.getAttribute("property")===(f.property==null?null:f.property)&&w.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&w.getAttribute("charset")===(f.charSet==null?null:f.charSet)){q.splice($,1);break e}}w=_.createElement(h),ti(w,h,f),_.head.appendChild(w);break;default:throw Error(a(468,h))}w[$n]=e,Ce(w),h=w}e.stateNode=h}else Xv(_,e.type,e.stateNode);else e.stateNode=Kv(_,h,e.memoizedProps);else w!==h?(w===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):w.count--,h===null?Xv(_,e.type,e.stateNode):Kv(_,h,e.memoizedProps)):h===null&&e.stateNode!==null&&qr(e,e.memoizedProps,f.memoizedProps)}break;case 27:ba(i,e),ja(e),h&512&&(dn||f===null||Za(f,f.return)),f!==null&&h&4&&qr(e,e.memoizedProps,f.memoizedProps);break;case 5:if(ba(i,e),ja(e),h&512&&(dn||f===null||Za(f,f.return)),e.flags&32){_=e.stateNode;try{es(_,"")}catch(ie){Qt(e,e.return,ie)}}h&4&&e.stateNode!=null&&(_=e.memoizedProps,qr(e,_,f!==null?f.memoizedProps:_)),h&1024&&(Es=!0);break;case 6:if(ba(i,e),ja(e),h&4){if(e.stateNode===null)throw Error(a(162));h=e.memoizedProps,f=e.stateNode;try{f.nodeValue=h}catch(ie){Qt(e,e.return,ie)}}break;case 3:if(B0=null,_=Ga,Ga=j0(i.containerInfo),ba(i,e),Ga=_,ja(e),h&4&&f!==null&&f.memoizedState.isDehydrated)try{Jc(i.containerInfo)}catch(ie){Qt(e,e.return,ie)}Es&&(Es=!1,zd(e));break;case 4:h=Ga,Ga=j0(e.stateNode.containerInfo),ba(i,e),ja(e),Ga=h;break;case 12:ba(i,e),ja(e);break;case 31:ba(i,e),ja(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,uo(e,h)));break;case 13:ba(i,e),ja(e),e.child.flags&8192&&e.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Yr=Se()),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,uo(e,h)));break;case 22:_=e.memoizedState!==null;var lt=f!==null&&f.memoizedState!==null,vt=ui,xt=dn;if(ui=vt||_,dn=xt||lt,ba(i,e),dn=xt,ui=vt,ja(e),h&8192)t:for(i=e.stateNode,i._visibility=_?i._visibility&-2:i._visibility|1,_&&(f===null||lt||ui||dn||co(e)),f=null,i=e;;){if(i.tag===5||i.tag===26){if(f===null){lt=f=i;try{if(w=lt.stateNode,_)q=w.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{$=lt.stateNode;var jt=lt.memoizedProps.style,bt=jt!=null&&jt.hasOwnProperty("display")?jt.display:null;$.style.display=bt==null||typeof bt=="boolean"?"":(""+bt).trim()}}catch(ie){Qt(lt,lt.return,ie)}}}else if(i.tag===6){if(f===null){lt=i;try{lt.stateNode.nodeValue=_?"":lt.memoizedProps}catch(ie){Qt(lt,lt.return,ie)}}}else if(i.tag===18){if(f===null){lt=i;try{var Ct=lt.stateNode;_?Lv(Ct,!0):Lv(lt.stateNode,!1)}catch(ie){Qt(lt,lt.return,ie)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break t;for(;i.sibling===null;){if(i.return===null||i.return===e)break t;f===i&&(f=null),i=i.return}f===i&&(f=null),i.sibling.return=i.return,i=i.sibling}h&4&&(h=e.updateQueue,h!==null&&(f=h.retryQueue,f!==null&&(h.retryQueue=null,uo(e,f))));break;case 19:ba(i,e),ja(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,uo(e,h)));break;case 30:break;case 21:break;default:ba(i,e),ja(e)}}function ja(e){var i=e.flags;if(i&2){try{for(var f,h=e.return;h!==null;){if(w0(h)){f=h;break}h=h.return}if(f==null)throw Error(a(160));switch(f.tag){case 27:var _=f.stateNode,w=io(e);ro(e,w,_);break;case 5:var q=f.stateNode;f.flags&32&&(es(q,""),f.flags&=-33);var $=io(e);ro(e,$,q);break;case 3:case 4:var lt=f.stateNode.containerInfo,vt=io(e);cu(e,vt,lt);break;default:throw Error(a(161))}}catch(xt){Qt(e,e.return,xt)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function zd(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var i=e;zd(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),e=e.sibling}}function vr(e,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)so(e,i.alternate,i),i=i.sibling}function co(e){for(e=e.child;e!==null;){var i=e;switch(i.tag){case 0:case 11:case 14:case 15:Ai(4,i,i.return),co(i);break;case 1:Za(i,i.return);var f=i.stateNode;typeof f.componentWillUnmount=="function"&&Pc(i,i.return,f),co(i);break;case 27:Hd(i.stateNode);case 26:case 5:Za(i,i.return),co(i);break;case 22:i.memoizedState===null&&co(i);break;case 30:co(i);break;default:co(i)}e=e.sibling}}function ci(e,i,f){for(f=f&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var h=i.alternate,_=e,w=i,q=w.flags;switch(w.tag){case 0:case 11:case 15:ci(_,w,f),ao(4,w);break;case 1:if(ci(_,w,f),h=w,_=h.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(vt){Qt(h,h.return,vt)}if(h=w,_=h.updateQueue,_!==null){var $=h.stateNode;try{var lt=_.shared.hiddenCallbacks;if(lt!==null)for(_.shared.hiddenCallbacks=null,_=0;_<lt.length;_++)ld(lt[_],$)}catch(vt){Qt(h,h.return,vt)}}f&&q&64&&$o(w),mr(w,w.return);break;case 27:fu(w);case 26:case 5:ci(_,w,f),f&&h===null&&q&4&&Ud(w),mr(w,w.return);break;case 12:ci(_,w,f);break;case 31:ci(_,w,f),f&&q&4&&hu(_,w);break;case 13:ci(_,w,f),f&&q&4&&oo(_,w);break;case 22:w.memoizedState===null&&ci(_,w,f),mr(w,w.return);break;case 30:break;default:ci(_,w,f)}i=i.sibling}}function fo(e,i){var f=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(f=e.memoizedState.cachePool.pool),e=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(e=i.memoizedState.cachePool.pool),e!==f&&(e!=null&&e.refCount++,f!=null&&qo(f))}function Cs(e,i){e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&qo(e))}function Ui(e,i,f,h){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)wi(e,i,f,h),i=i.sibling}function wi(e,i,f,h){var _=i.flags;switch(i.tag){case 0:case 11:case 15:Ui(e,i,f,h),_&2048&&ao(9,i);break;case 1:Ui(e,i,f,h);break;case 3:Ui(e,i,f,h),_&2048&&(e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&qo(e)));break;case 12:if(_&2048){Ui(e,i,f,h),e=i.stateNode;try{var w=i.memoizedProps,q=w.id,$=w.onPostCommit;typeof $=="function"&&$(q,i.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(lt){Qt(i,i.return,lt)}}else Ui(e,i,f,h);break;case 31:Ui(e,i,f,h);break;case 13:Ui(e,i,f,h);break;case 23:break;case 22:w=i.stateNode,q=i.alternate,i.memoizedState!==null?w._visibility&2?Ui(e,i,f,h):Zn(e,i):w._visibility&2?Ui(e,i,f,h):(w._visibility|=2,Wa(e,i,f,h,(i.subtreeFlags&10256)!==0||!1)),_&2048&&fo(q,i);break;case 24:Ui(e,i,f,h),_&2048&&Cs(i.alternate,i);break;default:Ui(e,i,f,h)}}function Wa(e,i,f,h,_){for(_=_&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var w=e,q=i,$=f,lt=h,vt=q.flags;switch(q.tag){case 0:case 11:case 15:Wa(w,q,$,lt,_),ao(8,q);break;case 23:break;case 22:var xt=q.stateNode;q.memoizedState!==null?xt._visibility&2?Wa(w,q,$,lt,_):Zn(w,q):(xt._visibility|=2,Wa(w,q,$,lt,_)),_&&vt&2048&&fo(q.alternate,q);break;case 24:Wa(w,q,$,lt,_),_&&vt&2048&&Cs(q.alternate,q);break;default:Wa(w,q,$,lt,_)}i=i.sibling}}function Zn(e,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var f=e,h=i,_=h.flags;switch(h.tag){case 22:Zn(f,h),_&2048&&fo(h.alternate,h);break;case 24:Zn(f,h),_&2048&&Cs(h.alternate,h);break;default:Zn(f,h)}i=i.sibling}}var ho=8192;function go(e,i,f){if(e.subtreeFlags&ho)for(e=e.child;e!==null;)Ld(e,i,f),e=e.sibling}function Ld(e,i,f){switch(e.tag){case 26:go(e,i,f),e.flags&ho&&e.memoizedState!==null&&f4(f,Ga,e.memoizedState,e.memoizedProps);break;case 5:go(e,i,f);break;case 3:case 4:var h=Ga;Ga=j0(e.stateNode.containerInfo),go(e,i,f),Ga=h;break;case 22:e.memoizedState===null&&(h=e.alternate,h!==null&&h.memoizedState!==null?(h=ho,ho=16777216,go(e,i,f),ho=h):go(e,i,f));break;default:go(e,i,f)}}function va(e){var i=e.alternate;if(i!==null&&(e=i.child,e!==null)){i.child=null;do i=e.sibling,e.sibling=null,e=i;while(e!==null)}}function po(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var f=0;f<i.length;f++){var h=i[f];Pn=h,Gc(h,e)}va(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)yr(e),e=e.sibling}function yr(e){switch(e.tag){case 0:case 11:case 15:po(e),e.flags&2048&&Ai(9,e,e.return);break;case 3:po(e);break;case 12:po(e);break;case 22:var i=e.stateNode;e.memoizedState!==null&&i._visibility&2&&(e.return===null||e.return.tag!==13)?(i._visibility&=-3,Vn(e)):po(e);break;default:po(e)}}function Vn(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var f=0;f<i.length;f++){var h=i[f];Pn=h,Gc(h,e)}va(e)}for(e=e.child;e!==null;){switch(i=e,i.tag){case 0:case 11:case 15:Ai(8,i,i.return),Vn(i);break;case 22:f=i.stateNode,f._visibility&2&&(f._visibility&=-3,Vn(i));break;default:Vn(i)}e=e.sibling}}function Gc(e,i){for(;Pn!==null;){var f=Pn;switch(f.tag){case 0:case 11:case 15:Ai(8,f,i);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var h=f.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:qo(f.memoizedState.cache)}if(h=f.child,h!==null)h.return=f,Pn=h;else t:for(f=e;Pn!==null;){h=Pn;var _=h.sibling,w=h.return;if(du(h),h===f){Pn=null;break t}if(_!==null){_.return=w,Pn=_;break t}Pn=w}}}var O0={getCacheForType:function(e){var i=Ln(fa),f=i.data.get(e);return f===void 0&&(f=e(),i.data.set(e,f)),f},cacheSignal:function(){return Ln(fa).controller.signal}},_a=typeof WeakMap=="function"?WeakMap:Map,ve=0,ke=null,we=null,Pe=0,Sn=0,Ha=null,Xi=!1,Vr=!1,tl=!1,Bi=0,Mn=0,Ts=0,Ie=0,Tn=0,be=0,Ve=0,sn=null,Dn=null,Sr=!1,Yr=0,Hc=0,zi=1/0,In=null,$a=null,Gn=0,br=null,Ua=null,fi=0,mo=0,ka=null,kc=null,vo=0,yo=null;function qa(){return(ve&2)!==0&&Pe!==0?Pe&-Pe:D.T!==null?Jg():gi()}function Kr(){if(be===0)if((Pe&536870912)===0||Fe){var e=ea;ea<<=1,(ea&3932160)===0&&(ea=262144),be=e}else be=536870912;return e=qn.current,e!==null&&(e.flags|=32),be}function gn(e,i,f){(e===ke&&(Sn===2||Sn===9)||e.cancelPendingCommit!==null)&&(Er(e,0),_r(e,Pe,be,!1)),Ne(e,f),((ve&2)===0||e!==ke)&&(e===ke&&((ve&2)===0&&(Ie|=f),Mn===4&&_r(e,Pe,be,!1)),Rs(e))}function Qr(e,i,f){if((ve&6)!==0)throw Error(a(327));var h=!f&&(i&127)===0&&(i&e.expiredLanes)===0||Jt(e,i),_=h?et(e,i):N(e,i,!0),w=h;do{if(_===0){Vr&&!h&&_r(e,i,0,!1);break}else{if(f=e.current.alternate,w&&!el(f)){_=N(e,i,!1),w=!1;continue}if(_===2){if(w=i,e.errorRecoveryDisabledLanes&w)var q=0;else q=e.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){i=q;t:{var $=e;_=sn;var lt=$.current.memoizedState.isDehydrated;if(lt&&(Er($,q).flags|=256),q=N($,q,!1),q!==2){if(tl&&!lt){$.errorRecoveryDisabledLanes|=w,Ie|=w,_=4;break t}w=Dn,Dn=_,w!==null&&(Dn===null?Dn=w:Dn.push.apply(Dn,w))}_=q}if(w=!1,_!==2)continue}}if(_===1){Er(e,0),_r(e,i,0,!0);break}t:{switch(h=e,w=_,w){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:_r(h,i,be,!Xi);break t;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(_=Yr+300-Se(),10<_)){if(_r(h,i,be,!Xi),Ot(h,0,!0)!==0)break t;fi=i,h.timeoutHandle=Uv(So.bind(null,h,f,Dn,In,Sr,i,be,Ie,Ve,Xi,w,"Throttled",-0,0),_);break t}So(h,f,Dn,In,Sr,i,be,Ie,Ve,Xi,w,null,-0,0)}}break}while(!0);Rs(e)}function So(e,i,f,h,_,w,q,$,lt,vt,xt,jt,bt,Ct){if(e.timeoutHandle=-1,jt=i.subtreeFlags,jt&8192||(jt&16785408)===16785408){jt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ni},Ld(i,w,jt);var ie=(w&62914560)===w?Yr-Se():(w&4194048)===w?Hc-Se():0;if(ie=d4(jt,ie),ie!==null){fi=w,e.cancelPendingCommit=ie(je.bind(null,e,i,w,f,h,_,q,$,lt,xt,jt,null,bt,Ct)),_r(e,w,q,!vt);return}}je(e,i,w,f,h,_,q,$,lt)}function el(e){for(var i=e;;){var f=i.tag;if((f===0||f===11||f===15)&&i.flags&16384&&(f=i.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var h=0;h<f.length;h++){var _=f[h],w=_.getSnapshot;_=_.value;try{if(!wa(w(),_))return!1}catch{return!1}}if(f=i.child,i.subtreeFlags&16384&&f!==null)f.return=i,i=f;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function _r(e,i,f,h){i&=~Tn,i&=~Ie,e.suspendedLanes|=i,e.pingedLanes&=~i,h&&(e.warmLanes|=i),h=e.expirationTimes;for(var _=i;0<_;){var w=31-an(_),q=1<<w;h[w]=-1,_&=~q}f!==0&&Le(e,f,i)}function nl(){return(ve&6)===0?(Pd(0),!1):!0}function qc(){if(we!==null){if(Sn===0)var e=we.return;else e=we,Vi=Ze=null,dd(e),hs=null,Zl=0,e=we;for(;e!==null;)uu(e.alternate,e),e=e.return;we=null}}function Er(e,i){var f=e.timeoutHandle;f!==-1&&(e.timeoutHandle=-1,Xb(f)),f=e.cancelPendingCommit,f!==null&&(e.cancelPendingCommit=null,f()),fi=0,qc(),ke=e,we=f=Gi(e.current,null),Pe=i,Sn=0,Ha=null,Xi=!1,Vr=Jt(e,i),tl=!1,Ve=be=Tn=Ie=Ts=Mn=0,Dn=sn=null,Sr=!1,(i&8)!==0&&(i|=i&32);var h=e.entangledLanes;if(h!==0)for(e=e.entanglements,h&=i;0<h;){var _=31-an(h),w=1<<_;i|=e[_],h&=~w}return Bi=i,ql(),f}function Vc(e,i){De=null,D.H=Fo,i===Ys||i===pc?(i=vc(),Sn=3):i===Fl?(i=vc(),Sn=4):Sn=i===xd?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Ha=i,we===null&&(Mn=1,jc(e,yi(i,e.current)))}function s(){var e=qn.current;return e===null?!0:(Pe&4194048)===Pe?Di===null:(Pe&62914560)===Pe||(Pe&536870912)!==0?e===Di:!1}function u(){var e=D.H;return D.H=Fo,e===null?Fo:e}function p(){var e=D.A;return D.A=O0,e}function b(){Mn=4,Xi||(Pe&4194048)!==Pe&&qn.current!==null||(Vr=!0),(Ts&134217727)===0&&(Ie&134217727)===0||ke===null||_r(ke,Pe,be,!1)}function N(e,i,f){var h=ve;ve|=2;var _=u(),w=p();(ke!==e||Pe!==i)&&(In=null,Er(e,i)),i=!1;var q=Mn;t:do try{if(Sn!==0&&we!==null){var $=we,lt=Ha;switch(Sn){case 8:qc(),q=6;break t;case 3:case 2:case 9:case 6:qn.current===null&&(i=!0);var vt=Sn;if(Sn=0,Ha=null,It(e,$,lt,vt),f&&Vr){q=0;break t}break;default:vt=Sn,Sn=0,Ha=null,It(e,$,lt,vt)}}G(),q=Mn;break}catch(xt){Vc(e,xt)}while(!0);return i&&e.shellSuspendCounter++,Vi=Ze=null,ve=h,D.H=_,D.A=w,we===null&&(ke=null,Pe=0,ql()),q}function G(){for(;we!==null;)St(we)}function et(e,i){var f=ve;ve|=2;var h=u(),_=p();ke!==e||Pe!==i?(In=null,zi=Se()+500,Er(e,i)):Vr=Jt(e,i);t:do try{if(Sn!==0&&we!==null){i=we;var w=Ha;e:switch(Sn){case 1:Sn=0,Ha=null,It(e,i,w,1);break;case 2:case 9:if(Ur(w)){Sn=0,Ha=null,Bt(i);break}i=function(){Sn!==2&&Sn!==9||ke!==e||(Sn=7),Rs(e)},w.then(i,i);break t;case 3:Sn=7;break t;case 4:Sn=5;break t;case 7:Ur(w)?(Sn=0,Ha=null,Bt(i)):(Sn=0,Ha=null,It(e,i,w,7));break;case 5:var q=null;switch(we.tag){case 26:q=we.memoizedState;case 5:case 27:var $=we;if(q?Fv(q):$.stateNode.complete){Sn=0,Ha=null;var lt=$.sibling;if(lt!==null)we=lt;else{var vt=$.return;vt!==null?(we=vt,Wt(vt)):we=null}break e}}Sn=0,Ha=null,It(e,i,w,5);break;case 6:Sn=0,Ha=null,It(e,i,w,6);break;case 8:qc(),Mn=6;break t;default:throw Error(a(462))}}ut();break}catch(xt){Vc(e,xt)}while(!0);return Vi=Ze=null,D.H=h,D.A=_,ve=f,we!==null?0:(ke=null,Pe=0,ql(),Mn)}function ut(){for(;we!==null&&!Ht();)St(we)}function St(e){var i=_s(e.alternate,e,Bi);e.memoizedProps=e.pendingProps,i===null?Wt(e):we=i}function Bt(e){var i=e,f=i.alternate;switch(i.tag){case 15:case 0:i=Ti(f,i,i.pendingProps,i.type,void 0,Pe);break;case 11:i=Ti(f,i,i.pendingProps,i.type.render,i.ref,Pe);break;case 5:dd(i);default:uu(f,i),i=we=sc(i,Bi),i=_s(f,i,Bi)}e.memoizedProps=e.pendingProps,i===null?Wt(e):we=i}function It(e,i,f,h){Vi=Ze=null,dd(i),hs=null,Zl=0;var _=i.return;try{if(Od(e,_,i,f,Pe)){Mn=1,jc(e,yi(f,e.current)),we=null;return}}catch(w){if(_!==null)throw we=_,w;Mn=1,jc(e,yi(f,e.current)),we=null;return}i.flags&32768?(Fe||h===1?e=!0:Vr||(Pe&536870912)!==0?e=!1:(Xi=e=!0,(h===2||h===9||h===3||h===6)&&(h=qn.current,h!==null&&h.tag===13&&(h.flags|=16384))),ne(i,e)):Wt(i)}function Wt(e){var i=e;do{if((i.flags&32768)!==0){ne(i,Xi);return}e=i.return;var f=Wo(i.alternate,i,Bi);if(f!==null){we=f;return}if(i=i.sibling,i!==null){we=i;return}we=i=e}while(i!==null);Mn===0&&(Mn=5)}function ne(e,i){do{var f=jd(e.alternate,e);if(f!==null){f.flags&=32767,we=f;return}if(f=e.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!i&&(e=e.sibling,e!==null)){we=e;return}we=e=f}while(e!==null);Mn=6,we=null}function je(e,i,f,h,_,w,q,$,lt){e.cancelPendingCommit=null;do ht();while(Gn!==0);if((ve&6)!==0)throw Error(a(327));if(i!==null){if(i===e.current)throw Error(a(177));if(w=i.lanes|i.childLanes,w|=Mi,ce(e,f,w,q,$,lt),e===ke&&(we=ke=null,Pe=0),Ua=i,br=e,fi=f,mo=w,ka=_,kc=h,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,ws(ct,function(){return _t(),null})):(e.callbackNode=null,e.callbackPriority=0),h=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||h){h=D.T,D.T=null,_=H.p,H.p=2,q=ve,ve|=4;try{Bd(e,i,f)}finally{ve=q,H.p=_,D.T=h}}Gn=1,Ri(),al(),As()}}function Ri(){if(Gn===1){Gn=0;var e=br,i=Ua,f=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||f){f=D.T,D.T=null;var h=H.p;H.p=2;var _=ve;ve|=4;try{R0(i,e);var w=ip,q=Pi(e.containerInfo),$=w.focusedElem,lt=w.selectionRange;if(q!==$&&$&&$.ownerDocument&&Bo($.ownerDocument.documentElement,$)){if(lt!==null&&nc($)){var vt=lt.start,xt=lt.end;if(xt===void 0&&(xt=vt),"selectionStart"in $)$.selectionStart=vt,$.selectionEnd=Math.min(xt,$.value.length);else{var jt=$.ownerDocument||document,bt=jt&&jt.defaultView||window;if(bt.getSelection){var Ct=bt.getSelection(),ie=$.textContent.length,_e=Math.min(lt.start,ie),Un=lt.end===void 0?_e:Math.min(lt.end,ie);!Ct.extend&&_e>Un&&(q=Un,Un=_e,_e=q);var gt=Yf($,_e),ft=Yf($,Un);if(gt&&ft&&(Ct.rangeCount!==1||Ct.anchorNode!==gt.node||Ct.anchorOffset!==gt.offset||Ct.focusNode!==ft.node||Ct.focusOffset!==ft.offset)){var mt=jt.createRange();mt.setStart(gt.node,gt.offset),Ct.removeAllRanges(),_e>Un?(Ct.addRange(mt),Ct.extend(ft.node,ft.offset)):(mt.setEnd(ft.node,ft.offset),Ct.addRange(mt))}}}}for(jt=[],Ct=$;Ct=Ct.parentNode;)Ct.nodeType===1&&jt.push({element:Ct,left:Ct.scrollLeft,top:Ct.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<jt.length;$++){var Dt=jt[$];Dt.element.scrollLeft=Dt.left,Dt.element.scrollTop=Dt.top}}I0=!!ap,ip=ap=null}finally{ve=_,H.p=h,D.T=f}}e.current=i,Gn=2}}function al(){if(Gn===2){Gn=0;var e=br,i=Ua,f=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||f){f=D.T,D.T=null;var h=H.p;H.p=2;var _=ve;ve|=4;try{so(e,i.alternate,i)}finally{ve=_,H.p=h,D.T=f}}Gn=3}}function As(){if(Gn===4||Gn===3){Gn=0,me();var e=br,i=Ua,f=fi,h=kc;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Gn=5:(Gn=0,Ua=br=null,yt(e,e.pendingLanes));var _=e.pendingLanes;if(_===0&&($a=null),Pa(f),i=i.stateNode,ee&&typeof ee.onCommitFiberRoot=="function")try{ee.onCommitFiberRoot(zt,i,void 0,(i.current.flags&128)===128)}catch{}if(h!==null){i=D.T,_=H.p,H.p=2,D.T=null;try{for(var w=e.onRecoverableError,q=0;q<h.length;q++){var $=h[q];w($.value,{componentStack:$.stack})}}finally{D.T=i,H.p=_}}(fi&3)!==0&&ht(),Rs(e),_=e.pendingLanes,(f&261930)!==0&&(_&42)!==0?e===yo?vo++:(vo=0,yo=e):vo=0,Pd(0)}}function yt(e,i){(e.pooledCacheLanes&=i)===0&&(i=e.pooledCache,i!=null&&(e.pooledCache=null,qo(i)))}function ht(){return Ri(),al(),As(),_t()}function _t(){if(Gn!==5)return!1;var e=br,i=mo;mo=0;var f=Pa(fi),h=D.T,_=H.p;try{H.p=32>f?32:f,D.T=null,f=ka,ka=null;var w=br,q=fi;if(Gn=0,Ua=br=null,fi=0,(ve&6)!==0)throw Error(a(331));var $=ve;if(ve|=4,yr(w.current),wi(w,w.current,q,f),ve=$,Pd(0,!1),ee&&typeof ee.onPostCommitFiberRoot=="function")try{ee.onPostCommitFiberRoot(zt,w)}catch{}return!0}finally{H.p=_,D.T=h,yt(e,i)}}function Gt(e,i,f){i=yi(f,i),i=Ci(e.stateNode,i,2),e=ps(e,i,2),e!==null&&(Ne(e,2),Rs(e))}function Qt(e,i,f){if(e.tag===3)Gt(e,e,f);else for(;i!==null;){if(i.tag===3){Gt(i,e,f);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&($a===null||!$a.has(h))){e=yi(f,e),f=Rd(2),h=ps(i,f,2),h!==null&&(T0(f,h,i,e),Ne(h,2),Rs(h));break}}i=i.return}}function wn(e,i,f){var h=e.pingCache;if(h===null){h=e.pingCache=new _a;var _=new Set;h.set(i,_)}else _=h.get(i),_===void 0&&(_=new Set,h.set(i,_));_.has(f)||(tl=!0,_.add(f),e=Te.bind(null,e,i,f),i.then(e,e))}function Te(e,i,f){var h=e.pingCache;h!==null&&h.delete(i),e.pingedLanes|=e.suspendedLanes&f,e.warmLanes&=~f,ke===e&&(Pe&f)===f&&(Mn===4||Mn===3&&(Pe&62914560)===Pe&&300>Se()-Yr?(ve&2)===0&&Er(e,0):Tn|=f,Ve===Pe&&(Ve=0)),Rs(e)}function on(e,i){i===0&&(i=He()),e=vi(e,i),e!==null&&(Ne(e,i),Rs(e))}function Ea(e){var i=e.memoizedState,f=0;i!==null&&(f=i.retryLane),on(e,f)}function cn(e,i){var f=0;switch(e.tag){case 31:case 13:var h=e.stateNode,_=e.memoizedState;_!==null&&(f=_.retryLane);break;case 19:h=e.stateNode;break;case 22:h=e.stateNode._retryCache;break;default:throw Error(a(314))}h!==null&&h.delete(i),on(e,f)}function ws(e,i){return fn(e,i)}var Yc=null,Kc=null,Xg=!1,x0=!1,Fg=!1,il=0;function Rs(e){e!==Kc&&e.next===null&&(Kc===null?Yc=Kc=e:Kc=Kc.next=e),x0=!0,Xg||(Xg=!0,Lb())}function Pd(e,i){if(!Fg&&x0){Fg=!0;do for(var f=!1,h=Yc;h!==null;){if(e!==0){var _=h.pendingLanes;if(_===0)var w=0;else{var q=h.suspendedLanes,$=h.pingedLanes;w=(1<<31-an(42|e)+1)-1,w&=_&~(q&~$),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(f=!0,Cv(h,w))}else w=Pe,w=Ot(h,h===ke?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||Jt(h,w)||(f=!0,Cv(h,w));h=h.next}while(f);Fg=!1}}function zb(){bv()}function bv(){x0=Xg=!1;var e=0;il!==0&&Qb()&&(e=il);for(var i=Se(),f=null,h=Yc;h!==null;){var _=h.next,w=_v(h,i);w===0?(h.next=null,f===null?Yc=_:f.next=_,_===null&&(Kc=f)):(f=h,(e!==0||(w&3)!==0)&&(x0=!0)),h=_}Gn!==0&&Gn!==5||Pd(e),il!==0&&(il=0)}function _v(e,i){for(var f=e.suspendedLanes,h=e.pingedLanes,_=e.expirationTimes,w=e.pendingLanes&-62914561;0<w;){var q=31-an(w),$=1<<q,lt=_[q];lt===-1?(($&f)===0||($&h)!==0)&&(_[q]=Ge($,i)):lt<=i&&(e.expiredLanes|=$),w&=~$}if(i=ke,f=Pe,f=Ot(e,e===i?f:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h=e.callbackNode,f===0||e===i&&(Sn===2||Sn===9)||e.cancelPendingCommit!==null)return h!==null&&h!==null&&At(h),e.callbackNode=null,e.callbackPriority=0;if((f&3)===0||Jt(e,f)){if(i=f&-f,i===e.callbackPriority)return i;switch(h!==null&&At(h),Pa(f)){case 2:case 8:f=xe;break;case 32:f=ct;break;case 268435456:f=Mt;break;default:f=ct}return h=Ev.bind(null,e),f=fn(f,h),e.callbackPriority=i,e.callbackNode=f,i}return h!==null&&h!==null&&At(h),e.callbackPriority=2,e.callbackNode=null,2}function Ev(e,i){if(Gn!==0&&Gn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var f=e.callbackNode;if(ht()&&e.callbackNode!==f)return null;var h=Pe;return h=Ot(e,e===ke?h:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h===0?null:(Qr(e,h,i),_v(e,Se()),e.callbackNode!=null&&e.callbackNode===f?Ev.bind(null,e):null)}function Cv(e,i){if(ht())return null;Qr(e,i,!0)}function Lb(){Fb(function(){(ve&6)!==0?fn($e,zb):bv()})}function Jg(){if(il===0){var e=ks;e===0&&(e=_n,_n<<=1,(_n&261888)===0&&(_n=256)),il=e}return il}function Tv(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ol(""+e)}function Av(e,i){var f=i.ownerDocument.createElement("input");return f.name=i.name,f.value=i.value,e.id&&f.setAttribute("form",e.id),i.parentNode.insertBefore(f,i),e=new FormData(e),f.parentNode.removeChild(f),e}function Pb(e,i,f,h,_){if(i==="submit"&&f&&f.stateNode===_){var w=Tv((_[wt]||null).action),q=h.submitter;q&&(i=(i=q[wt]||null)?Tv(i.formAction):q.getAttribute("formAction"),i!==null&&(w=i,q=null));var $=new qu("action","action",null,h,_);e.push({event:$,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(il!==0){var lt=q?Av(_,q):new FormData(_);Nc(f,{pending:!0,data:lt,method:_.method,action:w},null,lt)}}else typeof w=="function"&&($.preventDefault(),lt=q?Av(_,q):new FormData(_),Nc(f,{pending:!0,data:lt,method:_.method,action:w},w,lt))},currentTarget:_}]})}}for(var Zg=0;Zg<ar.length;Zg++){var Wg=ar[Zg],Ib=Wg.toLowerCase(),Gb=Wg[0].toUpperCase()+Wg.slice(1);Oa(Ib,"on"+Gb)}Oa(ic,"onAnimationEnd"),Oa(Ff,"onAnimationIteration"),Oa(kh,"onAnimationStart"),Oa("dblclick","onDoubleClick"),Oa("focusin","onFocus"),Oa("focusout","onBlur"),Oa(Jf,"onTransitionRun"),Oa(Ya,"onTransitionStart"),Oa(qh,"onTransitionCancel"),Oa(Ka,"onTransitionEnd"),vn("onMouseEnter",["mouseout","mouseover"]),vn("onMouseLeave",["mouseout","mouseover"]),vn("onPointerEnter",["pointerout","pointerover"]),vn("onPointerLeave",["pointerout","pointerover"]),kn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),kn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),kn("onBeforeInput",["compositionend","keypress","textInput","paste"]),kn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),kn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),kn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Id="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Id));function wv(e,i){i=(i&4)!==0;for(var f=0;f<e.length;f++){var h=e[f],_=h.event;h=h.listeners;t:{var w=void 0;if(i)for(var q=h.length-1;0<=q;q--){var $=h[q],lt=$.instance,vt=$.currentTarget;if($=$.listener,lt!==w&&_.isPropagationStopped())break t;w=$,_.currentTarget=vt;try{w(_)}catch(xt){Ii(xt)}_.currentTarget=null,w=lt}else for(q=0;q<h.length;q++){if($=h[q],lt=$.instance,vt=$.currentTarget,$=$.listener,lt!==w&&_.isPropagationStopped())break t;w=$,_.currentTarget=vt;try{w(_)}catch(xt){Ii(xt)}_.currentTarget=null,w=lt}}}}function We(e,i){var f=i[te];f===void 0&&(f=i[te]=new Set);var h=e+"__bubble";f.has(h)||(Rv(i,e,2,!1),f.add(h))}function $g(e,i,f){var h=0;i&&(h|=4),Rv(f,e,h,i)}var N0="_reactListening"+Math.random().toString(36).slice(2);function tp(e){if(!e[N0]){e[N0]=!0,An.forEach(function(f){f!=="selectionchange"&&(Hb.has(f)||$g(f,!1,e),$g(f,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[N0]||(i[N0]=!0,$g("selectionchange",!1,i))}}function Rv(e,i,f,h){switch(ny(i)){case 2:var _=p4;break;case 8:_=m4;break;default:_=pp}f=_.bind(null,i,f,e),_=void 0,!Gu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(_=!0),h?_!==void 0?e.addEventListener(i,f,{capture:!0,passive:_}):e.addEventListener(i,f,!0):_!==void 0?e.addEventListener(i,f,{passive:_}):e.addEventListener(i,f,!1)}function ep(e,i,f,h,_){var w=h;if((i&1)===0&&(i&2)===0&&h!==null)t:for(;;){if(h===null)return;var q=h.tag;if(q===3||q===4){var $=h.stateNode.containerInfo;if($===_)break;if(q===4)for(q=h.return;q!==null;){var lt=q.tag;if((lt===3||lt===4)&&q.stateNode.containerInfo===_)return;q=q.return}for(;$!==null;){if(q=de($),q===null)return;if(lt=q.tag,lt===5||lt===6||lt===26||lt===27){h=w=q;continue t}$=$.parentNode}}h=h.return}jf(function(){var vt=w,xt=Pu(f),jt=[];t:{var bt=Zf.get(e);if(bt!==void 0){var Ct=qu,ie=e;switch(e){case"keypress":if(xl(f)===0)break t;case"keydown":case"keyup":Ct=Lf;break;case"focusin":ie="focus",Ct=Ku;break;case"focusout":ie="blur",Ct=Ku;break;case"beforeblur":case"afterblur":Ct=Ku;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ct=Bf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ct=Ul;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ct=Aa;break;case ic:case Ff:case kh:Ct=is;break;case Ka:Ct=Uh;break;case"scroll":case"scrollend":Ct=wh;break;case"wheel":Ct=zh;break;case"copy":case"cut":case"paste":Ct=rs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ct=Pf;break;case"toggle":case"beforetoggle":Ct=Qu}var _e=(i&4)!==0,Un=!_e&&(e==="scroll"||e==="scrollend"),gt=_e?bt!==null?bt+"Capture":null:bt;_e=[];for(var ft=vt,mt;ft!==null;){var Dt=ft;if(mt=Dt.stateNode,Dt=Dt.tag,Dt!==5&&Dt!==26&&Dt!==27||mt===null||gt===null||(Dt=No(ft,gt),Dt!=null&&_e.push(Gd(ft,Dt,mt))),Un)break;ft=ft.return}0<_e.length&&(bt=new Ct(bt,ie,null,f,xt),jt.push({event:bt,listeners:_e}))}}if((i&7)===0){t:{if(bt=e==="mouseover"||e==="pointerover",Ct=e==="mouseout"||e==="pointerout",bt&&f!==xo&&(ie=f.relatedTarget||f.fromElement)&&(de(ie)||ie[Et]))break t;if((Ct||bt)&&(bt=xt.window===xt?xt:(bt=xt.ownerDocument)?bt.defaultView||bt.parentWindow:window,Ct?(ie=f.relatedTarget||f.toElement,Ct=vt,ie=ie?de(ie):null,ie!==null&&(Un=l(ie),_e=ie.tag,ie!==Un||_e!==5&&_e!==27&&_e!==6)&&(ie=null)):(Ct=null,ie=vt),Ct!==ie)){if(_e=Bf,Dt="onMouseLeave",gt="onMouseEnter",ft="mouse",(e==="pointerout"||e==="pointerover")&&(_e=Pf,Dt="onPointerLeave",gt="onPointerEnter",ft="pointer"),Un=Ct==null?bt:qe(Ct),mt=ie==null?bt:qe(ie),bt=new _e(Dt,ft+"leave",Ct,f,xt),bt.target=Un,bt.relatedTarget=mt,Dt=null,de(xt)===vt&&(_e=new _e(gt,ft+"enter",ie,f,xt),_e.target=mt,_e.relatedTarget=Un,Dt=_e),Un=Dt,Ct&&ie)e:{for(_e=kb,gt=Ct,ft=ie,mt=0,Dt=gt;Dt;Dt=_e(Dt))mt++;Dt=0;for(var he=ft;he;he=_e(he))Dt++;for(;0<mt-Dt;)gt=_e(gt),mt--;for(;0<Dt-mt;)ft=_e(ft),Dt--;for(;mt--;){if(gt===ft||ft!==null&&gt===ft.alternate){_e=gt;break e}gt=_e(gt),ft=_e(ft)}_e=null}else _e=null;Ct!==null&&Ov(jt,bt,Ct,_e,!1),ie!==null&&Un!==null&&Ov(jt,Un,ie,_e,!0)}}t:{if(bt=vt?qe(vt):window,Ct=bt.nodeName&&bt.nodeName.toLowerCase(),Ct==="select"||Ct==="input"&&bt.type==="file")var pn=$u;else if(nr(bt))if(kf)pn=Hg;else{pn=Jn;var le=Hl}else Ct=bt.nodeName,!Ct||Ct.toLowerCase()!=="input"||bt.type!=="checkbox"&&bt.type!=="radio"?vt&&Lu(vt.elementType)&&(pn=$u):pn=Gg;if(pn&&(pn=pn(e,vt))){Wu(jt,pn,f,xt);break t}le&&le(e,bt,vt),e==="focusout"&&vt&&bt.type==="number"&&vt.memoizedProps.value!=null&&Rf(bt,"number",bt.value)}switch(le=vt?qe(vt):window,e){case"focusin":(nr(le)||le.contentEditable==="true")&&(Bs=le,kl=vt,zs=null);break;case"focusout":zs=kl=Bs=null;break;case"mousedown":zo=!0;break;case"contextmenu":case"mouseup":case"dragend":zo=!1,Qf(jt,f,xt);break;case"selectionchange":if(Kf)break;case"keydown":case"keyup":Qf(jt,f,xt)}var Ye;if(Xu)t:{switch(e){case"compositionstart":var en="onCompositionStart";break t;case"compositionend":en="onCompositionEnd";break t;case"compositionupdate":en="onCompositionUpdate";break t}en=void 0}else ss?Zu(e,f)&&(en="onCompositionEnd"):e==="keydown"&&f.keyCode===229&&(en="onCompositionStart");en&&(Fu&&f.locale!=="ko"&&(ss||en!=="onCompositionStart"?en==="onCompositionEnd"&&ss&&(Ye=Uf()):(Rr=xt,Hu="value"in Rr?Rr.value:Rr.textContent,ss=!0)),le=M0(vt,en),0<le.length&&(en=new Bl(en,e,null,f,xt),jt.push({event:en,listeners:le}),Ye?en.data=Ye:(Ye=zl(f),Ye!==null&&(en.data=Ye)))),(Ye=Ph?Ih(e,f):Hf(e,f))&&(en=M0(vt,"onBeforeInput"),0<en.length&&(le=new Bl("onBeforeInput","beforeinput",null,f,xt),jt.push({event:le,listeners:en}),le.data=Ye)),Pb(jt,e,vt,f,xt)}wv(jt,i)})}function Gd(e,i,f){return{instance:e,listener:i,currentTarget:f}}function M0(e,i){for(var f=i+"Capture",h=[];e!==null;){var _=e,w=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||w===null||(_=No(e,f),_!=null&&h.unshift(Gd(e,_,w)),_=No(e,i),_!=null&&h.push(Gd(e,_,w))),e.tag===3)return h;e=e.return}return[]}function kb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Ov(e,i,f,h,_){for(var w=i._reactName,q=[];f!==null&&f!==h;){var $=f,lt=$.alternate,vt=$.stateNode;if($=$.tag,lt!==null&&lt===h)break;$!==5&&$!==26&&$!==27||vt===null||(lt=vt,_?(vt=No(f,w),vt!=null&&q.unshift(Gd(f,vt,lt))):_||(vt=No(f,w),vt!=null&&q.push(Gd(f,vt,lt)))),f=f.return}q.length!==0&&e.push({event:i,listeners:q})}var qb=/\r\n?/g,Vb=/\u0000|\uFFFD/g;function xv(e){return(typeof e=="string"?e:""+e).replace(qb,`
`).replace(Vb,"")}function Nv(e,i){return i=xv(i),xv(e)===i}function jn(e,i,f,h,_,w){switch(f){case"children":typeof h=="string"?i==="body"||i==="textarea"&&h===""||es(e,h):(typeof h=="number"||typeof h=="bigint")&&i!=="body"&&es(e,""+h);break;case"className":Oi(e,"class",h);break;case"tabIndex":Oi(e,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Oi(e,f,h);break;case"style":Mf(e,h,w);break;case"data":if(i!=="object"){Oi(e,"data",h);break}case"src":case"href":if(h===""&&(i!=="a"||f!=="href")){e.removeAttribute(f);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(f);break}h=Ol(""+h),e.setAttribute(f,h);break;case"action":case"formAction":if(typeof h=="function"){e.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(f==="formAction"?(i!=="input"&&jn(e,i,"name",_.name,_,null),jn(e,i,"formEncType",_.formEncType,_,null),jn(e,i,"formMethod",_.formMethod,_,null),jn(e,i,"formTarget",_.formTarget,_,null)):(jn(e,i,"encType",_.encType,_,null),jn(e,i,"method",_.method,_,null),jn(e,i,"target",_.target,_,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(f);break}h=Ol(""+h),e.setAttribute(f,h);break;case"onClick":h!=null&&(e.onclick=ni);break;case"onScroll":h!=null&&We("scroll",e);break;case"onScrollEnd":h!=null&&We("scrollend",e);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(f=h.__html,f!=null){if(_.children!=null)throw Error(a(60));e.innerHTML=f}}break;case"multiple":e.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":e.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){e.removeAttribute("xlink:href");break}f=Ol(""+h),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,""+h):e.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,""):e.removeAttribute(f);break;case"capture":case"download":h===!0?e.setAttribute(f,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,h):e.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?e.setAttribute(f,h):e.removeAttribute(f);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?e.removeAttribute(f):e.setAttribute(f,h);break;case"popover":We("beforetoggle",e),We("toggle",e),Oo(e,"popover",h);break;case"xlinkActuate":xi(e,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":xi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":xi(e,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":xi(e,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":xi(e,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":xi(e,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":xi(e,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":xi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":xi(e,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Oo(e,"is",h);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Ah.get(f)||f,Oo(e,f,h))}}function np(e,i,f,h,_,w){switch(f){case"style":Mf(e,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(f=h.__html,f!=null){if(_.children!=null)throw Error(a(60));e.innerHTML=f}}break;case"children":typeof h=="string"?es(e,h):(typeof h=="number"||typeof h=="bigint")&&es(e,""+h);break;case"onScroll":h!=null&&We("scroll",e);break;case"onScrollEnd":h!=null&&We("scrollend",e);break;case"onClick":h!=null&&(e.onclick=ni);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zn.hasOwnProperty(f))t:{if(f[0]==="o"&&f[1]==="n"&&(_=f.endsWith("Capture"),i=f.slice(2,_?f.length-7:void 0),w=e[wt]||null,w=w!=null?w[f]:null,typeof w=="function"&&e.removeEventListener(i,w,_),typeof h=="function")){typeof w!="function"&&w!==null&&(f in e?e[f]=null:e.hasAttribute(f)&&e.removeAttribute(f)),e.addEventListener(i,h,_);break t}f in e?e[f]=h:h===!0?e.setAttribute(f,""):Oo(e,f,h)}}}function ti(e,i,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":We("error",e),We("load",e);var h=!1,_=!1,w;for(w in f)if(f.hasOwnProperty(w)){var q=f[w];if(q!=null)switch(w){case"src":h=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:jn(e,i,w,q,f,null)}}_&&jn(e,i,"srcSet",f.srcSet,f,null),h&&jn(e,i,"src",f.src,f,null);return;case"input":We("invalid",e);var $=w=q=_=null,lt=null,vt=null;for(h in f)if(f.hasOwnProperty(h)){var xt=f[h];if(xt!=null)switch(h){case"name":_=xt;break;case"type":q=xt;break;case"checked":lt=xt;break;case"defaultChecked":vt=xt;break;case"value":w=xt;break;case"defaultValue":$=xt;break;case"children":case"dangerouslySetInnerHTML":if(xt!=null)throw Error(a(137,i));break;default:jn(e,i,h,xt,f,null)}}wf(e,w,$,lt,vt,q,_,!1);return;case"select":We("invalid",e),h=q=w=null;for(_ in f)if(f.hasOwnProperty(_)&&($=f[_],$!=null))switch(_){case"value":w=$;break;case"defaultValue":q=$;break;case"multiple":h=$;default:jn(e,i,_,$,f,null)}i=w,f=q,e.multiple=!!h,i!=null?Ms(e,!!h,i,!1):f!=null&&Ms(e,!!h,f,!0);return;case"textarea":We("invalid",e),w=_=h=null;for(q in f)if(f.hasOwnProperty(q)&&($=f[q],$!=null))switch(q){case"value":h=$;break;case"defaultValue":_=$;break;case"children":w=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(a(91));break;default:jn(e,i,q,$,f,null)}xf(e,h,_,w);return;case"option":for(lt in f)if(f.hasOwnProperty(lt)&&(h=f[lt],h!=null))switch(lt){case"selected":e.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:jn(e,i,lt,h,f,null)}return;case"dialog":We("beforetoggle",e),We("toggle",e),We("cancel",e),We("close",e);break;case"iframe":case"object":We("load",e);break;case"video":case"audio":for(h=0;h<Id.length;h++)We(Id[h],e);break;case"image":We("error",e),We("load",e);break;case"details":We("toggle",e);break;case"embed":case"source":case"link":We("error",e),We("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(vt in f)if(f.hasOwnProperty(vt)&&(h=f[vt],h!=null))switch(vt){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:jn(e,i,vt,h,f,null)}return;default:if(Lu(i)){for(xt in f)f.hasOwnProperty(xt)&&(h=f[xt],h!==void 0&&np(e,i,xt,h,f,void 0));return}}for($ in f)f.hasOwnProperty($)&&(h=f[$],h!=null&&jn(e,i,$,h,f,null))}function Yb(e,i,f,h){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,w=null,q=null,$=null,lt=null,vt=null,xt=null;for(Ct in f){var jt=f[Ct];if(f.hasOwnProperty(Ct)&&jt!=null)switch(Ct){case"checked":break;case"value":break;case"defaultValue":lt=jt;default:h.hasOwnProperty(Ct)||jn(e,i,Ct,null,h,jt)}}for(var bt in h){var Ct=h[bt];if(jt=f[bt],h.hasOwnProperty(bt)&&(Ct!=null||jt!=null))switch(bt){case"type":w=Ct;break;case"name":_=Ct;break;case"checked":vt=Ct;break;case"defaultChecked":xt=Ct;break;case"value":q=Ct;break;case"defaultValue":$=Ct;break;case"children":case"dangerouslySetInnerHTML":if(Ct!=null)throw Error(a(137,i));break;default:Ct!==jt&&jn(e,i,bt,Ct,h,jt)}}Rl(e,q,$,lt,vt,xt,w,_);return;case"select":Ct=q=$=bt=null;for(w in f)if(lt=f[w],f.hasOwnProperty(w)&&lt!=null)switch(w){case"value":break;case"multiple":Ct=lt;default:h.hasOwnProperty(w)||jn(e,i,w,null,h,lt)}for(_ in h)if(w=h[_],lt=f[_],h.hasOwnProperty(_)&&(w!=null||lt!=null))switch(_){case"value":bt=w;break;case"defaultValue":$=w;break;case"multiple":q=w;default:w!==lt&&jn(e,i,_,w,h,lt)}i=$,f=q,h=Ct,bt!=null?Ms(e,!!f,bt,!1):!!h!=!!f&&(i!=null?Ms(e,!!f,i,!0):Ms(e,!!f,f?[]:"",!1));return;case"textarea":Ct=bt=null;for($ in f)if(_=f[$],f.hasOwnProperty($)&&_!=null&&!h.hasOwnProperty($))switch($){case"value":break;case"children":break;default:jn(e,i,$,null,h,_)}for(q in h)if(_=h[q],w=f[q],h.hasOwnProperty(q)&&(_!=null||w!=null))switch(q){case"value":bt=_;break;case"defaultValue":Ct=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(a(91));break;default:_!==w&&jn(e,i,q,_,h,w)}Of(e,bt,Ct);return;case"option":for(var ie in f)if(bt=f[ie],f.hasOwnProperty(ie)&&bt!=null&&!h.hasOwnProperty(ie))switch(ie){case"selected":e.selected=!1;break;default:jn(e,i,ie,null,h,bt)}for(lt in h)if(bt=h[lt],Ct=f[lt],h.hasOwnProperty(lt)&&bt!==Ct&&(bt!=null||Ct!=null))switch(lt){case"selected":e.selected=bt&&typeof bt!="function"&&typeof bt!="symbol";break;default:jn(e,i,lt,bt,h,Ct)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var _e in f)bt=f[_e],f.hasOwnProperty(_e)&&bt!=null&&!h.hasOwnProperty(_e)&&jn(e,i,_e,null,h,bt);for(vt in h)if(bt=h[vt],Ct=f[vt],h.hasOwnProperty(vt)&&bt!==Ct&&(bt!=null||Ct!=null))switch(vt){case"children":case"dangerouslySetInnerHTML":if(bt!=null)throw Error(a(137,i));break;default:jn(e,i,vt,bt,h,Ct)}return;default:if(Lu(i)){for(var Un in f)bt=f[Un],f.hasOwnProperty(Un)&&bt!==void 0&&!h.hasOwnProperty(Un)&&np(e,i,Un,void 0,h,bt);for(xt in h)bt=h[xt],Ct=f[xt],!h.hasOwnProperty(xt)||bt===Ct||bt===void 0&&Ct===void 0||np(e,i,xt,bt,h,Ct);return}}for(var gt in f)bt=f[gt],f.hasOwnProperty(gt)&&bt!=null&&!h.hasOwnProperty(gt)&&jn(e,i,gt,null,h,bt);for(jt in h)bt=h[jt],Ct=f[jt],!h.hasOwnProperty(jt)||bt===Ct||bt==null&&Ct==null||jn(e,i,jt,bt,h,Ct)}function Mv(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Kb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,i=0,f=performance.getEntriesByType("resource"),h=0;h<f.length;h++){var _=f[h],w=_.transferSize,q=_.initiatorType,$=_.duration;if(w&&$&&Mv(q)){for(q=0,$=_.responseEnd,h+=1;h<f.length;h++){var lt=f[h],vt=lt.startTime;if(vt>$)break;var xt=lt.transferSize,jt=lt.initiatorType;xt&&Mv(jt)&&(lt=lt.responseEnd,q+=xt*(lt<$?1:($-vt)/(lt-vt)))}if(--h,i+=8*(w+q)/(_.duration/1e3),e++,10<e)break}}if(0<e)return i/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var ap=null,ip=null;function D0(e){return e.nodeType===9?e:e.ownerDocument}function Dv(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jv(e,i){if(e===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&i==="foreignObject"?0:e}function rp(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var sp=null;function Qb(){var e=window.event;return e&&e.type==="popstate"?e===sp?!1:(sp=e,!0):(sp=null,!1)}var Uv=typeof setTimeout=="function"?setTimeout:void 0,Xb=typeof clearTimeout=="function"?clearTimeout:void 0,Bv=typeof Promise=="function"?Promise:void 0,Fb=typeof queueMicrotask=="function"?queueMicrotask:typeof Bv<"u"?function(e){return Bv.resolve(null).then(e).catch(Jb)}:Uv;function Jb(e){setTimeout(function(){throw e})}function rl(e){return e==="head"}function zv(e,i){var f=i,h=0;do{var _=f.nextSibling;if(e.removeChild(f),_&&_.nodeType===8)if(f=_.data,f==="/$"||f==="/&"){if(h===0){e.removeChild(_),Jc(i);return}h--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")h++;else if(f==="html")Hd(e.ownerDocument.documentElement);else if(f==="head"){f=e.ownerDocument.head,Hd(f);for(var w=f.firstChild;w;){var q=w.nextSibling,$=w.nodeName;w[En]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&w.rel.toLowerCase()==="stylesheet"||f.removeChild(w),w=q}}else f==="body"&&Hd(e.ownerDocument.body);f=_}while(f);Jc(i)}function Lv(e,i){var f=e;e=0;do{var h=f.nextSibling;if(f.nodeType===1?i?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(i?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),h&&h.nodeType===8)if(f=h.data,f==="/$"){if(e===0)break;e--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||e++;f=h}while(f)}function op(e){var i=e.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var f=i;switch(i=i.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":op(f),fe(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}e.removeChild(f)}}function Zb(e,i,f,h){for(;e.nodeType===1;){var _=f;if(e.nodeName.toLowerCase()!==i.toLowerCase()){if(!h&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(h){if(!e[En])switch(i){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(w=e.getAttribute("rel"),w==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(w!==_.rel||e.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||e.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||e.getAttribute("title")!==(_.title==null?null:_.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(w=e.getAttribute("src"),(w!==(_.src==null?null:_.src)||e.getAttribute("type")!==(_.type==null?null:_.type)||e.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&w&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(i==="input"&&e.type==="hidden"){var w=_.name==null?null:""+_.name;if(_.type==="hidden"&&e.getAttribute("name")===w)return e}else return e;if(e=Cr(e.nextSibling),e===null)break}return null}function Wb(e,i,f){if(i==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!f||(e=Cr(e.nextSibling),e===null))return null;return e}function Pv(e,i){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=Cr(e.nextSibling),e===null))return null;return e}function lp(e){return e.data==="$?"||e.data==="$~"}function up(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function $b(e,i){var f=e.ownerDocument;if(e.data==="$~")e._reactRetry=i;else if(e.data!=="$?"||f.readyState!=="loading")i();else{var h=function(){i(),f.removeEventListener("DOMContentLoaded",h)};f.addEventListener("DOMContentLoaded",h),e._reactRetry=h}}function Cr(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return e}var cp=null;function Iv(e){e=e.nextSibling;for(var i=0;e;){if(e.nodeType===8){var f=e.data;if(f==="/$"||f==="/&"){if(i===0)return Cr(e.nextSibling);i--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||i++}e=e.nextSibling}return null}function Gv(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var f=e.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(i===0)return e;i--}else f!=="/$"&&f!=="/&"||i++}e=e.previousSibling}return null}function Hv(e,i,f){switch(i=D0(f),e){case"html":if(e=i.documentElement,!e)throw Error(a(452));return e;case"head":if(e=i.head,!e)throw Error(a(453));return e;case"body":if(e=i.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function Hd(e){for(var i=e.attributes;i.length;)e.removeAttributeNode(i[0]);fe(e)}var Tr=new Map,kv=new Set;function j0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var bo=H.d;H.d={f:t4,r:e4,D:n4,C:a4,L:i4,m:r4,X:o4,S:s4,M:l4};function t4(){var e=bo.f(),i=nl();return e||i}function e4(e){var i=Zt(e);i!==null&&i.tag===5&&i.type==="form"?y0(i):bo.r(e)}var Qc=typeof document>"u"?null:document;function qv(e,i,f){var h=Qc;if(h&&typeof i=="string"&&i){var _=pi(i);_='link[rel="'+e+'"][href="'+_+'"]',typeof f=="string"&&(_+='[crossorigin="'+f+'"]'),kv.has(_)||(kv.add(_),e={rel:e,crossOrigin:f,href:i},h.querySelector(_)===null&&(i=h.createElement("link"),ti(i,"link",e),Ce(i),h.head.appendChild(i)))}}function n4(e){bo.D(e),qv("dns-prefetch",e,null)}function a4(e,i){bo.C(e,i),qv("preconnect",e,i)}function i4(e,i,f){bo.L(e,i,f);var h=Qc;if(h&&e&&i){var _='link[rel="preload"][as="'+pi(i)+'"]';i==="image"&&f&&f.imageSrcSet?(_+='[imagesrcset="'+pi(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(_+='[imagesizes="'+pi(f.imageSizes)+'"]')):_+='[href="'+pi(e)+'"]';var w=_;switch(i){case"style":w=Xc(e);break;case"script":w=Fc(e)}Tr.has(w)||(e=C({rel:"preload",href:i==="image"&&f&&f.imageSrcSet?void 0:e,as:i},f),Tr.set(w,e),h.querySelector(_)!==null||i==="style"&&h.querySelector(kd(w))||i==="script"&&h.querySelector(qd(w))||(i=h.createElement("link"),ti(i,"link",e),Ce(i),h.head.appendChild(i)))}}function r4(e,i){bo.m(e,i);var f=Qc;if(f&&e){var h=i&&typeof i.as=="string"?i.as:"script",_='link[rel="modulepreload"][as="'+pi(h)+'"][href="'+pi(e)+'"]',w=_;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Fc(e)}if(!Tr.has(w)&&(e=C({rel:"modulepreload",href:e},i),Tr.set(w,e),f.querySelector(_)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(qd(w)))return}h=f.createElement("link"),ti(h,"link",e),Ce(h),f.head.appendChild(h)}}}function s4(e,i,f){bo.S(e,i,f);var h=Qc;if(h&&e){var _=Me(h).hoistableStyles,w=Xc(e);i=i||"default";var q=_.get(w);if(!q){var $={loading:0,preload:null};if(q=h.querySelector(kd(w)))$.loading=5;else{e=C({rel:"stylesheet",href:e,"data-precedence":i},f),(f=Tr.get(w))&&fp(e,f);var lt=q=h.createElement("link");Ce(lt),ti(lt,"link",e),lt._p=new Promise(function(vt,xt){lt.onload=vt,lt.onerror=xt}),lt.addEventListener("load",function(){$.loading|=1}),lt.addEventListener("error",function(){$.loading|=2}),$.loading|=4,U0(q,i,h)}q={type:"stylesheet",instance:q,count:1,state:$},_.set(w,q)}}}function o4(e,i){bo.X(e,i);var f=Qc;if(f&&e){var h=Me(f).hoistableScripts,_=Fc(e),w=h.get(_);w||(w=f.querySelector(qd(_)),w||(e=C({src:e,async:!0},i),(i=Tr.get(_))&&dp(e,i),w=f.createElement("script"),Ce(w),ti(w,"link",e),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(_,w))}}function l4(e,i){bo.M(e,i);var f=Qc;if(f&&e){var h=Me(f).hoistableScripts,_=Fc(e),w=h.get(_);w||(w=f.querySelector(qd(_)),w||(e=C({src:e,async:!0,type:"module"},i),(i=Tr.get(_))&&dp(e,i),w=f.createElement("script"),Ce(w),ti(w,"link",e),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(_,w))}}function Vv(e,i,f,h){var _=(_=W.current)?j0(_):null;if(!_)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(i=Xc(f.href),f=Me(_).hoistableStyles,h=f.get(i),h||(h={type:"style",instance:null,count:0,state:null},f.set(i,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){e=Xc(f.href);var w=Me(_).hoistableStyles,q=w.get(e);if(q||(_=_.ownerDocument||_,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(e,q),(w=_.querySelector(kd(e)))&&!w._p&&(q.instance=w,q.state.loading=5),Tr.has(e)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Tr.set(e,f),w||u4(_,e,f,q.state))),i&&h===null)throw Error(a(528,""));return q}if(i&&h!==null)throw Error(a(529,""));return null;case"script":return i=f.async,f=f.src,typeof f=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Fc(f),f=Me(_).hoistableScripts,h=f.get(i),h||(h={type:"script",instance:null,count:0,state:null},f.set(i,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Xc(e){return'href="'+pi(e)+'"'}function kd(e){return'link[rel="stylesheet"]['+e+"]"}function Yv(e){return C({},e,{"data-precedence":e.precedence,precedence:null})}function u4(e,i,f,h){e.querySelector('link[rel="preload"][as="style"]['+i+"]")?h.loading=1:(i=e.createElement("link"),h.preload=i,i.addEventListener("load",function(){return h.loading|=1}),i.addEventListener("error",function(){return h.loading|=2}),ti(i,"link",f),Ce(i),e.head.appendChild(i))}function Fc(e){return'[src="'+pi(e)+'"]'}function qd(e){return"script[async]"+e}function Kv(e,i,f){if(i.count++,i.instance===null)switch(i.type){case"style":var h=e.querySelector('style[data-href~="'+pi(f.href)+'"]');if(h)return i.instance=h,Ce(h),h;var _=C({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return h=(e.ownerDocument||e).createElement("style"),Ce(h),ti(h,"style",_),U0(h,f.precedence,e),i.instance=h;case"stylesheet":_=Xc(f.href);var w=e.querySelector(kd(_));if(w)return i.state.loading|=4,i.instance=w,Ce(w),w;h=Yv(f),(_=Tr.get(_))&&fp(h,_),w=(e.ownerDocument||e).createElement("link"),Ce(w);var q=w;return q._p=new Promise(function($,lt){q.onload=$,q.onerror=lt}),ti(w,"link",h),i.state.loading|=4,U0(w,f.precedence,e),i.instance=w;case"script":return w=Fc(f.src),(_=e.querySelector(qd(w)))?(i.instance=_,Ce(_),_):(h=f,(_=Tr.get(w))&&(h=C({},f),dp(h,_)),e=e.ownerDocument||e,_=e.createElement("script"),Ce(_),ti(_,"link",h),e.head.appendChild(_),i.instance=_);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(h=i.instance,i.state.loading|=4,U0(h,f.precedence,e));return i.instance}function U0(e,i,f){for(var h=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=h.length?h[h.length-1]:null,w=_,q=0;q<h.length;q++){var $=h[q];if($.dataset.precedence===i)w=$;else if(w!==_)break}w?w.parentNode.insertBefore(e,w.nextSibling):(i=f.nodeType===9?f.head:f,i.insertBefore(e,i.firstChild))}function fp(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.title==null&&(e.title=i.title)}function dp(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.integrity==null&&(e.integrity=i.integrity)}var B0=null;function Qv(e,i,f){if(B0===null){var h=new Map,_=B0=new Map;_.set(f,h)}else _=B0,h=_.get(f),h||(h=new Map,_.set(f,h));if(h.has(e))return h;for(h.set(e,null),f=f.getElementsByTagName(e),_=0;_<f.length;_++){var w=f[_];if(!(w[En]||w[$n]||e==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var q=w.getAttribute(i)||"";q=e+q;var $=h.get(q);$?$.push(w):h.set(q,[w])}}return h}function Xv(e,i,f){e=e.ownerDocument||e,e.head.insertBefore(f,i==="title"?e.querySelector("head > title"):null)}function c4(e,i,f){if(f===1||i.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return e=i.disabled,typeof i.precedence=="string"&&e==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Fv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function f4(e,i,f,h){if(f.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var _=Xc(h.href),w=i.querySelector(kd(_));if(w){i=w._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(e.count++,e=z0.bind(e),i.then(e,e)),f.state.loading|=4,f.instance=w,Ce(w);return}w=i.ownerDocument||i,h=Yv(h),(_=Tr.get(_))&&fp(h,_),w=w.createElement("link"),Ce(w);var q=w;q._p=new Promise(function($,lt){q.onload=$,q.onerror=lt}),ti(w,"link",h),f.instance=w}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(f,i),(i=f.state.preload)&&(f.state.loading&3)===0&&(e.count++,f=z0.bind(e),i.addEventListener("load",f),i.addEventListener("error",f))}}var hp=0;function d4(e,i){return e.stylesheets&&e.count===0&&P0(e,e.stylesheets),0<e.count||0<e.imgCount?function(f){var h=setTimeout(function(){if(e.stylesheets&&P0(e,e.stylesheets),e.unsuspend){var w=e.unsuspend;e.unsuspend=null,w()}},6e4+i);0<e.imgBytes&&hp===0&&(hp=62500*Kb());var _=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&P0(e,e.stylesheets),e.unsuspend)){var w=e.unsuspend;e.unsuspend=null,w()}},(e.imgBytes>hp?50:800)+i);return e.unsuspend=f,function(){e.unsuspend=null,clearTimeout(h),clearTimeout(_)}}:null}function z0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)P0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var L0=null;function P0(e,i){e.stylesheets=null,e.unsuspend!==null&&(e.count++,L0=new Map,i.forEach(h4,e),L0=null,z0.call(e))}function h4(e,i){if(!(i.state.loading&4)){var f=L0.get(e);if(f)var h=f.get(null);else{f=new Map,L0.set(e,f);for(var _=e.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<_.length;w++){var q=_[w];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(f.set(q.dataset.precedence,q),h=q)}h&&f.set(null,h)}_=i.instance,q=_.getAttribute("data-precedence"),w=f.get(q)||h,w===h&&f.set(null,_),f.set(q,_),this.count++,h=z0.bind(this),_.addEventListener("load",h),_.addEventListener("error",h),w?w.parentNode.insertBefore(_,w.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(_,e.firstChild)),i.state.loading|=4}}var Vd={$$typeof:x,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function g4(e,i,f,h,_,w,q,$,lt){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ke(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ke(0),this.hiddenUpdates=Ke(null),this.identifierPrefix=h,this.onUncaughtError=_,this.onCaughtError=w,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=lt,this.incompleteTransitions=new Map}function Jv(e,i,f,h,_,w,q,$,lt,vt,xt,jt){return e=new g4(e,i,f,q,lt,vt,xt,jt,$),i=1,w===!0&&(i|=24),w=Ia(3,null,null,i),e.current=w,w.stateNode=e,i=dc(),i.refCount++,e.pooledCache=i,i.refCount++,w.memoizedState={element:h,isDehydrated:f,cache:i},Xs(w),e}function Zv(e){return e?(e=ir,e):ir}function Wv(e,i,f,h,_,w){_=Zv(_),h.context===null?h.context=_:h.pendingContext=_,h=gs(i),h.payload={element:f},w=w===void 0?null:w,w!==null&&(h.callback=w),f=ps(e,h,i),f!==null&&(gn(f,e,i),tu(f,e,i))}function $v(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var f=e.retryLane;e.retryLane=f!==0&&f<i?f:i}}function gp(e,i){$v(e,i),(e=e.alternate)&&$v(e,i)}function ty(e){if(e.tag===13||e.tag===31){var i=vi(e,67108864);i!==null&&gn(i,e,67108864),gp(e,67108864)}}function ey(e){if(e.tag===13||e.tag===31){var i=qa();i=Ta(i);var f=vi(e,i);f!==null&&gn(f,e,i),gp(e,i)}}var I0=!0;function p4(e,i,f,h){var _=D.T;D.T=null;var w=H.p;try{H.p=2,pp(e,i,f,h)}finally{H.p=w,D.T=_}}function m4(e,i,f,h){var _=D.T;D.T=null;var w=H.p;try{H.p=8,pp(e,i,f,h)}finally{H.p=w,D.T=_}}function pp(e,i,f,h){if(I0){var _=mp(h);if(_===null)ep(e,i,h,G0,f),ay(e,h);else if(y4(_,e,i,f,h))h.stopPropagation();else if(ay(e,h),i&4&&-1<v4.indexOf(e)){for(;_!==null;){var w=Zt(_);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var q=Nt(w.pendingLanes);if(q!==0){var $=w;for($.pendingLanes|=2,$.entangledLanes|=2;q;){var lt=1<<31-an(q);$.entanglements[1]|=lt,q&=~lt}Rs(w),(ve&6)===0&&(zi=Se()+500,Pd(0))}}break;case 31:case 13:$=vi(w,2),$!==null&&gn($,w,2),nl(),gp(w,2)}if(w=mp(h),w===null&&ep(e,i,h,G0,f),w===_)break;_=w}_!==null&&h.stopPropagation()}else ep(e,i,h,null,f)}}function mp(e){return e=Pu(e),vp(e)}var G0=null;function vp(e){if(G0=null,e=de(e),e!==null){var i=l(e);if(i===null)e=null;else{var f=i.tag;if(f===13){if(e=c(i),e!==null)return e;e=null}else if(f===31){if(e=d(i),e!==null)return e;e=null}else if(f===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null)}}return G0=e,null}function ny(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oe()){case $e:return 2;case xe:return 8;case ct:case Tt:return 32;case Mt:return 268435456;default:return 32}default:return 32}}var yp=!1,sl=null,ol=null,ll=null,Yd=new Map,Kd=new Map,ul=[],v4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ay(e,i){switch(e){case"focusin":case"focusout":sl=null;break;case"dragenter":case"dragleave":ol=null;break;case"mouseover":case"mouseout":ll=null;break;case"pointerover":case"pointerout":Yd.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kd.delete(i.pointerId)}}function Qd(e,i,f,h,_,w){return e===null||e.nativeEvent!==w?(e={blockedOn:i,domEventName:f,eventSystemFlags:h,nativeEvent:w,targetContainers:[_]},i!==null&&(i=Zt(i),i!==null&&ty(i)),e):(e.eventSystemFlags|=h,i=e.targetContainers,_!==null&&i.indexOf(_)===-1&&i.push(_),e)}function y4(e,i,f,h,_){switch(i){case"focusin":return sl=Qd(sl,e,i,f,h,_),!0;case"dragenter":return ol=Qd(ol,e,i,f,h,_),!0;case"mouseover":return ll=Qd(ll,e,i,f,h,_),!0;case"pointerover":var w=_.pointerId;return Yd.set(w,Qd(Yd.get(w)||null,e,i,f,h,_)),!0;case"gotpointercapture":return w=_.pointerId,Kd.set(w,Qd(Kd.get(w)||null,e,i,f,h,_)),!0}return!1}function iy(e){var i=de(e.target);if(i!==null){var f=l(i);if(f!==null){if(i=f.tag,i===13){if(i=c(f),i!==null){e.blockedOn=i,Li(e.priority,function(){ey(f)});return}}else if(i===31){if(i=d(f),i!==null){e.blockedOn=i,Li(e.priority,function(){ey(f)});return}}else if(i===3&&f.stateNode.current.memoizedState.isDehydrated){e.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}e.blockedOn=null}function H0(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var f=mp(e.nativeEvent);if(f===null){f=e.nativeEvent;var h=new f.constructor(f.type,f);xo=h,f.target.dispatchEvent(h),xo=null}else return i=Zt(f),i!==null&&ty(i),e.blockedOn=f,!1;i.shift()}return!0}function ry(e,i,f){H0(e)&&f.delete(i)}function S4(){yp=!1,sl!==null&&H0(sl)&&(sl=null),ol!==null&&H0(ol)&&(ol=null),ll!==null&&H0(ll)&&(ll=null),Yd.forEach(ry),Kd.forEach(ry)}function k0(e,i){e.blockedOn===i&&(e.blockedOn=null,yp||(yp=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,S4)))}var q0=null;function sy(e){q0!==e&&(q0=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){q0===e&&(q0=null);for(var i=0;i<e.length;i+=3){var f=e[i],h=e[i+1],_=e[i+2];if(typeof h!="function"){if(vp(h||f)===null)continue;break}var w=Zt(f);w!==null&&(e.splice(i,3),i-=3,Nc(w,{pending:!0,data:_,method:f.method,action:h},h,_))}}))}function Jc(e){function i(lt){return k0(lt,e)}sl!==null&&k0(sl,e),ol!==null&&k0(ol,e),ll!==null&&k0(ll,e),Yd.forEach(i),Kd.forEach(i);for(var f=0;f<ul.length;f++){var h=ul[f];h.blockedOn===e&&(h.blockedOn=null)}for(;0<ul.length&&(f=ul[0],f.blockedOn===null);)iy(f),f.blockedOn===null&&ul.shift();if(f=(e.ownerDocument||e).$$reactFormReplay,f!=null)for(h=0;h<f.length;h+=3){var _=f[h],w=f[h+1],q=_[wt]||null;if(typeof w=="function")q||sy(f);else if(q){var $=null;if(w&&w.hasAttribute("formAction")){if(_=w,q=w[wt]||null)$=q.formAction;else if(vp(_)!==null)continue}else $=q.action;typeof $=="function"?f[h+1]=$:(f.splice(h,3),h-=3),sy(f)}}}function oy(){function e(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(q){return _=q})},focusReset:"manual",scroll:"manual"})}function i(){_!==null&&(_(),_=null),h||setTimeout(f,20)}function f(){if(!h&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,_=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(f,100),function(){h=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),_!==null&&(_(),_=null)}}}function Sp(e){this._internalRoot=e}V0.prototype.render=Sp.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(a(409));var f=i.current,h=qa();Wv(f,h,e,i,null,null)},V0.prototype.unmount=Sp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Wv(e.current,2,null,e,null,null),nl(),i[Et]=null}};function V0(e){this._internalRoot=e}V0.prototype.unstable_scheduleHydration=function(e){if(e){var i=gi();e={blockedOn:null,target:e,priority:i};for(var f=0;f<ul.length&&i!==0&&i<ul[f].priority;f++);ul.splice(f,0,e),f===0&&iy(e)}};var ly=t.version;if(ly!=="19.2.0")throw Error(a(527,ly,"19.2.0"));H.findDOMNode=function(e){var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=m(i),e=e!==null?S(e):null,e=e===null?null:e.stateNode,e};var b4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Y0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Y0.isDisabled&&Y0.supportsFiber)try{zt=Y0.inject(b4),ee=Y0}catch{}}return Fd.createRoot=function(e,i){if(!r(e))throw Error(a(299));var f=!1,h="",_=ou,w=lu,q=Dc;return i!=null&&(i.unstable_strictMode===!0&&(f=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(_=i.onUncaughtError),i.onCaughtError!==void 0&&(w=i.onCaughtError),i.onRecoverableError!==void 0&&(q=i.onRecoverableError)),i=Jv(e,1,!1,null,null,f,h,null,_,w,q,oy),e[Et]=i.current,tp(e),new Sp(i)},Fd.hydrateRoot=function(e,i,f){if(!r(e))throw Error(a(299));var h=!1,_="",w=ou,q=lu,$=Dc,lt=null;return f!=null&&(f.unstable_strictMode===!0&&(h=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onUncaughtError!==void 0&&(w=f.onUncaughtError),f.onCaughtError!==void 0&&(q=f.onCaughtError),f.onRecoverableError!==void 0&&($=f.onRecoverableError),f.formState!==void 0&&(lt=f.formState)),i=Jv(e,1,!0,i,f??null,h,_,lt,w,q,$,oy),i.context=Zv(null),f=i.current,h=qa(),h=Ta(h),_=gs(h),_.callback=null,ps(f,_,h),f=h,i.current.lanes=f,Ne(i,f),Rs(i),e[Et]=i.current,tp(e),new V0(i)},Fd.version="19.2.0",Fd}var yy;function M4(){if(yy)return Ep.exports;yy=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),Ep.exports=N4(),Ep.exports}var D4=M4();const j4=vf(D4);N2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hh(){return hh=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},hh.apply(this,arguments)}var yl;(function(o){o.Pop="POP",o.Push="PUSH",o.Replace="REPLACE"})(yl||(yl={}));const Sy="popstate";function U4(o){o===void 0&&(o={});function t(a,r){let{pathname:l,search:c,hash:d}=a.location;return Am("",{pathname:l,search:c,hash:d},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){return typeof r=="string"?r:D2(r)}return z4(t,n,null,o)}function za(o,t){if(o===!1||o===null||typeof o>"u")throw new Error(t)}function M2(o,t){if(!o){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function B4(){return Math.random().toString(36).substr(2,8)}function by(o,t){return{usr:o.state,key:o.key,idx:t}}function Am(o,t,n,a){return n===void 0&&(n=null),hh({pathname:typeof o=="string"?o:o.pathname,search:"",hash:""},typeof t=="string"?yf(t):t,{state:n,key:t&&t.key||a||B4()})}function D2(o){let{pathname:t="/",search:n="",hash:a=""}=o;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function yf(o){let t={};if(o){let n=o.indexOf("#");n>=0&&(t.hash=o.substr(n),o=o.substr(0,n));let a=o.indexOf("?");a>=0&&(t.search=o.substr(a),o=o.substr(0,a)),o&&(t.pathname=o)}return t}function z4(o,t,n,a){a===void 0&&(a={});let{window:r=document.defaultView,v5Compat:l=!1}=a,c=r.history,d=yl.Pop,g=null,m=S();m==null&&(m=0,c.replaceState(hh({},c.state,{idx:m}),""));function S(){return(c.state||{idx:null}).idx}function C(){d=yl.Pop;let z=S(),P=z==null?null:z-m;m=z,g&&g({action:d,location:M.location,delta:P})}function E(z,P){d=yl.Push;let j=Am(M.location,z,P);m=S()+1;let x=by(j,m),L=M.createHref(j);try{c.pushState(x,"",L)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;r.location.assign(L)}l&&g&&g({action:d,location:M.location,delta:1})}function R(z,P){d=yl.Replace;let j=Am(M.location,z,P);m=S();let x=by(j,m),L=M.createHref(j);c.replaceState(x,"",L),l&&g&&g({action:d,location:M.location,delta:0})}function v(z){let P=r.location.origin!=="null"?r.location.origin:r.location.href,j=typeof z=="string"?z:D2(z);return j=j.replace(/ $/,"%20"),za(P,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,P)}let M={get action(){return d},get location(){return o(r,c)},listen(z){if(g)throw new Error("A history only accepts one active listener");return r.addEventListener(Sy,C),g=z,()=>{r.removeEventListener(Sy,C),g=null}},createHref(z){return t(r,z)},createURL:v,encodeLocation(z){let P=v(z);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:E,replace:R,go(z){return c.go(z)}};return M}var _y;(function(o){o.data="data",o.deferred="deferred",o.redirect="redirect",o.error="error"})(_y||(_y={}));function L4(o,t,n){return n===void 0&&(n="/"),P4(o,t,n)}function P4(o,t,n,a){let r=typeof t=="string"?yf(t):t,l=B2(r.pathname||"/",n);if(l==null)return null;let c=j2(o);I4(c);let d=null;for(let g=0;d==null&&g<c.length;++g){let m=Z4(l);d=X4(c[g],m)}return d}function j2(o,t,n,a){t===void 0&&(t=[]),n===void 0&&(n=[]),a===void 0&&(a="");let r=(l,c,d)=>{let g={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};g.relativePath.startsWith("/")&&(za(g.relativePath.startsWith(a),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(a.length));let m=Cu([a,g.relativePath]),S=n.concat(g);l.children&&l.children.length>0&&(za(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),j2(l.children,t,S,m)),!(l.path==null&&!l.index)&&t.push({path:m,score:K4(m,l.index),routesMeta:S})};return o.forEach((l,c)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))r(l,c);else for(let g of U2(l.path))r(l,c,g)}),t}function U2(o){let t=o.split("/");if(t.length===0)return[];let[n,...a]=t,r=n.endsWith("?"),l=n.replace(/\?$/,"");if(a.length===0)return r?[l,""]:[l];let c=U2(a.join("/")),d=[];return d.push(...c.map(g=>g===""?l:[l,g].join("/"))),r&&d.push(...c),d.map(g=>o.startsWith("/")&&g===""?"/":g)}function I4(o){o.sort((t,n)=>t.score!==n.score?n.score-t.score:Q4(t.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}const G4=/^:[\w-]+$/,H4=3,k4=2,q4=1,V4=10,Y4=-2,Ey=o=>o==="*";function K4(o,t){let n=o.split("/"),a=n.length;return n.some(Ey)&&(a+=Y4),t&&(a+=k4),n.filter(r=>!Ey(r)).reduce((r,l)=>r+(G4.test(l)?H4:l===""?q4:V4),a)}function Q4(o,t){return o.length===t.length&&o.slice(0,-1).every((a,r)=>a===t[r])?o[o.length-1]-t[t.length-1]:0}function X4(o,t,n){let{routesMeta:a}=o,r={},l="/",c=[];for(let d=0;d<a.length;++d){let g=a[d],m=d===a.length-1,S=l==="/"?t:t.slice(l.length)||"/",C=F4({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},S),E=g.route;if(!C)return null;Object.assign(r,C.params),c.push({params:r,pathname:Cu([l,C.pathname]),pathnameBase:a3(Cu([l,C.pathnameBase])),route:E}),C.pathnameBase!=="/"&&(l=Cu([l,C.pathnameBase]))}return c}function F4(o,t){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[n,a]=J4(o.path,o.caseSensitive,o.end),r=t.match(n);if(!r)return null;let l=r[0],c=l.replace(/(.)\/+$/,"$1"),d=r.slice(1);return{params:a.reduce((m,S,C)=>{let{paramName:E,isOptional:R}=S;if(E==="*"){let M=d[C]||"";c=l.slice(0,l.length-M.length).replace(/(.)\/+$/,"$1")}const v=d[C];return R&&!v?m[E]=void 0:m[E]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:c,pattern:o}}function J4(o,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),M2(o==="*"||!o.endsWith("*")||o.endsWith("/*"),'Route path "'+o+'" will be treated as if it were '+('"'+o.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+o.replace(/\*$/,"/*")+'".'));let a=[],r="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,g)=>(a.push({paramName:d,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(a.push({paramName:"*"}),r+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":o!==""&&o!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function Z4(o){try{return o.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return M2(!1,'The URL path "'+o+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),o}}function B2(o,t){if(t==="/")return o;if(!o.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=o.charAt(n);return a&&a!=="/"?null:o.slice(n)||"/"}function W4(o,t){t===void 0&&(t="/");let{pathname:n,search:a="",hash:r=""}=typeof o=="string"?yf(o):o;return{pathname:n?n.startsWith("/")?n:$4(n,t):t,search:i3(a),hash:r3(r)}}function $4(o,t){let n=t.replace(/\/+$/,"").split("/");return o.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function wp(o,t,n,a){return"Cannot include a '"+o+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function t3(o){return o.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function e3(o,t){let n=t3(o);return t?n.map((a,r)=>r===n.length-1?a.pathname:a.pathnameBase):n.map(a=>a.pathnameBase)}function n3(o,t,n,a){a===void 0&&(a=!1);let r;typeof o=="string"?r=yf(o):(r=hh({},o),za(!r.pathname||!r.pathname.includes("?"),wp("?","pathname","search",r)),za(!r.pathname||!r.pathname.includes("#"),wp("#","pathname","hash",r)),za(!r.search||!r.search.includes("#"),wp("#","search","hash",r)));let l=o===""||r.pathname==="",c=l?"/":r.pathname,d;if(c==null)d=n;else{let C=t.length-1;if(!a&&c.startsWith("..")){let E=c.split("/");for(;E[0]==="..";)E.shift(),C-=1;r.pathname=E.join("/")}d=C>=0?t[C]:"/"}let g=W4(r,d),m=c&&c!=="/"&&c.endsWith("/"),S=(l||c===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(m||S)&&(g.pathname+="/"),g}const Cu=o=>o.join("/").replace(/\/\/+/g,"/"),a3=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),i3=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,r3=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function s3(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}const z2=["post","put","patch","delete"];new Set(z2);const o3=["get",...z2];new Set(o3);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gh(){return gh=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},gh.apply(this,arguments)}const $m=rt.createContext(null),l3=rt.createContext(null),Rg=rt.createContext(null),Og=rt.createContext(null),Sf=rt.createContext({outlet:null,matches:[],isDataRoute:!1}),L2=rt.createContext(null);function xg(){return rt.useContext(Og)!=null}function tv(){return xg()||za(!1),rt.useContext(Og).location}function P2(o){rt.useContext(Rg).static||rt.useLayoutEffect(o)}function bf(){let{isDataRoute:o}=rt.useContext(Sf);return o?_3():u3()}function u3(){xg()||za(!1);let o=rt.useContext($m),{basename:t,future:n,navigator:a}=rt.useContext(Rg),{matches:r}=rt.useContext(Sf),{pathname:l}=tv(),c=JSON.stringify(e3(r,n.v7_relativeSplatPath)),d=rt.useRef(!1);return P2(()=>{d.current=!0}),rt.useCallback(function(m,S){if(S===void 0&&(S={}),!d.current)return;if(typeof m=="number"){a.go(m);return}let C=n3(m,JSON.parse(c),l,S.relative==="path");o==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:Cu([t,C.pathname])),(S.replace?a.replace:a.push)(C,S.state,S)},[t,a,c,l,o])}function c3(o,t){return f3(o,t)}function f3(o,t,n,a){xg()||za(!1);let{navigator:r}=rt.useContext(Rg),{matches:l}=rt.useContext(Sf),c=l[l.length-1],d=c?c.params:{};c&&c.pathname;let g=c?c.pathnameBase:"/";c&&c.route;let m=tv(),S;if(t){var C;let z=typeof t=="string"?yf(t):t;g==="/"||(C=z.pathname)!=null&&C.startsWith(g)||za(!1),S=z}else S=m;let E=S.pathname||"/",R=E;if(g!=="/"){let z=g.replace(/^\//,"").split("/");R="/"+E.replace(/^\//,"").split("/").slice(z.length).join("/")}let v=L4(o,{pathname:R}),M=m3(v&&v.map(z=>Object.assign({},z,{params:Object.assign({},d,z.params),pathname:Cu([g,r.encodeLocation?r.encodeLocation(z.pathname).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?g:Cu([g,r.encodeLocation?r.encodeLocation(z.pathnameBase).pathname:z.pathnameBase])})),l,n,a);return t&&M?rt.createElement(Og.Provider,{value:{location:gh({pathname:"/",search:"",hash:"",state:null,key:"default"},S),navigationType:yl.Pop}},M):M}function d3(){let o=b3(),t=s3(o)?o.status+" "+o.statusText:o instanceof Error?o.message:JSON.stringify(o),n=o instanceof Error?o.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return rt.createElement(rt.Fragment,null,rt.createElement("h2",null,"Unexpected Application Error!"),rt.createElement("h3",{style:{fontStyle:"italic"}},t),n?rt.createElement("pre",{style:r},n):null,null)}const h3=rt.createElement(d3,null);class g3 extends rt.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?rt.createElement(Sf.Provider,{value:this.props.routeContext},rt.createElement(L2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function p3(o){let{routeContext:t,match:n,children:a}=o,r=rt.useContext($m);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),rt.createElement(Sf.Provider,{value:t},a)}function m3(o,t,n,a){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),a===void 0&&(a=null),o==null){var l;if(!n)return null;if(n.errors)o=n.matches;else if((l=a)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)o=n.matches;else return null}let c=o,d=(r=n)==null?void 0:r.errors;if(d!=null){let S=c.findIndex(C=>C.route.id&&(d==null?void 0:d[C.route.id])!==void 0);S>=0||za(!1),c=c.slice(0,Math.min(c.length,S+1))}let g=!1,m=-1;if(n&&a&&a.v7_partialHydration)for(let S=0;S<c.length;S++){let C=c[S];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(m=S),C.route.id){let{loaderData:E,errors:R}=n,v=C.route.loader&&E[C.route.id]===void 0&&(!R||R[C.route.id]===void 0);if(C.route.lazy||v){g=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((S,C,E)=>{let R,v=!1,M=null,z=null;n&&(R=d&&C.route.id?d[C.route.id]:void 0,M=C.route.errorElement||h3,g&&(m<0&&E===0?(E3("route-fallback"),v=!0,z=null):m===E&&(v=!0,z=C.route.hydrateFallbackElement||null)));let P=t.concat(c.slice(0,E+1)),j=()=>{let x;return R?x=M:v?x=z:C.route.Component?x=rt.createElement(C.route.Component,null):C.route.element?x=C.route.element:x=S,rt.createElement(p3,{match:C,routeContext:{outlet:S,matches:P,isDataRoute:n!=null},children:x})};return n&&(C.route.ErrorBoundary||C.route.errorElement||E===0)?rt.createElement(g3,{location:n.location,revalidation:n.revalidation,component:M,error:R,children:j(),routeContext:{outlet:null,matches:P,isDataRoute:!0}}):j()},null)}var I2=(function(o){return o.UseBlocker="useBlocker",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o})(I2||{}),G2=(function(o){return o.UseBlocker="useBlocker",o.UseLoaderData="useLoaderData",o.UseActionData="useActionData",o.UseRouteError="useRouteError",o.UseNavigation="useNavigation",o.UseRouteLoaderData="useRouteLoaderData",o.UseMatches="useMatches",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o.UseRouteId="useRouteId",o})(G2||{});function v3(o){let t=rt.useContext($m);return t||za(!1),t}function y3(o){let t=rt.useContext(l3);return t||za(!1),t}function S3(o){let t=rt.useContext(Sf);return t||za(!1),t}function H2(o){let t=S3(),n=t.matches[t.matches.length-1];return n.route.id||za(!1),n.route.id}function b3(){var o;let t=rt.useContext(L2),n=y3(),a=H2();return t!==void 0?t:(o=n.errors)==null?void 0:o[a]}function _3(){let{router:o}=v3(I2.UseNavigateStable),t=H2(G2.UseNavigateStable),n=rt.useRef(!1);return P2(()=>{n.current=!0}),rt.useCallback(function(r,l){l===void 0&&(l={}),n.current&&(typeof r=="number"?o.navigate(r):o.navigate(r,gh({fromRouteId:t},l)))},[o,t])}const Cy={};function E3(o,t,n){Cy[o]||(Cy[o]=!0)}function C3(o,t){o==null||o.v7_startTransition,o==null||o.v7_relativeSplatPath}function vu(o){za(!1)}function T3(o){let{basename:t="/",children:n=null,location:a,navigationType:r=yl.Pop,navigator:l,static:c=!1,future:d}=o;xg()&&za(!1);let g=t.replace(/^\/*/,"/"),m=rt.useMemo(()=>({basename:g,navigator:l,static:c,future:gh({v7_relativeSplatPath:!1},d)}),[g,d,l,c]);typeof a=="string"&&(a=yf(a));let{pathname:S="/",search:C="",hash:E="",state:R=null,key:v="default"}=a,M=rt.useMemo(()=>{let z=B2(S,g);return z==null?null:{location:{pathname:z,search:C,hash:E,state:R,key:v},navigationType:r}},[g,S,C,E,R,v,r]);return M==null?null:rt.createElement(Rg.Provider,{value:m},rt.createElement(Og.Provider,{children:n,value:M}))}function A3(o){let{children:t,location:n}=o;return c3(wm(t),n)}new Promise(()=>{});function wm(o,t){t===void 0&&(t=[]);let n=[];return rt.Children.forEach(o,(a,r)=>{if(!rt.isValidElement(a))return;let l=[...t,r];if(a.type===rt.Fragment){n.push.apply(n,wm(a.props.children,l));return}a.type!==vu&&za(!1),!a.props.index||!a.props.children||za(!1);let c={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(c.children=wm(a.props.children,l)),n.push(c)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rm(o){return o===void 0&&(o=""),new URLSearchParams(typeof o=="string"||Array.isArray(o)||o instanceof URLSearchParams?o:Object.keys(o).reduce((t,n)=>{let a=o[n];return t.concat(Array.isArray(a)?a.map(r=>[n,r]):[[n,a]])},[]))}function w3(o,t){let n=Rm(o);return t&&t.forEach((a,r)=>{n.has(r)||t.getAll(r).forEach(l=>{n.append(r,l)})}),n}const R3="6";try{window.__reactRouterVersion=R3}catch{}const O3="startTransition",Ty=w4[O3];function x3(o){let{basename:t,children:n,future:a,window:r}=o,l=rt.useRef();l.current==null&&(l.current=U4({window:r,v5Compat:!0}));let c=l.current,[d,g]=rt.useState({action:c.action,location:c.location}),{v7_startTransition:m}=a||{},S=rt.useCallback(C=>{m&&Ty?Ty(()=>g(C)):g(C)},[g,m]);return rt.useLayoutEffect(()=>c.listen(S),[c,S]),rt.useEffect(()=>C3(a),[a]),rt.createElement(T3,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:c,future:a})}var Ay;(function(o){o.UseScrollRestoration="useScrollRestoration",o.UseSubmit="useSubmit",o.UseSubmitFetcher="useSubmitFetcher",o.UseFetcher="useFetcher",o.useViewTransitionState="useViewTransitionState"})(Ay||(Ay={}));var wy;(function(o){o.UseFetcher="useFetcher",o.UseFetchers="useFetchers",o.UseScrollRestoration="useScrollRestoration"})(wy||(wy={}));function Sh(o){let t=rt.useRef(Rm(o)),n=rt.useRef(!1),a=tv(),r=rt.useMemo(()=>w3(a.search,n.current?null:t.current),[a.search]),l=bf(),c=rt.useCallback((d,g)=>{const m=Rm(typeof d=="function"?d(r):d);n.current=!0,l("?"+m,g)},[l,r]);return[r,c]}function N3(){const o=bf(),[t,n]=rt.useState(!1),[a,r]=rt.useState(""),[l,c]=rt.useState("demo"),d=g=>{g.preventDefault(),a.trim()&&l.trim()&&o(`/student?room=${l}&name=${encodeURIComponent(a.trim())}`)};return t?k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsx("div",{className:"glass-surface landing-container",style:{maxWidth:"500px"},children:k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",style:{fontSize:"2rem"},children:"Join as Student"}),k.jsx("p",{className:"landing-description",children:"Enter your name and room code to start drawing"})]}),k.jsxs("form",{onSubmit:d,style:{width:"100%",marginTop:"2rem"},children:[k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"studentName",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Your Name"}),k.jsx("input",{id:"studentName",type:"text",value:a,onChange:g=>r(g.target.value),placeholder:"Enter your name",autoFocus:!0,required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"roomCode",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Room Code"}),k.jsx("input",{id:"roomCode",type:"text",value:l,onChange:g=>c(g.target.value.toUpperCase()),placeholder:"Enter room code",required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s",fontFamily:"monospace",letterSpacing:"2px"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[k.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"2px solid #ddd",borderRadius:"8px",background:"white",cursor:"pointer",transition:"all 0.2s"},children:"← Back"}),k.jsx("button",{type:"submit",style:{flex:2,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:g=>g.target.style.transform="translateY(-2px)",onMouseOut:g=>g.target.style.transform="translateY(0)",children:"Join Room →"})]})]})]})})})]}):k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsxs("div",{className:"glass-surface landing-container",children:[k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",children:"Teach visually. Collaborate instantly."}),k.jsx("p",{className:"landing-description",children:"Feather streams pencil-perfect strokes between teachers and students in real time. Instant sync, buttery smooth annotation tools, and delightful classroom-ready controls built for iPad and stylus workflows."})]}),k.jsxs("dl",{className:"features",children:[k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Palm rejection"}),k.jsx("dd",{className:"feature-subtitle",children:"Silky palm drawing"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Frameless logos"}),k.jsx("dd",{className:"feature-subtitle",children:"Delightful annotations"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Realtime sync"}),k.jsx("dd",{className:"feature-subtitle",children:"Sub-second latency"})]})]})]}),k.jsxs("div",{className:"workspace-section",children:[k.jsx("p",{className:"workspace-label",children:"PICK YOUR WORKSPACE"}),k.jsxs("div",{className:"workspace-cards",children:[k.jsxs("a",{onClick:()=>o("/teacher"),className:"glass-button teacher-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Teacher dashboard"}),k.jsx("p",{className:"workspace-description",children:"Monitor your students, sync views, and annotate the board. Assign templates/images, and manage the class."})]}),k.jsx("span",{className:"workspace-emoji",children:"👩‍🏫"})]}),k.jsxs("a",{onClick:()=>o("/student-login"),className:"glass-button student-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Student workspace"}),k.jsx("p",{className:"workspace-description",children:"Sketch on a public or draw alongside the class, with undo/redo, templates, and stylus-first controls."})]}),k.jsx("span",{className:"workspace-emoji",children:"👩‍🎓"})]})]})]})]})})]})}const M3=Math.PI/180;function D3(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const _u=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Ft={_global:_u,version:"10.0.7",isBrowser:D3(),isUnminified:/param/.test((function(o){}).toString()),dblClickWindow:400,getAngle(o){return Ft.angleDeg?o*M3:o},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Ft.DD.isDragging},isTransforming(){var o,t;return(t=(o=Ft.Transformer)===null||o===void 0?void 0:o.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!Ft.DD.node},releaseCanvasOnDestroy:!0,document:_u.document,_injectGlobal(o){typeof _u.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),_u.Konva=o}},ua=o=>{Ft[o.prototype.getClassName()]=o};Ft._injectGlobal(Ft);const j3=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Ry=()=>{if(typeof document>"u")throw new Error(j3)};class Ji{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Ji(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const n=this.m;return{x:n[0]*t.x+n[2]*t.y+n[4],y:n[1]*t.x+n[3]*t.y+n[5]}}translate(t,n){return this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n,this}scale(t,n){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n,this}rotate(t){const n=Math.cos(t),a=Math.sin(t),r=this.m[0]*n+this.m[2]*a,l=this.m[1]*n+this.m[3]*a,c=this.m[0]*-a+this.m[2]*n,d=this.m[1]*-a+this.m[3]*n;return this.m[0]=r,this.m[1]=l,this.m[2]=c,this.m[3]=d,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,n){const a=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,l=this.m[2]+this.m[0]*t,c=this.m[3]+this.m[1]*t;return this.m[0]=a,this.m[1]=r,this.m[2]=l,this.m[3]=c,this}multiply(t){const n=this.m[0]*t.m[0]+this.m[2]*t.m[1],a=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],l=this.m[1]*t.m[2]+this.m[3]*t.m[3],c=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],d=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=l,this.m[4]=c,this.m[5]=d,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,a=-this.m[1]*t,r=-this.m[2]*t,l=this.m[0]*t,c=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),d=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=l,this.m[4]=c,this.m[5]=d,this}getMatrix(){return this.m}decompose(){const t=this.m[0],n=this.m[1],a=this.m[2],r=this.m[3],l=this.m[4],c=this.m[5],d=t*r-n*a,g={x:l,y:c,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){const m=Math.sqrt(t*t+n*n);g.rotation=n>0?Math.acos(t/m):-Math.acos(t/m),g.scaleX=m,g.scaleY=d/m,g.skewX=(t*a+n*r)/d,g.skewY=0}else if(a!=0||r!=0){const m=Math.sqrt(a*a+r*r);g.rotation=Math.PI/2-(r>0?Math.acos(-a/m):-Math.acos(a/m)),g.scaleX=d/m,g.scaleY=m,g.skewX=0,g.skewY=(t*a+n*r)/d}return g.rotation=pt._getRotation(g.rotation),g}}const U3="[object Array]",B3="[object Number]",z3="[object String]",L3="[object Boolean]",P3=Math.PI/180,I3=180/Math.PI,Rp="#",G3="",H3="0",k3="Konva warning: ",Oy="Konva error: ",q3="rgb(",Op={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},V3=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let K0=[];const Y3=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(o){setTimeout(o,60)},pt={_isElement(o){return!!(o&&o.nodeType==1)},_isFunction(o){return!!(o&&o.constructor&&o.call&&o.apply)},_isPlainObject(o){return!!o&&o.constructor===Object},_isArray(o){return Object.prototype.toString.call(o)===U3},_isNumber(o){return Object.prototype.toString.call(o)===B3&&!isNaN(o)&&isFinite(o)},_isString(o){return Object.prototype.toString.call(o)===z3},_isBoolean(o){return Object.prototype.toString.call(o)===L3},isObject(o){return o instanceof Object},isValidSelector(o){if(typeof o!="string")return!1;const t=o[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(o){return o===0||o>0?1:-1},requestAnimFrame(o){K0.push(o),K0.length===1&&Y3(function(){const t=K0;K0=[],t.forEach(function(n){n()})})},createCanvasElement(){Ry();const o=document.createElement("canvas");try{o.style=o.style||{}}catch{}return o},createImageElement(){return Ry(),document.createElement("img")},_isInDocument(o){for(;o=o.parentNode;)if(o==document)return!0;return!1},_urlToImage(o,t){const n=pt.createImageElement();n.onload=function(){t(n)},n.src=o},_rgbToHex(o,t,n){return((1<<24)+(o<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(o){o=o.replace(Rp,G3);const t=parseInt(o,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let o=(Math.random()*16777215<<0).toString(16);for(;o.length<6;)o=H3+o;return Rp+o},getRGB(o){let t;return o in Op?(t=Op[o],{r:t[0],g:t[1],b:t[2]}):o[0]===Rp?this._hexToRgb(o.substring(1)):o.substr(0,4)===q3?(t=V3.exec(o.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(o){return o=o||"black",pt._namedColorToRBA(o)||pt._hex3ColorToRGBA(o)||pt._hex4ColorToRGBA(o)||pt._hex6ColorToRGBA(o)||pt._hex8ColorToRGBA(o)||pt._rgbColorToRGBA(o)||pt._rgbaColorToRGBA(o)||pt._hslColorToRGBA(o)},_namedColorToRBA(o){const t=Op[o.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(o){if(o.indexOf("rgb(")===0){o=o.match(/rgb\(([^)]+)\)/)[1];const t=o.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(o){if(o.indexOf("rgba(")===0){o=o.match(/rgba\(([^)]+)\)/)[1];const t=o.split(/ *, */).map((n,a)=>n.slice(-1)==="%"?a===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(o){if(o[0]==="#"&&o.length===9)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:parseInt(o.slice(7,9),16)/255}},_hex6ColorToRGBA(o){if(o[0]==="#"&&o.length===7)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:1}},_hex4ColorToRGBA(o){if(o[0]==="#"&&o.length===5)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:parseInt(o[4]+o[4],16)/255}},_hex3ColorToRGBA(o){if(o[0]==="#"&&o.length===4)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:1}},_hslColorToRGBA(o){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(o)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o),a=Number(n[0])/360,r=Number(n[1])/100,l=Number(n[2])/100;let c,d,g;if(r===0)return g=l*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};l<.5?c=l*(1+r):c=l+r-l*r;const m=2*l-c,S=[0,0,0];for(let C=0;C<3;C++)d=a+1/3*-(C-1),d<0&&d++,d>1&&d--,6*d<1?g=m+(c-m)*6*d:2*d<1?g=c:3*d<2?g=m+(c-m)*(2/3-d)*6:g=m,S[C]=g*255;return{r:Math.round(S[0]),g:Math.round(S[1]),b:Math.round(S[2]),a:1}}},haveIntersection(o,t){return!(t.x>o.x+o.width||t.x+t.width<o.x||t.y>o.y+o.height||t.y+t.height<o.y)},cloneObject(o){const t={};for(const n in o)this._isPlainObject(o[n])?t[n]=this.cloneObject(o[n]):this._isArray(o[n])?t[n]=this.cloneArray(o[n]):t[n]=o[n];return t},cloneArray(o){return o.slice(0)},degToRad(o){return o*P3},radToDeg(o){return o*I3},_degToRad(o){return pt.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),pt.degToRad(o)},_radToDeg(o){return pt.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),pt.radToDeg(o)},_getRotation(o){return Ft.angleDeg?pt.radToDeg(o):o},_capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},throw(o){throw new Error(Oy+o)},error(o){console.error(Oy+o)},warn(o){Ft.showWarnings&&console.warn(k3+o)},each(o,t){for(const n in o)t(n,o[n])},_inRange(o,t,n){return t<=o&&o<n},_getProjectionToSegment(o,t,n,a,r,l){let c,d,g;const m=(o-n)*(o-n)+(t-a)*(t-a);if(m==0)c=o,d=t,g=(r-n)*(r-n)+(l-a)*(l-a);else{const S=((r-o)*(n-o)+(l-t)*(a-t))/m;S<0?(c=o,d=t,g=(o-r)*(o-r)+(t-l)*(t-l)):S>1?(c=n,d=a,g=(n-r)*(n-r)+(a-l)*(a-l)):(c=o+S*(n-o),d=t+S*(a-t),g=(c-r)*(c-r)+(d-l)*(d-l))}return[c,d,g]},_getProjectionToLine(o,t,n){const a=pt.cloneObject(o);let r=Number.MAX_VALUE;return t.forEach(function(l,c){if(!n&&c===t.length-1)return;const d=t[(c+1)%t.length],g=pt._getProjectionToSegment(l.x,l.y,d.x,d.y,o.x,o.y),m=g[0],S=g[1],C=g[2];C<r&&(a.x=m,a.y=S,r=C)}),a},_prepareArrayForTween(o,t,n){const a=[],r=[];if(o.length>t.length){const c=t;t=o,o=c}for(let c=0;c<o.length;c+=2)a.push({x:o[c],y:o[c+1]});for(let c=0;c<t.length;c+=2)r.push({x:t[c],y:t[c+1]});const l=[];return r.forEach(function(c){const d=pt._getProjectionToLine(c,a,n);l.push(d.x),l.push(d.y)}),l},_prepareToStringify(o){let t;o.visitedByCircularReferenceRemoval=!0;for(const n in o)if(o.hasOwnProperty(n)&&o[n]&&typeof o[n]=="object"){if(t=Object.getOwnPropertyDescriptor(o,n),o[n].visitedByCircularReferenceRemoval||pt._isElement(o[n]))if(t.configurable)delete o[n];else return null;else if(pt._prepareToStringify(o[n])===null)if(t.configurable)delete o[n];else return null}return delete o.visitedByCircularReferenceRemoval,o},_assign(o,t){for(const n in t)o[n]=t[n];return o},_getFirstPointerId(o){return o.touches?o.changedTouches[0].identifier:o.pointerId||999},releaseCanvas(...o){Ft.releaseCanvasOnDestroy&&o.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(o,t,n,a){let r=t<0?t:0,l=n<0?n:0;t=Math.abs(t),n=Math.abs(n);let c=0,d=0,g=0,m=0;typeof a=="number"?c=d=g=m=Math.min(a,t/2,n/2):(c=Math.min(a[0]||0,t/2,n/2),d=Math.min(a[1]||0,t/2,n/2),m=Math.min(a[2]||0,t/2,n/2),g=Math.min(a[3]||0,t/2,n/2)),o.moveTo(r+c,l),o.lineTo(r+t-d,l),o.arc(r+t-d,l+d,d,Math.PI*3/2,0,!1),o.lineTo(r+t,l+n-m),o.arc(r+t-m,l+n-m,m,0,Math.PI/2,!1),o.lineTo(r+g,l+n),o.arc(r+g,l+n-g,g,Math.PI/2,Math.PI,!1),o.lineTo(r,l+c),o.arc(r+c,l+c,c,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(o,t,n,a,r){a=Math.abs(a);for(let l=0;l<n;l++){const c=t[(l-1+n)%n],d=t[l],g=t[(l+1)%n],m={x:d.x-c.x,y:d.y-c.y},S={x:g.x-d.x,y:g.y-d.y},C=Math.hypot(m.x,m.y),E=Math.hypot(S.x,S.y);let R;typeof r=="number"?R=r:R=l<r.length?r[l]:0,R=a*Math.cos(Math.PI/n)*Math.min(1,R/a*2);const M={x:m.x/C,y:m.y/C},z={x:S.x/E,y:S.y/E},P={x:d.x-M.x*R,y:d.y-M.y*R},j={x:d.x+z.x*R,y:d.y+z.y*R};l===0?o.moveTo(P.x,P.y):o.lineTo(P.x,P.y),o.arcTo(d.x,d.y,j.x,j.y,R)}}};function K3(o){const t=[],n=o.length,a=pt;for(let r=0;r<n;r++){let l=o[r];a._isNumber(l)?l=Math.round(l*1e3)/1e3:a._isString(l)||(l=l+""),t.push(l)}return t}const xy=",",Q3="(",X3=")",F3="([",J3="])",Z3=";",W3="()",$3="=",Ny=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],t5=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],e5=100;let Q0=null;function My(){if(Q0!==null)return Q0;try{const t=pt.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Q0=!1,!1)}catch{return Q0=!1,!1}}class Ng{constructor(t){this.canvas=t,Ft.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,n){let a=this.traceArr,r=a.length,l="",c,d,g,m;for(c=0;c<r;c++)d=a[c],g=d.method,g?(m=d.args,l+=g,t?l+=W3:pt._isArray(m[0])?l+=F3+m.join(xy)+J3:(n&&(m=m.map(S=>typeof S=="number"?Math.floor(S):S)),l+=Q3+m.join(xy)+X3)):(l+=d.property,t||(l+=$3+d.val)),l+=Z3;return l}clearTrace(){this.traceArr=[]}_trace(t){let n=this.traceArr,a;n.push(t),a=n.length,a>=e5&&n.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const n=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(t){const n=t.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(t){const n=t.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(t){const n=t.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(t){const n=t.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(t,n){this._context[t]=n}arc(t,n,a,r,l,c){this._context.arc(t,n,a,r,l,c)}arcTo(t,n,a,r,l){this._context.arcTo(t,n,a,r,l)}beginPath(){this._context.beginPath()}bezierCurveTo(t,n,a,r,l,c){this._context.bezierCurveTo(t,n,a,r,l,c)}clearRect(t,n,a,r){this._context.clearRect(t,n,a,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,n){const a=arguments;if(a.length===2)return this._context.createImageData(t,n);if(a.length===1)return this._context.createImageData(t)}createLinearGradient(t,n,a,r){return this._context.createLinearGradient(t,n,a,r)}createPattern(t,n){return this._context.createPattern(t,n)}createRadialGradient(t,n,a,r,l,c){return this._context.createRadialGradient(t,n,a,r,l,c)}drawImage(t,n,a,r,l,c,d,g,m){const S=arguments,C=this._context;S.length===3?C.drawImage(t,n,a):S.length===5?C.drawImage(t,n,a,r,l):S.length===9&&C.drawImage(t,n,a,r,l,c,d,g,m)}ellipse(t,n,a,r,l,c,d,g){this._context.ellipse(t,n,a,r,l,c,d,g)}isPointInPath(t,n,a,r){return a?this._context.isPointInPath(a,t,n,r):this._context.isPointInPath(t,n,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,n,a,r){this._context.fillRect(t,n,a,r)}strokeRect(t,n,a,r){this._context.strokeRect(t,n,a,r)}fillText(t,n,a,r){r?this._context.fillText(t,n,a,r):this._context.fillText(t,n,a)}measureText(t){return this._context.measureText(t)}getImageData(t,n,a,r){return this._context.getImageData(t,n,a,r)}lineTo(t,n){this._context.lineTo(t,n)}moveTo(t,n){this._context.moveTo(t,n)}rect(t,n,a,r){this._context.rect(t,n,a,r)}roundRect(t,n,a,r,l){this._context.roundRect(t,n,a,r,l)}putImageData(t,n,a){this._context.putImageData(t,n,a)}quadraticCurveTo(t,n,a,r){this._context.quadraticCurveTo(t,n,a,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,n){this._context.scale(t,n)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,n,a,r,l,c){this._context.setTransform(t,n,a,r,l,c)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,n,a,r){this._context.strokeText(t,n,a,r)}transform(t,n,a,r,l,c){this._context.transform(t,n,a,r,l,c)}translate(t,n){this._context.translate(t,n)}_enableTrace(){let t=this,n=Ny.length,a=this.setAttr,r,l;const c=function(d){let g=t[d],m;t[d]=function(){return l=K3(Array.prototype.slice.call(arguments,0)),m=g.apply(t,arguments),t._trace({method:d,args:l}),m}};for(r=0;r<n;r++)c(Ny[r]);t.setAttr=function(){a.apply(t,arguments);const d=arguments[0];let g=arguments[1];(d==="shadowOffsetX"||d==="shadowOffsetY"||d==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),t._trace({property:d,val:g})}}_applyGlobalCompositeOperation(t){const n=t.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}t5.forEach(function(o){Object.defineProperty(Ng.prototype,o,{get(){return this._context[o]},set(t){this._context[o]=t}})});class n5 extends Ng{constructor(t,{willReadFrequently:n=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(t){const n=t.fill();this.setAttr("fillStyle",n),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const n=t._getLinearGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fillRadialGradient(t){const n=t._getRadialGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fill(t){const n=t.fill(),a=t.getFillPriority();if(n&&a==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&a==="pattern"){this._fillPattern(t);return}const l=t.getFillLinearGradientColorStops();if(l&&a==="linear-gradient"){this._fillLinearGradient(t);return}const c=t.getFillRadialGradientColorStops();if(c&&a==="radial-gradient"){this._fillRadialGradient(t);return}n?this._fillColor(t):r?this._fillPattern(t):l?this._fillLinearGradient(t):c&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const n=t.getStrokeLinearGradientStartPoint(),a=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),l=this.createLinearGradient(n.x,n.y,a.x,a.y);if(r){for(let c=0;c<r.length;c+=2)l.addColorStop(r[c],r[c+1]);this.setAttr("strokeStyle",l)}}_stroke(t){const n=t.dash(),a=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!a){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t),n&&t.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),a||this.restore()}}_applyShadow(t){var n,a,r;const l=(n=t.getShadowRGBA())!==null&&n!==void 0?n:"black",c=(a=t.getShadowBlur())!==null&&a!==void 0?a:5,d=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},g=t.getAbsoluteScale(),m=this.canvas.getPixelRatio(),S=g.x*m,C=g.y*m;this.setAttr("shadowColor",l),this.setAttr("shadowBlur",c*Math.min(Math.abs(S),Math.abs(C))),this.setAttr("shadowOffsetX",d.x*S),this.setAttr("shadowOffsetY",d.y*C)}}class a5 extends Ng{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const n=t.getStrokeScaleEnabled();if(!n){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t);const a=t.hitStrokeWidth(),r=a==="auto"?t.strokeWidth():a;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),n||this.restore()}}}let X0;function i5(){if(X0)return X0;const o=pt.createCanvasElement(),t=o.getContext("2d");return X0=(function(){const n=Ft._global.devicePixelRatio||1,a=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/a})(),pt.releaseCanvas(o),X0}class ev{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const a=(t||{}).pixelRatio||Ft.pixelRatio||i5();this.pixelRatio=a,this._canvas=pt.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const n=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,n){this.setWidth(t||0),this.setHeight(n||0)}toDataURL(t,n){try{return this._canvas.toDataURL(t,n)}catch{try{return this._canvas.toDataURL()}catch(r){return pt.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class ml extends ev{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new n5(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function Dy(){const o=pt.createCanvasElement();o.width=1,o.height=1;const t=o.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data;return!(n[0]===255&&n[1]===0&&n[2]===255&&n[3]===255)}function jy(){var o,t;return typeof navigator>"u"?!1:(t=(o=navigator.brave)===null||o===void 0?void 0:o.isBrave())!==null&&t!==void 0?t:!1}let Uy=!1;function r5(){return jy()&&Dy()&&!Uy&&(Uy=!0,pt.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),jy()&&Dy()}class nv extends ev{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new a5(this),this.setSize(t.width,t.height),r5()}}const bn={get isDragging(){let o=!1;return bn._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(o=!0)}),o},justDragged:!1,get node(){let o;return bn._dragElements.forEach(t=>{o=t.node}),o},_dragElements:new Map,_drag(o){const t=[];bn._dragElements.forEach((n,a)=>{const{node:r}=n,l=r.getStage();l.setPointersPositions(o),n.pointerId===void 0&&(n.pointerId=pt._getFirstPointerId(o));const c=l._changedPointerPositions.find(d=>d.id===n.pointerId);if(c){if(n.dragStatus!=="dragging"){const d=r.dragDistance();if(Math.max(Math.abs(c.x-n.startPointerPos.x),Math.abs(c.y-n.startPointerPos.y))<d||(r.startDrag({evt:o}),!r.isDragging()))return}r._setDragPosition(o,n),t.push(r)}}),t.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:o},!0)})},_endDragBefore(o){const t=[];bn._dragElements.forEach(n=>{const{node:a}=n,r=a.getStage();if(o&&r.setPointersPositions(o),!r._changedPointerPositions.find(d=>d.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(bn.justDragged=!0,Ft._mouseListenClick=!1,Ft._touchListenClick=!1,Ft._pointerListenClick=!1,n.dragStatus="stopped");const c=n.node.getLayer()||n.node instanceof Ft.Stage&&n.node;c&&t.indexOf(c)===-1&&t.push(c)}),t.forEach(n=>{n.draw()})},_endDragAfter(o){bn._dragElements.forEach((t,n)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:o},!0),t.dragStatus!=="dragging"&&bn._dragElements.delete(n)})}};Ft.isBrowser&&(window.addEventListener("mouseup",bn._endDragBefore,!0),window.addEventListener("touchend",bn._endDragBefore,!0),window.addEventListener("touchcancel",bn._endDragBefore,!0),window.addEventListener("mousemove",bn._drag),window.addEventListener("touchmove",bn._drag),window.addEventListener("mouseup",bn._endDragAfter,!1),window.addEventListener("touchend",bn._endDragAfter,!1),window.addEventListener("touchcancel",bn._endDragAfter,!1));function bl(o){return pt._isString(o)?'"'+o+'"':Object.prototype.toString.call(o)==="[object Number]"||pt._isBoolean(o)?o:Object.prototype.toString.call(o)}function k2(o){return o>255?255:o<0?0:Math.round(o)}function Kt(){if(Ft.isUnminified)return function(o,t){return pt._isNumber(o)||pt.warn(bl(o)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),o}}function Mg(o){if(Ft.isUnminified)return function(t,n){let a=pt._isNumber(t),r=pt._isArray(t)&&t.length==o;return!a&&!r&&pt.warn(bl(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+o+")"),t}}function av(){if(Ft.isUnminified)return function(o,t){return pt._isNumber(o)||o==="auto"||pt.warn(bl(o)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),o}}function Tu(){if(Ft.isUnminified)return function(o,t){return pt._isString(o)||pt.warn(bl(o)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),o}}function q2(){if(Ft.isUnminified)return function(o,t){const n=pt._isString(o),a=Object.prototype.toString.call(o)==="[object CanvasGradient]"||o&&o.addColorStop;return n||a||pt.warn(bl(o)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),o}}function s5(){if(Ft.isUnminified)return function(o,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&o instanceof n||(pt._isArray(o)?o.forEach(function(a){pt._isNumber(a)||pt.warn('"'+t+'" attribute has non numeric element '+a+". Make sure that all elements are numbers.")}):pt.warn(bl(o)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),o}}function $r(){if(Ft.isUnminified)return function(o,t){return o===!0||o===!1||pt.warn(bl(o)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),o}}function o5(o){if(Ft.isUnminified)return function(t,n){return t==null||pt.isObject(t)||pt.warn(bl(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+o),t}}const Jd="get",Zd="set",ot={addGetterSetter(o,t,n,a,r){ot.addGetter(o,t,n),ot.addSetter(o,t,a,r),ot.addOverloadedGetterSetter(o,t)},addGetter(o,t,n){const a=Jd+pt._capitalize(t);o.prototype[a]=o.prototype[a]||function(){const r=this.attrs[t];return r===void 0?n:r}},addSetter(o,t,n,a){const r=Zd+pt._capitalize(t);o.prototype[r]||ot.overWriteSetter(o,t,n,a)},overWriteSetter(o,t,n,a){const r=Zd+pt._capitalize(t);o.prototype[r]=function(l){return n&&l!==void 0&&l!==null&&(l=n.call(this,l,t)),this._setAttr(t,l),a&&a.call(this),this}},addComponentsGetterSetter(o,t,n,a,r){const l=n.length,c=pt._capitalize,d=Jd+c(t),g=Zd+c(t);o.prototype[d]=function(){const S={};for(let C=0;C<l;C++){const E=n[C];S[E]=this.getAttr(t+c(E))}return S};const m=o5(n);o.prototype[g]=function(S){const C=this.attrs[t];a&&(S=a.call(this,S,t)),m&&m.call(this,S,t);for(const E in S)S.hasOwnProperty(E)&&this._setAttr(t+c(E),S[E]);return S||n.forEach(E=>{this._setAttr(t+c(E),void 0)}),this._fireChangeEvent(t,C,S),r&&r.call(this),this},ot.addOverloadedGetterSetter(o,t)},addOverloadedGetterSetter(o,t){const n=pt._capitalize(t),a=Zd+n,r=Jd+n;o.prototype[t]=function(){return arguments.length?(this[a](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(o,t,n,a){pt.error("Adding deprecated "+t);const r=Jd+pt._capitalize(t),l=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[r]=function(){pt.error(l);const c=this.attrs[t];return c===void 0?n:c},ot.addSetter(o,t,a,function(){pt.error(l)}),ot.addOverloadedGetterSetter(o,t)},backCompat(o,t){pt.each(t,function(n,a){const r=o.prototype[a],l=Jd+pt._capitalize(n),c=Zd+pt._capitalize(n);function d(){r.apply(this,arguments),pt.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+a+'" instead.')}o.prototype[n]=d,o.prototype[l]=d,o.prototype[c]=d})},afterSetFilter(){this._filterUpToDate=!1}};function l5(o){const t=/(\w+)\(([^)]+)\)/g;let n;for(;(n=t.exec(o))!==null;){const[,a,r]=n;switch(a){case"blur":{const l=parseFloat(r.replace("px",""));return function(c){this.blurRadius(l*.5);const d=Ft.Filters;d&&d.Blur&&d.Blur.call(this,c)}}case"brightness":{const l=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(c){this.brightness(l);const d=Ft.Filters;d&&d.Brightness&&d.Brightness.call(this,c)}}case"contrast":{const l=parseFloat(r);return function(c){const d=100*(Math.sqrt(l)-1);this.contrast(d);const g=Ft.Filters;g&&g.Contrast&&g.Contrast.call(this,c)}}case"grayscale":return function(l){const c=Ft.Filters;c&&c.Grayscale&&c.Grayscale.call(this,l)};case"sepia":return function(l){const c=Ft.Filters;c&&c.Sepia&&c.Sepia.call(this,l)};case"invert":return function(l){const c=Ft.Filters;c&&c.Invert&&c.Invert.call(this,l)};default:pt.warn(`CSS filter "${a}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const vg="absoluteOpacity",F0="allEventListeners",Eo="absoluteTransform",By="absoluteScale",gu="canvas",u5="Change",c5="children",f5="konva",Om="listening",d5="mouseenter",h5="mouseleave",g5="pointerenter",p5="pointerleave",m5="touchenter",v5="touchleave",zy="set",Ly="Shape",yg=" ",Py="stage",hl="transform",y5="Stage",xm="visible",S5=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(yg);let b5=1;class Vt{constructor(t){this._id=b5++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===hl||t===Eo)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,n){let a=this._cache.get(t);return(a===void 0||(t===hl||t===Eo)&&a.dirty===!0)&&(a=n.call(this),this._cache.set(t,a)),a}_calculate(t,n,a){if(!this._attachedDepsListeners.get(t)){const r=n.map(l=>l+"Change.konva").join(yg);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,a)}_getCanvasCache(){return this._cache.get(gu)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Eo&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(gu)){const{scene:t,filter:n,hit:a,buffer:r}=this._cache.get(gu);pt.releaseCanvas(t,n,a,r),this._cache.delete(gu)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const n=t||{};let a={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(a=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(n.width||a.width),l=Math.ceil(n.height||a.height),c=n.pixelRatio,d=n.x===void 0?Math.floor(a.x):n.x,g=n.y===void 0?Math.floor(a.y):n.y,m=n.offset||0,S=n.drawBorder||!1,C=n.hitCanvasPixelRatio||1;if(!r||!l){pt.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const E=Math.abs(Math.round(a.x)-d)>.5?1:0,R=Math.abs(Math.round(a.y)-g)>.5?1:0;r+=m*2+E,l+=m*2+R,d-=m,g-=m;const v=new ml({pixelRatio:c,width:r,height:l}),M=new ml({pixelRatio:c,width:0,height:0,willReadFrequently:!0}),z=new nv({pixelRatio:C,width:r,height:l}),P=v.getContext(),j=z.getContext(),x=new ml({width:v.width/v.pixelRatio+Math.abs(d),height:v.height/v.pixelRatio+Math.abs(g),pixelRatio:v.pixelRatio}),L=x.getContext();return z.isCache=!0,v.isCache=!0,this._cache.delete(gu),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,M.getContext()._context.imageSmoothingEnabled=!1),P.save(),j.save(),L.save(),P.translate(-d,-g),j.translate(-d,-g),L.translate(-d,-g),x.x=d,x.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(vg),this._clearSelfAndDescendantCache(By),this.drawScene(v,this,x),this.drawHit(z,this),this._isUnderCache=!1,P.restore(),j.restore(),S&&(P.save(),P.beginPath(),P.rect(0,0,r,l),P.closePath(),P.setAttr("strokeStyle","red"),P.setAttr("lineWidth",5),P.stroke(),P.restore()),this._cache.set(gu,{scene:v,filter:M,hit:z,buffer:x,x:d,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(gu)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,n){const a=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,l=1/0,c=-1/0,d=-1/0;const g=this.getAbsoluteTransform(n);return a.forEach(function(m){const S=g.point(m);r===void 0&&(r=c=S.x,l=d=S.y),r=Math.min(r,S.x),l=Math.min(l,S.y),c=Math.max(c,S.x),d=Math.max(d,S.y)}),{x:r,y:l,width:c-r,height:d-l}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();t.translate(n.x,n.y);const a=this._getCachedSceneCanvas(),r=a.pixelRatio;t.drawImage(a._canvas,0,0,a.width/r,a.height/r),t.restore()}_drawCachedHitCanvas(t){const n=this._getCanvasCache(),a=n.hit;t.save(),t.translate(n.x,n.y),t.drawImage(a._canvas,0,0,a.width/a.pixelRatio,a.height/a.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),n=this._getCanvasCache(),a=n.scene,r=n.filter,l=r.getContext(),c,d,g,m;if(!t||t.length===0)return a;if(this._filterUpToDate)return r;let S=!0;for(let E=0;E<t.length;E++)if(typeof t[E]=="string"&&My(),typeof t[E]!="string"||!My()){S=!1;break}const C=a.pixelRatio;if(r.setSize(a.width/a.pixelRatio,a.height/a.pixelRatio),S){const E=t.join(" ");return l.save(),l.setAttr("filter",E),l.drawImage(a._canvas,0,0,a.getWidth()/C,a.getHeight()/C),l.restore(),this._filterUpToDate=!0,r}try{for(c=t.length,l.clear(),l.drawImage(a._canvas,0,0,a.getWidth()/C,a.getHeight()/C),d=l.getImageData(0,0,r.getWidth(),r.getHeight()),g=0;g<c;g++)m=t[g],typeof m=="string"&&(m=l5(m)),m.call(this,d),l.putImageData(d,0,0)}catch(E){pt.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,n){if(this._cache&&this._cache.delete(F0),arguments.length===3)return this._delegate.apply(this,arguments);const a=t.split(yg);for(let r=0;r<a.length;r++){const c=a[r].split("."),d=c[0],g=c[1]||"";this.eventListeners[d]||(this.eventListeners[d]=[]),this.eventListeners[d].push({name:g,handler:n})}return this}off(t,n){let a=(t||"").split(yg),r=a.length,l,c,d,g,m,S;if(this._cache&&this._cache.delete(F0),!t)for(c in this.eventListeners)this._off(c);for(l=0;l<r;l++)if(d=a[l],g=d.split("."),m=g[0],S=g[1],m)this.eventListeners[m]&&this._off(m,S,n);else for(c in this.eventListeners)this._off(c,S,n);return this}dispatchEvent(t){const n={target:this,type:t.type,evt:t};return this.fire(t.type,n),this}addEventListener(t,n){return this.on(t,function(a){n.call(this,a.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,n,a){const r=this;this.on(t,function(l){const c=l.target.findAncestors(n,!0,r);for(let d=0;d<c.length;d++)l=pt.cloneObject(l),l.currentTarget=c[d],a.call(c[d],l)})}remove(){return this.isDragging()&&this.stopDrag(),bn._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Eo),this._clearSelfAndDescendantCache(vg),this._clearSelfAndDescendantCache(By),this._clearSelfAndDescendantCache(Py),this._clearSelfAndDescendantCache(xm),this._clearSelfAndDescendantCache(Om)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const n="get"+pt._capitalize(t);return pt._isFunction(this[n])?this[n]():this.attrs[t]}getAncestors(){let t=this.getParent(),n=[];for(;t;)n.push(t),t=t.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let n,a;if(!t)return this;for(n in t)n!==c5&&(a=zy+pt._capitalize(n),pt._isFunction(this[a])?this[a](t[n]):this._setAttr(n,t[n]))}),this}isListening(){return this._getCache(Om,this._isListening)}_isListening(t){if(!this.listening())return!1;const a=this.getParent();return a&&a!==t&&this!==t?a._isListening(t):!0}isVisible(){return this._getCache(xm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const a=this.getParent();return a&&a!==t&&this!==t?a._isVisible(t):!0}shouldDrawHit(t,n=!1){if(t)return this._isVisible(t)&&this._isListening(t);const a=this.getLayer();let r=!1;bn._dragElements.forEach(c=>{c.dragStatus==="dragging"&&(c.node.nodeType==="Stage"||c.node.getLayer()===a)&&(r=!0)});const l=!n&&!Ft.hitOnDragEnabled&&(r||Ft.isTransforming());return this.isListening()&&this.isVisible()&&!l}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),n=this,a=0,r,l,c,d;function g(S){for(r=[],l=S.length,c=0;c<l;c++)d=S[c],a++,d.nodeType!==Ly&&(r=r.concat(d.getChildren().slice())),d._id===n._id&&(c=l);r.length>0&&r[0].getDepth()<=t&&g(r)}const m=this.getStage();return n.nodeType!==y5&&m&&g(m.getChildren()),a}getDepth(){let t=0,n=this.parent;for(;n;)t++,n=n.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(hl),this._clearSelfAndDescendantCache(Eo)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const n=t.getPointerPosition();if(!n)return null;const a=this.getAbsoluteTransform().copy();return a.invert(),a.point(n)}getAbsolutePosition(t){let n=!1,a=this.parent;for(;a;){if(a.isCached()){n=!0;break}a=a.parent}n&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),l=new Ji,c=this.offset();return l.m=r.slice(),l.translate(c.x,c.y),l.getTranslation()}setAbsolutePosition(t){const{x:n,y:a,...r}=this._clearTransform();this.attrs.x=n,this.attrs.y=a,this._clearCache(hl);const l=this._getAbsoluteTransform().copy();return l.invert(),l.translate(t.x,t.y),t={x:this.attrs.x+l.getTranslation().x,y:this.attrs.y+l.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(hl),this._clearSelfAndDescendantCache(Eo),this}_setTransform(t){let n;for(n in t)this.attrs[n]=t[n]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let n=t.x,a=t.y,r=this.x(),l=this.y();return n!==void 0&&(r+=n),a!==void 0&&(l+=a),this.setPosition({x:r,y:l}),this}_eachAncestorReverse(t,n){let a=[],r=this.getParent(),l,c;if(!(n&&n._id===this._id)){for(a.unshift(this);r&&(!n||r._id!==n._id);)a.unshift(r),r=r.parent;for(l=a.length,c=0;c<l;c++)t(a[c])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return pt.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return pt.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return pt.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return pt.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return pt.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&pt.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(vg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(t*=n.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),n,a,r,l,c;const d={attrs:{},className:this.getClassName()};for(n in t)a=t[n],c=pt.isObject(a)&&!pt._isPlainObject(a)&&!pt._isArray(a),!c&&(r=typeof this[n]=="function"&&this[n],delete t[n],l=r?r.call(this):null,t[n]=a,l!==a&&(d.attrs[n]=a));return pt._prepareToStringify(d)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,n,a){const r=[];n&&this._isMatch(t)&&r.push(this);let l=this.parent;for(;l;){if(l===a)return r;l._isMatch(t)&&r.push(l),l=l.parent}return r}isAncestorOf(t){return!1}findAncestor(t,n,a){return this.findAncestors(t,n,a)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let n=t.replace(/ /g,"").split(","),a=n.length,r,l;for(r=0;r<a;r++)if(l=n[r],pt.isValidSelector(l)||(pt.warn('Selector "'+l+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),pt.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),pt.warn("Konva is awesome, right?")),l.charAt(0)==="#"){if(this.id()===l.slice(1))return!0}else if(l.charAt(0)==="."){if(this.hasName(l.slice(1)))return!0}else if(this.className===l||this.nodeType===l)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(Py,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,n={},a){return n.target=n.target||this,a?this._fireAndBubble(t,n):this._fire(t,n),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Eo,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let n;if(t)return n=new Ji,this._eachAncestorReverse(function(a){const r=a.transformsEnabled();r==="all"?n.multiply(a.getTransform()):r==="position"&&n.translate(a.x()-a.offsetX(),a.y()-a.offsetY())},t),n;{n=this._cache.get(Eo)||new Ji,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const a=this.transformsEnabled();if(a==="all")n.multiply(this.getTransform());else if(a==="position"){const r=this.attrs.x||0,l=this.attrs.y||0,c=this.attrs.offsetX||0,d=this.attrs.offsetY||0;n.translate(r-c,l-d)}return n.dirty=!1,n}}getAbsoluteScale(t){let n=this;for(;n;)n._isUnderCache&&(t=n),n=n.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(hl,this._getTransform)}_getTransform(){var t,n;const a=this._cache.get(hl)||new Ji;a.reset();const r=this.x(),l=this.y(),c=Ft.getAngle(this.rotation()),d=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,S=this.attrs.skewY||0,C=this.attrs.offsetX||0,E=this.attrs.offsetY||0;return(r!==0||l!==0)&&a.translate(r,l),c!==0&&a.rotate(c),(m!==0||S!==0)&&a.skew(m,S),(d!==1||g!==1)&&a.scale(d,g),(C!==0||E!==0)&&a.translate(-1*C,-1*E),a.dirty=!1,a}clone(t){let n=pt.cloneObject(this.attrs),a,r,l,c,d;for(a in t)n[a]=t[a];const g=new this.constructor(n);for(a in this.eventListeners)for(r=this.eventListeners[a],l=r.length,c=0;c<l;c++)d=r[c],d.name.indexOf(f5)<0&&(g.eventListeners[a]||(g.eventListeners[a]=[]),g.eventListeners[a].push(d));return g}_toKonvaCanvas(t){t=t||{};const n=this.getClientRect(),a=this.getStage(),r=t.x!==void 0?t.x:Math.floor(n.x),l=t.y!==void 0?t.y:Math.floor(n.y),c=t.pixelRatio||1,d=new ml({width:t.width||Math.ceil(n.width)||(a?a.width():0),height:t.height||Math.ceil(n.height)||(a?a.height():0),pixelRatio:c}),g=d.getContext(),m=new ml({width:d.width/d.pixelRatio+Math.abs(r),height:d.height/d.pixelRatio+Math.abs(l),pixelRatio:d.pixelRatio});return t.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(r||l)&&g.translate(-1*r,-1*l),this.drawScene(d,void 0,m),g.restore(),d}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const n=t.mimeType||null,a=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(n,a);return t.callback&&t.callback(r),r}toImage(t){return new Promise((n,a)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,pt._urlToImage(this.toDataURL(t),function(l){n(l),r==null||r(l)})}catch(r){a(r)}})}toBlob(t){return new Promise((n,a)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(l=>{n(l),r==null||r(l)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(r){a(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Ft.dragDistance}_off(t,n,a){let r=this.eventListeners[t],l,c,d;for(l=0;l<r.length;l++)if(c=r[l].name,d=r[l].handler,(c!=="konva"||n==="konva")&&(!n||c===n)&&(!a||a===d)){if(r.splice(l,1),r.length===0){delete this.eventListeners[t];break}l--}}_fireChangeEvent(t,n,a){this._fire(t+u5,{oldVal:n,newVal:a})}addName(t){if(!this.hasName(t)){const n=this.name(),a=n?n+" "+t:t;this.name(a)}return this}hasName(t){if(!t)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const n=(this.name()||"").split(/\s/g),a=n.indexOf(t);return a!==-1&&(n.splice(a,1),this.name(n.join(" "))),this}setAttr(t,n){const a=this[zy+pt._capitalize(t)];return pt._isFunction(a)?a.call(this,n):this._setAttr(t,n),this}_requestDraw(){if(Ft.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,n){const a=this.attrs[t];a===n&&!pt.isObject(n)||(n==null?delete this.attrs[t]:this.attrs[t]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(t,a,n),this._requestDraw())}_setComponentAttr(t,n,a){let r;a!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][n]=a,this._fireChangeEvent(t,r,a))}_fireAndBubble(t,n,a){n&&this.nodeType===Ly&&(n.target=this);const r=[d5,h5,g5,p5,m5,v5];if(!(r.indexOf(t)!==-1&&(a&&(this===a||this.isAncestorOf&&this.isAncestorOf(a))||this.nodeType==="Stage"&&!a))){this._fire(t,n);const c=r.indexOf(t)!==-1&&a&&a.isAncestorOf&&a.isAncestorOf(this)&&!a.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!c&&(a&&a.parent?this._fireAndBubble.call(this.parent,t,n,a):this._fireAndBubble.call(this.parent,t,n))}}_getProtoListeners(t){var n,a,r;const l=(n=this._cache.get(F0))!==null&&n!==void 0?n:{};let c=l==null?void 0:l[t];if(c===void 0){c=[];let d=Object.getPrototypeOf(this);for(;d;){const g=(r=(a=d.eventListeners)===null||a===void 0?void 0:a[t])!==null&&r!==void 0?r:[];c.push(...g),d=Object.getPrototypeOf(d)}l[t]=c,this._cache.set(F0,l)}return c}_fire(t,n){n=n||{},n.currentTarget=this,n.type=t;const a=this._getProtoListeners(t);if(a)for(let l=0;l<a.length;l++)a[l].handler.call(this,n);const r=this.eventListeners[t];if(r)for(let l=0;l<r.length;l++)r[l].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const n=t?t.pointerId:void 0,a=this.getStage(),r=this.getAbsolutePosition();if(!a)return;const l=a._getPointerById(n)||a._changedPointerPositions[0]||r;bn._dragElements.set(this._id,{node:this,startPointerPos:l,offset:{x:l.x-r.x,y:l.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(t,n=!0){bn._dragElements.has(this._id)||this._createDragElement(t);const a=bn._dragElements.get(this._id);a.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},n)}_setDragPosition(t,n){const a=this.getStage()._getPointerById(n.pointerId);if(!a)return;let r={x:a.x-n.offset.x,y:a.y-n.offset.y};const l=this.dragBoundFunc();if(l!==void 0){const c=l.call(this,r,t);c?r=c:pt.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const n=bn._dragElements.get(this._id);n&&(n.dragStatus="stopped"),bn._endDragBefore(t),bn._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=bn._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Ft.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;bn._dragElements.forEach(l=>{this.isAncestorOf(l.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=bn._dragElements.get(this._id),a=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";a?this.stopDrag():r&&bn._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const n=this.getStage();if(!n)return!1;const a={x:-t.x,y:-t.y,width:n.width()+2*t.x,height:n.height()+2*t.y};return pt.haveIntersection(a,this.getClientRect())}static create(t,n){return pt._isString(t)&&(t=JSON.parse(t)),this._createNode(t,n)}static _createNode(t,n){let a=Vt.prototype.getClassName.call(t),r=t.children,l,c,d;n&&(t.attrs.container=n),Ft[a]||(pt.warn('Can not find a node with class name "'+a+'". Fallback to "Shape".'),a="Shape");const g=Ft[a];if(l=new g(t.attrs),r)for(c=r.length,d=0;d<c;d++)l.add(Vt._createNode(r[d]));return l}}Vt.prototype.nodeType="Node";Vt.prototype._attrsAffectingSize=[];Vt.prototype.eventListeners={};Vt.prototype.on.call(Vt.prototype,S5,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(hl),this._clearSelfAndDescendantCache(Eo)});Vt.prototype.on.call(Vt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(xm)});Vt.prototype.on.call(Vt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Om)});Vt.prototype.on.call(Vt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(vg)});const Hn=ot.addGetterSetter;Hn(Vt,"zIndex");Hn(Vt,"absolutePosition");Hn(Vt,"position");Hn(Vt,"x",0,Kt());Hn(Vt,"y",0,Kt());Hn(Vt,"globalCompositeOperation","source-over",Tu());Hn(Vt,"opacity",1,Kt());Hn(Vt,"name","",Tu());Hn(Vt,"id","",Tu());Hn(Vt,"rotation",0,Kt());ot.addComponentsGetterSetter(Vt,"scale",["x","y"]);Hn(Vt,"scaleX",1,Kt());Hn(Vt,"scaleY",1,Kt());ot.addComponentsGetterSetter(Vt,"skew",["x","y"]);Hn(Vt,"skewX",0,Kt());Hn(Vt,"skewY",0,Kt());ot.addComponentsGetterSetter(Vt,"offset",["x","y"]);Hn(Vt,"offsetX",0,Kt());Hn(Vt,"offsetY",0,Kt());Hn(Vt,"dragDistance",void 0,Kt());Hn(Vt,"width",0,Kt());Hn(Vt,"height",0,Kt());Hn(Vt,"listening",!0,$r());Hn(Vt,"preventDefault",!0,$r());Hn(Vt,"filters",void 0,function(o){return this._filterUpToDate=!1,o});Hn(Vt,"visible",!0,$r());Hn(Vt,"transformsEnabled","all",Tu());Hn(Vt,"size");Hn(Vt,"dragBoundFunc");Hn(Vt,"draggable",!1,$r());ot.backCompat(Vt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class $i extends Vt{constructor(){super(...arguments),this.children=[]}getChildren(t){const n=this.children||[];return t?n.filter(t):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let a=0;a<t.length;a++)this.add(t[a]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const n=this._generalFind(t,!0);return n.length>0?n[0]:void 0}_generalFind(t,n){const a=[];return this._descendants(r=>{const l=r._isMatch(t);return l&&a.push(r),!!(l&&n)}),a}_descendants(t){let n=!1;const a=this.getChildren();for(const r of a){if(n=t(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(t),n))return!0}return!1}toObject(){const t=Vt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(n=>{t.children.push(n.toObject())}),t}isAncestorOf(t){let n=t.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(t){const n=Vt.prototype.clone.call(this,t);return this.getChildren().forEach(function(a){n.add(a.clone())}),n}getAllIntersections(t){const n=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(t)&&n.push(a)}),n}_clearSelfAndDescendantCache(t){var n;super._clearSelfAndDescendantCache(t),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(a){a._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(n,a){n.index=a}),this._requestDraw()}drawScene(t,n,a){const r=this.getLayer(),l=t||r&&r.getCanvas(),c=l&&l.getContext(),d=this._getCanvasCache(),g=d&&d.scene,m=l&&l.isCache;if(!this.isVisible()&&!m)return this;if(g){c.save();const S=this.getAbsoluteTransform(n).getMatrix();c.transform(S[0],S[1],S[2],S[3],S[4],S[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",l,n,a);return this}drawHit(t,n){if(!this.shouldDrawHit(n))return this;const a=this.getLayer(),r=t||a&&a.hitCanvas,l=r&&r.getContext(),c=this._getCanvasCache();if(c&&c.hit){l.save();const g=this.getAbsoluteTransform(n).getMatrix();l.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(l),l.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(t,n,a,r){var l;const c=n&&n.getContext(),d=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),S=typeof d=="number"&&typeof g=="number"||m,C=a===this;if(S){c.save();const R=this.getAbsoluteTransform(a);let v=R.getMatrix();c.transform(v[0],v[1],v[2],v[3],v[4],v[5]),c.beginPath();let M;if(m)M=m.call(this,c,this);else{const z=this.clipX(),P=this.clipY();c.rect(z||0,P||0,d,g)}c.clip.apply(c,M),v=R.copy().invert().getMatrix(),c.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const E=!C&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(c.save(),c._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(R){R[t](n,a,r)}),E&&c.restore(),S&&c.restore()}getClientRect(t={}){var n;const a=t.skipTransform,r=t.relativeTo;let l,c,d,g,m={x:1/0,y:1/0,width:0,height:0};const S=this;(n=this.children)===null||n===void 0||n.forEach(function(R){if(!R.visible())return;const v=R.getClientRect({relativeTo:S,skipShadow:t.skipShadow,skipStroke:t.skipStroke});v.width===0&&v.height===0||(l===void 0?(l=v.x,c=v.y,d=v.x+v.width,g=v.y+v.height):(l=Math.min(l,v.x),c=Math.min(c,v.y),d=Math.max(d,v.x+v.width),g=Math.max(g,v.y+v.height)))});const C=this.find("Shape");let E=!1;for(let R=0;R<C.length;R++)if(C[R]._isVisible(this)){E=!0;break}return E&&l!==void 0?m={x:l,y:c,width:d-l,height:g-c}:m={x:0,y:0,width:0,height:0},a?m:this._transformedRect(m,r)}}ot.addComponentsGetterSetter($i,"clip",["x","y","width","height"]);ot.addGetterSetter($i,"clipX",void 0,Kt());ot.addGetterSetter($i,"clipY",void 0,Kt());ot.addGetterSetter($i,"clipWidth",void 0,Kt());ot.addGetterSetter($i,"clipHeight",void 0,Kt());ot.addGetterSetter($i,"clipFunc");const ph=new Map,V2=Ft._global.PointerEvent!==void 0;function xp(o){return ph.get(o)}function iv(o){return{evt:o,pointerId:o.pointerId}}function Y2(o,t){return ph.get(o)===t}function K2(o,t){sh(o),t.getStage()&&(ph.set(o,t),V2&&t._fire("gotpointercapture",iv(new PointerEvent("gotpointercapture"))))}function sh(o,t){const n=ph.get(o);if(!n)return;const a=n.getStage();a&&a.content,ph.delete(o),V2&&n._fire("lostpointercapture",iv(new PointerEvent("lostpointercapture")))}const _5="Stage",E5="string",Iy="px",C5="mouseout",Q2="mouseleave",X2="mouseover",F2="mouseenter",J2="mousemove",Z2="mousedown",W2="mouseup",th="pointermove",eh="pointerdown",ff="pointerup",nh="pointercancel",T5="lostpointercapture",J0="pointerout",ah="pointerleave",Z0="pointerover",W0="pointerenter",Nm="contextmenu",$2="touchstart",tS="touchend",eS="touchmove",nS="touchcancel",Mm="wheel",A5=5,w5=[[F2,"_pointerenter"],[Z2,"_pointerdown"],[J2,"_pointermove"],[W2,"_pointerup"],[Q2,"_pointerleave"],[$2,"_pointerdown"],[eS,"_pointermove"],[tS,"_pointerup"],[nS,"_pointercancel"],[X2,"_pointerover"],[Mm,"_wheel"],[Nm,"_contextmenu"],[eh,"_pointerdown"],[th,"_pointermove"],[ff,"_pointerup"],[nh,"_pointercancel"],[ah,"_pointerleave"],[T5,"_lostpointercapture"]],Np={mouse:{[J0]:C5,[ah]:Q2,[Z0]:X2,[W0]:F2,[th]:J2,[eh]:Z2,[ff]:W2,[nh]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[J0]:"touchout",[ah]:"touchleave",[Z0]:"touchover",[W0]:"touchenter",[th]:eS,[eh]:$2,[ff]:tS,[nh]:nS,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[J0]:J0,[ah]:ah,[Z0]:Z0,[W0]:W0,[th]:th,[eh]:eh,[ff]:ff,[nh]:nh,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ih=o=>o.indexOf("pointer")>=0?"pointer":o.indexOf("touch")>=0?"touch":"mouse",Zc=o=>{const t=ih(o);if(t==="pointer")return Ft.pointerEventsEnabled&&Np.pointer;if(t==="touch")return Np.touch;if(t==="mouse")return Np.mouse};function Gy(o={}){return(o.clipFunc||o.clipWidth||o.clipHeight)&&pt.warn("Stage does not support clipping. Please use clip for Layers or Groups."),o}const R5="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",oh=[];let Dg=class extends $i{constructor(t){super(Gy(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),oh.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Gy(this.attrs)}),this._checkVisibility()}_validateAdd(t){const n=t.getType()==="Layer",a=t.getType()==="FastLayer";n||a||pt.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===E5){let n;if(t.charAt(0)==="."){const a=t.slice(1);t=document.getElementsByClassName(a)[0]}else t.charAt(0)!=="#"?n=t:n=t.slice(1),t=document.getElementById(n);if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,n=t.length;for(let a=0;a<n;a++)t[a].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),$i.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&pt._isInDocument(t)&&this.container().removeChild(t);const n=oh.indexOf(this);return n>-1&&oh.splice(n,1),pt.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(pt.warn(R5),null)}_getPointerById(t){return this._pointerPositions.find(n=>n.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const n=new ml({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),a=n.getContext()._context,r=this.children;return(t.x||t.y)&&a.translate(-1*t.x,-1*t.y),r.forEach(function(l){if(!l.isVisible())return;const c=l._toKonvaCanvas(t);a.drawImage(c._canvas,t.x,t.y,c.getWidth()/c.getPixelRatio(),c.getHeight()/c.getPixelRatio())}),n}getIntersection(t){if(!t)return null;const n=this.children,a=n.length,r=a-1;for(let l=r;l>=0;l--){const c=n[l].getIntersection(t);if(c)return c}return null}_resizeDOM(){const t=this.width(),n=this.height();this.content&&(this.content.style.width=t+Iy,this.content.style.height=n+Iy),this.bufferCanvas.setSize(t,n),this.bufferHitCanvas.setSize(t,n),this.children.forEach(a=>{a.setSize({width:t,height:n}),a.draw()})}add(t,...n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const a=this.children.length;return a>A5&&pt.warn("The stage has "+a+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Ft.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Y2(t,this)}setPointerCapture(t){K2(t,this)}releaseCapture(t){sh(t)}getLayers(){return this.children}_bindContentEvents(){Ft.isBrowser&&w5.forEach(([t,n])=>{this.content.addEventListener(t,a=>{this[n](a)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const n=Zc(t.type);n&&this._fire(n.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const n=Zc(t.type);n&&this._fire(n.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let n=this[t+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(t){const n=Zc(t.type),a=ih(t.type);if(!n)return;this.setPointersPositions(t);const r=this._getTargetShape(a),l=!(Ft.isDragging()||Ft.isTransforming())||Ft.hitOnDragEnabled;r&&l?(r._fireAndBubble(n.pointerout,{evt:t}),r._fireAndBubble(n.pointerleave,{evt:t}),this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this[a+"targetShape"]=null):l&&(this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const n=Zc(t.type),a=ih(t.type);if(!n)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(l=>{const c=this.getIntersection(l);if(bn.justDragged=!1,Ft["_"+a+"ListenClick"]=!0,!c||!c.isListening()){this[a+"ClickStartShape"]=void 0;return}Ft.capturePointerEventsEnabled&&c.setPointerCapture(l.id),this[a+"ClickStartShape"]=c,c._fireAndBubble(n.pointerdown,{evt:t,pointerId:l.id}),r=!0;const d=t.type.indexOf("touch")>=0;c.preventDefault()&&t.cancelable&&d&&t.preventDefault()}),r||this._fire(n.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const n=Zc(t.type),a=ih(t.type);if(!n)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(Ft.isDragging()&&bn.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(Ft.isDragging()||Ft.isTransforming())||Ft.hitOnDragEnabled))return;const c={};let d=!1;const g=this._getTargetShape(a);this._changedPointerPositions.forEach(m=>{const S=xp(m.id)||this.getIntersection(m),C=m.id,E={evt:t,pointerId:C},R=g!==S;if(R&&g&&(g._fireAndBubble(n.pointerout,{...E},S),g._fireAndBubble(n.pointerleave,{...E},S)),S){if(c[S._id])return;c[S._id]=!0}S&&S.isListening()?(d=!0,R&&(S._fireAndBubble(n.pointerover,{...E},g),S._fireAndBubble(n.pointerenter,{...E},g),this[a+"targetShape"]=S),S._fireAndBubble(n.pointermove,{...E})):g&&(this._fire(n.pointerover,{evt:t,target:this,currentTarget:this,pointerId:C}),this[a+"targetShape"]=null)}),d||this._fire(n.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const n=Zc(t.type),a=ih(t.type);if(!n)return;this.setPointersPositions(t);const r=this[a+"ClickStartShape"],l=this[a+"ClickEndShape"],c={};let d=!1;this._changedPointerPositions.forEach(g=>{const m=xp(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),c[m._id])return;c[m._id]=!0}const S=g.id,C={evt:t,pointerId:S};let E=!1;Ft["_"+a+"InDblClickWindow"]?(E=!0,clearTimeout(this[a+"DblTimeout"])):bn.justDragged||(Ft["_"+a+"InDblClickWindow"]=!0,clearTimeout(this[a+"DblTimeout"])),this[a+"DblTimeout"]=setTimeout(function(){Ft["_"+a+"InDblClickWindow"]=!1},Ft.dblClickWindow),m&&m.isListening()?(d=!0,this[a+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...C}),Ft["_"+a+"ListenClick"]&&r&&r===m&&(m._fireAndBubble(n.pointerclick,{...C}),E&&l&&l===m&&m._fireAndBubble(n.pointerdblclick,{...C}))):(this[a+"ClickEndShape"]=null,d||(this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),d=!0),Ft["_"+a+"ListenClick"]&&this._fire(n.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:S}),E&&this._fire(n.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:S}))}),d||this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Ft["_"+a+"ListenClick"]=!1,t.cancelable&&a!=="touch"&&a!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Nm,{evt:t}):this._fire(Nm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Mm,{evt:t}):this._fire(Mm,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const n=xp(t.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(ff,iv(t)),sh(t.pointerId)}_lostpointercapture(t){sh(t.pointerId)}setPointersPositions(t){const n=this._getContentPosition();let a=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,l=>{this._pointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,l=>{this._changedPointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})})):(a=(t.clientX-n.left)/n.scaleX,r=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:a,y:r},this._pointerPositions=[{x:a,y:r,id:pt._getFirstPointerId(t)}],this._changedPointerPositions=[{x:a,y:r,id:pt._getFirstPointerId(t)}])}_setPointerPosition(t){pt.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new ml({width:this.width(),height:this.height()}),this.bufferHitCanvas=new nv({pixelRatio:1,width:this.width(),height:this.height()}),!Ft.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return pt.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Dg.prototype.nodeType=_5;ua(Dg);ot.addGetterSetter(Dg,"container");Ft.isBrowser&&document.addEventListener("visibilitychange",()=>{oh.forEach(o=>{o.batchDraw()})});const aS="hasShadow",iS="shadowRGBA",rS="patternImage",sS="linearGradient",oS="radialGradient";let $0;function Mp(){return $0||($0=pt.createCanvasElement().getContext("2d"),$0)}const lh={};function O5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function x5(o){o.stroke()}function N5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function M5(o){o.stroke()}function D5(){this._clearCache(aS)}function j5(){this._clearCache(iS)}function U5(){this._clearCache(rS)}function B5(){this._clearCache(sS)}function z5(){this._clearCache(oS)}class Lt extends Vt{constructor(t){super(t);let n;for(;n=pt.getRandomColor(),!(n&&!(n in lh)););this.colorKey=n,lh[n]=this}getContext(){return pt.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return pt.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(aS,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(rS,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Mp().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const a=new Ji;a.translate(this.fillPatternX(),this.fillPatternY()),a.rotate(Ft.getAngle(this.fillPatternRotation())),a.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),a.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=a.getMatrix(),l=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(l)}return n}}_getLinearGradient(){return this._getCache(sS,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const n=Mp(),a=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),l=n.createLinearGradient(a.x,a.y,r.x,r.y);for(let c=0;c<t.length;c+=2)l.addColorStop(t[c],t[c+1]);return l}}_getRadialGradient(){return this._getCache(oS,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const n=Mp(),a=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),l=n.createRadialGradient(a.x,a.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let c=0;c<t.length;c+=2)l.addColorStop(t[c],t[c+1]);return l}}getShadowRGBA(){return this._getCache(iS,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=pt.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const n=this.getStage();if(!n)return!1;const a=n.bufferHitCanvas;return a.getContext().clear(),this.drawHit(a,void 0,!0),a.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return Vt.prototype.destroy.call(this),delete lh[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=t||this.hasFill(),l=this.hasStroke(),c=this.getAbsoluteOpacity()!==1;if(r&&l&&c)return!0;const d=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(r&&l&&d&&g)}setStrokeHitEnabled(t){pt.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let n=!1,a=this.getParent();for(;a;){if(a.isCached()){n=!0;break}a=a.getParent()}const r=t.skipTransform,l=t.relativeTo||n&&this.getStage()||void 0,c=this.getSelfRect(),g=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=c.width+g,S=c.height+g,C=!t.skipShadow&&this.hasShadow(),E=C?this.shadowOffsetX():0,R=C?this.shadowOffsetY():0,v=m+Math.abs(E),M=S+Math.abs(R),z=C&&this.shadowBlur()||0,P=v+z*2,j=M+z*2,x={width:P,height:j,x:-(g/2+z)+Math.min(E,0)+c.x,y:-(g/2+z)+Math.min(R,0)+c.y};return r?x:this._transformedRect(x,l)}drawScene(t,n,a){const r=this.getLayer(),l=t||r.getCanvas(),c=l.getContext(),d=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let S;const C=n===this;if(!this.isVisible()&&!C)return this;if(d){c.save();const E=this.getAbsoluteTransform(n).getMatrix();return c.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedSceneCanvas(c),c.restore(),this}if(!g)return this;if(c.save(),this._useBufferCanvas()){S=this.getStage();const E=a||S.bufferCanvas,R=E.getContext();R.clear(),R.save(),R._applyLineJoin(this),R._applyMiterLimit(this);const v=this.getAbsoluteTransform(n).getMatrix();R.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.call(this,R,this),R.restore();const M=E.pixelRatio;m&&c._applyShadow(this),c._applyOpacity(this),c._applyGlobalCompositeOperation(this),c.drawImage(E._canvas,E.x||0,E.y||0,E.width/M,E.height/M)}else{if(c._applyLineJoin(this),c._applyMiterLimit(this),!C){const E=this.getAbsoluteTransform(n).getMatrix();c.transform(E[0],E[1],E[2],E[3],E[4],E[5]),c._applyOpacity(this),c._applyGlobalCompositeOperation(this)}m&&c._applyShadow(this),g.call(this,c,this)}return c.restore(),this}drawHit(t,n,a=!1){if(!this.shouldDrawHit(n,a))return this;const r=this.getLayer(),l=t||r.hitCanvas,c=l&&l.getContext(),d=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||pt.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){c.save();const C=this.getAbsoluteTransform(n).getMatrix();return c.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._drawCachedHitCanvas(c),c.restore(),this}if(!d)return this;if(c.save(),c._applyLineJoin(this),c._applyMiterLimit(this),!(this===n)){const C=this.getAbsoluteTransform(n).getMatrix();c.transform(C[0],C[1],C[2],C[3],C[4],C[5])}return d.call(this,c,this),c.restore(),this}drawHitFromCache(t=0){const n=this._getCanvasCache(),a=this._getCachedSceneCanvas(),r=n.hit,l=r.getContext(),c=r.getWidth(),d=r.getHeight();l.clear(),l.drawImage(a._canvas,0,0,c,d);try{const g=l.getImageData(0,0,c,d),m=g.data,S=m.length,C=pt._hexToRgb(this.colorKey);for(let E=0;E<S;E+=4)m[E+3]>t?(m[E]=C.r,m[E+1]=C.g,m[E+2]=C.b,m[E+3]=255):m[E+3]=0;l.putImageData(g,0,0)}catch(g){pt.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return Y2(t,this)}setPointerCapture(t){K2(t,this)}releaseCapture(t){sh(t)}}Lt.prototype._fillFunc=O5;Lt.prototype._strokeFunc=x5;Lt.prototype._fillFuncHit=N5;Lt.prototype._strokeFuncHit=M5;Lt.prototype._centroid=!1;Lt.prototype.nodeType="Shape";ua(Lt);Lt.prototype.eventListeners={};Lt.prototype.on.call(Lt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",D5);Lt.prototype.on.call(Lt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",j5);Lt.prototype.on.call(Lt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",U5);Lt.prototype.on.call(Lt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",B5);Lt.prototype.on.call(Lt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",z5);ot.addGetterSetter(Lt,"stroke",void 0,q2());ot.addGetterSetter(Lt,"strokeWidth",2,Kt());ot.addGetterSetter(Lt,"fillAfterStrokeEnabled",!1);ot.addGetterSetter(Lt,"hitStrokeWidth","auto",av());ot.addGetterSetter(Lt,"strokeHitEnabled",!0,$r());ot.addGetterSetter(Lt,"perfectDrawEnabled",!0,$r());ot.addGetterSetter(Lt,"shadowForStrokeEnabled",!0,$r());ot.addGetterSetter(Lt,"lineJoin");ot.addGetterSetter(Lt,"lineCap");ot.addGetterSetter(Lt,"miterLimit");ot.addGetterSetter(Lt,"sceneFunc");ot.addGetterSetter(Lt,"hitFunc");ot.addGetterSetter(Lt,"dash");ot.addGetterSetter(Lt,"dashOffset",0,Kt());ot.addGetterSetter(Lt,"shadowColor",void 0,Tu());ot.addGetterSetter(Lt,"shadowBlur",0,Kt());ot.addGetterSetter(Lt,"shadowOpacity",1,Kt());ot.addComponentsGetterSetter(Lt,"shadowOffset",["x","y"]);ot.addGetterSetter(Lt,"shadowOffsetX",0,Kt());ot.addGetterSetter(Lt,"shadowOffsetY",0,Kt());ot.addGetterSetter(Lt,"fillPatternImage");ot.addGetterSetter(Lt,"fill",void 0,q2());ot.addGetterSetter(Lt,"fillPatternX",0,Kt());ot.addGetterSetter(Lt,"fillPatternY",0,Kt());ot.addGetterSetter(Lt,"fillLinearGradientColorStops");ot.addGetterSetter(Lt,"strokeLinearGradientColorStops");ot.addGetterSetter(Lt,"fillRadialGradientStartRadius",0);ot.addGetterSetter(Lt,"fillRadialGradientEndRadius",0);ot.addGetterSetter(Lt,"fillRadialGradientColorStops");ot.addGetterSetter(Lt,"fillPatternRepeat","repeat");ot.addGetterSetter(Lt,"fillEnabled",!0);ot.addGetterSetter(Lt,"strokeEnabled",!0);ot.addGetterSetter(Lt,"shadowEnabled",!0);ot.addGetterSetter(Lt,"dashEnabled",!0);ot.addGetterSetter(Lt,"strokeScaleEnabled",!0);ot.addGetterSetter(Lt,"fillPriority","color");ot.addComponentsGetterSetter(Lt,"fillPatternOffset",["x","y"]);ot.addGetterSetter(Lt,"fillPatternOffsetX",0,Kt());ot.addGetterSetter(Lt,"fillPatternOffsetY",0,Kt());ot.addComponentsGetterSetter(Lt,"fillPatternScale",["x","y"]);ot.addGetterSetter(Lt,"fillPatternScaleX",1,Kt());ot.addGetterSetter(Lt,"fillPatternScaleY",1,Kt());ot.addComponentsGetterSetter(Lt,"fillLinearGradientStartPoint",["x","y"]);ot.addComponentsGetterSetter(Lt,"strokeLinearGradientStartPoint",["x","y"]);ot.addGetterSetter(Lt,"fillLinearGradientStartPointX",0);ot.addGetterSetter(Lt,"strokeLinearGradientStartPointX",0);ot.addGetterSetter(Lt,"fillLinearGradientStartPointY",0);ot.addGetterSetter(Lt,"strokeLinearGradientStartPointY",0);ot.addComponentsGetterSetter(Lt,"fillLinearGradientEndPoint",["x","y"]);ot.addComponentsGetterSetter(Lt,"strokeLinearGradientEndPoint",["x","y"]);ot.addGetterSetter(Lt,"fillLinearGradientEndPointX",0);ot.addGetterSetter(Lt,"strokeLinearGradientEndPointX",0);ot.addGetterSetter(Lt,"fillLinearGradientEndPointY",0);ot.addGetterSetter(Lt,"strokeLinearGradientEndPointY",0);ot.addComponentsGetterSetter(Lt,"fillRadialGradientStartPoint",["x","y"]);ot.addGetterSetter(Lt,"fillRadialGradientStartPointX",0);ot.addGetterSetter(Lt,"fillRadialGradientStartPointY",0);ot.addComponentsGetterSetter(Lt,"fillRadialGradientEndPoint",["x","y"]);ot.addGetterSetter(Lt,"fillRadialGradientEndPointX",0);ot.addGetterSetter(Lt,"fillRadialGradientEndPointY",0);ot.addGetterSetter(Lt,"fillPatternRotation",0);ot.addGetterSetter(Lt,"fillRule",void 0,Tu());ot.backCompat(Lt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const L5="#",P5="beforeDraw",I5="draw",lS=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],G5=lS.length;let Au=class extends $i{constructor(t){super(t),this.canvas=new ml,this.hitCanvas=new nv({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),t<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[t+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Vt.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Vt.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Vt.prototype.moveDown.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Vt.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return Vt.prototype.remove.call(this),t&&t.parentNode&&pt._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:n}){return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&pt.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Vt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){pt.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){pt.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,pt.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let n=1,a=!1;for(;;){for(let r=0;r<G5;r++){const l=lS[r],c=this._getIntersection({x:t.x+l.x*n,y:t.y+l.y*n}),d=c.shape;if(d)return d;if(a=!!c.antialiased,!c.antialiased)break}if(a)n+=1;else return null}}_getIntersection(t){const n=this.hitCanvas.pixelRatio,a=this.hitCanvas.context.getImageData(Math.round(t.x*n),Math.round(t.y*n),1,1).data,r=a[3];if(r===255){const l=pt._rgbToHex(a[0],a[1],a[2]),c=lh[L5+l];return c?{shape:c}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,n,a){const r=this.getLayer(),l=t||r&&r.getCanvas();return this._fire(P5,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),$i.prototype.drawScene.call(this,l,n,a),this._fire(I5,{node:this}),this}drawHit(t,n){const a=this.getLayer(),r=t||a&&a.hitCanvas;return a&&a.clearBeforeDraw()&&a.getHitCanvas().getContext().clear(),$i.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){pt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return pt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return pt.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Au.prototype.nodeType="Layer";ua(Au);ot.addGetterSetter(Au,"imageSmoothingEnabled",!0);ot.addGetterSetter(Au,"clearBeforeDraw",!0);ot.addGetterSetter(Au,"hitGraphEnabled",!0,$r());class rv extends Au{constructor(t){super(t),this.listening(!1),pt.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}rv.prototype.nodeType="FastLayer";ua(rv);class hf extends $i{_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&pt.throw("You may only add groups and shapes to groups.")}}hf.prototype.nodeType="Group";ua(hf);const Dp=(function(){return _u.performance&&_u.performance.now?function(){return _u.performance.now()}:function(){return new Date().getTime()}})();class Ar{constructor(t,n){this.id=Ar.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Dp(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(t){let n=[];return t&&(n=Array.isArray(t)?t:[t]),this.layers=n,this}getLayers(){return this.layers}addLayer(t){const n=this.layers,a=n.length;for(let r=0;r<a;r++)if(n[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const n=Ar.animations,a=n.length;for(let r=0;r<a;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Dp(),Ar._addAnimation(this),this}stop(){return Ar._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const n=t.id,a=this.animations,r=a.length;for(let l=0;l<r;l++)if(a[l].id===n){this.animations.splice(l,1);break}}static _runFrames(){const t={},n=this.animations;for(let a=0;a<n.length;a++){const r=n[a],l=r.layers,c=r.func;r._updateFrameObject(Dp());const d=l.length;let g;if(c?g=c.call(r,r.frame)!==!1:g=!0,!!g)for(let m=0;m<d;m++){const S=l[m];S._id!==void 0&&(t[S._id]=S)}}for(const a in t)t.hasOwnProperty(a)&&t[a].batchDraw()}static _animationLoop(){const t=Ar;t.animations.length?(t._runFrames(),pt.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,pt.requestAnimFrame(this._animationLoop))}}Ar.animations=[];Ar.animIdCounter=0;Ar.animRunning=!1;const H5={node:1,duration:1,easing:1,onFinish:1,yoyo:1},k5=1,Hy=2,ky=3,qy=["fill","stroke","shadowColor"];let q5=0;class V5{constructor(t,n,a,r,l,c,d){this.prop=t,this.propFunc=n,this.begin=r,this._pos=r,this.duration=c,this._change=0,this.prevPos=0,this.yoyo=d,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=a,this._change=l-this.begin,this.pause()}fire(t){const n=this[t];n&&n()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=Hy,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=ky,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===Hy?this.setTime(t):this.state===ky&&this.setTime(this.duration-t)}pause(){this.state=k5,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Kn{constructor(t){const n=this,a=t.node,r=a._id,l=t.easing||uh.Linear,c=!!t.yoyo;let d,g;typeof t.duration>"u"?d=.3:t.duration===0?d=.001:d=t.duration,this.node=a,this._id=q5++;const m=a.getLayer()||(a instanceof Ft.Stage?a.getLayers():null);m||pt.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Ar(function(){n.tween.onEnterFrame()},m),this.tween=new V5(g,function(S){n._tweenFunc(S)},l,0,1,d*1e3,c),this._addListeners(),Kn.attrs[r]||(Kn.attrs[r]={}),Kn.attrs[r][this._id]||(Kn.attrs[r][this._id]={}),Kn.tweens[r]||(Kn.tweens[r]={});for(g in t)H5[g]===void 0&&this._addAttr(g,t[g]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,n){const a=this.node,r=a._id;let l,c,d,g,m;const S=Kn.tweens[r][t];S&&delete Kn.attrs[r][S][t];let C=a.getAttr(t);if(pt._isArray(n))if(l=[],c=Math.max(n.length,C.length),t==="points"&&n.length!==C.length&&(n.length>C.length?(g=C,C=pt._prepareArrayForTween(C,n,a.closed())):(d=n,n=pt._prepareArrayForTween(n,C,a.closed()))),t.indexOf("fill")===0)for(let E=0;E<c;E++)if(E%2===0)l.push(n[E]-C[E]);else{const R=pt.colorToRGBA(C[E]);m=pt.colorToRGBA(n[E]),C[E]=R,l.push({r:m.r-R.r,g:m.g-R.g,b:m.b-R.b,a:m.a-R.a})}else for(let E=0;E<c;E++)l.push(n[E]-C[E]);else qy.indexOf(t)!==-1?(C=pt.colorToRGBA(C),m=pt.colorToRGBA(n),l={r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a}):l=n-C;Kn.attrs[r][this._id][t]={start:C,diff:l,end:n,trueEnd:d,trueStart:g},Kn.tweens[r][t]=this._id}_tweenFunc(t){const n=this.node,a=Kn.attrs[n._id][this._id];let r,l,c,d,g,m,S,C;for(r in a){if(l=a[r],c=l.start,d=l.diff,C=l.end,pt._isArray(c))if(g=[],S=Math.max(c.length,C.length),r.indexOf("fill")===0)for(m=0;m<S;m++)m%2===0?g.push((c[m]||0)+d[m]*t):g.push("rgba("+Math.round(c[m].r+d[m].r*t)+","+Math.round(c[m].g+d[m].g*t)+","+Math.round(c[m].b+d[m].b*t)+","+(c[m].a+d[m].a*t)+")");else for(m=0;m<S;m++)g.push((c[m]||0)+d[m]*t);else qy.indexOf(r)!==-1?g="rgba("+Math.round(c.r+d.r*t)+","+Math.round(c.g+d.g*t)+","+Math.round(c.b+d.b*t)+","+(c.a+d.a*t)+")":g=c+d*t;n.setAttr(r,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,n=Kn.attrs[t._id][this._id];n.points&&n.points.trueEnd&&t.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,n=Kn.attrs[t._id][this._id];n.points&&n.points.trueStart&&t.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,n=this._id,a=Kn.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in a)delete Kn.tweens[t][r];delete Kn.attrs[t][n],Kn.tweens[t]&&(Object.keys(Kn.tweens[t]).length===0&&delete Kn.tweens[t],Object.keys(Kn.attrs[t]).length===0&&delete Kn.attrs[t])}}Kn.attrs={};Kn.tweens={};Vt.prototype.to=function(o){const t=o.onFinish;o.node=this,o.onFinish=function(){this.destroy(),t&&t()},new Kn(o).play()};const uh={BackEaseIn(o,t,n,a){return n*(o/=a)*o*((1.70158+1)*o-1.70158)+t},BackEaseOut(o,t,n,a){return n*((o=o/a-1)*o*((1.70158+1)*o+1.70158)+1)+t},BackEaseInOut(o,t,n,a){let r=1.70158;return(o/=a/2)<1?n/2*(o*o*(((r*=1.525)+1)*o-r))+t:n/2*((o-=2)*o*(((r*=1.525)+1)*o+r)+2)+t},ElasticEaseIn(o,t,n,a,r,l){let c=0;return o===0?t:(o/=a)===1?t+n:(l||(l=a*.3),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(o-=1))*Math.sin((o*a-c)*(2*Math.PI)/l))+t)},ElasticEaseOut(o,t,n,a,r,l){let c=0;return o===0?t:(o/=a)===1?t+n:(l||(l=a*.3),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*o)*Math.sin((o*a-c)*(2*Math.PI)/l)+n+t)},ElasticEaseInOut(o,t,n,a,r,l){let c=0;return o===0?t:(o/=a/2)===2?t+n:(l||(l=a*(.3*1.5)),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),o<1?-.5*(r*Math.pow(2,10*(o-=1))*Math.sin((o*a-c)*(2*Math.PI)/l))+t:r*Math.pow(2,-10*(o-=1))*Math.sin((o*a-c)*(2*Math.PI)/l)*.5+n+t)},BounceEaseOut(o,t,n,a){return(o/=a)<1/2.75?n*(7.5625*o*o)+t:o<2/2.75?n*(7.5625*(o-=1.5/2.75)*o+.75)+t:o<2.5/2.75?n*(7.5625*(o-=2.25/2.75)*o+.9375)+t:n*(7.5625*(o-=2.625/2.75)*o+.984375)+t},BounceEaseIn(o,t,n,a){return n-uh.BounceEaseOut(a-o,0,n,a)+t},BounceEaseInOut(o,t,n,a){return o<a/2?uh.BounceEaseIn(o*2,0,n,a)*.5+t:uh.BounceEaseOut(o*2-a,0,n,a)*.5+n*.5+t},EaseIn(o,t,n,a){return n*(o/=a)*o+t},EaseOut(o,t,n,a){return-n*(o/=a)*(o-2)+t},EaseInOut(o,t,n,a){return(o/=a/2)<1?n/2*o*o+t:-n/2*(--o*(o-2)-1)+t},StrongEaseIn(o,t,n,a){return n*(o/=a)*o*o*o*o+t},StrongEaseOut(o,t,n,a){return n*((o=o/a-1)*o*o*o*o+1)+t},StrongEaseInOut(o,t,n,a){return(o/=a/2)<1?n/2*o*o*o*o*o+t:n/2*((o-=2)*o*o*o*o+2)+t},Linear(o,t,n,a){return n*o/a+t}},gf=pt._assign(Ft,{Util:pt,Transform:Ji,Node:Vt,Container:$i,Stage:Dg,stages:oh,Layer:Au,FastLayer:rv,Group:hf,DD:bn,Shape:Lt,shapes:lh,Animation:Ar,Tween:Kn,Easings:uh,Context:Ng,Canvas:ev});class To extends Lt{_sceneFunc(t){const n=Ft.getAngle(this.angle()),a=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,n,a),t.arc(0,0,this.innerRadius(),n,0,!a),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),n=this.outerRadius(),a=this.clockwise(),r=Ft.getAngle(a?360-this.angle():this.angle()),l=Math.cos(Math.min(r,Math.PI)),c=1,d=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),g=Math.sin(Math.min(r,Math.PI/2)),m=l*(l>0?t:n),S=c*n,C=d*(d>0?t:n),E=g*(g>0?n:t);return{x:m,y:a?-1*E:C,width:S-m,height:E-C}}}To.prototype._centroid=!0;To.prototype.className="Arc";To.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];ua(To);ot.addGetterSetter(To,"innerRadius",0,Kt());ot.addGetterSetter(To,"outerRadius",0,Kt());ot.addGetterSetter(To,"angle",0,Kt());ot.addGetterSetter(To,"clockwise",!1,$r());function Dm(o,t,n,a,r,l,c){const d=Math.sqrt(Math.pow(n-o,2)+Math.pow(a-t,2)),g=Math.sqrt(Math.pow(r-n,2)+Math.pow(l-a,2)),m=c*d/(d+g),S=c*g/(d+g),C=n-m*(r-o),E=a-m*(l-t),R=n+S*(r-o),v=a+S*(l-t);return[C,E,R,v]}function Vy(o,t){const n=o.length,a=[];for(let r=2;r<n-2;r+=2){const l=Dm(o[r-2],o[r-1],o[r],o[r+1],o[r+2],o[r+3],t);isNaN(l[0])||(a.push(l[0]),a.push(l[1]),a.push(o[r]),a.push(o[r+1]),a.push(l[2]),a.push(l[3]))}return a}let Ao=class extends Lt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const n=this.points(),a=n.length,r=this.tension(),l=this.closed(),c=this.bezier();if(!a)return;let d=0;if(t.beginPath(),t.moveTo(n[0],n[1]),r!==0&&a>4){const g=this.getTensionPoints(),m=g.length;for(d=l?0:4,l||t.quadraticCurveTo(g[0],g[1],g[2],g[3]);d<m-2;)t.bezierCurveTo(g[d++],g[d++],g[d++],g[d++],g[d++],g[d++]);l||t.quadraticCurveTo(g[m-2],g[m-1],n[a-2],n[a-1])}else if(c)for(d=2;d<a;)t.bezierCurveTo(n[d++],n[d++],n[d++],n[d++],n[d++],n[d++]);else for(d=2;d<a;d+=2)t.lineTo(n[d],n[d+1]);l?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Vy(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),n=t.length,a=this.tension(),r=Dm(t[n-2],t[n-1],t[0],t[1],t[2],t[3],a),l=Dm(t[n-4],t[n-3],t[n-2],t[n-1],t[0],t[1],a),c=Vy(t,a);return[r[2],r[3]].concat(c).concat([l[0],l[1],t[n-2],t[n-1],l[2],l[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let n=t[0],a=t[0],r=t[1],l=t[1],c,d;for(let g=0;g<t.length/2;g++)c=t[g*2],d=t[g*2+1],n=Math.min(n,c),a=Math.max(a,c),r=Math.min(r,d),l=Math.max(l,d);return{x:n,y:r,width:a-n,height:l-r}}};Ao.prototype.className="Line";Ao.prototype._attrsAffectingSize=["points","bezier","tension"];ua(Ao);ot.addGetterSetter(Ao,"closed",!1);ot.addGetterSetter(Ao,"bezier",!1);ot.addGetterSetter(Ao,"tension",0,Kt());ot.addGetterSetter(Ao,"points",[],s5());const Y5=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],K5=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],Q5=[[1],[1,1],[1,2,1],[1,3,3,1]],Yy=(o,t,n)=>{let a,r;const c=n/2;a=0;for(let d=0;d<20;d++)r=c*Y5[20][d]+c,a+=K5[20][d]*X5(o,t,r);return c*a},Ky=(o,t,n)=>{n===void 0&&(n=1);const a=o[0]-2*o[1]+o[2],r=t[0]-2*t[1]+t[2],l=2*o[1]-2*o[0],c=2*t[1]-2*t[0],d=4*(a*a+r*r),g=4*(a*l+r*c),m=l*l+c*c;if(d===0)return n*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(t[2]-t[0],2));const S=g/(2*d),C=m/d,E=n+S,R=C-S*S,v=E*E+R>0?Math.sqrt(E*E+R):0,M=S*S+R>0?Math.sqrt(S*S+R):0,z=S+Math.sqrt(S*S+R)!==0?R*Math.log(Math.abs((E+v)/(S+M))):0;return Math.sqrt(d)/2*(E*v-S*M+z)};function X5(o,t,n){const a=jm(1,n,o),r=jm(1,n,t),l=a*a+r*r;return Math.sqrt(l)}const jm=(o,t,n)=>{const a=n.length-1;let r,l;if(a===0)return 0;if(o===0){l=0;for(let c=0;c<=a;c++)l+=Q5[a][c]*Math.pow(1-t,a-c)*Math.pow(t,c)*n[c];return l}else{r=new Array(a);for(let c=0;c<a;c++)r[c]=a*(n[c+1]-n[c]);return jm(o-1,t,r)}},Qy=(o,t,n)=>{let a=1,r=o/t,l=(o-n(r))/t,c=0;for(;a>.001;){const d=n(r+l),g=Math.abs(o-d)/t;if(g<a)a=g,r+=l;else{const m=n(r-l),S=Math.abs(o-m)/t;S<a?(a=S,r-=l):l/=2}if(c++,c>500)break}return r};class Qn extends Lt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Qn.parsePathData(this.data()),this.pathLength=Qn.getPathLength(this.dataArray)}_sceneFunc(t){const n=this.dataArray;t.beginPath();let a=!1;for(let r=0;r<n.length;r++){const l=n[r].command,c=n[r].points;switch(l){case"L":t.lineTo(c[0],c[1]);break;case"M":t.moveTo(c[0],c[1]);break;case"C":t.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":t.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":const d=c[0],g=c[1],m=c[2],S=c[3],C=c[4],E=c[5],R=c[6],v=c[7],M=m>S?m:S,z=m>S?1:m/S,P=m>S?S/m:1;t.translate(d,g),t.rotate(R),t.scale(z,P),t.arc(0,0,M,C,C+E,1-v),t.scale(1/z,1/P),t.rotate(-R),t.translate(-d,-g);break;case"z":a=!0,t.closePath();break}}!a&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],S=g.points[5],C=g.points[4]+S;let E=Math.PI/180;if(Math.abs(m-C)<E&&(E=Math.abs(m-C)),S<0)for(let R=m-E;R>C;R-=E){const v=Qn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}else for(let R=m+E;R<C;R+=E){const v=Qn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const S=Qn.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);t.push(S.x,S.y)}else t=t.concat(g.points)});let n=t[0],a=t[0],r=t[1],l=t[1],c,d;for(let g=0;g<t.length/2;g++)c=t[g*2],d=t[g*2+1],isNaN(c)||(n=Math.min(n,c),a=Math.max(a,c)),isNaN(d)||(r=Math.min(r,d),l=Math.max(l,d));return{x:n,y:r,width:a-n,height:l-r}}getLength(){return this.pathLength}getPointAtLength(t){return Qn.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,n,a,r){return Math.sqrt((a-t)*(a-t)+(r-n)*(r-n))}static getPathLength(t){let n=0;for(let a=0;a<t.length;++a)n+=t[a].pathLength;return n}static getPointAtLengthOfDataArray(t,n){let a,r=0,l=n.length;if(!l)return null;for(;r<l&&t>n[r].pathLength;)t-=n[r].pathLength,++r;if(r===l)return a=n[r-1].points.slice(-2),{x:a[0],y:a[1]};if(t<.01)return n[r].command==="M"?(a=n[r].points.slice(0,2),{x:a[0],y:a[1]}):{x:n[r].start.x,y:n[r].start.y};const c=n[r],d=c.points;switch(c.command){case"L":return Qn.getPointOnLine(t,c.start.x,c.start.y,d[0],d[1]);case"C":return Qn.getPointOnCubicBezier(Qy(t,Qn.getPathLength(n),M=>Yy([c.start.x,d[0],d[2],d[4]],[c.start.y,d[1],d[3],d[5]],M)),c.start.x,c.start.y,d[0],d[1],d[2],d[3],d[4],d[5]);case"Q":return Qn.getPointOnQuadraticBezier(Qy(t,Qn.getPathLength(n),M=>Ky([c.start.x,d[0],d[2]],[c.start.y,d[1],d[3]],M)),c.start.x,c.start.y,d[0],d[1],d[2],d[3]);case"A":const g=d[0],m=d[1],S=d[2],C=d[3],E=d[5],R=d[6];let v=d[4];return v+=E*t/c.pathLength,Qn.getPointOnEllipticalArc(g,m,S,C,v,R)}return null}static getPointOnLine(t,n,a,r,l,c,d){c=c??n,d=d??a;const g=this.getLineLength(n,a,r,l);if(g<1e-10)return{x:n,y:a};if(r===n)return{x:c,y:d+(l>a?t:-t)};const m=(l-a)/(r-n),S=Math.sqrt(t*t/(1+m*m))*(r<n?-1:1),C=m*S;if(Math.abs(d-a-m*(c-n))<1e-10)return{x:c+S,y:d+C};const E=((c-n)*(r-n)+(d-a)*(l-a))/(g*g),R=n+E*(r-n),v=a+E*(l-a),M=this.getLineLength(c,d,R,v),z=Math.sqrt(t*t-M*M),P=Math.sqrt(z*z/(1+m*m))*(r<n?-1:1),j=m*P;return{x:R+P,y:v+j}}static getPointOnCubicBezier(t,n,a,r,l,c,d,g,m){function S(z){return z*z*z}function C(z){return 3*z*z*(1-z)}function E(z){return 3*z*(1-z)*(1-z)}function R(z){return(1-z)*(1-z)*(1-z)}const v=g*S(t)+c*C(t)+r*E(t)+n*R(t),M=m*S(t)+d*C(t)+l*E(t)+a*R(t);return{x:v,y:M}}static getPointOnQuadraticBezier(t,n,a,r,l,c,d){function g(R){return R*R}function m(R){return 2*R*(1-R)}function S(R){return(1-R)*(1-R)}const C=c*g(t)+r*m(t)+n*S(t),E=d*g(t)+l*m(t)+a*S(t);return{x:C,y:E}}static getPointOnEllipticalArc(t,n,a,r,l,c){const d=Math.cos(c),g=Math.sin(c),m={x:a*Math.cos(l),y:r*Math.sin(l)};return{x:t+(m.x*d-m.y*g),y:n+(m.x*g+m.y*d)}}static parsePathData(t){if(!t)return[];let n=t;const a=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let C=0;C<a.length;C++)n=n.replace(new RegExp(a[C],"g"),"|"+a[C]);const r=n.split("|"),l=[],c=[];let d=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let S;for(let C=1;C<r.length;C++){let E=r[C],R=E.charAt(0);for(E=E.slice(1),c.length=0;S=m.exec(E);)c.push(S[0]);let v=[],M=R==="A"||R==="a"?0:-1;for(let z=0,P=c.length;z<P;z++){const j=c[z];if(j==="00"){v.push(0,0),M>=0&&(M+=2,M>=7&&(M-=7));continue}if(M>=0){if(M===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(j)){v.push(parseInt(j[0],10)),v.push(parseInt(j[1],10)),v.push(parseFloat(j.slice(2))),M+=3,M>=7&&(M-=7);continue}if(j==="11"||j==="10"||j==="01"){v.push(parseInt(j[0],10)),v.push(parseInt(j[1],10)),M+=2,M>=7&&(M-=7);continue}if(j==="0"||j==="1"){v.push(parseInt(j,10)),M+=1,M>=7&&(M-=7);continue}}else if(M===4){if(/^[01]\d+(?:\.\d+)?$/.test(j)){v.push(parseInt(j[0],10)),v.push(parseFloat(j.slice(1))),M+=2,M>=7&&(M-=7);continue}if(j==="0"||j==="1"){v.push(parseInt(j,10)),M+=1,M>=7&&(M-=7);continue}}const x=parseFloat(j);isNaN(x)?v.push(0):v.push(x),M+=1,M>=7&&(M-=7)}else{const x=parseFloat(j);isNaN(x)?v.push(0):v.push(x)}}for(;v.length>0&&!isNaN(v[0]);){let z="",P=[];const j=d,x=g;let L,O,T,A,y,B,U,I,K,Q;switch(R){case"l":d+=v.shift(),g+=v.shift(),z="L",P.push(d,g);break;case"L":d=v.shift(),g=v.shift(),P.push(d,g);break;case"m":const X=v.shift(),Y=v.shift();if(d+=X,g+=Y,z="M",l.length>2&&l[l.length-1].command==="z"){for(let D=l.length-2;D>=0;D--)if(l[D].command==="M"){d=l[D].points[0]+X,g=l[D].points[1]+Y;break}}P.push(d,g),R="l";break;case"M":d=v.shift(),g=v.shift(),z="M",P.push(d,g),R="L";break;case"h":d+=v.shift(),z="L",P.push(d,g);break;case"H":d=v.shift(),z="L",P.push(d,g);break;case"v":g+=v.shift(),z="L",P.push(d,g);break;case"V":g=v.shift(),z="L",P.push(d,g);break;case"C":P.push(v.shift(),v.shift(),v.shift(),v.shift()),d=v.shift(),g=v.shift(),P.push(d,g);break;case"c":P.push(d+v.shift(),g+v.shift(),d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="C",P.push(d,g);break;case"S":O=d,T=g,L=l[l.length-1],L.command==="C"&&(O=d+(d-L.points[2]),T=g+(g-L.points[3])),P.push(O,T,v.shift(),v.shift()),d=v.shift(),g=v.shift(),z="C",P.push(d,g);break;case"s":O=d,T=g,L=l[l.length-1],L.command==="C"&&(O=d+(d-L.points[2]),T=g+(g-L.points[3])),P.push(O,T,d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="C",P.push(d,g);break;case"Q":P.push(v.shift(),v.shift()),d=v.shift(),g=v.shift(),P.push(d,g);break;case"q":P.push(d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="Q",P.push(d,g);break;case"T":O=d,T=g,L=l[l.length-1],L.command==="Q"&&(O=d+(d-L.points[0]),T=g+(g-L.points[1])),d=v.shift(),g=v.shift(),z="Q",P.push(O,T,d,g);break;case"t":O=d,T=g,L=l[l.length-1],L.command==="Q"&&(O=d+(d-L.points[0]),T=g+(g-L.points[1])),d+=v.shift(),g+=v.shift(),z="Q",P.push(O,T,d,g);break;case"A":A=v.shift(),y=v.shift(),B=v.shift(),U=v.shift(),I=v.shift(),K=d,Q=g,d=v.shift(),g=v.shift(),z="A",P=this.convertEndpointToCenterParameterization(K,Q,d,g,U,I,A,y,B);break;case"a":A=v.shift(),y=v.shift(),B=v.shift(),U=v.shift(),I=v.shift(),K=d,Q=g,d+=v.shift(),g+=v.shift(),z="A",P=this.convertEndpointToCenterParameterization(K,Q,d,g,U,I,A,y,B);break}l.push({command:z||R,points:P,start:{x:j,y:x},pathLength:this.calcLength(j,x,z||R,P)})}(R==="z"||R==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(t,n,a,r){let l,c,d,g;const m=Qn;switch(a){case"L":return m.getLineLength(t,n,r[0],r[1]);case"C":return Yy([t,r[0],r[2],r[4]],[n,r[1],r[3],r[5]],1);case"Q":return Ky([t,r[0],r[2]],[n,r[1],r[3]],1);case"A":l=0;const S=r[4],C=r[5],E=r[4]+C;let R=Math.PI/180;if(Math.abs(S-E)<R&&(R=Math.abs(S-E)),c=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],S,0),C<0)for(g=S-R;g>E;g-=R)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),c=d;else for(g=S+R;g<E;g+=R)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),c=d;return d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],E,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),l}return 0}static convertEndpointToCenterParameterization(t,n,a,r,l,c,d,g,m){const S=m*(Math.PI/180),C=Math.cos(S)*(t-a)/2+Math.sin(S)*(n-r)/2,E=-1*Math.sin(S)*(t-a)/2+Math.cos(S)*(n-r)/2,R=C*C/(d*d)+E*E/(g*g);R>1&&(d*=Math.sqrt(R),g*=Math.sqrt(R));let v=Math.sqrt((d*d*(g*g)-d*d*(E*E)-g*g*(C*C))/(d*d*(E*E)+g*g*(C*C)));l===c&&(v*=-1),isNaN(v)&&(v=0);const M=v*d*E/g,z=v*-g*C/d,P=(t+a)/2+Math.cos(S)*M-Math.sin(S)*z,j=(n+r)/2+Math.sin(S)*M+Math.cos(S)*z,x=function(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1])},L=function(U,I){return(U[0]*I[0]+U[1]*I[1])/(x(U)*x(I))},O=function(U,I){return(U[0]*I[1]<U[1]*I[0]?-1:1)*Math.acos(L(U,I))},T=O([1,0],[(C-M)/d,(E-z)/g]),A=[(C-M)/d,(E-z)/g],y=[(-1*C-M)/d,(-1*E-z)/g];let B=O(A,y);return L(A,y)<=-1&&(B=Math.PI),L(A,y)>=1&&(B=0),c===0&&B>0&&(B=B-2*Math.PI),c===1&&B<0&&(B=B+2*Math.PI),[P,j,d,g,T,B,S,c]}}Qn.prototype.className="Path";Qn.prototype._attrsAffectingSize=["data"];ua(Qn);ot.addGetterSetter(Qn,"data");class wu extends Ao{_sceneFunc(t){super._sceneFunc(t);const n=Math.PI*2,a=this.points();let r=a;const l=this.tension()!==0&&a.length>4;l&&(r=this.getTensionPoints());const c=this.pointerLength(),d=a.length;let g,m;if(l){const E=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],a[d-2],a[d-1]],R=Qn.calcLength(r[r.length-4],r[r.length-3],"C",E),v=Qn.getPointOnQuadraticBezier(Math.min(1,1-c/R),E[0],E[1],E[2],E[3],E[4],E[5]);g=a[d-2]-v.x,m=a[d-1]-v.y}else g=a[d-2]-a[d-4],m=a[d-1]-a[d-3];const S=(Math.atan2(m,g)+n)%n,C=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(a[d-2],a[d-1]),t.rotate(S),t.moveTo(0,0),t.lineTo(-c,C/2),t.lineTo(-c,-C/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(a[0],a[1]),l?(g=(r[0]+r[2])/2-a[0],m=(r[1]+r[3])/2-a[1]):(g=a[2]-a[0],m=a[3]-a[1]),t.rotate((Math.atan2(-m,-g)+n)%n),t.moveTo(0,0),t.lineTo(-c,C/2),t.lineTo(-c,-C/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),n=this.pointerWidth()/2;return{x:t.x,y:t.y-n,width:t.width,height:t.height+n*2}}}wu.prototype.className="Arrow";ua(wu);ot.addGetterSetter(wu,"pointerLength",10,Kt());ot.addGetterSetter(wu,"pointerWidth",10,Kt());ot.addGetterSetter(wu,"pointerAtBeginning",!1);ot.addGetterSetter(wu,"pointerAtEnding",!0);class _f extends Lt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}_f.prototype._centroid=!0;_f.prototype.className="Circle";_f.prototype._attrsAffectingSize=["radius"];ua(_f);ot.addGetterSetter(_f,"radius",0,Kt());class _l extends Lt{_sceneFunc(t){const n=this.radiusX(),a=this.radiusY();t.beginPath(),t.save(),n!==a&&t.scale(1,a/n),t.arc(0,0,n,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}_l.prototype.className="Ellipse";_l.prototype._centroid=!0;_l.prototype._attrsAffectingSize=["radiusX","radiusY"];ua(_l);ot.addComponentsGetterSetter(_l,"radius",["x","y"]);ot.addGetterSetter(_l,"radiusX",0,Kt());ot.addGetterSetter(_l,"radiusY",0,Kt());let ts=class uS extends Lt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),n=this.hasShadow();return t&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const n=this.getWidth(),a=this.getHeight(),r=this.cornerRadius(),l=this.attrs.image;let c;if(l){const d=this.attrs.cropWidth,g=this.attrs.cropHeight;d&&g?c=[l,this.cropX(),this.cropY(),d,g,0,0,n,a]:c=[l,0,0,n,a]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?pt.drawRoundedRectPath(t,n,a,r):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)),l&&(r&&t.clip(),t.drawImage.apply(t,c))}_hitFunc(t){const n=this.width(),a=this.height(),r=this.cornerRadius();t.beginPath(),r?pt.drawRoundedRectPath(t,n,a,r):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,n,a;return(a=(t=this.attrs.width)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&a!==void 0?a:0}getHeight(){var t,n,a;return(a=(t=this.attrs.height)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&a!==void 0?a:0}static fromURL(t,n,a=null){const r=pt.createImageElement();r.onload=function(){const l=new uS({image:r});n(l)},r.onerror=a,r.crossOrigin="Anonymous",r.src=t}};ts.prototype.className="Image";ts.prototype._attrsAffectingSize=["image"];ua(ts);ot.addGetterSetter(ts,"cornerRadius",0,Mg(4));ot.addGetterSetter(ts,"image");ot.addComponentsGetterSetter(ts,"crop",["x","y","width","height"]);ot.addGetterSetter(ts,"cropX",0,Kt());ot.addGetterSetter(ts,"cropY",0,Kt());ot.addGetterSetter(ts,"cropWidth",0,Kt());ot.addGetterSetter(ts,"cropHeight",0,Kt());const cS=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],F5="Change.konva",J5="none",Um="up",Bm="right",zm="down",Lm="left",Z5=cS.length;class sv extends hf{constructor(t){super(t),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let n=this,a;const r=function(){n._sync()};for(a=0;a<Z5;a++)t.on(cS[a]+F5,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),n=this.getTag(),a,r,l,c,d,g,m;if(t&&n){switch(a=t.width(),r=t.height(),l=n.pointerDirection(),c=n.pointerWidth(),m=n.pointerHeight(),d=0,g=0,l){case Um:d=a/2,g=-1*m;break;case Bm:d=a+c,g=r/2;break;case zm:d=a/2,g=r+m;break;case Lm:d=-1*c,g=r/2;break}n.setAttrs({x:-1*d,y:-1*g,width:a,height:r}),t.setAttrs({x:-1*d,y:-1*g})}}}sv.prototype.className="Label";ua(sv);class Ru extends Lt{_sceneFunc(t){const n=this.width(),a=this.height(),r=this.pointerDirection(),l=this.pointerWidth(),c=this.pointerHeight(),d=this.cornerRadius();let g=0,m=0,S=0,C=0;typeof d=="number"?g=m=S=C=Math.min(d,n/2,a/2):(g=Math.min(d[0]||0,n/2,a/2),m=Math.min(d[1]||0,n/2,a/2),C=Math.min(d[2]||0,n/2,a/2),S=Math.min(d[3]||0,n/2,a/2)),t.beginPath(),t.moveTo(g,0),r===Um&&(t.lineTo((n-l)/2,0),t.lineTo(n/2,-1*c),t.lineTo((n+l)/2,0)),t.lineTo(n-m,0),t.arc(n-m,m,m,Math.PI*3/2,0,!1),r===Bm&&(t.lineTo(n,(a-c)/2),t.lineTo(n+l,a/2),t.lineTo(n,(a+c)/2)),t.lineTo(n,a-C),t.arc(n-C,a-C,C,0,Math.PI/2,!1),r===zm&&(t.lineTo((n+l)/2,a),t.lineTo(n/2,a+c),t.lineTo((n-l)/2,a)),t.lineTo(S,a),t.arc(S,a-S,S,Math.PI/2,Math.PI,!1),r===Lm&&(t.lineTo(0,(a+c)/2),t.lineTo(-1*l,a/2),t.lineTo(0,(a-c)/2)),t.lineTo(0,g),t.arc(g,g,g,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,n=0,a=this.pointerWidth(),r=this.pointerHeight(),l=this.pointerDirection(),c=this.width(),d=this.height();return l===Um?(n-=r,d+=r):l===zm?d+=r:l===Lm?(t-=a*1.5,c+=a):l===Bm&&(c+=a*1.5),{x:t,y:n,width:c,height:d}}}Ru.prototype.className="Tag";ua(Ru);ot.addGetterSetter(Ru,"pointerDirection",J5);ot.addGetterSetter(Ru,"pointerWidth",0,Kt());ot.addGetterSetter(Ru,"pointerHeight",0,Kt());ot.addGetterSetter(Ru,"cornerRadius",0,Mg(4));class bh extends Lt{_sceneFunc(t){const n=this.cornerRadius(),a=this.width(),r=this.height();t.beginPath(),n?pt.drawRoundedRectPath(t,a,r,n):t.rect(0,0,a,r),t.closePath(),t.fillStrokeShape(this)}}bh.prototype.className="Rect";ua(bh);ot.addGetterSetter(bh,"cornerRadius",0,Mg(4));class El extends Lt{_sceneFunc(t){const n=this._getPoints(),a=this.radius(),r=this.sides(),l=this.cornerRadius();if(t.beginPath(),l)pt.drawRoundedPolygonPath(t,n,r,a,l);else{t.moveTo(n[0].x,n[0].y);for(let c=1;c<n.length;c++)t.lineTo(n[c].x,n[c].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,n=this.attrs.radius||0,a=[];for(let r=0;r<t;r++)a.push({x:n*Math.sin(r*2*Math.PI/t),y:-1*n*Math.cos(r*2*Math.PI/t)});return a}getSelfRect(){const t=this._getPoints();let n=t[0].x,a=t[0].y,r=t[0].x,l=t[0].y;return t.forEach(c=>{n=Math.min(n,c.x),a=Math.max(a,c.x),r=Math.min(r,c.y),l=Math.max(l,c.y)}),{x:n,y:r,width:a-n,height:l-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}El.prototype.className="RegularPolygon";El.prototype._centroid=!0;El.prototype._attrsAffectingSize=["radius"];ua(El);ot.addGetterSetter(El,"radius",0,Kt());ot.addGetterSetter(El,"sides",0,Kt());ot.addGetterSetter(El,"cornerRadius",0,Mg(4));const Xy=Math.PI*2;class Ou extends Lt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Xy,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Xy,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Ou.prototype.className="Ring";Ou.prototype._centroid=!0;Ou.prototype._attrsAffectingSize=["innerRadius","outerRadius"];ua(Ou);ot.addGetterSetter(Ou,"innerRadius",0,Kt());ot.addGetterSetter(Ou,"outerRadius",0,Kt());class xs extends Lt{constructor(t){super(t),this._updated=!0,this.anim=new Ar(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const n=this.animation(),a=this.frameIndex(),r=a*4,l=this.animations()[n],c=this.frameOffsets(),d=l[r+0],g=l[r+1],m=l[r+2],S=l[r+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,m,S),t.closePath(),t.fillStrokeShape(this)),C)if(c){const E=c[n],R=a*2;t.drawImage(C,d,g,m,S,E[R+0],E[R+1],m,S)}else t.drawImage(C,d,g,m,S,0,0,m,S)}_hitFunc(t){const n=this.animation(),a=this.frameIndex(),r=a*4,l=this.animations()[n],c=this.frameOffsets(),d=l[r+2],g=l[r+3];if(t.beginPath(),c){const m=c[n],S=a*2;t.rect(m[S+0],m[S+1],d,g)}else t.rect(0,0,d,g);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),n=this.animation(),a=this.animations(),r=a[n],l=r.length/4;t<l-1?this.frameIndex(t+1):this.frameIndex(0)}}xs.prototype.className="Sprite";ua(xs);ot.addGetterSetter(xs,"animation");ot.addGetterSetter(xs,"animations");ot.addGetterSetter(xs,"frameOffsets");ot.addGetterSetter(xs,"image");ot.addGetterSetter(xs,"frameIndex",0,Kt());ot.addGetterSetter(xs,"frameRate",17,Kt());ot.backCompat(xs,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Cl extends Lt{_sceneFunc(t){const n=this.innerRadius(),a=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-a);for(let l=1;l<r*2;l++){const c=l%2===0?a:n,d=c*Math.sin(l*Math.PI/r),g=-1*c*Math.cos(l*Math.PI/r);t.lineTo(d,g)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Cl.prototype.className="Star";Cl.prototype._centroid=!0;Cl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];ua(Cl);ot.addGetterSetter(Cl,"numPoints",5,Kt());ot.addGetterSetter(Cl,"innerRadius",0,Kt());ot.addGetterSetter(Cl,"outerRadius",0,Kt());function gl(o){return[...o].reduce((t,n,a,r)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const l=r[a+1];l&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(l)?(t.push(n+l),r[a+1]=""):t.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(r[a+1]||""))?t.push(n+r[a+1]):a>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?t[t.length-1]+=n:n&&t.push(n);return t},[])}const Wc="auto",W5="center",fS="inherit",$c="justify",$5="Change.konva",t6="2d",Fy="-",dS="left",e6="text",n6="Text",a6="top",i6="bottom",Jy="middle",hS="normal",r6="px ",tg=" ",s6="right",Zy="rtl",o6="word",l6="char",Wy="none",jp="…",gS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],u6=gS.length;function c6(o){return o.split(",").map(t=>{t=t.trim();const n=t.indexOf(" ")>=0,a=t.indexOf('"')>=0||t.indexOf("'")>=0;return n&&!a&&(t=`"${t}"`),t}).join(", ")}let eg;function Up(){return eg||(eg=pt.createCanvasElement().getContext(t6),eg)}function f6(o){o.fillText(this._partialText,this._partialTextX,this._partialTextY)}function d6(o){o.setAttr("miterLimit",2),o.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function h6(o){return o=o||{},!o.fillLinearGradientColorStops&&!o.fillRadialGradientColorStops&&!o.fillPatternImage&&(o.fill=o.fill||"black"),o}class Wn extends Lt{constructor(t){super(h6(t)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<u6;n++)this.on(gS[n]+$5,this._setTextData);this._setTextData()}_sceneFunc(t){var n,a;const r=this.textArr,l=r.length;if(!this.text())return;let c=this.padding(),d=this.fontSize(),g=this.lineHeight()*d,m=this.verticalAlign(),S=this.direction(),C=0,E=this.align(),R=this.getWidth(),v=this.letterSpacing(),M=this.charRenderFunc(),z=this.fill(),P=this.textDecoration(),j=P.indexOf("underline")!==-1,x=P.indexOf("line-through")!==-1,L;S=S===fS?t.direction:S;let O=g/2,T=Jy;if(!Ft.legacyTextRendering){const A=this.measureSize("M");T="alphabetic";const y=(n=A.fontBoundingBoxAscent)!==null&&n!==void 0?n:A.actualBoundingBoxAscent,B=(a=A.fontBoundingBoxDescent)!==null&&a!==void 0?a:A.actualBoundingBoxDescent;O=(y-B)/2+g/2}for(S===Zy&&t.setAttr("direction",S),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",T),t.setAttr("textAlign",dS),m===Jy?C=(this.getHeight()-l*g-c*2)/2:m===i6&&(C=this.getHeight()-l*g-c*2),t.translate(c,C+c),L=0;L<l;L++){let A=0,y=0;const B=r[L],U=B.text,I=B.width,K=B.lastInParagraph;if(t.save(),E===s6?A+=R-I-c*2:E===W5&&(A+=(R-I-c*2)/2),j){t.save(),t.beginPath();const Q=Ft.legacyTextRendering?Math.round(d/2):Math.round(d/4),X=A,Y=O+y+Q;t.moveTo(X,Y);const D=E===$c&&!K?R-c*2:I;t.lineTo(X+Math.round(D),Y),t.lineWidth=d/15;const H=this._getLinearGradient();t.strokeStyle=H||z,t.stroke(),t.restore()}if(S!==Zy&&(v!==0||E===$c||M)){const Q=U.split(" ").length-1,X=gl(U);for(let Y=0;Y<X.length;Y++){const D=X[Y];if(D===" "&&!K&&E===$c&&(A+=(R-c*2-I)/Q),this._partialTextX=A,this._partialTextY=O+y,this._partialText=D,M){t.save();const F=r.slice(0,L).reduce((at,Z)=>at+gl(Z.text).length,0),tt=Y+F;M({char:D,index:tt,x:A,y:O+y,lineIndex:L,column:Y,isLastInLine:K,width:this.measureSize(D).width,context:t})}t.fillStrokeShape(this),M&&t.restore(),A+=this.measureSize(D).width+v}}else v!==0&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=A,this._partialTextY=O+y,this._partialText=U,t.fillStrokeShape(this);if(x){t.save(),t.beginPath();const Q=Ft.legacyTextRendering?0:-Math.round(d/4),X=E===$c?0:A;t.moveTo(X,O+y+Q);const Y=E===$c&&!K?R-c*2:I;t.lineTo(X+Math.round(Y),O+y+Q),t.lineWidth=d/15;const D=this._getLinearGradient();t.strokeStyle=D||z,t.stroke(),t.restore()}t.restore(),l>1&&(O+=g)}}_hitFunc(t){const n=this.getWidth(),a=this.getHeight();t.beginPath(),t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}setText(t){const n=pt._isString(t)?t:t==null?"":t+"";return this._setAttr(e6,n),this}getWidth(){return this.attrs.width===Wc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Wc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return pt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var n,a,r,l,c,d,g,m,S,C,E;let R=Up(),v=this.fontSize(),M;R.save(),R.font=this._getContextFont(),M=R.measureText(t),R.restore();const z=v/100;return{actualBoundingBoxAscent:(n=M.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*z,actualBoundingBoxDescent:(a=M.actualBoundingBoxDescent)!==null&&a!==void 0?a:0,actualBoundingBoxLeft:(r=M.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*z,actualBoundingBoxRight:(l=M.actualBoundingBoxRight)!==null&&l!==void 0?l:75.732421875*z,alphabeticBaseline:(c=M.alphabeticBaseline)!==null&&c!==void 0?c:0,emHeightAscent:(d=M.emHeightAscent)!==null&&d!==void 0?d:100*z,emHeightDescent:(g=M.emHeightDescent)!==null&&g!==void 0?g:-20*z,fontBoundingBoxAscent:(m=M.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*z,fontBoundingBoxDescent:(S=M.fontBoundingBoxDescent)!==null&&S!==void 0?S:21*z,hangingBaseline:(C=M.hangingBaseline)!==null&&C!==void 0?C:72.80000305175781*z,ideographicBaseline:(E=M.ideographicBaseline)!==null&&E!==void 0?E:-21*z,width:M.width,height:v}}_getContextFont(){return this.fontStyle()+tg+this.fontVariant()+tg+(this.fontSize()+r6)+c6(this.fontFamily())}_addTextLine(t){this.align()===$c&&(t=t.trim());const a=this._getTextWidth(t);return this.textArr.push({text:t,width:a,lastInParagraph:!1})}_getTextWidth(t){const n=this.letterSpacing(),a=t.length;return Up().measureText(t).width+n*a}_setTextData(){let t=this.text().split(`
`),n=+this.fontSize(),a=0,r=this.lineHeight()*n,l=this.attrs.width,c=this.attrs.height,d=l!==Wc&&l!==void 0,g=c!==Wc&&c!==void 0,m=this.padding(),S=l-m*2,C=c-m*2,E=0,R=this.wrap(),v=R!==Wy,M=R!==l6&&v,z=this.ellipsis();this.textArr=[],Up().font=this._getContextFont();const P=z?this._getTextWidth(jp):0;for(let j=0,x=t.length;j<x;++j){let L=t[j],O=this._getTextWidth(L);if(d&&O>S)for(;L.length>0;){let T=0,A=gl(L).length,y="",B=0;for(;T<A;){const U=T+A>>>1,I=gl(L),K=I.slice(0,U+1).join(""),Q=this._getTextWidth(K);(z&&g&&E+r>C?Q+P:Q)<=S?(T=U+1,y=K,B=Q):A=U}if(y){if(M){const K=gl(L),Q=gl(y),X=K[Q.length],Y=X===tg||X===Fy;let D;if(Y&&B<=S)D=Q.length;else{const H=Q.lastIndexOf(tg),F=Q.lastIndexOf(Fy);D=Math.max(H,F)+1}D>0&&(T=D,y=K.slice(0,T).join(""),B=this._getTextWidth(y))}if(y=y.trimRight(),this._addTextLine(y),a=Math.max(a,B),E+=r,this._shouldHandleEllipsis(E)){this._tryToAddEllipsisToLastLine();break}if(L=gl(L).slice(T).join("").trimLeft(),L.length>0&&(O=this._getTextWidth(L),O<=S)){this._addTextLine(L),E+=r,a=Math.max(a,O);break}}else break}else this._addTextLine(L),E+=r,a=Math.max(a,O),this._shouldHandleEllipsis(E)&&j<x-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&E+r>C)break}this.textHeight=n,this.textWidth=a}_shouldHandleEllipsis(t){const n=+this.fontSize(),a=this.lineHeight()*n,r=this.attrs.height,l=r!==Wc&&r!==void 0,c=this.padding(),d=r-c*2;return!(this.wrap()!==Wy)||l&&t+a>d}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,n=t!==Wc&&t!==void 0,a=this.padding(),r=t-a*2,l=this.ellipsis(),c=this.textArr[this.textArr.length-1];!c||!l||(n&&(this._getTextWidth(c.text+jp)<r||(c.text=c.text.slice(0,c.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(c.text+jp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return t&&n?!0:super._useBufferCanvas()}}Wn.prototype._fillFunc=f6;Wn.prototype._strokeFunc=d6;Wn.prototype.className=n6;Wn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];ua(Wn);ot.overWriteSetter(Wn,"width",av());ot.overWriteSetter(Wn,"height",av());ot.addGetterSetter(Wn,"direction",fS);ot.addGetterSetter(Wn,"fontFamily","Arial");ot.addGetterSetter(Wn,"fontSize",12,Kt());ot.addGetterSetter(Wn,"fontStyle",hS);ot.addGetterSetter(Wn,"fontVariant",hS);ot.addGetterSetter(Wn,"padding",0,Kt());ot.addGetterSetter(Wn,"align",dS);ot.addGetterSetter(Wn,"verticalAlign",a6);ot.addGetterSetter(Wn,"lineHeight",1,Kt());ot.addGetterSetter(Wn,"wrap",o6);ot.addGetterSetter(Wn,"ellipsis",!1,$r());ot.addGetterSetter(Wn,"letterSpacing",0,Kt());ot.addGetterSetter(Wn,"text","",Tu());ot.addGetterSetter(Wn,"textDecoration","");ot.addGetterSetter(Wn,"charRenderFunc",void 0);const g6="",pS="normal";function mS(o){o.fillText(this.partialText,0,0)}function vS(o){o.strokeText(this.partialText,0,0)}class La extends Lt{constructor(t){super(t),this.dummyCanvas=pt.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Qn.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const n=this.pathLength;return t>n?null:Qn.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Qn.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const n=this.textDecoration(),a=this.fill(),r=this.fontSize(),l=this.glyphInfo,c=n.indexOf("underline")!==-1,d=n.indexOf("line-through")!==-1;c&&t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),this.partialText=l[g].text,t.fillStrokeShape(this),c&&(g===0&&t.moveTo(0,r/2+1),t.lineTo(l[g].width,r/2+1)),t.restore()}if(c&&(t.strokeStyle=a,t.lineWidth=r/20,t.stroke()),d){t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),g===0&&t.moveTo(0,0),t.lineTo(l[g].width,0),t.restore()}t.strokeStyle=a,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const n=this.glyphInfo;if(n.length>=1){const a=n[0].p0;t.moveTo(a.x,a.y)}for(let a=0;a<n.length;a++){const r=n[a].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return pt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Wn.prototype.setText.call(this,t)}_getContextFont(){return Wn.prototype._getContextFont.call(this)}_getTextSize(t){const a=this.dummyCanvas.getContext("2d");a.save(),a.font=this._getContextFont();const r=a.measureText(t);return a.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=gl(this.text()),n=[];let a=0;for(let C=0;C<t.length;C++)n.push({char:t[C],width:this._getTextSize(t[C]).width}),a+=n[C].width;const{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=a,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const l=this.letterSpacing(),c=this.align(),d=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*l,0);let m=0;c==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),c==="right"&&(m=Math.max(0,this.pathLength-g));let S=m;for(let C=0;C<n.length;C++){const E=this._getPointAtLength(S);if(!E)return;const R=n[C].char;let v=n[C].width+l;if(R===" "&&c==="justify"){const L=this.text().split(" ").length-1;v+=(this.pathLength-g)/L}const M=this._getPointAtLength(S+v);if(!M)return;const z=Qn.getLineLength(E.x,E.y,M.x,M.y);let P=0;if(d)try{P=d(n[C-1].char,R)*this.fontSize()}catch{P=0}E.x+=P,M.x+=P,this.textWidth+=P;const j=Qn.getPointOnLine(P+z/2,E.x,E.y,M.x,M.y),x=Math.atan2(M.y-E.y,M.x-E.x);this.glyphInfo.push({transposeX:j.x,transposeY:j.y,text:t[C],rotation:x,p0:E,p1:M,width:z}),S+=v}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});let n=t[0]||0,a=t[0]||0,r=t[1]||0,l=t[1]||0,c,d;for(let m=0;m<t.length/2;m++)c=t[m*2],d=t[m*2+1],n=Math.min(n,c),a=Math.max(a,c),r=Math.min(r,d),l=Math.max(l,d);const g=this.fontSize();return{x:n-g/2,y:r-g/2,width:a-n+g,height:l-r+g}}destroy(){return pt.releaseCanvas(this.dummyCanvas),super.destroy()}}La.prototype._fillFunc=mS;La.prototype._strokeFunc=vS;La.prototype._fillFuncHit=mS;La.prototype._strokeFuncHit=vS;La.prototype.className="TextPath";La.prototype._attrsAffectingSize=["text","fontSize","data"];ua(La);ot.addGetterSetter(La,"data");ot.addGetterSetter(La,"fontFamily","Arial");ot.addGetterSetter(La,"fontSize",12,Kt());ot.addGetterSetter(La,"fontStyle",pS);ot.addGetterSetter(La,"align","left");ot.addGetterSetter(La,"letterSpacing",0,Kt());ot.addGetterSetter(La,"textBaseline","middle");ot.addGetterSetter(La,"fontVariant",pS);ot.addGetterSetter(La,"text",g6);ot.addGetterSetter(La,"textDecoration","");ot.addGetterSetter(La,"kerningFunc",void 0);const yS="tr-konva",p6=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(o=>o+`.${yS}`).join(" "),$y="nodesRect",m6=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],v6={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},y6="ontouchstart"in Ft._global;function S6(o,t,n){if(o==="rotater")return n;t+=pt.degToRad(v6[o]||0);const a=(pt.radToDeg(t)%360+360)%360;return pt._inRange(a,315+22.5,360)||pt._inRange(a,0,22.5)?"ns-resize":pt._inRange(a,45-22.5,45+22.5)?"nesw-resize":pt._inRange(a,90-22.5,90+22.5)?"ew-resize":pt._inRange(a,135-22.5,135+22.5)?"nwse-resize":pt._inRange(a,180-22.5,180+22.5)?"ns-resize":pt._inRange(a,225-22.5,225+22.5)?"nesw-resize":pt._inRange(a,270-22.5,270+22.5)?"ew-resize":pt._inRange(a,315-22.5,315+22.5)?"nwse-resize":(pt.error("Transformer has unknown angle for cursor detection: "+a),"pointer")}const Sg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function b6(o){return{x:o.x+o.width/2*Math.cos(o.rotation)+o.height/2*Math.sin(-o.rotation),y:o.y+o.height/2*Math.cos(o.rotation)+o.width/2*Math.sin(o.rotation)}}function SS(o,t,n){const a=n.x+(o.x-n.x)*Math.cos(t)-(o.y-n.y)*Math.sin(t),r=n.y+(o.x-n.x)*Math.sin(t)+(o.y-n.y)*Math.cos(t);return{...o,rotation:o.rotation+t,x:a,y:r}}function _6(o,t){const n=b6(o);return SS(o,t,n)}function E6(o,t,n){let a=t;for(let r=0;r<o.length;r++){const l=Ft.getAngle(o[r]),c=Math.abs(l-t)%(Math.PI*2);Math.min(c,Math.PI*2-c)<n&&(a=l)}return a}let Pm=0;class ln extends hf{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(p6,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return pt.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return yS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const n=t.filter(r=>r.isAncestorOf(this)?(pt.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=n,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){const c=r._attrsAffectingSize.map(d=>d+"Change."+this._getEventNamespace()).join(" ");r.on(c,l)}r.on(m6.map(c=>c+`.${this._getEventNamespace()}`).join(" "),l),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let n;t.on(`dragstart.${this._getEventNamespace()}`,a=>{n=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(a,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,a=>{if(!n)return;const r=t.getAbsolutePosition(),l=r.x-n.x,c=r.y-n.y;this.nodes().forEach(d=>{if(d===t||d.isDragging())return;const g=d.getAbsolutePosition();d.setAbsolutePosition({x:g.x+l,y:g.y+c}),d.startDrag(a)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache($y),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache($y,this.__getNodeRect)}__getNodeShape(t,n=this.rotation(),a){const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=t.getAbsoluteScale(a),c=t.getAbsolutePosition(a),d=r.x*l.x-t.offsetX()*l.x,g=r.y*l.y-t.offsetY()*l.y,m=(Ft.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),S={x:c.x+d*Math.cos(m)+g*Math.sin(-m),y:c.y+g*Math.cos(m)+d*Math.sin(m),width:r.width*l.x,height:r.height*l.y,rotation:m};return SS(S,-Ft.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const S=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),C=[{x:S.x,y:S.y},{x:S.x+S.width,y:S.y},{x:S.x+S.width,y:S.y+S.height},{x:S.x,y:S.y+S.height}],E=m.getAbsoluteTransform();C.forEach(function(R){const v=E.point(R);n.push(v)})});const a=new Ji;a.rotate(-Ft.getAngle(this.rotation()));let r=1/0,l=1/0,c=-1/0,d=-1/0;n.forEach(function(m){const S=a.point(m);r===void 0&&(r=c=S.x,l=d=S.y),r=Math.min(r,S.x),l=Math.min(l,S.y),c=Math.max(c,S.x),d=Math.max(d,S.y)}),a.invert();const g=a.point({x:r,y:l});return{x:g.x,y:g.y,width:c-r,height:d-l,rotation:Ft.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Sg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const n=new bh({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:y6?10:"auto"}),a=this;n.on("mousedown touchstart",function(r){a._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{const r=Ft.getAngle(this.rotation()),l=this.rotateAnchorCursor(),c=S6(t,r,l);n.getStage().content&&(n.getStage().content.style.cursor=c),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const t=new Lt({name:"back",width:0,height:0,sceneFunc(n,a){const r=a.getParent(),l=r.padding();n.beginPath(),n.rect(-l,-l,a.width()+l*2,a.height()+l*2),n.moveTo(a.width()/2,-l),r.rotateEnabled()&&r.rotateLineVisible()&&n.lineTo(a.width()/2,-r.rotateAnchorOffset()*pt._sign(a.height())-l),n.fillStrokeShape(a)},hitFunc:(n,a)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();n.beginPath(),n.rect(-r,-r,a.width()+r*2,a.height()+r*2),n.fillStrokeShape(a)}});this.add(t),this._proxyDrag(t),t.on("dragstart",n=>{n.cancelBubble=!0}),t.on("dragmove",n=>{n.cancelBubble=!0}),t.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const n=this._getNodeRect(),a=n.width,r=n.height,l=Math.sqrt(Math.pow(a,2)+Math.pow(r,2));this.sin=Math.abs(r/l),this.cos=Math.abs(a/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const c=t.target.getAbsolutePosition(),d=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:d.x-c.x,y:d.y-c.y},Pm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:t.evt,target:g})})}_handleMouseMove(t){let n,a,r;const l=this.findOne("."+this._movingAnchorName),c=l.getStage();c.setPointersPositions(t);const d=c.getPointerPosition();let g={x:d.x-this._anchorDragOffset.x,y:d.y-this._anchorDragOffset.y};const m=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,t)),l.setAbsolutePosition(g);const S=l.getAbsolutePosition();if(m.x===S.x&&m.y===S.y)return;if(this._movingAnchorName==="rotater"){const j=this._getNodeRect();n=l.x()-j.width/2,a=-l.y()+j.height/2;let x=Math.atan2(-a,n)+Math.PI/2;j.height<0&&(x-=Math.PI);const O=Ft.getAngle(this.rotation())+x,T=Ft.getAngle(this.rotationSnapTolerance()),y=E6(this.rotationSnaps(),O,T)-j.rotation,B=_6(j,y);this._fitNodesInto(B,t);return}const C=this.shiftBehavior();let E;C==="inverted"?E=this.keepRatio()&&!t.shiftKey:C==="none"?E=this.keepRatio():E=this.keepRatio()||t.shiftKey;let R=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(E){const j=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(j.x-l.x(),2)+Math.pow(j.y-l.y(),2));const x=this.findOne(".top-left").x()>j.x?-1:1,L=this.findOne(".top-left").y()>j.y?-1:1;n=r*this.cos*x,a=r*this.sin*L,this.findOne(".top-left").x(j.x-n),this.findOne(".top-left").y(j.y-a)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(E){const j=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(l.x()-j.x,2)+Math.pow(j.y-l.y(),2));const x=this.findOne(".top-right").x()<j.x?-1:1,L=this.findOne(".top-right").y()>j.y?-1:1;n=r*this.cos*x,a=r*this.sin*L,this.findOne(".top-right").x(j.x+n),this.findOne(".top-right").y(j.y-a)}var v=l.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(E){const j=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(j.x-l.x(),2)+Math.pow(l.y()-j.y,2));const x=j.x<l.x()?-1:1,L=l.y()<j.y?-1:1;n=r*this.cos*x,a=r*this.sin*L,l.x(j.x-n),l.y(j.y+a)}v=l.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(E){const j=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(l.x()-j.x,2)+Math.pow(l.y()-j.y,2));const x=this.findOne(".bottom-right").x()<j.x?-1:1,L=this.findOne(".bottom-right").y()<j.y?-1:1;n=r*this.cos*x,a=r*this.sin*L,this.findOne(".bottom-right").x(j.x+n),this.findOne(".bottom-right").y(j.y+a)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(R=this.centeredScaling()||t.altKey,R){const j=this.findOne(".top-left"),x=this.findOne(".bottom-right"),L=j.x(),O=j.y(),T=this.getWidth()-x.x(),A=this.getHeight()-x.y();x.move({x:-L,y:-O}),j.move({x:T,y:A})}const M=this.findOne(".top-left").getAbsolutePosition();n=M.x,a=M.y;const z=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),P=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:a,width:z,height:P,rotation:Ft.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const a=this.getNode();Pm--,this._fire("transformend",{evt:t,target:a}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),a&&this._nodes.forEach(r=>{var l;r._fire("transformend",{evt:t,target:r}),(l=r.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,n){const a=this._getNodeRect(),r=1;if(pt._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(pt._inRange(t.height,-this.padding()*2-r,r)){this.update();return}const l=new Ji;if(l.rotate(Ft.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=l.point({x:-this.padding()*2,y:0});t.x+=E.x,t.y+=E.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=l.point({x:0,y:-this.padding()*2});t.x+=E.x,t.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(a,t);E?t=E:pt.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const c=1e7,d=new Ji;d.translate(a.x,a.y),d.rotate(a.rotation),d.scale(a.width/c,a.height/c);const g=new Ji,m=t.width/c,S=t.height/c;this.flipEnabled()===!1?(g.translate(t.x,t.y),g.rotate(t.rotation),g.translate(t.width<0?t.width:0,t.height<0?t.height:0),g.scale(Math.abs(m),Math.abs(S))):(g.translate(t.x,t.y),g.rotate(t.rotation),g.scale(m,S));const C=g.multiply(d.invert());this._nodes.forEach(E=>{var R;if(!E.getStage())return;const v=E.getParent().getAbsoluteTransform(),M=E.getTransform().copy();M.translate(E.offsetX(),E.offsetY());const z=new Ji;z.multiply(v.copy().invert()).multiply(C).multiply(v).multiply(M);const P=z.decompose();E.setAttrs(P),(R=E.getLayer())===null||R===void 0||R.batchDraw()}),this.rotation(pt._getRotation(t.rotation)),this._nodes.forEach(E=>{this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,n){this.findOne(t).setAttrs(n)}update(){var t;const n=this._getNodeRect();this.rotation(pt._getRotation(n.rotation));const a=n.width,r=n.height,l=this.enabledAnchors(),c=this.resizeEnabled(),d=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(C=>{C.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+d,offsetY:g/2+d,visible:c&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:a/2,y:0,offsetY:g/2+d,visible:c&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:a,y:0,offsetX:g/2-d,offsetY:g/2+d,visible:c&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:g/2+d,visible:c&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:a,y:r/2,offsetX:g/2-d,visible:c&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:g/2+d,offsetY:g/2-d,visible:c&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:a/2,y:r,offsetY:g/2-d,visible:c&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:a,y:r,offsetX:g/2-d,offsetY:g/2-d,visible:c&&l.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:a/2,y:-this.rotateAnchorOffset()*pt._sign(r)-d,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:a,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(C=>C.draggable()),x:0,y:0});const S=this.anchorStyleFunc();S&&m.forEach(C=>{S(C)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),hf.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Vt.prototype.toObject.call(this)}clone(t){return Vt.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}ln.isTransforming=()=>Pm>0;function C6(o){return o instanceof Array||pt.warn("enabledAnchors value should be an array"),o instanceof Array&&o.forEach(function(t){Sg.indexOf(t)===-1&&pt.warn("Unknown anchor name: "+t+". Available names are: "+Sg.join(", "))}),o||[]}ln.prototype.className="Transformer";ua(ln);ot.addGetterSetter(ln,"enabledAnchors",Sg,C6);ot.addGetterSetter(ln,"flipEnabled",!0,$r());ot.addGetterSetter(ln,"resizeEnabled",!0);ot.addGetterSetter(ln,"anchorSize",10,Kt());ot.addGetterSetter(ln,"rotateEnabled",!0);ot.addGetterSetter(ln,"rotateLineVisible",!0);ot.addGetterSetter(ln,"rotationSnaps",[]);ot.addGetterSetter(ln,"rotateAnchorOffset",50,Kt());ot.addGetterSetter(ln,"rotateAnchorCursor","crosshair");ot.addGetterSetter(ln,"rotationSnapTolerance",5,Kt());ot.addGetterSetter(ln,"borderEnabled",!0);ot.addGetterSetter(ln,"anchorStroke","rgb(0, 161, 255)");ot.addGetterSetter(ln,"anchorStrokeWidth",1,Kt());ot.addGetterSetter(ln,"anchorFill","white");ot.addGetterSetter(ln,"anchorCornerRadius",0,Kt());ot.addGetterSetter(ln,"borderStroke","rgb(0, 161, 255)");ot.addGetterSetter(ln,"borderStrokeWidth",1,Kt());ot.addGetterSetter(ln,"borderDash");ot.addGetterSetter(ln,"keepRatio",!0);ot.addGetterSetter(ln,"shiftBehavior","default");ot.addGetterSetter(ln,"centeredScaling",!1);ot.addGetterSetter(ln,"ignoreStroke",!1);ot.addGetterSetter(ln,"padding",0,Kt());ot.addGetterSetter(ln,"nodes");ot.addGetterSetter(ln,"node");ot.addGetterSetter(ln,"boundBoxFunc");ot.addGetterSetter(ln,"anchorDragBoundFunc");ot.addGetterSetter(ln,"anchorStyleFunc");ot.addGetterSetter(ln,"shouldOverdrawWholeArea",!1);ot.addGetterSetter(ln,"useSingleNodeRotation",!0);ot.backCompat(ln,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class wo extends Lt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Ft.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}wo.prototype.className="Wedge";wo.prototype._centroid=!0;wo.prototype._attrsAffectingSize=["radius"];ua(wo);ot.addGetterSetter(wo,"radius",0,Kt());ot.addGetterSetter(wo,"angle",0,Kt());ot.addGetterSetter(wo,"clockwise",!1);ot.backCompat(wo,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function t1(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const T6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],A6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function w6(o,t){const n=o.data,a=o.width,r=o.height;let l,c,d,g,m,S,C,E,R,v,M,z,P,j,x,L,O,T,A,y;const B=t+t+1,U=a-1,I=r-1,K=t+1,Q=K*(K+1)/2,X=new t1,Y=T6[t],D=A6[t];let H=null,F=X,tt=null,at=null;for(let Z=1;Z<B;Z++)F=F.next=new t1,Z===K&&(H=F);F.next=X,d=c=0;for(let Z=0;Z<r;Z++){z=P=j=x=g=m=S=C=0,E=K*(L=n[c]),R=K*(O=n[c+1]),v=K*(T=n[c+2]),M=K*(A=n[c+3]),g+=Q*L,m+=Q*O,S+=Q*T,C+=Q*A,F=X;for(let it=0;it<K;it++)F.r=L,F.g=O,F.b=T,F.a=A,F=F.next;for(let it=1;it<K;it++)l=c+((U<it?U:it)<<2),g+=(F.r=L=n[l])*(y=K-it),m+=(F.g=O=n[l+1])*y,S+=(F.b=T=n[l+2])*y,C+=(F.a=A=n[l+3])*y,z+=L,P+=O,j+=T,x+=A,F=F.next;tt=X,at=H;for(let it=0;it<a;it++)n[c+3]=A=C*Y>>D,A!==0?(A=255/A,n[c]=(g*Y>>D)*A,n[c+1]=(m*Y>>D)*A,n[c+2]=(S*Y>>D)*A):n[c]=n[c+1]=n[c+2]=0,g-=E,m-=R,S-=v,C-=M,E-=tt.r,R-=tt.g,v-=tt.b,M-=tt.a,l=d+((l=it+t+1)<U?l:U)<<2,z+=tt.r=n[l],P+=tt.g=n[l+1],j+=tt.b=n[l+2],x+=tt.a=n[l+3],g+=z,m+=P,S+=j,C+=x,tt=tt.next,E+=L=at.r,R+=O=at.g,v+=T=at.b,M+=A=at.a,z-=L,P-=O,j-=T,x-=A,at=at.next,c+=4;d+=a}for(let Z=0;Z<a;Z++){P=j=x=z=m=S=C=g=0,c=Z<<2,E=K*(L=n[c]),R=K*(O=n[c+1]),v=K*(T=n[c+2]),M=K*(A=n[c+3]),g+=Q*L,m+=Q*O,S+=Q*T,C+=Q*A,F=X;for(let st=0;st<K;st++)F.r=L,F.g=O,F.b=T,F.a=A,F=F.next;let it=a;for(let st=1;st<=t;st++)c=it+Z<<2,g+=(F.r=L=n[c])*(y=K-st),m+=(F.g=O=n[c+1])*y,S+=(F.b=T=n[c+2])*y,C+=(F.a=A=n[c+3])*y,z+=L,P+=O,j+=T,x+=A,F=F.next,st<I&&(it+=a);c=Z,tt=X,at=H;for(let st=0;st<r;st++)l=c<<2,n[l+3]=A=C*Y>>D,A>0?(A=255/A,n[l]=(g*Y>>D)*A,n[l+1]=(m*Y>>D)*A,n[l+2]=(S*Y>>D)*A):n[l]=n[l+1]=n[l+2]=0,g-=E,m-=R,S-=v,C-=M,E-=tt.r,R-=tt.g,v-=tt.b,M-=tt.a,l=Z+((l=st+K)<I?l:I)*a<<2,g+=z+=tt.r=n[l],m+=P+=tt.g=n[l+1],S+=j+=tt.b=n[l+2],C+=x+=tt.a=n[l+3],tt=tt.next,E+=L=at.r,R+=O=at.g,v+=T=at.b,M+=A=at.a,z-=L,P-=O,j-=T,x-=A,at=at.next,c+=a}}const R6=function(t){const n=Math.round(this.blurRadius());n>0&&w6(t,n)};ot.addGetterSetter(Vt,"blurRadius",0,Kt(),ot.afterSetFilter);const O6=function(o){const t=this.brightness()*255,n=o.data,a=n.length;for(let r=0;r<a;r+=4)n[r]+=t,n[r+1]+=t,n[r+2]+=t};ot.addGetterSetter(Vt,"brightness",0,Kt(),ot.afterSetFilter);const x6=function(o){const t=this.brightness(),n=o.data,a=n.length;for(let r=0;r<a;r+=4)n[r]=Math.min(255,n[r]*t),n[r+1]=Math.min(255,n[r+1]*t),n[r+2]=Math.min(255,n[r+2]*t)},N6=function(o){const t=Math.pow((this.contrast()+100)/100,2),n=o.data,a=n.length;let r=150,l=150,c=150;for(let d=0;d<a;d+=4)r=n[d],l=n[d+1],c=n[d+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,l/=255,l-=.5,l*=t,l+=.5,l*=255,c/=255,c-=.5,c*=t,c+=.5,c*=255,r=r<0?0:r>255?255:r,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,n[d]=r,n[d+1]=l,n[d+2]=c};ot.addGetterSetter(Vt,"contrast",0,Kt(),ot.afterSetFilter);const M6=function(o){var t,n,a,r,l,c,d,g,m;const S=o.data,C=o.width,E=o.height,R=Math.min(1,Math.max(0,(n=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:.5)),v=Math.min(1,Math.max(0,(r=(a=this.embossWhiteLevel)===null||a===void 0?void 0:a.call(this))!==null&&r!==void 0?r:.5)),z=(d={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(c=(l=this.embossDirection)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0?c:"top-left"])!==null&&d!==void 0?d:315,P=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),j=R*10,x=v*255,L=z*Math.PI/180,O=Math.cos(L),T=Math.sin(L),A=128/1020*j,y=new Uint8ClampedArray(S),B=new Float32Array(C*E);for(let X=0,Y=0;Y<S.length;Y+=4,X++)B[X]=.2126*y[Y]+.7152*y[Y+1]+.0722*y[Y+2];const U=[-1,0,1,-2,0,2,-1,0,1],I=[-1,-2,-1,0,0,0,1,2,1],K=[-C-1,-C,-C+1,-1,0,1,C-1,C,C+1],Q=X=>X<0?0:X>255?255:X;for(let X=1;X<E-1;X++)for(let Y=1;Y<C-1;Y++){const D=X*C+Y;let H=0,F=0;H+=B[D+K[0]]*U[0],F+=B[D+K[0]]*I[0],H+=B[D+K[1]]*U[1],F+=B[D+K[1]]*I[1],H+=B[D+K[2]]*U[2],F+=B[D+K[2]]*I[2],H+=B[D+K[3]]*U[3],F+=B[D+K[3]]*I[3],H+=B[D+K[5]]*U[5],F+=B[D+K[5]]*I[5],H+=B[D+K[6]]*U[6],F+=B[D+K[6]]*I[6],H+=B[D+K[7]]*U[7],F+=B[D+K[7]]*I[7],H+=B[D+K[8]]*U[8],F+=B[D+K[8]]*I[8];const tt=O*H+T*F,at=Q(x+tt*A),Z=D*4;if(P){const it=at-x;S[Z]=Q(y[Z]+it),S[Z+1]=Q(y[Z+1]+it),S[Z+2]=Q(y[Z+2]+it),S[Z+3]=y[Z+3]}else S[Z]=S[Z+1]=S[Z+2]=at,S[Z+3]=y[Z+3]}for(let X=0;X<C;X++){let Y=X*4,D=((E-1)*C+X)*4;S[Y]=y[Y],S[Y+1]=y[Y+1],S[Y+2]=y[Y+2],S[Y+3]=y[Y+3],S[D]=y[D],S[D+1]=y[D+1],S[D+2]=y[D+2],S[D+3]=y[D+3]}for(let X=1;X<E-1;X++){let Y=X*C*4,D=(X*C+(C-1))*4;S[Y]=y[Y],S[Y+1]=y[Y+1],S[Y+2]=y[Y+2],S[Y+3]=y[Y+3],S[D]=y[D],S[D+1]=y[D+1],S[D+2]=y[D+2],S[D+3]=y[D+3]}return o};ot.addGetterSetter(Vt,"embossStrength",.5,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"embossWhiteLevel",.5,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"embossDirection","top-left",void 0,ot.afterSetFilter);ot.addGetterSetter(Vt,"embossBlend",!1,void 0,ot.afterSetFilter);function Bp(o,t,n,a,r){const l=n-t,c=r-a;if(l===0)return a+c/2;if(c===0)return a;let d=(o-t)/l;return d=c*d+a,d}const D6=function(o){const t=o.data,n=t.length;let a=t[0],r=a,l,c=t[1],d=c,g,m=t[2],S=m,C;const E=this.enhance();if(E===0)return;for(let x=0;x<n;x+=4)l=t[x+0],l<a?a=l:l>r&&(r=l),g=t[x+1],g<c?c=g:g>d&&(d=g),C=t[x+2],C<m?m=C:C>S&&(S=C);r===a&&(r=255,a=0),d===c&&(d=255,c=0),S===m&&(S=255,m=0);let R,v,M,z,P,j;if(E>0)R=r+E*(255-r),v=a-E*(a-0),M=d+E*(255-d),z=c-E*(c-0),P=S+E*(255-S),j=m-E*(m-0);else{const x=(r+a)*.5;R=r+E*(r-x),v=a+E*(a-x);const L=(d+c)*.5;M=d+E*(d-L),z=c+E*(c-L);const O=(S+m)*.5;P=S+E*(S-O),j=m+E*(m-O)}for(let x=0;x<n;x+=4)t[x+0]=Bp(t[x+0],a,r,v,R),t[x+1]=Bp(t[x+1],c,d,z,M),t[x+2]=Bp(t[x+2],m,S,j,P)};ot.addGetterSetter(Vt,"enhance",0,Kt(),ot.afterSetFilter);const j6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4){const r=.34*t[a]+.5*t[a+1]+.16*t[a+2];t[a]=r,t[a+1]=r,t[a+2]=r}};ot.addGetterSetter(Vt,"hue",0,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"saturation",0,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"luminance",0,Kt(),ot.afterSetFilter);const U6=function(o){const t=o.data,n=t.length,a=1,r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=this.luminance()*127,d=a*r*Math.cos(l*Math.PI/180),g=a*r*Math.sin(l*Math.PI/180),m=.299*a+.701*d+.167*g,S=.587*a-.587*d+.33*g,C=.114*a-.114*d-.497*g,E=.299*a-.299*d-.328*g,R=.587*a+.413*d+.035*g,v=.114*a-.114*d+.293*g,M=.299*a-.3*d+1.25*g,z=.587*a-.586*d-1.05*g,P=.114*a+.886*d-.2*g;let j,x,L,O;for(let T=0;T<n;T+=4)j=t[T+0],x=t[T+1],L=t[T+2],O=t[T+3],t[T+0]=m*j+S*x+C*L+c,t[T+1]=E*j+R*x+v*L+c,t[T+2]=M*j+z*x+P*L+c,t[T+3]=O},B6=function(o){const t=o.data,n=t.length,a=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=a*r*Math.cos(l*Math.PI/180),d=a*r*Math.sin(l*Math.PI/180),g=.299*a+.701*c+.167*d,m=.587*a-.587*c+.33*d,S=.114*a-.114*c-.497*d,C=.299*a-.299*c-.328*d,E=.587*a+.413*c+.035*d,R=.114*a-.114*c+.293*d,v=.299*a-.3*c+1.25*d,M=.587*a-.586*c-1.05*d,z=.114*a+.886*c-.2*d;for(let P=0;P<n;P+=4){const j=t[P+0],x=t[P+1],L=t[P+2],O=t[P+3];t[P+0]=g*j+m*x+S*L,t[P+1]=C*j+E*x+R*L,t[P+2]=v*j+M*x+z*L,t[P+3]=O}};ot.addGetterSetter(Vt,"hue",0,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"saturation",0,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"value",0,Kt(),ot.afterSetFilter);const z6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4)t[a]=255-t[a],t[a+1]=255-t[a+1],t[a+2]=255-t[a+2]},L6=function(o,t,n){const a=o.data,r=t.data,l=o.width,c=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||c/2;let m=Math.sqrt(d*d+g*g),S=l-d,C=c-g;const E=Math.sqrt(S*S+C*C);m=E>m?E:m;const R=c,v=l,M=360/v*Math.PI/180;for(let z=0;z<v;z+=1){const P=Math.sin(z*M),j=Math.cos(z*M);for(let x=0;x<R;x+=1){S=Math.floor(d+m*x/R*j),C=Math.floor(g+m*x/R*P);let L=(C*l+S)*4;const O=a[L+0],T=a[L+1],A=a[L+2],y=a[L+3];L=(z+x*l)*4,r[L+0]=O,r[L+1]=T,r[L+2]=A,r[L+3]=y}}},P6=function(o,t,n){const a=o.data,r=t.data,l=o.width,c=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||c/2;let m=Math.sqrt(d*d+g*g),S=l-d,C=c-g;const E=Math.sqrt(S*S+C*C);m=E>m?E:m;const R=c,v=l,M=0;let z,P;for(S=0;S<l;S+=1)for(C=0;C<c;C+=1){const j=S-d,x=C-g,L=Math.sqrt(j*j+x*x)*R/m;let O=(Math.atan2(x,j)*180/Math.PI+360+M)%360;O=O*v/360,z=Math.floor(O),P=Math.floor(L);let T=(P*l+z)*4;const A=a[T+0],y=a[T+1],B=a[T+2],U=a[T+3];T=(C*l+S)*4,r[T+0]=A,r[T+1]=y,r[T+2]=B,r[T+3]=U}},I6=function(o){const t=o.width,n=o.height;let a,r,l,c,d,g,m,S,C,E,R=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),M=Math.floor(t*(v%360)/360);if(R<1)return;const z=pt.createCanvasElement();z.width=t,z.height=n;const P=z.getContext("2d").getImageData(0,0,t,n);pt.releaseCanvas(z),L6(o,P,{polarCenterX:t/2,polarCenterY:n/2});let j=t/Math.pow(2,R);for(;j<=8;)j=j*2,R-=1;j=Math.ceil(j);let x=j,L=0,O=x,T=1;for(M+j>t&&(L=x,O=0,T=-1),r=0;r<n;r+=1)for(a=L;a!==O;a+=T)l=Math.round(a+M)%t,C=(t*r+l)*4,d=P.data[C+0],g=P.data[C+1],m=P.data[C+2],S=P.data[C+3],E=(t*r+a)*4,P.data[E+0]=d,P.data[E+1]=g,P.data[E+2]=m,P.data[E+3]=S;for(r=0;r<n;r+=1)for(x=Math.floor(j),c=0;c<R;c+=1){for(a=0;a<x+1;a+=1)C=(t*r+a)*4,d=P.data[C+0],g=P.data[C+1],m=P.data[C+2],S=P.data[C+3],E=(t*r+x*2-a-1)*4,P.data[E+0]=d,P.data[E+1]=g,P.data[E+2]=m,P.data[E+3]=S;x*=2}P6(P,o,{})};ot.addGetterSetter(Vt,"kaleidoscopePower",2,Kt(),ot.afterSetFilter);ot.addGetterSetter(Vt,"kaleidoscopeAngle",0,Kt(),ot.afterSetFilter);function ng(o,t,n){let a=(n*o.width+t)*4;const r=[];return r.push(o.data[a++],o.data[a++],o.data[a++],o.data[a++]),r}function Wd(o,t){return Math.sqrt(Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)+Math.pow(o[2]-t[2],2))}function G6(o){const t=[0,0,0];for(let n=0;n<o.length;n++)t[0]+=o[n][0],t[1]+=o[n][1],t[2]+=o[n][2];return t[0]/=o.length,t[1]/=o.length,t[2]/=o.length,t}function H6(o,t){const n=ng(o,0,0),a=ng(o,o.width-1,0),r=ng(o,0,o.height-1),l=ng(o,o.width-1,o.height-1),c=t||10;if(Wd(n,a)<c&&Wd(a,l)<c&&Wd(l,r)<c&&Wd(r,n)<c){const d=G6([a,n,l,r]),g=[];for(let m=0;m<o.width*o.height;m++){const S=Wd(d,[o.data[m*4],o.data[m*4+1],o.data[m*4+2]]);g[m]=S<c?0:255}return g}}function k6(o,t){for(let n=0;n<o.width*o.height;n++)o.data[4*n+3]=t[n]}function q6(o,t,n){const a=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let S=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const M=R*t+v,z=a[C*r+E];S+=o[M]*z}}c[m]=S===2040?255:0}return c}function V6(o,t,n){const a=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let S=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const M=R*t+v,z=a[C*r+E];S+=o[M]*z}}c[m]=S>=1020?255:0}return c}function Y6(o,t,n){const a=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let S=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const M=R*t+v,z=a[C*r+E];S+=o[M]*z}}c[m]=S}return c}const K6=function(o){const t=this.threshold();let n=H6(o,t);return n&&(n=q6(n,o.width,o.height),n=V6(n,o.width,o.height),n=Y6(n,o.width,o.height),k6(o,n)),o};ot.addGetterSetter(Vt,"threshold",0,Kt(),ot.afterSetFilter);const Q6=function(o){const t=this.noise()*255,n=o.data,a=n.length,r=t/2;for(let l=0;l<a;l+=4)n[l+0]+=r-2*r*Math.random(),n[l+1]+=r-2*r*Math.random(),n[l+2]+=r-2*r*Math.random()};ot.addGetterSetter(Vt,"noise",.2,Kt(),ot.afterSetFilter);const X6=function(o){let t=Math.ceil(this.pixelSize()),n=o.width,a=o.height,r=Math.ceil(n/t),l=Math.ceil(a/t),c=o.data;if(t<=0){pt.error("pixelSize value can not be <= 0");return}for(let d=0;d<r;d+=1)for(let g=0;g<l;g+=1){let m=0,S=0,C=0,E=0;const R=d*t,v=R+t,M=g*t,z=M+t;let P=0;for(let j=R;j<v;j+=1)if(!(j>=n))for(let x=M;x<z;x+=1){if(x>=a)continue;const L=(n*x+j)*4;m+=c[L+0],S+=c[L+1],C+=c[L+2],E+=c[L+3],P+=1}m=m/P,S=S/P,C=C/P,E=E/P;for(let j=R;j<v;j+=1)if(!(j>=n))for(let x=M;x<z;x+=1){if(x>=a)continue;const L=(n*x+j)*4;c[L+0]=m,c[L+1]=S,c[L+2]=C,c[L+3]=E}}};ot.addGetterSetter(Vt,"pixelSize",8,Kt(),ot.afterSetFilter);const F6=function(o){const t=Math.round(this.levels()*254)+1,n=o.data,a=n.length,r=255/t;for(let l=0;l<a;l+=1)n[l]=Math.floor(n[l]/r)*r};ot.addGetterSetter(Vt,"levels",.5,Kt(),ot.afterSetFilter);const J6=function(o){const t=o.data,n=t.length,a=this.red(),r=this.green(),l=this.blue();for(let c=0;c<n;c+=4){const d=(.34*t[c]+.5*t[c+1]+.16*t[c+2])/255;t[c]=d*a,t[c+1]=d*r,t[c+2]=d*l,t[c+3]=t[c+3]}};ot.addGetterSetter(Vt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});ot.addGetterSetter(Vt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});ot.addGetterSetter(Vt,"blue",0,k2,ot.afterSetFilter);const Z6=function(o){const t=o.data,n=t.length,a=this.red(),r=this.green(),l=this.blue(),c=this.alpha();for(let d=0;d<n;d+=4){const g=1-c;t[d]=a*c+t[d]*g,t[d+1]=r*c+t[d+1]*g,t[d+2]=l*c+t[d+2]*g}};ot.addGetterSetter(Vt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});ot.addGetterSetter(Vt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});ot.addGetterSetter(Vt,"blue",0,k2,ot.afterSetFilter);ot.addGetterSetter(Vt,"alpha",1,function(o){return this._filterUpToDate=!1,o>1?1:o<0?0:o});const W6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4){const r=t[a+0],l=t[a+1],c=t[a+2];t[a+0]=Math.min(255,r*.393+l*.769+c*.189),t[a+1]=Math.min(255,r*.349+l*.686+c*.168),t[a+2]=Math.min(255,r*.272+l*.534+c*.131)}},$6=function(o){const n=o.data;for(let a=0;a<n.length;a+=4){const r=n[a],l=n[a+1],c=n[a+2];.2126*r+.7152*l+.0722*c>=128&&(n[a]=255-r,n[a+1]=255-l,n[a+2]=255-c)}return o},t_=function(o){const t=this.threshold()*255,n=o.data,a=n.length;for(let r=0;r<a;r+=1)n[r]=n[r]<t?0:255};ot.addGetterSetter(Vt,"threshold",.5,Kt(),ot.afterSetFilter);gf.Util._assign(gf,{Arc:To,Arrow:wu,Circle:_f,Ellipse:_l,Image:ts,Label:sv,Tag:Ru,Line:Ao,Path:Qn,Rect:bh,RegularPolygon:El,Ring:Ou,Sprite:xs,Star:Cl,Text:Wn,TextPath:La,Transformer:ln,Wedge:wo,Filters:{Blur:R6,Brightness:x6,Brighten:O6,Contrast:N6,Emboss:M6,Enhance:D6,Grayscale:j6,HSL:U6,HSV:B6,Invert:z6,Kaleidoscope:I6,Mask:K6,Noise:Q6,Pixelate:X6,Posterize:F6,RGB:J6,RGBA:Z6,Sepia:W6,Solarize:$6,Threshold:t_}});var zp={exports:{}},Lp={exports:{}},Pp={exports:{}},Ip={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function e_(){return e1||(e1=1,(function(o){function t(D,H){var F=D.length;D.push(H);t:for(;0<F;){var tt=F-1>>>1,at=D[tt];if(0<r(at,H))D[tt]=H,D[F]=at,F=tt;else break t}}function n(D){return D.length===0?null:D[0]}function a(D){if(D.length===0)return null;var H=D[0],F=D.pop();if(F!==H){D[0]=F;t:for(var tt=0,at=D.length,Z=at>>>1;tt<Z;){var it=2*(tt+1)-1,st=D[it],V=it+1,J=D[V];if(0>r(st,F))V<at&&0>r(J,st)?(D[tt]=J,D[V]=F,tt=V):(D[tt]=st,D[it]=F,tt=it);else if(V<at&&0>r(J,F))D[tt]=J,D[V]=F,tt=V;else break t}}return H}function r(D,H){var F=D.sortIndex-H.sortIndex;return F!==0?F:D.id-H.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],S=1,C=null,E=3,R=!1,v=!1,M=!1,z=!1,P=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function L(D){for(var H=n(m);H!==null;){if(H.callback===null)a(m);else if(H.startTime<=D)a(m),H.sortIndex=H.expirationTime,t(g,H);else break;H=n(m)}}function O(D){if(M=!1,L(D),!v)if(n(g)!==null)v=!0,T||(T=!0,K());else{var H=n(m);H!==null&&Y(O,H.startTime-D)}}var T=!1,A=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function I(){if(z=!1,T){var D=o.unstable_now();B=D;var H=!0;try{t:{v=!1,M&&(M=!1,j(A),A=-1),R=!0;var F=E;try{e:{for(L(D),C=n(g);C!==null&&!(C.expirationTime>D&&U());){var tt=C.callback;if(typeof tt=="function"){C.callback=null,E=C.priorityLevel;var at=tt(C.expirationTime<=D);if(D=o.unstable_now(),typeof at=="function"){C.callback=at,L(D),H=!0;break e}C===n(g)&&a(g),L(D)}else a(g);C=n(g)}if(C!==null)H=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-D),H=!1}}break t}finally{C=null,E=F,R=!1}H=void 0}}finally{H?K():T=!1}}}var K;if(typeof x=="function")K=function(){x(I)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=I,K=function(){X.postMessage(null)}}else K=function(){P(I,0)};function Y(D,H){A=P(function(){D(o.unstable_now())},H)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(D){D.callback=null},o.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<D?Math.floor(1e3/D):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(D){switch(E){case 1:case 2:case 3:var H=3;break;default:H=E}var F=E;E=H;try{return D()}finally{E=F}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(D,H){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=E;E=D;try{return H()}finally{E=F}},o.unstable_scheduleCallback=function(D,H,F){var tt=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?tt+F:tt):F=tt,D){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=F+at,D={id:S++,callback:H,priorityLevel:D,startTime:F,expirationTime:at,sortIndex:-1},F>tt?(D.sortIndex=F,t(m,D),n(g)===null&&D===n(m)&&(M?(j(A),A=-1):M=!0,Y(O,F-tt))):(D.sortIndex=at,t(g,D),v||R||(v=!0,T||(T=!0,K()))),D},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(D){var H=E;return function(){var F=E;E=H;try{return D.apply(this,arguments)}finally{E=F}}}})(Ip)),Ip}var n1;function n_(){return n1||(n1=1,Pp.exports=e_()),Pp.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a1;function a_(){return a1||(a1=1,(function(o){o.exports=function(t){function n(s,u,p,b){return new fc(s,u,p,b)}function a(){}function r(s){var u="https://react.dev/errors/"+s;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){var u=s,p=s;if(s.alternate)for(;u.return;)u=u.return;else{s=u;do u=s,(u.flags&4098)!==0&&(p=u.return),s=u.return;while(s)}return u.tag===3?p:null}function c(s){if(l(s)!==s)throw Error(r(188))}function d(s){var u=s.alternate;if(!u){if(u=l(s),u===null)throw Error(r(188));return u!==s?null:s}for(var p=s,b=u;;){var N=p.return;if(N===null)break;var G=N.alternate;if(G===null){if(b=N.return,b!==null){p=b;continue}break}if(N.child===G.child){for(G=N.child;G;){if(G===p)return c(N),s;if(G===b)return c(N),u;G=G.sibling}throw Error(r(188))}if(p.return!==b.return)p=N,b=G;else{for(var et=!1,ut=N.child;ut;){if(ut===p){et=!0,p=N,b=G;break}if(ut===b){et=!0,b=N,p=G;break}ut=ut.sibling}if(!et){for(ut=G.child;ut;){if(ut===p){et=!0,p=G,b=N;break}if(ut===b){et=!0,b=G,p=N;break}ut=ut.sibling}if(!et)throw Error(r(189))}}if(p.alternate!==b)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:u}function g(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(u=g(s),u!==null)return u;s=s.sibling}return null}function m(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(s.tag!==4&&(u=m(s),u!==null))return u;s=s.sibling}return null}function S(s){return s===null||typeof s!="object"?null:(s=Wl&&s[Wl]||s["@@iterator"],typeof s=="function"?s:null)}function C(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===$l?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case Vs:return"Fragment";case Fl:return"Profiler";case Ys:return"StrictMode";case Br:return"Suspense";case zr:return"SuspenseList";case hs:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case jr:return"Portal";case Ur:return(s.displayName||"Context")+".Provider";case Jl:return(s._context.displayName||"Context")+".Consumer";case mc:var u=s.render;return s=s.displayName,s||(s=u.displayName||u.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case vc:return u=s.displayName||null,u!==null?u:C(s.type)||"Memo";case Lr:u=s._payload,s=s._init;try{return C(s(u))}catch{}}return null}function E(s){return{current:s}}function R(s){0>Ws||(s.current=su[Ws],su[Ws]=null,Ws--)}function v(s,u){Ws++,su[Ws]=s.current,s.current=u}function M(s){return s>>>=0,s===0?32:31-(_0(s)/E0|0)|0}function z(s){var u=s&42;if(u!==0)return u;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function P(s,u,p){var b=s.pendingLanes;if(b===0)return 0;var N=0,G=s.suspendedLanes,et=s.pingedLanes;s=s.warmLanes;var ut=b&134217727;return ut!==0?(b=ut&~G,b!==0?N=z(b):(et&=ut,et!==0?N=z(et):p||(p=ut&~s,p!==0&&(N=z(p))))):(ut=b&~G,ut!==0?N=z(ut):et!==0?N=z(et):p||(p=b&~s,p!==0&&(N=z(p)))),N===0?0:u!==0&&u!==N&&(u&G)===0&&(G=N&-N,p=u&-u,G>=p||G===32&&(p&4194048)!==0)?u:N}function j(s,u){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&u)===0}function x(s,u){switch(s){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L(){var s=gr;return gr<<=1,(gr&4194048)===0&&(gr=256),s}function O(){var s=ou;return ou<<=1,(ou&62914560)===0&&(ou=4194304),s}function T(s){for(var u=[],p=0;31>p;p++)u.push(s);return u}function A(s,u){s.pendingLanes|=u,u!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function y(s,u,p,b,N,G){var et=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ut=s.entanglements,St=s.expirationTimes,Bt=s.hiddenUpdates;for(p=et&~p;0<p;){var It=31-Fa(p),Wt=1<<It;ut[It]=0,St[It]=-1;var ne=Bt[It];if(ne!==null)for(Bt[It]=null,It=0;It<ne.length;It++){var je=ne[It];je!==null&&(je.lane&=-536870913)}p&=~Wt}b!==0&&B(s,b,0),G!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=G&~(et&~u))}function B(s,u,p){s.pendingLanes|=u,s.suspendedLanes&=~u;var b=31-Fa(u);s.entangledLanes|=u,s.entanglements[b]=s.entanglements[b]|1073741824|p&4194090}function U(s,u){var p=s.entangledLanes|=u;for(s=s.entanglements;p;){var b=31-Fa(p),N=1<<b;N&u|s[b]&u&&(s[b]|=u),p&=~N}}function I(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function K(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Q(s){if(typeof ga=="function"&&Ma(s),oi&&typeof oi.setStrictMode=="function")try{oi.setStrictMode(Jo,s)}catch{}}function X(s){if(Uc===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Uc=u&&u[1]||"",Nd=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Uc+s+Nd}function Y(s,u){if(!s||$s)return"";$s=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(u){var Wt=function(){throw Error()};if(Object.defineProperty(Wt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Wt,[])}catch(je){var ne=je}Reflect.construct(s,[],Wt)}else{try{Wt.call()}catch(je){ne=je}s.call(Wt.prototype)}}else{try{throw Error()}catch(je){ne=je}(Wt=s())&&typeof Wt.catch=="function"&&Wt.catch(function(){})}}catch(je){if(je&&ne&&typeof je.stack=="string")return[je.stack,ne.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var G=b.DetermineComponentFrameRoot(),et=G[0],ut=G[1];if(et&&ut){var St=et.split(`
`),Bt=ut.split(`
`);for(N=b=0;b<St.length&&!St[b].includes("DetermineComponentFrameRoot");)b++;for(;N<Bt.length&&!Bt[N].includes("DetermineComponentFrameRoot");)N++;if(b===St.length||N===Bt.length)for(b=St.length-1,N=Bt.length-1;1<=b&&0<=N&&St[b]!==Bt[N];)N--;for(;1<=b&&0<=N;b--,N--)if(St[b]!==Bt[N]){if(b!==1||N!==1)do if(b--,N--,0>N||St[b]!==Bt[N]){var It=`
`+St[b].replace(" at new "," at ");return s.displayName&&It.includes("<anonymous>")&&(It=It.replace("<anonymous>",s.displayName)),It}while(1<=b&&0<=N);break}}}finally{$s=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?X(p):""}function D(s){switch(s.tag){case 26:case 27:case 5:return X(s.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return Y(s.type,!1);case 11:return Y(s.type.render,!1);case 1:return Y(s.type,!0);case 31:return X("Activity");default:return""}}function H(s){try{var u="";do u+=D(s),s=s.return;while(s);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function F(s,u){if(typeof s=="object"&&s!==null){var p=Md.get(s);return p!==void 0?p:(u={value:s,source:u,stack:H(u)},Md.set(s,u),u)}return{value:s,source:u,stack:H(u)}}function tt(s,u){Gr[to++]=eo,Gr[to++]=Bc,Bc=s,eo=u}function at(s,u,p){li[Ti++]=pr,li[Ti++]=Yi,li[Ti++]=bs,bs=s;var b=pr;s=Yi;var N=32-Fa(b)-1;b&=~(1<<N),p+=1;var G=32-Fa(u)+N;if(30<G){var et=N-N%5;G=(b&(1<<et)-1).toString(32),b>>=et,N-=et,pr=1<<32-Fa(u)+N|p<<N|b,Yi=G+s}else pr=1<<G|p<<N|b,Yi=s}function Z(s){s.return!==null&&(tt(s,1),at(s,1,0))}function it(s){for(;s===Bc;)Bc=Gr[--to],Gr[to]=null,eo=Gr[--to],Gr[to]=null;for(;s===bs;)bs=li[--Ti],li[Ti]=null,Yi=li[--Ti],li[Ti]=null,pr=li[--Ti],li[Ti]=null}function st(s,u){v(Hr,u),v(no,s),v(ma,null),s=sd(u),R(ma),v(ma,s)}function V(){R(ma),R(no),R(Hr)}function J(s){s.memoizedState!==null&&v(Zo,s);var u=ma.current,p=gs(u,s.type);u!==p&&(v(no,s),v(ma,p))}function W(s){no.current===s&&(R(ma),R(no)),Zo.current===s&&(R(Zo),lr?ji._currentValue=Ir:ji._currentValue2=Ir)}function nt(s){var u=Error(r(418,""));throw oe(F(u,s)),Qi}function dt(s,u){if(!qn)throw Error(r(175));u0(s.stateNode,s.type,s.memoizedProps,u,s)||nt(s)}function Rt(s){for(Sa=s.return;Sa;)switch(Sa.tag){case 5:case 13:Ki=!1;return;case 27:case 3:Ki=!0;return;default:Sa=Sa.return}}function Ut(s){if(!qn||s!==Sa)return!1;if(!un)return Rt(s),un=!0,!1;var u=s.tag;if(ia?u!==3&&u!==27&&(u!==5||Oc(s.type)&&!ms(s.type,s.memoizedProps))&&ra&&nt(s):u!==3&&(u!==5||Oc(s.type)&&!ms(s.type,s.memoizedProps))&&ra&&nt(s),Rt(s),u===13){if(!qn)throw Error(r(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));ra=c0(s)}else ra=ia&&u===27?r0(s.type,ra):Sa?bd(s.stateNode):null;return!0}function Xt(){qn&&(ra=Sa=null,un=!1)}function $t(){var s=kr;return s!==null&&(ka===null?ka=s:ka.push.apply(ka,s),kr=null),s}function oe(s){kr===null?kr=[s]:kr.push(s)}function kt(s,u){return s===u&&(s!==0||1/s===1/u)||s!==s&&u!==u}function Re(s,u,p){lr?(v(zc,u._currentValue),u._currentValue=p):(v(zc,u._currentValue2),u._currentValue2=p)}function Ee(s){var u=zc.current;lr?s._currentValue=u:s._currentValue2=u,R(zc)}function ze(s,u,p){for(;s!==null;){var b=s.alternate;if((s.childLanes&u)!==u?(s.childLanes|=u,b!==null&&(b.childLanes|=u)):b!==null&&(b.childLanes&u)!==u&&(b.childLanes|=u),s===p)break;s=s.return}}function Xe(s,u,p,b){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var G=N.dependencies;if(G!==null){var et=N.child;G=G.firstContext;t:for(;G!==null;){var ut=G;G=N;for(var St=0;St<u.length;St++)if(ut.context===u[St]){G.lanes|=p,ut=G.alternate,ut!==null&&(ut.lanes|=p),ze(G.return,p,s),b||(et=null);break t}G=ut.next}}else if(N.tag===18){if(et=N.return,et===null)throw Error(r(341));et.lanes|=p,G=et.alternate,G!==null&&(G.lanes|=p),ze(et,p,s),et=null}else et=N.child;if(et!==null)et.return=N;else for(et=N;et!==null;){if(et===s){et=null;break}if(N=et.sibling,N!==null){N.return=et.return,et=N;break}et=et.return}N=et}}function nn(s,u,p,b){s=null;for(var N=u,G=!1;N!==null;){if(!G){if((N.flags&524288)!==0)G=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var et=N.alternate;if(et===null)throw Error(r(387));if(et=et.memoizedProps,et!==null){var ut=N.type;Ja(N.pendingProps.value,et.value)||(s!==null?s.push(ut):s=[ut])}}else if(N===Zo.current){if(et=N.alternate,et===null)throw Error(r(387));et.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(ji):s=[ji])}N=N.return}s!==null&&Xe(u,s,p,b),u.flags|=262144}function fn(s){for(s=s.firstContext;s!==null;){var u=s.context;if(!Ja(lr?u._currentValue:u._currentValue2,s.memoizedValue))return!0;s=s.next}return!1}function At(s){_s=s,Da=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ht(s){return Se(_s,s)}function me(s,u){return _s===null&&At(s),Se(s,u)}function Se(s,u){var p=lr?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},Da===null){if(s===null)throw Error(r(308));Da=u,s.dependencies={lanes:0,firstContext:u},s.flags|=524288}else Da=Da.next=u;return p}function Oe(){return{controller:new Dd,data:new Map,refCount:0}}function $e(s){s.refCount--,s.refCount===0&&A0(Lc,function(){s.controller.abort()})}function xe(s){s!==Wo&&s.next===null&&(Wo===null?Cn=Wo=s:Wo=Wo.next=s),uu=!0,jd||(jd=!0,ee())}function ct(s,u){if(!ao&&uu){ao=!0;do for(var p=!1,b=Cn;b!==null;){if(s!==0){var N=b.pendingLanes;if(N===0)var G=0;else{var et=b.suspendedLanes,ut=b.pingedLanes;G=(1<<31-Fa(42|s)+1)-1,G&=N&~(et&~ut),G=G&201326741?G&201326741|1:G?G|2:0}G!==0&&(p=!0,zt(b,G))}else G=Ve,G=P(b,b===Tn?G:0,b.cancelPendingCommit!==null||b.timeoutHandle!==or),(G&3)===0||j(b,G)||(p=!0,zt(b,G));b=b.next}while(p);ao=!1}}function Tt(){Mt()}function Mt(){uu=jd=!1;var s=0;Ai!==0&&(_i()&&(s=Ai),Ai=0);for(var u=Ci(),p=null,b=Cn;b!==null;){var N=b.next,G=Pt(b,u);G===0?(b.next=null,p===null?Cn=N:p.next=N,N===null&&(Wo=p)):(p=b,(s!==0||(G&3)!==0)&&(uu=!0)),b=N}ct(s)}function Pt(s,u){for(var p=s.suspendedLanes,b=s.pingedLanes,N=s.expirationTimes,G=s.pendingLanes&-62914561;0<G;){var et=31-Fa(G),ut=1<<et,St=N[et];St===-1?((ut&p)===0||(ut&b)!==0)&&(N[et]=x(ut,u)):St<=u&&(s.expiredLanes|=ut),G&=~ut}if(u=Tn,p=Ve,p=P(s,s===u?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==or),b=s.callbackNode,p===0||s===u&&(sn===2||sn===9)||s.cancelPendingCommit!==null)return b!==null&&b!==null&&Dc(b),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||j(s,p)){if(u=p&-p,u===s.callbackPriority)return u;switch(b!==null&&Dc(b),K(p)){case 2:case 8:p=T0;break;case 32:p=Od;break;case 268435456:p=xd;break;default:p=Od}return b=se.bind(null,s),p=lu(p,b),s.callbackPriority=u,s.callbackNode=p,u}return b!==null&&b!==null&&Dc(b),s.callbackPriority=2,s.callbackNode=null,2}function se(s,u){if(gn!==0&&gn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(Gs()&&s.callbackNode!==p)return null;var b=Ve;return b=P(s,s===Tn?b:0,s.cancelPendingCommit!==null||s.timeoutHandle!==or),b===0?null:(yi(s,b,u),Pt(s,Ci()),s.callbackNode!=null&&s.callbackNode===p?se.bind(null,s):null)}function zt(s,u){if(Gs())return null;yi(s,u,!0)}function ee(){Sc?nu(function(){(Ie&6)!==0?lu(Rd,Tt):Mt()}):lu(Rd,Tt)}function qt(){return Ai===0&&(Ai=L()),Ai}function an(s,u){if($o===null){var p=$o=[];Pc=0,mr=qt(),Za={status:"pending",value:void 0,then:function(b){p.push(b)}}}return Pc++,u.then(Ae,Ae),u}function Ae(){if(--Pc===0&&$o!==null){Za!==null&&(Za.status="fulfilled");var s=$o;$o=null,mr=0,Za=null;for(var u=0;u<s.length;u++)(0,s[u])()}}function re(s,u){var p=[],b={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return s.then(function(){b.status="fulfilled",b.value=u;for(var N=0;N<p.length;N++)(0,p[N])(u)},function(N){for(b.status="rejected",b.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),b}function tn(){var s=qr.current;return s!==null?s:Tn.pooledCache}function _n(s,u){u===null?v(qr,qr.current):v(qr,u.pool)}function ea(){var s=tn();return s===null?null:{parent:lr?Nn._currentValue:Nn._currentValue2,pool:s}}function Xn(s,u){if(Ja(s,u))return!0;if(typeof s!="object"||s===null||typeof u!="object"||u===null)return!1;var p=Object.keys(s),b=Object.keys(u);if(p.length!==b.length)return!1;for(b=0;b<p.length;b++){var N=p[b];if(!w0.call(u,N)||!Ja(s[N],u[N]))return!1}return!0}function Nt(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ot(){}function Jt(s,u,p){switch(p=s[p],p===void 0?s.push(u):p!==u&&(u.then(Ot,Ot),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,He(s),s;default:if(typeof u.status=="string")u.then(Ot,Ot);else{if(s=Tn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=u,s.status="pending",s.then(function(b){if(u.status==="pending"){var N=u;N.status="fulfilled",N.value=b}},function(b){if(u.status==="pending"){var N=u;N.status="rejected",N.reason=b}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,He(s),s}throw ui=u,io}}function Ge(){if(ui===null)throw Error(r(459));var s=ui;return ui=null,s}function He(s){if(s===io||s===ro)throw Error(r(483))}function Ke(){for(var s=Es,u=Ic=Es=0;u<s;){var p=dn[u];dn[u++]=null;var b=dn[u];dn[u++]=null;var N=dn[u];dn[u++]=null;var G=dn[u];if(dn[u++]=null,b!==null&&N!==null){var et=b.pending;et===null?N.next=N:(N.next=et.next,et.next=N),b.pending=N}G!==0&&Rn(p,N,G)}}function Ne(s,u,p,b){dn[Es++]=s,dn[Es++]=u,dn[Es++]=p,dn[Es++]=b,Ic|=b,s.lanes|=b,s=s.alternate,s!==null&&(s.lanes|=b)}function ce(s,u,p,b){return Ne(s,u,p,b),On(s)}function Le(s,u){return Ne(s,null,null,u),On(s)}function Rn(s,u,p){s.lanes|=p;var b=s.alternate;b!==null&&(b.lanes|=p);for(var N=!1,G=s.return;G!==null;)G.childLanes|=p,b=G.alternate,b!==null&&(b.childLanes|=p),G.tag===22&&(s=G.stateNode,s===null||s._visibility&1||(N=!0)),s=G,G=G.return;return s.tag===3?(G=s.stateNode,N&&u!==null&&(N=31-Fa(p),s=G.hiddenUpdates,b=s[N],b===null?s[N]=[u]:b.push(u),u.lane=p|536870912),G):null}function On(s){if(50<Er)throw Er=0,Vc=null,Error(r(185));for(var u=s.return;u!==null;)s=u,u=s.return;return s.tag===3?s.stateNode:null}function Ta(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pa(s,u){s=s.updateQueue,u.updateQueue===s&&(u.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function gi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Li(s,u,p){var b=s.updateQueue;if(b===null)return null;if(b=b.shared,(Ie&2)!==0){var N=b.pending;return N===null?u.next=u:(u.next=N.next,N.next=u),b.pending=u,u=On(s),Rn(s,null,p),u}return Ne(s,b,u,p),On(s)}function ca(s,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var b=u.lanes;b&=s.pendingLanes,p|=b,u.lanes=p,U(s,p)}}function $n(s,u){var p=s.updateQueue,b=s.alternate;if(b!==null&&(b=b.updateQueue,p===b)){var N=null,G=null;if(p=p.firstBaseUpdate,p!==null){do{var et={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};G===null?N=G=et:G=G.next=et,p=p.next}while(p!==null);G===null?N=G=u:G=G.next=u}else N=G=u;p={baseState:b.baseState,firstBaseUpdate:N,lastBaseUpdate:G,shared:b.shared,callbacks:b.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=u:s.next=u,p.lastBaseUpdate=u}function wt(){if(Bd){var s=Za;if(s!==null)throw s}}function Et(s,u,p,b){Bd=!1;var N=s.updateQueue;Pn=!1;var G=N.firstBaseUpdate,et=N.lastBaseUpdate,ut=N.shared.pending;if(ut!==null){N.shared.pending=null;var St=ut,Bt=St.next;St.next=null,et===null?G=Bt:et.next=Bt,et=St;var It=s.alternate;It!==null&&(It=It.updateQueue,ut=It.lastBaseUpdate,ut!==et&&(ut===null?It.firstBaseUpdate=Bt:ut.next=Bt,It.lastBaseUpdate=St))}if(G!==null){var Wt=N.baseState;et=0,It=Bt=St=null,ut=G;do{var ne=ut.lane&-536870913,je=ne!==ut.lane;if(je?(Ve&ne)===ne:(b&ne)===ne){ne!==0&&ne===mr&&(Bd=!0),It!==null&&(It=It.next={lane:0,tag:ut.tag,payload:ut.payload,callback:null,next:null});t:{var Ri=s,al=ut;ne=u;var As=p;switch(al.tag){case 1:if(Ri=al.payload,typeof Ri=="function"){Wt=Ri.call(As,Wt,ne);break t}Wt=Ri;break t;case 3:Ri.flags=Ri.flags&-65537|128;case 0:if(Ri=al.payload,ne=typeof Ri=="function"?Ri.call(As,Wt,ne):Ri,ne==null)break t;Wt=gc({},Wt,ne);break t;case 2:Pn=!0}}ne=ut.callback,ne!==null&&(s.flags|=64,je&&(s.flags|=8192),je=N.callbacks,je===null?N.callbacks=[ne]:je.push(ne))}else je={lane:ne,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null},It===null?(Bt=It=je,St=Wt):It=It.next=je,et|=ne;if(ut=ut.next,ut===null){if(ut=N.shared.pending,ut===null)break;je=ut,ut=je.next,je.next=null,N.lastBaseUpdate=je,N.shared.pending=null}}while(!0);It===null&&(St=Wt),N.baseState=St,N.firstBaseUpdate=Bt,N.lastBaseUpdate=It,G===null&&(N.shared.lanes=0),$a|=et,s.lanes=et,s.memoizedState=Wt}}function te(s,u){if(typeof s!="function")throw Error(r(191,s));s.call(u)}function ae(s,u){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)te(p[s],u)}function Yt(s,u){s=zi,v(du,s),v(so,u),zi=s|u.baseLanes}function rn(){v(du,zi),v(so,so.current)}function En(){zi=du.current,R(so),R(du)}function fe(){throw Error(r(321))}function de(s,u){if(u===null)return!1;for(var p=0;p<u.length&&p<s.length;p++)if(!Ja(s[p],u[p]))return!1;return!0}function Zt(s,u,p,b,N,G){return hn=G,pe=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ge.H=s===null||s.memoizedState===null?zd:vr,lo=!1,G=p(b,N),lo=!1,oo&&(G=Me(u,p,b,N)),qe(s),G}function qe(s){ge.H=ja;var u=Je!==null&&Je.next!==null;if(hn=0,sa=Je=pe=null,hu=!1,ba=0,Ga=null,u)throw Error(r(300));s===null||va||(s=s.dependencies,s!==null&&fn(s)&&(va=!0))}function Me(s,u,p,b){pe=s;var N=0;do{if(oo&&(Ga=null),ba=0,oo=!1,25<=N)throw Error(r(301));if(N+=1,sa=Je=null,s.updateQueue!=null){var G=s.updateQueue;G.lastEffect=null,G.events=null,G.stores=null,G.memoCache!=null&&(G.memoCache.index=0)}ge.H=co,G=u(p,b)}while(oo);return G}function Ce(){var s=ge.H,u=s.useState()[0];return u=typeof u.then=="function"?Ro(u):u,s=s.useState()[0],(Je!==null?Je.memoizedState:null)!==s&&(pe.flags|=1024),u}function An(){var s=uo!==0;return uo=0,s}function zn(s,u,p){u.updateQueue=s.updateQueue,u.flags&=-2053,s.lanes&=~p}function kn(s){if(hu){for(s=s.memoizedState;s!==null;){var u=s.queue;u!==null&&(u.pending=null),s=s.next}hu=!1}hn=0,sa=Je=pe=null,oo=!1,ba=uo=0,Ga=null}function vn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sa===null?pe.memoizedState=sa=s:sa=sa.next=s,sa}function Fn(){if(Je===null){var s=pe.alternate;s=s!==null?s.memoizedState:null}else s=Je.next;var u=sa===null?pe.memoizedState:sa.next;if(u!==null)sa=u,Je=s;else{if(s===null)throw pe.alternate===null?Error(r(467)):Error(r(310));Je=s,s={memoizedState:Je.memoizedState,baseState:Je.baseState,baseQueue:Je.baseQueue,queue:Je.queue,next:null},sa===null?pe.memoizedState=sa=s:sa=sa.next=s}return sa}function Ns(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ro(s){var u=ba;return ba+=1,Ga===null&&(Ga=[]),s=Jt(Ga,s,u),u=pe,(sa===null?u.memoizedState:sa.next)===null&&(u=u.alternate,ge.H=u===null||u.memoizedState===null?zd:vr),s}function Uu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ro(s);if(s.$$typeof===Ur)return Ht(s)}throw Error(r(438,String(s)))}function Oo(s){var u=null,p=pe.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var b=pe.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(u={data:b.data.map(function(N){return N.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Ns(),pe.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(s),b=0;b<s;b++)p[b]=Zl;return u.index++,p}function Oi(s,u){return typeof u=="function"?u(s):u}function xi(s){var u=Fn();return ei(u,Je,s)}function ei(s,u,p){var b=s.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=p;var N=s.baseQueue,G=b.pending;if(G!==null){if(N!==null){var et=N.next;N.next=G.next,G.next=et}u.baseQueue=N=G,b.pending=null}if(G=s.baseState,N===null)s.memoizedState=G;else{u=N.next;var ut=et=null,St=null,Bt=u,It=!1;do{var Wt=Bt.lane&-536870913;if(Wt!==Bt.lane?(Ve&Wt)===Wt:(hn&Wt)===Wt){var ne=Bt.revertLane;if(ne===0)St!==null&&(St=St.next={lane:0,revertLane:0,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null}),Wt===mr&&(It=!0);else if((hn&ne)===ne){Bt=Bt.next,ne===mr&&(It=!0);continue}else Wt={lane:0,revertLane:Bt.revertLane,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null},St===null?(ut=St=Wt,et=G):St=St.next=Wt,pe.lanes|=ne,$a|=ne;Wt=Bt.action,lo&&p(G,Wt),G=Bt.hasEagerState?Bt.eagerState:p(G,Wt)}else ne={lane:Wt,revertLane:Bt.revertLane,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null},St===null?(ut=St=ne,et=G):St=St.next=ne,pe.lanes|=Wt,$a|=Wt;Bt=Bt.next}while(Bt!==null&&Bt!==u);if(St===null?et=G:St.next=ut,!Ja(G,s.memoizedState)&&(va=!0,It&&(p=Za,p!==null)))throw p;s.memoizedState=G,s.baseState=et,s.baseQueue=St,b.lastRenderedState=G}return N===null&&(b.lanes=0),[s.memoizedState,b.dispatch]}function Bu(s){var u=Fn(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var b=p.dispatch,N=p.pending,G=u.memoizedState;if(N!==null){p.pending=null;var et=N=N.next;do G=s(G,et.action),et=et.next;while(et!==N);Ja(G,u.memoizedState)||(va=!0),u.memoizedState=G,u.baseQueue===null&&(u.baseState=G),p.lastRenderedState=G}return[G,b]}function Eh(s,u,p){var b=pe,N=Fn(),G=un;if(G){if(p===void 0)throw Error(r(407));p=p()}else p=u();var et=!Ja((Je||N).memoizedState,p);et&&(N.memoizedState=p,va=!0),N=N.queue;var ut=wl.bind(null,b,N,s);if(tr(2048,8,ut,[s]),N.getSnapshot!==u||et||sa!==null&&sa.memoizedState.tag&1){if(b.flags|=2048,ni(9,xo(),Af.bind(null,b,N,p,u),null),Tn===null)throw Error(r(349));G||(hn&124)!==0||zu(b,u,p)}return p}function zu(s,u,p){s.flags|=16384,s={getSnapshot:u,value:p},u=pe.updateQueue,u===null?(u=Ns(),pe.updateQueue=u,u.stores=[s]):(p=u.stores,p===null?u.stores=[s]:p.push(s))}function Af(s,u,p,b){u.value=p,u.getSnapshot=b,Ch(u)&&pi(s)}function wl(s,u,p){return p(function(){Ch(u)&&pi(s)})}function Ch(s){var u=s.getSnapshot;s=s.value;try{var p=u();return!Ja(s,p)}catch{return!0}}function pi(s){var u=Le(s,2);u!==null&&ri(u,s,2)}function Rl(s){var u=vn();if(typeof s=="function"){var p=s;if(s=p(),lo){Q(!0);try{p()}finally{Q(!1)}}}return u.memoizedState=u.baseState=s,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oi,lastRenderedState:s},u}function wf(s,u,p,b){return s.baseState=p,ei(s,Je,typeof b=="function"?b:Oi)}function Rf(s,u,p,b,N){if(as(s))throw Error(r(485));if(s=u.action,s!==null){var G={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(et){G.listeners.push(et)}};ge.T!==null?p(!0):G.isTransition=!1,b(G),p=u.pending,p===null?(G.next=u.pending=G,Ms(u,G)):(G.next=p.next,u.pending=p.next=G)}}function Ms(s,u){var p=u.action,b=u.payload,N=s.state;if(u.isTransition){var G=ge.T,et={};ge.T=et;try{var ut=p(N,b),St=ge.S;St!==null&&St(et,ut),Of(s,u,ut)}catch(Bt){es(s,u,Bt)}finally{ge.T=G}}else try{G=p(N,b),Of(s,u,G)}catch(Bt){es(s,u,Bt)}}function Of(s,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(b){xf(s,u,b)},function(b){return es(s,u,b)}):xf(s,u,p)}function xf(s,u,p){u.status="fulfilled",u.value=p,Th(u),s.state=p,u=s.pending,u!==null&&(p=u.next,p===u?s.pending=null:(p=p.next,u.next=p,Ms(s,p)))}function es(s,u,p){var b=s.pending;if(s.pending=null,b!==null){b=b.next;do u.status="rejected",u.reason=p,Th(u),u=u.next;while(u!==b)}s.action=null}function Th(s){s=s.listeners;for(var u=0;u<s.length;u++)(0,s[u])()}function Nf(s,u){return u}function Mf(s,u){if(un){var p=Tn.formState;if(p!==null){t:{var b=pe;if(un){if(ra){var N=a0(ra,Ki);if(N){ra=bd(N),b=i0(N);break t}}nt(b)}b=!1}b&&(u=p[0])}}p=vn(),p.memoizedState=p.baseState=u,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nf,lastRenderedState:u},p.queue=b,p=wh.bind(null,pe,b),b.dispatch=p,b=Rl(!1);var G=Dl.bind(null,pe,!1,b.queue);return b=vn(),N={state:u,dispatch:null,action:s,pending:null},b.queue=N,p=Rf.bind(null,pe,N,G,p),N.dispatch=p,b.memoizedState=s,[u,p,!1]}function Lu(s){var u=Fn();return Ah(u,Je,s)}function Ah(s,u,p){if(u=ei(s,u,Nf)[0],s=xi(Oi)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var b=Ro(u)}catch(et){throw et===io?ro:et}else b=u;u=Fn();var N=u.queue,G=N.dispatch;return p!==u.memoizedState&&(pe.flags|=2048,ni(9,xo(),Pg.bind(null,N,p),null)),[b,G,s]}function Pg(s,u){s.action=u}function Ol(s){var u=Fn(),p=Je;if(p!==null)return Ah(u,p,s);Fn(),u=u.memoizedState,p=Fn();var b=p.queue.dispatch;return p.memoizedState=s,[u,b,!1]}function ni(s,u,p,b){return s={tag:s,create:p,deps:b,inst:u,next:null},u=pe.updateQueue,u===null&&(u=Ns(),pe.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=s.next=s:(b=p.next,p.next=s,s.next=b,u.lastEffect=s),s}function xo(){return{destroy:void 0,resource:void 0}}function Pu(){return Fn().memoizedState}function wr(s,u,p,b){var N=vn();b=b===void 0?null:b,pe.flags|=s,N.memoizedState=ni(1|u,xo(),p,b)}function tr(s,u,p,b){var N=Fn();b=b===void 0?null:b;var G=N.memoizedState.inst;Je!==null&&b!==null&&de(b,Je.memoizedState.deps)?N.memoizedState=ni(u,G,p,b):(pe.flags|=s,N.memoizedState=ni(1|u,G,p,b))}function Df(s,u){wr(8390656,8,s,u)}function Iu(s,u){tr(2048,8,s,u)}function jf(s,u){return tr(4,2,s,u)}function No(s,u){return tr(4,4,s,u)}function er(s,u){if(typeof u=="function"){s=s();var p=u(s);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return s=s(),u.current=s,function(){u.current=null}}function Gu(s,u,p){p=p!=null?p.concat([s]):null,tr(4,4,er.bind(null,u,s),p)}function Ds(){}function Rr(s,u){var p=Fn();u=u===void 0?null:u;var b=p.memoizedState;return u!==null&&de(u,b[1])?b[0]:(p.memoizedState=[s,u],s)}function Hu(s,u){var p=Fn();u=u===void 0?null:u;var b=p.memoizedState;if(u!==null&&de(u,b[1]))return b[0];if(b=s(),lo){Q(!0);try{s()}finally{Q(!1)}}return p.memoizedState=[b,u],b}function Mo(s,u,p){return p===void 0||(hn&1073741824)!==0?s.memoizedState=u:(s.memoizedState=p,s=oc(),pe.lanes|=s,$a|=s,p)}function Uf(s,u,p,b){return Ja(p,u)?p:so.current!==null?(s=Mo(s,p,b),Ja(s,u)||(va=!0),s):(hn&42)===0?(va=!0,s.memoizedState=p):(s=oc(),pe.lanes|=s,$a|=s,u)}function xl(s,u,p,b,N){var G=cr();da(G!==0&&8>G?G:8);var et=ge.T,ut={};ge.T=ut,Dl(s,!1,u,p);try{var St=N(),Bt=ge.S;if(Bt!==null&&Bt(ut,St),St!==null&&typeof St=="object"&&typeof St.then=="function"){var It=re(St,b);js(s,u,It,ii(s))}else js(s,u,b,ii(s))}catch(Wt){js(s,u,{then:function(){},status:"rejected",reason:Wt},ii())}finally{da(G),ge.T=et}}function Nl(s){var u=s.memoizedState;if(u!==null)return u;u={memoizedState:Ir,baseState:Ir,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oi,lastRenderedState:Ir},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oi,lastRenderedState:p},next:null},s.memoizedState=u,s=s.alternate,s!==null&&(s.memoizedState=u),u}function ku(){return Ht(ji)}function Va(){return Fn().memoizedState}function ns(){return Fn().memoizedState}function qu(s){for(var u=s.return;u!==null;){switch(u.tag){case 24:case 3:var p=ii();s=gi(p);var b=Li(u,s,p);b!==null&&(ri(b,u,p),ca(b,u,p)),u={cache:Oe()},s.payload=u;return}u=u.return}}function Ml(s,u,p){var b=ii();p={lane:b,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},as(s)?jl(u,p):(p=ce(s,u,p,b),p!==null&&(ri(p,s,b),Bf(p,u,b)))}function wh(s,u,p){var b=ii();js(s,u,p,b)}function js(s,u,p,b){var N={lane:b,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(as(s))jl(u,N);else{var G=s.alternate;if(s.lanes===0&&(G===null||G.lanes===0)&&(G=u.lastRenderedReducer,G!==null))try{var et=u.lastRenderedState,ut=G(et,p);if(N.hasEagerState=!0,N.eagerState=ut,Ja(ut,et))return Ne(s,u,N,0),Tn===null&&Ke(),!1}catch{}finally{}if(p=ce(s,u,N,b),p!==null)return ri(p,s,b),Bf(p,u,b),!0}return!1}function Dl(s,u,p,b){if(b={lane:2,revertLane:qt(),action:b,hasEagerState:!1,eagerState:null,next:null},as(s)){if(u)throw Error(r(479))}else u=ce(s,p,b,2),u!==null&&ri(u,s,2)}function as(s){var u=s.alternate;return s===pe||u!==null&&u===pe}function jl(s,u){oo=hu=!0;var p=s.pending;p===null?u.next=u:(u.next=p.next,p.next=u),s.pending=u}function Bf(s,u,p){if((p&4194048)!==0){var b=u.lanes;b&=s.pendingLanes,p|=b,u.lanes=p,U(s,p)}}function Vu(s){var u=fo;return fo+=1,ci===null&&(ci=[]),Jt(ci,s,u)}function Ul(s,u){u=u.props.ref,s.ref=u!==void 0?u:null}function Yu(s,u){throw u.$$typeof===qs?Error(r(525)):(s=Object.prototype.toString.call(u),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":s)))}function Ku(s){var u=s._init;return u(s._payload)}function Rh(s){function u(yt,ht){if(s){var _t=yt.deletions;_t===null?(yt.deletions=[ht],yt.flags|=16):_t.push(ht)}}function p(yt,ht){if(!s)return null;for(;ht!==null;)u(yt,ht),ht=ht.sibling;return null}function b(yt){for(var ht=new Map;yt!==null;)yt.key!==null?ht.set(yt.key,yt):ht.set(yt.index,yt),yt=yt.sibling;return ht}function N(yt,ht){return yt=Ln(yt,ht),yt.index=0,yt.sibling=null,yt}function G(yt,ht,_t){return yt.index=_t,s?(_t=yt.alternate,_t!==null?(_t=_t.index,_t<ht?(yt.flags|=67108866,ht):_t):(yt.flags|=67108866,ht)):(yt.flags|=1048576,ht)}function et(yt){return s&&yt.alternate===null&&(yt.flags|=67108866),yt}function ut(yt,ht,_t,Gt){return ht===null||ht.tag!==6?(ht=id(_t,yt.mode,Gt),ht.return=yt,ht):(ht=N(ht,_t),ht.return=yt,ht)}function St(yt,ht,_t,Gt){var Qt=_t.type;return Qt===Vs?It(yt,ht,_t.props.children,Gt,_t.key):ht!==null&&(ht.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===Lr&&Ku(Qt)===ht.type)?(ht=N(ht,_t.props),Ul(ht,_t),ht.return=yt,ht):(ht=Xl(_t.type,_t.key,_t.props,null,yt.mode,Gt),Ul(ht,_t),ht.return=yt,ht)}function Bt(yt,ht,_t,Gt){return ht===null||ht.tag!==4||ht.stateNode.containerInfo!==_t.containerInfo||ht.stateNode.implementation!==_t.implementation?(ht=rd(_t,yt.mode,Gt),ht.return=yt,ht):(ht=N(ht,_t.children||[]),ht.return=yt,ht)}function It(yt,ht,_t,Gt,Qt){return ht===null||ht.tag!==7?(ht=Hs(_t,yt.mode,Gt,Qt),ht.return=yt,ht):(ht=N(ht,_t),ht.return=yt,ht)}function Wt(yt,ht,_t){if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return ht=id(""+ht,yt.mode,_t),ht.return=yt,ht;if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case Yo:return _t=Xl(ht.type,ht.key,ht.props,null,yt.mode,_t),Ul(_t,ht),_t.return=yt,_t;case jr:return ht=rd(ht,yt.mode,_t),ht.return=yt,ht;case Lr:var Gt=ht._init;return ht=Gt(ht._payload),Wt(yt,ht,_t)}if(Ks(ht)||S(ht))return ht=Hs(ht,yt.mode,_t,null),ht.return=yt,ht;if(typeof ht.then=="function")return Wt(yt,Vu(ht),_t);if(ht.$$typeof===Ur)return Wt(yt,me(yt,ht),_t);Yu(yt,ht)}return null}function ne(yt,ht,_t,Gt){var Qt=ht!==null?ht.key:null;if(typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint")return Qt!==null?null:ut(yt,ht,""+_t,Gt);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case Yo:return _t.key===Qt?St(yt,ht,_t,Gt):null;case jr:return _t.key===Qt?Bt(yt,ht,_t,Gt):null;case Lr:return Qt=_t._init,_t=Qt(_t._payload),ne(yt,ht,_t,Gt)}if(Ks(_t)||S(_t))return Qt!==null?null:It(yt,ht,_t,Gt,null);if(typeof _t.then=="function")return ne(yt,ht,Vu(_t),Gt);if(_t.$$typeof===Ur)return ne(yt,ht,me(yt,_t),Gt);Yu(yt,_t)}return null}function je(yt,ht,_t,Gt,Qt){if(typeof Gt=="string"&&Gt!==""||typeof Gt=="number"||typeof Gt=="bigint")return yt=yt.get(_t)||null,ut(ht,yt,""+Gt,Qt);if(typeof Gt=="object"&&Gt!==null){switch(Gt.$$typeof){case Yo:return yt=yt.get(Gt.key===null?_t:Gt.key)||null,St(ht,yt,Gt,Qt);case jr:return yt=yt.get(Gt.key===null?_t:Gt.key)||null,Bt(ht,yt,Gt,Qt);case Lr:var wn=Gt._init;return Gt=wn(Gt._payload),je(yt,ht,_t,Gt,Qt)}if(Ks(Gt)||S(Gt))return yt=yt.get(_t)||null,It(ht,yt,Gt,Qt,null);if(typeof Gt.then=="function")return je(yt,ht,_t,Vu(Gt),Qt);if(Gt.$$typeof===Ur)return je(yt,ht,_t,me(ht,Gt),Qt);Yu(ht,Gt)}return null}function Ri(yt,ht,_t,Gt){for(var Qt=null,wn=null,Te=ht,on=ht=0,Ea=null;Te!==null&&on<_t.length;on++){Te.index>on?(Ea=Te,Te=null):Ea=Te.sibling;var cn=ne(yt,Te,_t[on],Gt);if(cn===null){Te===null&&(Te=Ea);break}s&&Te&&cn.alternate===null&&u(yt,Te),ht=G(cn,ht,on),wn===null?Qt=cn:wn.sibling=cn,wn=cn,Te=Ea}if(on===_t.length)return p(yt,Te),un&&tt(yt,on),Qt;if(Te===null){for(;on<_t.length;on++)Te=Wt(yt,_t[on],Gt),Te!==null&&(ht=G(Te,ht,on),wn===null?Qt=Te:wn.sibling=Te,wn=Te);return un&&tt(yt,on),Qt}for(Te=b(Te);on<_t.length;on++)Ea=je(Te,yt,on,_t[on],Gt),Ea!==null&&(s&&Ea.alternate!==null&&Te.delete(Ea.key===null?on:Ea.key),ht=G(Ea,ht,on),wn===null?Qt=Ea:wn.sibling=Ea,wn=Ea);return s&&Te.forEach(function(ws){return u(yt,ws)}),un&&tt(yt,on),Qt}function al(yt,ht,_t,Gt){if(_t==null)throw Error(r(151));for(var Qt=null,wn=null,Te=ht,on=ht=0,Ea=null,cn=_t.next();Te!==null&&!cn.done;on++,cn=_t.next()){Te.index>on?(Ea=Te,Te=null):Ea=Te.sibling;var ws=ne(yt,Te,cn.value,Gt);if(ws===null){Te===null&&(Te=Ea);break}s&&Te&&ws.alternate===null&&u(yt,Te),ht=G(ws,ht,on),wn===null?Qt=ws:wn.sibling=ws,wn=ws,Te=Ea}if(cn.done)return p(yt,Te),un&&tt(yt,on),Qt;if(Te===null){for(;!cn.done;on++,cn=_t.next())cn=Wt(yt,cn.value,Gt),cn!==null&&(ht=G(cn,ht,on),wn===null?Qt=cn:wn.sibling=cn,wn=cn);return un&&tt(yt,on),Qt}for(Te=b(Te);!cn.done;on++,cn=_t.next())cn=je(Te,yt,on,cn.value,Gt),cn!==null&&(s&&cn.alternate!==null&&Te.delete(cn.key===null?on:cn.key),ht=G(cn,ht,on),wn===null?Qt=cn:wn.sibling=cn,wn=cn);return s&&Te.forEach(function(Yc){return u(yt,Yc)}),un&&tt(yt,on),Qt}function As(yt,ht,_t,Gt){if(typeof _t=="object"&&_t!==null&&_t.type===Vs&&_t.key===null&&(_t=_t.props.children),typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case Yo:t:{for(var Qt=_t.key;ht!==null;){if(ht.key===Qt){if(Qt=_t.type,Qt===Vs){if(ht.tag===7){p(yt,ht.sibling),Gt=N(ht,_t.props.children),Gt.return=yt,yt=Gt;break t}}else if(ht.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===Lr&&Ku(Qt)===ht.type){p(yt,ht.sibling),Gt=N(ht,_t.props),Ul(Gt,_t),Gt.return=yt,yt=Gt;break t}p(yt,ht);break}else u(yt,ht);ht=ht.sibling}_t.type===Vs?(Gt=Hs(_t.props.children,yt.mode,Gt,_t.key),Gt.return=yt,yt=Gt):(Gt=Xl(_t.type,_t.key,_t.props,null,yt.mode,Gt),Ul(Gt,_t),Gt.return=yt,yt=Gt)}return et(yt);case jr:t:{for(Qt=_t.key;ht!==null;){if(ht.key===Qt)if(ht.tag===4&&ht.stateNode.containerInfo===_t.containerInfo&&ht.stateNode.implementation===_t.implementation){p(yt,ht.sibling),Gt=N(ht,_t.children||[]),Gt.return=yt,yt=Gt;break t}else{p(yt,ht);break}else u(yt,ht);ht=ht.sibling}Gt=rd(_t,yt.mode,Gt),Gt.return=yt,yt=Gt}return et(yt);case Lr:return Qt=_t._init,_t=Qt(_t._payload),As(yt,ht,_t,Gt)}if(Ks(_t))return Ri(yt,ht,_t,Gt);if(S(_t)){if(Qt=S(_t),typeof Qt!="function")throw Error(r(150));return _t=Qt.call(_t),al(yt,ht,_t,Gt)}if(typeof _t.then=="function")return As(yt,ht,Vu(_t),Gt);if(_t.$$typeof===Ur)return As(yt,ht,me(yt,_t),Gt);Yu(yt,_t)}return typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint"?(_t=""+_t,ht!==null&&ht.tag===6?(p(yt,ht.sibling),Gt=N(ht,_t),Gt.return=yt,yt=Gt):(p(yt,ht),Gt=id(_t,yt.mode,Gt),Gt.return=yt,yt=Gt),et(yt)):p(yt,ht)}return function(yt,ht,_t,Gt){try{fo=0;var Qt=As(yt,ht,_t,Gt);return ci=null,Qt}catch(Te){if(Te===io||Te===ro)throw Te;var wn=n(29,Te,null,yt.mode);return wn.lanes=Gt,wn.return=yt,wn}finally{}}}function is(s){var u=s.alternate;v(Zn,Zn.current&1),v(wi,s),Wa===null&&(u===null||so.current!==null||u.memoizedState!==null)&&(Wa=s)}function Oh(s){if(s.tag===22){if(v(Zn,Zn.current),v(wi,s),Wa===null){var u=s.alternate;u!==null&&u.memoizedState!==null&&(Wa=s)}}else rs()}function rs(){v(Zn,Zn.current),v(wi,wi.current)}function Or(s){R(wi),Wa===s&&(Wa=null),R(Zn)}function Bl(s){for(var u=s;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Tc(p)||Ac(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function zf(s,u,p,b){u=s.memoizedState,p=p(b,u),p=p==null?u:gc({},u,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}function xh(s,u,p,b,N,G,et){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(b,G,et):u.prototype&&u.prototype.isPureReactComponent?!Xn(p,b)||!Xn(N,G):!0}function Nh(s,u,p,b){s=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,b),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,b),u.state!==s&&ho.enqueueReplaceState(u,u.state,null)}function Us(s,u){var p=u;if("ref"in u){p={};for(var b in u)b!=="ref"&&(p[b]=u[b])}if(s=s.defaultProps){p===u&&(p=gc({},p));for(var N in s)p[N]===void 0&&(p[N]=s[N])}return p}function Do(s,u){try{var p=s.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(b){setTimeout(function(){throw b})}}function Mh(s,u,p){try{var b=s.onCaughtError;b(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Lf(s,u,p){return p=gi(p),p.tag=3,p.payload={element:null},p.callback=function(){Do(s,u)},p}function Dh(s){return s=gi(s),s.tag=3,s}function Pf(s,u,p,b){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var G=b.value;s.payload=function(){return N(G)},s.callback=function(){Mh(u,p,b)}}var et=p.stateNode;et!==null&&typeof et.componentDidCatch=="function"&&(s.callback=function(){Mh(u,p,b),typeof N!="function"&&(Kr===null?Kr=new Set([this]):Kr.add(this));var ut=b.stack;this.componentDidCatch(b.value,{componentStack:ut!==null?ut:""})})}function Ig(s,u,p,b,N){if(p.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(u=p.alternate,u!==null&&nn(u,p,N,!0),p=wi.current,p!==null){switch(p.tag){case 13:return Wa===null?lc():p.alternate===null&&In===0&&(In=3),p.flags&=-257,p.flags|=65536,p.lanes=N,b===fu?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([b]):u.add(b),Vi(s,b,N)),!1;case 22:return p.flags|=65536,b===fu?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([b])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([b]):p.add(b)),Vi(s,b,N)),!1}throw Error(r(435,p.tag))}return Vi(s,b,N),lc(),!1}if(un)return u=wi.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=N,b!==Qi&&(s=Error(r(422),{cause:b}),oe(F(s,p)))):(b!==Qi&&(u=Error(r(423),{cause:b}),oe(F(u,p))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,b=F(b,p),N=Lf(s.stateNode,b,N),$n(s,N),In!==4&&(In=2)),!1;var G=Error(r(520),{cause:b});if(G=F(G,p),mo===null?mo=[G]:mo.push(G),In!==4&&(In=2),u===null)return!0;b=F(b,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,s=N&-N,p.lanes|=s,s=Lf(p.stateNode,b,s),$n(p,s),!1;case 1:if(u=p.type,G=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(Kr===null||!Kr.has(G))))return p.flags|=65536,N&=-N,p.lanes|=N,N=Dh(N),Pf(N,s,p,b),$n(p,N),!1}p=p.return}while(p!==null);return!1}function Aa(s,u,p,b){u.child=s===null?Ui(u,null,p,b):Cs(u,s.child,p,b)}function jh(s,u,p,b,N){p=p.render;var G=u.ref;if("ref"in b){var et={};for(var ut in b)ut!=="ref"&&(et[ut]=b[ut])}else et=b;return At(u),b=Zt(s,u,p,et,G,N),ut=An(),s!==null&&!va?(zn(s,u,N),nr(s,u,N)):(un&&ut&&Z(u),u.flags|=1,Aa(s,u,b,N),u.child)}function Uh(s,u,p,b,N){if(s===null){var G=p.type;return typeof G=="function"&&!Dr(G)&&G.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=G,Bh(s,u,G,b,N)):(s=Xl(p.type,null,b,u,u.mode,N),s.ref=u.ref,s.return=u,u.child=s)}if(G=s.child,!Wu(s,N)){var et=G.memoizedProps;if(p=p.compare,p=p!==null?p:Xn,p(et,b)&&s.ref===u.ref)return nr(s,u,N)}return u.flags|=1,s=Ln(G,b),s.ref=u.ref,s.return=u,u.child=s}function Bh(s,u,p,b,N){if(s!==null){var G=s.memoizedProps;if(Xn(G,b)&&s.ref===u.ref)if(va=!1,u.pendingProps=b=G,Wu(s,N))(s.flags&131072)!==0&&(va=!0);else return u.lanes=s.lanes,nr(s,u,N)}return If(s,u,p,b,N)}function zh(s,u,p){var b=u.pendingProps,N=b.children,G=s!==null?s.memoizedState:null;if(b.mode==="hidden"){if((u.flags&128)!==0){if(b=G!==null?G.baseLanes|p:p,s!==null){for(N=u.child=s.child,G=0;N!==null;)G=G|N.lanes|N.childLanes,N=N.sibling;u.childLanes=G&~b}else u.childLanes=0,u.child=null;return Lh(s,u,b,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},s!==null&&_n(u,G!==null?G.cachePool:null),G!==null?Yt(u,G):rn(),Oh(u);else return u.lanes=u.childLanes=536870912,Lh(s,u,G!==null?G.baseLanes|p:p,p)}else G!==null?(_n(u,G.cachePool),Yt(u,G),rs(),u.memoizedState=null):(s!==null&&_n(u,null),rn(),rs());return Aa(s,u,N,p),u.child}function Lh(s,u,p,b){var N=tn();return N=N===null?null:{parent:lr?Nn._currentValue:Nn._currentValue2,pool:N},u.memoizedState={baseLanes:p,cachePool:N},s!==null&&_n(u,null),rn(),Oh(u),s!==null&&nn(s,u,b,!0),null}function Qu(s,u){var p=u.ref;if(p===null)s!==null&&s.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(u.flags|=4194816)}}function If(s,u,p,b,N){return At(u),p=Zt(s,u,p,b,void 0,N),b=An(),s!==null&&!va?(zn(s,u,N),nr(s,u,N)):(un&&b&&Z(u),u.flags|=1,Aa(s,u,p,N),u.child)}function Xu(s,u,p,b,N,G){return At(u),u.updateQueue=null,p=Me(u,b,p,N),qe(s),b=An(),s!==null&&!va?(zn(s,u,G),nr(s,u,G)):(un&&b&&Z(u),u.flags|=1,Aa(s,u,p,G),u.child)}function jo(s,u,p,b,N){if(At(u),u.stateNode===null){var G=Ss,et=p.contextType;typeof et=="object"&&et!==null&&(G=Ht(et)),G=new p(b,G),u.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,G.updater=ho,u.stateNode=G,G._reactInternals=u,G=u.stateNode,G.props=b,G.state=u.memoizedState,G.refs={},Ta(u),et=p.contextType,G.context=typeof et=="object"&&et!==null?Ht(et):Ss,G.state=u.memoizedState,et=p.getDerivedStateFromProps,typeof et=="function"&&(zf(u,p,et,b),G.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(et=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),et!==G.state&&ho.enqueueReplaceState(G,G.state,null),Et(u,b,G,N),wt(),G.state=u.memoizedState),typeof G.componentDidMount=="function"&&(u.flags|=4194308),b=!0}else if(s===null){G=u.stateNode;var ut=u.memoizedProps,St=Us(p,ut);G.props=St;var Bt=G.context,It=p.contextType;et=Ss,typeof It=="object"&&It!==null&&(et=Ht(It));var Wt=p.getDerivedStateFromProps;It=typeof Wt=="function"||typeof G.getSnapshotBeforeUpdate=="function",ut=u.pendingProps!==ut,It||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(ut||Bt!==et)&&Nh(u,G,b,et),Pn=!1;var ne=u.memoizedState;G.state=ne,Et(u,b,G,N),wt(),Bt=u.memoizedState,ut||ne!==Bt||Pn?(typeof Wt=="function"&&(zf(u,p,Wt,b),Bt=u.memoizedState),(St=Pn||xh(u,p,St,b,ne,Bt,et))?(It||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(u.flags|=4194308)):(typeof G.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=b,u.memoizedState=Bt),G.props=b,G.state=Bt,G.context=et,b=St):(typeof G.componentDidMount=="function"&&(u.flags|=4194308),b=!1)}else{G=u.stateNode,Pa(s,u),et=u.memoizedProps,It=Us(p,et),G.props=It,Wt=u.pendingProps,ne=G.context,Bt=p.contextType,St=Ss,typeof Bt=="object"&&Bt!==null&&(St=Ht(Bt)),ut=p.getDerivedStateFromProps,(Bt=typeof ut=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(et!==Wt||ne!==St)&&Nh(u,G,b,St),Pn=!1,ne=u.memoizedState,G.state=ne,Et(u,b,G,N),wt();var je=u.memoizedState;et!==Wt||ne!==je||Pn||s!==null&&s.dependencies!==null&&fn(s.dependencies)?(typeof ut=="function"&&(zf(u,p,ut,b),je=u.memoizedState),(It=Pn||xh(u,p,It,b,ne,je,St)||s!==null&&s.dependencies!==null&&fn(s.dependencies))?(Bt||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(b,je,St),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(b,je,St)),typeof G.componentDidUpdate=="function"&&(u.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof G.componentDidUpdate!="function"||et===s.memoizedProps&&ne===s.memoizedState||(u.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&ne===s.memoizedState||(u.flags|=1024),u.memoizedProps=b,u.memoizedState=je),G.props=b,G.state=je,G.context=St,b=It):(typeof G.componentDidUpdate!="function"||et===s.memoizedProps&&ne===s.memoizedState||(u.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&ne===s.memoizedState||(u.flags|=1024),b=!1)}return G=b,Qu(s,u),b=(u.flags&128)!==0,G||b?(G=u.stateNode,p=b&&typeof p.getDerivedStateFromError!="function"?null:G.render(),u.flags|=1,s!==null&&b?(u.child=Cs(u,s.child,null,N),u.child=Cs(u,null,p,N)):Aa(s,u,p,N),u.memoizedState=G.state,s=u.child):s=nr(s,u,N),s}function Ph(s,u,p,b){return Xt(),u.flags|=256,Aa(s,u,p,b),u.child}function Fu(s){return{baseLanes:s,cachePool:ea()}}function Ju(s,u,p){return s=s!==null?s.childLanes&~p:0,u&&(s|=Ua),s}function Gf(s,u,p){var b=u.pendingProps,N=!1,G=(u.flags&128)!==0,et;if((et=G)||(et=s!==null&&s.memoizedState===null?!1:(Zn.current&2)!==0),et&&(N=!0,u.flags&=-129),et=(u.flags&32)!==0,u.flags&=-33,s===null){if(un){if(N?is(u):rs(),un){var ut=ra,St;(St=ut)&&(ut=Rc(ut,Ki),ut!==null?(u.memoizedState={dehydrated:ut,treeContext:bs!==null?{id:pr,overflow:Yi}:null,retryLane:536870912,hydrationErrors:null},St=n(18,null,null,0),St.stateNode=ut,St.return=u,u.child=St,Sa=u,ra=null,St=!0):St=!1),St||nt(u)}if(ut=u.memoizedState,ut!==null&&(ut=ut.dehydrated,ut!==null))return Ac(ut)?u.lanes=32:u.lanes=536870912,null;Or(u)}return ut=b.children,b=b.fallback,N?(rs(),N=u.mode,ut=zl({mode:"hidden",children:ut},N),b=Hs(b,N,p,null),ut.return=u,b.return=u,ut.sibling=b,u.child=ut,N=u.child,N.memoizedState=Fu(p),N.childLanes=Ju(s,et,p),u.memoizedState=po,b):(is(u),Zu(u,ut))}if(St=s.memoizedState,St!==null&&(ut=St.dehydrated,ut!==null)){if(G)u.flags&256?(is(u),u.flags&=-257,u=ss(s,u,p)):u.memoizedState!==null?(rs(),u.child=s.child,u.flags|=128,u=null):(rs(),N=b.fallback,ut=u.mode,b=zl({mode:"visible",children:b.children},ut),N=Hs(N,ut,p,null),N.flags|=2,b.return=u,N.return=u,b.sibling=N,u.child=b,Cs(u,s.child,null,p),b=u.child,b.memoizedState=Fu(p),b.childLanes=Ju(s,et,p),u.memoizedState=po,u=N);else if(is(u),Ac(ut))et=n0(ut).digest,b=Error(r(419)),b.stack="",b.digest=et,oe({value:b,source:null,stack:null}),u=ss(s,u,p);else if(va||nn(s,u,p,!1),et=(p&s.childLanes)!==0,va||et){if(et=Tn,et!==null&&(b=p&-p,b=(b&42)!==0?1:I(b),b=(b&(et.suspendedLanes|p))!==0?0:b,b!==0&&b!==St.retryLane))throw St.retryLane=b,Le(s,b),ri(et,s,b),Ld;Tc(ut)||lc(),u=ss(s,u,p)}else Tc(ut)?(u.flags|=192,u.child=s.child,u=null):(s=St.treeContext,qn&&(ra=o0(ut),Sa=u,un=!0,kr=null,Ki=!1,s!==null&&(li[Ti++]=pr,li[Ti++]=Yi,li[Ti++]=bs,pr=s.id,Yi=s.overflow,bs=u)),u=Zu(u,b.children),u.flags|=4096);return u}return N?(rs(),N=b.fallback,ut=u.mode,St=s.child,G=St.sibling,b=Ln(St,{mode:"hidden",children:b.children}),b.subtreeFlags=St.subtreeFlags&65011712,G!==null?N=Ln(G,N):(N=Hs(N,ut,p,null),N.flags|=2),N.return=u,b.return=u,b.sibling=N,u.child=b,b=N,N=u.child,ut=s.child.memoizedState,ut===null?ut=Fu(p):(St=ut.cachePool,St!==null?(G=lr?Nn._currentValue:Nn._currentValue2,St=St.parent!==G?{parent:G,pool:G}:St):St=ea(),ut={baseLanes:ut.baseLanes|p,cachePool:St}),N.memoizedState=ut,N.childLanes=Ju(s,et,p),u.memoizedState=po,b):(is(u),p=s.child,s=p.sibling,p=Ln(p,{mode:"visible",children:b.children}),p.return=u,p.sibling=null,s!==null&&(et=u.deletions,et===null?(u.deletions=[s],u.flags|=16):et.push(s)),u.child=p,u.memoizedState=null,p)}function Zu(s,u){return u=zl({mode:"visible",children:u},s.mode),u.return=s,s.child=u}function zl(s,u){return s=n(22,s,null,u),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function ss(s,u,p){return Cs(u,s.child,null,p),s=Zu(u,u.pendingProps.children),s.flags|=2,u.memoizedState=null,s}function Ih(s,u,p){s.lanes|=u;var b=s.alternate;b!==null&&(b.lanes|=u),ze(s.return,u,p)}function Hf(s,u,p,b,N){var G=s.memoizedState;G===null?s.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:b,tail:p,tailMode:N}:(G.isBackwards=u,G.rendering=null,G.renderingStartTime=0,G.last=b,G.tail=p,G.tailMode=N)}function Gh(s,u,p){var b=u.pendingProps,N=b.revealOrder,G=b.tail;if(Aa(s,u,b.children,p),b=Zn.current,(b&2)!==0)b=b&1|2,u.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=u.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ih(s,p,u);else if(s.tag===19)Ih(s,p,u);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===u)break t;for(;s.sibling===null;){if(s.return===null||s.return===u)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}b&=1}switch(v(Zn,b),N){case"forwards":for(p=u.child,N=null;p!==null;)s=p.alternate,s!==null&&Bl(s)===null&&(N=p),p=p.sibling;p=N,p===null?(N=u.child,u.child=null):(N=p.sibling,p.sibling=null),Hf(u,!1,N,p,G);break;case"backwards":for(p=null,N=u.child,u.child=null;N!==null;){if(s=N.alternate,s!==null&&Bl(s)===null){u.child=N;break}s=N.sibling,N.sibling=p,p=N,N=s}Hf(u,!0,p,null,G);break;case"together":Hf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function nr(s,u,p){if(s!==null&&(u.dependencies=s.dependencies),$a|=u.lanes,(p&u.childLanes)===0)if(s!==null){if(nn(s,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(s!==null&&u.child!==s.child)throw Error(r(153));if(u.child!==null){for(s=u.child,p=Ln(s,s.pendingProps),u.child=p,p.return=u;s.sibling!==null;)s=s.sibling,p=p.sibling=Ln(s,s.pendingProps),p.return=u;p.sibling=null}return u.child}function Wu(s,u){return(s.lanes&u)!==0?!0:(s=s.dependencies,!!(s!==null&&fn(s)))}function Ll(s,u,p){switch(u.tag){case 3:st(u,u.stateNode.containerInfo),Re(u,Nn,s.memoizedState.cache),Xt();break;case 27:case 5:J(u);break;case 4:st(u,u.stateNode.containerInfo);break;case 10:Re(u,u.type,u.memoizedProps.value);break;case 13:var b=u.memoizedState;if(b!==null)return b.dehydrated!==null?(is(u),u.flags|=128,null):(p&u.child.childLanes)!==0?Gf(s,u,p):(is(u),s=nr(s,u,p),s!==null?s.sibling:null);is(u);break;case 19:var N=(s.flags&128)!==0;if(b=(p&u.childLanes)!==0,b||(nn(s,u,p,!1),b=(p&u.childLanes)!==0),N){if(b)return Gh(s,u,p);u.flags|=128}if(N=u.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),v(Zn,Zn.current),b)break;return null;case 22:case 23:return u.lanes=0,zh(s,u,p);case 24:Re(u,Nn,s.memoizedState.cache)}return nr(s,u,p)}function Uo(s,u,p){if(s!==null)if(s.memoizedProps!==u.pendingProps)va=!0;else{if(!Wu(s,p)&&(u.flags&128)===0)return va=!1,Ll(s,u,p);va=(s.flags&131072)!==0}else va=!1,un&&(u.flags&1048576)!==0&&at(u,eo,u.index);switch(u.lanes=0,u.tag){case 16:t:{s=u.pendingProps;var b=u.elementType,N=b._init;if(b=N(b._payload),u.type=b,typeof b=="function")Dr(b)?(s=Us(b,s),u.tag=1,u=jo(null,u,b,s,p)):(u.tag=0,u=If(null,u,b,s,p));else{if(b!=null){if(N=b.$$typeof,N===mc){u.tag=11,u=jh(null,u,b,s,p);break t}else if(N===vc){u.tag=14,u=Uh(null,u,b,s,p);break t}}throw u=C(b)||b,Error(r(306,u,""))}}return u;case 0:return If(s,u,u.type,u.pendingProps,p);case 1:return b=u.type,N=Us(b,u.pendingProps),jo(s,u,b,N,p);case 3:t:{if(st(u,u.stateNode.containerInfo),s===null)throw Error(r(387));var G=u.pendingProps;N=u.memoizedState,b=N.element,Pa(s,u),Et(u,G,null,p);var et=u.memoizedState;if(G=et.cache,Re(u,Nn,G),G!==N.cache&&Xe(u,[Nn],p,!0),wt(),G=et.element,qn&&N.isDehydrated)if(N={element:G,isDehydrated:!1,cache:et.cache},u.updateQueue.baseState=N,u.memoizedState=N,u.flags&256){u=Ph(s,u,G,p);break t}else if(G!==b){b=F(Error(r(424)),u),oe(b),u=Ph(s,u,G,p);break t}else for(qn&&(ra=Vg(u.stateNode.containerInfo),Sa=u,un=!0,kr=null,Ki=!0),p=Ui(u,null,G,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Xt(),G===b){u=nr(s,u,p);break t}Aa(s,u,G,p)}u=u.child}return u;case 26:if(Ei)return Qu(s,u),s===null?(p=v0(u.type,null,u.pendingProps,null))?u.memoizedState=p:un||(u.stateNode=S0(u.type,u.pendingProps,Hr.current,u)):u.memoizedState=v0(u.type,s.memoizedProps,u.pendingProps,s.memoizedState),null;case 27:if(ia)return J(u),s===null&&ia&&un&&(b=u.stateNode=ru(u.type,u.pendingProps,Hr.current,ma.current,!1),Sa=u,Ki=!0,ra=Xo(u.type,b,ra)),Aa(s,u,u.pendingProps.children,p),Qu(s,u),s===null&&(u.flags|=4194304),u.child;case 5:return s===null&&un&&(p0(u.type,u.pendingProps,ma.current),(N=b=ra)&&(b=l0(b,u.type,u.pendingProps,Ki),b!==null?(u.stateNode=b,Sa=u,ra=s0(b),Ki=!1,N=!0):N=!1),N||nt(u)),J(u),N=u.type,G=u.pendingProps,et=s!==null?s.memoizedProps:null,b=G.children,ms(N,G)?b=null:et!==null&&ms(N,et)&&(u.flags|=32),u.memoizedState!==null&&(N=Zt(s,u,Ce,null,null,p),lr?ji._currentValue=N:ji._currentValue2=N),Qu(s,u),Aa(s,u,b,p),u.child;case 6:return s===null&&un&&(m0(u.pendingProps,ma.current),(s=p=ra)&&(p=wc(p,u.pendingProps,Ki),p!==null?(u.stateNode=p,Sa=u,ra=null,s=!0):s=!1),s||nt(u)),null;case 13:return Gf(s,u,p);case 4:return st(u,u.stateNode.containerInfo),b=u.pendingProps,s===null?u.child=Cs(u,null,b,p):Aa(s,u,b,p),u.child;case 11:return jh(s,u,u.type,u.pendingProps,p);case 7:return Aa(s,u,u.pendingProps,p),u.child;case 8:return Aa(s,u,u.pendingProps.children,p),u.child;case 12:return Aa(s,u,u.pendingProps.children,p),u.child;case 10:return b=u.pendingProps,Re(u,u.type,b.value),Aa(s,u,b.children,p),u.child;case 9:return N=u.type._context,b=u.pendingProps.children,At(u),N=Ht(N),b=b(N),u.flags|=1,Aa(s,u,b,p),u.child;case 14:return Uh(s,u,u.type,u.pendingProps,p);case 15:return Bh(s,u,u.type,u.pendingProps,p);case 19:return Gh(s,u,p);case 31:return b=u.pendingProps,p=u.mode,b={mode:b.mode,children:b.children},s===null?(p=zl(b,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=Ln(s.child,b),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return zh(s,u,p);case 24:return At(u),b=Ht(Nn),s===null?(N=tn(),N===null&&(N=Tn,G=Oe(),N.pooledCache=G,G.refCount++,G!==null&&(N.pooledCacheLanes|=p),N=G),u.memoizedState={parent:b,cache:N},Ta(u),Re(u,Nn,N)):((s.lanes&p)!==0&&(Pa(s,u),Et(u,null,null,p),wt()),N=s.memoizedState,G=u.memoizedState,N.parent!==b?(N={parent:b,cache:b},u.memoizedState=N,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=N),Re(u,Nn,b)):(b=G.cache,Re(u,Nn,b),b!==N.cache&&Xe(u,[Nn],p,!0))),Aa(s,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function mi(s){s.flags|=4}function Pl(s,u){if(s!==null&&s.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(s=u.child;s!==null;){if((s.flags&13878)!==0||(s.subtreeFlags&13878)!==0)return!0;s=s.sibling}return!1}function $u(s,u,p,b){if(ya)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)eu(s,p.stateNode);else if(!(p.tag===4||ia&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(ur)for(var N=u.child;N!==null;){if(N.tag===5){var G=N.stateNode;p&&b&&(G=yd(G,N.type,N.memoizedProps)),eu(s,G)}else if(N.tag===6)G=N.stateNode,p&&b&&(G=e0(G,N.memoizedProps)),eu(s,G);else if(N.tag!==4){if(N.tag===22&&N.memoizedState!==null)G=N.child,G!==null&&(G.return=N),$u(s,N,!0,!0);else if(N.child!==null){N.child.return=N,N=N.child;continue}}if(N===u)break;for(;N.sibling===null;){if(N.return===null||N.return===u)return;N=N.return}N.sibling.return=N.return,N=N.sibling}}function kf(s,u,p,b){var N=!1;if(ur)for(var G=u.child;G!==null;){if(G.tag===5){var et=G.stateNode;p&&b&&(et=yd(et,G.type,G.memoizedProps)),vd(s,et)}else if(G.tag===6)et=G.stateNode,p&&b&&(et=e0(et,G.memoizedProps)),vd(s,et);else if(G.tag!==4){if(G.tag===22&&G.memoizedState!==null)N=G.child,N!==null&&(N.return=G),kf(s,G,!0,!0),N=!0;else if(G.child!==null){G.child.return=G,G=G.child;continue}}if(G===u)break;for(;G.sibling===null;){if(G.return===null||G.return===u)return N;G=G.return}G.sibling.return=G.return,G=G.sibling}return N}function tc(s,u){if(ur&&Pl(s,u)){s=u.stateNode;var p=s.containerInfo,b=md();kf(b,u,!1,!1),s.pendingChildren=b,mi(u),t0(p,b)}}function Il(s,u,p,b){if(ya)s.memoizedProps!==b&&mi(u);else if(ur){var N=s.stateNode,G=s.memoizedProps;if((s=Pl(s,u))||G!==b){var et=ma.current;G=$h(N,p,G,b,!s,null),G===N?u.stateNode=N:(Ko(G,p,b,et)&&mi(u),u.stateNode=G,s?$u(G,u,!1,!1):mi(u))}else u.stateNode=N}}function ec(s,u,p){if(yc(u,p)){if(s.flags|=16777216,!fr(u,p))if(ki())s.flags|=8192;else throw ui=fu,cu}else s.flags&=-16777217}function qf(s,u){if(Qg(u)){if(s.flags|=16777216,!Ad(u))if(ki())s.flags|=8192;else throw ui=fu,cu}else s.flags&=-16777217}function Gl(s,u){u!==null&&(s.flags|=4),s.flags&16384&&(u=s.tag!==22?O():536870912,s.lanes|=u,fi|=u)}function Hl(s,u){if(!un)switch(s.tailMode){case"hidden":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var b=null;p!==null;)p.alternate!==null&&(b=p),p=p.sibling;b===null?u||s.tail===null?s.tail=null:s.tail.sibling=null:b.sibling=null}}function Jn(s){var u=s.alternate!==null&&s.alternate.child===s.child,p=0,b=0;if(u)for(var N=s.child;N!==null;)p|=N.lanes|N.childLanes,b|=N.subtreeFlags&65011712,b|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)p|=N.lanes|N.childLanes,b|=N.subtreeFlags,b|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=b,s.childLanes=p,u}function Gg(s,u,p){var b=u.pendingProps;switch(it(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jn(u),null;case 1:return Jn(u),null;case 3:return p=u.stateNode,b=null,s!==null&&(b=s.memoizedState.cache),u.memoizedState.cache!==b&&(u.flags|=2048),Ee(Nn),V(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Ut(u)?mi(u):s===null||s.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,$t())),tc(s,u),Jn(u),null;case 26:if(Ei){p=u.type;var N=u.memoizedState;return s===null?(mi(u),N!==null?(Jn(u),qf(u,N)):(Jn(u),ec(u,p,b))):N?N!==s.memoizedState?(mi(u),Jn(u),qf(u,N)):(Jn(u),u.flags&=-16777217):(ya?s.memoizedProps!==b&&mi(u):Il(s,u,p,b),Jn(u),ec(u,p,b)),null}case 27:if(ia){if(W(u),p=Hr.current,N=u.type,s!==null&&u.stateNode!=null)ya?s.memoizedProps!==b&&mi(u):Il(s,u,N,b);else{if(!b){if(u.stateNode===null)throw Error(r(166));return Jn(u),null}s=ma.current,Ut(u)?dt(u,s):(s=ru(N,b,p,s,!0),u.stateNode=s,mi(u))}return Jn(u),null}case 5:if(W(u),p=u.type,s!==null&&u.stateNode!=null)Il(s,u,p,b);else{if(!b){if(u.stateNode===null)throw Error(r(166));return Jn(u),null}s=ma.current,Ut(u)?dt(u,s):(N=od(p,b,Hr.current,s,u),$u(N,u,!1,!1),u.stateNode=N,Ko(N,p,b,s)&&mi(u))}return Jn(u),ec(u,u.type,u.pendingProps),null;case 6:if(s&&u.stateNode!=null)p=s.memoizedProps,ya?p!==b&&mi(u):ur&&(p!==b?(u.stateNode=ld(b,Hr.current,ma.current,u),mi(u)):u.stateNode=s.stateNode);else{if(typeof b!="string"&&u.stateNode===null)throw Error(r(166));if(s=Hr.current,p=ma.current,Ut(u)){if(!qn)throw Error(r(176));if(s=u.stateNode,p=u.memoizedProps,b=null,N=Sa,N!==null)switch(N.tag){case 27:case 5:b=N.memoizedProps}_d(s,p,u,b)||nt(u)}else u.stateNode=ld(b,s,p,u)}return Jn(u),null;case 13:if(b=u.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Ut(u),b!==null&&b.dehydrated!==null){if(s===null){if(!N)throw Error(r(318));if(!qn)throw Error(r(344));if(N=u.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));Yg(N,u)}else Xt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Jn(u),N=!1}else N=$t(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return u.flags&256?(Or(u),u):(Or(u),null)}if(Or(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=b!==null,s=s!==null&&s.memoizedState!==null,p){b=u.child,N=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(N=b.alternate.memoizedState.cachePool.pool);var G=null;b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(G=b.memoizedState.cachePool.pool),G!==N&&(b.flags|=2048)}return p!==s&&p&&(u.child.flags|=8192),Gl(u,u.updateQueue),Jn(u),null;case 4:return V(),tc(s,u),s===null&&vs(u.stateNode.containerInfo),Jn(u),null;case 10:return Ee(u.type),Jn(u),null;case 19:if(R(Zn),N=u.memoizedState,N===null)return Jn(u),null;if(b=(u.flags&128)!==0,G=N.rendering,G===null)if(b)Hl(N,!1);else{if(In!==0||s!==null&&(s.flags&128)!==0)for(s=u.child;s!==null;){if(G=Bl(s),G!==null){for(u.flags|=128,Hl(N,!1),s=G.updateQueue,u.updateQueue=s,Gl(u,s),u.subtreeFlags=0,s=p,p=u.child;p!==null;)Ql(p,s),p=p.sibling;return v(Zn,Zn.current&1|2),u.child}s=s.sibling}N.tail!==null&&Ci()>yo&&(u.flags|=128,b=!0,Hl(N,!1),u.lanes=4194304)}else{if(!b)if(s=Bl(G),s!==null){if(u.flags|=128,b=!0,s=s.updateQueue,u.updateQueue=s,Gl(u,s),Hl(N,!0),N.tail===null&&N.tailMode==="hidden"&&!G.alternate&&!un)return Jn(u),null}else 2*Ci()-N.renderingStartTime>yo&&p!==536870912&&(u.flags|=128,b=!0,Hl(N,!1),u.lanes=4194304);N.isBackwards?(G.sibling=u.child,u.child=G):(s=N.last,s!==null?s.sibling=G:u.child=G,N.last=G)}return N.tail!==null?(u=N.tail,N.rendering=u,N.tail=u.sibling,N.renderingStartTime=Ci(),u.sibling=null,s=Zn.current,v(Zn,b?s&1|2:s&1),u):(Jn(u),null);case 22:case 23:return Or(u),En(),b=u.memoizedState!==null,s!==null?s.memoizedState!==null!==b&&(u.flags|=8192):b&&(u.flags|=8192),b?(p&536870912)!==0&&(u.flags&128)===0&&(Jn(u),u.subtreeFlags&6&&(u.flags|=8192)):Jn(u),p=u.updateQueue,p!==null&&Gl(u,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),b=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==p&&(u.flags|=2048),s!==null&&R(qr),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),Ee(Nn),Jn(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function Hg(s,u){switch(it(u),u.tag){case 1:return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 3:return Ee(Nn),V(),s=u.flags,(s&65536)!==0&&(s&128)===0?(u.flags=s&-65537|128,u):null;case 26:case 27:case 5:return W(u),null;case 13:if(Or(u),s=u.memoizedState,s!==null&&s.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Xt()}return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 19:return R(Zn),null;case 4:return V(),null;case 10:return Ee(u.type),null;case 22:case 23:return Or(u),En(),s!==null&&R(qr),s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 24:return Ee(Nn),null;case 25:return null;default:return null}}function Hh(s,u){switch(it(u),u.tag){case 3:Ee(Nn),V();break;case 26:case 27:case 5:W(u);break;case 4:V();break;case 13:Or(u);break;case 19:R(Zn);break;case 10:Ee(u.type);break;case 22:case 23:Or(u),En(),s!==null&&R(qr);break;case 24:Ee(Nn)}}function wa(s,u){try{var p=u.updateQueue,b=p!==null?p.lastEffect:null;if(b!==null){var N=b.next;p=N;do{if((p.tag&s)===s){b=void 0;var G=p.create,et=p.inst;b=G(),et.destroy=b}p=p.next}while(p!==N)}}catch(ut){Ze(u,u.return,ut)}}function Ni(s,u,p){try{var b=u.updateQueue,N=b!==null?b.lastEffect:null;if(N!==null){var G=N.next;b=G;do{if((b.tag&s)===s){var et=b.inst,ut=et.destroy;if(ut!==void 0){et.destroy=void 0,N=u;var St=p,Bt=ut;try{Bt()}catch(It){Ze(N,St,It)}}}b=b.next}while(b!==G)}}catch(It){Ze(u,u.return,It)}}function Vf(s){var u=s.updateQueue;if(u!==null){var p=s.stateNode;try{ae(u,p)}catch(b){Ze(s,s.return,b)}}}function Yf(s,u,p){p.props=Us(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(b){Ze(s,u,b)}}function Bo(s,u){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var b=Xs(s.stateNode);break;case 30:b=s.stateNode;break;default:b=s.stateNode}typeof p=="function"?s.refCleanup=p(b):p.current=b}}catch(N){Ze(s,u,N)}}function Pi(s,u){var p=s.ref,b=s.refCleanup;if(p!==null)if(typeof b=="function")try{b()}catch(N){Ze(s,u,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){Ze(s,u,N)}else p.current=null}function nc(s){var u=s.type,p=s.memoizedProps,b=s.stateNode;try{Xa(b,u,p,s)}catch(N){Ze(s,s.return,N)}}function Kf(s,u,p){try{aa(s.stateNode,s.type,p,u,s)}catch(b){Ze(s,s.return,b)}}function Bs(s){return s.tag===5||s.tag===3||(Ei?s.tag===26:!1)||(ia?s.tag===27&&Zs(s.type):!1)||s.tag===4}function kl(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||Bs(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(ia&&s.tag===27&&Zs(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function zs(s,u,p){var b=s.tag;if(b===5||b===6)s=s.stateNode,u?au(p,s,u):fd(p,s);else if(b!==4&&(ia&&b===27&&Zs(s.type)&&(p=s.stateNode,u=null),s=s.child,s!==null))for(zs(s,u,p),s=s.sibling;s!==null;)zs(s,u,p),s=s.sibling}function zo(s,u,p){var b=s.tag;if(b===5||b===6)s=s.stateNode,u?bc(p,s,u):cd(p,s);else if(b!==4&&(ia&&b===27&&Zs(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(zo(s,u,p),s=s.sibling;s!==null;)zo(s,u,p),s=s.sibling}function Qf(s,u,p){s=s.containerInfo;try{Cc(s,p)}catch(b){Ze(u,u.return,b)}}function os(s){var u=s.stateNode,p=s.memoizedProps;try{b0(s.type,p,u,s)}catch(b){Ze(s,s.return,b)}}function Lo(s,u){for(ps(s.containerInfo),_a=u;_a!==null;)if(s=_a,u=s.child,(s.subtreeFlags&1024)!==0&&u!==null)u.return=s,_a=u;else for(;_a!==null;){s=_a;var p=s.alternate;switch(u=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0;var b=s,N=p.memoizedProps;p=p.memoizedState;var G=b.stateNode;try{var et=Us(b.type,N,b.elementType===b.type);u=G.getSnapshotBeforeUpdate(et,p),G.__reactInternalSnapshotBeforeUpdate=u}catch(ut){Ze(b,b.return,ut)}}break;case 3:(u&1024)!==0&&ya&&Wh(s.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=s.sibling,u!==null){u.return=s.return,_a=u;break}_a=s.return}}function ac(s,u,p){var b=p.flags;switch(p.tag){case 0:case 11:case 15:ar(s,p),b&4&&wa(5,p);break;case 1:if(ar(s,p),b&4)if(s=p.stateNode,u===null)try{s.componentDidMount()}catch(et){Ze(p,p.return,et)}else{var N=Us(p.type,u.memoizedProps);u=u.memoizedState;try{s.componentDidUpdate(N,u,s.__reactInternalSnapshotBeforeUpdate)}catch(et){Ze(p,p.return,et)}}b&64&&Vf(p),b&512&&Bo(p,p.return);break;case 3:if(ar(s,p),b&64&&(s=p.updateQueue,s!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=Xs(p.child.stateNode);break;case 1:u=p.child.stateNode}try{ae(s,u)}catch(et){Ze(p,p.return,et)}}break;case 27:ia&&u===null&&b&4&&os(p);case 26:case 5:ar(s,p),u===null&&b&4&&nc(p),b&512&&Bo(p,p.return);break;case 12:ar(s,p);break;case 13:ar(s,p),b&4&&Ff(s,p),b&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=nd.bind(null,p),Sd(s,p))));break;case 22:if(b=p.memoizedState!==null||yr,!b){u=u!==null&&u.memoizedState!==null||Vn,N=yr;var G=Vn;yr=b,(Vn=u)&&!G?Ii(s,p,(p.subtreeFlags&8772)!==0):ar(s,p),yr=N,Vn=G}break;case 30:break;default:ar(s,p)}}function Xf(s){var u=s.alternate;u!==null&&(s.alternate=null,Xf(u)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(u=s.stateNode,u!==null&&na(u)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Ra(s,u,p){for(p=p.child;p!==null;)ic(s,u,p),p=p.sibling}function ic(s,u,p){if(oi&&typeof oi.onCommitFiberUnmount=="function")try{oi.onCommitFiberUnmount(Jo,p)}catch{}switch(p.tag){case 26:if(Ei){Vn||Pi(p,u),Ra(s,u,p),p.memoizedState?Cd(p.memoizedState):p.stateNode&&Td(p.stateNode);break}case 27:if(ia){Vn||Pi(p,u);var b=ve,N=ke;Zs(p.type)&&(ve=p.stateNode,ke=!1),Ra(s,u,p),wd(p.stateNode),ve=b,ke=N;break}case 5:Vn||Pi(p,u);case 6:if(ya){if(b=ve,N=ke,ve=null,Ra(s,u,p),ve=b,ke=N,ve!==null)if(ke)try{hd(ve,p.stateNode)}catch(G){Ze(p,u,G)}else try{_c(ve,p.stateNode)}catch(G){Ze(p,u,G)}}else Ra(s,u,p);break;case 18:ya&&ve!==null&&(ke?g0(ve,p.stateNode):h0(ve,p.stateNode));break;case 4:ya?(b=ve,N=ke,ve=p.stateNode.containerInfo,ke=!0,Ra(s,u,p),ve=b,ke=N):(ur&&Qf(p.stateNode,p,md()),Ra(s,u,p));break;case 0:case 11:case 14:case 15:Vn||Ni(2,p,u),Vn||Ni(4,p,u),Ra(s,u,p);break;case 1:Vn||(Pi(p,u),b=p.stateNode,typeof b.componentWillUnmount=="function"&&Yf(p,u,b)),Ra(s,u,p);break;case 21:Ra(s,u,p);break;case 22:Vn=(b=Vn)||p.memoizedState!==null,Ra(s,u,p),Vn=b;break;default:Ra(s,u,p)}}function Ff(s,u){if(qn&&u.memoizedState===null&&(s=u.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{d0(s)}catch(p){Ze(u,u.return,p)}}function kh(s){switch(s.tag){case 13:case 19:var u=s.stateNode;return u===null&&(u=s.stateNode=new O0),u;case 22:return s=s.stateNode,u=s._retryCache,u===null&&(u=s._retryCache=new O0),u;default:throw Error(r(435,s.tag))}}function Jf(s,u){var p=kh(s);u.forEach(function(b){var N=ad.bind(null,s,b);p.has(b)||(p.add(b),b.then(N,N))})}function Ya(s,u){var p=u.deletions;if(p!==null)for(var b=0;b<p.length;b++){var N=p[b],G=s,et=u;if(ya){var ut=et;t:for(;ut!==null;){switch(ut.tag){case 27:if(ia){if(Zs(ut.type)){ve=ut.stateNode,ke=!1;break t}break}case 5:ve=ut.stateNode,ke=!1;break t;case 3:case 4:ve=ut.stateNode.containerInfo,ke=!0;break t}ut=ut.return}if(ve===null)throw Error(r(160));ic(G,et,N),ve=null,ke=!1}else ic(G,et,N);G=N.alternate,G!==null&&(G.return=null),N.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)qh(u,s),u=u.sibling}function qh(s,u){var p=s.alternate,b=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ya(u,s),Ka(s),b&4&&(Ni(3,s,s.return),wa(3,s),Ni(5,s,s.return));break;case 1:Ya(u,s),Ka(s),b&512&&(Vn||p===null||Pi(p,p.return)),b&64&&yr&&(s=s.updateQueue,s!==null&&(b=s.callbacks,b!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?b:p.concat(b))));break;case 26:if(Ei){var N=we;if(Ya(u,s),Ka(s),b&512&&(Vn||p===null||Pi(p,p.return)),b&4){b=p!==null?p.memoizedState:null;var G=s.memoizedState;p===null?G===null?s.stateNode===null?s.stateNode=y0(N,s.type,s.memoizedProps,s):Mc(N,s.type,s.stateNode):s.stateNode=Nc(N,G,s.memoizedProps):b!==G?(b===null?p.stateNode!==null&&Td(p.stateNode):Cd(b),G===null?Mc(N,s.type,s.stateNode):Nc(N,G,s.memoizedProps)):G===null&&s.stateNode!==null&&Kf(s,s.memoizedProps,p.memoizedProps)}break}case 27:if(ia){Ya(u,s),Ka(s),b&512&&(Vn||p===null||Pi(p,p.return)),p!==null&&b&4&&Kf(s,s.memoizedProps,p.memoizedProps);break}case 5:if(Ya(u,s),Ka(s),b&512&&(Vn||p===null||Pi(p,p.return)),ya){if(s.flags&32){N=s.stateNode;try{hr(N)}catch(It){Ze(s,s.return,It)}}b&4&&s.stateNode!=null&&(N=s.memoizedProps,Kf(s,N,p!==null?p.memoizedProps:N)),b&1024&&(Gc=!0)}break;case 6:if(Ya(u,s),Ka(s),b&4&&ya){if(s.stateNode===null)throw Error(r(162));b=s.memoizedProps,p=p!==null?p.memoizedProps:b,N=s.stateNode;try{dd(N,p,b)}catch(It){Ze(s,s.return,It)}}break;case 3:if(Ei?(Kg(),N=we,we=xc(u.containerInfo),Ya(u,s),we=N):Ya(u,s),Ka(s),b&4){if(ya&&qn&&p!==null&&p.memoizedState.isDehydrated)try{f0(u.containerInfo)}catch(It){Ze(s,s.return,It)}if(ur){b=u.containerInfo,p=u.pendingChildren;try{Cc(b,p)}catch(It){Ze(s,s.return,It)}}}Gc&&(Gc=!1,Zf(s));break;case 4:Ei?(p=we,we=xc(s.stateNode.containerInfo),Ya(u,s),Ka(s),we=p):(Ya(u,s),Ka(s)),b&4&&ur&&Qf(s.stateNode,s,s.stateNode.pendingChildren);break;case 12:Ya(u,s),Ka(s);break;case 13:Ya(u,s),Ka(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(vo=Ci()),b&4&&(b=s.updateQueue,b!==null&&(s.updateQueue=null,Jf(s,b)));break;case 22:N=s.memoizedState!==null;var et=p!==null&&p.memoizedState!==null,ut=yr,St=Vn;if(yr=ut||N,Vn=St||et,Ya(u,s),Vn=St,yr=ut,Ka(s),b&8192&&(u=s.stateNode,u._visibility=N?u._visibility&-2:u._visibility|1,N&&(p===null||et||yr||Vn||Oa(s)),ya)){t:if(p=null,ya)for(u=s;;){if(u.tag===5||Ei&&u.tag===26){if(p===null){et=p=u;try{G=et.stateNode,N?Ec(G):pd(et.stateNode,et.memoizedProps)}catch(It){Ze(et,et.return,It)}}}else if(u.tag===6){if(p===null){et=u;try{var Bt=et.stateNode;N?gd(Bt):Zh(Bt,et.memoizedProps)}catch(It){Ze(et,et.return,It)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===s)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break t;for(;u.sibling===null;){if(u.return===null||u.return===s)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}b&4&&(b=s.updateQueue,b!==null&&(p=b.retryQueue,p!==null&&(b.retryQueue=null,Jf(s,p))));break;case 19:Ya(u,s),Ka(s),b&4&&(b=s.updateQueue,b!==null&&(s.updateQueue=null,Jf(s,b)));break;case 30:break;case 21:break;default:Ya(u,s),Ka(s)}}function Ka(s){var u=s.flags;if(u&2){try{if(ya){for(var p,b=s.return;b!==null;){if(Bs(b)){p=b;break}b=b.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:if(ia){var N=p.stateNode,G=kl(s);zo(s,G,N);break}case 5:var et=p.stateNode;p.flags&32&&(hr(et),p.flags&=-33);var ut=kl(s);zo(s,ut,et);break;case 3:case 4:var St=p.stateNode.containerInfo,Bt=kl(s);zs(s,Bt,St);break;default:throw Error(r(161))}}}catch(It){Ze(s,s.return,It)}s.flags&=-3}u&4096&&(s.flags&=-4097)}function Zf(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var u=s;Zf(u),u.tag===5&&u.flags&1024&&Fs(u.stateNode),s=s.sibling}}function ar(s,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)ac(s,u.alternate,u),u=u.sibling}function Oa(s){for(s=s.child;s!==null;){var u=s;switch(u.tag){case 0:case 11:case 14:case 15:Ni(4,u,u.return),Oa(u);break;case 1:Pi(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&Yf(u,u.return,p),Oa(u);break;case 27:ia&&wd(u.stateNode);case 26:case 5:Pi(u,u.return),Oa(u);break;case 22:u.memoizedState===null&&Oa(u);break;case 30:Oa(u);break;default:Oa(u)}s=s.sibling}}function Ii(s,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var b=u.alternate,N=s,G=u,et=G.flags;switch(G.tag){case 0:case 11:case 15:Ii(N,G,p),wa(4,G);break;case 1:if(Ii(N,G,p),b=G,N=b.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Bt){Ze(b,b.return,Bt)}if(b=G,N=b.updateQueue,N!==null){var ut=b.stateNode;try{var St=N.shared.hiddenCallbacks;if(St!==null)for(N.shared.hiddenCallbacks=null,N=0;N<St.length;N++)te(St[N],ut)}catch(Bt){Ze(b,b.return,Bt)}}p&&et&64&&Vf(G),Bo(G,G.return);break;case 27:ia&&os(G);case 26:case 5:Ii(N,G,p),p&&b===null&&et&4&&nc(G),Bo(G,G.return);break;case 12:Ii(N,G,p);break;case 13:Ii(N,G,p),p&&et&4&&Ff(N,G);break;case 22:G.memoizedState===null&&Ii(N,G,p),Bo(G,G.return);break;case 30:break;default:Ii(N,G,p)}u=u.sibling}}function ai(s,u){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(s=u.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&$e(p))}function ls(s,u){s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&$e(s))}function Mi(s,u,p,b){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)ql(s,u,p,b),u=u.sibling}function ql(s,u,p,b){var N=u.flags;switch(u.tag){case 0:case 11:case 15:Mi(s,u,p,b),N&2048&&wa(9,u);break;case 1:Mi(s,u,p,b);break;case 3:Mi(s,u,p,b),N&2048&&(s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&$e(s)));break;case 12:if(N&2048){Mi(s,u,p,b),s=u.stateNode;try{var G=u.memoizedProps,et=G.id,ut=G.onPostCommit;typeof ut=="function"&&ut(et,u.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(St){Ze(u,u.return,St)}}else Mi(s,u,p,b);break;case 13:Mi(s,u,p,b);break;case 23:break;case 22:G=u.stateNode,et=u.alternate,u.memoizedState!==null?G._visibility&2?Mi(s,u,p,b):Ls(s,u):G._visibility&2?Mi(s,u,p,b):(G._visibility|=2,xr(s,u,p,b,(u.subtreeFlags&10256)!==0)),N&2048&&ai(et,u);break;case 24:Mi(s,u,p,b),N&2048&&ls(u.alternate,u);break;default:Mi(s,u,p,b)}}function xr(s,u,p,b,N){for(N=N&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var G=s,et=u,ut=p,St=b,Bt=et.flags;switch(et.tag){case 0:case 11:case 15:xr(G,et,ut,St,N),wa(8,et);break;case 23:break;case 22:var It=et.stateNode;et.memoizedState!==null?It._visibility&2?xr(G,et,ut,St,N):Ls(G,et):(It._visibility|=2,xr(G,et,ut,St,N)),N&&Bt&2048&&ai(et.alternate,et);break;case 24:xr(G,et,ut,St,N),N&&Bt&2048&&ls(et.alternate,et);break;default:xr(G,et,ut,St,N)}u=u.sibling}}function Ls(s,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=s,b=u,N=b.flags;switch(b.tag){case 22:Ls(p,b),N&2048&&ai(b.alternate,b);break;case 24:Ls(p,b),N&2048&&ls(b.alternate,b);break;default:Ls(p,b)}u=u.sibling}}function vi(s){if(s.subtreeFlags&Pe)for(s=s.child;s!==null;)Wf(s),s=s.sibling}function Wf(s){switch(s.tag){case 26:vi(s),s.flags&Pe&&(s.memoizedState!==null?iu(we,s.memoizedState,s.memoizedProps):yn(s.type,s.memoizedProps));break;case 5:vi(s),s.flags&Pe&&yn(s.type,s.memoizedProps);break;case 3:case 4:if(Ei){var u=we;we=xc(s.stateNode.containerInfo),vi(s),we=u}else vi(s);break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Pe,Pe=16777216,vi(s),Pe=u):vi(s));break;default:vi(s)}}function Vl(s){var u=s.alternate;if(u!==null&&(s=u.child,s!==null)){u.child=null;do u=s.sibling,s.sibling=null,s=u;while(s!==null)}}function ir(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var b=u[p];_a=b,rc(b,s)}Vl(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Vh(s),s=s.sibling}function Vh(s){switch(s.tag){case 0:case 11:case 15:ir(s),s.flags&2048&&Ni(9,s,s.return);break;case 3:ir(s);break;case 12:ir(s);break;case 22:var u=s.stateNode;s.memoizedState!==null&&u._visibility&2&&(s.return===null||s.return.tag!==13)?(u._visibility&=-3,Ia(s)):ir(s);break;default:ir(s)}}function Ia(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var b=u[p];_a=b,rc(b,s)}Vl(s)}for(s=s.child;s!==null;){switch(u=s,u.tag){case 0:case 11:case 15:Ni(8,u,u.return),Ia(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,Ia(u));break;default:Ia(u)}s=s.sibling}}function rc(s,u){for(;_a!==null;){var p=_a;switch(p.tag){case 0:case 11:case 15:Ni(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var b=p.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:$e(p.memoizedState.cache)}if(b=p.child,b!==null)b.return=p,_a=b;else t:for(p=s;_a!==null;){b=_a;var N=b.sibling,G=b.return;if(Xf(b),b===p){_a=null;break t}if(N!==null){N.return=G,_a=N;break t}_a=G}}}function Gi(s){var u=Di(s);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(r(364));return u}if(s=kg(s),s===null)throw Error(r(362));return s.stateNode.current}function sc(s,u){var p=s.tag;switch(u.$$typeof){case Ha:if(s.type===u.value)return!0;break;case Xi:t:{for(u=u.value,s=[s,0],p=0;p<s.length;){var b=s[p++],N=b.tag,G=s[p++],et=u[G];if(N!==5&&N!==26&&N!==27||!Js(b)){for(;et!=null&&sc(b,et);)G++,et=u[G];if(G===u.length){u=!0;break t}else for(b=b.child;b!==null;)s.push(b,G),b=b.sibling}}u=!1}return u;case Vr:if((p===5||p===26||p===27)&&Fh(s.stateNode,u.value))return!0;break;case Bi:if((p===5||p===6||p===26||p===27)&&(s=ud(s),s!==null&&0<=s.indexOf(u.value)))return!0;break;case tl:if((p===5||p===26||p===27)&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Po(s){switch(s.$$typeof){case Ha:return"<"+(C(s.value)||"Unknown")+">";case Xi:return":has("+(Po(s)||"")+")";case Vr:return'[role="'+s.value+'"]';case Bi:return'"'+s.value+'"';case tl:return'[data-testname="'+s.value+'"]';default:throw Error(r(365))}}function us(s,u){var p=[];s=[s,0];for(var b=0;b<s.length;){var N=s[b++],G=N.tag,et=s[b++],ut=u[et];if(G!==5&&G!==26&&G!==27||!Js(N)){for(;ut!=null&&sc(N,ut);)et++,ut=u[et];if(et===u.length)p.push(N);else for(N=N.child;N!==null;)s.push(N,et),N=N.sibling}}return p}function Yl(s,u){if(!dr)throw Error(r(363));s=Gi(s),s=us(s,u),u=[],s=Array.from(s);for(var p=0;p<s.length;){var b=s[p++],N=b.tag;if(N===5||N===26||N===27)Js(b)||u.push(b.stateNode);else for(b=b.child;b!==null;)s.push(b),b=b.sibling}return u}function ii(){if((Ie&2)!==0&&Ve!==0)return Ve&-Ve;if(ge.T!==null){var s=mr;return s!==0?s:qt()}return ys()}function oc(){Ua===0&&(Ua=(Ve&536870912)===0||un?L():536870912);var s=wi.current;return s!==null&&(s.flags|=32),Ua}function ri(s,u,p){(s===Tn&&(sn===2||sn===9)||s.cancelPendingCommit!==null)&&(xa(s,0),Hi(s,Ve,Ua,!1)),A(s,p),((Ie&2)===0||s!==Tn)&&(s===Tn&&((Ie&2)===0&&(Gn|=p),In===4&&Hi(s,Ve,Ua,!1)),xe(s))}function yi(s,u,p){if((Ie&6)!==0)throw Error(r(327));var b=!p&&(u&124)===0&&(u&s.expiredLanes)===0||j(s,u),N=b?Yh(s,u):Kl(s,u,!0),G=b;do{if(N===0){Yr&&!b&&Hi(s,u,0,!1);break}else{if(p=s.current.alternate,G&&!Io(p)){N=Kl(s,u,!1),G=!1;continue}if(N===2){if(G=u,s.errorRecoveryDisabledLanes&G)var et=0;else et=s.pendingLanes&-536870913,et=et!==0?et:et&536870912?536870912:0;if(et!==0){u=et;t:{var ut=s;N=mo;var St=qn&&ut.current.memoizedState.isDehydrated;if(St&&(xa(ut,et).flags|=256),et=Kl(ut,et,!1),et!==2){if(Hc&&!St){ut.errorRecoveryDisabledLanes|=G,Gn|=G,N=4;break t}G=ka,ka=N,G!==null&&(ka===null?ka=G:ka.push.apply(ka,G))}N=et}if(G=!1,N!==2)continue}}if(N===1){xa(s,0),Hi(s,u,0,!0);break}t:{switch(b=s,G=N,G){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:Hi(b,u,Ua,!Sr);break t;case 2:ka=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(N=vo+300-Ci(),10<N)){if(Hi(b,u,Ua,!Sr),P(b,0,!0)!==0)break t;b.timeoutHandle=Xh(Ps.bind(null,b,p,ka,qa,kc,u,Ua,Gn,fi,Sr,G,2,-0,0),N);break t}Ps(b,p,ka,qa,kc,u,Ua,Gn,fi,Sr,G,0,-0,0)}}break}while(!0);xe(s)}function Ps(s,u,p,b,N,G,et,ut,St,Bt,It,Wt,ne,je){if(s.timeoutHandle=or,Wt=u.subtreeFlags,(Wt&8192||(Wt&16785408)===16785408)&&(De(),Wf(u),Wt=ha(),Wt!==null)){s.cancelPendingCommit=Wt(Mr.bind(null,s,u,G,p,b,N,et,ut,St,It,1,ne,je)),Hi(s,G,et,!Bt);return}Mr(s,u,G,p,b,N,et,ut,St)}function Io(s){for(var u=s;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var b=0;b<p.length;b++){var N=p[b],G=N.getSnapshot;N=N.value;try{if(!Ja(G(),N))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Hi(s,u,p,b){u&=~br,u&=~Gn,s.suspendedLanes|=u,s.pingedLanes&=~u,b&&(s.warmLanes|=u),b=s.expirationTimes;for(var N=u;0<N;){var G=31-Fa(N),et=1<<G;b[G]=-1,N&=~et}p!==0&&B(s,p,u)}function Go(){return(Ie&6)===0?(ct(0),!1):!0}function si(){if(be!==null){if(sn===0)var s=be.return;else s=be,Da=_s=null,kn(s),ci=null,fo=0,s=be;for(;s!==null;)Hh(s.alternate,s),s=s.return;be=null}}function xa(s,u){var p=s.timeoutHandle;p!==or&&(s.timeoutHandle=or,Qo(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),si(),Tn=s,be=p=Ln(s.current,null),Ve=u,sn=0,Dn=null,Sr=!1,Yr=j(s,u),Hc=!1,fi=Ua=br=Gn=$a=In=0,ka=mo=null,kc=!1,(u&8)!==0&&(u|=u&32);var b=s.entangledLanes;if(b!==0)for(s=s.entanglements,b&=u;0<b;){var N=31-Fa(b),G=1<<N;u|=s[N],b&=~G}return zi=u,Ke(),p}function Nr(s,u){pe=null,ge.H=ja,u===io||u===ro?(u=Ge(),sn=3):u===cu?(u=Ge(),sn=4):sn=u===Ld?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Dn=u,be===null&&(In=1,Do(s,F(u,s.current)))}function ki(){var s=wi.current;return s===null?!0:(Ve&4194048)===Ve?Wa===null:(Ve&62914560)===Ve||(Ve&536870912)!==0?s===Wa:!1}function qi(){var s=ge.H;return ge.H=ja,s===null?ja:s}function rr(){var s=ge.A;return ge.A=Sn,s}function lc(){In=4,Sr||(Ve&4194048)!==Ve&&wi.current!==null||(Yr=!0),($a&134217727)===0&&(Gn&134217727)===0||Tn===null||Hi(Tn,Ve,Ua,!1)}function Kl(s,u,p){var b=Ie;Ie|=2;var N=qi(),G=rr();(Tn!==s||Ve!==u)&&(qa=null,xa(s,u)),u=!1;var et=In;t:do try{if(sn!==0&&be!==null){var ut=be,St=Dn;switch(sn){case 8:si(),et=6;break t;case 3:case 2:case 9:case 6:wi.current===null&&(u=!0);var Bt=sn;if(sn=0,Dn=null,Si(s,ut,St,Bt),p&&Yr){et=0;break t}break;default:Bt=sn,sn=0,Dn=null,Si(s,ut,St,Bt)}}$f(),et=In;break}catch(It){Nr(s,It)}while(!0);return u&&s.shellSuspendCounter++,Da=_s=null,Ie=b,ge.H=N,ge.A=G,be===null&&(Tn=null,Ve=0,Ke()),et}function $f(){for(;be!==null;)xn(be)}function Yh(s,u){var p=Ie;Ie|=2;var b=qi(),N=rr();Tn!==s||Ve!==u?(qa=null,yo=Ci()+500,xa(s,u)):Yr=j(s,u);t:do try{if(sn!==0&&be!==null){u=be;var G=Dn;e:switch(sn){case 1:sn=0,Dn=null,Si(s,u,G,1);break;case 2:case 9:if(Nt(G)){sn=0,Dn=null,Fe(u);break}u=function(){sn!==2&&sn!==9||Tn!==s||(sn=7),xe(s)},G.then(u,u);break t;case 3:sn=7;break t;case 4:sn=5;break t;case 7:Nt(G)?(sn=0,Dn=null,Fe(u)):(sn=0,Dn=null,Si(s,u,G,7));break;case 5:var et=null;switch(be.tag){case 26:et=be.memoizedState;case 5:case 27:var ut=be,St=ut.type,Bt=ut.pendingProps;if(et?Ad(et):fr(St,Bt)){sn=0,Dn=null;var It=ut.sibling;if(It!==null)be=It;else{var Wt=ut.return;Wt!==null?(be=Wt,Qa(Wt)):be=null}break e}}sn=0,Dn=null,Si(s,u,G,5);break;case 6:sn=0,Dn=null,Si(s,u,G,6);break;case 8:si(),In=6;break t;default:throw Error(r(462))}}Na();break}catch(ne){Nr(s,ne)}while(!0);return Da=_s=null,ge.H=b,ge.A=N,Ie=p,be!==null?0:(Tn=null,Ve=0,Ke(),In)}function Na(){for(;be!==null&&!jc();)xn(be)}function xn(s){var u=Uo(s.alternate,s,zi);s.memoizedProps=s.pendingProps,u===null?Qa(s):be=u}function Fe(s){var u=s,p=u.alternate;switch(u.tag){case 15:case 0:u=Xu(p,u,u.pendingProps,u.type,void 0,Ve);break;case 11:u=Xu(p,u,u.pendingProps,u.type.render,u.ref,Ve);break;case 5:kn(u);default:Hh(p,u),u=be=Ql(u,zi),u=Uo(p,u,zi)}s.memoizedProps=s.pendingProps,u===null?Qa(s):be=u}function Si(s,u,p,b){Da=_s=null,kn(u),ci=null,fo=0;var N=u.return;try{if(Ig(s,N,u,p,Ve)){In=1,Do(s,F(p,s.current)),be=null;return}}catch(G){if(N!==null)throw be=N,G;In=1,Do(s,F(p,s.current)),be=null;return}u.flags&32768?(un||b===1?s=!0:Yr||(Ve&536870912)!==0?s=!1:(Sr=s=!0,(b===2||b===9||b===3||b===6)&&(b=wi.current,b!==null&&b.tag===13&&(b.flags|=16384))),uc(u,s)):Qa(u)}function Qa(s){var u=s;do{if((u.flags&32768)!==0){uc(u,Sr);return}s=u.return;var p=Gg(u.alternate,u,zi);if(p!==null){be=p;return}if(u=u.sibling,u!==null){be=u;return}be=u=s}while(u!==null);In===0&&(In=5)}function uc(s,u){do{var p=Hg(s.alternate,s);if(p!==null){p.flags&=32767,be=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(s=s.sibling,s!==null)){be=s;return}be=s=p}while(s!==null);In=6,be=null}function Mr(s,u,p,b,N,G,et,ut,St){s.cancelPendingCommit=null;do Gs();while(gn!==0);if((Ie&6)!==0)throw Error(r(327));if(u!==null){if(u===s.current)throw Error(r(177));if(G=u.lanes|u.childLanes,G|=Ic,y(s,p,G,et,ut,St),s===Tn&&(be=Tn=null,Ve=0),So=u,Qr=s,el=p,_r=G,nl=N,qc=b,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,ko(Od,function(){return Ho(),null})):(s.callbackNode=null,s.callbackPriority=0),b=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||b){b=ge.T,ge.T=null,N=cr(),da(2),et=Ie,Ie|=4;try{Lo(s,u,p)}finally{Ie=et,da(N),ge.T=b}}gn=1,td(),ed(),Is()}}function td(){if(gn===1){gn=0;var s=Qr,u=So,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=ge.T,ge.T=null;var b=cr();da(2);var N=Ie;Ie|=4;try{qh(u,s),tu(s.containerInfo)}finally{Ie=N,da(b),ge.T=p}}s.current=u,gn=2}}function ed(){if(gn===2){gn=0;var s=Qr,u=So,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=ge.T,ge.T=null;var b=cr();da(2);var N=Ie;Ie|=4;try{ac(s,u.alternate,u)}finally{Ie=N,da(b),ge.T=p}}gn=3}}function Is(){if(gn===4||gn===3){gn=0,C0();var s=Qr,u=So,p=el,b=qc;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?gn=5:(gn=0,So=Qr=null,cs(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(Kr=null),K(p),u=u.stateNode,oi&&typeof oi.onCommitFiberRoot=="function")try{oi.onCommitFiberRoot(Jo,u,void 0,(u.current.flags&128)===128)}catch{}if(b!==null){u=ge.T,N=cr(),da(2),ge.T=null;try{for(var G=s.onRecoverableError,et=0;et<b.length;et++){var ut=b[et];G(ut.value,{componentStack:ut.stack})}}finally{ge.T=u,da(N)}}(el&3)!==0&&Gs(),xe(s),N=s.pendingLanes,(p&4194090)!==0&&(N&42)!==0?s===Vc?Er++:(Er=0,Vc=s):Er=0,ct(0)}}function cs(s,u){(s.pooledCacheLanes&=u)===0&&(u=s.pooledCache,u!=null&&(s.pooledCache=null,$e(u)))}function Gs(s){return td(),ed(),Is(),Ho()}function Ho(){if(gn!==5)return!1;var s=Qr,u=_r;_r=0;var p=K(el),b=32>p?32:p;p=ge.T;var N=cr();try{da(b),ge.T=null,b=nl,nl=null;var G=Qr,et=el;if(gn=0,So=Qr=null,el=0,(Ie&6)!==0)throw Error(r(331));var ut=Ie;if(Ie|=4,Vh(G.current),ql(G,G.current,et,b),Ie=ut,ct(0,!1),oi&&typeof oi.onPostCommitFiberRoot=="function")try{oi.onPostCommitFiberRoot(Jo,G)}catch{}return!0}finally{da(N),ge.T=p,cs(s,u)}}function cc(s,u,p){u=F(p,u),u=Lf(s.stateNode,u,2),s=Li(s,u,2),s!==null&&(A(s,2),xe(s))}function Ze(s,u,p){if(s.tag===3)cc(s,s,p);else for(;u!==null;){if(u.tag===3){cc(u,s,p);break}else if(u.tag===1){var b=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(Kr===null||!Kr.has(b))){s=F(p,s),p=Dh(2),b=Li(u,p,2),b!==null&&(Pf(p,b,u,s),A(b,2),xe(b));break}}u=u.return}}function Vi(s,u,p){var b=s.pingCache;if(b===null){b=s.pingCache=new Ts;var N=new Set;b.set(u,N)}else N=b.get(u),N===void 0&&(N=new Set,b.set(u,N));N.has(p)||(Hc=!0,N.add(p),s=fs.bind(null,s,u,p),u.then(s,s))}function fs(s,u,p){var b=s.pingCache;b!==null&&b.delete(u),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,Tn===s&&(Ve&p)===p&&(In===4||In===3&&(Ve&62914560)===Ve&&300>Ci()-vo?(Ie&2)===0&&xa(s,0):br|=p,fi===Ve&&(fi=0)),xe(s)}function sr(s,u){u===0&&(u=O()),s=Le(s,u),s!==null&&(A(s,u),xe(s))}function nd(s){var u=s.memoizedState,p=0;u!==null&&(p=u.retryLane),sr(s,p)}function ad(s,u){var p=0;switch(s.tag){case 13:var b=s.stateNode,N=s.memoizedState;N!==null&&(p=N.retryLane);break;case 19:b=s.stateNode;break;case 22:b=s.stateNode._retryCache;break;default:throw Error(r(314))}b!==null&&b.delete(u),sr(s,p)}function ko(s,u){return lu(s,u)}function fc(s,u,p,b){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ln(s,u){var p=s.alternate;return p===null?(p=n(s.tag,u,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=u,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,u=s.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Ql(s,u){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,u=p.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),s}function Xl(s,u,p,b,N,G){var et=0;if(b=s,typeof s=="function")Dr(s)&&(et=1);else if(typeof s=="string")et=Ei&&ia?Ed(s,p,ma.current)?26:Fo(s)?27:5:Ei?Ed(s,p,ma.current)?26:5:ia&&Fo(s)?27:5;else t:switch(s){case hs:return s=n(31,p,u,N),s.elementType=hs,s.lanes=G,s;case Vs:return Hs(p.children,N,G,u);case Ys:et=8,N|=24;break;case Fl:return s=n(12,p,u,N|2),s.elementType=Fl,s.lanes=G,s;case Br:return s=n(13,p,u,N),s.elementType=Br,s.lanes=G,s;case zr:return s=n(19,p,u,N),s.elementType=zr,s.lanes=G,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case pc:case Ur:et=10;break t;case Jl:et=9;break t;case mc:et=11;break t;case vc:et=14;break t;case Lr:et=16,b=null;break t}et=29,p=Error(r(130,s===null?"null":typeof s,"")),b=null}return u=n(et,p,u,N),u.elementType=s,u.type=b,u.lanes=G,u}function Hs(s,u,p,b){return s=n(7,s,b,u),s.lanes=p,s}function id(s,u,p){return s=n(6,s,null,u),s.lanes=p,s}function rd(s,u,p){return u=n(4,s.children!==null?s.children:[],s.key,u),u.lanes=p,u.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},u}function fa(s,u,p,b,N,G,et,ut){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=or,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=T(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=T(0),this.hiddenUpdates=T(null),this.identifierPrefix=b,this.onUncaughtError=N,this.onCaughtError=G,this.onRecoverableError=et,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ut,this.incompleteTransitions=new Map}function dc(s,u,p,b,N,G,et,ut,St,Bt,It,Wt){return s=new fa(s,u,p,et,ut,St,Bt,Wt),u=1,G===!0&&(u|=24),G=n(3,null,null,u),s.current=G,G.stateNode=s,u=Oe(),u.refCount++,s.pooledCache=u,u.refCount++,G.memoizedState={element:b,isDehydrated:p,cache:u},Ta(G),s}function qo(s){return s?(s=Ss,s):Ss}function Vo(s){var u=s._reactInternals;if(u===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(u),s=s!==null?g(s):null,s===null?null:Xs(s.stateNode)}function hc(s,u,p,b,N,G){N=qo(N),b.context===null?b.context=N:b.pendingContext=N,b=gi(u),b.payload={element:p},G=G===void 0?null:G,G!==null&&(b.callback=G),p=Li(s,b,u),p!==null&&(ri(p,s,u),ca(p,s,u))}function ks(s,u){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<u?p:u}}function ds(s,u){ks(s,u),(s=s.alternate)&&ks(s,u)}var Qe={},Kh=wg(),bi=n_(),gc=Object.assign,qs=Symbol.for("react.element"),Yo=Symbol.for("react.transitional.element"),jr=Symbol.for("react.portal"),Vs=Symbol.for("react.fragment"),Ys=Symbol.for("react.strict_mode"),Fl=Symbol.for("react.profiler"),pc=Symbol.for("react.provider"),Jl=Symbol.for("react.consumer"),Ur=Symbol.for("react.context"),mc=Symbol.for("react.forward_ref"),Br=Symbol.for("react.suspense"),zr=Symbol.for("react.suspense_list"),vc=Symbol.for("react.memo"),Lr=Symbol.for("react.lazy"),hs=Symbol.for("react.activity"),Zl=Symbol.for("react.memo_cache_sentinel"),Wl=Symbol.iterator,$l=Symbol.for("react.client.reference"),Ks=Array.isArray,ge=Kh.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Qs=t.rendererVersion,Qh=t.rendererPackageName,Pr=t.extraDevToolsConfig,Xs=t.getPublicInstance,sd=t.getRootHostContext,gs=t.getChildHostContext,ps=t.prepareForCommit,tu=t.resetAfterCommit,od=t.createInstance;t.cloneMutableInstance;var eu=t.appendInitialChild,Ko=t.finalizeInitialChildren,ms=t.shouldSetTextContent,ld=t.createTextInstance;t.cloneMutableTextInstance;var Xh=t.scheduleTimeout,Qo=t.cancelTimeout,or=t.noTimeout,lr=t.isPrimaryRenderer;t.warnsIfNotActing;var ya=t.supportsMutation,ur=t.supportsPersistence,qn=t.supportsHydration,Di=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var vs=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var da=t.setCurrentUpdatePriority,cr=t.getCurrentUpdatePriority,ys=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var _i=t.shouldAttemptEagerTransition,na=t.detachDeletedInstance;t.requestPostPaintCallback;var yc=t.maySuspendCommit,fr=t.preloadInstance,De=t.startSuspendingCommit,yn=t.suspendInstance;t.suspendOnActiveViewTransition;var ha=t.waitForCommitToBeReady,Ir=t.NotPendingTransition,ji=t.HostTransitionContext,Fs=t.resetFormInstance;t.bindToConsole;var Sc=t.supportsMicrotasks,nu=t.scheduleMicrotask,dr=t.supportsTestSelectors,kg=t.findFiberRoot,ta=t.getBoundingRect,ud=t.getTextContent,Js=t.isHiddenSubtree,Fh=t.matchAccessibilityRole,Jh=t.setFocusIfFocusable,qg=t.setupIntersectionObserver,cd=t.appendChild,fd=t.appendChildToContainer,dd=t.commitTextUpdate,Xa=t.commitMount,aa=t.commitUpdate,bc=t.insertBefore,au=t.insertInContainerBefore,_c=t.removeChild,hd=t.removeChildFromContainer,hr=t.resetTextContent,Ec=t.hideInstance,gd=t.hideTextInstance,pd=t.unhideInstance,Zh=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopGestureTransition,t.getCurrentGestureOffset,t.subscribeToGestureDirection,t.createViewTransitionInstance;var Wh=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var $h=t.cloneInstance,md=t.createContainerChildSet,vd=t.appendChildToContainerChildSet,t0=t.finalizeContainerChildren,Cc=t.replaceContainerChildren,yd=t.cloneHiddenInstance,e0=t.cloneHiddenTextInstance,Tc=t.isSuspenseInstancePending,Ac=t.isSuspenseInstanceFallback,n0=t.getSuspenseInstanceFallbackErrorDetails,Sd=t.registerSuspenseInstanceRetry,a0=t.canHydrateFormStateMarker,i0=t.isFormStateMarkerMatching,bd=t.getNextHydratableSibling,r0=t.getNextHydratableSiblingAfterSingleton,s0=t.getFirstHydratableChild,Vg=t.getFirstHydratableChildWithinContainer,o0=t.getFirstHydratableChildWithinSuspenseInstance,Xo=t.getFirstHydratableChildWithinSingleton,l0=t.canHydrateInstance,wc=t.canHydrateTextInstance,Rc=t.canHydrateSuspenseInstance,u0=t.hydrateInstance,_d=t.hydrateTextInstance,Yg=t.hydrateSuspenseInstance,c0=t.getNextHydratableInstanceAfterSuspenseInstance,f0=t.commitHydratedContainer,d0=t.commitHydratedSuspenseInstance,h0=t.clearSuspenseBoundary,g0=t.clearSuspenseBoundaryFromContainer,Oc=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var p0=t.validateHydratableInstance,m0=t.validateHydratableTextInstance,Ei=t.supportsResources,Ed=t.isHostHoistableType,xc=t.getHoistableRoot,v0=t.getResource,Nc=t.acquireResource,Cd=t.releaseResource,y0=t.hydrateHoistable,Mc=t.mountHoistable,Td=t.unmountHoistable,S0=t.createHoistableInstance,Kg=t.prepareToCommitHoistables,Qg=t.mayResourceSuspendCommit,Ad=t.preloadResource,iu=t.suspendResource,ia=t.supportsSingletons,ru=t.resolveSingletonInstance,b0=t.acquireSingletonInstance,wd=t.releaseSingletonInstance,Fo=t.isHostSingletonType,Zs=t.isSingletonScope,su=[],Ws=-1,Ss={},Fa=Math.clz32?Math.clz32:M,_0=Math.log,E0=Math.LN2,gr=256,ou=4194304,lu=bi.unstable_scheduleCallback,Dc=bi.unstable_cancelCallback,jc=bi.unstable_shouldYield,C0=bi.unstable_requestPaint,Ci=bi.unstable_now,Rd=bi.unstable_ImmediatePriority,T0=bi.unstable_UserBlockingPriority,Od=bi.unstable_NormalPriority,xd=bi.unstable_IdlePriority,ga=bi.log,Ma=bi.unstable_setDisableYieldValue,Jo=null,oi=null,Uc,Nd,$s=!1,Md=new WeakMap,Gr=[],to=0,Bc=null,eo=0,li=[],Ti=0,bs=null,pr=1,Yi="",ma=E(null),no=E(null),Hr=E(null),Zo=E(null),Sa=null,ra=null,un=!1,kr=null,Ki=!1,Qi=Error(r(519)),Ja=typeof Object.is=="function"?Object.is:kt,zc=E(null),_s=null,Da=null,Dd=typeof AbortController<"u"?AbortController:function(){var s=[],u=this.signal={aborted:!1,addEventListener:function(p,b){s.push(b)}};this.abort=function(){u.aborted=!0,s.forEach(function(p){return p()})}},A0=bi.unstable_scheduleCallback,Lc=bi.unstable_NormalPriority,Nn={$$typeof:Ur,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Cn=null,Wo=null,jd=!1,uu=!1,ao=!1,Ai=0,$o=null,Pc=0,mr=0,Za=null,Ud=ge.S;ge.S=function(s,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&an(s,u),Ud!==null&&Ud(s,u)};var qr=E(null),w0=Object.prototype.hasOwnProperty,io=Error(r(460)),cu=Error(r(474)),ro=Error(r(542)),fu={then:function(){}},ui=null,dn=[],Es=0,Ic=0,Pn=!1,Bd=!1,so=E(null),du=E(0),hn=0,pe=null,Je=null,sa=null,hu=!1,oo=!1,lo=!1,uo=0,ba=0,Ga=null,R0=0,ja={readContext:Ht,use:Uu,useCallback:fe,useContext:fe,useEffect:fe,useImperativeHandle:fe,useLayoutEffect:fe,useInsertionEffect:fe,useMemo:fe,useReducer:fe,useRef:fe,useState:fe,useDebugValue:fe,useDeferredValue:fe,useTransition:fe,useSyncExternalStore:fe,useId:fe,useHostTransitionStatus:fe,useFormState:fe,useActionState:fe,useOptimistic:fe,useMemoCache:fe,useCacheRefresh:fe},zd={readContext:Ht,use:Uu,useCallback:function(s,u){return vn().memoizedState=[s,u===void 0?null:u],s},useContext:Ht,useEffect:Df,useImperativeHandle:function(s,u,p){p=p!=null?p.concat([s]):null,wr(4194308,4,er.bind(null,u,s),p)},useLayoutEffect:function(s,u){return wr(4194308,4,s,u)},useInsertionEffect:function(s,u){wr(4,2,s,u)},useMemo:function(s,u){var p=vn();u=u===void 0?null:u;var b=s();if(lo){Q(!0);try{s()}finally{Q(!1)}}return p.memoizedState=[b,u],b},useReducer:function(s,u,p){var b=vn();if(p!==void 0){var N=p(u);if(lo){Q(!0);try{p(u)}finally{Q(!1)}}}else N=u;return b.memoizedState=b.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},b.queue=s,s=s.dispatch=Ml.bind(null,pe,s),[b.memoizedState,s]},useRef:function(s){var u=vn();return s={current:s},u.memoizedState=s},useState:function(s){s=Rl(s);var u=s.queue,p=wh.bind(null,pe,u);return u.dispatch=p,[s.memoizedState,p]},useDebugValue:Ds,useDeferredValue:function(s,u){var p=vn();return Mo(p,s,u)},useTransition:function(){var s=Rl(!1);return s=xl.bind(null,pe,s.queue,!0,!1),vn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,u,p){var b=pe,N=vn();if(un){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),Tn===null)throw Error(r(349));(Ve&124)!==0||zu(b,u,p)}N.memoizedState=p;var G={value:p,getSnapshot:u};return N.queue=G,Df(wl.bind(null,b,G,s),[s]),b.flags|=2048,ni(9,xo(),Af.bind(null,b,G,p,u),null),p},useId:function(){var s=vn(),u=Tn.identifierPrefix;if(un){var p=Yi,b=pr;p=(b&~(1<<32-Fa(b)-1)).toString(32)+p,u="«"+u+"R"+p,p=uo++,0<p&&(u+="H"+p.toString(32)),u+="»"}else p=R0++,u="«"+u+"r"+p.toString(32)+"»";return s.memoizedState=u},useHostTransitionStatus:ku,useFormState:Mf,useActionState:Mf,useOptimistic:function(s){var u=vn();u.memoizedState=u.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=Dl.bind(null,pe,!0,p),p.dispatch=u,[s,u]},useMemoCache:Oo,useCacheRefresh:function(){return vn().memoizedState=qu.bind(null,pe)}},vr={readContext:Ht,use:Uu,useCallback:Rr,useContext:Ht,useEffect:Iu,useImperativeHandle:Gu,useInsertionEffect:jf,useLayoutEffect:No,useMemo:Hu,useReducer:xi,useRef:Pu,useState:function(){return xi(Oi)},useDebugValue:Ds,useDeferredValue:function(s,u){var p=Fn();return Uf(p,Je.memoizedState,s,u)},useTransition:function(){var s=xi(Oi)[0],u=Fn().memoizedState;return[typeof s=="boolean"?s:Ro(s),u]},useSyncExternalStore:Eh,useId:Va,useHostTransitionStatus:ku,useFormState:Lu,useActionState:Lu,useOptimistic:function(s,u){var p=Fn();return wf(p,Je,s,u)},useMemoCache:Oo,useCacheRefresh:ns},co={readContext:Ht,use:Uu,useCallback:Rr,useContext:Ht,useEffect:Iu,useImperativeHandle:Gu,useInsertionEffect:jf,useLayoutEffect:No,useMemo:Hu,useReducer:Bu,useRef:Pu,useState:function(){return Bu(Oi)},useDebugValue:Ds,useDeferredValue:function(s,u){var p=Fn();return Je===null?Mo(p,s,u):Uf(p,Je.memoizedState,s,u)},useTransition:function(){var s=Bu(Oi)[0],u=Fn().memoizedState;return[typeof s=="boolean"?s:Ro(s),u]},useSyncExternalStore:Eh,useId:Va,useHostTransitionStatus:ku,useFormState:Ol,useActionState:Ol,useOptimistic:function(s,u){var p=Fn();return Je!==null?wf(p,Je,s,u):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:Oo,useCacheRefresh:ns},ci=null,fo=0,Cs=Rh(!0),Ui=Rh(!1),wi=E(null),Wa=null,Zn=E(0),ho={enqueueSetState:function(s,u,p){s=s._reactInternals;var b=ii(),N=gi(b);N.payload=u,p!=null&&(N.callback=p),u=Li(s,N,b),u!==null&&(ri(u,s,b),ca(u,s,b))},enqueueReplaceState:function(s,u,p){s=s._reactInternals;var b=ii(),N=gi(b);N.tag=1,N.payload=u,p!=null&&(N.callback=p),u=Li(s,N,b),u!==null&&(ri(u,s,b),ca(u,s,b))},enqueueForceUpdate:function(s,u){s=s._reactInternals;var p=ii(),b=gi(p);b.tag=2,u!=null&&(b.callback=u),u=Li(s,b,p),u!==null&&(ri(u,s,p),ca(u,s,p))}},go=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ld=Error(r(461)),va=!1,po={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},yr=!1,Vn=!1,Gc=!1,O0=typeof WeakSet=="function"?WeakSet:Set,_a=null,ve=null,ke=!1,we=null,Pe=8192,Sn={getCacheForType:function(s){var u=Ht(Nn),p=u.data.get(s);return p===void 0&&(p=s(),u.data.set(s,p)),p}},Ha=0,Xi=1,Vr=2,tl=3,Bi=4;if(typeof Symbol=="function"&&Symbol.for){var Mn=Symbol.for;Ha=Mn("selector.component"),Xi=Mn("selector.has_pseudo_class"),Vr=Mn("selector.role"),tl=Mn("selector.test_id"),Bi=Mn("selector.text")}var Ts=typeof WeakMap=="function"?WeakMap:Map,Ie=0,Tn=null,be=null,Ve=0,sn=0,Dn=null,Sr=!1,Yr=!1,Hc=!1,zi=0,In=0,$a=0,Gn=0,br=0,Ua=0,fi=0,mo=null,ka=null,kc=!1,vo=0,yo=1/0,qa=null,Kr=null,gn=0,Qr=null,So=null,el=0,_r=0,nl=null,qc=null,Er=0,Vc=null;return Qe.attemptContinuousHydration=function(s){if(s.tag===13){var u=Le(s,67108864);u!==null&&ri(u,s,67108864),ds(s,67108864)}},Qe.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var u=ii();u=I(u);var p=Le(s,u);p!==null&&ri(p,s,u),ds(s,u)}},Qe.attemptSynchronousHydration=function(s){switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var u=z(s.pendingLanes);if(u!==0){for(s.pendingLanes|=2,s.entangledLanes|=2;u;){var p=1<<31-Fa(u);s.entanglements[1]|=p,u&=~p}xe(s),(Ie&6)===0&&(yo=Ci()+500,ct(0))}}break;case 13:u=Le(s,2),u!==null&&ri(u,s,2),Go(),ds(s,2)}},Qe.batchedUpdates=function(s,u){return s(u)},Qe.createComponentSelector=function(s){return{$$typeof:Ha,value:s}},Qe.createContainer=function(s,u,p,b,N,G,et,ut,St,Bt){return dc(s,u,!1,null,p,b,G,et,ut,St,Bt,null)},Qe.createHasPseudoClassSelector=function(s){return{$$typeof:Xi,value:s}},Qe.createHydrationContainer=function(s,u,p,b,N,G,et,ut,St,Bt,It,Wt,ne){return s=dc(p,b,!0,s,N,G,ut,St,Bt,It,Wt,ne),s.context=qo(null),p=s.current,b=ii(),b=I(b),N=gi(b),N.callback=u??null,Li(p,N,b),u=b,s.current.lanes=u,A(s,u),xe(s),s},Qe.createPortal=function(s,u,p){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jr,key:b==null?null:""+b,children:s,containerInfo:u,implementation:p}},Qe.createRoleSelector=function(s){return{$$typeof:Vr,value:s}},Qe.createTestNameSelector=function(s){return{$$typeof:tl,value:s}},Qe.createTextSelector=function(s){return{$$typeof:Bi,value:s}},Qe.defaultOnCaughtError=function(s){console.error(s)},Qe.defaultOnRecoverableError=function(s){go(s)},Qe.defaultOnUncaughtError=function(s){go(s)},Qe.deferredUpdates=function(s){var u=ge.T,p=cr();try{return da(32),ge.T=null,s()}finally{da(p),ge.T=u}},Qe.discreteUpdates=function(s,u,p,b,N){var G=ge.T,et=cr();try{return da(2),ge.T=null,s(u,p,b,N)}finally{da(et),ge.T=G,Ie===0&&(yo=Ci()+500)}},Qe.findAllNodes=Yl,Qe.findBoundingRects=function(s,u){if(!dr)throw Error(r(363));u=Yl(s,u),s=[];for(var p=0;p<u.length;p++)s.push(ta(u[p]));for(u=s.length-1;0<u;u--){p=s[u];for(var b=p.x,N=b+p.width,G=p.y,et=G+p.height,ut=u-1;0<=ut;ut--)if(u!==ut){var St=s[ut],Bt=St.x,It=Bt+St.width,Wt=St.y,ne=Wt+St.height;if(b>=Bt&&G>=Wt&&N<=It&&et<=ne){s.splice(u,1);break}else if(b!==Bt||p.width!==St.width||ne<G||Wt>et){if(!(G!==Wt||p.height!==St.height||It<b||Bt>N)){Bt>b&&(St.width+=Bt-b,St.x=b),It<N&&(St.width=N-Bt),s.splice(u,1);break}}else{Wt>G&&(St.height+=Wt-G,St.y=G),ne<et&&(St.height=et-Wt),s.splice(u,1);break}}}return s},Qe.findHostInstance=Vo,Qe.findHostInstanceWithNoPortals=function(s){return s=d(s),s=s!==null?m(s):null,s===null?null:Xs(s.stateNode)},Qe.findHostInstanceWithWarning=function(s){return Vo(s)},Qe.flushPassiveEffects=Gs,Qe.flushSyncFromReconciler=function(s){var u=Ie;Ie|=1;var p=ge.T,b=cr();try{if(da(2),ge.T=null,s)return s()}finally{da(b),ge.T=p,Ie=u,(Ie&6)===0&&ct(0)}},Qe.flushSyncWork=Go,Qe.focusWithin=function(s,u){if(!dr)throw Error(r(363));for(s=Gi(s),u=us(s,u),u=Array.from(u),s=0;s<u.length;){var p=u[s++],b=p.tag;if(!Js(p)){if((b===5||b===26||b===27)&&Jh(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},Qe.getFindAllNodesFailureDescription=function(s,u){if(!dr)throw Error(r(363));var p=0,b=[];s=[Gi(s),0];for(var N=0;N<s.length;){var G=s[N++],et=G.tag,ut=s[N++],St=u[ut];if((et!==5&&et!==26&&et!==27||!Js(G))&&(sc(G,St)&&(b.push(Po(St)),ut++,ut>p&&(p=ut)),ut<u.length))for(G=G.child;G!==null;)s.push(G,ut),G=G.sibling}if(p<u.length){for(s=[];p<u.length;p++)s.push(Po(u[p]));return`findAllNodes was able to match part of the selector:
  `+(b.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},Qe.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 27:case 5:return Xs(s.child.stateNode);default:return s.child.stateNode}},Qe.injectIntoDevTools=function(){var s={bundleType:0,version:Qs,rendererPackageName:Qh,currentDispatcherRef:ge,reconcilerVersion:"19.1.0"};if(Pr!==null&&(s.rendererConfig=Pr),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)s=!0;else{try{Jo=u.inject(s),oi=u}catch{}s=!!u.checkDCE}}return s},Qe.isAlreadyRendering=function(){return(Ie&6)!==0},Qe.observeVisibleRects=function(s,u,p,b){if(!dr)throw Error(r(363));s=Yl(s,u);var N=qg(s,p,b).disconnect;return{disconnect:function(){N()}}},Qe.shouldError=function(){return null},Qe.shouldSuspend=function(){return!1},Qe.startHostTransition=function(s,u,p,b){if(s.tag!==5)throw Error(r(476));var N=Nl(s).queue;xl(s,N,u,Ir,p===null?a:function(){var G=Nl(s).next.queue;return js(s,G,{},ii()),p(b)})},Qe.updateContainer=function(s,u,p,b){var N=u.current,G=ii();return hc(N,G,s,u,p,b),G},Qe.updateContainerSync=function(s,u,p,b){return hc(u.current,2,s,u,p,b),2},Qe},o.exports.default=o.exports,Object.defineProperty(o.exports,"__esModule",{value:!0})})(Lp)),Lp.exports}var i1;function i_(){return i1||(i1=1,zp.exports=a_()),zp.exports}var r_=i_();const s_=vf(r_);var Gp={exports:{}},_o={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function o_(){return r1||(r1=1,_o.ConcurrentRoot=1,_o.ContinuousEventPriority=8,_o.DefaultEventPriority=32,_o.DiscreteEventPriority=2,_o.IdleEventPriority=268435456,_o.LegacyRoot=0,_o.NoEventPriority=0),_o}var s1;function l_(){return s1||(s1=1,Gp.exports=o_()),Gp.exports}var jg=l_();const o1={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let l1=!1,u1=!1;const bg=".react-konva-event",u_=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,c_=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,f_={};function Ug(o,t,n=f_){if(!l1&&"zIndex"in t&&(console.warn(c_),l1=!0),!u1&&t.draggable){var a=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;a&&!r&&(console.warn(u_),u1=!0)}for(var l in n)if(!o1[l]){var c=l.slice(0,2)==="on",d=n[l]!==t[l];if(c&&d){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),o.off(g,n[l])}var m=!t.hasOwnProperty(l);m&&o.setAttr(l,void 0)}var S=t._useStrictMode,C={},E=!1;const R={};for(var l in t)if(!o1[l]){var c=l.slice(0,2)==="on",v=n[l]!==t[l];if(c&&v){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),t[l]&&(R[g]=t[l])}!c&&(t[l]!==n[l]||S&&t[l]!==o.getAttr(l))&&(E=!0,C[l]=t[l])}E&&(o.setAttrs(C),Tl(o));for(var g in R)o.off(g+bg),o.on(g+bg,R[g])}function Tl(o){if(!Ft.autoDrawEnabled){var t=o.getLayer()||o.getStage();t&&t.batchDraw()}}var Hp={exports:{}},kp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1;function d_(){return c1||(c1=1,(function(o){function t(D,H){var F=D.length;D.push(H);t:for(;0<F;){var tt=F-1>>>1,at=D[tt];if(0<r(at,H))D[tt]=H,D[F]=at,F=tt;else break t}}function n(D){return D.length===0?null:D[0]}function a(D){if(D.length===0)return null;var H=D[0],F=D.pop();if(F!==H){D[0]=F;t:for(var tt=0,at=D.length,Z=at>>>1;tt<Z;){var it=2*(tt+1)-1,st=D[it],V=it+1,J=D[V];if(0>r(st,F))V<at&&0>r(J,st)?(D[tt]=J,D[V]=F,tt=V):(D[tt]=st,D[it]=F,tt=it);else if(V<at&&0>r(J,F))D[tt]=J,D[V]=F,tt=V;else break t}}return H}function r(D,H){var F=D.sortIndex-H.sortIndex;return F!==0?F:D.id-H.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],S=1,C=null,E=3,R=!1,v=!1,M=!1,z=!1,P=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function L(D){for(var H=n(m);H!==null;){if(H.callback===null)a(m);else if(H.startTime<=D)a(m),H.sortIndex=H.expirationTime,t(g,H);else break;H=n(m)}}function O(D){if(M=!1,L(D),!v)if(n(g)!==null)v=!0,T||(T=!0,K());else{var H=n(m);H!==null&&Y(O,H.startTime-D)}}var T=!1,A=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function I(){if(z=!1,T){var D=o.unstable_now();B=D;var H=!0;try{t:{v=!1,M&&(M=!1,j(A),A=-1),R=!0;var F=E;try{e:{for(L(D),C=n(g);C!==null&&!(C.expirationTime>D&&U());){var tt=C.callback;if(typeof tt=="function"){C.callback=null,E=C.priorityLevel;var at=tt(C.expirationTime<=D);if(D=o.unstable_now(),typeof at=="function"){C.callback=at,L(D),H=!0;break e}C===n(g)&&a(g),L(D)}else a(g);C=n(g)}if(C!==null)H=!0;else{var Z=n(m);Z!==null&&Y(O,Z.startTime-D),H=!1}}break t}finally{C=null,E=F,R=!1}H=void 0}}finally{H?K():T=!1}}}var K;if(typeof x=="function")K=function(){x(I)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,X=Q.port2;Q.port1.onmessage=I,K=function(){X.postMessage(null)}}else K=function(){P(I,0)};function Y(D,H){A=P(function(){D(o.unstable_now())},H)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(D){D.callback=null},o.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<D?Math.floor(1e3/D):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(D){switch(E){case 1:case 2:case 3:var H=3;break;default:H=E}var F=E;E=H;try{return D()}finally{E=F}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(D,H){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=E;E=D;try{return H()}finally{E=F}},o.unstable_scheduleCallback=function(D,H,F){var tt=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?tt+F:tt):F=tt,D){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=F+at,D={id:S++,callback:H,priorityLevel:D,startTime:F,expirationTime:at,sortIndex:-1},F>tt?(D.sortIndex=F,t(m,D),n(g)===null&&D===n(m)&&(M?(j(A),A=-1):M=!0,Y(O,F-tt))):(D.sortIndex=at,t(g,D),v||R||(v=!0,T||(T=!0,K()))),D},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(D){var H=E;return function(){var F=E;E=H;try{return D.apply(this,arguments)}finally{E=F}}}})(kp)),kp}var f1;function h_(){return f1||(f1=1,Hp.exports=d_()),Hp.exports}var qp=h_();const bS={},g_={};gf.Node.prototype._applyProps=Ug;let _S=jg.DefaultEventPriority;function p_(o,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}o.add(t),Tl(o)}function m_(o,t,n){let a=gf[o];a||(console.error(`Konva has no node with the type ${o}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${o}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),a=gf.Group);const r={},l={};for(var c in t)if(c!=="ref"){var d=c.slice(0,2)==="on";d?l[c]=t[c]:r[c]=t[c]}const g=new a(r);return Ug(g,l),g}function v_(o,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${o}"`)}function y_(o,t,n){return!1}function S_(o){return o}function b_(){return null}function __(){return null}function E_(o,t,n,a){return g_}function C_(){}function T_(o){}function A_(o,t){return!1}function w_(){return bS}function R_(){return bS}const O_=setTimeout,x_=clearTimeout,N_=!0,M_=o=>{o()},D_=-1;function j_(o,t){return!1}const U_=!1,B_=!1,z_=!0,L_=!1,P_=!1;function I_(o,t){t.parent===o?t.moveToTop():o.add(t),Tl(o)}function G_(o,t){t.parent===o?t.moveToTop():o.add(t),Tl(o)}function ES(o,t,n){t._remove(),o.add(t),t.setZIndex(n.getZIndex()),Tl(o)}function H_(o,t,n){ES(o,t,n)}function k_(o,t){t.destroy(),t.off(bg),Tl(o)}function q_(o,t){t.destroy(),t.off(bg),Tl(o)}function V_(o,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function Y_(o,t,n){}function K_(o,t,n,a){Ug(o,a,n)}function Q_(o){o.hide(),Tl(o)}function X_(o){}function F_(o,t){(t.visible==null||t.visible)&&o.show()}function J_(o,t){}function Z_(o){}function W_(){}function $_(){return jg.DefaultEventPriority}function t8(){}function e8(){return null}function n8(o){_S=o}function a8(){return _S}function i8(){return jg.DiscreteEventPriority}function r8(){return!1}function s8(){}function o8(){return!1}function l8(){return!0}function u8(){}function c8(){}function f8(){return null}const d8=null;function h8(){}const g8=Object.freeze(Object.defineProperty({__proto__:null,NotPendingTransition:d8,appendChild:I_,appendChildToContainer:G_,appendInitialChild:p_,cancelTimeout:x_,clearContainer:Z_,commitMount:Y_,commitTextUpdate:V_,commitUpdate:K_,createInstance:m_,createTextInstance:v_,detachDeletedInstance:W_,finalizeInitialChildren:y_,getChildHostContext:R_,getCurrentEventPriority:$_,getCurrentUpdatePriority:a8,getInstanceFromScope:e8,getPublicInstance:S_,getRootHostContext:w_,hideInstance:Q_,hideTextInstance:X_,idlePriority:qp.unstable_IdlePriority,insertBefore:ES,insertInContainerBefore:H_,isPrimaryRenderer:U_,maySuspendCommit:o8,noTimeout:D_,now:qp.unstable_now,preloadInstance:l8,prepareForCommit:b_,preparePortalMount:__,prepareScopeUpdate:t8,prepareUpdate:E_,removeChild:k_,removeChildFromContainer:q_,requestPostPaintCallback:s8,resetAfterCommit:C_,resetFormInstance:h8,resetTextContent:T_,resolveUpdatePriority:i8,run:qp.unstable_runWithPriority,scheduleMicrotask:M_,scheduleTimeout:O_,setCurrentUpdatePriority:n8,shouldAttemptEagerTransition:r8,shouldDeprioritizeSubtree:A_,shouldSetTextContent:j_,startSuspendingCommit:u8,supportsHydration:P_,supportsMicrotasks:N_,supportsMutation:z_,supportsPersistence:L_,suspendInstance:c8,unhideInstance:F_,unhideTextInstance:J_,waitForCommitToBeReady:f8,warnsIfNotActing:B_},Symbol.toStringTag,{value:"Module"}));function CS(o,t,n){if(!o)return;if(n(o)===!0)return o;let a=o.child;for(;a;){const r=CS(a,t,n);if(r)return r;a=a.sibling}}function TS(o){try{return Object.defineProperties(o,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return o}}const ov=TS(rt.createContext(null));class AS extends rt.Component{render(){return rt.createElement(ov.Provider,{value:this._reactInternals},this.props.children)}}function p8(){const o=rt.useContext(ov);if(o===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=rt.useId();return rt.useMemo(()=>{for(const n of[o,o==null?void 0:o.alternate]){if(!n)continue;const a=CS(n,!1,r=>{let l=r.memoizedState;for(;l;){if(l.memoizedState===t)return!0;l=l.next}});if(a)return a}},[o,t])}const m8=Symbol.for("react.context"),v8=o=>o!==null&&typeof o=="object"&&"$$typeof"in o&&o.$$typeof===m8;function y8(){const o=p8(),[t]=rt.useState(()=>new Map);t.clear();let n=o;for(;n;){const a=n.type;v8(a)&&a!==ov&&!t.has(a)&&t.set(a,rt.use(TS(a))),n=n.return}return t}function S8(){const o=y8();return rt.useMemo(()=>Array.from(o.keys()).reduce((t,n)=>a=>rt.createElement(t,null,rt.createElement(n.Provider,{...a,value:o.get(n)})),t=>rt.createElement(AS,{...t})),[o])}if(pa.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function b8(o){const t=pa.useRef({});return pa.useLayoutEffect(()=>{t.current=o}),pa.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const _8=()=>{const o=pa.useRef(0);return pa.useMemo(()=>{o.current++},[]),o.current>1},E8=o=>{const t=pa.useRef(null),n=pa.useRef(null),a=pa.useRef(null),r=b8(o),l=S8(),c=pa.useRef(!1),d=m=>{const{forwardedRef:S}=o;S&&(typeof S=="function"?S(m):S.current=m)},g=_8();return pa.useLayoutEffect(()=>c.current&&g?()=>{c.current=!1,d(null),lf.updateContainer(null,a.current,null),n.current.destroy()}:(c.current=!0,n.current=new gf.Stage({width:o.width,height:o.height,container:t.current}),d(n.current),a.current=lf.createContainer(n.current,jg.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),lf.updateContainer(pa.createElement(l,{},o.children),a.current,null,()=>{}),()=>{g||(d(null),lf.updateContainer(null,a.current,null),n.current.destroy())}),[]),pa.useLayoutEffect(()=>{d(n.current),Ug(n.current,o,r),lf.updateContainer(pa.createElement(l,{},o.children),a.current,null)}),pa.createElement("div",{ref:t,id:o.id,accessKey:o.accessKey,className:o.className,role:o.role,style:o.style,tabIndex:o.tabIndex,title:o.title})},Wr="Layer",Sl="Line",lv="Image",lf=s_(g8);lf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:pa.version,rendererPackageName:"react-konva"});const Bg=pa.forwardRef((o,t)=>pa.createElement(AS,{},pa.createElement(E8,{...o,forwardedRef:t})));var Vp={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var d1;function wS(){return d1||(d1=1,(function(o,t){(function(a,r){o.exports=r()})(window,function(){return(function(n){var a={};function r(l){if(a[l])return a[l].exports;var c=a[l]={i:l,l:!1,exports:{}};return n[l].call(c.exports,c,c.exports,r),c.l=!0,c.exports}return r.m=n,r.c=a,r.d=function(l,c,d){r.o(l,c)||Object.defineProperty(l,c,{enumerable:!0,get:d})},r.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},r.t=function(l,c){if(c&1&&(l=r(l)),c&8||c&4&&typeof l=="object"&&l&&l.__esModule)return l;var d=Object.create(null);if(r.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:l}),c&2&&typeof l!="string")for(var g in l)r.d(d,g,(function(m){return l[m]}).bind(null,g));return d},r.n=function(l){var c=l&&l.__esModule?function(){return l.default}:function(){return l};return r.d(c,"a",c),c},r.o=function(l,c){return Object.prototype.hasOwnProperty.call(l,c)},r.p="",r(r.s=42)})([(function(n,a,r){r.r(a),r.d(a,"__extends",function(){return c}),r.d(a,"__assign",function(){return d}),r.d(a,"__rest",function(){return g}),r.d(a,"__decorate",function(){return m}),r.d(a,"__param",function(){return S}),r.d(a,"__metadata",function(){return C}),r.d(a,"__awaiter",function(){return E}),r.d(a,"__generator",function(){return R}),r.d(a,"__createBinding",function(){return v}),r.d(a,"__exportStar",function(){return M}),r.d(a,"__values",function(){return z}),r.d(a,"__read",function(){return P}),r.d(a,"__spread",function(){return j}),r.d(a,"__spreadArrays",function(){return x}),r.d(a,"__spreadArray",function(){return L}),r.d(a,"__await",function(){return O}),r.d(a,"__asyncGenerator",function(){return T}),r.d(a,"__asyncDelegator",function(){return A}),r.d(a,"__asyncValues",function(){return y}),r.d(a,"__makeTemplateObject",function(){return B}),r.d(a,"__importStar",function(){return I}),r.d(a,"__importDefault",function(){return K}),r.d(a,"__classPrivateFieldGet",function(){return Q}),r.d(a,"__classPrivateFieldSet",function(){return X});/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */var l=function(Y,D){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,F){H.__proto__=F}||function(H,F){for(var tt in F)Object.prototype.hasOwnProperty.call(F,tt)&&(H[tt]=F[tt])},l(Y,D)};function c(Y,D){if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");l(Y,D);function H(){this.constructor=Y}Y.prototype=D===null?Object.create(D):(H.prototype=D.prototype,new H)}var d=function(){return d=Object.assign||function(D){for(var H,F=1,tt=arguments.length;F<tt;F++){H=arguments[F];for(var at in H)Object.prototype.hasOwnProperty.call(H,at)&&(D[at]=H[at])}return D},d.apply(this,arguments)};function g(Y,D){var H={};for(var F in Y)Object.prototype.hasOwnProperty.call(Y,F)&&D.indexOf(F)<0&&(H[F]=Y[F]);if(Y!=null&&typeof Object.getOwnPropertySymbols=="function")for(var tt=0,F=Object.getOwnPropertySymbols(Y);tt<F.length;tt++)D.indexOf(F[tt])<0&&Object.prototype.propertyIsEnumerable.call(Y,F[tt])&&(H[F[tt]]=Y[F[tt]]);return H}function m(Y,D,H,F){var tt=arguments.length,at=tt<3?D:F===null?F=Object.getOwnPropertyDescriptor(D,H):F,Z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")at=Reflect.decorate(Y,D,H,F);else for(var it=Y.length-1;it>=0;it--)(Z=Y[it])&&(at=(tt<3?Z(at):tt>3?Z(D,H,at):Z(D,H))||at);return tt>3&&at&&Object.defineProperty(D,H,at),at}function S(Y,D){return function(H,F){D(H,F,Y)}}function C(Y,D){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Y,D)}function E(Y,D,H,F){function tt(at){return at instanceof H?at:new H(function(Z){Z(at)})}return new(H||(H=Promise))(function(at,Z){function it(J){try{V(F.next(J))}catch(W){Z(W)}}function st(J){try{V(F.throw(J))}catch(W){Z(W)}}function V(J){J.done?at(J.value):tt(J.value).then(it,st)}V((F=F.apply(Y,D||[])).next())})}function R(Y,D){var H={label:0,sent:function(){if(at[0]&1)throw at[1];return at[1]},trys:[],ops:[]},F,tt,at,Z;return Z={next:it(0),throw:it(1),return:it(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function it(V){return function(J){return st([V,J])}}function st(V){if(F)throw new TypeError("Generator is already executing.");for(;H;)try{if(F=1,tt&&(at=V[0]&2?tt.return:V[0]?tt.throw||((at=tt.return)&&at.call(tt),0):tt.next)&&!(at=at.call(tt,V[1])).done)return at;switch(tt=0,at&&(V=[V[0]&2,at.value]),V[0]){case 0:case 1:at=V;break;case 4:return H.label++,{value:V[1],done:!1};case 5:H.label++,tt=V[1],V=[0];continue;case 7:V=H.ops.pop(),H.trys.pop();continue;default:if(at=H.trys,!(at=at.length>0&&at[at.length-1])&&(V[0]===6||V[0]===2)){H=0;continue}if(V[0]===3&&(!at||V[1]>at[0]&&V[1]<at[3])){H.label=V[1];break}if(V[0]===6&&H.label<at[1]){H.label=at[1],at=V;break}if(at&&H.label<at[2]){H.label=at[2],H.ops.push(V);break}at[2]&&H.ops.pop(),H.trys.pop();continue}V=D.call(Y,H)}catch(J){V=[6,J],tt=0}finally{F=at=0}if(V[0]&5)throw V[1];return{value:V[0]?V[1]:void 0,done:!0}}}var v=Object.create?(function(Y,D,H,F){F===void 0&&(F=H),Object.defineProperty(Y,F,{enumerable:!0,get:function(){return D[H]}})}):(function(Y,D,H,F){F===void 0&&(F=H),Y[F]=D[H]});function M(Y,D){for(var H in Y)H!=="default"&&!Object.prototype.hasOwnProperty.call(D,H)&&v(D,Y,H)}function z(Y){var D=typeof Symbol=="function"&&Symbol.iterator,H=D&&Y[D],F=0;if(H)return H.call(Y);if(Y&&typeof Y.length=="number")return{next:function(){return Y&&F>=Y.length&&(Y=void 0),{value:Y&&Y[F++],done:!Y}}};throw new TypeError(D?"Object is not iterable.":"Symbol.iterator is not defined.")}function P(Y,D){var H=typeof Symbol=="function"&&Y[Symbol.iterator];if(!H)return Y;var F=H.call(Y),tt,at=[],Z;try{for(;(D===void 0||D-- >0)&&!(tt=F.next()).done;)at.push(tt.value)}catch(it){Z={error:it}}finally{try{tt&&!tt.done&&(H=F.return)&&H.call(F)}finally{if(Z)throw Z.error}}return at}function j(){for(var Y=[],D=0;D<arguments.length;D++)Y=Y.concat(P(arguments[D]));return Y}function x(){for(var Y=0,D=0,H=arguments.length;D<H;D++)Y+=arguments[D].length;for(var F=Array(Y),tt=0,D=0;D<H;D++)for(var at=arguments[D],Z=0,it=at.length;Z<it;Z++,tt++)F[tt]=at[Z];return F}function L(Y,D,H){if(H||arguments.length===2)for(var F=0,tt=D.length,at;F<tt;F++)(at||!(F in D))&&(at||(at=Array.prototype.slice.call(D,0,F)),at[F]=D[F]);return Y.concat(at||Array.prototype.slice.call(D))}function O(Y){return this instanceof O?(this.v=Y,this):new O(Y)}function T(Y,D,H){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var F=H.apply(Y,D||[]),tt,at=[];return tt={},Z("next"),Z("throw"),Z("return"),tt[Symbol.asyncIterator]=function(){return this},tt;function Z(nt){F[nt]&&(tt[nt]=function(dt){return new Promise(function(Rt,Ut){at.push([nt,dt,Rt,Ut])>1||it(nt,dt)})})}function it(nt,dt){try{st(F[nt](dt))}catch(Rt){W(at[0][3],Rt)}}function st(nt){nt.value instanceof O?Promise.resolve(nt.value.v).then(V,J):W(at[0][2],nt)}function V(nt){it("next",nt)}function J(nt){it("throw",nt)}function W(nt,dt){nt(dt),at.shift(),at.length&&it(at[0][0],at[0][1])}}function A(Y){var D,H;return D={},F("next"),F("throw",function(tt){throw tt}),F("return"),D[Symbol.iterator]=function(){return this},D;function F(tt,at){D[tt]=Y[tt]?function(Z){return(H=!H)?{value:O(Y[tt](Z)),done:tt==="return"}:at?at(Z):Z}:at}}function y(Y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var D=Y[Symbol.asyncIterator],H;return D?D.call(Y):(Y=typeof z=="function"?z(Y):Y[Symbol.iterator](),H={},F("next"),F("throw"),F("return"),H[Symbol.asyncIterator]=function(){return this},H);function F(at){H[at]=Y[at]&&function(Z){return new Promise(function(it,st){Z=Y[at](Z),tt(it,st,Z.done,Z.value)})}}function tt(at,Z,it,st){Promise.resolve(st).then(function(V){at({value:V,done:it})},Z)}}function B(Y,D){return Object.defineProperty?Object.defineProperty(Y,"raw",{value:D}):Y.raw=D,Y}var U=Object.create?(function(Y,D){Object.defineProperty(Y,"default",{enumerable:!0,value:D})}):function(Y,D){Y.default=D};function I(Y){if(Y&&Y.__esModule)return Y;var D={};if(Y!=null)for(var H in Y)H!=="default"&&Object.prototype.hasOwnProperty.call(Y,H)&&v(D,Y,H);return U(D,Y),D}function K(Y){return Y&&Y.__esModule?Y:{default:Y}}function Q(Y,D,H,F){if(H==="a"&&!F)throw new TypeError("Private accessor was defined without a getter");if(typeof D=="function"?Y!==D||!F:!D.has(Y))throw new TypeError("Cannot read private member from an object whose class did not declare it");return H==="m"?F:H==="a"?F.call(Y):F?F.value:D.get(Y)}function X(Y,D,H,F,tt){if(F==="m")throw new TypeError("Private method is not writable");if(F==="a"&&!tt)throw new TypeError("Private accessor was defined without a setter");if(typeof D=="function"?Y!==D||!tt:!D.has(Y))throw new TypeError("Cannot write private member to an object whose class did not declare it");return F==="a"?tt.call(Y,H):tt?tt.value=H:D.set(Y,H),H}}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0}),a.allToUpperCase=a.allToLowerCase=a.encodeBody=a.decodeBody=a.Format=a.promisify=a.trim=a.arrChooseN=a.randomHexString=a.randomString=a.cheapRandStr=a.dataSizeBytes=a.inspectBody=a.inspectError=a.isErrorInfoOrPartialErrorInfo=a.now=a.parseQueryString=a.toQueryString=a.arrPopRandomElement=a.defaultPostHeaders=a.defaultGetHeaders=a.allSame=a.arrEvery=a.arrFilter=a.arrMap=a.safeArrForEach=a.arrForEach=a.forInOwnNonNullProperties=a.valuesArray=a.keysArray=a.arrWithoutValue=a.arrDeleteValue=a.arrIn=a.arrIndexOf=a.arrSubtract=a.arrIntersectOb=a.arrIntersect=a.intersect=a.containsValue=a.inherits=a.prototypicalClone=a.shallowClone=a.isEmptyArg=a.isOnlyPropIn=a.isEmpty=a.isObject=a.ensureArray=a.isArray=a.copy=a.mixin=void 0,a.arrEquals=a.toBase64=a.matchDerivedChannel=a.shallowEquals=a.getGlobalObject=a.getRetryTime=a.getJitterCoefficient=a.getBackoffCoefficient=void 0;var c=r(0),d=c.__importDefault(r(3)),g=c.__importStar(r(8)),m=c.__importDefault(r(4)),S=r(11),C=r(31);function E(ct){return Math.floor(Math.random()*ct.length)}function R(ct){for(var Tt=[],Mt=1;Mt<arguments.length;Mt++)Tt[Mt-1]=arguments[Mt];for(var Pt=0;Pt<Tt.length;Pt++){var se=Tt[Pt];if(!se)break;var zt=Object.prototype.hasOwnProperty;for(var ee in se)(!zt||zt.call(se,ee))&&(ct[ee]=se[ee])}return ct}a.mixin=R;function v(ct){return R({},ct)}a.copy=v,a.isArray=Array.isArray||function(ct){return Object.prototype.toString.call(ct)=="[object Array]"};function M(ct){return x(ct)?[]:(0,a.isArray)(ct)?ct:[ct]}a.ensureArray=M;function z(ct){return Object.prototype.toString.call(ct)=="[object Object]"}a.isObject=z;function P(ct){for(var Tt in ct)return!1;return!0}a.isEmpty=P;function j(ct,Tt){for(var Mt in ct)if(Mt!==Tt)return!1;return!0}a.isOnlyPropIn=j;function x(ct){return ct==null}a.isEmptyArg=x;function L(ct){var Tt=new Object;for(var Mt in ct)Tt[Mt]=ct[Mt];return Tt}a.shallowClone=L;function O(ct,Tt){var Mt=(function(){function se(){}return se})();Mt.prototype=ct;var Pt=new Mt;return Tt&&R(Pt,Tt),Pt}a.prototypicalClone=O;var T=function(ct,Tt){if(d.default.Config.inherits){d.default.Config.inherits(ct,Tt);return}ct.super_=Tt,ct.prototype=O(Tt.prototype,{constructor:ct})};a.inherits=T;function A(ct,Tt){for(var Mt in ct)if(ct[Mt]==Tt)return!0;return!1}a.containsValue=A;function y(ct,Tt){return(0,a.isArray)(Tt)?B(ct,Tt):U(ct,Tt)}a.intersect=y;function B(ct,Tt){for(var Mt=[],Pt=0;Pt<ct.length;Pt++){var se=ct[Pt];(0,a.arrIndexOf)(Tt,se)!=-1&&Mt.push(se)}return Mt}a.arrIntersect=B;function U(ct,Tt){for(var Mt=[],Pt=0;Pt<ct.length;Pt++){var se=ct[Pt];se in Tt&&Mt.push(se)}return Mt}a.arrIntersectOb=U;function I(ct,Tt){for(var Mt=[],Pt=0;Pt<ct.length;Pt++){var se=ct[Pt];(0,a.arrIndexOf)(Tt,se)==-1&&Mt.push(se)}return Mt}a.arrSubtract=I,a.arrIndexOf=Array.prototype.indexOf?function(ct,Tt,Mt){return ct.indexOf(Tt,Mt)}:function(ct,Tt,Mt){Mt=Mt||0;for(var Pt=ct.length;Mt<Pt;Mt++)if(ct[Mt]===Tt)return Mt;return-1};function K(ct,Tt){return(0,a.arrIndexOf)(ct,Tt)!==-1}a.arrIn=K;function Q(ct,Tt){var Mt=(0,a.arrIndexOf)(ct,Tt),Pt=Mt!=-1;return Pt&&ct.splice(Mt,1),Pt}a.arrDeleteValue=Q;function X(ct,Tt){var Mt=ct.slice();return Q(Mt,Tt),Mt}a.arrWithoutValue=X;function Y(ct,Tt){var Mt=[];for(var Pt in ct)Tt&&!Object.prototype.hasOwnProperty.call(ct,Pt)||Mt.push(Pt);return Mt}a.keysArray=Y;function D(ct,Tt){var Mt=[];for(var Pt in ct)Tt&&!Object.prototype.hasOwnProperty.call(ct,Pt)||Mt.push(ct[Pt]);return Mt}a.valuesArray=D;function H(ct,Tt){for(var Mt in ct)Object.prototype.hasOwnProperty.call(ct,Mt)&&ct[Mt]&&Tt(Mt)}a.forInOwnNonNullProperties=H,a.arrForEach=Array.prototype.forEach?function(ct,Tt){ct.forEach(Tt)}:function(ct,Tt){for(var Mt=ct.length,Pt=0;Pt<Mt;Pt++)Tt(ct[Pt],Pt,ct)};function F(ct,Tt){return(0,a.arrForEach)(ct.slice(),Tt)}a.safeArrForEach=F,a.arrMap=Array.prototype.map?function(ct,Tt){return ct.map(Tt)}:function(ct,Tt){for(var Mt=[],Pt=ct.length,se=0;se<Pt;se++)Mt.push(Tt(ct[se],se,ct));return Mt},a.arrFilter=Array.prototype.filter?function(ct,Tt){return ct.filter(Tt)}:function(ct,Tt){for(var Mt=[],Pt=ct.length,se=0;se<Pt;se++)Tt(ct[se])&&Mt.push(ct[se]);return Mt},a.arrEvery=Array.prototype.every?function(ct,Tt){return ct.every(Tt)}:function(ct,Tt){for(var Mt=ct.length,Pt=0;Pt<Mt;Pt++)if(!Tt(ct[Pt],Pt,ct))return!1;return!0};function tt(ct,Tt){if(ct.length===0)return!0;var Mt=ct[0][Tt];return(0,a.arrEvery)(ct,function(Pt){return Pt[Tt]===Mt})}a.allSame=tt;var at={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function Z(ct,Tt){var Mt=at[Tt||Re.json];return{accept:Mt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ct)}}a.defaultGetHeaders=Z;function it(ct,Tt){var Mt,Pt=Mt=at[Tt||Re.json];return{accept:Pt,"content-type":Mt,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ct)}}a.defaultPostHeaders=it;function st(ct){return ct.splice(E(ct),1)[0]}a.arrPopRandomElement=st;function V(ct){var Tt=[];if(ct)for(var Mt in ct)Tt.push(encodeURIComponent(Mt)+"="+encodeURIComponent(ct[Mt]));return Tt.length?"?"+Tt.join("&"):""}a.toQueryString=V;function J(ct){for(var Tt,Mt=/([^?&=]+)=?([^&]*)/g,Pt={};Tt=Mt.exec(ct);)Pt[decodeURIComponent(Tt[1])]=decodeURIComponent(Tt[2]);return Pt}a.parseQueryString=J,a.now=Date.now||function(){return new Date().getTime()};function W(ct){return typeof ct=="object"&&ct!==null&&(ct.constructor.name=="ErrorInfo"||ct.constructor.name=="PartialErrorInfo")}a.isErrorInfoOrPartialErrorInfo=W;function nt(ct){var Tt,Mt;return ct instanceof Error||((Tt=ct==null?void 0:ct.constructor)===null||Tt===void 0?void 0:Tt.name)==="ErrorInfo"||((Mt=ct==null?void 0:ct.constructor)===null||Mt===void 0?void 0:Mt.name)==="PartialErrorInfo"?ct.toString():d.default.Config.inspect(ct)}a.inspectError=nt;function dt(ct){return d.default.BufferUtils.isBuffer(ct)?ct.toString():typeof ct=="string"?ct:d.default.Config.inspect(ct)}a.inspectBody=dt;function Rt(ct){if(d.default.BufferUtils.isBuffer(ct))return d.default.BufferUtils.byteLength(ct);if(typeof ct=="string")return d.default.Config.stringByteSize(ct);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof ct)}a.dataSizeBytes=Rt;function Ut(){return String(Math.random()).substr(2)}a.cheapRandStr=Ut;var Xt=function(ct){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var Tt=new Uint8Array(ct);return d.default.Config.getRandomValues(Tt),d.default.BufferUtils.base64Encode(Tt)}for(var Mt=d.default.BufferUtils.base64CharSet,Pt=Math.round(ct*4/3),se="",zt=0;zt<Pt;zt++)se+=Mt[E(Mt)];return se};a.randomString=Xt;var $t=function(ct){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var Tt=new Uint8Array(ct);return d.default.Config.getRandomValues(Tt),d.default.BufferUtils.hexEncode(Tt)}for(var Mt=d.default.BufferUtils.hexCharSet,Pt=ct*2,se="",zt=0;zt<Pt;zt++)se+=Mt[E(Mt)];return se};a.randomHexString=$t;function oe(ct,Tt){for(var Mt=Math.min(Tt,ct.length),Pt=ct.slice(),se=[],zt=0;zt<Mt;zt++)se.push(st(Pt));return se}a.arrChooseN=oe,a.trim=String.prototype.trim?function(ct){return ct.trim()}:function(ct){return ct.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function kt(ct,Tt,Mt){return new Promise(function(Pt,se){ct[Tt].apply(ct,c.__spreadArray(c.__spreadArray([],Mt,!1),[function(zt,ee){zt?se(zt):Pt(ee)}],!1))})}a.promisify=kt;var Re;(function(ct){ct.msgpack="msgpack",ct.json="json"})(Re=a.Format||(a.Format={}));function Ee(ct,Tt){return Tt=="msgpack"?d.default.Config.msgpack.decode(ct):JSON.parse(String(ct))}a.decodeBody=Ee;function ze(ct,Tt){return Tt=="msgpack"?d.default.Config.msgpack.encode(ct,!0):JSON.stringify(ct)}a.encodeBody=ze;function Xe(ct){return ct.map(function(Tt){return Tt&&Tt.toLowerCase()})}a.allToLowerCase=Xe;function nn(ct){return ct.map(function(Tt){return Tt&&Tt.toUpperCase()})}a.allToUpperCase=nn;function fn(ct){return Math.min((ct+2)/3,2)}a.getBackoffCoefficient=fn;function At(){return 1-Math.random()*.2}a.getJitterCoefficient=At;function Ht(ct,Tt){return ct*fn(Tt)*At()}a.getRetryTime=Ht;function me(){return l||(typeof window<"u"?window:self)}a.getGlobalObject=me;function Se(ct,Tt){return Object.keys(ct).every(function(Mt){return ct[Mt]===Tt[Mt]})&&Object.keys(Tt).every(function(Mt){return Tt[Mt]===ct[Mt]})}a.shallowEquals=Se;function Oe(ct){var Tt=/^(\[([^?]*)(?:(.*))\])?(.+)$/,Mt=ct.match(Tt);if(!Mt||!Mt.length||Mt.length<5)throw new m.default("regex match failed",400,40010);if(Mt[2])throw new m.default("cannot use a derived option with a ".concat(Mt[2]," channel"),400,40010);return{qualifierParam:Mt[3]||"",channelName:Mt[4]}}a.matchDerivedChannel=Oe;function $e(ct){return d.default.Config.createHmac?Buffer.from(ct,"ascii").toString("base64"):(0,S.stringify)((0,C.parse)(ct))}a.toBase64=$e;function xe(ct,Tt){return ct.length===Tt.length&&(0,a.arrEvery)(ct,function(Mt,Pt){return Mt===Tt[Pt]})}a.arrEquals=xe}).call(this,r(13))}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var c=r(0),d=c.__importDefault(r(3)),g=l||(typeof window<"u"?window:self),m;(function(v){v[v.None=0]="None",v[v.Error=1]="Error",v[v.Major=2]="Major",v[v.Minor=3]="Minor",v[v.Micro=4]="Micro"})(m||(m={}));function S(v,M){return"".concat(v).padStart(M?3:2,"0")}function C(v){return d.default.Config.logTimestamps?function(M){var z=new Date;v(S(z.getHours())+":"+S(z.getMinutes())+":"+S(z.getSeconds())+"."+S(z.getMilliseconds(),1)+" "+M)}:v}var E=function(){var v,M,z,P;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((M=(v=g==null?void 0:g.console)===null||v===void 0?void 0:v.log)===null||M===void 0?void 0:M.apply)=="function"?(z=function(){for(var j=[],x=0;x<arguments.length;x++)j[x]=arguments[x];console.log.apply(console,j)},P=console.warn?function(){for(var j=[],x=0;x<arguments.length;x++)j[x]=arguments[x];console.warn.apply(console,j)}:z):g!=null&&g.console.log?z=P=function(){Function.prototype.apply.call(console.log,console,arguments)}:z=P=function(){},[z,P].map(C)},R=(function(){function v(){v.logLevel=v.LOG_DEFAULT}return v.initLogHandlers=function(){var M=E(),z=M[0],P=M[1];this.logHandler=z,this.logErrorHandler=P},v.renamedClientOption=function(M,z){v.deprecationWarning("The `".concat(M,"` client option has been renamed to `").concat(z,"`. Please update your code to use `").concat(z,"` instead. `").concat(M,"` will be removed in a future version."))},v.renamedMethod=function(M,z,P){v.deprecationWarning("`".concat(M,"`’s `").concat(z,"` method has been renamed to `").concat(P,"`. Please update your code to use `").concat(P,"` instead. `").concat(z,"` will be removed in a future version."))},v.deprecationWarning=function(M){v.shouldLog(m.Error)&&v.logErrorHandler("Ably: Deprecation warning - ".concat(M))},v.logLevel=m.Error,v.LOG_NONE=m.None,v.LOG_ERROR=m.Error,v.LOG_MAJOR=m.Major,v.LOG_MINOR=m.Minor,v.LOG_MICRO=m.Micro,v.LOG_DEFAULT=m.Error,v.LOG_DEBUG=m.Micro,v.logAction=function(M,z,P){v.shouldLog(M)&&(M===m.Error?v.logErrorHandler:v.logHandler)("Ably: "+z+": "+P)},v.deprecated=function(M,z){v.deprecationWarning("".concat(M," is deprecated and will be removed in a future version. ").concat(z))},v.shouldLog=function(M){return M<=v.logLevel},v.setLog=function(M,z){M!==void 0&&(v.logLevel=M),z!==void 0&&(v.logHandler=v.logErrorHandler=z)},v})();a.default=R}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function c(){}return c})();a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.PartialErrorInfo=void 0;var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1));function g(C){var E="["+C.constructor.name;return C.message&&(E+=": "+C.message),C.statusCode&&(E+="; statusCode="+C.statusCode),C.code&&(E+="; code="+C.code),C.cause&&(E+="; cause="+d.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(E+="; see "+C.href+" "),E+="]",E}var m=(function(C){l.__extends(E,C);function E(R,v,M,z){var P=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(P,E.prototype),P.code=v,P.statusCode=M,P.cause=z,P}return E.prototype.toString=function(){return g(this)},E.fromValues=function(R){var v=R,M=v.message,z=v.code,P=v.statusCode;if(typeof M!="string"||typeof z!="number"||typeof P!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+c.default.Config.inspect(R));var j=Object.assign(new E(M,z,P),R);return j.code&&!j.href&&(j.href="https://help.ably.io/error/"+j.code),j},E})(Error);a.default=m;var S=(function(C){l.__extends(E,C);function E(R,v,M,z){var P=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(P,E.prototype),P.code=v,P.statusCode=M,P.cause=z,P}return E.prototype.toString=function(){return g(this)},E})(Error);a.PartialErrorInfo=S}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){if(typeof ArrayBuffer=="function"){var c=l,d=c.lib,g=d.WordArray,m=g.init,S=g.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var E=C.byteLength,R=[],v=0;v<E;v++)R[v>>>2]|=C[v]<<24-v%4*8;m.call(this,R,E)}else m.apply(this,arguments)};S.prototype=g}})(),l.lib.WordArray})}),(function(n,a,r){(function(l){(function(c,d){n.exports=d()})(this,function(){var c=c||(function(d,g){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof l<"u"&&l.crypto&&(m=l.crypto),!m)try{m=r(44)}catch{}var S=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||(function(){function T(){}return function(A){var y;return T.prototype=A,y=new T,T.prototype=null,y}})(),E={},R=E.lib={},v=R.Base=(function(){return{extend:function(T){var A=C(this);return T&&A.mixIn(T),(!A.hasOwnProperty("init")||this.init===A.init)&&(A.init=function(){A.$super.init.apply(this,arguments)}),A.init.prototype=A,A.$super=this,A},create:function(){var T=this.extend();return T.init.apply(T,arguments),T},init:function(){},mixIn:function(T){for(var A in T)T.hasOwnProperty(A)&&(this[A]=T[A]);T.hasOwnProperty("toString")&&(this.toString=T.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),M=R.WordArray=v.extend({init:function(T,A){T=this.words=T||[],A!=g?this.sigBytes=A:this.sigBytes=T.length*4},toString:function(T){return(T||P).stringify(this)},concat:function(T){var A=this.words,y=T.words,B=this.sigBytes,U=T.sigBytes;if(this.clamp(),B%4)for(var I=0;I<U;I++){var K=y[I>>>2]>>>24-I%4*8&255;A[B+I>>>2]|=K<<24-(B+I)%4*8}else for(var I=0;I<U;I+=4)A[B+I>>>2]=y[I>>>2];return this.sigBytes+=U,this},clamp:function(){var T=this.words,A=this.sigBytes;T[A>>>2]&=4294967295<<32-A%4*8,T.length=d.ceil(A/4)},clone:function(){var T=v.clone.call(this);return T.words=this.words.slice(0),T},random:function(T){for(var A=[],y=0;y<T;y+=4)A.push(S());return new M.init(A,T)}}),z=E.enc={},P=z.Hex={stringify:function(T){for(var A=T.words,y=T.sigBytes,B=[],U=0;U<y;U++){var I=A[U>>>2]>>>24-U%4*8&255;B.push((I>>>4).toString(16)),B.push((I&15).toString(16))}return B.join("")},parse:function(T){for(var A=T.length,y=[],B=0;B<A;B+=2)y[B>>>3]|=parseInt(T.substr(B,2),16)<<24-B%8*4;return new M.init(y,A/2)}},j=z.Latin1={stringify:function(T){for(var A=T.words,y=T.sigBytes,B=[],U=0;U<y;U++){var I=A[U>>>2]>>>24-U%4*8&255;B.push(String.fromCharCode(I))}return B.join("")},parse:function(T){for(var A=T.length,y=[],B=0;B<A;B++)y[B>>>2]|=(T.charCodeAt(B)&255)<<24-B%4*8;return new M.init(y,A)}},x=z.Utf8={stringify:function(T){try{return decodeURIComponent(escape(j.stringify(T)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(T){return j.parse(unescape(encodeURIComponent(T)))}},L=R.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new M.init,this._nDataBytes=0},_append:function(T){typeof T=="string"&&(T=x.parse(T)),this._data.concat(T),this._nDataBytes+=T.sigBytes},_process:function(T){var A,y=this._data,B=y.words,U=y.sigBytes,I=this.blockSize,K=I*4,Q=U/K;T?Q=d.ceil(Q):Q=d.max((Q|0)-this._minBufferSize,0);var X=Q*I,Y=d.min(X*4,U);if(X){for(var D=0;D<X;D+=I)this._doProcessBlock(B,D);A=B.splice(0,X),y.sigBytes-=Y}return new M.init(A,Y)},clone:function(){var T=v.clone.call(this);return T._data=this._data.clone(),T},_minBufferSize:0});R.Hasher=L.extend({cfg:v.extend(),init:function(T){this.cfg=this.cfg.extend(T),this.reset()},reset:function(){L.reset.call(this),this._doReset()},update:function(T){return this._append(T),this._process(),this},finalize:function(T){T&&this._append(T);var A=this._doFinalize();return A},blockSize:16,_createHelper:function(T){return function(A,y){return new T.init(y).finalize(A)}},_createHmacHelper:function(T){return function(A,y){return new O.HMAC.init(T,y).finalize(A)}}});var O=E.algo={};return E})(Math);return c})}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(3));function m(E,R,v){try{R.apply(E,v)}catch(M){d.default.logAction(d.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+M+"; stack = "+(M&&M.stack))}}function S(E,R,v){for(var M,z,P,j=0;j<E.length;j++)if(M=E[j],v&&(M=M[v]),c.isArray(M)){for(;(z=c.arrIndexOf(M,R))!==-1;)M.splice(z,1);v&&M.length===0&&delete E[j][v]}else if(c.isObject(M))for(P in M)Object.prototype.hasOwnProperty.call(M,P)&&c.isArray(M[P])&&S([M],R,P)}var C=(function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var R=this,v=[],M=0;M<arguments.length;M++)v[M]=arguments[M];if(v.length===1){var z=v[0];if(typeof z=="function")this.any.push(z);else throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v))}if(v.length===2){var P=v[0],j=v[1];if(typeof j!="function")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));if(c.isEmptyArg(P))this.any.push(j);else if(c.isArray(P))P.forEach(function(L){R.on(L,j)});else{if(typeof P!="string")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));var x=this.events[P]||(this.events[P]=[]);x.push(j)}}},E.prototype.off=function(){for(var R,v=this,M=[],z=0;z<arguments.length;z++)M[z]=arguments[z];if(M.length==0||c.isEmptyArg(M[0])&&c.isEmptyArg(M[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var P=M[0],j=M[1],x=null,L=null;if(M.length===1||!j)typeof P=="function"?x=P:L=P;else{if(typeof j!="function")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(M));R=[P,j],L=R[0],x=R[1]}if(x&&c.isEmptyArg(L)){S([this.any,this.events,this.anyOnce,this.eventsOnce],x);return}if(c.isArray(L)){L.forEach(function(O){v.off(O,x)});return}if(typeof L!="string")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(M));x?S([this.events,this.eventsOnce],x,L):(delete this.events[L],delete this.eventsOnce[L])},E.prototype.listeners=function(R){if(R){var v=this.events[R]||[];return this.eventsOnce[R]&&Array.prototype.push.apply(v,this.eventsOnce[R]),v.length?v:null}return this.any.length?this.any:null},E.prototype.emit=function(R){for(var v=[],M=1;M<arguments.length;M++)v[M-1]=arguments[M];var z={event:R},P=[];this.anyOnce.length&&(Array.prototype.push.apply(P,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(P,this.any);var j=this.eventsOnce[R];j&&(Array.prototype.push.apply(P,j),delete this.eventsOnce[R]);var x=this.events[R];x&&Array.prototype.push.apply(P,x),c.arrForEach(P,function(L){m(z,L,v)})},E.prototype.once=function(){for(var R=this,v=[],M=0;M<arguments.length;M++)v[M]=arguments[M];var z=v.length;if((z===0||z===1&&typeof v[0]!="function")&&g.default.Config.Promise){var P=v[0];return new g.default.Config.Promise(function(A){R.once(P,A)})}var j=v[0],x=v[1];if(v.length===1&&typeof j=="function")this.anyOnce.push(j);else if(c.isEmptyArg(j)){if(typeof x!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));this.anyOnce.push(x)}else if(c.isArray(j)){var L=this,O=function(){var A=Array.prototype.slice.call(arguments);if(c.arrForEach(j,function(y){L.off(y,O)}),typeof x!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));x.apply(this,A)};c.arrForEach(j,function(A){L.on(A,O)})}else{if(typeof j!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));var T=this.eventsOnce[j]||(this.eventsOnce[j]=[]);if(x){if(typeof x!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));T.push(x)}}},E.prototype.whenState=function(R,v,M){for(var z=this,P=[],j=3;j<arguments.length;j++)P[j-3]=arguments[j];var x={event:R};if(typeof R!="string"||typeof v!="string")throw"whenState requires a valid event String argument";if(typeof M!="function"&&g.default.Config.Promise)return new g.default.Config.Promise(function(L){E.prototype.whenState.apply(z,[R,v,L].concat(P))});R===v?m(x,M,P):this.once(R,M)},E})();a.default=C}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.getDefaults=a.normaliseOptions=a.objectifyOptions=a.getAgentString=a.getHosts=a.getFallbackHosts=a.environmentFallbackHosts=a.getHttpScheme=a.getPort=a.getHost=void 0;var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(4)),S=r(43),C="ably-js/"+S.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:S.version,protocolVersion:2,agent:C,getHost:R,getPort:v,getHttpScheme:M,environmentFallbackHosts:z,getFallbackHosts:P,getHosts:j,checkHost:x,objectifyOptions:A,normaliseOptions:y};function R(U,I,K){return K?I=I==U.restHost&&U.realtimeHost||I||U.realtimeHost:I=I||U.restHost,I}a.getHost=R;function v(U,I){return I||U.tls?U.tlsPort:U.port}a.getPort=v;function M(U){return U.tls?"https://":"http://"}a.getHttpScheme=M;function z(U){return[U+"-a-fallback.ably-realtime.com",U+"-b-fallback.ably-realtime.com",U+"-c-fallback.ably-realtime.com",U+"-d-fallback.ably-realtime.com",U+"-e-fallback.ably-realtime.com"]}a.environmentFallbackHosts=z;function P(U){var I=U.fallbackHosts,K=typeof U.httpMaxRetryCount<"u"?U.httpMaxRetryCount:E.httpMaxRetryCount;return I?d.arrChooseN(I,K):[]}a.getFallbackHosts=P;function j(U){return[U.restHost].concat(P(U))}a.getHosts=j;function x(U){if(typeof U!="string")throw new m.default("host must be a string; was a "+typeof U,4e4,400);if(!U.length)throw new m.default("host must not be zero-length",4e4,400)}function L(U,I,K){return U.realtimeHost?U.realtimeHost:U.restHost?(g.default.logAction(g.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+U.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+U.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),U.restHost):I?E.REALTIME_HOST:K+"-"+E.REALTIME_HOST}function O(U){var I={};for(var K in E.TIMEOUTS)I[K]=U[K]||E.TIMEOUTS[K];return I}function T(U){var I=E.agent;if(U.agents)for(var K in U.agents)I+=" "+K+"/"+U.agents[K];return I}a.getAgentString=T;function A(U){return typeof U=="string"?U.indexOf(":")==-1?{token:U}:{key:U}:U}a.objectifyOptions=A;function y(U){if(U.host&&(g.default.renamedClientOption("host","restHost"),U.restHost=U.host),U.wsHost&&(g.default.renamedClientOption("wsHost","realtimeHost"),U.realtimeHost=U.wsHost),U.queueEvents&&(g.default.renamedClientOption("queueEvents","queueMessages"),U.queueMessages=U.queueEvents),U.headers&&g.default.deprecated("the `headers` client option",""),U.fallbackHostsUseDefault){if(U.fallbackHosts){var I="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",I),new m.default(I,4e4,400)}if(U.port||U.tlsPort){var I="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",I),new m.default(I,4e4,400)}U.environment?g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),U.fallbackHosts=E.FALLBACK_HOSTS}U.recover===!0&&(g.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),U.recover=function(st,V){V(!0)}),typeof U.recover=="function"&&U.closeOnUnload===!0&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),U.recover=void 0),"closeOnUnload"in U||(U.closeOnUnload=!U.recover),U.transports&&d.arrIn(U.transports,"xhr")&&(g.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),d.arrDeleteValue(U.transports,"xhr"),U.transports.push("xhr_streaming")),"queueMessages"in U||(U.queueMessages=!0);var K=U.environment&&String(U.environment).toLowerCase()||E.ENVIRONMENT,Q=!K||K==="production";!U.fallbackHosts&&!U.restHost&&!U.realtimeHost&&!U.port&&!U.tlsPort&&(U.fallbackHosts=Q?E.FALLBACK_HOSTS:z(K));var X=U.restHost||(Q?E.REST_HOST:K+"-"+E.REST_HOST),Y=L(U,Q,K);d.arrForEach((U.fallbackHosts||[]).concat(X,Y),x),U.port=U.port||E.PORT,U.tlsPort=U.tlsPort||E.TLS_PORT,"tls"in U||(U.tls=!0);var D=O(U);if("useBinaryProtocol"in U?U.useBinaryProtocol=c.default.Config.supportsBinary&&U.useBinaryProtocol:U.useBinaryProtocol=c.default.Config.preferBinary,U.clientId){var H=U.headers=U.headers||{};H["X-Ably-ClientId"]=c.default.BufferUtils.base64Encode(c.default.BufferUtils.utf8Encode(U.clientId))}"idempotentRestPublishing"in U||(U.idempotentRestPublishing=!0),U.promises&&!c.default.Config.Promise&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),U.promises=!1);var F=null,tt=U.connectivityCheckUrl;if(U.connectivityCheckUrl){var at=U.connectivityCheckUrl.split("?"),Z=at[0],it=at[1];F=it?d.parseQueryString(it):{},Z.indexOf("://")===-1&&(Z="https://"+Z),tt=Z}return l.__assign(l.__assign({},U),{useBinaryProtocol:"useBinaryProtocol"in U?c.default.Config.supportsBinary&&U.useBinaryProtocol:c.default.Config.preferBinary,realtimeHost:Y,restHost:X,maxMessageSize:U.maxMessageSize||E.maxMessageSize,timeouts:D,connectivityCheckParams:F,connectivityCheckUrl:tt})}a.normaliseOptions=y,a.default=E;function B(U){return Object.assign(E,U)}a.getDefaults=B}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importDefault(r(2)),g=l.__importDefault(r(4)),m=l.__importStar(r(1));function S(v){return!v||!v.channelOptions?{channelOptions:v,plugins:{},baseEncodedPreviousPayload:void 0}:v}function C(v){if(v&&v.cipher){if(!c.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var M=c.default.Crypto.getCipher(v.cipher);return{cipher:M.cipherParams,channelCipher:M.cipher}}return v??{}}function E(v){var M=0;return v.name&&(M+=v.name.length),v.clientId&&(M+=v.clientId.length),v.extras&&(M+=JSON.stringify(v.extras).length),v.data&&(M+=m.dataSizeBytes(v.data)),M}var R=(function(){function v(){}return v.prototype.toJSON=function(){var M=this.encoding,z=this.data;return z&&c.default.BufferUtils.isBuffer(z)&&(arguments.length>0?(M=M?M+"/base64":"base64",z=c.default.BufferUtils.base64Encode(z)):z=c.default.BufferUtils.toBuffer(z)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:M,data:z}},v.prototype.toString=function(){var M="[Message";return this.name&&(M+="; name="+this.name),this.id&&(M+="; id="+this.id),this.timestamp&&(M+="; timestamp="+this.timestamp),this.clientId&&(M+="; clientId="+this.clientId),this.connectionId&&(M+="; connectionId="+this.connectionId),this.encoding&&(M+="; encoding="+this.encoding),this.extras&&(M+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?M+="; data="+this.data:c.default.BufferUtils.isBuffer(this.data)?M+="; data (buffer)="+c.default.BufferUtils.base64Encode(this.data):M+="; data (json)="+JSON.stringify(this.data)),this.extras&&(M+="; extras="+JSON.stringify(this.extras)),M+="]",M},v.encrypt=function(M,z,P){var j=M.data,x=M.encoding,L=z.channelCipher;x=x?x+"/":"",c.default.BufferUtils.isBuffer(j)||(j=c.default.BufferUtils.utf8Encode(String(j)),x=x+"utf-8/"),L.encrypt(j,function(O,T){if(O){P(O);return}M.data=T,M.encoding=x+"cipher+"+L.algorithm,P(null,M)})},v.encode=function(M,z,P){var j=M.data,x=typeof j=="string"||c.default.BufferUtils.isBuffer(j)||j===null||j===void 0;if(!x)if(m.isObject(j)||m.isArray(j))M.data=JSON.stringify(j),M.encoding=M.encoding?M.encoding+"/json":"json";else throw new g.default("Data type is unsupported",40013,400);z!=null&&z.cipher?v.encrypt(M,z,P):P(null,M)},v.encodeArray=function(M,z,P){for(var j=0,x=0;x<M.length;x++)v.encode(M[x],z,function(L){if(L){P(L);return}j++,j==M.length&&P(null,M)})},v.decode=function(M,z){var P=S(z),j=M.data,x=M.encoding;if(x){var L=x.split("/"),O=void 0,T=L.length,A=M.data,y="";try{for(;(O=T)>0;){var B=L[--T].match(/([-\w]+)(\+([\w-]+))?/);if(!B)break;switch(y=B[1],y){case"base64":A=c.default.BufferUtils.base64Decode(String(A)),O==L.length&&(j=A);continue;case"utf-8":A=c.default.BufferUtils.utf8Decode(A);continue;case"json":A=JSON.parse(A);continue;case"cipher":if(P.channelOptions!=null&&P.channelOptions.cipher&&P.channelOptions.channelCipher){var U=B[3],I=P.channelOptions.channelCipher;if(U!=I.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");A=I.decrypt(A);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!P.plugins||!P.plugins.vcdiff)throw new g.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new g.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var K=P.baseEncodedPreviousPayload;typeof K=="string"&&(K=c.default.BufferUtils.utf8Encode(K)),K=c.default.BufferUtils.toBuffer(K),A=c.default.BufferUtils.toBuffer(A),A=c.default.BufferUtils.typedArrayToBuffer(P.plugins.vcdiff.decode(A,K)),j=A}catch(X){throw new g.default("Vcdiff delta decode failed with "+X,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(X){var Q=X;throw new g.default("Error processing the "+y+" encoding, decoder returned ‘"+Q.message+"’",Q.code||40013,400)}finally{M.encoding=O<=0?null:L.slice(0,O).join("/"),M.data=A}}P.baseEncodedPreviousPayload=j},v.fromResponseBody=function(M,z,P){P&&(M=m.decodeBody(M,P));for(var j=0;j<M.length;j++){var x=M[j]=v.fromValues(M[j]);try{v.decode(x,z)}catch(L){d.default.logAction(d.default.LOG_ERROR,"Message.fromResponseBody()",L.toString())}}return M},v.fromValues=function(M){return Object.assign(new v,M)},v.fromValuesArray=function(M){for(var z=M.length,P=new Array(z),j=0;j<z;j++)P[j]=v.fromValues(M[j]);return P},v.fromEncoded=function(M,z){var P=v.fromValues(M),j=C(z??null);try{v.decode(P,j)}catch(x){d.default.logAction(d.default.LOG_ERROR,"Message.fromEncoded()",x.toString())}return P},v.fromEncodedArray=function(M,z){return M.map(function(P){return v.fromEncoded(P,z)})},v.getMessagesSize=function(M){for(var z,P=0,j=0;j<M.length;j++)z=M[j],P+=z.size||(z.size=E(z));return P},v.serialize=m.encodeBody,v})();a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(4)),g=l.__importDefault(r(9)),m=l.__importDefault(r(16)),S={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(S).forEach(function(P){C[S[P]]=P});var E={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},R=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function v(P){var j=[];if(P)for(var x=0;x<P.length;x++)j.push(P[x].toString());return"[ "+j.join(", ")+" ]"}var M="id channel channelSerial connectionId count msgSerial timestamp".split(" "),z=(function(){function P(){var j=this;this.hasFlag=function(x){return(j.flags&E[x])>0}}return P.prototype.setFlag=function(j){return this.flags=this.flags|E[j]},P.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},P.prototype.encodeModesToFlags=function(j){var x=this;j.forEach(function(L){return x.setFlag(L)})},P.prototype.decodeModesFromFlags=function(){var j=this,x=[];return P.channelModes.forEach(function(L){j.hasFlag(L)&&x.push(L)}),x.length>0?x:void 0},P.fromValues=function(j){return Object.assign(new P,j)},P.Action=S,P.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],P.ActionName=C,P.serialize=c.encodeBody,P.deserialize=function(j,x){var L=c.decodeBody(j,x);return P.fromDeserialized(L)},P.fromDeserialized=function(j){var x=j.error;x&&(j.error=d.default.fromValues(x));var L=j.messages;if(L)for(var O=0;O<L.length;O++)L[O]=g.default.fromValues(L[O]);var T=j.presence;if(T)for(var O=0;O<T.length;O++)T[O]=m.default.fromValues(T[O],!0);return Object.assign(new P,j)},P.stringify=function(j){var x="[ProtocolMessage";j.action!==void 0&&(x+="; action="+P.ActionName[j.action]||!1);for(var L,O=0;O<M.length;O++)L=M[O],j[L]!==void 0&&(x+="; "+L+"="+j[L]);if(j.messages&&(x+="; messages="+v(g.default.fromValuesArray(j.messages))),j.presence&&(x+="; presence="+v(m.default.fromValuesArray(j.presence))),j.error&&(x+="; error="+d.default.fromValues(j.error).toString()),j.auth&&j.auth.accessToken&&(x+="; token="+j.auth.accessToken),j.flags&&(x+="; flags="+R.filter(j.hasFlag).join(",")),j.params){var T="";c.forInOwnNonNullProperties(j.params,function(A){T.length>0&&(T+="; "),T+=A+"="+j.params[A]}),T.length>0&&(x+="; params=["+T+"]")}return x+="]",x},P})();a.default=z}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=c.enc;m.Base64={stringify:function(C){var E=C.words,R=C.sigBytes,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var M=[],z=0;z<R;z+=3)for(var P=E[z>>>2]>>>24-z%4*8&255,j=E[z+1>>>2]>>>24-(z+1)%4*8&255,x=E[z+2>>>2]>>>24-(z+2)%4*8&255,L=P<<16|j<<8|x,O=0;O<4&&z+O*.75<R;O++)M.push(v.charAt(L>>>6*(3-O)&63));var T=v.charAt(64);if(T)for(;M.length%4;)M.push(T);return M.join("")},parse:function(C){var E=C.length,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var M=0;M<R.length;M++)v[R.charCodeAt(M)]=M}var z=R.charAt(64);if(z){var P=C.indexOf(z);P!==-1&&(E=P)}return S(C,E,v)}};function S(C,E,R){for(var v=[],M=0,z=0;z<E;z++)if(z%4){var P=R[C.charCodeAt(z-1)]<<z%4*2,j=R[C.charCodeAt(z)]>>>6-z%4*2,x=P|j;v[M>>>2]|=x<<24-M%4*8,M++}return g.create(v,M)}})(),l.enc.Base64})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(10)),g=l.__importDefault(r(26)),m=l.__importDefault(r(2)),S=l.__importDefault(r(8)),C=l.__importDefault(r(21)),E=l.__importDefault(r(18)),R=l.__importDefault(r(4)),v=l.__importDefault(r(22)),M=l.__importDefault(r(3));function z(x){var L=[80015,80017,80030];return x.code?E.default.isTokenErr(x)?!1:c.arrIn(L,x.code)?!0:x.code>=4e4&&x.code<5e4:!1}function P(x){return z(x)?[d.default.fromValues({action:d.default.Action.ERROR,error:x})]:[d.default.fromValues({action:d.default.Action.DISCONNECTED,error:x})]}var j=(function(x){l.__extends(L,x);function L(O,T,A){var y=x.call(this,O,T,A,!0)||this;return y.onAuthUpdated=function(B){y.authParams={access_token:B.token}},y.stream="stream"in A?A.stream:!0,y.sendRequest=null,y.recvRequest=null,y.pendingCallback=null,y.pendingItems=null,y}return L.prototype.connect=function(){var O=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","starting"),g.default.prototype.connect.call(this);var T=this.params,A=T.options,y=S.default.getHost(A,T.host),B=S.default.getPort(A),U=A.tls?"https://":"http://";this.baseUri=U+y+":"+B+"/comet/";var I=this.baseUri+"connect";m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","uri: "+I),this.auth.getAuthParams(function(K,Q){if(K){O.disconnect(K);return}if(!O.isDisposed){O.authParams=Q;var X=O.params.getConnectParams(Q);"stream"in X&&(O.stream=X.stream),m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+c.toQueryString(X));var Y=!1,D=O.recvRequest=O.createRequest(I,null,X,null,O.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV);D.on("data",function(H){O.recvRequest&&(Y||(Y=!0,O.emit("preconnect")),O.onData(H))}),D.on("complete",function(H){if(O.recvRequest||(H=H||new R.default("Request cancelled",80003,400)),O.recvRequest=null,!Y&&!H&&(Y=!0,O.emit("preconnect")),O.onActivity(),H){H.code?O.onData(P(H)):O.disconnect(H);return}M.default.Config.nextTick(function(){O.recv()})}),D.exec()}})},L.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},L.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},L.prototype._requestCloseOrDisconnect=function(O){var T=this,A=O?this.closeUri:this.disconnectUri;if(A){var y=this.createRequest(A,null,this.authParams,null,v.default.REQ_SEND);y.on("complete",function(B){B&&(m.default.logAction(m.default.LOG_ERROR,"CometTransport.request"+(O?"Close()":"Disconnect()"),"request returned err = "+c.inspectError(B)),T.finish("disconnected",B))}),y.exec()}},L.prototype.dispose=function(){var O=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),M.default.Config.nextTick(function(){O.emit("disposed")}))},L.prototype.onConnect=function(O){var T;if(!this.isDisposed){var A=(T=O.connectionDetails)===null||T===void 0?void 0:T.connectionKey;g.default.prototype.onConnect.call(this,O);var y=this.baseUri+A;m.default.logAction(m.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+y),this.sendUri=y+"/send",this.recvUri=y+"/recv",this.closeUri=y+"/close",this.disconnectUri=y+"/disconnect"}},L.prototype.send=function(O){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(O);return}var T=this.pendingItems||[];T.push(O),this.pendingItems=null,this.sendItems(T)},L.prototype.sendAnyPending=function(){var O=this.pendingItems;O&&(this.pendingItems=null,this.sendItems(O))},L.prototype.sendItems=function(O){var T=this,A=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(O),v.default.REQ_SEND);A.on("complete",function(y,B){if(y&&m.default.logAction(m.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+c.inspectError(y)),T.sendRequest=null,y){y.code?T.onData(P(y)):T.disconnect(y);return}B&&T.onData(B),T.pendingItems&&M.default.Config.nextTick(function(){T.sendRequest||T.sendAnyPending()})}),A.exec()},L.prototype.recv=function(){var O=this;if(!this.recvRequest&&this.isConnected){var T=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV_POLL);T.on("data",function(A){O.onData(A)}),T.on("complete",function(A){if(O.recvRequest=null,O.onActivity(),A){A.code?O.onData(P(A)):O.disconnect(A);return}M.default.Config.nextTick(function(){O.recv()})}),T.exec()}},L.prototype.onData=function(O){try{var T=this.decodeResponse(O);if(T&&T.length)for(var A=0;A<T.length;A++)this.onProtocolMessage(d.default.fromDeserialized(T[A]))}catch(y){m.default.logAction(m.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+y.stack)}},L.prototype.encodeRequest=function(O){return JSON.stringify(O)},L.prototype.decodeResponse=function(O){return typeof O=="string"?JSON.parse(O):O},L})(g.default);a.default=j}),(function(n,a){var r;r=(function(){return this})();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.isSuccessCode=void 0;var l;(function(d){d[d.Success=200]="Success",d[d.NoContent=204]="NoContent",d[d.BadRequest=400]="BadRequest",d[d.Unauthorized=401]="Unauthorized",d[d.Forbidden=403]="Forbidden",d[d.RequestTimeout=408]="RequestTimeout",d[d.InternalServerError=500]="InternalServerError"})(l||(l={}));function c(d){return d>=l.Success&&d<l.BadRequest}a.isSuccessCode=c,a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(18)),S=l.__importDefault(r(19)),C=r(4),E=l.__importDefault(r(14));function R(x,L,O,T,A){x.http.supportsAuthHeaders?x.auth.getAuthHeaders(function(y,B){y?T(y):A(d.mixin(B,L),O)}):x.auth.getAuthParams(function(y,B){y?T(y):A(L,d.mixin(B,O))})}function v(x,L){return function(O,T,A,y,B){if(O&&!T){x(O);return}if(B===E.default.NoContent){x(O,[],A,!0,B);return}if(!y)try{T=d.decodeBody(T,L)}catch(Y){d.isErrorInfoOrPartialErrorInfo(Y)?x(Y):x(new C.PartialErrorInfo(d.inspectError(Y),null));return}if(!T){x(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var U=T,I=U.statusCode,K=U.response,Q=U.headers;if(I===void 0){x(O,T,A,!0,B);return}if(I<200||I>=300){var X=K&&K.error||O;X||(X=new Error("Error in unenveloping "+T),X.statusCode=I),x(X,K,Q,!0,I);return}x(O,K,Q,!0,I)}}function M(x){var L=[];if(x)for(var O in x)L.push(O+"="+x[O]);return L.join("&")}function z(x,L){return x+(L?"?":"")+M(L)}function P(x,L,O,T){return function(A,y,B,U,I){A?g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Received Error; "+z(O,T)+"; Error: "+d.inspectError(A)):g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Received; "+z(O,T)+"; Headers: "+M(B)+"; StatusCode: "+I+"; Body: "+(c.default.BufferUtils.isBuffer(y)?y.toString():y)),x&&x(A,y,B,U,I)}}var j=(function(){function x(){}return x.get=function(L,O,T,A,y,B){x.do(S.default.Get,L,O,null,T,A,y,B)},x.delete=function(L,O,T,A,y,B){x.do(S.default.Delete,L,O,null,T,A,y,B)},x.post=function(L,O,T,A,y,B,U){x.do(S.default.Post,L,O,T,A,y,B,U)},x.patch=function(L,O,T,A,y,B,U){x.do(S.default.Patch,L,O,T,A,y,B,U)},x.put=function(L,O,T,A,y,B,U){x.do(S.default.Put,L,O,T,A,y,B,U)},x.do=function(L,O,T,A,y,B,U,I){g.default.shouldLog(g.default.LOG_MICRO)&&(I=P(I,L,T,B)),U&&(I=I&&v(I,U),(B=B||{}).envelope=U);function K(Q,X){var Y;if(g.default.shouldLog(g.default.LOG_MICRO)&&g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Sending; "+z(T,X)),g.default.shouldLog(g.default.LOG_MICRO)){var D=A;if(((Y=Q["content-type"])===null||Y===void 0?void 0:Y.indexOf("msgpack"))>0)try{D=c.default.Config.msgpack.decode(A)}catch(H){g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Sending MsgPack Decoding Error: "+d.inspectError(H))}g.default.logAction(g.default.LOG_MICRO,"Resource."+L+"()","Sending; "+z(T,X)+"; Body: "+D)}O.http.do(L,O,T,Q,A,X,function(H,F,tt,at,Z){if(H&&m.default.isTokenErr(H)){O.auth.authorize(null,null,function(it){if(it){I(it);return}R(O,Q,X,I,K)});return}I(H,F,tt,at,Z)})}R(O,y,B,I,K)},x})();a.default=j}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=l.__importDefault(r(3)),g=l.__importDefault(r(9)),m=l.__importStar(r(1));function S(E){return C.Actions.indexOf(E)}var C=(function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var R=this.id.split(":");return{connectionId:R[0],msgSerial:parseInt(R[1],10),index:parseInt(R[2],10)}},E.prototype.toJSON=function(){var R=this.data,v=this.encoding;return R&&d.default.BufferUtils.isBuffer(R)&&(arguments.length>0?(v=v?v+"/base64":"base64",R=d.default.BufferUtils.base64Encode(R)):R=d.default.BufferUtils.toBuffer(R)),{id:this.id,clientId:this.clientId,action:S(this.action),data:R,encoding:v,extras:this.extras}},E.prototype.toString=function(){var R="[PresenceMessage";return R+="; action="+this.action,this.id&&(R+="; id="+this.id),this.timestamp&&(R+="; timestamp="+this.timestamp),this.clientId&&(R+="; clientId="+this.clientId),this.connectionId&&(R+="; connectionId="+this.connectionId),this.encoding&&(R+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?R+="; data="+this.data:d.default.BufferUtils.isBuffer(this.data)?R+="; data (buffer)="+d.default.BufferUtils.base64Encode(this.data):R+="; data (json)="+JSON.stringify(this.data)),this.extras&&(R+="; extras="+JSON.stringify(this.extras)),R+="]",R},E.fromResponseBody=function(R,v,M){var z=[];M&&(R=m.decodeBody(R,M));for(var P=0;P<R.length;P++){var j=z[P]=E.fromValues(R[P],!0);try{E.decode(j,v)}catch(x){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",x.toString())}}return z},E.fromValues=function(R,v){return v&&(R.action=E.Actions[R.action]),Object.assign(new E,R)},E.fromValuesArray=function(R){for(var v=R.length,M=new Array(v),z=0;z<v;z++)M[z]=E.fromValues(R[z]);return M},E.fromEncoded=function(R,v){var M=E.fromValues(R,!0);try{E.decode(M,v??{})}catch(z){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromEncoded()",z.toString())}return M},E.fromEncodedArray=function(R,v){return R.map(function(M){return E.fromEncoded(M,v)})},E.fromData=function(R){return R instanceof E?R:E.fromValues({data:R})},E.Actions=["absent","present","enter","leave","update"],E.encode=g.default.encode,E.decode=g.default.decode,E.getMessagesSize=g.default.getMessagesSize,E})();a.default=C}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var c=r(0),d=c.__importStar(r(1)),g=c.__importDefault(r(7)),m=c.__importStar(r(4)),S=c.__importDefault(r(2)),C=c.__importDefault(r(8)),E=c.__importDefault(r(22)),R=c.__importDefault(r(3));function v(U,I){return d.arrIn(d.allToLowerCase(d.keysArray(I)),"x-ably-errorcode")}function M(U,I){if(v(U,I))return U.error&&m.default.fromValues(U.error)}var z=function(){},P=0,j={},x=typeof l<"u"&&l.XDomainRequest;function L(){var U=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return U&&Number(U[1])}function O(){var U;return x&&(U=L())&&U===10}function T(U,I){return U.getResponseHeader&&U.getResponseHeader(I)}function A(U){return U.getResponseHeader&&(U.getResponseHeader("transfer-encoding")||!U.getResponseHeader("content-length"))}function y(U){for(var I=d.trim(U.getAllResponseHeaders()).split(`\r
`),K={},Q=0;Q<I.length;Q++){var X=I[Q].split(":").map(d.trim);K[X[0].toLowerCase()]=X[1]}return K}var B=(function(U){c.__extends(I,U);function I(K,Q,X,Y,D,H,F){var tt=U.call(this)||this;return X=X||{},X.rnd=d.cheapRandStr(),O()&&!X.envelope&&(X.envelope="json"),tt.uri=K+d.toQueryString(X),tt.headers=Q||{},tt.body=Y,tt.method=F?F.toUpperCase():d.isEmptyArg(Y)?"GET":"POST",tt.requestMode=D,tt.timeouts=H,tt.timedOut=!1,tt.requestComplete=!1,tt.id=String(++P),j[tt.id]=tt,tt}return I.createRequest=function(K,Q,X,Y,D,H,F){var tt=H||C.default.TIMEOUTS;return new I(K,Q,d.copy(X),Y,D,tt,F)},I.prototype.complete=function(K,Q,X,Y,D){this.requestComplete||(this.requestComplete=!0,!K&&Q&&this.emit("data",Q),this.emit("complete",K,Q,X,Y,D),this.dispose())},I.prototype.abort=function(){this.dispose()},I.prototype.exec=function(){var K=this,Q=this.headers,X=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,Y=this.timer=setTimeout(function(){K.timedOut=!0,H.abort()},X),D=this.method,H=this.xhr=new XMLHttpRequest,F=Q.accept,tt=this.body,at="text";if(F?F.indexOf("application/x-msgpack")===0&&(at="arraybuffer"):Q.accept="application/json",tt){var Z=Q["content-type"]||(Q["content-type"]="application/json");Z.indexOf("application/json")>-1&&typeof tt!="string"&&(tt=JSON.stringify(tt))}H.open(D,this.uri,!0),H.responseType=at,"authorization"in Q&&(H.withCredentials=!0);for(var it in Q)H.setRequestHeader(it,Q[it]);var st=function(kt,Re,Ee,ze){var Xe,nn=Re+" (event type: "+kt.type+")";!((Xe=K==null?void 0:K.xhr)===null||Xe===void 0)&&Xe.statusText&&(nn+=", current statusText is "+K.xhr.statusText),S.default.logAction(S.default.LOG_ERROR,"Request.on"+kt.type+"()",nn),K.complete(new m.PartialErrorInfo(nn,Ee,ze))};H.onerror=function(kt){st(kt,"XHR error occurred",null,400)},H.onabort=function(kt){K.timedOut?st(kt,"Request aborted due to request timeout expiring",null,408):st(kt,"Request cancelled",null,400)},H.ontimeout=function(kt){st(kt,"Request timed out",null,408)};var V,J,W,nt=0,dt=!1,Rt=function(){if(clearTimeout(Y),W=J<400,J==204){K.complete(null,null,null,null,J);return}V=K.requestMode==E.default.REQ_RECV_STREAM&&W&&A(H)},Ut=function(){var kt;try{var Re=T(H,"content-type"),Ee=Re?Re.indexOf("application/json")>=0:H.responseType=="text";if(Ee){var ze=H.responseType==="arraybuffer"?R.default.BufferUtils.utf8Decode(H.response):String(H.responseText);ze.length?kt=JSON.parse(ze):kt=ze,dt=!0}else kt=H.response;kt.response!==void 0?(J=kt.statusCode,W=J<400,Q=kt.headers,kt=kt.response):Q=y(H)}catch(nn){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+nn.message,null,400));return}if(W||d.isArray(kt)){K.complete(null,kt,Q,dt,J);return}var Xe=M(kt,Q);Xe||(Xe=new m.PartialErrorInfo("Error response received from server: "+J+" body was: "+R.default.Config.inspect(kt),null,J)),K.complete(Xe,kt,Q,dt,J)};function Xt(){for(var kt=H.responseText,Re=kt.length-1,Ee,ze;nt<Re&&(Ee=kt.indexOf(`
`,nt))>-1;)ze=kt.slice(nt,Ee),nt=Ee+1,$t(ze)}var $t=function(kt){try{kt=JSON.parse(kt)}catch(Re){K.complete(new m.PartialErrorInfo("Malformed response body from server: "+Re.message,null,400));return}K.emit("data",kt)},oe=function(){Xt(),K.streamComplete=!0,R.default.Config.nextTick(function(){K.complete()})};H.onreadystatechange=function(){var kt=H.readyState;kt<3||H.status!==0&&(J===void 0&&(J=H.status,J===1223&&(J=204),Rt()),kt==3&&V?Xt():kt==4&&(V?oe():Ut()))},H.send(tt)},I.prototype.dispose=function(){var K=this.xhr;if(K){K.onreadystatechange=K.onerror=K.onabort=K.ontimeout=z,this.xhr=null;var Q=this.timer;Q&&(clearTimeout(Q),this.timer=null),this.requestComplete||K.abort()}delete j[this.id]},I})(g.default);a.default=B}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=l.__importStar(r(1)),g=l.__importDefault(r(24)),m=l.__importDefault(r(4)),S=l.__importDefault(r(45)),C=r(11),E=l.__importDefault(r(19)),R=l.__importDefault(r(14)),v=l.__importDefault(r(3)),M=l.__importDefault(r(15)),z=Math.pow(2,17);function P(){}function j(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function x(X){return!!X.connection}function L(X){return d.isErrorInfoOrPartialErrorInfo(X)?(X.code||(X.statusCode===403?X.code=40300:(X.code=40170,X.statusCode=401)),X):new m.default(d.inspectError(X),X.code||40170,X.statusCode||401)}var O=function(X,Y){if(v.default.Config.createHmac){var D=v.default.Config.createHmac("SHA256",Y);return D.update(X),D.digest("base64")}return(0,C.stringify)((0,S.default)(X,Y))};function T(X){if(!X)return"";typeof X=="string"&&(X=JSON.parse(X));var Y=Object.create(null),D=d.keysArray(X,!0);if(!D)return"";D.sort();for(var H=0;H<D.length;H++)Y[D[H]]=X[D[H]].sort();return JSON.stringify(Y)}function A(X){if(X.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(X.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(X.key)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(X.tokenDetails)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var Y="authOptions must include valid authentication parameters";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",Y),new Error(Y)}}function y(X){return"useTokenAuth"in X&&!X.useTokenAuth}function B(X){return X.useTokenAuth||!y(X)&&(X.authCallback||X.authUrl||X.token||X.tokenDetails)}function U(X){return!X.key&&!X.authCallback&&!X.authUrl}var I=0;function K(){return I++}var Q=(function(){function X(Y,D){if(this.authOptions={},this.client=Y,this.tokenParams=D.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,B(D)){if(D.key&&!O){var H="client-side token request signing not supported";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",H),new Error(H)}U(D)&&c.default.logAction(c.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(D.defaultTokenParams,D),A(this.authOptions)}else{if(!D.key){var H="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",H),new m.default(H,40160,401)}c.default.logAction(c.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(D)}}return X.prototype.authorize=function(Y,D,H){var F=this,tt;if(typeof Y=="function"&&!H?(H=Y,tt=Y=null):typeof D=="function"&&!H?(H=D,tt=null):tt=D,!H&&this.client.options.promises)return d.promisify(this,"authorize",arguments);if(tt&&tt.key&&this.authOptions.key!==tt.key)throw new m.default("Unable to update auth options with incompatible key",40102,401);tt&&"force"in tt&&(c.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),d.isOnlyPropIn(tt,"force")&&(tt=null)),this._forceNewToken(Y,tt,function(at,Z){if(at){F.client.connection&&at.statusCode===R.default.Forbidden&&F.client.connection.connectionManager.actOnErrorFromAuthorize(at),H==null||H(at);return}x(F.client)?F.client.connection.connectionManager.onAuthUpdated(Z,H||P):H==null||H(null,Z)})},X.prototype.authorise=function(Y,D,H){c.default.renamedMethod("Auth","authorise","authorize"),this.authorize(Y,D,H)},X.prototype._forceNewToken=function(Y,D,H){var F=this;this.tokenDetails=null,this._saveTokenOptions(Y,D),A(this.authOptions),this._ensureValidAuthCredentials(!0,function(tt,at){delete F.tokenParams.timestamp,delete F.authOptions.queryTime,H(tt,at)})},X.prototype.requestToken=function(Y,D,H){var F=this;if(typeof Y=="function"&&!H?(H=Y,D=Y=null):typeof D=="function"&&!H&&(H=D,D=null),!H&&this.client.options.promises)return d.promisify(this,"requestToken",arguments);D=D||this.authOptions,Y=Y||d.copy(this.tokenParams);var tt=H||P,at,Z=this.client;if(D.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),at=D.authCallback;else if(D.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),at=function(nt,dt){var Rt=d.mixin({accept:"application/json, text/plain"},D.authHeaders),Ut=D.authMethod&&D.authMethod.toLowerCase()==="post",Xt,$t=D.authUrl.indexOf("?");$t>-1&&(Xt=d.parseQueryString(D.authUrl.slice($t)),D.authUrl=D.authUrl.slice(0,$t),Ut||(D.authParams=d.mixin(Xt,D.authParams)));var oe=d.mixin({},D.authParams||{},nt),kt=function(ze,Xe,nn,fn){var At;if(ze?c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+d.inspectError(ze)):(At=nn["content-type"],c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+At+"; body: "+d.inspectBody(Xe))),ze||fn)return dt(ze,Xe);if(v.default.BufferUtils.isBuffer(Xe)&&(Xe=Xe.toString()),!At){dt(new m.default("authUrl response is missing a content-type header",40170,401));return}var Ht=At.indexOf("application/json")>-1,me=At.indexOf("text/plain")>-1||At.indexOf("application/jwt")>-1;if(!Ht&&!me){dt(new m.default("authUrl responded with unacceptable content-type "+At+", should be either text/plain, application/jwt or application/json",40170,401));return}if(Ht){if(Xe.length>z){dt(new m.default("authUrl response exceeded max permitted length",40170,401));return}try{Xe=JSON.parse(Xe)}catch(Se){dt(new m.default("Unexpected error processing authURL response; err = "+Se.message,40170,401));return}}dt(null,Xe,At)};if(c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+D.authUrl+"; Params: "+JSON.stringify(oe)+"; method: "+(Ut?"POST":"GET")),Ut){var Re=Rt||{};Re["content-type"]="application/x-www-form-urlencoded";var Ee=d.toQueryString(oe).slice(1);F.client.http.doUri(E.default.Post,Z,D.authUrl,Re,Ee,Xt,kt)}else F.client.http.doUri(E.default.Get,Z,D.authUrl,Rt||{},null,oe,kt)};else if(D.key)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),at=function(nt,dt){F.createTokenRequest(nt,D,dt)};else{var it="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";c.default.logAction(c.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),tt(new m.default(it,40171,403));return}"capability"in Y&&(Y.capability=T(Y.capability));var st=function(nt,dt){var Rt=nt.keyName,Ut="/keys/"+Rt+"/requestToken",Xt=function(oe){return Z.baseUri(oe)+Ut},$t=d.defaultPostHeaders(F.client.options);D.requestHeaders&&d.mixin($t,D.requestHeaders),c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+Ut+"; Token params: "+JSON.stringify(nt)),F.client.http.do(E.default.Post,Z,Xt,$t,JSON.stringify(nt),null,dt)},V=!1,J=this.client.options.timeouts.realtimeRequestTimeout,W=setTimeout(function(){V=!0;var nt="Token request callback timed out after "+J/1e3+" seconds";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",nt),tt(new m.default(nt,40170,401))},J);at(Y,function(nt,dt,Rt){if(!V){if(clearTimeout(W),nt){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+d.inspectError(nt)),tt(L(nt));return}if(typeof dt=="string"){dt.length===0?tt(new m.default("Token string is empty",40170,401)):dt.length>z?tt(new m.default("Token string exceeded max permitted length (was "+dt.length+" bytes)",40170,401)):dt==="undefined"||dt==="null"?tt(new m.default("Token string was literal null/undefined",40170,401)):dt[0]==="{"&&!(Rt&&Rt.indexOf("application/jwt")>-1)?tt(new m.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):tt(null,{token:dt});return}if(typeof dt!="object"){var Ut="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof dt;c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",Ut),tt(new m.default(Ut,40170,401));return}var Xt=JSON.stringify(dt).length;if(Xt>z&&!D.suppressMaxLengthCheck){tt(new m.default("Token request/details object exceeded max permitted stringified size (was "+Xt+" bytes)",40170,401));return}if("issued"in dt){tt(null,dt);return}if(!("keyName"in dt)){var Ut="Expected token request callback to call back with a token string, token request object, or token details object";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",Ut),tt(new m.default(Ut,40170,401));return}st(dt,function($t,oe,kt,Re){if($t){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+d.inspectError($t)),tt(L($t));return}Re||(oe=JSON.parse(oe)),c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","token received"),tt(null,oe)})}})},X.prototype.createTokenRequest=function(Y,D,H){var F=this;if(typeof Y=="function"&&!H?(H=Y,D=Y=null):typeof D=="function"&&!H&&(H=D,D=null),!H&&this.client.options.promises)return d.promisify(this,"createTokenRequest",arguments);D=D||this.authOptions,Y=Y||d.copy(this.tokenParams);var tt=D.key;if(!tt){H(new m.default("No key specified",40101,403));return}var at=tt.split(":"),Z=at[0],it=at[1];if(!it){H(new m.default("Invalid key specified",40101,403));return}if(Y.clientId===""){H(new m.default("clientId can’t be an empty string",40012,400));return}"capability"in Y&&(Y.capability=T(Y.capability));var st=d.mixin({keyName:Z},Y),V=Y.clientId||"",J=Y.ttl||"",W=Y.capability||"";(function(nt){if(st.timestamp){nt();return}F.getTimestamp(D&&D.queryTime,function(dt,Rt){if(dt){H(dt);return}st.timestamp=Rt,nt()})})(function(){var nt=st.nonce||(st.nonce=j()),dt=st.timestamp,Rt=st.keyName+`
`+J+`
`+W+`
`+V+`
`+dt+`
`+nt+`
`;st.mac=st.mac||O(Rt,it),c.default.logAction(c.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),H(null,st)})},X.prototype.getAuthParams=function(Y){this.method=="basic"?Y(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(D,H){if(D){Y(D);return}if(!H)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");Y(null,{access_token:H.token})})},X.prototype.getAuthHeaders=function(Y){this.method=="basic"?Y(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(D,H){if(D){Y(D);return}if(!H)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");Y(null,{authorization:"Bearer "+d.toBase64(H.token)})})},X.prototype.getTimestamp=function(Y,D){!this.isTimeOffsetSet()&&(Y||this.authOptions.queryTime)?this.client.time(D):D(null,this.getTimestampUsingOffset())},X.prototype.getTimestampUsingOffset=function(){return d.now()+(this.client.serverTimeOffset||0)},X.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},X.prototype._saveBasicOptions=function(Y){this.method="basic",this.key=Y.key,this.basicKey=d.toBase64(Y.key),this.authOptions=Y||{},"clientId"in Y&&this._userSetClientId(Y.clientId)},X.prototype._saveTokenOptions=function(Y,D){this.method="token",Y&&(this.tokenParams=Y),D&&(D.token&&(D.tokenDetails=typeof D.token=="string"?{token:D.token}:D.token),D.tokenDetails&&(this.tokenDetails=D.tokenDetails),"clientId"in D&&this._userSetClientId(D.clientId),this.authOptions=D)},X.prototype._ensureValidAuthCredentials=function(Y,D){var H=this,F=this.tokenDetails;if(F){if(this._tokenClientIdMismatch(F.clientId)){D(new m.default("Mismatch between clientId in token ("+F.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!F.expires||F.expires>=this.getTimestampUsingOffset()){c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+F.expires),D(null,F);return}c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=g.default.create())).push(D),!(this.currentTokenRequestId!==null&&!Y)){var tt=this.currentTokenRequestId=K();this.requestToken(this.tokenParams,this.authOptions,function(at,Z){if(H.currentTokenRequestId>tt){c.default.logAction(c.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}H.currentTokenRequestId=null;var it=H.waitingForTokenRequest||P;if(H.waitingForTokenRequest=null,at){it(at);return}it(null,H.tokenDetails=Z)})}},X.prototype._userSetClientId=function(Y){if(typeof Y=="string"||Y===null){if(Y==="*")throw new m.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var D=this._uncheckedSetClientId(Y);if(D)throw D}else throw new m.default("clientId must be either a string or null",40012,400)},X.prototype._uncheckedSetClientId=function(Y){if(this._tokenClientIdMismatch(Y)){var D="Unexpected clientId mismatch: client has "+this.clientId+", requested "+Y,H=new m.default(D,40102,401);return c.default.logAction(c.default.LOG_ERROR,"Auth._uncheckedSetClientId()",D),H}else return this.clientId=this.tokenParams.clientId=Y,null},X.prototype._tokenClientIdMismatch=function(Y){return!!(this.clientId&&this.clientId!=="*"&&Y&&Y!=="*"&&this.clientId!==Y)},X.isTokenErr=function(Y){return Y.code&&Y.code>=40140&&Y.code<40150},X.prototype.revokeTokens=function(Y,D,H){if(B(this.client.options))throw new m.default("Cannot revoke tokens when using token auth",40162,401);var F=this.client.options.keyName,tt;if(typeof D=="function"?(H=D,tt={}):tt=D??{},H===void 0){if(this.client.options.promises)return d.promisify(this,"revokeTokens",[Y,tt]);H=P}var at=H,Z=l.__assign({targets:Y.map(function(J){return"".concat(J.type,":").concat(J.value)})},tt),it=this.client.options.useBinaryProtocol?d.Format.msgpack:d.Format.json,st=d.defaultPostHeaders(this.client.options,it);this.client.options.headers&&d.mixin(st,this.client.options.headers);var V=d.encodeBody(Z,it);M.default.post(this.client,"/keys/".concat(F,"/revokeTokens"),V,st,{newBatchResponse:"true"},null,function(J,W,nt,dt){if(J){at(J);return}var Rt=dt?W:d.decodeBody(W,it);at(null,Rt)})},X})();a.default=Q}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(c){c.Get="get",c.Delete="delete",c.Post="post",c.Put="put",c.Patch="patch"})(l||(l={})),a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.HttpPaginatedResponse=a.PaginatedResult=void 0;var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(15)),m=l.__importDefault(r(14));function S(z){var P=z.match(/^\.\/(\w+)\?(.*)$/);return P&&P[2]&&c.parseQueryString(P[2])}function C(z){typeof z=="string"&&(z=z.split(","));for(var P={},j=0;j<z.length;j++){var x=z[j].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(x){var L=S(x[1]);L&&(P[x[2]]=L)}}return P}function E(z,P,j){return!(j&&(P||typeof z.code=="number"))}var R=(function(){function z(P,j,x,L,O,T){this.rest=P,this.path=j,this.headers=x,this.envelope=L??null,this.bodyHandler=O,this.useHttpPaginatedResponse=T||!1}return z.prototype.get=function(P,j){var x=this;g.default.get(this.rest,this.path,this.headers,P,this.envelope,function(L,O,T,A,y){x.handlePage(L,O,T,A,y,j)})},z.prototype.delete=function(P,j){var x=this;g.default.delete(this.rest,this.path,this.headers,P,this.envelope,function(L,O,T,A,y){x.handlePage(L,O,T,A,y,j)})},z.prototype.post=function(P,j,x){var L=this;g.default.post(this.rest,this.path,j,this.headers,P,this.envelope,function(O,T,A,y,B){x&&L.handlePage(O,T,A,y,B,x)})},z.prototype.put=function(P,j,x){var L=this;g.default.put(this.rest,this.path,j,this.headers,P,this.envelope,function(O,T,A,y,B){x&&L.handlePage(O,T,A,y,B,x)})},z.prototype.patch=function(P,j,x){var L=this;g.default.patch(this.rest,this.path,j,this.headers,P,this.envelope,function(O,T,A,y,B){x&&L.handlePage(O,T,A,y,B,x)})},z.prototype.handlePage=function(P,j,x,L,O,T){if(P&&E(P,j,this.useHttpPaginatedResponse)){d.default.logAction(d.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+c.inspectError(P)),T==null||T(P);return}var A,y,B;try{A=O==m.default.NoContent?[]:this.bodyHandler(j,x||{},L)}catch(U){T==null||T(P||U);return}x&&(y=x.Link||x.link)&&(B=C(y)),this.useHttpPaginatedResponse?T(null,new M(this,A,x||{},O,B,P)):T(null,new v(this,A,B))},z})(),v=(function(){function z(P,j,x){var L=this;this.resource=P,this.items=j;var O=this;x&&("first"in x&&(this.first=function(T){if(!T&&O.resource.rest.options.promises)return c.promisify(O,"first",[]);O.get(x.first,T)}),"current"in x&&(this.current=function(T){if(!T&&O.resource.rest.options.promises)return c.promisify(O,"current",[]);O.get(x.current,T)}),this.next=function(T){if(!T&&O.resource.rest.options.promises)return c.promisify(O,"next",[]);"next"in x?O.get(x.next,T):T(null,null)},this.hasNext=function(){return"next"in x},this.isLast=function(){var T;return!(!((T=L.hasNext)===null||T===void 0)&&T.call(L))})}return z.prototype.get=function(P,j){var x=this.resource;g.default.get(x.rest,x.path,x.headers,P,x.envelope,function(L,O,T,A,y){x.handlePage(L,O,T,A,y,j)})},z})();a.PaginatedResult=v;var M=(function(z){l.__extends(P,z);function P(j,x,L,O,T,A){var y=z.call(this,j,x,T)||this;return y.statusCode=O,y.success=O<300&&O>=200,y.headers=L,y.errorCode=A&&A.code,y.errorMessage=A&&A.message,y}return P.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},P})(v);a.HttpPaginatedResponse=M,a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.isRetriable=void 0;var l=r(0),c=l.__importDefault(r(4)),d={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},g={disconnected:function(){return c.default.fromValues({statusCode:400,code:d.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return c.default.fromValues({statusCode:400,code:d.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return c.default.fromValues({statusCode:400,code:d.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return c.default.fromValues({statusCode:400,code:d.CLOSING,message:"Connection closing"})},closed:function(){return c.default.fromValues({statusCode:400,code:d.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return c.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return c.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function m(S){return!S.statusCode||!S.code||S.statusCode>=500?!0:Object.values(d).includes(S.code)}a.isRetriable=m,a.default=g}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(c){c[c.REQ_SEND=0]="REQ_SEND",c[c.REQ_RECV=1]="REQ_RECV",c[c.REQ_RECV_POLL=2]="REQ_RECV_POLL",c[c.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(l||(l={})),a.default=l}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(l){return l})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=(function(){function g(m){this.members=m||[]}return g.prototype.call=function(){for(var m=[],S=0;S<arguments.length;S++)m[S]=arguments[S];for(var C=0,E=this.members;C<E.length;C++){var R=E[C];if(R)try{R.apply(void 0,m)}catch(v){c.default.logAction(c.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+v+"; stack = "+v.stack)}}},g.prototype.push=function(){for(var m,S=[],C=0;C<arguments.length;C++)S[C]=arguments[C];(m=this.members).push.apply(m,S)},g.create=function(m){var S=new g(m);return Object.assign(function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];return S.call.apply(S,C)},{push:function(C){return S.push(C)}})},g})();a.default=d}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){(function(){var c=l,d=c.lib,g=d.Base,m=c.enc,S=m.Utf8,C=c.algo;C.HMAC=g.extend({init:function(E,R){E=this._hasher=new E.init,typeof R=="string"&&(R=S.parse(R));var v=E.blockSize,M=v*4;R.sigBytes>M&&(R=E.finalize(R)),R.clamp();for(var z=this._oKey=R.clone(),P=this._iKey=R.clone(),j=z.words,x=P.words,L=0;L<v;L++)j[L]^=1549556828,x[L]^=909522486;z.sigBytes=P.sigBytes=M,this.reset()},reset:function(){var E=this._hasher;E.reset(),E.update(this._iKey)},update:function(E){return this._hasher.update(E),this},finalize:function(E){var R=this._hasher,v=R.finalize(E);R.reset();var M=R.finalize(this._oKey.clone().concat(v));return M}})})()})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),S=l.__importDefault(r(21)),C=l.__importDefault(r(4)),E=l.__importDefault(r(3)),R=c.default.Action,v=c.default.fromValues({action:R.CLOSE}),M=c.default.fromValues({action:R.DISCONNECT}),z=(function(P){l.__extends(j,P);function j(x,L,O,T){var A=P.call(this)||this;return T&&(O.format=void 0,O.heartbeats=!0),A.connectionManager=x,x.registerProposedTransport(A),A.auth=L,A.params=O,A.timeouts=O.options.timeouts,A.format=O.format,A.isConnected=!1,A.isFinished=!1,A.isDisposed=!1,A.maxIdleInterval=null,A.idleTimer=null,A.lastActivity=null,A}return j.prototype.connect=function(){},j.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",S.default.closed())},j.prototype.disconnect=function(x){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",x||S.default.disconnected())},j.prototype.fail=function(x){this.isConnected&&this.requestDisconnect(),this.finish("failed",x||S.default.failed())},j.prototype.finish=function(x,L){var O;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((O=this.idleTimer)!==null&&O!==void 0?O:void 0),this.idleTimer=null,this.emit(x,L),this.dispose())},j.prototype.onProtocolMessage=function(x){switch(m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+c.default.stringify(x)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),x.action){case R.HEARTBEAT:m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",x.id);break;case R.CONNECTED:this.onConnect(x),this.emit("connected",x.error,x.connectionId,x.connectionDetails,x);break;case R.CLOSED:this.onClose(x);break;case R.DISCONNECTED:this.onDisconnect(x);break;case R.ACK:this.emit("ack",x.msgSerial,x.count);break;case R.NACK:this.emit("nack",x.msgSerial,x.count,x.error);break;case R.SYNC:this.connectionManager.onChannelMessage(x,this);break;case R.ACTIVATE:break;case R.AUTH:this.auth.authorize(function(L){L&&m.default.logAction(m.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+d.inspectError(L))});break;case R.ERROR:if(m.default.logAction(m.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(x.error)+(x.channel?", channel: "+x.channel:"")),x.channel===void 0){this.onFatalError(x);break}this.connectionManager.onChannelMessage(x,this);break;default:this.connectionManager.onChannelMessage(x,this)}},j.prototype.onConnect=function(x){if(this.isConnected=!0,!x.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var L=x.connectionDetails.maxIdleInterval;L&&(this.maxIdleInterval=L+this.timeouts.realtimeRequestTimeout,this.onActivity())},j.prototype.onDisconnect=function(x){var L=x&&x.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onDisconnect()","err = "+d.inspectError(L)),this.finish("disconnected",L)},j.prototype.onFatalError=function(x){var L=x&&x.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onFatalError()","err = "+d.inspectError(L)),this.finish("failed",L)},j.prototype.onClose=function(x){var L=x&&x.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onClose()","err = "+d.inspectError(L)),this.finish("closed",L)},j.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestClose()",""),this.send(v)},j.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(M)},j.prototype.ping=function(x){var L={action:c.default.Action.HEARTBEAT};x&&(L.id=x),this.send(c.default.fromValues(L))},j.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},j.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=d.now(),this.setIdleTimer(this.maxIdleInterval+100))},j.prototype.setIdleTimer=function(x){var L=this;this.idleTimer||(this.idleTimer=setTimeout(function(){L.onIdleTimerExpire()},x))},j.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var x=d.now()-this.lastActivity,L=this.maxIdleInterval-x;if(L<=0){var O="No activity seen from realtime in "+x+"ms; assuming connection has dropped";m.default.logAction(m.default.LOG_ERROR,"Transport.onIdleTimerExpire()",O),this.disconnect(new C.default(O,80003,408))}else this.setIdleTimer(L+100)},j.tryConnect=function(x,L,O,T,A){var y=new x(L,O,T),B,U=function(K){clearTimeout(B),A({event:this.event,error:K})},I=L.options.timeouts.realtimeRequestTimeout;B=setTimeout(function(){y.off(["preconnect","disconnected","failed"]),y.dispose(),U.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},I),y.on(["failed","disconnected"],U),y.on("preconnect",function(){m.default.logAction(m.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+y),clearTimeout(B),y.off(["failed","disconnected"],U),A(null,y)}),y.connect()},j})(g.default);a.default=z}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(40),r(25))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.Base,m=d.WordArray,S=c.algo,C=S.MD5,E=S.EvpKDF=g.extend({cfg:g.extend({keySize:128/32,hasher:C,iterations:1}),init:function(R){this.cfg=this.cfg.extend(R)},compute:function(R,v){for(var M,z=this.cfg,P=z.hasher.create(),j=m.create(),x=j.words,L=z.keySize,O=z.iterations;x.length<L;){M&&P.update(M),M=P.update(R).finalize(v),P.reset();for(var T=1;T<O;T++)M=P.finalize(M),P.reset();j.concat(M)}return j.sigBytes=L*4,j}});c.EvpKDF=function(R,v,M){return E.create(M).compute(R,v)}})(),l.EvpKDF})}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(27))})(this,function(l){l.lib.Cipher||(function(c){var d=l,g=d.lib,m=g.Base,S=g.WordArray,C=g.BufferedBlockAlgorithm,E=d.enc;E.Utf8;var R=E.Base64,v=d.algo,M=v.EvpKDF,z=g.Cipher=C.extend({cfg:m.extend(),createEncryptor:function(Q,X){return this.create(this._ENC_XFORM_MODE,Q,X)},createDecryptor:function(Q,X){return this.create(this._DEC_XFORM_MODE,Q,X)},init:function(Q,X,Y){this.cfg=this.cfg.extend(Y),this._xformMode=Q,this._key=X,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(Q){return this._append(Q),this._process()},finalize:function(Q){Q&&this._append(Q);var X=this._doFinalize();return X},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function Q(X){return typeof X=="string"?K:B}return function(X){return{encrypt:function(Y,D,H){return Q(D).encrypt(X,Y,D,H)},decrypt:function(Y,D,H){return Q(D).decrypt(X,Y,D,H)}}}})()});g.StreamCipher=z.extend({_doFinalize:function(){var Q=this._process(!0);return Q},blockSize:1});var P=d.mode={},j=g.BlockCipherMode=m.extend({createEncryptor:function(Q,X){return this.Encryptor.create(Q,X)},createDecryptor:function(Q,X){return this.Decryptor.create(Q,X)},init:function(Q,X){this._cipher=Q,this._iv=X}}),x=P.CBC=(function(){var Q=j.extend();Q.Encryptor=Q.extend({processBlock:function(Y,D){var H=this._cipher,F=H.blockSize;X.call(this,Y,D,F),H.encryptBlock(Y,D),this._prevBlock=Y.slice(D,D+F)}}),Q.Decryptor=Q.extend({processBlock:function(Y,D){var H=this._cipher,F=H.blockSize,tt=Y.slice(D,D+F);H.decryptBlock(Y,D),X.call(this,Y,D,F),this._prevBlock=tt}});function X(Y,D,H){var F,tt=this._iv;tt?(F=tt,this._iv=c):F=this._prevBlock;for(var at=0;at<H;at++)Y[D+at]^=F[at]}return Q})(),L=d.pad={},O=L.Pkcs7={pad:function(Q,X){for(var Y=X*4,D=Y-Q.sigBytes%Y,H=D<<24|D<<16|D<<8|D,F=[],tt=0;tt<D;tt+=4)F.push(H);var at=S.create(F,D);Q.concat(at)},unpad:function(Q){var X=Q.words[Q.sigBytes-1>>>2]&255;Q.sigBytes-=X}};g.BlockCipher=z.extend({cfg:z.cfg.extend({mode:x,padding:O}),reset:function(){var Q;z.reset.call(this);var X=this.cfg,Y=X.iv,D=X.mode;this._xformMode==this._ENC_XFORM_MODE?Q=D.createEncryptor:(Q=D.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Q?this._mode.init(this,Y&&Y.words):(this._mode=Q.call(D,this,Y&&Y.words),this._mode.__creator=Q)},_doProcessBlock:function(Q,X){this._mode.processBlock(Q,X)},_doFinalize:function(){var Q,X=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(X.pad(this._data,this.blockSize),Q=this._process(!0)):(Q=this._process(!0),X.unpad(Q)),Q},blockSize:128/32});var T=g.CipherParams=m.extend({init:function(Q){this.mixIn(Q)},toString:function(Q){return(Q||this.formatter).stringify(this)}}),A=d.format={},y=A.OpenSSL={stringify:function(Q){var X,Y=Q.ciphertext,D=Q.salt;return D?X=S.create([1398893684,1701076831]).concat(D).concat(Y):X=Y,X.toString(R)},parse:function(Q){var X,Y=R.parse(Q),D=Y.words;return D[0]==1398893684&&D[1]==1701076831&&(X=S.create(D.slice(2,4)),D.splice(0,4),Y.sigBytes-=16),T.create({ciphertext:Y,salt:X})}},B=g.SerializableCipher=m.extend({cfg:m.extend({format:y}),encrypt:function(Q,X,Y,D){D=this.cfg.extend(D);var H=Q.createEncryptor(Y,D),F=H.finalize(X),tt=H.cfg;return T.create({ciphertext:F,key:Y,iv:tt.iv,algorithm:Q,mode:tt.mode,padding:tt.padding,blockSize:Q.blockSize,formatter:D.format})},decrypt:function(Q,X,Y,D){D=this.cfg.extend(D),X=this._parse(X,D.format);var H=Q.createDecryptor(Y,D).finalize(X.ciphertext);return H},_parse:function(Q,X){return typeof Q=="string"?X.parse(Q,this):Q}}),U=d.kdf={},I=U.OpenSSL={execute:function(Q,X,Y,D){D||(D=S.random(64/8));var H=M.create({keySize:X+Y}).compute(Q,D),F=S.create(H.words.slice(X),Y*4);return H.sigBytes=X*4,T.create({key:H,iv:F,salt:D})}},K=g.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:I}),encrypt:function(Q,X,Y,D){D=this.cfg.extend(D);var H=D.kdf.execute(Y,Q.keySize,Q.ivSize);D.iv=H.iv;var F=B.encrypt.call(this,Q,X,H.key,D);return F.mixIn(H),F},decrypt:function(Q,X,Y,D){D=this.cfg.extend(D),X=this._parse(X,D.format);var H=D.kdf.execute(Y,Q.keySize,Q.ivSize,X.salt);D.iv=H.iv;var F=B.decrypt.call(this,Q,X,H.key,D);return F}})})()})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.Request=a.createRequest=void 0;var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(12)),g=l.__importDefault(r(3)),m=l.__importDefault(r(7)),S=r(4),C=l.__importDefault(r(8)),E=l.__importDefault(r(2)),R=l.__importDefault(r(22)),v=c.getGlobalObject(),M=function(){},z=v._ablyjs_jsonp={};z._=function(A){return z["_"+A]||M};var P=1,j="jsonp";function x(A,y,B,U,I,K,Q){return K=K||C.default.TIMEOUTS,new O(void 0,A,y,c.copy(B),U,I,K,Q)}a.createRequest=x;var L=(function(A){l.__extends(y,A);function y(B,U,I){var K=A.call(this,B,U,I)||this;return K.shortName=j,I.stream=!1,K}return y.isAvailable=function(){return g.default.Config.jsonpSupported&&g.default.Config.allowComet},y.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},y.prototype.createRequest=function(B,U,I,K,Q,X,Y){return X=(this===null||this===void 0?void 0:this.timeouts)||X||C.default.TIMEOUTS,x(B,U,I,K,Q,X,Y)},y})(d.default),O=(function(A){l.__extends(y,A);function y(B,U,I,K,Q,X,Y,D){var H=A.call(this)||this;return B===void 0&&(B=P++),H.id=B,H.uri=U,H.params=K||{},H.params.rnd=c.cheapRandStr(),I&&(I["X-Ably-Version"]&&(H.params.v=I["X-Ably-Version"]),I["X-Ably-Lib"]&&(H.params.lib=I["X-Ably-Lib"])),H.body=Q,H.method=D,H.requestMode=X,H.timeouts=Y,H.requestComplete=!1,H}return y.prototype.exec=function(){var B=this,U=this.id,I=this.body,K=this.method,Q=this.uri,X=this.params;X.callback="_ablyjs_jsonp._("+U+")",X.envelope="jsonp",I&&(X.body=I),K&&K!=="get"&&(X.method=K);var Y=this.script=document.createElement("script"),D=Q+c.toQueryString(X);Y.src=D,Y.src.split("/").slice(-1)[0]!==D.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),Y.async=!0,Y.type="text/javascript",Y.charset="UTF-8",Y.onerror=function(tt){B.complete(new S.PartialErrorInfo("JSONP script error (event: "+g.default.Config.inspect(tt)+")",null,400))},z["_"+U]=function(tt){if(tt.statusCode){var at=tt.response;if(tt.statusCode==204)B.complete(null,null,null,tt.statusCode);else if(!at)B.complete(new S.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(tt.statusCode<400||c.isArray(at))B.complete(null,at,tt.headers,tt.statusCode);else{var Z=at.error||new S.PartialErrorInfo("Error response received from server",null,tt.statusCode);B.complete(Z)}}else B.complete(null,tt)};var H=this.requestMode==R.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),H);var F=document.getElementsByTagName("head")[0];F.insertBefore(Y,F.firstChild)},y.prototype.complete=function(B,U,I,K){if(I=I||{},!this.requestComplete){this.requestComplete=!0;var Q=void 0;U&&(Q=typeof U=="string"?"text/plain":"application/json",I["content-type"]=Q,this.emit("data",U)),this.emit("complete",B,U,I,!0,K),this.dispose()}},y.prototype.abort=function(){this.dispose()},y.prototype.dispose=function(){var B=this.timer;B&&(clearTimeout(B),this.timer=null);var U=this.script;U.parentNode&&U.parentNode.removeChild(U),delete z[this.id],this.emit("disposed")},y})(m.default);a.Request=O;function T(A){return v.JSONPTransport=L,L.isAvailable()&&(A.supportedTransports[j]=L),L}a.default=T}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(8)),m=l.__importDefault(r(18)),S=l.__importDefault(r(46)),C=l.__importDefault(r(20)),E=l.__importDefault(r(33)),R=l.__importDefault(r(4)),v=l.__importDefault(r(49)),M=l.__importDefault(r(19)),z=l.__importDefault(r(3)),P=l.__importDefault(r(9)),j=l.__importDefault(r(16)),x=l.__importDefault(r(15)),L=function(){},O=(function(){function A(y){if(!y){var B="no options provided";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new Error(B)}var U=g.default.objectifyOptions(y);U.log?(d.default.setLog(U.log.level,U.log.handler),d.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):d.default.setLog(U.logLevel,U.logHandler),d.default.logAction(d.default.LOG_MICRO,"Rest()","initialized with clientOptions "+z.default.Config.inspect(y));var I=this.options=g.default.normaliseOptions(U);if(I.key){var K=I.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!K){var B="invalid key parameter";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new R.default(B,40400,404)}I.keyName=K[1],I.keySecret=K[2]}if("clientId"in I)if(typeof I.clientId=="string"||I.clientId===null){if(I.clientId==="*")throw new R.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new R.default("clientId must be either a string or null",40012,400);d.default.logAction(d.default.LOG_MINOR,"Rest()","started; version = "+g.default.version),this.baseUri=this.authority=function(Q){return g.default.getHttpScheme(I)+Q+":"+g.default.getPort(I,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new z.default.Http(I),this.auth=new m.default(this,I),this.channels=new T(this),this.push=new S.default(this)}return A.prototype.stats=function(y,B){if(B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.options.promises)return c.promisify(this,"stats",[y]);B=L}var U=c.defaultGetHeaders(this.options),I=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,K=this.http.supportsLinkHeaders?void 0:I;this.options.headers&&c.mixin(U,this.options.headers),new C.default(this,"/stats",U,K,function(Q,X,Y){for(var D=Y?Q:JSON.parse(Q),H=0;H<D.length;H++)D[H]=v.default.fromValues(D[H]);return D}).get(y,B)},A.prototype.time=function(y,B){var U=this;if(B===void 0){if(typeof y=="function")B=y,y=null;else if(this.options.promises)return c.promisify(this,"time",[y])}var I=B||L,K=c.defaultGetHeaders(this.options);this.options.headers&&c.mixin(K,this.options.headers);var Q=function(X){return U.authority(X)+"/time"};this.http.do(M.default.Get,this,Q,K,null,y,function(X,Y,D,H){if(X){I(X);return}H||(Y=JSON.parse(Y));var F=Y[0];if(!F){I(new R.default("Internal error (unexpected result type from GET /time)",5e4,500));return}U.serverTimeOffset=F-c.now(),I(null,F)})},A.prototype.request=function(y,B,U,I,K,Q){var X=this.options.useBinaryProtocol,Y=X?z.default.Config.msgpack.encode:JSON.stringify,D=X?z.default.Config.msgpack.decode:JSON.parse,H=X?c.Format.msgpack:c.Format.json,F=this.http.supportsLinkHeaders?void 0:H;U=U||{};var tt=y.toLowerCase(),at=tt=="get"?c.defaultGetHeaders(this.options,H):c.defaultPostHeaders(this.options,H);if(Q===void 0){if(this.options.promises)return c.promisify(this,"request",[y,B,U,I,K]);Q=L}typeof I!="string"&&(I=Y(I)),this.options.headers&&c.mixin(at,this.options.headers),K&&c.mixin(at,K);var Z=new C.default(this,B,at,F,function(it,st,V){return c.ensureArray(V?it:D(it))},!0);if(!c.arrIn(z.default.Http.methods,tt))throw new R.default("Unsupported method "+tt,40500,405);c.arrIn(z.default.Http.methodsWithBody,tt)?Z[tt](U,I,Q):Z[tt](U,Q)},A.prototype.batchPublish=function(y,B){if(B===void 0){if(this.options.promises)return c.promisify(this,"batchPublish",[y]);B=L}var U=B,I,K;c.isArray(y)?(I=y,K=!1):(I=[y],K=!0);var Q=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,X=c.defaultPostHeaders(this.options,Q);this.options.headers&&c.mixin(X,this.options.headers);var Y=c.encodeBody(I,Q);x.default.post(this,"/messages",Y,X,{newBatchResponse:"true"},null,function(D,H,F,tt){if(D){U(D);return}var at=tt?H:c.decodeBody(H,Q);K?U(null,at[0]):U(null,at)})},A.prototype.batchPresence=function(y,B){if(B===void 0){if(this.options.promises)return c.promisify(this,"batchPresence",[y]);B=L}var U=B,I=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,K=c.defaultPostHeaders(this.options,I);this.options.headers&&c.mixin(K,this.options.headers);var Q=y.join(",");x.default.get(this,"/presence",K,{newBatchResponse:"true",channels:Q},null,function(X,Y,D,H){if(X){U(X);return}var F=H?Y:c.decodeBody(Y,I);U(null,F)})},A.prototype.setLog=function(y){d.default.setLog(y.level,y.handler)},A.Promise=function(y){return y=g.default.objectifyOptions(y),y.promises=!0,new A(y)},A.Callbacks=A,A.Platform=z.default,A.Message=P.default,A.PresenceMessage=j.default,A})(),T=(function(){function A(y){this.rest=y,this.all=Object.create(null)}return A.prototype.get=function(y,B){y=String(y);var U=this.all[y];return U?B&&U.setOptions(B):this.all[y]=U=new E.default(this.rest,y,B),U},A.prototype.release=function(y){delete this.all[String(y)]},A})();a.default=O}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return l.enc.Utf8})}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.WordArray,S=g.Hasher,C=d.algo,E=[],R=[];(function(){function z(L){for(var O=c.sqrt(L),T=2;T<=O;T++)if(!(L%T))return!1;return!0}function P(L){return(L-(L|0))*4294967296|0}for(var j=2,x=0;x<64;)z(j)&&(x<8&&(E[x]=P(c.pow(j,1/2))),R[x]=P(c.pow(j,1/3)),x++),j++})();var v=[],M=C.SHA256=S.extend({_doReset:function(){this._hash=new m.init(E.slice(0))},_doProcessBlock:function(z,P){for(var j=this._hash.words,x=j[0],L=j[1],O=j[2],T=j[3],A=j[4],y=j[5],B=j[6],U=j[7],I=0;I<64;I++){if(I<16)v[I]=z[P+I]|0;else{var K=v[I-15],Q=(K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3,X=v[I-2],Y=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;v[I]=Q+v[I-7]+Y+v[I-16]}var D=A&y^~A&B,H=x&L^x&O^L&O,F=(x<<30|x>>>2)^(x<<19|x>>>13)^(x<<10|x>>>22),tt=(A<<26|A>>>6)^(A<<21|A>>>11)^(A<<7|A>>>25),at=U+tt+D+R[I]+v[I],Z=F+H;U=B,B=y,y=A,A=T+at|0,T=O,O=L,L=x,x=at+Z|0}j[0]=j[0]+x|0,j[1]=j[1]+L|0,j[2]=j[2]+O|0,j[3]=j[3]+T|0,j[4]=j[4]+A|0,j[5]=j[5]+y|0,j[6]=j[6]+B|0,j[7]=j[7]+U|0},_doFinalize:function(){var z=this._data,P=z.words,j=this._nDataBytes*8,x=z.sigBytes*8;return P[x>>>5]|=128<<24-x%32,P[(x+64>>>9<<4)+14]=c.floor(j/4294967296),P[(x+64>>>9<<4)+15]=j,z.sigBytes=P.length*4,this._process(),this._hash},clone:function(){var z=S.clone.call(this);return z._hash=this._hash.clone(),z}});d.SHA256=S._createHelper(M),d.HmacSHA256=S._createHmacHelper(M)})(Math),l.SHA256})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(34)),S=l.__importDefault(r(9)),C=l.__importDefault(r(4)),E=l.__importDefault(r(20)),R=l.__importDefault(r(15)),v=l.__importDefault(r(3));function M(){}var z=9;function P(L){return c.arrEvery(L,function(O){return!O.id})}function j(L){var O=L||{};if(O.cipher){if(!v.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var T=v.default.Crypto.getCipher(O.cipher);O.cipher=T.cipherParams,O.channelCipher=T.cipher}else"cipher"in O&&(O.cipher=void 0,O.channelCipher=null);return O}var x=(function(L){l.__extends(O,L);function O(T,A,y){var B=L.call(this)||this;return g.default.logAction(g.default.LOG_MINOR,"Channel()","started; name = "+A),B.rest=T,B.name=A,B.basePath="/channels/"+encodeURIComponent(A),B.presence=new m.default(B),B.channelOptions=j(y),B}return O.prototype.setOptions=function(T){this.channelOptions=j(T)},O.prototype.history=function(T,A){if(g.default.logAction(g.default.LOG_MICRO,"Channel.history()","channel = "+this.name),A===void 0)if(typeof T=="function")A=T,T=null;else{if(this.rest.options.promises)return c.promisify(this,"history",arguments);A=M}this._history(T,A)},O.prototype._history=function(T,A){var y=this.rest,B=y.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,U=this.rest.http.supportsLinkHeaders?void 0:B,I=c.defaultGetHeaders(y.options,B);y.options.headers&&c.mixin(I,y.options.headers);var K=this.channelOptions;new E.default(y,this.basePath+"/messages",I,U,function(Q,X,Y){return S.default.fromResponseBody(Q,K,Y?void 0:B)}).get(T,A)},O.prototype.publish=function(){var T=this,A=arguments.length,y=arguments[0],B=arguments[1],U=arguments[A-1],I,K;if(typeof U!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);U=M}if(typeof y=="string"||y===null)I=[S.default.fromValues({name:y,data:B})],K=arguments[2];else if(c.isObject(y))I=[S.default.fromValues(y)],K=arguments[1];else if(c.isArray(y))I=S.default.fromValuesArray(y),K=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof K!="object"||!K)&&(K={});var Q=this.rest,X=Q.options,Y=X.useBinaryProtocol?c.Format.msgpack:c.Format.json,D=Q.options.idempotentRestPublishing,H=c.defaultPostHeaders(Q.options,Y);if(X.headers&&c.mixin(H,X.headers),D&&P(I)){var F=c.randomString(z);c.arrForEach(I,function(tt,at){tt.id=F+":"+at.toString()})}S.default.encodeArray(I,this.channelOptions,function(tt){if(tt){U(tt);return}var at=S.default.getMessagesSize(I),Z=X.maxMessageSize;if(at>Z){U(new C.default("Maximum size of messages that can be published at once exceeded ( was "+at+" bytes; limit is "+Z+" bytes)",40009,400));return}T._publish(S.default.serialize(I,Y),H,K,U)})},O.prototype._publish=function(T,A,y,B){R.default.post(this.rest,this.basePath+"/messages",T,A,y,null,B)},O.prototype.status=function(T){if(typeof T!="function"&&this.rest.options.promises)return c.promisify(this,"status",[]);var A=this.rest.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,y=c.defaultPostHeaders(this.rest.options,A);R.default.get(this.rest,this.basePath,y,{},A,T||M)},O})(d.default);a.default=x}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(20)),S=l.__importDefault(r(16));function C(){}var E=(function(R){l.__extends(v,R);function v(M){var z=R.call(this)||this;return z.channel=M,z.basePath=M.basePath+"/presence",z}return v.prototype.get=function(M,z){if(g.default.logAction(g.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),z===void 0)if(typeof M=="function")z=M,M=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"get",arguments);z=C}var P=this.channel.rest,j=P.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,x=this.channel.rest.http.supportsLinkHeaders?void 0:j,L=c.defaultGetHeaders(P.options,j);P.options.headers&&c.mixin(L,P.options.headers);var O=this.channel.channelOptions;new m.default(P,this.basePath,L,x,function(T,A,y){return S.default.fromResponseBody(T,O,y?void 0:j)}).get(M,z)},v.prototype.history=function(M,z){return g.default.logAction(g.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(M,z)},v.prototype._history=function(M,z){if(z===void 0)if(typeof M=="function")z=M,M=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"_history",[M]);z=C}var P=this.channel.rest,j=P.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,x=this.channel.rest.http.supportsLinkHeaders?void 0:j,L=c.defaultGetHeaders(P.options,j);P.options.headers&&c.mixin(L,P.options.headers);var O=this.channel.channelOptions;new m.default(P,this.basePath+"/history",L,x,function(T,A,y){return S.default.fromResponseBody(T,O,y?void 0:j)}).get(M,z)},v})(d.default);a.default=E}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0}),a.TransportParams=void 0;var c=r(0),d=c.__importDefault(r(10)),g=c.__importStar(r(1)),m=c.__importStar(r(52)),S=c.__importStar(r(8)),C=c.__importDefault(r(3)),E=c.__importDefault(r(7)),R=c.__importDefault(r(36)),v=c.__importDefault(r(2)),M=c.__importDefault(r(37)),z=c.__importStar(r(21)),P=c.__importStar(r(4)),j=c.__importDefault(r(18)),x=c.__importDefault(r(9)),L=c.__importDefault(r(24)),O=c.__importDefault(r(53)),T=c.__importDefault(r(26)),A=c.__importDefault(r(14)),y=function(){var it;return typeof C.default.WebStorage<"u"&&((it=C.default.WebStorage)===null||it===void 0?void 0:it.localSupported)},B=function(){var it;return typeof C.default.WebStorage<"u"&&((it=C.default.WebStorage)===null||it===void 0?void 0:it.sessionSupported)},U=d.default.Action,I=function(){},K="ably-transport-preference",Q="ably-connection-recovery";function X(){var it,st;return B()&&((st=(it=C.default.WebStorage)===null||it===void 0?void 0:it.getSession)===null||st===void 0?void 0:st.call(it,Q))}function Y(it){var st,V;return B()&&((V=(st=C.default.WebStorage)===null||st===void 0?void 0:st.setSession)===null||V===void 0?void 0:V.call(st,Q,it))}function D(){var it,st;return B()&&((st=(it=C.default.WebStorage)===null||it===void 0?void 0:it.removeSession)===null||st===void 0?void 0:st.call(it,Q))}function H(it,st){return g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,it.shortName)>g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,st.shortName)}function F(it,st,V){var J;if(it.channel!==st.channel||(J=it.action)!==U.PRESENCE&&J!==U.MESSAGE||J!==st.action)return!1;var W=J===U.PRESENCE?"presence":"messages",nt=it[W].concat(st[W]),dt=x.default.getMessagesSize(nt);return dt>V||!g.allSame(nt,"clientId")||!g.arrEvery(nt,function(Rt){return!Rt.id})?!1:(it[W]=nt,!0)}function tt(it){try{return JSON.parse(it)}catch{return null}}var at=(function(){function it(st,V,J,W){this.options=st,this.host=V,this.mode=J,this.connectionKey=W,this.format=st.useBinaryProtocol?g.Format.msgpack:g.Format.json}return it.prototype.getConnectParams=function(st){var V=st?g.copy(st):{},J=this.options;switch(this.mode){case"upgrade":V.upgrade=this.connectionKey;break;case"resume":V.resume=this.connectionKey;break;case"recover":{var W=tt(J.recover);W&&(V.recover=W.connectionKey);break}}return J.clientId!==void 0&&(V.clientId=J.clientId),J.echoMessages===!1&&(V.echo="false"),this.format!==void 0&&(V.format=this.format),this.stream!==void 0&&(V.stream=this.stream),this.heartbeats!==void 0&&(V.heartbeats=this.heartbeats),V.v=S.default.protocolVersion,V.agent=(0,S.getAgentString)(this.options),J.transportParams!==void 0&&g.mixin(V,J.transportParams),V},it.prototype.toString=function(){var st="[mode="+this.mode;return this.host&&(st+=",host="+this.host),this.connectionKey&&(st+=",connectionKey="+this.connectionKey),this.format&&(st+=",format="+this.format),st+="]",st},it})();a.TransportParams=at;var Z=(function(it){c.__extends(st,it);function st(V,J){var W=it.call(this)||this;W.disconnectedRetryCount=0,st.initTransports(),W.realtime=V,W.options=J;var nt=J.timeouts,dt=nt.preferenceConnectTimeout+nt.realtimeRequestTimeout;if(W.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:dt,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:nt.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},W.state=W.states.initialized,W.errorReason=null,W.queuedMessages=new R.default,W.msgSerial=0,W.connectionDetails=void 0,W.connectionId=void 0,W.connectionKey=void 0,W.connectionStateTtl=nt.connectionStateTtl,W.maxIdleInterval=null,W.transports=g.intersect(J.transports||S.default.defaultTransports,st.supportedTransports),W.baseTransport=g.intersect(S.default.baseTransportOrder,W.transports)[0],W.upgradeTransports=g.intersect(W.transports,S.default.upgradeTransports),W.transportPreference=null,W.httpHosts=S.default.getHosts(J),W.activeProtocol=null,W.proposedTransports=[],W.pendingTransports=[],W.host=null,W.lastAutoReconnectAttempt=null,W.lastActivity=null,W.forceFallbackHost=!1,W.connectCounter=0,v.default.logAction(v.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(J.transports||S.default.defaultTransports)+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+W.transports+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+W.httpHosts+"]"),!W.transports.length){var Rt="no requested transports available";throw v.default.logAction(v.default.LOG_ERROR,"realtime.ConnectionManager()",Rt),new Error(Rt)}var Ut=C.default.Config.addEventListener;return Ut&&(B()&&typeof J.recover=="function"&&Ut("beforeunload",W.persistConnection.bind(W)),J.closeOnUnload===!0&&Ut("beforeunload",function(){v.default.logAction(v.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),W.requestState({state:"closing"})}),Ut("online",function(){W.state==W.states.disconnected||W.state==W.states.suspended?(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),W.requestState({state:"connecting"})):W.state==W.states.connecting&&(W.pendingTransports.forEach(function(Xt){Xt.off()}),W.disconnectAllTransports(),W.startConnect())}),Ut("offline",function(){W.state==W.states.connected&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),W.disconnectAllTransports())})),W}return st.initTransports=function(){(0,O.default)(st),g.arrForEach(C.default.Transports,function(V){V(st)})},st.prototype.createTransportParams=function(V,J){return new at(this.options,V,J,this.connectionKey)},st.prototype.getTransportParams=function(V){var J=this,W=function(nt){if(J.connectionKey){nt("resume");return}if(typeof J.options.recover=="string"){nt("recover");return}var dt=J.options.recover,Rt=X();if(Rt&&typeof dt=="function"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),dt(Rt,function(Ut){Ut?(J.options.recover=Rt.recoveryKey,nt("recover")):nt("clean")});return}nt("clean")};W(function(nt){var dt=J.createTransportParams(null,nt);if(nt==="recover"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+J.options.recover);var Rt=tt(J.options.recover);Rt&&(J.msgSerial=Rt.msgSerial)}else v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+dt.toString());V(dt)})},st.prototype.tryATransport=function(V,J,W){var nt=this;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+J),T.default.tryConnect(st.supportedTransports[J],this,this.realtime.auth,V,function(dt,Rt){var Ut=nt.state;if(Ut==nt.states.closing||Ut==nt.states.closed||Ut==nt.states.failed){Rt&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+Ut.state+" while we were attempting the transport; closing "+Rt),Rt.close()),W(!0);return}if(dt){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+J+" "+dt.event+", err: "+dt.error.toString()),j.default.isTokenErr(dt.error)&&!(nt.errorReason&&j.default.isTokenErr(nt.errorReason))?(nt.errorReason=dt.error,nt.realtime.auth._forceNewToken(null,null,function(Xt){if(Xt){nt.actOnErrorFromAuthorize(Xt);return}nt.tryATransport(V,J,W)})):dt.event==="failed"?(nt.notifyState({state:"failed",error:dt.error}),W(!0)):dt.event==="disconnected"&&((0,z.isRetriable)(dt.error)?W(!1):(nt.notifyState({state:nt.states.connecting.failState,error:dt.error}),W(!0)));return}v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+J+"; setting pending"),nt.setTransportPending(Rt,V),W(null,Rt)})},st.prototype.setTransportPending=function(V,J){var W=this,nt=J.mode;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+V+"; mode = "+nt),g.arrDeleteValue(this.proposedTransports,V),this.pendingTransports.push(V);var dt=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];V.once("connected",function(Ut,Xt,$t){nt=="upgrade"&&W.activeProtocol?V.shortName!==dt&&g.arrIn(W.getUpgradePossibilities(),dt)&&W.activeProtocol?setTimeout(function(){W.scheduleTransportActivation(Ut,V,Xt,$t)},W.options.timeouts.parallelUpgradeDelay):W.scheduleTransportActivation(Ut,V,Xt,$t):(W.activateTransport(Ut,V,Xt,$t),C.default.Config.nextTick(function(){W.connectImpl(J)})),nt==="recover"&&W.options.recover&&(W.options.recover=null,W.unpersistConnection())});var Rt=this;V.on(["disconnected","closed","failed"],function(Ut){Rt.deactivateTransport(V,this.event,Ut)}),this.emit("transport.pending",V)},st.prototype.scheduleTransportActivation=function(V,J,W,nt){var dt=this,Rt=this.activeProtocol&&this.activeProtocol.getTransport(),Ut=function(){J.disconnect(),g.arrDeleteValue(dt.pendingTransports,J)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),Ut();return}if(Rt&&!H(J,Rt)){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+" is no better than current active transport "+Rt.shortName+" - abandoning upgrade"),Ut();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+J);var Xt=null;if(!J.isConnected){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+"is no longer connected; abandoning upgrade"),Ut();return}if(this.state===this.states.connected)v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,Xt=this.activeProtocol;else if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),Ut();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+J);var $t=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+J),J.send(d.default.fromValues({action:U.ACTIVATE})),dt.activateTransport(V,J,W,nt),dt.state===dt.states.synchronizing?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+J),dt.state=dt.states.connected):v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+dt.state.state+", so leaving unchanged"),dt.state.sendEvents&&dt.sendQueuedMessages()};Xt?Xt.onceIdle($t):$t()},st.prototype.activateTransport=function(V,J,W,nt){var dt=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+J),V&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+V),W&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+W),nt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(nt)),this.persistTransportPreference(J);var Rt=this.state,Ut=this.states.connected.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+Rt.state),Rt.state==this.states.closing.state||Rt.state==this.states.closed.state||Rt.state==this.states.failed.state)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),J.disconnect(),!1;if(g.arrDeleteValue(this.pendingTransports,J),!J.isConnected)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+J+" since it appears to no longer be connected"),!1;var Xt=this.activeProtocol;this.activeProtocol=new m.default(J),this.host=J.params.host;var $t=nt.connectionKey;if($t&&this.connectionKey!=$t&&this.setConnection(W,nt,!!V),this.onConnectionDetailsUpdate(nt,J),C.default.Config.nextTick(function(){J.on("connected",function(kt,Re,Ee){dt.onConnectionDetailsUpdate(Ee,J),dt.emit("update",new M.default(Ut,Ut,null,kt))})}),Rt.state===this.states.connected.state?V&&(this.errorReason=this.realtime.connection.errorReason=V,this.emit("update",new M.default(Ut,Ut,null,V))):(this.notifyState({state:"connected",error:V}),this.errorReason=this.realtime.connection.errorReason=V||null),this.emit("transport.active",J),Xt)if(Xt.messageQueue.count()>0&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+Xt.transport.shortName+", new one is "+J.shortName+") finishing with "+Xt.messageQueue.count()+" messages still pending"),Xt.transport===J){var oe="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",oe)}else Xt.finish();return g.safeArrForEach(this.pendingTransports,function(kt){if(kt===J){var Re="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",Re),g.arrDeleteValue(dt.pendingTransports,J)}else kt.disconnect()}),g.safeArrForEach(this.proposedTransports,function(kt){kt===J?(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+J.shortName+"; stack = "+new Error().stack),g.arrDeleteValue(dt.proposedTransports,J)):kt.dispose()}),!0},st.prototype.deactivateTransport=function(V,J,W){var nt=this.activeProtocol,dt=nt&&nt.getTransport()===V,Rt=g.arrDeleteValue(this.pendingTransports,V),Ut=g.arrDeleteValue(this.proposedTransports,V),Xt=this.noTransportsScheduledForActivation();if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+V),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+J+(dt?"; was active":Rt?"; was pending":Ut?"; was proposed":"")+(Xt?"":"; another transport is scheduled for activation")),W&&W.message&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+W.message),dt&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(nt.getPendingMessages()),C.default.Config.nextTick(function(){nt.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",V),dt&&Xt||dt&&J==="failed"||J==="closed"||nt===null&&Rt&&this.pendingTransports.length===0){if(J==="disconnected"&&W&&W.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:J,error:W,retryImmediately:!0});return}var $t=J==="failed"&&j.default.isTokenErr(W)?"disconnected":J;this.notifyState({state:$t,error:W});return}dt&&J==="disconnected"&&this.state!==this.states.synchronizing&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:W}))},st.prototype.noTransportsScheduledForActivation=function(){return g.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(V){return!V.isConnected})},st.prototype.setConnection=function(V,J,W){var nt=this.connectionId,dt=nt&&nt!==V,Rt=!nt&&W;(dt||Rt)&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==V&&v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=V,this.realtime.connection.key=this.connectionKey=J.connectionKey},st.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},st.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},st.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var V=g.now()-this.lastActivity;V>this.connectionStateTtl+this.maxIdleInterval&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+V+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},st.prototype.persistConnection=function(){if(B()){var V=this.createRecoveryKey();V&&Y({recoveryKey:V,disconnectedAt:g.now(),location:l.location,clientId:this.realtime.auth.clientId})}},st.prototype.unpersistConnection=function(){D()},st.prototype.getError=function(){return this.errorReason||this.getStateError()},st.prototype.getStateError=function(){var V,J;return(J=(V=z.default)[this.state.state])===null||J===void 0?void 0:J.call(V)},st.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},st.prototype.enactStateChange=function(V){var J=V.current==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(J,"Connection state",V.current+(V.reason?"; reason: "+V.reason:"")),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+V.current+"; reason = "+(V.reason&&V.reason.message));var W=this.state=this.states[V.current];V.reason&&(this.errorReason=V.reason,this.realtime.connection.errorReason=V.reason),(W.terminal||W.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",V)},st.prototype.startTransitionTimer=function(V){var J=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+V.state),this.transitionTimer&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){J.transitionTimer&&(J.transitionTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager "+V.state+" timer expired","requesting new state: "+V.failState),J.notifyState({state:V.failState}))},V.retryDelay)},st.prototype.cancelTransitionTimer=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},st.prototype.startSuspendTimer=function(){var V=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){V.suspendTimer&&(V.suspendTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),V.states.connecting.failState="suspended",V.notifyState({state:"suspended"}))},this.connectionStateTtl))},st.prototype.checkSuspendTimer=function(V){V!=="disconnected"&&V!=="suspended"&&V!=="connecting"&&this.cancelSuspendTimer()},st.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},st.prototype.startRetryTimer=function(V){var J=this;this.retryTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),J.retryTimer=null,J.requestState({state:"connecting"})},V)},st.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},st.prototype.notifyState=function(V){var J=this,W,nt,dt=V.state,Rt=dt==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||V.retryImmediately||this.state===this.states.connecting&&V.error&&j.default.isTokenErr(V.error)&&!(this.errorReason&&j.default.isTokenErr(this.errorReason)));if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+dt+(Rt?"; will retry connection immediately":"")),dt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(V.state),(dt==="suspended"||dt==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var Ut=this.states[V.state],Xt=Ut.retryDelay;Ut.state==="disconnected"&&(this.disconnectedRetryCount++,Xt=g.getRetryTime(Ut.retryDelay,this.disconnectedRetryCount));var $t=new M.default(this.state.state,Ut.state,Xt,V.error||((nt=(W=z.default)[Ut.state])===null||nt===void 0?void 0:nt.call(W)));if(Rt){var oe=function(){J.state===J.states.disconnected&&(J.lastAutoReconnectAttempt=g.now(),J.requestState({state:"connecting"}))},kt=this.lastAutoReconnectAttempt&&g.now()-this.lastAutoReconnectAttempt+1;kt&&kt<1e3?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+kt+"ms ago, waiting another "+(1e3-kt)+"ms before trying again"),setTimeout(oe,1e3-kt)):C.default.Config.nextTick(oe)}else(dt==="disconnected"||dt==="suspended")&&this.startRetryTimer(Xt);(dt==="disconnected"&&!Rt||dt==="suspended"||Ut.terminal)&&C.default.Config.nextTick(function(){J.disconnectAllTransports()}),dt=="connected"&&!this.activeProtocol&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange($t),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(dt,$t.reason),this.failQueuedMessages($t.reason))}},st.prototype.requestState=function(V){var J=this,W,nt,dt=V.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+dt+"; current state: "+this.state.state),dt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(dt),!(dt=="connecting"&&this.state.state=="connected")&&!(dt=="closing"&&this.state.state=="closed"))){var Rt=this.states[dt],Ut=new M.default(this.state.state,Rt.state,null,V.error||((nt=(W=z.default)[Rt.state])===null||nt===void 0?void 0:nt.call(W)));this.enactStateChange(Ut),dt=="connecting"&&C.default.Config.nextTick(function(){J.startConnect()}),dt=="closing"&&this.closeImpl()}},st.prototype.startConnect=function(){var V=this;if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var J=this.realtime.auth,W=++this.connectCounter,nt=function(){V.checkConnectionStateFreshness(),V.getTransportParams(function(Rt){if(Rt.mode==="recover"&&Rt.options.recover){var Ut=tt(Rt.options.recover);Ut&&V.realtime.channels.recoverChannels(Ut.channelSerials)}W===V.connectCounter&&V.connectImpl(Rt,W)})};if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),J.method==="basic")nt();else{var dt=function(Rt){W===V.connectCounter&&(Rt?V.actOnErrorFromAuthorize(Rt):nt())};this.errorReason&&j.default.isTokenErr(this.errorReason)?J._forceNewToken(null,null,dt):J._ensureValidAuthCredentials(!1,dt)}},st.prototype.connectImpl=function(V,J){var W=this.state.state;W!==this.states.connecting.state&&W!==this.states.connected.state?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+W):this.pendingTransports.length?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):W==this.states.connected.state?this.upgradeIfNeeded(V):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(V,J):this.connectBase(V,J)},st.prototype.connectPreference=function(V,J){var W=this,nt=this.getTransportPreference(),dt=!1;g.arrIn(this.transports,nt)||(this.unpersistTransportPreference(),this.connectImpl(V,J)),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+nt);var Rt=setTimeout(function(){dt=!0,W.state.state!==W.states.connected.state&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+nt+" failed; clearing preference and trying from scratch"),W.disconnectAllTransports(),W.unpersistTransportPreference()),W.connectImpl(V,J)},this.options.timeouts.preferenceConnectTimeout);V.host=this.httpHosts[0],this.tryATransport(V,nt,function(Ut,Xt){clearTimeout(Rt),dt&&Xt?(Xt.off(),Xt.disconnect(),g.arrDeleteValue(W.pendingTransports,Xt)):!Xt&&!Ut&&(W.unpersistTransportPreference(),W.connectImpl(V,J))})},st.prototype.connectBase=function(V,J){var W=this,nt=function($t){W.notifyState({state:W.states.connecting.failState,error:$t})},dt=this.httpHosts.slice(),Rt=function($t,oe){J===W.connectCounter&&!oe&&!$t&&Xt()};v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var Ut=dt.shift();if(!Ut){nt(new P.default("Unable to connect (no available host)",80003,404));return}V.host=Ut;var Xt=function(){if(!dt.length){nt(new P.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!W.realtime.http.checkConnectivity){nt(new P.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}W.realtime.http.checkConnectivity(function($t,oe){if(J===W.connectCounter){if($t){nt($t);return}if(!oe){nt(new P.default("Unable to connect (network unreachable)",80003,404));return}V.host=g.arrPopRandomElement(dt),W.tryATransport(V,W.baseTransport,Rt)}})};if(this.forceFallbackHost&&dt.length){this.forceFallbackHost=!1,Xt();return}this.tryATransport(V,this.baseTransport,Rt)},st.prototype.getUpgradePossibilities=function(){var V=this.activeProtocol.getTransport().shortName,J=g.arrIndexOf(this.upgradeTransports,V);return this.upgradeTransports.slice(J+1)},st.prototype.upgradeIfNeeded=function(V){var J=this,W=this.getUpgradePossibilities();v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect(W)),W.length&&g.arrForEach(W,function(nt){var dt=J.createTransportParams(V.host,"upgrade");J.tryATransport(dt,nt,I)})},st.prototype.closeImpl=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),g.safeArrForEach(this.pendingTransports,function(V){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+V),V&&V.close()}),g.safeArrForEach(this.proposedTransports,function(V){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+V),V&&V.dispose()}),this.activeProtocol&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},st.prototype.onAuthUpdated=function(V,J){var W=this,nt;switch(this.state.state){case"connected":{if(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var dt=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){W.state.state==="connected"&&W.upgradeIfNeeded(dt)})}var Rt=(nt=this.activeProtocol)===null||nt===void 0?void 0:nt.getTransport();Rt&&Rt.onAuthUpdated&&Rt.onAuthUpdated(V);var Ut=d.default.fromValues({action:U.AUTH,auth:{accessToken:V.token}});this.send(Ut);var Xt=function(){W.off($t),J(null,V)},$t=function(kt){kt.current==="failed"&&(W.off(Xt),W.off($t),J(kt.reason||W.getStateError()))};this.once("connectiondetails",Xt),this.on("connectionstate",$t);break}case"connecting":v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var oe=function(kt){switch(kt.current){case"connected":W.off(oe),J(null,V);break;case"failed":case"closed":case"suspended":W.off(oe),J(kt.reason||W.getStateError());break}};this.on("connectionstate",oe),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},st.prototype.disconnectAllTransports=function(V){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(V?" except the active transport":"")),this.connectCounter++,g.safeArrForEach(this.pendingTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+J),J&&J.disconnect()}),this.pendingTransports=[],g.safeArrForEach(this.proposedTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+J),J&&J.dispose()}),this.proposedTransports=[],this.activeProtocol&&!V&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},st.prototype.send=function(V,J,W){W=W||I;var nt=this.state;if(nt.sendEvents){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new m.PendingMessage(V,W));return}var dt=J&&nt.queueEvents||nt.forceQueueEvents;if(!dt){var Rt="rejecting event, queueEvent was "+J+", state was "+nt.state;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()",Rt),W(this.errorReason||new P.default(Rt,9e4,400));return}v.default.shouldLog(v.default.LOG_MICRO)&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+d.default.stringify(V)),this.queue(V,W)},st.prototype.sendImpl=function(V){var J=V.message;V.ackRequired&&!V.sendAttempted&&(J.msgSerial=this.msgSerial++);try{this.activeProtocol.send(V)}catch(W){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+W.stack)}},st.prototype.queue=function(V,J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var W=this.queuedMessages.last(),nt=this.options.maxMessageSize;W&&!W.sendAttempted&&F(W.message,V,nt)?(W.merged||(W.callback=L.default.create([W.callback]),W.merged=!0),W.callback.push(J)):this.queuedMessages.push(new m.PendingMessage(V,J))},st.prototype.sendQueuedMessages=function(){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var V;V=this.queuedMessages.shift();)this.sendImpl(V)},st.prototype.queuePendingMessages=function(V){V&&V.length&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+V.length+" pending messages"),this.queuedMessages.prepend(V))},st.prototype.failQueuedMessages=function(V){var J=this.queuedMessages.count();J>0&&(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+J+" queued messages, err = "+g.inspectError(V)),this.queuedMessages.completeAllMessages(V))},st.prototype.onChannelMessage=function(V,J){var W=this.activeProtocol&&J===this.activeProtocol.getTransport(),nt=g.arrIn(this.pendingTransports,J)&&this.state==this.states.synchronizing;W||nt?this.realtime.channels.onChannelMessage(V):g.arrIndexOf([U.ACK,U.NACK,U.ERROR],V.action)>-1?this.realtime.channels.onChannelMessage(V):v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(V)+"on defunct transport; discarding")},st.prototype.ping=function(V,J){var W=this;if(V){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+V);var nt=function(){V.off("heartbeat",Ut),J(new P.default("Timeout waiting for heartbeat response",5e4,500))},dt=g.now(),Rt=g.cheapRandStr(),Ut=function(Re){if(Re===Rt){V.off("heartbeat",Ut),clearTimeout(Xt);var Ee=g.now()-dt;J(null,Ee)}},Xt=setTimeout(nt,this.options.timeouts.realtimeRequestTimeout);V.on("heartbeat",Ut),V.ping(Rt);return}if(this.state.state!=="connected"){J(new P.default("Unable to ping service; not connected",4e4,400));return}var $t=!1,oe=function(Re,Ee){W.off("transport.active",kt),$t||($t=!0,J(Re,Ee))},kt=function(){$t||($t=!0,C.default.Config.nextTick(function(){W.ping(null,J)}))};this.on("transport.active",kt),this.ping(this.activeProtocol.getTransport(),oe)},st.prototype.abort=function(V){this.activeProtocol.getTransport().fail(V)},st.prototype.registerProposedTransport=function(V){this.proposedTransports.push(V)},st.prototype.getTransportPreference=function(){var V,J;return this.transportPreference||y()&&((J=(V=C.default.WebStorage)===null||V===void 0?void 0:V.get)===null||J===void 0?void 0:J.call(V,K))},st.prototype.persistTransportPreference=function(V){var J,W;g.arrIn(S.default.upgradeTransports,V.shortName)&&(this.transportPreference=V.shortName,y()&&((W=(J=C.default.WebStorage)===null||J===void 0?void 0:J.set)===null||W===void 0||W.call(J,K,V.shortName)))},st.prototype.unpersistTransportPreference=function(){var V,J;this.transportPreference=null,y()&&((J=(V=C.default.WebStorage)===null||V===void 0?void 0:V.remove)===null||J===void 0||J.call(V,K))},st.prototype.actOnErrorFromAuthorize=function(V){if(V.code===40171)this.notifyState({state:"failed",error:V});else if(V.code===40102)this.notifyState({state:"failed",error:V});else if(V.statusCode===A.default.Forbidden){var J="Client configured authentication provider returned 403; failing the connection";v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",J),this.notifyState({state:"failed",error:new P.default(J,80019,403,V)})}else{var J="Client configured authentication provider request failed";v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",J),this.notifyState({state:this.state.failState,error:new P.default(J,80019,401,V)})}},st.prototype.onConnectionDetailsUpdate=function(V,J){if(V){this.connectionDetails=V,V.maxMessageSize&&(this.options.maxMessageSize=V.maxMessageSize);var W=V.clientId;if(W){var nt=this.realtime.auth._uncheckedSetClientId(W);if(nt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",nt.message),J.fail(nt);return}}var dt=V.connectionStateTtl;dt&&(this.connectionStateTtl=dt),this.maxIdleInterval=V.maxIdleInterval,this.emit("connectiondetails",V)}},st.supportedTransports={},st})(E.default);a.default=Z}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(7)),d=l.__importDefault(r(2)),g=(function(m){l.__extends(S,m);function S(){var C=m.call(this)||this;return C.messages=[],C}return S.prototype.count=function(){return this.messages.length},S.prototype.push=function(C){this.messages.push(C)},S.prototype.shift=function(){return this.messages.shift()},S.prototype.last=function(){return this.messages[this.messages.length-1]},S.prototype.copyAll=function(){return this.messages.slice()},S.prototype.append=function(C){this.messages.push.apply(this.messages,C)},S.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},S.prototype.completeMessages=function(C,E,R){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+E),R=R||null;var v=this.messages;if(v.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var M=v[0];if(M){var z=M.message.msgSerial,P=C+E;if(P>z)for(var j=v.splice(0,P-z),x=0,L=j;x<L.length;x++){var O=L[x];O.callback(R)}v.length==0&&this.emit("idle")}},S.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},S.prototype.resetSendAttempted=function(){for(var C=0,E=this.messages;C<E.length;C++){var R=E[C];R.sendAttempted=!1}},S.prototype.clear=function(){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},S})(c.default);a.default=g}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function c(d,g,m,S){this.previous=d,this.current=g,m&&(this.retryIn=m),S&&(this.reason=S)}return c})();a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(10)),d=l.__importDefault(r(7)),g=l.__importStar(r(1)),m=l.__importDefault(r(33)),S=l.__importDefault(r(2)),C=l.__importDefault(r(54)),E=l.__importDefault(r(9)),R=l.__importDefault(r(39)),v=l.__importStar(r(4)),M=l.__importDefault(r(16)),z=l.__importDefault(r(21)),P=c.default.Action,j=function(){};function x(T){if(T&&"params"in T&&!g.isObject(T.params))return new v.default("options.params must be an object",4e4,400);if(T&&"modes"in T){if(!g.isArray(T.modes))return new v.default("options.modes must be an array",4e4,400);for(var A=0;A<T.modes.length;A++){var y=T.modes[A];if(!y||typeof y!="string"||!g.arrIn(c.default.channelModes,String.prototype.toUpperCase.call(y)))return new v.default("Invalid channel mode: "+y,4e4,400)}}}var L=(function(T){l.__extends(A,T);function A(y,B,U){var I=T.call(this,y,B,U)||this;return I.retryCount=0,I.history=function(K,Q){if(S.default.logAction(S.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),Q===void 0)if(typeof K=="function")Q=K,K=null;else{if(this.rest.options.promises)return g.promisify(this,"history",arguments);Q=j}if(K&&K.untilAttach){if(this.state!=="attached"){Q(new v.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){Q(new v.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete K.untilAttach,K.from_serial=this.properties.attachSerial}m.default.prototype._history.call(this,K,Q)},I.whenState=(function(K,Q){return d.default.prototype.whenState.call(I,K,I.state,Q)}),S.default.logAction(S.default.LOG_MINOR,"RealtimeChannel()","started; name = "+B),I.realtime=y,I.presence=new C.default(I),I.connectionManager=y.connection.connectionManager,I.state="initialized",I.subscriptions=new d.default,I.syncChannelSerial=void 0,I.properties={attachSerial:void 0,channelSerial:void 0},I.setOptions(U),I.errorReason=null,I._requestedFlags=null,I._mode=null,I._attachResume=!1,I._decodingContext={channelOptions:I.channelOptions,plugins:y.options.plugins||{},baseEncodedPreviousPayload:void 0},I._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},I._allChannelChanges=new d.default,I}return A.prototype.invalidStateError=function(){return new v.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},A.processListenerArgs=function(y){return y=Array.prototype.slice.call(y),typeof y[0]=="function"&&y.unshift(null),y[y.length-1]==null&&y.pop(),y},A.prototype.setOptions=function(y,B){var U=this.channelOptions;if(!B&&this.rest.options.promises)return g.promisify(this,"setOptions",arguments);var I=B||function(Q){Q&&S.default.logAction(S.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+Q.toString())},K=x(y);if(K){I(K);return}m.default.prototype.setOptions.call(this,y),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(y,U)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(Q){switch(this.event){case"update":case"attached":I==null||I(null);return;default:I==null||I(Q.reason);return}})):I()},A.prototype._shouldReattachToSetOptions=function(y,B){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(y!=null&&y.params){var U=O(y.params),I=O(B.params);if(Object.keys(U).length!==Object.keys(I).length||!g.shallowEquals(I,U))return!0}return!!(y!=null&&y.modes&&(!B.modes||!g.arrEquals(y.modes,B.modes)))},A.prototype.publish=function(){for(var y=this,B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];var I=B[0],K=B.length,Q=B[K-1];if(typeof Q!="function"){if(this.realtime.options.promises)return g.promisify(this,"publish",arguments);Q=j,++K}if(!this.connectionManager.activeState()){Q(this.connectionManager.getError());return}if(K==2)if(g.isObject(I))I=[E.default.fromValues(I)];else if(g.isArray(I))I=E.default.fromValuesArray(I);else throw new v.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else I=[E.default.fromValues({name:B[0],data:B[1]})];var X=this.realtime.options.maxMessageSize;E.default.encodeArray(I,this.channelOptions,function(Y){if(Y){Q(Y);return}var D=E.default.getMessagesSize(I);if(D>X){Q(new v.default("Maximum size of messages that can be published at once exceeded ( was "+D+" bytes; limit is "+X+" bytes)",40009,400));return}y.__publish(I,Q)})},A.prototype.__publish=function(y,B){S.default.logAction(S.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+y.length);var U=this.state;switch(U){case"failed":case"suspended":B(v.default.fromValues(this.invalidStateError()));break;default:{S.default.logAction(S.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+U);var I=new c.default;I.action=P.MESSAGE,I.channel=this.name,I.messages=y,this.sendMessage(I,B);break}}},A.prototype.onEvent=function(y){S.default.logAction(S.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var B=this.subscriptions,U=0;U<y.length;U++){var I=y[U];B.emit(I.name,I)}},A.prototype.attach=function(y,B){var U;if(typeof y=="function"?(B=y,U=null):U=y,!B){if(this.realtime.options.promises)return g.promisify(this,"attach",arguments);B=function(I){I&&S.default.logAction(S.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+I.toString())}}if(U)S.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=U;else if(this.state==="attached"){B(null,null);return}this._attach(!1,null,B)},A.prototype._attach=function(y,B,U){U||(U=function(K){K&&S.default.logAction(S.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+K.toString())});var I=this.connectionManager;if(!I.activeState()){U(I.getError());return}(this.state!=="attaching"||y)&&this.requestState("attaching",B),this.once(function(K){switch(this.event){case"attached":U==null||U(null,K);break;case"detached":case"suspended":case"failed":U==null||U(K.reason||I.getError()||new v.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":U==null||U(new v.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},A.prototype.attachImpl=function(){S.default.logAction(S.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var y=c.default.fromValues({action:P.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?y.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&y.encodeModesToFlags(g.allToUpperCase(this.channelOptions.modes)),this._attachResume&&y.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(y.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(y,j)},A.prototype.detach=function(y){if(!y){if(this.realtime.options.promises)return g.promisify(this,"detach",arguments);y=j}var B=this.connectionManager;if(!B.activeState()){y(B.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),y();break;case"detached":y();break;case"failed":y(new v.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(U){switch(this.event){case"detached":y();break;case"attached":case"suspended":case"failed":y(U.reason||B.getError()||new v.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":y(new v.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},A.prototype.detachImpl=function(y){S.default.logAction(S.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var B=c.default.fromValues({action:P.DETACH,channel:this.name});this.sendMessage(B,y||j)},A.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=A.processListenerArgs(y),I=U[0],K=U[1],Q=U[2];if(!Q&&this.realtime.options.promises)return g.promisify(this,"subscribe",[I,K]);if(this.state==="failed"){Q==null||Q(v.default.fromValues(this.invalidStateError()));return}return I&&typeof I=="object"&&!Array.isArray(I)?this._subscribeFilter(I,K):this.subscriptions.on(I,K),this.attach(Q||j)},A.prototype._subscribeFilter=function(y,B){var U=function(I){var K,Q,X,Y,D,H,F={name:I.name,refTimeserial:(Q=(K=I.extras)===null||K===void 0?void 0:K.ref)===null||Q===void 0?void 0:Q.timeserial,refType:(Y=(X=I.extras)===null||X===void 0?void 0:X.ref)===null||Y===void 0?void 0:Y.type,isRef:!!(!((H=(D=I.extras)===null||D===void 0?void 0:D.ref)===null||H===void 0)&&H.timeserial),clientId:I.clientId};Object.entries(y).find(function(tt){var at=tt[0],Z=tt[1];return Z!==void 0?F[at]!==Z:!1})||B(I)};this._addFilteredSubscription(y,B,U),this.subscriptions.on(U)},A.prototype._addFilteredSubscription=function(y,B,U){var I;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(B)){var K=this.filteredSubscriptions.get(B);K.set(y,((I=K==null?void 0:K.get(y))===null||I===void 0?void 0:I.concat(U))||[U])}else this.filteredSubscriptions.set(B,new Map([[y,[U]]]))},A.prototype._getAndDeleteFilteredSubscriptions=function(y,B){var U=this;if(!this.filteredSubscriptions)return[];if(!B&&y)return Array.from(this.filteredSubscriptions.entries()).map(function(X){var Y,D=X[0],H=X[1],F=H.get(y);return H.delete(y),H.size===0&&((Y=U.filteredSubscriptions)===null||Y===void 0||Y.delete(D)),F}).reduce(function(X,Y){var D;return Y?(D=X).concat.apply(D,Y):X},[]);if(!B||!this.filteredSubscriptions.has(B))return[];var I=this.filteredSubscriptions.get(B);if(!y){var K=Array.from(I.values()).reduce(function(X,Y){return X.concat.apply(X,Y)},[]);return this.filteredSubscriptions.delete(B),K}var Q=I.get(y);return I.delete(y),Q||[]},A.prototype.unsubscribe=function(){for(var y=this,B,U=[],I=0;I<arguments.length;I++)U[I]=arguments[I];var K=A.processListenerArgs(U),Q=K[0],X=K[1];if(typeof Q=="object"&&!X||!((B=this.filteredSubscriptions)===null||B===void 0)&&B.has(X)){this._getAndDeleteFilteredSubscriptions(Q,X).forEach(function(Y){return y.subscriptions.off(Y)});return}this.subscriptions.off(Q,X)},A.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new v.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var y=this.connectionManager;if(!y.activeState())throw y.getError();var B=c.default.fromValues({action:P.SYNC,channel:this.name});this.syncChannelSerial&&(B.channelSerial=this.syncChannelSerial),y.send(B)},A.prototype.sendMessage=function(y,B){this.connectionManager.send(y,this.realtime.options.queueMessages,B)},A.prototype.sendPresence=function(y,B){var U=c.default.fromValues({action:P.PRESENCE,channel:this.name,presence:g.isArray(y)?M.default.fromValuesArray(y):[M.default.fromValues(y)]});this.sendMessage(U,B)},A.prototype.onMessage=function(y){(y.action===P.ATTACHED||y.action===P.MESSAGE||y.action===P.PRESENCE)&&this.setChannelSerial(y.channelSerial);var B,U=!1;switch(y.action){case P.ATTACHED:{this.properties.attachSerial=y.channelSerial,this._mode=y.getMode(),this.params=y.params||{};var I=y.decodeModesFromFlags();this.modes=I&&g.allToLowerCase(I)||void 0;var K=y.hasFlag("RESUMED"),Q=y.hasFlag("HAS_PRESENCE"),X=y.hasFlag("HAS_BACKLOG");if(this.state==="attached"){K||this.presence.onAttached(Q);var Y=new R.default(this.state,this.state,K,X,y.error);this._allChannelChanges.emit("update",Y),(!K||this.channelOptions.updateOnAttached)&&this.emit("update",Y)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",y.error,K,Q,X);break}case P.DETACHED:{var D=y.error?v.default.fromValues(y.error):new v.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",D):this.state==="attaching"?this.notifyState("suspended",D):this.requestState("attaching",D);break}case P.SYNC:if(U=!0,B=this.syncChannelSerial=y.channelSerial,!y.presence)break;case P.PRESENCE:{for(var H=y.presence,F=y.id,tt=y.connectionId,at=y.timestamp,Z=this.channelOptions,it=void 0,st=0;st<H.length;st++)try{it=H[st],M.default.decode(it,Z),it.connectionId||(it.connectionId=tt),it.timestamp||(it.timestamp=at),it.id||(it.id=F+":"+st)}catch(Rt){S.default.logAction(S.default.LOG_ERROR,"RealtimeChannel.onMessage()",Rt.toString())}this.presence.setPresence(H,U,B);break}case P.MESSAGE:{if(this.state!=="attached"){S.default.logAction(S.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+y.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var V=y.messages,J=V[0],W=V[V.length-1],F=y.id,tt=y.connectionId,at=y.timestamp;if(J.extras&&J.extras.delta&&J.extras.delta.from!==this._lastPayload.messageId){var nt='Delta message decode failure - previous message not available for message "'+y.id+'" on this channel "'+this.name+'".';S.default.logAction(S.default.LOG_ERROR,"RealtimeChannel.onMessage()",nt),this._startDecodeFailureRecovery(new v.default(nt,40018,400));break}for(var st=0;st<V.length;st++){var nt=V[st];try{E.default.decode(nt,this._decodingContext)}catch(kt){switch(S.default.logAction(S.default.LOG_ERROR,"RealtimeChannel.onMessage()",kt.toString()),kt.code){case 40018:this._startDecodeFailureRecovery(kt);return;case 40019:case 40021:this.notifyState("failed",kt);return}}nt.connectionId||(nt.connectionId=tt),nt.timestamp||(nt.timestamp=at),nt.id||(nt.id=F+":"+st)}this._lastPayload.messageId=W.id,this._lastPayload.protocolMessageChannelSerial=y.channelSerial,this.onEvent(V);break}case P.ERROR:{var dt=y.error;dt&&dt.code==80016?this.checkPendingState():this.notifyState("failed",v.default.fromValues(dt));break}default:S.default.logAction(S.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+y.action+")"),this.connectionManager.abort(z.default.unknownChannelErr())}},A.prototype._startDecodeFailureRecovery=function(y){var B=this;this._lastPayload.decodeFailureRecoveryInProgress||(S.default.logAction(S.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,y,function(){B._lastPayload.decodeFailureRecoveryInProgress=!1}))},A.prototype.onAttached=function(){S.default.logAction(S.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},A.prototype.notifyState=function(y,B,U,I,K){if(S.default.logAction(S.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+y),this.clearStateTimer(),g.arrIn(["detached","suspended","failed"],y)&&(this.properties.channelSerial=null),y!==this.state){this.presence.actOnChannelState(y,I,B),y==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),B&&(this.errorReason=B);var Q=new R.default(this.state,y,U,K,B),X=y==="failed"?S.default.LOG_ERROR:S.default.LOG_MAJOR;S.default.logAction(X,'Channel state for channel "'+this.name+'"',y+(B?"; reason: "+B:"")),y!=="attaching"&&y!=="suspended"&&(this.retryCount=0),y==="attached"&&this.onAttached(),y==="attached"?this._attachResume=!0:(y==="detaching"||y==="failed")&&(this._attachResume=!1),this.state=y,this._allChannelChanges.emit(y,Q),this.emit(y,Q)}},A.prototype.requestState=function(y,B){S.default.logAction(S.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+y),this.notifyState(y,B),this.checkPendingState()},A.prototype.checkPendingState=function(){var y=this.connectionManager.state;if(!(y.sendEvents||y.forceQueueEvents)){S.default.logAction(S.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(S.default.logAction(S.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},A.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var y=new v.default("Channel attach timed out",90007,408);this.notifyState("suspended",y);break}case"detaching":{var y=new v.default("Channel detach timed out",90007,408);this.notifyState("attached",y);break}default:this.checkPendingState();break}},A.prototype.startStateTimerIfNotRunning=function(){var y=this;this.stateTimer||(this.stateTimer=setTimeout(function(){S.default.logAction(S.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),y.stateTimer=null,y.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},A.prototype.clearStateTimer=function(){var y=this.stateTimer;y&&(clearTimeout(y),this.stateTimer=null)},A.prototype.startRetryTimer=function(){var y=this;if(!this.retryTimer){this.retryCount++;var B=g.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){y.state==="suspended"&&y.connectionManager.state.sendEvents&&(y.retryTimer=null,S.default.logAction(S.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),y.requestState("attaching"))},B)}},A.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},A.prototype.getReleaseErr=function(){var y=this.state;return y==="initialized"||y==="detached"||y==="failed"?null:new v.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+y,90001,400)},A.prototype.setChannelSerial=function(y){S.default.logAction(S.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+y+"; previous = "+this.properties.channelSerial),y&&(this.properties.channelSerial=y)},A})(m.default);function O(T){var A=T||{};A.agent;var y=l.__rest(A,["agent"]);return y}a.default=L}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function c(d,g,m,S,C){this.previous=d,this.current=g,g==="attached"&&(this.resumed=m,this.hasBacklog=S),C&&(this.reason=C)}return c})();a.default=l}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=d.Hasher,S=c.algo,C=[],E=S.SHA1=m.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(R,v){for(var M=this._hash.words,z=M[0],P=M[1],j=M[2],x=M[3],L=M[4],O=0;O<80;O++){if(O<16)C[O]=R[v+O]|0;else{var T=C[O-3]^C[O-8]^C[O-14]^C[O-16];C[O]=T<<1|T>>>31}var A=(z<<5|z>>>27)+L+C[O];O<20?A+=(P&j|~P&x)+1518500249:O<40?A+=(P^j^x)+1859775393:O<60?A+=(P&j|P&x|j&x)-1894007588:A+=(P^j^x)-899497514,L=x,x=j,j=P<<30|P>>>2,P=z,z=A}M[0]=M[0]+z|0,M[1]=M[1]+P|0,M[2]=M[2]+j|0,M[3]=M[3]+x|0,M[4]=M[4]+L|0},_doFinalize:function(){var R=this._data,v=R.words,M=this._nDataBytes*8,z=R.sigBytes*8;return v[z>>>5]|=128<<24-z%32,v[(z+64>>>9<<4)+14]=Math.floor(M/4294967296),v[(z+64>>>9<<4)+15]=M,R.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var R=m.clone.call(this);return R._hash=this._hash.clone(),R}});c.SHA1=m._createHelper(E),c.HmacSHA1=m._createHmacHelper(E)})(),l.SHA1})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});function l(O){if(O===void 0)return"undefined";var T,A;if(O instanceof ArrayBuffer?(A="ArrayBuffer",T=new DataView(O)):O instanceof DataView&&(A="DataView",T=O),!T)return JSON.stringify(O);for(var y=[],B=0;B<O.byteLength;B++){if(B>20){y.push("...");break}var U=T.getUint8(B).toString(16);U.length===1&&(U="0"+U),y.push(U)}return"<"+A+" "+y.join(" ")+">"}function c(O,T,A){for(var y=0,B=A.length;y<B;y++){var U=A.charCodeAt(y);if(U<128){O.setUint8(T++,U>>>0&127|0);continue}if(U<2048){O.setUint8(T++,U>>>6&31|192),O.setUint8(T++,U>>>0&63|128);continue}if(U<65536){O.setUint8(T++,U>>>12&15|224),O.setUint8(T++,U>>>6&63|128),O.setUint8(T++,U>>>0&63|128);continue}if(U<1114112){O.setUint8(T++,U>>>18&7|240),O.setUint8(T++,U>>>12&63|128),O.setUint8(T++,U>>>6&63|128),O.setUint8(T++,U>>>0&63|128);continue}throw new Error("bad codepoint "+U)}}function d(O,T,A){for(var y="",B=T,U=T+A;B<U;B++){var I=O.getUint8(B);if((I&128)===0){y+=String.fromCharCode(I);continue}if((I&224)===192){y+=String.fromCharCode((I&15)<<6|O.getUint8(++B)&63);continue}if((I&240)===224){y+=String.fromCharCode((I&15)<<12|(O.getUint8(++B)&63)<<6|(O.getUint8(++B)&63)<<0);continue}if((I&248)===240){y+=String.fromCharCode((I&7)<<18|(O.getUint8(++B)&63)<<12|(O.getUint8(++B)&63)<<6|(O.getUint8(++B)&63)<<0);continue}throw new Error("Invalid byte "+I.toString(16))}return y}function g(O){for(var T=0,A=0,y=O.length;A<y;A++){var B=O.charCodeAt(A);if(B<128){T+=1;continue}if(B<2048){T+=2;continue}if(B<65536){T+=3;continue}if(B<1114112){T+=4;continue}throw new Error("bad codepoint "+B)}return T}function m(O,T){var A=L(O,T);if(A!==0){var y=new ArrayBuffer(A),B=new DataView(y);return x(O,B,0,T),y}}var S=65536*65536,C=1/S;function E(O,T){return T=T||0,O.getInt32(T)*S+O.getUint32(T+4)}function R(O,T){return T=T||0,O.getUint32(T)*S+O.getUint32(T+4)}function v(O,T,A){A<9223372036854776e3?(O.setInt32(T,Math.floor(A*C)),O.setInt32(T+4,A&-1)):(O.setUint32(T,2147483647),O.setUint32(T+4,2147483647))}function M(O,T,A){A<18446744073709552e3?(O.setUint32(T,Math.floor(A*C)),O.setInt32(T+4,A&-1)):(O.setUint32(T,4294967295),O.setUint32(T+4,4294967295))}var z=(function(){function O(T,A){var y=this;this.map=function(B){for(var U={},I=0;I<B;I++){var K=y.parse();U[K]=y.parse()}return U},this.bin=function(B){var U=new ArrayBuffer(B);return new Uint8Array(U).set(new Uint8Array(y.view.buffer,y.offset,B),0),y.offset+=B,U},this.buf=this.bin,this.str=function(B){var U=d(y.view,y.offset,B);return y.offset+=B,U},this.array=function(B){for(var U=new Array(B),I=0;I<B;I++)U[I]=y.parse();return U},this.ext=function(B){return y.offset+=B,{type:y.view.getInt8(y.offset),data:y.buf(B)}},this.parse=function(){var B=y.view.getUint8(y.offset),U,I;if((B&128)===0)return y.offset++,B;if((B&240)===128)return I=B&15,y.offset++,y.map(I);if((B&240)===144)return I=B&15,y.offset++,y.array(I);if((B&224)===160)return I=B&31,y.offset++,y.str(I);if((B&224)===224)return U=y.view.getInt8(y.offset),y.offset++,U;switch(B){case 192:return y.offset++,null;case 193:y.offset++;return;case 194:return y.offset++,!1;case 195:return y.offset++,!0;case 196:return I=y.view.getUint8(y.offset+1),y.offset+=2,y.bin(I);case 197:return I=y.view.getUint16(y.offset+1),y.offset+=3,y.bin(I);case 198:return I=y.view.getUint32(y.offset+1),y.offset+=5,y.bin(I);case 199:return I=y.view.getUint8(y.offset+1),y.offset+=2,y.ext(I);case 200:return I=y.view.getUint16(y.offset+1),y.offset+=3,y.ext(I);case 201:return I=y.view.getUint32(y.offset+1),y.offset+=5,y.ext(I);case 202:return U=y.view.getFloat32(y.offset+1),y.offset+=5,U;case 203:return U=y.view.getFloat64(y.offset+1),y.offset+=9,U;case 204:return U=y.view.getUint8(y.offset+1),y.offset+=2,U;case 205:return U=y.view.getUint16(y.offset+1),y.offset+=3,U;case 206:return U=y.view.getUint32(y.offset+1),y.offset+=5,U;case 207:return U=R(y.view,y.offset+1),y.offset+=9,U;case 208:return U=y.view.getInt8(y.offset+1),y.offset+=2,U;case 209:return U=y.view.getInt16(y.offset+1),y.offset+=3,U;case 210:return U=y.view.getInt32(y.offset+1),y.offset+=5,U;case 211:return U=E(y.view,y.offset+1),y.offset+=9,U;case 212:return I=1,y.offset++,y.ext(I);case 213:return I=2,y.offset++,y.ext(I);case 214:return I=4,y.offset++,y.ext(I);case 215:return I=8,y.offset++,y.ext(I);case 216:return I=16,y.offset++,y.ext(I);case 217:return I=y.view.getUint8(y.offset+1),y.offset+=2,y.str(I);case 218:return I=y.view.getUint16(y.offset+1),y.offset+=3,y.str(I);case 219:return I=y.view.getUint32(y.offset+1),y.offset+=5,y.str(I);case 220:return I=y.view.getUint16(y.offset+1),y.offset+=3,y.array(I);case 221:return I=y.view.getUint32(y.offset+1),y.offset+=5,y.array(I);case 222:return I=y.view.getUint16(y.offset+1),y.offset+=3,y.map(I);case 223:return I=y.view.getUint32(y.offset+1),y.offset+=5,y.map(I)}throw new Error("Unknown type 0x"+B.toString(16))},this.offset=A||0,this.view=T}return O})();function P(O){var T=new DataView(O),A=new z(T),y=A.parse();if(A.offset!==O.byteLength)throw new Error(O.byteLength-A.offset+" trailing bytes");return y}function j(O,T){return Object.keys(O).filter(function(A){var y=O[A],B=typeof y;return(!T||y!=null)&&(B!=="function"||!!y.toJSON)})}function x(O,T,A,y){var B=typeof O;if(typeof O=="string"){var U=g(O);if(U<32)return T.setUint8(A,U|160),c(T,A+1,O),1+U;if(U<256)return T.setUint8(A,217),T.setUint8(A+1,U),c(T,A+2,O),2+U;if(U<65536)return T.setUint8(A,218),T.setUint16(A+1,U),c(T,A+3,O),3+U;if(U<4294967296)return T.setUint8(A,219),T.setUint32(A+1,U),c(T,A+5,O),5+U}if(ArrayBuffer.isView&&ArrayBuffer.isView(O)&&(O=O.buffer),O instanceof ArrayBuffer){var I=O.byteLength;if(I<256)return T.setUint8(A,196),T.setUint8(A+1,I),new Uint8Array(T.buffer).set(new Uint8Array(O),A+2),2+I;if(I<65536)return T.setUint8(A,197),T.setUint16(A+1,I),new Uint8Array(T.buffer).set(new Uint8Array(O),A+3),3+I;if(I<4294967296)return T.setUint8(A,198),T.setUint32(A+1,I),new Uint8Array(T.buffer).set(new Uint8Array(O),A+5),5+I}if(typeof O=="number"){if(Math.floor(O)!==O)return T.setUint8(A,203),T.setFloat64(A+1,O),9;if(O>=0){if(O<128)return T.setUint8(A,O),1;if(O<256)return T.setUint8(A,204),T.setUint8(A+1,O),2;if(O<65536)return T.setUint8(A,205),T.setUint16(A+1,O),3;if(O<4294967296)return T.setUint8(A,206),T.setUint32(A+1,O),5;if(O<18446744073709552e3)return T.setUint8(A,207),M(T,A+1,O),9;throw new Error("Number too big 0x"+O.toString(16))}if(O>=-32)return T.setInt8(A,O),1;if(O>=-128)return T.setUint8(A,208),T.setInt8(A+1,O),2;if(O>=-32768)return T.setUint8(A,209),T.setInt16(A+1,O),3;if(O>=-2147483648)return T.setUint8(A,210),T.setInt32(A+1,O),5;if(O>=-9223372036854776e3)return T.setUint8(A,211),v(T,A+1,O),9;throw new Error("Number too small -0x"+(-O).toString(16).substr(1))}if(B==="undefined")return y?0:(T.setUint8(A,212),T.setUint8(A+1,0),T.setUint8(A+2,0),3);if(O===null)return y?0:(T.setUint8(A,192),1);if(B==="boolean")return T.setUint8(A,O?195:194),1;if(typeof O.toJSON=="function")return x(O.toJSON(),T,A,y);if(B==="object"){var K,Q=0,X=void 0,Y=Array.isArray(O);if(Y?K=O.length:(X=j(O,y),K=X.length),K<16?(T.setUint8(A,K|(Y?144:128)),Q=1):K<65536?(T.setUint8(A,Y?220:222),T.setUint16(A+1,K),Q=3):K<4294967296&&(T.setUint8(A,Y?221:223),T.setUint32(A+1,K),Q=5),Y)for(var D=0;D<K;D++)Q+=x(O[D],T,A+Q,y);else if(X)for(var D=0;D<K;D++){var H=X[D];Q+=x(H,T,A+Q),Q+=x(O[H],T,A+Q,y)}return Q}if(B==="function")return 0;throw new Error("Unknown type "+B)}function L(O,T){var A=typeof O;if(A==="string"){var y=g(O);if(y<32)return 1+y;if(y<256)return 2+y;if(y<65536)return 3+y;if(y<4294967296)return 5+y}if(ArrayBuffer.isView&&ArrayBuffer.isView(O)&&(O=O.buffer),O instanceof ArrayBuffer){var B=O.byteLength;if(B<256)return 2+B;if(B<65536)return 3+B;if(B<4294967296)return 5+B}if(typeof O=="number"){if(Math.floor(O)!==O)return 9;if(O>=0){if(O<128)return 1;if(O<256)return 2;if(O<65536)return 3;if(O<4294967296)return 5;if(O<18446744073709552e3)return 9;throw new Error("Number too big 0x"+O.toString(16))}if(O>=-32)return 1;if(O>=-128)return 2;if(O>=-32768)return 3;if(O>=-2147483648)return 5;if(O>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+O.toString(16).substr(1))}if(A==="boolean")return 1;if(O===null)return T?0:1;if(O===void 0)return T?0:3;if(typeof O.toJSON=="function")return L(O.toJSON(),T);if(A==="object"){var U,I=0;if(Array.isArray(O)){U=O.length;for(var K=0;K<U;K++)I+=L(O[K],T)}else{var Q=j(O,T);U=Q.length;for(var K=0;K<U;K++){var X=Q[K];I+=L(X)+L(O[X],T)}}if(U<16)return 1+I;if(U<65536)return 3+I;if(U<4294967296)return 5+I;throw new Error("Array or object too long 0x"+U.toString(16))}if(A==="function")return 0;throw new Error("Unknown type "+A)}a.default={encode:m,decode:P,inspect:l,utf8Write:c,utf8Read:d,utf8ByteCount:g}}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(30)),d=l.__importDefault(r(50)),g=l.__importDefault(r(3)),m=l.__importDefault(r(4)),S=l.__importDefault(r(55)),C=l.__importDefault(r(57)),E=l.__importDefault(r(62)),R=l.__importDefault(r(64)),v=l.__importDefault(r(68)),M=l.__importDefault(r(2)),z=r(8),P=l.__importDefault(r(65)),j=l.__importDefault(r(66)),x=l.__importDefault(r(41)),L=(0,C.default)(R.default,S.default);g.default.Crypto=L,g.default.BufferUtils=S.default,g.default.Http=E.default,g.default.Config=R.default,g.default.Transports=v.default,g.default.WebStorage=P.default,c.default.Crypto=L,d.default.Crypto=L,M.default.initLogHandlers(),g.default.Defaults=(0,z.getDefaults)(j.default),g.default.Config.agent&&(g.default.Defaults.agent+=" "+g.default.Config.agent),g.default.Config.noUpgrade&&(g.default.Defaults.upgradeTransports=[]),a.default={ErrorInfo:m.default,Rest:c.default,Realtime:d.default,msgpack:x.default}}),(function(n){n.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')}),(function(n,a){}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(32),r(25))})(this,function(l){return l.HmacSHA256})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(47)),g=l.__importDefault(r(15)),m=l.__importDefault(r(20)),S=l.__importDefault(r(4)),C=l.__importDefault(r(48)),E=function(){},R=(function(){function P(j){this.rest=j,this.admin=new v(j)}return P})(),v=(function(){function P(j){this.rest=j,this.deviceRegistrations=new M(j),this.channelSubscriptions=new z(j)}return P.prototype.publish=function(j,x,L){var O=this.rest,T=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultPostHeaders(O.options,T),y={},B=c.mixin({recipient:j},x);if(typeof L!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);L=E}O.options.headers&&c.mixin(A,O.options.headers),O.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var U=c.encodeBody(B,T);g.default.post(O,"/push/publish",U,A,y,null,function(I){return L(I)})},P})(),M=(function(){function P(j){this.rest=j}return P.prototype.save=function(j,x){var L=this.rest,O=d.default.fromValues(j),T=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultPostHeaders(L.options,T),y={};if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);x=E}L.options.headers&&c.mixin(A,L.options.headers),L.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var B=c.encodeBody(O,T);g.default.put(L,"/push/deviceRegistrations/"+encodeURIComponent(j.id),B,A,y,null,function(U,I,K,Q){x(U,U?void 0:d.default.fromResponseBody(I,Q?void 0:T))})},P.prototype.get=function(j,x){var L=this.rest,O=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultGetHeaders(L.options,O),A=j.id||j;if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"get",arguments);x=E}if(typeof A!="string"||!A.length){x(new S.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}L.options.headers&&c.mixin(T,L.options.headers),g.default.get(L,"/push/deviceRegistrations/"+encodeURIComponent(A),T,{},null,function(y,B,U,I){x(y,y?void 0:d.default.fromResponseBody(B,I?void 0:O))})},P.prototype.list=function(j,x){var L=this.rest,O=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=this.rest.http.supportsLinkHeaders?void 0:O,A=c.defaultGetHeaders(L.options,O);if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);x=E}L.options.headers&&c.mixin(A,L.options.headers),new m.default(L,"/push/deviceRegistrations",A,T,function(y,B,U){return d.default.fromResponseBody(y,U?void 0:O)}).get(j,x)},P.prototype.remove=function(j,x){var L=this.rest,O=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultGetHeaders(L.options,O),A={},y=j.id||j;if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"remove",arguments);x=E}if(typeof y!="string"||!y.length){x(new S.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}L.options.headers&&c.mixin(T,L.options.headers),L.options.pushFullWait&&c.mixin(A,{fullWait:"true"}),g.default.delete(L,"/push/deviceRegistrations/"+encodeURIComponent(y),T,A,null,function(B){return x(B)})},P.prototype.removeWhere=function(j,x){var L=this.rest,O=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultGetHeaders(L.options,O);if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);x=E}L.options.headers&&c.mixin(T,L.options.headers),L.options.pushFullWait&&c.mixin(j,{fullWait:"true"}),g.default.delete(L,"/push/deviceRegistrations",T,j,null,function(A){return x(A)})},P})(),z=(function(){function P(j){this.remove=P.prototype.removeWhere,this.rest=j}return P.prototype.save=function(j,x){var L=this.rest,O=C.default.fromValues(j),T=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultPostHeaders(L.options,T),y={};if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);x=E}L.options.headers&&c.mixin(A,L.options.headers),L.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var B=c.encodeBody(O,T);g.default.post(L,"/push/channelSubscriptions",B,A,y,null,function(U,I,K,Q){x(U,!U&&C.default.fromResponseBody(I,Q?void 0:T))})},P.prototype.list=function(j,x){var L=this.rest,O=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=this.rest.http.supportsLinkHeaders?void 0:O,A=c.defaultGetHeaders(L.options,O);if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);x=E}L.options.headers&&c.mixin(A,L.options.headers),new m.default(L,"/push/channelSubscriptions",A,T,function(y,B,U){return C.default.fromResponseBody(y,U?void 0:O)}).get(j,x)},P.prototype.removeWhere=function(j,x){var L=this.rest,O=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultGetHeaders(L.options,O);if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);x=E}L.options.headers&&c.mixin(T,L.options.headers),L.options.pushFullWait&&c.mixin(j,{fullWait:"true"}),g.default.delete(L,"/push/channelSubscriptions",T,j,null,function(A){return x(A)})},P.prototype.listChannels=function(j,x){var L=this.rest,O=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=this.rest.http.supportsLinkHeaders?void 0:O,A=c.defaultGetHeaders(L.options,O);if(typeof x!="function"){if(this.rest.options.promises)return c.promisify(this,"listChannels",arguments);x=E}L.options.headers&&c.mixin(A,L.options.headers),L.options.pushFullWait&&c.mixin(j,{fullWait:"true"}),new m.default(L,"/push/channels",A,T,function(y,B,U){for(var I=!U&&O?c.decodeBody(y,O):y,K=0;K<I.length;K++)I[K]=String(I[K]);return I}).get(j,x)},P})();a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(4)),g;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(g||(g={}));var m;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(m||(m={}));var S=(function(){function C(){}return C.prototype.toJSON=function(){var E,R,v;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(R=this.push)===null||R===void 0?void 0:R.state,error:(v=this.push)===null||v===void 0?void 0:v.error}}},C.prototype.toString=function(){var E,R,v,M,z="[DeviceDetails";return this.id&&(z+="; id="+this.id),this.platform&&(z+="; platform="+this.platform),this.formFactor&&(z+="; formFactor="+this.formFactor),this.clientId&&(z+="; clientId="+this.clientId),this.metadata&&(z+="; metadata="+this.metadata),this.deviceIdentityToken&&(z+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(z+="; push.recipient="+JSON.stringify(this.push.recipient)),!((R=this.push)===null||R===void 0)&&R.state&&(z+="; push.state="+this.push.state),!((v=this.push)===null||v===void 0)&&v.error&&(z+="; push.error="+JSON.stringify(this.push.error)),!((M=this.push)===null||M===void 0)&&M.metadata&&(z+="; push.metadata="+this.push.metadata),z+="]",z},C.fromResponseBody=function(E,R){return R&&(E=c.decodeBody(E,R)),c.isArray(E)?C.fromValuesArray(E):C.fromValues(E)},C.fromValues=function(E){return E.error=E.error&&d.default.fromValues(E.error),Object.assign(new C,E)},C.fromValuesArray=function(E){for(var R=E.length,v=new Array(R),M=0;M<R;M++)v[M]=C.fromValues(E[M]);return v},C.toRequestBody=c.encodeBody,C})();a.default=S}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=(function(){function g(){}return g.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},g.prototype.toString=function(){var m="[PushChannelSubscription";return this.channel&&(m+="; channel="+this.channel),this.deviceId&&(m+="; deviceId="+this.deviceId),this.clientId&&(m+="; clientId="+this.clientId),m+="]",m},g.fromResponseBody=function(m,S){return S&&(m=c.decodeBody(m,S)),c.isArray(m)?g.fromValuesArray(m):g.fromValues(m)},g.fromValues=function(m){return Object.assign(new g,m)},g.fromValuesArray=function(m){for(var S=m.length,C=new Array(S),E=0;E<S;E++)C[E]=g.fromValues(m[E]);return C},g.toRequestBody=c.encodeBody,g})();a.default=d}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=(function(){function L(O){this.count=O&&O.count||0,this.data=O&&O.data||0,this.uncompressedData=O&&O.uncompressedData||0,this.failed=O&&O.failed||0,this.refused=O&&O.refused||0}return L})(),g=(function(L){l.__extends(O,L);function O(T){var A=L.call(this,T)||this;return T&&T.category&&(A.category={},c.forInOwnNonNullProperties(T.category,function(y){A.category[y]=new d(T.category[y])})),A}return O})(d),m=(function(){function L(O){this.peak=O&&O.peak||0,this.min=O&&O.min||0,this.mean=O&&O.mean||0,this.opened=O&&O.opened||0,this.refused=O&&O.refused||0}return L})(),S=(function(){function L(O){this.succeeded=O&&O.succeeded||0,this.failed=O&&O.failed||0,this.refused=O&&O.refused||0}return L})(),C=(function(){function L(O){this.plain=new m(O&&O.plain),this.tls=new m(O&&O.tls),this.all=new m(O&&O.all)}return L})(),E=(function(){function L(O){this.messages=new g(O&&O.messages),this.presence=new g(O&&O.presence),this.all=new g(O&&O.all)}return L})(),R=(function(){function L(O){this.realtime=new E(O&&O.realtime),this.rest=new E(O&&O.rest),this.webhook=new E(O&&O.webhook),this.sharedQueue=new E(O&&O.sharedQueue),this.externalQueue=new E(O&&O.externalQueue),this.httpEvent=new E(O&&O.httpEvent),this.push=new E(O&&O.push),this.all=new E(O&&O.all)}return L})(),v=(function(){function L(O){this.all=new E(O&&O.all),this.inbound=new R(O&&O.inbound),this.outbound=new R(O&&O.outbound)}return L})(),M=(function(){function L(O){this.all=new E(O&&O.all),this.producerPaid=new v(O&&O.producerPaid),this.consumerPaid=new v(O&&O.consumerPaid)}return L})(),z=(function(){function L(O){this.messages=O&&O.messages||0;var T=O&&O.notifications;this.notifications={invalid:T&&T.invalid||0,attempted:T&&T.attempted||0,successful:T&&T.successful||0,failed:T&&T.failed||0},this.directPublishes=O&&O.directPublishes||0}return L})(),P=(function(){function L(O){this.succeeded=O&&O.succeeded||0,this.skipped=O&&O.skipped||0,this.failed=O&&O.failed||0}return L})(),j=(function(){function L(O){var T=this;this.delta=void 0,O&&O.delta&&(this.delta={},c.forInOwnNonNullProperties(O.delta,function(A){T.delta[A]=new P(O.delta[A])}))}return L})(),x=(function(L){l.__extends(O,L);function O(T){var A=L.call(this,T)||this;return A.persisted=new E(T&&T.persisted),A.connections=new C(T&&T.connections),A.channels=new m(T&&T.channels),A.apiRequests=new S(T&&T.apiRequests),A.tokenRequests=new S(T&&T.tokenRequests),A.xchgProducer=new M(T&&T.xchgProducer),A.xchgConsumer=new M(T&&T.xchgConsumer),A.push=new z(T&&T.pushStats),A.processed=new j(T&&T.processed),A.inProgress=T&&T.inProgress||void 0,A.unit=T&&T.unit||void 0,A.intervalId=T&&T.intervalId||void 0,A}return O.fromValues=function(T){return new O(T)},O})(v);a.default=x}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(30)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),S=l.__importDefault(r(51)),C=l.__importDefault(r(38)),E=l.__importDefault(r(8)),R=l.__importDefault(r(4)),v=l.__importDefault(r(10)),M=l.__importDefault(r(35)),z=l.__importDefault(r(3)),P=l.__importDefault(r(9)),j=(function(L){l.__extends(O,L);function O(T){var A=L.call(this,T)||this;return m.default.logAction(m.default.LOG_MINOR,"Realtime()",""),A.connection=new S.default(A,A.options),A.channels=new x(A),T.autoConnect!==!1&&A.connect(),A}return O.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},O.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},O.Promise=function(T){return T=E.default.objectifyOptions(T),T.promises=!0,new O(T)},O.Callbacks=O,O.Utils=c,O.ConnectionManager=M.default,O.Platform=z.default,O.ProtocolMessage=v.default,O.Message=P.default,O})(d.default),x=(function(L){l.__extends(O,L);function O(T){var A=L.call(this)||this;return A.realtime=T,A.all=Object.create(null),T.connection.connectionManager.on("transport.active",function(){A.onTransportActive()}),A}return O.prototype.channelSerials=function(){for(var T={},A=0,y=c.keysArray(this.all,!0);A<y.length;A++){var B=y[A],U=this.all[B];U.properties.channelSerial&&(T[B]=U.properties.channelSerial)}return T},O.prototype.recoverChannels=function(T){for(var A=0,y=c.keysArray(T,!0);A<y.length;A++){var B=y[A],U=this.get(B);U.properties.channelSerial=T[B]}},O.prototype.onChannelMessage=function(T){var A=T.channel;if(A===void 0){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+T.action);return}var y=this.all[A];if(!y){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+A);return}y.onMessage(T)},O.prototype.onTransportActive=function(){for(var T in this.all){var A=this.all[T];A.state==="attaching"||A.state==="detaching"?A.checkPendingState():A.state==="suspended"?A._attach(!1,null):A.state==="attached"&&A.requestState("attaching")}},O.prototype.propogateConnectionInterruption=function(T,A){var y={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},B=["attaching","attached","detaching","suspended"],U=y[T];for(var I in this.all){var K=this.all[I];c.arrIn(B,K.state)&&K.notifyState(U,A)}},O.prototype.get=function(T,A){T=String(T);var y=this.all[T];if(!y)y=this.all[T]=new C.default(this.realtime,T,A);else if(A){if(y._shouldReattachToSetOptions(A,y.channelOptions))throw new R.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);y.setOptions(A)}return y},O.prototype.getDerived=function(T,A,y){if(A.filter){var B=c.toBase64(A.filter),U=c.matchDerivedChannel(T);T="[filter=".concat(B).concat(U.qualifierParam,"]").concat(U.channelName)}return this.get(T,y)},O.prototype.release=function(T){T=String(T);var A=this.all[T];if(A){var y=A.getReleaseErr();if(y)throw y;delete this.all[T]}},O})(g.default);a.default=j}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(35)),m=l.__importDefault(r(2)),S=l.__importDefault(r(37)),C=l.__importDefault(r(3));function E(){}var R=(function(v){l.__extends(M,v);function M(z,P){var j=v.call(this)||this;return j.whenState=(function(x,L){return d.default.prototype.whenState.call(j,x,j.state,L,new S.default(void 0,x))}),j.ably=z,j.connectionManager=new g.default(z,P),j.state=j.connectionManager.state.state,j.key=void 0,j.id=void 0,j.errorReason=null,j.connectionManager.on("connectionstate",function(x){var L=j.state=x.current;C.default.Config.nextTick(function(){j.emit(L,x)})}),j.connectionManager.on("update",function(x){C.default.Config.nextTick(function(){j.emit("update",x)})}),j}return M.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},M.prototype.ping=function(z){if(m.default.logAction(m.default.LOG_MINOR,"Connection.ping()",""),!z){if(this.ably.options.promises)return c.promisify(this,"ping",arguments);z=E}this.connectionManager.ping(null,z)},M.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(M.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),M.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},M})(d.default);a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.PendingMessage=void 0;var l=r(0),c=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),S=l.__importDefault(r(36)),C=l.__importDefault(r(4)),E=c.default.Action,R=(function(){function M(z,P){this.message=z,this.callback=P,this.merged=!1;var j=z.action;this.sendAttempted=!1,this.ackRequired=j==E.MESSAGE||j==E.PRESENCE}return M})();a.PendingMessage=R;var v=(function(M){l.__extends(z,M);function z(P){var j=M.call(this)||this;return j.transport=P,j.messageQueue=new S.default,P.on("ack",function(x,L){j.onAck(x,L)}),P.on("nack",function(x,L,O){j.onNack(x,L,O)}),j}return z.prototype.onAck=function(P,j){m.default.logAction(m.default.LOG_MICRO,"Protocol.onAck()","serial = "+P+"; count = "+j),this.messageQueue.completeMessages(P,j)},z.prototype.onNack=function(P,j,x){m.default.logAction(m.default.LOG_ERROR,"Protocol.onNack()","serial = "+P+"; count = "+j+"; err = "+d.inspectError(x)),x||(x=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(P,j,x)},z.prototype.onceIdle=function(P){var j=this.messageQueue;if(j.count()===0){P();return}j.once("idle",P)},z.prototype.send=function(P){P.ackRequired&&this.messageQueue.push(P),m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Protocol.send()","sending msg; "+c.default.stringify(P.message)),P.sendAttempted=!0,this.transport.send(P.message)},z.prototype.getTransport=function(){return this.transport},z.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},z.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},z.prototype.finish=function(){var P=this.transport;this.onceIdle(function(){P.disconnect()})},z})(g.default);a.default=v}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(26)),m=l.__importDefault(r(8)),S=l.__importDefault(r(2)),C=l.__importDefault(r(10)),E=l.__importDefault(r(4)),R="web_socket";function v(P){return!!P.on}var M=(function(P){l.__extends(j,P);function j(x,L,O){var T=P.call(this,x,L,O)||this;return T.shortName=R,O.heartbeats=c.default.Config.useProtocolHeartbeats,T.wsHost=m.default.getHost(O.options,O.host,!0),T}return j.isAvailable=function(){return!!c.default.Config.WebSocket},j.prototype.createWebSocket=function(x,L){return this.uri=x+d.toQueryString(L),new c.default.Config.WebSocket(this.uri)},j.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},j.prototype.connect=function(){S.default.logAction(S.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),g.default.prototype.connect.call(this);var x=this,L=this.params,O=L.options,T=O.tls?"wss://":"ws://",A=T+this.wsHost+":"+m.default.getPort(O)+"/";S.default.logAction(S.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+A),this.auth.getAuthParams(function(y,B){if(!x.isDisposed){var U="";for(var I in B)U+=" "+I+": "+B[I]+";";if(S.default.logAction(S.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+U+" err: "+y),y){x.disconnect(y);return}var K=L.getConnectParams(B);try{var Q=x.wsConnection=x.createWebSocket(A,K);Q.binaryType=c.default.Config.binaryType,Q.onopen=function(){x.onWsOpen()},Q.onclose=function(X){x.onWsClose(X)},Q.onmessage=function(X){x.onWsData(X.data)},Q.onerror=function(X){x.onWsError(X)},v(Q)&&Q.on("ping",function(){x.onActivity()})}catch(X){S.default.logAction(S.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(X.stack||X.message)),x.disconnect(X)}}})},j.prototype.send=function(x){var L=this.wsConnection;if(!L){S.default.logAction(S.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{L.send(C.default.serialize(x,this.params.format))}catch(T){var O="Exception from ws connection when trying to send: "+d.inspectError(T);S.default.logAction(S.default.LOG_ERROR,"WebSocketTransport.send()",O),this.finish("disconnected",new E.default(O,5e4,500))}},j.prototype.onWsData=function(x){S.default.logAction(S.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+x.length+"; type = "+typeof x);try{this.onProtocolMessage(C.default.deserialize(x,this.format))}catch(L){S.default.logAction(S.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+L.stack)}},j.prototype.onWsOpen=function(){S.default.logAction(S.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},j.prototype.onWsClose=function(x){var L,O;if(typeof x=="object"?(O=x.code,L=x.wasClean||O===1e3):(O=x,L=O==1e3),delete this.wsConnection,L){S.default.logAction(S.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var T=new E.default("Websocket closed",80003,400);this.finish("disconnected",T)}else{var A="Unclean disconnection of WebSocket ; code = "+O,T=new E.default(A,80003,400);S.default.logAction(S.default.LOG_MINOR,"WebSocketTransport.onWsClose()",A),this.finish("disconnected",T)}this.emit("disposed")},j.prototype.onWsError=function(x){var L=this;S.default.logAction(S.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+x.message),c.default.Config.nextTick(function(){L.disconnect(Error(x.message))})},j.prototype.dispose=function(){S.default.logAction(S.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var x=this.wsConnection;x&&(x.onmessage=function(){},delete this.wsConnection,c.default.Config.nextTick(function(){if(S.default.logAction(S.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!x)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");x.close()}))},j})(g.default);function z(P){return M.isAvailable()&&(P.supportedTransports[R]=M),M}a.default=z}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(34)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),S=l.__importDefault(r(16)),C=l.__importStar(r(4)),E=l.__importDefault(r(38)),R=l.__importDefault(r(24)),v=l.__importDefault(r(39)),M=function(){};function z(T){return T.channel.realtime.auth.clientId}function P(T){var A=T.channel.realtime,y=A.auth.clientId;return(!y||y==="*")&&A.connection.state==="connected"}function j(T,A,y){switch(T.state){case"attached":case"suspended":y();break;case"initialized":case"detached":case"detaching":case"attaching":T.attach(function(B){B?A(B):y()});break;default:A(C.default.fromValues(T.invalidStateError()))}}function x(T,A){if(T.isSynthesized()||A.isSynthesized())return T.timestamp>=A.timestamp;var y=T.parseId(),B=A.parseId();return y.msgSerial===B.msgSerial?y.index>B.index:y.msgSerial>B.msgSerial}var L=(function(T){l.__extends(A,T);function A(y){var B=T.call(this,y)||this;return B.channel=y,B.syncComplete=!1,B.members=new O(B,function(U){return U.clientId+":"+U.connectionId}),B._myMembers=new O(B,function(U){return U.clientId}),B.subscriptions=new g.default,B.pendingPresence=[],B}return A.prototype.enter=function(y,B){if(P(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"enter",B)},A.prototype.update=function(y,B){if(P(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"update",B)},A.prototype.enterClient=function(y,B,U){return this._enterOrUpdateClient(void 0,y,B,"enter",U)},A.prototype.updateClient=function(y,B,U){return this._enterOrUpdateClient(void 0,y,B,"update",U)},A.prototype._enterOrUpdateClient=function(y,B,U,I,K){var Q=this;if(!K)if(typeof U=="function")K=U,U=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"_enterOrUpdateClient",[y,B,U,I]);K=M}var X=this.channel;if(!X.connectionManager.activeState()){K(X.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence."+I+"Client()","channel = "+X.name+", id = "+y+", client = "+(B||"(implicit) "+z(this)));var Y=S.default.fromData(U);Y.action=I,y&&(Y.id=y),B&&(Y.clientId=B),S.default.encode(Y,X.channelOptions,function(D){if(D){K(D);return}switch(X.state){case"attached":X.sendPresence(Y,K);break;case"initialized":case"detached":X.attach();case"attaching":Q.pendingPresence.push({presence:Y,callback:K});break;default:D=new C.PartialErrorInfo("Unable to "+I+" presence channel while in "+X.state+" state",90001),D.code=90001,K(D)}})},A.prototype.leave=function(y,B){if(P(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,y,B)},A.prototype.leaveClient=function(y,B,U){if(!U)if(typeof B=="function")U=B,B=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"leaveClient",[y,B]);U=M}var I=this.channel;if(!I.connectionManager.activeState()){U==null||U(I.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+y);var K=S.default.fromData(B);switch(K.action="leave",y&&(K.clientId=y),I.state){case"attached":I.sendPresence(K,U);break;case"attaching":this.pendingPresence.push({presence:K,callback:U});break;case"initialized":case"failed":{var Q=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);U==null||U(Q);break}default:U==null||U(I.invalidStateError())}},A.prototype.get=function(y,B){var U=this,I=Array.prototype.slice.call(arguments);I.length==1&&typeof I[0]=="function"&&I.unshift(null),y=I[0],B=I[1];var K=!y||("waitForSync"in y?y.waitForSync:!0);if(!B){if(this.channel.realtime.options.promises)return c.promisify(this,"get",I);B=M}function Q(X){B(null,y?X.list(y):X.values())}if(this.channel.state==="suspended"){K?B(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):Q(this.members);return}j(this.channel,B,function(){var X=U.members;K?X.waitSync(function(){Q(X)}):Q(X)})},A.prototype.history=function(y,B){if(m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"history",arguments);B=M}y&&y.untilAttach&&(this.channel.state==="attached"?(delete y.untilAttach,y.from_serial=this.channel.properties.attachSerial):B(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),d.default.prototype._history.call(this,y,B)},A.prototype.setPresence=function(y,B,U){m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+y.length+" participants; syncChannelSerial = "+U);var I,K,Q=this.members,X=this._myMembers,Y=[],D=this.channel.connectionManager.connectionId;B&&(this.members.startSync(),U&&(K=U.match(/^[\w-]+:(.*)$/))&&(I=K[1]));for(var H=0;H<y.length;H++){var F=S.default.fromValues(y[H]);switch(F.action){case"leave":Q.remove(F)&&Y.push(F),F.connectionId===D&&!F.isSynthesized()&&X.remove(F);break;case"enter":case"present":case"update":Q.put(F)&&Y.push(F),F.connectionId===D&&X.put(F);break}}B&&!I&&(Q.endSync(),this.channel.syncChannelSerial=null);for(var H=0;H<Y.length;H++){var F=Y[H];this.subscriptions.emit(F.action,F)}},A.prototype.onAttached=function(y){m.default.logAction(m.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+y),y?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var B=this.pendingPresence,U=B.length;if(U){this.pendingPresence=[];var I=[],K=R.default.create();m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+U+" queued presence messages");for(var Q=0;Q<U;Q++){var X=B[Q];I.push(X.presence),K.push(X.callback)}this.channel.sendPresence(I,K)}},A.prototype.actOnChannelState=function(y,B,U){switch(y){case"attached":this.onAttached(B);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(U);break}},A.prototype.failPendingPresence=function(y){if(this.pendingPresence.length){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+c.inspectError(y));for(var B=0;B<this.pendingPresence.length;B++)try{this.pendingPresence[B].callback(y)}catch{}this.pendingPresence=[]}},A.prototype._clearMyMembers=function(){this._myMembers.clear()},A.prototype._ensureMyMembersPresent=function(){var y=this,B=this._myMembers,U=function(Q){if(Q){var X="Presence auto-re-enter failed: "+Q.toString(),Y=new C.default(X,91004,400);m.default.logAction(m.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",X);var D=new v.default(y.channel.state,y.channel.state,!0,!1,Y);y.channel.emit("update",D)}};for(var I in B.map){var K=B.map[I];m.default.logAction(m.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+K.clientId+'" into the presence set'),this._enterOrUpdateClient(K.id,K.clientId,K.data,"enter",U)}},A.prototype._synthesizeLeaves=function(y){var B=this.subscriptions;c.arrForEach(y,function(U){var I=S.default.fromValues({action:"leave",connectionId:U.connectionId,clientId:U.clientId,data:U.data,encoding:U.encoding,timestamp:c.now()});B.emit("leave",I)})},A.prototype.on=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,y)},A.prototype.off=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,y)},A.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=E.default.processListenerArgs(y),I=U[0],K=U[1],Q=U[2],X=this.channel;if(!Q){if(this.channel.realtime.options.promises)return c.promisify(this,"subscribe",[I,K]);Q=M}if(X.state==="failed"){Q(C.default.fromValues(X.invalidStateError()));return}this.subscriptions.on(I,K),X.attach(Q)},A.prototype.unsubscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=E.default.processListenerArgs(y),I=U[0],K=U[1];this.subscriptions.off(I,K)},A})(d.default),O=(function(T){l.__extends(A,T);function A(y,B){var U=T.call(this)||this;return U.presence=y,U.map=Object.create(null),U.syncInProgress=!1,U.residualMembers=null,U.memberKey=B,U}return A.prototype.get=function(y){return this.map[y]},A.prototype.getClient=function(y){var B=this.map,U=[];for(var I in B){var K=B[I];K.clientId==y&&K.action!="absent"&&U.push(K)}return U},A.prototype.list=function(y){var B=this.map,U=y&&y.clientId,I=y&&y.connectionId,K=[];for(var Q in B){var X=B[Q];X.action!=="absent"&&(U&&U!=X.clientId||I&&I!=X.connectionId||K.push(X))}return K},A.prototype.put=function(y){(y.action==="enter"||y.action==="update")&&(y=S.default.fromValues(y),y.action="present");var B=this.map,U=this.memberKey(y);this.residualMembers&&delete this.residualMembers[U];var I=B[U];return I&&!x(y,I)?!1:(B[U]=y,!0)},A.prototype.values=function(){var y=this.map,B=[];for(var U in y){var I=y[U];I.action!="absent"&&B.push(I)}return B},A.prototype.remove=function(y){var B=this.map,U=this.memberKey(y),I=B[U];return I&&!x(y,I)?!1:(this.syncInProgress?(y=S.default.fromValues(y),y.action="absent",B[U]=y):delete B[U],!0)},A.prototype.startSync=function(){var y=this.map,B=this.syncInProgress;m.default.logAction(m.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),this.syncInProgress||(this.residualMembers=c.copy(y),this.setInProgress(!0))},A.prototype.endSync=function(){var y=this.map,B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),B){for(var U in y){var I=y[U];I.action==="absent"&&delete y[U]}this.presence._synthesizeLeaves(c.valuesArray(this.residualMembers));for(var U in this.residualMembers)delete y[U];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},A.prototype.waitSync=function(y){var B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),!B){y();return}this.once("sync",y)},A.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},A.prototype.setInProgress=function(y){m.default.logAction(m.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+y),this.syncInProgress=y,this.presence.syncComplete=!y},A})(g.default);a.default=L}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=r(56),d=r(31),g=r(11),m=l.__importDefault(r(5)),S=l.__importDefault(r(3)),C=(function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(R){return R!=null&&R.sigBytes!==void 0},E.prototype.isArrayBuffer=function(R){return R!=null&&R.constructor===ArrayBuffer},E.prototype.isTypedArray=function(R){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(R)},E.prototype.uint8ViewToBase64=function(R){for(var v="",M=this.base64CharSet,z=R.byteLength,P=z%3,j=z-P,x,L,O,T,A,y=0;y<j;y=y+3)A=R[y]<<16|R[y+1]<<8|R[y+2],x=(A&16515072)>>18,L=(A&258048)>>12,O=(A&4032)>>6,T=A&63,v+=M[x]+M[L]+M[O]+M[T];return P==1?(A=R[j],x=(A&252)>>2,L=(A&3)<<4,v+=M[x]+M[L]+"=="):P==2&&(A=R[j]<<8|R[j+1],x=(A&64512)>>10,L=(A&1008)>>4,O=(A&15)<<2,v+=M[x]+M[L]+M[O]+"="),v},E.prototype.base64ToArrayBuffer=function(R){for(var v=atob==null?void 0:atob(R),M=v.length,z=new Uint8Array(M),P=0;P<M;P++){var j=v.charCodeAt(P);z[P]=j}return z.buffer},E.prototype.isBuffer=function(R){return this.isArrayBuffer(R)||this.isWordArray(R)||this.isTypedArray(R)},E.prototype.toBuffer=function(R){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(R))return new Uint8Array(R);if(this.isTypedArray(R))return new Uint8Array(R.buffer);if(this.isWordArray(R)){for(var v=new ArrayBuffer(R.sigBytes),M=new Uint8Array(v),z=0;z<R.sigBytes;z++)M[z]=R.words[z>>>2]>>>24-z%4*8&255;return M}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(R){return this.isArrayBuffer(R)?R:this.toBuffer(R).buffer},E.prototype.toWordArray=function(R){return this.isTypedArray(R)&&(R=R.buffer),this.isWordArray(R)?R:m.default.create(R)},E.prototype.base64Encode=function(R){return this.isWordArray(R)?(0,g.stringify)(R):this.uint8ViewToBase64(this.toBuffer(R))},E.prototype.base64Decode=function(R){return ArrayBuffer&&S.default.Config.atob?this.base64ToArrayBuffer(R):(0,g.parse)(R)},E.prototype.hexEncode=function(R){return(0,c.stringify)(this.toWordArray(R))},E.prototype.hexDecode=function(R){var v=(0,c.parse)(R);return ArrayBuffer?this.toArrayBuffer(v):v},E.prototype.utf8Encode=function(R){return S.default.Config.TextEncoder?new S.default.Config.TextEncoder().encode(R).buffer:(0,d.parse)(R)},E.prototype.utf8Decode=function(R){if(!this.isBuffer(R))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(R)?new TextDecoder().decode(R):(R=this.toWordArray(R),(0,d.stringify)(R))},E.prototype.bufferCompare=function(R,v){if(!R)return-1;if(!v)return 1;var M=this.toWordArray(R),z=this.toWordArray(v);M.clamp(),z.clamp();var P=M.sigBytes-z.sigBytes;if(P!=0)return P;for(var j=M.words,x=z.words,L=0;L<j.length;L++)if(P=j[L]-x[L],P!=0)return P;return 0},E.prototype.byteLength=function(R){return this.isArrayBuffer(R)||this.isTypedArray(R)?R.byteLength:this.isWordArray(R)?R.sigBytes:-1},E.prototype.typedArrayToBuffer=function(R){return R.buffer},E})();a.default=new C}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return l.enc.Hex})}),(function(n,a,r){r.r(a);var l=r(5),c=r.n(l),d=r(11),g=r(23),m=r.n(g),S=r(2),C=r.n(S),E=r(4),R=r.n(E),v=function(M,z){var P="aes",j=256,x="cbc",L=16,O=4,T=4294967296,A=2147483648,y;if(M.getRandomWordArray)y=M.getRandomWordArray;else if(typeof Uint32Array<"u"&&M.getRandomValues){var B=new Uint32Array(O);y=function(H,F){var tt=H/4,at=tt==O?B:new Uint32Array(tt);M.getRandomValues(at,function(Z){typeof F<"u"&&F(Z,z.toWordArray(at))})}}else y=function(H,F){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var tt=H/4,at=new Array(tt),Z=0;Z<tt;Z++)at[Z]=Math.floor(Math.random()*T)-A;F(null,c.a.create(at))};function U(H){return H+L&-L}function I(H){if(H.algorithm==="aes"&&H.mode==="cbc"){if(H.keyLength===128||H.keyLength===256)return;throw new Error("Unsupported key length "+H.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function K(H){return H.replace("_","/").replace("-","+")}var Q=[c.a.create([269488144,269488144,269488144,269488144],16),c.a.create([16777216],1),c.a.create([33685504],2),c.a.create([50529024],3),c.a.create([67372036],4),c.a.create([84215045,83886080],5),c.a.create([101058054,101056512],6),c.a.create([117901063,117901056],7),c.a.create([134744072,134744072],8),c.a.create([151587081,151587081,150994944],9),c.a.create([168430090,168430090,168427520],10),c.a.create([185273099,185273099,185273088],11),c.a.create([202116108,202116108,202116108],12),c.a.create([218959117,218959117,218959117,218103808],13),c.a.create([235802126,235802126,235802126,235798528],14),c.a.create([252645135,252645135,252645135,252645135],15),c.a.create([269488144,269488144,269488144,269488144],16)];function X(){}function Y(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}X.CipherParams=Y,X.getDefaultParams=function(H){var F;if(typeof H=="function"||typeof H=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof H=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),X.generateRandomKey(function(at){H(null,X.getDefaultParams({key:at}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,X.getDefaultParams({key:H}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!H.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof H.key=="string"?F=Object(d.parse)(K(H.key)):F=z.toWordArray(H.key);var tt=new Y;if(tt.key=F,tt.algorithm=H.algorithm||P,tt.keyLength=F.words.length*32,tt.mode=H.mode||x,H.keyLength&&H.keyLength!==tt.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+H.keyLength+" was specified, but the key actually has length "+tt.keyLength);return I(tt),tt},X.generateRandomKey=function(H,F){arguments.length==1&&typeof H=="function"&&(F=H,H=void 0),y((H||j)/8,function(tt,at){F!==void 0&&F(tt?R.a.fromValues(tt):null,at)})},X.getCipher=function(H){var F=H instanceof Y?H:X.getDefaultParams(H);return{cipherParams:F,cipher:new D(F,O,H.iv)}};function D(H,F,tt){this.algorithm=H.algorithm+"-"+String(H.keyLength)+"-"+H.mode,this.cjsAlgorithm=H.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=z.toWordArray(H.key),tt&&(this.iv=z.toWordArray(tt).clone()),this.blockLengthWords=F}return D.prototype.encrypt=function(H,F){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),H=z.toWordArray(H);var tt=H.sigBytes,at=U(tt),Z=this,it=function(){Z.getIv(function(st,V){if(st){F(st);return}var J=Z.encryptCipher.process(H.concat(Q[at-tt])),W=V.concat(J);F(null,W)})};this.encryptCipher?it():this.iv?(this.encryptCipher=m.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),it()):y(L,function(st,V){if(st){F(st);return}Z.encryptCipher=m.a.algo[Z.cjsAlgorithm].createEncryptor(Z.key,{iv:V}),Z.iv=V,it()})},D.prototype.decrypt=function(H){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),H=z.toWordArray(H);var F=this.blockLengthWords,tt=H.words,at=c.a.create(tt.slice(0,F)),Z=c.a.create(tt.slice(F)),it=m.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:at}),st=it.process(Z),V=it.finalize();return it.reset(),V&&V.sigBytes&&st.concat(V),st},D.prototype.getIv=function(H){if(this.iv){var F=this.iv;this.iv=null,H(null,F);return}var tt=this;y(L,function(at,Z){if(at){H(at);return}H(null,tt.encryptCipher.process(Z))})},X};a.default=v}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=c.enc;m.Utf16=m.Utf16BE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],M=0;M<R;M+=2){var z=E[M>>>2]>>>16-M%4*8&65535;v.push(String.fromCharCode(z))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=C.charCodeAt(v)<<16-v%2*16;return g.create(R,E*2)}},m.Utf16LE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],M=0;M<R;M+=2){var z=S(E[M>>>2]>>>16-M%4*8&65535);v.push(String.fromCharCode(z))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=S(C.charCodeAt(v)<<16-v%2*16);return g.create(R,E*2)}};function S(C){return C<<8&4278255360|C>>>8&16711935}})(),l.enc.Utf16})}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(28))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.CipherParams,S=d.enc,C=S.Hex,E=d.format;E.Hex={stringify:function(R){return R.ciphertext.toString(C)},parse:function(R){var v=C.parse(R);return m.create({ciphertext:v})}}})(),l.format.Hex})}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(11),r(61),r(27),r(28))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.BlockCipher,m=c.algo,S=[],C=[],E=[],R=[],v=[],M=[],z=[],P=[],j=[],x=[];(function(){for(var T=[],A=0;A<256;A++)A<128?T[A]=A<<1:T[A]=A<<1^283;for(var y=0,B=0,A=0;A<256;A++){var U=B^B<<1^B<<2^B<<3^B<<4;U=U>>>8^U&255^99,S[y]=U,C[U]=y;var I=T[y],K=T[I],Q=T[K],X=T[U]*257^U*16843008;E[y]=X<<24|X>>>8,R[y]=X<<16|X>>>16,v[y]=X<<8|X>>>24,M[y]=X;var X=Q*16843009^K*65537^I*257^y*16843008;z[U]=X<<24|X>>>8,P[U]=X<<16|X>>>16,j[U]=X<<8|X>>>24,x[U]=X,y?(y=I^T[T[T[Q^I]]],B^=T[T[B]]):y=B=1}})();var L=[0,1,2,4,8,16,32,64,128,27,54],O=m.AES=g.extend({_doReset:function(){var T;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var A=this._keyPriorReset=this._key,y=A.words,B=A.sigBytes/4,U=this._nRounds=B+6,I=(U+1)*4,K=this._keySchedule=[],Q=0;Q<I;Q++)Q<B?K[Q]=y[Q]:(T=K[Q-1],Q%B?B>6&&Q%B==4&&(T=S[T>>>24]<<24|S[T>>>16&255]<<16|S[T>>>8&255]<<8|S[T&255]):(T=T<<8|T>>>24,T=S[T>>>24]<<24|S[T>>>16&255]<<16|S[T>>>8&255]<<8|S[T&255],T^=L[Q/B|0]<<24),K[Q]=K[Q-B]^T);for(var X=this._invKeySchedule=[],Y=0;Y<I;Y++){var Q=I-Y;if(Y%4)var T=K[Q];else var T=K[Q-4];Y<4||Q<=4?X[Y]=T:X[Y]=z[S[T>>>24]]^P[S[T>>>16&255]]^j[S[T>>>8&255]]^x[S[T&255]]}}},encryptBlock:function(T,A){this._doCryptBlock(T,A,this._keySchedule,E,R,v,M,S)},decryptBlock:function(T,A){var y=T[A+1];T[A+1]=T[A+3],T[A+3]=y,this._doCryptBlock(T,A,this._invKeySchedule,z,P,j,x,C);var y=T[A+1];T[A+1]=T[A+3],T[A+3]=y},_doCryptBlock:function(T,A,y,B,U,I,K,Q){for(var X=this._nRounds,Y=T[A]^y[0],D=T[A+1]^y[1],H=T[A+2]^y[2],F=T[A+3]^y[3],tt=4,at=1;at<X;at++){var Z=B[Y>>>24]^U[D>>>16&255]^I[H>>>8&255]^K[F&255]^y[tt++],it=B[D>>>24]^U[H>>>16&255]^I[F>>>8&255]^K[Y&255]^y[tt++],st=B[H>>>24]^U[F>>>16&255]^I[Y>>>8&255]^K[D&255]^y[tt++],V=B[F>>>24]^U[Y>>>16&255]^I[D>>>8&255]^K[H&255]^y[tt++];Y=Z,D=it,H=st,F=V}var Z=(Q[Y>>>24]<<24|Q[D>>>16&255]<<16|Q[H>>>8&255]<<8|Q[F&255])^y[tt++],it=(Q[D>>>24]<<24|Q[H>>>16&255]<<16|Q[F>>>8&255]<<8|Q[Y&255])^y[tt++],st=(Q[H>>>24]<<24|Q[F>>>16&255]<<16|Q[Y>>>8&255]<<8|Q[D&255])^y[tt++],V=(Q[F>>>24]<<24|Q[Y>>>16&255]<<16|Q[D>>>8&255]<<8|Q[H&255])^y[tt++];T[A]=Z,T[A+1]=it,T[A+2]=st,T[A+3]=V},keySize:256/32});c.AES=g._createHelper(O)})(),l.AES})}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.WordArray,S=g.Hasher,C=d.algo,E=[];(function(){for(var j=0;j<64;j++)E[j]=c.abs(c.sin(j+1))*4294967296|0})();var R=C.MD5=S.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(j,x){for(var L=0;L<16;L++){var O=x+L,T=j[O];j[O]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var A=this._hash.words,y=j[x+0],B=j[x+1],U=j[x+2],I=j[x+3],K=j[x+4],Q=j[x+5],X=j[x+6],Y=j[x+7],D=j[x+8],H=j[x+9],F=j[x+10],tt=j[x+11],at=j[x+12],Z=j[x+13],it=j[x+14],st=j[x+15],V=A[0],J=A[1],W=A[2],nt=A[3];V=v(V,J,W,nt,y,7,E[0]),nt=v(nt,V,J,W,B,12,E[1]),W=v(W,nt,V,J,U,17,E[2]),J=v(J,W,nt,V,I,22,E[3]),V=v(V,J,W,nt,K,7,E[4]),nt=v(nt,V,J,W,Q,12,E[5]),W=v(W,nt,V,J,X,17,E[6]),J=v(J,W,nt,V,Y,22,E[7]),V=v(V,J,W,nt,D,7,E[8]),nt=v(nt,V,J,W,H,12,E[9]),W=v(W,nt,V,J,F,17,E[10]),J=v(J,W,nt,V,tt,22,E[11]),V=v(V,J,W,nt,at,7,E[12]),nt=v(nt,V,J,W,Z,12,E[13]),W=v(W,nt,V,J,it,17,E[14]),J=v(J,W,nt,V,st,22,E[15]),V=M(V,J,W,nt,B,5,E[16]),nt=M(nt,V,J,W,X,9,E[17]),W=M(W,nt,V,J,tt,14,E[18]),J=M(J,W,nt,V,y,20,E[19]),V=M(V,J,W,nt,Q,5,E[20]),nt=M(nt,V,J,W,F,9,E[21]),W=M(W,nt,V,J,st,14,E[22]),J=M(J,W,nt,V,K,20,E[23]),V=M(V,J,W,nt,H,5,E[24]),nt=M(nt,V,J,W,it,9,E[25]),W=M(W,nt,V,J,I,14,E[26]),J=M(J,W,nt,V,D,20,E[27]),V=M(V,J,W,nt,Z,5,E[28]),nt=M(nt,V,J,W,U,9,E[29]),W=M(W,nt,V,J,Y,14,E[30]),J=M(J,W,nt,V,at,20,E[31]),V=z(V,J,W,nt,Q,4,E[32]),nt=z(nt,V,J,W,D,11,E[33]),W=z(W,nt,V,J,tt,16,E[34]),J=z(J,W,nt,V,it,23,E[35]),V=z(V,J,W,nt,B,4,E[36]),nt=z(nt,V,J,W,K,11,E[37]),W=z(W,nt,V,J,Y,16,E[38]),J=z(J,W,nt,V,F,23,E[39]),V=z(V,J,W,nt,Z,4,E[40]),nt=z(nt,V,J,W,y,11,E[41]),W=z(W,nt,V,J,I,16,E[42]),J=z(J,W,nt,V,X,23,E[43]),V=z(V,J,W,nt,H,4,E[44]),nt=z(nt,V,J,W,at,11,E[45]),W=z(W,nt,V,J,st,16,E[46]),J=z(J,W,nt,V,U,23,E[47]),V=P(V,J,W,nt,y,6,E[48]),nt=P(nt,V,J,W,Y,10,E[49]),W=P(W,nt,V,J,it,15,E[50]),J=P(J,W,nt,V,Q,21,E[51]),V=P(V,J,W,nt,at,6,E[52]),nt=P(nt,V,J,W,I,10,E[53]),W=P(W,nt,V,J,F,15,E[54]),J=P(J,W,nt,V,B,21,E[55]),V=P(V,J,W,nt,D,6,E[56]),nt=P(nt,V,J,W,st,10,E[57]),W=P(W,nt,V,J,X,15,E[58]),J=P(J,W,nt,V,Z,21,E[59]),V=P(V,J,W,nt,K,6,E[60]),nt=P(nt,V,J,W,tt,10,E[61]),W=P(W,nt,V,J,U,15,E[62]),J=P(J,W,nt,V,H,21,E[63]),A[0]=A[0]+V|0,A[1]=A[1]+J|0,A[2]=A[2]+W|0,A[3]=A[3]+nt|0},_doFinalize:function(){var j=this._data,x=j.words,L=this._nDataBytes*8,O=j.sigBytes*8;x[O>>>5]|=128<<24-O%32;var T=c.floor(L/4294967296),A=L;x[(O+64>>>9<<4)+15]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,x[(O+64>>>9<<4)+14]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,j.sigBytes=(x.length+1)*4,this._process();for(var y=this._hash,B=y.words,U=0;U<4;U++){var I=B[U];B[U]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}return y},clone:function(){var j=S.clone.call(this);return j._hash=this._hash.clone(),j}});function v(j,x,L,O,T,A,y){var B=j+(x&L|~x&O)+T+y;return(B<<A|B>>>32-A)+x}function M(j,x,L,O,T,A,y){var B=j+(x&O|L&~O)+T+y;return(B<<A|B>>>32-A)+x}function z(j,x,L,O,T,A,y){var B=j+(x^L^O)+T+y;return(B<<A|B>>>32-A)+x}function P(j,x,L,O,T,A,y){var B=j+(L^(x|~O))+T+y;return(B<<A|B>>>32-A)+x}d.MD5=S._createHelper(R),d.HmacMD5=S._createHmacHelper(R)})(Math),l.MD5})}),(function(n,a,r){var l;Object.defineProperty(a,"__esModule",{value:!0});var c=r(0),d=c.__importDefault(r(3)),g=c.__importStar(r(1)),m=c.__importDefault(r(8)),S=r(4),C=c.__importDefault(r(19)),E=c.__importDefault(r(17)),R=c.__importDefault(r(22)),v=c.__importDefault(r(2)),M=r(29),z=c.__importDefault(r(63)),P=r(14);function j(O){var T=O.statusCode;return T===408&&!O.code||T===400&&!O.code||T>=500&&T<=504}function x(O){var T=O.connection,A=T&&T.connectionManager.host;return A?[A].concat(m.default.getFallbackHosts(O.options)):m.default.getHosts(O.options)}var L=(l=(function(){function O(T){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=x,this.options=T||{};var A=this.options.connectivityCheckUrl||m.default.connectivityCheckUrl,y=this.options.connectivityCheckParams,B=!this.options.connectivityCheckUrl;d.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(U,I,K,Q,X,Y,D){var H=E.default.createRequest(K,Q,X,Y,R.default.REQ_SEND,I&&I.options.timeouts,U);return H.once("complete",D),H.exec(),H},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+A),this.doUri(C.default.Get,null,A,null,null,y,function(I,K,Q,X,Y){var D=!1;B?D=!I&&(K==null?void 0:K.replace(/\n/,""))=="yes":D=!I&&(0,P.isSuccessCode)(Y),v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+D),U(null,D)})}):d.default.Config.jsonpSupported?(this.Request=function(U,I,K,Q,X,Y,D){var H=(0,M.createRequest)(K,Q,X,Y,R.default.REQ_SEND,I&&I.options.timeouts,U);return H.once("complete",D),d.default.Config.nextTick(function(){H.exec()}),H},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){var I=this,K=m.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(U);return}this.checksInProgress=[U],v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+K);var Q=new M.Request("isTheInternetUp",K,null,null,null,R.default.REQ_SEND,m.default.TIMEOUTS);Q.once("complete",function(X,Y){var D=!X&&Y;v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+D);for(var H=0;H<I.checksInProgress.length;H++)I.checksInProgress[H](null,D);I.checksInProgress=null}),d.default.Config.nextTick(function(){Q.exec()})}):d.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=z.default,this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+A),this.doUri(C.default.Get,null,A,null,null,null,function(I,K){var Q=!I&&(K==null?void 0:K.replace(/\n/,""))=="yes";v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+Q),U(null,Q)})}):this.Request=function(U,I,K,Q,X,Y,D){D(new S.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return O.prototype.do=function(T,A,y,B,U,I,K){var Q=this,X=typeof y=="function"?y:function(F){return A.baseUri(F)+y},Y=A._currentFallback;if(Y)if(Y.validUntil>g.now()){if(!this.Request){K==null||K(new S.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(T,A,X(Y.host),B,I,U,function(F){for(var tt=[],at=1;at<arguments.length;at++)tt[at-1]=arguments[at];if(F&&j(F)){A._currentFallback=null,Q.do(T,A,y,B,U,I,K);return}K==null||K.apply(void 0,c.__spreadArray([F],tt,!1))});return}else A._currentFallback=null;var D=x(A);if(D.length===1){this.doUri(T,A,X(D[0]),B,U,I,K);return}var H=function(F,tt){var at=F.shift();Q.doUri(T,A,X(at),B,U,I,function(Z){for(var it=[],st=1;st<arguments.length;st++)it[st-1]=arguments[st];if(Z&&j(Z)&&F.length){H(F,!0);return}tt&&(A._currentFallback={host:at,validUntil:g.now()+A.options.timeouts.fallbackRetryTimeout}),K==null||K.apply(void 0,c.__spreadArray([Z],it,!1))})};H(D)},O.prototype.doUri=function(T,A,y,B,U,I,K){if(!this.Request){K(new S.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(T,A,y,B,I,U,K)},O})(),l.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],l.methodsWithoutBody=[C.default.Get,C.default.Delete],l.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],l);a.default=L}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(4)),d=l.__importDefault(r(3)),g=l.__importDefault(r(8)),m=l.__importStar(r(1)),S=r(1);function C(v,M){return!!M.get("x-ably-errorcode")}function E(v,M){if(C(v,M))return v.error&&c.default.fromValues(v.error)}function R(v,M,z,P,j,x,L){var O=new Headers(P||{}),T=v?v.toUpperCase():m.isEmptyArg(x)?"GET":"POST",A=new AbortController,y=setTimeout(function(){A.abort(),L(new c.PartialErrorInfo("Request timed out",null,408))},M?M.options.timeouts.httpRequestTimeout:g.default.TIMEOUTS.httpRequestTimeout),B={method:T,headers:O,body:x};d.default.Config.isWebworker||(B.credentials=O.has("authorization")?"include":"same-origin"),(0,S.getGlobalObject)().fetch(z+"?"+new URLSearchParams(j||{}),B).then(function(U){clearTimeout(y);var I=U.headers.get("Content-Type"),K;I&&I.indexOf("application/x-msgpack")>-1?K=U.arrayBuffer():I&&I.indexOf("application/json")>-1?K=U.json():K=U.text(),K.then(function(Q){var X=!!I&&I.indexOf("application/x-msgpack")===-1;if(U.ok)L(null,Q,U.headers,X,U.status);else{var Y=E(Q,U.headers)||new c.PartialErrorInfo("Error response received from server: "+U.status+" body was: "+d.default.Config.inspect(Q),null,U.status);L(Y,Q,U.headers,X,U.status)}})}).catch(function(U){clearTimeout(y),L(U)})}a.default=R}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(41)),d=l.__importStar(r(1)),g=d.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function m(){var R=g.location;return!g.WebSocket||!R||!R.origin||R.origin.indexOf("http")>-1}var S=g.navigator&&g.navigator.userAgent.toString(),C=g.location&&g.location.href,E={agent:"browser",logTimestamps:!0,userAgent:S,currentUrl:C,noUpgrade:S&&!!S.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:g.WebSocket,fetchSupported:!!g.fetch,xhrSupported:g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:m(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:c.default,supportsBinary:!!g.TextDecoder,preferBinary:!1,ArrayBuffer:g.ArrayBuffer,atob:g.atob,nextTick:typeof g.setImmediate<"u"?g.setImmediate.bind(g):function(R){setTimeout(R,0)},addEventListener:g.addEventListener,inspect:JSON.stringify,stringByteSize:function(R){return g.TextDecoder&&new g.TextEncoder().encode(R).length||R.length},TextEncoder:g.TextEncoder,TextDecoder:g.TextDecoder,Promise:g.Promise,getRandomValues:(function(R){if(R!==void 0)return function(v,M){R.getRandomValues(v),M&&M(null)}})(g.crypto||msCrypto)};a.default=E}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var c=r(0),d=c.__importStar(r(1)),g="ablyjs-storage-test",m=(function(){function S(){try{l.sessionStorage.setItem(g,g),l.sessionStorage.removeItem(g),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{l.localStorage.setItem(g,g),l.localStorage.removeItem(g),this.localSupported=!0}catch{this.localSupported=!1}}return S.prototype.get=function(C){return this._get(C,!1)},S.prototype.getSession=function(C){return this._get(C,!0)},S.prototype.remove=function(C){return this._remove(C,!1)},S.prototype.removeSession=function(C){return this._remove(C,!0)},S.prototype.set=function(C,E,R){return this._set(C,E,R,!1)},S.prototype.setSession=function(C,E,R){return this._set(C,E,R,!0)},S.prototype._set=function(C,E,R,v){var M={value:E};return R&&(M.expires=d.now()+R),this.storageInterface(v).setItem(C,JSON.stringify(M))},S.prototype._get=function(C,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var R=this.storageInterface(E).getItem(C);if(!R)return null;var v=JSON.parse(R);return v.expires&&v.expires<d.now()?(this.storageInterface(E).removeItem(C),null):v.value},S.prototype._remove=function(C,E){return this.storageInterface(E).removeItem(C)},S.prototype.storageInterface=function(C){return C?l.sessionStorage:l.localStorage},S})();a.default=new m}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(67)),d={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],baseTransportOrder:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],transportPreferenceOrder:[c.default.JsonP,c.default.XhrPolling,c.default.XhrStreaming,c.default.WebSocket],upgradeTransports:[c.default.XhrStreaming,c.default.WebSocket]};a.default=d}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(c){c.WebSocket="web_socket",c.Comet="comet",c.XhrStreaming="xhr_streaming",c.XhrPolling="xhr_polling",c.JsonP="jsonp"})(l||(l={})),a.default=l}),(function(n,a,r){r.r(a);var l=r(29),c=r.n(l),d=r(1),g=r(3),m=r.n(g),S=r(12),C=r.n(S),E=r(17),R=r.n(E),v=function(j){var x="xhr_polling";function L(O,T,A){A.stream=!1,C.a.call(this,O,T,A),this.shortName=x}return d.inherits(L,C.a),L.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.allowComet},L.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},L.prototype.createRequest=function(O,T,A,y,B){return R.a.createRequest(O,T,A,y,B,this.timeouts)},typeof j<"u"&&L.isAvailable()&&(j.supportedTransports[x]=L),L},M=v,z=function(j){var x="xhr_streaming";function L(O,T,A){C.a.call(this,O,T,A),this.shortName=x}return d.inherits(L,C.a),L.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.streamingSupported&&m.a.Config.allowComet},L.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},L.prototype.createRequest=function(O,T,A,y,B){return R.a.createRequest(O,T,A,y,B,this.timeouts)},typeof j<"u"&&L.isAvailable()&&(j.supportedTransports[x]=L),L},P=z;a.default=[c.a,M,P]})]).default})})(Vp)),Vp.exports}var RS=wS(),Im=function(o,t){return Im=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(n[r]=a[r])},Im(o,t)};function OS(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Im(o,t);function n(){this.constructor=o}o.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var _g=function(){return _g=Object.assign||function(t){for(var n,a=1,r=arguments.length;a<r;a++){n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},_g.apply(this,arguments)};function Ef(o,t){var n={};for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&t.indexOf(a)<0&&(n[a]=o[a]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(o);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(o,a[r])&&(n[a[r]]=o[a[r]]);return n}function xS(o,t,n,a){var r=arguments.length,l=r<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,n):a,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,t,n,a);else for(var d=o.length-1;d>=0;d--)(c=o[d])&&(l=(r<3?c(l):r>3?c(t,n,l):c(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l}function NS(o,t){return function(n,a){t(n,a,o)}}function MS(o,t,n,a,r,l){function c(P){if(P!==void 0&&typeof P!="function")throw new TypeError("Function expected");return P}for(var d=a.kind,g=d==="getter"?"get":d==="setter"?"set":"value",m=!t&&o?a.static?o:o.prototype:null,S=t||(m?Object.getOwnPropertyDescriptor(m,a.name):{}),C,E=!1,R=n.length-1;R>=0;R--){var v={};for(var M in a)v[M]=M==="access"?{}:a[M];for(var M in a.access)v.access[M]=a.access[M];v.addInitializer=function(P){if(E)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(P||null))};var z=(0,n[R])(d==="accessor"?{get:S.get,set:S.set}:S[g],v);if(d==="accessor"){if(z===void 0)continue;if(z===null||typeof z!="object")throw new TypeError("Object expected");(C=c(z.get))&&(S.get=C),(C=c(z.set))&&(S.set=C),(C=c(z.init))&&r.unshift(C)}else(C=c(z))&&(d==="field"?r.unshift(C):S[g]=C)}m&&Object.defineProperty(m,a.name,S),E=!0}function DS(o,t,n){for(var a=arguments.length>2,r=0;r<t.length;r++)n=a?t[r].call(o,n):t[r].call(o);return a?n:void 0}function jS(o){return typeof o=="symbol"?o:"".concat(o)}function US(o,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function BS(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function ue(o,t,n,a){function r(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(S){try{m(a.next(S))}catch(C){c(C)}}function g(S){try{m(a.throw(S))}catch(C){c(C)}}function m(S){S.done?l(S.value):r(S.value).then(d,g)}m((a=a.apply(o,t||[])).next())})}function zS(o,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,r,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(m){return function(S){return g([m,S])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(n=0)),n;)try{if(a=1,r&&(l=m[0]&2?r.return:m[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,m[1])).done)return l;switch(r=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(o,n)}catch(S){m=[6,S],r=0}finally{a=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var zg=Object.create?(function(o,t,n,a){a===void 0&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(o,a,r)}):(function(o,t,n,a){a===void 0&&(a=n),o[a]=t[n]});function LS(o,t){for(var n in o)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&zg(t,o,n)}function Eg(o){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&o[t],a=0;if(n)return n.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&a>=o.length&&(o=void 0),{value:o&&o[a++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function uv(o,t){var n=typeof Symbol=="function"&&o[Symbol.iterator];if(!n)return o;var a=n.call(o),r,l=[],c;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)l.push(r.value)}catch(d){c={error:d}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(c)throw c.error}}return l}function PS(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(uv(arguments[t]));return o}function IS(){for(var o=0,t=0,n=arguments.length;t<n;t++)o+=arguments[t].length;for(var a=Array(o),r=0,t=0;t<n;t++)for(var l=arguments[t],c=0,d=l.length;c<d;c++,r++)a[r]=l[c];return a}function GS(o,t,n){if(n||arguments.length===2)for(var a=0,r=t.length,l;a<r;a++)(l||!(a in t))&&(l||(l=Array.prototype.slice.call(t,0,a)),l[a]=t[a]);return o.concat(l||Array.prototype.slice.call(t))}function pf(o){return this instanceof pf?(this.v=o,this):new pf(o)}function HS(o,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n.apply(o,t||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(R){return function(v){return Promise.resolve(v).then(R,C)}}function d(R,v){a[R]&&(r[R]=function(M){return new Promise(function(z,P){l.push([R,M,z,P])>1||g(R,M)})},v&&(r[R]=v(r[R])))}function g(R,v){try{m(a[R](v))}catch(M){E(l[0][3],M)}}function m(R){R.value instanceof pf?Promise.resolve(R.value.v).then(S,C):E(l[0][2],R)}function S(R){g("next",R)}function C(R){g("throw",R)}function E(R,v){R(v),l.shift(),l.length&&g(l[0][0],l[0][1])}}function kS(o){var t,n;return t={},a("next"),a("throw",function(r){throw r}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(r,l){t[r]=o[r]?function(c){return(n=!n)?{value:pf(o[r](c)),done:!1}:l?l(c):c}:l}}function qS(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],n;return t?t.call(o):(o=typeof Eg=="function"?Eg(o):o[Symbol.iterator](),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(l){n[l]=o[l]&&function(c){return new Promise(function(d,g){c=o[l](c),r(d,g,c.done,c.value)})}}function r(l,c,d,g){Promise.resolve(g).then(function(m){l({value:m,done:d})},c)}}function VS(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}var C8=Object.create?(function(o,t){Object.defineProperty(o,"default",{enumerable:!0,value:t})}):function(o,t){o.default=t},Gm=function(o){return Gm=Object.getOwnPropertyNames||function(t){var n=[];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[n.length]=a);return n},Gm(o)};function YS(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var n=Gm(o),a=0;a<n.length;a++)n[a]!=="default"&&zg(t,o,n[a]);return C8(t,o),t}function KS(o){return o&&o.__esModule?o:{default:o}}function QS(o,t,n,a){if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!a:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?a:n==="a"?a.call(o):a?a.value:t.get(o)}function XS(o,t,n,a,r){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!r:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?r.call(o,n):r?r.value=n:t.set(o,n),n}function FS(o,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?t===o:o.has(t)}function JS(o,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var a,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=t[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=t[Symbol.dispose],n&&(r=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");r&&(a=function(){try{r.call(this)}catch(l){return Promise.reject(l)}}),o.stack.push({value:t,dispose:a,async:n})}else n&&o.stack.push({async:!0});return t}var T8=typeof SuppressedError=="function"?SuppressedError:function(o,t,n){var a=new Error(n);return a.name="SuppressedError",a.error=o,a.suppressed=t,a};function ZS(o){function t(l){o.error=o.hasError?new T8(l,o.error,"An error was suppressed during disposal."):l,o.hasError=!0}var n,a=0;function r(){for(;n=o.stack.pop();)try{if(!n.async&&a===1)return a=0,o.stack.push(n),Promise.resolve().then(r);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return a|=2,Promise.resolve(l).then(r,function(c){return t(c),r()})}else a|=1}catch(c){t(c)}if(a===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return r()}function WS(o,t){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,a,r,l,c){return a?t?".jsx":".js":r&&(!l||!c)?n:r+l+"."+c.toLowerCase()+"js"}):o}const A8={__extends:OS,__assign:_g,__rest:Ef,__decorate:xS,__param:NS,__esDecorate:MS,__runInitializers:DS,__propKey:jS,__setFunctionName:US,__metadata:BS,__awaiter:ue,__generator:zS,__createBinding:zg,__exportStar:LS,__values:Eg,__read:uv,__spread:PS,__spreadArrays:IS,__spreadArray:GS,__await:pf,__asyncGenerator:HS,__asyncDelegator:kS,__asyncValues:qS,__makeTemplateObject:VS,__importStar:YS,__importDefault:KS,__classPrivateFieldGet:QS,__classPrivateFieldSet:XS,__classPrivateFieldIn:FS,__addDisposableResource:JS,__disposeResources:ZS,__rewriteRelativeImportExtension:WS},w8=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:JS,get __assign(){return _g},__asyncDelegator:kS,__asyncGenerator:HS,__asyncValues:qS,__await:pf,__awaiter:ue,__classPrivateFieldGet:QS,__classPrivateFieldIn:FS,__classPrivateFieldSet:XS,__createBinding:zg,__decorate:xS,__disposeResources:ZS,__esDecorate:MS,__exportStar:LS,__extends:OS,__generator:zS,__importDefault:KS,__importStar:YS,__makeTemplateObject:VS,__metadata:BS,__param:NS,__propKey:jS,__read:uv,__rest:Ef,__rewriteRelativeImportExtension:WS,__runInitializers:DS,__setFunctionName:US,__spread:PS,__spreadArray:GS,__spreadArrays:IS,__values:Eg,default:A8},Symbol.toStringTag,{value:"Module"})),R8="modulepreload",O8=function(o){return"/"+o},h1={},xu=function(t,n,a){let r=Promise.resolve();if(n&&n.length>0){let c=function(m){return Promise.all(m.map(S=>Promise.resolve(S).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=c(n.map(m=>{if(m=O8(m),m in h1)return;h1[m]=!0;const S=m.endsWith(".css"),C=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${C}`))return;const E=document.createElement("link");if(E.rel=S?"stylesheet":R8,S||(E.as="script"),E.crossOrigin="",E.href=m,g&&E.setAttribute("nonce",g),document.head.appendChild(E),S)return new Promise((R,v)=>{E.addEventListener("load",R),E.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return r.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return t().catch(l)})},x8=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>xu(async()=>{const{default:a}=await Promise.resolve().then(()=>Nu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)};class cv extends Error{constructor(t,n="FunctionsError",a){super(t),this.name=n,this.context=a}}class g1 extends cv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class p1 extends cv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class m1 extends cv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Hm;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Hm||(Hm={}));class N8{constructor(t,{headers:n={},customFetch:a,region:r=Hm.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=x8(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return ue(this,arguments,void 0,function*(n,a={}){var r;try{const{headers:l,method:c,body:d,signal:g}=a;let m={},{region:S}=a;S||(S=this.region);const C=new URL(`${this.url}/${n}`);S&&S!=="any"&&(m["x-region"]=S,C.searchParams.set("forceFunctionRegion",S));let E;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=d):typeof d=="string"?(m["Content-Type"]="text/plain",E=d):typeof FormData<"u"&&d instanceof FormData?E=d:(m["Content-Type"]="application/json",E=JSON.stringify(d)):E=d;const R=yield this.fetch(C.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),l),body:E,signal:g}).catch(P=>{throw P.name==="AbortError"?P:new g1(P)}),v=R.headers.get("x-relay-error");if(v&&v==="true")throw new p1(R);if(!R.ok)throw new m1(R);let M=((r=R.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),z;return M==="application/json"?z=yield R.json():M==="application/octet-stream"||M==="application/pdf"?z=yield R.blob():M==="text/event-stream"?z=R:M==="multipart/form-data"?z=yield R.formData():z=yield R.text(),{data:z,error:null,response:R}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new g1(l)}:{data:null,error:l,response:l instanceof m1||l instanceof p1?l.context:void 0}}})}}var hi={};const Cf=x2(w8);var ag={},ig={},rg={},sg={},og={},M8=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},mf=M8();const D8=mf.fetch,$S=mf.fetch.bind(mf),tb=mf.Headers,j8=mf.Request,U8=mf.Response,Nu=Object.freeze(Object.defineProperty({__proto__:null,Headers:tb,Request:j8,Response:U8,default:$S,fetch:D8},Symbol.toStringTag,{value:"Module"})),B8=x2(Nu);var lg={},v1;function eb(){if(v1)return lg;v1=1,Object.defineProperty(lg,"__esModule",{value:!0});class o extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return lg.default=o,lg}var y1;function nb(){if(y1)return og;y1=1,Object.defineProperty(og,"__esModule",{value:!0});const o=Cf,t=o.__importDefault(B8),n=o.__importDefault(eb());class a{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let g=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var S,C,E,R;let v=null,M=null,z=null,P=m.status,j=m.statusText;if(m.ok){if(this.method!=="HEAD"){const T=await m.text();T===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((S=this.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?M=T:M=JSON.parse(T))}const L=(C=this.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),O=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");L&&O&&O.length>1&&(z=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(M)&&(M.length>1?(v={code:"PGRST116",details:`Results contain ${M.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},M=null,z=null,P=406,j="Not Acceptable"):M.length===1?M=M[0]:M=null)}else{const L=await m.text();try{v=JSON.parse(L),Array.isArray(v)&&m.status===404&&(M=[],v=null,P=200,j="OK")}catch{m.status===404&&L===""?(P=204,j="No Content"):v={message:L}}if(v&&this.isMaybeSingle&&(!((R=v==null?void 0:v.details)===null||R===void 0)&&R.includes("0 rows"))&&(v=null,P=200,j="OK"),v&&this.shouldThrowOnError)throw new n.default(v)}return{error:v,data:M,count:z,status:P,statusText:j}});return this.shouldThrowOnError||(g=g.catch(m=>{var S,C,E;return{error:{message:`${(S=m==null?void 0:m.name)!==null&&S!==void 0?S:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(C=m==null?void 0:m.stack)!==null&&C!==void 0?C:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),g.then(l,c)}returns(){return this}overrideTypes(){return this}}return og.default=a,og}var S1;function ab(){if(S1)return sg;S1=1,Object.defineProperty(sg,"__esModule",{value:!0});const t=Cf.__importDefault(nb());class n extends t.default{select(r){let l=!1;const c=(r??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:g=d}={}){const m=g?`${g}.order`:"order",S=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${S?`${S},`:""}${r}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${r}`),this}range(r,l,{foreignTable:c,referencedTable:d=c}={}){const g=typeof d>"u"?"offset":`${d}.offset`,m=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(g,`${r}`),this.url.searchParams.set(m,`${l-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:g=!1,format:m="text"}={}){var S;const C=[r?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(S=this.headers.get("Accept"))!==null&&S!==void 0?S:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${C};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return sg.default=n,sg}var b1;function fv(){if(b1)return rg;b1=1,Object.defineProperty(rg,"__esModule",{value:!0});const t=Cf.__importDefault(ab());class n extends t.default{eq(r,l){return this.url.searchParams.append(r,`eq.${l}`),this}neq(r,l){return this.url.searchParams.append(r,`neq.${l}`),this}gt(r,l){return this.url.searchParams.append(r,`gt.${l}`),this}gte(r,l){return this.url.searchParams.append(r,`gte.${l}`),this}lt(r,l){return this.url.searchParams.append(r,`lt.${l}`),this}lte(r,l){return this.url.searchParams.append(r,`lte.${l}`),this}like(r,l){return this.url.searchParams.append(r,`like.${l}`),this}likeAllOf(r,l){return this.url.searchParams.append(r,`like(all).{${l.join(",")}}`),this}likeAnyOf(r,l){return this.url.searchParams.append(r,`like(any).{${l.join(",")}}`),this}ilike(r,l){return this.url.searchParams.append(r,`ilike.${l}`),this}ilikeAllOf(r,l){return this.url.searchParams.append(r,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(r,l){return this.url.searchParams.append(r,`ilike(any).{${l.join(",")}}`),this}is(r,l){return this.url.searchParams.append(r,`is.${l}`),this}in(r,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(r,`in.(${c})`),this}contains(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cs.{${l.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(l)}`),this}containedBy(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cd.{${l.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(l)}`),this}rangeGt(r,l){return this.url.searchParams.append(r,`sr.${l}`),this}rangeGte(r,l){return this.url.searchParams.append(r,`nxl.${l}`),this}rangeLt(r,l){return this.url.searchParams.append(r,`sl.${l}`),this}rangeLte(r,l){return this.url.searchParams.append(r,`nxr.${l}`),this}rangeAdjacent(r,l){return this.url.searchParams.append(r,`adj.${l}`),this}overlaps(r,l){return typeof l=="string"?this.url.searchParams.append(r,`ov.${l}`):this.url.searchParams.append(r,`ov.{${l.join(",")}}`),this}textSearch(r,l,{config:c,type:d}={}){let g="";d==="plain"?g="pl":d==="phrase"?g="ph":d==="websearch"&&(g="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(r,`${g}fts${m}.${l}`),this}match(r){return Object.entries(r).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(r,l,c){return this.url.searchParams.append(r,`not.${l}.${c}`),this}or(r,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${r})`),this}filter(r,l,c){return this.url.searchParams.append(r,`${l}.${c}`),this}}return rg.default=n,rg}var _1;function ib(){if(_1)return ig;_1=1,Object.defineProperty(ig,"__esModule",{value:!0});const t=Cf.__importDefault(fv());class n{constructor(r,{headers:l={},schema:c,fetch:d}){this.url=r,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(r,l){const{head:c=!1,count:d}=l??{},g=c?"HEAD":"GET";let m=!1;const S=(r??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",S),d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:l,defaultToNull:c=!0}={}){var d;const g="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((S,C)=>S.concat(Object.keys(C)),[]);if(m.length>0){const S=[...new Set(m)].map(C=>`"${C}"`);this.url.searchParams.set("columns",S.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(r,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:g=!0}={}){var m;const S="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const C=r.reduce((E,R)=>E.concat(Object.keys(R)),[]);if(C.length>0){const E=[...new Set(C)].map(R=>`"${R}"`);this.url.searchParams.set("columns",E.join(","))}}return new t.default({method:S,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:r}={}){var l;const c="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return ig.default=n,ig}var E1;function z8(){if(E1)return ag;E1=1,Object.defineProperty(ag,"__esModule",{value:!0});const o=Cf,t=o.__importDefault(ib()),n=o.__importDefault(fv());class a{constructor(l,{headers:c={},schema:d,fetch:g}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=g}from(l){const c=new URL(`${this.url}/${l}`);return new t.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:g=!1,count:m}={}){var S;let C;const E=new URL(`${this.url}/rpc/${l}`);let R;d||g?(C=d?"HEAD":"GET",Object.entries(c).filter(([M,z])=>z!==void 0).map(([M,z])=>[M,Array.isArray(z)?`{${z.join(",")}}`:`${z}`]).forEach(([M,z])=>{E.searchParams.append(M,z)})):(C="POST",R=c);const v=new Headers(this.headers);return m&&v.set("Prefer",`count=${m}`),new n.default({method:C,url:E,headers:v,schema:this.schemaName,body:R,fetch:(S=this.fetch)!==null&&S!==void 0?S:fetch})}}return ag.default=a,ag}var C1;function L8(){if(C1)return hi;C1=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.PostgrestError=hi.PostgrestBuilder=hi.PostgrestTransformBuilder=hi.PostgrestFilterBuilder=hi.PostgrestQueryBuilder=hi.PostgrestClient=void 0;const o=Cf,t=o.__importDefault(z8());hi.PostgrestClient=t.default;const n=o.__importDefault(ib());hi.PostgrestQueryBuilder=n.default;const a=o.__importDefault(fv());hi.PostgrestFilterBuilder=a.default;const r=o.__importDefault(ab());hi.PostgrestTransformBuilder=r.default;const l=o.__importDefault(nb());hi.PostgrestBuilder=l.default;const c=o.__importDefault(eb());return hi.PostgrestError=c.default,hi.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:l.default,PostgrestError:c.default},hi}var P8=L8();const I8=vf(P8),{PostgrestClient:G8,PostgrestQueryBuilder:FT,PostgrestFilterBuilder:JT,PostgrestTransformBuilder:ZT,PostgrestBuilder:WT,PostgrestError:$T}=I8;class H8{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const a=n.node,r=parseInt(a.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const a=this.getWebSocketConstructor();return new a(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const k8="2.76.1",q8=`realtime-js/${k8}`,V8="1.0.0",km=1e4,Y8=1e3,K8=100;var ch;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(ch||(ch={}));var Ba;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Ba||(Ba={}));var Zr;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(Zr||(Zr={}));var qm;(function(o){o.websocket="websocket"})(qm||(qm={}));var Su;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(Su||(Su={}));class Q8{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,n,a)}_decodeBroadcast(t,n,a){const r=n.getUint8(1),l=n.getUint8(2);let c=this.HEADER_LENGTH+2;const d=a.decode(t.slice(c,c+r));c=c+r;const g=a.decode(t.slice(c,c+l));c=c+l;const m=JSON.parse(a.decode(t.slice(c,t.byteLength)));return{ref:null,topic:d,event:g,payload:m}}}class rb{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Yn;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(Yn||(Yn={}));const T1=(o,t,n={})=>{var a;const r=(a=n.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=X8(c,o,t,r),l),{}):{}},X8=(o,t,n,a)=>{const r=t.find(d=>d.name===o),l=r==null?void 0:r.type,c=n[o];return l&&!a.includes(l)?sb(l,c):Vm(c)},sb=(o,t)=>{if(o.charAt(0)==="_"){const n=o.slice(1,o.length);return W8(t,n)}switch(o){case Yn.bool:return F8(t);case Yn.float4:case Yn.float8:case Yn.int2:case Yn.int4:case Yn.int8:case Yn.numeric:case Yn.oid:return J8(t);case Yn.json:case Yn.jsonb:return Z8(t);case Yn.timestamp:return $8(t);case Yn.abstime:case Yn.date:case Yn.daterange:case Yn.int4range:case Yn.int8range:case Yn.money:case Yn.reltime:case Yn.text:case Yn.time:case Yn.timestamptz:case Yn.timetz:case Yn.tsrange:case Yn.tstzrange:return Vm(t);default:return Vm(t)}},Vm=o=>o,F8=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},J8=o=>{if(typeof o=="string"){const t=parseFloat(o);if(!Number.isNaN(t))return t}return o},Z8=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(t){return console.log(`JSON parse error: ${t}`),o}return o},W8=(o,t)=>{if(typeof o!="string")return o;const n=o.length-1,a=o[n];if(o[0]==="{"&&a==="}"){let l;const c=o.slice(1,n);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>sb(t,d))}return o},$8=o=>typeof o=="string"?o.replace(" ","T"):o,ob=o=>{const t=new URL(o);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Yp{constructor(t,n,a={},r=km){this.channel=t,this.event=n,this.payload=a,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var a;return this._hasReceived(t)&&n((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var A1;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(A1||(A1={}));class fh{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},r=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fh.syncState(this.state,r,l,c),this.pendingDiffs.forEach(g=>{this.state=fh.syncDiff(this.state,g,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(a.diff,{},r=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=fh.syncDiff(this.state,r,l,c),d())}),this.onJoin((r,l,c)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:l,newPresences:c})}),this.onLeave((r,l,c)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,a,r){const l=this.cloneDeep(t),c=this.transformState(n),d={},g={};return this.map(l,(m,S)=>{c[m]||(g[m]=S)}),this.map(c,(m,S)=>{const C=l[m];if(C){const E=S.map(z=>z.presence_ref),R=C.map(z=>z.presence_ref),v=S.filter(z=>R.indexOf(z.presence_ref)<0),M=C.filter(z=>E.indexOf(z.presence_ref)<0);v.length>0&&(d[m]=v),M.length>0&&(g[m]=M)}else d[m]=S}),this.syncDiff(l,{joins:d,leaves:g},a,r)}static syncDiff(t,n,a,r){const{joins:l,leaves:c}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return a||(a=()=>{}),r||(r=()=>{}),this.map(l,(d,g)=>{var m;const S=(m=t[d])!==null&&m!==void 0?m:[];if(t[d]=this.cloneDeep(g),S.length>0){const C=t[d].map(R=>R.presence_ref),E=S.filter(R=>C.indexOf(R.presence_ref)<0);t[d].unshift(...E)}a(d,S,g)}),this.map(c,(d,g)=>{let m=t[d];if(!m)return;const S=g.map(C=>C.presence_ref);m=m.filter(C=>S.indexOf(C.presence_ref)<0),t[d]=m,r(d,m,g),m.length===0&&delete t[d]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(a=>n(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,a)=>{const r=t[a];return"metas"in r?n[a]=r.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[a]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var w1;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(w1||(w1={}));var dh;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(dh||(dh={}));var Co;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(Co||(Co={}));class dv{constructor(t,n={config:{}},a){var r,l;if(this.topic=t,this.params=n,this.socket=a,this.bindings={},this.state=Ba.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Yp(this,Zr.join,this.params,this.timeout),this.rejoinTimer=new rb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ba.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ba.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ba.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ba.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ba.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zr.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new fh(this),this.broadcastEndpointURL=ob(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var a,r,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Ba.closed){const{config:{broadcast:c,presence:d,private:g}}=this.params,m=(r=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(R=>R.filter))!==null&&r!==void 0?r:[],S=!!this.bindings[dh.PRESENCE]&&this.bindings[dh.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,C={},E={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:S}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(R=>t==null?void 0:t(Co.CHANNEL_ERROR,R)),this._onClose(()=>t==null?void 0:t(Co.CLOSED)),this.updateJoinPayload(Object.assign({config:E},C)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:R})=>{var v;if(this.socket.setAuth(),R===void 0){t==null||t(Co.SUBSCRIBED);return}else{const M=this.bindings.postgres_changes,z=(v=M==null?void 0:M.length)!==null&&v!==void 0?v:0,P=[];for(let j=0;j<z;j++){const x=M[j],{filter:{event:L,schema:O,table:T,filter:A}}=x,y=R&&R[j];if(y&&y.event===L&&y.schema===O&&y.table===T&&y.filter===A)P.push(Object.assign(Object.assign({},x),{id:y.id}));else{this.unsubscribe(),this.state=Ba.errored,t==null||t(Co.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=P,t&&t(Co.SUBSCRIBED);return}}).receive("error",R=>{this.state=Ba.errored,t==null||t(Co.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(R).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Co.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,a){return this.state===Ba.joined&&t===dh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,a)}async httpSend(t,n,a={}){var r;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=a.timeout)!==null&&r!==void 0?r:this.timeout);if(d.status===202)return{success:!0};let g=d.statusText;try{const m=await d.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(t,n={}){var a,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,g;const m=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((g=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ba.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zr.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(r=>{a=new Yp(this,Zr.leave,{},t),a.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ba.closed,this.bindings={}}async _fetchWithTimeout(t,n,a){const r=new AbortController,l=setTimeout(()=>r.abort(),a),c=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(l),c}_push(t,n,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Yp(this,t,n,a);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>K8){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,a){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,a){var r,l;const c=t.toLocaleLowerCase(),{close:d,error:g,leave:m,join:S}=Zr;if(a&&[d,g,m,S].indexOf(c)>=0&&a!==this._joinRef())return;let E=this._onMessage(c,n,a);if(n&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(R=>{var v,M,z;return((v=R.filter)===null||v===void 0?void 0:v.event)==="*"||((z=(M=R.filter)===null||M===void 0?void 0:M.event)===null||z===void 0?void 0:z.toLocaleLowerCase())===c}).map(R=>R.callback(E,a)):(l=this.bindings[c])===null||l===void 0||l.filter(R=>{var v,M,z,P,j,x;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in R){const L=R.id,O=(v=R.filter)===null||v===void 0?void 0:v.event;return L&&((M=n.ids)===null||M===void 0?void 0:M.includes(L))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((z=n.data)===null||z===void 0?void 0:z.type.toLocaleLowerCase()))}else{const L=(j=(P=R==null?void 0:R.filter)===null||P===void 0?void 0:P.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return L==="*"||L===((x=n==null?void 0:n.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===c}).map(R=>{if(typeof E=="object"&&"ids"in E){const v=E.data,{schema:M,table:z,commit_timestamp:P,type:j,errors:x}=v;E=Object.assign(Object.assign({},{schema:M,table:z,commit_timestamp:P,eventType:j,new:{},old:{},errors:x}),this._getPayloadRecords(v))}R.callback(E,a)})}_isClosed(){return this.state===Ba.closed}_isJoined(){return this.state===Ba.joined}_isJoining(){return this.state===Ba.joining}_isLeaving(){return this.state===Ba.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,a){const r=t.toLocaleLowerCase(),l={type:r,filter:n,callback:a};return this.bindings[r]?this.bindings[r].push(l):this.bindings[r]=[l],this}_off(t,n){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(r=>{var l;return!(((l=r.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&dv.isEqual(r.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const a in t)if(t[a]!==n[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Zr.close,{},t)}_onError(t){this._on(Zr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ba.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=T1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=T1(t.columns,t.old_record)),n}}const Kp=()=>{},ug={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},tE=[1e3,2e3,5e3,1e4],eE=1e4,nE=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class aE{constructor(t,n){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=km,this.transport=null,this.heartbeatIntervalMs=ug.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Kp,this.ref=0,this.reconnectTimer=null,this.logger=Kp,this.conn=null,this.sendBuffer=[],this.serializer=new Q8,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let l;return r?l=r:typeof fetch>"u"?l=(...c)=>xu(async()=>{const{default:d}=await Promise.resolve().then(()=>Nu);return{default:d}},void 0).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((a=n==null?void 0:n.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${qm.websocket}`,this.httpEndpoint=ob(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=H8.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:V8}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,a){this.logger(t,n,a)}connectionState(){switch(this.conn&&this.conn.readyState){case ch.connecting:return Su.Connecting;case ch.open:return Su.Open;case ch.closing:return Su.Closing;default:return Su.Closed}}isConnected(){return this.connectionState()===Su.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const a=`realtime:${t}`,r=this.getChannels().find(l=>l.topic===a);if(r)return r;{const l=new dv(`realtime:${t}`,n,this);return this.channels.push(l),l}}push(t){const{topic:n,event:a,payload:r,ref:l}=t,c=()=>{this.encode(t,d=>{var g;(g=this.conn)===null||g===void 0||g.send(d)})};this.log("push",`${n} ${a} (${l})`,r),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Y8,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},ug.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:r,payload:l,ref:c}=n,d=c?`(${c})`:"",g=l.status||"";this.log("receive",`${g} ${a} ${r} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(a)).forEach(m=>m._trigger(r,l,c)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Zr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const a=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${a}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const a=new Blob([nE],{type:"application/javascript"});n=URL.createObjectURL(a)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(a=>{const r={access_token:n,version:q8};n&&a.updateJoinPayload(r),a.joinedOnce&&a._isJoined()&&a._push(Zr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(n)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new rb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ug.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,a,r,l,c,d,g,m,S;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:km,this.heartbeatIntervalMs=(r=t==null?void 0:t.heartbeatIntervalMs)!==null&&r!==void 0?r:ug.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t==null?void 0:t.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=t==null?void 0:t.heartbeatCallback)!==null&&d!==void 0?d:Kp,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(C=>tE[C-1]||eE),this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((C,E)=>E(JSON.stringify(C))),this.decode=(S=t==null?void 0:t.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class hv extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function la(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class iE extends hv{constructor(t,n,a){super(t),this.name="StorageApiError",this.status=n,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ym extends hv{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const gv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>xu(async()=>{const{default:a}=await Promise.resolve().then(()=>Nu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},rE=()=>ue(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield xu(()=>Promise.resolve().then(()=>Nu),void 0)).Response:Response}),Km=o=>{if(Array.isArray(o))return o.map(n=>Km(n));if(typeof o=="function"||o!==Object(o))return o;const t={};return Object.entries(o).forEach(([n,a])=>{const r=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[r]=Km(a)}),t},sE=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Qp=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),oE=(o,t,n)=>ue(void 0,void 0,void 0,function*(){const a=yield rE();o instanceof a&&!(n!=null&&n.noResolveJson)?o.json().then(r=>{const l=o.status||500,c=(r==null?void 0:r.statusCode)||l+"";t(new iE(Qp(r),l,c))}).catch(r=>{t(new Ym(Qp(r),r))}):t(new Ym(Qp(o),o))}),lE=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"||!a?r:(sE(a)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,t!=null&&t.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),n))};function _h(o,t,n,a,r,l){return ue(this,void 0,void 0,function*(){return new Promise((c,d)=>{o(n,lE(t,a,r,l)).then(g=>{if(!g.ok)throw g;return a!=null&&a.noResolveJson?g:g.json()}).then(g=>c(g)).catch(g=>oE(g,d,a))})})}function mh(o,t,n,a){return ue(this,void 0,void 0,function*(){return _h(o,"GET",t,n,a)})}function Jr(o,t,n,a,r){return ue(this,void 0,void 0,function*(){return _h(o,"POST",t,a,r,n)})}function Qm(o,t,n,a,r){return ue(this,void 0,void 0,function*(){return _h(o,"PUT",t,a,r,n)})}function uE(o,t,n,a){return ue(this,void 0,void 0,function*(){return _h(o,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),a)})}function pv(o,t,n,a,r){return ue(this,void 0,void 0,function*(){return _h(o,"DELETE",t,a,r,n)})}class cE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return ue(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(la(t))return{data:null,error:t};throw t}})}}var lb;class fE{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[lb]="BlobDownloadBuilder",this.promise=null}asStream(){return new cE(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return ue(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(la(t))return{data:null,error:t};throw t}})}}lb=Symbol.toStringTag;const dE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},R1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class hE{constructor(t,n={},a,r){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=a,this.fetch=gv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,a,r){return ue(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},R1),r);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(c.upsert)});const g=c.metadata;typeof Blob<"u"&&a instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",this.encodeMetadata(g)),l.append("",a)):typeof FormData<"u"&&a instanceof FormData?(l=a,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",this.encodeMetadata(g))):(l=a,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,g&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),r!=null&&r.headers&&(d=Object.assign(Object.assign({},d),r.headers));const m=this._removeEmptyFolders(n),S=this._getFinalPath(m),C=yield(t=="PUT"?Qm:Jr)(this.fetch,`${this.url}/object/${S}`,l,Object.assign({headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:C.Id,fullPath:C.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(la(l))return{data:null,error:l};throw l}})}upload(t,n,a){return ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,a)})}uploadToSignedUrl(t,n,a,r){return ue(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",n);try{let g;const m=Object.assign({upsert:R1.upsert},r),S=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&a instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",a)):typeof FormData<"u"&&a instanceof FormData?(g=a,g.append("cacheControl",m.cacheControl)):(g=a,S["cache-control"]=`max-age=${m.cacheControl}`,S["content-type"]=m.contentType);const C=yield Qm(this.fetch,d.toString(),g,{headers:S});return{data:{path:l,fullPath:C.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(la(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(t,n){return ue(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const l=yield Jr(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:r}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new hv("No token returned by API");return{data:{signedUrl:c.toString(),path:t,token:d},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(la(a))return{data:null,error:a};throw a}})}update(t,n,a){return ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,a)})}move(t,n,a){return ue(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(la(r))return{data:null,error:r};throw r}})}copy(t,n,a){return ue(this,void 0,void 0,function*(){try{return{data:{path:(yield Jr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(la(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,a){return ue(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),l=yield Jr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const c=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(la(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,a){return ue(this,void 0,void 0,function*(){try{const r=yield Jr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),l=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:r.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(la(r))return{data:null,error:r};throw r}})}download(t,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),c=l?`?${l}`:"",d=this._getFinalPath(t),g=()=>mh(this.fetch,`${this.url}/${r}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new fE(g,this.shouldThrowOnError)}info(t){return ue(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const a=yield mh(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Km(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(la(a))return{data:null,error:a};throw a}})}exists(t){return ue(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield uE(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(la(a)&&a instanceof Ym){const r=a.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,n){const a=this._getFinalPath(t),r=[],l=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&r.push(l);const d=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});g!==""&&r.push(g);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${a}${m}`)}}}remove(t){return ue(this,void 0,void 0,function*(){try{return{data:yield pv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(la(n))return{data:null,error:n};throw n}})}list(t,n,a){return ue(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},dE),n),{prefix:t||""});return{data:yield Jr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},a),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(la(r))return{data:null,error:r};throw r}})}listV2(t,n){return ue(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield Jr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(la(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const ub="2.76.1",cb={"X-Client-Info":`storage-js/${ub}`};class gE{constructor(t,n={},a,r){this.shouldThrowOnError=!1;const l=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},cb),n),this.fetch=gv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ue(this,void 0,void 0,function*(){try{return{data:yield mh(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(la(t))return{data:null,error:t};throw t}})}getBucket(t){return ue(this,void 0,void 0,function*(){try{return{data:yield mh(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(la(n))return{data:null,error:n};throw n}})}createBucket(t){return ue(this,arguments,void 0,function*(n,a={public:!1}){try{return{data:yield Jr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(la(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return ue(this,void 0,void 0,function*(){try{return{data:yield Qm(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(la(a))return{data:null,error:a};throw a}})}emptyBucket(t){return ue(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(la(n))return{data:null,error:n};throw n}})}deleteBucket(t){return ue(this,void 0,void 0,function*(){try{return{data:yield pv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(la(n))return{data:null,error:n};throw n}})}}class pE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},cb),n),this.fetch=gv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return ue(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(la(n))return{data:null,error:n};throw n}})}listBuckets(t){return ue(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const a=n.toString(),r=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`,l=yield mh(this.fetch,r,{headers:this.headers});return{data:Array.isArray(l)?l.filter(d=>d.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(la(n))return{data:null,error:n};throw n}})}deleteBucket(t){return ue(this,void 0,void 0,function*(){try{return{data:yield pv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(la(n))return{data:null,error:n};throw n}})}}const mv={"X-Client-Info":`storage-js/${ub}`,"Content-Type":"application/json"};class fb extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Zi(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class Xp extends fb{constructor(t,n,a){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class mE extends fb{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var O1;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(O1||(O1={}));const vv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>xu(async()=>{const{default:a}=await Promise.resolve().then(()=>Nu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},vE=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},x1=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),yE=(o,t,n)=>ue(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!(n!=null&&n.noResolveJson)){const r=o.status||500,l=o;if(typeof l.json=="function")l.json().then(c=>{const d=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||r+"";t(new Xp(x1(c),r,d))}).catch(()=>{const c=r+"",d=l.statusText||`HTTP ${r} error`;t(new Xp(d,r,c))});else{const c=r+"",d=l.statusText||`HTTP ${r} error`;t(new Xp(d,r,c))}}else t(new mE(x1(o),o))}),SE=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return a?(vE(a)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,Object.assign(Object.assign({},r),n)):r};function bE(o,t,n,a,r,l){return ue(this,void 0,void 0,function*(){return new Promise((c,d)=>{o(n,SE(t,a,r,l)).then(g=>{if(!g.ok)throw g;if(a!=null&&a.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>c(g)).catch(g=>yE(g,d,a))})})}function Wi(o,t,n,a,r){return ue(this,void 0,void 0,function*(){return bE(o,"POST",t,a,r,n)})}class _E{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mv),n),this.fetch=vv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return ue(this,void 0,void 0,function*(){try{return{data:(yield Wi(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}getIndex(t,n){return ue(this,void 0,void 0,function*(){try{return{data:yield Wi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Zi(a))return{data:null,error:a};throw a}})}listIndexes(t){return ue(this,void 0,void 0,function*(){try{return{data:yield Wi(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return ue(this,void 0,void 0,function*(){try{return{data:(yield Wi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Zi(a))return{data:null,error:a};throw a}})}}class EE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mv),n),this.fetch=vv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return ue(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Wi(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}getVectors(t){return ue(this,void 0,void 0,function*(){try{return{data:yield Wi(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}listVectors(t){return ue(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Wi(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}queryVectors(t){return ue(this,void 0,void 0,function*(){try{return{data:yield Wi(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}deleteVectors(t){return ue(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Wi(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}}class CE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mv),n),this.fetch=vv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return ue(this,void 0,void 0,function*(){try{return{data:(yield Wi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}getBucket(t){return ue(this,void 0,void 0,function*(){try{return{data:yield Wi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}listBuckets(){return ue(this,arguments,void 0,function*(t={}){try{return{data:yield Wi(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}deleteBucket(t){return ue(this,void 0,void 0,function*(){try{return{data:(yield Wi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zi(n))return{data:null,error:n};throw n}})}}class TE extends CE{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new AE(this.url,this.headers,t,this.fetch)}}class AE extends _E{constructor(t,n,a,r){super(t,n,r),this.vectorBucketName=a}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return ue(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return ue(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return ue(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return ue(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new wE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class wE extends EE{constructor(t,n,a,r,l){super(t,n,l),this.vectorBucketName=a,this.indexName=r}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return ue(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return ue(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return ue(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return ue(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return ue(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class RE extends gE{constructor(t,n={},a,r){super(t,n,a,r)}from(t){return new hE(this.url,this.headers,t,this.fetch)}get vectors(){return new TE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new pE(this.url+"/iceberg",this.headers,this.fetch)}}const OE="2.76.1";let rh="";typeof Deno<"u"?rh="deno":typeof document<"u"?rh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?rh="react-native":rh="node";const xE={"X-Client-Info":`supabase-js-${rh}/${OE}`},NE={headers:xE},ME={schema:"public"},DE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jE={},UE=o=>{let t;return o?t=o:typeof fetch>"u"?t=$S:t=fetch,(...n)=>t(...n)},BE=()=>typeof Headers>"u"?tb:Headers,zE=(o,t,n)=>{const a=UE(n),r=BE();return async(l,c)=>{var d;const g=(d=await t())!==null&&d!==void 0?d:o;let m=new r(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),a(l,Object.assign(Object.assign({},c),{headers:m}))}};function LE(o){return o.endsWith("/")?o:o+"/"}function PE(o,t){var n,a;const{db:r,auth:l,realtime:c,global:d}=o,{db:g,auth:m,realtime:S,global:C}=t,E={db:Object.assign(Object.assign({},g),r),auth:Object.assign(Object.assign({},m),l),realtime:Object.assign(Object.assign({},S),c),storage:{},global:Object.assign(Object.assign(Object.assign({},C),d),{headers:Object.assign(Object.assign({},(n=C==null?void 0:C.headers)!==null&&n!==void 0?n:{}),(a=d==null?void 0:d.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return o.accessToken?E.accessToken=o.accessToken:delete E.accessToken,E}function IE(o){const t=o==null?void 0:o.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(LE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const db="2.76.1",uf=30*1e3,Xm=3,Fp=Xm*uf,GE="http://localhost:9999",HE="supabase.auth.token",kE={"X-Client-Info":`gotrue-js/${db}`},Fm="X-Supabase-Api-Version",hb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},qE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,VE=600*1e3;class vh extends Error{constructor(t,n,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=a}}function ye(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class YE extends vh{constructor(t,n,a){super(t,n,a),this.name="AuthApiError",this.status=n,this.code=a}}function KE(o){return ye(o)&&o.name==="AuthApiError"}class bu extends vh{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Al extends vh{constructor(t,n,a,r){super(t,a,r),this.name=n,this.status=a}}class pl extends Al{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function QE(o){return ye(o)&&o.name==="AuthSessionMissingError"}class tf extends Al{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cg extends Al{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class fg extends Al{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function XE(o){return ye(o)&&o.name==="AuthImplicitGrantRedirectError"}class N1 extends Al{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Jm extends Al{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Jp(o){return ye(o)&&o.name==="AuthRetryableFetchError"}class M1 extends Al{constructor(t,n,a){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=a}}class Zm extends Al{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),D1=` 	
\r=`.split(""),FE=(()=>{const o=new Array(128);for(let t=0;t<o.length;t+=1)o[t]=-1;for(let t=0;t<D1.length;t+=1)o[D1[t].charCodeAt(0)]=-2;for(let t=0;t<Cg.length;t+=1)o[Cg[t].charCodeAt(0)]=t;return o})();function j1(o,t,n){if(o!==null)for(t.queue=t.queue<<8|o,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;n(Cg[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;n(Cg[a]),t.queuedBits-=6}}function gb(o,t,n){const a=FE[o];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function U1(o){const t=[],n=c=>{t.push(String.fromCodePoint(c))},a={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},l=c=>{WE(c,a,n)};for(let c=0;c<o.length;c+=1)gb(o.charCodeAt(c),r,l);return t.join("")}function JE(o,t){if(o<=127){t(o);return}else if(o<=2047){t(192|o>>6),t(128|o&63);return}else if(o<=65535){t(224|o>>12),t(128|o>>6&63),t(128|o&63);return}else if(o<=1114111){t(240|o>>18),t(128|o>>12&63),t(128|o>>6&63),t(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function ZE(o,t){for(let n=0;n<o.length;n+=1){let a=o.charCodeAt(n);if(a>55295&&a<=56319){const r=(a-55296)*1024&65535;a=(o.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}JE(a,t)}}function WE(o,t,n){if(t.utf8seq===0){if(o<=127){n(o);return}for(let a=1;a<6;a+=1)if((o>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=o&31;else if(t.utf8seq===3)t.codepoint=o&15;else if(t.utf8seq===4)t.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|o&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function df(o){const t=[],n={queue:0,queuedBits:0},a=r=>{t.push(r)};for(let r=0;r<o.length;r+=1)gb(o.charCodeAt(r),n,a);return new Uint8Array(t)}function $E(o){const t=[];return ZE(o,n=>t.push(n)),new Uint8Array(t)}function Eu(o){const t=[],n={queue:0,queuedBits:0},a=r=>{t.push(r)};return o.forEach(r=>j1(r,n,a)),j1(null,n,a),t.join("")}function tC(o){return Math.round(Date.now()/1e3)+o}function eC(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o=="x"?t:t&3|8).toString(16)})}const Fi=()=>typeof window<"u"&&typeof document<"u",pu={tested:!1,writable:!1},pb=()=>{if(!Fi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(pu.tested)return pu.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),pu.tested=!0,pu.writable=!0}catch{pu.tested=!0,pu.writable=!1}return pu.writable};function nC(o){const t={},n=new URL(o);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,l)=>{t[l]=r})}catch{}return n.searchParams.forEach((a,r)=>{t[r]=a}),t}const mb=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>xu(async()=>{const{default:a}=await Promise.resolve().then(()=>Nu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},aC=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",cf=async(o,t,n)=>{await o.setItem(t,JSON.stringify(n))},mu=async(o,t)=>{const n=await o.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},fl=async(o,t)=>{await o.removeItem(t)};class Lg{constructor(){this.promise=new Lg.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Lg.promiseConstructor=Promise;function Zp(o){const t=o.split(".");if(t.length!==3)throw new Zm("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!qE.test(t[a]))throw new Zm("JWT not in base64url format");return{header:JSON.parse(U1(t[0])),payload:JSON.parse(U1(t[1])),signature:df(t[2]),raw:{header:t[0],payload:t[1]}}}async function iC(o){return await new Promise(t=>{setTimeout(()=>t(null),o)})}function rC(o,t){return new Promise((a,r)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await o(l);if(!t(l,null,c)){a(c);return}}catch(c){if(!t(l,c)){r(c);return}}})()})}function sC(o){return("0"+o.toString(16)).substr(-2)}function oC(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=n.length;let r="";for(let l=0;l<56;l++)r+=n.charAt(Math.floor(Math.random()*a));return r}return crypto.getRandomValues(t),Array.from(t,sC).join("")}async function lC(o){const n=new TextEncoder().encode(o),a=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(a);return Array.from(r).map(l=>String.fromCharCode(l)).join("")}async function uC(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const n=await lC(o);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ef(o,t,n=!1){const a=oC();let r=a;n&&(r+="/PASSWORD_RECOVERY"),await cf(o,`${t}-code-verifier`,r);const l=await uC(a);return[l,a===l?"plain":"s256"]}const cC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function fC(o){const t=o.headers.get(Fm);if(!t||!t.match(cC))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function dC(o){if(!o)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(o<=t)throw new Error("JWT has expired")}function hC(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const gC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function nf(o){if(!gC.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Wp(){const o={};return new Proxy(o,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function B1(o){return JSON.parse(JSON.stringify(o))}const yu=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),pC=[502,503,504];async function z1(o){var t;if(!aC(o))throw new Jm(yu(o),0);if(pC.includes(o.status))throw new Jm(yu(o),o.status);let n;try{n=await o.json()}catch(l){throw new bu(yu(l),l)}let a;const r=fC(o);if(r&&r.getTime()>=hb["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?a=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(a=n.error_code),a){if(a==="weak_password")throw new M1(yu(n),o.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new pl}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new M1(yu(n),o.status,n.weak_password.reasons);throw new YE(yu(n),o.status||500,a)}const mC=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(a),Object.assign(Object.assign({},r),n))};async function Be(o,t,n,a){var r;const l=Object.assign({},a==null?void 0:a.headers);l[Fm]||(l[Fm]=hb["2024-01-01"].name),a!=null&&a.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const c=(r=a==null?void 0:a.query)!==null&&r!==void 0?r:{};a!=null&&a.redirectTo&&(c.redirect_to=a.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",g=await vC(o,t,n+d,{headers:l,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(g):{data:Object.assign({},g),error:null}}async function vC(o,t,n,a,r,l){const c=mC(t,a,r,l);let d;try{d=await o(n,Object.assign({},c))}catch(g){throw console.error(g),new Jm(yu(g),0)}if(d.ok||await z1(d),a!=null&&a.noResolveJson)return d;try{return await d.json()}catch(g){await z1(g)}}function Fr(o){var t;let n=null;bC(o)&&(n=Object.assign({},o),o.expires_at||(n.expires_at=tC(o.expires_in)));const a=(t=o.user)!==null&&t!==void 0?t:o;return{data:{session:n,user:a},error:null}}function L1(o){const t=Fr(o);return!t.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((n,a)=>n&&typeof a=="string",!0)&&(t.data.weak_password=o.weak_password),t}function vl(o){var t;return{data:{user:(t=o.user)!==null&&t!==void 0?t:o},error:null}}function yC(o){return{data:o,error:null}}function SC(o){const{action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:l}=o,c=Ef(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:l},g=Object.assign({},c);return{data:{properties:d,user:g},error:null}}function P1(o){return o}function bC(o){return o.access_token&&o.refresh_token&&o.expires_in}const $p=["global","local","others"];class _C{constructor({url:t="",headers:n={},fetch:a}){this.url=t,this.headers=n,this.fetch=mb(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=$p[0]){if($p.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$p.join(", ")}`);try{return await Be(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(ye(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,n={}){try{return await Be(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:vl})}catch(a){if(ye(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:n}=t,a=Ef(t,["options"]),r=Object.assign(Object.assign({},a),n);return"newEmail"in a&&(r.new_email=a==null?void 0:a.newEmail,delete r.newEmail),await Be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:SC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ye(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Be(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:vl})}catch(n){if(ye(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,a,r,l,c,d,g;try{const m={nextPage:null,lastPage:0,total:0},S=await Be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:P1});if(S.error)throw S.error;const C=await S.json(),E=(c=S.headers.get("x-total-count"))!==null&&c!==void 0?c:0,R=(g=(d=S.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const M=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(v.split(";")[1].split("=")[1]);m[`${z}Page`]=M}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(ye(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){nf(t);try{return await Be(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:vl})}catch(n){if(ye(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){nf(t);try{return await Be(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:vl})}catch(a){if(ye(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,n=!1){nf(t);try{return await Be(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:vl})}catch(a){if(ye(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){nf(t.userId);try{const{data:n,error:a}=await Be(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:a}}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _deleteFactor(t){nf(t.userId),nf(t.id);try{return{data:await Be(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,a,r,l,c,d,g;try{const m={nextPage:null,lastPage:0,total:0},S=await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:P1});if(S.error)throw S.error;const C=await S.json(),E=(c=S.headers.get("x-total-count"))!==null&&c!==void 0?c:0,R=(g=(d=S.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const M=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(v.split(";")[1].split("=")[1]);m[`${z}Page`]=M}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(ye(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}}function I1(o={}){return{getItem:t=>o[t]||null,setItem:(t,n)=>{o[t]=n},removeItem:t=>{delete o[t]}}}const af={debug:!!(globalThis&&pb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class vb extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class EC extends vb{}async function CC(o,t,n){af.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),af.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async r=>{if(r){af.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,r.name);try{return await n()}finally{af.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,r.name)}}else{if(t===0)throw af.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new EC(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(af.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function TC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function yb(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function AC(o){return parseInt(o,16)}function wC(o){const t=new TextEncoder().encode(o);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function RC(o){var t;const{chainId:n,domain:a,expirationTime:r,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:g,resources:m,scheme:S,uri:C,version:E}=o;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((t=o.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const R=yb(o.address),v=S?`${S}://${a}`:a,M=o.statement?`${o.statement}
`:"",z=`${v} wants you to sign in with your Ethereum account:
${R}

${M}`;let P=`URI: ${C}
Version: ${E}
Chain ID: ${n}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(r&&(P+=`
Expiration Time: ${r.toISOString()}`),d&&(P+=`
Not Before: ${d.toISOString()}`),g&&(P+=`
Request ID: ${g}`),m){let j=`
Resources:`;for(const x of m){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);j+=`
- ${x}`}P+=j}return`${z}
${P}`}class Ca extends Error{constructor({message:t,code:n,cause:a,name:r}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=r??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class Tg extends Ca{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function OC({error:o,options:t}){var n,a,r;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ca({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Ca({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ca({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Ca({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Ca({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Ca({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Ca({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Ca({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const c=window.location.hostname;if(Sb(c)){if(l.rp.id!==c)return new Ca({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Ca({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Ca({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Ca({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Ca({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function xC({error:o,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ca({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Ca({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const a=window.location.hostname;if(Sb(a)){if(n.rpId!==a)return new Ca({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Ca({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Ca({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Ca({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class NC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const MC=new NC;function DC(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:t,user:n,excludeCredentials:a}=o,r=Ef(o,["challenge","user","excludeCredentials"]),l=df(t).buffer,c=Object.assign(Object.assign({},n),{id:df(n.id).buffer}),d=Object.assign(Object.assign({},r),{challenge:l,user:c});if(a&&a.length>0){d.excludeCredentials=new Array(a.length);for(let g=0;g<a.length;g++){const m=a[g];d.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:df(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function jC(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:t,allowCredentials:n}=o,a=Ef(o,["challenge","allowCredentials"]),r=df(t).buffer,l=Object.assign(Object.assign({},a),{challenge:r});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:df(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function UC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o;return{id:o.id,rawId:o.id,response:{attestationObject:Eu(new Uint8Array(o.response.attestationObject)),clientDataJSON:Eu(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function BC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o,a=o.getClientExtensionResults(),r=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:Eu(new Uint8Array(r.authenticatorData)),clientDataJSON:Eu(new Uint8Array(r.clientDataJSON)),signature:Eu(new Uint8Array(r.signature)),userHandle:r.userHandle?Eu(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Sb(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function G1(){var o,t;return!!(Fi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator==null?void 0:navigator.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function zC(o){try{const t=await navigator.credentials.create(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Tg("Browser returned unexpected credential type",t)}:{data:null,error:new Tg("Empty credential response",t)}}catch(t){return{data:null,error:OC({error:t,options:o})}}}async function LC(o){try{const t=await navigator.credentials.get(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Tg("Browser returned unexpected credential type",t)}:{data:null,error:new Tg("Empty credential response",t)}}catch(t){return{data:null,error:xC({error:t,options:o})}}}const PC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},IC={userVerification:"preferred",hints:["security-key"]};function Ag(...o){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),a={};for(const r of o)if(r)for(const l in r){const c=r[l];if(c!==void 0)if(Array.isArray(c))a[l]=c;else if(n(c))a[l]=c;else if(t(c)){const d=a[l];t(d)?a[l]=Ag(d,c):a[l]=Ag(c)}else a[l]=c}return a}function GC(o,t){return Ag(PC,o,t||{})}function HC(o,t){return Ag(IC,o,t||{})}class kC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:a,signal:r},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!c)return{data:null,error:d};const g=r??MC.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${a}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=GC(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:S,error:C}=await zC({publicKey:m,signal:g});return S?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:S}},error:null}:{data:null,error:C}}case"request":{const m=HC(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:S,error:C}=await LC(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:g}));return S?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:S}},error:null}:{data:null,error:C}}}}catch(c){return ye(c)?{data:null,error:c}:{data:null,error:new bu("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:n,webauthn:a}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:r}},l){if(!n)return{data:null,error:new vh("rpId is required for WebAuthn authentication")};try{if(!G1())return{data:null,error:new bu("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:a},signal:r},{request:l});if(!c)return{data:null,error:d};const{webauthn:g}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:a,credential_response:g.credential_response}})}catch(c){return ye(c)?{data:null,error:c}:{data:null,error:new bu("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:r},l){if(!n)return{data:null,error:new vh("rpId is required for WebAuthn registration")};try{if(!G1())return{data:null,error:new bu("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(S=>{var C;return(C=S.data)===null||C===void 0?void 0:C.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===t&&E.status!=="unverified")}).then(S=>S?this.client.mfa.unenroll({factorId:S==null?void 0:S.id}):void 0),{data:null,error:d};const{data:g,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:n,rpOrigins:a},signal:r},{create:l});return g?this._verify({factorId:c.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:a,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(c){return ye(c)?{data:null,error:c}:{data:null,error:new bu("Unexpected error in register",c)}}}}TC();const qC={url:GE,storageKey:HE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:kE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function H1(o,t,n){return await n()}const rf={};class yh{get jwks(){var t,n;return(n=(t=rf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){rf[this.storageKey]=Object.assign(Object.assign({},rf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=rf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){rf[this.storageKey]=Object.assign(Object.assign({},rf[this.storageKey]),{cachedAt:t})}constructor(t){var n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=yh.nextInstanceID,yh.nextInstanceID+=1,this.instanceID>0&&Fi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},qC),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new _C({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=mb(r.fetch),this.lock=r.lock||H1,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Fi()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=CC:this.lock=H1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new kC(this)},this.persistSession?(r.storage?this.storage=r.storage:pb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=I1(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=I1(this.memoryStorage)),Fi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${db}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=nC(window.location.href);let a="none";if(this._isImplicitGrantCallback(n)?a="implicit":await this._isPKCECallback(n)&&(a="pkce"),Fi()&&this.detectSessionInUrl&&a!=="none"){const{data:r,error:l}=await this._getSessionFromURL(n,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),XE(l)){const g=(t=l.details)===null||t===void 0?void 0:t.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=r;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ye(n)?{error:n}:{error:new bu("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,a,r;try{const l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:Fr}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const g=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(ye(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var n,a,r;try{let l;if("email"in t){const{email:S,password:C,options:E}=t;let R=null,v=null;this.flowType==="pkce"&&([R,v]=await ef(this.storage,this.storageKey)),l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:S,password:C,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:R,code_challenge_method:v},xform:Fr})}else if("phone"in t){const{phone:S,password:C,options:E}=t;l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:S,password:C,data:(a=E==null?void 0:E.data)!==null&&a!==void 0?a:{},channel:(r=E==null?void 0:E.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:Fr})}else throw new cg("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const g=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(ye(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:c,options:d}=t;n=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:L1})}else if("phone"in t){const{phone:l,password:c,options:d}=t;n=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:L1})}else throw new cg("You must provide either an email or phone number and a password");const{data:a,error:r}=n;return r?{data:{user:null,session:null},error:r}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new tf}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:r})}catch(n){if(ye(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,a,r,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,a,r,l,c,d,g,m,S,C,E;let R,v;if("message"in t)R=t.message,v=t.signature;else{const{chain:M,wallet:z,statement:P,options:j}=t;let x;if(Fi())if(typeof z=="object")x=z;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")x=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof z!="object"||!(j!=null&&j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=z}const L=new URL((n=j==null?void 0:j.url)!==null&&n!==void 0?n:window.location.href),O=await x.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=yb(O[0]);let A=(a=j==null?void 0:j.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!A){const B=await x.request({method:"eth_chainId"});A=AC(B)}const y={domain:L.host,address:T,statement:P,uri:L.href,version:"1",chainId:A,nonce:(r=j==null?void 0:j.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(c=(l=j==null?void 0:j.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=j==null?void 0:j.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(g=j==null?void 0:j.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=j==null?void 0:j.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(S=j==null?void 0:j.signInWithEthereum)===null||S===void 0?void 0:S.resources};R=RC(y),v=await x.request({method:"personal_sign",params:[wC(R),T]})}try{const{data:M,error:z}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:R,signature:v},!((C=t.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(E=t.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:Fr});if(z)throw z;return!M||!M.session||!M.user?{data:{user:null,session:null},error:new tf}:(M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),{data:Object.assign({},M),error:z})}catch(M){if(ye(M))return{data:{user:null,session:null},error:M};throw M}}async signInWithSolana(t){var n,a,r,l,c,d,g,m,S,C,E,R;let v,M;if("message"in t)v=t.message,M=t.signature;else{const{chain:z,wallet:P,statement:j,options:x}=t;let L;if(Fi())if(typeof P=="object")L=P;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))L=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof P!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=P}const O=new URL((n=x==null?void 0:x.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in L&&L.signIn){const T=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),j?{statement:j}:null));let A;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")A=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)A=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)v=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),M=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${O.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...j?["",j,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(r=(a=x==null?void 0:x.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((d=x==null?void 0:x.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((g=x==null?void 0:x.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((m=x==null?void 0:x.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((C=(S=x==null?void 0:x.signInWithSolana)===null||S===void 0?void 0:S.resources)===null||C===void 0)&&C.length?["Resources",...x.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const T=await L.signMessage(new TextEncoder().encode(v),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");M=T}}try{const{data:z,error:P}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Eu(M)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(R=t.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:Fr});if(P)throw P;return!z||!z.session||!z.user?{data:{user:null,session:null},error:new tf}:(z.session&&(await this._saveSession(z.session),await this._notifyAllSubscribers("SIGNED_IN",z.session)),{data:Object.assign({},z),error:P})}catch(z){if(ye(z))return{data:{user:null,session:null},error:z};throw z}}async _exchangeCodeForSession(t){const n=await mu(this.storage,`${this.storageKey}-code-verifier`),[a,r]=(n??"").split("/");try{const{data:l,error:c}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:Fr});if(await fl(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new tf}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:r??null}),error:c})}catch(l){if(ye(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:n,provider:a,token:r,access_token:l,nonce:c}=t,d=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:r,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Fr}),{data:g,error:m}=d;return m?{data:{user:null,session:null},error:m}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new tf}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:m})}catch(n){if(ye(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,a,r,l,c;try{if("email"in t){const{email:d,options:g}=t;let m=null,S=null;this.flowType==="pkce"&&([m,S]=await ef(this.storage,this.storageKey));const{error:C}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(a=g==null?void 0:g.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:S},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:d,options:g}=t,{data:m,error:S}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(c=g==null?void 0:g.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:S}}throw new cg("You must provide either an email or phone number.")}catch(d){if(ye(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(t){var n,a;try{let r,l;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:c,error:d}=await Be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:r,xform:Fr});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const g=c.session,m=c.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(r){if(ye(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,a,r;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await ef(this.storage,this.storageKey)),await Be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&a!==void 0?a:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:yC})}catch(l){if(ye(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;if(a)throw a;if(!n)throw new pl;const{error:r}=await Be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(ye(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:a,type:r,options:l}=t,{error:c}=await Be(this.fetch,"POST",n,{headers:this.headers,body:{email:a,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in t){const{phone:a,type:r,options:l}=t,{data:c,error:d}=await Be(this.fetch,"POST",n,{headers:this.headers,body:{phone:a,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new cg("You must provide either an email or phone number and a type")}catch(n){if(ye(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await a,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=n();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await mu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<Fp:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const c=await mu(this.userStorage,this.storageKey+"-user");c!=null&&c.user?t.user=c.user:t.user=Wp()}if(this.storage.isServer&&t.user){let c=this.suppressGetSessionWarning;t=new Proxy(t,{get:(g,m,S)=>(!c&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,m,S))})}return{data:{session:t},error:null}}const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:vl}):await this._useSession(async n=>{var a,r,l;const{data:c,error:d}=n;if(d)throw d;return!(!((a=c.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new pl}:await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(r=c.session)===null||r===void 0?void 0:r.access_token)!==null&&l!==void 0?l:void 0,xform:vl})})}catch(n){if(ye(n))return QE(n)&&(await this._removeSession(),await fl(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async a=>{const{data:r,error:l}=a;if(l)throw l;if(!r.session)throw new pl;const c=r.session;let d=null,g=null;this.flowType==="pkce"&&t.email!=null&&([d,g]=await ef(this.storage,this.storageKey));const{data:m,error:S}=await Be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:g}),jwt:c.access_token,xform:vl});if(S)throw S;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(a){if(ye(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new pl;const n=Date.now()/1e3;let a=n,r=!0,l=null;const{payload:c}=Zp(t.access_token);if(c.exp&&(a=c.exp,r=a<=n),r){const{data:d,error:g}=await this._callRefreshToken(t.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:g}=await this._getUser(t.access_token);if(g)throw g;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:a-n,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(n){if(ye(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var a;if(!t){const{data:c,error:d}=n;if(d)throw d;t=(a=c.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new pl;const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ye(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Fi())throw new fg("No browser detected.");if(t.error||t.error_description||t.error_code)throw new fg(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new N1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new fg("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new N1("No code detected.");const{data:j,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:j.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:r,access_token:l,refresh_token:c,expires_in:d,expires_at:g,token_type:m}=t;if(!l||!d||!c||!m)throw new fg("No session defined in URL");const S=Math.round(Date.now()/1e3),C=parseInt(d);let E=S+C;g&&(E=parseInt(g));const R=E-S;R*1e3<=uf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${C}s`);const v=E-C;S-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,E,S):S-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,E,S);const{data:M,error:z}=await this._getUser(l);if(z)throw z;const P={provider_token:a,provider_refresh_token:r,access_token:l,expires_in:C,expires_at:E,refresh_token:c,token_type:m,user:M.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:P,redirectType:t.type},error:null}}catch(a){if(ye(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await mu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{error:l};const c=(a=r.session)===null||a===void 0?void 0:a.access_token;if(c){const{error:d}=await this.admin.signOut(c,t);if(d&&!(KE(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return t!=="others"&&(await this._removeSession(),await fl(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=eC(),a={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async n=>{var a,r;try{const{data:{session:l},error:c}=n;if(c)throw c;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let a=null,r=null;this.flowType==="pkce"&&([a,r]=await ef(this.storage,this.storageKey,!0));try{return await Be(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(ye(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:n,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(ye(n))return{data:null,error:n};throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:a,error:r}=await this._useSession(async l=>{var c,d,g,m,S;const{data:C,error:E}=l;if(E)throw E;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=t.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Be(this.fetch,"GET",R,{headers:this.headers,jwt:(S=(m=C.session)===null||m===void 0?void 0:m.access_token)!==null&&S!==void 0?S:void 0})});if(r)throw r;return Fi()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(ye(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var a;try{const{error:r,data:{session:l}}=n;if(r)throw r;const{options:c,provider:d,token:g,access_token:m,nonce:S}=t,C=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l==null?void 0:l.access_token)!==null&&a!==void 0?a:void 0,body:{provider:d,id_token:g,access_token:m,nonce:S,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Fr}),{data:E,error:R}=C;return R?{data:{user:null,session:null},error:R}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new tf}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:R})}catch(r){if(ye(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var a,r;const{data:l,error:c}=n;if(c)throw c;return await Be(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const a=Date.now();return await rC(async r=>(r>0&&await iC(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await Be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Fr})),(r,l)=>{const c=200*Math.pow(2,r);return l&&Jp(l)&&Date.now()+c-a<uf})}catch(a){if(this._debug(n,"error",a),ye(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",a),Fi()&&!n.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,n;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const r=await mu(this.storage,this.storageKey);if(r&&this.userStorage){let c=await mu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:r.user},await cf(this.userStorage,this.storageKey+"-user",c)),r.user=(t=c==null?void 0:c.user)!==null&&t!==void 0?t:Wp()}else if(r&&!r.user&&!r.user){const c=await mu(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(r.user=c.user,await fl(this.storage,this.storageKey+"-user"),await cf(this.storage,this.storageKey,r)):r.user=Wp()}if(this._debug(a,"session from storage",r),!this._isValidSession(r)){this._debug(a,"session is not valid"),r!==null&&await this._removeSession();return}const l=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Fp;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${Fp}s`),l){if(this.autoRefreshToken&&r.refresh_token){const{error:c}=await this._callRefreshToken(r.refresh_token);c&&(console.error(c),Jp(c)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(r.access_token);!d&&(c!=null&&c.user)?(r.user=c.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(a,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(a,"error",r),console.error(r);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var n,a;if(!t)throw new pl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Lg;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new pl;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(r,"error",l),ye(l)){const c={data:null,error:l};return Jp(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(c),c}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,a=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,n)}catch(g){l.push(g)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),a=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&n.user&&await cf(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const l=B1(r);await cf(this.storage,this.storageKey,l)}else{const r=B1(n);await cf(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await fl(this.storage,this.storageKey),await fl(this.storage,this.storageKey+"-code-verifier"),await fl(this.storage,this.storageKey+"-user"),this.userStorage&&await fl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Fi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),uf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:a}}=n;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((a.expires_at*1e3-t)/uf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${uf}ms, refresh threshold is ${Xm} ticks`),r<=Xm&&await this._callRefreshToken(a.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof vb)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Fi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,a){const r=[`provider=${encodeURIComponent(n)}`];if(a!=null&&a.redirectTo&&r.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&r.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,c]=await ef(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});r.push(d.toString())}if(a!=null&&a.queryParams){const l=new URLSearchParams(a.queryParams);r.push(l.toString())}return a!=null&&a.skipBrowserRedirect&&r.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;return l?{data:null,error:l}:await Be(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var a,r;const{data:l,error:c}=n;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:g,error:m}=await Be(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token});return m?{data:null,error:m}:(t.factorType==="totp"&&g.type==="totp"&&(!((r=g==null?void 0:g.totp)===null||r===void 0)&&r.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?UC(t.webauthn.credential_response):BC(t.webauthn.credential_response)})}:{code:t.code}),{data:d,error:g}=await Be(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:g})})}catch(n){if(ye(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{data:null,error:l};const c=await Be(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:DC(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:jC(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(ye(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:a}=await this.getUser();if(a)return{data:null,error:a};const r={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])r.all.push(l),l.status==="verified"&&r[l.factor_type].push(l);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,a;const{data:{session:r},error:l}=t;if(l)return{data:null,error:l};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=Zp(r.access_token);let d=null;c.aal&&(d=c.aal);let g=d;((a=(n=r.user.factors)===null||n===void 0?void 0:n.filter(C=>C.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(g="aal2");const S=c.amr||[];return{data:{currentLevel:d,nextLevel:g,currentAuthenticationMethods:S},error:null}}))}async fetchJwk(t,n={keys:[]}){let a=n.keys.find(d=>d.kid===t);if(a)return a;const r=Date.now();if(a=this.jwks.keys.find(d=>d.kid===t),a&&this.jwks_cached_at+VE>r)return a;const{data:l,error:c}=await Be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=r,a=l.keys.find(d=>d.kid===t),!a)?null:a}async getClaims(t,n={}){try{let a=t;if(!a){const{data:R,error:v}=await this.getSession();if(v||!R.session)return{data:null,error:v};a=R.session.access_token}const{header:r,payload:l,signature:c,raw:{header:d,payload:g}}=Zp(a);n!=null&&n.allowExpired||dC(l.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!m){const{error:R}=await this.getUser(a);if(R)throw R;return{data:{claims:l,header:r,signature:c},error:null}}const S=hC(r.alg),C=await crypto.subtle.importKey("jwk",m,S,!0,["verify"]);if(!await crypto.subtle.verify(S,C,c,$E(`${d}.${g}`)))throw new Zm("Invalid JWT signature");return{data:{claims:l,header:r,signature:c},error:null}}catch(a){if(ye(a))return{data:null,error:a};throw a}}}yh.nextInstanceID=0;const VC=yh;class YC extends VC{constructor(t){super(t)}}class KC{constructor(t,n,a){var r,l,c;this.supabaseUrl=t,this.supabaseKey=n;const d=IE(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const g=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:ME,realtime:jE,auth:Object.assign(Object.assign({},DE),{storageKey:g}),global:NE},S=PE(a??{},m);this.storageKey=(r=S.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(l=S.global.headers)!==null&&l!==void 0?l:{},S.accessToken?(this.accessToken=S.accessToken,this.auth=new Proxy({},{get:(C,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=S.auth)!==null&&c!==void 0?c:{},this.headers,S.global.fetch),this.fetch=zE(n,this._getAccessToken.bind(this),S.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},S.realtime)),this.rest=new G8(new URL("rest/v1",d).href,{headers:this.headers,schema:S.db.schema,fetch:this.fetch}),this.storage=new RE(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),S.accessToken||this._listenForAuthEvents()}get functions(){return new N8(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,a)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(n=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:a,storage:r,userStorage:l,storageKey:c,flowType:d,lock:g,debug:m},S,C){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new YC({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),S),storageKey:c,autoRefreshToken:t,persistSession:n,detectSessionInUrl:a,storage:r,userStorage:l,flowType:d,lock:g,debug:m,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(R=>R.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new aE(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,a)=>{this._handleTokenChanged(n,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,n,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const QC=(o,t,n)=>new KC(o,t,n);function XC(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const t=o.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}XC()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const FC="https://pmlwhqhezvczissdvuyc.supabase.co",JC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtbHdocWhlenZjemlzc2R2dXljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0MTA4MDUsImV4cCI6MjA3Njk4NjgwNX0.3W7AiFmapKzKJENDQ0H_Chz-V_AAw7a20fGOYlcCMb8",oa=QC(FC,JC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),WC=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,a)=>a?a.toUpperCase():n.toLowerCase()),k1=o=>{const t=WC(o);return t.charAt(0).toUpperCase()+t.slice(1)},bb=(...o)=>o.filter((t,n,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===n).join(" ").trim(),$C=o=>{for(const t in o)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eT=rt.forwardRef(({color:o="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:l,iconNode:c,...d},g)=>rt.createElement("svg",{ref:g,...tT,width:t,height:t,stroke:o,strokeWidth:a?Number(n)*24/Number(t):n,className:bb("lucide",r),...!l&&!$C(d)&&{"aria-hidden":"true"},...d},[...c.map(([m,S])=>rt.createElement(m,S)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=(o,t)=>{const n=rt.forwardRef(({className:a,...r},l)=>rt.createElement(eT,{ref:l,iconNode:t,className:bb(`lucide-${ZC(k1(o))}`,`lucide-${o}`,a),...r}));return n.displayName=k1(o),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nT=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],_b=Tf("eraser",nT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aT=[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]],iT=Tf("feather",aT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Eb=Tf("pen",rT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sT=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],Cb=Tf("redo",sT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Tb=Tf("trash-2",oT);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lT=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],Ab=Tf("undo",lT),q1="Feather_studentId",V1=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,o=>{const t=Math.random()*16|0;return(o==="x"?t:t&3|8).toString(16)}),uT=()=>{try{let o=localStorage.getItem(q1);return o?(console.log("📱 Using existing studentId:",o),o):(o=`student-${V1()}`,localStorage.setItem(q1,o),console.log("🆕 Created new studentId:",o),o)}catch{return console.warn("⚠️ localStorage unavailable, using session-only studentId"),`student-temp-${V1()}`}},cT="FeatherWhiteboardDB",Y1=1,Bn={STUDENT_WORK:"studentWork",TEACHER_ANNOTATIONS:"teacherAnnotations",SESSION_STATE:"sessionState"};let dg=null;const Mu=()=>new Promise((o,t)=>{if(dg){o(dg);return}const n=indexedDB.open(cT,Y1);n.onerror=()=>{console.error("❌ IndexedDB: Failed to open database",n.error),t(n.error)},n.onsuccess=()=>{dg=n.result,console.log("✅ IndexedDB: Database opened successfully"),o(dg)},n.onupgradeneeded=a=>{const r=a.target.result;if(console.log("🔧 IndexedDB: Upgrading database schema to version",Y1),!r.objectStoreNames.contains(Bn.STUDENT_WORK)){const l=r.createObjectStore(Bn.STUDENT_WORK,{keyPath:"id"});l.createIndex("studentId","studentId",{unique:!1}),l.createIndex("sessionId","sessionId",{unique:!1}),l.createIndex("questionId","questionId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1}),l.createIndex("composite",["studentId","sessionId","questionId"],{unique:!1}),console.log("✅ Created studentWork store")}if(!r.objectStoreNames.contains(Bn.TEACHER_ANNOTATIONS)){const l=r.createObjectStore(Bn.TEACHER_ANNOTATIONS,{keyPath:"id"});l.createIndex("sessionId","sessionId",{unique:!1}),l.createIndex("targetStudentId","targetStudentId",{unique:!1}),l.createIndex("questionId","questionId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1}),l.createIndex("composite",["sessionId","targetStudentId","questionId"],{unique:!1}),console.log("✅ Created teacherAnnotations store")}r.objectStoreNames.contains(Bn.SESSION_STATE)||(r.createObjectStore(Bn.SESSION_STATE,{keyPath:"sessionId"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("✅ Created sessionState store"))}}),hg=async(o,t,n,a,r,l=null)=>{try{const c=await Mu(),d=`${o}-${t}-${n}`,g={id:d,studentId:o,sessionId:t,questionId:n,lines:a,meta:r,teacherAnnotations:l||[],timestamp:Date.now()};await c.transaction(Bn.STUDENT_WORK,"readwrite").objectStore(Bn.STUDENT_WORK).put(g);const C=l?l.length:0;return console.log("💾 Saved student work to IndexedDB:",d,a.length,"lines,",C,"teacher annotations"),!0}catch(c){return console.error("❌ Failed to save student work:",c),!1}},K1=async(o,t,n)=>{try{const a=await Mu(),r=`${o}-${t}-${n}`,d=a.transaction(Bn.STUDENT_WORK,"readonly").objectStore(Bn.STUDENT_WORK).get(r);return new Promise((g,m)=>{d.onsuccess=()=>{var C,E;const S=d.result;if(S){const R=((C=S.teacherAnnotations)==null?void 0:C.length)||0;console.log("📂 Loaded student work from IndexedDB:",r,((E=S.lines)==null?void 0:E.length)||0,"lines,",R,"teacher annotations"),g(S)}else console.log("ℹ️ No saved student work found:",r),g(null)},d.onerror=()=>{console.error("❌ Failed to load student work:",d.error),m(d.error)}})}catch(a){return console.error("❌ Failed to load student work:",a),null}},Q1=async(o,t,n,a)=>{try{const r=await Mu(),l=`${o}-${t}-${n}`,c={id:l,sessionId:o,targetStudentId:t,questionId:n,annotations:a,timestamp:Date.now()};return await r.transaction(Bn.TEACHER_ANNOTATIONS,"readwrite").objectStore(Bn.TEACHER_ANNOTATIONS).put(c),console.log("💾 Saved teacher annotation to IndexedDB:",l,a.length,"lines"),!0}catch(r){return console.error("❌ Failed to save teacher annotation:",r),!1}},X1=async(o,t)=>{try{const n=await Mu(),a={sessionId:o,students:t.students||{},questionNumber:t.questionNumber||0,currentQuestionId:t.currentQuestionId||null,sharedImage:t.sharedImage||null,timestamp:Date.now()};await n.transaction(Bn.SESSION_STATE,"readwrite").objectStore(Bn.SESSION_STATE).put(a);const c=Object.keys(a.students).length;return console.log("💾 Saved session state to IndexedDB:",o,c,"students, Q",a.questionNumber),!0}catch(n){return console.error("❌ Failed to save session state:",n),!1}},fT=async o=>{try{const r=(await Mu()).transaction(Bn.SESSION_STATE,"readonly").objectStore(Bn.SESSION_STATE).get(o);return new Promise((l,c)=>{r.onsuccess=()=>{const d=r.result;if(d){const g=Object.keys(d.students||{}).length;console.log("📂 Loaded session state from IndexedDB:",o,g,"students, Q",d.questionNumber),l(d)}else console.log("ℹ️ No saved session state found:",o),l(null)},r.onerror=()=>{console.error("❌ Failed to load session state:",r.error),c(r.error)}})}catch(t){return console.error("❌ Failed to load session state:",t),null}},Wm=async o=>{try{const t=await Mu();let n=t.transaction(Bn.STUDENT_WORK,"readwrite"),a=n.objectStore(Bn.STUDENT_WORK),r=a.index("sessionId"),l=r.openCursor(IDBKeyRange.only(o));return await new Promise(c=>{l.onsuccess=d=>{const g=d.target.result;g?(g.delete(),g.continue()):c()}}),n=t.transaction(Bn.TEACHER_ANNOTATIONS,"readwrite"),a=n.objectStore(Bn.TEACHER_ANNOTATIONS),r=a.index("sessionId"),l=r.openCursor(IDBKeyRange.only(o)),await new Promise(c=>{l.onsuccess=d=>{const g=d.target.result;g?(g.delete(),g.continue()):c()}}),n=t.transaction(Bn.SESSION_STATE,"readwrite"),a=n.objectStore(Bn.SESSION_STATE),await a.delete(o),console.log("🗑️ Cleared all data for session:",o),!0}catch(t){return console.error("❌ Failed to clear session data:",t),!1}},wb=async(o=7)=>{try{const t=await Mu(),n=Date.now()-o*24*60*60*1e3;let a=0,r=t.transaction(Bn.STUDENT_WORK,"readwrite"),l=r.objectStore(Bn.STUDENT_WORK),c=l.index("timestamp"),d=c.openCursor(IDBKeyRange.upperBound(n));return await new Promise(g=>{d.onsuccess=m=>{const S=m.target.result;S?(S.delete(),a++,S.continue()):g()}}),r=t.transaction(Bn.TEACHER_ANNOTATIONS,"readwrite"),l=r.objectStore(Bn.TEACHER_ANNOTATIONS),c=l.index("timestamp"),d=c.openCursor(IDBKeyRange.upperBound(n)),await new Promise(g=>{d.onsuccess=m=>{const S=m.target.result;S?(S.delete(),a++,S.continue()):g()}}),r=t.transaction(Bn.SESSION_STATE,"readwrite"),l=r.objectStore(Bn.SESSION_STATE),c=l.index("timestamp"),d=c.openCursor(IDBKeyRange.upperBound(n)),await new Promise(g=>{d.onsuccess=m=>{const S=m.target.result;S?(S.delete(),a++,S.continue()):g()}}),a>0&&console.log(`🗑️ Cleaned up ${a} old records (older than ${o} days)`),a}catch(t){return console.error("❌ Failed to cleanup old sessions:",t),0}},Xr={width:800,height:600},dT=.65,hT=2.2,gg="studentCanvasPrefs",F1=2,J1=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,gT=({sharedImage:o,canvasWidth:t,canvasHeight:n})=>{const[a,r]=rt.useState(null);if(rt.useEffect(()=>{if(!o){r(null);return}const R=new window.Image;R.src=o.dataUrl,R.onload=()=>{r(R)}},[o]),!o||!a)return null;const l=a.naturalWidth||a.width,c=a.naturalHeight||a.height;if(!l||!c||!t||!n)return null;const d=l/c,g=t/n;let m,S,C,E;return d>g?(m=t,S=t/d,C=0,E=(n-S)/2):(S=n,m=n*d,C=(t-m)/2,E=0),m=Math.min(m,t),S=Math.min(S,n),k.jsx(lv,{image:a,x:C,y:E,width:m,height:S,listening:!1})};function pT(){const[o]=Sh(),t=bf(),n=o.get("room"),a=o.get("name"),[r,l]=rt.useState(null),c=rt.useRef({roomId:null,studentName:null,clientId:null}),[d,g]=rt.useState(null),[m,S]=rt.useState(null),[C,E]=rt.useState(!1),R=rt.useRef(null),[v,M]=rt.useState(null),[z,P]=rt.useState(null),[j,x]=rt.useState("loading"),[L,O]=rt.useState(null),[T,A]=rt.useState([]),[y,B]=rt.useState([]),[U,I]=rt.useState(null),[K,Q]=rt.useState("pen"),[X,Y]=rt.useState("black"),[D,H]=rt.useState(3),[F,tt]=rt.useState(!1),[at,Z]=rt.useState("stylus-only"),[it,st]=rt.useState("left"),[V,J]=rt.useState(J1()),W=rt.useRef(!1),[nt,dt]=rt.useState(!1),Rt=rt.useRef(null);rt.useEffect(()=>{(!n||!a)&&t(`/student-login${n?`?room=${n}`:""}`)},[n,a,t]),rt.useEffect(()=>{if(!n||!a)return;const Nt=c.current;if(Nt.clientId&&Nt.roomId===n&&Nt.studentName===a){g(Nt.clientId);return}const Ot=Math.random().toString(36).substring(2,8),Jt=Math.random().toString(36).substring(2,8),Ge=Date.now().toString(36).slice(-4),Ke=`student-${`${Ot}${Jt}${Ge}`}`;c.current={roomId:n,studentName:a,clientId:Ke},g(Ke)},[a,n]),rt.useEffect(()=>{const Nt=uT();S(Nt),wb(7).catch(Ot=>{console.error("Failed to cleanup old sessions:",Ot)})},[]);const Ut=rt.useRef(null);rt.useEffect(()=>{if(!v)return;const Nt=Ut.current;Nt&&Nt!==v&&(console.log("🔄 Session changed from",Nt,"to",v),console.log("🗑️ Clearing IndexedDB memory for old session:",Nt),Wm(Nt).then(()=>{console.log("✅ IndexedDB memory cleared for old session")}).catch(Ot=>{console.error("❌ Failed to clear old session data:",Ot)})),Ut.current=v},[v]),rt.useEffect(()=>{if(!(!n||!a)&&!(typeof window>"u"))try{const Nt=localStorage.getItem(gg);if(Nt){const Ot=JSON.parse(Nt);if(Ot.version!==F1){localStorage.removeItem(gg);return}Ot.tool&&Q(Ot.tool),Ot.color&&Y(Ot.color),typeof Ot.brushSize=="number"&&H(Ot.brushSize),Ot.inputMode&&Z(Ot.inputMode),Ot.toolbarPosition&&st(Ot.toolbarPosition)}}catch{localStorage.removeItem(gg)}},[n,a]),rt.useEffect(()=>{const Nt=()=>{J(J1())};return window.addEventListener("resize",Nt),()=>window.removeEventListener("resize",Nt)},[]),rt.useEffect(()=>{V&&(Z("all"),H(3))},[V]),rt.useEffect(()=>{if(!n||!a||typeof window>"u")return;if(oe.current){oe.current=!1;return}const Nt={version:F1,tool:K,color:X,brushSize:D,inputMode:at,toolbarPosition:it};localStorage.setItem(gg,JSON.stringify(Nt))},[K,X,D,at,it,n,a]);const Xt=rt.useRef([]),$t=rt.useRef([]),oe=rt.useRef(!0),kt=rt.useRef(T);rt.useEffect(()=>{kt.current=T},[T]);const Re=rt.useRef(y);rt.useEffect(()=>{Re.current=y},[y]);const Ee=rt.useRef(0),ze=rt.useRef(!1),Xe=rt.useRef(!1),nn=rt.useRef(null),fn=rt.useRef(null);rt.useEffect(()=>()=>{fn.current&&cancelAnimationFrame(fn.current)},[]),rt.useEffect(()=>()=>{Rt.current&&clearTimeout(Rt.current)},[]),rt.useEffect(()=>{const Nt=At.current;if(!Nt)return;const Ot=He=>{const Ke=He.target;Ke.closest("button")||Ke.closest(".student-toolbar")||Ke.closest(".student-topbar")||He.preventDefault()},Jt=He=>{He.preventDefault()},Ge=He=>{if(F)return He.preventDefault(),!1};return Nt.addEventListener("touchstart",Ot,{passive:!1}),Nt.addEventListener("touchmove",Ot,{passive:!1}),Nt.addEventListener("gesturestart",Jt,{passive:!1}),Nt.addEventListener("gesturechange",Jt,{passive:!1}),document.addEventListener("selectstart",Ge),()=>{Nt&&(Nt.removeEventListener("touchstart",Ot),Nt.removeEventListener("touchmove",Ot),Nt.removeEventListener("gesturestart",Jt),Nt.removeEventListener("gesturechange",Jt)),document.removeEventListener("selectstart",Ge)}},[F]);const At=rt.useRef(null),Ht=rt.useRef(null),[me,Se]=rt.useState(Xr),Oe=rt.useMemo(()=>Xr.width?me.width/Xr.width:1,[me.width]),$e=rt.useRef(me),xe=rt.useRef(Oe);rt.useEffect(()=>{$e.current=me,xe.current=Oe},[me,Oe]),rt.useEffect(()=>{if(!n||!a||!d||R.current===n)return;R.current=n;let Nt=!1;return(async()=>{try{const{data:Jt,error:Ge}=await oa.from("sessions").select("*").ilike("room_code",n).order("created_at",{ascending:!1}).limit(1);if(Ge){console.error("Session query error:",Ge),x("no-session");return}if(!Jt||Jt.length===0){console.log("No session found for room code:",n),x("no-session");return}const He=Jt[0];if(Nt)return;if(He.status==="ended"){console.log("Session found but already ended"),x("ended"),setTimeout(()=>t("/student-login"),3e3);return}M(He.id),x(He.status==="active"?"active":"waiting");const{data:Ke}=await oa.from("participants").select("*").eq("session_id",He.id).or(`student_id.eq.${m},client_id.eq.${d}`).maybeSingle();if(Ke){P(Ke.id),Ke.client_id!==d&&(await oa.from("participants").update({client_id:d}).eq("id",Ke.id),console.log("✅ Updated participant client_id after refresh"));return}if(Nt)return;const{data:Ne,error:ce}=await oa.from("participants").insert([{session_id:He.id,client_id:d,student_id:m,name:a,role:"student"}]).select().single();if(ce){console.error("Failed to create participant:",ce);return}if(Nt)return;P(Ne.id)}catch(Jt){console.error("Error initializing session:",Jt),x("no-session"),R.current=null}})(),()=>{Nt=!0}},[n,d,a]),rt.useEffect(()=>{if(!n||!a||!d)return;let Nt=null,Ot=null,Jt=!0,Ge=!1;const He=[];return(async()=>{try{Nt=new RS.Realtime({authUrl:"/api/token",authParams:{clientId:d}}),Nt.connection.on("connected",async()=>{if(Jt)if(E(!0),Ge&&Ot){console.log("🔄 Reconnected - re-entering presence and syncing state");try{await Ot.presence.enter({name:a,studentId:m,isVisible:!document.hidden}),console.log("✅ Re-entered presence as:",a,"with studentId:",m);let ce=kt.current;if((!ce||ce.length===0)&&m&&v&&L){console.log("🔄 In-memory state empty, loading from IndexedDB");const Le=await K1(m,v,L);Le!=null&&Le.lines&&(ce=Le.lines,A(Le.lines))}ce&&ce.length>0?(console.log("🔄 Publishing stroke count after reconnection:",ce.length,"lines"),await Ot.publish("student-stroke-count",{studentId:m,strokeCount:ce.length,timestamp:Date.now()}),Ee.current=ce.length,console.log("✅ Stroke count published")):(console.log("ℹ️ No strokes to report"),Ee.current=0),setTimeout(()=>{Jt&&(console.log("🔄 Requesting full state (question + annotations)"),Ot.publish("request-current-state",{clientId:d,studentId:m,timestamp:Date.now()}))},300)}catch(ce){console.error("❌ Error during reconnection:",ce)}}else Ge=!0}),Nt.connection.on("disconnected",()=>{Jt&&E(!1)}),Ot=Nt.channels.get(`room-${n}`);const Ne=(ce,Le)=>{Ot.subscribe(ce,Le),He.push({event:ce,handler:Le})};if(Ne("student-layer",()=>{}),Ne("teacher-annotation",ce=>{if(Jt&&(console.log("📨 Received teacher-annotation event. Target:",ce.data.targetStudentId,"My clientId:",d,"Match:",ce.data.targetStudentId===d),ce.data.targetStudentId===d)){const Le=ce.data.annotations||[];console.log("✅ ClientId matches! Applying",Le.length,"teacher annotation strokes"),ze.current=!0,B(Le),m&&v&&L&&hg(m,v,L,kt.current,{base:Xr,display:$e.current,scale:xe.current},Le).then(()=>{console.log("💾 Saved teacher annotation to IndexedDB")}).catch(Rn=>{console.error("❌ Failed to save teacher annotation to IndexedDB:",Rn)}),setTimeout(()=>{ze.current=!1},100)}}),Ne("teacher-image",ce=>{var Le,Rn,On,Ta;Jt&&I({dataUrl:(Le=ce.data)==null?void 0:Le.dataUrl,width:(Rn=ce.data)==null?void 0:Rn.width,height:(On=ce.data)==null?void 0:On.height,timestamp:(Ta=ce.data)==null?void 0:Ta.timestamp})}),Ne("teacher-template",ce=>{var Le,Rn,On,Ta,Pa;Jt&&I({dataUrl:(Le=ce.data)==null?void 0:Le.dataUrl,width:(Rn=ce.data)==null?void 0:Rn.width,height:(On=ce.data)==null?void 0:On.height,type:(Ta=ce.data)==null?void 0:Ta.type,timestamp:(Pa=ce.data)==null?void 0:Pa.timestamp})}),Ne("teacher-clear",()=>{Jt&&I(null)}),Ne("sync-full-state",ce=>{if(Jt&&ce.data.targetClientId===d){const{content:Le=null,questionId:Rn,annotations:On=[]}=ce.data;console.log("📨 Received sync-full-state:",{questionId:Rn,hasContent:!!Le,annotationCount:On.length}),I(Le||null),Rn!==void 0&&O(Rn||null),On.length>0&&(console.log("✅ Applying",On.length,"teacher annotations from sync"),ze.current=!0,B(On),m&&v&&L&&hg(m,v,L,kt.current,{base:Xr,display:$e.current,scale:xe.current},On),setTimeout(()=>{ze.current=!1},100))}}),Ne("sync-question-state",ce=>{if(Jt&&ce.data.targetClientId===d){const{content:Le=null,questionId:Rn}=ce.data;I(Le||null),Rn!==void 0&&O(Rn||null)}}),Ne("clear-all-drawings",ce=>{var Le;Jt&&((Le=ce.data)!=null&&Le.questionId&&O(ce.data.questionId),ze.current=!0,A([]),B([]),setTimeout(()=>{ze.current=!1},100))}),Ne("session-started",()=>{Jt&&x("active")}),Ne("session-ended",async()=>{Jt&&(console.log("🔚 Session ended - clearing IndexedDB memory for session:",v),v&&(await Wm(v),console.log("✅ IndexedDB memory cleared for ended session")),x("ended"),t("/student-login"))}),await Ot.presence.enter({name:a,studentId:m,isVisible:!document.hidden}),!Jt){await Ot.presence.leaveClient(d),Nt.close();return}l(Ot),setTimeout(()=>{Jt&&Ot.publish("request-current-state",{clientId:d,studentId:m,timestamp:Date.now()})},500)}catch(Ne){console.error("Failed to initialize Ably:",Ne)}})(),()=>{if(Jt=!1,Ot){He.forEach(({event:Ne,handler:ce})=>{Ot.unsubscribe(Ne,ce)});try{Ot.presence.leaveClient(d)}catch(Ne){console.error("Error leaving presence:",Ne)}}if(l(null),Nt)try{Nt.close()}catch(Ne){console.error("Error closing Ably:",Ne)}}},[d,n,a,t,m,v,L]),rt.useEffect(()=>{if(!r||W.current)return;W.current=!0;const Nt=()=>{const Ot=!document.hidden;r.presence.update({name:a,studentId:m,isVisible:Ot,lastVisibilityChange:Date.now()}),r.publish("student-visibility",{studentId:m,studentName:a,isVisible:Ot,timestamp:Date.now()})};return document.addEventListener("visibilitychange",Nt),()=>{W.current=!1,document.removeEventListener("visibilitychange",Nt)}},[r,d,a]),rt.useEffect(()=>{const Nt=At.current;if(!Nt)return;const Ot=()=>{if(!At.current)return;const Ge=At.current.getBoundingClientRect(),He=V?16:48,Ke=Math.max(280,Ge.width-He),Ne=Math.max(210,Ge.height-He),ce=Ke/Xr.width,Le=Ne/Xr.height,Rn=Math.min(ce,Le),Ta=Math.max(V?.35:dT,Math.min(hT,Rn)),Pa=Math.round(Ta*20)/20;Se({width:Math.round(Xr.width*Pa),height:Math.round(Xr.height*Pa)})};Ot(),window.addEventListener("resize",Ot);let Jt;return window.ResizeObserver&&(Jt=new ResizeObserver(()=>Ot()),Jt.observe(Nt)),()=>{window.removeEventListener("resize",Ot),Jt&&Jt.disconnect()}},[it,V]),rt.useEffect(()=>{if(!m||!v||!L||!r)return;(async()=>{console.log("🔄 Loading strokes from Redis for question:",L),dt(!0),Ee.current=0;try{const Ot=await fetch(`/api/strokes/load?sessionId=${v}&questionId=${L}&userId=${m}`);if(!Ot.ok)throw new Error("Failed to load strokes from Redis");const Jt=await Ot.json(),{studentStrokes:Ge=[],teacherStrokes:He=[]}=Jt;console.log("📂 Loaded from Redis:",Ge.length,"student strokes +",He.length,"teacher strokes"),ze.current=!0,A(Ge),B(He),(Ge.length>0||He.length>0)&&(await hg(m,v,L,Ge,{base:Xr,display:me,scale:Oe},He),console.log("💾 Backed up to IndexedDB")),setTimeout(()=>{r.publish("student-stroke-count",{studentId:m,strokeCount:Ge.length,timestamp:Date.now()}),Ee.current=Ge.length,ze.current=!1},100)}catch(Ot){console.error("❌ Failed to load from Redis, trying IndexedDB fallback:",Ot);try{const Jt=await K1(m,v,L);Jt!=null&&Jt.lines&&(ze.current=!0,A(Jt.lines),B(Jt.teacherAnnotations||[]),setTimeout(()=>{ze.current=!1},100),console.log("📂 Loaded from IndexedDB fallback:",Jt.lines.length,"lines"))}catch(Jt){console.error("❌ IndexedDB fallback also failed:",Jt)}}dt(!1)})()},[m,v,L,r,d,a,me,Oe]),rt.useEffect(()=>{if(!d||!r||ze.current)return;const Nt=setTimeout(async()=>{if(m&&v&&L){const Ot=T.length;await hg(m,v,L,T,{base:Xr,display:me,scale:Oe},Re.current),console.log("💾 Saved to IndexedDB:",Ot,"lines");try{await fetch("/api/strokes/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:v,questionId:L,userId:m,role:"student",strokes:T})}),console.log("☁️ Saved to Redis:",Ot,"lines")}catch(Jt){console.error("❌ Failed to save to Redis:",Jt)}}r.publish("student-stroke-count",{studentId:m,strokeCount:T.length,timestamp:Date.now()}),Ee.current=T.length},150);return()=>clearTimeout(Nt)},[T,r,d,me,Oe,a,m,v,L]),rt.useEffect(()=>{if(!v||!z||!L||j!=="active")return;const Ot=setInterval(async()=>{try{const{data:Jt,error:Ge}=await oa.from("annotations").select("id").eq("question_id",L).eq("participant_id",z).maybeSingle(),He={session_id:v,question_id:L,participant_id:z,student_lines:kt.current};if(Ge){console.error("Failed to query annotation:",Ge);return}if(Jt){const{error:Ke}=await oa.from("annotations").update(He).eq("id",Jt.id);Ke&&console.error("Failed to update annotation:",Ke)}else{const{error:Ke}=await oa.from("annotations").insert([He]);Ke&&console.error("Failed to create annotation:",Ke)}}catch(Jt){console.error("Auto-save error:",Jt)}},1e4);return()=>clearInterval(Ot)},[v,z,L,j]),rt.useEffect(()=>{if(!v||!z||!L||j!=="active")return;(async()=>{try{const{data:Ot}=await oa.from("annotations").select("id").eq("question_id",L).eq("participant_id",z).maybeSingle(),Jt={session_id:v,question_id:L,participant_id:z,student_lines:T};Ot?await oa.from("annotations").update(Jt).eq("id",Ot.id):await oa.from("annotations").insert([Jt])}catch(Ot){console.error("Error saving on question change:",Ot)}})()},[L]);const ct=Nt=>at!=="stylus-only"?!0:(Nt==null?void 0:Nt.pointerType)==="pen",Tt=Nt=>{const Ot=Nt.evt;if(nt){Ot!=null&&Ot.preventDefault&&Ot.preventDefault();return}if(!ct(Ot)){Ot!=null&&Ot.preventDefault&&Ot.preventDefault();return}const Jt=Nt.target.getStage();if(Jt&&Ot.pointerId!==void 0){const Ge=Jt.content;if(Ge&&Ge.setPointerCapture)try{Ge.setPointerCapture(Ot.pointerId)}catch{}}if(K==="pen"){tt(!0);const Ge=Jt.getPointerPosition(),He=Ge.x/Oe,Ke=Ge.y/Oe,Ne={tool:K,points:[He,Ke],color:X,strokeWidth:D/Oe};nn.current=Ne,Xt.current.push([...T]),$t.current=[],A([...T,Ne])}else K==="eraser"&&(tt(!0),Xe.current=!1);Ot.preventDefault&&Ot.preventDefault(),Ot.stopPropagation&&Ot.stopPropagation()},Mt=Nt=>{if(!F)return;const Ot=Nt.evt;if(!ct(Ot)){Ot!=null&&Ot.preventDefault&&Ot.preventDefault();return}const Ge=Nt.target.getStage().getPointerPosition();if(K==="pen"){if(nn.current){const He=Ge.x/Oe,Ke=Ge.y/Oe;nn.current.points=nn.current.points.concat([He,Ke]);const Ne=nn.current;fn.current&&cancelAnimationFrame(fn.current),fn.current=requestAnimationFrame(()=>{Ne&&A(ce=>ce.length>0?[...ce.slice(0,-1),Ne]:ce)})}}else if(K==="eraser"){const He=T.length,Ke=Ge.x,Ne=Ge.y,ce=20,Le=T.filter(Rn=>{for(let On=0;On<Rn.points.length;On+=2){const Ta=Rn.points[On]*Oe,Pa=Rn.points[On+1]*Oe;if(Math.sqrt(Math.pow(Ta-Ke,2)+Math.pow(Pa-Ne,2))<ce)return!1}return!0});Le.length<He&&!Xe.current&&(Xt.current.push([...T]),$t.current=[],Xe.current=!0),A(Le)}Ot!=null&&Ot.preventDefault&&Ot.preventDefault(),Ot!=null&&Ot.stopPropagation&&Ot.stopPropagation()},Pt=Nt=>{const Ot=Nt==null?void 0:Nt.evt;if(!ct(Ot)){Ot!=null&&Ot.preventDefault&&Ot.preventDefault();return}tt(!1),nn.current=null},se=()=>{if(Xt.current.length>0){const Nt=Xt.current.pop();$t.current.push([...T]),A(Nt)}},zt=()=>{if($t.current.length>0){const Nt=$t.current.pop();Xt.current.push([...T]),A(Nt)}},ee=async()=>{if(Xt.current.push([...T]),$t.current=[],A([]),v&&L&&m)try{await fetch("/api/strokes/clear",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:v,questionId:L,userId:m,role:"student"})}),console.log("🗑️ Cleared student strokes from Redis")}catch(Nt){console.error("❌ Failed to clear from Redis:",Nt)}r&&await r.publish("student-stroke-count",{studentId:m,strokeCount:0,timestamp:Date.now()})},qt=()=>{var Nt;return d?((Nt=d.split("-")[1])==null?void 0:Nt.substring(0,3))||d:"---"},an=()=>{Z(Nt=>Nt==="stylus-only"?"all":"stylus-only")},Ae=()=>{st(Nt=>Nt==="left"?"right":"left")},re=()=>`Connected as ${a&&a!=="Anonymous"?a:qt()}`,tn=C?"Connected":"Reconnecting…",_n=C?"online":"offline",ea=Nt=>Nt.map((Ot,Jt)=>Ot*Oe),Xn=Nt=>(Nt.strokeWidth||3)*Oe;return!n||!a?null:k.jsxs("div",{className:"student-canvas-page",children:[j==="loading"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-spinner"}),k.jsx("h2",{children:"Connecting to session..."}),k.jsx("p",{children:"Please wait while we verify your session"})]})}),j==="waiting"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:"⏳"}),k.jsx("h2",{children:"Waiting for teacher"}),k.jsx("p",{children:"Your teacher hasn't started the session yet. Please wait..."})]})}),j==="no-session"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:"🔍"}),k.jsx("h2",{children:"No session found"}),k.jsxs("p",{children:['There is no active session for room code "',n,'".']}),k.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem"},children:"Please make sure your teacher has started a session, or verify the room code is correct."}),k.jsx("button",{onClick:()=>t("/student-login"),style:{marginTop:"1.5rem",padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"transform 0.2s"},onMouseEnter:Nt=>Nt.target.style.transform="scale(1.05)",onMouseLeave:Nt=>Nt.target.style.transform="scale(1)",children:"Back to Login"})]})}),j==="ended"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon ended",children:"✓"}),k.jsx("h2",{children:"Session ended"}),k.jsx("p",{children:"Thank you for participating! The teacher has ended this session."}),k.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",opacity:.8},children:"Redirecting to login..."})]})}),nt&&j==="active"&&k.jsx("div",{className:"session-overlay",style:{background:"rgba(0, 0, 0, 0.5)"},children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-spinner"}),k.jsx("h2",{children:"Restoring canvas..."}),k.jsx("p",{children:"Loading your previous work and teacher annotations"})]})}),k.jsxs("div",{className:"student-canvas-container",children:[k.jsxs("div",{className:"student-status-bar",children:[k.jsxs("div",{className:"student-status-text",children:[k.jsxs("h1",{children:["Student Canvas",n&&k.jsxs("span",{style:{marginLeft:"0.75rem",fontSize:"0.75rem",fontWeight:"400",color:"rgba(0, 0, 0, 0.4)",letterSpacing:"0.5px"},children:["Session: ",n]})]}),k.jsx("p",{children:re()})]}),k.jsxs("div",{className:"student-status-actions",children:[!V&&k.jsxs(k.Fragment,{children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:K==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",at==="all"?"All inputs":"Stylus only"]})}),k.jsxs("div",{className:`connection-pill ${_n}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:tn})]}),k.jsxs("button",{className:"move-toolbar-btn",onClick:Ae,children:["Move toolbar to ",it==="left"?"right":"left"]})]}),V&&k.jsxs("div",{className:`connection-pill ${_n}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:tn})]})]})]}),k.jsxs("div",{className:`student-workspace ${it==="right"?"toolbar-right":""} ${V?"mobile-view":""}`,children:[V?k.jsxs("div",{className:"mobile-toolbar",children:[k.jsxs("div",{className:"mobile-colors",children:[k.jsx("button",{onClick:()=>Y("black"),className:`mobile-color-button ${X==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>Y("#0066FF"),className:`mobile-color-button ${X==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>Y("#00AA00"),className:`mobile-color-button ${X==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>Q("pen"),className:`mobile-tool-button ${K==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(Eb,{size:20})}),k.jsx("button",{onClick:()=>Q("eraser"),className:`mobile-tool-button ${K==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(_b,{size:20})}),k.jsx("button",{onClick:se,className:"mobile-tool-button",disabled:Xt.current.length===0,"aria-label":"Undo",children:k.jsx(Ab,{size:20})}),k.jsx("button",{onClick:zt,className:"mobile-tool-button",disabled:$t.current.length===0,"aria-label":"Redo",children:k.jsx(Cb,{size:20})}),k.jsx("button",{onClick:ee,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(Tb,{size:20})})]})]}):k.jsxs("div",{className:"student-sidebar",children:[k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsxs("div",{className:"color-buttons",children:[k.jsx("button",{onClick:()=>Y("black"),className:`color-button ${X==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>Y("#0066FF"),className:`color-button ${X==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>Y("#00AA00"),className:`color-button ${X==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>Q("pen"),className:`tool-icon-button ${K==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>Q("eraser"),className:`tool-icon-button ${K==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsx("div",{className:"brush-size-control",children:k.jsxs("div",{className:"brush-slider-container",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:D,onChange:Nt=>H(parseInt(Nt.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:D})]})})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${at==="all"?"all-inputs":""}`,onClick:an,children:at==="stylus-only"?"Stylus mode (pen only)":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:se,className:"history-button",disabled:Xt.current.length===0,children:"Undo"}),k.jsx("button",{onClick:zt,className:"history-button",disabled:$t.current.length===0,children:"Redo"}),k.jsx("button",{onClick:ee,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"student-canvas-panel",ref:At,children:k.jsx("div",{className:"student-canvas-frame",children:k.jsx("div",{className:"student-canvas-surface",style:{width:`${me.width}px`,height:`${me.height}px`},children:k.jsxs(Bg,{ref:Ht,width:me.width,height:me.height,onPointerDown:Tt,onPointerMove:Mt,onPointerUp:Pt,onPointerLeave:Pt,onTouchStart:Nt=>{var Ot,Jt;(Jt=(Ot=Nt.evt)==null?void 0:Ot.preventDefault)==null||Jt.call(Ot)},onTouchMove:Nt=>{var Ot,Jt;(Jt=(Ot=Nt.evt)==null?void 0:Ot.preventDefault)==null||Jt.call(Ot)},onTouchEnd:Nt=>{var Ot,Jt;(Jt=(Ot=Nt.evt)==null?void 0:Ot.preventDefault)==null||Jt.call(Ot)},className:"canvas-stage",style:{touchAction:"none"},perfectDrawEnabled:!1,children:[k.jsx(Wr,{listening:!1,children:k.jsx(gT,{sharedImage:U,canvasWidth:me.width,canvasHeight:me.height})}),k.jsx(Wr,{children:T.map((Nt,Ot)=>k.jsx(Sl,{points:ea(Nt.points),stroke:Nt.color,strokeWidth:Xn(Nt),tension:.5,lineCap:"round",lineJoin:"round"},`student-${Ot}`))}),k.jsx(Wr,{listening:!1,children:y.map((Nt,Ot)=>k.jsx(Sl,{points:ea(Nt.points),stroke:Nt.color,strokeWidth:Xn(Nt),tension:.5,lineCap:"round",lineJoin:"round"},`teacher-${Ot}`))})]})})})})]})]})]})}const Z1="Feather_username";function mT(){const[o]=Sh(),t=bf(),[n,a]=rt.useState(""),[r,l]=rt.useState(""),[c,d]=rt.useState(""),[g,m]=rt.useState(!1);rt.useEffect(()=>{const C=localStorage.getItem(Z1);C&&a(C);const E=o.get("room");E&&l(E.toUpperCase())},[o]);const S=async C=>{if(C.preventDefault(),!n.trim()){d("Please enter your name");return}if(!r.trim()){d("Please enter a session code");return}m(!0),d(""),localStorage.setItem(Z1,n.trim());try{const E=(await xu(async()=>{const{default:P}=await Promise.resolve().then(()=>ST);return{default:P}},void 0)).default,R=new E.Realtime({authUrl:"/api/token",authParams:{clientId:`ping-${Date.now()}`}});await new Promise((P,j)=>{const x=setTimeout(()=>j(new Error("Connection timeout")),8e3);R.connection.once("connected",()=>{clearTimeout(x),P()}),R.connection.once("failed",()=>{clearTimeout(x),j(new Error("Connection failed"))})});const z=(await R.channels.get(`room-${r.trim().toUpperCase()}`).presence.get()).some(P=>P.clientId.startsWith("teacher-"));if(R.close(),!z){d("No active teacher found. Please check your session code."),m(!1);return}t(`/student?room=${r.trim().toUpperCase()}&name=${encodeURIComponent(n.trim())}`)}catch(E){console.error("Failed to connect:",E),d("Failed to connect to session. Please try again."),m(!1)}};return k.jsx("div",{className:"student-login-page",children:k.jsxs("div",{className:"student-login-card",children:[k.jsx("h1",{children:"Student Login"}),k.jsx("p",{className:"login-subtitle",children:"Join your classroom session to start drawing."}),k.jsxs("form",{onSubmit:S,children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"name",children:"Name"}),k.jsx("input",{id:"name",type:"text",placeholder:"Your name",value:n,onChange:C=>{a(C.target.value),d("")},autoFocus:!0,maxLength:50})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"sessionCode",children:"Session code"}),k.jsx("input",{id:"sessionCode",type:"text",placeholder:"SESSION CODE (E.G., ABC123)",value:r,onChange:C=>{l(C.target.value.toUpperCase()),d("")},maxLength:10})]}),c&&k.jsx("div",{className:"login-error",children:c}),k.jsx("button",{type:"submit",className:"join-button",disabled:g,children:g?"Checking session...":"Join Session"})]})]})})}var tm,W1;function vT(){if(W1)return tm;W1=1;function o(l){return typeof l=="string"&&(l=l.indexOf(":")==-1?{token:l}:{key:l}),l.promises=!0,l}var t=wS(),n=function(l,c,d,g){return new t.ErrorInfo(l,c,d,g)},a=function(l){return new t.Rest(o(l))};Object.assign(a,t.Rest);var r=function(l){return new t.Realtime(o(l))};return Object.assign(r,t.Realtime),tm={ErrorInfo:n,Rest:a,Realtime:r},tm}var yT=vT();const yv=vf(yT),ST=Object.freeze(Object.defineProperty({__proto__:null,default:yv},Symbol.toStringTag,{value:"Module"}));var sf={},em,$1;function bT(){return $1||($1=1,em=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),em}var nm={},dl={},t2;function Du(){if(t2)return dl;t2=1;let o;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return dl.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17},dl.getSymbolTotalCodewords=function(a){return t[a]},dl.getBCHDigit=function(n){let a=0;for(;n!==0;)a++,n>>>=1;return a},dl.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');o=a},dl.isKanjiModeEnabled=function(){return typeof o<"u"},dl.toSJIS=function(a){return o(a)},dl}var am={},e2;function Sv(){return e2||(e2=1,(function(o){o.L={bit:1},o.M={bit:0},o.Q={bit:3},o.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return o.L;case"m":case"medium":return o.M;case"q":case"quartile":return o.Q;case"h":case"high":return o.H;default:throw new Error("Unknown EC Level: "+n)}}o.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},o.from=function(a,r){if(o.isValid(a))return a;try{return t(a)}catch{return r}}})(am)),am}var im,n2;function _T(){if(n2)return im;n2=1;function o(){this.buffer=[],this.length=0}return o.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let a=0;a<n;a++)this.putBit((t>>>n-a-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},im=o,im}var rm,a2;function ET(){if(a2)return rm;a2=1;function o(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return o.prototype.set=function(t,n,a,r){const l=t*this.size+n;this.data[l]=a,r&&(this.reservedBit[l]=!0)},o.prototype.get=function(t,n){return this.data[t*this.size+n]},o.prototype.xor=function(t,n,a){this.data[t*this.size+n]^=a},o.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},rm=o,rm}var sm={},i2;function CT(){return i2||(i2=1,(function(o){const t=Du().getSymbolSize;o.getRowColCoords=function(a){if(a===1)return[];const r=Math.floor(a/7)+2,l=t(a),c=l===145?26:Math.ceil((l-13)/(2*r-2))*2,d=[l-7];for(let g=1;g<r-1;g++)d[g]=d[g-1]-c;return d.push(6),d.reverse()},o.getPositions=function(a){const r=[],l=o.getRowColCoords(a),c=l.length;for(let d=0;d<c;d++)for(let g=0;g<c;g++)d===0&&g===0||d===0&&g===c-1||d===c-1&&g===0||r.push([l[d],l[g]]);return r}})(sm)),sm}var om={},r2;function TT(){if(r2)return om;r2=1;const o=Du().getSymbolSize,t=7;return om.getPositions=function(a){const r=o(a);return[[0,0],[r-t,0],[0,r-t]]},om}var lm={},s2;function AT(){return s2||(s2=1,(function(o){o.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};o.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},o.from=function(r){return o.isValid(r)?parseInt(r,10):void 0},o.getPenaltyN1=function(r){const l=r.size;let c=0,d=0,g=0,m=null,S=null;for(let C=0;C<l;C++){d=g=0,m=S=null;for(let E=0;E<l;E++){let R=r.get(C,E);R===m?d++:(d>=5&&(c+=t.N1+(d-5)),m=R,d=1),R=r.get(E,C),R===S?g++:(g>=5&&(c+=t.N1+(g-5)),S=R,g=1)}d>=5&&(c+=t.N1+(d-5)),g>=5&&(c+=t.N1+(g-5))}return c},o.getPenaltyN2=function(r){const l=r.size;let c=0;for(let d=0;d<l-1;d++)for(let g=0;g<l-1;g++){const m=r.get(d,g)+r.get(d,g+1)+r.get(d+1,g)+r.get(d+1,g+1);(m===4||m===0)&&c++}return c*t.N2},o.getPenaltyN3=function(r){const l=r.size;let c=0,d=0,g=0;for(let m=0;m<l;m++){d=g=0;for(let S=0;S<l;S++)d=d<<1&2047|r.get(m,S),S>=10&&(d===1488||d===93)&&c++,g=g<<1&2047|r.get(S,m),S>=10&&(g===1488||g===93)&&c++}return c*t.N3},o.getPenaltyN4=function(r){let l=0;const c=r.data.length;for(let g=0;g<c;g++)l+=r.data[g];return Math.abs(Math.ceil(l*100/c/5)-10)*t.N4};function n(a,r,l){switch(a){case o.Patterns.PATTERN000:return(r+l)%2===0;case o.Patterns.PATTERN001:return r%2===0;case o.Patterns.PATTERN010:return l%3===0;case o.Patterns.PATTERN011:return(r+l)%3===0;case o.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(l/3))%2===0;case o.Patterns.PATTERN101:return r*l%2+r*l%3===0;case o.Patterns.PATTERN110:return(r*l%2+r*l%3)%2===0;case o.Patterns.PATTERN111:return(r*l%3+(r+l)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}o.applyMask=function(r,l){const c=l.size;for(let d=0;d<c;d++)for(let g=0;g<c;g++)l.isReserved(g,d)||l.xor(g,d,n(r,g,d))},o.getBestMask=function(r,l){const c=Object.keys(o.Patterns).length;let d=0,g=1/0;for(let m=0;m<c;m++){l(m),o.applyMask(m,r);const S=o.getPenaltyN1(r)+o.getPenaltyN2(r)+o.getPenaltyN3(r)+o.getPenaltyN4(r);o.applyMask(m,r),S<g&&(g=S,d=m)}return d}})(lm)),lm}var pg={},o2;function Rb(){if(o2)return pg;o2=1;const o=Sv(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return pg.getBlocksCount=function(r,l){switch(l){case o.L:return t[(r-1)*4+0];case o.M:return t[(r-1)*4+1];case o.Q:return t[(r-1)*4+2];case o.H:return t[(r-1)*4+3];default:return}},pg.getTotalCodewordsCount=function(r,l){switch(l){case o.L:return n[(r-1)*4+0];case o.M:return n[(r-1)*4+1];case o.Q:return n[(r-1)*4+2];case o.H:return n[(r-1)*4+3];default:return}},pg}var um={},$d={},l2;function wT(){if(l2)return $d;l2=1;const o=new Uint8Array(512),t=new Uint8Array(256);return(function(){let a=1;for(let r=0;r<255;r++)o[r]=a,t[a]=r,a<<=1,a&256&&(a^=285);for(let r=255;r<512;r++)o[r]=o[r-255]})(),$d.log=function(a){if(a<1)throw new Error("log("+a+")");return t[a]},$d.exp=function(a){return o[a]},$d.mul=function(a,r){return a===0||r===0?0:o[t[a]+t[r]]},$d}var u2;function RT(){return u2||(u2=1,(function(o){const t=wT();o.mul=function(a,r){const l=new Uint8Array(a.length+r.length-1);for(let c=0;c<a.length;c++)for(let d=0;d<r.length;d++)l[c+d]^=t.mul(a[c],r[d]);return l},o.mod=function(a,r){let l=new Uint8Array(a);for(;l.length-r.length>=0;){const c=l[0];for(let g=0;g<r.length;g++)l[g]^=t.mul(r[g],c);let d=0;for(;d<l.length&&l[d]===0;)d++;l=l.slice(d)}return l},o.generateECPolynomial=function(a){let r=new Uint8Array([1]);for(let l=0;l<a;l++)r=o.mul(r,new Uint8Array([1,t.exp(l)]));return r}})(um)),um}var cm,c2;function OT(){if(c2)return cm;c2=1;const o=RT();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(a){this.degree=a,this.genPoly=o.generateECPolynomial(this.degree)},t.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(a.length+this.degree);r.set(a);const l=o.mod(r,this.genPoly),c=this.degree-l.length;if(c>0){const d=new Uint8Array(this.degree);return d.set(l,c),d}return l},cm=t,cm}var fm={},dm={},hm={},f2;function Ob(){return f2||(f2=1,hm.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),hm}var Os={},d2;function xb(){if(d2)return Os;d2=1;const o="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Os.KANJI=new RegExp(n,"g"),Os.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Os.BYTE=new RegExp(a,"g"),Os.NUMERIC=new RegExp(o,"g"),Os.ALPHANUMERIC=new RegExp(t,"g");const r=new RegExp("^"+n+"$"),l=new RegExp("^"+o+"$"),c=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Os.testKanji=function(g){return r.test(g)},Os.testNumeric=function(g){return l.test(g)},Os.testAlphanumeric=function(g){return c.test(g)},Os}var h2;function ju(){return h2||(h2=1,(function(o){const t=Ob(),n=xb();o.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},o.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},o.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},o.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},o.MIXED={bit:-1},o.getCharCountIndicator=function(l,c){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!t.isValid(c))throw new Error("Invalid version: "+c);return c>=1&&c<10?l.ccBits[0]:c<27?l.ccBits[1]:l.ccBits[2]},o.getBestModeForData=function(l){return n.testNumeric(l)?o.NUMERIC:n.testAlphanumeric(l)?o.ALPHANUMERIC:n.testKanji(l)?o.KANJI:o.BYTE},o.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},o.isValid=function(l){return l&&l.bit&&l.ccBits};function a(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return o.NUMERIC;case"alphanumeric":return o.ALPHANUMERIC;case"kanji":return o.KANJI;case"byte":return o.BYTE;default:throw new Error("Unknown mode: "+r)}}o.from=function(l,c){if(o.isValid(l))return l;try{return a(l)}catch{return c}}})(dm)),dm}var g2;function xT(){return g2||(g2=1,(function(o){const t=Du(),n=Rb(),a=Sv(),r=ju(),l=Ob(),c=7973,d=t.getBCHDigit(c);function g(E,R,v){for(let M=1;M<=40;M++)if(R<=o.getCapacity(M,v,E))return M}function m(E,R){return r.getCharCountIndicator(E,R)+4}function S(E,R){let v=0;return E.forEach(function(M){const z=m(M.mode,R);v+=z+M.getBitsLength()}),v}function C(E,R){for(let v=1;v<=40;v++)if(S(E,v)<=o.getCapacity(v,R,r.MIXED))return v}o.from=function(R,v){return l.isValid(R)?parseInt(R,10):v},o.getCapacity=function(R,v,M){if(!l.isValid(R))throw new Error("Invalid QR Code version");typeof M>"u"&&(M=r.BYTE);const z=t.getSymbolTotalCodewords(R),P=n.getTotalCodewordsCount(R,v),j=(z-P)*8;if(M===r.MIXED)return j;const x=j-m(M,R);switch(M){case r.NUMERIC:return Math.floor(x/10*3);case r.ALPHANUMERIC:return Math.floor(x/11*2);case r.KANJI:return Math.floor(x/13);case r.BYTE:default:return Math.floor(x/8)}},o.getBestVersionForData=function(R,v){let M;const z=a.from(v,a.M);if(Array.isArray(R)){if(R.length>1)return C(R,z);if(R.length===0)return 1;M=R[0]}else M=R;return g(M.mode,M.getLength(),z)},o.getEncodedBits=function(R){if(!l.isValid(R)||R<7)throw new Error("Invalid QR Code version");let v=R<<12;for(;t.getBCHDigit(v)-d>=0;)v^=c<<t.getBCHDigit(v)-d;return R<<12|v}})(fm)),fm}var gm={},p2;function NT(){if(p2)return gm;p2=1;const o=Du(),t=1335,n=21522,a=o.getBCHDigit(t);return gm.getEncodedBits=function(l,c){const d=l.bit<<3|c;let g=d<<10;for(;o.getBCHDigit(g)-a>=0;)g^=t<<o.getBCHDigit(g)-a;return(d<<10|g)^n},gm}var pm={},mm,m2;function MT(){if(m2)return mm;m2=1;const o=ju();function t(n){this.mode=o.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(a){let r,l,c;for(r=0;r+3<=this.data.length;r+=3)l=this.data.substr(r,3),c=parseInt(l,10),a.put(c,10);const d=this.data.length-r;d>0&&(l=this.data.substr(r),c=parseInt(l,10),a.put(c,d*3+1))},mm=t,mm}var vm,v2;function DT(){if(v2)return vm;v2=1;const o=ju(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(a){this.mode=o.ALPHANUMERIC,this.data=a}return n.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let l;for(l=0;l+2<=this.data.length;l+=2){let c=t.indexOf(this.data[l])*45;c+=t.indexOf(this.data[l+1]),r.put(c,11)}this.data.length%2&&r.put(t.indexOf(this.data[l]),6)},vm=n,vm}var ym,y2;function jT(){if(y2)return ym;y2=1;const o=ju();function t(n){this.mode=o.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(a){return a*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let a=0,r=this.data.length;a<r;a++)n.put(this.data[a],8)},ym=t,ym}var Sm,S2;function UT(){if(S2)return Sm;S2=1;const o=ju(),t=Du();function n(a){this.mode=o.KANJI,this.data=a}return n.getBitsLength=function(r){return r*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(a){let r;for(r=0;r<this.data.length;r++){let l=t.toSJIS(this.data[r]);if(l>=33088&&l<=40956)l-=33088;else if(l>=57408&&l<=60351)l-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);l=(l>>>8&255)*192+(l&255),a.put(l,13)}},Sm=n,Sm}var bm={exports:{}},b2;function BT(){return b2||(b2=1,(function(o){var t={single_source_shortest_paths:function(n,a,r){var l={},c={};c[a]=0;var d=t.PriorityQueue.make();d.push(a,0);for(var g,m,S,C,E,R,v,M,z;!d.empty();){g=d.pop(),m=g.value,C=g.cost,E=n[m]||{};for(S in E)E.hasOwnProperty(S)&&(R=E[S],v=C+R,M=c[S],z=typeof c[S]>"u",(z||M>v)&&(c[S]=v,d.push(S,v),l[S]=m))}if(typeof r<"u"&&typeof c[r]>"u"){var P=["Could not find a path from ",a," to ",r,"."].join("");throw new Error(P)}return l},extract_shortest_path_from_predecessor_list:function(n,a){for(var r=[],l=a;l;)r.push(l),n[l],l=n[l];return r.reverse(),r},find_path:function(n,a,r){var l=t.single_source_shortest_paths(n,a,r);return t.extract_shortest_path_from_predecessor_list(l,r)},PriorityQueue:{make:function(n){var a=t.PriorityQueue,r={},l;n=n||{};for(l in a)a.hasOwnProperty(l)&&(r[l]=a[l]);return r.queue=[],r.sorter=n.sorter||a.default_sorter,r},default_sorter:function(n,a){return n.cost-a.cost},push:function(n,a){var r={value:n,cost:a};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};o.exports=t})(bm)),bm.exports}var _2;function zT(){return _2||(_2=1,(function(o){const t=ju(),n=MT(),a=DT(),r=jT(),l=UT(),c=xb(),d=Du(),g=BT();function m(P){return unescape(encodeURIComponent(P)).length}function S(P,j,x){const L=[];let O;for(;(O=P.exec(x))!==null;)L.push({data:O[0],index:O.index,mode:j,length:O[0].length});return L}function C(P){const j=S(c.NUMERIC,t.NUMERIC,P),x=S(c.ALPHANUMERIC,t.ALPHANUMERIC,P);let L,O;return d.isKanjiModeEnabled()?(L=S(c.BYTE,t.BYTE,P),O=S(c.KANJI,t.KANJI,P)):(L=S(c.BYTE_KANJI,t.BYTE,P),O=[]),j.concat(x,L,O).sort(function(A,y){return A.index-y.index}).map(function(A){return{data:A.data,mode:A.mode,length:A.length}})}function E(P,j){switch(j){case t.NUMERIC:return n.getBitsLength(P);case t.ALPHANUMERIC:return a.getBitsLength(P);case t.KANJI:return l.getBitsLength(P);case t.BYTE:return r.getBitsLength(P)}}function R(P){return P.reduce(function(j,x){const L=j.length-1>=0?j[j.length-1]:null;return L&&L.mode===x.mode?(j[j.length-1].data+=x.data,j):(j.push(x),j)},[])}function v(P){const j=[];for(let x=0;x<P.length;x++){const L=P[x];switch(L.mode){case t.NUMERIC:j.push([L,{data:L.data,mode:t.ALPHANUMERIC,length:L.length},{data:L.data,mode:t.BYTE,length:L.length}]);break;case t.ALPHANUMERIC:j.push([L,{data:L.data,mode:t.BYTE,length:L.length}]);break;case t.KANJI:j.push([L,{data:L.data,mode:t.BYTE,length:m(L.data)}]);break;case t.BYTE:j.push([{data:L.data,mode:t.BYTE,length:m(L.data)}])}}return j}function M(P,j){const x={},L={start:{}};let O=["start"];for(let T=0;T<P.length;T++){const A=P[T],y=[];for(let B=0;B<A.length;B++){const U=A[B],I=""+T+B;y.push(I),x[I]={node:U,lastCount:0},L[I]={};for(let K=0;K<O.length;K++){const Q=O[K];x[Q]&&x[Q].node.mode===U.mode?(L[Q][I]=E(x[Q].lastCount+U.length,U.mode)-E(x[Q].lastCount,U.mode),x[Q].lastCount+=U.length):(x[Q]&&(x[Q].lastCount=U.length),L[Q][I]=E(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,j))}}O=y}for(let T=0;T<O.length;T++)L[O[T]].end=0;return{map:L,table:x}}function z(P,j){let x;const L=t.getBestModeForData(P);if(x=t.from(j,L),x!==t.BYTE&&x.bit<L.bit)throw new Error('"'+P+'" cannot be encoded with mode '+t.toString(x)+`.
 Suggested mode is: `+t.toString(L));switch(x===t.KANJI&&!d.isKanjiModeEnabled()&&(x=t.BYTE),x){case t.NUMERIC:return new n(P);case t.ALPHANUMERIC:return new a(P);case t.KANJI:return new l(P);case t.BYTE:return new r(P)}}o.fromArray=function(j){return j.reduce(function(x,L){return typeof L=="string"?x.push(z(L,null)):L.data&&x.push(z(L.data,L.mode)),x},[])},o.fromString=function(j,x){const L=C(j,d.isKanjiModeEnabled()),O=v(L),T=M(O,x),A=g.find_path(T.map,"start","end"),y=[];for(let B=1;B<A.length-1;B++)y.push(T.table[A[B]].node);return o.fromArray(R(y))},o.rawSplit=function(j){return o.fromArray(C(j,d.isKanjiModeEnabled()))}})(pm)),pm}var E2;function LT(){if(E2)return nm;E2=1;const o=Du(),t=Sv(),n=_T(),a=ET(),r=CT(),l=TT(),c=AT(),d=Rb(),g=OT(),m=xT(),S=NT(),C=ju(),E=zT();function R(T,A){const y=T.size,B=l.getPositions(A);for(let U=0;U<B.length;U++){const I=B[U][0],K=B[U][1];for(let Q=-1;Q<=7;Q++)if(!(I+Q<=-1||y<=I+Q))for(let X=-1;X<=7;X++)K+X<=-1||y<=K+X||(Q>=0&&Q<=6&&(X===0||X===6)||X>=0&&X<=6&&(Q===0||Q===6)||Q>=2&&Q<=4&&X>=2&&X<=4?T.set(I+Q,K+X,!0,!0):T.set(I+Q,K+X,!1,!0))}}function v(T){const A=T.size;for(let y=8;y<A-8;y++){const B=y%2===0;T.set(y,6,B,!0),T.set(6,y,B,!0)}}function M(T,A){const y=r.getPositions(A);for(let B=0;B<y.length;B++){const U=y[B][0],I=y[B][1];for(let K=-2;K<=2;K++)for(let Q=-2;Q<=2;Q++)K===-2||K===2||Q===-2||Q===2||K===0&&Q===0?T.set(U+K,I+Q,!0,!0):T.set(U+K,I+Q,!1,!0)}}function z(T,A){const y=T.size,B=m.getEncodedBits(A);let U,I,K;for(let Q=0;Q<18;Q++)U=Math.floor(Q/3),I=Q%3+y-8-3,K=(B>>Q&1)===1,T.set(U,I,K,!0),T.set(I,U,K,!0)}function P(T,A,y){const B=T.size,U=S.getEncodedBits(A,y);let I,K;for(I=0;I<15;I++)K=(U>>I&1)===1,I<6?T.set(I,8,K,!0):I<8?T.set(I+1,8,K,!0):T.set(B-15+I,8,K,!0),I<8?T.set(8,B-I-1,K,!0):I<9?T.set(8,15-I-1+1,K,!0):T.set(8,15-I-1,K,!0);T.set(B-8,8,1,!0)}function j(T,A){const y=T.size;let B=-1,U=y-1,I=7,K=0;for(let Q=y-1;Q>0;Q-=2)for(Q===6&&Q--;;){for(let X=0;X<2;X++)if(!T.isReserved(U,Q-X)){let Y=!1;K<A.length&&(Y=(A[K]>>>I&1)===1),T.set(U,Q-X,Y),I--,I===-1&&(K++,I=7)}if(U+=B,U<0||y<=U){U-=B,B=-B;break}}}function x(T,A,y){const B=new n;y.forEach(function(X){B.put(X.mode.bit,4),B.put(X.getLength(),C.getCharCountIndicator(X.mode,T)),X.write(B)});const U=o.getSymbolTotalCodewords(T),I=d.getTotalCodewordsCount(T,A),K=(U-I)*8;for(B.getLengthInBits()+4<=K&&B.put(0,4);B.getLengthInBits()%8!==0;)B.putBit(0);const Q=(K-B.getLengthInBits())/8;for(let X=0;X<Q;X++)B.put(X%2?17:236,8);return L(B,T,A)}function L(T,A,y){const B=o.getSymbolTotalCodewords(A),U=d.getTotalCodewordsCount(A,y),I=B-U,K=d.getBlocksCount(A,y),Q=B%K,X=K-Q,Y=Math.floor(B/K),D=Math.floor(I/K),H=D+1,F=Y-D,tt=new g(F);let at=0;const Z=new Array(K),it=new Array(K);let st=0;const V=new Uint8Array(T.buffer);for(let Rt=0;Rt<K;Rt++){const Ut=Rt<X?D:H;Z[Rt]=V.slice(at,at+Ut),it[Rt]=tt.encode(Z[Rt]),at+=Ut,st=Math.max(st,Ut)}const J=new Uint8Array(B);let W=0,nt,dt;for(nt=0;nt<st;nt++)for(dt=0;dt<K;dt++)nt<Z[dt].length&&(J[W++]=Z[dt][nt]);for(nt=0;nt<F;nt++)for(dt=0;dt<K;dt++)J[W++]=it[dt][nt];return J}function O(T,A,y,B){let U;if(Array.isArray(T))U=E.fromArray(T);else if(typeof T=="string"){let Y=A;if(!Y){const D=E.rawSplit(T);Y=m.getBestVersionForData(D,y)}U=E.fromString(T,Y||40)}else throw new Error("Invalid data");const I=m.getBestVersionForData(U,y);if(!I)throw new Error("The amount of data is too big to be stored in a QR Code");if(!A)A=I;else if(A<I)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+I+`.
`);const K=x(A,y,U),Q=o.getSymbolSize(A),X=new a(Q);return R(X,A),v(X),M(X,A),P(X,y,0),A>=7&&z(X,A),j(X,K),isNaN(B)&&(B=c.getBestMask(X,P.bind(null,X,y))),c.applyMask(B,X),P(X,y,B),{modules:X,version:A,errorCorrectionLevel:y,maskPattern:B,segments:U}}return nm.create=function(A,y){if(typeof A>"u"||A==="")throw new Error("No input text");let B=t.M,U,I;return typeof y<"u"&&(B=t.from(y.errorCorrectionLevel,t.M),U=m.from(y.version),I=c.from(y.maskPattern),y.toSJISFunc&&o.setToSJISFunction(y.toSJISFunc)),O(A,U,B,I)},nm}var _m={},Em={},C2;function Nb(){return C2||(C2=1,(function(o){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let a=n.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+n);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(l){return[l,l]}))),a.length===6&&a.push("F","F");const r=parseInt(a.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+a.slice(0,6).join("")}}o.getOptions=function(a){a||(a={}),a.color||(a.color={});const r=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,l=a.width&&a.width>=21?a.width:void 0,c=a.scale||4;return{width:l,scale:l?4:c,margin:r,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},o.getScale=function(a,r){return r.width&&r.width>=a+r.margin*2?r.width/(a+r.margin*2):r.scale},o.getImageWidth=function(a,r){const l=o.getScale(a,r);return Math.floor((a+r.margin*2)*l)},o.qrToImageData=function(a,r,l){const c=r.modules.size,d=r.modules.data,g=o.getScale(c,l),m=Math.floor((c+l.margin*2)*g),S=l.margin*g,C=[l.color.light,l.color.dark];for(let E=0;E<m;E++)for(let R=0;R<m;R++){let v=(E*m+R)*4,M=l.color.light;if(E>=S&&R>=S&&E<m-S&&R<m-S){const z=Math.floor((E-S)/g),P=Math.floor((R-S)/g);M=C[d[z*c+P]?1:0]}a[v++]=M.r,a[v++]=M.g,a[v++]=M.b,a[v]=M.a}}})(Em)),Em}var T2;function PT(){return T2||(T2=1,(function(o){const t=Nb();function n(r,l,c){r.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=c,l.width=c,l.style.height=c+"px",l.style.width=c+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}o.render=function(l,c,d){let g=d,m=c;typeof g>"u"&&(!c||!c.getContext)&&(g=c,c=void 0),c||(m=a()),g=t.getOptions(g);const S=t.getImageWidth(l.modules.size,g),C=m.getContext("2d"),E=C.createImageData(S,S);return t.qrToImageData(E.data,l,g),n(C,m,S),C.putImageData(E,0,0),m},o.renderToDataURL=function(l,c,d){let g=d;typeof g>"u"&&(!c||!c.getContext)&&(g=c,c=void 0),g||(g={});const m=o.render(l,c,g),S=g.type||"image/png",C=g.rendererOpts||{};return m.toDataURL(S,C.quality)}})(_m)),_m}var Cm={},A2;function IT(){if(A2)return Cm;A2=1;const o=Nb();function t(r,l){const c=r.a/255,d=l+'="'+r.hex+'"';return c<1?d+" "+l+'-opacity="'+c.toFixed(2).slice(1)+'"':d}function n(r,l,c){let d=r+l;return typeof c<"u"&&(d+=" "+c),d}function a(r,l,c){let d="",g=0,m=!1,S=0;for(let C=0;C<r.length;C++){const E=Math.floor(C%l),R=Math.floor(C/l);!E&&!m&&(m=!0),r[C]?(S++,C>0&&E>0&&r[C-1]||(d+=m?n("M",E+c,.5+R+c):n("m",g,0),g=0,m=!1),E+1<l&&r[C+1]||(d+=n("h",S),S=0)):g++}return d}return Cm.render=function(l,c,d){const g=o.getOptions(c),m=l.modules.size,S=l.modules.data,C=m+g.margin*2,E=g.color.light.a?"<path "+t(g.color.light,"fill")+' d="M0 0h'+C+"v"+C+'H0z"/>':"",R="<path "+t(g.color.dark,"stroke")+' d="'+a(S,m,g.margin)+'"/>',v='viewBox="0 0 '+C+" "+C+'"',z='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+v+' shape-rendering="crispEdges">'+E+R+`</svg>
`;return typeof d=="function"&&d(null,z),z},Cm}var w2;function GT(){if(w2)return sf;w2=1;const o=bT(),t=LT(),n=PT(),a=IT();function r(l,c,d,g,m){const S=[].slice.call(arguments,1),C=S.length,E=typeof S[C-1]=="function";if(!E&&!o())throw new Error("Callback required as last argument");if(E){if(C<2)throw new Error("Too few arguments provided");C===2?(m=d,d=c,c=g=void 0):C===3&&(c.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=d,d=c,c=void 0))}else{if(C<1)throw new Error("Too few arguments provided");return C===1?(d=c,c=g=void 0):C===2&&!c.getContext&&(g=d,d=c,c=void 0),new Promise(function(R,v){try{const M=t.create(d,g);R(l(M,c,g))}catch(M){v(M)}})}try{const R=t.create(d,g);m(null,l(R,c,g))}catch(R){m(R)}}return sf.create=t.create,sf.toCanvas=r.bind(null,n.render),sf.toDataURL=r.bind(null,n.renderToDataURL),sf.toString=r.bind(null,function(l,c,d){return a.render(l,d)}),sf}var HT=GT();const Mb=vf(HT),Db=({active:o=!1,size:t=20})=>{const n=o?"#ff4d4f":"#b8c1cc",a=o?"#ff4d4f":"transparent";return k.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[k.jsx("path",{d:"M5 2.5V17.5",stroke:n,strokeWidth:"1.6",strokeLinecap:"round"}),k.jsx("path",{d:"M5 3h10l-2 3 2 3H5V3Z",fill:a,stroke:n,strokeWidth:"1.4",strokeLinejoin:"round"})]})},jb=({student:o,onClick:t,onToggleFlag:n,teacherAnnotations:a=[],sharedImage:r,hideNames:l=!1})=>{var L,O,T,A;const c=rt.useRef(null),d=rt.useRef(null),[g,m]=rt.useState(null),[S,C]=rt.useState(300);rt.useEffect(()=>{if(!r){m(null);return}const y=new window.Image;y.src=r.dataUrl,y.onload=()=>{m(y)}},[r]),rt.useEffect(()=>{if(!d.current)return;const y=()=>{d.current&&C(d.current.clientWidth)};y();const B=new ResizeObserver(y);return B.observe(d.current),()=>B.disconnect()},[]);const E=()=>{if(o!=null&&o.name)return o.name;if(!(o!=null&&o.clientId))return"Unknown Student";const y=o.clientId.match(/student-(\d+)/);return y?`Student ${y[1]}`:o.clientId},R=()=>{if(!o.lastUpdate)return"Just joined";const y=Math.floor((Date.now()-o.lastUpdate)/1e3);return y<5?"Just now":y<60?`${y}s ago`:`${Math.floor(y/60)}m ago`},v=((O=(L=o.meta)==null?void 0:L.base)==null?void 0:O.width)||800,M=((A=(T=o.meta)==null?void 0:T.base)==null?void 0:A.height)||600,z=S/v,P=y=>{y.stopPropagation(),n&&n(o.clientId)},x=(()=>{if(!r||!g)return null;const y=r.width/r.height,B=v/M;let U,I,K,Q;return y>B?(U=v,I=v/y,K=0,Q=(M-I)/2):(I=M,U=M*y,K=(v-U)/2,Q=0),{x:K,y:Q,width:U,height:I}})();return k.jsxs("div",{className:`student-card ${o.isActive?"active":"inactive"}`,onClick:()=>t(o),children:[k.jsxs("div",{className:"student-card-header",children:[k.jsxs("div",{className:"student-name",children:[k.jsx("span",{className:"student-icon",children:"👤"}),l?"•••":E()]}),k.jsxs("div",{className:"student-header-actions",children:[k.jsx("button",{className:`flag-button ${o.isFlagged?"active":""}`,onClick:P,"aria-label":o.isFlagged?"Remove flag":"Flag student",title:o.isFlagged?"Remove flag":"Flag student",children:k.jsx(Db,{active:o.isFlagged,size:18})}),k.jsxs("div",{className:"student-status",children:[k.jsx("span",{className:`status-dot ${o.isActive?"online":"offline"}`}),o.isVisible===!1&&o.isActive&&k.jsx("span",{className:"visibility-indicator away",title:"Student is distracted (switched away from tab)",children:"⚠️"})]})]})]}),k.jsxs("div",{className:"student-card-canvas",ref:d,children:[k.jsxs(Bg,{ref:c,width:v,height:M,scaleX:z,scaleY:z,style:{transformOrigin:"top left",width:"100%",height:"100%"},children:[x&&k.jsx(Wr,{listening:!1,children:k.jsx(lv,{image:g,x:x.x,y:x.y,width:x.width,height:x.height})}),k.jsx(Wr,{children:o.lines&&o.lines.map((y,B)=>k.jsx(Sl,{points:y.points,stroke:y.color||"black",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`preview-${o.clientId}-${B}`))}),k.jsx(Wr,{children:a.map((y,B)=>k.jsx(Sl,{points:y.points,stroke:y.color||"#FF0000",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${o.clientId}-${B}`))})]}),(!o.lines||o.lines.length===0)&&k.jsxs("div",{className:"no-drawing",children:[k.jsx("span",{children:"✏️"}),k.jsx("p",{children:"No drawing yet"})]}),o.lines&&o.lines.length>0&&k.jsxs("div",{className:"stroke-count",children:[o.lines.length," stroke",o.lines.length!==1?"s":""]})]}),k.jsxs("div",{className:"student-card-footer",children:[k.jsx("span",{className:"last-update",children:R()}),k.jsx("span",{className:"click-hint",children:"Click to annotate →"})]})]})},of={width:800,height:600},mg="teacherAnnotationPrefs",R2=2,Tm=[{label:"Red",value:"#FF3B30"},{label:"Purple",value:"#7C3AED"},{label:"Teal",value:"#0EA5E9"}],Ub=({student:o,isOpen:t,onClose:n,onAnnotate:a,existingAnnotations:r=[],isFlagged:l=!1,onToggleFlag:c,sharedImage:d})=>{const[g,m]=rt.useState("pen"),[S,C]=rt.useState(Tm[0].value),[E,R]=rt.useState(3),[v,M]=rt.useState(!1),[z,P]=rt.useState([]),[j,x]=rt.useState("stylus-only"),[L,O]=rt.useState("left"),[T,A]=rt.useState(null),[y,B]=rt.useState(!1),U=rt.useRef([]),I=rt.useRef([]),K=rt.useRef(!1),Q=rt.useRef(null),X=rt.useRef(!0),Y=rt.useRef(0),D=rt.useRef(null),H=rt.useRef(null);rt.useEffect(()=>{if(!d){A(null);return}const At=new window.Image;At.src=d.dataUrl,At.onload=()=>{A(At)}},[d]);const F=rt.useRef(null),tt=rt.useRef(null),[at,Z]=rt.useState({width:960,height:720}),it=rt.useMemo(()=>({x:at.width/of.width,y:at.height/of.height}),[at]);rt.useEffect(()=>{const At=()=>{B(window.innerWidth<=768)};return At(),window.addEventListener("resize",At),()=>window.removeEventListener("resize",At)},[]),rt.useEffect(()=>{if(!(typeof window>"u"))try{const At=localStorage.getItem(mg);if(At){const Ht=JSON.parse(At);if(Ht.version!==R2){localStorage.removeItem(mg);return}Ht.tool&&m(Ht.tool),Ht.color&&C(Ht.color),typeof Ht.brushSize=="number"&&R(Ht.brushSize),Ht.inputMode&&x(Ht.inputMode),Ht.toolbarPosition&&O(Ht.toolbarPosition)}}catch{localStorage.removeItem(mg)}},[]),rt.useEffect(()=>{if(typeof window>"u")return;if(X.current){X.current=!1;return}const At={version:R2,tool:g,color:S,brushSize:E,inputMode:j,toolbarPosition:L};localStorage.setItem(mg,JSON.stringify(At))},[g,S,E,j,L]),rt.useEffect(()=>{t&&o&&o.clientId!==Q.current&&(Q.current=o.clientId,P(r),U.current=[],I.current=[])},[t,o,r]),rt.useEffect(()=>{t&&o&&P(r)},[r,t,o]),rt.useEffect(()=>()=>{H.current&&cancelAnimationFrame(H.current)},[]),rt.useEffect(()=>{if(!t)return;const At=document.body.style.overflow,Ht=document.body.style.position,me=document.body.style.touchAction,Se=document.body.style.width,Oe=document.body.style.top,$e=window.scrollY||document.documentElement.scrollTop||0;Y.current=$e,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${$e}px`,document.body.style.touchAction="none";const xe=F.current,ct=Pt=>{const se=Pt.target;se.closest("button")||se.closest(".annotation-sidebar")||se.closest(".annotation-status-actions")||Pt.preventDefault()},Tt=Pt=>{Pt.preventDefault()},Mt=Pt=>{if(v)return Pt.preventDefault(),!1};return xe&&(xe.addEventListener("touchstart",ct,{passive:!1}),xe.addEventListener("touchmove",ct,{passive:!1}),xe.addEventListener("gesturestart",Tt,{passive:!1}),xe.addEventListener("gesturechange",Tt,{passive:!1})),document.addEventListener("selectstart",Mt),()=>{document.body.style.overflow=At,document.body.style.position=Ht,document.body.style.width=Se,document.body.style.top=Oe,document.body.style.touchAction=me,xe&&(xe.removeEventListener("touchstart",ct),xe.removeEventListener("touchmove",ct),xe.removeEventListener("gesturestart",Tt),xe.removeEventListener("gesturechange",Tt)),document.removeEventListener("selectstart",Mt),requestAnimationFrame(()=>{window.scrollTo(0,Y.current)})}},[t,v]),rt.useEffect(()=>{if(!t)return;const At=()=>{if(!F.current)return;const Ht=F.current.getBoundingClientRect(),Oe=24+4,$e=Math.max(320,Ht.width-Oe),xe=Math.max(240,Ht.height-Oe),ct=$e/of.width,Tt=xe/of.height,Mt=Math.min(ct,Tt);Z({width:Math.round(of.width*Mt),height:Math.round(of.height*Mt)})};return At(),window.addEventListener("resize",At),()=>window.removeEventListener("resize",At)},[L,t]);const st=()=>{if(!d||!T)return null;const At=d.width/d.height,Ht=at.width/at.height;let me,Se,Oe,$e;return At>Ht?(me=at.width,Se=at.width/At,Oe=0,$e=(at.height-Se)/2):(Se=at.height,me=at.height*At,Oe=(at.width-me)/2,$e=0),{x:Oe,y:$e,width:me,height:Se}};if(!t||!o)return null;const V=st(),J=()=>{if(o.name)return o.name;const At=o.clientId.match(/student-(\d+)/)||o.clientId.match(/load-test-student-(\d+)/);return At?`Student ${At[1]}`:o.clientId},W=At=>j!=="stylus-only"?!0:(At==null?void 0:At.pointerType)==="pen",nt=(At=[])=>At.map((Ht,me)=>me%2===0?Ht*it.x:Ht*it.y),dt=At=>({x:At.x/it.x,y:At.y/it.y}),Rt=At=>(At.strokeWidth||3)*it.x,Ut=At=>{const Ht=At.evt;if(Ht!=null&&Ht.preventDefault&&Ht.preventDefault(),Ht!=null&&Ht.stopPropagation&&Ht.stopPropagation(),!W(Ht))return;const me=At.target.getStage();if(me&&Ht.pointerId!==void 0){const Se=me.content;if(Se&&Se.setPointerCapture)try{Se.setPointerCapture(Ht.pointerId)}catch{}}if(g==="pen"){M(!0);const Se=me.getPointerPosition(),{x:Oe,y:$e}=dt(Se),xe={tool:"pen",points:[Oe,$e],color:S,strokeWidth:E};U.current.push([...z]),I.current=[],D.current=xe,P([...z,xe])}else g==="eraser"&&(M(!0),K.current=!1)},Xt=At=>{const Ht=At.evt;if(Ht!=null&&Ht.preventDefault&&Ht.preventDefault(),Ht!=null&&Ht.stopPropagation&&Ht.stopPropagation(),!v||!W(Ht))return;const Se=At.target.getStage().getPointerPosition();if(g==="pen"){if(D.current){const{x:Oe,y:$e}=dt(Se);D.current.points=D.current.points.concat([Oe,$e]);const xe=D.current;H.current&&cancelAnimationFrame(H.current),H.current=requestAnimationFrame(()=>{xe&&P(ct=>ct.length===0?ct:[...ct.slice(0,-1),xe])})}}else if(g==="eraser"){const Oe=z.length,$e=20,xe=z.filter(ct=>{for(let Tt=0;Tt<ct.points.length;Tt+=2){const Mt=ct.points[Tt]*it.x,Pt=ct.points[Tt+1]*it.y;if(Math.sqrt(Math.pow(Mt-Se.x,2)+Math.pow(Pt-Se.y,2))<$e)return!1}return!0});xe.length<Oe&&!K.current&&(U.current.push([...z]),I.current=[],K.current=!0),P(xe)}},$t=At=>{const Ht=At==null?void 0:At.evt;if(!W(Ht)){Ht!=null&&Ht.preventDefault&&Ht.preventDefault();return}if(M(!1),H.current&&(cancelAnimationFrame(H.current),H.current=null),D.current&&g==="pen"){const me=D.current;P(Se=>{if(Se.length===0)return Se;const Oe=[...Se.slice(0,-1),me];return setTimeout(()=>a(Oe),0),Oe}),D.current=null}else setTimeout(()=>a(z),0)},oe=()=>{if(U.current.length>0){const At=U.current.pop();I.current.push([...z]),P(At),a(At)}},kt=()=>{if(I.current.length>0){const At=I.current.pop();U.current.push([...z]),P(At),a(At)}},Re=()=>{U.current.push([...z]),I.current=[];const At=[];P(At),a(At)},Ee=()=>{c&&c(o.clientId)},ze=()=>{M(!1),n()},Xe=()=>{x(At=>At==="stylus-only"?"all":"stylus-only")},nn=()=>{O(At=>At==="left"?"right":"left")},fn=At=>{At.preventDefault(),At.stopPropagation()};return k.jsx("div",{className:"annotation-modal-overlay",onTouchMove:fn,onTouchStart:fn,children:k.jsx("div",{className:"annotation-modal student-console",children:k.jsxs("div",{className:"annotation-console",children:[k.jsxs("div",{className:"annotation-status-bar",children:[k.jsxs("div",{className:"annotation-status-text",children:[k.jsx("h1",{children:"Annotate Student"}),k.jsx("p",{children:J()})]}),k.jsxs("div",{className:"annotation-status-actions",children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:g==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",j==="all"?"All inputs":"Stylus only"]})}),k.jsxs("button",{className:`flag-pill ${l?"active":""}`,onClick:Ee,children:[k.jsx(Db,{active:l,size:16}),l?"Flagged":"Flag"]}),k.jsxs("button",{className:"status-badge",onClick:nn,children:["Move toolbar to ",L==="left"?"right":"left"]}),k.jsx("button",{className:"status-badge danger",onClick:ze,children:"✕ Close"})]})]}),k.jsxs("div",{className:`annotation-workspace ${L==="right"?"toolbar-right":""} ${y?"mobile-view":""}`,children:[y?k.jsxs("div",{className:"mobile-annotation-toolbar",children:[k.jsx("div",{className:"mobile-colors",children:Tm.map(At=>k.jsx("button",{onClick:()=>C(At.value),className:`mobile-color-button ${S===At.value?"active":""}`,style:{background:At.value},"aria-label":At.label},At.value))}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>m("pen"),className:`mobile-tool-button ${g==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(Eb,{size:20})}),k.jsx("button",{onClick:()=>m("eraser"),className:`mobile-tool-button ${g==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(_b,{size:20})}),k.jsx("button",{onClick:oe,className:"mobile-tool-button",disabled:U.current.length===0,"aria-label":"Undo",children:k.jsx(Ab,{size:20})}),k.jsx("button",{onClick:kt,className:"mobile-tool-button",disabled:I.current.length===0,"aria-label":"Redo",children:k.jsx(Cb,{size:20})}),k.jsx("button",{onClick:Re,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(Tb,{size:20})})]})]}):k.jsxs("div",{className:"annotation-sidebar",children:[k.jsxs("div",{className:"sidebar-header",children:[k.jsx("h2",{children:"Annotation Console"}),k.jsx("p",{children:"Mirror of student workspace"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsx("div",{className:"color-row",children:Tm.map(At=>k.jsx("button",{className:`color-button ${S===At.value?"active":""}`,style:{background:At.value},onClick:()=>C(At.value),"aria-label":At.label},At.value))})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>m("pen"),className:`tool-icon-button ${g==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>m("eraser"),className:`tool-icon-button ${g==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsxs("div",{className:"brush-size-control",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:E,onChange:At=>R(parseInt(At.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:E})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${j==="all"?"all":""}`,onClick:Xe,children:j==="stylus-only"?"Stylus only":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:oe,className:"history-button",disabled:U.current.length===0,children:"Undo"}),k.jsx("button",{onClick:kt,className:"history-button",disabled:I.current.length===0,children:"Redo"}),k.jsx("button",{onClick:Re,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"annotation-canvas-panel",children:k.jsx("div",{className:"annotation-canvas-frame",ref:F,onTouchMove:At=>At.preventDefault(),onTouchStart:At=>At.preventDefault(),children:k.jsxs(Bg,{ref:tt,width:at.width,height:at.height,onPointerDown:Ut,onPointerMove:Xt,onPointerUp:$t,onPointerLeave:$t,onTouchStart:At=>At.preventDefault(),onTouchMove:At=>At.preventDefault(),onTouchEnd:At=>At.preventDefault(),className:"annotation-stage",perfectDrawEnabled:!1,children:[V&&k.jsx(Wr,{listening:!1,children:k.jsx(lv,{image:T,x:V.x,y:V.y,width:V.width,height:V.height})}),k.jsx(Wr,{listening:!1,children:o.lines&&o.lines.map((At,Ht)=>k.jsx(Sl,{points:nt(At.points),stroke:At.color||"black",strokeWidth:(At.strokeWidth||3)*it.x,tension:.5,lineCap:"round",lineJoin:"round"},`student-${Ht}`))}),k.jsx(Wr,{children:z.map((At,Ht)=>k.jsx(Sl,{points:nt(At.points),stroke:At.color,strokeWidth:Rt(At),tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${Ht}`))})]})})})]})]})})})},Bb=async(o,t=800,n=600,a=.7)=>{console.log("📸 Processing image:",o.name,o.type,o.size,"bytes");let r,l,c;if(typeof createImageBitmap=="function")try{console.log("📸 Using createImageBitmap");const v=await createImageBitmap(o);l=v.width,c=v.height,r=v}catch(v){console.warn("📸 createImageBitmap failed, using fallback:",v),r=null}r||(console.log("📸 Using Image() fallback for iOS/Safari"),r=await new Promise((v,M)=>{const z=new Image,P=URL.createObjectURL(o);z.onload=()=>{URL.revokeObjectURL(P),v(z)},z.onerror=j=>{URL.revokeObjectURL(P),console.error("📸 Image load error:",j),M(new Error(`Failed to load image: ${o.name}. File may be corrupted or in unsupported format.`))},z.src=P}),l=r.naturalWidth||r.width,c=r.naturalHeight||r.height);const d=Math.min(t/l,n/c,1),g=Math.round(l*d),m=Math.round(c*d);console.log("📸 Resizing:",l,"x",c,"→",g,"x",m);const S=document.createElement("canvas");S.width=g,S.height=m;const C=S.getContext("2d");C.fillStyle="#FFFFFF",C.fillRect(0,0,g,m),C.drawImage(r,0,0,g,m);const E=await new Promise((v,M)=>{try{S.toBlob(z=>{z?(console.log("📸 Compressed to:",z.size,"bytes"),v(z)):(console.error("📸 Canvas toBlob returned null"),M(new Error("Failed to compress image. Canvas may be too large or device out of memory.")))},"image/jpeg",a)}catch(z){console.error("📸 Canvas toBlob error:",z),M(new Error(`Failed to compress image: ${z.message}`))}}),R=await new Promise((v,M)=>{const z=new FileReader;z.onload=()=>{console.log("📸 Data URL created, length:",z.result.length),v(z.result)},z.onerror=P=>{var j;console.error("📸 Failed to create data URL:",P,z.error),M(new Error(`Failed to create data URL: ${((j=z.error)==null?void 0:j.message)||"Unknown FileReader error"}`))},z.readAsDataURL(E)});return console.log("📸 ✅ Image processing complete"),{blob:E,dataUrl:R,width:g,height:m,size:E.size}},kT=()=>{const[o,t]=Sh(),n=bf(),a=()=>{const wt="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let Et="";for(let te=0;te<6;te++)Et+=wt.charAt(Math.floor(Math.random()*wt.length));return Et},[r,l]=rt.useState(""),c=rt.useRef(!1);rt.useEffect(()=>{if(c.current)return;const wt=o.get("room");if(wt)l(wt.toUpperCase());else{const Et=a();l(Et),t({room:Et},{replace:!0})}c.current=!0},[o,t]);const[d,g]=rt.useState(null),[m,S]=rt.useState(null),[C,E]=rt.useState(null),[R,v]=rt.useState(0),[M,z]=rt.useState("created"),[P,j]=rt.useState(null),[x,L]=rt.useState(null),[O,T]=rt.useState(!1),[A,y]=rt.useState(!1),[B]=rt.useState(`teacher-${Math.random().toString(36).substring(7)}`),[U,I]=rt.useState(()=>{const wt=parseInt(o.get("bot"))||0,Et={};if(wt>0)for(let te=1;te<=wt;te++){const ae=`bot-student-${te}`;Et[ae]={studentId:ae,clientId:`bot-${te}`,name:`Bot ${te}`,strokeCount:0,lastUpdate:Date.now()-te*1e3,isActive:!0,isFlagged:!1}}return Et}),[K,Q]=rt.useState(null),[X,Y]=rt.useState({}),[D,H]=rt.useState(""),[F,tt]=rt.useState("all"),[at,Z]=rt.useState("all"),[it,st]=rt.useState(()=>{const wt=localStorage.getItem("teacherDashboardHideNames");return wt?JSON.parse(wt):!1}),[V,J]=rt.useState(()=>{const wt=localStorage.getItem("teacherDashboardCardsPerRow");return wt?parseInt(wt):3}),[W,nt]=rt.useState("blank"),[dt,Rt]=rt.useState(null),[Ut,Xt]=rt.useState(null),[$t,oe]=rt.useState(""),[kt,Re]=rt.useState(!1),[Ee,ze]=rt.useState(null),Xe=rt.useRef(null),nn=rt.useRef({}),fn=rt.useRef(null),At=rt.useRef(0),Ht=rt.useRef(null),me=rt.useRef(null),Se=rt.useRef(null),[Oe,$e]=rt.useState(!1),[xe,ct]=rt.useState(""),[Tt,Mt]=rt.useState([]);rt.useRef(!1);const Pt=rt.useRef({roomId:null,status:"idle"}),se=rt.useRef(!1),zt=rt.useRef(new Set),ee=rt.useRef(!1),qt=rt.useRef(null);rt.useEffect(()=>{Xe.current=Ee},[Ee]),rt.useEffect(()=>{nn.current=X},[X]),rt.useEffect(()=>{fn.current=C},[C]),rt.useEffect(()=>{At.current=R},[R]),rt.useEffect(()=>{if(d)return qt.current&&clearTimeout(qt.current),qt.current=setTimeout(async()=>{qt.current=null;try{await X1(d,{students:U,questionNumber:R,currentQuestionId:C,sharedImage:Ee})}catch(wt){console.error("❌ Failed to save session state (debounced):",wt)}},400),()=>{qt.current&&(clearTimeout(qt.current),qt.current=null)}},[d,U,R,C,Ee]);const an=rt.useRef(0),Ae=(wt,Et="info")=>{const te=`${Date.now()}-${an.current++}`;Mt(ae=>[...ae,{id:te,message:wt,type:Et}]),setTimeout(()=>{Mt(ae=>ae.filter(Yt=>Yt.id!==te))},4e3)},re=rt.useCallback(async(wt="teacher_ended")=>{if(!d||M!=="active"&&M!=="created")return!1;try{await oa.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",d),x&&await x.publish("session-ended",{timestamp:Date.now(),reason:wt});try{await Wm(d)}catch(Et){console.error("Failed to clear local session data:",Et)}return z("ended"),Ht.current&&(clearTimeout(Ht.current),Ht.current=null),!0}catch(Et){return console.error("Error ending session:",Et),!1}},[d,M,x]);rt.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(it))},[it]),rt.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",V.toString())},[V]),rt.useEffect(()=>{if(!r||(Pt.current.roomId!==r&&(Pt.current={roomId:r,status:"idle"},se.current=!1),Pt.current.status==="in-progress"||Pt.current.status==="done"))return;Pt.current={roomId:r,status:"in-progress"};let wt=!1;const Et=()=>{const ae=Pt.current;!wt&&ae.roomId===r&&(Pt.current={roomId:r,status:"idle"},se.current=!1)};return(async()=>{try{const{data:ae,error:Yt}=await oa.from("sessions").select("*").ilike("room_code",r).order("created_at",{ascending:!1}).limit(1);if(Yt){console.error("Failed to query sessions:",Yt),Et();return}let rn=null;if(ae&&ae.length>0){const En=ae[0];if(En.status==="ended"){const{data:fe,error:de}=await oa.from("sessions").update({status:"created",started_at:null,ended_at:null}).eq("id",En.id).select().single();if(de){console.error("Failed to update session:",de),Et();return}rn=fe}else rn=En}else{const{data:En,error:fe}=await oa.from("sessions").insert([{room_code:r,status:"created"}]).select().single();if(fe)if(fe.code==="23505"){const{data:de,error:Zt}=await oa.from("sessions").select("*").ilike("room_code",r).order("created_at",{ascending:!1}).limit(1);if(Zt){console.error("Failed to load existing session after duplicate key error:",Zt),Et();return}if(de&&de.length>0)rn=de[0];else{console.error("Duplicate key reported but no session found when refetching."),Et();return}}else{console.error("Failed to create session:",fe),Et();return}else rn=En}if(wt)return;if(rn){if(g(rn.id),z(rn.status),!se.current){const{data:En,error:fe}=await oa.from("participants").select("*").eq("session_id",rn.id).eq("client_id",B).eq("role","teacher").maybeSingle();if(fe&&console.error("Failed to check existing teacher participant:",fe),En)S(En.id),se.current=!0;else{const{data:de,error:Zt}=await oa.from("participants").insert([{session_id:rn.id,client_id:B,name:"Teacher",role:"teacher"}]).select().single();Zt?console.error("Failed to create teacher participant:",Zt):(S(de.id),se.current=!0)}}wt||(Pt.current={roomId:r,status:"done"})}else Et()}catch(ae){console.error("Error initializing session:",ae),Et()}})(),()=>{wt=!0;const ae=Pt.current;ae.roomId===r&&ae.status==="in-progress"&&(Pt.current={roomId:r,status:"idle"},se.current=!1)}},[r,B]),rt.useEffect(()=>{if(!d)return;(async()=>{try{await wb(7);const Et=await fT(d);if(Et){if(Et.students&&Object.keys(Et.students).length>0&&I(Et.students),Et.questionNumber!==void 0&&(v(Et.questionNumber),At.current=Et.questionNumber),Et.currentQuestionId){E(Et.currentQuestionId),fn.current=Et.currentQuestionId;const te={};if(Et.students)for(const ae of Object.keys(Et.students))try{const Yt=await fetch(`/api/strokes/load?sessionId=${d}&questionId=${Et.currentQuestionId}&userId=${ae}`);if(Yt.ok){const rn=await Yt.json();rn.teacherStrokes&&rn.teacherStrokes.length>0&&(te[ae]=rn.teacherStrokes)}}catch(Yt){console.error(`❌ Failed to load annotations for student ${ae}:`,Yt)}Object.keys(te).length>0&&(Y(te),console.log("📂 Loaded",Object.keys(te).length,"teacher annotations from Redis"))}else fn.current=null;Et.sharedImage&&ze(Et.sharedImage)}}catch(Et){console.error("❌ Failed to load session state:",Et)}finally{y(!0)}})()},[d]),rt.useEffect(()=>{if(!d||typeof window>"u")return;!O&&(M==="active"||M==="created")&&!Ht.current&&(console.log("⏱️ Teacher disconnected, starting 10-minute auto-logout timer"),Ht.current=window.setTimeout(async()=>{console.log("⏰ 10-minute timeout reached, automatically ending session"),await re("teacher_timeout_10min")?console.log("✅ Session ended due to teacher inactivity"):console.warn("Auto-logout timer fired but session was already ended or unavailable"),Ht.current=null},600*1e3)),O&&Ht.current&&(console.log("✅ Teacher reconnected, cancelling auto-logout timer"),clearTimeout(Ht.current),Ht.current=null)},[O,d,M,re]),rt.useEffect(()=>()=>{Ht.current&&(clearTimeout(Ht.current),Ht.current=null)},[]),rt.useEffect(()=>{if(ee.current||!r||!B||!A)return;ee.current=!0;let wt=null,Et=null;return(async()=>{try{const ae=`/api/token?clientId=${B}`,Yt=await fetch(ae),rn=await Yt.text();if(!Yt.ok)throw new Error(`Token request failed (${Yt.status} ${Yt.statusText})${rn?` – ${rn}`:""}`);let En;try{En=JSON.parse(rn)}catch(Zt){throw new Error(`Token response was not valid JSON: ${Zt.message}`)}wt=new yv.Realtime({authCallback:async(Zt,qe)=>{qe(null,En)},clientId:B}),wt.connection.on("connected",()=>{T(!0)}),wt.connection.on("disconnected",()=>{T(!1)}),wt.connection.on("suspended",()=>{T(!1)}),wt.connection.on("failed",()=>{T(!1)}),wt.connection.on("closing",()=>{T(!1)}),wt.connection.on("closed",()=>{T(!1)}),j(wt),Et=wt.channels.get(`room-${r}`),Et.subscribe("student-stroke-count",Zt=>{const{studentId:qe,strokeCount:Me}=Zt.data;qe&&I(Ce=>Ce[qe]?{...Ce,[qe]:{...Ce[qe],strokeCount:Me||0,lastUpdate:Date.now()}}:Ce)}),Et.presence.subscribe("enter",Zt=>{var qe,Me;if(Zt.clientId!==B&&Zt.clientId.includes("student")){const Ce=((qe=Zt.data)==null?void 0:qe.name)||tn(Zt.clientId),An=Zt.clientId,zn=(Me=Zt.data)==null?void 0:Me.studentId;if(!zn){console.warn("⚠️ Student joined without persistent studentId:",An);return}I(kn=>{var Fn,Ns;const vn=kn[zn];return vn?(console.log("🔄 Student reconnected:",vn.clientId,"→",An,"(",Ce,")"),(K==null?void 0:K.studentId)===zn&&Q({...vn,clientId:An}),{...kn,[zn]:{...vn,clientId:An,name:Ce,isActive:!0,isVisible:((Fn=Zt.data)==null?void 0:Fn.isVisible)!==!1,lastUpdate:Date.now()}}):(zt.current.has(zn)||(zt.current.add(zn),Ae(`${Ce} joined`,"success")),{...kn,[zn]:{studentId:zn,clientId:An,name:Ce,strokeCount:0,isActive:!0,isVisible:((Ns=Zt.data)==null?void 0:Ns.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:!1}})}),setTimeout(()=>{var vn;const kn=((vn=nn.current)==null?void 0:vn[zn])||[];Et.publish("sync-full-state",{targetClientId:An,content:Xe.current||null,questionId:fn.current,questionNumber:At.current,annotations:kn,timestamp:Date.now()}),kn.length>0&&console.log("📤 Sent",kn.length,"teacher annotations to",Ce)},300)}}),Et.presence.subscribe("leave",Zt=>{var qe;if(Zt.clientId!==B&&Zt.clientId.includes("student")){const Me=(qe=Zt.data)==null?void 0:qe.studentId;I(Ce=>{const An=Me?Ce[Me]:null;if(!An)return Ce;const zn=(An==null?void 0:An.name)||tn(Zt.clientId);Ae(`${zn} left`,"info"),zt.current.delete(Me);const{[Me]:kn,...vn}=Ce;return vn})}}),Et.subscribe("student-visibility",Zt=>{const{studentId:qe,studentName:Me,isVisible:Ce}=Zt.data;qe&&I(An=>{const zn=An[qe];if(!zn)return An;const kn=zn.isVisible===!1;return Ce?kn&&Ae(`✓ ${Me} returned`,"success"):Ae(`⚠️ ${Me} switched away`,"warning"),{...An,[qe]:{...zn,isVisible:Ce,lastVisibilityChange:Date.now()}}})}),Et.subscribe("teacher-image",Zt=>{ze(Zt.data)}),Et.subscribe("request-current-state",Zt=>{var Me;const qe=(Me=Zt.data)==null?void 0:Me.studentId;setTimeout(()=>{var An;const Ce=((An=nn.current)==null?void 0:An[qe])||[];Et.publish("sync-full-state",{targetClientId:Zt.clientId,content:Xe.current||null,questionId:fn.current,questionNumber:At.current,annotations:Ce,timestamp:Date.now()})},100)}),await Et.presence.enter({role:"teacher",timestamp:Date.now()});const fe=await Et.presence.get(),de={...U};if(fe.forEach(Zt=>{var qe,Me,Ce;if(Zt.clientId!==B&&Zt.clientId.includes("student")){const An=((qe=Zt.data)==null?void 0:qe.name)||tn(Zt.clientId),zn=(Me=Zt.data)==null?void 0:Me.studentId;if(!zn){console.warn("⚠️ Student in presence without studentId:",Zt.clientId);return}const kn=U[zn]||{};de[zn]={...kn,studentId:zn,clientId:Zt.clientId,name:An,isActive:!0,isVisible:((Ce=Zt.data)==null?void 0:Ce.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:kn.isFlagged||!1,strokeCount:kn.strokeCount||0}}}),I(de),L(Et),!se.current&&d)try{const{data:Zt,error:qe}=await oa.from("participants").select("*").eq("session_id",d).eq("client_id",B).eq("role","teacher").maybeSingle();if(qe&&console.error("Failed to check existing teacher participant during Ably init:",qe),Zt)S(Zt.id),se.current=!0;else{const{data:Me,error:Ce}=await oa.from("participants").insert([{session_id:d,client_id:B,role:"teacher"}]).select().single();Ce?console.error("Failed to create teacher participant during Ably init:",Ce):(S(Me.id),se.current=!0)}}catch(Zt){console.error("Error ensuring teacher participant during Ably init:",Zt)}}catch(ae){console.error("Failed to connect to Ably:",ae)}})(),()=>{Et&&(Et.unsubscribe(),Et.presence.unsubscribe()),wt&&wt.close()}},[r,B,A]),rt.useEffect(()=>{if(!d)return;const wt=setInterval(async()=>{try{await X1(d,{students:U,questionNumber:R,currentQuestionId:C,sharedImage:Ee}),console.log("💾 Auto-saved session metadata to IndexedDB")}catch(Et){console.error("❌ Failed to auto-save session state:",Et)}},1e4);return()=>clearInterval(wt)},[d,U,R,C,Ee]),rt.useEffect(()=>{if(!d||!C)return;const wt=setInterval(async()=>{try{if(Object.keys(X).length>0)for(const[te,ae]of Object.entries(X))await Q1(d,te,C,ae)}catch(Et){console.error("❌ Failed to auto-save teacher annotations:",Et)}},1e4);return()=>clearInterval(wt)},[d,C,X]);const tn=wt=>{const Et=wt.match(/student-(\d+)/)||wt.match(/student-([\w]+)/);return Et?`Student ${Et[1]}`:wt},_n=wt=>{Q(U[wt.studentId]||wt)},ea=()=>{Q(null)},Xn=async wt=>{if(!K||!x)return;const Et=K.studentId,te=K.clientId;if(!Et){console.error("❌ Student has no persistent studentId, cannot save annotation");return}if(Y(ae=>({...ae,[Et]:wt})),d&&C)try{await Q1(d,Et,C,wt)}catch(ae){console.error("❌ Failed to save teacher annotation:",ae)}if(d&&C)try{await fetch("/api/strokes/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:d,questionId:C,userId:Et,role:"teacher",strokes:wt})}),console.log("☁️ Saved teacher annotations to Redis:",wt.length,"strokes")}catch(ae){console.error("❌ Failed to save annotations to Redis:",ae)}x.publish("teacher-annotation",{targetStudentId:te,annotations:wt,teacherId:B,timestamp:Date.now()})},Nt=wt=>{I(Et=>{const te=Et[wt];return te?{...Et,[wt]:{...te,isFlagged:!te.isFlagged}}:Et}),Q(Et=>Et&&Et.studentId===wt?{...Et,isFlagged:!Et.isFlagged}:Et)},Ot=()=>{me.current&&(me.current.value="",me.current.click())},Jt=async wt=>{var Yt,rn,En,fe,de;const Et=(Yt=wt.target.files)==null?void 0:Yt[0];if(!Et){oe("No file selected.");return}const te=(Et.size/(1024*1024)).toFixed(2);if(console.log("📸 File selected:",{name:Et.name,type:Et.type,size:`${te}MB (${Et.size} bytes)`,lastModified:new Date(Et.lastModified).toISOString()}),!Et.type.startsWith("image/")){const Zt=`❌ Invalid file type: ${Et.type||"unknown"}. Please select an image file (JPG, PNG, etc.)`;oe(Zt),console.error(Zt),Ae("Invalid file type","error");return}const ae=25;if(Et.size>ae*1024*1024){const Zt=`❌ File too large: ${te}MB. Maximum size is ${ae}MB.`;oe(Zt),console.error(Zt),Ae("File too large","error");return}Re(!0),oe(`Processing ${Et.name} (${te}MB)...`);try{const{dataUrl:Zt,width:qe,height:Me,size:Ce}=await Bb(Et),An={dataUrl:Zt,width:qe,height:Me,filename:Et.name,timestamp:Date.now()};Xt(An),oe(`✅ Image ready (${qe}×${Me}, ${Math.round(Ce/1024)}KB)`),console.log("✅ Image processed successfully")}catch(Zt){const qe={fileName:Et.name,fileType:Et.type,fileSize:`${te}MB`,errorMessage:Zt.message||"Unknown error",errorStack:Zt.stack};console.error("❌ [TEACHER] Image upload failed:",qe);let Me=`❌ Upload failed: ${Zt.message||"Unknown error"}
`;Me+=`File: ${Et.name} (${Et.type})
`,Me+=`Size: ${te}MB
`,(rn=Zt.message)!=null&&rn.includes("load")?Me+="Error loading image. The file may be corrupted or in an unsupported format.":(En=Zt.message)!=null&&En.includes("compress")?Me+="Error compressing image. Try a different image or smaller file.":(fe=Zt.message)!=null&&fe.includes("memory")||(de=Zt.message)!=null&&de.includes("allocation")?Me+="Image too large for device memory. Try a smaller image.":Me+="Try a different image or format (JPG/PNG recommended).",oe(Me),Ae(`Upload failed: ${Zt.message}`,"error")}finally{Re(!1)}},Ge=()=>{Xt(null),oe(""),me.current&&(me.current.value="")},He=wt=>{const Et=document.createElement("canvas"),te=800,ae=600;Et.width=te,Et.height=ae;const Yt=Et.getContext("2d");if(Yt.fillStyle="#FFFFFF",Yt.fillRect(0,0,te,ae),wt==="hanzi"){const fe=(te-450)/2,de=(ae-450)/2;Yt.strokeStyle="#0F9D83",Yt.lineWidth=4,Yt.strokeRect(fe,de,450,450),Yt.strokeStyle="#B0E8D8",Yt.lineWidth=2,Yt.setLineDash([8,8]),Yt.beginPath(),Yt.moveTo(te/2,de),Yt.lineTo(te/2,de+450),Yt.stroke(),Yt.beginPath(),Yt.moveTo(fe,ae/2),Yt.lineTo(fe+450,ae/2),Yt.stroke()}else if(wt==="graph-corner"){Yt.strokeStyle="#E0E0E0",Yt.lineWidth=1,Yt.setLineDash([]);for(let de=80;de<=te-80;de+=40)Yt.beginPath(),Yt.moveTo(de,80),Yt.lineTo(de,ae-80),Yt.stroke();for(let de=80;de<=ae-80;de+=40)Yt.beginPath(),Yt.moveTo(80,de),Yt.lineTo(te-80,de),Yt.stroke();Yt.strokeStyle="#5B9BD5",Yt.lineWidth=3,Yt.beginPath(),Yt.moveTo(80,ae-80),Yt.lineTo(te-80,ae-80),Yt.stroke(),Yt.beginPath(),Yt.moveTo(80,80),Yt.lineTo(80,ae-80),Yt.stroke()}else if(wt==="graph-cross"){Yt.strokeStyle="#E0E0E0",Yt.lineWidth=1,Yt.setLineDash([]);for(let de=80;de<=te-80;de+=40)Yt.beginPath(),Yt.moveTo(de,80),Yt.lineTo(de,ae-80),Yt.stroke();for(let de=80;de<=ae-80;de+=40)Yt.beginPath(),Yt.moveTo(80,de),Yt.lineTo(te-80,de),Yt.stroke();Yt.strokeStyle="#5B9BD5",Yt.lineWidth=3,Yt.beginPath(),Yt.moveTo(80,ae/2),Yt.lineTo(te-80,ae/2),Yt.stroke(),Yt.beginPath(),Yt.moveTo(te/2,80),Yt.lineTo(te/2,ae-80),Yt.stroke()}const rn=Et.toDataURL("image/png");return{type:wt,dataUrl:rn,width:te,height:ae,timestamp:Date.now()}},Ke=wt=>{const Et=He(wt);Rt(Et),oe(`Template ready: ${wt}`)},Ne=async()=>{if(!x||!d){console.error("Cannot send: channel or sessionId missing",{channel:!!x,sessionId:d}),oe("Error: Not connected properly. Please refresh the page."),Ae("Failed to send: Connection issue","error");return}try{if(M==="created"){const{error:fe}=await oa.from("sessions").update({status:"active",started_at:new Date().toISOString()}).eq("id",d);if(fe){console.error("Failed to start session:",fe),oe("Failed to start session. Please try again.");return}z("active"),await x.publish("session-started",{timestamp:Date.now(),sessionId:d})}if(C){console.log("💾 Saving teacher annotations from Q",R,"to Supabase before moving to next question");const fe=[];for(const[de,Zt]of Object.entries(X))if(Zt.length>0){const qe=U[de];if(qe){const{data:Me}=await oa.from("participants").select("id").eq("session_id",d).eq("client_id",qe.clientId).eq("role","student").maybeSingle();if(Me){const Ce=oa.from("annotations").upsert({session_id:d,participant_id:Me.id,question_id:C,student_lines:[],teacher_annotations:Zt,last_updated_at:new Date().toISOString()},{onConflict:"participant_id,question_id"});fe.push(Ce)}}}if(fe.length>0)try{await Promise.all(fe),console.log(`✅ Saved annotations for ${fe.length} students to Supabase`)}catch(de){console.error("❌ Failed to save some annotations to Supabase:",de)}}const Et=R+1;v(Et),At.current=Et;let te="blank",ae=null,Yt=null;W==="templates"&&dt?(te="template",ae=dt.type,Yt={dataUrl:dt.dataUrl,width:dt.width,height:dt.height}):W==="image"&&Ut&&(te="image",Yt={dataUrl:Ut.dataUrl,width:Ut.width,height:Ut.height,filename:Ut.filename});const{data:rn,error:En}=await oa.from("questions").insert([{session_id:d,question_number:Et,content_type:te,template_type:ae,image_data:Yt}]).select().single();if(En){console.error("Failed to create question:",En),oe("Failed to save question. Please try again.");return}E(rn.id),fn.current=rn.id,await x.publish("clear-all-drawings",{timestamp:Date.now(),questionId:rn.id}),I(fe=>{const de={};return Object.keys(fe).forEach(Zt=>{de[Zt]={...fe[Zt],lines:[]}}),de}),Y({}),W==="blank"?(await x.publish("teacher-clear",{timestamp:Date.now()}),ze(null),Rt(null),oe(`Question ${Et}: Blank canvas sent to all students.`),Ae(`Question ${Et} sent!`,"success")):W==="templates"&&dt?(await x.publish("teacher-template",dt),ze(dt),oe(`Question ${Et}: Template sent to all students.`),Ae(`Question ${Et} sent!`,"success")):W==="image"&&Ut&&(await x.publish("teacher-image",Ut),ze(Ut),oe(`Question ${Et}: Image sent to all students.`),Ae(`Question ${Et} sent!`,"success"))}catch(wt){console.error("Failed to send to class:",wt),oe("Failed to send. Please try again."),Ae("Failed to send question","error")}},ce=async()=>{window.confirm(`Are you sure you want to end this session?

All students will be logged out and the session will be closed.`)&&(await re("teacher_ended"),P&&P.close(),n("/"))},Le=async()=>{const wt=`${window.location.origin}/student?room=${r}`;try{const Et=await Mb.toDataURL(wt,{width:300,margin:2,color:{dark:"#0F172A",light:"#FFFFFF"}});ct(Et),$e(!0)}catch(Et){console.error("Failed to generate QR code:",Et)}},Rn=async()=>{const wt=`${window.location.origin}/student?room=${r}`,Et=()=>{Ae("Link copied to clipboard!","success")};if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(wt),Et();return}catch(te){console.error("Clipboard API failed:",te)}try{const te=Se.current;if(te&&(te.select(),te.setSelectionRange(0,wt.length),document.execCommand("copy"))){Et(),window.getSelection().removeAllRanges();return}throw new Error("execCommand failed")}catch(te){console.error("Fallback copy failed:",te),Se.current&&Se.current.select(),Ae("Select the link and press ⌘C/CTRL+C to copy","warning")}},On=()=>Object.values(U).sort((wt,Et)=>{const te=(wt.name||wt.clientId||"").toLowerCase(),ae=(Et.name||Et.clientId||"").toLowerCase();return te.localeCompare(ae)}),Ta=()=>{const wt=On(),Et=D.trim().toLowerCase();return wt.filter(te=>{const ae=Et?(te.name||te.studentId).toLowerCase().includes(Et):!0,Yt=F==="all"||F==="flagged"&&te.isFlagged,rn=at==="all"||at==="distracted"&&te.isVisible===!1&&te.isActive;return ae&&Yt&&rn})},Pa=On(),gi=Ta(),Li=Pa.filter(wt=>wt.isActive).length,ca=K?U[K.studentId]||K:null,$n=$t?!/fail|no file/i.test($t):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:Tt.map(wt=>k.jsxs("div",{className:`toast toast-${wt.type}`,children:[wt.type==="success"&&k.jsx("span",{className:"toast-icon",children:"✓"}),wt.type==="info"&&k.jsx("span",{className:"toast-icon",children:"ℹ"}),wt.type==="error"&&k.jsx("span",{className:"toast-icon",children:"✕"}),k.jsx("span",{className:"toast-message",children:wt.message})]},wt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsxs("div",{className:"feather-branding",onClick:()=>window.location.reload(),style:{cursor:"pointer"},children:[k.jsx(iT,{size:32,strokeWidth:2}),k.jsx("span",{className:"feather-text",children:"Feather"})]}),k.jsx("section",{className:"hero-card glass-panel",children:k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"Teacher dashboard"}),k.jsx("h1",{children:"Monitor and annotate student canvases live"}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code to invite students. Their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:Le,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:r})]}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Session live"}),k.jsx("span",{className:`status-pill connection-pill ${O?"online":"offline"}`,children:O?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:Li}),k.jsx("span",{children:"online"})]})]}),k.jsx("button",{className:"end-session-btn",onClick:ce,title:"End session and logout all students",children:"End Session"})]})]})}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),dt&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",dt.type==="hanzi"?"Hanzi":dt.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:Ne,disabled:W==="image"&&!Ut,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${W==="blank"?"active":""}`,onClick:()=>{nt("blank"),Rt(null),Xt(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${W==="templates"?"active":""}`,onClick:()=>{nt("templates"),Xt(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${W==="image"?"active":""} ${Ut?"ready":""}`,onClick:()=>{nt("image"),Rt(null)},disabled:kt,children:kt?"Uploading…":"Send image"})]}),k.jsx("input",{ref:me,type:"file",accept:"image/*",onChange:Jt,style:{display:"none"}}),W==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(dt==null?void 0:dt.type)==="hanzi"?"active":""}`,onClick:()=>Ke("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(dt==null?void 0:dt.type)==="graph-corner"?"active":""}`,onClick:()=>Ke("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(dt==null?void 0:dt.type)==="graph-cross"?"active":""}`,onClick:()=>Ke("graph-cross"),children:"Graph (cross)"})]}),dt&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:dt.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),W==="image"&&k.jsx(k.Fragment,{children:Ut?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:Ut.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:Ut.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:Ut.width&&Ut.height?`${Math.round(Ut.width)} × ${Math.round(Ut.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:Ot,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:Ge,children:"Clear"})]}),$t&&k.jsx("span",{className:`image-message ${$n?"success":"error"}`,children:$t})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:Ot,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),$t&&k.jsx("span",{className:`image-message ${$n?"success":"error"}`,children:$t})]})}),W==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"controls-section glass-panel",children:k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:"🔍"}),k.jsx("input",{type:"text",placeholder:"Filter students",value:D,onChange:wt=>H(wt.target.value),className:"search-input"}),D&&k.jsx("button",{className:"clear-search-btn",onClick:()=>H(""),title:"Clear search",children:"✕"})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:it,onChange:wt=>st(wt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${F==="flagged"?"active":""}`,onClick:()=>tt(wt=>wt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${at==="distracted"?"active":""}`,onClick:()=>Z(wt=>wt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:"⚠️ Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:V,onChange:wt=>J(Number(wt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:Pa.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),k.jsx("h2",{children:"Waiting for students to join…"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):gi.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:"🔍"}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',D,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>H(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${V}, 1fr)`},children:gi.filter(wt=>wt&&wt.studentId&&wt.clientId).map(wt=>k.jsx(jb,{student:wt,onClick:_n,onToggleFlag:Nt,teacherAnnotations:X[wt.studentId]||[],sharedImage:Ee,hideNames:it},wt.studentId))})})})]}),k.jsx(Ub,{student:ca,isOpen:!!ca,isFlagged:ca==null?void 0:ca.isFlagged,onToggleFlag:Nt,onClose:ea,onAnnotate:Xn,existingAnnotations:ca?X[ca.studentId]||[]:[],sharedImage:Ee}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:["💡 ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),Oe&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>$e(!1),children:k.jsxs("div",{className:"qr-modal",onClick:wt=>wt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",r]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>$e(!1),children:"✕"})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:xe&&k.jsx("img",{src:xe,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:Se,type:"text",value:`${window.location.origin}/student?room=${r}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:Rn,children:"Copy Link"})]})]})]})]})})]})},O2={width:800,height:600};function qT(){const[o]=Sh(),t=o.get("room")||"load-test",n=o.get("name")||`TestStudent-${Date.now()}`,[a,r]=rt.useState(null),[l]=rt.useState(`test-student-${Math.random().toString(36).substr(2,9)}`),[c,d]=rt.useState(!1),[g,m]=rt.useState([]),[S,C]=rt.useState([]),[E,R]=rt.useState("pen"),[v,M]=rt.useState(!1),z=rt.useRef(!1);rt.useEffect(()=>{(async()=>{try{const T=new RS.Realtime({authUrl:"/api/token",authParams:{clientId:l}});T.connection.on("connected",()=>{console.log("Connected to Ably"),d(!0)}),T.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),d(!1)});const A=T.channels.get(`room-${t}`);await new Promise((B,U)=>{A.once("attached",B),A.once("failed",U),A.attach()}),console.log("✅ Test Student channel attached");const y={name:n,role:"student",testMode:!0};console.log("📍 Entering presence with data:",y),await A.presence.enter(y),console.log("✅ Test Student entered presence as:",n),A.subscribe("student-layer",B=>{z.current=!0;const U=B.data;U.action==="clear"?m([]):U.lines&&m(I=>[...I,...U.lines]),setTimeout(()=>{z.current=!1},0)}),A.subscribe("teacher-layer",B=>{const U=B.data;U.action==="clear"?C([]):U.lines&&C(I=>[...I,...U.lines])}),r(A)}catch(T){console.error("Failed to initialize Ably:",T)}})()},[l,t,n]);const P=O=>{const T=O.target.getStage().getPointerPosition();if(!T)return;M(!0);const A={tool:E,points:[T.x,T.y],color:"black",strokeWidth:3};m([...g,A])},j=O=>{if(!v)return;const A=O.target.getStage().getPointerPosition();if(!A)return;const y=g[g.length-1];y&&(y.points=y.points.concat([A.x,A.y]),m([...g.slice(0,-1),y]))},x=()=>{if(!v||!a){M(!1);return}M(!1);const O=g[g.length-1];O&&O.points.length>=4&&a.publish("student-layer",{lines:[O]})},L=()=>{m([]),a&&a.publish("student-layer",{action:"clear"})};return k.jsxs("div",{className:"student-container",children:[k.jsxs("div",{className:"student-header",children:[k.jsxs("div",{className:"student-info",children:[k.jsx("span",{className:"student-name",children:n}),k.jsxs("span",{className:"room-code",children:["Room: ",t]}),k.jsx("span",{className:`connection-status ${c?"connected":"disconnected"}`,children:c?"● Connected":"○ Disconnected"})]}),k.jsx("div",{className:"test-badge",children:"TEST MODE"})]}),k.jsxs("div",{className:"toolbar",children:[k.jsx("button",{className:`tool-btn ${E==="pen"?"active":""}`,onClick:()=>R("pen"),title:"Pen",children:"✏️ Pen"}),k.jsx("button",{className:`tool-btn ${E==="eraser"?"active":""}`,onClick:()=>R("eraser"),title:"Eraser",children:"🧹 Eraser"}),k.jsx("button",{className:"tool-btn",onClick:L,title:"Clear Canvas",children:"🗑️ Clear"})]}),k.jsx("div",{className:"canvas-container",children:k.jsxs(Bg,{width:O2.width,height:O2.height,onMouseDown:P,onMousemove:j,onMouseup:x,onTouchStart:P,onTouchMove:j,onTouchEnd:x,className:"konva-stage",children:[k.jsx(Wr,{children:g.map((O,T)=>k.jsx(Sl,{points:O.points,stroke:O.tool==="eraser"?"white":O.color,strokeWidth:O.tool==="eraser"?20:O.strokeWidth,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:O.tool==="eraser"?"destination-out":"source-over"},`student-${T}`))}),k.jsx(Wr,{listening:!1,children:S.map((O,T)=>k.jsx(Sl,{points:O.points,stroke:"red",strokeWidth:O.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round",opacity:.7},`teacher-${T}`))})]})}),k.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",background:"#f0f0f0",padding:"10px",borderRadius:"8px",fontSize:"12px"},children:[k.jsx("div",{children:k.jsx("strong",{children:"Test Mode Instructions:"})}),k.jsx("div",{children:"• No login required"}),k.jsx("div",{children:"• Draw on canvas to test"}),k.jsx("div",{children:"• Red lines are from teacher"})]})]})}const VT=()=>{const[o]=Sh(),t=bf(),n=()=>{const zt=o.get("room");return zt?zt.toUpperCase():"load-test".toUpperCase()},[a]=pa.useState(n),[r,l]=rt.useState(null),[c,d]=rt.useState(null),[g,m]=rt.useState(!1),[S]=rt.useState(`test-teacher-${Math.random().toString(36).substring(7)}`),[C,E]=rt.useState({}),[R,v]=rt.useState(null),[M,z]=rt.useState({}),[P,j]=rt.useState(""),[x,L]=rt.useState("all"),[O,T]=rt.useState("all"),[A,y]=rt.useState(()=>{const zt=localStorage.getItem("teacherDashboardHideNames");return zt?JSON.parse(zt):!1}),[B,U]=rt.useState(()=>{const zt=localStorage.getItem("teacherDashboardCardsPerRow");return zt?parseInt(zt):3}),[I,K]=rt.useState("blank"),[Q,X]=rt.useState(null),[Y,D]=rt.useState(null),[H,F]=rt.useState(""),[tt,at]=rt.useState(!1),[Z,it]=rt.useState(null),st=rt.useRef(null),V=rt.useRef(null),J=rt.useRef(null),[W,nt]=rt.useState(!1),[dt,Rt]=rt.useState(""),[Ut,Xt]=rt.useState([]);rt.useRef(!1),rt.useEffect(()=>{st.current=Z},[Z]);const $t=(zt,ee="info")=>{const qt=Date.now();Xt(an=>[...an,{id:qt,message:zt,type:ee}]),setTimeout(()=>{Xt(an=>an.filter(Ae=>Ae.id!==qt))},4e3)};rt.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(A))},[A]),rt.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",B.toString())},[B]),rt.useEffect(()=>((async()=>{try{const ee=new yv.Realtime({authUrl:"/api/token",authParams:{clientId:S}});ee.connection.on("connected",()=>{console.log("✅ Test Teacher connected to Ably"),m(!0)}),ee.connection.on("disconnected",()=>{console.log("❌ Test Teacher disconnected"),m(!1)});const qt=ee.channels.get(`room-${a}`);await new Promise((re,tn)=>{qt.once("attached",re),qt.once("failed",tn),qt.attach()}),console.log("✅ Channel attached"),qt.presence.subscribe("enter",re=>{var tn,_n;console.log("👤 Member entered:",re.clientId,"Role:",(tn=re.data)==null?void 0:tn.role,"Data:",re.data),((_n=re.data)==null?void 0:_n.role)==="student"&&(console.log("✅ Adding student to dashboard:",re.data.name||re.clientId),E(ea=>({...ea,[re.clientId]:{clientId:re.clientId,name:re.data.name||re.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,testMode:re.data.testMode||!1,meta:{base:{width:800,height:600}}}})))}),qt.presence.subscribe("leave",re=>{console.log("👋 Student left:",re.clientId),E(tn=>{const _n={...tn};return _n[re.clientId]&&(_n[re.clientId].isActive=!1),_n})}),qt.presence.subscribe("update",re=>{var tn;((tn=re.data)==null?void 0:tn.isVisible)!==void 0&&E(_n=>{const ea={..._n};return ea[re.clientId]&&(ea[re.clientId].isVisible=re.data.isVisible),ea})});const an=await qt.presence.get();console.log(`📋 Found ${an.length} members in presence`);const Ae={};an.forEach(re=>{var tn,_n,ea,Xn,Nt;console.log("  - Member:",re.clientId,"Role:",(tn=re.data)==null?void 0:tn.role,"Name:",(_n=re.data)==null?void 0:_n.name),((ea=re.data)==null?void 0:ea.role)==="student"&&(console.log("    ✅ Adding existing student:",re.data.name||re.clientId),Ae[re.clientId]={clientId:re.clientId,name:re.data.name||re.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:((Xn=re.data)==null?void 0:Xn.isVisible)!==!1,testMode:((Nt=re.data)==null?void 0:Nt.testMode)||!1,meta:{base:{width:800,height:600}}})}),console.log(`✅ Initialized with ${Object.keys(Ae).length} students`),E(Ae),qt.subscribe("student-layer",re=>{const{clientId:tn}=re,_n=re.data;E(ea=>{const Xn={...ea};return Xn[tn]||(Xn[tn]={clientId:tn,name:tn,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,meta:{base:{width:800,height:600}}}),_n.action==="clear"?Xn[tn].lines=[]:_n.lines&&(Xn[tn].lines=[...Xn[tn].lines,..._n.lines]),Xn[tn].lastUpdate=Date.now(),Xn})}),await qt.presence.enter({role:"teacher",name:"Test Teacher",testMode:!0}),l(ee),d(qt)}catch(ee){console.error("Failed to connect to Ably:",ee)}})(),()=>{c&&c.presence.leave(),r&&r.close()}),[a,S]),rt.useEffect(()=>{if(W){const zt=`${window.location.origin}/test/student?room=${a}`;Mb.toDataURL(zt,{width:300,margin:2}).then(ee=>Rt(ee)).catch(ee=>console.error("Failed to generate QR code:",ee))}},[W,a]);const oe=()=>{t("/")},kt=()=>{nt(!0)},Re=()=>{c&&(c.publish("session-ended",{timestamp:Date.now(),reason:"teacher_ended"}),$t("Session ended","success"))},Ee=zt=>{v(C[zt.clientId]||zt)},ze=()=>{v(null)},Xe=zt=>{if(!R||!c)return;const ee=R.clientId;z(qt=>({...qt,[ee]:zt})),c.publish("teacher-annotation",{targetStudentId:ee,annotations:zt,teacherId:S,timestamp:Date.now()}),console.log("📤 Published annotations for",ee)},nn=zt=>{E(ee=>{const qt=ee[zt];return qt?{...ee,[zt]:{...qt,isFlagged:!qt.isFlagged}}:ee}),v(ee=>ee&&ee.clientId===zt?{...ee,isFlagged:!ee.isFlagged}:ee)},fn=zt=>{const ee=document.createElement("canvas");ee.width=800,ee.height=600;const qt=ee.getContext("2d");if(qt.fillStyle="white",qt.fillRect(0,0,800,600),qt.strokeStyle="#ddd",qt.lineWidth=1,zt==="hanzi")qt.strokeRect(250,150,300,300),qt.beginPath(),qt.moveTo(400,150),qt.lineTo(400,450),qt.moveTo(250,300),qt.lineTo(550,300),qt.stroke();else if(zt==="graph-corner"){qt.beginPath(),qt.moveTo(100,500),qt.lineTo(100,100),qt.lineTo(700,100),qt.stroke();for(let Ae=1;Ae<10;Ae++){const re=100+Ae*60;qt.beginPath(),qt.moveTo(re,100),qt.lineTo(re,500),qt.stroke()}for(let Ae=1;Ae<8;Ae++){const re=100+Ae*50;qt.beginPath(),qt.moveTo(100,re),qt.lineTo(700,re),qt.stroke()}}else if(zt==="graph-cross"){qt.beginPath(),qt.moveTo(50,300),qt.lineTo(750,300),qt.moveTo(400,50),qt.lineTo(400,550),qt.stroke();for(let Ae=-6;Ae<=6;Ae++){if(Ae===0)continue;const re=400+Ae*50;qt.beginPath(),qt.moveTo(re,50),qt.lineTo(re,550),qt.stroke()}for(let Ae=-5;Ae<=5;Ae++){if(Ae===0)continue;const re=300+Ae*50;qt.beginPath(),qt.moveTo(50,re),qt.lineTo(750,re),qt.stroke()}}const an=ee.toDataURL("image/png");X({type:zt,dataUrl:an,width:800,height:600})},At=()=>{V.current&&(V.current.value="",V.current.click())},Ht=async zt=>{var qt;const ee=(qt=zt.target.files)==null?void 0:qt[0];if(!ee){F("No file selected.");return}at(!0),F("");try{const{dataUrl:an,width:Ae,height:re}=await Bb(ee),tn={dataUrl:an,width:Ae,height:re,filename:ee.name,timestamp:Date.now()};D(tn),F("Image ready to send.")}catch(an){console.error("Failed to upload image:",an),F("Upload failed. Please try again.")}finally{at(!1)}},me=()=>{D(null),F("")},Se=()=>{if(!c)return;let zt=null;I==="templates"&&Q?zt=Q:I==="image"&&Y&&(zt=Y),c.publish("teacher-action",{action:"send-blank-canvas",questionNumber:1,sharedImage:zt,timestamp:Date.now()}),it(zt||null),$t("Sent to all students","success"),console.log("📄 Sent to class:",I)},Oe=async()=>{const zt=`${window.location.origin}/test/student?room=${a}`;try{await navigator.clipboard.writeText(zt),$t("Link copied to clipboard","success")}catch(ee){console.error("Clipboard API failed:",ee);try{J.current&&(J.current.select(),document.execCommand("copy"),$t("Link copied to clipboard","success"))}catch(qt){console.error("Fallback copy failed:",qt),J.current&&J.current.select(),alert("Please copy the selected link manually")}}},$e=()=>Object.values(C).sort((zt,ee)=>zt.isActive&&!ee.isActive?-1:!zt.isActive&&ee.isActive?1:(ee.lastUpdate||0)-(zt.lastUpdate||0)),xe=()=>{const zt=$e(),ee=P.trim().toLowerCase();return zt.filter(qt=>{const an=ee?(qt.name||qt.clientId).toLowerCase().includes(ee):!0,Ae=x==="all"||x==="flagged"&&qt.isFlagged,re=O==="all"||O==="distracted"&&qt.isVisible===!1&&qt.isActive;return an&&Ae&&re})},ct=$e(),Tt=xe(),Mt=ct.filter(zt=>zt.isActive).length,Pt=R?C[R.clientId]||R:null,se=H?!/fail|no file/i.test(H):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:Ut.map(zt=>k.jsxs("div",{className:`toast toast-${zt.type}`,children:[zt.type==="success"&&k.jsx("span",{className:"toast-icon",children:"✓"}),zt.type==="info"&&k.jsx("span",{className:"toast-icon",children:"ℹ"}),zt.type==="error"&&k.jsx("span",{className:"toast-icon",children:"✕"}),k.jsx("span",{className:"toast-message",children:zt.message})]},zt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsx("button",{className:"back-link",onClick:oe,children:"← Exit class"}),k.jsxs("section",{className:"hero-card glass-panel",children:[k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"🧪 Test Teacher dashboard"}),k.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:kt,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:a})]}),k.jsx("button",{className:"end-session-btn",onClick:Re,title:"End session and logout all students",children:"End Session"}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Test mode"}),k.jsx("span",{className:`status-pill connection-pill ${g?"online":"offline"}`,children:g?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:Mt}),k.jsx("span",{children:"online"})]})]})]})]}),k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:"🔍"}),k.jsx("input",{type:"text",placeholder:"Filter students",value:P,onChange:zt=>j(zt.target.value),className:"search-input"}),P&&k.jsx("button",{className:"clear-search-btn",onClick:()=>j(""),title:"Clear search",children:"✕"})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:A,onChange:zt=>y(zt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${x==="flagged"?"active":""}`,onClick:()=>L(zt=>zt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${O==="distracted"?"active":""}`,onClick:()=>T(zt=>zt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:"⚠️ Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:B,onChange:zt=>U(Number(zt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})]}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),Q&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",Q.type==="hanzi"?"Hanzi":Q.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:Se,disabled:I==="image"&&!Y,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${I==="blank"?"active":""}`,onClick:()=>{K("blank"),X(null),D(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${I==="templates"?"active":""}`,onClick:()=>{K("templates"),D(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${I==="image"?"active":""} ${Y?"ready":""}`,onClick:()=>{K("image"),X(null)},disabled:tt,children:tt?"Uploading…":"Send image"})]}),k.jsx("input",{ref:V,type:"file",accept:"image/*",onChange:Ht,style:{display:"none"}}),I==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="hanzi"?"active":""}`,onClick:()=>fn("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="graph-corner"?"active":""}`,onClick:()=>fn("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(Q==null?void 0:Q.type)==="graph-cross"?"active":""}`,onClick:()=>fn("graph-cross"),children:"Graph (cross)"})]}),Q&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:Q.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),I==="image"&&k.jsx(k.Fragment,{children:Y?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:Y.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:Y.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:Y.width&&Y.height?`${Math.round(Y.width)} × ${Math.round(Y.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:At,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:me,children:"Clear"})]}),H&&k.jsx("span",{className:`image-message ${se?"success":"error"}`,children:H})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:At,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),H&&k.jsx("span",{className:`image-message ${se?"success":"error"}`,children:H})]})}),I==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:ct.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),k.jsx("h2",{children:"Waiting for students to join…"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):Tt.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:"🔍"}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',P,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>j(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${B}, 1fr)`},children:Tt.filter(zt=>zt&&zt.clientId).map(zt=>k.jsx(jb,{student:zt,onClick:Ee,onToggleFlag:nn,teacherAnnotations:M[zt.clientId]||[],sharedImage:Z,hideNames:A},zt.clientId))})})})]}),k.jsx(Ub,{student:Pt,isOpen:!!Pt,isFlagged:Pt==null?void 0:Pt.isFlagged,onToggleFlag:nn,onClose:ze,onAnnotate:Xe,existingAnnotations:Pt?M[Pt.clientId]||[]:[],sharedImage:Z}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:["💡 ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),W&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>nt(!1),children:k.jsxs("div",{className:"qr-modal",onClick:zt=>zt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",a]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>nt(!1),children:"✕"})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:dt&&k.jsx("img",{src:dt,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:J,type:"text",value:`${window.location.origin}/test/student?room=${a}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:Oe,children:"Copy Link"})]})]})]})]})})]})};function YT(){return k.jsx(x3,{children:k.jsxs(A3,{children:[k.jsx(vu,{path:"/",element:k.jsx(N3,{})}),k.jsx(vu,{path:"/student-login",element:k.jsx(mT,{})}),k.jsx(vu,{path:"/student",element:k.jsx(pT,{})}),k.jsx(vu,{path:"/teacher",element:k.jsx(kT,{})}),k.jsx(vu,{path:"/test/student",element:k.jsx(qT,{})}),k.jsx(vu,{path:"/test/teacher",element:k.jsx(VT,{})})]})})}j4.createRoot(document.getElementById("root")).render(k.jsx(pa.StrictMode,{children:k.jsx(YT,{})}));
