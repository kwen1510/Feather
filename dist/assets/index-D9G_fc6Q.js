function W4(o,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in o)){const l=Object.getOwnPropertyDescriptor(i,r);l&&Object.defineProperty(o,r,l.get?l:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function ff(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function m2(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var t=o.default;if(typeof t=="function"){var n=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(i){var r=Object.getOwnPropertyDescriptor(o,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return o[i]}})}),n}var gp={exports:{}},Ih={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a1;function $4(){if(a1)return Ih;a1=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(i,r,l){var f=null;if(l!==void 0&&(f=""+l),r.key!==void 0&&(f=""+r.key),"key"in r){l={};for(var d in r)d!=="key"&&(l[d]=r[d])}else l=r;return r=l.ref,{$$typeof:o,type:i,key:f,ref:r!==void 0?r:null,props:l}}return Ih.Fragment=t,Ih.jsx=n,Ih.jsxs=n,Ih}var r1;function tb(){return r1||(r1=1,gp.exports=$4()),gp.exports}var Z=tb(),pp={exports:{}},ye={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s1;function eb(){if(s1)return ye;s1=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),f=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),E=Symbol.iterator;function R(J){return J===null||typeof J!="object"?null:(J=E&&J[E]||J["@@iterator"],typeof J=="function"?J:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,z={};function L(J,rt,it){this.props=J,this.context=rt,this.refs=z,this.updater=it||v}L.prototype.isReactComponent={},L.prototype.setState=function(J,rt){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,rt,"setState")},L.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function N(){}N.prototype=L.prototype;function M(J,rt,it){this.props=J,this.context=rt,this.refs=z,this.updater=it||v}var G=M.prototype=new N;G.constructor=M,D(G,L.prototype),G.isPureReactComponent=!0;var w=Array.isArray;function O(){}var A={H:null,A:null,T:null,S:null},y=Object.prototype.hasOwnProperty;function B(J,rt,it){var q=it.ref;return{$$typeof:o,type:J,key:rt,ref:q!==void 0?q:null,props:it}}function U(J,rt){return B(J.type,rt,J.props)}function P(J){return typeof J=="object"&&J!==null&&J.$$typeof===o}function Y(J){var rt={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(it){return rt[it]})}var K=/\/+/g;function Q(J,rt){return typeof J=="object"&&J!==null&&J.key!=null?Y(""+J.key):rt.toString(36)}function V(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(O,O):(J.status="pending",J.then(function(rt){J.status==="pending"&&(J.status="fulfilled",J.value=rt)},function(rt){J.status==="pending"&&(J.status="rejected",J.reason=rt)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function j(J,rt,it,q,F){var tt=typeof J;(tt==="undefined"||tt==="boolean")&&(J=null);var nt=!1;if(J===null)nt=!0;else switch(tt){case"bigint":case"string":case"number":nt=!0;break;case"object":switch(J.$$typeof){case o:case t:nt=!0;break;case _:return nt=J._init,j(nt(J._payload),rt,it,q,F)}}if(nt)return F=F(J),nt=q===""?"."+Q(J,0):q,w(F)?(it="",nt!=null&&(it=nt.replace(K,"$&/")+"/"),j(F,rt,it,"",function(Bt){return Bt})):F!=null&&(P(F)&&(F=U(F,it+(F.key==null||J&&J.key===F.key?"":(""+F.key).replace(K,"$&/")+"/")+nt)),rt.push(F)),1;nt=0;var gt=q===""?".":q+":";if(w(J))for(var At=0;At<J.length;At++)q=J[At],tt=gt+Q(q,At),nt+=j(q,rt,it,tt,F);else if(At=R(J),typeof At=="function")for(J=At.call(J),At=0;!(q=J.next()).done;)q=q.value,tt=gt+Q(q,At++),nt+=j(q,rt,it,tt,F);else if(tt==="object"){if(typeof J.then=="function")return j(V(J),rt,it,q,F);throw rt=String(J),Error("Objects are not valid as a React child (found: "+(rt==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":rt)+"). If you meant to render a collection of children, use an array instead.")}return nt}function I(J,rt,it){if(J==null)return J;var q=[],F=0;return j(J,q,"","",function(tt){return rt.call(it,tt,F++)}),q}function X(J){if(J._status===-1){var rt=J._result;rt=rt(),rt.then(function(it){(J._status===0||J._status===-1)&&(J._status=1,J._result=it)},function(it){(J._status===0||J._status===-1)&&(J._status=2,J._result=it)}),J._status===-1&&(J._status=0,J._result=rt)}if(J._status===1)return J._result.default;throw J._result}var W=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var rt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(rt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},at={map:I,forEach:function(J,rt,it){I(J,function(){rt.apply(this,arguments)},it)},count:function(J){var rt=0;return I(J,function(){rt++}),rt},toArray:function(J){return I(J,function(rt){return rt})||[]},only:function(J){if(!P(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return ye.Activity=C,ye.Children=at,ye.Component=L,ye.Fragment=n,ye.Profiler=r,ye.PureComponent=M,ye.StrictMode=i,ye.Suspense=g,ye.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ye.__COMPILER_RUNTIME={__proto__:null,c:function(J){return A.H.useMemoCache(J)}},ye.cache=function(J){return function(){return J.apply(null,arguments)}},ye.cacheSignal=function(){return null},ye.cloneElement=function(J,rt,it){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var q=D({},J.props),F=J.key;if(rt!=null)for(tt in rt.key!==void 0&&(F=""+rt.key),rt)!y.call(rt,tt)||tt==="key"||tt==="__self"||tt==="__source"||tt==="ref"&&rt.ref===void 0||(q[tt]=rt[tt]);var tt=arguments.length-2;if(tt===1)q.children=it;else if(1<tt){for(var nt=Array(tt),gt=0;gt<tt;gt++)nt[gt]=arguments[gt+2];q.children=nt}return B(J.type,F,q)},ye.createContext=function(J){return J={$$typeof:f,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:l,_context:J},J},ye.createElement=function(J,rt,it){var q,F={},tt=null;if(rt!=null)for(q in rt.key!==void 0&&(tt=""+rt.key),rt)y.call(rt,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(F[q]=rt[q]);var nt=arguments.length-2;if(nt===1)F.children=it;else if(1<nt){for(var gt=Array(nt),At=0;At<nt;At++)gt[At]=arguments[At+2];F.children=gt}if(J&&J.defaultProps)for(q in nt=J.defaultProps,nt)F[q]===void 0&&(F[q]=nt[q]);return B(J,tt,F)},ye.createRef=function(){return{current:null}},ye.forwardRef=function(J){return{$$typeof:d,render:J}},ye.isValidElement=P,ye.lazy=function(J){return{$$typeof:_,_payload:{_status:-1,_result:J},_init:X}},ye.memo=function(J,rt){return{$$typeof:m,type:J,compare:rt===void 0?null:rt}},ye.startTransition=function(J){var rt=A.T,it={};A.T=it;try{var q=J(),F=A.S;F!==null&&F(it,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(O,W)}catch(tt){W(tt)}finally{rt!==null&&it.types!==null&&(rt.types=it.types),A.T=rt}},ye.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ye.use=function(J){return A.H.use(J)},ye.useActionState=function(J,rt,it){return A.H.useActionState(J,rt,it)},ye.useCallback=function(J,rt){return A.H.useCallback(J,rt)},ye.useContext=function(J){return A.H.useContext(J)},ye.useDebugValue=function(){},ye.useDeferredValue=function(J,rt){return A.H.useDeferredValue(J,rt)},ye.useEffect=function(J,rt){return A.H.useEffect(J,rt)},ye.useEffectEvent=function(J){return A.H.useEffectEvent(J)},ye.useId=function(){return A.H.useId()},ye.useImperativeHandle=function(J,rt,it){return A.H.useImperativeHandle(J,rt,it)},ye.useInsertionEffect=function(J,rt){return A.H.useInsertionEffect(J,rt)},ye.useLayoutEffect=function(J,rt){return A.H.useLayoutEffect(J,rt)},ye.useMemo=function(J,rt){return A.H.useMemo(J,rt)},ye.useOptimistic=function(J,rt){return A.H.useOptimistic(J,rt)},ye.useReducer=function(J,rt,it){return A.H.useReducer(J,rt,it)},ye.useRef=function(J){return A.H.useRef(J)},ye.useState=function(J){return A.H.useState(J)},ye.useSyncExternalStore=function(J,rt,it){return A.H.useSyncExternalStore(J,rt,it)},ye.useTransition=function(){return A.H.useTransition()},ye.version="19.2.0",ye}var l1;function _g(){return l1||(l1=1,pp.exports=eb()),pp.exports}var dt=_g();const In=ff(dt),nb=W4({__proto__:null,default:In},[dt]);var mp={exports:{}},kh={},vp={exports:{}},yp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o1;function ib(){return o1||(o1=1,(function(o){function t(j,I){var X=j.length;j.push(I);t:for(;0<X;){var W=X-1>>>1,at=j[W];if(0<r(at,I))j[W]=I,j[X]=at,X=W;else break t}}function n(j){return j.length===0?null:j[0]}function i(j){if(j.length===0)return null;var I=j[0],X=j.pop();if(X!==I){j[0]=X;t:for(var W=0,at=j.length,J=at>>>1;W<J;){var rt=2*(W+1)-1,it=j[rt],q=rt+1,F=j[q];if(0>r(it,X))q<at&&0>r(F,it)?(j[W]=F,j[q]=X,W=q):(j[W]=it,j[rt]=X,W=rt);else if(q<at&&0>r(F,X))j[W]=F,j[q]=X,W=q;else break t}}return I}function r(j,I){var X=j.sortIndex-I.sortIndex;return X!==0?X:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,z=!1,L=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(j){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=j)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function w(j){if(D=!1,G(j),!v)if(n(g)!==null)v=!0,O||(O=!0,Y());else{var I=n(m);I!==null&&V(w,I.startTime-j)}}var O=!1,A=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,O){var j=o.unstable_now();B=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(A),A=-1),R=!0;var X=E;try{e:{for(G(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var at=W(C.expirationTime<=j);if(j=o.unstable_now(),typeof at=="function"){C.callback=at,G(j),I=!0;break e}C===n(g)&&i(g),G(j)}else i(g);C=n(g)}if(C!==null)I=!0;else{var J=n(m);J!==null&&V(w,J.startTime-j),I=!1}}break t}finally{C=null,E=X,R=!1}I=void 0}}finally{I?Y():O=!1}}}var Y;if(typeof M=="function")Y=function(){M(P)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Q=K.port2;K.port1.onmessage=P,Y=function(){Q.postMessage(null)}}else Y=function(){L(P,0)};function V(j,I){A=L(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var X=E;E=I;try{return j()}finally{E=X}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=E;E=j;try{return I()}finally{E=X}},o.unstable_scheduleCallback=function(j,I,X){var W=o.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?W+X:W):X=W,j){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=X+at,j={id:_++,callback:I,priorityLevel:j,startTime:X,expirationTime:at,sortIndex:-1},X>W?(j.sortIndex=X,t(m,j),n(g)===null&&j===n(m)&&(D?(N(A),A=-1):D=!0,V(w,X-W))):(j.sortIndex=at,t(g,j),v||R||(v=!0,O||(O=!0,Y()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var X=E;E=I;try{return j.apply(this,arguments)}finally{E=X}}}})(yp)),yp}var u1;function ab(){return u1||(u1=1,vp.exports=ib()),vp.exports}var Sp={exports:{}},Vi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1;function rb(){if(c1)return Vi;c1=1;var o=_g();function t(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(g,m,_){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:C==null?null:""+C,children:g,containerInfo:m,implementation:_}}var f=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Vi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Vi.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(g,m,null,_)},Vi.flushSync=function(g){var m=f.T,_=i.p;try{if(f.T=null,i.p=2,g)return g()}finally{f.T=m,i.p=_,i.d.f()}},Vi.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},Vi.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Vi.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,R=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:C,integrity:E,fetchPriority:R}):_==="script"&&i.d.X(g,{crossOrigin:C,integrity:E,fetchPriority:R,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Vi.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=d(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},Vi.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin);i.d.L(g,_,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Vi.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=d(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},Vi.requestFormReset=function(g){i.d.r(g)},Vi.unstable_batchedUpdates=function(g,m){return g(m)},Vi.useFormState=function(g,m,_){return f.H.useFormState(g,m,_)},Vi.useFormStatus=function(){return f.H.useHostTransitionStatus()},Vi.version="19.2.0",Vi}var f1;function v2(){if(f1)return Sp.exports;f1=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),Sp.exports=rb(),Sp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1;function sb(){if(h1)return kh;h1=1;var o=ab(),t=_g(),n=v2();function i(e){var a="https://react.dev/errors/"+e;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+e+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var a=e,c=e;if(e.alternate)for(;a.return;)a=a.return;else{e=a;do a=e,(a.flags&4098)!==0&&(c=a.return),e=a.return;while(e)}return a.tag===3?c:null}function f(e){if(e.tag===13){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function d(e){if(e.tag===31){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function g(e){if(l(e)!==e)throw Error(i(188))}function m(e){var a=e.alternate;if(!a){if(a=l(e),a===null)throw Error(i(188));return a!==e?null:e}for(var c=e,h=a;;){var b=c.return;if(b===null)break;var T=b.alternate;if(T===null){if(h=b.return,h!==null){c=h;continue}break}if(b.child===T.child){for(T=b.child;T;){if(T===c)return g(b),e;if(T===h)return g(b),a;T=T.sibling}throw Error(i(188))}if(c.return!==h.return)c=b,h=T;else{for(var k=!1,$=b.child;$;){if($===c){k=!0,c=b,h=T;break}if($===h){k=!0,h=b,c=T;break}$=$.sibling}if(!k){for($=T.child;$;){if($===c){k=!0,c=T,h=b;break}if($===h){k=!0,h=T,c=b;break}$=$.sibling}if(!k)throw Error(i(189))}}if(c.alternate!==h)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?e:a}function _(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e;for(e=e.child;e!==null;){if(a=_(e),a!==null)return a;e=e.sibling}return null}var C=Object.assign,E=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),M=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function Y(e){return e===null||typeof e!="object"?null:(e=P&&e[P]||e["@@iterator"],typeof e=="function"?e:null)}var K=Symbol.for("react.client.reference");function Q(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===K?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case D:return"Fragment";case L:return"Profiler";case z:return"StrictMode";case w:return"Suspense";case O:return"SuspenseList";case B:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case M:return e.displayName||"Context";case N:return(e._context.displayName||"Context")+".Consumer";case G:var a=e.render;return e=e.displayName,e||(e=a.displayName||a.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case A:return a=e.displayName||null,a!==null?a:Q(e.type)||"Memo";case y:a=e._payload,e=e._init;try{return Q(e(a))}catch{}}return null}var V=Array.isArray,j=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},W=[],at=-1;function J(e){return{current:e}}function rt(e){0>at||(e.current=W[at],W[at]=null,at--)}function it(e,a){at++,W[at]=e.current,e.current=a}var q=J(null),F=J(null),tt=J(null),nt=J(null);function gt(e,a){switch(it(tt,a),it(F,e),it(q,null),a.nodeType){case 9:case 11:e=(e=a.documentElement)&&(e=e.namespaceURI)?Rv(e):0;break;default:if(e=a.tagName,a=a.namespaceURI)a=Rv(a),e=wv(a,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}rt(q),it(q,e)}function At(){rt(q),rt(F),rt(tt)}function Bt(e){e.memoizedState!==null&&it(nt,e);var a=q.current,c=wv(a,e.type);a!==c&&(it(F,e),it(q,c))}function qt(e){F.current===e&&(rt(q),rt(F)),nt.current===e&&(rt(nt),Lh._currentValue=X)}var Jt,ee;function Gt(e){if(Jt===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);Jt=a&&a[1]||"",ee=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Jt+e+ee}var be=!1;function Re(e,a){if(!e||be)return"";be=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var Mt=function(){throw Error()};if(Object.defineProperty(Mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Mt,[])}catch(Tt){var Et=Tt}Reflect.construct(e,[],Mt)}else{try{Mt.call()}catch(Tt){Et=Tt}e.call(Mt.prototype)}}else{try{throw Error()}catch(Tt){Et=Tt}(Mt=e())&&typeof Mt.catch=="function"&&Mt.catch(function(){})}}catch(Tt){if(Tt&&Et&&typeof Tt.stack=="string")return[Tt.stack,Et.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=h.DetermineComponentFrameRoot(),k=T[0],$=T[1];if(k&&$){var lt=k.split(`
`),St=$.split(`
`);for(b=h=0;h<lt.length&&!lt[h].includes("DetermineComponentFrameRoot");)h++;for(;b<St.length&&!St[b].includes("DetermineComponentFrameRoot");)b++;if(h===lt.length||b===St.length)for(h=lt.length-1,b=St.length-1;1<=h&&0<=b&&lt[h]!==St[b];)b--;for(;1<=h&&0<=b;h--,b--)if(lt[h]!==St[b]){if(h!==1||b!==1)do if(h--,b--,0>b||lt[h]!==St[b]){var Ot=`
`+lt[h].replace(" at new "," at ");return e.displayName&&Ot.includes("<anonymous>")&&(Ot=Ot.replace("<anonymous>",e.displayName)),Ot}while(1<=h&&0<=b);break}}}finally{be=!1,Error.prepareStackTrace=c}return(c=e?e.displayName||e.name:"")?Gt(c):""}function tn(e,a){switch(e.tag){case 26:case 27:case 5:return Gt(e.type);case 16:return Gt("Lazy");case 13:return e.child!==a&&a!==null?Gt("Suspense Fallback"):Gt("Suspense");case 19:return Gt("SuspenseList");case 0:case 15:return Re(e.type,!1);case 11:return Re(e.type.render,!1);case 1:return Re(e.type,!0);case 31:return Gt("Activity");default:return""}}function Rt(e){try{var a="",c=null;do a+=tn(e,c),c=e,e=e.return;while(e);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Kt=Object.prototype.hasOwnProperty,Be=o.unstable_scheduleCallback,te=o.unstable_cancelCallback,ae=o.unstable_shouldYield,qe=o.unstable_requestPaint,xe=o.unstable_now,an=o.unstable_getCurrentPriorityLevel,yn=o.unstable_ImmediatePriority,hn=o.unstable_UserBlockingPriority,ct=o.unstable_NormalPriority,ht=o.unstable_LowPriority,ut=o.unstable_IdlePriority,xt=o.log,Dt=o.unstable_setDisableYieldValue,$t=null,de=null;function Fe(e){if(typeof xt=="function"&&Dt(e),de&&typeof de.setStrictMode=="function")try{de.setStrictMode($t,e)}catch{}}var Je=Math.clz32?Math.clz32:sa,Ki=Math.log,ur=Math.LN2;function sa(e){return e>>>=0,e===0?32:31-(Ki(e)/ur|0)|0}var Di=256,la=262144,gi=4194304;function Sa(e){var a=e&42;if(a!==0)return a;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ut(e,a,c){var h=e.pendingLanes;if(h===0)return 0;var b=0,T=e.suspendedLanes,k=e.pingedLanes;e=e.warmLanes;var $=h&134217727;return $!==0?(h=$&~T,h!==0?b=Sa(h):(k&=$,k!==0?b=Sa(k):c||(c=$&~e,c!==0&&(b=Sa(c))))):($=h&~T,$!==0?b=Sa($):k!==0?b=Sa(k):c||(c=h&~e,c!==0&&(b=Sa(c)))),b===0?0:a!==0&&a!==b&&(a&T)===0&&(T=b&-b,c=a&-a,T>=c||T===32&&(c&4194048)!==0)?a:b}function Yt(e,a){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&a)===0}function re(e,a){switch(e){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ce(){var e=gi;return gi<<=1,(gi&62914560)===0&&(gi=4194304),e}function Ht(e){for(var a=[],c=0;31>c;c++)a.push(e);return a}function ze(e,a){e.pendingLanes|=a,a!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ne(e,a,c,h,b,T){var k=e.pendingLanes;e.pendingLanes=c,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=c,e.entangledLanes&=c,e.errorRecoveryDisabledLanes&=c,e.shellSuspendCounter=0;var $=e.entanglements,lt=e.expirationTimes,St=e.hiddenUpdates;for(c=k&~c;0<c;){var Ot=31-Je(c),Mt=1<<Ot;$[Ot]=0,lt[Ot]=-1;var Et=St[Ot];if(Et!==null)for(St[Ot]=null,Ot=0;Ot<Et.length;Ot++){var Tt=Et[Ot];Tt!==null&&(Tt.lane&=-536870913)}c&=~Mt}h!==0&&Me(e,h,0),T!==0&&b===0&&e.tag!==0&&(e.suspendedLanes|=T&~(k&~a))}function Me(e,a,c){e.pendingLanes|=a,e.suspendedLanes&=~a;var h=31-Je(a);e.entangledLanes|=a,e.entanglements[h]=e.entanglements[h]|1073741824|c&261930}function _e(e,a){var c=e.entangledLanes|=a;for(e=e.entanglements;c;){var h=31-Je(c),b=1<<h;b&a|e[h]&a&&(e[h]|=a),c&=~b}}function ti(e,a){var c=a&-a;return c=(c&42)!==0?1:oa(c),(c&(e.suspendedLanes|a))!==0?0:c}function oa(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function vs(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function cr(){var e=I.p;return e!==0?e:(e=window.event,e===void 0?32:Zv(e.type))}function fr(e,a){var c=I.p;try{return I.p=e,a()}finally{I.p=c}}var ua=Math.random().toString(36).slice(2),kn="__reactFiber$"+ua,Kn="__reactProps$"+ua,za="__reactContainer$"+ua,Eu="__reactEvents$"+ua,vd="__reactListeners$"+ua,yd="__reactHandles$"+ua,Cu="__reactResources$"+ua,ys="__reactMarker$"+ua;function Tn(e){delete e[kn],delete e[Kn],delete e[Eu],delete e[vd],delete e[yd]}function Pr(e){var a=e[kn];if(a)return a;for(var c=e.parentNode;c;){if(a=c[za]||c[kn]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(e=Bv(e);e!==null;){if(c=e[kn])return c;e=Bv(e)}return a}e=c,c=e.parentNode}return null}function Ir(e){if(e=e[kn]||e[za]){var a=e.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return e}return null}function vl(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e.stateNode;throw Error(i(33))}function Ss(e){var a=e[Cu];return a||(a=e[Cu]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Qn(e){e[ys]=!0}var Tu=new Set,Au={};function hr(e,a){qn(e,a),qn(e+"Capture",a)}function qn(e,a){for(Au[e]=a,e=0;e<a.length;e++)Tu.add(a[e])}var zn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ou={},yl={};function Ru(e){return Kt.call(yl,e)?!0:Kt.call(Ou,e)?!1:zn.test(e)?yl[e]=!0:(Ou[e]=!0,!1)}function Sl(e,a,c){if(Ru(a))if(c===null)e.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":e.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){e.removeAttribute(a);return}}e.setAttribute(a,""+c)}}function ca(e,a,c){if(c===null)e.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttribute(a,""+c)}}function fa(e,a,c,h){if(h===null)e.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(c);return}e.setAttributeNS(a,c,""+h)}}function ji(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wu(e){var a=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Sd(e,a,c){var h=Object.getOwnPropertyDescriptor(e.constructor.prototype,a);if(!e.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var b=h.get,T=h.set;return Object.defineProperty(e,a,{configurable:!0,get:function(){return b.call(this)},set:function(k){c=""+k,T.call(this,k)}}),Object.defineProperty(e,a,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(k){c=""+k},stopTracking:function(){e._valueTracker=null,delete e[a]}}}}function xu(e){if(!e._valueTracker){var a=wu(e)?"checked":"value";e._valueTracker=Sd(e,a,""+e[a])}}function yf(e){if(!e)return!1;var a=e._valueTracker;if(!a)return!0;var c=a.getValue(),h="";return e&&(h=wu(e)?e.checked?"true":"false":e.value),e=h,e!==c?(a.setValue(e),!0):!1}function vo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var bd=/[\n"\\]/g;function Qi(e){return e.replace(bd,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function yo(e,a,c,h,b,T,k,$){e.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?e.type=k:e.removeAttribute("type"),a!=null?k==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+ji(a)):e.value!==""+ji(a)&&(e.value=""+ji(a)):k!=="submit"&&k!=="reset"||e.removeAttribute("value"),a!=null?bf(e,k,ji(a)):c!=null?bf(e,k,ji(c)):h!=null&&e.removeAttribute("value"),b==null&&T!=null&&(e.defaultChecked=!!T),b!=null&&(e.checked=b&&typeof b!="function"&&typeof b!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?e.name=""+ji($):e.removeAttribute("name")}function Sf(e,a,c,h,b,T,k,$){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(e.type=T),a!=null||c!=null){if(!(T!=="submit"&&T!=="reset"||a!=null)){xu(e);return}c=c!=null?""+ji(c):"",a=a!=null?""+ji(a):c,$||a===e.value||(e.value=a),e.defaultValue=a}h=h??b,h=typeof h!="function"&&typeof h!="symbol"&&!!h,e.checked=$?e.checked:!!h,e.defaultChecked=!!h,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(e.name=k),xu(e)}function bf(e,a,c){a==="number"&&vo(e.ownerDocument)===e||e.defaultValue===""+c||(e.defaultValue=""+c)}function bs(e,a,c,h){if(e=e.options,a){a={};for(var b=0;b<c.length;b++)a["$"+c[b]]=!0;for(c=0;c<e.length;c++)b=a.hasOwnProperty("$"+e[c].value),e[c].selected!==b&&(e[c].selected=b),b&&h&&(e[c].defaultSelected=!0)}else{for(c=""+ji(c),a=null,b=0;b<e.length;b++){if(e[b].value===c){e[b].selected=!0,h&&(e[b].defaultSelected=!0);return}a!==null||e[b].disabled||(a=e[b])}a!==null&&(a.selected=!0)}}function _f(e,a,c){if(a!=null&&(a=""+ji(a),a!==e.value&&(e.value=a),c==null)){e.defaultValue!==a&&(e.defaultValue=a);return}e.defaultValue=c!=null?""+ji(c):""}function Ef(e,a,c,h){if(a==null){if(h!=null){if(c!=null)throw Error(i(92));if(V(h)){if(1<h.length)throw Error(i(93));h=h[0]}c=h}c==null&&(c=""),a=c}c=ji(a),e.defaultValue=c,h=e.textContent,h===c&&h!==""&&h!==null&&(e.value=h),xu(e)}function kr(e,a){if(a){var c=e.firstChild;if(c&&c===e.lastChild&&c.nodeType===3){c.nodeValue=a;return}}e.textContent=a}var _d=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cf(e,a,c){var h=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="":h?e.setProperty(a,c):typeof c!="number"||c===0||_d.has(a)?a==="float"?e.cssFloat=c:e[a]=(""+c).trim():e[a]=c+"px"}function Tf(e,a,c){if(a!=null&&typeof a!="object")throw Error(i(62));if(e=e.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?e.setProperty(h,""):h==="float"?e.cssFloat="":e[h]="");for(var b in a)h=a[b],a.hasOwnProperty(b)&&c[b]!==h&&Cf(e,b,h)}else for(var T in a)a.hasOwnProperty(T)&&Cf(e,T,a[T])}function Mu(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ed=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function So(e){return Dg.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ui(){}var bl=null;function Nu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var dr=null,La=null;function Af(e){var a=Ir(e);if(a&&(e=a.stateNode)){var c=e[Kn]||null;t:switch(e=a.stateNode,a.type){case"input":if(yo(e,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=e;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Qi(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var h=c[a];if(h!==e&&h.form===e.form){var b=h[Kn]||null;if(!b)throw Error(i(90));yo(h,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(a=0;a<c.length;a++)h=c[a],h.form===e.form&&yf(h)}break t;case"textarea":_f(e,c.value,c.defaultValue);break t;case"select":a=c.value,a!=null&&bs(e,!!c.multiple,a,!1)}}}var Du=!1;function Of(e,a,c){if(Du)return e(a,c);Du=!0;try{var h=e(a);return h}finally{if(Du=!1,(dr!==null||La!==null)&&(Ql(),dr&&(a=dr,e=La,La=dr=null,Af(a),e)))for(a=0;a<e.length;a++)Af(e[a])}}function _l(e,a){var c=e.stateNode;if(c===null)return null;var h=c[Kn]||null;if(h===null)return null;c=h[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break t;default:e=!1}if(e)return null;if(c&&typeof c!="function")throw Error(i(231,a,typeof c));return c}var Ga=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ju=!1;if(Ga)try{var _s={};Object.defineProperty(_s,"passive",{get:function(){ju=!0}}),window.addEventListener("test",_s,_s),window.removeEventListener("test",_s,_s)}catch{ju=!1}var gr=null,Uu=null,El=null;function Rf(){if(El)return El;var e,a=Uu,c=a.length,h,b="value"in gr?gr.value:gr.textContent,T=b.length;for(e=0;e<c&&a[e]===b[e];e++);var k=c-e;for(h=1;h<=k&&a[c-h]===b[T-h];h++);return El=b.slice(e,1<h?1-h:void 0)}function bo(e){var a=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&a===13&&(e=13)):e=a,e===10&&(e=13),32<=e||e===13?e:0}function _o(){return!0}function Bu(){return!1}function bi(e){function a(c,h,b,T,k){this._reactName=c,this._targetInst=b,this.type=h,this.nativeEvent=T,this.target=k,this.currentTarget=null;for(var $ in e)e.hasOwnProperty($)&&(c=e[$],this[$]=c?c(T):T[$]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?_o:Bu,this.isPropagationStopped=Bu,this}return C(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=_o)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=_o)},persist:function(){},isPersistent:_o}),a}var qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zu=bi(qr),Eo=C({},qr,{view:0,detail:0}),Cd=bi(Eo),Es,Co,Vr,To=C({},Eo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vr&&(Vr&&e.type==="mousemove"?(Es=e.screenX-Vr.screenX,Co=e.screenY-Vr.screenY):Co=Es=0,Vr=e),Es)},movementY:function(e){return"movementY"in e?e.movementY:Co}}),wf=bi(To),Lu=C({},To,{dataTransfer:0}),Ao=bi(Lu),Gu=C({},Eo,{relatedTarget:0}),Hu=bi(Gu),Td=C({},qr,{animationName:0,elapsedTime:0,pseudoElement:0}),Yr=bi(Td),Ad=C({},qr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Kr=bi(Ad),pr=C({},qr,{data:0}),Oo=bi(pr),xf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Od={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cs(e){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(e):(e=Rd[e])?!!a[e]:!1}function Cl(){return Cs}var wd=C({},Eo,{key:function(e){if(e.key){var a=xf[e.key]||e.key;if(a!=="Unidentified")return a}return e.type==="keypress"?(e=bo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Od[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cl,charCode:function(e){return e.type==="keypress"?bo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Mf=bi(wd),xd=C({},To,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nf=bi(xd),jg=C({},Eo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cl}),ei=bi(jg),Md=C({},qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nd=bi(Md),Dd=C({},To,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),jd=bi(Dd),Ud=C({},qr,{newState:0,oldState:0}),Pu=bi(Ud),Df=[9,13,27,32],Iu=Ga&&"CompositionEvent"in window,Tl=null;Ga&&"documentMode"in document&&(Tl=document.documentMode);var Bd=Ga&&"TextEvent"in window&&!Tl,ku=Ga&&(!Iu||Tl&&8<Tl&&11>=Tl),qu=" ",jf=!1;function Vu(e,a){switch(e){case"keyup":return Df.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ro(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Qr=!1;function zd(e,a){switch(e){case"compositionend":return Ro(a);case"keypress":return a.which!==32?null:(jf=!0,qu);case"textInput":return e=a.data,e===qu&&jf?null:e;default:return null}}function Uf(e,a){if(Qr)return e==="compositionend"||!Iu&&Vu(e,a)?(e=Rf(),El=Uu=gr=null,Qr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return ku&&a.locale!=="ko"?null:a.data;default:return null}}var Ld={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ha(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a==="input"?!!Ld[e.type]:a==="textarea"}function Yu(e,a,c,h){dr?La?La.push(h):La=[h]:dr=h,a=w0(a,"onChange"),0<a.length&&(c=new zu("onChange","change",null,c,h),e.push({event:c,listeners:a}))}var wo=null,Al=null;function Xi(e){_v(e,0)}function xo(e){var a=vl(e);if(yf(a))return e}function Ku(e,a){if(e==="change")return a}var Bf=!1;if(Ga){var Qu;if(Ga){var Mo="oninput"in document;if(!Mo){var Xu=document.createElement("div");Xu.setAttribute("oninput","return;"),Mo=typeof Xu.oninput=="function"}Qu=Mo}else Qu=!1;Bf=Qu&&(!document.documentMode||9<document.documentMode)}function zf(){wo&&(wo.detachEvent("onpropertychange",No),Al=wo=null)}function No(e){if(e.propertyName==="value"&&xo(Al)){var a=[];Yu(a,Al,e,Nu(e)),Of(Xi,a)}}function Do(e,a,c){e==="focusin"?(zf(),wo=a,Al=c,wo.attachEvent("onpropertychange",No)):e==="focusout"&&zf()}function An(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xo(Al)}function Ug(e,a){if(e==="click")return xo(a)}function Bg(e,a){if(e==="input"||e==="change")return xo(a)}function Gd(e,a){return e===a&&(e!==0||1/e===1/a)||e!==e&&a!==a}var ni=typeof Object.is=="function"?Object.is:Gd;function ha(e,a){if(ni(e,a))return!0;if(typeof e!="object"||e===null||typeof a!="object"||a===null)return!1;var c=Object.keys(e),h=Object.keys(a);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var b=c[h];if(!Kt.call(a,b)||!ni(e[b],a[b]))return!1}return!0}function Lf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Gf(e,a){var c=Lf(e);e=0;for(var h;c;){if(c.nodeType===3){if(h=e+c.textContent.length,e<=a&&h>=a)return{node:c,offset:a-e};e=h}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=Lf(c)}}function Ol(e,a){return e&&a?e===a?!0:e&&e.nodeType===3?!1:a&&a.nodeType===3?Ol(e,a.parentNode):"contains"in e?e.contains(a):e.compareDocumentPosition?!!(e.compareDocumentPosition(a)&16):!1:!1}function ba(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var a=vo(e.document);a instanceof e.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)e=a.contentWindow;else break;a=vo(e.document)}return a}function Fu(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a&&(a==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||a==="textarea"||e.contentEditable==="true")}var Hf=Ga&&"documentMode"in document&&11>=document.documentMode,Ts=null,jo=null,As=null,Rl=!1;function Pf(e,a,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Rl||Ts==null||Ts!==vo(h)||(h=Ts,"selectionStart"in h&&Fu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),As&&ha(As,h)||(As=h,h=w0(jo,"onSelect"),0<h.length&&(a=new zu("onSelect","select",null,a,c),e.push({event:a,listeners:h}),a.target=Ts)))}function Xr(e,a){var c={};return c[e.toLowerCase()]=a.toLowerCase(),c["Webkit"+e]="webkit"+a,c["Moz"+e]="moz"+a,c}var wl={animationend:Xr("Animation","AnimationEnd"),animationiteration:Xr("Animation","AnimationIteration"),animationstart:Xr("Animation","AnimationStart"),transitionrun:Xr("Transition","TransitionRun"),transitionstart:Xr("Transition","TransitionStart"),transitioncancel:Xr("Transition","TransitionCancel"),transitionend:Xr("Transition","TransitionEnd")},Ju={},If={};Ga&&(If=document.createElement("div").style,"AnimationEvent"in window||(delete wl.animationend.animation,delete wl.animationiteration.animation,delete wl.animationstart.animation),"TransitionEvent"in window||delete wl.transitionend.transition);function ii(e){if(Ju[e])return Ju[e];if(!wl[e])return e;var a=wl[e],c;for(c in a)if(a.hasOwnProperty(c)&&c in If)return Ju[e]=a[c];return e}var Zu=ii("animationend"),kf=ii("animationiteration"),Hd=ii("animationstart"),qf=ii("transitionrun"),_i=ii("transitionstart"),Pd=ii("transitioncancel"),Ei=ii("transitionend"),Vf=new Map,Pa="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pa.push("scrollEnd");function ai(e,a){Vf.set(e,a),hr(a,[e])}var _a=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Bi=[],Fr=0,da=0;function Uo(){for(var e=Fr,a=da=Fr=0;a<e;){var c=Bi[a];Bi[a++]=null;var h=Bi[a];Bi[a++]=null;var b=Bi[a];Bi[a++]=null;var T=Bi[a];if(Bi[a++]=null,h!==null&&b!==null){var k=h.pending;k===null?b.next=b:(b.next=k.next,k.next=b),h.pending=b}T!==0&&Yf(c,b,T)}}function mr(e,a,c,h){Bi[Fr++]=e,Bi[Fr++]=a,Bi[Fr++]=c,Bi[Fr++]=h,da|=h,e.lanes|=h,e=e.alternate,e!==null&&(e.lanes|=h)}function Os(e,a,c,h){return mr(e,a,c,h),Bo(e)}function Fi(e,a){return mr(e,null,null,a),Bo(e)}function Yf(e,a,c){e.lanes|=c;var h=e.alternate;h!==null&&(h.lanes|=c);for(var b=!1,T=e.return;T!==null;)T.childLanes|=c,h=T.alternate,h!==null&&(h.childLanes|=c),T.tag===22&&(e=T.stateNode,e===null||e._visibility&1||(b=!0)),e=T,T=T.return;return e.tag===3?(T=e.stateNode,b&&a!==null&&(b=31-Je(c),e=T.hiddenUpdates,h=e[b],h===null?e[b]=[a]:h.push(a),a.lane=c|536870912),T):null}function Bo(e){if(50<rl)throw rl=0,sl=null,Error(i(185));for(var a=e.return;a!==null;)e=a,a=e.return;return e.tag===3?e.stateNode:null}var Ia={};function Id(e,a,c,h){this.tag=e,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pi(e,a,c,h){return new Id(e,a,c,h)}function Wu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ea(e,a){var c=e.alternate;return c===null?(c=pi(e.tag,a,e.key,e.mode),c.elementType=e.elementType,c.type=e.type,c.stateNode=e.stateNode,c.alternate=e,e.alternate=c):(c.pendingProps=a,c.type=e.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=e.flags&65011712,c.childLanes=e.childLanes,c.lanes=e.lanes,c.child=e.child,c.memoizedProps=e.memoizedProps,c.memoizedState=e.memoizedState,c.updateQueue=e.updateQueue,a=e.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=e.sibling,c.index=e.index,c.ref=e.ref,c.refCleanup=e.refCleanup,c}function $u(e,a){e.flags&=65011714;var c=e.alternate;return c===null?(e.childLanes=0,e.lanes=a,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=c.childLanes,e.lanes=c.lanes,e.child=c.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=c.memoizedProps,e.memoizedState=c.memoizedState,e.updateQueue=c.updateQueue,e.type=c.type,a=c.dependencies,e.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),e}function xl(e,a,c,h,b,T){var k=0;if(h=e,typeof e=="function")Wu(e)&&(k=1);else if(typeof e=="string")k=P4(e,c,q.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case B:return e=pi(31,c,a,b),e.elementType=B,e.lanes=T,e;case D:return Jr(c.children,b,T,a);case z:k=8,b|=24;break;case L:return e=pi(12,c,a,b|2),e.elementType=L,e.lanes=T,e;case w:return e=pi(13,c,a,b),e.elementType=w,e.lanes=T,e;case O:return e=pi(19,c,a,b),e.elementType=O,e.lanes=T,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:k=10;break t;case N:k=9;break t;case G:k=11;break t;case A:k=14;break t;case y:k=16,h=null;break t}k=29,c=Error(i(130,e===null?"null":typeof e,"")),h=null}return a=pi(k,c,a,b),a.elementType=e,a.type=h,a.lanes=T,a}function Jr(e,a,c,h){return e=pi(7,e,h,a),e.lanes=c,e}function zo(e,a,c){return e=pi(6,e,null,a),e.lanes=c,e}function zi(e){var a=pi(18,null,null,0);return a.stateNode=e,a}function tc(e,a,c){return a=pi(4,e.children!==null?e.children:[],e.key,a),a.lanes=c,a.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},a}var Li=new WeakMap;function Ji(e,a){if(typeof e=="object"&&e!==null){var c=Li.get(e);return c!==void 0?c:(a={value:e,source:a,stack:Rt(a)},Li.set(e,a),a)}return{value:e,source:a,stack:Rt(a)}}var Rs=[],Ml=0,Ca=null,Nl=0,Gi=[],ri=0,vr=null,Ta=1,Aa="";function ka(e,a){Rs[Ml++]=Nl,Rs[Ml++]=Ca,Ca=e,Nl=a}function ec(e,a,c){Gi[ri++]=Ta,Gi[ri++]=Aa,Gi[ri++]=vr,vr=e;var h=Ta;e=Aa;var b=32-Je(h)-1;h&=~(1<<b),c+=1;var T=32-Je(a)+b;if(30<T){var k=b-b%5;T=(h&(1<<k)-1).toString(32),h>>=k,b-=k,Ta=1<<32-Je(a)+b|c<<b|h,Aa=T+e}else Ta=1<<T|c<<b|h,Aa=e}function Lo(e){e.return!==null&&(ka(e,1),ec(e,1,0))}function Kf(e){for(;e===Ca;)Ca=Rs[--Ml],Rs[Ml]=null,Nl=Rs[--Ml],Rs[Ml]=null;for(;e===vr;)vr=Gi[--ri],Gi[ri]=null,Aa=Gi[--ri],Gi[ri]=null,Ta=Gi[--ri],Gi[ri]=null}function kd(e,a){Gi[ri++]=Ta,Gi[ri++]=Aa,Gi[ri++]=vr,Ta=a.id,Aa=a.overflow,vr=e}var si=null,sn=null,Ne=!1,Zi=null,Ci=!1,nc=Error(i(519));function yr(e){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Dl(Ji(a,e)),nc}function Qf(e){var a=e.stateNode,c=e.type,h=e.memoizedProps;switch(a[kn]=e,a[Kn]=h,c){case"dialog":Ue("cancel",a),Ue("close",a);break;case"iframe":case"object":case"embed":Ue("load",a);break;case"video":case"audio":for(c=0;c<Dh.length;c++)Ue(Dh[c],a);break;case"source":Ue("error",a);break;case"img":case"image":case"link":Ue("error",a),Ue("load",a);break;case"details":Ue("toggle",a);break;case"input":Ue("invalid",a),Sf(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Ue("invalid",a);break;case"textarea":Ue("invalid",a),Ef(a,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||h.suppressHydrationWarning===!0||Av(a.textContent,c)?(h.popover!=null&&(Ue("beforetoggle",a),Ue("toggle",a)),h.onScroll!=null&&Ue("scroll",a),h.onScrollEnd!=null&&Ue("scrollend",a),h.onClick!=null&&(a.onclick=Ui),a=!0):a=!1,a||yr(e,!0)}function Xf(e){for(si=e.return;si;)switch(si.tag){case 5:case 31:case 13:Ci=!1;return;case 27:case 3:Ci=!0;return;default:si=si.return}}function ws(e){if(e!==si)return!1;if(!Ne)return Xf(e),Ne=!0,!1;var a=e.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=e.type,c=!(c!=="form"&&c!=="button")||$g(e.type,e.memoizedProps)),c=!c),c&&sn&&yr(e),Xf(e),a===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));sn=Uv(e)}else if(a===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));sn=Uv(e)}else a===27?(a=sn,Jl(e.type)?(e=ap,ap=null,sn=e):sn=a):sn=si?sr(e.stateNode.nextSibling):null;return!0}function Zr(){sn=si=null,Ne=!1}function xs(){var e=Zi;return e!==null&&(un===null?un=e:un.push.apply(un,e),Zi=null),e}function Dl(e){Zi===null?Zi=[e]:Zi.push(e)}var ic=J(null),je=null,Oa=null;function Wr(e,a,c){it(ic,a._currentValue),a._currentValue=c}function qa(e){e._currentValue=ic.current,rt(ic)}function Ff(e,a,c){for(;e!==null;){var h=e.alternate;if((e.childLanes&a)!==a?(e.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),e===c)break;e=e.return}}function Jf(e,a,c,h){var b=e.child;for(b!==null&&(b.return=e);b!==null;){var T=b.dependencies;if(T!==null){var k=b.child;T=T.firstContext;t:for(;T!==null;){var $=T;T=b;for(var lt=0;lt<a.length;lt++)if($.context===a[lt]){T.lanes|=c,$=T.alternate,$!==null&&($.lanes|=c),Ff(T.return,c,e),h||(k=null);break t}T=$.next}}else if(b.tag===18){if(k=b.return,k===null)throw Error(i(341));k.lanes|=c,T=k.alternate,T!==null&&(T.lanes|=c),Ff(k,c,e),k=null}else k=b.child;if(k!==null)k.return=b;else for(k=b;k!==null;){if(k===e){k=null;break}if(b=k.sibling,b!==null){b.return=k.return,k=b;break}k=k.return}b=k}}function jl(e,a,c,h){e=null;for(var b=a,T=!1;b!==null;){if(!T){if((b.flags&524288)!==0)T=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var k=b.alternate;if(k===null)throw Error(i(387));if(k=k.memoizedProps,k!==null){var $=b.type;ni(b.pendingProps.value,k.value)||(e!==null?e.push($):e=[$])}}else if(b===nt.current){if(k=b.alternate,k===null)throw Error(i(387));k.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(e!==null?e.push(Lh):e=[Lh])}b=b.return}e!==null&&Jf(a,e,c,h),a.flags|=262144}function ac(e){for(e=e.firstContext;e!==null;){if(!ni(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Sr(e){je=e,Oa=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function dn(e){return Ho(je,e)}function Go(e,a){return je===null&&Sr(e),Ho(e,a)}function Ho(e,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},Oa===null){if(e===null)throw Error(i(308));Oa=a,e.dependencies={lanes:0,firstContext:a},e.flags|=524288}else Oa=Oa.next=a;return c}var Ms=typeof AbortController<"u"?AbortController:function(){var e=[],a=this.signal={aborted:!1,addEventListener:function(c,h){e.push(h)}};this.abort=function(){a.aborted=!0,e.forEach(function(c){return c()})}},Zf=o.unstable_scheduleCallback,Wf=o.unstable_NormalPriority,Ln={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rc(){return{controller:new Ms,data:new Map,refCount:0}}function Ul(e){e.refCount--,e.refCount===0&&Zf(Wf,function(){e.controller.abort()})}var Bl=null,sc=0,Ns=0,$r=null;function we(e,a){if(Bl===null){var c=Bl=[];sc=0,Ns=Vg(),$r={status:"pending",value:void 0,then:function(h){c.push(h)}}}return sc++,a.then(qd,qd),a}function qd(){if(--sc===0&&Bl!==null){$r!==null&&($r.status="fulfilled");var e=Bl;Bl=null,Ns=0,$r=null;for(var a=0;a<e.length;a++)(0,e[a])()}}function Wi(e,a){var c=[],h={status:"pending",value:null,reason:null,then:function(b){c.push(b)}};return e.then(function(){h.status="fulfilled",h.value=a;for(var b=0;b<c.length;b++)(0,c[b])(a)},function(b){for(h.status="rejected",h.reason=b,b=0;b<c.length;b++)(0,c[b])(void 0)}),h}var lc=j.S;j.S=function(e,a){Uc=xe(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&we(e,a),lc!==null&&lc(e,a)};var Ds=J(null);function zl(){var e=Ds.current;return e!==null?e:Te.pooledCache}function br(e,a){a===null?it(Ds,Ds.current):it(Ds,a.pool)}function js(){var e=zl();return e===null?null:{parent:Ln._currentValue,pool:e}}var Us=Error(i(460)),Po=Error(i(474)),oc=Error(i(542)),Io={then:function(){}};function _r(e){return e=e.status,e==="fulfilled"||e==="rejected"}function uc(e,a,c){switch(c=e[c],c===void 0?e.push(a):c!==a&&(a.then(Ui,Ui),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,Tr(e),e;default:if(typeof a.status=="string")a.then(Ui,Ui);else{if(e=Te,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=a,e.status="pending",e.then(function(h){if(a.status==="pending"){var b=a;b.status="fulfilled",b.value=h}},function(h){if(a.status==="pending"){var b=a;b.status="rejected",b.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,Tr(e),e}throw Cr=a,Us}}function Er(e){try{var a=e._init;return a(e._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Cr=c,Us):c}}var Cr=null;function cc(){if(Cr===null)throw Error(i(459));var e=Cr;return Cr=null,e}function Tr(e){if(e===Us||e===oc)throw Error(i(483))}var ts=null,ko=0;function qo(e){var a=ko;return ko+=1,ts===null&&(ts=[]),uc(ts,e,a)}function Vo(e,a){a=a.props.ref,e.ref=a!==void 0?a:null}function Bs(e,a){throw a.$$typeof===E?Error(i(525)):(e=Object.prototype.toString.call(a),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":e)))}function se(e){function a(mt,ft){if(e){var yt=mt.deletions;yt===null?(mt.deletions=[ft],mt.flags|=16):yt.push(ft)}}function c(mt,ft){if(!e)return null;for(;ft!==null;)a(mt,ft),ft=ft.sibling;return null}function h(mt){for(var ft=new Map;mt!==null;)mt.key!==null?ft.set(mt.key,mt):ft.set(mt.index,mt),mt=mt.sibling;return ft}function b(mt,ft){return mt=Ea(mt,ft),mt.index=0,mt.sibling=null,mt}function T(mt,ft,yt){return mt.index=yt,e?(yt=mt.alternate,yt!==null?(yt=yt.index,yt<ft?(mt.flags|=67108866,ft):yt):(mt.flags|=67108866,ft)):(mt.flags|=1048576,ft)}function k(mt){return e&&mt.alternate===null&&(mt.flags|=67108866),mt}function $(mt,ft,yt,wt){return ft===null||ft.tag!==6?(ft=zo(yt,mt.mode,wt),ft.return=mt,ft):(ft=b(ft,yt),ft.return=mt,ft)}function lt(mt,ft,yt,wt){var ie=yt.type;return ie===D?Ot(mt,ft,yt.props.children,wt,yt.key):ft!==null&&(ft.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===y&&Er(ie)===ft.type)?(ft=b(ft,yt.props),Vo(ft,yt),ft.return=mt,ft):(ft=xl(yt.type,yt.key,yt.props,null,mt.mode,wt),Vo(ft,yt),ft.return=mt,ft)}function St(mt,ft,yt,wt){return ft===null||ft.tag!==4||ft.stateNode.containerInfo!==yt.containerInfo||ft.stateNode.implementation!==yt.implementation?(ft=tc(yt,mt.mode,wt),ft.return=mt,ft):(ft=b(ft,yt.children||[]),ft.return=mt,ft)}function Ot(mt,ft,yt,wt,ie){return ft===null||ft.tag!==7?(ft=Jr(yt,mt.mode,wt,ie),ft.return=mt,ft):(ft=b(ft,yt),ft.return=mt,ft)}function Mt(mt,ft,yt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return ft=zo(""+ft,mt.mode,yt),ft.return=mt,ft;if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case R:return yt=xl(ft.type,ft.key,ft.props,null,mt.mode,yt),Vo(yt,ft),yt.return=mt,yt;case v:return ft=tc(ft,mt.mode,yt),ft.return=mt,ft;case y:return ft=Er(ft),Mt(mt,ft,yt)}if(V(ft)||Y(ft))return ft=Jr(ft,mt.mode,yt,null),ft.return=mt,ft;if(typeof ft.then=="function")return Mt(mt,qo(ft),yt);if(ft.$$typeof===M)return Mt(mt,Go(mt,ft),yt);Bs(mt,ft)}return null}function Et(mt,ft,yt,wt){var ie=ft!==null?ft.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return ie!==null?null:$(mt,ft,""+yt,wt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case R:return yt.key===ie?lt(mt,ft,yt,wt):null;case v:return yt.key===ie?St(mt,ft,yt,wt):null;case y:return yt=Er(yt),Et(mt,ft,yt,wt)}if(V(yt)||Y(yt))return ie!==null?null:Ot(mt,ft,yt,wt,null);if(typeof yt.then=="function")return Et(mt,ft,qo(yt),wt);if(yt.$$typeof===M)return Et(mt,ft,Go(mt,yt),wt);Bs(mt,yt)}return null}function Tt(mt,ft,yt,wt,ie){if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return mt=mt.get(yt)||null,$(ft,mt,""+wt,ie);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case R:return mt=mt.get(wt.key===null?yt:wt.key)||null,lt(ft,mt,wt,ie);case v:return mt=mt.get(wt.key===null?yt:wt.key)||null,St(ft,mt,wt,ie);case y:return wt=Er(wt),Tt(mt,ft,yt,wt,ie)}if(V(wt)||Y(wt))return mt=mt.get(yt)||null,Ot(ft,mt,wt,ie,null);if(typeof wt.then=="function")return Tt(mt,ft,yt,qo(wt),ie);if(wt.$$typeof===M)return Tt(mt,ft,yt,Go(ft,wt),ie);Bs(ft,wt)}return null}function Ft(mt,ft,yt,wt){for(var ie=null,Qe=null,Zt=ft,Oe=ft=0,Le=null;Zt!==null&&Oe<yt.length;Oe++){Zt.index>Oe?(Le=Zt,Zt=null):Le=Zt.sibling;var Xe=Et(mt,Zt,yt[Oe],wt);if(Xe===null){Zt===null&&(Zt=Le);break}e&&Zt&&Xe.alternate===null&&a(mt,Zt),ft=T(Xe,ft,Oe),Qe===null?ie=Xe:Qe.sibling=Xe,Qe=Xe,Zt=Le}if(Oe===yt.length)return c(mt,Zt),Ne&&ka(mt,Oe),ie;if(Zt===null){for(;Oe<yt.length;Oe++)Zt=Mt(mt,yt[Oe],wt),Zt!==null&&(ft=T(Zt,ft,Oe),Qe===null?ie=Zt:Qe.sibling=Zt,Qe=Zt);return Ne&&ka(mt,Oe),ie}for(Zt=h(Zt);Oe<yt.length;Oe++)Le=Tt(Zt,mt,Oe,yt[Oe],wt),Le!==null&&(e&&Le.alternate!==null&&Zt.delete(Le.key===null?Oe:Le.key),ft=T(Le,ft,Oe),Qe===null?ie=Le:Qe.sibling=Le,Qe=Le);return e&&Zt.forEach(function(eo){return a(mt,eo)}),Ne&&ka(mt,Oe),ie}function he(mt,ft,yt,wt){if(yt==null)throw Error(i(151));for(var ie=null,Qe=null,Zt=ft,Oe=ft=0,Le=null,Xe=yt.next();Zt!==null&&!Xe.done;Oe++,Xe=yt.next()){Zt.index>Oe?(Le=Zt,Zt=null):Le=Zt.sibling;var eo=Et(mt,Zt,Xe.value,wt);if(eo===null){Zt===null&&(Zt=Le);break}e&&Zt&&eo.alternate===null&&a(mt,Zt),ft=T(eo,ft,Oe),Qe===null?ie=eo:Qe.sibling=eo,Qe=eo,Zt=Le}if(Xe.done)return c(mt,Zt),Ne&&ka(mt,Oe),ie;if(Zt===null){for(;!Xe.done;Oe++,Xe=yt.next())Xe=Mt(mt,Xe.value,wt),Xe!==null&&(ft=T(Xe,ft,Oe),Qe===null?ie=Xe:Qe.sibling=Xe,Qe=Xe);return Ne&&ka(mt,Oe),ie}for(Zt=h(Zt);!Xe.done;Oe++,Xe=yt.next())Xe=Tt(Zt,mt,Oe,Xe.value,wt),Xe!==null&&(e&&Xe.alternate!==null&&Zt.delete(Xe.key===null?Oe:Xe.key),ft=T(Xe,ft,Oe),Qe===null?ie=Xe:Qe.sibling=Xe,Qe=Xe);return e&&Zt.forEach(function(Z4){return a(mt,Z4)}),Ne&&ka(mt,Oe),ie}function fn(mt,ft,yt,wt){if(typeof yt=="object"&&yt!==null&&yt.type===D&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case R:t:{for(var ie=yt.key;ft!==null;){if(ft.key===ie){if(ie=yt.type,ie===D){if(ft.tag===7){c(mt,ft.sibling),wt=b(ft,yt.props.children),wt.return=mt,mt=wt;break t}}else if(ft.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===y&&Er(ie)===ft.type){c(mt,ft.sibling),wt=b(ft,yt.props),Vo(wt,yt),wt.return=mt,mt=wt;break t}c(mt,ft);break}else a(mt,ft);ft=ft.sibling}yt.type===D?(wt=Jr(yt.props.children,mt.mode,wt,yt.key),wt.return=mt,mt=wt):(wt=xl(yt.type,yt.key,yt.props,null,mt.mode,wt),Vo(wt,yt),wt.return=mt,mt=wt)}return k(mt);case v:t:{for(ie=yt.key;ft!==null;){if(ft.key===ie)if(ft.tag===4&&ft.stateNode.containerInfo===yt.containerInfo&&ft.stateNode.implementation===yt.implementation){c(mt,ft.sibling),wt=b(ft,yt.children||[]),wt.return=mt,mt=wt;break t}else{c(mt,ft);break}else a(mt,ft);ft=ft.sibling}wt=tc(yt,mt.mode,wt),wt.return=mt,mt=wt}return k(mt);case y:return yt=Er(yt),fn(mt,ft,yt,wt)}if(V(yt))return Ft(mt,ft,yt,wt);if(Y(yt)){if(ie=Y(yt),typeof ie!="function")throw Error(i(150));return yt=ie.call(yt),he(mt,ft,yt,wt)}if(typeof yt.then=="function")return fn(mt,ft,qo(yt),wt);if(yt.$$typeof===M)return fn(mt,ft,Go(mt,yt),wt);Bs(mt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint"?(yt=""+yt,ft!==null&&ft.tag===6?(c(mt,ft.sibling),wt=b(ft,yt),wt.return=mt,mt=wt):(c(mt,ft),wt=zo(yt,mt.mode,wt),wt.return=mt,mt=wt),k(mt)):c(mt,ft)}return function(mt,ft,yt,wt){try{ko=0;var ie=fn(mt,ft,yt,wt);return ts=null,ie}catch(Zt){if(Zt===Us||Zt===oc)throw Zt;var Qe=pi(29,Zt,null,mt.mode);return Qe.lanes=wt,Qe.return=mt,Qe}finally{}}}var zs=se(!0),Vd=se(!1),Ar=!1;function Ls(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $f(e,a){e=e.updateQueue,a.updateQueue===e&&(a.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function es(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ns(e,a,c){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,(oe&2)!==0){var b=h.pending;return b===null?a.next=a:(a.next=b.next,b.next=a),h.pending=a,a=Bo(e),Yf(e,null,c),a}return mr(e,h,a,c),Bo(e)}function Yo(e,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var h=a.lanes;h&=e.pendingLanes,c|=h,a.lanes=c,_e(e,c)}}function th(e,a){var c=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var b=null,T=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};T===null?b=T=k:T=T.next=k,c=c.next}while(c!==null);T===null?b=T=a:T=T.next=a}else b=T=a;c={baseState:h.baseState,firstBaseUpdate:b,lastBaseUpdate:T,shared:h.shared,callbacks:h.callbacks},e.updateQueue=c;return}e=c.lastBaseUpdate,e===null?c.firstBaseUpdate=a:e.next=a,c.lastBaseUpdate=a}var Ko=!1;function Ll(){if(Ko){var e=$r;if(e!==null)throw e}}function is(e,a,c,h){Ko=!1;var b=e.updateQueue;Ar=!1;var T=b.firstBaseUpdate,k=b.lastBaseUpdate,$=b.shared.pending;if($!==null){b.shared.pending=null;var lt=$,St=lt.next;lt.next=null,k===null?T=St:k.next=St,k=lt;var Ot=e.alternate;Ot!==null&&(Ot=Ot.updateQueue,$=Ot.lastBaseUpdate,$!==k&&($===null?Ot.firstBaseUpdate=St:$.next=St,Ot.lastBaseUpdate=lt))}if(T!==null){var Mt=b.baseState;k=0,Ot=St=lt=null,$=T;do{var Et=$.lane&-536870913,Tt=Et!==$.lane;if(Tt?(Ee&Et)===Et:(h&Et)===Et){Et!==0&&Et===Ns&&(Ko=!0),Ot!==null&&(Ot=Ot.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});t:{var Ft=e,he=$;Et=a;var fn=c;switch(he.tag){case 1:if(Ft=he.payload,typeof Ft=="function"){Mt=Ft.call(fn,Mt,Et);break t}Mt=Ft;break t;case 3:Ft.flags=Ft.flags&-65537|128;case 0:if(Ft=he.payload,Et=typeof Ft=="function"?Ft.call(fn,Mt,Et):Ft,Et==null)break t;Mt=C({},Mt,Et);break t;case 2:Ar=!0}}Et=$.callback,Et!==null&&(e.flags|=64,Tt&&(e.flags|=8192),Tt=b.callbacks,Tt===null?b.callbacks=[Et]:Tt.push(Et))}else Tt={lane:Et,tag:$.tag,payload:$.payload,callback:$.callback,next:null},Ot===null?(St=Ot=Tt,lt=Mt):Ot=Ot.next=Tt,k|=Et;if($=$.next,$===null){if($=b.shared.pending,$===null)break;Tt=$,$=Tt.next,Tt.next=null,b.lastBaseUpdate=Tt,b.shared.pending=null}}while(!0);Ot===null&&(lt=Mt),b.baseState=lt,b.firstBaseUpdate=St,b.lastBaseUpdate=Ot,T===null&&(b.shared.lanes=0),fs|=k,e.lanes=k,e.memoizedState=Mt}}function eh(e,a){if(typeof e!="function")throw Error(i(191,e));e.call(a)}function Yd(e,a){var c=e.callbacks;if(c!==null)for(e.callbacks=null,e=0;e<c.length;e++)eh(c[e],a)}var Gl=J(null),Va=J(0);function Ya(e,a){e=va,it(Va,e),it(Gl,a),va=e|a.baseLanes}function Xn(){it(Va,va),it(Gl,Gl.current)}function Ka(){va=Va.current,rt(Gl),rt(Va)}var Sn=J(null),ga=null;function as(e){var a=e.alternate;it(xn,xn.current&1),it(Sn,e),ga===null&&(a===null||Gl.current!==null||a.memoizedState!==null)&&(ga=e)}function Gn(e){it(xn,xn.current),it(Sn,e),ga===null&&(ga=e)}function Qa(e){e.tag===22?(it(xn,xn.current),it(Sn,e),ga===null&&(ga=e)):rs()}function rs(){it(xn,xn.current),it(Sn,Sn.current)}function $i(e){rt(Sn),ga===e&&(ga=null),rt(xn)}var xn=J(0);function fc(e){for(var a=e;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||np(c)||ip(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Xa=0,me=null,Ze=null,Hn=null,Or=!1,pa=!1,Gs=!1,hc=0,Qo=0,Fa=null,zg=0;function wn(){throw Error(i(321))}function nh(e,a){if(a===null)return!1;for(var c=0;c<a.length&&c<e.length;c++)if(!ni(e[c],a[c]))return!1;return!0}function Hs(e,a,c,h,b,T){return Xa=T,me=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,j.H=e===null||e.memoizedState===null?Ps:Zo,Gs=!1,T=c(h,b),Gs=!1,pa&&(T=Qd(a,c,h,b)),Kd(e),T}function Kd(e){j.H=Pl;var a=Ze!==null&&Ze.next!==null;if(Xa=0,Hn=Ze=me=null,Or=!1,Qo=0,Fa=null,a)throw Error(i(300));e===null||Pn||(e=e.dependencies,e!==null&&ac(e)&&(Pn=!0))}function Qd(e,a,c,h){me=e;var b=0;do{if(pa&&(Fa=null),Qo=0,pa=!1,25<=b)throw Error(i(301));if(b+=1,Hn=Ze=null,e.updateQueue!=null){var T=e.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}j.H=Is,T=a(c,h)}while(pa);return T}function Lg(){var e=j.H,a=e.useState()[0];return a=typeof a.then=="function"?Xo(a):a,e=e.useState()[0],(Ze!==null?Ze.memoizedState:null)!==e&&(me.flags|=1024),a}function ih(){var e=hc!==0;return hc=0,e}function ah(e,a,c){a.updateQueue=e.updateQueue,a.flags&=-2053,e.lanes&=~c}function rh(e){if(Or){for(e=e.memoizedState;e!==null;){var a=e.queue;a!==null&&(a.pending=null),e=e.next}Or=!1}Xa=0,Hn=Ze=me=null,pa=!1,Qo=hc=0,Fa=null}function Ti(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?me.memoizedState=Hn=e:Hn=Hn.next=e,Hn}function Mn(){if(Ze===null){var e=me.alternate;e=e!==null?e.memoizedState:null}else e=Ze.next;var a=Hn===null?me.memoizedState:Hn.next;if(a!==null)Hn=a,Ze=e;else{if(e===null)throw me.alternate===null?Error(i(467)):Error(i(310));Ze=e,e={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},Hn===null?me.memoizedState=Hn=e:Hn=Hn.next=e}return Hn}function dc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xo(e){var a=Qo;return Qo+=1,Fa===null&&(Fa=[]),e=uc(Fa,e,a),a=me,(Hn===null?a.memoizedState:Hn.next)===null&&(a=a.alternate,j.H=a===null||a.memoizedState===null?Ps:Zo),e}function gc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Xo(e);if(e.$$typeof===M)return dn(e)}throw Error(i(438,String(e)))}function sh(e){var a=null,c=me.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var h=me.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(b){return b.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=dc(),me.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(e),h=0;h<e;h++)c[h]=U;return a.index++,c}function Ja(e,a){return typeof a=="function"?a(e):a}function pc(e){var a=Mn();return lh(a,Ze,e)}function lh(e,a,c){var h=e.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=c;var b=e.baseQueue,T=h.pending;if(T!==null){if(b!==null){var k=b.next;b.next=T.next,T.next=k}a.baseQueue=b=T,h.pending=null}if(T=e.baseState,b===null)e.memoizedState=T;else{a=b.next;var $=k=null,lt=null,St=a,Ot=!1;do{var Mt=St.lane&-536870913;if(Mt!==St.lane?(Ee&Mt)===Mt:(Xa&Mt)===Mt){var Et=St.revertLane;if(Et===0)lt!==null&&(lt=lt.next={lane:0,revertLane:0,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),Mt===Ns&&(Ot=!0);else if((Xa&Et)===Et){St=St.next,Et===Ns&&(Ot=!0);continue}else Mt={lane:0,revertLane:St.revertLane,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},lt===null?($=lt=Mt,k=T):lt=lt.next=Mt,me.lanes|=Et,fs|=Et;Mt=St.action,Gs&&c(T,Mt),T=St.hasEagerState?St.eagerState:c(T,Mt)}else Et={lane:Mt,revertLane:St.revertLane,gesture:St.gesture,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},lt===null?($=lt=Et,k=T):lt=lt.next=Et,me.lanes|=Mt,fs|=Mt;St=St.next}while(St!==null&&St!==a);if(lt===null?k=T:lt.next=$,!ni(T,e.memoizedState)&&(Pn=!0,Ot&&(c=$r,c!==null)))throw c;e.memoizedState=T,e.baseState=k,e.baseQueue=lt,h.lastRenderedState=T}return b===null&&(h.lanes=0),[e.memoizedState,h.dispatch]}function oh(e){var a=Mn(),c=a.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=e;var h=c.dispatch,b=c.pending,T=a.memoizedState;if(b!==null){c.pending=null;var k=b=b.next;do T=e(T,k.action),k=k.next;while(k!==b);ni(T,a.memoizedState)||(Pn=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),c.lastRenderedState=T}return[T,h]}function Xd(e,a,c){var h=me,b=Mn(),T=Ne;if(T){if(c===void 0)throw Error(i(407));c=c()}else c=a();var k=!ni((Ze||b).memoizedState,c);if(k&&(b.memoizedState=c,Pn=!0),b=b.queue,gh(uh.bind(null,h,b,e),[e]),b.getSnapshot!==a||k||Hn!==null&&Hn.memoizedState.tag&1){if(h.flags|=2048,Hl(9,{destroy:void 0},Jd.bind(null,h,b,c,a),null),Te===null)throw Error(i(349));T||(Xa&127)!==0||Fd(h,a,c)}return c}function Fd(e,a,c){e.flags|=16384,e={getSnapshot:a,value:c},a=me.updateQueue,a===null?(a=dc(),me.updateQueue=a,a.stores=[e]):(c=a.stores,c===null?a.stores=[e]:c.push(e))}function Jd(e,a,c,h){a.value=c,a.getSnapshot=h,ch(a)&&Zd(e)}function uh(e,a,c){return c(function(){ch(a)&&Zd(e)})}function ch(e){var a=e.getSnapshot;e=e.value;try{var c=a();return!ni(e,c)}catch{return!0}}function Zd(e){var a=Fi(e,2);a!==null&&Ke(a,e,2)}function mc(e){var a=Ti();if(typeof e=="function"){var c=e;if(e=c(),Gs){Fe(!0);try{c()}finally{Fe(!1)}}}return a.memoizedState=a.baseState=e,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:e},a}function fh(e,a,c,h){return e.baseState=c,lh(e,Ze,typeof h=="function"?h:Ja)}function Wd(e,a,c,h,b){if(Jo(e))throw Error(i(485));if(e=a.action,e!==null){var T={payload:b,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){T.listeners.push(k)}};j.T!==null?c(!0):T.isTransition=!1,h(T),c=a.pending,c===null?(T.next=a.pending=T,vc(a,T)):(T.next=c.next,a.pending=c.next=T)}}function vc(e,a){var c=a.action,h=a.payload,b=e.state;if(a.isTransition){var T=j.T,k={};j.T=k;try{var $=c(b,h),lt=j.S;lt!==null&&lt(k,$),yc(e,a,$)}catch(St){hh(e,a,St)}finally{T!==null&&k.types!==null&&(T.types=k.types),j.T=T}}else try{T=c(b,h),yc(e,a,T)}catch(St){hh(e,a,St)}}function yc(e,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){$d(e,a,h)},function(h){return hh(e,a,h)}):$d(e,a,c)}function $d(e,a,c){a.status="fulfilled",a.value=c,t0(a),e.state=c,a=e.pending,a!==null&&(c=a.next,c===a?e.pending=null:(c=c.next,a.next=c,vc(e,c)))}function hh(e,a,c){var h=e.pending;if(e.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=c,t0(a),a=a.next;while(a!==h)}e.action=null}function t0(e){e=e.listeners;for(var a=0;a<e.length;a++)(0,e[a])()}function e0(e,a){return a}function dh(e,a){if(Ne){var c=Te.formState;if(c!==null){t:{var h=me;if(Ne){if(sn){e:{for(var b=sn,T=Ci;b.nodeType!==8;){if(!T){b=null;break e}if(b=sr(b.nextSibling),b===null){b=null;break e}}T=b.data,b=T==="F!"||T==="F"?b:null}if(b){sn=sr(b.nextSibling),h=b.data==="F!";break t}}yr(h)}h=!1}h&&(a=c[0])}}return c=Ti(),c.memoizedState=c.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e0,lastRenderedState:a},c.queue=h,c=yh.bind(null,me,h),h.dispatch=c,h=mc(!1),T=Nn.bind(null,me,!1,h.queue),h=Ti(),b={state:a,dispatch:null,action:e,pending:null},h.queue=b,c=Wd.bind(null,me,b,T,c),b.dispatch=c,h.memoizedState=e,[a,c,!1]}function n0(e){var a=Mn();return i0(a,Ze,e)}function i0(e,a,c){if(a=lh(e,a,e0)[0],e=pc(Ja)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=Xo(a)}catch(k){throw k===Us?oc:k}else h=a;a=Mn();var b=a.queue,T=b.dispatch;return c!==a.memoizedState&&(me.flags|=2048,Hl(9,{destroy:void 0},Gg.bind(null,b,c),null)),[h,T,e]}function Gg(e,a){e.action=a}function a0(e){var a=Mn(),c=Ze;if(c!==null)return i0(a,c,e);Mn(),a=a.memoizedState,c=Mn();var h=c.queue.dispatch;return c.memoizedState=e,[a,h,!1]}function Hl(e,a,c,h){return e={tag:e,create:c,deps:h,inst:a,next:null},a=me.updateQueue,a===null&&(a=dc(),me.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=e.next=e:(h=c.next,c.next=e,e.next=h,a.lastEffect=e),e}function r0(){return Mn().memoizedState}function Sc(e,a,c,h){var b=Ti();me.flags|=e,b.memoizedState=Hl(1|a,{destroy:void 0},c,h===void 0?null:h)}function bc(e,a,c,h){var b=Mn();h=h===void 0?null:h;var T=b.memoizedState.inst;Ze!==null&&h!==null&&nh(h,Ze.memoizedState.deps)?b.memoizedState=Hl(a,T,c,h):(me.flags|=e,b.memoizedState=Hl(1|a,T,c,h))}function s0(e,a){Sc(8390656,8,e,a)}function gh(e,a){bc(2048,8,e,a)}function Hg(e){me.flags|=4;var a=me.updateQueue;if(a===null)a=dc(),me.updateQueue=a,a.events=[e];else{var c=a.events;c===null?a.events=[e]:c.push(e)}}function l0(e){var a=Mn().memoizedState;return Hg({ref:a,nextImpl:e}),function(){if((oe&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function o0(e,a){return bc(4,2,e,a)}function u0(e,a){return bc(4,4,e,a)}function c0(e,a){if(typeof a=="function"){e=e();var c=a(e);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return e=e(),a.current=e,function(){a.current=null}}function f0(e,a,c){c=c!=null?c.concat([e]):null,bc(4,4,c0.bind(null,a,e),c)}function _c(){}function h0(e,a){var c=Mn();a=a===void 0?null:a;var h=c.memoizedState;return a!==null&&nh(a,h[1])?h[0]:(c.memoizedState=[e,a],e)}function d0(e,a){var c=Mn();a=a===void 0?null:a;var h=c.memoizedState;if(a!==null&&nh(a,h[1]))return h[0];if(h=e(),Gs){Fe(!0);try{e()}finally{Fe(!1)}}return c.memoizedState=[h,a],h}function ta(e,a,c){return c===void 0||(Xa&1073741824)!==0&&(Ee&261930)===0?e.memoizedState=a:(e.memoizedState=c,e=jr(),me.lanes|=e,fs|=e,c)}function ph(e,a,c,h){return ni(c,a)?c:Gl.current!==null?(e=ta(e,c,h),ni(e,a)||(Pn=!0),e):(Xa&42)===0||(Xa&1073741824)!==0&&(Ee&261930)===0?(Pn=!0,e.memoizedState=c):(e=jr(),me.lanes|=e,fs|=e,a)}function Ec(e,a,c,h,b){var T=I.p;I.p=T!==0&&8>T?T:8;var k=j.T,$={};j.T=$,Nn(e,!1,a,c);try{var lt=b(),St=j.S;if(St!==null&&St($,lt),lt!==null&&typeof lt=="object"&&typeof lt.then=="function"){var Ot=Wi(lt,h);Fo(e,a,Ot,Si(e))}else Fo(e,a,h,Si(e))}catch(Mt){Fo(e,a,{then:function(){},status:"rejected",reason:Mt},Si())}finally{I.p=T,k!==null&&$.types!==null&&(k.types=$.types),j.T=k}}function g0(){}function Cc(e,a,c,h){if(e.tag!==5)throw Error(i(476));var b=mh(e).queue;Ec(e,b,a,X,c===null?g0:function(){return p0(e),c(h)})}function mh(e){var a=e.memoizedState;if(a!==null)return a;a={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:X},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:c},next:null},e.memoizedState=a,e=e.alternate,e!==null&&(e.memoizedState=a),a}function p0(e){var a=mh(e);a.next===null&&(a=e.alternate.memoizedState),Fo(e,a.next.queue,{},Si())}function Tc(){return dn(Lh)}function vh(){return Mn().memoizedState}function m0(){return Mn().memoizedState}function Pg(e){for(var a=e.return;a!==null;){switch(a.tag){case 24:case 3:var c=Si();e=es(c);var h=ns(a,e,c);h!==null&&(Ke(h,a,c),Yo(h,a,c)),a={cache:rc()},e.payload=a;return}a=a.return}}function Ig(e,a,c){var h=Si();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Jo(e)?v0(a,c):(c=Os(e,a,c,h),c!==null&&(Ke(c,e,h),Sh(c,a,h)))}function yh(e,a,c){var h=Si();Fo(e,a,c,h)}function Fo(e,a,c,h){var b={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Jo(e))v0(a,b);else{var T=e.alternate;if(e.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var k=a.lastRenderedState,$=T(k,c);if(b.hasEagerState=!0,b.eagerState=$,ni($,k))return mr(e,a,b,0),Te===null&&Uo(),!1}catch{}finally{}if(c=Os(e,a,b,h),c!==null)return Ke(c,e,h),Sh(c,a,h),!0}return!1}function Nn(e,a,c,h){if(h={lane:2,revertLane:Vg(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Jo(e)){if(a)throw Error(i(479))}else a=Os(e,c,h,2),a!==null&&Ke(a,e,2)}function Jo(e){var a=e.alternate;return e===me||a!==null&&a===me}function v0(e,a){pa=Or=!0;var c=e.pending;c===null?a.next=a:(a.next=c.next,c.next=a),e.pending=a}function Sh(e,a,c){if((c&4194048)!==0){var h=a.lanes;h&=e.pendingLanes,c|=h,a.lanes=c,_e(e,c)}}var Pl={readContext:dn,use:gc,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useLayoutEffect:wn,useInsertionEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useSyncExternalStore:wn,useId:wn,useHostTransitionStatus:wn,useFormState:wn,useActionState:wn,useOptimistic:wn,useMemoCache:wn,useCacheRefresh:wn};Pl.useEffectEvent=wn;var Ps={readContext:dn,use:gc,useCallback:function(e,a){return Ti().memoizedState=[e,a===void 0?null:a],e},useContext:dn,useEffect:s0,useImperativeHandle:function(e,a,c){c=c!=null?c.concat([e]):null,Sc(4194308,4,c0.bind(null,a,e),c)},useLayoutEffect:function(e,a){return Sc(4194308,4,e,a)},useInsertionEffect:function(e,a){Sc(4,2,e,a)},useMemo:function(e,a){var c=Ti();a=a===void 0?null:a;var h=e();if(Gs){Fe(!0);try{e()}finally{Fe(!1)}}return c.memoizedState=[h,a],h},useReducer:function(e,a,c){var h=Ti();if(c!==void 0){var b=c(a);if(Gs){Fe(!0);try{c(a)}finally{Fe(!1)}}}else b=a;return h.memoizedState=h.baseState=b,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:b},h.queue=e,e=e.dispatch=Ig.bind(null,me,e),[h.memoizedState,e]},useRef:function(e){var a=Ti();return e={current:e},a.memoizedState=e},useState:function(e){e=mc(e);var a=e.queue,c=yh.bind(null,me,a);return a.dispatch=c,[e.memoizedState,c]},useDebugValue:_c,useDeferredValue:function(e,a){var c=Ti();return ta(c,e,a)},useTransition:function(){var e=mc(!1);return e=Ec.bind(null,me,e.queue,!0,!1),Ti().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,a,c){var h=me,b=Ti();if(Ne){if(c===void 0)throw Error(i(407));c=c()}else{if(c=a(),Te===null)throw Error(i(349));(Ee&127)!==0||Fd(h,a,c)}b.memoizedState=c;var T={value:c,getSnapshot:a};return b.queue=T,s0(uh.bind(null,h,T,e),[e]),h.flags|=2048,Hl(9,{destroy:void 0},Jd.bind(null,h,T,c,a),null),c},useId:function(){var e=Ti(),a=Te.identifierPrefix;if(Ne){var c=Aa,h=Ta;c=(h&~(1<<32-Je(h)-1)).toString(32)+c,a="_"+a+"R_"+c,c=hc++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=zg++,a="_"+a+"r_"+c.toString(32)+"_";return e.memoizedState=a},useHostTransitionStatus:Tc,useFormState:dh,useActionState:dh,useOptimistic:function(e){var a=Ti();a.memoizedState=a.baseState=e;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=Nn.bind(null,me,!0,c),c.dispatch=a,[e,a]},useMemoCache:sh,useCacheRefresh:function(){return Ti().memoizedState=Pg.bind(null,me)},useEffectEvent:function(e){var a=Ti(),c={impl:e};return a.memoizedState=c,function(){if((oe&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},Zo={readContext:dn,use:gc,useCallback:h0,useContext:dn,useEffect:gh,useImperativeHandle:f0,useInsertionEffect:o0,useLayoutEffect:u0,useMemo:d0,useReducer:pc,useRef:r0,useState:function(){return pc(Ja)},useDebugValue:_c,useDeferredValue:function(e,a){var c=Mn();return ph(c,Ze.memoizedState,e,a)},useTransition:function(){var e=pc(Ja)[0],a=Mn().memoizedState;return[typeof e=="boolean"?e:Xo(e),a]},useSyncExternalStore:Xd,useId:vh,useHostTransitionStatus:Tc,useFormState:n0,useActionState:n0,useOptimistic:function(e,a){var c=Mn();return fh(c,Ze,e,a)},useMemoCache:sh,useCacheRefresh:m0};Zo.useEffectEvent=l0;var Is={readContext:dn,use:gc,useCallback:h0,useContext:dn,useEffect:gh,useImperativeHandle:f0,useInsertionEffect:o0,useLayoutEffect:u0,useMemo:d0,useReducer:oh,useRef:r0,useState:function(){return oh(Ja)},useDebugValue:_c,useDeferredValue:function(e,a){var c=Mn();return Ze===null?ta(c,e,a):ph(c,Ze.memoizedState,e,a)},useTransition:function(){var e=oh(Ja)[0],a=Mn().memoizedState;return[typeof e=="boolean"?e:Xo(e),a]},useSyncExternalStore:Xd,useId:vh,useHostTransitionStatus:Tc,useFormState:a0,useActionState:a0,useOptimistic:function(e,a){var c=Mn();return Ze!==null?fh(c,Ze,e,a):(c.baseState=e,[e,c.queue.dispatch])},useMemoCache:sh,useCacheRefresh:m0};Is.useEffectEvent=l0;function ss(e,a,c,h){a=e.memoizedState,c=c(h,a),c=c==null?a:C({},a,c),e.memoizedState=c,e.lanes===0&&(e.updateQueue.baseState=c)}var Ai={enqueueSetState:function(e,a,c){e=e._reactInternals;var h=Si(),b=es(h);b.payload=a,c!=null&&(b.callback=c),a=ns(e,b,h),a!==null&&(Ke(a,e,h),Yo(a,e,h))},enqueueReplaceState:function(e,a,c){e=e._reactInternals;var h=Si(),b=es(h);b.tag=1,b.payload=a,c!=null&&(b.callback=c),a=ns(e,b,h),a!==null&&(Ke(a,e,h),Yo(a,e,h))},enqueueForceUpdate:function(e,a){e=e._reactInternals;var c=Si(),h=es(c);h.tag=2,a!=null&&(h.callback=a),a=ns(e,h,c),a!==null&&(Ke(a,e,c),Yo(a,e,c))}};function y0(e,a,c,h,b,T,k){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,T,k):a.prototype&&a.prototype.isPureReactComponent?!ha(c,h)||!ha(b,T):!0}function S0(e,a,c,h){e=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,h),a.state!==e&&Ai.enqueueReplaceState(a,a.state,null)}function Za(e,a){var c=a;if("ref"in a){c={};for(var h in a)h!=="ref"&&(c[h]=a[h])}if(e=e.defaultProps){c===a&&(c=C({},c));for(var b in e)c[b]===void 0&&(c[b]=e[b])}return c}function Wo(e){_a(e)}function $o(e){console.error(e)}function Ac(e){_a(e)}function Oc(e,a){try{var c=e.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function b0(e,a,c){try{var h=e.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function ea(e,a,c){return c=es(c),c.tag=3,c.payload={element:null},c.callback=function(){Oc(e,a)},c}function bh(e){return e=es(e),e.tag=3,e}function _0(e,a,c,h){var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var T=h.value;e.payload=function(){return b(T)},e.callback=function(){b0(a,c,h)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(e.callback=function(){b0(a,c,h),typeof b!="function"&&(xi===null?xi=new Set([this]):xi.add(this));var $=h.stack;this.componentDidCatch(h.value,{componentStack:$!==null?$:""})})}function _h(e,a,c,h,b){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=c.alternate,a!==null&&jl(a,c,b,!0),c=Sn.current,c!==null){switch(c.tag){case 31:case 13:return ga===null?S():c.alternate===null&&on===0&&(on=3),c.flags&=-257,c.flags|=65536,c.lanes=b,h===Io?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([h]):a.add(h),rn(e,h,b)),!1;case 22:return c.flags|=65536,h===Io?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([h]):c.add(h)),rn(e,h,b)),!1}throw Error(i(435,c.tag))}return rn(e,h,b),S(),!1}if(Ne)return a=Sn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=b,h!==nc&&(e=Error(i(422),{cause:h}),Dl(Ji(e,c)))):(h!==nc&&(a=Error(i(423),{cause:h}),Dl(Ji(a,c))),e=e.current.alternate,e.flags|=65536,b&=-b,e.lanes|=b,h=Ji(h,c),b=ea(e.stateNode,h,b),th(e,b),on!==4&&(on=2)),!1;var T=Error(i(520),{cause:h});if(T=Ji(T,c),Ge===null?Ge=[T]:Ge.push(T),on!==4&&(on=2),a===null)return!0;h=Ji(h,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,e=b&-b,c.lanes|=e,e=ea(c.stateNode,h,e),th(c,e),!1;case 1:if(a=c.type,T=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(xi===null||!xi.has(T))))return c.flags|=65536,b&=-b,c.lanes|=b,b=bh(b),_0(b,e,c,h),th(c,b),!1}c=c.return}while(c!==null);return!1}var Eh=Error(i(461)),Pn=!1;function li(e,a,c,h){a.child=e===null?Vd(a,null,c,h):zs(a,e.child,c,h)}function Il(e,a,c,h,b){c=c.render;var T=a.ref;if("ref"in h){var k={};for(var $ in h)$!=="ref"&&(k[$]=h[$])}else k=h;return Sr(a),h=Hs(e,a,c,k,T,b),$=ih(),e!==null&&!Pn?(ah(e,a,b),xa(e,a,b)):(Ne&&$&&Lo(a),a.flags|=1,li(e,a,h,b),a.child)}function Hi(e,a,c,h,b){if(e===null){var T=c.type;return typeof T=="function"&&!Wu(T)&&T.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=T,Rc(e,a,T,h,b)):(e=xl(c.type,null,h,a,a.mode,b),e.ref=a.ref,e.return=a,a.child=e)}if(T=e.child,!Oi(e,b)){var k=T.memoizedProps;if(c=c.compare,c=c!==null?c:ha,c(k,h)&&e.ref===a.ref)return xa(e,a,b)}return a.flags|=1,e=Ea(T,h),e.ref=a.ref,e.return=a,a.child=e}function Rc(e,a,c,h,b){if(e!==null){var T=e.memoizedProps;if(ha(T,h)&&e.ref===a.ref)if(Pn=!1,a.pendingProps=h=T,Oi(e,b))(e.flags&131072)!==0&&(Pn=!0);else return a.lanes=e.lanes,xa(e,a,b)}return Pi(e,a,c,h,b)}function Ch(e,a,c,h){var b=h.children,T=e!==null?e.memoizedState:null;if(e===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((a.flags&128)!==0){if(T=T!==null?T.baseLanes|c:c,e!==null){for(h=a.child=e.child,b=0;h!==null;)b=b|h.lanes|h.childLanes,h=h.sibling;h=b&~T}else h=0,a.child=null;return Th(e,a,T,c,h)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},e!==null&&br(a,T!==null?T.cachePool:null),T!==null?Ya(a,T):Xn(),Qa(a);else return h=a.lanes=536870912,Th(e,a,T!==null?T.baseLanes|c:c,c,h)}else T!==null?(br(a,T.cachePool),Ya(a,T),rs(),a.memoizedState=null):(e!==null&&br(a,null),Xn(),rs());return li(e,a,b,c),a.child}function ks(e,a){return e!==null&&e.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Th(e,a,c,h,b){var T=zl();return T=T===null?null:{parent:Ln._currentValue,pool:T},a.memoizedState={baseLanes:c,cachePool:T},e!==null&&br(a,null),Xn(),Qa(a),e!==null&&jl(e,a,h,!0),a.childLanes=b,null}function Rr(e,a){return a=Fn({mode:a.mode,children:a.children},e.mode),a.ref=e.ref,e.child=a,a.return=e,a}function qs(e,a,c){return zs(a,e.child,null,c),e=Rr(a,a.pendingProps),e.flags|=2,$i(a),a.memoizedState=null,e}function wc(e,a,c){var h=a.pendingProps,b=(a.flags&128)!==0;if(a.flags&=-129,e===null){if(Ne){if(h.mode==="hidden")return e=Rr(a,h),a.lanes=536870912,ks(null,e);if(Gn(a),(e=sn)?(e=jv(e,Ci),e=e!==null&&e.data==="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:vr!==null?{id:Ta,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},c=zi(e),c.return=a,a.child=c,si=a,sn=null)):e=null,e===null)throw yr(a);return a.lanes=536870912,null}return Rr(a,h)}var T=e.memoizedState;if(T!==null){var k=T.dehydrated;if(Gn(a),b)if(a.flags&256)a.flags&=-257,a=qs(e,a,c);else if(a.memoizedState!==null)a.child=e.child,a.flags|=128,a=null;else throw Error(i(558));else if(Pn||jl(e,a,c,!1),b=(c&e.childLanes)!==0,Pn||b){if(h=Te,h!==null&&(k=ti(h,c),k!==0&&k!==T.retryLane))throw T.retryLane=k,Fi(e,k),Ke(h,e,k),Eh;S(),a=qs(e,a,c)}else e=T.treeContext,sn=sr(k.nextSibling),si=a,Ne=!0,Zi=null,Ci=!1,e!==null&&kd(a,e),a=Rr(a,h),a.flags|=4096;return a}return e=Ea(e.child,{mode:h.mode,children:h.children}),e.ref=a.ref,a.child=e,e.return=a,e}function Vs(e,a){var c=a.ref;if(c===null)e!==null&&e.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(e===null||e.ref!==c)&&(a.flags|=4194816)}}function Pi(e,a,c,h,b){return Sr(a),c=Hs(e,a,c,h,void 0,b),h=ih(),e!==null&&!Pn?(ah(e,a,b),xa(e,a,b)):(Ne&&h&&Lo(a),a.flags|=1,li(e,a,c,b),a.child)}function na(e,a,c,h,b,T){return Sr(a),a.updateQueue=null,c=Qd(a,h,c,b),Kd(e),h=ih(),e!==null&&!Pn?(ah(e,a,T),xa(e,a,T)):(Ne&&h&&Lo(a),a.flags|=1,li(e,a,c,T),a.child)}function ls(e,a,c,h,b){if(Sr(a),a.stateNode===null){var T=Ia,k=c.contextType;typeof k=="object"&&k!==null&&(T=dn(k)),T=new c(h,T),a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Ai,a.stateNode=T,T._reactInternals=a,T=a.stateNode,T.props=h,T.state=a.memoizedState,T.refs={},Ls(a),k=c.contextType,T.context=typeof k=="object"&&k!==null?dn(k):Ia,T.state=a.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(ss(a,c,k,h),T.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(k=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),k!==T.state&&Ai.enqueueReplaceState(T,T.state,null),is(a,h,T,b),Ll(),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(e===null){T=a.stateNode;var $=a.memoizedProps,lt=Za(c,$);T.props=lt;var St=T.context,Ot=c.contextType;k=Ia,typeof Ot=="object"&&Ot!==null&&(k=dn(Ot));var Mt=c.getDerivedStateFromProps;Ot=typeof Mt=="function"||typeof T.getSnapshotBeforeUpdate=="function",$=a.pendingProps!==$,Ot||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||($||St!==k)&&S0(a,T,h,k),Ar=!1;var Et=a.memoizedState;T.state=Et,is(a,h,T,b),Ll(),St=a.memoizedState,$||Et!==St||Ar?(typeof Mt=="function"&&(ss(a,c,Mt,h),St=a.memoizedState),(lt=Ar||y0(a,c,lt,h,Et,St,k))?(Ot||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=St),T.props=h,T.state=St,T.context=k,h=lt):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{T=a.stateNode,$f(e,a),k=a.memoizedProps,Ot=Za(c,k),T.props=Ot,Mt=a.pendingProps,Et=T.context,St=c.contextType,lt=Ia,typeof St=="object"&&St!==null&&(lt=dn(St)),$=c.getDerivedStateFromProps,(St=typeof $=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(k!==Mt||Et!==lt)&&S0(a,T,h,lt),Ar=!1,Et=a.memoizedState,T.state=Et,is(a,h,T,b),Ll();var Tt=a.memoizedState;k!==Mt||Et!==Tt||Ar||e!==null&&e.dependencies!==null&&ac(e.dependencies)?(typeof $=="function"&&(ss(a,c,$,h),Tt=a.memoizedState),(Ot=Ar||y0(a,c,Ot,h,Et,Tt,lt)||e!==null&&e.dependencies!==null&&ac(e.dependencies))?(St||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(h,Tt,lt),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(h,Tt,lt)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||k===e.memoizedProps&&Et===e.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&Et===e.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=Tt),T.props=h,T.state=Tt,T.context=lt,h=Ot):(typeof T.componentDidUpdate!="function"||k===e.memoizedProps&&Et===e.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&Et===e.memoizedState||(a.flags|=1024),h=!1)}return T=h,Vs(e,a),h=(a.flags&128)!==0,T||h?(T=a.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:T.render(),a.flags|=1,e!==null&&h?(a.child=zs(a,e.child,null,b),a.child=zs(a,null,c,b)):li(e,a,c,b),a.memoizedState=T.state,e=a.child):e=xa(e,a,b),e}function Wa(e,a,c,h){return Zr(),a.flags|=256,li(e,a,c,h),a.child}var Ra={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vn(e){return{baseLanes:e,cachePool:js()}}function Ys(e,a,c){return e=e!==null?e.childLanes&~c:0,a&&(e|=fe),e}function wr(e,a,c){var h=a.pendingProps,b=!1,T=(a.flags&128)!==0,k;if((k=T)||(k=e!==null&&e.memoizedState===null?!1:(xn.current&2)!==0),k&&(b=!0,a.flags&=-129),k=(a.flags&32)!==0,a.flags&=-33,e===null){if(Ne){if(b?as(a):rs(),(e=sn)?(e=jv(e,Ci),e=e!==null&&e.data!=="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:vr!==null?{id:Ta,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},c=zi(e),c.return=a,a.child=c,si=a,sn=null)):e=null,e===null)throw yr(a);return ip(e)?a.lanes=32:a.lanes=536870912,null}var $=h.children;return h=h.fallback,b?(rs(),b=a.mode,$=Fn({mode:"hidden",children:$},b),h=Jr(h,b,c,null),$.return=a,h.return=a,$.sibling=h,a.child=$,h=a.child,h.memoizedState=Vn(c),h.childLanes=Ys(e,k,c),a.memoizedState=Ra,ks(null,h)):(as(a),kl(a,$))}var lt=e.memoizedState;if(lt!==null&&($=lt.dehydrated,$!==null)){if(T)a.flags&256?(as(a),a.flags&=-257,a=Dn(e,a,c)):a.memoizedState!==null?(rs(),a.child=e.child,a.flags|=128,a=null):(rs(),$=h.fallback,b=a.mode,h=Fn({mode:"visible",children:h.children},b),$=Jr($,b,c,null),$.flags|=2,h.return=a,$.return=a,h.sibling=$,a.child=h,zs(a,e.child,null,c),h=a.child,h.memoizedState=Vn(c),h.childLanes=Ys(e,k,c),a.memoizedState=Ra,a=ks(null,h));else if(as(a),ip($)){if(k=$.nextSibling&&$.nextSibling.dataset,k)var St=k.dgst;k=St,h=Error(i(419)),h.stack="",h.digest=k,Dl({value:h,source:null,stack:null}),a=Dn(e,a,c)}else if(Pn||jl(e,a,c,!1),k=(c&e.childLanes)!==0,Pn||k){if(k=Te,k!==null&&(h=ti(k,c),h!==0&&h!==lt.retryLane))throw lt.retryLane=h,Fi(e,h),Ke(k,e,h),Eh;np($)||S(),a=Dn(e,a,c)}else np($)?(a.flags|=192,a.child=e.child,a=null):(e=lt.treeContext,sn=sr($.nextSibling),si=a,Ne=!0,Zi=null,Ci=!1,e!==null&&kd(a,e),a=kl(a,h.children),a.flags|=4096);return a}return b?(rs(),$=h.fallback,b=a.mode,lt=e.child,St=lt.sibling,h=Ea(lt,{mode:"hidden",children:h.children}),h.subtreeFlags=lt.subtreeFlags&65011712,St!==null?$=Ea(St,$):($=Jr($,b,c,null),$.flags|=2),$.return=a,h.return=a,h.sibling=$,a.child=h,ks(null,h),h=a.child,$=e.child.memoizedState,$===null?$=Vn(c):(b=$.cachePool,b!==null?(lt=Ln._currentValue,b=b.parent!==lt?{parent:lt,pool:lt}:b):b=js(),$={baseLanes:$.baseLanes|c,cachePool:b}),h.memoizedState=$,h.childLanes=Ys(e,k,c),a.memoizedState=Ra,ks(e.child,h)):(as(a),c=e.child,e=c.sibling,c=Ea(c,{mode:"visible",children:h.children}),c.return=a,c.sibling=null,e!==null&&(k=a.deletions,k===null?(a.deletions=[e],a.flags|=16):k.push(e)),a.child=c,a.memoizedState=null,c)}function kl(e,a){return a=Fn({mode:"visible",children:a},e.mode),a.return=e,e.child=a}function Fn(e,a){return e=pi(22,e,null,a),e.lanes=0,e}function Dn(e,a,c){return zs(a,e.child,null,c),e=kl(a,a.pendingProps.children),e.flags|=2,a.memoizedState=null,e}function Ie(e,a,c){e.lanes|=a;var h=e.alternate;h!==null&&(h.lanes|=a),Ff(e.return,a,c)}function xr(e,a,c,h,b,T){var k=e.memoizedState;k===null?e.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:b,treeForkCount:T}:(k.isBackwards=a,k.rendering=null,k.renderingStartTime=0,k.last=h,k.tail=c,k.tailMode=b,k.treeForkCount=T)}function wa(e,a,c){var h=a.pendingProps,b=h.revealOrder,T=h.tail;h=h.children;var k=xn.current,$=(k&2)!==0;if($?(k=k&1|2,a.flags|=128):k&=1,it(xn,k),li(e,a,h,c),h=Ne?Nl:0,!$&&e!==null&&(e.flags&128)!==0)t:for(e=a.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ie(e,c,a);else if(e.tag===19)Ie(e,c,a);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===a)break t;for(;e.sibling===null;){if(e.return===null||e.return===a)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(b){case"forwards":for(c=a.child,b=null;c!==null;)e=c.alternate,e!==null&&fc(e)===null&&(b=c),c=c.sibling;c=b,c===null?(b=a.child,a.child=null):(b=c.sibling,c.sibling=null),xr(a,!1,b,c,T,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,b=a.child,a.child=null;b!==null;){if(e=b.alternate,e!==null&&fc(e)===null){a.child=b;break}e=b.sibling,b.sibling=c,c=b,b=e}xr(a,!0,c,null,T,h);break;case"together":xr(a,!1,null,null,void 0,h);break;default:a.memoizedState=null}return a.child}function xa(e,a,c){if(e!==null&&(a.dependencies=e.dependencies),fs|=a.lanes,(c&a.childLanes)===0)if(e!==null){if(jl(e,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(e!==null&&a.child!==e.child)throw Error(i(153));if(a.child!==null){for(e=a.child,c=Ea(e,e.pendingProps),a.child=c,c.return=a;e.sibling!==null;)e=e.sibling,c=c.sibling=Ea(e,e.pendingProps),c.return=a;c.sibling=null}return a.child}function Oi(e,a){return(e.lanes&a)!==0?!0:(e=e.dependencies,!!(e!==null&&ac(e)))}function xc(e,a,c){switch(a.tag){case 3:gt(a,a.stateNode.containerInfo),Wr(a,Ln,e.memoizedState.cache),Zr();break;case 27:case 5:Bt(a);break;case 4:gt(a,a.stateNode.containerInfo);break;case 10:Wr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Gn(a),null;break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(as(a),a.flags|=128,null):(c&a.child.childLanes)!==0?wr(e,a,c):(as(a),e=xa(e,a,c),e!==null?e.sibling:null);as(a);break;case 19:var b=(e.flags&128)!==0;if(h=(c&a.childLanes)!==0,h||(jl(e,a,c,!1),h=(c&a.childLanes)!==0),b){if(h)return wa(e,a,c);a.flags|=128}if(b=a.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),it(xn,xn.current),h)break;return null;case 22:return a.lanes=0,Ch(e,a,c,a.pendingProps);case 24:Wr(a,Ln,e.memoizedState.cache)}return xa(e,a,c)}function os(e,a,c){if(e!==null)if(e.memoizedProps!==a.pendingProps)Pn=!0;else{if(!Oi(e,c)&&(a.flags&128)===0)return Pn=!1,xc(e,a,c);Pn=(e.flags&131072)!==0}else Pn=!1,Ne&&(a.flags&1048576)!==0&&ec(a,Nl,a.index);switch(a.lanes=0,a.tag){case 16:t:{var h=a.pendingProps;if(e=Er(a.elementType),a.type=e,typeof e=="function")Wu(e)?(h=Za(e,h),a.tag=1,a=ls(null,a,e,h,c)):(a.tag=0,a=Pi(null,a,e,h,c));else{if(e!=null){var b=e.$$typeof;if(b===G){a.tag=11,a=Il(null,a,e,h,c);break t}else if(b===A){a.tag=14,a=Hi(null,a,e,h,c);break t}}throw a=Q(e)||e,Error(i(306,a,""))}}return a;case 0:return Pi(e,a,a.type,a.pendingProps,c);case 1:return h=a.type,b=Za(h,a.pendingProps),ls(e,a,h,b,c);case 3:t:{if(gt(a,a.stateNode.containerInfo),e===null)throw Error(i(387));h=a.pendingProps;var T=a.memoizedState;b=T.element,$f(e,a),is(a,h,null,c);var k=a.memoizedState;if(h=k.cache,Wr(a,Ln,h),h!==T.cache&&Jf(a,[Ln],c,!0),Ll(),h=k.element,T.isDehydrated)if(T={element:h,isDehydrated:!1,cache:k.cache},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){a=Wa(e,a,h,c);break t}else if(h!==b){b=Ji(Error(i(424)),a),Dl(b),a=Wa(e,a,h,c);break t}else{switch(e=a.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(sn=sr(e.firstChild),si=a,Ne=!0,Zi=null,Ci=!0,c=Vd(a,null,h,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Zr(),h===b){a=xa(e,a,c);break t}li(e,a,h,c)}a=a.child}return a;case 26:return Vs(e,a),e===null?(c=Hv(a.type,null,a.pendingProps,null))?a.memoizedState=c:Ne||(c=a.type,e=a.pendingProps,h=x0(tt.current).createElement(c),h[kn]=a,h[Kn]=e,Mi(h,c,e),Qn(h),a.stateNode=h):a.memoizedState=Hv(a.type,e.memoizedProps,a.pendingProps,e.memoizedState),null;case 27:return Bt(a),e===null&&Ne&&(h=a.stateNode=zv(a.type,a.pendingProps,tt.current),si=a,Ci=!0,b=sn,Jl(a.type)?(ap=b,sn=sr(h.firstChild)):sn=b),li(e,a,a.pendingProps.children,c),Vs(e,a),e===null&&(a.flags|=4194304),a.child;case 5:return e===null&&Ne&&((b=h=sn)&&(h=R4(h,a.type,a.pendingProps,Ci),h!==null?(a.stateNode=h,si=a,sn=sr(h.firstChild),Ci=!1,b=!0):b=!1),b||yr(a)),Bt(a),b=a.type,T=a.pendingProps,k=e!==null?e.memoizedProps:null,h=T.children,$g(b,T)?h=null:k!==null&&$g(b,k)&&(a.flags|=32),a.memoizedState!==null&&(b=Hs(e,a,Lg,null,null,c),Lh._currentValue=b),Vs(e,a),li(e,a,h,c),a.child;case 6:return e===null&&Ne&&((e=c=sn)&&(c=w4(c,a.pendingProps,Ci),c!==null?(a.stateNode=c,si=a,sn=null,e=!0):e=!1),e||yr(a)),null;case 13:return wr(e,a,c);case 4:return gt(a,a.stateNode.containerInfo),h=a.pendingProps,e===null?a.child=zs(a,null,h,c):li(e,a,h,c),a.child;case 11:return Il(e,a,a.type,a.pendingProps,c);case 7:return li(e,a,a.pendingProps,c),a.child;case 8:return li(e,a,a.pendingProps.children,c),a.child;case 12:return li(e,a,a.pendingProps.children,c),a.child;case 10:return h=a.pendingProps,Wr(a,a.type,h.value),li(e,a,h.children,c),a.child;case 9:return b=a.type._context,h=a.pendingProps.children,Sr(a),b=dn(b),h=h(b),a.flags|=1,li(e,a,h,c),a.child;case 14:return Hi(e,a,a.type,a.pendingProps,c);case 15:return Rc(e,a,a.type,a.pendingProps,c);case 19:return wa(e,a,c);case 31:return wc(e,a,c);case 22:return Ch(e,a,c,a.pendingProps);case 24:return Sr(a),h=dn(Ln),e===null?(b=zl(),b===null&&(b=Te,T=rc(),b.pooledCache=T,T.refCount++,T!==null&&(b.pooledCacheLanes|=c),b=T),a.memoizedState={parent:h,cache:b},Ls(a),Wr(a,Ln,b)):((e.lanes&c)!==0&&($f(e,a),is(a,null,null,c),Ll()),b=e.memoizedState,T=a.memoizedState,b.parent!==h?(b={parent:h,cache:h},a.memoizedState=b,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=b),Wr(a,Ln,h)):(h=T.cache,Wr(a,Ln,h),h!==b.cache&&Jf(a,[Ln],c,!0))),li(e,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function oi(e){e.flags|=4}function Ah(e,a,c,h,b){if((a=(e.mode&32)!==0)&&(a=!1),a){if(e.flags|=16777216,(b&335544128)===b)if(e.stateNode.complete)e.flags|=8192;else if(s())e.flags|=8192;else throw Cr=Io,Po}else e.flags&=-16777217}function E0(e,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Vv(a))if(s())e.flags|=8192;else throw Cr=Io,Po}function Mc(e,a){a!==null&&(e.flags|=4),e.flags&16384&&(a=e.tag!==22?ce():536870912,e.lanes|=a,Ae|=a)}function ln(e,a){if(!Ne)switch(e.tailMode){case"hidden":a=e.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?e.tail=null:c.sibling=null;break;case"collapsed":c=e.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function en(e){var a=e.alternate!==null&&e.alternate.child===e.child,c=0,h=0;if(a)for(var b=e.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags&65011712,h|=b.flags&65011712,b.return=e,b=b.sibling;else for(b=e.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags,h|=b.flags,b.return=e,b=b.sibling;return e.subtreeFlags|=h,e.childLanes=c,a}function ql(e,a,c){var h=a.pendingProps;switch(Kf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(a),null;case 1:return en(a),null;case 3:return c=a.stateNode,h=null,e!==null&&(h=e.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),qa(Ln),At(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(ws(a)?oi(a):e===null||e.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,xs())),en(a),null;case 26:var b=a.type,T=a.memoizedState;return e===null?(oi(a),T!==null?(en(a),E0(a,T)):(en(a),Ah(a,b,null,h,c))):T?T!==e.memoizedState?(oi(a),en(a),E0(a,T)):(en(a),a.flags&=-16777217):(e=e.memoizedProps,e!==h&&oi(a),en(a),Ah(a,b,e,h,c)),null;case 27:if(qt(a),c=tt.current,b=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==h&&oi(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return en(a),null}e=q.current,ws(a)?Qf(a):(e=zv(b,h,c),a.stateNode=e,oi(a))}return en(a),null;case 5:if(qt(a),b=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==h&&oi(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return en(a),null}if(T=q.current,ws(a))Qf(a);else{var k=x0(tt.current);switch(T){case 1:T=k.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:T=k.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":T=k.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":T=k.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":T=k.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof h.is=="string"?k.createElement("select",{is:h.is}):k.createElement("select"),h.multiple?T.multiple=!0:h.size&&(T.size=h.size);break;default:T=typeof h.is=="string"?k.createElement(b,{is:h.is}):k.createElement(b)}}T[kn]=a,T[Kn]=h;t:for(k=a.child;k!==null;){if(k.tag===5||k.tag===6)T.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===a)break t;for(;k.sibling===null;){if(k.return===null||k.return===a)break t;k=k.return}k.sibling.return=k.return,k=k.sibling}a.stateNode=T;t:switch(Mi(T,b,h),b){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&oi(a)}}return en(a),Ah(a,a.type,e===null?null:e.memoizedProps,a.pendingProps,c),null;case 6:if(e&&a.stateNode!=null)e.memoizedProps!==h&&oi(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(i(166));if(e=tt.current,ws(a)){if(e=a.stateNode,c=a.memoizedProps,h=null,b=si,b!==null)switch(b.tag){case 27:case 5:h=b.memoizedProps}e[kn]=a,e=!!(e.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||Av(e.nodeValue,c)),e||yr(a,!0)}else e=x0(e).createTextNode(h),e[kn]=a,a.stateNode=e}return en(a),null;case 31:if(c=a.memoizedState,e===null||e.memoizedState!==null){if(h=ws(a),c!==null){if(e===null){if(!h)throw Error(i(318));if(e=a.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[kn]=a}else Zr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;en(a),e=!1}else c=xs(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),e=!0;if(!e)return a.flags&256?($i(a),a):($i(a),null);if((a.flags&128)!==0)throw Error(i(558))}return en(a),null;case 13:if(h=a.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(b=ws(a),h!==null&&h.dehydrated!==null){if(e===null){if(!b)throw Error(i(318));if(b=a.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(i(317));b[kn]=a}else Zr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;en(a),b=!1}else b=xs(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=b),b=!0;if(!b)return a.flags&256?($i(a),a):($i(a),null)}return $i(a),(a.flags&128)!==0?(a.lanes=c,a):(c=h!==null,e=e!==null&&e.memoizedState!==null,c&&(h=a.child,b=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(b=h.alternate.memoizedState.cachePool.pool),T=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(T=h.memoizedState.cachePool.pool),T!==b&&(h.flags|=2048)),c!==e&&c&&(a.child.flags|=8192),Mc(a,a.updateQueue),en(a),null);case 4:return At(),e===null&&Xg(a.stateNode.containerInfo),en(a),null;case 10:return qa(a.type),en(a),null;case 19:if(rt(xn),h=a.memoizedState,h===null)return en(a),null;if(b=(a.flags&128)!==0,T=h.rendering,T===null)if(b)ln(h,!1);else{if(on!==0||e!==null&&(e.flags&128)!==0)for(e=a.child;e!==null;){if(T=fc(e),T!==null){for(a.flags|=128,ln(h,!1),e=T.updateQueue,a.updateQueue=e,Mc(a,e),a.subtreeFlags=0,e=c,c=a.child;c!==null;)$u(c,e),c=c.sibling;return it(xn,xn.current&1|2),Ne&&ka(a,h.treeForkCount),a.child}e=e.sibling}h.tail!==null&&xe()>ya&&(a.flags|=128,b=!0,ln(h,!1),a.lanes=4194304)}else{if(!b)if(e=fc(T),e!==null){if(a.flags|=128,b=!0,e=e.updateQueue,a.updateQueue=e,Mc(a,e),ln(h,!0),h.tail===null&&h.tailMode==="hidden"&&!T.alternate&&!Ne)return en(a),null}else 2*xe()-h.renderingStartTime>ya&&c!==536870912&&(a.flags|=128,b=!0,ln(h,!1),a.lanes=4194304);h.isBackwards?(T.sibling=a.child,a.child=T):(e=h.last,e!==null?e.sibling=T:a.child=T,h.last=T)}return h.tail!==null?(e=h.tail,h.rendering=e,h.tail=e.sibling,h.renderingStartTime=xe(),e.sibling=null,c=xn.current,it(xn,b?c&1|2:c&1),Ne&&ka(a,h.treeForkCount),e):(en(a),null);case 22:case 23:return $i(a),Ka(),h=a.memoizedState!==null,e!==null?e.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(c&536870912)!==0&&(a.flags&128)===0&&(en(a),a.subtreeFlags&6&&(a.flags|=8192)):en(a),c=a.updateQueue,c!==null&&Mc(a,c.retryQueue),c=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==c&&(a.flags|=2048),e!==null&&rt(Ds),null;case 24:return c=null,e!==null&&(c=e.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),qa(Ln),en(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Oh(e,a){switch(Kf(a),a.tag){case 1:return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 3:return qa(Ln),At(),e=a.flags,(e&65536)!==0&&(e&128)===0?(a.flags=e&-65537|128,a):null;case 26:case 27:case 5:return qt(a),null;case 31:if(a.memoizedState!==null){if($i(a),a.alternate===null)throw Error(i(340));Zr()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 13:if($i(a),e=a.memoizedState,e!==null&&e.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Zr()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 19:return rt(xn),null;case 4:return At(),null;case 10:return qa(a.type),null;case 22:case 23:return $i(a),Ka(),e!==null&&rt(Ds),e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 24:return qa(Ln),null;case 25:return null;default:return null}}function tu(e,a){switch(Kf(a),a.tag){case 3:qa(Ln),At();break;case 26:case 27:case 5:qt(a);break;case 4:At();break;case 31:a.memoizedState!==null&&$i(a);break;case 13:$i(a);break;case 19:rt(xn);break;case 10:qa(a.type);break;case 22:case 23:$i(a),Ka(),e!==null&&rt(Ds);break;case 24:qa(Ln)}}function Ks(e,a){try{var c=a.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var b=h.next;c=b;do{if((c.tag&e)===e){h=void 0;var T=c.create,k=c.inst;h=T(),k.destroy=h}c=c.next}while(c!==b)}}catch($){kt(a,a.return,$)}}function ia(e,a,c){try{var h=a.updateQueue,b=h!==null?h.lastEffect:null;if(b!==null){var T=b.next;h=T;do{if((h.tag&e)===e){var k=h.inst,$=k.destroy;if($!==void 0){k.destroy=void 0,b=a;var lt=c,St=$;try{St()}catch(Ot){kt(b,lt,Ot)}}}h=h.next}while(h!==T)}}catch(Ot){kt(a,a.return,Ot)}}function Vl(e){var a=e.updateQueue;if(a!==null){var c=e.stateNode;try{Yd(a,c)}catch(h){kt(e,e.return,h)}}}function Nc(e,a,c){c.props=Za(e.type,e.memoizedProps),c.state=e.memoizedState;try{c.componentWillUnmount()}catch(h){kt(e,a,h)}}function $a(e,a){try{var c=e.ref;if(c!==null){switch(e.tag){case 26:case 27:case 5:var h=e.stateNode;break;case 30:h=e.stateNode;break;default:h=e.stateNode}typeof c=="function"?e.refCleanup=c(h):c.current=h}}catch(b){kt(e,a,b)}}function Ri(e,a){var c=e.ref,h=e.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(b){kt(e,a,b)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(b){kt(e,a,b)}else c.current=null}function Rh(e){var a=e.type,c=e.memoizedProps,h=e.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break t;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(b){kt(e,e.return,b)}}function Mr(e,a,c){try{var h=e.stateNode;_4(h,e.type,c,a),h[Kn]=a}catch(b){kt(e,e.return,b)}}function C0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Jl(e.type)||e.tag===4}function Qs(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||C0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Jl(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function eu(e,a,c){var h=e.tag;if(h===5||h===6)e=e.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(e,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(e),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Ui));else if(h!==4&&(h===27&&Jl(e.type)&&(c=e.stateNode,a=null),e=e.child,e!==null))for(eu(e,a,c),e=e.sibling;e!==null;)eu(e,a,c),e=e.sibling}function Xs(e,a,c){var h=e.tag;if(h===5||h===6)e=e.stateNode,a?c.insertBefore(e,a):c.appendChild(e);else if(h!==4&&(h===27&&Jl(e.type)&&(c=e.stateNode),e=e.child,e!==null))for(Xs(e,a,c),e=e.sibling;e!==null;)Xs(e,a,c),e=e.sibling}function nu(e){var a=e.stateNode,c=e.memoizedProps;try{for(var h=e.type,b=a.attributes;b.length;)a.removeAttributeNode(b[0]);Mi(a,h,c),a[kn]=e,a[Kn]=c}catch(T){kt(e,e.return,T)}}var Ii=!1,Ve=!1,us=!1,Dc=typeof WeakSet=="function"?WeakSet:Set,gn=null;function wh(e,a){if(e=e.containerInfo,Zg=z0,e=ba(e),Fu(e)){if("selectionStart"in e)var c={start:e.selectionStart,end:e.selectionEnd};else t:{c=(c=e.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var b=h.anchorOffset,T=h.focusNode;h=h.focusOffset;try{c.nodeType,T.nodeType}catch{c=null;break t}var k=0,$=-1,lt=-1,St=0,Ot=0,Mt=e,Et=null;e:for(;;){for(var Tt;Mt!==c||b!==0&&Mt.nodeType!==3||($=k+b),Mt!==T||h!==0&&Mt.nodeType!==3||(lt=k+h),Mt.nodeType===3&&(k+=Mt.nodeValue.length),(Tt=Mt.firstChild)!==null;)Et=Mt,Mt=Tt;for(;;){if(Mt===e)break e;if(Et===c&&++St===b&&($=k),Et===T&&++Ot===h&&(lt=k),(Tt=Mt.nextSibling)!==null)break;Mt=Et,Et=Mt.parentNode}Mt=Tt}c=$===-1||lt===-1?null:{start:$,end:lt}}else c=null}c=c||{start:0,end:0}}else c=null;for(Wg={focusedElem:e,selectionRange:c},z0=!1,gn=a;gn!==null;)if(a=gn,e=a.child,(a.subtreeFlags&1028)!==0&&e!==null)e.return=a,gn=e;else for(;gn!==null;){switch(a=gn,T=a.alternate,e=a.flags,a.tag){case 0:if((e&4)!==0&&(e=a.updateQueue,e=e!==null?e.events:null,e!==null))for(c=0;c<e.length;c++)b=e[c],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&T!==null){e=void 0,c=a,b=T.memoizedProps,T=T.memoizedState,h=c.stateNode;try{var Ft=Za(c.type,b);e=h.getSnapshotBeforeUpdate(Ft,T),h.__reactInternalSnapshotBeforeUpdate=e}catch(he){kt(c,c.return,he)}}break;case 3:if((e&1024)!==0){if(e=a.stateNode.containerInfo,c=e.nodeType,c===9)ep(e);else if(c===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ep(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=a.sibling,e!==null){e.return=a.return,gn=e;break}gn=a.return}}function Fs(e,a,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:tr(e,c),h&4&&Ks(5,c);break;case 1:if(tr(e,c),h&4)if(e=c.stateNode,a===null)try{e.componentDidMount()}catch(k){kt(c,c.return,k)}else{var b=Za(c.type,a.memoizedProps);a=a.memoizedState;try{e.componentDidUpdate(b,a,e.__reactInternalSnapshotBeforeUpdate)}catch(k){kt(c,c.return,k)}}h&64&&Vl(c),h&512&&$a(c,c.return);break;case 3:if(tr(e,c),h&64&&(e=c.updateQueue,e!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{Yd(e,a)}catch(k){kt(c,c.return,k)}}break;case 27:a===null&&h&4&&nu(c);case 26:case 5:tr(e,c),a===null&&h&4&&Rh(c),h&512&&$a(c,c.return);break;case 12:tr(e,c);break;case 31:tr(e,c),h&4&&au(e,c);break;case 13:tr(e,c),h&4&&Js(e,c),h&64&&(e=c.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(c=Wn.bind(null,c),x4(e,c))));break;case 22:if(h=c.memoizedState!==null||Ii,!h){a=a!==null&&a.memoizedState!==null||Ve,b=Ii;var T=Ve;Ii=h,(Ve=a)&&!T?ki(e,c,(c.subtreeFlags&8772)!==0):tr(e,c),Ii=b,Ve=T}break;case 30:break;default:tr(e,c)}}function iu(e){var a=e.alternate;a!==null&&(e.alternate=null,iu(a)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(a=e.stateNode,a!==null&&Tn(a)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ye=null,le=!1;function De(e,a,c){for(c=c.child;c!==null;)jn(e,a,c),c=c.sibling}function jn(e,a,c){if(de&&typeof de.onCommitFiberUnmount=="function")try{de.onCommitFiberUnmount($t,c)}catch{}switch(c.tag){case 26:Ve||Ri(c,a),De(e,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Ve||Ri(c,a);var h=Ye,b=le;Jl(c.type)&&(Ye=c.stateNode,le=!1),De(e,a,c),Uh(c.stateNode),Ye=h,le=b;break;case 5:Ve||Ri(c,a);case 6:if(h=Ye,b=le,Ye=null,De(e,a,c),Ye=h,le=b,Ye!==null)if(le)try{(Ye.nodeType===9?Ye.body:Ye.nodeName==="HTML"?Ye.ownerDocument.body:Ye).removeChild(c.stateNode)}catch(T){kt(c,a,T)}else try{Ye.removeChild(c.stateNode)}catch(T){kt(c,a,T)}break;case 18:Ye!==null&&(le?(e=Ye,Nv(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,c.stateNode),qc(e)):Nv(Ye,c.stateNode));break;case 4:h=Ye,b=le,Ye=c.stateNode.containerInfo,le=!0,De(e,a,c),Ye=h,le=b;break;case 0:case 11:case 14:case 15:ia(2,c,a),Ve||ia(4,c,a),De(e,a,c);break;case 1:Ve||(Ri(c,a),h=c.stateNode,typeof h.componentWillUnmount=="function"&&Nc(c,a,h)),De(e,a,c);break;case 21:De(e,a,c);break;case 22:Ve=(h=Ve)||c.memoizedState!==null,De(e,a,c),Ve=h;break;default:De(e,a,c)}}function au(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{qc(e)}catch(c){kt(a,a.return,c)}}}function Js(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{qc(e)}catch(c){kt(a,a.return,c)}}function Zs(e){switch(e.tag){case 31:case 13:case 19:var a=e.stateNode;return a===null&&(a=e.stateNode=new Dc),a;case 22:return e=e.stateNode,a=e._retryCache,a===null&&(a=e._retryCache=new Dc),a;default:throw Error(i(435,e.tag))}}function Ws(e,a){var c=Zs(e);a.forEach(function(h){if(!c.has(h)){c.add(h);var b=ke.bind(null,e,h);h.then(b,b)}})}function Jn(e,a){var c=a.deletions;if(c!==null)for(var h=0;h<c.length;h++){var b=c[h],T=e,k=a,$=k;t:for(;$!==null;){switch($.tag){case 27:if(Jl($.type)){Ye=$.stateNode,le=!1;break t}break;case 5:Ye=$.stateNode,le=!1;break t;case 3:case 4:Ye=$.stateNode.containerInfo,le=!0;break t}$=$.return}if(Ye===null)throw Error(i(160));jn(T,k,b),Ye=null,le=!1,T=b.alternate,T!==null&&(T.return=null),b.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)T0(a,e),a=a.sibling}var mi=null;function T0(e,a){var c=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Jn(a,e),ui(e),h&4&&(ia(3,e,e.return),Ks(3,e),ia(5,e,e.return));break;case 1:Jn(a,e),ui(e),h&512&&(Ve||c===null||Ri(c,c.return)),h&64&&Ii&&(e=e.updateQueue,e!==null&&(h=e.callbacks,h!==null&&(c=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var b=mi;if(Jn(a,e),ui(e),h&512&&(Ve||c===null||Ri(c,c.return)),h&4){var T=c!==null?c.memoizedState:null;if(h=e.memoizedState,c===null)if(h===null)if(e.stateNode===null){t:{h=e.type,c=e.memoizedProps,b=b.ownerDocument||b;e:switch(h){case"title":T=b.getElementsByTagName("title")[0],(!T||T[ys]||T[kn]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=b.createElement(h),b.head.insertBefore(T,b.querySelector("head > title"))),Mi(T,h,c),T[kn]=e,Qn(T),h=T;break t;case"link":var k=kv("link","href",b).get(h+(c.href||""));if(k){for(var $=0;$<k.length;$++)if(T=k[$],T.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&T.getAttribute("rel")===(c.rel==null?null:c.rel)&&T.getAttribute("title")===(c.title==null?null:c.title)&&T.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice($,1);break e}}T=b.createElement(h),Mi(T,h,c),b.head.appendChild(T);break;case"meta":if(k=kv("meta","content",b).get(h+(c.content||""))){for($=0;$<k.length;$++)if(T=k[$],T.getAttribute("content")===(c.content==null?null:""+c.content)&&T.getAttribute("name")===(c.name==null?null:c.name)&&T.getAttribute("property")===(c.property==null?null:c.property)&&T.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&T.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice($,1);break e}}T=b.createElement(h),Mi(T,h,c),b.head.appendChild(T);break;default:throw Error(i(468,h))}T[kn]=e,Qn(T),h=T}e.stateNode=h}else qv(b,e.type,e.stateNode);else e.stateNode=Iv(b,h,e.memoizedProps);else T!==h?(T===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):T.count--,h===null?qv(b,e.type,e.stateNode):Iv(b,h,e.memoizedProps)):h===null&&e.stateNode!==null&&Mr(e,e.memoizedProps,c.memoizedProps)}break;case 27:Jn(a,e),ui(e),h&512&&(Ve||c===null||Ri(c,c.return)),c!==null&&h&4&&Mr(e,e.memoizedProps,c.memoizedProps);break;case 5:if(Jn(a,e),ui(e),h&512&&(Ve||c===null||Ri(c,c.return)),e.flags&32){b=e.stateNode;try{kr(b,"")}catch(Ft){kt(e,e.return,Ft)}}h&4&&e.stateNode!=null&&(b=e.memoizedProps,Mr(e,b,c!==null?c.memoizedProps:b)),h&1024&&(us=!0);break;case 6:if(Jn(a,e),ui(e),h&4){if(e.stateNode===null)throw Error(i(162));h=e.memoizedProps,c=e.stateNode;try{c.nodeValue=h}catch(Ft){kt(e,e.return,Ft)}}break;case 3:if(D0=null,b=mi,mi=M0(a.containerInfo),Jn(a,e),mi=b,ui(e),h&4&&c!==null&&c.memoizedState.isDehydrated)try{qc(a.containerInfo)}catch(Ft){kt(e,e.return,Ft)}us&&(us=!1,xh(e));break;case 4:h=mi,mi=M0(e.stateNode.containerInfo),Jn(a,e),ui(e),mi=h;break;case 12:Jn(a,e),ui(e);break;case 31:Jn(a,e),ui(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ws(e,h)));break;case 13:Jn(a,e),ui(e),e.child.flags&8192&&e.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Dr=xe()),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ws(e,h)));break;case 22:b=e.memoizedState!==null;var lt=c!==null&&c.memoizedState!==null,St=Ii,Ot=Ve;if(Ii=St||b,Ve=Ot||lt,Jn(a,e),Ve=Ot,Ii=St,ui(e),h&8192)t:for(a=e.stateNode,a._visibility=b?a._visibility&-2:a._visibility|1,b&&(c===null||lt||Ii||Ve||$s(e)),c=null,a=e;;){if(a.tag===5||a.tag===26){if(c===null){lt=c=a;try{if(T=lt.stateNode,b)k=T.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{$=lt.stateNode;var Mt=lt.memoizedProps.style,Et=Mt!=null&&Mt.hasOwnProperty("display")?Mt.display:null;$.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(Ft){kt(lt,lt.return,Ft)}}}else if(a.tag===6){if(c===null){lt=a;try{lt.stateNode.nodeValue=b?"":lt.memoizedProps}catch(Ft){kt(lt,lt.return,Ft)}}}else if(a.tag===18){if(c===null){lt=a;try{var Tt=lt.stateNode;b?Dv(Tt,!0):Dv(lt.stateNode,!1)}catch(Ft){kt(lt,lt.return,Ft)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===e)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break t;for(;a.sibling===null;){if(a.return===null||a.return===e)break t;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=e.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Ws(e,c))));break;case 19:Jn(a,e),ui(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ws(e,h)));break;case 30:break;case 21:break;default:Jn(a,e),ui(e)}}function ui(e){var a=e.flags;if(a&2){try{for(var c,h=e.return;h!==null;){if(C0(h)){c=h;break}h=h.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var b=c.stateNode,T=Qs(e);Xs(e,T,b);break;case 5:var k=c.stateNode;c.flags&32&&(kr(k,""),c.flags&=-33);var $=Qs(e);Xs(e,$,k);break;case 3:case 4:var lt=c.stateNode.containerInfo,St=Qs(e);eu(e,St,lt);break;default:throw Error(i(161))}}catch(Ot){kt(e,e.return,Ot)}e.flags&=-3}a&4096&&(e.flags&=-4097)}function xh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var a=e;xh(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),e=e.sibling}}function tr(e,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Fs(e,a.alternate,a),a=a.sibling}function $s(e){for(e=e.child;e!==null;){var a=e;switch(a.tag){case 0:case 11:case 14:case 15:ia(4,a,a.return),$s(a);break;case 1:Ri(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&Nc(a,a.return,c),$s(a);break;case 27:Uh(a.stateNode);case 26:case 5:Ri(a,a.return),$s(a);break;case 22:a.memoizedState===null&&$s(a);break;case 30:$s(a);break;default:$s(a)}e=e.sibling}}function ki(e,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,b=e,T=a,k=T.flags;switch(T.tag){case 0:case 11:case 15:ki(b,T,c),Ks(4,T);break;case 1:if(ki(b,T,c),h=T,b=h.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(St){kt(h,h.return,St)}if(h=T,b=h.updateQueue,b!==null){var $=h.stateNode;try{var lt=b.shared.hiddenCallbacks;if(lt!==null)for(b.shared.hiddenCallbacks=null,b=0;b<lt.length;b++)eh(lt[b],$)}catch(St){kt(h,h.return,St)}}c&&k&64&&Vl(T),$a(T,T.return);break;case 27:nu(T);case 26:case 5:ki(b,T,c),c&&h===null&&k&4&&Rh(T),$a(T,T.return);break;case 12:ki(b,T,c);break;case 31:ki(b,T,c),c&&k&4&&au(b,T);break;case 13:ki(b,T,c),c&&k&4&&Js(b,T);break;case 22:T.memoizedState===null&&ki(b,T,c),$a(T,T.return);break;case 30:break;default:ki(b,T,c)}a=a.sibling}}function tl(e,a){var c=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(c=e.memoizedState.cachePool.pool),e=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(e=a.memoizedState.cachePool.pool),e!==c&&(e!=null&&e.refCount++,c!=null&&Ul(c))}function cs(e,a){e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&Ul(e))}function ma(e,a,c,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)aa(e,a,c,h),a=a.sibling}function aa(e,a,c,h){var b=a.flags;switch(a.tag){case 0:case 11:case 15:ma(e,a,c,h),b&2048&&Ks(9,a);break;case 1:ma(e,a,c,h);break;case 3:ma(e,a,c,h),b&2048&&(e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&Ul(e)));break;case 12:if(b&2048){ma(e,a,c,h),e=a.stateNode;try{var T=a.memoizedProps,k=T.id,$=T.onPostCommit;typeof $=="function"&&$(k,a.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(lt){kt(a,a.return,lt)}}else ma(e,a,c,h);break;case 31:ma(e,a,c,h);break;case 13:ma(e,a,c,h);break;case 23:break;case 22:T=a.stateNode,k=a.alternate,a.memoizedState!==null?T._visibility&2?ma(e,a,c,h):On(e,a):T._visibility&2?ma(e,a,c,h):(T._visibility|=2,wi(e,a,c,h,(a.subtreeFlags&10256)!==0||!1)),b&2048&&tl(k,a);break;case 24:ma(e,a,c,h),b&2048&&cs(a.alternate,a);break;default:ma(e,a,c,h)}}function wi(e,a,c,h,b){for(b=b&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var T=e,k=a,$=c,lt=h,St=k.flags;switch(k.tag){case 0:case 11:case 15:wi(T,k,$,lt,b),Ks(8,k);break;case 23:break;case 22:var Ot=k.stateNode;k.memoizedState!==null?Ot._visibility&2?wi(T,k,$,lt,b):On(T,k):(Ot._visibility|=2,wi(T,k,$,lt,b)),b&&St&2048&&tl(k.alternate,k);break;case 24:wi(T,k,$,lt,b),b&&St&2048&&cs(k.alternate,k);break;default:wi(T,k,$,lt,b)}a=a.sibling}}function On(e,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=e,h=a,b=h.flags;switch(h.tag){case 22:On(c,h),b&2048&&tl(h.alternate,h);break;case 24:On(c,h),b&2048&&cs(h.alternate,h);break;default:On(c,h)}a=a.sibling}}var el=8192;function nl(e,a,c){if(e.subtreeFlags&el)for(e=e.child;e!==null;)Mh(e,a,c),e=e.sibling}function Mh(e,a,c){switch(e.tag){case 26:nl(e,a,c),e.flags&el&&e.memoizedState!==null&&I4(c,mi,e.memoizedState,e.memoizedProps);break;case 5:nl(e,a,c);break;case 3:case 4:var h=mi;mi=M0(e.stateNode.containerInfo),nl(e,a,c),mi=h;break;case 22:e.memoizedState===null&&(h=e.alternate,h!==null&&h.memoizedState!==null?(h=el,el=16777216,nl(e,a,c),el=h):nl(e,a,c));break;default:nl(e,a,c)}}function Yn(e){var a=e.alternate;if(a!==null&&(e=a.child,e!==null)){a.child=null;do a=e.sibling,e.sibling=null,e=a;while(e!==null)}}function il(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];gn=h,jc(h,e)}Yn(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)er(e),e=e.sibling}function er(e){switch(e.tag){case 0:case 11:case 15:il(e),e.flags&2048&&ia(9,e,e.return);break;case 3:il(e);break;case 12:il(e);break;case 22:var a=e.stateNode;e.memoizedState!==null&&a._visibility&2&&(e.return===null||e.return.tag!==13)?(a._visibility&=-3,bn(e)):il(e);break;default:il(e)}}function bn(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];gn=h,jc(h,e)}Yn(e)}for(e=e.child;e!==null;){switch(a=e,a.tag){case 0:case 11:case 15:ia(8,a,a.return),bn(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,bn(a));break;default:bn(a)}e=e.sibling}}function jc(e,a){for(;gn!==null;){var c=gn;switch(c.tag){case 0:case 11:case 15:ia(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Ul(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,gn=h;else t:for(c=e;gn!==null;){h=gn;var b=h.sibling,T=h.return;if(iu(h),h===c){gn=null;break t}if(b!==null){b.return=T,gn=b;break t}gn=T}}}var A0={getCacheForType:function(e){var a=dn(Ln),c=a.data.get(e);return c===void 0&&(c=e(),a.data.set(e,c)),c},cacheSignal:function(){return dn(Ln).controller.signal}},Zn=typeof WeakMap=="function"?WeakMap:Map,oe=0,Te=null,pe=null,Ee=0,We=0,vi=null,Ma=!1,Nr=!1,Yl=!1,va=0,on=0,fs=0,Ce=0,nn=0,fe=0,Ae=0,Ge=null,un=null,nr=!1,Dr=0,Uc=0,ya=1/0,pn=null,xi=null,mn=0,ir=null,ci=null,qi=0,al=0,yi=null,Bc=null,rl=0,sl=null;function Si(){return(oe&2)!==0&&Ee!==0?Ee&-Ee:j.T!==null?Vg():cr()}function jr(){if(fe===0)if((Ee&536870912)===0||Ne){var e=la;la<<=1,(la&3932160)===0&&(la=262144),fe=e}else fe=536870912;return e=Sn.current,e!==null&&(e.flags|=32),fe}function Ke(e,a,c){(e===Te&&(We===2||We===9)||e.cancelPendingCommit!==null)&&(rr(e,0),ar(e,Ee,fe,!1)),ze(e,c),((oe&2)===0||e!==Te)&&(e===Te&&((oe&2)===0&&(Ce|=c),on===4&&ar(e,Ee,fe,!1)),gs(e))}function Ur(e,a,c){if((oe&6)!==0)throw Error(i(327));var h=!c&&(a&127)===0&&(a&e.expiredLanes)===0||Yt(e,a),b=h?et(e,a):x(e,a,!0),T=h;do{if(b===0){Nr&&!h&&ar(e,a,0,!1);break}else{if(c=e.current.alternate,T&&!Kl(c)){b=x(e,a,!1),T=!1;continue}if(b===2){if(T=a,e.errorRecoveryDisabledLanes&T)var k=0;else k=e.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){a=k;t:{var $=e;b=Ge;var lt=$.current.memoizedState.isDehydrated;if(lt&&(rr($,k).flags|=256),k=x($,k,!1),k!==2){if(Yl&&!lt){$.errorRecoveryDisabledLanes|=T,Ce|=T,b=4;break t}T=un,un=b,T!==null&&(un===null?un=T:un.push.apply(un,T))}b=k}if(T=!1,b!==2)continue}}if(b===1){rr(e,0),ar(e,a,0,!0);break}t:{switch(h=e,T=b,T){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:ar(h,a,fe,!Ma);break t;case 2:un=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(b=Dr+300-xe(),10<b)){if(ar(h,a,fe,!Ma),Ut(h,0,!0)!==0)break t;qi=a,h.timeoutHandle=xv(ll.bind(null,h,c,un,pn,nr,a,fe,Ce,Ae,Ma,T,"Throttled",-0,0),b);break t}ll(h,c,un,pn,nr,a,fe,Ce,Ae,Ma,T,null,-0,0)}}break}while(!0);gs(e)}function ll(e,a,c,h,b,T,k,$,lt,St,Ot,Mt,Et,Tt){if(e.timeoutHandle=-1,Mt=a.subtreeFlags,Mt&8192||(Mt&16785408)===16785408){Mt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ui},Mh(a,T,Mt);var Ft=(T&62914560)===T?Dr-xe():(T&4194048)===T?Uc-xe():0;if(Ft=k4(Mt,Ft),Ft!==null){qi=T,e.cancelPendingCommit=Ft(ve.bind(null,e,a,T,c,h,b,k,$,lt,Ot,Mt,null,Et,Tt)),ar(e,T,k,!St);return}}ve(e,a,T,c,h,b,k,$,lt)}function Kl(e){for(var a=e;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var b=c[h],T=b.getSnapshot;b=b.value;try{if(!ni(T(),b))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ar(e,a,c,h){a&=~nn,a&=~Ce,e.suspendedLanes|=a,e.pingedLanes&=~a,h&&(e.warmLanes|=a),h=e.expirationTimes;for(var b=a;0<b;){var T=31-Je(b),k=1<<T;h[T]=-1,b&=~k}c!==0&&Me(e,c,a)}function Ql(){return(oe&6)===0?(Nh(0),!1):!0}function zc(){if(pe!==null){if(We===0)var e=pe.return;else e=pe,Oa=je=null,rh(e),ts=null,ko=0,e=pe;for(;e!==null;)tu(e.alternate,e),e=e.return;pe=null}}function rr(e,a){var c=e.timeoutHandle;c!==-1&&(e.timeoutHandle=-1,T4(c)),c=e.cancelPendingCommit,c!==null&&(e.cancelPendingCommit=null,c()),qi=0,zc(),Te=e,pe=c=Ea(e.current,null),Ee=a,We=0,vi=null,Ma=!1,Nr=Yt(e,a),Yl=!1,Ae=fe=nn=Ce=fs=on=0,un=Ge=null,nr=!1,(a&8)!==0&&(a|=a&32);var h=e.entangledLanes;if(h!==0)for(e=e.entanglements,h&=a;0<h;){var b=31-Je(h),T=1<<b;a|=e[b],h&=~T}return va=a,Uo(),c}function Lc(e,a){me=null,j.H=Pl,a===Us||a===oc?(a=cc(),We=3):a===Po?(a=cc(),We=4):We=a===Eh?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,vi=a,pe===null&&(on=1,Oc(e,Ji(a,e.current)))}function s(){var e=Sn.current;return e===null?!0:(Ee&4194048)===Ee?ga===null:(Ee&62914560)===Ee||(Ee&536870912)!==0?e===ga:!1}function u(){var e=j.H;return j.H=Pl,e===null?Pl:e}function p(){var e=j.A;return j.A=A0,e}function S(){on=4,Ma||(Ee&4194048)!==Ee&&Sn.current!==null||(Nr=!0),(fs&134217727)===0&&(Ce&134217727)===0||Te===null||ar(Te,Ee,fe,!1)}function x(e,a,c){var h=oe;oe|=2;var b=u(),T=p();(Te!==e||Ee!==a)&&(pn=null,rr(e,a)),a=!1;var k=on;t:do try{if(We!==0&&pe!==null){var $=pe,lt=vi;switch(We){case 8:zc(),k=6;break t;case 3:case 2:case 9:case 6:Sn.current===null&&(a=!0);var St=We;if(We=0,vi=null,zt(e,$,lt,St),c&&Nr){k=0;break t}break;default:St=We,We=0,vi=null,zt(e,$,lt,St)}}H(),k=on;break}catch(Ot){Lc(e,Ot)}while(!0);return a&&e.shellSuspendCounter++,Oa=je=null,oe=h,j.H=b,j.A=T,pe===null&&(Te=null,Ee=0,Uo()),k}function H(){for(;pe!==null;)_t(pe)}function et(e,a){var c=oe;oe|=2;var h=u(),b=p();Te!==e||Ee!==a?(pn=null,ya=xe()+500,rr(e,a)):Nr=Yt(e,a);t:do try{if(We!==0&&pe!==null){a=pe;var T=vi;e:switch(We){case 1:We=0,vi=null,zt(e,a,T,1);break;case 2:case 9:if(_r(T)){We=0,vi=null,Nt(a);break}a=function(){We!==2&&We!==9||Te!==e||(We=7),gs(e)},T.then(a,a);break t;case 3:We=7;break t;case 4:We=5;break t;case 7:_r(T)?(We=0,vi=null,Nt(a)):(We=0,vi=null,zt(e,a,T,7));break;case 5:var k=null;switch(pe.tag){case 26:k=pe.memoizedState;case 5:case 27:var $=pe;if(k?Vv(k):$.stateNode.complete){We=0,vi=null;var lt=$.sibling;if(lt!==null)pe=lt;else{var St=$.return;St!==null?(pe=St,Qt(St)):pe=null}break e}}We=0,vi=null,zt(e,a,T,5);break;case 6:We=0,vi=null,zt(e,a,T,6);break;case 8:zc(),on=6;break t;default:throw Error(i(462))}}ot();break}catch(Ot){Lc(e,Ot)}while(!0);return Oa=je=null,j.H=h,j.A=b,oe=c,pe!==null?0:(Te=null,Ee=0,Uo(),on)}function ot(){for(;pe!==null&&!ae();)_t(pe)}function _t(e){var a=os(e.alternate,e,va);e.memoizedProps=e.pendingProps,a===null?Qt(e):pe=a}function Nt(e){var a=e,c=a.alternate;switch(a.tag){case 15:case 0:a=na(c,a,a.pendingProps,a.type,void 0,Ee);break;case 11:a=na(c,a,a.pendingProps,a.type.render,a.ref,Ee);break;case 5:rh(a);default:tu(c,a),a=pe=$u(a,va),a=os(c,a,va)}e.memoizedProps=e.pendingProps,a===null?Qt(e):pe=a}function zt(e,a,c,h){Oa=je=null,rh(a),ts=null,ko=0;var b=a.return;try{if(_h(e,b,a,c,Ee)){on=1,Oc(e,Ji(c,e.current)),pe=null;return}}catch(T){if(b!==null)throw pe=b,T;on=1,Oc(e,Ji(c,e.current)),pe=null;return}a.flags&32768?(Ne||h===1?e=!0:Nr||(Ee&536870912)!==0?e=!1:(Ma=e=!0,(h===2||h===9||h===3||h===6)&&(h=Sn.current,h!==null&&h.tag===13&&(h.flags|=16384))),Xt(a,e)):Qt(a)}function Qt(e){var a=e;do{if((a.flags&32768)!==0){Xt(a,Ma);return}e=a.return;var c=ql(a.alternate,a,va);if(c!==null){pe=c;return}if(a=a.sibling,a!==null){pe=a;return}pe=a=e}while(a!==null);on===0&&(on=5)}function Xt(e,a){do{var c=Oh(e.alternate,e);if(c!==null){c.flags&=32767,pe=c;return}if(c=e.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(e=e.sibling,e!==null)){pe=e;return}pe=e=c}while(e!==null);on=6,pe=null}function ve(e,a,c,h,b,T,k,$,lt){e.cancelPendingCommit=null;do pt();while(mn!==0);if((oe&6)!==0)throw Error(i(327));if(a!==null){if(a===e.current)throw Error(i(177));if(T=a.lanes|a.childLanes,T|=da,ne(e,c,T,k,$,lt),e===Te&&(pe=Te=null,Ee=0),ci=a,ir=e,qi=c,al=T,yi=b,Bc=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,ds(ct,function(){return Ct(),null})):(e.callbackNode=null,e.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=j.T,j.T=null,b=I.p,I.p=2,k=oe,oe|=4;try{wh(e,a,c)}finally{oe=k,I.p=b,j.T=h}}mn=1,ra(),Xl(),hs()}}function ra(){if(mn===1){mn=0;var e=ir,a=ci,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=j.T,j.T=null;var h=I.p;I.p=2;var b=oe;oe|=4;try{T0(a,e);var T=Wg,k=ba(e.containerInfo),$=T.focusedElem,lt=T.selectionRange;if(k!==$&&$&&$.ownerDocument&&Ol($.ownerDocument.documentElement,$)){if(lt!==null&&Fu($)){var St=lt.start,Ot=lt.end;if(Ot===void 0&&(Ot=St),"selectionStart"in $)$.selectionStart=St,$.selectionEnd=Math.min(Ot,$.value.length);else{var Mt=$.ownerDocument||document,Et=Mt&&Mt.defaultView||window;if(Et.getSelection){var Tt=Et.getSelection(),Ft=$.textContent.length,he=Math.min(lt.start,Ft),fn=lt.end===void 0?he:Math.min(lt.end,Ft);!Tt.extend&&he>fn&&(k=fn,fn=he,he=k);var mt=Gf($,he),ft=Gf($,fn);if(mt&&ft&&(Tt.rangeCount!==1||Tt.anchorNode!==mt.node||Tt.anchorOffset!==mt.offset||Tt.focusNode!==ft.node||Tt.focusOffset!==ft.offset)){var yt=Mt.createRange();yt.setStart(mt.node,mt.offset),Tt.removeAllRanges(),he>fn?(Tt.addRange(yt),Tt.extend(ft.node,ft.offset)):(yt.setEnd(ft.node,ft.offset),Tt.addRange(yt))}}}}for(Mt=[],Tt=$;Tt=Tt.parentNode;)Tt.nodeType===1&&Mt.push({element:Tt,left:Tt.scrollLeft,top:Tt.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<Mt.length;$++){var wt=Mt[$];wt.element.scrollLeft=wt.left,wt.element.scrollTop=wt.top}}z0=!!Zg,Wg=Zg=null}finally{oe=b,I.p=h,j.T=c}}e.current=a,mn=2}}function Xl(){if(mn===2){mn=0;var e=ir,a=ci,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=j.T,j.T=null;var h=I.p;I.p=2;var b=oe;oe|=4;try{Fs(e,a.alternate,a)}finally{oe=b,I.p=h,j.T=c}}mn=3}}function hs(){if(mn===4||mn===3){mn=0,qe();var e=ir,a=ci,c=qi,h=Bc;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?mn=5:(mn=0,ci=ir=null,bt(e,e.pendingLanes));var b=e.pendingLanes;if(b===0&&(xi=null),vs(c),a=a.stateNode,de&&typeof de.onCommitFiberRoot=="function")try{de.onCommitFiberRoot($t,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=j.T,b=I.p,I.p=2,j.T=null;try{for(var T=e.onRecoverableError,k=0;k<h.length;k++){var $=h[k];T($.value,{componentStack:$.stack})}}finally{j.T=a,I.p=b}}(qi&3)!==0&&pt(),gs(e),b=e.pendingLanes,(c&261930)!==0&&(b&42)!==0?e===sl?rl++:(rl=0,sl=e):rl=0,Nh(0)}}function bt(e,a){(e.pooledCacheLanes&=a)===0&&(a=e.pooledCache,a!=null&&(e.pooledCache=null,Ul(a)))}function pt(){return ra(),Xl(),hs(),Ct()}function Ct(){if(mn!==5)return!1;var e=ir,a=al;al=0;var c=vs(qi),h=j.T,b=I.p;try{I.p=32>c?32:c,j.T=null,c=yi,yi=null;var T=ir,k=qi;if(mn=0,ci=ir=null,qi=0,(oe&6)!==0)throw Error(i(331));var $=oe;if(oe|=4,er(T.current),aa(T,T.current,k,c),oe=$,Nh(0,!1),de&&typeof de.onPostCommitFiberRoot=="function")try{de.onPostCommitFiberRoot($t,T)}catch{}return!0}finally{I.p=b,j.T=h,bt(e,a)}}function Lt(e,a,c){a=Ji(c,a),a=ea(e.stateNode,a,2),e=ns(e,a,2),e!==null&&(ze(e,2),gs(e))}function kt(e,a,c){if(e.tag===3)Lt(e,e,c);else for(;a!==null;){if(a.tag===3){Lt(a,e,c);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(xi===null||!xi.has(h))){e=Ji(c,e),c=bh(2),h=ns(a,c,2),h!==null&&(_0(c,h,a,e),ze(h,2),gs(h));break}}a=a.return}}function rn(e,a,c){var h=e.pingCache;if(h===null){h=e.pingCache=new Zn;var b=new Set;h.set(a,b)}else b=h.get(a),b===void 0&&(b=new Set,h.set(a,b));b.has(c)||(Yl=!0,b.add(c),e=ge.bind(null,e,a,c),a.then(e,e))}function ge(e,a,c){var h=e.pingCache;h!==null&&h.delete(a),e.pingedLanes|=e.suspendedLanes&c,e.warmLanes&=~c,Te===e&&(Ee&c)===c&&(on===4||on===3&&(Ee&62914560)===Ee&&300>xe()-Dr?(oe&2)===0&&rr(e,0):nn|=c,Ae===Ee&&(Ae=0)),gs(e)}function He(e,a){a===0&&(a=ce()),e=Fi(e,a),e!==null&&(ze(e,a),gs(e))}function Wn(e){var a=e.memoizedState,c=0;a!==null&&(c=a.retryLane),He(e,c)}function ke(e,a){var c=0;switch(e.tag){case 31:case 13:var h=e.stateNode,b=e.memoizedState;b!==null&&(c=b.retryLane);break;case 19:h=e.stateNode;break;case 22:h=e.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(a),He(e,c)}function ds(e,a){return Be(e,a)}var Gc=null,Hc=null,kg=!1,O0=!1,qg=!1,Fl=0;function gs(e){e!==Hc&&e.next===null&&(Hc===null?Gc=Hc=e:Hc=Hc.next=e),O0=!0,kg||(kg=!0,d4())}function Nh(e,a){if(!qg&&O0){qg=!0;do for(var c=!1,h=Gc;h!==null;){if(e!==0){var b=h.pendingLanes;if(b===0)var T=0;else{var k=h.suspendedLanes,$=h.pingedLanes;T=(1<<31-Je(42|e)+1)-1,T&=b&~(k&~$),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(c=!0,yv(h,T))}else T=Ee,T=Ut(h,h===Te?T:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(T&3)===0||Yt(h,T)||(c=!0,yv(h,T));h=h.next}while(c);qg=!1}}function h4(){pv()}function pv(){O0=kg=!1;var e=0;Fl!==0&&C4()&&(e=Fl);for(var a=xe(),c=null,h=Gc;h!==null;){var b=h.next,T=mv(h,a);T===0?(h.next=null,c===null?Gc=b:c.next=b,b===null&&(Hc=c)):(c=h,(e!==0||(T&3)!==0)&&(O0=!0)),h=b}mn!==0&&mn!==5||Nh(e),Fl!==0&&(Fl=0)}function mv(e,a){for(var c=e.suspendedLanes,h=e.pingedLanes,b=e.expirationTimes,T=e.pendingLanes&-62914561;0<T;){var k=31-Je(T),$=1<<k,lt=b[k];lt===-1?(($&c)===0||($&h)!==0)&&(b[k]=re($,a)):lt<=a&&(e.expiredLanes|=$),T&=~$}if(a=Te,c=Ee,c=Ut(e,e===a?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h=e.callbackNode,c===0||e===a&&(We===2||We===9)||e.cancelPendingCommit!==null)return h!==null&&h!==null&&te(h),e.callbackNode=null,e.callbackPriority=0;if((c&3)===0||Yt(e,c)){if(a=c&-c,a===e.callbackPriority)return a;switch(h!==null&&te(h),vs(c)){case 2:case 8:c=hn;break;case 32:c=ct;break;case 268435456:c=ut;break;default:c=ct}return h=vv.bind(null,e),c=Be(c,h),e.callbackPriority=a,e.callbackNode=c,a}return h!==null&&h!==null&&te(h),e.callbackPriority=2,e.callbackNode=null,2}function vv(e,a){if(mn!==0&&mn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var c=e.callbackNode;if(pt()&&e.callbackNode!==c)return null;var h=Ee;return h=Ut(e,e===Te?h:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h===0?null:(Ur(e,h,a),mv(e,xe()),e.callbackNode!=null&&e.callbackNode===c?vv.bind(null,e):null)}function yv(e,a){if(pt())return null;Ur(e,a,!0)}function d4(){A4(function(){(oe&6)!==0?Be(yn,h4):pv()})}function Vg(){if(Fl===0){var e=Ns;e===0&&(e=Di,Di<<=1,(Di&261888)===0&&(Di=256)),Fl=e}return Fl}function Sv(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:So(""+e)}function bv(e,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,e.id&&c.setAttribute("form",e.id),a.parentNode.insertBefore(c,a),e=new FormData(e),c.parentNode.removeChild(c),e}function g4(e,a,c,h,b){if(a==="submit"&&c&&c.stateNode===b){var T=Sv((b[Kn]||null).action),k=h.submitter;k&&(a=(a=k[Kn]||null)?Sv(a.formAction):k.getAttribute("formAction"),a!==null&&(T=a,k=null));var $=new zu("action","action",null,h,b);e.push({event:$,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Fl!==0){var lt=k?bv(b,k):new FormData(b);Cc(c,{pending:!0,data:lt,method:b.method,action:T},null,lt)}}else typeof T=="function"&&($.preventDefault(),lt=k?bv(b,k):new FormData(b),Cc(c,{pending:!0,data:lt,method:b.method,action:T},T,lt))},currentTarget:b}]})}}for(var Yg=0;Yg<Pa.length;Yg++){var Kg=Pa[Yg],p4=Kg.toLowerCase(),m4=Kg[0].toUpperCase()+Kg.slice(1);ai(p4,"on"+m4)}ai(Zu,"onAnimationEnd"),ai(kf,"onAnimationIteration"),ai(Hd,"onAnimationStart"),ai("dblclick","onDoubleClick"),ai("focusin","onFocus"),ai("focusout","onBlur"),ai(qf,"onTransitionRun"),ai(_i,"onTransitionStart"),ai(Pd,"onTransitionCancel"),ai(Ei,"onTransitionEnd"),qn("onMouseEnter",["mouseout","mouseover"]),qn("onMouseLeave",["mouseout","mouseover"]),qn("onPointerEnter",["pointerout","pointerover"]),qn("onPointerLeave",["pointerout","pointerover"]),hr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),hr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),hr("onBeforeInput",["compositionend","keypress","textInput","paste"]),hr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),hr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),hr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),v4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Dh));function _v(e,a){a=(a&4)!==0;for(var c=0;c<e.length;c++){var h=e[c],b=h.event;h=h.listeners;t:{var T=void 0;if(a)for(var k=h.length-1;0<=k;k--){var $=h[k],lt=$.instance,St=$.currentTarget;if($=$.listener,lt!==T&&b.isPropagationStopped())break t;T=$,b.currentTarget=St;try{T(b)}catch(Ot){_a(Ot)}b.currentTarget=null,T=lt}else for(k=0;k<h.length;k++){if($=h[k],lt=$.instance,St=$.currentTarget,$=$.listener,lt!==T&&b.isPropagationStopped())break t;T=$,b.currentTarget=St;try{T(b)}catch(Ot){_a(Ot)}b.currentTarget=null,T=lt}}}}function Ue(e,a){var c=a[Eu];c===void 0&&(c=a[Eu]=new Set);var h=e+"__bubble";c.has(h)||(Ev(a,e,2,!1),c.add(h))}function Qg(e,a,c){var h=0;a&&(h|=4),Ev(c,e,h,a)}var R0="_reactListening"+Math.random().toString(36).slice(2);function Xg(e){if(!e[R0]){e[R0]=!0,Tu.forEach(function(c){c!=="selectionchange"&&(v4.has(c)||Qg(c,!1,e),Qg(c,!0,e))});var a=e.nodeType===9?e:e.ownerDocument;a===null||a[R0]||(a[R0]=!0,Qg("selectionchange",!1,a))}}function Ev(e,a,c,h){switch(Zv(a)){case 2:var b=Y4;break;case 8:b=K4;break;default:b=up}c=b.bind(null,a,c,e),b=void 0,!ju||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(b=!0),h?b!==void 0?e.addEventListener(a,c,{capture:!0,passive:b}):e.addEventListener(a,c,!0):b!==void 0?e.addEventListener(a,c,{passive:b}):e.addEventListener(a,c,!1)}function Fg(e,a,c,h,b){var T=h;if((a&1)===0&&(a&2)===0&&h!==null)t:for(;;){if(h===null)return;var k=h.tag;if(k===3||k===4){var $=h.stateNode.containerInfo;if($===b)break;if(k===4)for(k=h.return;k!==null;){var lt=k.tag;if((lt===3||lt===4)&&k.stateNode.containerInfo===b)return;k=k.return}for(;$!==null;){if(k=Pr($),k===null)return;if(lt=k.tag,lt===5||lt===6||lt===26||lt===27){h=T=k;continue t}$=$.parentNode}}h=h.return}Of(function(){var St=T,Ot=Nu(c),Mt=[];t:{var Et=Vf.get(e);if(Et!==void 0){var Tt=zu,Ft=e;switch(e){case"keypress":if(bo(c)===0)break t;case"keydown":case"keyup":Tt=Mf;break;case"focusin":Ft="focus",Tt=Hu;break;case"focusout":Ft="blur",Tt=Hu;break;case"beforeblur":case"afterblur":Tt=Hu;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Tt=wf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Tt=Ao;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Tt=ei;break;case Zu:case kf:case Hd:Tt=Yr;break;case Ei:Tt=Nd;break;case"scroll":case"scrollend":Tt=Cd;break;case"wheel":Tt=jd;break;case"copy":case"cut":case"paste":Tt=Kr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Tt=Nf;break;case"toggle":case"beforetoggle":Tt=Pu}var he=(a&4)!==0,fn=!he&&(e==="scroll"||e==="scrollend"),mt=he?Et!==null?Et+"Capture":null:Et;he=[];for(var ft=St,yt;ft!==null;){var wt=ft;if(yt=wt.stateNode,wt=wt.tag,wt!==5&&wt!==26&&wt!==27||yt===null||mt===null||(wt=_l(ft,mt),wt!=null&&he.push(jh(ft,wt,yt))),fn)break;ft=ft.return}0<he.length&&(Et=new Tt(Et,Ft,null,c,Ot),Mt.push({event:Et,listeners:he}))}}if((a&7)===0){t:{if(Et=e==="mouseover"||e==="pointerover",Tt=e==="mouseout"||e==="pointerout",Et&&c!==bl&&(Ft=c.relatedTarget||c.fromElement)&&(Pr(Ft)||Ft[za]))break t;if((Tt||Et)&&(Et=Ot.window===Ot?Ot:(Et=Ot.ownerDocument)?Et.defaultView||Et.parentWindow:window,Tt?(Ft=c.relatedTarget||c.toElement,Tt=St,Ft=Ft?Pr(Ft):null,Ft!==null&&(fn=l(Ft),he=Ft.tag,Ft!==fn||he!==5&&he!==27&&he!==6)&&(Ft=null)):(Tt=null,Ft=St),Tt!==Ft)){if(he=wf,wt="onMouseLeave",mt="onMouseEnter",ft="mouse",(e==="pointerout"||e==="pointerover")&&(he=Nf,wt="onPointerLeave",mt="onPointerEnter",ft="pointer"),fn=Tt==null?Et:vl(Tt),yt=Ft==null?Et:vl(Ft),Et=new he(wt,ft+"leave",Tt,c,Ot),Et.target=fn,Et.relatedTarget=yt,wt=null,Pr(Ot)===St&&(he=new he(mt,ft+"enter",Ft,c,Ot),he.target=yt,he.relatedTarget=fn,wt=he),fn=wt,Tt&&Ft)e:{for(he=y4,mt=Tt,ft=Ft,yt=0,wt=mt;wt;wt=he(wt))yt++;wt=0;for(var ie=ft;ie;ie=he(ie))wt++;for(;0<yt-wt;)mt=he(mt),yt--;for(;0<wt-yt;)ft=he(ft),wt--;for(;yt--;){if(mt===ft||ft!==null&&mt===ft.alternate){he=mt;break e}mt=he(mt),ft=he(ft)}he=null}else he=null;Tt!==null&&Cv(Mt,Et,Tt,he,!1),Ft!==null&&fn!==null&&Cv(Mt,fn,Ft,he,!0)}}t:{if(Et=St?vl(St):window,Tt=Et.nodeName&&Et.nodeName.toLowerCase(),Tt==="select"||Tt==="input"&&Et.type==="file")var Qe=Ku;else if(Ha(Et))if(Bf)Qe=Bg;else{Qe=An;var Zt=Do}else Tt=Et.nodeName,!Tt||Tt.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?St&&Mu(St.elementType)&&(Qe=Ku):Qe=Ug;if(Qe&&(Qe=Qe(e,St))){Yu(Mt,Qe,c,Ot);break t}Zt&&Zt(e,Et,St),e==="focusout"&&St&&Et.type==="number"&&St.memoizedProps.value!=null&&bf(Et,"number",Et.value)}switch(Zt=St?vl(St):window,e){case"focusin":(Ha(Zt)||Zt.contentEditable==="true")&&(Ts=Zt,jo=St,As=null);break;case"focusout":As=jo=Ts=null;break;case"mousedown":Rl=!0;break;case"contextmenu":case"mouseup":case"dragend":Rl=!1,Pf(Mt,c,Ot);break;case"selectionchange":if(Hf)break;case"keydown":case"keyup":Pf(Mt,c,Ot)}var Oe;if(Iu)t:{switch(e){case"compositionstart":var Le="onCompositionStart";break t;case"compositionend":Le="onCompositionEnd";break t;case"compositionupdate":Le="onCompositionUpdate";break t}Le=void 0}else Qr?Vu(e,c)&&(Le="onCompositionEnd"):e==="keydown"&&c.keyCode===229&&(Le="onCompositionStart");Le&&(ku&&c.locale!=="ko"&&(Qr||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&Qr&&(Oe=Rf()):(gr=Ot,Uu="value"in gr?gr.value:gr.textContent,Qr=!0)),Zt=w0(St,Le),0<Zt.length&&(Le=new Oo(Le,e,null,c,Ot),Mt.push({event:Le,listeners:Zt}),Oe?Le.data=Oe:(Oe=Ro(c),Oe!==null&&(Le.data=Oe)))),(Oe=Bd?zd(e,c):Uf(e,c))&&(Le=w0(St,"onBeforeInput"),0<Le.length&&(Zt=new Oo("onBeforeInput","beforeinput",null,c,Ot),Mt.push({event:Zt,listeners:Le}),Zt.data=Oe)),g4(Mt,e,St,c,Ot)}_v(Mt,a)})}function jh(e,a,c){return{instance:e,listener:a,currentTarget:c}}function w0(e,a){for(var c=a+"Capture",h=[];e!==null;){var b=e,T=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||T===null||(b=_l(e,c),b!=null&&h.unshift(jh(e,b,T)),b=_l(e,a),b!=null&&h.push(jh(e,b,T))),e.tag===3)return h;e=e.return}return[]}function y4(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Cv(e,a,c,h,b){for(var T=a._reactName,k=[];c!==null&&c!==h;){var $=c,lt=$.alternate,St=$.stateNode;if($=$.tag,lt!==null&&lt===h)break;$!==5&&$!==26&&$!==27||St===null||(lt=St,b?(St=_l(c,T),St!=null&&k.unshift(jh(c,St,lt))):b||(St=_l(c,T),St!=null&&k.push(jh(c,St,lt)))),c=c.return}k.length!==0&&e.push({event:a,listeners:k})}var S4=/\r\n?/g,b4=/\u0000|\uFFFD/g;function Tv(e){return(typeof e=="string"?e:""+e).replace(S4,`
`).replace(b4,"")}function Av(e,a){return a=Tv(a),Tv(e)===a}function cn(e,a,c,h,b,T){switch(c){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||kr(e,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&kr(e,""+h);break;case"className":ca(e,"class",h);break;case"tabIndex":ca(e,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ca(e,c,h);break;case"style":Tf(e,h,T);break;case"data":if(a!=="object"){ca(e,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||c!=="href")){e.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(c);break}h=So(""+h),e.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){e.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(c==="formAction"?(a!=="input"&&cn(e,a,"name",b.name,b,null),cn(e,a,"formEncType",b.formEncType,b,null),cn(e,a,"formMethod",b.formMethod,b,null),cn(e,a,"formTarget",b.formTarget,b,null)):(cn(e,a,"encType",b.encType,b,null),cn(e,a,"method",b.method,b,null),cn(e,a,"target",b.target,b,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(c);break}h=So(""+h),e.setAttribute(c,h);break;case"onClick":h!=null&&(e.onclick=Ui);break;case"onScroll":h!=null&&Ue("scroll",e);break;case"onScrollEnd":h!=null&&Ue("scrollend",e);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(b.children!=null)throw Error(i(60));e.innerHTML=c}}break;case"multiple":e.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":e.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){e.removeAttribute("xlink:href");break}c=So(""+h),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,""+h):e.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,""):e.removeAttribute(c);break;case"capture":case"download":h===!0?e.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(c,h):e.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?e.setAttribute(c,h):e.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?e.removeAttribute(c):e.setAttribute(c,h);break;case"popover":Ue("beforetoggle",e),Ue("toggle",e),Sl(e,"popover",h);break;case"xlinkActuate":fa(e,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":fa(e,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":fa(e,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":fa(e,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":fa(e,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":fa(e,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":fa(e,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":fa(e,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":fa(e,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Sl(e,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Ed.get(c)||c,Sl(e,c,h))}}function Jg(e,a,c,h,b,T){switch(c){case"style":Tf(e,h,T);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(b.children!=null)throw Error(i(60));e.innerHTML=c}}break;case"children":typeof h=="string"?kr(e,h):(typeof h=="number"||typeof h=="bigint")&&kr(e,""+h);break;case"onScroll":h!=null&&Ue("scroll",e);break;case"onScrollEnd":h!=null&&Ue("scrollend",e);break;case"onClick":h!=null&&(e.onclick=Ui);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Au.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(b=c.endsWith("Capture"),a=c.slice(2,b?c.length-7:void 0),T=e[Kn]||null,T=T!=null?T[c]:null,typeof T=="function"&&e.removeEventListener(a,T,b),typeof h=="function")){typeof T!="function"&&T!==null&&(c in e?e[c]=null:e.hasAttribute(c)&&e.removeAttribute(c)),e.addEventListener(a,h,b);break t}c in e?e[c]=h:h===!0?e.setAttribute(c,""):Sl(e,c,h)}}}function Mi(e,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ue("error",e),Ue("load",e);var h=!1,b=!1,T;for(T in c)if(c.hasOwnProperty(T)){var k=c[T];if(k!=null)switch(T){case"src":h=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:cn(e,a,T,k,c,null)}}b&&cn(e,a,"srcSet",c.srcSet,c,null),h&&cn(e,a,"src",c.src,c,null);return;case"input":Ue("invalid",e);var $=T=k=b=null,lt=null,St=null;for(h in c)if(c.hasOwnProperty(h)){var Ot=c[h];if(Ot!=null)switch(h){case"name":b=Ot;break;case"type":k=Ot;break;case"checked":lt=Ot;break;case"defaultChecked":St=Ot;break;case"value":T=Ot;break;case"defaultValue":$=Ot;break;case"children":case"dangerouslySetInnerHTML":if(Ot!=null)throw Error(i(137,a));break;default:cn(e,a,h,Ot,c,null)}}Sf(e,T,$,lt,St,k,b,!1);return;case"select":Ue("invalid",e),h=k=T=null;for(b in c)if(c.hasOwnProperty(b)&&($=c[b],$!=null))switch(b){case"value":T=$;break;case"defaultValue":k=$;break;case"multiple":h=$;default:cn(e,a,b,$,c,null)}a=T,c=k,e.multiple=!!h,a!=null?bs(e,!!h,a,!1):c!=null&&bs(e,!!h,c,!0);return;case"textarea":Ue("invalid",e),T=b=h=null;for(k in c)if(c.hasOwnProperty(k)&&($=c[k],$!=null))switch(k){case"value":h=$;break;case"defaultValue":b=$;break;case"children":T=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(i(91));break;default:cn(e,a,k,$,c,null)}Ef(e,h,b,T);return;case"option":for(lt in c)if(c.hasOwnProperty(lt)&&(h=c[lt],h!=null))switch(lt){case"selected":e.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:cn(e,a,lt,h,c,null)}return;case"dialog":Ue("beforetoggle",e),Ue("toggle",e),Ue("cancel",e),Ue("close",e);break;case"iframe":case"object":Ue("load",e);break;case"video":case"audio":for(h=0;h<Dh.length;h++)Ue(Dh[h],e);break;case"image":Ue("error",e),Ue("load",e);break;case"details":Ue("toggle",e);break;case"embed":case"source":case"link":Ue("error",e),Ue("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(St in c)if(c.hasOwnProperty(St)&&(h=c[St],h!=null))switch(St){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:cn(e,a,St,h,c,null)}return;default:if(Mu(a)){for(Ot in c)c.hasOwnProperty(Ot)&&(h=c[Ot],h!==void 0&&Jg(e,a,Ot,h,c,void 0));return}}for($ in c)c.hasOwnProperty($)&&(h=c[$],h!=null&&cn(e,a,$,h,c,null))}function _4(e,a,c,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,T=null,k=null,$=null,lt=null,St=null,Ot=null;for(Tt in c){var Mt=c[Tt];if(c.hasOwnProperty(Tt)&&Mt!=null)switch(Tt){case"checked":break;case"value":break;case"defaultValue":lt=Mt;default:h.hasOwnProperty(Tt)||cn(e,a,Tt,null,h,Mt)}}for(var Et in h){var Tt=h[Et];if(Mt=c[Et],h.hasOwnProperty(Et)&&(Tt!=null||Mt!=null))switch(Et){case"type":T=Tt;break;case"name":b=Tt;break;case"checked":St=Tt;break;case"defaultChecked":Ot=Tt;break;case"value":k=Tt;break;case"defaultValue":$=Tt;break;case"children":case"dangerouslySetInnerHTML":if(Tt!=null)throw Error(i(137,a));break;default:Tt!==Mt&&cn(e,a,Et,Tt,h,Mt)}}yo(e,k,$,lt,St,Ot,T,b);return;case"select":Tt=k=$=Et=null;for(T in c)if(lt=c[T],c.hasOwnProperty(T)&&lt!=null)switch(T){case"value":break;case"multiple":Tt=lt;default:h.hasOwnProperty(T)||cn(e,a,T,null,h,lt)}for(b in h)if(T=h[b],lt=c[b],h.hasOwnProperty(b)&&(T!=null||lt!=null))switch(b){case"value":Et=T;break;case"defaultValue":$=T;break;case"multiple":k=T;default:T!==lt&&cn(e,a,b,T,h,lt)}a=$,c=k,h=Tt,Et!=null?bs(e,!!c,Et,!1):!!h!=!!c&&(a!=null?bs(e,!!c,a,!0):bs(e,!!c,c?[]:"",!1));return;case"textarea":Tt=Et=null;for($ in c)if(b=c[$],c.hasOwnProperty($)&&b!=null&&!h.hasOwnProperty($))switch($){case"value":break;case"children":break;default:cn(e,a,$,null,h,b)}for(k in h)if(b=h[k],T=c[k],h.hasOwnProperty(k)&&(b!=null||T!=null))switch(k){case"value":Et=b;break;case"defaultValue":Tt=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(i(91));break;default:b!==T&&cn(e,a,k,b,h,T)}_f(e,Et,Tt);return;case"option":for(var Ft in c)if(Et=c[Ft],c.hasOwnProperty(Ft)&&Et!=null&&!h.hasOwnProperty(Ft))switch(Ft){case"selected":e.selected=!1;break;default:cn(e,a,Ft,null,h,Et)}for(lt in h)if(Et=h[lt],Tt=c[lt],h.hasOwnProperty(lt)&&Et!==Tt&&(Et!=null||Tt!=null))switch(lt){case"selected":e.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:cn(e,a,lt,Et,h,Tt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var he in c)Et=c[he],c.hasOwnProperty(he)&&Et!=null&&!h.hasOwnProperty(he)&&cn(e,a,he,null,h,Et);for(St in h)if(Et=h[St],Tt=c[St],h.hasOwnProperty(St)&&Et!==Tt&&(Et!=null||Tt!=null))switch(St){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(i(137,a));break;default:cn(e,a,St,Et,h,Tt)}return;default:if(Mu(a)){for(var fn in c)Et=c[fn],c.hasOwnProperty(fn)&&Et!==void 0&&!h.hasOwnProperty(fn)&&Jg(e,a,fn,void 0,h,Et);for(Ot in h)Et=h[Ot],Tt=c[Ot],!h.hasOwnProperty(Ot)||Et===Tt||Et===void 0&&Tt===void 0||Jg(e,a,Ot,Et,h,Tt);return}}for(var mt in c)Et=c[mt],c.hasOwnProperty(mt)&&Et!=null&&!h.hasOwnProperty(mt)&&cn(e,a,mt,null,h,Et);for(Mt in h)Et=h[Mt],Tt=c[Mt],!h.hasOwnProperty(Mt)||Et===Tt||Et==null&&Tt==null||cn(e,a,Mt,Et,h,Tt)}function Ov(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function E4(){if(typeof performance.getEntriesByType=="function"){for(var e=0,a=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var b=c[h],T=b.transferSize,k=b.initiatorType,$=b.duration;if(T&&$&&Ov(k)){for(k=0,$=b.responseEnd,h+=1;h<c.length;h++){var lt=c[h],St=lt.startTime;if(St>$)break;var Ot=lt.transferSize,Mt=lt.initiatorType;Ot&&Ov(Mt)&&(lt=lt.responseEnd,k+=Ot*(lt<$?1:($-St)/(lt-St)))}if(--h,a+=8*(T+k)/(b.duration/1e3),e++,10<e)break}}if(0<e)return a/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Zg=null,Wg=null;function x0(e){return e.nodeType===9?e:e.ownerDocument}function Rv(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wv(e,a){if(e===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&a==="foreignObject"?0:e}function $g(e,a){return e==="textarea"||e==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var tp=null;function C4(){var e=window.event;return e&&e.type==="popstate"?e===tp?!1:(tp=e,!0):(tp=null,!1)}var xv=typeof setTimeout=="function"?setTimeout:void 0,T4=typeof clearTimeout=="function"?clearTimeout:void 0,Mv=typeof Promise=="function"?Promise:void 0,A4=typeof queueMicrotask=="function"?queueMicrotask:typeof Mv<"u"?function(e){return Mv.resolve(null).then(e).catch(O4)}:xv;function O4(e){setTimeout(function(){throw e})}function Jl(e){return e==="head"}function Nv(e,a){var c=a,h=0;do{var b=c.nextSibling;if(e.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"||c==="/&"){if(h===0){e.removeChild(b),qc(a);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")Uh(e.ownerDocument.documentElement);else if(c==="head"){c=e.ownerDocument.head,Uh(c);for(var T=c.firstChild;T;){var k=T.nextSibling,$=T.nodeName;T[ys]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&T.rel.toLowerCase()==="stylesheet"||c.removeChild(T),T=k}}else c==="body"&&Uh(e.ownerDocument.body);c=b}while(c);qc(a)}function Dv(e,a){var c=e;e=0;do{var h=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(e===0)break;e--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||e++;c=h}while(c)}function ep(e){var a=e.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":ep(c),Tn(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}e.removeChild(c)}}function R4(e,a,c,h){for(;e.nodeType===1;){var b=c;if(e.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(h){if(!e[ys])switch(a){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(T=e.getAttribute("rel"),T==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(T!==b.rel||e.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||e.getAttribute("title")!==(b.title==null?null:b.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(T=e.getAttribute("src"),(T!==(b.src==null?null:b.src)||e.getAttribute("type")!==(b.type==null?null:b.type)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&T&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(a==="input"&&e.type==="hidden"){var T=b.name==null?null:""+b.name;if(b.type==="hidden"&&e.getAttribute("name")===T)return e}else return e;if(e=sr(e.nextSibling),e===null)break}return null}function w4(e,a,c){if(a==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!c||(e=sr(e.nextSibling),e===null))return null;return e}function jv(e,a){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=sr(e.nextSibling),e===null))return null;return e}function np(e){return e.data==="$?"||e.data==="$~"}function ip(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function x4(e,a){var c=e.ownerDocument;if(e.data==="$~")e._reactRetry=a;else if(e.data!=="$?"||c.readyState!=="loading")a();else{var h=function(){a(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),e._reactRetry=h}}function sr(e){for(;e!=null;e=e.nextSibling){var a=e.nodeType;if(a===1||a===3)break;if(a===8){if(a=e.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return e}var ap=null;function Uv(e){e=e.nextSibling;for(var a=0;e;){if(e.nodeType===8){var c=e.data;if(c==="/$"||c==="/&"){if(a===0)return sr(e.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}e=e.nextSibling}return null}function Bv(e){e=e.previousSibling;for(var a=0;e;){if(e.nodeType===8){var c=e.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return e;a--}else c!=="/$"&&c!=="/&"||a++}e=e.previousSibling}return null}function zv(e,a,c){switch(a=x0(c),e){case"html":if(e=a.documentElement,!e)throw Error(i(452));return e;case"head":if(e=a.head,!e)throw Error(i(453));return e;case"body":if(e=a.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Uh(e){for(var a=e.attributes;a.length;)e.removeAttributeNode(a[0]);Tn(e)}var lr=new Map,Lv=new Set;function M0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ol=I.d;I.d={f:M4,r:N4,D:D4,C:j4,L:U4,m:B4,X:L4,S:z4,M:G4};function M4(){var e=ol.f(),a=Ql();return e||a}function N4(e){var a=Ir(e);a!==null&&a.tag===5&&a.type==="form"?p0(a):ol.r(e)}var Pc=typeof document>"u"?null:document;function Gv(e,a,c){var h=Pc;if(h&&typeof a=="string"&&a){var b=Qi(a);b='link[rel="'+e+'"][href="'+b+'"]',typeof c=="string"&&(b+='[crossorigin="'+c+'"]'),Lv.has(b)||(Lv.add(b),e={rel:e,crossOrigin:c,href:a},h.querySelector(b)===null&&(a=h.createElement("link"),Mi(a,"link",e),Qn(a),h.head.appendChild(a)))}}function D4(e){ol.D(e),Gv("dns-prefetch",e,null)}function j4(e,a){ol.C(e,a),Gv("preconnect",e,a)}function U4(e,a,c){ol.L(e,a,c);var h=Pc;if(h&&e&&a){var b='link[rel="preload"][as="'+Qi(a)+'"]';a==="image"&&c&&c.imageSrcSet?(b+='[imagesrcset="'+Qi(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(b+='[imagesizes="'+Qi(c.imageSizes)+'"]')):b+='[href="'+Qi(e)+'"]';var T=b;switch(a){case"style":T=Ic(e);break;case"script":T=kc(e)}lr.has(T)||(e=C({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:e,as:a},c),lr.set(T,e),h.querySelector(b)!==null||a==="style"&&h.querySelector(Bh(T))||a==="script"&&h.querySelector(zh(T))||(a=h.createElement("link"),Mi(a,"link",e),Qn(a),h.head.appendChild(a)))}}function B4(e,a){ol.m(e,a);var c=Pc;if(c&&e){var h=a&&typeof a.as=="string"?a.as:"script",b='link[rel="modulepreload"][as="'+Qi(h)+'"][href="'+Qi(e)+'"]',T=b;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=kc(e)}if(!lr.has(T)&&(e=C({rel:"modulepreload",href:e},a),lr.set(T,e),c.querySelector(b)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(zh(T)))return}h=c.createElement("link"),Mi(h,"link",e),Qn(h),c.head.appendChild(h)}}}function z4(e,a,c){ol.S(e,a,c);var h=Pc;if(h&&e){var b=Ss(h).hoistableStyles,T=Ic(e);a=a||"default";var k=b.get(T);if(!k){var $={loading:0,preload:null};if(k=h.querySelector(Bh(T)))$.loading=5;else{e=C({rel:"stylesheet",href:e,"data-precedence":a},c),(c=lr.get(T))&&rp(e,c);var lt=k=h.createElement("link");Qn(lt),Mi(lt,"link",e),lt._p=new Promise(function(St,Ot){lt.onload=St,lt.onerror=Ot}),lt.addEventListener("load",function(){$.loading|=1}),lt.addEventListener("error",function(){$.loading|=2}),$.loading|=4,N0(k,a,h)}k={type:"stylesheet",instance:k,count:1,state:$},b.set(T,k)}}}function L4(e,a){ol.X(e,a);var c=Pc;if(c&&e){var h=Ss(c).hoistableScripts,b=kc(e),T=h.get(b);T||(T=c.querySelector(zh(b)),T||(e=C({src:e,async:!0},a),(a=lr.get(b))&&sp(e,a),T=c.createElement("script"),Qn(T),Mi(T,"link",e),c.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(b,T))}}function G4(e,a){ol.M(e,a);var c=Pc;if(c&&e){var h=Ss(c).hoistableScripts,b=kc(e),T=h.get(b);T||(T=c.querySelector(zh(b)),T||(e=C({src:e,async:!0,type:"module"},a),(a=lr.get(b))&&sp(e,a),T=c.createElement("script"),Qn(T),Mi(T,"link",e),c.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(b,T))}}function Hv(e,a,c,h){var b=(b=tt.current)?M0(b):null;if(!b)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=Ic(c.href),c=Ss(b).hoistableStyles,h=c.get(a),h||(h={type:"style",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){e=Ic(c.href);var T=Ss(b).hoistableStyles,k=T.get(e);if(k||(b=b.ownerDocument||b,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(e,k),(T=b.querySelector(Bh(e)))&&!T._p&&(k.instance=T,k.state.loading=5),lr.has(e)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},lr.set(e,c),T||H4(b,e,c,k.state))),a&&h===null)throw Error(i(528,""));return k}if(a&&h!==null)throw Error(i(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=kc(c),c=Ss(b).hoistableScripts,h=c.get(a),h||(h={type:"script",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Ic(e){return'href="'+Qi(e)+'"'}function Bh(e){return'link[rel="stylesheet"]['+e+"]"}function Pv(e){return C({},e,{"data-precedence":e.precedence,precedence:null})}function H4(e,a,c,h){e.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=e.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),Mi(a,"link",c),Qn(a),e.head.appendChild(a))}function kc(e){return'[src="'+Qi(e)+'"]'}function zh(e){return"script[async]"+e}function Iv(e,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var h=e.querySelector('style[data-href~="'+Qi(c.href)+'"]');if(h)return a.instance=h,Qn(h),h;var b=C({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(e.ownerDocument||e).createElement("style"),Qn(h),Mi(h,"style",b),N0(h,c.precedence,e),a.instance=h;case"stylesheet":b=Ic(c.href);var T=e.querySelector(Bh(b));if(T)return a.state.loading|=4,a.instance=T,Qn(T),T;h=Pv(c),(b=lr.get(b))&&rp(h,b),T=(e.ownerDocument||e).createElement("link"),Qn(T);var k=T;return k._p=new Promise(function($,lt){k.onload=$,k.onerror=lt}),Mi(T,"link",h),a.state.loading|=4,N0(T,c.precedence,e),a.instance=T;case"script":return T=kc(c.src),(b=e.querySelector(zh(T)))?(a.instance=b,Qn(b),b):(h=c,(b=lr.get(T))&&(h=C({},c),sp(h,b)),e=e.ownerDocument||e,b=e.createElement("script"),Qn(b),Mi(b,"link",h),e.head.appendChild(b),a.instance=b);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,N0(h,c.precedence,e));return a.instance}function N0(e,a,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=h.length?h[h.length-1]:null,T=b,k=0;k<h.length;k++){var $=h[k];if($.dataset.precedence===a)T=$;else if(T!==b)break}T?T.parentNode.insertBefore(e,T.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(e,a.firstChild))}function rp(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.title==null&&(e.title=a.title)}function sp(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.integrity==null&&(e.integrity=a.integrity)}var D0=null;function kv(e,a,c){if(D0===null){var h=new Map,b=D0=new Map;b.set(c,h)}else b=D0,h=b.get(c),h||(h=new Map,b.set(c,h));if(h.has(e))return h;for(h.set(e,null),c=c.getElementsByTagName(e),b=0;b<c.length;b++){var T=c[b];if(!(T[ys]||T[kn]||e==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var k=T.getAttribute(a)||"";k=e+k;var $=h.get(k);$?$.push(T):h.set(k,[T])}}return h}function qv(e,a,c){e=e.ownerDocument||e,e.head.insertBefore(c,a==="title"?e.querySelector("head > title"):null)}function P4(e,a,c){if(c===1||a.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return e=a.disabled,typeof a.precedence=="string"&&e==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Vv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function I4(e,a,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var b=Ic(h.href),T=a.querySelector(Bh(b));if(T){a=T._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(e.count++,e=j0.bind(e),a.then(e,e)),c.state.loading|=4,c.instance=T,Qn(T);return}T=a.ownerDocument||a,h=Pv(h),(b=lr.get(b))&&rp(h,b),T=T.createElement("link"),Qn(T);var k=T;k._p=new Promise(function($,lt){k.onload=$,k.onerror=lt}),Mi(T,"link",h),c.instance=T}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(e.count++,c=j0.bind(e),a.addEventListener("load",c),a.addEventListener("error",c))}}var lp=0;function k4(e,a){return e.stylesheets&&e.count===0&&B0(e,e.stylesheets),0<e.count||0<e.imgCount?function(c){var h=setTimeout(function(){if(e.stylesheets&&B0(e,e.stylesheets),e.unsuspend){var T=e.unsuspend;e.unsuspend=null,T()}},6e4+a);0<e.imgBytes&&lp===0&&(lp=62500*E4());var b=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&B0(e,e.stylesheets),e.unsuspend)){var T=e.unsuspend;e.unsuspend=null,T()}},(e.imgBytes>lp?50:800)+a);return e.unsuspend=c,function(){e.unsuspend=null,clearTimeout(h),clearTimeout(b)}}:null}function j0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)B0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var U0=null;function B0(e,a){e.stylesheets=null,e.unsuspend!==null&&(e.count++,U0=new Map,a.forEach(q4,e),U0=null,j0.call(e))}function q4(e,a){if(!(a.state.loading&4)){var c=U0.get(e);if(c)var h=c.get(null);else{c=new Map,U0.set(e,c);for(var b=e.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<b.length;T++){var k=b[T];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),h=k)}h&&c.set(null,h)}b=a.instance,k=b.getAttribute("data-precedence"),T=c.get(k)||h,T===h&&c.set(null,b),c.set(k,b),this.count++,h=j0.bind(this),b.addEventListener("load",h),b.addEventListener("error",h),T?T.parentNode.insertBefore(b,T.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(b,e.firstChild)),a.state.loading|=4}}var Lh={$$typeof:M,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function V4(e,a,c,h,b,T,k,$,lt){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ht(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ht(0),this.hiddenUpdates=Ht(null),this.identifierPrefix=h,this.onUncaughtError=b,this.onCaughtError=T,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=lt,this.incompleteTransitions=new Map}function Yv(e,a,c,h,b,T,k,$,lt,St,Ot,Mt){return e=new V4(e,a,c,k,lt,St,Ot,Mt,$),a=1,T===!0&&(a|=24),T=pi(3,null,null,a),e.current=T,T.stateNode=e,a=rc(),a.refCount++,e.pooledCache=a,a.refCount++,T.memoizedState={element:h,isDehydrated:c,cache:a},Ls(T),e}function Kv(e){return e?(e=Ia,e):Ia}function Qv(e,a,c,h,b,T){b=Kv(b),h.context===null?h.context=b:h.pendingContext=b,h=es(a),h.payload={element:c},T=T===void 0?null:T,T!==null&&(h.callback=T),c=ns(e,h,a),c!==null&&(Ke(c,e,a),Yo(c,e,a))}function Xv(e,a){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var c=e.retryLane;e.retryLane=c!==0&&c<a?c:a}}function op(e,a){Xv(e,a),(e=e.alternate)&&Xv(e,a)}function Fv(e){if(e.tag===13||e.tag===31){var a=Fi(e,67108864);a!==null&&Ke(a,e,67108864),op(e,67108864)}}function Jv(e){if(e.tag===13||e.tag===31){var a=Si();a=oa(a);var c=Fi(e,a);c!==null&&Ke(c,e,a),op(e,a)}}var z0=!0;function Y4(e,a,c,h){var b=j.T;j.T=null;var T=I.p;try{I.p=2,up(e,a,c,h)}finally{I.p=T,j.T=b}}function K4(e,a,c,h){var b=j.T;j.T=null;var T=I.p;try{I.p=8,up(e,a,c,h)}finally{I.p=T,j.T=b}}function up(e,a,c,h){if(z0){var b=cp(h);if(b===null)Fg(e,a,h,L0,c),Wv(e,h);else if(X4(b,e,a,c,h))h.stopPropagation();else if(Wv(e,h),a&4&&-1<Q4.indexOf(e)){for(;b!==null;){var T=Ir(b);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var k=Sa(T.pendingLanes);if(k!==0){var $=T;for($.pendingLanes|=2,$.entangledLanes|=2;k;){var lt=1<<31-Je(k);$.entanglements[1]|=lt,k&=~lt}gs(T),(oe&6)===0&&(ya=xe()+500,Nh(0))}}break;case 31:case 13:$=Fi(T,2),$!==null&&Ke($,T,2),Ql(),op(T,2)}if(T=cp(h),T===null&&Fg(e,a,h,L0,c),T===b)break;b=T}b!==null&&h.stopPropagation()}else Fg(e,a,h,null,c)}}function cp(e){return e=Nu(e),fp(e)}var L0=null;function fp(e){if(L0=null,e=Pr(e),e!==null){var a=l(e);if(a===null)e=null;else{var c=a.tag;if(c===13){if(e=f(a),e!==null)return e;e=null}else if(c===31){if(e=d(a),e!==null)return e;e=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;e=null}else a!==e&&(e=null)}}return L0=e,null}function Zv(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(an()){case yn:return 2;case hn:return 8;case ct:case ht:return 32;case ut:return 268435456;default:return 32}default:return 32}}var hp=!1,Zl=null,Wl=null,$l=null,Gh=new Map,Hh=new Map,to=[],Q4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Wv(e,a){switch(e){case"focusin":case"focusout":Zl=null;break;case"dragenter":case"dragleave":Wl=null;break;case"mouseover":case"mouseout":$l=null;break;case"pointerover":case"pointerout":Gh.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hh.delete(a.pointerId)}}function Ph(e,a,c,h,b,T){return e===null||e.nativeEvent!==T?(e={blockedOn:a,domEventName:c,eventSystemFlags:h,nativeEvent:T,targetContainers:[b]},a!==null&&(a=Ir(a),a!==null&&Fv(a)),e):(e.eventSystemFlags|=h,a=e.targetContainers,b!==null&&a.indexOf(b)===-1&&a.push(b),e)}function X4(e,a,c,h,b){switch(a){case"focusin":return Zl=Ph(Zl,e,a,c,h,b),!0;case"dragenter":return Wl=Ph(Wl,e,a,c,h,b),!0;case"mouseover":return $l=Ph($l,e,a,c,h,b),!0;case"pointerover":var T=b.pointerId;return Gh.set(T,Ph(Gh.get(T)||null,e,a,c,h,b)),!0;case"gotpointercapture":return T=b.pointerId,Hh.set(T,Ph(Hh.get(T)||null,e,a,c,h,b)),!0}return!1}function $v(e){var a=Pr(e.target);if(a!==null){var c=l(a);if(c!==null){if(a=c.tag,a===13){if(a=f(c),a!==null){e.blockedOn=a,fr(e.priority,function(){Jv(c)});return}}else if(a===31){if(a=d(c),a!==null){e.blockedOn=a,fr(e.priority,function(){Jv(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){e.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}e.blockedOn=null}function G0(e){if(e.blockedOn!==null)return!1;for(var a=e.targetContainers;0<a.length;){var c=cp(e.nativeEvent);if(c===null){c=e.nativeEvent;var h=new c.constructor(c.type,c);bl=h,c.target.dispatchEvent(h),bl=null}else return a=Ir(c),a!==null&&Fv(a),e.blockedOn=c,!1;a.shift()}return!0}function t1(e,a,c){G0(e)&&c.delete(a)}function F4(){hp=!1,Zl!==null&&G0(Zl)&&(Zl=null),Wl!==null&&G0(Wl)&&(Wl=null),$l!==null&&G0($l)&&($l=null),Gh.forEach(t1),Hh.forEach(t1)}function H0(e,a){e.blockedOn===a&&(e.blockedOn=null,hp||(hp=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,F4)))}var P0=null;function e1(e){P0!==e&&(P0=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){P0===e&&(P0=null);for(var a=0;a<e.length;a+=3){var c=e[a],h=e[a+1],b=e[a+2];if(typeof h!="function"){if(fp(h||c)===null)continue;break}var T=Ir(c);T!==null&&(e.splice(a,3),a-=3,Cc(T,{pending:!0,data:b,method:c.method,action:h},h,b))}}))}function qc(e){function a(lt){return H0(lt,e)}Zl!==null&&H0(Zl,e),Wl!==null&&H0(Wl,e),$l!==null&&H0($l,e),Gh.forEach(a),Hh.forEach(a);for(var c=0;c<to.length;c++){var h=to[c];h.blockedOn===e&&(h.blockedOn=null)}for(;0<to.length&&(c=to[0],c.blockedOn===null);)$v(c),c.blockedOn===null&&to.shift();if(c=(e.ownerDocument||e).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var b=c[h],T=c[h+1],k=b[Kn]||null;if(typeof T=="function")k||e1(c);else if(k){var $=null;if(T&&T.hasAttribute("formAction")){if(b=T,k=T[Kn]||null)$=k.formAction;else if(fp(b)!==null)continue}else $=k.action;typeof $=="function"?c[h+1]=$:(c.splice(h,3),h-=3),e1(c)}}}function n1(){function e(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(k){return b=k})},focusReset:"manual",scroll:"manual"})}function a(){b!==null&&(b(),b=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,b=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),b!==null&&(b(),b=null)}}}function dp(e){this._internalRoot=e}I0.prototype.render=dp.prototype.render=function(e){var a=this._internalRoot;if(a===null)throw Error(i(409));var c=a.current,h=Si();Qv(c,h,e,a,null,null)},I0.prototype.unmount=dp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var a=e.containerInfo;Qv(e.current,2,null,e,null,null),Ql(),a[za]=null}};function I0(e){this._internalRoot=e}I0.prototype.unstable_scheduleHydration=function(e){if(e){var a=cr();e={blockedOn:null,target:e,priority:a};for(var c=0;c<to.length&&a!==0&&a<to[c].priority;c++);to.splice(c,0,e),c===0&&$v(e)}};var i1=t.version;if(i1!=="19.2.0")throw Error(i(527,i1,"19.2.0"));I.findDOMNode=function(e){var a=e._reactInternals;if(a===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(a),e=e!==null?_(e):null,e=e===null?null:e.stateNode,e};var J4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var k0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!k0.isDisabled&&k0.supportsFiber)try{$t=k0.inject(J4),de=k0}catch{}}return kh.createRoot=function(e,a){if(!r(e))throw Error(i(299));var c=!1,h="",b=Wo,T=$o,k=Ac;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(b=a.onUncaughtError),a.onCaughtError!==void 0&&(T=a.onCaughtError),a.onRecoverableError!==void 0&&(k=a.onRecoverableError)),a=Yv(e,1,!1,null,null,c,h,null,b,T,k,n1),e[za]=a.current,Xg(e),new dp(a)},kh.hydrateRoot=function(e,a,c){if(!r(e))throw Error(i(299));var h=!1,b="",T=Wo,k=$o,$=Ac,lt=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(b=c.identifierPrefix),c.onUncaughtError!==void 0&&(T=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&($=c.onRecoverableError),c.formState!==void 0&&(lt=c.formState)),a=Yv(e,1,!0,a,c??null,h,b,lt,T,k,$,n1),a.context=Kv(null),c=a.current,h=Si(),h=oa(h),b=es(h),b.callback=null,ns(c,b,h),c=h,a.current.lanes=c,ze(a,c),gs(a),e[za]=a.current,Xg(e),new I0(a)},kh.version="19.2.0",kh}var d1;function lb(){if(d1)return mp.exports;d1=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),mp.exports=sb(),mp.exports}var ob=lb();const ub=ff(ob);v2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ld(){return ld=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},ld.apply(this,arguments)}var uo;(function(o){o.Pop="POP",o.Push="PUSH",o.Replace="REPLACE"})(uo||(uo={}));const g1="popstate";function cb(o){o===void 0&&(o={});function t(i,r){let{pathname:l,search:f,hash:d}=i.location;return bm("",{pathname:l,search:f,hash:d},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:S2(r)}return hb(t,n,null,o)}function hi(o,t){if(o===!1||o===null||typeof o>"u")throw new Error(t)}function y2(o,t){if(!o){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function fb(){return Math.random().toString(36).substr(2,8)}function p1(o,t){return{usr:o.state,key:o.key,idx:t}}function bm(o,t,n,i){return n===void 0&&(n=null),ld({pathname:typeof o=="string"?o:o.pathname,search:"",hash:""},typeof t=="string"?hf(t):t,{state:n,key:t&&t.key||i||fb()})}function S2(o){let{pathname:t="/",search:n="",hash:i=""}=o;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function hf(o){let t={};if(o){let n=o.indexOf("#");n>=0&&(t.hash=o.substr(n),o=o.substr(0,n));let i=o.indexOf("?");i>=0&&(t.search=o.substr(i),o=o.substr(0,i)),o&&(t.pathname=o)}return t}function hb(o,t,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:l=!1}=i,f=r.history,d=uo.Pop,g=null,m=_();m==null&&(m=0,f.replaceState(ld({},f.state,{idx:m}),""));function _(){return(f.state||{idx:null}).idx}function C(){d=uo.Pop;let z=_(),L=z==null?null:z-m;m=z,g&&g({action:d,location:D.location,delta:L})}function E(z,L){d=uo.Push;let N=bm(D.location,z,L);m=_()+1;let M=p1(N,m),G=D.createHref(N);try{f.pushState(M,"",G)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;r.location.assign(G)}l&&g&&g({action:d,location:D.location,delta:1})}function R(z,L){d=uo.Replace;let N=bm(D.location,z,L);m=_();let M=p1(N,m),G=D.createHref(N);f.replaceState(M,"",G),l&&g&&g({action:d,location:D.location,delta:0})}function v(z){let L=r.location.origin!=="null"?r.location.origin:r.location.href,N=typeof z=="string"?z:S2(z);return N=N.replace(/ $/,"%20"),hi(L,"No window.location.(origin|href) available to create URL for href: "+N),new URL(N,L)}let D={get action(){return d},get location(){return o(r,f)},listen(z){if(g)throw new Error("A history only accepts one active listener");return r.addEventListener(g1,C),g=z,()=>{r.removeEventListener(g1,C),g=null}},createHref(z){return t(r,z)},createURL:v,encodeLocation(z){let L=v(z);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:E,replace:R,go(z){return f.go(z)}};return D}var m1;(function(o){o.data="data",o.deferred="deferred",o.redirect="redirect",o.error="error"})(m1||(m1={}));function db(o,t,n){return n===void 0&&(n="/"),gb(o,t,n)}function gb(o,t,n,i){let r=typeof t=="string"?hf(t):t,l=E2(r.pathname||"/",n);if(l==null)return null;let f=b2(o);pb(f);let d=null;for(let g=0;d==null&&g<f.length;++g){let m=Rb(l);d=Tb(f[g],m)}return d}function b2(o,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(l,f,d)=>{let g={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:f,route:l};g.relativePath.startsWith("/")&&(hi(g.relativePath.startsWith(i),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(i.length));let m=du([i,g.relativePath]),_=n.concat(g);l.children&&l.children.length>0&&(hi(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),b2(l.children,t,_,m)),!(l.path==null&&!l.index)&&t.push({path:m,score:Eb(m,l.index),routesMeta:_})};return o.forEach((l,f)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))r(l,f);else for(let g of _2(l.path))r(l,f,g)}),t}function _2(o){let t=o.split("/");if(t.length===0)return[];let[n,...i]=t,r=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return r?[l,""]:[l];let f=_2(i.join("/")),d=[];return d.push(...f.map(g=>g===""?l:[l,g].join("/"))),r&&d.push(...f),d.map(g=>o.startsWith("/")&&g===""?"/":g)}function pb(o){o.sort((t,n)=>t.score!==n.score?n.score-t.score:Cb(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const mb=/^:[\w-]+$/,vb=3,yb=2,Sb=1,bb=10,_b=-2,v1=o=>o==="*";function Eb(o,t){let n=o.split("/"),i=n.length;return n.some(v1)&&(i+=_b),t&&(i+=yb),n.filter(r=>!v1(r)).reduce((r,l)=>r+(mb.test(l)?vb:l===""?Sb:bb),i)}function Cb(o,t){return o.length===t.length&&o.slice(0,-1).every((i,r)=>i===t[r])?o[o.length-1]-t[t.length-1]:0}function Tb(o,t,n){let{routesMeta:i}=o,r={},l="/",f=[];for(let d=0;d<i.length;++d){let g=i[d],m=d===i.length-1,_=l==="/"?t:t.slice(l.length)||"/",C=Ab({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},_),E=g.route;if(!C)return null;Object.assign(r,C.params),f.push({params:r,pathname:du([l,C.pathname]),pathnameBase:jb(du([l,C.pathnameBase])),route:E}),C.pathnameBase!=="/"&&(l=du([l,C.pathnameBase]))}return f}function Ab(o,t){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[n,i]=Ob(o.path,o.caseSensitive,o.end),r=t.match(n);if(!r)return null;let l=r[0],f=l.replace(/(.)\/+$/,"$1"),d=r.slice(1);return{params:i.reduce((m,_,C)=>{let{paramName:E,isOptional:R}=_;if(E==="*"){let D=d[C]||"";f=l.slice(0,l.length-D.length).replace(/(.)\/+$/,"$1")}const v=d[C];return R&&!v?m[E]=void 0:m[E]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:f,pattern:o}}function Ob(o,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),y2(o==="*"||!o.endsWith("*")||o.endsWith("/*"),'Route path "'+o+'" will be treated as if it were '+('"'+o.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+o.replace(/\*$/,"/*")+'".'));let i=[],r="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,d,g)=>(i.push({paramName:d,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(i.push({paramName:"*"}),r+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":o!==""&&o!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function Rb(o){try{return o.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return y2(!1,'The URL path "'+o+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),o}}function E2(o,t){if(t==="/")return o;if(!o.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=o.charAt(n);return i&&i!=="/"?null:o.slice(n)||"/"}function wb(o,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:r=""}=typeof o=="string"?hf(o):o;return{pathname:n?n.startsWith("/")?n:xb(n,t):t,search:Ub(i),hash:Bb(r)}}function xb(o,t){let n=t.replace(/\/+$/,"").split("/");return o.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function bp(o,t,n,i){return"Cannot include a '"+o+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Mb(o){return o.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Nb(o,t){let n=Mb(o);return t?n.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function Db(o,t,n,i){i===void 0&&(i=!1);let r;typeof o=="string"?r=hf(o):(r=ld({},o),hi(!r.pathname||!r.pathname.includes("?"),bp("?","pathname","search",r)),hi(!r.pathname||!r.pathname.includes("#"),bp("#","pathname","hash",r)),hi(!r.search||!r.search.includes("#"),bp("#","search","hash",r)));let l=o===""||r.pathname==="",f=l?"/":r.pathname,d;if(f==null)d=n;else{let C=t.length-1;if(!i&&f.startsWith("..")){let E=f.split("/");for(;E[0]==="..";)E.shift(),C-=1;r.pathname=E.join("/")}d=C>=0?t[C]:"/"}let g=wb(r,d),m=f&&f!=="/"&&f.endsWith("/"),_=(l||f===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(m||_)&&(g.pathname+="/"),g}const du=o=>o.join("/").replace(/\/\/+/g,"/"),jb=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),Ub=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,Bb=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function zb(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}const C2=["post","put","patch","delete"];new Set(C2);const Lb=["get",...C2];new Set(Lb);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function od(){return od=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},od.apply(this,arguments)}const Qm=dt.createContext(null),Gb=dt.createContext(null),Eg=dt.createContext(null),Cg=dt.createContext(null),df=dt.createContext({outlet:null,matches:[],isDataRoute:!1}),T2=dt.createContext(null);function Tg(){return dt.useContext(Cg)!=null}function Xm(){return Tg()||hi(!1),dt.useContext(Cg).location}function A2(o){dt.useContext(Eg).static||dt.useLayoutEffect(o)}function dd(){let{isDataRoute:o}=dt.useContext(df);return o?Zb():Hb()}function Hb(){Tg()||hi(!1);let o=dt.useContext(Qm),{basename:t,future:n,navigator:i}=dt.useContext(Eg),{matches:r}=dt.useContext(df),{pathname:l}=Xm(),f=JSON.stringify(Nb(r,n.v7_relativeSplatPath)),d=dt.useRef(!1);return A2(()=>{d.current=!0}),dt.useCallback(function(m,_){if(_===void 0&&(_={}),!d.current)return;if(typeof m=="number"){i.go(m);return}let C=Db(m,JSON.parse(f),l,_.relative==="path");o==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:du([t,C.pathname])),(_.replace?i.replace:i.push)(C,_.state,_)},[t,i,f,l,o])}function Pb(o,t){return Ib(o,t)}function Ib(o,t,n,i){Tg()||hi(!1);let{navigator:r}=dt.useContext(Eg),{matches:l}=dt.useContext(df),f=l[l.length-1],d=f?f.params:{};f&&f.pathname;let g=f?f.pathnameBase:"/";f&&f.route;let m=Xm(),_;if(t){var C;let z=typeof t=="string"?hf(t):t;g==="/"||(C=z.pathname)!=null&&C.startsWith(g)||hi(!1),_=z}else _=m;let E=_.pathname||"/",R=E;if(g!=="/"){let z=g.replace(/^\//,"").split("/");R="/"+E.replace(/^\//,"").split("/").slice(z.length).join("/")}let v=db(o,{pathname:R}),D=Kb(v&&v.map(z=>Object.assign({},z,{params:Object.assign({},d,z.params),pathname:du([g,r.encodeLocation?r.encodeLocation(z.pathname).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?g:du([g,r.encodeLocation?r.encodeLocation(z.pathnameBase).pathname:z.pathnameBase])})),l,n,i);return t&&D?dt.createElement(Cg.Provider,{value:{location:od({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:uo.Pop}},D):D}function kb(){let o=Jb(),t=zb(o)?o.status+" "+o.statusText:o instanceof Error?o.message:JSON.stringify(o),n=o instanceof Error?o.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return dt.createElement(dt.Fragment,null,dt.createElement("h2",null,"Unexpected Application Error!"),dt.createElement("h3",{style:{fontStyle:"italic"}},t),n?dt.createElement("pre",{style:r},n):null,null)}const qb=dt.createElement(kb,null);class Vb extends dt.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?dt.createElement(df.Provider,{value:this.props.routeContext},dt.createElement(T2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Yb(o){let{routeContext:t,match:n,children:i}=o,r=dt.useContext(Qm);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),dt.createElement(df.Provider,{value:t},i)}function Kb(o,t,n,i){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),o==null){var l;if(!n)return null;if(n.errors)o=n.matches;else if((l=i)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)o=n.matches;else return null}let f=o,d=(r=n)==null?void 0:r.errors;if(d!=null){let _=f.findIndex(C=>C.route.id&&(d==null?void 0:d[C.route.id])!==void 0);_>=0||hi(!1),f=f.slice(0,Math.min(f.length,_+1))}let g=!1,m=-1;if(n&&i&&i.v7_partialHydration)for(let _=0;_<f.length;_++){let C=f[_];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(m=_),C.route.id){let{loaderData:E,errors:R}=n,v=C.route.loader&&E[C.route.id]===void 0&&(!R||R[C.route.id]===void 0);if(C.route.lazy||v){g=!0,m>=0?f=f.slice(0,m+1):f=[f[0]];break}}}return f.reduceRight((_,C,E)=>{let R,v=!1,D=null,z=null;n&&(R=d&&C.route.id?d[C.route.id]:void 0,D=C.route.errorElement||qb,g&&(m<0&&E===0?(Wb("route-fallback"),v=!0,z=null):m===E&&(v=!0,z=C.route.hydrateFallbackElement||null)));let L=t.concat(f.slice(0,E+1)),N=()=>{let M;return R?M=D:v?M=z:C.route.Component?M=dt.createElement(C.route.Component,null):C.route.element?M=C.route.element:M=_,dt.createElement(Yb,{match:C,routeContext:{outlet:_,matches:L,isDataRoute:n!=null},children:M})};return n&&(C.route.ErrorBoundary||C.route.errorElement||E===0)?dt.createElement(Vb,{location:n.location,revalidation:n.revalidation,component:D,error:R,children:N(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):N()},null)}var O2=(function(o){return o.UseBlocker="useBlocker",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o})(O2||{}),R2=(function(o){return o.UseBlocker="useBlocker",o.UseLoaderData="useLoaderData",o.UseActionData="useActionData",o.UseRouteError="useRouteError",o.UseNavigation="useNavigation",o.UseRouteLoaderData="useRouteLoaderData",o.UseMatches="useMatches",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o.UseRouteId="useRouteId",o})(R2||{});function Qb(o){let t=dt.useContext(Qm);return t||hi(!1),t}function Xb(o){let t=dt.useContext(Gb);return t||hi(!1),t}function Fb(o){let t=dt.useContext(df);return t||hi(!1),t}function w2(o){let t=Fb(),n=t.matches[t.matches.length-1];return n.route.id||hi(!1),n.route.id}function Jb(){var o;let t=dt.useContext(T2),n=Xb(),i=w2();return t!==void 0?t:(o=n.errors)==null?void 0:o[i]}function Zb(){let{router:o}=Qb(O2.UseNavigateStable),t=w2(R2.UseNavigateStable),n=dt.useRef(!1);return A2(()=>{n.current=!0}),dt.useCallback(function(r,l){l===void 0&&(l={}),n.current&&(typeof r=="number"?o.navigate(r):o.navigate(r,od({fromRouteId:t},l)))},[o,t])}const y1={};function Wb(o,t,n){y1[o]||(y1[o]=!0)}function $b(o,t){o==null||o.v7_startTransition,o==null||o.v7_relativeSplatPath}function Qh(o){hi(!1)}function t3(o){let{basename:t="/",children:n=null,location:i,navigationType:r=uo.Pop,navigator:l,static:f=!1,future:d}=o;Tg()&&hi(!1);let g=t.replace(/^\/*/,"/"),m=dt.useMemo(()=>({basename:g,navigator:l,static:f,future:od({v7_relativeSplatPath:!1},d)}),[g,d,l,f]);typeof i=="string"&&(i=hf(i));let{pathname:_="/",search:C="",hash:E="",state:R=null,key:v="default"}=i,D=dt.useMemo(()=>{let z=E2(_,g);return z==null?null:{location:{pathname:z,search:C,hash:E,state:R,key:v},navigationType:r}},[g,_,C,E,R,v,r]);return D==null?null:dt.createElement(Eg.Provider,{value:m},dt.createElement(Cg.Provider,{children:n,value:D}))}function e3(o){let{children:t,location:n}=o;return Pb(_m(t),n)}new Promise(()=>{});function _m(o,t){t===void 0&&(t=[]);let n=[];return dt.Children.forEach(o,(i,r)=>{if(!dt.isValidElement(i))return;let l=[...t,r];if(i.type===dt.Fragment){n.push.apply(n,_m(i.props.children,l));return}i.type!==Qh&&hi(!1),!i.props.index||!i.props.children||hi(!1);let f={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(f.children=_m(i.props.children,l)),n.push(f)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Em(o){return o===void 0&&(o=""),new URLSearchParams(typeof o=="string"||Array.isArray(o)||o instanceof URLSearchParams?o:Object.keys(o).reduce((t,n)=>{let i=o[n];return t.concat(Array.isArray(i)?i.map(r=>[n,r]):[[n,i]])},[]))}function n3(o,t){let n=Em(o);return t&&t.forEach((i,r)=>{n.has(r)||t.getAll(r).forEach(l=>{n.append(r,l)})}),n}const i3="6";try{window.__reactRouterVersion=i3}catch{}const a3="startTransition",S1=nb[a3];function r3(o){let{basename:t,children:n,future:i,window:r}=o,l=dt.useRef();l.current==null&&(l.current=cb({window:r,v5Compat:!0}));let f=l.current,[d,g]=dt.useState({action:f.action,location:f.location}),{v7_startTransition:m}=i||{},_=dt.useCallback(C=>{m&&S1?S1(()=>g(C)):g(C)},[g,m]);return dt.useLayoutEffect(()=>f.listen(_),[f,_]),dt.useEffect(()=>$b(i),[i]),dt.createElement(t3,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:f,future:i})}var b1;(function(o){o.UseScrollRestoration="useScrollRestoration",o.UseSubmit="useSubmit",o.UseSubmitFetcher="useSubmitFetcher",o.UseFetcher="useFetcher",o.useViewTransitionState="useViewTransitionState"})(b1||(b1={}));var _1;(function(o){o.UseFetcher="useFetcher",o.UseFetchers="useFetchers",o.UseScrollRestoration="useScrollRestoration"})(_1||(_1={}));function Fm(o){let t=dt.useRef(Em(o)),n=dt.useRef(!1),i=Xm(),r=dt.useMemo(()=>n3(i.search,n.current?null:t.current),[i.search]),l=dd(),f=dt.useCallback((d,g)=>{const m=Em(typeof d=="function"?d(r):d);n.current=!0,l("?"+m,g)},[l,r]);return[r,f]}function s3(){const o=dd(),[t,n]=dt.useState(!1),[i,r]=dt.useState(""),[l,f]=dt.useState("demo"),d=g=>{g.preventDefault(),i.trim()&&l.trim()&&o(`/student?room=${l}&name=${encodeURIComponent(i.trim())}`)};return t?Z.jsxs("div",{className:"landing-page",children:[Z.jsxs("div",{className:"background-decorations",children:[Z.jsx("div",{className:"bg-blob bg-blob-1"}),Z.jsx("div",{className:"bg-blob bg-blob-2"}),Z.jsx("div",{className:"bg-gradient-overlay"})]}),Z.jsx("main",{className:"landing-main",children:Z.jsx("div",{className:"glass-surface landing-container",style:{maxWidth:"500px"},children:Z.jsxs("div",{className:"landing-content",children:[Z.jsx("span",{className:"glass-pill landing-badge",children:Z.jsx("span",{children:"FEATHER"})}),Z.jsxs("div",{className:"landing-header",children:[Z.jsx("h1",{className:"landing-title",style:{fontSize:"2rem"},children:"Join as Student"}),Z.jsx("p",{className:"landing-description",children:"Enter your name and room code to start drawing"})]}),Z.jsxs("form",{onSubmit:d,style:{width:"100%",marginTop:"2rem"},children:[Z.jsxs("div",{style:{marginBottom:"1.5rem"},children:[Z.jsx("label",{htmlFor:"studentName",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Your Name"}),Z.jsx("input",{id:"studentName",type:"text",value:i,onChange:g=>r(g.target.value),placeholder:"Enter your name",autoFocus:!0,required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),Z.jsxs("div",{style:{marginBottom:"1.5rem"},children:[Z.jsx("label",{htmlFor:"roomCode",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Room Code"}),Z.jsx("input",{id:"roomCode",type:"text",value:l,onChange:g=>f(g.target.value.toUpperCase()),placeholder:"Enter room code",required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s",fontFamily:"monospace",letterSpacing:"2px"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),Z.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[Z.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"2px solid #ddd",borderRadius:"8px",background:"white",cursor:"pointer",transition:"all 0.2s"},children:"← Back"}),Z.jsx("button",{type:"submit",style:{flex:2,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:g=>g.target.style.transform="translateY(-2px)",onMouseOut:g=>g.target.style.transform="translateY(0)",children:"Join Room →"})]})]})]})})})]}):Z.jsxs("div",{className:"landing-page",children:[Z.jsxs("div",{className:"background-decorations",children:[Z.jsx("div",{className:"bg-blob bg-blob-1"}),Z.jsx("div",{className:"bg-blob bg-blob-2"}),Z.jsx("div",{className:"bg-gradient-overlay"})]}),Z.jsx("main",{className:"landing-main",children:Z.jsxs("div",{className:"glass-surface landing-container",children:[Z.jsxs("div",{className:"landing-content",children:[Z.jsx("span",{className:"glass-pill landing-badge",children:Z.jsx("span",{children:"FEATHER"})}),Z.jsxs("div",{className:"landing-header",children:[Z.jsx("h1",{className:"landing-title",children:"Teach visually. Collaborate instantly."}),Z.jsx("p",{className:"landing-description",children:"Feather streams pencil-perfect strokes between teachers and students in real time. Instant sync, buttery smooth annotation tools, and delightful classroom-ready controls built for iPad and stylus workflows."})]}),Z.jsxs("dl",{className:"features",children:[Z.jsxs("div",{className:"feature-card",children:[Z.jsx("dt",{className:"feature-title",children:"Palm rejection"}),Z.jsx("dd",{className:"feature-subtitle",children:"Silky palm drawing"})]}),Z.jsxs("div",{className:"feature-card",children:[Z.jsx("dt",{className:"feature-title",children:"Frameless logos"}),Z.jsx("dd",{className:"feature-subtitle",children:"Delightful annotations"})]}),Z.jsxs("div",{className:"feature-card",children:[Z.jsx("dt",{className:"feature-title",children:"Realtime sync"}),Z.jsx("dd",{className:"feature-subtitle",children:"Sub-second latency"})]})]})]}),Z.jsxs("div",{className:"workspace-section",children:[Z.jsx("p",{className:"workspace-label",children:"PICK YOUR WORKSPACE"}),Z.jsxs("div",{className:"workspace-cards",children:[Z.jsxs("a",{onClick:()=>o("/teacher?room=demo"),className:"glass-button teacher-card",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"workspace-title",children:"Teacher dashboard"}),Z.jsx("p",{className:"workspace-description",children:"Monitor your students, sync views, and annotate the board. Assign templates/images, and manage the class."})]}),Z.jsx("span",{className:"workspace-emoji",children:"👩‍🏫"})]}),Z.jsxs("a",{onClick:()=>n(!0),className:"glass-button student-card",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"workspace-title",children:"Student workspace"}),Z.jsx("p",{className:"workspace-description",children:"Sketch on a public or draw alongside the class, with undo/redo, templates, and stylus-first controls."})]}),Z.jsx("span",{className:"workspace-emoji",children:"👩‍🎓"})]})]})]})]})})]})}const l3=Math.PI/180;function o3(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const fu=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Vt={_global:fu,version:"10.0.7",isBrowser:o3(),isUnminified:/param/.test((function(o){}).toString()),dblClickWindow:400,getAngle(o){return Vt.angleDeg?o*l3:o},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Vt.DD.isDragging},isTransforming(){var o,t;return(t=(o=Vt.Transformer)===null||o===void 0?void 0:o.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!Vt.DD.node},releaseCanvasOnDestroy:!0,document:fu.document,_injectGlobal(o){typeof fu.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),fu.Konva=o}},Bn=o=>{Vt[o.prototype.getClassName()]=o};Vt._injectGlobal(Vt);const u3=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,E1=()=>{if(typeof document>"u")throw new Error(u3)};class Da{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Da(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const n=this.m;return{x:n[0]*t.x+n[2]*t.y+n[4],y:n[1]*t.x+n[3]*t.y+n[5]}}translate(t,n){return this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n,this}scale(t,n){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n,this}rotate(t){const n=Math.cos(t),i=Math.sin(t),r=this.m[0]*n+this.m[2]*i,l=this.m[1]*n+this.m[3]*i,f=this.m[0]*-i+this.m[2]*n,d=this.m[1]*-i+this.m[3]*n;return this.m[0]=r,this.m[1]=l,this.m[2]=f,this.m[3]=d,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,n){const i=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,l=this.m[2]+this.m[0]*t,f=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=r,this.m[2]=l,this.m[3]=f,this}multiply(t){const n=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],l=this.m[1]*t.m[2]+this.m[3]*t.m[3],f=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],d=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=l,this.m[4]=f,this.m[5]=d,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,i=-this.m[1]*t,r=-this.m[2]*t,l=this.m[0]*t,f=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),d=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=l,this.m[4]=f,this.m[5]=d,this}getMatrix(){return this.m}decompose(){const t=this.m[0],n=this.m[1],i=this.m[2],r=this.m[3],l=this.m[4],f=this.m[5],d=t*r-n*i,g={x:l,y:f,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){const m=Math.sqrt(t*t+n*n);g.rotation=n>0?Math.acos(t/m):-Math.acos(t/m),g.scaleX=m,g.scaleY=d/m,g.skewX=(t*i+n*r)/d,g.skewY=0}else if(i!=0||r!=0){const m=Math.sqrt(i*i+r*r);g.rotation=Math.PI/2-(r>0?Math.acos(-i/m):-Math.acos(i/m)),g.scaleX=d/m,g.scaleY=m,g.skewX=0,g.skewY=(t*i+n*r)/d}return g.rotation=vt._getRotation(g.rotation),g}}const c3="[object Array]",f3="[object Number]",h3="[object String]",d3="[object Boolean]",g3=Math.PI/180,p3=180/Math.PI,_p="#",m3="",v3="0",y3="Konva warning: ",C1="Konva error: ",S3="rgb(",Ep={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b3=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let q0=[];const _3=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(o){setTimeout(o,60)},vt={_isElement(o){return!!(o&&o.nodeType==1)},_isFunction(o){return!!(o&&o.constructor&&o.call&&o.apply)},_isPlainObject(o){return!!o&&o.constructor===Object},_isArray(o){return Object.prototype.toString.call(o)===c3},_isNumber(o){return Object.prototype.toString.call(o)===f3&&!isNaN(o)&&isFinite(o)},_isString(o){return Object.prototype.toString.call(o)===h3},_isBoolean(o){return Object.prototype.toString.call(o)===d3},isObject(o){return o instanceof Object},isValidSelector(o){if(typeof o!="string")return!1;const t=o[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(o){return o===0||o>0?1:-1},requestAnimFrame(o){q0.push(o),q0.length===1&&_3(function(){const t=q0;q0=[],t.forEach(function(n){n()})})},createCanvasElement(){E1();const o=document.createElement("canvas");try{o.style=o.style||{}}catch{}return o},createImageElement(){return E1(),document.createElement("img")},_isInDocument(o){for(;o=o.parentNode;)if(o==document)return!0;return!1},_urlToImage(o,t){const n=vt.createImageElement();n.onload=function(){t(n)},n.src=o},_rgbToHex(o,t,n){return((1<<24)+(o<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(o){o=o.replace(_p,m3);const t=parseInt(o,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let o=(Math.random()*16777215<<0).toString(16);for(;o.length<6;)o=v3+o;return _p+o},getRGB(o){let t;return o in Ep?(t=Ep[o],{r:t[0],g:t[1],b:t[2]}):o[0]===_p?this._hexToRgb(o.substring(1)):o.substr(0,4)===S3?(t=b3.exec(o.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(o){return o=o||"black",vt._namedColorToRBA(o)||vt._hex3ColorToRGBA(o)||vt._hex4ColorToRGBA(o)||vt._hex6ColorToRGBA(o)||vt._hex8ColorToRGBA(o)||vt._rgbColorToRGBA(o)||vt._rgbaColorToRGBA(o)||vt._hslColorToRGBA(o)},_namedColorToRBA(o){const t=Ep[o.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(o){if(o.indexOf("rgb(")===0){o=o.match(/rgb\(([^)]+)\)/)[1];const t=o.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(o){if(o.indexOf("rgba(")===0){o=o.match(/rgba\(([^)]+)\)/)[1];const t=o.split(/ *, */).map((n,i)=>n.slice(-1)==="%"?i===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(o){if(o[0]==="#"&&o.length===9)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:parseInt(o.slice(7,9),16)/255}},_hex6ColorToRGBA(o){if(o[0]==="#"&&o.length===7)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:1}},_hex4ColorToRGBA(o){if(o[0]==="#"&&o.length===5)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:parseInt(o[4]+o[4],16)/255}},_hex3ColorToRGBA(o){if(o[0]==="#"&&o.length===4)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:1}},_hslColorToRGBA(o){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(o)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o),i=Number(n[0])/360,r=Number(n[1])/100,l=Number(n[2])/100;let f,d,g;if(r===0)return g=l*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};l<.5?f=l*(1+r):f=l+r-l*r;const m=2*l-f,_=[0,0,0];for(let C=0;C<3;C++)d=i+1/3*-(C-1),d<0&&d++,d>1&&d--,6*d<1?g=m+(f-m)*6*d:2*d<1?g=f:3*d<2?g=m+(f-m)*(2/3-d)*6:g=m,_[C]=g*255;return{r:Math.round(_[0]),g:Math.round(_[1]),b:Math.round(_[2]),a:1}}},haveIntersection(o,t){return!(t.x>o.x+o.width||t.x+t.width<o.x||t.y>o.y+o.height||t.y+t.height<o.y)},cloneObject(o){const t={};for(const n in o)this._isPlainObject(o[n])?t[n]=this.cloneObject(o[n]):this._isArray(o[n])?t[n]=this.cloneArray(o[n]):t[n]=o[n];return t},cloneArray(o){return o.slice(0)},degToRad(o){return o*g3},radToDeg(o){return o*p3},_degToRad(o){return vt.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),vt.degToRad(o)},_radToDeg(o){return vt.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),vt.radToDeg(o)},_getRotation(o){return Vt.angleDeg?vt.radToDeg(o):o},_capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},throw(o){throw new Error(C1+o)},error(o){console.error(C1+o)},warn(o){Vt.showWarnings&&console.warn(y3+o)},each(o,t){for(const n in o)t(n,o[n])},_inRange(o,t,n){return t<=o&&o<n},_getProjectionToSegment(o,t,n,i,r,l){let f,d,g;const m=(o-n)*(o-n)+(t-i)*(t-i);if(m==0)f=o,d=t,g=(r-n)*(r-n)+(l-i)*(l-i);else{const _=((r-o)*(n-o)+(l-t)*(i-t))/m;_<0?(f=o,d=t,g=(o-r)*(o-r)+(t-l)*(t-l)):_>1?(f=n,d=i,g=(n-r)*(n-r)+(i-l)*(i-l)):(f=o+_*(n-o),d=t+_*(i-t),g=(f-r)*(f-r)+(d-l)*(d-l))}return[f,d,g]},_getProjectionToLine(o,t,n){const i=vt.cloneObject(o);let r=Number.MAX_VALUE;return t.forEach(function(l,f){if(!n&&f===t.length-1)return;const d=t[(f+1)%t.length],g=vt._getProjectionToSegment(l.x,l.y,d.x,d.y,o.x,o.y),m=g[0],_=g[1],C=g[2];C<r&&(i.x=m,i.y=_,r=C)}),i},_prepareArrayForTween(o,t,n){const i=[],r=[];if(o.length>t.length){const f=t;t=o,o=f}for(let f=0;f<o.length;f+=2)i.push({x:o[f],y:o[f+1]});for(let f=0;f<t.length;f+=2)r.push({x:t[f],y:t[f+1]});const l=[];return r.forEach(function(f){const d=vt._getProjectionToLine(f,i,n);l.push(d.x),l.push(d.y)}),l},_prepareToStringify(o){let t;o.visitedByCircularReferenceRemoval=!0;for(const n in o)if(o.hasOwnProperty(n)&&o[n]&&typeof o[n]=="object"){if(t=Object.getOwnPropertyDescriptor(o,n),o[n].visitedByCircularReferenceRemoval||vt._isElement(o[n]))if(t.configurable)delete o[n];else return null;else if(vt._prepareToStringify(o[n])===null)if(t.configurable)delete o[n];else return null}return delete o.visitedByCircularReferenceRemoval,o},_assign(o,t){for(const n in t)o[n]=t[n];return o},_getFirstPointerId(o){return o.touches?o.changedTouches[0].identifier:o.pointerId||999},releaseCanvas(...o){Vt.releaseCanvasOnDestroy&&o.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(o,t,n,i){let r=t<0?t:0,l=n<0?n:0;t=Math.abs(t),n=Math.abs(n);let f=0,d=0,g=0,m=0;typeof i=="number"?f=d=g=m=Math.min(i,t/2,n/2):(f=Math.min(i[0]||0,t/2,n/2),d=Math.min(i[1]||0,t/2,n/2),m=Math.min(i[2]||0,t/2,n/2),g=Math.min(i[3]||0,t/2,n/2)),o.moveTo(r+f,l),o.lineTo(r+t-d,l),o.arc(r+t-d,l+d,d,Math.PI*3/2,0,!1),o.lineTo(r+t,l+n-m),o.arc(r+t-m,l+n-m,m,0,Math.PI/2,!1),o.lineTo(r+g,l+n),o.arc(r+g,l+n-g,g,Math.PI/2,Math.PI,!1),o.lineTo(r,l+f),o.arc(r+f,l+f,f,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(o,t,n,i,r){i=Math.abs(i);for(let l=0;l<n;l++){const f=t[(l-1+n)%n],d=t[l],g=t[(l+1)%n],m={x:d.x-f.x,y:d.y-f.y},_={x:g.x-d.x,y:g.y-d.y},C=Math.hypot(m.x,m.y),E=Math.hypot(_.x,_.y);let R;typeof r=="number"?R=r:R=l<r.length?r[l]:0,R=i*Math.cos(Math.PI/n)*Math.min(1,R/i*2);const D={x:m.x/C,y:m.y/C},z={x:_.x/E,y:_.y/E},L={x:d.x-D.x*R,y:d.y-D.y*R},N={x:d.x+z.x*R,y:d.y+z.y*R};l===0?o.moveTo(L.x,L.y):o.lineTo(L.x,L.y),o.arcTo(d.x,d.y,N.x,N.y,R)}}};function E3(o){const t=[],n=o.length,i=vt;for(let r=0;r<n;r++){let l=o[r];i._isNumber(l)?l=Math.round(l*1e3)/1e3:i._isString(l)||(l=l+""),t.push(l)}return t}const T1=",",C3="(",T3=")",A3="([",O3="])",R3=";",w3="()",x3="=",A1=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],M3=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],N3=100;let V0=null;function O1(){if(V0!==null)return V0;try{const t=vt.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(V0=!1,!1)}catch{return V0=!1,!1}}class Ag{constructor(t){this.canvas=t,Vt.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,n){let i=this.traceArr,r=i.length,l="",f,d,g,m;for(f=0;f<r;f++)d=i[f],g=d.method,g?(m=d.args,l+=g,t?l+=w3:vt._isArray(m[0])?l+=A3+m.join(T1)+O3:(n&&(m=m.map(_=>typeof _=="number"?Math.floor(_):_)),l+=C3+m.join(T1)+T3)):(l+=d.property,t||(l+=x3+d.val)),l+=R3;return l}clearTrace(){this.traceArr=[]}_trace(t){let n=this.traceArr,i;n.push(t),i=n.length,i>=N3&&n.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const n=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(t){const n=t.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(t){const n=t.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(t){const n=t.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(t){const n=t.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(t,n){this._context[t]=n}arc(t,n,i,r,l,f){this._context.arc(t,n,i,r,l,f)}arcTo(t,n,i,r,l){this._context.arcTo(t,n,i,r,l)}beginPath(){this._context.beginPath()}bezierCurveTo(t,n,i,r,l,f){this._context.bezierCurveTo(t,n,i,r,l,f)}clearRect(t,n,i,r){this._context.clearRect(t,n,i,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,n){const i=arguments;if(i.length===2)return this._context.createImageData(t,n);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,n,i,r){return this._context.createLinearGradient(t,n,i,r)}createPattern(t,n){return this._context.createPattern(t,n)}createRadialGradient(t,n,i,r,l,f){return this._context.createRadialGradient(t,n,i,r,l,f)}drawImage(t,n,i,r,l,f,d,g,m){const _=arguments,C=this._context;_.length===3?C.drawImage(t,n,i):_.length===5?C.drawImage(t,n,i,r,l):_.length===9&&C.drawImage(t,n,i,r,l,f,d,g,m)}ellipse(t,n,i,r,l,f,d,g){this._context.ellipse(t,n,i,r,l,f,d,g)}isPointInPath(t,n,i,r){return i?this._context.isPointInPath(i,t,n,r):this._context.isPointInPath(t,n,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,n,i,r){this._context.fillRect(t,n,i,r)}strokeRect(t,n,i,r){this._context.strokeRect(t,n,i,r)}fillText(t,n,i,r){r?this._context.fillText(t,n,i,r):this._context.fillText(t,n,i)}measureText(t){return this._context.measureText(t)}getImageData(t,n,i,r){return this._context.getImageData(t,n,i,r)}lineTo(t,n){this._context.lineTo(t,n)}moveTo(t,n){this._context.moveTo(t,n)}rect(t,n,i,r){this._context.rect(t,n,i,r)}roundRect(t,n,i,r,l){this._context.roundRect(t,n,i,r,l)}putImageData(t,n,i){this._context.putImageData(t,n,i)}quadraticCurveTo(t,n,i,r){this._context.quadraticCurveTo(t,n,i,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,n){this._context.scale(t,n)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,n,i,r,l,f){this._context.setTransform(t,n,i,r,l,f)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,n,i,r){this._context.strokeText(t,n,i,r)}transform(t,n,i,r,l,f){this._context.transform(t,n,i,r,l,f)}translate(t,n){this._context.translate(t,n)}_enableTrace(){let t=this,n=A1.length,i=this.setAttr,r,l;const f=function(d){let g=t[d],m;t[d]=function(){return l=E3(Array.prototype.slice.call(arguments,0)),m=g.apply(t,arguments),t._trace({method:d,args:l}),m}};for(r=0;r<n;r++)f(A1[r]);t.setAttr=function(){i.apply(t,arguments);const d=arguments[0];let g=arguments[1];(d==="shadowOffsetX"||d==="shadowOffsetY"||d==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),t._trace({property:d,val:g})}}_applyGlobalCompositeOperation(t){const n=t.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}M3.forEach(function(o){Object.defineProperty(Ag.prototype,o,{get(){return this._context[o]},set(t){this._context[o]=t}})});class D3 extends Ag{constructor(t,{willReadFrequently:n=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(t){const n=t.fill();this.setAttr("fillStyle",n),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const n=t._getLinearGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fillRadialGradient(t){const n=t._getRadialGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fill(t){const n=t.fill(),i=t.getFillPriority();if(n&&i==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&i==="pattern"){this._fillPattern(t);return}const l=t.getFillLinearGradientColorStops();if(l&&i==="linear-gradient"){this._fillLinearGradient(t);return}const f=t.getFillRadialGradientColorStops();if(f&&i==="radial-gradient"){this._fillRadialGradient(t);return}n?this._fillColor(t):r?this._fillPattern(t):l?this._fillLinearGradient(t):f&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const n=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),l=this.createLinearGradient(n.x,n.y,i.x,i.y);if(r){for(let f=0;f<r.length;f+=2)l.addColorStop(r[f],r[f+1]);this.setAttr("strokeStyle",l)}}_stroke(t){const n=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t),n&&t.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var n,i,r;const l=(n=t.getShadowRGBA())!==null&&n!==void 0?n:"black",f=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,d=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},g=t.getAbsoluteScale(),m=this.canvas.getPixelRatio(),_=g.x*m,C=g.y*m;this.setAttr("shadowColor",l),this.setAttr("shadowBlur",f*Math.min(Math.abs(_),Math.abs(C))),this.setAttr("shadowOffsetX",d.x*_),this.setAttr("shadowOffsetY",d.y*C)}}class j3 extends Ag{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const n=t.getStrokeScaleEnabled();if(!n){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t);const i=t.hitStrokeWidth(),r=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),n||this.restore()}}}let Y0;function U3(){if(Y0)return Y0;const o=vt.createCanvasElement(),t=o.getContext("2d");return Y0=(function(){const n=Vt._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i})(),vt.releaseCanvas(o),Y0}class Jm{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const i=(t||{}).pixelRatio||Vt.pixelRatio||U3();this.pixelRatio=i,this._canvas=vt.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const n=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,n){this.setWidth(t||0),this.setHeight(n||0)}toDataURL(t,n){try{return this._canvas.toDataURL(t,n)}catch{try{return this._canvas.toDataURL()}catch(r){return vt.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class lo extends Jm{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new D3(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function R1(){const o=vt.createCanvasElement();o.width=1,o.height=1;const t=o.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data;return!(n[0]===255&&n[1]===0&&n[2]===255&&n[3]===255)}function w1(){var o,t;return typeof navigator>"u"?!1:(t=(o=navigator.brave)===null||o===void 0?void 0:o.isBrave())!==null&&t!==void 0?t:!1}let x1=!1;function B3(){return w1()&&R1()&&!x1&&(x1=!0,vt.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),w1()&&R1()}class Zm extends Jm{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new j3(this),this.setSize(t.width,t.height),B3()}}const $e={get isDragging(){let o=!1;return $e._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(o=!0)}),o},justDragged:!1,get node(){let o;return $e._dragElements.forEach(t=>{o=t.node}),o},_dragElements:new Map,_drag(o){const t=[];$e._dragElements.forEach((n,i)=>{const{node:r}=n,l=r.getStage();l.setPointersPositions(o),n.pointerId===void 0&&(n.pointerId=vt._getFirstPointerId(o));const f=l._changedPointerPositions.find(d=>d.id===n.pointerId);if(f){if(n.dragStatus!=="dragging"){const d=r.dragDistance();if(Math.max(Math.abs(f.x-n.startPointerPos.x),Math.abs(f.y-n.startPointerPos.y))<d||(r.startDrag({evt:o}),!r.isDragging()))return}r._setDragPosition(o,n),t.push(r)}}),t.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:o},!0)})},_endDragBefore(o){const t=[];$e._dragElements.forEach(n=>{const{node:i}=n,r=i.getStage();if(o&&r.setPointersPositions(o),!r._changedPointerPositions.find(d=>d.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&($e.justDragged=!0,Vt._mouseListenClick=!1,Vt._touchListenClick=!1,Vt._pointerListenClick=!1,n.dragStatus="stopped");const f=n.node.getLayer()||n.node instanceof Vt.Stage&&n.node;f&&t.indexOf(f)===-1&&t.push(f)}),t.forEach(n=>{n.draw()})},_endDragAfter(o){$e._dragElements.forEach((t,n)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:o},!0),t.dragStatus!=="dragging"&&$e._dragElements.delete(n)})}};Vt.isBrowser&&(window.addEventListener("mouseup",$e._endDragBefore,!0),window.addEventListener("touchend",$e._endDragBefore,!0),window.addEventListener("touchcancel",$e._endDragBefore,!0),window.addEventListener("mousemove",$e._drag),window.addEventListener("touchmove",$e._drag),window.addEventListener("mouseup",$e._endDragAfter,!1),window.addEventListener("touchend",$e._endDragAfter,!1),window.addEventListener("touchcancel",$e._endDragAfter,!1));function co(o){return vt._isString(o)?'"'+o+'"':Object.prototype.toString.call(o)==="[object Number]"||vt._isBoolean(o)?o:Object.prototype.toString.call(o)}function x2(o){return o>255?255:o<0?0:Math.round(o)}function It(){if(Vt.isUnminified)return function(o,t){return vt._isNumber(o)||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),o}}function Og(o){if(Vt.isUnminified)return function(t,n){let i=vt._isNumber(t),r=vt._isArray(t)&&t.length==o;return!i&&!r&&vt.warn(co(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+o+")"),t}}function Wm(){if(Vt.isUnminified)return function(o,t){return vt._isNumber(o)||o==="auto"||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),o}}function gu(){if(Vt.isUnminified)return function(o,t){return vt._isString(o)||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),o}}function M2(){if(Vt.isUnminified)return function(o,t){const n=vt._isString(o),i=Object.prototype.toString.call(o)==="[object CanvasGradient]"||o&&o.addColorStop;return n||i||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),o}}function z3(){if(Vt.isUnminified)return function(o,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&o instanceof n||(vt._isArray(o)?o.forEach(function(i){vt._isNumber(i)||vt.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),o}}function Gr(){if(Vt.isUnminified)return function(o,t){return o===!0||o===!1||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),o}}function L3(o){if(Vt.isUnminified)return function(t,n){return t==null||vt.isObject(t)||vt.warn(co(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+o),t}}const qh="get",Vh="set",st={addGetterSetter(o,t,n,i,r){st.addGetter(o,t,n),st.addSetter(o,t,i,r),st.addOverloadedGetterSetter(o,t)},addGetter(o,t,n){const i=qh+vt._capitalize(t);o.prototype[i]=o.prototype[i]||function(){const r=this.attrs[t];return r===void 0?n:r}},addSetter(o,t,n,i){const r=Vh+vt._capitalize(t);o.prototype[r]||st.overWriteSetter(o,t,n,i)},overWriteSetter(o,t,n,i){const r=Vh+vt._capitalize(t);o.prototype[r]=function(l){return n&&l!==void 0&&l!==null&&(l=n.call(this,l,t)),this._setAttr(t,l),i&&i.call(this),this}},addComponentsGetterSetter(o,t,n,i,r){const l=n.length,f=vt._capitalize,d=qh+f(t),g=Vh+f(t);o.prototype[d]=function(){const _={};for(let C=0;C<l;C++){const E=n[C];_[E]=this.getAttr(t+f(E))}return _};const m=L3(n);o.prototype[g]=function(_){const C=this.attrs[t];i&&(_=i.call(this,_,t)),m&&m.call(this,_,t);for(const E in _)_.hasOwnProperty(E)&&this._setAttr(t+f(E),_[E]);return _||n.forEach(E=>{this._setAttr(t+f(E),void 0)}),this._fireChangeEvent(t,C,_),r&&r.call(this),this},st.addOverloadedGetterSetter(o,t)},addOverloadedGetterSetter(o,t){const n=vt._capitalize(t),i=Vh+n,r=qh+n;o.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(o,t,n,i){vt.error("Adding deprecated "+t);const r=qh+vt._capitalize(t),l=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[r]=function(){vt.error(l);const f=this.attrs[t];return f===void 0?n:f},st.addSetter(o,t,i,function(){vt.error(l)}),st.addOverloadedGetterSetter(o,t)},backCompat(o,t){vt.each(t,function(n,i){const r=o.prototype[i],l=qh+vt._capitalize(n),f=Vh+vt._capitalize(n);function d(){r.apply(this,arguments),vt.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}o.prototype[n]=d,o.prototype[l]=d,o.prototype[f]=d})},afterSetFilter(){this._filterUpToDate=!1}};function G3(o){const t=/(\w+)\(([^)]+)\)/g;let n;for(;(n=t.exec(o))!==null;){const[,i,r]=n;switch(i){case"blur":{const l=parseFloat(r.replace("px",""));return function(f){this.blurRadius(l*.5);const d=Vt.Filters;d&&d.Blur&&d.Blur.call(this,f)}}case"brightness":{const l=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(f){this.brightness(l);const d=Vt.Filters;d&&d.Brightness&&d.Brightness.call(this,f)}}case"contrast":{const l=parseFloat(r);return function(f){const d=100*(Math.sqrt(l)-1);this.contrast(d);const g=Vt.Filters;g&&g.Contrast&&g.Contrast.call(this,f)}}case"grayscale":return function(l){const f=Vt.Filters;f&&f.Grayscale&&f.Grayscale.call(this,l)};case"sepia":return function(l){const f=Vt.Filters;f&&f.Sepia&&f.Sepia.call(this,l)};case"invert":return function(l){const f=Vt.Filters;f&&f.Invert&&f.Invert.call(this,l)};default:vt.warn(`CSS filter "${i}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const hg="absoluteOpacity",K0="allEventListeners",fl="absoluteTransform",M1="absoluteScale",ru="canvas",H3="Change",P3="children",I3="konva",Cm="listening",k3="mouseenter",q3="mouseleave",V3="pointerenter",Y3="pointerleave",K3="touchenter",Q3="touchleave",N1="set",D1="Shape",dg=" ",j1="stage",ao="transform",X3="Stage",Tm="visible",F3=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(dg);let J3=1;class Pt{constructor(t){this._id=J3++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===ao||t===fl)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,n){let i=this._cache.get(t);return(i===void 0||(t===ao||t===fl)&&i.dirty===!0)&&(i=n.call(this),this._cache.set(t,i)),i}_calculate(t,n,i){if(!this._attachedDepsListeners.get(t)){const r=n.map(l=>l+"Change.konva").join(dg);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(ru)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===fl&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ru)){const{scene:t,filter:n,hit:i,buffer:r}=this._cache.get(ru);vt.releaseCanvas(t,n,i,r),this._cache.delete(ru)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const n=t||{};let i={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(n.width||i.width),l=Math.ceil(n.height||i.height),f=n.pixelRatio,d=n.x===void 0?Math.floor(i.x):n.x,g=n.y===void 0?Math.floor(i.y):n.y,m=n.offset||0,_=n.drawBorder||!1,C=n.hitCanvasPixelRatio||1;if(!r||!l){vt.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const E=Math.abs(Math.round(i.x)-d)>.5?1:0,R=Math.abs(Math.round(i.y)-g)>.5?1:0;r+=m*2+E,l+=m*2+R,d-=m,g-=m;const v=new lo({pixelRatio:f,width:r,height:l}),D=new lo({pixelRatio:f,width:0,height:0,willReadFrequently:!0}),z=new Zm({pixelRatio:C,width:r,height:l}),L=v.getContext(),N=z.getContext(),M=new lo({width:v.width/v.pixelRatio+Math.abs(d),height:v.height/v.pixelRatio+Math.abs(g),pixelRatio:v.pixelRatio}),G=M.getContext();return z.isCache=!0,v.isCache=!0,this._cache.delete(ru),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,D.getContext()._context.imageSmoothingEnabled=!1),L.save(),N.save(),G.save(),L.translate(-d,-g),N.translate(-d,-g),G.translate(-d,-g),M.x=d,M.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(hg),this._clearSelfAndDescendantCache(M1),this.drawScene(v,this,M),this.drawHit(z,this),this._isUnderCache=!1,L.restore(),N.restore(),_&&(L.save(),L.beginPath(),L.rect(0,0,r,l),L.closePath(),L.setAttr("strokeStyle","red"),L.setAttr("lineWidth",5),L.stroke(),L.restore()),this._cache.set(ru,{scene:v,filter:D,hit:z,buffer:M,x:d,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(ru)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,n){const i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,l=1/0,f=-1/0,d=-1/0;const g=this.getAbsoluteTransform(n);return i.forEach(function(m){const _=g.point(m);r===void 0&&(r=f=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),f=Math.max(f,_.x),d=Math.max(d,_.y)}),{x:r,y:l,width:f-r,height:d-l}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();t.translate(n.x,n.y);const i=this._getCachedSceneCanvas(),r=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/r,i.height/r),t.restore()}_drawCachedHitCanvas(t){const n=this._getCanvasCache(),i=n.hit;t.save(),t.translate(n.x,n.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),n=this._getCanvasCache(),i=n.scene,r=n.filter,l=r.getContext(),f,d,g,m;if(!t||t.length===0)return i;if(this._filterUpToDate)return r;let _=!0;for(let E=0;E<t.length;E++)if(typeof t[E]=="string"&&O1(),typeof t[E]!="string"||!O1()){_=!1;break}const C=i.pixelRatio;if(r.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio),_){const E=t.join(" ");return l.save(),l.setAttr("filter",E),l.drawImage(i._canvas,0,0,i.getWidth()/C,i.getHeight()/C),l.restore(),this._filterUpToDate=!0,r}try{for(f=t.length,l.clear(),l.drawImage(i._canvas,0,0,i.getWidth()/C,i.getHeight()/C),d=l.getImageData(0,0,r.getWidth(),r.getHeight()),g=0;g<f;g++)m=t[g],typeof m=="string"&&(m=G3(m)),m.call(this,d),l.putImageData(d,0,0)}catch(E){vt.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,n){if(this._cache&&this._cache.delete(K0),arguments.length===3)return this._delegate.apply(this,arguments);const i=t.split(dg);for(let r=0;r<i.length;r++){const f=i[r].split("."),d=f[0],g=f[1]||"";this.eventListeners[d]||(this.eventListeners[d]=[]),this.eventListeners[d].push({name:g,handler:n})}return this}off(t,n){let i=(t||"").split(dg),r=i.length,l,f,d,g,m,_;if(this._cache&&this._cache.delete(K0),!t)for(f in this.eventListeners)this._off(f);for(l=0;l<r;l++)if(d=i[l],g=d.split("."),m=g[0],_=g[1],m)this.eventListeners[m]&&this._off(m,_,n);else for(f in this.eventListeners)this._off(f,_,n);return this}dispatchEvent(t){const n={target:this,type:t.type,evt:t};return this.fire(t.type,n),this}addEventListener(t,n){return this.on(t,function(i){n.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,n,i){const r=this;this.on(t,function(l){const f=l.target.findAncestors(n,!0,r);for(let d=0;d<f.length;d++)l=vt.cloneObject(l),l.currentTarget=f[d],i.call(f[d],l)})}remove(){return this.isDragging()&&this.stopDrag(),$e._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(fl),this._clearSelfAndDescendantCache(hg),this._clearSelfAndDescendantCache(M1),this._clearSelfAndDescendantCache(j1),this._clearSelfAndDescendantCache(Tm),this._clearSelfAndDescendantCache(Cm)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const n="get"+vt._capitalize(t);return vt._isFunction(this[n])?this[n]():this.attrs[t]}getAncestors(){let t=this.getParent(),n=[];for(;t;)n.push(t),t=t.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let n,i;if(!t)return this;for(n in t)n!==P3&&(i=N1+vt._capitalize(n),vt._isFunction(this[i])?this[i](t[n]):this._setAttr(n,t[n]))}),this}isListening(){return this._getCache(Cm,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(Tm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,n=!1){if(t)return this._isVisible(t)&&this._isListening(t);const i=this.getLayer();let r=!1;$e._dragElements.forEach(f=>{f.dragStatus==="dragging"&&(f.node.nodeType==="Stage"||f.node.getLayer()===i)&&(r=!0)});const l=!n&&!Vt.hitOnDragEnabled&&(r||Vt.isTransforming());return this.isListening()&&this.isVisible()&&!l}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),n=this,i=0,r,l,f,d;function g(_){for(r=[],l=_.length,f=0;f<l;f++)d=_[f],i++,d.nodeType!==D1&&(r=r.concat(d.getChildren().slice())),d._id===n._id&&(f=l);r.length>0&&r[0].getDepth()<=t&&g(r)}const m=this.getStage();return n.nodeType!==X3&&m&&g(m.getChildren()),i}getDepth(){let t=0,n=this.parent;for(;n;)t++,n=n.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ao),this._clearSelfAndDescendantCache(fl)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const n=t.getPointerPosition();if(!n)return null;const i=this.getAbsoluteTransform().copy();return i.invert(),i.point(n)}getAbsolutePosition(t){let n=!1,i=this.parent;for(;i;){if(i.isCached()){n=!0;break}i=i.parent}n&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),l=new Da,f=this.offset();return l.m=r.slice(),l.translate(f.x,f.y),l.getTranslation()}setAbsolutePosition(t){const{x:n,y:i,...r}=this._clearTransform();this.attrs.x=n,this.attrs.y=i,this._clearCache(ao);const l=this._getAbsoluteTransform().copy();return l.invert(),l.translate(t.x,t.y),t={x:this.attrs.x+l.getTranslation().x,y:this.attrs.y+l.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(ao),this._clearSelfAndDescendantCache(fl),this}_setTransform(t){let n;for(n in t)this.attrs[n]=t[n]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let n=t.x,i=t.y,r=this.x(),l=this.y();return n!==void 0&&(r+=n),i!==void 0&&(l+=i),this.setPosition({x:r,y:l}),this}_eachAncestorReverse(t,n){let i=[],r=this.getParent(),l,f;if(!(n&&n._id===this._id)){for(i.unshift(this);r&&(!n||r._id!==n._id);)i.unshift(r),r=r.parent;for(l=i.length,f=0;f<l;f++)t(i[f])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return vt.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return vt.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return vt.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return vt.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return vt.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&vt.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(hg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(t*=n.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),n,i,r,l,f;const d={attrs:{},className:this.getClassName()};for(n in t)i=t[n],f=vt.isObject(i)&&!vt._isPlainObject(i)&&!vt._isArray(i),!f&&(r=typeof this[n]=="function"&&this[n],delete t[n],l=r?r.call(this):null,t[n]=i,l!==i&&(d.attrs[n]=i));return vt._prepareToStringify(d)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,n,i){const r=[];n&&this._isMatch(t)&&r.push(this);let l=this.parent;for(;l;){if(l===i)return r;l._isMatch(t)&&r.push(l),l=l.parent}return r}isAncestorOf(t){return!1}findAncestor(t,n,i){return this.findAncestors(t,n,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let n=t.replace(/ /g,"").split(","),i=n.length,r,l;for(r=0;r<i;r++)if(l=n[r],vt.isValidSelector(l)||(vt.warn('Selector "'+l+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),vt.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),vt.warn("Konva is awesome, right?")),l.charAt(0)==="#"){if(this.id()===l.slice(1))return!0}else if(l.charAt(0)==="."){if(this.hasName(l.slice(1)))return!0}else if(this.className===l||this.nodeType===l)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(j1,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,n={},i){return n.target=n.target||this,i?this._fireAndBubble(t,n):this._fire(t,n),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(fl,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let n;if(t)return n=new Da,this._eachAncestorReverse(function(i){const r=i.transformsEnabled();r==="all"?n.multiply(i.getTransform()):r==="position"&&n.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},t),n;{n=this._cache.get(fl)||new Da,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const i=this.transformsEnabled();if(i==="all")n.multiply(this.getTransform());else if(i==="position"){const r=this.attrs.x||0,l=this.attrs.y||0,f=this.attrs.offsetX||0,d=this.attrs.offsetY||0;n.translate(r-f,l-d)}return n.dirty=!1,n}}getAbsoluteScale(t){let n=this;for(;n;)n._isUnderCache&&(t=n),n=n.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ao,this._getTransform)}_getTransform(){var t,n;const i=this._cache.get(ao)||new Da;i.reset();const r=this.x(),l=this.y(),f=Vt.getAngle(this.rotation()),d=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,_=this.attrs.skewY||0,C=this.attrs.offsetX||0,E=this.attrs.offsetY||0;return(r!==0||l!==0)&&i.translate(r,l),f!==0&&i.rotate(f),(m!==0||_!==0)&&i.skew(m,_),(d!==1||g!==1)&&i.scale(d,g),(C!==0||E!==0)&&i.translate(-1*C,-1*E),i.dirty=!1,i}clone(t){let n=vt.cloneObject(this.attrs),i,r,l,f,d;for(i in t)n[i]=t[i];const g=new this.constructor(n);for(i in this.eventListeners)for(r=this.eventListeners[i],l=r.length,f=0;f<l;f++)d=r[f],d.name.indexOf(I3)<0&&(g.eventListeners[i]||(g.eventListeners[i]=[]),g.eventListeners[i].push(d));return g}_toKonvaCanvas(t){t=t||{};const n=this.getClientRect(),i=this.getStage(),r=t.x!==void 0?t.x:Math.floor(n.x),l=t.y!==void 0?t.y:Math.floor(n.y),f=t.pixelRatio||1,d=new lo({width:t.width||Math.ceil(n.width)||(i?i.width():0),height:t.height||Math.ceil(n.height)||(i?i.height():0),pixelRatio:f}),g=d.getContext(),m=new lo({width:d.width/d.pixelRatio+Math.abs(r),height:d.height/d.pixelRatio+Math.abs(l),pixelRatio:d.pixelRatio});return t.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(r||l)&&g.translate(-1*r,-1*l),this.drawScene(d,void 0,m),g.restore(),d}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const n=t.mimeType||null,i=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(n,i);return t.callback&&t.callback(r),r}toImage(t){return new Promise((n,i)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,vt._urlToImage(this.toDataURL(t),function(l){n(l),r==null||r(l)})}catch(r){i(r)}})}toBlob(t){return new Promise((n,i)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(l=>{n(l),r==null||r(l)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(r){i(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Vt.dragDistance}_off(t,n,i){let r=this.eventListeners[t],l,f,d;for(l=0;l<r.length;l++)if(f=r[l].name,d=r[l].handler,(f!=="konva"||n==="konva")&&(!n||f===n)&&(!i||i===d)){if(r.splice(l,1),r.length===0){delete this.eventListeners[t];break}l--}}_fireChangeEvent(t,n,i){this._fire(t+H3,{oldVal:n,newVal:i})}addName(t){if(!this.hasName(t)){const n=this.name(),i=n?n+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const n=(this.name()||"").split(/\s/g),i=n.indexOf(t);return i!==-1&&(n.splice(i,1),this.name(n.join(" "))),this}setAttr(t,n){const i=this[N1+vt._capitalize(t)];return vt._isFunction(i)?i.call(this,n):this._setAttr(t,n),this}_requestDraw(){if(Vt.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,n){const i=this.attrs[t];i===n&&!vt.isObject(n)||(n==null?delete this.attrs[t]:this.attrs[t]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,n),this._requestDraw())}_setComponentAttr(t,n,i){let r;i!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][n]=i,this._fireChangeEvent(t,r,i))}_fireAndBubble(t,n,i){n&&this.nodeType===D1&&(n.target=this);const r=[k3,q3,V3,Y3,K3,Q3];if(!(r.indexOf(t)!==-1&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i))){this._fire(t,n);const f=r.indexOf(t)!==-1&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!f&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,n,i):this._fireAndBubble.call(this.parent,t,n))}}_getProtoListeners(t){var n,i,r;const l=(n=this._cache.get(K0))!==null&&n!==void 0?n:{};let f=l==null?void 0:l[t];if(f===void 0){f=[];let d=Object.getPrototypeOf(this);for(;d;){const g=(r=(i=d.eventListeners)===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:[];f.push(...g),d=Object.getPrototypeOf(d)}l[t]=f,this._cache.set(K0,l)}return f}_fire(t,n){n=n||{},n.currentTarget=this,n.type=t;const i=this._getProtoListeners(t);if(i)for(let l=0;l<i.length;l++)i[l].handler.call(this,n);const r=this.eventListeners[t];if(r)for(let l=0;l<r.length;l++)r[l].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const n=t?t.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition();if(!i)return;const l=i._getPointerById(n)||i._changedPointerPositions[0]||r;$e._dragElements.set(this._id,{node:this,startPointerPos:l,offset:{x:l.x-r.x,y:l.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(t,n=!0){$e._dragElements.has(this._id)||this._createDragElement(t);const i=$e._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},n)}_setDragPosition(t,n){const i=this.getStage()._getPointerById(n.pointerId);if(!i)return;let r={x:i.x-n.offset.x,y:i.y-n.offset.y};const l=this.dragBoundFunc();if(l!==void 0){const f=l.call(this,r,t);f?r=f:vt.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const n=$e._dragElements.get(this._id);n&&(n.dragStatus="stopped"),$e._endDragBefore(t),$e._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=$e._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Vt.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;$e._dragElements.forEach(l=>{this.isAncestorOf(l.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=$e._dragElements.get(this._id),i=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";i?this.stopDrag():r&&$e._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const n=this.getStage();if(!n)return!1;const i={x:-t.x,y:-t.y,width:n.width()+2*t.x,height:n.height()+2*t.y};return vt.haveIntersection(i,this.getClientRect())}static create(t,n){return vt._isString(t)&&(t=JSON.parse(t)),this._createNode(t,n)}static _createNode(t,n){let i=Pt.prototype.getClassName.call(t),r=t.children,l,f,d;n&&(t.attrs.container=n),Vt[i]||(vt.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const g=Vt[i];if(l=new g(t.attrs),r)for(f=r.length,d=0;d<f;d++)l.add(Pt._createNode(r[d]));return l}}Pt.prototype.nodeType="Node";Pt.prototype._attrsAffectingSize=[];Pt.prototype.eventListeners={};Pt.prototype.on.call(Pt.prototype,F3,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ao),this._clearSelfAndDescendantCache(fl)});Pt.prototype.on.call(Pt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Tm)});Pt.prototype.on.call(Pt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Cm)});Pt.prototype.on.call(Pt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(hg)});const vn=st.addGetterSetter;vn(Pt,"zIndex");vn(Pt,"absolutePosition");vn(Pt,"position");vn(Pt,"x",0,It());vn(Pt,"y",0,It());vn(Pt,"globalCompositeOperation","source-over",gu());vn(Pt,"opacity",1,It());vn(Pt,"name","",gu());vn(Pt,"id","",gu());vn(Pt,"rotation",0,It());st.addComponentsGetterSetter(Pt,"scale",["x","y"]);vn(Pt,"scaleX",1,It());vn(Pt,"scaleY",1,It());st.addComponentsGetterSetter(Pt,"skew",["x","y"]);vn(Pt,"skewX",0,It());vn(Pt,"skewY",0,It());st.addComponentsGetterSetter(Pt,"offset",["x","y"]);vn(Pt,"offsetX",0,It());vn(Pt,"offsetY",0,It());vn(Pt,"dragDistance",void 0,It());vn(Pt,"width",0,It());vn(Pt,"height",0,It());vn(Pt,"listening",!0,Gr());vn(Pt,"preventDefault",!0,Gr());vn(Pt,"filters",void 0,function(o){return this._filterUpToDate=!1,o});vn(Pt,"visible",!0,Gr());vn(Pt,"transformsEnabled","all",gu());vn(Pt,"size");vn(Pt,"dragBoundFunc");vn(Pt,"draggable",!1,Gr());st.backCompat(Pt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Ba extends Pt{constructor(){super(...arguments),this.children=[]}getChildren(t){const n=this.children||[];return t?n.filter(t):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let i=0;i<t.length;i++)this.add(t[i]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const n=this._generalFind(t,!0);return n.length>0?n[0]:void 0}_generalFind(t,n){const i=[];return this._descendants(r=>{const l=r._isMatch(t);return l&&i.push(r),!!(l&&n)}),i}_descendants(t){let n=!1;const i=this.getChildren();for(const r of i){if(n=t(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(t),n))return!0}return!1}toObject(){const t=Pt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(n=>{t.children.push(n.toObject())}),t}isAncestorOf(t){let n=t.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(t){const n=Pt.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){n.add(i.clone())}),n}getAllIntersections(t){const n=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&n.push(i)}),n}_clearSelfAndDescendantCache(t){var n;super._clearSelfAndDescendantCache(t),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(n,i){n.index=i}),this._requestDraw()}drawScene(t,n,i){const r=this.getLayer(),l=t||r&&r.getCanvas(),f=l&&l.getContext(),d=this._getCanvasCache(),g=d&&d.scene,m=l&&l.isCache;if(!this.isVisible()&&!m)return this;if(g){f.save();const _=this.getAbsoluteTransform(n).getMatrix();f.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",l,n,i);return this}drawHit(t,n){if(!this.shouldDrawHit(n))return this;const i=this.getLayer(),r=t||i&&i.hitCanvas,l=r&&r.getContext(),f=this._getCanvasCache();if(f&&f.hit){l.save();const g=this.getAbsoluteTransform(n).getMatrix();l.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(l),l.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(t,n,i,r){var l;const f=n&&n.getContext(),d=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),_=typeof d=="number"&&typeof g=="number"||m,C=i===this;if(_){f.save();const R=this.getAbsoluteTransform(i);let v=R.getMatrix();f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),f.beginPath();let D;if(m)D=m.call(this,f,this);else{const z=this.clipX(),L=this.clipY();f.rect(z||0,L||0,d,g)}f.clip.apply(f,D),v=R.copy().invert().getMatrix(),f.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const E=!C&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(f.save(),f._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(R){R[t](n,i,r)}),E&&f.restore(),_&&f.restore()}getClientRect(t={}){var n;const i=t.skipTransform,r=t.relativeTo;let l,f,d,g,m={x:1/0,y:1/0,width:0,height:0};const _=this;(n=this.children)===null||n===void 0||n.forEach(function(R){if(!R.visible())return;const v=R.getClientRect({relativeTo:_,skipShadow:t.skipShadow,skipStroke:t.skipStroke});v.width===0&&v.height===0||(l===void 0?(l=v.x,f=v.y,d=v.x+v.width,g=v.y+v.height):(l=Math.min(l,v.x),f=Math.min(f,v.y),d=Math.max(d,v.x+v.width),g=Math.max(g,v.y+v.height)))});const C=this.find("Shape");let E=!1;for(let R=0;R<C.length;R++)if(C[R]._isVisible(this)){E=!0;break}return E&&l!==void 0?m={x:l,y:f,width:d-l,height:g-f}:m={x:0,y:0,width:0,height:0},i?m:this._transformedRect(m,r)}}st.addComponentsGetterSetter(Ba,"clip",["x","y","width","height"]);st.addGetterSetter(Ba,"clipX",void 0,It());st.addGetterSetter(Ba,"clipY",void 0,It());st.addGetterSetter(Ba,"clipWidth",void 0,It());st.addGetterSetter(Ba,"clipHeight",void 0,It());st.addGetterSetter(Ba,"clipFunc");const ud=new Map,N2=Vt._global.PointerEvent!==void 0;function Cp(o){return ud.get(o)}function $m(o){return{evt:o,pointerId:o.pointerId}}function D2(o,t){return ud.get(o)===t}function j2(o,t){td(o),t.getStage()&&(ud.set(o,t),N2&&t._fire("gotpointercapture",$m(new PointerEvent("gotpointercapture"))))}function td(o,t){const n=ud.get(o);if(!n)return;const i=n.getStage();i&&i.content,ud.delete(o),N2&&n._fire("lostpointercapture",$m(new PointerEvent("lostpointercapture")))}const Z3="Stage",W3="string",U1="px",$3="mouseout",U2="mouseleave",B2="mouseover",z2="mouseenter",L2="mousemove",G2="mousedown",H2="mouseup",Xh="pointermove",Fh="pointerdown",af="pointerup",Jh="pointercancel",t5="lostpointercapture",Q0="pointerout",Zh="pointerleave",X0="pointerover",F0="pointerenter",Am="contextmenu",P2="touchstart",I2="touchend",k2="touchmove",q2="touchcancel",Om="wheel",e5=5,n5=[[z2,"_pointerenter"],[G2,"_pointerdown"],[L2,"_pointermove"],[H2,"_pointerup"],[U2,"_pointerleave"],[P2,"_pointerdown"],[k2,"_pointermove"],[I2,"_pointerup"],[q2,"_pointercancel"],[B2,"_pointerover"],[Om,"_wheel"],[Am,"_contextmenu"],[Fh,"_pointerdown"],[Xh,"_pointermove"],[af,"_pointerup"],[Jh,"_pointercancel"],[Zh,"_pointerleave"],[t5,"_lostpointercapture"]],Tp={mouse:{[Q0]:$3,[Zh]:U2,[X0]:B2,[F0]:z2,[Xh]:L2,[Fh]:G2,[af]:H2,[Jh]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Q0]:"touchout",[Zh]:"touchleave",[X0]:"touchover",[F0]:"touchenter",[Xh]:k2,[Fh]:P2,[af]:I2,[Jh]:q2,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Q0]:Q0,[Zh]:Zh,[X0]:X0,[F0]:F0,[Xh]:Xh,[Fh]:Fh,[af]:af,[Jh]:Jh,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Wh=o=>o.indexOf("pointer")>=0?"pointer":o.indexOf("touch")>=0?"touch":"mouse",Vc=o=>{const t=Wh(o);if(t==="pointer")return Vt.pointerEventsEnabled&&Tp.pointer;if(t==="touch")return Tp.touch;if(t==="mouse")return Tp.mouse};function B1(o={}){return(o.clipFunc||o.clipWidth||o.clipHeight)&&vt.warn("Stage does not support clipping. Please use clip for Layers or Groups."),o}const i5="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",ed=[];let Rg=class extends Ba{constructor(t){super(B1(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),ed.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{B1(this.attrs)}),this._checkVisibility()}_validateAdd(t){const n=t.getType()==="Layer",i=t.getType()==="FastLayer";n||i||vt.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===W3){let n;if(t.charAt(0)==="."){const i=t.slice(1);t=document.getElementsByClassName(i)[0]}else t.charAt(0)!=="#"?n=t:n=t.slice(1),t=document.getElementById(n);if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,n=t.length;for(let i=0;i<n;i++)t[i].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),Ba.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&vt._isInDocument(t)&&this.container().removeChild(t);const n=ed.indexOf(this);return n>-1&&ed.splice(n,1),vt.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(vt.warn(i5),null)}_getPointerById(t){return this._pointerPositions.find(n=>n.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const n=new lo({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=n.getContext()._context,r=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),r.forEach(function(l){if(!l.isVisible())return;const f=l._toKonvaCanvas(t);i.drawImage(f._canvas,t.x,t.y,f.getWidth()/f.getPixelRatio(),f.getHeight()/f.getPixelRatio())}),n}getIntersection(t){if(!t)return null;const n=this.children,i=n.length,r=i-1;for(let l=r;l>=0;l--){const f=n[l].getIntersection(t);if(f)return f}return null}_resizeDOM(){const t=this.width(),n=this.height();this.content&&(this.content.style.width=t+U1,this.content.style.height=n+U1),this.bufferCanvas.setSize(t,n),this.bufferHitCanvas.setSize(t,n),this.children.forEach(i=>{i.setSize({width:t,height:n}),i.draw()})}add(t,...n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const i=this.children.length;return i>e5&&vt.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Vt.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return D2(t,this)}setPointerCapture(t){j2(t,this)}releaseCapture(t){td(t)}getLayers(){return this.children}_bindContentEvents(){Vt.isBrowser&&n5.forEach(([t,n])=>{this.content.addEventListener(t,i=>{this[n](i)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const n=Vc(t.type);n&&this._fire(n.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const n=Vc(t.type);n&&this._fire(n.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let n=this[t+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(t){const n=Vc(t.type),i=Wh(t.type);if(!n)return;this.setPointersPositions(t);const r=this._getTargetShape(i),l=!(Vt.isDragging()||Vt.isTransforming())||Vt.hitOnDragEnabled;r&&l?(r._fireAndBubble(n.pointerout,{evt:t}),r._fireAndBubble(n.pointerleave,{evt:t}),this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):l&&(this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const n=Vc(t.type),i=Wh(t.type);if(!n)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(l=>{const f=this.getIntersection(l);if($e.justDragged=!1,Vt["_"+i+"ListenClick"]=!0,!f||!f.isListening()){this[i+"ClickStartShape"]=void 0;return}Vt.capturePointerEventsEnabled&&f.setPointerCapture(l.id),this[i+"ClickStartShape"]=f,f._fireAndBubble(n.pointerdown,{evt:t,pointerId:l.id}),r=!0;const d=t.type.indexOf("touch")>=0;f.preventDefault()&&t.cancelable&&d&&t.preventDefault()}),r||this._fire(n.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const n=Vc(t.type),i=Wh(t.type);if(!n)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(Vt.isDragging()&&$e.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(Vt.isDragging()||Vt.isTransforming())||Vt.hitOnDragEnabled))return;const f={};let d=!1;const g=this._getTargetShape(i);this._changedPointerPositions.forEach(m=>{const _=Cp(m.id)||this.getIntersection(m),C=m.id,E={evt:t,pointerId:C},R=g!==_;if(R&&g&&(g._fireAndBubble(n.pointerout,{...E},_),g._fireAndBubble(n.pointerleave,{...E},_)),_){if(f[_._id])return;f[_._id]=!0}_&&_.isListening()?(d=!0,R&&(_._fireAndBubble(n.pointerover,{...E},g),_._fireAndBubble(n.pointerenter,{...E},g),this[i+"targetShape"]=_),_._fireAndBubble(n.pointermove,{...E})):g&&(this._fire(n.pointerover,{evt:t,target:this,currentTarget:this,pointerId:C}),this[i+"targetShape"]=null)}),d||this._fire(n.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const n=Vc(t.type),i=Wh(t.type);if(!n)return;this.setPointersPositions(t);const r=this[i+"ClickStartShape"],l=this[i+"ClickEndShape"],f={};let d=!1;this._changedPointerPositions.forEach(g=>{const m=Cp(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),f[m._id])return;f[m._id]=!0}const _=g.id,C={evt:t,pointerId:_};let E=!1;Vt["_"+i+"InDblClickWindow"]?(E=!0,clearTimeout(this[i+"DblTimeout"])):$e.justDragged||(Vt["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){Vt["_"+i+"InDblClickWindow"]=!1},Vt.dblClickWindow),m&&m.isListening()?(d=!0,this[i+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...C}),Vt["_"+i+"ListenClick"]&&r&&r===m&&(m._fireAndBubble(n.pointerclick,{...C}),E&&l&&l===m&&m._fireAndBubble(n.pointerdblclick,{...C}))):(this[i+"ClickEndShape"]=null,d||(this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),d=!0),Vt["_"+i+"ListenClick"]&&this._fire(n.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:_}),E&&this._fire(n.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:_}))}),d||this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Vt["_"+i+"ListenClick"]=!1,t.cancelable&&i!=="touch"&&i!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Am,{evt:t}):this._fire(Am,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Om,{evt:t}):this._fire(Om,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const n=Cp(t.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(af,$m(t)),td(t.pointerId)}_lostpointercapture(t){td(t.pointerId)}setPointersPositions(t){const n=this._getContentPosition();let i=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,l=>{this._pointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,l=>{this._changedPointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})})):(i=(t.clientX-n.left)/n.scaleX,r=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:i,y:r},this._pointerPositions=[{x:i,y:r,id:vt._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:r,id:vt._getFirstPointerId(t)}])}_setPointerPosition(t){vt.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new lo({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Zm({pixelRatio:1,width:this.width(),height:this.height()}),!Vt.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return vt.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Rg.prototype.nodeType=Z3;Bn(Rg);st.addGetterSetter(Rg,"container");Vt.isBrowser&&document.addEventListener("visibilitychange",()=>{ed.forEach(o=>{o.batchDraw()})});const V2="hasShadow",Y2="shadowRGBA",K2="patternImage",Q2="linearGradient",X2="radialGradient";let J0;function Ap(){return J0||(J0=vt.createCanvasElement().getContext("2d"),J0)}const nd={};function a5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function r5(o){o.stroke()}function s5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function l5(o){o.stroke()}function o5(){this._clearCache(V2)}function u5(){this._clearCache(Y2)}function c5(){this._clearCache(K2)}function f5(){this._clearCache(Q2)}function h5(){this._clearCache(X2)}class jt extends Pt{constructor(t){super(t);let n;for(;n=vt.getRandomColor(),!(n&&!(n in nd)););this.colorKey=n,nd[n]=this}getContext(){return vt.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return vt.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(V2,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(K2,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Ap().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const i=new Da;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(Vt.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=i.getMatrix(),l=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(l)}return n}}_getLinearGradient(){return this._getCache(Q2,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const n=Ap(),i=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),l=n.createLinearGradient(i.x,i.y,r.x,r.y);for(let f=0;f<t.length;f+=2)l.addColorStop(t[f],t[f+1]);return l}}_getRadialGradient(){return this._getCache(X2,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const n=Ap(),i=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),l=n.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let f=0;f<t.length;f+=2)l.addColorStop(t[f],t[f+1]);return l}}getShadowRGBA(){return this._getCache(Y2,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=vt.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const n=this.getStage();if(!n)return!1;const i=n.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,void 0,!0),i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return Pt.prototype.destroy.call(this),delete nd[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=t||this.hasFill(),l=this.hasStroke(),f=this.getAbsoluteOpacity()!==1;if(r&&l&&f)return!0;const d=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(r&&l&&d&&g)}setStrokeHitEnabled(t){vt.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let n=!1,i=this.getParent();for(;i;){if(i.isCached()){n=!0;break}i=i.getParent()}const r=t.skipTransform,l=t.relativeTo||n&&this.getStage()||void 0,f=this.getSelfRect(),g=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=f.width+g,_=f.height+g,C=!t.skipShadow&&this.hasShadow(),E=C?this.shadowOffsetX():0,R=C?this.shadowOffsetY():0,v=m+Math.abs(E),D=_+Math.abs(R),z=C&&this.shadowBlur()||0,L=v+z*2,N=D+z*2,M={width:L,height:N,x:-(g/2+z)+Math.min(E,0)+f.x,y:-(g/2+z)+Math.min(R,0)+f.y};return r?M:this._transformedRect(M,l)}drawScene(t,n,i){const r=this.getLayer(),l=t||r.getCanvas(),f=l.getContext(),d=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let _;const C=n===this;if(!this.isVisible()&&!C)return this;if(d){f.save();const E=this.getAbsoluteTransform(n).getMatrix();return f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedSceneCanvas(f),f.restore(),this}if(!g)return this;if(f.save(),this._useBufferCanvas()){_=this.getStage();const E=i||_.bufferCanvas,R=E.getContext();R.clear(),R.save(),R._applyLineJoin(this),R._applyMiterLimit(this);const v=this.getAbsoluteTransform(n).getMatrix();R.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.call(this,R,this),R.restore();const D=E.pixelRatio;m&&f._applyShadow(this),f._applyOpacity(this),f._applyGlobalCompositeOperation(this),f.drawImage(E._canvas,E.x||0,E.y||0,E.width/D,E.height/D)}else{if(f._applyLineJoin(this),f._applyMiterLimit(this),!C){const E=this.getAbsoluteTransform(n).getMatrix();f.transform(E[0],E[1],E[2],E[3],E[4],E[5]),f._applyOpacity(this),f._applyGlobalCompositeOperation(this)}m&&f._applyShadow(this),g.call(this,f,this)}return f.restore(),this}drawHit(t,n,i=!1){if(!this.shouldDrawHit(n,i))return this;const r=this.getLayer(),l=t||r.hitCanvas,f=l&&l.getContext(),d=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||vt.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){f.save();const C=this.getAbsoluteTransform(n).getMatrix();return f.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._drawCachedHitCanvas(f),f.restore(),this}if(!d)return this;if(f.save(),f._applyLineJoin(this),f._applyMiterLimit(this),!(this===n)){const C=this.getAbsoluteTransform(n).getMatrix();f.transform(C[0],C[1],C[2],C[3],C[4],C[5])}return d.call(this,f,this),f.restore(),this}drawHitFromCache(t=0){const n=this._getCanvasCache(),i=this._getCachedSceneCanvas(),r=n.hit,l=r.getContext(),f=r.getWidth(),d=r.getHeight();l.clear(),l.drawImage(i._canvas,0,0,f,d);try{const g=l.getImageData(0,0,f,d),m=g.data,_=m.length,C=vt._hexToRgb(this.colorKey);for(let E=0;E<_;E+=4)m[E+3]>t?(m[E]=C.r,m[E+1]=C.g,m[E+2]=C.b,m[E+3]=255):m[E+3]=0;l.putImageData(g,0,0)}catch(g){vt.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return D2(t,this)}setPointerCapture(t){j2(t,this)}releaseCapture(t){td(t)}}jt.prototype._fillFunc=a5;jt.prototype._strokeFunc=r5;jt.prototype._fillFuncHit=s5;jt.prototype._strokeFuncHit=l5;jt.prototype._centroid=!1;jt.prototype.nodeType="Shape";Bn(jt);jt.prototype.eventListeners={};jt.prototype.on.call(jt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",o5);jt.prototype.on.call(jt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",u5);jt.prototype.on.call(jt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",c5);jt.prototype.on.call(jt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",f5);jt.prototype.on.call(jt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",h5);st.addGetterSetter(jt,"stroke",void 0,M2());st.addGetterSetter(jt,"strokeWidth",2,It());st.addGetterSetter(jt,"fillAfterStrokeEnabled",!1);st.addGetterSetter(jt,"hitStrokeWidth","auto",Wm());st.addGetterSetter(jt,"strokeHitEnabled",!0,Gr());st.addGetterSetter(jt,"perfectDrawEnabled",!0,Gr());st.addGetterSetter(jt,"shadowForStrokeEnabled",!0,Gr());st.addGetterSetter(jt,"lineJoin");st.addGetterSetter(jt,"lineCap");st.addGetterSetter(jt,"miterLimit");st.addGetterSetter(jt,"sceneFunc");st.addGetterSetter(jt,"hitFunc");st.addGetterSetter(jt,"dash");st.addGetterSetter(jt,"dashOffset",0,It());st.addGetterSetter(jt,"shadowColor",void 0,gu());st.addGetterSetter(jt,"shadowBlur",0,It());st.addGetterSetter(jt,"shadowOpacity",1,It());st.addComponentsGetterSetter(jt,"shadowOffset",["x","y"]);st.addGetterSetter(jt,"shadowOffsetX",0,It());st.addGetterSetter(jt,"shadowOffsetY",0,It());st.addGetterSetter(jt,"fillPatternImage");st.addGetterSetter(jt,"fill",void 0,M2());st.addGetterSetter(jt,"fillPatternX",0,It());st.addGetterSetter(jt,"fillPatternY",0,It());st.addGetterSetter(jt,"fillLinearGradientColorStops");st.addGetterSetter(jt,"strokeLinearGradientColorStops");st.addGetterSetter(jt,"fillRadialGradientStartRadius",0);st.addGetterSetter(jt,"fillRadialGradientEndRadius",0);st.addGetterSetter(jt,"fillRadialGradientColorStops");st.addGetterSetter(jt,"fillPatternRepeat","repeat");st.addGetterSetter(jt,"fillEnabled",!0);st.addGetterSetter(jt,"strokeEnabled",!0);st.addGetterSetter(jt,"shadowEnabled",!0);st.addGetterSetter(jt,"dashEnabled",!0);st.addGetterSetter(jt,"strokeScaleEnabled",!0);st.addGetterSetter(jt,"fillPriority","color");st.addComponentsGetterSetter(jt,"fillPatternOffset",["x","y"]);st.addGetterSetter(jt,"fillPatternOffsetX",0,It());st.addGetterSetter(jt,"fillPatternOffsetY",0,It());st.addComponentsGetterSetter(jt,"fillPatternScale",["x","y"]);st.addGetterSetter(jt,"fillPatternScaleX",1,It());st.addGetterSetter(jt,"fillPatternScaleY",1,It());st.addComponentsGetterSetter(jt,"fillLinearGradientStartPoint",["x","y"]);st.addComponentsGetterSetter(jt,"strokeLinearGradientStartPoint",["x","y"]);st.addGetterSetter(jt,"fillLinearGradientStartPointX",0);st.addGetterSetter(jt,"strokeLinearGradientStartPointX",0);st.addGetterSetter(jt,"fillLinearGradientStartPointY",0);st.addGetterSetter(jt,"strokeLinearGradientStartPointY",0);st.addComponentsGetterSetter(jt,"fillLinearGradientEndPoint",["x","y"]);st.addComponentsGetterSetter(jt,"strokeLinearGradientEndPoint",["x","y"]);st.addGetterSetter(jt,"fillLinearGradientEndPointX",0);st.addGetterSetter(jt,"strokeLinearGradientEndPointX",0);st.addGetterSetter(jt,"fillLinearGradientEndPointY",0);st.addGetterSetter(jt,"strokeLinearGradientEndPointY",0);st.addComponentsGetterSetter(jt,"fillRadialGradientStartPoint",["x","y"]);st.addGetterSetter(jt,"fillRadialGradientStartPointX",0);st.addGetterSetter(jt,"fillRadialGradientStartPointY",0);st.addComponentsGetterSetter(jt,"fillRadialGradientEndPoint",["x","y"]);st.addGetterSetter(jt,"fillRadialGradientEndPointX",0);st.addGetterSetter(jt,"fillRadialGradientEndPointY",0);st.addGetterSetter(jt,"fillPatternRotation",0);st.addGetterSetter(jt,"fillRule",void 0,gu());st.backCompat(jt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const d5="#",g5="beforeDraw",p5="draw",F2=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],m5=F2.length;let pu=class extends Ba{constructor(t){super(t),this.canvas=new lo,this.hitCanvas=new Zm({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),t<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[t+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Pt.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Pt.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Pt.prototype.moveDown.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Pt.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return Pt.prototype.remove.call(this),t&&t.parentNode&&vt._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:n}){return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&vt.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Pt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){vt.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){vt.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,vt.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let n=1,i=!1;for(;;){for(let r=0;r<m5;r++){const l=F2[r],f=this._getIntersection({x:t.x+l.x*n,y:t.y+l.y*n}),d=f.shape;if(d)return d;if(i=!!f.antialiased,!f.antialiased)break}if(i)n+=1;else return null}}_getIntersection(t){const n=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*n),Math.round(t.y*n),1,1).data,r=i[3];if(r===255){const l=vt._rgbToHex(i[0],i[1],i[2]),f=nd[d5+l];return f?{shape:f}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,n,i){const r=this.getLayer(),l=t||r&&r.getCanvas();return this._fire(g5,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),Ba.prototype.drawScene.call(this,l,n,i),this._fire(p5,{node:this}),this}drawHit(t,n){const i=this.getLayer(),r=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),Ba.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){vt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return vt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return vt.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};pu.prototype.nodeType="Layer";Bn(pu);st.addGetterSetter(pu,"imageSmoothingEnabled",!0);st.addGetterSetter(pu,"clearBeforeDraw",!0);st.addGetterSetter(pu,"hitGraphEnabled",!0,Gr());class tv extends pu{constructor(t){super(t),this.listening(!1),vt.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}tv.prototype.nodeType="FastLayer";Bn(tv);class sf extends Ba{_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&vt.throw("You may only add groups and shapes to groups.")}}sf.prototype.nodeType="Group";Bn(sf);const Op=(function(){return fu.performance&&fu.performance.now?function(){return fu.performance.now()}:function(){return new Date().getTime()}})();class or{constructor(t,n){this.id=or.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Op(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(t){let n=[];return t&&(n=Array.isArray(t)?t:[t]),this.layers=n,this}getLayers(){return this.layers}addLayer(t){const n=this.layers,i=n.length;for(let r=0;r<i;r++)if(n[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const n=or.animations,i=n.length;for(let r=0;r<i;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Op(),or._addAnimation(this),this}stop(){return or._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const n=t.id,i=this.animations,r=i.length;for(let l=0;l<r;l++)if(i[l].id===n){this.animations.splice(l,1);break}}static _runFrames(){const t={},n=this.animations;for(let i=0;i<n.length;i++){const r=n[i],l=r.layers,f=r.func;r._updateFrameObject(Op());const d=l.length;let g;if(f?g=f.call(r,r.frame)!==!1:g=!0,!!g)for(let m=0;m<d;m++){const _=l[m];_._id!==void 0&&(t[_._id]=_)}}for(const i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=or;t.animations.length?(t._runFrames(),vt.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,vt.requestAnimFrame(this._animationLoop))}}or.animations=[];or.animIdCounter=0;or.animRunning=!1;const v5={node:1,duration:1,easing:1,onFinish:1,yoyo:1},y5=1,z1=2,L1=3,G1=["fill","stroke","shadowColor"];let S5=0;class b5{constructor(t,n,i,r,l,f,d){this.prop=t,this.propFunc=n,this.begin=r,this._pos=r,this.duration=f,this._change=0,this.prevPos=0,this.yoyo=d,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=l-this.begin,this.pause()}fire(t){const n=this[t];n&&n()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=z1,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=L1,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===z1?this.setTime(t):this.state===L1&&this.setTime(this.duration-t)}pause(){this.state=y5,this.fire("onPause")}getTimer(){return new Date().getTime()}}class En{constructor(t){const n=this,i=t.node,r=i._id,l=t.easing||id.Linear,f=!!t.yoyo;let d,g;typeof t.duration>"u"?d=.3:t.duration===0?d=.001:d=t.duration,this.node=i,this._id=S5++;const m=i.getLayer()||(i instanceof Vt.Stage?i.getLayers():null);m||vt.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new or(function(){n.tween.onEnterFrame()},m),this.tween=new b5(g,function(_){n._tweenFunc(_)},l,0,1,d*1e3,f),this._addListeners(),En.attrs[r]||(En.attrs[r]={}),En.attrs[r][this._id]||(En.attrs[r][this._id]={}),En.tweens[r]||(En.tweens[r]={});for(g in t)v5[g]===void 0&&this._addAttr(g,t[g]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,n){const i=this.node,r=i._id;let l,f,d,g,m;const _=En.tweens[r][t];_&&delete En.attrs[r][_][t];let C=i.getAttr(t);if(vt._isArray(n))if(l=[],f=Math.max(n.length,C.length),t==="points"&&n.length!==C.length&&(n.length>C.length?(g=C,C=vt._prepareArrayForTween(C,n,i.closed())):(d=n,n=vt._prepareArrayForTween(n,C,i.closed()))),t.indexOf("fill")===0)for(let E=0;E<f;E++)if(E%2===0)l.push(n[E]-C[E]);else{const R=vt.colorToRGBA(C[E]);m=vt.colorToRGBA(n[E]),C[E]=R,l.push({r:m.r-R.r,g:m.g-R.g,b:m.b-R.b,a:m.a-R.a})}else for(let E=0;E<f;E++)l.push(n[E]-C[E]);else G1.indexOf(t)!==-1?(C=vt.colorToRGBA(C),m=vt.colorToRGBA(n),l={r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a}):l=n-C;En.attrs[r][this._id][t]={start:C,diff:l,end:n,trueEnd:d,trueStart:g},En.tweens[r][t]=this._id}_tweenFunc(t){const n=this.node,i=En.attrs[n._id][this._id];let r,l,f,d,g,m,_,C;for(r in i){if(l=i[r],f=l.start,d=l.diff,C=l.end,vt._isArray(f))if(g=[],_=Math.max(f.length,C.length),r.indexOf("fill")===0)for(m=0;m<_;m++)m%2===0?g.push((f[m]||0)+d[m]*t):g.push("rgba("+Math.round(f[m].r+d[m].r*t)+","+Math.round(f[m].g+d[m].g*t)+","+Math.round(f[m].b+d[m].b*t)+","+(f[m].a+d[m].a*t)+")");else for(m=0;m<_;m++)g.push((f[m]||0)+d[m]*t);else G1.indexOf(r)!==-1?g="rgba("+Math.round(f.r+d.r*t)+","+Math.round(f.g+d.g*t)+","+Math.round(f.b+d.b*t)+","+(f.a+d.a*t)+")":g=f+d*t;n.setAttr(r,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,n=En.attrs[t._id][this._id];n.points&&n.points.trueEnd&&t.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,n=En.attrs[t._id][this._id];n.points&&n.points.trueStart&&t.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,n=this._id,i=En.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in i)delete En.tweens[t][r];delete En.attrs[t][n],En.tweens[t]&&(Object.keys(En.tweens[t]).length===0&&delete En.tweens[t],Object.keys(En.attrs[t]).length===0&&delete En.attrs[t])}}En.attrs={};En.tweens={};Pt.prototype.to=function(o){const t=o.onFinish;o.node=this,o.onFinish=function(){this.destroy(),t&&t()},new En(o).play()};const id={BackEaseIn(o,t,n,i){return n*(o/=i)*o*((1.70158+1)*o-1.70158)+t},BackEaseOut(o,t,n,i){return n*((o=o/i-1)*o*((1.70158+1)*o+1.70158)+1)+t},BackEaseInOut(o,t,n,i){let r=1.70158;return(o/=i/2)<1?n/2*(o*o*(((r*=1.525)+1)*o-r))+t:n/2*((o-=2)*o*(((r*=1.525)+1)*o+r)+2)+t},ElasticEaseIn(o,t,n,i,r,l){let f=0;return o===0?t:(o/=i)===1?t+n:(l||(l=i*.3),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(o-=1))*Math.sin((o*i-f)*(2*Math.PI)/l))+t)},ElasticEaseOut(o,t,n,i,r,l){let f=0;return o===0?t:(o/=i)===1?t+n:(l||(l=i*.3),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*o)*Math.sin((o*i-f)*(2*Math.PI)/l)+n+t)},ElasticEaseInOut(o,t,n,i,r,l){let f=0;return o===0?t:(o/=i/2)===2?t+n:(l||(l=i*(.3*1.5)),!r||r<Math.abs(n)?(r=n,f=l/4):f=l/(2*Math.PI)*Math.asin(n/r),o<1?-.5*(r*Math.pow(2,10*(o-=1))*Math.sin((o*i-f)*(2*Math.PI)/l))+t:r*Math.pow(2,-10*(o-=1))*Math.sin((o*i-f)*(2*Math.PI)/l)*.5+n+t)},BounceEaseOut(o,t,n,i){return(o/=i)<1/2.75?n*(7.5625*o*o)+t:o<2/2.75?n*(7.5625*(o-=1.5/2.75)*o+.75)+t:o<2.5/2.75?n*(7.5625*(o-=2.25/2.75)*o+.9375)+t:n*(7.5625*(o-=2.625/2.75)*o+.984375)+t},BounceEaseIn(o,t,n,i){return n-id.BounceEaseOut(i-o,0,n,i)+t},BounceEaseInOut(o,t,n,i){return o<i/2?id.BounceEaseIn(o*2,0,n,i)*.5+t:id.BounceEaseOut(o*2-i,0,n,i)*.5+n*.5+t},EaseIn(o,t,n,i){return n*(o/=i)*o+t},EaseOut(o,t,n,i){return-n*(o/=i)*(o-2)+t},EaseInOut(o,t,n,i){return(o/=i/2)<1?n/2*o*o+t:-n/2*(--o*(o-2)-1)+t},StrongEaseIn(o,t,n,i){return n*(o/=i)*o*o*o*o+t},StrongEaseOut(o,t,n,i){return n*((o=o/i-1)*o*o*o*o+1)+t},StrongEaseInOut(o,t,n,i){return(o/=i/2)<1?n/2*o*o*o*o*o+t:n/2*((o-=2)*o*o*o*o+2)+t},Linear(o,t,n,i){return n*o/i+t}},lf=vt._assign(Vt,{Util:vt,Transform:Da,Node:Pt,Container:Ba,Stage:Rg,stages:ed,Layer:pu,FastLayer:tv,Group:sf,DD:$e,Shape:jt,shapes:nd,Animation:or,Tween:En,Easings:id,Context:Ag,Canvas:Jm});class gl extends jt{_sceneFunc(t){const n=Vt.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,n,i),t.arc(0,0,this.innerRadius(),n,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),n=this.outerRadius(),i=this.clockwise(),r=Vt.getAngle(i?360-this.angle():this.angle()),l=Math.cos(Math.min(r,Math.PI)),f=1,d=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),g=Math.sin(Math.min(r,Math.PI/2)),m=l*(l>0?t:n),_=f*n,C=d*(d>0?t:n),E=g*(g>0?n:t);return{x:m,y:i?-1*E:C,width:_-m,height:E-C}}}gl.prototype._centroid=!0;gl.prototype.className="Arc";gl.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];Bn(gl);st.addGetterSetter(gl,"innerRadius",0,It());st.addGetterSetter(gl,"outerRadius",0,It());st.addGetterSetter(gl,"angle",0,It());st.addGetterSetter(gl,"clockwise",!1,Gr());function Rm(o,t,n,i,r,l,f){const d=Math.sqrt(Math.pow(n-o,2)+Math.pow(i-t,2)),g=Math.sqrt(Math.pow(r-n,2)+Math.pow(l-i,2)),m=f*d/(d+g),_=f*g/(d+g),C=n-m*(r-o),E=i-m*(l-t),R=n+_*(r-o),v=i+_*(l-t);return[C,E,R,v]}function H1(o,t){const n=o.length,i=[];for(let r=2;r<n-2;r+=2){const l=Rm(o[r-2],o[r-1],o[r],o[r+1],o[r+2],o[r+3],t);isNaN(l[0])||(i.push(l[0]),i.push(l[1]),i.push(o[r]),i.push(o[r+1]),i.push(l[2]),i.push(l[3]))}return i}let pl=class extends jt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const n=this.points(),i=n.length,r=this.tension(),l=this.closed(),f=this.bezier();if(!i)return;let d=0;if(t.beginPath(),t.moveTo(n[0],n[1]),r!==0&&i>4){const g=this.getTensionPoints(),m=g.length;for(d=l?0:4,l||t.quadraticCurveTo(g[0],g[1],g[2],g[3]);d<m-2;)t.bezierCurveTo(g[d++],g[d++],g[d++],g[d++],g[d++],g[d++]);l||t.quadraticCurveTo(g[m-2],g[m-1],n[i-2],n[i-1])}else if(f)for(d=2;d<i;)t.bezierCurveTo(n[d++],n[d++],n[d++],n[d++],n[d++],n[d++]);else for(d=2;d<i;d+=2)t.lineTo(n[d],n[d+1]);l?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():H1(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),n=t.length,i=this.tension(),r=Rm(t[n-2],t[n-1],t[0],t[1],t[2],t[3],i),l=Rm(t[n-4],t[n-3],t[n-2],t[n-1],t[0],t[1],i),f=H1(t,i);return[r[2],r[3]].concat(f).concat([l[0],l[1],t[n-2],t[n-1],l[2],l[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let n=t[0],i=t[0],r=t[1],l=t[1],f,d;for(let g=0;g<t.length/2;g++)f=t[g*2],d=t[g*2+1],n=Math.min(n,f),i=Math.max(i,f),r=Math.min(r,d),l=Math.max(l,d);return{x:n,y:r,width:i-n,height:l-r}}};pl.prototype.className="Line";pl.prototype._attrsAffectingSize=["points","bezier","tension"];Bn(pl);st.addGetterSetter(pl,"closed",!1);st.addGetterSetter(pl,"bezier",!1);st.addGetterSetter(pl,"tension",0,It());st.addGetterSetter(pl,"points",[],z3());const _5=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],E5=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],C5=[[1],[1,1],[1,2,1],[1,3,3,1]],P1=(o,t,n)=>{let i,r;const f=n/2;i=0;for(let d=0;d<20;d++)r=f*_5[20][d]+f,i+=E5[20][d]*T5(o,t,r);return f*i},I1=(o,t,n)=>{n===void 0&&(n=1);const i=o[0]-2*o[1]+o[2],r=t[0]-2*t[1]+t[2],l=2*o[1]-2*o[0],f=2*t[1]-2*t[0],d=4*(i*i+r*r),g=4*(i*l+r*f),m=l*l+f*f;if(d===0)return n*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(t[2]-t[0],2));const _=g/(2*d),C=m/d,E=n+_,R=C-_*_,v=E*E+R>0?Math.sqrt(E*E+R):0,D=_*_+R>0?Math.sqrt(_*_+R):0,z=_+Math.sqrt(_*_+R)!==0?R*Math.log(Math.abs((E+v)/(_+D))):0;return Math.sqrt(d)/2*(E*v-_*D+z)};function T5(o,t,n){const i=wm(1,n,o),r=wm(1,n,t),l=i*i+r*r;return Math.sqrt(l)}const wm=(o,t,n)=>{const i=n.length-1;let r,l;if(i===0)return 0;if(o===0){l=0;for(let f=0;f<=i;f++)l+=C5[i][f]*Math.pow(1-t,i-f)*Math.pow(t,f)*n[f];return l}else{r=new Array(i);for(let f=0;f<i;f++)r[f]=i*(n[f+1]-n[f]);return wm(o-1,t,r)}},k1=(o,t,n)=>{let i=1,r=o/t,l=(o-n(r))/t,f=0;for(;i>.001;){const d=n(r+l),g=Math.abs(o-d)/t;if(g<i)i=g,r+=l;else{const m=n(r-l),_=Math.abs(o-m)/t;_<i?(i=_,r-=l):l/=2}if(f++,f>500)break}return r};class Cn extends jt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Cn.parsePathData(this.data()),this.pathLength=Cn.getPathLength(this.dataArray)}_sceneFunc(t){const n=this.dataArray;t.beginPath();let i=!1;for(let r=0;r<n.length;r++){const l=n[r].command,f=n[r].points;switch(l){case"L":t.lineTo(f[0],f[1]);break;case"M":t.moveTo(f[0],f[1]);break;case"C":t.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":t.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const d=f[0],g=f[1],m=f[2],_=f[3],C=f[4],E=f[5],R=f[6],v=f[7],D=m>_?m:_,z=m>_?1:m/_,L=m>_?_/m:1;t.translate(d,g),t.rotate(R),t.scale(z,L),t.arc(0,0,D,C,C+E,1-v),t.scale(1/z,1/L),t.rotate(-R),t.translate(-d,-g);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],_=g.points[5],C=g.points[4]+_;let E=Math.PI/180;if(Math.abs(m-C)<E&&(E=Math.abs(m-C)),_<0)for(let R=m-E;R>C;R-=E){const v=Cn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}else for(let R=m+E;R<C;R+=E){const v=Cn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],R,0);t.push(v.x,v.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const _=Cn.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);t.push(_.x,_.y)}else t=t.concat(g.points)});let n=t[0],i=t[0],r=t[1],l=t[1],f,d;for(let g=0;g<t.length/2;g++)f=t[g*2],d=t[g*2+1],isNaN(f)||(n=Math.min(n,f),i=Math.max(i,f)),isNaN(d)||(r=Math.min(r,d),l=Math.max(l,d));return{x:n,y:r,width:i-n,height:l-r}}getLength(){return this.pathLength}getPointAtLength(t){return Cn.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,n,i,r){return Math.sqrt((i-t)*(i-t)+(r-n)*(r-n))}static getPathLength(t){let n=0;for(let i=0;i<t.length;++i)n+=t[i].pathLength;return n}static getPointAtLengthOfDataArray(t,n){let i,r=0,l=n.length;if(!l)return null;for(;r<l&&t>n[r].pathLength;)t-=n[r].pathLength,++r;if(r===l)return i=n[r-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return n[r].command==="M"?(i=n[r].points.slice(0,2),{x:i[0],y:i[1]}):{x:n[r].start.x,y:n[r].start.y};const f=n[r],d=f.points;switch(f.command){case"L":return Cn.getPointOnLine(t,f.start.x,f.start.y,d[0],d[1]);case"C":return Cn.getPointOnCubicBezier(k1(t,Cn.getPathLength(n),D=>P1([f.start.x,d[0],d[2],d[4]],[f.start.y,d[1],d[3],d[5]],D)),f.start.x,f.start.y,d[0],d[1],d[2],d[3],d[4],d[5]);case"Q":return Cn.getPointOnQuadraticBezier(k1(t,Cn.getPathLength(n),D=>I1([f.start.x,d[0],d[2]],[f.start.y,d[1],d[3]],D)),f.start.x,f.start.y,d[0],d[1],d[2],d[3]);case"A":const g=d[0],m=d[1],_=d[2],C=d[3],E=d[5],R=d[6];let v=d[4];return v+=E*t/f.pathLength,Cn.getPointOnEllipticalArc(g,m,_,C,v,R)}return null}static getPointOnLine(t,n,i,r,l,f,d){f=f??n,d=d??i;const g=this.getLineLength(n,i,r,l);if(g<1e-10)return{x:n,y:i};if(r===n)return{x:f,y:d+(l>i?t:-t)};const m=(l-i)/(r-n),_=Math.sqrt(t*t/(1+m*m))*(r<n?-1:1),C=m*_;if(Math.abs(d-i-m*(f-n))<1e-10)return{x:f+_,y:d+C};const E=((f-n)*(r-n)+(d-i)*(l-i))/(g*g),R=n+E*(r-n),v=i+E*(l-i),D=this.getLineLength(f,d,R,v),z=Math.sqrt(t*t-D*D),L=Math.sqrt(z*z/(1+m*m))*(r<n?-1:1),N=m*L;return{x:R+L,y:v+N}}static getPointOnCubicBezier(t,n,i,r,l,f,d,g,m){function _(z){return z*z*z}function C(z){return 3*z*z*(1-z)}function E(z){return 3*z*(1-z)*(1-z)}function R(z){return(1-z)*(1-z)*(1-z)}const v=g*_(t)+f*C(t)+r*E(t)+n*R(t),D=m*_(t)+d*C(t)+l*E(t)+i*R(t);return{x:v,y:D}}static getPointOnQuadraticBezier(t,n,i,r,l,f,d){function g(R){return R*R}function m(R){return 2*R*(1-R)}function _(R){return(1-R)*(1-R)}const C=f*g(t)+r*m(t)+n*_(t),E=d*g(t)+l*m(t)+i*_(t);return{x:C,y:E}}static getPointOnEllipticalArc(t,n,i,r,l,f){const d=Math.cos(f),g=Math.sin(f),m={x:i*Math.cos(l),y:r*Math.sin(l)};return{x:t+(m.x*d-m.y*g),y:n+(m.x*g+m.y*d)}}static parsePathData(t){if(!t)return[];let n=t;const i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let C=0;C<i.length;C++)n=n.replace(new RegExp(i[C],"g"),"|"+i[C]);const r=n.split("|"),l=[],f=[];let d=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let C=1;C<r.length;C++){let E=r[C],R=E.charAt(0);for(E=E.slice(1),f.length=0;_=m.exec(E);)f.push(_[0]);let v=[],D=R==="A"||R==="a"?0:-1;for(let z=0,L=f.length;z<L;z++){const N=f[z];if(N==="00"){v.push(0,0),D>=0&&(D+=2,D>=7&&(D-=7));continue}if(D>=0){if(D===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(N)){v.push(parseInt(N[0],10)),v.push(parseInt(N[1],10)),v.push(parseFloat(N.slice(2))),D+=3,D>=7&&(D-=7);continue}if(N==="11"||N==="10"||N==="01"){v.push(parseInt(N[0],10)),v.push(parseInt(N[1],10)),D+=2,D>=7&&(D-=7);continue}if(N==="0"||N==="1"){v.push(parseInt(N,10)),D+=1,D>=7&&(D-=7);continue}}else if(D===4){if(/^[01]\d+(?:\.\d+)?$/.test(N)){v.push(parseInt(N[0],10)),v.push(parseFloat(N.slice(1))),D+=2,D>=7&&(D-=7);continue}if(N==="0"||N==="1"){v.push(parseInt(N,10)),D+=1,D>=7&&(D-=7);continue}}const M=parseFloat(N);isNaN(M)?v.push(0):v.push(M),D+=1,D>=7&&(D-=7)}else{const M=parseFloat(N);isNaN(M)?v.push(0):v.push(M)}}for(;v.length>0&&!isNaN(v[0]);){let z="",L=[];const N=d,M=g;let G,w,O,A,y,B,U,P,Y,K;switch(R){case"l":d+=v.shift(),g+=v.shift(),z="L",L.push(d,g);break;case"L":d=v.shift(),g=v.shift(),L.push(d,g);break;case"m":const Q=v.shift(),V=v.shift();if(d+=Q,g+=V,z="M",l.length>2&&l[l.length-1].command==="z"){for(let j=l.length-2;j>=0;j--)if(l[j].command==="M"){d=l[j].points[0]+Q,g=l[j].points[1]+V;break}}L.push(d,g),R="l";break;case"M":d=v.shift(),g=v.shift(),z="M",L.push(d,g),R="L";break;case"h":d+=v.shift(),z="L",L.push(d,g);break;case"H":d=v.shift(),z="L",L.push(d,g);break;case"v":g+=v.shift(),z="L",L.push(d,g);break;case"V":g=v.shift(),z="L",L.push(d,g);break;case"C":L.push(v.shift(),v.shift(),v.shift(),v.shift()),d=v.shift(),g=v.shift(),L.push(d,g);break;case"c":L.push(d+v.shift(),g+v.shift(),d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="C",L.push(d,g);break;case"S":w=d,O=g,G=l[l.length-1],G.command==="C"&&(w=d+(d-G.points[2]),O=g+(g-G.points[3])),L.push(w,O,v.shift(),v.shift()),d=v.shift(),g=v.shift(),z="C",L.push(d,g);break;case"s":w=d,O=g,G=l[l.length-1],G.command==="C"&&(w=d+(d-G.points[2]),O=g+(g-G.points[3])),L.push(w,O,d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="C",L.push(d,g);break;case"Q":L.push(v.shift(),v.shift()),d=v.shift(),g=v.shift(),L.push(d,g);break;case"q":L.push(d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="Q",L.push(d,g);break;case"T":w=d,O=g,G=l[l.length-1],G.command==="Q"&&(w=d+(d-G.points[0]),O=g+(g-G.points[1])),d=v.shift(),g=v.shift(),z="Q",L.push(w,O,d,g);break;case"t":w=d,O=g,G=l[l.length-1],G.command==="Q"&&(w=d+(d-G.points[0]),O=g+(g-G.points[1])),d+=v.shift(),g+=v.shift(),z="Q",L.push(w,O,d,g);break;case"A":A=v.shift(),y=v.shift(),B=v.shift(),U=v.shift(),P=v.shift(),Y=d,K=g,d=v.shift(),g=v.shift(),z="A",L=this.convertEndpointToCenterParameterization(Y,K,d,g,U,P,A,y,B);break;case"a":A=v.shift(),y=v.shift(),B=v.shift(),U=v.shift(),P=v.shift(),Y=d,K=g,d+=v.shift(),g+=v.shift(),z="A",L=this.convertEndpointToCenterParameterization(Y,K,d,g,U,P,A,y,B);break}l.push({command:z||R,points:L,start:{x:N,y:M},pathLength:this.calcLength(N,M,z||R,L)})}(R==="z"||R==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(t,n,i,r){let l,f,d,g;const m=Cn;switch(i){case"L":return m.getLineLength(t,n,r[0],r[1]);case"C":return P1([t,r[0],r[2],r[4]],[n,r[1],r[3],r[5]],1);case"Q":return I1([t,r[0],r[2]],[n,r[1],r[3]],1);case"A":l=0;const _=r[4],C=r[5],E=r[4]+C;let R=Math.PI/180;if(Math.abs(_-E)<R&&(R=Math.abs(_-E)),f=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],_,0),C<0)for(g=_-R;g>E;g-=R)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),f=d;else for(g=_+R;g<E;g+=R)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),f=d;return d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],E,0),l+=m.getLineLength(f.x,f.y,d.x,d.y),l}return 0}static convertEndpointToCenterParameterization(t,n,i,r,l,f,d,g,m){const _=m*(Math.PI/180),C=Math.cos(_)*(t-i)/2+Math.sin(_)*(n-r)/2,E=-1*Math.sin(_)*(t-i)/2+Math.cos(_)*(n-r)/2,R=C*C/(d*d)+E*E/(g*g);R>1&&(d*=Math.sqrt(R),g*=Math.sqrt(R));let v=Math.sqrt((d*d*(g*g)-d*d*(E*E)-g*g*(C*C))/(d*d*(E*E)+g*g*(C*C)));l===f&&(v*=-1),isNaN(v)&&(v=0);const D=v*d*E/g,z=v*-g*C/d,L=(t+i)/2+Math.cos(_)*D-Math.sin(_)*z,N=(n+r)/2+Math.sin(_)*D+Math.cos(_)*z,M=function(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1])},G=function(U,P){return(U[0]*P[0]+U[1]*P[1])/(M(U)*M(P))},w=function(U,P){return(U[0]*P[1]<U[1]*P[0]?-1:1)*Math.acos(G(U,P))},O=w([1,0],[(C-D)/d,(E-z)/g]),A=[(C-D)/d,(E-z)/g],y=[(-1*C-D)/d,(-1*E-z)/g];let B=w(A,y);return G(A,y)<=-1&&(B=Math.PI),G(A,y)>=1&&(B=0),f===0&&B>0&&(B=B-2*Math.PI),f===1&&B<0&&(B=B+2*Math.PI),[L,N,d,g,O,B,_,f]}}Cn.prototype.className="Path";Cn.prototype._attrsAffectingSize=["data"];Bn(Cn);st.addGetterSetter(Cn,"data");class mu extends pl{_sceneFunc(t){super._sceneFunc(t);const n=Math.PI*2,i=this.points();let r=i;const l=this.tension()!==0&&i.length>4;l&&(r=this.getTensionPoints());const f=this.pointerLength(),d=i.length;let g,m;if(l){const E=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],i[d-2],i[d-1]],R=Cn.calcLength(r[r.length-4],r[r.length-3],"C",E),v=Cn.getPointOnQuadraticBezier(Math.min(1,1-f/R),E[0],E[1],E[2],E[3],E[4],E[5]);g=i[d-2]-v.x,m=i[d-1]-v.y}else g=i[d-2]-i[d-4],m=i[d-1]-i[d-3];const _=(Math.atan2(m,g)+n)%n,C=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[d-2],i[d-1]),t.rotate(_),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),l?(g=(r[0]+r[2])/2-i[0],m=(r[1]+r[3])/2-i[1]):(g=i[2]-i[0],m=i[3]-i[1]),t.rotate((Math.atan2(-m,-g)+n)%n),t.moveTo(0,0),t.lineTo(-f,C/2),t.lineTo(-f,-C/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),n=this.pointerWidth()/2;return{x:t.x,y:t.y-n,width:t.width,height:t.height+n*2}}}mu.prototype.className="Arrow";Bn(mu);st.addGetterSetter(mu,"pointerLength",10,It());st.addGetterSetter(mu,"pointerWidth",10,It());st.addGetterSetter(mu,"pointerAtBeginning",!1);st.addGetterSetter(mu,"pointerAtEnding",!0);class gf extends jt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}gf.prototype._centroid=!0;gf.prototype.className="Circle";gf.prototype._attrsAffectingSize=["radius"];Bn(gf);st.addGetterSetter(gf,"radius",0,It());class fo extends jt{_sceneFunc(t){const n=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),n!==i&&t.scale(1,i/n),t.arc(0,0,n,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}fo.prototype.className="Ellipse";fo.prototype._centroid=!0;fo.prototype._attrsAffectingSize=["radiusX","radiusY"];Bn(fo);st.addComponentsGetterSetter(fo,"radius",["x","y"]);st.addGetterSetter(fo,"radiusX",0,It());st.addGetterSetter(fo,"radiusY",0,It());let Hr=class J2 extends jt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),n=this.hasShadow();return t&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const n=this.getWidth(),i=this.getHeight(),r=this.cornerRadius(),l=this.attrs.image;let f;if(l){const d=this.attrs.cropWidth,g=this.attrs.cropHeight;d&&g?f=[l,this.cropX(),this.cropY(),d,g,0,0,n,i]:f=[l,0,0,n,i]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?vt.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)),l&&(r&&t.clip(),t.drawImage.apply(t,f))}_hitFunc(t){const n=this.width(),i=this.height(),r=this.cornerRadius();t.beginPath(),r?vt.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,n,i;return(i=(t=this.attrs.width)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&i!==void 0?i:0}getHeight(){var t,n,i;return(i=(t=this.attrs.height)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&i!==void 0?i:0}static fromURL(t,n,i=null){const r=vt.createImageElement();r.onload=function(){const l=new J2({image:r});n(l)},r.onerror=i,r.crossOrigin="Anonymous",r.src=t}};Hr.prototype.className="Image";Hr.prototype._attrsAffectingSize=["image"];Bn(Hr);st.addGetterSetter(Hr,"cornerRadius",0,Og(4));st.addGetterSetter(Hr,"image");st.addComponentsGetterSetter(Hr,"crop",["x","y","width","height"]);st.addGetterSetter(Hr,"cropX",0,It());st.addGetterSetter(Hr,"cropY",0,It());st.addGetterSetter(Hr,"cropWidth",0,It());st.addGetterSetter(Hr,"cropHeight",0,It());const Z2=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],A5="Change.konva",O5="none",xm="up",Mm="right",Nm="down",Dm="left",R5=Z2.length;class ev extends sf{constructor(t){super(t),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let n=this,i;const r=function(){n._sync()};for(i=0;i<R5;i++)t.on(Z2[i]+A5,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),n=this.getTag(),i,r,l,f,d,g,m;if(t&&n){switch(i=t.width(),r=t.height(),l=n.pointerDirection(),f=n.pointerWidth(),m=n.pointerHeight(),d=0,g=0,l){case xm:d=i/2,g=-1*m;break;case Mm:d=i+f,g=r/2;break;case Nm:d=i/2,g=r+m;break;case Dm:d=-1*f,g=r/2;break}n.setAttrs({x:-1*d,y:-1*g,width:i,height:r}),t.setAttrs({x:-1*d,y:-1*g})}}}ev.prototype.className="Label";Bn(ev);class vu extends jt{_sceneFunc(t){const n=this.width(),i=this.height(),r=this.pointerDirection(),l=this.pointerWidth(),f=this.pointerHeight(),d=this.cornerRadius();let g=0,m=0,_=0,C=0;typeof d=="number"?g=m=_=C=Math.min(d,n/2,i/2):(g=Math.min(d[0]||0,n/2,i/2),m=Math.min(d[1]||0,n/2,i/2),C=Math.min(d[2]||0,n/2,i/2),_=Math.min(d[3]||0,n/2,i/2)),t.beginPath(),t.moveTo(g,0),r===xm&&(t.lineTo((n-l)/2,0),t.lineTo(n/2,-1*f),t.lineTo((n+l)/2,0)),t.lineTo(n-m,0),t.arc(n-m,m,m,Math.PI*3/2,0,!1),r===Mm&&(t.lineTo(n,(i-f)/2),t.lineTo(n+l,i/2),t.lineTo(n,(i+f)/2)),t.lineTo(n,i-C),t.arc(n-C,i-C,C,0,Math.PI/2,!1),r===Nm&&(t.lineTo((n+l)/2,i),t.lineTo(n/2,i+f),t.lineTo((n-l)/2,i)),t.lineTo(_,i),t.arc(_,i-_,_,Math.PI/2,Math.PI,!1),r===Dm&&(t.lineTo(0,(i+f)/2),t.lineTo(-1*l,i/2),t.lineTo(0,(i-f)/2)),t.lineTo(0,g),t.arc(g,g,g,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,n=0,i=this.pointerWidth(),r=this.pointerHeight(),l=this.pointerDirection(),f=this.width(),d=this.height();return l===xm?(n-=r,d+=r):l===Nm?d+=r:l===Dm?(t-=i*1.5,f+=i):l===Mm&&(f+=i*1.5),{x:t,y:n,width:f,height:d}}}vu.prototype.className="Tag";Bn(vu);st.addGetterSetter(vu,"pointerDirection",O5);st.addGetterSetter(vu,"pointerWidth",0,It());st.addGetterSetter(vu,"pointerHeight",0,It());st.addGetterSetter(vu,"cornerRadius",0,Og(4));class gd extends jt{_sceneFunc(t){const n=this.cornerRadius(),i=this.width(),r=this.height();t.beginPath(),n?vt.drawRoundedRectPath(t,i,r,n):t.rect(0,0,i,r),t.closePath(),t.fillStrokeShape(this)}}gd.prototype.className="Rect";Bn(gd);st.addGetterSetter(gd,"cornerRadius",0,Og(4));class ho extends jt{_sceneFunc(t){const n=this._getPoints(),i=this.radius(),r=this.sides(),l=this.cornerRadius();if(t.beginPath(),l)vt.drawRoundedPolygonPath(t,n,r,i,l);else{t.moveTo(n[0].x,n[0].y);for(let f=1;f<n.length;f++)t.lineTo(n[f].x,n[f].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,n=this.attrs.radius||0,i=[];for(let r=0;r<t;r++)i.push({x:n*Math.sin(r*2*Math.PI/t),y:-1*n*Math.cos(r*2*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();let n=t[0].x,i=t[0].y,r=t[0].x,l=t[0].y;return t.forEach(f=>{n=Math.min(n,f.x),i=Math.max(i,f.x),r=Math.min(r,f.y),l=Math.max(l,f.y)}),{x:n,y:r,width:i-n,height:l-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}ho.prototype.className="RegularPolygon";ho.prototype._centroid=!0;ho.prototype._attrsAffectingSize=["radius"];Bn(ho);st.addGetterSetter(ho,"radius",0,It());st.addGetterSetter(ho,"sides",0,It());st.addGetterSetter(ho,"cornerRadius",0,Og(4));const q1=Math.PI*2;class yu extends jt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,q1,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),q1,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}yu.prototype.className="Ring";yu.prototype._centroid=!0;yu.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Bn(yu);st.addGetterSetter(yu,"innerRadius",0,It());st.addGetterSetter(yu,"outerRadius",0,It());class ms extends jt{constructor(t){super(t),this._updated=!0,this.anim=new or(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const n=this.animation(),i=this.frameIndex(),r=i*4,l=this.animations()[n],f=this.frameOffsets(),d=l[r+0],g=l[r+1],m=l[r+2],_=l[r+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,m,_),t.closePath(),t.fillStrokeShape(this)),C)if(f){const E=f[n],R=i*2;t.drawImage(C,d,g,m,_,E[R+0],E[R+1],m,_)}else t.drawImage(C,d,g,m,_,0,0,m,_)}_hitFunc(t){const n=this.animation(),i=this.frameIndex(),r=i*4,l=this.animations()[n],f=this.frameOffsets(),d=l[r+2],g=l[r+3];if(t.beginPath(),f){const m=f[n],_=i*2;t.rect(m[_+0],m[_+1],d,g)}else t.rect(0,0,d,g);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),n=this.animation(),i=this.animations(),r=i[n],l=r.length/4;t<l-1?this.frameIndex(t+1):this.frameIndex(0)}}ms.prototype.className="Sprite";Bn(ms);st.addGetterSetter(ms,"animation");st.addGetterSetter(ms,"animations");st.addGetterSetter(ms,"frameOffsets");st.addGetterSetter(ms,"image");st.addGetterSetter(ms,"frameIndex",0,It());st.addGetterSetter(ms,"frameRate",17,It());st.backCompat(ms,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class go extends jt{_sceneFunc(t){const n=this.innerRadius(),i=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(let l=1;l<r*2;l++){const f=l%2===0?i:n,d=f*Math.sin(l*Math.PI/r),g=-1*f*Math.cos(l*Math.PI/r);t.lineTo(d,g)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}go.prototype.className="Star";go.prototype._centroid=!0;go.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Bn(go);st.addGetterSetter(go,"numPoints",5,It());st.addGetterSetter(go,"innerRadius",0,It());st.addGetterSetter(go,"outerRadius",0,It());function ro(o){return[...o].reduce((t,n,i,r)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const l=r[i+1];l&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(l)?(t.push(n+l),r[i+1]=""):t.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(r[i+1]||""))?t.push(n+r[i+1]):i>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?t[t.length-1]+=n:n&&t.push(n);return t},[])}const Yc="auto",w5="center",W2="inherit",Kc="justify",x5="Change.konva",M5="2d",V1="-",$2="left",N5="text",D5="Text",j5="top",U5="bottom",Y1="middle",tS="normal",B5="px ",Z0=" ",z5="right",K1="rtl",L5="word",G5="char",Q1="none",Rp="…",eS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],H5=eS.length;function P5(o){return o.split(",").map(t=>{t=t.trim();const n=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return n&&!i&&(t=`"${t}"`),t}).join(", ")}let W0;function wp(){return W0||(W0=vt.createCanvasElement().getContext(M5),W0)}function I5(o){o.fillText(this._partialText,this._partialTextX,this._partialTextY)}function k5(o){o.setAttr("miterLimit",2),o.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function q5(o){return o=o||{},!o.fillLinearGradientColorStops&&!o.fillRadialGradientColorStops&&!o.fillPatternImage&&(o.fill=o.fill||"black"),o}class Rn extends jt{constructor(t){super(q5(t)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<H5;n++)this.on(eS[n]+x5,this._setTextData);this._setTextData()}_sceneFunc(t){var n,i;const r=this.textArr,l=r.length;if(!this.text())return;let f=this.padding(),d=this.fontSize(),g=this.lineHeight()*d,m=this.verticalAlign(),_=this.direction(),C=0,E=this.align(),R=this.getWidth(),v=this.letterSpacing(),D=this.charRenderFunc(),z=this.fill(),L=this.textDecoration(),N=L.indexOf("underline")!==-1,M=L.indexOf("line-through")!==-1,G;_=_===W2?t.direction:_;let w=g/2,O=Y1;if(!Vt.legacyTextRendering){const A=this.measureSize("M");O="alphabetic";const y=(n=A.fontBoundingBoxAscent)!==null&&n!==void 0?n:A.actualBoundingBoxAscent,B=(i=A.fontBoundingBoxDescent)!==null&&i!==void 0?i:A.actualBoundingBoxDescent;w=(y-B)/2+g/2}for(_===K1&&t.setAttr("direction",_),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",O),t.setAttr("textAlign",$2),m===Y1?C=(this.getHeight()-l*g-f*2)/2:m===U5&&(C=this.getHeight()-l*g-f*2),t.translate(f,C+f),G=0;G<l;G++){let A=0,y=0;const B=r[G],U=B.text,P=B.width,Y=B.lastInParagraph;if(t.save(),E===z5?A+=R-P-f*2:E===w5&&(A+=(R-P-f*2)/2),N){t.save(),t.beginPath();const K=Vt.legacyTextRendering?Math.round(d/2):Math.round(d/4),Q=A,V=w+y+K;t.moveTo(Q,V);const j=E===Kc&&!Y?R-f*2:P;t.lineTo(Q+Math.round(j),V),t.lineWidth=d/15;const I=this._getLinearGradient();t.strokeStyle=I||z,t.stroke(),t.restore()}if(_!==K1&&(v!==0||E===Kc||D)){const K=U.split(" ").length-1,Q=ro(U);for(let V=0;V<Q.length;V++){const j=Q[V];if(j===" "&&!Y&&E===Kc&&(A+=(R-f*2-P)/K),this._partialTextX=A,this._partialTextY=w+y,this._partialText=j,D){t.save();const X=r.slice(0,G).reduce((at,J)=>at+ro(J.text).length,0),W=V+X;D({char:j,index:W,x:A,y:w+y,lineIndex:G,column:V,isLastInLine:Y,width:this.measureSize(j).width,context:t})}t.fillStrokeShape(this),D&&t.restore(),A+=this.measureSize(j).width+v}}else v!==0&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=A,this._partialTextY=w+y,this._partialText=U,t.fillStrokeShape(this);if(M){t.save(),t.beginPath();const K=Vt.legacyTextRendering?0:-Math.round(d/4),Q=E===Kc?0:A;t.moveTo(Q,w+y+K);const V=E===Kc&&!Y?R-f*2:P;t.lineTo(Q+Math.round(V),w+y+K),t.lineWidth=d/15;const j=this._getLinearGradient();t.strokeStyle=j||z,t.stroke(),t.restore()}t.restore(),l>1&&(w+=g)}}_hitFunc(t){const n=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}setText(t){const n=vt._isString(t)?t:t==null?"":t+"";return this._setAttr(N5,n),this}getWidth(){return this.attrs.width===Yc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Yc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return vt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var n,i,r,l,f,d,g,m,_,C,E;let R=wp(),v=this.fontSize(),D;R.save(),R.font=this._getContextFont(),D=R.measureText(t),R.restore();const z=v/100;return{actualBoundingBoxAscent:(n=D.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*z,actualBoundingBoxDescent:(i=D.actualBoundingBoxDescent)!==null&&i!==void 0?i:0,actualBoundingBoxLeft:(r=D.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*z,actualBoundingBoxRight:(l=D.actualBoundingBoxRight)!==null&&l!==void 0?l:75.732421875*z,alphabeticBaseline:(f=D.alphabeticBaseline)!==null&&f!==void 0?f:0,emHeightAscent:(d=D.emHeightAscent)!==null&&d!==void 0?d:100*z,emHeightDescent:(g=D.emHeightDescent)!==null&&g!==void 0?g:-20*z,fontBoundingBoxAscent:(m=D.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*z,fontBoundingBoxDescent:(_=D.fontBoundingBoxDescent)!==null&&_!==void 0?_:21*z,hangingBaseline:(C=D.hangingBaseline)!==null&&C!==void 0?C:72.80000305175781*z,ideographicBaseline:(E=D.ideographicBaseline)!==null&&E!==void 0?E:-21*z,width:D.width,height:v}}_getContextFont(){return this.fontStyle()+Z0+this.fontVariant()+Z0+(this.fontSize()+B5)+P5(this.fontFamily())}_addTextLine(t){this.align()===Kc&&(t=t.trim());const i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){const n=this.letterSpacing(),i=t.length;return wp().measureText(t).width+n*i}_setTextData(){let t=this.text().split(`
`),n=+this.fontSize(),i=0,r=this.lineHeight()*n,l=this.attrs.width,f=this.attrs.height,d=l!==Yc&&l!==void 0,g=f!==Yc&&f!==void 0,m=this.padding(),_=l-m*2,C=f-m*2,E=0,R=this.wrap(),v=R!==Q1,D=R!==G5&&v,z=this.ellipsis();this.textArr=[],wp().font=this._getContextFont();const L=z?this._getTextWidth(Rp):0;for(let N=0,M=t.length;N<M;++N){let G=t[N],w=this._getTextWidth(G);if(d&&w>_)for(;G.length>0;){let O=0,A=ro(G).length,y="",B=0;for(;O<A;){const U=O+A>>>1,P=ro(G),Y=P.slice(0,U+1).join(""),K=this._getTextWidth(Y);(z&&g&&E+r>C?K+L:K)<=_?(O=U+1,y=Y,B=K):A=U}if(y){if(D){const Y=ro(G),K=ro(y),Q=Y[K.length],V=Q===Z0||Q===V1;let j;if(V&&B<=_)j=K.length;else{const I=K.lastIndexOf(Z0),X=K.lastIndexOf(V1);j=Math.max(I,X)+1}j>0&&(O=j,y=Y.slice(0,O).join(""),B=this._getTextWidth(y))}if(y=y.trimRight(),this._addTextLine(y),i=Math.max(i,B),E+=r,this._shouldHandleEllipsis(E)){this._tryToAddEllipsisToLastLine();break}if(G=ro(G).slice(O).join("").trimLeft(),G.length>0&&(w=this._getTextWidth(G),w<=_)){this._addTextLine(G),E+=r,i=Math.max(i,w);break}}else break}else this._addTextLine(G),E+=r,i=Math.max(i,w),this._shouldHandleEllipsis(E)&&N<M-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&E+r>C)break}this.textHeight=n,this.textWidth=i}_shouldHandleEllipsis(t){const n=+this.fontSize(),i=this.lineHeight()*n,r=this.attrs.height,l=r!==Yc&&r!==void 0,f=this.padding(),d=r-f*2;return!(this.wrap()!==Q1)||l&&t+i>d}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,n=t!==Yc&&t!==void 0,i=this.padding(),r=t-i*2,l=this.ellipsis(),f=this.textArr[this.textArr.length-1];!f||!l||(n&&(this._getTextWidth(f.text+Rp)<r||(f.text=f.text.slice(0,f.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(f.text+Rp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return t&&n?!0:super._useBufferCanvas()}}Rn.prototype._fillFunc=I5;Rn.prototype._strokeFunc=k5;Rn.prototype.className=D5;Rn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Bn(Rn);st.overWriteSetter(Rn,"width",Wm());st.overWriteSetter(Rn,"height",Wm());st.addGetterSetter(Rn,"direction",W2);st.addGetterSetter(Rn,"fontFamily","Arial");st.addGetterSetter(Rn,"fontSize",12,It());st.addGetterSetter(Rn,"fontStyle",tS);st.addGetterSetter(Rn,"fontVariant",tS);st.addGetterSetter(Rn,"padding",0,It());st.addGetterSetter(Rn,"align",$2);st.addGetterSetter(Rn,"verticalAlign",j5);st.addGetterSetter(Rn,"lineHeight",1,It());st.addGetterSetter(Rn,"wrap",L5);st.addGetterSetter(Rn,"ellipsis",!1,Gr());st.addGetterSetter(Rn,"letterSpacing",0,It());st.addGetterSetter(Rn,"text","",gu());st.addGetterSetter(Rn,"textDecoration","");st.addGetterSetter(Rn,"charRenderFunc",void 0);const V5="",nS="normal";function iS(o){o.fillText(this.partialText,0,0)}function aS(o){o.strokeText(this.partialText,0,0)}class di extends jt{constructor(t){super(t),this.dummyCanvas=vt.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Cn.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const n=this.pathLength;return t>n?null:Cn.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Cn.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const n=this.textDecoration(),i=this.fill(),r=this.fontSize(),l=this.glyphInfo,f=n.indexOf("underline")!==-1,d=n.indexOf("line-through")!==-1;f&&t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),this.partialText=l[g].text,t.fillStrokeShape(this),f&&(g===0&&t.moveTo(0,r/2+1),t.lineTo(l[g].width,r/2+1)),t.restore()}if(f&&(t.strokeStyle=i,t.lineWidth=r/20,t.stroke()),d){t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),g===0&&t.moveTo(0,0),t.lineTo(l[g].width,0),t.restore()}t.strokeStyle=i,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const n=this.glyphInfo;if(n.length>=1){const i=n[0].p0;t.moveTo(i.x,i.y)}for(let i=0;i<n.length;i++){const r=n[i].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return vt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Rn.prototype.setText.call(this,t)}_getContextFont(){return Rn.prototype._getContextFont.call(this)}_getTextSize(t){const i=this.dummyCanvas.getContext("2d");i.save(),i.font=this._getContextFont();const r=i.measureText(t);return i.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=ro(this.text()),n=[];let i=0;for(let C=0;C<t.length;C++)n.push({char:t[C],width:this._getTextSize(t[C]).width}),i+=n[C].width;const{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=i,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const l=this.letterSpacing(),f=this.align(),d=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*l,0);let m=0;f==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),f==="right"&&(m=Math.max(0,this.pathLength-g));let _=m;for(let C=0;C<n.length;C++){const E=this._getPointAtLength(_);if(!E)return;const R=n[C].char;let v=n[C].width+l;if(R===" "&&f==="justify"){const G=this.text().split(" ").length-1;v+=(this.pathLength-g)/G}const D=this._getPointAtLength(_+v);if(!D)return;const z=Cn.getLineLength(E.x,E.y,D.x,D.y);let L=0;if(d)try{L=d(n[C-1].char,R)*this.fontSize()}catch{L=0}E.x+=L,D.x+=L,this.textWidth+=L;const N=Cn.getPointOnLine(L+z/2,E.x,E.y,D.x,D.y),M=Math.atan2(D.y-E.y,D.x-E.x);this.glyphInfo.push({transposeX:N.x,transposeY:N.y,text:t[C],rotation:M,p0:E,p1:D,width:z}),_+=v}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});let n=t[0]||0,i=t[0]||0,r=t[1]||0,l=t[1]||0,f,d;for(let m=0;m<t.length/2;m++)f=t[m*2],d=t[m*2+1],n=Math.min(n,f),i=Math.max(i,f),r=Math.min(r,d),l=Math.max(l,d);const g=this.fontSize();return{x:n-g/2,y:r-g/2,width:i-n+g,height:l-r+g}}destroy(){return vt.releaseCanvas(this.dummyCanvas),super.destroy()}}di.prototype._fillFunc=iS;di.prototype._strokeFunc=aS;di.prototype._fillFuncHit=iS;di.prototype._strokeFuncHit=aS;di.prototype.className="TextPath";di.prototype._attrsAffectingSize=["text","fontSize","data"];Bn(di);st.addGetterSetter(di,"data");st.addGetterSetter(di,"fontFamily","Arial");st.addGetterSetter(di,"fontSize",12,It());st.addGetterSetter(di,"fontStyle",nS);st.addGetterSetter(di,"align","left");st.addGetterSetter(di,"letterSpacing",0,It());st.addGetterSetter(di,"textBaseline","middle");st.addGetterSetter(di,"fontVariant",nS);st.addGetterSetter(di,"text",V5);st.addGetterSetter(di,"textDecoration","");st.addGetterSetter(di,"kerningFunc",void 0);const rS="tr-konva",Y5=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(o=>o+`.${rS}`).join(" "),X1="nodesRect",K5=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],Q5={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},X5="ontouchstart"in Vt._global;function F5(o,t,n){if(o==="rotater")return n;t+=vt.degToRad(Q5[o]||0);const i=(vt.radToDeg(t)%360+360)%360;return vt._inRange(i,315+22.5,360)||vt._inRange(i,0,22.5)?"ns-resize":vt._inRange(i,45-22.5,45+22.5)?"nesw-resize":vt._inRange(i,90-22.5,90+22.5)?"ew-resize":vt._inRange(i,135-22.5,135+22.5)?"nwse-resize":vt._inRange(i,180-22.5,180+22.5)?"ns-resize":vt._inRange(i,225-22.5,225+22.5)?"nesw-resize":vt._inRange(i,270-22.5,270+22.5)?"ew-resize":vt._inRange(i,315-22.5,315+22.5)?"nwse-resize":(vt.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}const gg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function J5(o){return{x:o.x+o.width/2*Math.cos(o.rotation)+o.height/2*Math.sin(-o.rotation),y:o.y+o.height/2*Math.cos(o.rotation)+o.width/2*Math.sin(o.rotation)}}function sS(o,t,n){const i=n.x+(o.x-n.x)*Math.cos(t)-(o.y-n.y)*Math.sin(t),r=n.y+(o.x-n.x)*Math.sin(t)+(o.y-n.y)*Math.cos(t);return{...o,rotation:o.rotation+t,x:i,y:r}}function Z5(o,t){const n=J5(o);return sS(o,t,n)}function W5(o,t,n){let i=t;for(let r=0;r<o.length;r++){const l=Vt.getAngle(o[r]),f=Math.abs(l-t)%(Math.PI*2);Math.min(f,Math.PI*2-f)<n&&(i=l)}return i}let jm=0;class Pe extends sf{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Y5,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return vt.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return rS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const n=t.filter(r=>r.isAncestorOf(this)?(vt.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=n,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){const f=r._attrsAffectingSize.map(d=>d+"Change."+this._getEventNamespace()).join(" ");r.on(f,l)}r.on(K5.map(f=>f+`.${this._getEventNamespace()}`).join(" "),l),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let n;t.on(`dragstart.${this._getEventNamespace()}`,i=>{n=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(i,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!n)return;const r=t.getAbsolutePosition(),l=r.x-n.x,f=r.y-n.y;this.nodes().forEach(d=>{if(d===t||d.isDragging())return;const g=d.getAbsolutePosition();d.setAbsolutePosition({x:g.x+l,y:g.y+f}),d.startDrag(i)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(X1),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(X1,this.__getNodeRect)}__getNodeShape(t,n=this.rotation(),i){const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=t.getAbsoluteScale(i),f=t.getAbsolutePosition(i),d=r.x*l.x-t.offsetX()*l.x,g=r.y*l.y-t.offsetY()*l.y,m=(Vt.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),_={x:f.x+d*Math.cos(m)+g*Math.sin(-m),y:f.y+g*Math.cos(m)+d*Math.sin(m),width:r.width*l.x,height:r.height*l.y,rotation:m};return sS(_,-Vt.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const _=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),C=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}],E=m.getAbsoluteTransform();C.forEach(function(R){const v=E.point(R);n.push(v)})});const i=new Da;i.rotate(-Vt.getAngle(this.rotation()));let r=1/0,l=1/0,f=-1/0,d=-1/0;n.forEach(function(m){const _=i.point(m);r===void 0&&(r=f=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),f=Math.max(f,_.x),d=Math.max(d,_.y)}),i.invert();const g=i.point({x:r,y:l});return{x:g.x,y:g.y,width:f-r,height:d-l,rotation:Vt.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),gg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const n=new gd({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:X5?10:"auto"}),i=this;n.on("mousedown touchstart",function(r){i._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{const r=Vt.getAngle(this.rotation()),l=this.rotateAnchorCursor(),f=F5(t,r,l);n.getStage().content&&(n.getStage().content.style.cursor=f),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const t=new jt({name:"back",width:0,height:0,sceneFunc(n,i){const r=i.getParent(),l=r.padding();n.beginPath(),n.rect(-l,-l,i.width()+l*2,i.height()+l*2),n.moveTo(i.width()/2,-l),r.rotateEnabled()&&r.rotateLineVisible()&&n.lineTo(i.width()/2,-r.rotateAnchorOffset()*vt._sign(i.height())-l),n.fillStrokeShape(i)},hitFunc:(n,i)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();n.beginPath(),n.rect(-r,-r,i.width()+r*2,i.height()+r*2),n.fillStrokeShape(i)}});this.add(t),this._proxyDrag(t),t.on("dragstart",n=>{n.cancelBubble=!0}),t.on("dragmove",n=>{n.cancelBubble=!0}),t.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const n=this._getNodeRect(),i=n.width,r=n.height,l=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));this.sin=Math.abs(r/l),this.cos=Math.abs(i/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const f=t.target.getAbsolutePosition(),d=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:d.x-f.x,y:d.y-f.y},jm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:t.evt,target:g})})}_handleMouseMove(t){let n,i,r;const l=this.findOne("."+this._movingAnchorName),f=l.getStage();f.setPointersPositions(t);const d=f.getPointerPosition();let g={x:d.x-this._anchorDragOffset.x,y:d.y-this._anchorDragOffset.y};const m=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,t)),l.setAbsolutePosition(g);const _=l.getAbsolutePosition();if(m.x===_.x&&m.y===_.y)return;if(this._movingAnchorName==="rotater"){const N=this._getNodeRect();n=l.x()-N.width/2,i=-l.y()+N.height/2;let M=Math.atan2(-i,n)+Math.PI/2;N.height<0&&(M-=Math.PI);const w=Vt.getAngle(this.rotation())+M,O=Vt.getAngle(this.rotationSnapTolerance()),y=W5(this.rotationSnaps(),w,O)-N.rotation,B=Z5(N,y);this._fitNodesInto(B,t);return}const C=this.shiftBehavior();let E;C==="inverted"?E=this.keepRatio()&&!t.shiftKey:C==="none"?E=this.keepRatio():E=this.keepRatio()||t.shiftKey;let R=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(N.x-l.x(),2)+Math.pow(N.y-l.y(),2));const M=this.findOne(".top-left").x()>N.x?-1:1,G=this.findOne(".top-left").y()>N.y?-1:1;n=r*this.cos*M,i=r*this.sin*G,this.findOne(".top-left").x(N.x-n),this.findOne(".top-left").y(N.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(l.x()-N.x,2)+Math.pow(N.y-l.y(),2));const M=this.findOne(".top-right").x()<N.x?-1:1,G=this.findOne(".top-right").y()>N.y?-1:1;n=r*this.cos*M,i=r*this.sin*G,this.findOne(".top-right").x(N.x+n),this.findOne(".top-right").y(N.y-i)}var v=l.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(N.x-l.x(),2)+Math.pow(l.y()-N.y,2));const M=N.x<l.x()?-1:1,G=l.y()<N.y?-1:1;n=r*this.cos*M,i=r*this.sin*G,l.x(N.x-n),l.y(N.y+i)}v=l.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(E){const N=R?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(l.x()-N.x,2)+Math.pow(l.y()-N.y,2));const M=this.findOne(".bottom-right").x()<N.x?-1:1,G=this.findOne(".bottom-right").y()<N.y?-1:1;n=r*this.cos*M,i=r*this.sin*G,this.findOne(".bottom-right").x(N.x+n),this.findOne(".bottom-right").y(N.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(R=this.centeredScaling()||t.altKey,R){const N=this.findOne(".top-left"),M=this.findOne(".bottom-right"),G=N.x(),w=N.y(),O=this.getWidth()-M.x(),A=this.getHeight()-M.y();M.move({x:-G,y:-w}),N.move({x:O,y:A})}const D=this.findOne(".top-left").getAbsolutePosition();n=D.x,i=D.y;const z=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),L=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:i,width:z,height:L,rotation:Vt.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const i=this.getNode();jm--,this._fire("transformend",{evt:t,target:i}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),i&&this._nodes.forEach(r=>{var l;r._fire("transformend",{evt:t,target:r}),(l=r.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,n){const i=this._getNodeRect(),r=1;if(vt._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(vt._inRange(t.height,-this.padding()*2-r,r)){this.update();return}const l=new Da;if(l.rotate(Vt.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=l.point({x:-this.padding()*2,y:0});t.x+=E.x,t.y+=E.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=l.point({x:0,y:-this.padding()*2});t.x+=E.x,t.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(i,t);E?t=E:vt.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const f=1e7,d=new Da;d.translate(i.x,i.y),d.rotate(i.rotation),d.scale(i.width/f,i.height/f);const g=new Da,m=t.width/f,_=t.height/f;this.flipEnabled()===!1?(g.translate(t.x,t.y),g.rotate(t.rotation),g.translate(t.width<0?t.width:0,t.height<0?t.height:0),g.scale(Math.abs(m),Math.abs(_))):(g.translate(t.x,t.y),g.rotate(t.rotation),g.scale(m,_));const C=g.multiply(d.invert());this._nodes.forEach(E=>{var R;if(!E.getStage())return;const v=E.getParent().getAbsoluteTransform(),D=E.getTransform().copy();D.translate(E.offsetX(),E.offsetY());const z=new Da;z.multiply(v.copy().invert()).multiply(C).multiply(v).multiply(D);const L=z.decompose();E.setAttrs(L),(R=E.getLayer())===null||R===void 0||R.batchDraw()}),this.rotation(vt._getRotation(t.rotation)),this._nodes.forEach(E=>{this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,n){this.findOne(t).setAttrs(n)}update(){var t;const n=this._getNodeRect();this.rotation(vt._getRotation(n.rotation));const i=n.width,r=n.height,l=this.enabledAnchors(),f=this.resizeEnabled(),d=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(C=>{C.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+d,offsetY:g/2+d,visible:f&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:g/2+d,visible:f&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:g/2-d,offsetY:g/2+d,visible:f&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:g/2+d,visible:f&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:r/2,offsetX:g/2-d,visible:f&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:g/2+d,offsetY:g/2-d,visible:f&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:r,offsetY:g/2-d,visible:f&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:r,offsetX:g/2-d,offsetY:g/2-d,visible:f&&l.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*vt._sign(r)-d,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(C=>C.draggable()),x:0,y:0});const _=this.anchorStyleFunc();_&&m.forEach(C=>{_(C)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),sf.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Pt.prototype.toObject.call(this)}clone(t){return Pt.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Pe.isTransforming=()=>jm>0;function $5(o){return o instanceof Array||vt.warn("enabledAnchors value should be an array"),o instanceof Array&&o.forEach(function(t){gg.indexOf(t)===-1&&vt.warn("Unknown anchor name: "+t+". Available names are: "+gg.join(", "))}),o||[]}Pe.prototype.className="Transformer";Bn(Pe);st.addGetterSetter(Pe,"enabledAnchors",gg,$5);st.addGetterSetter(Pe,"flipEnabled",!0,Gr());st.addGetterSetter(Pe,"resizeEnabled",!0);st.addGetterSetter(Pe,"anchorSize",10,It());st.addGetterSetter(Pe,"rotateEnabled",!0);st.addGetterSetter(Pe,"rotateLineVisible",!0);st.addGetterSetter(Pe,"rotationSnaps",[]);st.addGetterSetter(Pe,"rotateAnchorOffset",50,It());st.addGetterSetter(Pe,"rotateAnchorCursor","crosshair");st.addGetterSetter(Pe,"rotationSnapTolerance",5,It());st.addGetterSetter(Pe,"borderEnabled",!0);st.addGetterSetter(Pe,"anchorStroke","rgb(0, 161, 255)");st.addGetterSetter(Pe,"anchorStrokeWidth",1,It());st.addGetterSetter(Pe,"anchorFill","white");st.addGetterSetter(Pe,"anchorCornerRadius",0,It());st.addGetterSetter(Pe,"borderStroke","rgb(0, 161, 255)");st.addGetterSetter(Pe,"borderStrokeWidth",1,It());st.addGetterSetter(Pe,"borderDash");st.addGetterSetter(Pe,"keepRatio",!0);st.addGetterSetter(Pe,"shiftBehavior","default");st.addGetterSetter(Pe,"centeredScaling",!1);st.addGetterSetter(Pe,"ignoreStroke",!1);st.addGetterSetter(Pe,"padding",0,It());st.addGetterSetter(Pe,"nodes");st.addGetterSetter(Pe,"node");st.addGetterSetter(Pe,"boundBoxFunc");st.addGetterSetter(Pe,"anchorDragBoundFunc");st.addGetterSetter(Pe,"anchorStyleFunc");st.addGetterSetter(Pe,"shouldOverdrawWholeArea",!1);st.addGetterSetter(Pe,"useSingleNodeRotation",!0);st.backCompat(Pe,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class ml extends jt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Vt.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}ml.prototype.className="Wedge";ml.prototype._centroid=!0;ml.prototype._attrsAffectingSize=["radius"];Bn(ml);st.addGetterSetter(ml,"radius",0,It());st.addGetterSetter(ml,"angle",0,It());st.addGetterSetter(ml,"clockwise",!1);st.backCompat(ml,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function F1(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const t6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],e6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function n6(o,t){const n=o.data,i=o.width,r=o.height;let l,f,d,g,m,_,C,E,R,v,D,z,L,N,M,G,w,O,A,y;const B=t+t+1,U=i-1,P=r-1,Y=t+1,K=Y*(Y+1)/2,Q=new F1,V=t6[t],j=e6[t];let I=null,X=Q,W=null,at=null;for(let J=1;J<B;J++)X=X.next=new F1,J===Y&&(I=X);X.next=Q,d=f=0;for(let J=0;J<r;J++){z=L=N=M=g=m=_=C=0,E=Y*(G=n[f]),R=Y*(w=n[f+1]),v=Y*(O=n[f+2]),D=Y*(A=n[f+3]),g+=K*G,m+=K*w,_+=K*O,C+=K*A,X=Q;for(let rt=0;rt<Y;rt++)X.r=G,X.g=w,X.b=O,X.a=A,X=X.next;for(let rt=1;rt<Y;rt++)l=f+((U<rt?U:rt)<<2),g+=(X.r=G=n[l])*(y=Y-rt),m+=(X.g=w=n[l+1])*y,_+=(X.b=O=n[l+2])*y,C+=(X.a=A=n[l+3])*y,z+=G,L+=w,N+=O,M+=A,X=X.next;W=Q,at=I;for(let rt=0;rt<i;rt++)n[f+3]=A=C*V>>j,A!==0?(A=255/A,n[f]=(g*V>>j)*A,n[f+1]=(m*V>>j)*A,n[f+2]=(_*V>>j)*A):n[f]=n[f+1]=n[f+2]=0,g-=E,m-=R,_-=v,C-=D,E-=W.r,R-=W.g,v-=W.b,D-=W.a,l=d+((l=rt+t+1)<U?l:U)<<2,z+=W.r=n[l],L+=W.g=n[l+1],N+=W.b=n[l+2],M+=W.a=n[l+3],g+=z,m+=L,_+=N,C+=M,W=W.next,E+=G=at.r,R+=w=at.g,v+=O=at.b,D+=A=at.a,z-=G,L-=w,N-=O,M-=A,at=at.next,f+=4;d+=i}for(let J=0;J<i;J++){L=N=M=z=m=_=C=g=0,f=J<<2,E=Y*(G=n[f]),R=Y*(w=n[f+1]),v=Y*(O=n[f+2]),D=Y*(A=n[f+3]),g+=K*G,m+=K*w,_+=K*O,C+=K*A,X=Q;for(let it=0;it<Y;it++)X.r=G,X.g=w,X.b=O,X.a=A,X=X.next;let rt=i;for(let it=1;it<=t;it++)f=rt+J<<2,g+=(X.r=G=n[f])*(y=Y-it),m+=(X.g=w=n[f+1])*y,_+=(X.b=O=n[f+2])*y,C+=(X.a=A=n[f+3])*y,z+=G,L+=w,N+=O,M+=A,X=X.next,it<P&&(rt+=i);f=J,W=Q,at=I;for(let it=0;it<r;it++)l=f<<2,n[l+3]=A=C*V>>j,A>0?(A=255/A,n[l]=(g*V>>j)*A,n[l+1]=(m*V>>j)*A,n[l+2]=(_*V>>j)*A):n[l]=n[l+1]=n[l+2]=0,g-=E,m-=R,_-=v,C-=D,E-=W.r,R-=W.g,v-=W.b,D-=W.a,l=J+((l=it+Y)<P?l:P)*i<<2,g+=z+=W.r=n[l],m+=L+=W.g=n[l+1],_+=N+=W.b=n[l+2],C+=M+=W.a=n[l+3],W=W.next,E+=G=at.r,R+=w=at.g,v+=O=at.b,D+=A=at.a,z-=G,L-=w,N-=O,M-=A,at=at.next,f+=i}}const i6=function(t){const n=Math.round(this.blurRadius());n>0&&n6(t,n)};st.addGetterSetter(Pt,"blurRadius",0,It(),st.afterSetFilter);const a6=function(o){const t=this.brightness()*255,n=o.data,i=n.length;for(let r=0;r<i;r+=4)n[r]+=t,n[r+1]+=t,n[r+2]+=t};st.addGetterSetter(Pt,"brightness",0,It(),st.afterSetFilter);const r6=function(o){const t=this.brightness(),n=o.data,i=n.length;for(let r=0;r<i;r+=4)n[r]=Math.min(255,n[r]*t),n[r+1]=Math.min(255,n[r+1]*t),n[r+2]=Math.min(255,n[r+2]*t)},s6=function(o){const t=Math.pow((this.contrast()+100)/100,2),n=o.data,i=n.length;let r=150,l=150,f=150;for(let d=0;d<i;d+=4)r=n[d],l=n[d+1],f=n[d+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,l/=255,l-=.5,l*=t,l+=.5,l*=255,f/=255,f-=.5,f*=t,f+=.5,f*=255,r=r<0?0:r>255?255:r,l=l<0?0:l>255?255:l,f=f<0?0:f>255?255:f,n[d]=r,n[d+1]=l,n[d+2]=f};st.addGetterSetter(Pt,"contrast",0,It(),st.afterSetFilter);const l6=function(o){var t,n,i,r,l,f,d,g,m;const _=o.data,C=o.width,E=o.height,R=Math.min(1,Math.max(0,(n=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:.5)),v=Math.min(1,Math.max(0,(r=(i=this.embossWhiteLevel)===null||i===void 0?void 0:i.call(this))!==null&&r!==void 0?r:.5)),z=(d={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(f=(l=this.embossDirection)===null||l===void 0?void 0:l.call(this))!==null&&f!==void 0?f:"top-left"])!==null&&d!==void 0?d:315,L=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),N=R*10,M=v*255,G=z*Math.PI/180,w=Math.cos(G),O=Math.sin(G),A=128/1020*N,y=new Uint8ClampedArray(_),B=new Float32Array(C*E);for(let Q=0,V=0;V<_.length;V+=4,Q++)B[Q]=.2126*y[V]+.7152*y[V+1]+.0722*y[V+2];const U=[-1,0,1,-2,0,2,-1,0,1],P=[-1,-2,-1,0,0,0,1,2,1],Y=[-C-1,-C,-C+1,-1,0,1,C-1,C,C+1],K=Q=>Q<0?0:Q>255?255:Q;for(let Q=1;Q<E-1;Q++)for(let V=1;V<C-1;V++){const j=Q*C+V;let I=0,X=0;I+=B[j+Y[0]]*U[0],X+=B[j+Y[0]]*P[0],I+=B[j+Y[1]]*U[1],X+=B[j+Y[1]]*P[1],I+=B[j+Y[2]]*U[2],X+=B[j+Y[2]]*P[2],I+=B[j+Y[3]]*U[3],X+=B[j+Y[3]]*P[3],I+=B[j+Y[5]]*U[5],X+=B[j+Y[5]]*P[5],I+=B[j+Y[6]]*U[6],X+=B[j+Y[6]]*P[6],I+=B[j+Y[7]]*U[7],X+=B[j+Y[7]]*P[7],I+=B[j+Y[8]]*U[8],X+=B[j+Y[8]]*P[8];const W=w*I+O*X,at=K(M+W*A),J=j*4;if(L){const rt=at-M;_[J]=K(y[J]+rt),_[J+1]=K(y[J+1]+rt),_[J+2]=K(y[J+2]+rt),_[J+3]=y[J+3]}else _[J]=_[J+1]=_[J+2]=at,_[J+3]=y[J+3]}for(let Q=0;Q<C;Q++){let V=Q*4,j=((E-1)*C+Q)*4;_[V]=y[V],_[V+1]=y[V+1],_[V+2]=y[V+2],_[V+3]=y[V+3],_[j]=y[j],_[j+1]=y[j+1],_[j+2]=y[j+2],_[j+3]=y[j+3]}for(let Q=1;Q<E-1;Q++){let V=Q*C*4,j=(Q*C+(C-1))*4;_[V]=y[V],_[V+1]=y[V+1],_[V+2]=y[V+2],_[V+3]=y[V+3],_[j]=y[j],_[j+1]=y[j+1],_[j+2]=y[j+2],_[j+3]=y[j+3]}return o};st.addGetterSetter(Pt,"embossStrength",.5,It(),st.afterSetFilter);st.addGetterSetter(Pt,"embossWhiteLevel",.5,It(),st.afterSetFilter);st.addGetterSetter(Pt,"embossDirection","top-left",void 0,st.afterSetFilter);st.addGetterSetter(Pt,"embossBlend",!1,void 0,st.afterSetFilter);function xp(o,t,n,i,r){const l=n-t,f=r-i;if(l===0)return i+f/2;if(f===0)return i;let d=(o-t)/l;return d=f*d+i,d}const o6=function(o){const t=o.data,n=t.length;let i=t[0],r=i,l,f=t[1],d=f,g,m=t[2],_=m,C;const E=this.enhance();if(E===0)return;for(let M=0;M<n;M+=4)l=t[M+0],l<i?i=l:l>r&&(r=l),g=t[M+1],g<f?f=g:g>d&&(d=g),C=t[M+2],C<m?m=C:C>_&&(_=C);r===i&&(r=255,i=0),d===f&&(d=255,f=0),_===m&&(_=255,m=0);let R,v,D,z,L,N;if(E>0)R=r+E*(255-r),v=i-E*(i-0),D=d+E*(255-d),z=f-E*(f-0),L=_+E*(255-_),N=m-E*(m-0);else{const M=(r+i)*.5;R=r+E*(r-M),v=i+E*(i-M);const G=(d+f)*.5;D=d+E*(d-G),z=f+E*(f-G);const w=(_+m)*.5;L=_+E*(_-w),N=m+E*(m-w)}for(let M=0;M<n;M+=4)t[M+0]=xp(t[M+0],i,r,v,R),t[M+1]=xp(t[M+1],f,d,z,D),t[M+2]=xp(t[M+2],m,_,N,L)};st.addGetterSetter(Pt,"enhance",0,It(),st.afterSetFilter);const u6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4){const r=.34*t[i]+.5*t[i+1]+.16*t[i+2];t[i]=r,t[i+1]=r,t[i+2]=r}};st.addGetterSetter(Pt,"hue",0,It(),st.afterSetFilter);st.addGetterSetter(Pt,"saturation",0,It(),st.afterSetFilter);st.addGetterSetter(Pt,"luminance",0,It(),st.afterSetFilter);const c6=function(o){const t=o.data,n=t.length,i=1,r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,f=this.luminance()*127,d=i*r*Math.cos(l*Math.PI/180),g=i*r*Math.sin(l*Math.PI/180),m=.299*i+.701*d+.167*g,_=.587*i-.587*d+.33*g,C=.114*i-.114*d-.497*g,E=.299*i-.299*d-.328*g,R=.587*i+.413*d+.035*g,v=.114*i-.114*d+.293*g,D=.299*i-.3*d+1.25*g,z=.587*i-.586*d-1.05*g,L=.114*i+.886*d-.2*g;let N,M,G,w;for(let O=0;O<n;O+=4)N=t[O+0],M=t[O+1],G=t[O+2],w=t[O+3],t[O+0]=m*N+_*M+C*G+f,t[O+1]=E*N+R*M+v*G+f,t[O+2]=D*N+z*M+L*G+f,t[O+3]=w},f6=function(o){const t=o.data,n=t.length,i=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,f=i*r*Math.cos(l*Math.PI/180),d=i*r*Math.sin(l*Math.PI/180),g=.299*i+.701*f+.167*d,m=.587*i-.587*f+.33*d,_=.114*i-.114*f-.497*d,C=.299*i-.299*f-.328*d,E=.587*i+.413*f+.035*d,R=.114*i-.114*f+.293*d,v=.299*i-.3*f+1.25*d,D=.587*i-.586*f-1.05*d,z=.114*i+.886*f-.2*d;for(let L=0;L<n;L+=4){const N=t[L+0],M=t[L+1],G=t[L+2],w=t[L+3];t[L+0]=g*N+m*M+_*G,t[L+1]=C*N+E*M+R*G,t[L+2]=v*N+D*M+z*G,t[L+3]=w}};st.addGetterSetter(Pt,"hue",0,It(),st.afterSetFilter);st.addGetterSetter(Pt,"saturation",0,It(),st.afterSetFilter);st.addGetterSetter(Pt,"value",0,It(),st.afterSetFilter);const h6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]},d6=function(o,t,n){const i=o.data,r=t.data,l=o.width,f=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||f/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=l,D=360/v*Math.PI/180;for(let z=0;z<v;z+=1){const L=Math.sin(z*D),N=Math.cos(z*D);for(let M=0;M<R;M+=1){_=Math.floor(d+m*M/R*N),C=Math.floor(g+m*M/R*L);let G=(C*l+_)*4;const w=i[G+0],O=i[G+1],A=i[G+2],y=i[G+3];G=(z+M*l)*4,r[G+0]=w,r[G+1]=O,r[G+2]=A,r[G+3]=y}}},g6=function(o,t,n){const i=o.data,r=t.data,l=o.width,f=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||f/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=f-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const R=f,v=l,D=0;let z,L;for(_=0;_<l;_+=1)for(C=0;C<f;C+=1){const N=_-d,M=C-g,G=Math.sqrt(N*N+M*M)*R/m;let w=(Math.atan2(M,N)*180/Math.PI+360+D)%360;w=w*v/360,z=Math.floor(w),L=Math.floor(G);let O=(L*l+z)*4;const A=i[O+0],y=i[O+1],B=i[O+2],U=i[O+3];O=(C*l+_)*4,r[O+0]=A,r[O+1]=y,r[O+2]=B,r[O+3]=U}},p6=function(o){const t=o.width,n=o.height;let i,r,l,f,d,g,m,_,C,E,R=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),D=Math.floor(t*(v%360)/360);if(R<1)return;const z=vt.createCanvasElement();z.width=t,z.height=n;const L=z.getContext("2d").getImageData(0,0,t,n);vt.releaseCanvas(z),d6(o,L,{polarCenterX:t/2,polarCenterY:n/2});let N=t/Math.pow(2,R);for(;N<=8;)N=N*2,R-=1;N=Math.ceil(N);let M=N,G=0,w=M,O=1;for(D+N>t&&(G=M,w=0,O=-1),r=0;r<n;r+=1)for(i=G;i!==w;i+=O)l=Math.round(i+D)%t,C=(t*r+l)*4,d=L.data[C+0],g=L.data[C+1],m=L.data[C+2],_=L.data[C+3],E=(t*r+i)*4,L.data[E+0]=d,L.data[E+1]=g,L.data[E+2]=m,L.data[E+3]=_;for(r=0;r<n;r+=1)for(M=Math.floor(N),f=0;f<R;f+=1){for(i=0;i<M+1;i+=1)C=(t*r+i)*4,d=L.data[C+0],g=L.data[C+1],m=L.data[C+2],_=L.data[C+3],E=(t*r+M*2-i-1)*4,L.data[E+0]=d,L.data[E+1]=g,L.data[E+2]=m,L.data[E+3]=_;M*=2}g6(L,o,{})};st.addGetterSetter(Pt,"kaleidoscopePower",2,It(),st.afterSetFilter);st.addGetterSetter(Pt,"kaleidoscopeAngle",0,It(),st.afterSetFilter);function $0(o,t,n){let i=(n*o.width+t)*4;const r=[];return r.push(o.data[i++],o.data[i++],o.data[i++],o.data[i++]),r}function Yh(o,t){return Math.sqrt(Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)+Math.pow(o[2]-t[2],2))}function m6(o){const t=[0,0,0];for(let n=0;n<o.length;n++)t[0]+=o[n][0],t[1]+=o[n][1],t[2]+=o[n][2];return t[0]/=o.length,t[1]/=o.length,t[2]/=o.length,t}function v6(o,t){const n=$0(o,0,0),i=$0(o,o.width-1,0),r=$0(o,0,o.height-1),l=$0(o,o.width-1,o.height-1),f=t||10;if(Yh(n,i)<f&&Yh(i,l)<f&&Yh(l,r)<f&&Yh(r,n)<f){const d=m6([i,n,l,r]),g=[];for(let m=0;m<o.width*o.height;m++){const _=Yh(d,[o.data[m*4],o.data[m*4+1],o.data[m*4+2]]);g[m]=_<f?0:255}return g}}function y6(o,t){for(let n=0;n<o.width*o.height;n++)o.data[4*n+3]=t[n]}function S6(o,t,n){const i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,z=i[C*r+E];_+=o[D]*z}}f[m]=_===2040?255:0}return f}function b6(o,t,n){const i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,z=i[C*r+E];_+=o[D]*z}}f[m]=_>=1020?255:0}return f}function _6(o,t,n){const i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),f=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const R=d+C-l,v=g+E-l;if(R>=0&&R<n&&v>=0&&v<t){const D=R*t+v,z=i[C*r+E];_+=o[D]*z}}f[m]=_}return f}const E6=function(o){const t=this.threshold();let n=v6(o,t);return n&&(n=S6(n,o.width,o.height),n=b6(n,o.width,o.height),n=_6(n,o.width,o.height),y6(o,n)),o};st.addGetterSetter(Pt,"threshold",0,It(),st.afterSetFilter);const C6=function(o){const t=this.noise()*255,n=o.data,i=n.length,r=t/2;for(let l=0;l<i;l+=4)n[l+0]+=r-2*r*Math.random(),n[l+1]+=r-2*r*Math.random(),n[l+2]+=r-2*r*Math.random()};st.addGetterSetter(Pt,"noise",.2,It(),st.afterSetFilter);const T6=function(o){let t=Math.ceil(this.pixelSize()),n=o.width,i=o.height,r=Math.ceil(n/t),l=Math.ceil(i/t),f=o.data;if(t<=0){vt.error("pixelSize value can not be <= 0");return}for(let d=0;d<r;d+=1)for(let g=0;g<l;g+=1){let m=0,_=0,C=0,E=0;const R=d*t,v=R+t,D=g*t,z=D+t;let L=0;for(let N=R;N<v;N+=1)if(!(N>=n))for(let M=D;M<z;M+=1){if(M>=i)continue;const G=(n*M+N)*4;m+=f[G+0],_+=f[G+1],C+=f[G+2],E+=f[G+3],L+=1}m=m/L,_=_/L,C=C/L,E=E/L;for(let N=R;N<v;N+=1)if(!(N>=n))for(let M=D;M<z;M+=1){if(M>=i)continue;const G=(n*M+N)*4;f[G+0]=m,f[G+1]=_,f[G+2]=C,f[G+3]=E}}};st.addGetterSetter(Pt,"pixelSize",8,It(),st.afterSetFilter);const A6=function(o){const t=Math.round(this.levels()*254)+1,n=o.data,i=n.length,r=255/t;for(let l=0;l<i;l+=1)n[l]=Math.floor(n[l]/r)*r};st.addGetterSetter(Pt,"levels",.5,It(),st.afterSetFilter);const O6=function(o){const t=o.data,n=t.length,i=this.red(),r=this.green(),l=this.blue();for(let f=0;f<n;f+=4){const d=(.34*t[f]+.5*t[f+1]+.16*t[f+2])/255;t[f]=d*i,t[f+1]=d*r,t[f+2]=d*l,t[f+3]=t[f+3]}};st.addGetterSetter(Pt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Pt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Pt,"blue",0,x2,st.afterSetFilter);const R6=function(o){const t=o.data,n=t.length,i=this.red(),r=this.green(),l=this.blue(),f=this.alpha();for(let d=0;d<n;d+=4){const g=1-f;t[d]=i*f+t[d]*g,t[d+1]=r*f+t[d+1]*g,t[d+2]=l*f+t[d+2]*g}};st.addGetterSetter(Pt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Pt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Pt,"blue",0,x2,st.afterSetFilter);st.addGetterSetter(Pt,"alpha",1,function(o){return this._filterUpToDate=!1,o>1?1:o<0?0:o});const w6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4){const r=t[i+0],l=t[i+1],f=t[i+2];t[i+0]=Math.min(255,r*.393+l*.769+f*.189),t[i+1]=Math.min(255,r*.349+l*.686+f*.168),t[i+2]=Math.min(255,r*.272+l*.534+f*.131)}},x6=function(o){const n=o.data;for(let i=0;i<n.length;i+=4){const r=n[i],l=n[i+1],f=n[i+2];.2126*r+.7152*l+.0722*f>=128&&(n[i]=255-r,n[i+1]=255-l,n[i+2]=255-f)}return o},M6=function(o){const t=this.threshold()*255,n=o.data,i=n.length;for(let r=0;r<i;r+=1)n[r]=n[r]<t?0:255};st.addGetterSetter(Pt,"threshold",.5,It(),st.afterSetFilter);lf.Util._assign(lf,{Arc:gl,Arrow:mu,Circle:gf,Ellipse:fo,Image:Hr,Label:ev,Tag:vu,Line:pl,Path:Cn,Rect:gd,RegularPolygon:ho,Ring:yu,Sprite:ms,Star:go,Text:Rn,TextPath:di,Transformer:Pe,Wedge:ml,Filters:{Blur:i6,Brightness:r6,Brighten:a6,Contrast:s6,Emboss:l6,Enhance:o6,Grayscale:u6,HSL:c6,HSV:f6,Invert:h6,Kaleidoscope:p6,Mask:E6,Noise:C6,Pixelate:T6,Posterize:A6,RGB:O6,RGBA:R6,Sepia:w6,Solarize:x6,Threshold:M6}});var Mp={exports:{}},Np={exports:{}},Dp={exports:{}},jp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J1;function N6(){return J1||(J1=1,(function(o){function t(j,I){var X=j.length;j.push(I);t:for(;0<X;){var W=X-1>>>1,at=j[W];if(0<r(at,I))j[W]=I,j[X]=at,X=W;else break t}}function n(j){return j.length===0?null:j[0]}function i(j){if(j.length===0)return null;var I=j[0],X=j.pop();if(X!==I){j[0]=X;t:for(var W=0,at=j.length,J=at>>>1;W<J;){var rt=2*(W+1)-1,it=j[rt],q=rt+1,F=j[q];if(0>r(it,X))q<at&&0>r(F,it)?(j[W]=F,j[q]=X,W=q):(j[W]=it,j[rt]=X,W=rt);else if(q<at&&0>r(F,X))j[W]=F,j[q]=X,W=q;else break t}}return I}function r(j,I){var X=j.sortIndex-I.sortIndex;return X!==0?X:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,z=!1,L=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(j){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=j)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function w(j){if(D=!1,G(j),!v)if(n(g)!==null)v=!0,O||(O=!0,Y());else{var I=n(m);I!==null&&V(w,I.startTime-j)}}var O=!1,A=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,O){var j=o.unstable_now();B=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(A),A=-1),R=!0;var X=E;try{e:{for(G(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var at=W(C.expirationTime<=j);if(j=o.unstable_now(),typeof at=="function"){C.callback=at,G(j),I=!0;break e}C===n(g)&&i(g),G(j)}else i(g);C=n(g)}if(C!==null)I=!0;else{var J=n(m);J!==null&&V(w,J.startTime-j),I=!1}}break t}finally{C=null,E=X,R=!1}I=void 0}}finally{I?Y():O=!1}}}var Y;if(typeof M=="function")Y=function(){M(P)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Q=K.port2;K.port1.onmessage=P,Y=function(){Q.postMessage(null)}}else Y=function(){L(P,0)};function V(j,I){A=L(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var X=E;E=I;try{return j()}finally{E=X}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=E;E=j;try{return I()}finally{E=X}},o.unstable_scheduleCallback=function(j,I,X){var W=o.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?W+X:W):X=W,j){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=X+at,j={id:_++,callback:I,priorityLevel:j,startTime:X,expirationTime:at,sortIndex:-1},X>W?(j.sortIndex=X,t(m,j),n(g)===null&&j===n(m)&&(D?(N(A),A=-1):D=!0,V(w,X-W))):(j.sortIndex=at,t(g,j),v||R||(v=!0,O||(O=!0,Y()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var X=E;E=I;try{return j.apply(this,arguments)}finally{E=X}}}})(jp)),jp}var Z1;function D6(){return Z1||(Z1=1,Dp.exports=N6()),Dp.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W1;function j6(){return W1||(W1=1,(function(o){o.exports=function(t){function n(s,u,p,S){return new ac(s,u,p,S)}function i(){}function r(s){var u="https://react.dev/errors/"+s;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){var u=s,p=s;if(s.alternate)for(;u.return;)u=u.return;else{s=u;do u=s,(u.flags&4098)!==0&&(p=u.return),s=u.return;while(s)}return u.tag===3?p:null}function f(s){if(l(s)!==s)throw Error(r(188))}function d(s){var u=s.alternate;if(!u){if(u=l(s),u===null)throw Error(r(188));return u!==s?null:s}for(var p=s,S=u;;){var x=p.return;if(x===null)break;var H=x.alternate;if(H===null){if(S=x.return,S!==null){p=S;continue}break}if(x.child===H.child){for(H=x.child;H;){if(H===p)return f(x),s;if(H===S)return f(x),u;H=H.sibling}throw Error(r(188))}if(p.return!==S.return)p=x,S=H;else{for(var et=!1,ot=x.child;ot;){if(ot===p){et=!0,p=x,S=H;break}if(ot===S){et=!0,S=x,p=H;break}ot=ot.sibling}if(!et){for(ot=H.child;ot;){if(ot===p){et=!0,p=H,S=x;break}if(ot===S){et=!0,S=H,p=x;break}ot=ot.sibling}if(!et)throw Error(r(189))}}if(p.alternate!==S)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:u}function g(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(u=g(s),u!==null)return u;s=s.sibling}return null}function m(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(s.tag!==4&&(u=m(s),u!==null))return u;s=s.sibling}return null}function _(s){return s===null||typeof s!="object"?null:(s=qo&&s[qo]||s["@@iterator"],typeof s=="function"?s:null)}function C(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Vo?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case js:return"Fragment";case Po:return"Profiler";case Us:return"StrictMode";case Er:return"Suspense";case Cr:return"SuspenseList";case ts:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case br:return"Portal";case _r:return(s.displayName||"Context")+".Provider";case Io:return(s._context.displayName||"Context")+".Consumer";case uc:var u=s.render;return s=s.displayName,s||(s=u.displayName||u.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case cc:return u=s.displayName||null,u!==null?u:C(s.type)||"Memo";case Tr:u=s._payload,s=s._init;try{return C(s(u))}catch{}}return null}function E(s){return{current:s}}function R(s){0>Is||(s.current=Zo[Is],Zo[Is]=null,Is--)}function v(s,u){Is++,Zo[Is]=s.current,s.current=u}function D(s){return s>>>=0,s===0?32:31-(y0(s)/S0|0)|0}function z(s){var u=s&42;if(u!==0)return u;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function L(s,u,p){var S=s.pendingLanes;if(S===0)return 0;var x=0,H=s.suspendedLanes,et=s.pingedLanes;s=s.warmLanes;var ot=S&134217727;return ot!==0?(S=ot&~H,S!==0?x=z(S):(et&=ot,et!==0?x=z(et):p||(p=ot&~s,p!==0&&(x=z(p))))):(ot=S&~H,ot!==0?x=z(ot):et!==0?x=z(et):p||(p=S&~s,p!==0&&(x=z(p)))),x===0?0:u!==0&&u!==x&&(u&H)===0&&(H=x&-x,p=u&-u,H>=p||H===32&&(p&4194048)!==0)?u:x}function N(s,u){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&u)===0}function M(s,u){switch(s){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G(){var s=Za;return Za<<=1,(Za&4194048)===0&&(Za=256),s}function w(){var s=Wo;return Wo<<=1,(Wo&62914560)===0&&(Wo=4194304),s}function O(s){for(var u=[],p=0;31>p;p++)u.push(s);return u}function A(s,u){s.pendingLanes|=u,u!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function y(s,u,p,S,x,H){var et=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ot=s.entanglements,_t=s.expirationTimes,Nt=s.hiddenUpdates;for(p=et&~p;0<p;){var zt=31-Ai(p),Qt=1<<zt;ot[zt]=0,_t[zt]=-1;var Xt=Nt[zt];if(Xt!==null)for(Nt[zt]=null,zt=0;zt<Xt.length;zt++){var ve=Xt[zt];ve!==null&&(ve.lane&=-536870913)}p&=~Qt}S!==0&&B(s,S,0),H!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=H&~(et&~u))}function B(s,u,p){s.pendingLanes|=u,s.suspendedLanes&=~u;var S=31-Ai(u);s.entangledLanes|=u,s.entanglements[S]=s.entanglements[S]|1073741824|p&4194090}function U(s,u){var p=s.entangledLanes|=u;for(s=s.entanglements;p;){var S=31-Ai(p),x=1<<S;x&u|s[S]&u&&(s[S]|=u),p&=~x}}function P(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Y(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function K(s){if(typeof Pn=="function"&&li(s),Hi&&typeof Hi.setStrictMode=="function")try{Hi.setStrictMode(Il,s)}catch{}}function Q(s){if(Rc===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Rc=u&&u[1]||"",Ch=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Rc+s+Ch}function V(s,u){if(!s||ks)return"";ks=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(u){var Qt=function(){throw Error()};if(Object.defineProperty(Qt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Qt,[])}catch(ve){var Xt=ve}Reflect.construct(s,[],Qt)}else{try{Qt.call()}catch(ve){Xt=ve}s.call(Qt.prototype)}}else{try{throw Error()}catch(ve){Xt=ve}(Qt=s())&&typeof Qt.catch=="function"&&Qt.catch(function(){})}}catch(ve){if(ve&&Xt&&typeof ve.stack=="string")return[ve.stack,Xt.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var H=S.DetermineComponentFrameRoot(),et=H[0],ot=H[1];if(et&&ot){var _t=et.split(`
`),Nt=ot.split(`
`);for(x=S=0;S<_t.length&&!_t[S].includes("DetermineComponentFrameRoot");)S++;for(;x<Nt.length&&!Nt[x].includes("DetermineComponentFrameRoot");)x++;if(S===_t.length||x===Nt.length)for(S=_t.length-1,x=Nt.length-1;1<=S&&0<=x&&_t[S]!==Nt[x];)x--;for(;1<=S&&0<=x;S--,x--)if(_t[S]!==Nt[x]){if(S!==1||x!==1)do if(S--,x--,0>x||_t[S]!==Nt[x]){var zt=`
`+_t[S].replace(" at new "," at ");return s.displayName&&zt.includes("<anonymous>")&&(zt=zt.replace("<anonymous>",s.displayName)),zt}while(1<=S&&0<=x);break}}}finally{ks=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?Q(p):""}function j(s){switch(s.tag){case 26:case 27:case 5:return Q(s.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 15:return V(s.type,!1);case 11:return V(s.type.render,!1);case 1:return V(s.type,!0);case 31:return Q("Activity");default:return""}}function I(s){try{var u="";do u+=j(s),s=s.return;while(s);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function X(s,u){if(typeof s=="object"&&s!==null){var p=Th.get(s);return p!==void 0?p:(u={value:s,source:u,stack:I(u)},Th.set(s,u),u)}return{value:s,source:u,stack:I(u)}}function W(s,u){Rr[qs++]=Vs,Rr[qs++]=wc,wc=s,Vs=u}function at(s,u,p){Pi[na++]=Wa,Pi[na++]=Ra,Pi[na++]=ls,ls=s;var S=Wa;s=Ra;var x=32-Ai(S)-1;S&=~(1<<x),p+=1;var H=32-Ai(u)+x;if(30<H){var et=x-x%5;H=(S&(1<<et)-1).toString(32),S>>=et,x-=et,Wa=1<<32-Ai(u)+x|p<<x|S,Ra=H+s}else Wa=1<<H|p<<x|S,Ra=s}function J(s){s.return!==null&&(W(s,1),at(s,1,0))}function rt(s){for(;s===wc;)wc=Rr[--qs],Rr[qs]=null,Vs=Rr[--qs],Rr[qs]=null;for(;s===ls;)ls=Pi[--na],Pi[na]=null,Ra=Pi[--na],Pi[na]=null,Wa=Pi[--na],Pi[na]=null}function it(s,u){v(wr,u),v(Ys,s),v(Vn,null),s=$f(u),R(Vn),v(Vn,s)}function q(){R(Vn),R(Ys),R(wr)}function F(s){s.memoizedState!==null&&v(kl,s);var u=Vn.current,p=es(u,s.type);u!==p&&(v(Ys,s),v(Vn,p))}function tt(s){Ys.current===s&&(R(Vn),R(Ys)),kl.current===s&&(R(kl),Ya?pa._currentValue=Or:pa._currentValue2=Or)}function nt(s){var u=Error(r(418,""));throw ee(X(u,s)),xa}function gt(s,u){if(!Sn)throw Error(r(175));s0(s.stateNode,s.type,s.memoizedProps,u,s)||nt(s)}function At(s){for(Fn=s.return;Fn;)switch(Fn.tag){case 5:case 13:wa=!1;return;case 27:case 3:wa=!0;return;default:Fn=Fn.return}}function Bt(s){if(!Sn||s!==Fn)return!1;if(!Ie)return At(s),Ie=!0,!1;var u=s.tag;if(Nn?u!==3&&u!==27&&(u!==5||_c(s.type)&&!is(s.type,s.memoizedProps))&&Dn&&nt(s):u!==3&&(u!==5||_c(s.type)&&!is(s.type,s.memoizedProps))&&Dn&&nt(s),At(s),u===13){if(!Sn)throw Error(r(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Dn=l0(s)}else Dn=Nn&&u===27?n0(s.type,Dn):Fn?dh(s.stateNode):null;return!0}function qt(){Sn&&(Dn=Fn=null,Ie=!1)}function Jt(){var s=xr;return s!==null&&(yi===null?yi=s:yi.push.apply(yi,s),xr=null),s}function ee(s){xr===null?xr=[s]:xr.push(s)}function Gt(s,u){return s===u&&(s!==0||1/s===1/u)||s!==s&&u!==u}function be(s,u,p){Ya?(v(xc,u._currentValue),u._currentValue=p):(v(xc,u._currentValue2),u._currentValue2=p)}function Re(s){var u=xc.current;Ya?s._currentValue=u:s._currentValue2=u,R(xc)}function tn(s,u,p){for(;s!==null;){var S=s.alternate;if((s.childLanes&u)!==u?(s.childLanes|=u,S!==null&&(S.childLanes|=u)):S!==null&&(S.childLanes&u)!==u&&(S.childLanes|=u),s===p)break;s=s.return}}function Rt(s,u,p,S){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var H=x.dependencies;if(H!==null){var et=x.child;H=H.firstContext;t:for(;H!==null;){var ot=H;H=x;for(var _t=0;_t<u.length;_t++)if(ot.context===u[_t]){H.lanes|=p,ot=H.alternate,ot!==null&&(ot.lanes|=p),tn(H.return,p,s),S||(et=null);break t}H=ot.next}}else if(x.tag===18){if(et=x.return,et===null)throw Error(r(341));et.lanes|=p,H=et.alternate,H!==null&&(H.lanes|=p),tn(et,p,s),et=null}else et=x.child;if(et!==null)et.return=x;else for(et=x;et!==null;){if(et===s){et=null;break}if(x=et.sibling,x!==null){x.return=et.return,et=x;break}et=et.return}x=et}}function Kt(s,u,p,S){s=null;for(var x=u,H=!1;x!==null;){if(!H){if((x.flags&524288)!==0)H=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var et=x.alternate;if(et===null)throw Error(r(387));if(et=et.memoizedProps,et!==null){var ot=x.type;Oi(x.pendingProps.value,et.value)||(s!==null?s.push(ot):s=[ot])}}else if(x===kl.current){if(et=x.alternate,et===null)throw Error(r(387));et.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(pa):s=[pa])}x=x.return}s!==null&&Rt(u,s,p,S),u.flags|=262144}function Be(s){for(s=s.firstContext;s!==null;){var u=s.context;if(!Oi(Ya?u._currentValue:u._currentValue2,s.memoizedValue))return!0;s=s.next}return!1}function te(s){os=s,oi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ae(s){return xe(os,s)}function qe(s,u){return os===null&&te(s),xe(s,u)}function xe(s,u){var p=Ya?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},oi===null){if(s===null)throw Error(r(308));oi=u,s.dependencies={lanes:0,firstContext:u},s.flags|=524288}else oi=oi.next=u;return p}function an(){return{controller:new Ah,data:new Map,refCount:0}}function yn(s){s.refCount--,s.refCount===0&&E0(Mc,function(){s.controller.abort()})}function hn(s){s!==ql&&s.next===null&&(ql===null?en=ql=s:ql=ql.next=s),tu=!0,Oh||(Oh=!0,de())}function ct(s,u){if(!Ks&&tu){Ks=!0;do for(var p=!1,S=en;S!==null;){if(s!==0){var x=S.pendingLanes;if(x===0)var H=0;else{var et=S.suspendedLanes,ot=S.pingedLanes;H=(1<<31-Ai(42|s)+1)-1,H&=x&~(et&~ot),H=H&201326741?H&201326741|1:H?H|2:0}H!==0&&(p=!0,$t(S,H))}else H=Ae,H=L(S,S===nn?H:0,S.cancelPendingCommit!==null||S.timeoutHandle!==Va),(H&3)===0||N(S,H)||(p=!0,$t(S,H));S=S.next}while(p);Ks=!1}}function ht(){ut()}function ut(){tu=Oh=!1;var s=0;ia!==0&&($i()&&(s=ia),ia=0);for(var u=ea(),p=null,S=en;S!==null;){var x=S.next,H=xt(S,u);H===0?(S.next=null,p===null?en=x:p.next=x,x===null&&(ql=p)):(p=S,(s!==0||(H&3)!==0)&&(tu=!0)),S=x}ct(s)}function xt(s,u){for(var p=s.suspendedLanes,S=s.pingedLanes,x=s.expirationTimes,H=s.pendingLanes&-62914561;0<H;){var et=31-Ai(H),ot=1<<et,_t=x[et];_t===-1?((ot&p)===0||(ot&S)!==0)&&(x[et]=M(ot,u)):_t<=u&&(s.expiredLanes|=ot),H&=~ot}if(u=nn,p=Ae,p=L(s,s===u?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==Va),S=s.callbackNode,p===0||s===u&&(Ge===2||Ge===9)||s.cancelPendingCommit!==null)return S!==null&&S!==null&&Ac(S),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||N(s,p)){if(u=p&-p,u===s.callbackPriority)return u;switch(S!==null&&Ac(S),Y(p)){case 2:case 8:p=_0;break;case 32:p=_h;break;case 268435456:p=Eh;break;default:p=_h}return S=Dt.bind(null,s),p=$o(p,S),s.callbackPriority=u,s.callbackNode=p,u}return S!==null&&S!==null&&Ac(S),s.callbackPriority=2,s.callbackNode=null,2}function Dt(s,u){if(Ke!==0&&Ke!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(xs()&&s.callbackNode!==p)return null;var S=Ae;return S=L(s,s===nn?S:0,s.cancelPendingCommit!==null||s.timeoutHandle!==Va),S===0?null:(Ji(s,S,u),xt(s,ea()),s.callbackNode!=null&&s.callbackNode===p?Dt.bind(null,s):null)}function $t(s,u){if(xs())return null;Ji(s,u,!0)}function de(){hc?Qo(function(){(Ce&6)!==0?$o(bh,ht):ut()}):$o(bh,ht)}function Fe(){return ia===0&&(ia=G()),ia}function Je(s,u){if(Vl===null){var p=Vl=[];Nc=0,$a=Fe(),Ri={status:"pending",value:void 0,then:function(S){p.push(S)}}}return Nc++,u.then(Ki,Ki),u}function Ki(){if(--Nc===0&&Vl!==null){Ri!==null&&(Ri.status="fulfilled");var s=Vl;Vl=null,$a=0,Ri=null;for(var u=0;u<s.length;u++)(0,s[u])()}}function ur(s,u){var p=[],S={status:"pending",value:null,reason:null,then:function(x){p.push(x)}};return s.then(function(){S.status="fulfilled",S.value=u;for(var x=0;x<p.length;x++)(0,p[x])(u)},function(x){for(S.status="rejected",S.reason=x,x=0;x<p.length;x++)(0,p[x])(void 0)}),S}function sa(){var s=Mr.current;return s!==null?s:nn.pooledCache}function Di(s,u){u===null?v(Mr,Mr.current):v(Mr,u.pool)}function la(){var s=sa();return s===null?null:{parent:Ya?ln._currentValue:ln._currentValue2,pool:s}}function gi(s,u){if(Oi(s,u))return!0;if(typeof s!="object"||s===null||typeof u!="object"||u===null)return!1;var p=Object.keys(s),S=Object.keys(u);if(p.length!==S.length)return!1;for(S=0;S<p.length;S++){var x=p[S];if(!C0.call(u,x)||!Oi(s[x],u[x]))return!1}return!0}function Sa(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ut(){}function Yt(s,u,p){switch(p=s[p],p===void 0?s.push(u):p!==u&&(u.then(Ut,Ut),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,ce(s),s;default:if(typeof u.status=="string")u.then(Ut,Ut);else{if(s=nn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=u,s.status="pending",s.then(function(S){if(u.status==="pending"){var x=u;x.status="fulfilled",x.value=S}},function(S){if(u.status==="pending"){var x=u;x.status="rejected",x.reason=S}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,ce(s),s}throw Ii=u,Qs}}function re(){if(Ii===null)throw Error(r(459));var s=Ii;return Ii=null,s}function ce(s){if(s===Qs||s===Xs)throw Error(r(483))}function Ht(){for(var s=us,u=Dc=us=0;u<s;){var p=Ve[u];Ve[u++]=null;var S=Ve[u];Ve[u++]=null;var x=Ve[u];Ve[u++]=null;var H=Ve[u];if(Ve[u++]=null,S!==null&&x!==null){var et=S.pending;et===null?x.next=x:(x.next=et.next,et.next=x),S.pending=x}H!==0&&_e(p,x,H)}}function ze(s,u,p,S){Ve[us++]=s,Ve[us++]=u,Ve[us++]=p,Ve[us++]=S,Dc|=S,s.lanes|=S,s=s.alternate,s!==null&&(s.lanes|=S)}function ne(s,u,p,S){return ze(s,u,p,S),ti(s)}function Me(s,u){return ze(s,null,null,u),ti(s)}function _e(s,u,p){s.lanes|=p;var S=s.alternate;S!==null&&(S.lanes|=p);for(var x=!1,H=s.return;H!==null;)H.childLanes|=p,S=H.alternate,S!==null&&(S.childLanes|=p),H.tag===22&&(s=H.stateNode,s===null||s._visibility&1||(x=!0)),s=H,H=H.return;return s.tag===3?(H=s.stateNode,x&&u!==null&&(x=31-Ai(p),s=H.hiddenUpdates,S=s[x],S===null?s[x]=[u]:S.push(u),u.lane=p|536870912),H):null}function ti(s){if(50<rr)throw rr=0,Lc=null,Error(r(185));for(var u=s.return;u!==null;)s=u,u=s.return;return s.tag===3?s.stateNode:null}function oa(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vs(s,u){s=s.updateQueue,u.updateQueue===s&&(u.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function cr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function fr(s,u,p){var S=s.updateQueue;if(S===null)return null;if(S=S.shared,(Ce&2)!==0){var x=S.pending;return x===null?u.next=u:(u.next=x.next,x.next=u),S.pending=u,u=ti(s),_e(s,null,p),u}return ze(s,S,u,p),ti(s)}function ua(s,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function kn(s,u){var p=s.updateQueue,S=s.alternate;if(S!==null&&(S=S.updateQueue,p===S)){var x=null,H=null;if(p=p.firstBaseUpdate,p!==null){do{var et={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};H===null?x=H=et:H=H.next=et,p=p.next}while(p!==null);H===null?x=H=u:H=H.next=u}else x=H=u;p={baseState:S.baseState,firstBaseUpdate:x,lastBaseUpdate:H,shared:S.shared,callbacks:S.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=u:s.next=u,p.lastBaseUpdate=u}function Kn(){if(wh){var s=Ri;if(s!==null)throw s}}function za(s,u,p,S){wh=!1;var x=s.updateQueue;gn=!1;var H=x.firstBaseUpdate,et=x.lastBaseUpdate,ot=x.shared.pending;if(ot!==null){x.shared.pending=null;var _t=ot,Nt=_t.next;_t.next=null,et===null?H=Nt:et.next=Nt,et=_t;var zt=s.alternate;zt!==null&&(zt=zt.updateQueue,ot=zt.lastBaseUpdate,ot!==et&&(ot===null?zt.firstBaseUpdate=Nt:ot.next=Nt,zt.lastBaseUpdate=_t))}if(H!==null){var Qt=x.baseState;et=0,zt=Nt=_t=null,ot=H;do{var Xt=ot.lane&-536870913,ve=Xt!==ot.lane;if(ve?(Ae&Xt)===Xt:(S&Xt)===Xt){Xt!==0&&Xt===$a&&(wh=!0),zt!==null&&(zt=zt.next={lane:0,tag:ot.tag,payload:ot.payload,callback:null,next:null});t:{var ra=s,Xl=ot;Xt=u;var hs=p;switch(Xl.tag){case 1:if(ra=Xl.payload,typeof ra=="function"){Qt=ra.call(hs,Qt,Xt);break t}Qt=ra;break t;case 3:ra.flags=ra.flags&-65537|128;case 0:if(ra=Xl.payload,Xt=typeof ra=="function"?ra.call(hs,Qt,Xt):ra,Xt==null)break t;Qt=lc({},Qt,Xt);break t;case 2:gn=!0}}Xt=ot.callback,Xt!==null&&(s.flags|=64,ve&&(s.flags|=8192),ve=x.callbacks,ve===null?x.callbacks=[Xt]:ve.push(Xt))}else ve={lane:Xt,tag:ot.tag,payload:ot.payload,callback:ot.callback,next:null},zt===null?(Nt=zt=ve,_t=Qt):zt=zt.next=ve,et|=Xt;if(ot=ot.next,ot===null){if(ot=x.shared.pending,ot===null)break;ve=ot,ot=ve.next,ve.next=null,x.lastBaseUpdate=ve,x.shared.pending=null}}while(!0);zt===null&&(_t=Qt),x.baseState=_t,x.firstBaseUpdate=Nt,x.lastBaseUpdate=zt,H===null&&(x.shared.lanes=0),xi|=et,s.lanes=et,s.memoizedState=Qt}}function Eu(s,u){if(typeof s!="function")throw Error(r(191,s));s.call(u)}function vd(s,u){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Eu(p[s],u)}function yd(s,u){s=ya,v(iu,s),v(Fs,u),ya=s|u.baseLanes}function Cu(){v(iu,ya),v(Fs,Fs.current)}function ys(){ya=iu.current,R(Fs),R(iu)}function Tn(){throw Error(r(321))}function Pr(s,u){if(u===null)return!1;for(var p=0;p<u.length&&p<s.length;p++)if(!Oi(s[p],u[p]))return!1;return!0}function Ir(s,u,p,S,x,H){return Ye=H,le=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,se.H=s===null||s.memoizedState===null?xh:tr,Zs=!1,H=p(S,x),Zs=!1,Js&&(H=Ss(u,p,S,x)),vl(s),H}function vl(s){se.H=ui;var u=De!==null&&De.next!==null;if(Ye=0,jn=De=le=null,au=!1,Jn=0,mi=null,u)throw Error(r(300));s===null||Yn||(s=s.dependencies,s!==null&&Be(s)&&(Yn=!0))}function Ss(s,u,p,S){le=s;var x=0;do{if(Js&&(mi=null),Jn=0,Js=!1,25<=x)throw Error(r(301));if(x+=1,jn=De=null,s.updateQueue!=null){var H=s.updateQueue;H.lastEffect=null,H.events=null,H.stores=null,H.memoCache!=null&&(H.memoCache.index=0)}se.H=$s,H=u(p,S)}while(Js);return H}function Qn(){var s=se.H,u=s.useState()[0];return u=typeof u.then=="function"?yl(u):u,s=s.useState()[0],(De!==null?De.memoizedState:null)!==s&&(le.flags|=1024),u}function Tu(){var s=Ws!==0;return Ws=0,s}function Au(s,u,p){u.updateQueue=s.updateQueue,u.flags&=-2053,s.lanes&=~p}function hr(s){if(au){for(s=s.memoizedState;s!==null;){var u=s.queue;u!==null&&(u.pending=null),s=s.next}au=!1}Ye=0,jn=De=le=null,Js=!1,Jn=Ws=0,mi=null}function qn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?le.memoizedState=jn=s:jn=jn.next=s,jn}function zn(){if(De===null){var s=le.alternate;s=s!==null?s.memoizedState:null}else s=De.next;var u=jn===null?le.memoizedState:jn.next;if(u!==null)jn=u,De=s;else{if(s===null)throw le.alternate===null?Error(r(467)):Error(r(310));De=s,s={memoizedState:De.memoizedState,baseState:De.baseState,baseQueue:De.baseQueue,queue:De.queue,next:null},jn===null?le.memoizedState=jn=s:jn=jn.next=s}return jn}function Ou(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yl(s){var u=Jn;return Jn+=1,mi===null&&(mi=[]),s=Yt(mi,s,u),u=le,(jn===null?u.memoizedState:jn.next)===null&&(u=u.alternate,se.H=u===null||u.memoizedState===null?xh:tr),s}function Ru(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return yl(s);if(s.$$typeof===_r)return ae(s)}throw Error(r(438,String(s)))}function Sl(s){var u=null,p=le.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var S=le.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(u={data:S.data.map(function(x){return x.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Ou(),le.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(s),S=0;S<s;S++)p[S]=ko;return u.index++,p}function ca(s,u){return typeof u=="function"?u(s):u}function fa(s){var u=zn();return ji(u,De,s)}function ji(s,u,p){var S=s.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=p;var x=s.baseQueue,H=S.pending;if(H!==null){if(x!==null){var et=x.next;x.next=H.next,H.next=et}u.baseQueue=x=H,S.pending=null}if(H=s.baseState,x===null)s.memoizedState=H;else{u=x.next;var ot=et=null,_t=null,Nt=u,zt=!1;do{var Qt=Nt.lane&-536870913;if(Qt!==Nt.lane?(Ae&Qt)===Qt:(Ye&Qt)===Qt){var Xt=Nt.revertLane;if(Xt===0)_t!==null&&(_t=_t.next={lane:0,revertLane:0,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null}),Qt===$a&&(zt=!0);else if((Ye&Xt)===Xt){Nt=Nt.next,Xt===$a&&(zt=!0);continue}else Qt={lane:0,revertLane:Nt.revertLane,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null},_t===null?(ot=_t=Qt,et=H):_t=_t.next=Qt,le.lanes|=Xt,xi|=Xt;Qt=Nt.action,Zs&&p(H,Qt),H=Nt.hasEagerState?Nt.eagerState:p(H,Qt)}else Xt={lane:Qt,revertLane:Nt.revertLane,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null},_t===null?(ot=_t=Xt,et=H):_t=_t.next=Xt,le.lanes|=Qt,xi|=Qt;Nt=Nt.next}while(Nt!==null&&Nt!==u);if(_t===null?et=H:_t.next=ot,!Oi(H,s.memoizedState)&&(Yn=!0,zt&&(p=Ri,p!==null)))throw p;s.memoizedState=H,s.baseState=et,s.baseQueue=_t,S.lastRenderedState=H}return x===null&&(S.lanes=0),[s.memoizedState,S.dispatch]}function wu(s){var u=zn(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var S=p.dispatch,x=p.pending,H=u.memoizedState;if(x!==null){p.pending=null;var et=x=x.next;do H=s(H,et.action),et=et.next;while(et!==x);Oi(H,u.memoizedState)||(Yn=!0),u.memoizedState=H,u.baseQueue===null&&(u.baseState=H),p.lastRenderedState=H}return[H,S]}function Sd(s,u,p){var S=le,x=zn(),H=Ie;if(H){if(p===void 0)throw Error(r(407));p=p()}else p=u();var et=!Oi((De||x).memoizedState,p);et&&(x.memoizedState=p,Yn=!0),x=x.queue;var ot=vo.bind(null,S,x,s);if(La(2048,8,ot,[s]),x.getSnapshot!==u||et||jn!==null&&jn.memoizedState.tag&1){if(S.flags|=2048,Ui(9,bl(),yf.bind(null,S,x,p,u),null),nn===null)throw Error(r(349));H||(Ye&124)!==0||xu(S,u,p)}return p}function xu(s,u,p){s.flags|=16384,s={getSnapshot:u,value:p},u=le.updateQueue,u===null?(u=Ou(),le.updateQueue=u,u.stores=[s]):(p=u.stores,p===null?u.stores=[s]:p.push(s))}function yf(s,u,p,S){u.value=p,u.getSnapshot=S,bd(u)&&Qi(s)}function vo(s,u,p){return p(function(){bd(u)&&Qi(s)})}function bd(s){var u=s.getSnapshot;s=s.value;try{var p=u();return!Oi(s,p)}catch{return!0}}function Qi(s){var u=Me(s,2);u!==null&&Li(u,s,2)}function yo(s){var u=qn();if(typeof s=="function"){var p=s;if(s=p(),Zs){K(!0);try{p()}finally{K(!1)}}}return u.memoizedState=u.baseState=s,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ca,lastRenderedState:s},u}function Sf(s,u,p,S){return s.baseState=p,ji(s,De,typeof S=="function"?S:ca)}function bf(s,u,p,S,x){if(Vr(s))throw Error(r(485));if(s=u.action,s!==null){var H={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(et){H.listeners.push(et)}};se.T!==null?p(!0):H.isTransition=!1,S(H),p=u.pending,p===null?(H.next=u.pending=H,bs(u,H)):(H.next=p.next,u.pending=p.next=H)}}function bs(s,u){var p=u.action,S=u.payload,x=s.state;if(u.isTransition){var H=se.T,et={};se.T=et;try{var ot=p(x,S),_t=se.S;_t!==null&&_t(et,ot),_f(s,u,ot)}catch(Nt){kr(s,u,Nt)}finally{se.T=H}}else try{H=p(x,S),_f(s,u,H)}catch(Nt){kr(s,u,Nt)}}function _f(s,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(S){Ef(s,u,S)},function(S){return kr(s,u,S)}):Ef(s,u,p)}function Ef(s,u,p){u.status="fulfilled",u.value=p,_d(u),s.state=p,u=s.pending,u!==null&&(p=u.next,p===u?s.pending=null:(p=p.next,u.next=p,bs(s,p)))}function kr(s,u,p){var S=s.pending;if(s.pending=null,S!==null){S=S.next;do u.status="rejected",u.reason=p,_d(u),u=u.next;while(u!==S)}s.action=null}function _d(s){s=s.listeners;for(var u=0;u<s.length;u++)(0,s[u])()}function Cf(s,u){return u}function Tf(s,u){if(Ie){var p=nn.formState;if(p!==null){t:{var S=le;if(Ie){if(Dn){var x=t0(Dn,wa);if(x){Dn=dh(x),S=e0(x);break t}}nt(S)}S=!1}S&&(u=p[0])}}p=qn(),p.memoizedState=p.baseState=u,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cf,lastRenderedState:u},p.queue=S,p=Cd.bind(null,le,S),S.dispatch=p,S=yo(!1);var H=Co.bind(null,le,!1,S.queue);return S=qn(),x={state:u,dispatch:null,action:s,pending:null},S.queue=x,p=bf.bind(null,le,x,H,p),x.dispatch=p,S.memoizedState=s,[u,p,!1]}function Mu(s){var u=zn();return Ed(u,De,s)}function Ed(s,u,p){if(u=ji(s,u,Cf)[0],s=fa(ca)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var S=yl(u)}catch(et){throw et===Qs?Xs:et}else S=u;u=zn();var x=u.queue,H=x.dispatch;return p!==u.memoizedState&&(le.flags|=2048,Ui(9,bl(),Dg.bind(null,x,p),null)),[S,H,s]}function Dg(s,u){s.action=u}function So(s){var u=zn(),p=De;if(p!==null)return Ed(u,p,s);zn(),u=u.memoizedState,p=zn();var S=p.queue.dispatch;return p.memoizedState=s,[u,S,!1]}function Ui(s,u,p,S){return s={tag:s,create:p,deps:S,inst:u,next:null},u=le.updateQueue,u===null&&(u=Ou(),le.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=s.next=s:(S=p.next,p.next=s,s.next=S,u.lastEffect=s),s}function bl(){return{destroy:void 0,resource:void 0}}function Nu(){return zn().memoizedState}function dr(s,u,p,S){var x=qn();S=S===void 0?null:S,le.flags|=s,x.memoizedState=Ui(1|u,bl(),p,S)}function La(s,u,p,S){var x=zn();S=S===void 0?null:S;var H=x.memoizedState.inst;De!==null&&S!==null&&Pr(S,De.memoizedState.deps)?x.memoizedState=Ui(u,H,p,S):(le.flags|=s,x.memoizedState=Ui(1|u,H,p,S))}function Af(s,u){dr(8390656,8,s,u)}function Du(s,u){La(2048,8,s,u)}function Of(s,u){return La(4,2,s,u)}function _l(s,u){return La(4,4,s,u)}function Ga(s,u){if(typeof u=="function"){s=s();var p=u(s);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return s=s(),u.current=s,function(){u.current=null}}function ju(s,u,p){p=p!=null?p.concat([s]):null,La(4,4,Ga.bind(null,u,s),p)}function _s(){}function gr(s,u){var p=zn();u=u===void 0?null:u;var S=p.memoizedState;return u!==null&&Pr(u,S[1])?S[0]:(p.memoizedState=[s,u],s)}function Uu(s,u){var p=zn();u=u===void 0?null:u;var S=p.memoizedState;if(u!==null&&Pr(u,S[1]))return S[0];if(S=s(),Zs){K(!0);try{s()}finally{K(!1)}}return p.memoizedState=[S,u],S}function El(s,u,p){return p===void 0||(Ye&1073741824)!==0?s.memoizedState=u:(s.memoizedState=p,s=tc(),le.lanes|=s,xi|=s,p)}function Rf(s,u,p,S){return Oi(p,u)?p:Fs.current!==null?(s=El(s,p,S),Oi(s,u)||(Yn=!0),s):(Ye&42)===0?(Yn=!0,s.memoizedState=p):(s=tc(),le.lanes|=s,xi|=s,u)}function bo(s,u,p,S,x){var H=Qa();Gn(H!==0&&8>H?H:8);var et=se.T,ot={};se.T=ot,Co(s,!1,u,p);try{var _t=x(),Nt=se.S;if(Nt!==null&&Nt(ot,_t),_t!==null&&typeof _t=="object"&&typeof _t.then=="function"){var zt=ur(_t,S);Es(s,u,zt,zi(s))}else Es(s,u,S,zi(s))}catch(Qt){Es(s,u,{then:function(){},status:"rejected",reason:Qt},zi())}finally{Gn(H),se.T=et}}function _o(s){var u=s.memoizedState;if(u!==null)return u;u={memoizedState:Or,baseState:Or,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ca,lastRenderedState:Or},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ca,lastRenderedState:p},next:null},s.memoizedState=u,s=s.alternate,s!==null&&(s.memoizedState=u),u}function Bu(){return ae(pa)}function bi(){return zn().memoizedState}function qr(){return zn().memoizedState}function zu(s){for(var u=s.return;u!==null;){switch(u.tag){case 24:case 3:var p=zi();s=cr(p);var S=fr(u,s,p);S!==null&&(Li(S,u,p),ua(S,u,p)),u={cache:an()},s.payload=u;return}u=u.return}}function Eo(s,u,p){var S=zi();p={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Vr(s)?To(u,p):(p=ne(s,u,p,S),p!==null&&(Li(p,s,S),wf(p,u,S)))}function Cd(s,u,p){var S=zi();Es(s,u,p,S)}function Es(s,u,p,S){var x={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Vr(s))To(u,x);else{var H=s.alternate;if(s.lanes===0&&(H===null||H.lanes===0)&&(H=u.lastRenderedReducer,H!==null))try{var et=u.lastRenderedState,ot=H(et,p);if(x.hasEagerState=!0,x.eagerState=ot,Oi(ot,et))return ze(s,u,x,0),nn===null&&Ht(),!1}catch{}finally{}if(p=ne(s,u,x,S),p!==null)return Li(p,s,S),wf(p,u,S),!0}return!1}function Co(s,u,p,S){if(S={lane:2,revertLane:Fe(),action:S,hasEagerState:!1,eagerState:null,next:null},Vr(s)){if(u)throw Error(r(479))}else u=ne(s,p,S,2),u!==null&&Li(u,s,2)}function Vr(s){var u=s.alternate;return s===le||u!==null&&u===le}function To(s,u){Js=au=!0;var p=s.pending;p===null?u.next=u:(u.next=p.next,p.next=u),s.pending=u}function wf(s,u,p){if((p&4194048)!==0){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,U(s,p)}}function Lu(s){var u=tl;return tl+=1,ki===null&&(ki=[]),Yt(ki,s,u)}function Ao(s,u){u=u.props.ref,s.ref=u!==void 0?u:null}function Gu(s,u){throw u.$$typeof===Ds?Error(r(525)):(s=Object.prototype.toString.call(u),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":s)))}function Hu(s){var u=s._init;return u(s._payload)}function Td(s){function u(bt,pt){if(s){var Ct=bt.deletions;Ct===null?(bt.deletions=[pt],bt.flags|=16):Ct.push(pt)}}function p(bt,pt){if(!s)return null;for(;pt!==null;)u(bt,pt),pt=pt.sibling;return null}function S(bt){for(var pt=new Map;bt!==null;)bt.key!==null?pt.set(bt.key,bt):pt.set(bt.index,bt),bt=bt.sibling;return pt}function x(bt,pt){return bt=dn(bt,pt),bt.index=0,bt.sibling=null,bt}function H(bt,pt,Ct){return bt.index=Ct,s?(Ct=bt.alternate,Ct!==null?(Ct=Ct.index,Ct<pt?(bt.flags|=67108866,pt):Ct):(bt.flags|=67108866,pt)):(bt.flags|=1048576,pt)}function et(bt){return s&&bt.alternate===null&&(bt.flags|=67108866),bt}function ot(bt,pt,Ct,Lt){return pt===null||pt.tag!==6?(pt=Zf(Ct,bt.mode,Lt),pt.return=bt,pt):(pt=x(pt,Ct),pt.return=bt,pt)}function _t(bt,pt,Ct,Lt){var kt=Ct.type;return kt===js?zt(bt,pt,Ct.props.children,Lt,Ct.key):pt!==null&&(pt.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===Tr&&Hu(kt)===pt.type)?(pt=x(pt,Ct.props),Ao(pt,Ct),pt.return=bt,pt):(pt=Ho(Ct.type,Ct.key,Ct.props,null,bt.mode,Lt),Ao(pt,Ct),pt.return=bt,pt)}function Nt(bt,pt,Ct,Lt){return pt===null||pt.tag!==4||pt.stateNode.containerInfo!==Ct.containerInfo||pt.stateNode.implementation!==Ct.implementation?(pt=Wf(Ct,bt.mode,Lt),pt.return=bt,pt):(pt=x(pt,Ct.children||[]),pt.return=bt,pt)}function zt(bt,pt,Ct,Lt,kt){return pt===null||pt.tag!==7?(pt=Ms(Ct,bt.mode,Lt,kt),pt.return=bt,pt):(pt=x(pt,Ct),pt.return=bt,pt)}function Qt(bt,pt,Ct){if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return pt=Zf(""+pt,bt.mode,Ct),pt.return=bt,pt;if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case zl:return Ct=Ho(pt.type,pt.key,pt.props,null,bt.mode,Ct),Ao(Ct,pt),Ct.return=bt,Ct;case br:return pt=Wf(pt,bt.mode,Ct),pt.return=bt,pt;case Tr:var Lt=pt._init;return pt=Lt(pt._payload),Qt(bt,pt,Ct)}if(Bs(pt)||_(pt))return pt=Ms(pt,bt.mode,Ct,null),pt.return=bt,pt;if(typeof pt.then=="function")return Qt(bt,Lu(pt),Ct);if(pt.$$typeof===_r)return Qt(bt,qe(bt,pt),Ct);Gu(bt,pt)}return null}function Xt(bt,pt,Ct,Lt){var kt=pt!==null?pt.key:null;if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return kt!==null?null:ot(bt,pt,""+Ct,Lt);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case zl:return Ct.key===kt?_t(bt,pt,Ct,Lt):null;case br:return Ct.key===kt?Nt(bt,pt,Ct,Lt):null;case Tr:return kt=Ct._init,Ct=kt(Ct._payload),Xt(bt,pt,Ct,Lt)}if(Bs(Ct)||_(Ct))return kt!==null?null:zt(bt,pt,Ct,Lt,null);if(typeof Ct.then=="function")return Xt(bt,pt,Lu(Ct),Lt);if(Ct.$$typeof===_r)return Xt(bt,pt,qe(bt,Ct),Lt);Gu(bt,Ct)}return null}function ve(bt,pt,Ct,Lt,kt){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number"||typeof Lt=="bigint")return bt=bt.get(Ct)||null,ot(pt,bt,""+Lt,kt);if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case zl:return bt=bt.get(Lt.key===null?Ct:Lt.key)||null,_t(pt,bt,Lt,kt);case br:return bt=bt.get(Lt.key===null?Ct:Lt.key)||null,Nt(pt,bt,Lt,kt);case Tr:var rn=Lt._init;return Lt=rn(Lt._payload),ve(bt,pt,Ct,Lt,kt)}if(Bs(Lt)||_(Lt))return bt=bt.get(Ct)||null,zt(pt,bt,Lt,kt,null);if(typeof Lt.then=="function")return ve(bt,pt,Ct,Lu(Lt),kt);if(Lt.$$typeof===_r)return ve(bt,pt,Ct,qe(pt,Lt),kt);Gu(pt,Lt)}return null}function ra(bt,pt,Ct,Lt){for(var kt=null,rn=null,ge=pt,He=pt=0,Wn=null;ge!==null&&He<Ct.length;He++){ge.index>He?(Wn=ge,ge=null):Wn=ge.sibling;var ke=Xt(bt,ge,Ct[He],Lt);if(ke===null){ge===null&&(ge=Wn);break}s&&ge&&ke.alternate===null&&u(bt,ge),pt=H(ke,pt,He),rn===null?kt=ke:rn.sibling=ke,rn=ke,ge=Wn}if(He===Ct.length)return p(bt,ge),Ie&&W(bt,He),kt;if(ge===null){for(;He<Ct.length;He++)ge=Qt(bt,Ct[He],Lt),ge!==null&&(pt=H(ge,pt,He),rn===null?kt=ge:rn.sibling=ge,rn=ge);return Ie&&W(bt,He),kt}for(ge=S(ge);He<Ct.length;He++)Wn=ve(ge,bt,He,Ct[He],Lt),Wn!==null&&(s&&Wn.alternate!==null&&ge.delete(Wn.key===null?He:Wn.key),pt=H(Wn,pt,He),rn===null?kt=Wn:rn.sibling=Wn,rn=Wn);return s&&ge.forEach(function(ds){return u(bt,ds)}),Ie&&W(bt,He),kt}function Xl(bt,pt,Ct,Lt){if(Ct==null)throw Error(r(151));for(var kt=null,rn=null,ge=pt,He=pt=0,Wn=null,ke=Ct.next();ge!==null&&!ke.done;He++,ke=Ct.next()){ge.index>He?(Wn=ge,ge=null):Wn=ge.sibling;var ds=Xt(bt,ge,ke.value,Lt);if(ds===null){ge===null&&(ge=Wn);break}s&&ge&&ds.alternate===null&&u(bt,ge),pt=H(ds,pt,He),rn===null?kt=ds:rn.sibling=ds,rn=ds,ge=Wn}if(ke.done)return p(bt,ge),Ie&&W(bt,He),kt;if(ge===null){for(;!ke.done;He++,ke=Ct.next())ke=Qt(bt,ke.value,Lt),ke!==null&&(pt=H(ke,pt,He),rn===null?kt=ke:rn.sibling=ke,rn=ke);return Ie&&W(bt,He),kt}for(ge=S(ge);!ke.done;He++,ke=Ct.next())ke=ve(ge,bt,He,ke.value,Lt),ke!==null&&(s&&ke.alternate!==null&&ge.delete(ke.key===null?He:ke.key),pt=H(ke,pt,He),rn===null?kt=ke:rn.sibling=ke,rn=ke);return s&&ge.forEach(function(Gc){return u(bt,Gc)}),Ie&&W(bt,He),kt}function hs(bt,pt,Ct,Lt){if(typeof Ct=="object"&&Ct!==null&&Ct.type===js&&Ct.key===null&&(Ct=Ct.props.children),typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case zl:t:{for(var kt=Ct.key;pt!==null;){if(pt.key===kt){if(kt=Ct.type,kt===js){if(pt.tag===7){p(bt,pt.sibling),Lt=x(pt,Ct.props.children),Lt.return=bt,bt=Lt;break t}}else if(pt.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===Tr&&Hu(kt)===pt.type){p(bt,pt.sibling),Lt=x(pt,Ct.props),Ao(Lt,Ct),Lt.return=bt,bt=Lt;break t}p(bt,pt);break}else u(bt,pt);pt=pt.sibling}Ct.type===js?(Lt=Ms(Ct.props.children,bt.mode,Lt,Ct.key),Lt.return=bt,bt=Lt):(Lt=Ho(Ct.type,Ct.key,Ct.props,null,bt.mode,Lt),Ao(Lt,Ct),Lt.return=bt,bt=Lt)}return et(bt);case br:t:{for(kt=Ct.key;pt!==null;){if(pt.key===kt)if(pt.tag===4&&pt.stateNode.containerInfo===Ct.containerInfo&&pt.stateNode.implementation===Ct.implementation){p(bt,pt.sibling),Lt=x(pt,Ct.children||[]),Lt.return=bt,bt=Lt;break t}else{p(bt,pt);break}else u(bt,pt);pt=pt.sibling}Lt=Wf(Ct,bt.mode,Lt),Lt.return=bt,bt=Lt}return et(bt);case Tr:return kt=Ct._init,Ct=kt(Ct._payload),hs(bt,pt,Ct,Lt)}if(Bs(Ct))return ra(bt,pt,Ct,Lt);if(_(Ct)){if(kt=_(Ct),typeof kt!="function")throw Error(r(150));return Ct=kt.call(Ct),Xl(bt,pt,Ct,Lt)}if(typeof Ct.then=="function")return hs(bt,pt,Lu(Ct),Lt);if(Ct.$$typeof===_r)return hs(bt,pt,qe(bt,Ct),Lt);Gu(bt,Ct)}return typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint"?(Ct=""+Ct,pt!==null&&pt.tag===6?(p(bt,pt.sibling),Lt=x(pt,Ct),Lt.return=bt,bt=Lt):(p(bt,pt),Lt=Zf(Ct,bt.mode,Lt),Lt.return=bt,bt=Lt),et(bt)):p(bt,pt)}return function(bt,pt,Ct,Lt){try{tl=0;var kt=hs(bt,pt,Ct,Lt);return ki=null,kt}catch(ge){if(ge===Qs||ge===Xs)throw ge;var rn=n(29,ge,null,bt.mode);return rn.lanes=Lt,rn.return=bt,rn}finally{}}}function Yr(s){var u=s.alternate;v(On,On.current&1),v(aa,s),wi===null&&(u===null||Fs.current!==null||u.memoizedState!==null)&&(wi=s)}function Ad(s){if(s.tag===22){if(v(On,On.current),v(aa,s),wi===null){var u=s.alternate;u!==null&&u.memoizedState!==null&&(wi=s)}}else Kr()}function Kr(){v(On,On.current),v(aa,aa.current)}function pr(s){R(aa),wi===s&&(wi=null),R(On)}function Oo(s){for(var u=s;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||vc(p)||yc(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function xf(s,u,p,S){u=s.memoizedState,p=p(S,u),p=p==null?u:lc({},u,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}function Od(s,u,p,S,x,H,et){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(S,H,et):u.prototype&&u.prototype.isPureReactComponent?!gi(p,S)||!gi(x,H):!0}function Rd(s,u,p,S){s=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,S),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,S),u.state!==s&&el.enqueueReplaceState(u,u.state,null)}function Cs(s,u){var p=u;if("ref"in u){p={};for(var S in u)S!=="ref"&&(p[S]=u[S])}if(s=s.defaultProps){p===u&&(p=lc({},p));for(var x in s)p[x]===void 0&&(p[x]=s[x])}return p}function Cl(s,u){try{var p=s.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(S){setTimeout(function(){throw S})}}function wd(s,u,p){try{var S=s.onCaughtError;S(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Mf(s,u,p){return p=cr(p),p.tag=3,p.payload={element:null},p.callback=function(){Cl(s,u)},p}function xd(s){return s=cr(s),s.tag=3,s}function Nf(s,u,p,S){var x=p.type.getDerivedStateFromError;if(typeof x=="function"){var H=S.value;s.payload=function(){return x(H)},s.callback=function(){wd(u,p,S)}}var et=p.stateNode;et!==null&&typeof et.componentDidCatch=="function"&&(s.callback=function(){wd(u,p,S),typeof x!="function"&&(jr===null?jr=new Set([this]):jr.add(this));var ot=S.stack;this.componentDidCatch(S.value,{componentStack:ot!==null?ot:""})})}function jg(s,u,p,S,x){if(p.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(u=p.alternate,u!==null&&Kt(u,p,x,!0),p=aa.current,p!==null){switch(p.tag){case 13:return wi===null?ec():p.alternate===null&&pn===0&&(pn=3),p.flags&=-257,p.flags|=65536,p.lanes=x,S===nu?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([S]):u.add(S),Oa(s,S,x)),!1;case 22:return p.flags|=65536,S===nu?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([S])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([S]):p.add(S)),Oa(s,S,x)),!1}throw Error(r(435,p.tag))}return Oa(s,S,x),ec(),!1}if(Ie)return u=aa.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=x,S!==xa&&(s=Error(r(422),{cause:S}),ee(X(s,p)))):(S!==xa&&(u=Error(r(423),{cause:S}),ee(X(u,p))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,S=X(S,p),x=Mf(s.stateNode,S,x),kn(s,x),pn!==4&&(pn=2)),!1;var H=Error(r(520),{cause:S});if(H=X(H,p),al===null?al=[H]:al.push(H),pn!==4&&(pn=2),u===null)return!0;S=X(S,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,s=x&-x,p.lanes|=s,s=Mf(p.stateNode,S,s),kn(p,s),!1;case 1:if(u=p.type,H=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(jr===null||!jr.has(H))))return p.flags|=65536,x&=-x,p.lanes|=x,x=xd(x),Nf(x,s,p,S),kn(p,x),!1}p=p.return}while(p!==null);return!1}function ei(s,u,p,S){u.child=s===null?ma(u,null,p,S):cs(u,s.child,p,S)}function Md(s,u,p,S,x){p=p.render;var H=u.ref;if("ref"in S){var et={};for(var ot in S)ot!=="ref"&&(et[ot]=S[ot])}else et=S;return te(u),S=Ir(s,u,p,et,H,x),ot=Tu(),s!==null&&!Yn?(Au(s,u,x),Ha(s,u,x)):(Ie&&ot&&J(u),u.flags|=1,ei(s,u,S,x),u.child)}function Nd(s,u,p,S,x){if(s===null){var H=p.type;return typeof H=="function"&&!Sr(H)&&H.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=H,Dd(s,u,H,S,x)):(s=Ho(p.type,null,S,u,u.mode,x),s.ref=u.ref,s.return=u,u.child=s)}if(H=s.child,!Yu(s,x)){var et=H.memoizedProps;if(p=p.compare,p=p!==null?p:gi,p(et,S)&&s.ref===u.ref)return Ha(s,u,x)}return u.flags|=1,s=dn(H,S),s.ref=u.ref,s.return=u,u.child=s}function Dd(s,u,p,S,x){if(s!==null){var H=s.memoizedProps;if(gi(H,S)&&s.ref===u.ref)if(Yn=!1,u.pendingProps=S=H,Yu(s,x))(s.flags&131072)!==0&&(Yn=!0);else return u.lanes=s.lanes,Ha(s,u,x)}return Df(s,u,p,S,x)}function jd(s,u,p){var S=u.pendingProps,x=S.children,H=s!==null?s.memoizedState:null;if(S.mode==="hidden"){if((u.flags&128)!==0){if(S=H!==null?H.baseLanes|p:p,s!==null){for(x=u.child=s.child,H=0;x!==null;)H=H|x.lanes|x.childLanes,x=x.sibling;u.childLanes=H&~S}else u.childLanes=0,u.child=null;return Ud(s,u,S,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},s!==null&&Di(u,H!==null?H.cachePool:null),H!==null?yd(u,H):Cu(),Ad(u);else return u.lanes=u.childLanes=536870912,Ud(s,u,H!==null?H.baseLanes|p:p,p)}else H!==null?(Di(u,H.cachePool),yd(u,H),Kr(),u.memoizedState=null):(s!==null&&Di(u,null),Cu(),Kr());return ei(s,u,x,p),u.child}function Ud(s,u,p,S){var x=sa();return x=x===null?null:{parent:Ya?ln._currentValue:ln._currentValue2,pool:x},u.memoizedState={baseLanes:p,cachePool:x},s!==null&&Di(u,null),Cu(),Ad(u),s!==null&&Kt(s,u,S,!0),null}function Pu(s,u){var p=u.ref;if(p===null)s!==null&&s.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(u.flags|=4194816)}}function Df(s,u,p,S,x){return te(u),p=Ir(s,u,p,S,void 0,x),S=Tu(),s!==null&&!Yn?(Au(s,u,x),Ha(s,u,x)):(Ie&&S&&J(u),u.flags|=1,ei(s,u,p,x),u.child)}function Iu(s,u,p,S,x,H){return te(u),u.updateQueue=null,p=Ss(u,S,p,x),vl(s),S=Tu(),s!==null&&!Yn?(Au(s,u,H),Ha(s,u,H)):(Ie&&S&&J(u),u.flags|=1,ei(s,u,p,H),u.child)}function Tl(s,u,p,S,x){if(te(u),u.stateNode===null){var H=ss,et=p.contextType;typeof et=="object"&&et!==null&&(H=ae(et)),H=new p(S,H),u.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,H.updater=el,u.stateNode=H,H._reactInternals=u,H=u.stateNode,H.props=S,H.state=u.memoizedState,H.refs={},oa(u),et=p.contextType,H.context=typeof et=="object"&&et!==null?ae(et):ss,H.state=u.memoizedState,et=p.getDerivedStateFromProps,typeof et=="function"&&(xf(u,p,et,S),H.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(et=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),et!==H.state&&el.enqueueReplaceState(H,H.state,null),za(u,S,H,x),Kn(),H.state=u.memoizedState),typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!0}else if(s===null){H=u.stateNode;var ot=u.memoizedProps,_t=Cs(p,ot);H.props=_t;var Nt=H.context,zt=p.contextType;et=ss,typeof zt=="object"&&zt!==null&&(et=ae(zt));var Qt=p.getDerivedStateFromProps;zt=typeof Qt=="function"||typeof H.getSnapshotBeforeUpdate=="function",ot=u.pendingProps!==ot,zt||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ot||Nt!==et)&&Rd(u,H,S,et),gn=!1;var Xt=u.memoizedState;H.state=Xt,za(u,S,H,x),Kn(),Nt=u.memoizedState,ot||Xt!==Nt||gn?(typeof Qt=="function"&&(xf(u,p,Qt,S),Nt=u.memoizedState),(_t=gn||Od(u,p,_t,S,Xt,Nt,et))?(zt||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(u.flags|=4194308)):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=S,u.memoizedState=Nt),H.props=S,H.state=Nt,H.context=et,S=_t):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!1)}else{H=u.stateNode,vs(s,u),et=u.memoizedProps,zt=Cs(p,et),H.props=zt,Qt=u.pendingProps,Xt=H.context,Nt=p.contextType,_t=ss,typeof Nt=="object"&&Nt!==null&&(_t=ae(Nt)),ot=p.getDerivedStateFromProps,(Nt=typeof ot=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(et!==Qt||Xt!==_t)&&Rd(u,H,S,_t),gn=!1,Xt=u.memoizedState,H.state=Xt,za(u,S,H,x),Kn();var ve=u.memoizedState;et!==Qt||Xt!==ve||gn||s!==null&&s.dependencies!==null&&Be(s.dependencies)?(typeof ot=="function"&&(xf(u,p,ot,S),ve=u.memoizedState),(zt=gn||Od(u,p,zt,S,Xt,ve,_t)||s!==null&&s.dependencies!==null&&Be(s.dependencies))?(Nt||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(S,ve,_t),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(S,ve,_t)),typeof H.componentDidUpdate=="function"&&(u.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof H.componentDidUpdate!="function"||et===s.memoizedProps&&Xt===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&Xt===s.memoizedState||(u.flags|=1024),u.memoizedProps=S,u.memoizedState=ve),H.props=S,H.state=ve,H.context=_t,S=zt):(typeof H.componentDidUpdate!="function"||et===s.memoizedProps&&Xt===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||et===s.memoizedProps&&Xt===s.memoizedState||(u.flags|=1024),S=!1)}return H=S,Pu(s,u),S=(u.flags&128)!==0,H||S?(H=u.stateNode,p=S&&typeof p.getDerivedStateFromError!="function"?null:H.render(),u.flags|=1,s!==null&&S?(u.child=cs(u,s.child,null,x),u.child=cs(u,null,p,x)):ei(s,u,p,x),u.memoizedState=H.state,s=u.child):s=Ha(s,u,x),s}function Bd(s,u,p,S){return qt(),u.flags|=256,ei(s,u,p,S),u.child}function ku(s){return{baseLanes:s,cachePool:la()}}function qu(s,u,p){return s=s!==null?s.childLanes&~p:0,u&&(s|=ci),s}function jf(s,u,p){var S=u.pendingProps,x=!1,H=(u.flags&128)!==0,et;if((et=H)||(et=s!==null&&s.memoizedState===null?!1:(On.current&2)!==0),et&&(x=!0,u.flags&=-129),et=(u.flags&32)!==0,u.flags&=-33,s===null){if(Ie){if(x?Yr(u):Kr(),Ie){var ot=Dn,_t;(_t=ot)&&(ot=bc(ot,wa),ot!==null?(u.memoizedState={dehydrated:ot,treeContext:ls!==null?{id:Wa,overflow:Ra}:null,retryLane:536870912,hydrationErrors:null},_t=n(18,null,null,0),_t.stateNode=ot,_t.return=u,u.child=_t,Fn=u,Dn=null,_t=!0):_t=!1),_t||nt(u)}if(ot=u.memoizedState,ot!==null&&(ot=ot.dehydrated,ot!==null))return yc(ot)?u.lanes=32:u.lanes=536870912,null;pr(u)}return ot=S.children,S=S.fallback,x?(Kr(),x=u.mode,ot=Ro({mode:"hidden",children:ot},x),S=Ms(S,x,p,null),ot.return=u,S.return=u,ot.sibling=S,u.child=ot,x=u.child,x.memoizedState=ku(p),x.childLanes=qu(s,et,p),u.memoizedState=il,S):(Yr(u),Vu(u,ot))}if(_t=s.memoizedState,_t!==null&&(ot=_t.dehydrated,ot!==null)){if(H)u.flags&256?(Yr(u),u.flags&=-257,u=Qr(s,u,p)):u.memoizedState!==null?(Kr(),u.child=s.child,u.flags|=128,u=null):(Kr(),x=S.fallback,ot=u.mode,S=Ro({mode:"visible",children:S.children},ot),x=Ms(x,ot,p,null),x.flags|=2,S.return=u,x.return=u,S.sibling=x,u.child=S,cs(u,s.child,null,p),S=u.child,S.memoizedState=ku(p),S.childLanes=qu(s,et,p),u.memoizedState=il,u=x);else if(Yr(u),yc(ot))et=$d(ot).digest,S=Error(r(419)),S.stack="",S.digest=et,ee({value:S,source:null,stack:null}),u=Qr(s,u,p);else if(Yn||Kt(s,u,p,!1),et=(p&s.childLanes)!==0,Yn||et){if(et=nn,et!==null&&(S=p&-p,S=(S&42)!==0?1:P(S),S=(S&(et.suspendedLanes|p))!==0?0:S,S!==0&&S!==_t.retryLane))throw _t.retryLane=S,Me(s,S),Li(et,s,S),Mh;vc(ot)||ec(),u=Qr(s,u,p)}else vc(ot)?(u.flags|=192,u.child=s.child,u=null):(s=_t.treeContext,Sn&&(Dn=a0(ot),Fn=u,Ie=!0,xr=null,wa=!1,s!==null&&(Pi[na++]=Wa,Pi[na++]=Ra,Pi[na++]=ls,Wa=s.id,Ra=s.overflow,ls=u)),u=Vu(u,S.children),u.flags|=4096);return u}return x?(Kr(),x=S.fallback,ot=u.mode,_t=s.child,H=_t.sibling,S=dn(_t,{mode:"hidden",children:S.children}),S.subtreeFlags=_t.subtreeFlags&65011712,H!==null?x=dn(H,x):(x=Ms(x,ot,p,null),x.flags|=2),x.return=u,S.return=u,S.sibling=x,u.child=S,S=x,x=u.child,ot=s.child.memoizedState,ot===null?ot=ku(p):(_t=ot.cachePool,_t!==null?(H=Ya?ln._currentValue:ln._currentValue2,_t=_t.parent!==H?{parent:H,pool:H}:_t):_t=la(),ot={baseLanes:ot.baseLanes|p,cachePool:_t}),x.memoizedState=ot,x.childLanes=qu(s,et,p),u.memoizedState=il,S):(Yr(u),p=s.child,s=p.sibling,p=dn(p,{mode:"visible",children:S.children}),p.return=u,p.sibling=null,s!==null&&(et=u.deletions,et===null?(u.deletions=[s],u.flags|=16):et.push(s)),u.child=p,u.memoizedState=null,p)}function Vu(s,u){return u=Ro({mode:"visible",children:u},s.mode),u.return=s,s.child=u}function Ro(s,u){return s=n(22,s,null,u),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Qr(s,u,p){return cs(u,s.child,null,p),s=Vu(u,u.pendingProps.children),s.flags|=2,u.memoizedState=null,s}function zd(s,u,p){s.lanes|=u;var S=s.alternate;S!==null&&(S.lanes|=u),tn(s.return,u,p)}function Uf(s,u,p,S,x){var H=s.memoizedState;H===null?s.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:S,tail:p,tailMode:x}:(H.isBackwards=u,H.rendering=null,H.renderingStartTime=0,H.last=S,H.tail=p,H.tailMode=x)}function Ld(s,u,p){var S=u.pendingProps,x=S.revealOrder,H=S.tail;if(ei(s,u,S.children,p),S=On.current,(S&2)!==0)S=S&1|2,u.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=u.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&zd(s,p,u);else if(s.tag===19)zd(s,p,u);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===u)break t;for(;s.sibling===null;){if(s.return===null||s.return===u)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}S&=1}switch(v(On,S),x){case"forwards":for(p=u.child,x=null;p!==null;)s=p.alternate,s!==null&&Oo(s)===null&&(x=p),p=p.sibling;p=x,p===null?(x=u.child,u.child=null):(x=p.sibling,p.sibling=null),Uf(u,!1,x,p,H);break;case"backwards":for(p=null,x=u.child,u.child=null;x!==null;){if(s=x.alternate,s!==null&&Oo(s)===null){u.child=x;break}s=x.sibling,x.sibling=p,p=x,x=s}Uf(u,!0,p,null,H);break;case"together":Uf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Ha(s,u,p){if(s!==null&&(u.dependencies=s.dependencies),xi|=u.lanes,(p&u.childLanes)===0)if(s!==null){if(Kt(s,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(s!==null&&u.child!==s.child)throw Error(r(153));if(u.child!==null){for(s=u.child,p=dn(s,s.pendingProps),u.child=p,p.return=u;s.sibling!==null;)s=s.sibling,p=p.sibling=dn(s,s.pendingProps),p.return=u;p.sibling=null}return u.child}function Yu(s,u){return(s.lanes&u)!==0?!0:(s=s.dependencies,!!(s!==null&&Be(s)))}function wo(s,u,p){switch(u.tag){case 3:it(u,u.stateNode.containerInfo),be(u,ln,s.memoizedState.cache),qt();break;case 27:case 5:F(u);break;case 4:it(u,u.stateNode.containerInfo);break;case 10:be(u,u.type,u.memoizedProps.value);break;case 13:var S=u.memoizedState;if(S!==null)return S.dehydrated!==null?(Yr(u),u.flags|=128,null):(p&u.child.childLanes)!==0?jf(s,u,p):(Yr(u),s=Ha(s,u,p),s!==null?s.sibling:null);Yr(u);break;case 19:var x=(s.flags&128)!==0;if(S=(p&u.childLanes)!==0,S||(Kt(s,u,p,!1),S=(p&u.childLanes)!==0),x){if(S)return Ld(s,u,p);u.flags|=128}if(x=u.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),v(On,On.current),S)break;return null;case 22:case 23:return u.lanes=0,jd(s,u,p);case 24:be(u,ln,s.memoizedState.cache)}return Ha(s,u,p)}function Al(s,u,p){if(s!==null)if(s.memoizedProps!==u.pendingProps)Yn=!0;else{if(!Yu(s,p)&&(u.flags&128)===0)return Yn=!1,wo(s,u,p);Yn=(s.flags&131072)!==0}else Yn=!1,Ie&&(u.flags&1048576)!==0&&at(u,Vs,u.index);switch(u.lanes=0,u.tag){case 16:t:{s=u.pendingProps;var S=u.elementType,x=S._init;if(S=x(S._payload),u.type=S,typeof S=="function")Sr(S)?(s=Cs(S,s),u.tag=1,u=Tl(null,u,S,s,p)):(u.tag=0,u=Df(null,u,S,s,p));else{if(S!=null){if(x=S.$$typeof,x===uc){u.tag=11,u=Md(null,u,S,s,p);break t}else if(x===cc){u.tag=14,u=Nd(null,u,S,s,p);break t}}throw u=C(S)||S,Error(r(306,u,""))}}return u;case 0:return Df(s,u,u.type,u.pendingProps,p);case 1:return S=u.type,x=Cs(S,u.pendingProps),Tl(s,u,S,x,p);case 3:t:{if(it(u,u.stateNode.containerInfo),s===null)throw Error(r(387));var H=u.pendingProps;x=u.memoizedState,S=x.element,vs(s,u),za(u,H,null,p);var et=u.memoizedState;if(H=et.cache,be(u,ln,H),H!==x.cache&&Rt(u,[ln],p,!0),Kn(),H=et.element,Sn&&x.isDehydrated)if(x={element:H,isDehydrated:!1,cache:et.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=Bd(s,u,H,p);break t}else if(H!==S){S=X(Error(r(424)),u),ee(S),u=Bd(s,u,H,p);break t}else for(Sn&&(Dn=Gg(u.stateNode.containerInfo),Fn=u,Ie=!0,xr=null,wa=!0),p=ma(u,null,H,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(qt(),H===S){u=Ha(s,u,p);break t}ei(s,u,H,p)}u=u.child}return u;case 26:if(ta)return Pu(s,u),s===null?(p=g0(u.type,null,u.pendingProps,null))?u.memoizedState=p:Ie||(u.stateNode=m0(u.type,u.pendingProps,wr.current,u)):u.memoizedState=g0(u.type,s.memoizedProps,u.pendingProps,s.memoizedState),null;case 27:if(Nn)return F(u),s===null&&Nn&&Ie&&(S=u.stateNode=Jo(u.type,u.pendingProps,wr.current,Vn.current,!1),Fn=u,wa=!0,Dn=Hl(u.type,S,Dn)),ei(s,u,u.pendingProps.children,p),Pu(s,u),s===null&&(u.flags|=4194304),u.child;case 5:return s===null&&Ie&&(h0(u.type,u.pendingProps,Vn.current),(x=S=Dn)&&(S=r0(S,u.type,u.pendingProps,wa),S!==null?(u.stateNode=S,Fn=u,Dn=i0(S),wa=!1,x=!0):x=!1),x||nt(u)),F(u),x=u.type,H=u.pendingProps,et=s!==null?s.memoizedProps:null,S=H.children,is(x,H)?S=null:et!==null&&is(x,et)&&(u.flags|=32),u.memoizedState!==null&&(x=Ir(s,u,Qn,null,null,p),Ya?pa._currentValue=x:pa._currentValue2=x),Pu(s,u),ei(s,u,S,p),u.child;case 6:return s===null&&Ie&&(d0(u.pendingProps,Vn.current),(s=p=Dn)&&(p=Sc(p,u.pendingProps,wa),p!==null?(u.stateNode=p,Fn=u,Dn=null,s=!0):s=!1),s||nt(u)),null;case 13:return jf(s,u,p);case 4:return it(u,u.stateNode.containerInfo),S=u.pendingProps,s===null?u.child=cs(u,null,S,p):ei(s,u,S,p),u.child;case 11:return Md(s,u,u.type,u.pendingProps,p);case 7:return ei(s,u,u.pendingProps,p),u.child;case 8:return ei(s,u,u.pendingProps.children,p),u.child;case 12:return ei(s,u,u.pendingProps.children,p),u.child;case 10:return S=u.pendingProps,be(u,u.type,S.value),ei(s,u,S.children,p),u.child;case 9:return x=u.type._context,S=u.pendingProps.children,te(u),x=ae(x),S=S(x),u.flags|=1,ei(s,u,S,p),u.child;case 14:return Nd(s,u,u.type,u.pendingProps,p);case 15:return Dd(s,u,u.type,u.pendingProps,p);case 19:return Ld(s,u,p);case 31:return S=u.pendingProps,p=u.mode,S={mode:S.mode,children:S.children},s===null?(p=Ro(S,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=dn(s.child,S),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return jd(s,u,p);case 24:return te(u),S=ae(ln),s===null?(x=sa(),x===null&&(x=nn,H=an(),x.pooledCache=H,H.refCount++,H!==null&&(x.pooledCacheLanes|=p),x=H),u.memoizedState={parent:S,cache:x},oa(u),be(u,ln,x)):((s.lanes&p)!==0&&(vs(s,u),za(u,null,null,p),Kn()),x=s.memoizedState,H=u.memoizedState,x.parent!==S?(x={parent:S,cache:S},u.memoizedState=x,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=x),be(u,ln,S)):(S=H.cache,be(u,ln,S),S!==x.cache&&Rt(u,[ln],p,!0))),ei(s,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function Xi(s){s.flags|=4}function xo(s,u){if(s!==null&&s.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(s=u.child;s!==null;){if((s.flags&13878)!==0||(s.subtreeFlags&13878)!==0)return!0;s=s.sibling}return!1}function Ku(s,u,p,S){if(Xn)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)Ko(s,p.stateNode);else if(!(p.tag===4||Nn&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(Ka)for(var x=u.child;x!==null;){if(x.tag===5){var H=x.stateNode;p&&S&&(H=fh(H,x.type,x.memoizedProps)),Ko(s,H)}else if(x.tag===6)H=x.stateNode,p&&S&&(H=Wd(H,x.memoizedProps)),Ko(s,H);else if(x.tag!==4){if(x.tag===22&&x.memoizedState!==null)H=x.child,H!==null&&(H.return=x),Ku(s,x,!0,!0);else if(x.child!==null){x.child.return=x,x=x.child;continue}}if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return}x.sibling.return=x.return,x=x.sibling}}function Bf(s,u,p,S){var x=!1;if(Ka)for(var H=u.child;H!==null;){if(H.tag===5){var et=H.stateNode;p&&S&&(et=fh(et,H.type,H.memoizedProps)),ch(s,et)}else if(H.tag===6)et=H.stateNode,p&&S&&(et=Wd(et,H.memoizedProps)),ch(s,et);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)x=H.child,x!==null&&(x.return=H),Bf(s,H,!0,!0),x=!0;else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===u)break;for(;H.sibling===null;){if(H.return===null||H.return===u)return x;H=H.return}H.sibling.return=H.return,H=H.sibling}return x}function Qu(s,u){if(Ka&&xo(s,u)){s=u.stateNode;var p=s.containerInfo,S=uh();Bf(S,u,!1,!1),s.pendingChildren=S,Xi(u),Zd(p,S)}}function Mo(s,u,p,S){if(Xn)s.memoizedProps!==S&&Xi(u);else if(Ka){var x=s.stateNode,H=s.memoizedProps;if((s=xo(s,u))||H!==S){var et=Vn.current;H=Jd(x,p,H,S,!s,null),H===x?u.stateNode=x:(Ll(H,p,S,et)&&Xi(u),u.stateNode=H,s?Ku(H,u,!1,!1):Xi(u))}else u.stateNode=x}}function Xu(s,u,p){if(fc(u,p)){if(s.flags|=16777216,!Xa(u,p))if(Ta())s.flags|=8192;else throw Ii=nu,eu}else s.flags&=-16777217}function zf(s,u){if(Ig(u)){if(s.flags|=16777216,!yh(u))if(Ta())s.flags|=8192;else throw Ii=nu,eu}else s.flags&=-16777217}function No(s,u){u!==null&&(s.flags|=4),s.flags&16384&&(u=s.tag!==22?w():536870912,s.lanes|=u,qi|=u)}function Do(s,u){if(!Ie)switch(s.tailMode){case"hidden":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?u||s.tail===null?s.tail=null:s.tail.sibling=null:S.sibling=null}}function An(s){var u=s.alternate!==null&&s.alternate.child===s.child,p=0,S=0;if(u)for(var x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags&65011712,S|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags,S|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=S,s.childLanes=p,u}function Ug(s,u,p){var S=u.pendingProps;switch(rt(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(u),null;case 1:return An(u),null;case 3:return p=u.stateNode,S=null,s!==null&&(S=s.memoizedState.cache),u.memoizedState.cache!==S&&(u.flags|=2048),Re(ln),q(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Bt(u)?Xi(u):s===null||s.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Jt())),Qu(s,u),An(u),null;case 26:if(ta){p=u.type;var x=u.memoizedState;return s===null?(Xi(u),x!==null?(An(u),zf(u,x)):(An(u),Xu(u,p,S))):x?x!==s.memoizedState?(Xi(u),An(u),zf(u,x)):(An(u),u.flags&=-16777217):(Xn?s.memoizedProps!==S&&Xi(u):Mo(s,u,p,S),An(u),Xu(u,p,S)),null}case 27:if(Nn){if(tt(u),p=wr.current,x=u.type,s!==null&&u.stateNode!=null)Xn?s.memoizedProps!==S&&Xi(u):Mo(s,u,x,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return An(u),null}s=Vn.current,Bt(u)?gt(u,s):(s=Jo(x,S,p,s,!0),u.stateNode=s,Xi(u))}return An(u),null}case 5:if(tt(u),p=u.type,s!==null&&u.stateNode!=null)Mo(s,u,p,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return An(u),null}s=Vn.current,Bt(u)?gt(u,s):(x=th(p,S,wr.current,s,u),Ku(x,u,!1,!1),u.stateNode=x,Ll(x,p,S,s)&&Xi(u))}return An(u),Xu(u,u.type,u.pendingProps),null;case 6:if(s&&u.stateNode!=null)p=s.memoizedProps,Xn?p!==S&&Xi(u):Ka&&(p!==S?(u.stateNode=eh(S,wr.current,Vn.current,u),Xi(u)):u.stateNode=s.stateNode);else{if(typeof S!="string"&&u.stateNode===null)throw Error(r(166));if(s=wr.current,p=Vn.current,Bt(u)){if(!Sn)throw Error(r(176));if(s=u.stateNode,p=u.memoizedProps,S=null,x=Fn,x!==null)switch(x.tag){case 27:case 5:S=x.memoizedProps}gh(s,p,u,S)||nt(u)}else u.stateNode=eh(S,s,p,u)}return An(u),null;case 13:if(S=u.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=Bt(u),S!==null&&S.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(!Sn)throw Error(r(344));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));Hg(x,u)}else qt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;An(u),x=!1}else x=Jt(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return u.flags&256?(pr(u),u):(pr(u),null)}if(pr(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=S!==null,s=s!==null&&s.memoizedState!==null,p){S=u.child,x=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(x=S.alternate.memoizedState.cachePool.pool);var H=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(H=S.memoizedState.cachePool.pool),H!==x&&(S.flags|=2048)}return p!==s&&p&&(u.child.flags|=8192),No(u,u.updateQueue),An(u),null;case 4:return q(),Qu(s,u),s===null&&as(u.stateNode.containerInfo),An(u),null;case 10:return Re(u.type),An(u),null;case 19:if(R(On),x=u.memoizedState,x===null)return An(u),null;if(S=(u.flags&128)!==0,H=x.rendering,H===null)if(S)Do(x,!1);else{if(pn!==0||s!==null&&(s.flags&128)!==0)for(s=u.child;s!==null;){if(H=Oo(s),H!==null){for(u.flags|=128,Do(x,!1),s=H.updateQueue,u.updateQueue=s,No(u,s),u.subtreeFlags=0,s=p,p=u.child;p!==null;)Go(p,s),p=p.sibling;return v(On,On.current&1|2),u.child}s=s.sibling}x.tail!==null&&ea()>sl&&(u.flags|=128,S=!0,Do(x,!1),u.lanes=4194304)}else{if(!S)if(s=Oo(H),s!==null){if(u.flags|=128,S=!0,s=s.updateQueue,u.updateQueue=s,No(u,s),Do(x,!0),x.tail===null&&x.tailMode==="hidden"&&!H.alternate&&!Ie)return An(u),null}else 2*ea()-x.renderingStartTime>sl&&p!==536870912&&(u.flags|=128,S=!0,Do(x,!1),u.lanes=4194304);x.isBackwards?(H.sibling=u.child,u.child=H):(s=x.last,s!==null?s.sibling=H:u.child=H,x.last=H)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=ea(),u.sibling=null,s=On.current,v(On,S?s&1|2:s&1),u):(An(u),null);case 22:case 23:return pr(u),ys(),S=u.memoizedState!==null,s!==null?s.memoizedState!==null!==S&&(u.flags|=8192):S&&(u.flags|=8192),S?(p&536870912)!==0&&(u.flags&128)===0&&(An(u),u.subtreeFlags&6&&(u.flags|=8192)):An(u),p=u.updateQueue,p!==null&&No(u,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),S=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(S=u.memoizedState.cachePool.pool),S!==p&&(u.flags|=2048),s!==null&&R(Mr),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),Re(ln),An(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function Bg(s,u){switch(rt(u),u.tag){case 1:return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 3:return Re(ln),q(),s=u.flags,(s&65536)!==0&&(s&128)===0?(u.flags=s&-65537|128,u):null;case 26:case 27:case 5:return tt(u),null;case 13:if(pr(u),s=u.memoizedState,s!==null&&s.dehydrated!==null){if(u.alternate===null)throw Error(r(340));qt()}return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 19:return R(On),null;case 4:return q(),null;case 10:return Re(u.type),null;case 22:case 23:return pr(u),ys(),s!==null&&R(Mr),s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 24:return Re(ln),null;case 25:return null;default:return null}}function Gd(s,u){switch(rt(u),u.tag){case 3:Re(ln),q();break;case 26:case 27:case 5:tt(u);break;case 4:q();break;case 13:pr(u);break;case 19:R(On);break;case 10:Re(u.type);break;case 22:case 23:pr(u),ys(),s!==null&&R(Mr);break;case 24:Re(ln)}}function ni(s,u){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var x=S.next;p=x;do{if((p.tag&s)===s){S=void 0;var H=p.create,et=p.inst;S=H(),et.destroy=S}p=p.next}while(p!==x)}}catch(ot){je(u,u.return,ot)}}function ha(s,u,p){try{var S=u.updateQueue,x=S!==null?S.lastEffect:null;if(x!==null){var H=x.next;S=H;do{if((S.tag&s)===s){var et=S.inst,ot=et.destroy;if(ot!==void 0){et.destroy=void 0,x=u;var _t=p,Nt=ot;try{Nt()}catch(zt){je(x,_t,zt)}}}S=S.next}while(S!==H)}}catch(zt){je(u,u.return,zt)}}function Lf(s){var u=s.updateQueue;if(u!==null){var p=s.stateNode;try{vd(u,p)}catch(S){je(s,s.return,S)}}}function Gf(s,u,p){p.props=Cs(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(S){je(s,u,S)}}function Ol(s,u){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var S=Ls(s.stateNode);break;case 30:S=s.stateNode;break;default:S=s.stateNode}typeof p=="function"?s.refCleanup=p(S):p.current=S}}catch(x){je(s,u,x)}}function ba(s,u){var p=s.ref,S=s.refCleanup;if(p!==null)if(typeof S=="function")try{S()}catch(x){je(s,u,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(x){je(s,u,x)}else p.current=null}function Fu(s){var u=s.type,p=s.memoizedProps,S=s.stateNode;try{Ti(S,u,p,s)}catch(x){je(s,s.return,x)}}function Hf(s,u,p){try{Mn(s.stateNode,s.type,p,u,s)}catch(S){je(s,s.return,S)}}function Ts(s){return s.tag===5||s.tag===3||(ta?s.tag===26:!1)||(Nn?s.tag===27&&Ps(s.type):!1)||s.tag===4}function jo(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||Ts(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(Nn&&s.tag===27&&Ps(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function As(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?Xo(p,s,u):ah(p,s);else if(S!==4&&(Nn&&S===27&&Ps(s.type)&&(p=s.stateNode,u=null),s=s.child,s!==null))for(As(s,u,p),s=s.sibling;s!==null;)As(s,u,p),s=s.sibling}function Rl(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?dc(p,s,u):ih(p,s);else if(S!==4&&(Nn&&S===27&&Ps(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(Rl(s,u,p),s=s.sibling;s!==null;)Rl(s,u,p),s=s.sibling}function Pf(s,u,p){s=s.containerInfo;try{mc(s,p)}catch(S){je(u,u.return,S)}}function Xr(s){var u=s.stateNode,p=s.memoizedProps;try{v0(s.type,p,u,s)}catch(S){je(s,s.return,S)}}function wl(s,u){for(ns(s.containerInfo),Zn=u;Zn!==null;)if(s=Zn,u=s.child,(s.subtreeFlags&1024)!==0&&u!==null)u.return=s,Zn=u;else for(;Zn!==null;){s=Zn;var p=s.alternate;switch(u=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0;var S=s,x=p.memoizedProps;p=p.memoizedState;var H=S.stateNode;try{var et=Cs(S.type,x,S.elementType===S.type);u=H.getSnapshotBeforeUpdate(et,p),H.__reactInternalSnapshotBeforeUpdate=u}catch(ot){je(S,S.return,ot)}}break;case 3:(u&1024)!==0&&Xn&&Fd(s.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=s.sibling,u!==null){u.return=s.return,Zn=u;break}Zn=s.return}}function Ju(s,u,p){var S=p.flags;switch(p.tag){case 0:case 11:case 15:Pa(s,p),S&4&&ni(5,p);break;case 1:if(Pa(s,p),S&4)if(s=p.stateNode,u===null)try{s.componentDidMount()}catch(et){je(p,p.return,et)}else{var x=Cs(p.type,u.memoizedProps);u=u.memoizedState;try{s.componentDidUpdate(x,u,s.__reactInternalSnapshotBeforeUpdate)}catch(et){je(p,p.return,et)}}S&64&&Lf(p),S&512&&Ol(p,p.return);break;case 3:if(Pa(s,p),S&64&&(s=p.updateQueue,s!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=Ls(p.child.stateNode);break;case 1:u=p.child.stateNode}try{vd(s,u)}catch(et){je(p,p.return,et)}}break;case 27:Nn&&u===null&&S&4&&Xr(p);case 26:case 5:Pa(s,p),u===null&&S&4&&Fu(p),S&512&&Ol(p,p.return);break;case 12:Pa(s,p);break;case 13:Pa(s,p),S&4&&kf(s,p),S&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Ff.bind(null,p),hh(s,p))));break;case 22:if(S=p.memoizedState!==null||er,!S){u=u!==null&&u.memoizedState!==null||bn,x=er;var H=bn;er=S,(bn=u)&&!H?_a(s,p,(p.subtreeFlags&8772)!==0):Pa(s,p),er=x,bn=H}break;case 30:break;default:Pa(s,p)}}function If(s){var u=s.alternate;u!==null&&(s.alternate=null,If(u)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(u=s.stateNode,u!==null&&xn(u)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function ii(s,u,p){for(p=p.child;p!==null;)Zu(s,u,p),p=p.sibling}function Zu(s,u,p){if(Hi&&typeof Hi.onCommitFiberUnmount=="function")try{Hi.onCommitFiberUnmount(Il,p)}catch{}switch(p.tag){case 26:if(ta){bn||ba(p,u),ii(s,u,p),p.memoizedState?mh(p.memoizedState):p.stateNode&&vh(p.stateNode);break}case 27:if(Nn){bn||ba(p,u);var S=oe,x=Te;Ps(p.type)&&(oe=p.stateNode,Te=!1),ii(s,u,p),Sh(p.stateNode),oe=S,Te=x;break}case 5:bn||ba(p,u);case 6:if(Xn){if(S=oe,x=Te,oe=null,ii(s,u,p),oe=S,Te=x,oe!==null)if(Te)try{sh(oe,p.stateNode)}catch(H){je(p,u,H)}else try{gc(oe,p.stateNode)}catch(H){je(p,u,H)}}else ii(s,u,p);break;case 18:Xn&&oe!==null&&(Te?f0(oe,p.stateNode):c0(oe,p.stateNode));break;case 4:Xn?(S=oe,x=Te,oe=p.stateNode.containerInfo,Te=!0,ii(s,u,p),oe=S,Te=x):(Ka&&Pf(p.stateNode,p,uh()),ii(s,u,p));break;case 0:case 11:case 14:case 15:bn||ha(2,p,u),bn||ha(4,p,u),ii(s,u,p);break;case 1:bn||(ba(p,u),S=p.stateNode,typeof S.componentWillUnmount=="function"&&Gf(p,u,S)),ii(s,u,p);break;case 21:ii(s,u,p);break;case 22:bn=(S=bn)||p.memoizedState!==null,ii(s,u,p),bn=S;break;default:ii(s,u,p)}}function kf(s,u){if(Sn&&u.memoizedState===null&&(s=u.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{u0(s)}catch(p){je(u,u.return,p)}}function Hd(s){switch(s.tag){case 13:case 19:var u=s.stateNode;return u===null&&(u=s.stateNode=new A0),u;case 22:return s=s.stateNode,u=s._retryCache,u===null&&(u=s._retryCache=new A0),u;default:throw Error(r(435,s.tag))}}function qf(s,u){var p=Hd(s);u.forEach(function(S){var x=Jf.bind(null,s,S);p.has(S)||(p.add(S),S.then(x,x))})}function _i(s,u){var p=u.deletions;if(p!==null)for(var S=0;S<p.length;S++){var x=p[S],H=s,et=u;if(Xn){var ot=et;t:for(;ot!==null;){switch(ot.tag){case 27:if(Nn){if(Ps(ot.type)){oe=ot.stateNode,Te=!1;break t}break}case 5:oe=ot.stateNode,Te=!1;break t;case 3:case 4:oe=ot.stateNode.containerInfo,Te=!0;break t}ot=ot.return}if(oe===null)throw Error(r(160));Zu(H,et,x),oe=null,Te=!1}else Zu(H,et,x);H=x.alternate,H!==null&&(H.return=null),x.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Pd(u,s),u=u.sibling}function Pd(s,u){var p=s.alternate,S=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:_i(u,s),Ei(s),S&4&&(ha(3,s,s.return),ni(3,s),ha(5,s,s.return));break;case 1:_i(u,s),Ei(s),S&512&&(bn||p===null||ba(p,p.return)),S&64&&er&&(s=s.updateQueue,s!==null&&(S=s.callbacks,S!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?S:p.concat(S))));break;case 26:if(ta){var x=pe;if(_i(u,s),Ei(s),S&512&&(bn||p===null||ba(p,p.return)),S&4){S=p!==null?p.memoizedState:null;var H=s.memoizedState;p===null?H===null?s.stateNode===null?s.stateNode=p0(x,s.type,s.memoizedProps,s):Tc(x,s.type,s.stateNode):s.stateNode=Cc(x,H,s.memoizedProps):S!==H?(S===null?p.stateNode!==null&&vh(p.stateNode):mh(S),H===null?Tc(x,s.type,s.stateNode):Cc(x,H,s.memoizedProps)):H===null&&s.stateNode!==null&&Hf(s,s.memoizedProps,p.memoizedProps)}break}case 27:if(Nn){_i(u,s),Ei(s),S&512&&(bn||p===null||ba(p,p.return)),p!==null&&S&4&&Hf(s,s.memoizedProps,p.memoizedProps);break}case 5:if(_i(u,s),Ei(s),S&512&&(bn||p===null||ba(p,p.return)),Xn){if(s.flags&32){x=s.stateNode;try{Ja(x)}catch(zt){je(s,s.return,zt)}}S&4&&s.stateNode!=null&&(x=s.memoizedProps,Hf(s,x,p!==null?p.memoizedProps:x)),S&1024&&(jc=!0)}break;case 6:if(_i(u,s),Ei(s),S&4&&Xn){if(s.stateNode===null)throw Error(r(162));S=s.memoizedProps,p=p!==null?p.memoizedProps:S,x=s.stateNode;try{rh(x,p,S)}catch(zt){je(s,s.return,zt)}}break;case 3:if(ta?(Pg(),x=pe,pe=Ec(u.containerInfo),_i(u,s),pe=x):_i(u,s),Ei(s),S&4){if(Xn&&Sn&&p!==null&&p.memoizedState.isDehydrated)try{o0(u.containerInfo)}catch(zt){je(s,s.return,zt)}if(Ka){S=u.containerInfo,p=u.pendingChildren;try{mc(S,p)}catch(zt){je(s,s.return,zt)}}}jc&&(jc=!1,Vf(s));break;case 4:ta?(p=pe,pe=Ec(s.stateNode.containerInfo),_i(u,s),Ei(s),pe=p):(_i(u,s),Ei(s)),S&4&&Ka&&Pf(s.stateNode,s,s.stateNode.pendingChildren);break;case 12:_i(u,s),Ei(s);break;case 13:_i(u,s),Ei(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(rl=ea()),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,qf(s,S)));break;case 22:x=s.memoizedState!==null;var et=p!==null&&p.memoizedState!==null,ot=er,_t=bn;if(er=ot||x,bn=_t||et,_i(u,s),bn=_t,er=ot,Ei(s),S&8192&&(u=s.stateNode,u._visibility=x?u._visibility&-2:u._visibility|1,x&&(p===null||et||er||bn||ai(s)),Xn)){t:if(p=null,Xn)for(u=s;;){if(u.tag===5||ta&&u.tag===26){if(p===null){et=p=u;try{H=et.stateNode,x?pc(H):oh(et.stateNode,et.memoizedProps)}catch(zt){je(et,et.return,zt)}}}else if(u.tag===6){if(p===null){et=u;try{var Nt=et.stateNode;x?lh(Nt):Xd(Nt,et.memoizedProps)}catch(zt){je(et,et.return,zt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===s)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break t;for(;u.sibling===null;){if(u.return===null||u.return===s)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}S&4&&(S=s.updateQueue,S!==null&&(p=S.retryQueue,p!==null&&(S.retryQueue=null,qf(s,p))));break;case 19:_i(u,s),Ei(s),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,qf(s,S)));break;case 30:break;case 21:break;default:_i(u,s),Ei(s)}}function Ei(s){var u=s.flags;if(u&2){try{if(Xn){for(var p,S=s.return;S!==null;){if(Ts(S)){p=S;break}S=S.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:if(Nn){var x=p.stateNode,H=jo(s);Rl(s,H,x);break}case 5:var et=p.stateNode;p.flags&32&&(Ja(et),p.flags&=-33);var ot=jo(s);Rl(s,ot,et);break;case 3:case 4:var _t=p.stateNode.containerInfo,Nt=jo(s);As(s,Nt,_t);break;default:throw Error(r(161))}}}catch(zt){je(s,s.return,zt)}s.flags&=-3}u&4096&&(s.flags&=-4097)}function Vf(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var u=s;Vf(u),u.tag===5&&u.flags&1024&&Gs(u.stateNode),s=s.sibling}}function Pa(s,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Ju(s,u.alternate,u),u=u.sibling}function ai(s){for(s=s.child;s!==null;){var u=s;switch(u.tag){case 0:case 11:case 14:case 15:ha(4,u,u.return),ai(u);break;case 1:ba(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&Gf(u,u.return,p),ai(u);break;case 27:Nn&&Sh(u.stateNode);case 26:case 5:ba(u,u.return),ai(u);break;case 22:u.memoizedState===null&&ai(u);break;case 30:ai(u);break;default:ai(u)}s=s.sibling}}function _a(s,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var S=u.alternate,x=s,H=u,et=H.flags;switch(H.tag){case 0:case 11:case 15:_a(x,H,p),ni(4,H);break;case 1:if(_a(x,H,p),S=H,x=S.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Nt){je(S,S.return,Nt)}if(S=H,x=S.updateQueue,x!==null){var ot=S.stateNode;try{var _t=x.shared.hiddenCallbacks;if(_t!==null)for(x.shared.hiddenCallbacks=null,x=0;x<_t.length;x++)Eu(_t[x],ot)}catch(Nt){je(S,S.return,Nt)}}p&&et&64&&Lf(H),Ol(H,H.return);break;case 27:Nn&&Xr(H);case 26:case 5:_a(x,H,p),p&&S===null&&et&4&&Fu(H),Ol(H,H.return);break;case 12:_a(x,H,p);break;case 13:_a(x,H,p),p&&et&4&&kf(x,H);break;case 22:H.memoizedState===null&&_a(x,H,p),Ol(H,H.return);break;case 30:break;default:_a(x,H,p)}u=u.sibling}}function Bi(s,u){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(s=u.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&yn(p))}function Fr(s,u){s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&yn(s))}function da(s,u,p,S){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Uo(s,u,p,S),u=u.sibling}function Uo(s,u,p,S){var x=u.flags;switch(u.tag){case 0:case 11:case 15:da(s,u,p,S),x&2048&&ni(9,u);break;case 1:da(s,u,p,S);break;case 3:da(s,u,p,S),x&2048&&(s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&yn(s)));break;case 12:if(x&2048){da(s,u,p,S),s=u.stateNode;try{var H=u.memoizedProps,et=H.id,ot=H.onPostCommit;typeof ot=="function"&&ot(et,u.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(_t){je(u,u.return,_t)}}else da(s,u,p,S);break;case 13:da(s,u,p,S);break;case 23:break;case 22:H=u.stateNode,et=u.alternate,u.memoizedState!==null?H._visibility&2?da(s,u,p,S):Os(s,u):H._visibility&2?da(s,u,p,S):(H._visibility|=2,mr(s,u,p,S,(u.subtreeFlags&10256)!==0)),x&2048&&Bi(et,u);break;case 24:da(s,u,p,S),x&2048&&Fr(u.alternate,u);break;default:da(s,u,p,S)}}function mr(s,u,p,S,x){for(x=x&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var H=s,et=u,ot=p,_t=S,Nt=et.flags;switch(et.tag){case 0:case 11:case 15:mr(H,et,ot,_t,x),ni(8,et);break;case 23:break;case 22:var zt=et.stateNode;et.memoizedState!==null?zt._visibility&2?mr(H,et,ot,_t,x):Os(H,et):(zt._visibility|=2,mr(H,et,ot,_t,x)),x&&Nt&2048&&Bi(et.alternate,et);break;case 24:mr(H,et,ot,_t,x),x&&Nt&2048&&Fr(et.alternate,et);break;default:mr(H,et,ot,_t,x)}u=u.sibling}}function Os(s,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=s,S=u,x=S.flags;switch(S.tag){case 22:Os(p,S),x&2048&&Bi(S.alternate,S);break;case 24:Os(p,S),x&2048&&Fr(S.alternate,S);break;default:Os(p,S)}u=u.sibling}}function Fi(s){if(s.subtreeFlags&Ee)for(s=s.child;s!==null;)Yf(s),s=s.sibling}function Yf(s){switch(s.tag){case 26:Fi(s),s.flags&Ee&&(s.memoizedState!==null?Fo(pe,s.memoizedState,s.memoizedProps):Ze(s.type,s.memoizedProps));break;case 5:Fi(s),s.flags&Ee&&Ze(s.type,s.memoizedProps);break;case 3:case 4:if(ta){var u=pe;pe=Ec(s.stateNode.containerInfo),Fi(s),pe=u}else Fi(s);break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Ee,Ee=16777216,Fi(s),Ee=u):Fi(s));break;default:Fi(s)}}function Bo(s){var u=s.alternate;if(u!==null&&(s=u.child,s!==null)){u.child=null;do u=s.sibling,s.sibling=null,s=u;while(s!==null)}}function Ia(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];Zn=S,Wu(S,s)}Bo(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Id(s),s=s.sibling}function Id(s){switch(s.tag){case 0:case 11:case 15:Ia(s),s.flags&2048&&ha(9,s,s.return);break;case 3:Ia(s);break;case 12:Ia(s);break;case 22:var u=s.stateNode;s.memoizedState!==null&&u._visibility&2&&(s.return===null||s.return.tag!==13)?(u._visibility&=-3,pi(s)):Ia(s);break;default:Ia(s)}}function pi(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];Zn=S,Wu(S,s)}Bo(s)}for(s=s.child;s!==null;){switch(u=s,u.tag){case 0:case 11:case 15:ha(8,u,u.return),pi(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,pi(u));break;default:pi(u)}s=s.sibling}}function Wu(s,u){for(;Zn!==null;){var p=Zn;switch(p.tag){case 0:case 11:case 15:ha(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var S=p.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:yn(p.memoizedState.cache)}if(S=p.child,S!==null)S.return=p,Zn=S;else t:for(p=s;Zn!==null;){S=Zn;var x=S.sibling,H=S.return;if(If(S),S===p){Zn=null;break t}if(x!==null){x.return=H,Zn=x;break t}Zn=H}}}function Ea(s){var u=ga(s);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(r(364));return u}if(s=zg(s),s===null)throw Error(r(362));return s.stateNode.current}function $u(s,u){var p=s.tag;switch(u.$$typeof){case vi:if(s.type===u.value)return!0;break;case Ma:t:{for(u=u.value,s=[s,0],p=0;p<s.length;){var S=s[p++],x=S.tag,H=s[p++],et=u[H];if(x!==5&&x!==26&&x!==27||!Hs(S)){for(;et!=null&&$u(S,et);)H++,et=u[H];if(H===u.length){u=!0;break t}else for(S=S.child;S!==null;)s.push(S,H),S=S.sibling}}u=!1}return u;case Nr:if((p===5||p===26||p===27)&&Kd(s.stateNode,u.value))return!0;break;case va:if((p===5||p===6||p===26||p===27)&&(s=nh(s),s!==null&&0<=s.indexOf(u.value)))return!0;break;case Yl:if((p===5||p===26||p===27)&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function xl(s){switch(s.$$typeof){case vi:return"<"+(C(s.value)||"Unknown")+">";case Ma:return":has("+(xl(s)||"")+")";case Nr:return'[role="'+s.value+'"]';case va:return'"'+s.value+'"';case Yl:return'[data-testname="'+s.value+'"]';default:throw Error(r(365))}}function Jr(s,u){var p=[];s=[s,0];for(var S=0;S<s.length;){var x=s[S++],H=x.tag,et=s[S++],ot=u[et];if(H!==5&&H!==26&&H!==27||!Hs(x)){for(;ot!=null&&$u(x,ot);)et++,ot=u[et];if(et===u.length)p.push(x);else for(x=x.child;x!==null;)s.push(x,et),x=x.sibling}}return p}function zo(s,u){if(!Fa)throw Error(r(363));s=Ea(s),s=Jr(s,u),u=[],s=Array.from(s);for(var p=0;p<s.length;){var S=s[p++],x=S.tag;if(x===5||x===26||x===27)Hs(S)||u.push(S.stateNode);else for(S=S.child;S!==null;)s.push(S),S=S.sibling}return u}function zi(){if((Ce&2)!==0&&Ae!==0)return Ae&-Ae;if(se.T!==null){var s=$a;return s!==0?s:Fe()}return rs()}function tc(){ci===0&&(ci=(Ae&536870912)===0||Ie?G():536870912);var s=aa.current;return s!==null&&(s.flags|=32),ci}function Li(s,u,p){(s===nn&&(Ge===2||Ge===9)||s.cancelPendingCommit!==null)&&(ri(s,0),Ca(s,Ae,ci,!1)),A(s,p),((Ce&2)===0||s!==nn)&&(s===nn&&((Ce&2)===0&&(mn|=p),pn===4&&Ca(s,Ae,ci,!1)),hn(s))}function Ji(s,u,p){if((Ce&6)!==0)throw Error(r(327));var S=!p&&(u&124)===0&&(u&s.expiredLanes)===0||N(s,u),x=S?kd(s,u):Lo(s,u,!0),H=S;do{if(x===0){Dr&&!S&&Ca(s,u,0,!1);break}else{if(p=s.current.alternate,H&&!Ml(p)){x=Lo(s,u,!1),H=!1;continue}if(x===2){if(H=u,s.errorRecoveryDisabledLanes&H)var et=0;else et=s.pendingLanes&-536870913,et=et!==0?et:et&536870912?536870912:0;if(et!==0){u=et;t:{var ot=s;x=al;var _t=Sn&&ot.current.memoizedState.isDehydrated;if(_t&&(ri(ot,et).flags|=256),et=Lo(ot,et,!1),et!==2){if(Uc&&!_t){ot.errorRecoveryDisabledLanes|=H,mn|=H,x=4;break t}H=yi,yi=x,H!==null&&(yi===null?yi=H:yi.push.apply(yi,H))}x=et}if(H=!1,x!==2)continue}}if(x===1){ri(s,0),Ca(s,u,0,!0);break}t:{switch(S=s,H=x,H){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:Ca(S,u,ci,!nr);break t;case 2:yi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(x=rl+300-ea(),10<x)){if(Ca(S,u,ci,!nr),L(S,0,!0)!==0)break t;S.timeoutHandle=Yd(Rs.bind(null,S,p,yi,Si,Bc,u,ci,mn,qi,nr,H,2,-0,0),x);break t}Rs(S,p,yi,Si,Bc,u,ci,mn,qi,nr,H,0,-0,0)}}break}while(!0);hn(s)}function Rs(s,u,p,S,x,H,et,ot,_t,Nt,zt,Qt,Xt,ve){if(s.timeoutHandle=Va,Qt=u.subtreeFlags,(Qt&8192||(Qt&16785408)===16785408)&&(me(),Yf(u),Qt=Hn(),Qt!==null)){s.cancelPendingCommit=Qt(yr.bind(null,s,u,H,p,S,x,et,ot,_t,zt,1,Xt,ve)),Ca(s,H,et,!Nt);return}yr(s,u,H,p,S,x,et,ot,_t)}function Ml(s){for(var u=s;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var S=0;S<p.length;S++){var x=p[S],H=x.getSnapshot;x=x.value;try{if(!Oi(H(),x))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Ca(s,u,p,S){u&=~ir,u&=~mn,s.suspendedLanes|=u,s.pingedLanes&=~u,S&&(s.warmLanes|=u),S=s.expirationTimes;for(var x=u;0<x;){var H=31-Ai(x),et=1<<H;S[H]=-1,x&=~et}p!==0&&B(s,p,u)}function Nl(){return(Ce&6)===0?(ct(0),!1):!0}function Gi(){if(fe!==null){if(Ge===0)var s=fe.return;else s=fe,oi=os=null,hr(s),ki=null,tl=0,s=fe;for(;s!==null;)Gd(s.alternate,s),s=s.return;fe=null}}function ri(s,u){var p=s.timeoutHandle;p!==Va&&(s.timeoutHandle=Va,Gl(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Gi(),nn=s,fe=p=dn(s.current,null),Ae=u,Ge=0,un=null,nr=!1,Dr=N(s,u),Uc=!1,qi=ci=ir=mn=xi=pn=0,yi=al=null,Bc=!1,(u&8)!==0&&(u|=u&32);var S=s.entangledLanes;if(S!==0)for(s=s.entanglements,S&=u;0<S;){var x=31-Ai(S),H=1<<x;u|=s[x],S&=~H}return ya=u,Ht(),p}function vr(s,u){le=null,se.H=ui,u===Qs||u===Xs?(u=re(),Ge=3):u===eu?(u=re(),Ge=4):Ge=u===Mh?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,un=u,fe===null&&(pn=1,Cl(s,X(u,s.current)))}function Ta(){var s=aa.current;return s===null?!0:(Ae&4194048)===Ae?wi===null:(Ae&62914560)===Ae||(Ae&536870912)!==0?s===wi:!1}function Aa(){var s=se.H;return se.H=ui,s===null?ui:s}function ka(){var s=se.A;return se.A=We,s}function ec(){pn=4,nr||(Ae&4194048)!==Ae&&aa.current!==null||(Dr=!0),(xi&134217727)===0&&(mn&134217727)===0||nn===null||Ca(nn,Ae,ci,!1)}function Lo(s,u,p){var S=Ce;Ce|=2;var x=Aa(),H=ka();(nn!==s||Ae!==u)&&(Si=null,ri(s,u)),u=!1;var et=pn;t:do try{if(Ge!==0&&fe!==null){var ot=fe,_t=un;switch(Ge){case 8:Gi(),et=6;break t;case 3:case 2:case 9:case 6:aa.current===null&&(u=!0);var Nt=Ge;if(Ge=0,un=null,Zi(s,ot,_t,Nt),p&&Dr){et=0;break t}break;default:Nt=Ge,Ge=0,un=null,Zi(s,ot,_t,Nt)}}Kf(),et=pn;break}catch(zt){vr(s,zt)}while(!0);return u&&s.shellSuspendCounter++,oi=os=null,Ce=S,se.H=x,se.A=H,fe===null&&(nn=null,Ae=0,Ht()),et}function Kf(){for(;fe!==null;)sn(fe)}function kd(s,u){var p=Ce;Ce|=2;var S=Aa(),x=ka();nn!==s||Ae!==u?(Si=null,sl=ea()+500,ri(s,u)):Dr=N(s,u);t:do try{if(Ge!==0&&fe!==null){u=fe;var H=un;e:switch(Ge){case 1:Ge=0,un=null,Zi(s,u,H,1);break;case 2:case 9:if(Sa(H)){Ge=0,un=null,Ne(u);break}u=function(){Ge!==2&&Ge!==9||nn!==s||(Ge=7),hn(s)},H.then(u,u);break t;case 3:Ge=7;break t;case 4:Ge=5;break t;case 7:Sa(H)?(Ge=0,un=null,Ne(u)):(Ge=0,un=null,Zi(s,u,H,7));break;case 5:var et=null;switch(fe.tag){case 26:et=fe.memoizedState;case 5:case 27:var ot=fe,_t=ot.type,Nt=ot.pendingProps;if(et?yh(et):Xa(_t,Nt)){Ge=0,un=null;var zt=ot.sibling;if(zt!==null)fe=zt;else{var Qt=ot.return;Qt!==null?(fe=Qt,Ci(Qt)):fe=null}break e}}Ge=0,un=null,Zi(s,u,H,5);break;case 6:Ge=0,un=null,Zi(s,u,H,6);break;case 8:Gi(),pn=6;break t;default:throw Error(r(462))}}si();break}catch(Xt){vr(s,Xt)}while(!0);return oi=os=null,se.H=S,se.A=x,Ce=p,fe!==null?0:(nn=null,Ae=0,Ht(),pn)}function si(){for(;fe!==null&&!Oc();)sn(fe)}function sn(s){var u=Al(s.alternate,s,ya);s.memoizedProps=s.pendingProps,u===null?Ci(s):fe=u}function Ne(s){var u=s,p=u.alternate;switch(u.tag){case 15:case 0:u=Iu(p,u,u.pendingProps,u.type,void 0,Ae);break;case 11:u=Iu(p,u,u.pendingProps,u.type.render,u.ref,Ae);break;case 5:hr(u);default:Gd(p,u),u=fe=Go(u,ya),u=Al(p,u,ya)}s.memoizedProps=s.pendingProps,u===null?Ci(s):fe=u}function Zi(s,u,p,S){oi=os=null,hr(u),ki=null,tl=0;var x=u.return;try{if(jg(s,x,u,p,Ae)){pn=1,Cl(s,X(p,s.current)),fe=null;return}}catch(H){if(x!==null)throw fe=x,H;pn=1,Cl(s,X(p,s.current)),fe=null;return}u.flags&32768?(Ie||S===1?s=!0:Dr||(Ae&536870912)!==0?s=!1:(nr=s=!0,(S===2||S===9||S===3||S===6)&&(S=aa.current,S!==null&&S.tag===13&&(S.flags|=16384))),nc(u,s)):Ci(u)}function Ci(s){var u=s;do{if((u.flags&32768)!==0){nc(u,nr);return}s=u.return;var p=Ug(u.alternate,u,ya);if(p!==null){fe=p;return}if(u=u.sibling,u!==null){fe=u;return}fe=u=s}while(u!==null);pn===0&&(pn=5)}function nc(s,u){do{var p=Bg(s.alternate,s);if(p!==null){p.flags&=32767,fe=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(s=s.sibling,s!==null)){fe=s;return}fe=s=p}while(s!==null);pn=6,fe=null}function yr(s,u,p,S,x,H,et,ot,_t){s.cancelPendingCommit=null;do xs();while(Ke!==0);if((Ce&6)!==0)throw Error(r(327));if(u!==null){if(u===s.current)throw Error(r(177));if(H=u.lanes|u.childLanes,H|=Dc,y(s,p,H,et,ot,_t),s===nn&&(fe=nn=null,Ae=0),ll=u,Ur=s,Kl=p,ar=H,Ql=x,zc=S,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,jl(_h,function(){return Dl(),null})):(s.callbackNode=null,s.callbackPriority=0),S=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||S){S=se.T,se.T=null,x=Qa(),Gn(2),et=Ce,Ce|=4;try{wl(s,u,p)}finally{Ce=et,Gn(x),se.T=S}}Ke=1,Qf(),Xf(),ws()}}function Qf(){if(Ke===1){Ke=0;var s=Ur,u=ll,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=se.T,se.T=null;var S=Qa();Gn(2);var x=Ce;Ce|=4;try{Pd(u,s),Yo(s.containerInfo)}finally{Ce=x,Gn(S),se.T=p}}s.current=u,Ke=2}}function Xf(){if(Ke===2){Ke=0;var s=Ur,u=ll,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=se.T,se.T=null;var S=Qa();Gn(2);var x=Ce;Ce|=4;try{Ju(s,u.alternate,u)}finally{Ce=x,Gn(S),se.T=p}}Ke=3}}function ws(){if(Ke===4||Ke===3){Ke=0,b0();var s=Ur,u=ll,p=Kl,S=zc;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Ke=5:(Ke=0,ll=Ur=null,Zr(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(jr=null),Y(p),u=u.stateNode,Hi&&typeof Hi.onCommitFiberRoot=="function")try{Hi.onCommitFiberRoot(Il,u,void 0,(u.current.flags&128)===128)}catch{}if(S!==null){u=se.T,x=Qa(),Gn(2),se.T=null;try{for(var H=s.onRecoverableError,et=0;et<S.length;et++){var ot=S[et];H(ot.value,{componentStack:ot.stack})}}finally{se.T=u,Gn(x)}}(Kl&3)!==0&&xs(),hn(s),x=s.pendingLanes,(p&4194090)!==0&&(x&42)!==0?s===Lc?rr++:(rr=0,Lc=s):rr=0,ct(0)}}function Zr(s,u){(s.pooledCacheLanes&=u)===0&&(u=s.pooledCache,u!=null&&(s.pooledCache=null,yn(u)))}function xs(s){return Qf(),Xf(),ws(),Dl()}function Dl(){if(Ke!==5)return!1;var s=Ur,u=ar;ar=0;var p=Y(Kl),S=32>p?32:p;p=se.T;var x=Qa();try{Gn(S),se.T=null,S=Ql,Ql=null;var H=Ur,et=Kl;if(Ke=0,ll=Ur=null,Kl=0,(Ce&6)!==0)throw Error(r(331));var ot=Ce;if(Ce|=4,Id(H.current),Uo(H,H.current,et,S),Ce=ot,ct(0,!1),Hi&&typeof Hi.onPostCommitFiberRoot=="function")try{Hi.onPostCommitFiberRoot(Il,H)}catch{}return!0}finally{Gn(x),se.T=p,Zr(s,u)}}function ic(s,u,p){u=X(p,u),u=Mf(s.stateNode,u,2),s=fr(s,u,2),s!==null&&(A(s,2),hn(s))}function je(s,u,p){if(s.tag===3)ic(s,s,p);else for(;u!==null;){if(u.tag===3){ic(u,s,p);break}else if(u.tag===1){var S=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(jr===null||!jr.has(S))){s=X(p,s),p=xd(2),S=fr(u,p,2),S!==null&&(Nf(p,S,u,s),A(S,2),hn(S));break}}u=u.return}}function Oa(s,u,p){var S=s.pingCache;if(S===null){S=s.pingCache=new fs;var x=new Set;S.set(u,x)}else x=S.get(u),x===void 0&&(x=new Set,S.set(u,x));x.has(p)||(Uc=!0,x.add(p),s=Wr.bind(null,s,u,p),u.then(s,s))}function Wr(s,u,p){var S=s.pingCache;S!==null&&S.delete(u),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,nn===s&&(Ae&p)===p&&(pn===4||pn===3&&(Ae&62914560)===Ae&&300>ea()-rl?(Ce&2)===0&&ri(s,0):ir|=p,qi===Ae&&(qi=0)),hn(s)}function qa(s,u){u===0&&(u=w()),s=Me(s,u),s!==null&&(A(s,u),hn(s))}function Ff(s){var u=s.memoizedState,p=0;u!==null&&(p=u.retryLane),qa(s,p)}function Jf(s,u){var p=0;switch(s.tag){case 13:var S=s.stateNode,x=s.memoizedState;x!==null&&(p=x.retryLane);break;case 19:S=s.stateNode;break;case 22:S=s.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(u),qa(s,p)}function jl(s,u){return $o(s,u)}function ac(s,u,p,S){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function dn(s,u){var p=s.alternate;return p===null?(p=n(s.tag,u,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=u,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,u=s.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Go(s,u){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,u=p.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),s}function Ho(s,u,p,S,x,H){var et=0;if(S=s,typeof s=="function")Sr(s)&&(et=1);else if(typeof s=="string")et=ta&&Nn?ph(s,p,Vn.current)?26:Pl(s)?27:5:ta?ph(s,p,Vn.current)?26:5:Nn&&Pl(s)?27:5;else t:switch(s){case ts:return s=n(31,p,u,x),s.elementType=ts,s.lanes=H,s;case js:return Ms(p.children,x,H,u);case Us:et=8,x|=24;break;case Po:return s=n(12,p,u,x|2),s.elementType=Po,s.lanes=H,s;case Er:return s=n(13,p,u,x),s.elementType=Er,s.lanes=H,s;case Cr:return s=n(19,p,u,x),s.elementType=Cr,s.lanes=H,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case oc:case _r:et=10;break t;case Io:et=9;break t;case uc:et=11;break t;case cc:et=14;break t;case Tr:et=16,S=null;break t}et=29,p=Error(r(130,s===null?"null":typeof s,"")),S=null}return u=n(et,p,u,x),u.elementType=s,u.type=S,u.lanes=H,u}function Ms(s,u,p,S){return s=n(7,s,S,u),s.lanes=p,s}function Zf(s,u,p){return s=n(6,s,null,u),s.lanes=p,s}function Wf(s,u,p){return u=n(4,s.children!==null?s.children:[],s.key,u),u.lanes=p,u.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},u}function Ln(s,u,p,S,x,H,et,ot){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Va,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=O(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O(0),this.hiddenUpdates=O(null),this.identifierPrefix=S,this.onUncaughtError=x,this.onCaughtError=H,this.onRecoverableError=et,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ot,this.incompleteTransitions=new Map}function rc(s,u,p,S,x,H,et,ot,_t,Nt,zt,Qt){return s=new Ln(s,u,p,et,ot,_t,Nt,Qt),u=1,H===!0&&(u|=24),H=n(3,null,null,u),s.current=H,H.stateNode=s,u=an(),u.refCount++,s.pooledCache=u,u.refCount++,H.memoizedState={element:S,isDehydrated:p,cache:u},oa(H),s}function Ul(s){return s?(s=ss,s):ss}function Bl(s){var u=s._reactInternals;if(u===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(u),s=s!==null?g(s):null,s===null?null:Ls(s.stateNode)}function sc(s,u,p,S,x,H){x=Ul(x),S.context===null?S.context=x:S.pendingContext=x,S=cr(u),S.payload={element:p},H=H===void 0?null:H,H!==null&&(S.callback=H),p=fr(s,S,u),p!==null&&(Li(p,s,u),ua(p,s,u))}function Ns(s,u){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<u?p:u}}function $r(s,u){Ns(s,u),(s=s.alternate)&&Ns(s,u)}var we={},qd=_g(),Wi=D6(),lc=Object.assign,Ds=Symbol.for("react.element"),zl=Symbol.for("react.transitional.element"),br=Symbol.for("react.portal"),js=Symbol.for("react.fragment"),Us=Symbol.for("react.strict_mode"),Po=Symbol.for("react.profiler"),oc=Symbol.for("react.provider"),Io=Symbol.for("react.consumer"),_r=Symbol.for("react.context"),uc=Symbol.for("react.forward_ref"),Er=Symbol.for("react.suspense"),Cr=Symbol.for("react.suspense_list"),cc=Symbol.for("react.memo"),Tr=Symbol.for("react.lazy"),ts=Symbol.for("react.activity"),ko=Symbol.for("react.memo_cache_sentinel"),qo=Symbol.iterator,Vo=Symbol.for("react.client.reference"),Bs=Array.isArray,se=qd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,zs=t.rendererVersion,Vd=t.rendererPackageName,Ar=t.extraDevToolsConfig,Ls=t.getPublicInstance,$f=t.getRootHostContext,es=t.getChildHostContext,ns=t.prepareForCommit,Yo=t.resetAfterCommit,th=t.createInstance;t.cloneMutableInstance;var Ko=t.appendInitialChild,Ll=t.finalizeInitialChildren,is=t.shouldSetTextContent,eh=t.createTextInstance;t.cloneMutableTextInstance;var Yd=t.scheduleTimeout,Gl=t.cancelTimeout,Va=t.noTimeout,Ya=t.isPrimaryRenderer;t.warnsIfNotActing;var Xn=t.supportsMutation,Ka=t.supportsPersistence,Sn=t.supportsHydration,ga=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var as=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var Gn=t.setCurrentUpdatePriority,Qa=t.getCurrentUpdatePriority,rs=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var $i=t.shouldAttemptEagerTransition,xn=t.detachDeletedInstance;t.requestPostPaintCallback;var fc=t.maySuspendCommit,Xa=t.preloadInstance,me=t.startSuspendingCommit,Ze=t.suspendInstance;t.suspendOnActiveViewTransition;var Hn=t.waitForCommitToBeReady,Or=t.NotPendingTransition,pa=t.HostTransitionContext,Gs=t.resetFormInstance;t.bindToConsole;var hc=t.supportsMicrotasks,Qo=t.scheduleMicrotask,Fa=t.supportsTestSelectors,zg=t.findFiberRoot,wn=t.getBoundingRect,nh=t.getTextContent,Hs=t.isHiddenSubtree,Kd=t.matchAccessibilityRole,Qd=t.setFocusIfFocusable,Lg=t.setupIntersectionObserver,ih=t.appendChild,ah=t.appendChildToContainer,rh=t.commitTextUpdate,Ti=t.commitMount,Mn=t.commitUpdate,dc=t.insertBefore,Xo=t.insertInContainerBefore,gc=t.removeChild,sh=t.removeChildFromContainer,Ja=t.resetTextContent,pc=t.hideInstance,lh=t.hideTextInstance,oh=t.unhideInstance,Xd=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopGestureTransition,t.getCurrentGestureOffset,t.subscribeToGestureDirection,t.createViewTransitionInstance;var Fd=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var Jd=t.cloneInstance,uh=t.createContainerChildSet,ch=t.appendChildToContainerChildSet,Zd=t.finalizeContainerChildren,mc=t.replaceContainerChildren,fh=t.cloneHiddenInstance,Wd=t.cloneHiddenTextInstance,vc=t.isSuspenseInstancePending,yc=t.isSuspenseInstanceFallback,$d=t.getSuspenseInstanceFallbackErrorDetails,hh=t.registerSuspenseInstanceRetry,t0=t.canHydrateFormStateMarker,e0=t.isFormStateMarkerMatching,dh=t.getNextHydratableSibling,n0=t.getNextHydratableSiblingAfterSingleton,i0=t.getFirstHydratableChild,Gg=t.getFirstHydratableChildWithinContainer,a0=t.getFirstHydratableChildWithinSuspenseInstance,Hl=t.getFirstHydratableChildWithinSingleton,r0=t.canHydrateInstance,Sc=t.canHydrateTextInstance,bc=t.canHydrateSuspenseInstance,s0=t.hydrateInstance,gh=t.hydrateTextInstance,Hg=t.hydrateSuspenseInstance,l0=t.getNextHydratableInstanceAfterSuspenseInstance,o0=t.commitHydratedContainer,u0=t.commitHydratedSuspenseInstance,c0=t.clearSuspenseBoundary,f0=t.clearSuspenseBoundaryFromContainer,_c=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var h0=t.validateHydratableInstance,d0=t.validateHydratableTextInstance,ta=t.supportsResources,ph=t.isHostHoistableType,Ec=t.getHoistableRoot,g0=t.getResource,Cc=t.acquireResource,mh=t.releaseResource,p0=t.hydrateHoistable,Tc=t.mountHoistable,vh=t.unmountHoistable,m0=t.createHoistableInstance,Pg=t.prepareToCommitHoistables,Ig=t.mayResourceSuspendCommit,yh=t.preloadResource,Fo=t.suspendResource,Nn=t.supportsSingletons,Jo=t.resolveSingletonInstance,v0=t.acquireSingletonInstance,Sh=t.releaseSingletonInstance,Pl=t.isHostSingletonType,Ps=t.isSingletonScope,Zo=[],Is=-1,ss={},Ai=Math.clz32?Math.clz32:D,y0=Math.log,S0=Math.LN2,Za=256,Wo=4194304,$o=Wi.unstable_scheduleCallback,Ac=Wi.unstable_cancelCallback,Oc=Wi.unstable_shouldYield,b0=Wi.unstable_requestPaint,ea=Wi.unstable_now,bh=Wi.unstable_ImmediatePriority,_0=Wi.unstable_UserBlockingPriority,_h=Wi.unstable_NormalPriority,Eh=Wi.unstable_IdlePriority,Pn=Wi.log,li=Wi.unstable_setDisableYieldValue,Il=null,Hi=null,Rc,Ch,ks=!1,Th=new WeakMap,Rr=[],qs=0,wc=null,Vs=0,Pi=[],na=0,ls=null,Wa=1,Ra="",Vn=E(null),Ys=E(null),wr=E(null),kl=E(null),Fn=null,Dn=null,Ie=!1,xr=null,wa=!1,xa=Error(r(519)),Oi=typeof Object.is=="function"?Object.is:Gt,xc=E(null),os=null,oi=null,Ah=typeof AbortController<"u"?AbortController:function(){var s=[],u=this.signal={aborted:!1,addEventListener:function(p,S){s.push(S)}};this.abort=function(){u.aborted=!0,s.forEach(function(p){return p()})}},E0=Wi.unstable_scheduleCallback,Mc=Wi.unstable_NormalPriority,ln={$$typeof:_r,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},en=null,ql=null,Oh=!1,tu=!1,Ks=!1,ia=0,Vl=null,Nc=0,$a=0,Ri=null,Rh=se.S;se.S=function(s,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&Je(s,u),Rh!==null&&Rh(s,u)};var Mr=E(null),C0=Object.prototype.hasOwnProperty,Qs=Error(r(460)),eu=Error(r(474)),Xs=Error(r(542)),nu={then:function(){}},Ii=null,Ve=[],us=0,Dc=0,gn=!1,wh=!1,Fs=E(null),iu=E(0),Ye=0,le=null,De=null,jn=null,au=!1,Js=!1,Zs=!1,Ws=0,Jn=0,mi=null,T0=0,ui={readContext:ae,use:Ru,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useLayoutEffect:Tn,useInsertionEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useSyncExternalStore:Tn,useId:Tn,useHostTransitionStatus:Tn,useFormState:Tn,useActionState:Tn,useOptimistic:Tn,useMemoCache:Tn,useCacheRefresh:Tn},xh={readContext:ae,use:Ru,useCallback:function(s,u){return qn().memoizedState=[s,u===void 0?null:u],s},useContext:ae,useEffect:Af,useImperativeHandle:function(s,u,p){p=p!=null?p.concat([s]):null,dr(4194308,4,Ga.bind(null,u,s),p)},useLayoutEffect:function(s,u){return dr(4194308,4,s,u)},useInsertionEffect:function(s,u){dr(4,2,s,u)},useMemo:function(s,u){var p=qn();u=u===void 0?null:u;var S=s();if(Zs){K(!0);try{s()}finally{K(!1)}}return p.memoizedState=[S,u],S},useReducer:function(s,u,p){var S=qn();if(p!==void 0){var x=p(u);if(Zs){K(!0);try{p(u)}finally{K(!1)}}}else x=u;return S.memoizedState=S.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},S.queue=s,s=s.dispatch=Eo.bind(null,le,s),[S.memoizedState,s]},useRef:function(s){var u=qn();return s={current:s},u.memoizedState=s},useState:function(s){s=yo(s);var u=s.queue,p=Cd.bind(null,le,u);return u.dispatch=p,[s.memoizedState,p]},useDebugValue:_s,useDeferredValue:function(s,u){var p=qn();return El(p,s,u)},useTransition:function(){var s=yo(!1);return s=bo.bind(null,le,s.queue,!0,!1),qn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,u,p){var S=le,x=qn();if(Ie){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),nn===null)throw Error(r(349));(Ae&124)!==0||xu(S,u,p)}x.memoizedState=p;var H={value:p,getSnapshot:u};return x.queue=H,Af(vo.bind(null,S,H,s),[s]),S.flags|=2048,Ui(9,bl(),yf.bind(null,S,H,p,u),null),p},useId:function(){var s=qn(),u=nn.identifierPrefix;if(Ie){var p=Ra,S=Wa;p=(S&~(1<<32-Ai(S)-1)).toString(32)+p,u="«"+u+"R"+p,p=Ws++,0<p&&(u+="H"+p.toString(32)),u+="»"}else p=T0++,u="«"+u+"r"+p.toString(32)+"»";return s.memoizedState=u},useHostTransitionStatus:Bu,useFormState:Tf,useActionState:Tf,useOptimistic:function(s){var u=qn();u.memoizedState=u.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=Co.bind(null,le,!0,p),p.dispatch=u,[s,u]},useMemoCache:Sl,useCacheRefresh:function(){return qn().memoizedState=zu.bind(null,le)}},tr={readContext:ae,use:Ru,useCallback:gr,useContext:ae,useEffect:Du,useImperativeHandle:ju,useInsertionEffect:Of,useLayoutEffect:_l,useMemo:Uu,useReducer:fa,useRef:Nu,useState:function(){return fa(ca)},useDebugValue:_s,useDeferredValue:function(s,u){var p=zn();return Rf(p,De.memoizedState,s,u)},useTransition:function(){var s=fa(ca)[0],u=zn().memoizedState;return[typeof s=="boolean"?s:yl(s),u]},useSyncExternalStore:Sd,useId:bi,useHostTransitionStatus:Bu,useFormState:Mu,useActionState:Mu,useOptimistic:function(s,u){var p=zn();return Sf(p,De,s,u)},useMemoCache:Sl,useCacheRefresh:qr},$s={readContext:ae,use:Ru,useCallback:gr,useContext:ae,useEffect:Du,useImperativeHandle:ju,useInsertionEffect:Of,useLayoutEffect:_l,useMemo:Uu,useReducer:wu,useRef:Nu,useState:function(){return wu(ca)},useDebugValue:_s,useDeferredValue:function(s,u){var p=zn();return De===null?El(p,s,u):Rf(p,De.memoizedState,s,u)},useTransition:function(){var s=wu(ca)[0],u=zn().memoizedState;return[typeof s=="boolean"?s:yl(s),u]},useSyncExternalStore:Sd,useId:bi,useHostTransitionStatus:Bu,useFormState:So,useActionState:So,useOptimistic:function(s,u){var p=zn();return De!==null?Sf(p,De,s,u):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:Sl,useCacheRefresh:qr},ki=null,tl=0,cs=Td(!0),ma=Td(!1),aa=E(null),wi=null,On=E(0),el={enqueueSetState:function(s,u,p){s=s._reactInternals;var S=zi(),x=cr(S);x.payload=u,p!=null&&(x.callback=p),u=fr(s,x,S),u!==null&&(Li(u,s,S),ua(u,s,S))},enqueueReplaceState:function(s,u,p){s=s._reactInternals;var S=zi(),x=cr(S);x.tag=1,x.payload=u,p!=null&&(x.callback=p),u=fr(s,x,S),u!==null&&(Li(u,s,S),ua(u,s,S))},enqueueForceUpdate:function(s,u){s=s._reactInternals;var p=zi(),S=cr(p);S.tag=2,u!=null&&(S.callback=u),u=fr(s,S,p),u!==null&&(Li(u,s,p),ua(u,s,p))}},nl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Mh=Error(r(461)),Yn=!1,il={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},er=!1,bn=!1,jc=!1,A0=typeof WeakSet=="function"?WeakSet:Set,Zn=null,oe=null,Te=!1,pe=null,Ee=8192,We={getCacheForType:function(s){var u=ae(ln),p=u.data.get(s);return p===void 0&&(p=s(),u.data.set(s,p)),p}},vi=0,Ma=1,Nr=2,Yl=3,va=4;if(typeof Symbol=="function"&&Symbol.for){var on=Symbol.for;vi=on("selector.component"),Ma=on("selector.has_pseudo_class"),Nr=on("selector.role"),Yl=on("selector.test_id"),va=on("selector.text")}var fs=typeof WeakMap=="function"?WeakMap:Map,Ce=0,nn=null,fe=null,Ae=0,Ge=0,un=null,nr=!1,Dr=!1,Uc=!1,ya=0,pn=0,xi=0,mn=0,ir=0,ci=0,qi=0,al=null,yi=null,Bc=!1,rl=0,sl=1/0,Si=null,jr=null,Ke=0,Ur=null,ll=null,Kl=0,ar=0,Ql=null,zc=null,rr=0,Lc=null;return we.attemptContinuousHydration=function(s){if(s.tag===13){var u=Me(s,67108864);u!==null&&Li(u,s,67108864),$r(s,67108864)}},we.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var u=zi();u=P(u);var p=Me(s,u);p!==null&&Li(p,s,u),$r(s,u)}},we.attemptSynchronousHydration=function(s){switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var u=z(s.pendingLanes);if(u!==0){for(s.pendingLanes|=2,s.entangledLanes|=2;u;){var p=1<<31-Ai(u);s.entanglements[1]|=p,u&=~p}hn(s),(Ce&6)===0&&(sl=ea()+500,ct(0))}}break;case 13:u=Me(s,2),u!==null&&Li(u,s,2),Nl(),$r(s,2)}},we.batchedUpdates=function(s,u){return s(u)},we.createComponentSelector=function(s){return{$$typeof:vi,value:s}},we.createContainer=function(s,u,p,S,x,H,et,ot,_t,Nt){return rc(s,u,!1,null,p,S,H,et,ot,_t,Nt,null)},we.createHasPseudoClassSelector=function(s){return{$$typeof:Ma,value:s}},we.createHydrationContainer=function(s,u,p,S,x,H,et,ot,_t,Nt,zt,Qt,Xt){return s=rc(p,S,!0,s,x,H,ot,_t,Nt,zt,Qt,Xt),s.context=Ul(null),p=s.current,S=zi(),S=P(S),x=cr(S),x.callback=u??null,fr(p,x,S),u=S,s.current.lanes=u,A(s,u),hn(s),s},we.createPortal=function(s,u,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:br,key:S==null?null:""+S,children:s,containerInfo:u,implementation:p}},we.createRoleSelector=function(s){return{$$typeof:Nr,value:s}},we.createTestNameSelector=function(s){return{$$typeof:Yl,value:s}},we.createTextSelector=function(s){return{$$typeof:va,value:s}},we.defaultOnCaughtError=function(s){console.error(s)},we.defaultOnRecoverableError=function(s){nl(s)},we.defaultOnUncaughtError=function(s){nl(s)},we.deferredUpdates=function(s){var u=se.T,p=Qa();try{return Gn(32),se.T=null,s()}finally{Gn(p),se.T=u}},we.discreteUpdates=function(s,u,p,S,x){var H=se.T,et=Qa();try{return Gn(2),se.T=null,s(u,p,S,x)}finally{Gn(et),se.T=H,Ce===0&&(sl=ea()+500)}},we.findAllNodes=zo,we.findBoundingRects=function(s,u){if(!Fa)throw Error(r(363));u=zo(s,u),s=[];for(var p=0;p<u.length;p++)s.push(wn(u[p]));for(u=s.length-1;0<u;u--){p=s[u];for(var S=p.x,x=S+p.width,H=p.y,et=H+p.height,ot=u-1;0<=ot;ot--)if(u!==ot){var _t=s[ot],Nt=_t.x,zt=Nt+_t.width,Qt=_t.y,Xt=Qt+_t.height;if(S>=Nt&&H>=Qt&&x<=zt&&et<=Xt){s.splice(u,1);break}else if(S!==Nt||p.width!==_t.width||Xt<H||Qt>et){if(!(H!==Qt||p.height!==_t.height||zt<S||Nt>x)){Nt>S&&(_t.width+=Nt-S,_t.x=S),zt<x&&(_t.width=x-Nt),s.splice(u,1);break}}else{Qt>H&&(_t.height+=Qt-H,_t.y=H),Xt<et&&(_t.height=et-Qt),s.splice(u,1);break}}}return s},we.findHostInstance=Bl,we.findHostInstanceWithNoPortals=function(s){return s=d(s),s=s!==null?m(s):null,s===null?null:Ls(s.stateNode)},we.findHostInstanceWithWarning=function(s){return Bl(s)},we.flushPassiveEffects=xs,we.flushSyncFromReconciler=function(s){var u=Ce;Ce|=1;var p=se.T,S=Qa();try{if(Gn(2),se.T=null,s)return s()}finally{Gn(S),se.T=p,Ce=u,(Ce&6)===0&&ct(0)}},we.flushSyncWork=Nl,we.focusWithin=function(s,u){if(!Fa)throw Error(r(363));for(s=Ea(s),u=Jr(s,u),u=Array.from(u),s=0;s<u.length;){var p=u[s++],S=p.tag;if(!Hs(p)){if((S===5||S===26||S===27)&&Qd(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},we.getFindAllNodesFailureDescription=function(s,u){if(!Fa)throw Error(r(363));var p=0,S=[];s=[Ea(s),0];for(var x=0;x<s.length;){var H=s[x++],et=H.tag,ot=s[x++],_t=u[ot];if((et!==5&&et!==26&&et!==27||!Hs(H))&&($u(H,_t)&&(S.push(xl(_t)),ot++,ot>p&&(p=ot)),ot<u.length))for(H=H.child;H!==null;)s.push(H,ot),H=H.sibling}if(p<u.length){for(s=[];p<u.length;p++)s.push(xl(u[p]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},we.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 27:case 5:return Ls(s.child.stateNode);default:return s.child.stateNode}},we.injectIntoDevTools=function(){var s={bundleType:0,version:zs,rendererPackageName:Vd,currentDispatcherRef:se,reconcilerVersion:"19.1.0"};if(Ar!==null&&(s.rendererConfig=Ar),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)s=!0;else{try{Il=u.inject(s),Hi=u}catch{}s=!!u.checkDCE}}return s},we.isAlreadyRendering=function(){return(Ce&6)!==0},we.observeVisibleRects=function(s,u,p,S){if(!Fa)throw Error(r(363));s=zo(s,u);var x=Lg(s,p,S).disconnect;return{disconnect:function(){x()}}},we.shouldError=function(){return null},we.shouldSuspend=function(){return!1},we.startHostTransition=function(s,u,p,S){if(s.tag!==5)throw Error(r(476));var x=_o(s).queue;bo(s,x,u,Or,p===null?i:function(){var H=_o(s).next.queue;return Es(s,H,{},zi()),p(S)})},we.updateContainer=function(s,u,p,S){var x=u.current,H=zi();return sc(x,H,s,u,p,S),H},we.updateContainerSync=function(s,u,p,S){return sc(u.current,2,s,u,p,S),2},we},o.exports.default=o.exports,Object.defineProperty(o.exports,"__esModule",{value:!0})})(Np)),Np.exports}var $1;function U6(){return $1||($1=1,Mp.exports=j6()),Mp.exports}var B6=U6();const z6=ff(B6);var Up={exports:{}},ul={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function L6(){return ty||(ty=1,ul.ConcurrentRoot=1,ul.ContinuousEventPriority=8,ul.DefaultEventPriority=32,ul.DiscreteEventPriority=2,ul.IdleEventPriority=268435456,ul.LegacyRoot=0,ul.NoEventPriority=0),ul}var ey;function G6(){return ey||(ey=1,Up.exports=L6()),Up.exports}var wg=G6();const ny={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let iy=!1,ay=!1;const pg=".react-konva-event",H6=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,P6=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,I6={};function xg(o,t,n=I6){if(!iy&&"zIndex"in t&&(console.warn(P6),iy=!0),!ay&&t.draggable){var i=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;i&&!r&&(console.warn(H6),ay=!0)}for(var l in n)if(!ny[l]){var f=l.slice(0,2)==="on",d=n[l]!==t[l];if(f&&d){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),o.off(g,n[l])}var m=!t.hasOwnProperty(l);m&&o.setAttr(l,void 0)}var _=t._useStrictMode,C={},E=!1;const R={};for(var l in t)if(!ny[l]){var f=l.slice(0,2)==="on",v=n[l]!==t[l];if(f&&v){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),t[l]&&(R[g]=t[l])}!f&&(t[l]!==n[l]||_&&t[l]!==o.getAttr(l))&&(E=!0,C[l]=t[l])}E&&(o.setAttrs(C),po(o));for(var g in R)o.off(g+pg),o.on(g+pg,R[g])}function po(o){if(!Vt.autoDrawEnabled){var t=o.getLayer()||o.getStage();t&&t.batchDraw()}}var Bp={exports:{}},zp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ry;function k6(){return ry||(ry=1,(function(o){function t(j,I){var X=j.length;j.push(I);t:for(;0<X;){var W=X-1>>>1,at=j[W];if(0<r(at,I))j[W]=I,j[X]=at,X=W;else break t}}function n(j){return j.length===0?null:j[0]}function i(j){if(j.length===0)return null;var I=j[0],X=j.pop();if(X!==I){j[0]=X;t:for(var W=0,at=j.length,J=at>>>1;W<J;){var rt=2*(W+1)-1,it=j[rt],q=rt+1,F=j[q];if(0>r(it,X))q<at&&0>r(F,it)?(j[W]=F,j[q]=X,W=q):(j[W]=it,j[rt]=X,W=rt);else if(q<at&&0>r(F,X))j[W]=F,j[q]=X,W=q;else break t}}return I}function r(j,I){var X=j.sortIndex-I.sortIndex;return X!==0?X:j.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var f=Date,d=f.now();o.unstable_now=function(){return f.now()-d}}var g=[],m=[],_=1,C=null,E=3,R=!1,v=!1,D=!1,z=!1,L=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(j){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=j)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function w(j){if(D=!1,G(j),!v)if(n(g)!==null)v=!0,O||(O=!0,Y());else{var I=n(m);I!==null&&V(w,I.startTime-j)}}var O=!1,A=-1,y=5,B=-1;function U(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,O){var j=o.unstable_now();B=j;var I=!0;try{t:{v=!1,D&&(D=!1,N(A),A=-1),R=!0;var X=E;try{e:{for(G(j),C=n(g);C!==null&&!(C.expirationTime>j&&U());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var at=W(C.expirationTime<=j);if(j=o.unstable_now(),typeof at=="function"){C.callback=at,G(j),I=!0;break e}C===n(g)&&i(g),G(j)}else i(g);C=n(g)}if(C!==null)I=!0;else{var J=n(m);J!==null&&V(w,J.startTime-j),I=!1}}break t}finally{C=null,E=X,R=!1}I=void 0}}finally{I?Y():O=!1}}}var Y;if(typeof M=="function")Y=function(){M(P)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Q=K.port2;K.port1.onmessage=P,Y=function(){Q.postMessage(null)}}else Y=function(){L(P,0)};function V(j,I){A=L(function(){j(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(j){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var X=E;E=I;try{return j()}finally{E=X}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(j,I){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=E;E=j;try{return I()}finally{E=X}},o.unstable_scheduleCallback=function(j,I,X){var W=o.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?W+X:W):X=W,j){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=X+at,j={id:_++,callback:I,priorityLevel:j,startTime:X,expirationTime:at,sortIndex:-1},X>W?(j.sortIndex=X,t(m,j),n(g)===null&&j===n(m)&&(D?(N(A),A=-1):D=!0,V(w,X-W))):(j.sortIndex=at,t(g,j),v||R||(v=!0,O||(O=!0,Y()))),j},o.unstable_shouldYield=U,o.unstable_wrapCallback=function(j){var I=E;return function(){var X=E;E=I;try{return j.apply(this,arguments)}finally{E=X}}}})(zp)),zp}var sy;function q6(){return sy||(sy=1,Bp.exports=k6()),Bp.exports}var Lp=q6();const lS={},V6={};lf.Node.prototype._applyProps=xg;let oS=wg.DefaultEventPriority;function Y6(o,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}o.add(t),po(o)}function K6(o,t,n){let i=lf[o];i||(console.error(`Konva has no node with the type ${o}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${o}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),i=lf.Group);const r={},l={};for(var f in t)if(f!=="ref"){var d=f.slice(0,2)==="on";d?l[f]=t[f]:r[f]=t[f]}const g=new i(r);return xg(g,l),g}function Q6(o,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${o}"`)}function X6(o,t,n){return!1}function F6(o){return o}function J6(){return null}function Z6(){return null}function W6(o,t,n,i){return V6}function $6(){}function t8(o){}function e8(o,t){return!1}function n8(){return lS}function i8(){return lS}const a8=setTimeout,r8=clearTimeout,s8=!0,l8=o=>{o()},o8=-1;function u8(o,t){return!1}const c8=!1,f8=!1,h8=!0,d8=!1,g8=!1;function p8(o,t){t.parent===o?t.moveToTop():o.add(t),po(o)}function m8(o,t){t.parent===o?t.moveToTop():o.add(t),po(o)}function uS(o,t,n){t._remove(),o.add(t),t.setZIndex(n.getZIndex()),po(o)}function v8(o,t,n){uS(o,t,n)}function y8(o,t){t.destroy(),t.off(pg),po(o)}function S8(o,t){t.destroy(),t.off(pg),po(o)}function b8(o,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function _8(o,t,n){}function E8(o,t,n,i){xg(o,i,n)}function C8(o){o.hide(),po(o)}function T8(o){}function A8(o,t){(t.visible==null||t.visible)&&o.show()}function O8(o,t){}function R8(o){}function w8(){}function x8(){return wg.DefaultEventPriority}function M8(){}function N8(){return null}function D8(o){oS=o}function j8(){return oS}function U8(){return wg.DiscreteEventPriority}function B8(){return!1}function z8(){}function L8(){return!1}function G8(){return!0}function H8(){}function P8(){}function I8(){return null}const k8=null;function q8(){}const V8=Object.freeze(Object.defineProperty({__proto__:null,NotPendingTransition:k8,appendChild:p8,appendChildToContainer:m8,appendInitialChild:Y6,cancelTimeout:r8,clearContainer:R8,commitMount:_8,commitTextUpdate:b8,commitUpdate:E8,createInstance:K6,createTextInstance:Q6,detachDeletedInstance:w8,finalizeInitialChildren:X6,getChildHostContext:i8,getCurrentEventPriority:x8,getCurrentUpdatePriority:j8,getInstanceFromScope:N8,getPublicInstance:F6,getRootHostContext:n8,hideInstance:C8,hideTextInstance:T8,idlePriority:Lp.unstable_IdlePriority,insertBefore:uS,insertInContainerBefore:v8,isPrimaryRenderer:c8,maySuspendCommit:L8,noTimeout:o8,now:Lp.unstable_now,preloadInstance:G8,prepareForCommit:J6,preparePortalMount:Z6,prepareScopeUpdate:M8,prepareUpdate:W6,removeChild:y8,removeChildFromContainer:S8,requestPostPaintCallback:z8,resetAfterCommit:$6,resetFormInstance:q8,resetTextContent:t8,resolveUpdatePriority:U8,run:Lp.unstable_runWithPriority,scheduleMicrotask:l8,scheduleTimeout:a8,setCurrentUpdatePriority:D8,shouldAttemptEagerTransition:B8,shouldDeprioritizeSubtree:e8,shouldSetTextContent:u8,startSuspendingCommit:H8,supportsHydration:g8,supportsMicrotasks:s8,supportsMutation:h8,supportsPersistence:d8,suspendInstance:P8,unhideInstance:A8,unhideTextInstance:O8,waitForCommitToBeReady:I8,warnsIfNotActing:f8},Symbol.toStringTag,{value:"Module"}));function cS(o,t,n){if(!o)return;if(n(o)===!0)return o;let i=o.child;for(;i;){const r=cS(i,t,n);if(r)return r;i=i.sibling}}function fS(o){try{return Object.defineProperties(o,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return o}}const nv=fS(dt.createContext(null));class hS extends dt.Component{render(){return dt.createElement(nv.Provider,{value:this._reactInternals},this.props.children)}}function Y8(){const o=dt.useContext(nv);if(o===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=dt.useId();return dt.useMemo(()=>{for(const n of[o,o==null?void 0:o.alternate]){if(!n)continue;const i=cS(n,!1,r=>{let l=r.memoizedState;for(;l;){if(l.memoizedState===t)return!0;l=l.next}});if(i)return i}},[o,t])}const K8=Symbol.for("react.context"),Q8=o=>o!==null&&typeof o=="object"&&"$$typeof"in o&&o.$$typeof===K8;function X8(){const o=Y8(),[t]=dt.useState(()=>new Map);t.clear();let n=o;for(;n;){const i=n.type;Q8(i)&&i!==nv&&!t.has(i)&&t.set(i,dt.use(fS(i))),n=n.return}return t}function F8(){const o=X8();return dt.useMemo(()=>Array.from(o.keys()).reduce((t,n)=>i=>dt.createElement(t,null,dt.createElement(n.Provider,{...i,value:o.get(n)})),t=>dt.createElement(hS,{...t})),[o])}if(In.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function J8(o){const t=In.useRef({});return In.useLayoutEffect(()=>{t.current=o}),In.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const Z8=()=>{const o=In.useRef(0);return In.useMemo(()=>{o.current++},[]),o.current>1},W8=o=>{const t=In.useRef(null),n=In.useRef(null),i=In.useRef(null),r=J8(o),l=F8(),f=In.useRef(!1),d=m=>{const{forwardedRef:_}=o;_&&(typeof _=="function"?_(m):_.current=m)},g=Z8();return In.useLayoutEffect(()=>f.current&&g?()=>{f.current=!1,d(null),tf.updateContainer(null,i.current,null),n.current.destroy()}:(f.current=!0,n.current=new lf.Stage({width:o.width,height:o.height,container:t.current}),d(n.current),i.current=tf.createContainer(n.current,wg.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),tf.updateContainer(In.createElement(l,{},o.children),i.current,null,()=>{}),()=>{g||(d(null),tf.updateContainer(null,i.current,null),n.current.destroy())}),[]),In.useLayoutEffect(()=>{d(n.current),xg(n.current,o,r),tf.updateContainer(In.createElement(l,{},o.children),i.current,null)}),In.createElement("div",{ref:t,id:o.id,accessKey:o.accessKey,className:o.className,role:o.role,style:o.style,tabIndex:o.tabIndex,title:o.title})},dl="Layer",of="Line",iv="Image",tf=z6(V8);tf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:In.version,rendererPackageName:"react-konva"});const av=In.forwardRef((o,t)=>In.createElement(hS,{},In.createElement(W8,{...o,forwardedRef:t})));var Gp={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var ly;function dS(){return ly||(ly=1,(function(o,t){(function(i,r){o.exports=r()})(window,function(){return(function(n){var i={};function r(l){if(i[l])return i[l].exports;var f=i[l]={i:l,l:!1,exports:{}};return n[l].call(f.exports,f,f.exports,r),f.l=!0,f.exports}return r.m=n,r.c=i,r.d=function(l,f,d){r.o(l,f)||Object.defineProperty(l,f,{enumerable:!0,get:d})},r.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},r.t=function(l,f){if(f&1&&(l=r(l)),f&8||f&4&&typeof l=="object"&&l&&l.__esModule)return l;var d=Object.create(null);if(r.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:l}),f&2&&typeof l!="string")for(var g in l)r.d(d,g,(function(m){return l[m]}).bind(null,g));return d},r.n=function(l){var f=l&&l.__esModule?function(){return l.default}:function(){return l};return r.d(f,"a",f),f},r.o=function(l,f){return Object.prototype.hasOwnProperty.call(l,f)},r.p="",r(r.s=42)})([(function(n,i,r){r.r(i),r.d(i,"__extends",function(){return f}),r.d(i,"__assign",function(){return d}),r.d(i,"__rest",function(){return g}),r.d(i,"__decorate",function(){return m}),r.d(i,"__param",function(){return _}),r.d(i,"__metadata",function(){return C}),r.d(i,"__awaiter",function(){return E}),r.d(i,"__generator",function(){return R}),r.d(i,"__createBinding",function(){return v}),r.d(i,"__exportStar",function(){return D}),r.d(i,"__values",function(){return z}),r.d(i,"__read",function(){return L}),r.d(i,"__spread",function(){return N}),r.d(i,"__spreadArrays",function(){return M}),r.d(i,"__spreadArray",function(){return G}),r.d(i,"__await",function(){return w}),r.d(i,"__asyncGenerator",function(){return O}),r.d(i,"__asyncDelegator",function(){return A}),r.d(i,"__asyncValues",function(){return y}),r.d(i,"__makeTemplateObject",function(){return B}),r.d(i,"__importStar",function(){return P}),r.d(i,"__importDefault",function(){return Y}),r.d(i,"__classPrivateFieldGet",function(){return K}),r.d(i,"__classPrivateFieldSet",function(){return Q});/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */var l=function(V,j){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,X){I.__proto__=X}||function(I,X){for(var W in X)Object.prototype.hasOwnProperty.call(X,W)&&(I[W]=X[W])},l(V,j)};function f(V,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");l(V,j);function I(){this.constructor=V}V.prototype=j===null?Object.create(j):(I.prototype=j.prototype,new I)}var d=function(){return d=Object.assign||function(j){for(var I,X=1,W=arguments.length;X<W;X++){I=arguments[X];for(var at in I)Object.prototype.hasOwnProperty.call(I,at)&&(j[at]=I[at])}return j},d.apply(this,arguments)};function g(V,j){var I={};for(var X in V)Object.prototype.hasOwnProperty.call(V,X)&&j.indexOf(X)<0&&(I[X]=V[X]);if(V!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,X=Object.getOwnPropertySymbols(V);W<X.length;W++)j.indexOf(X[W])<0&&Object.prototype.propertyIsEnumerable.call(V,X[W])&&(I[X[W]]=V[X[W]]);return I}function m(V,j,I,X){var W=arguments.length,at=W<3?j:X===null?X=Object.getOwnPropertyDescriptor(j,I):X,J;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")at=Reflect.decorate(V,j,I,X);else for(var rt=V.length-1;rt>=0;rt--)(J=V[rt])&&(at=(W<3?J(at):W>3?J(j,I,at):J(j,I))||at);return W>3&&at&&Object.defineProperty(j,I,at),at}function _(V,j){return function(I,X){j(I,X,V)}}function C(V,j){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(V,j)}function E(V,j,I,X){function W(at){return at instanceof I?at:new I(function(J){J(at)})}return new(I||(I=Promise))(function(at,J){function rt(F){try{q(X.next(F))}catch(tt){J(tt)}}function it(F){try{q(X.throw(F))}catch(tt){J(tt)}}function q(F){F.done?at(F.value):W(F.value).then(rt,it)}q((X=X.apply(V,j||[])).next())})}function R(V,j){var I={label:0,sent:function(){if(at[0]&1)throw at[1];return at[1]},trys:[],ops:[]},X,W,at,J;return J={next:rt(0),throw:rt(1),return:rt(2)},typeof Symbol=="function"&&(J[Symbol.iterator]=function(){return this}),J;function rt(q){return function(F){return it([q,F])}}function it(q){if(X)throw new TypeError("Generator is already executing.");for(;I;)try{if(X=1,W&&(at=q[0]&2?W.return:q[0]?W.throw||((at=W.return)&&at.call(W),0):W.next)&&!(at=at.call(W,q[1])).done)return at;switch(W=0,at&&(q=[q[0]&2,at.value]),q[0]){case 0:case 1:at=q;break;case 4:return I.label++,{value:q[1],done:!1};case 5:I.label++,W=q[1],q=[0];continue;case 7:q=I.ops.pop(),I.trys.pop();continue;default:if(at=I.trys,!(at=at.length>0&&at[at.length-1])&&(q[0]===6||q[0]===2)){I=0;continue}if(q[0]===3&&(!at||q[1]>at[0]&&q[1]<at[3])){I.label=q[1];break}if(q[0]===6&&I.label<at[1]){I.label=at[1],at=q;break}if(at&&I.label<at[2]){I.label=at[2],I.ops.push(q);break}at[2]&&I.ops.pop(),I.trys.pop();continue}q=j.call(V,I)}catch(F){q=[6,F],W=0}finally{X=at=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}var v=Object.create?(function(V,j,I,X){X===void 0&&(X=I),Object.defineProperty(V,X,{enumerable:!0,get:function(){return j[I]}})}):(function(V,j,I,X){X===void 0&&(X=I),V[X]=j[I]});function D(V,j){for(var I in V)I!=="default"&&!Object.prototype.hasOwnProperty.call(j,I)&&v(j,V,I)}function z(V){var j=typeof Symbol=="function"&&Symbol.iterator,I=j&&V[j],X=0;if(I)return I.call(V);if(V&&typeof V.length=="number")return{next:function(){return V&&X>=V.length&&(V=void 0),{value:V&&V[X++],done:!V}}};throw new TypeError(j?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(V,j){var I=typeof Symbol=="function"&&V[Symbol.iterator];if(!I)return V;var X=I.call(V),W,at=[],J;try{for(;(j===void 0||j-- >0)&&!(W=X.next()).done;)at.push(W.value)}catch(rt){J={error:rt}}finally{try{W&&!W.done&&(I=X.return)&&I.call(X)}finally{if(J)throw J.error}}return at}function N(){for(var V=[],j=0;j<arguments.length;j++)V=V.concat(L(arguments[j]));return V}function M(){for(var V=0,j=0,I=arguments.length;j<I;j++)V+=arguments[j].length;for(var X=Array(V),W=0,j=0;j<I;j++)for(var at=arguments[j],J=0,rt=at.length;J<rt;J++,W++)X[W]=at[J];return X}function G(V,j,I){if(I||arguments.length===2)for(var X=0,W=j.length,at;X<W;X++)(at||!(X in j))&&(at||(at=Array.prototype.slice.call(j,0,X)),at[X]=j[X]);return V.concat(at||Array.prototype.slice.call(j))}function w(V){return this instanceof w?(this.v=V,this):new w(V)}function O(V,j,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var X=I.apply(V,j||[]),W,at=[];return W={},J("next"),J("throw"),J("return"),W[Symbol.asyncIterator]=function(){return this},W;function J(nt){X[nt]&&(W[nt]=function(gt){return new Promise(function(At,Bt){at.push([nt,gt,At,Bt])>1||rt(nt,gt)})})}function rt(nt,gt){try{it(X[nt](gt))}catch(At){tt(at[0][3],At)}}function it(nt){nt.value instanceof w?Promise.resolve(nt.value.v).then(q,F):tt(at[0][2],nt)}function q(nt){rt("next",nt)}function F(nt){rt("throw",nt)}function tt(nt,gt){nt(gt),at.shift(),at.length&&rt(at[0][0],at[0][1])}}function A(V){var j,I;return j={},X("next"),X("throw",function(W){throw W}),X("return"),j[Symbol.iterator]=function(){return this},j;function X(W,at){j[W]=V[W]?function(J){return(I=!I)?{value:w(V[W](J)),done:W==="return"}:at?at(J):J}:at}}function y(V){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var j=V[Symbol.asyncIterator],I;return j?j.call(V):(V=typeof z=="function"?z(V):V[Symbol.iterator](),I={},X("next"),X("throw"),X("return"),I[Symbol.asyncIterator]=function(){return this},I);function X(at){I[at]=V[at]&&function(J){return new Promise(function(rt,it){J=V[at](J),W(rt,it,J.done,J.value)})}}function W(at,J,rt,it){Promise.resolve(it).then(function(q){at({value:q,done:rt})},J)}}function B(V,j){return Object.defineProperty?Object.defineProperty(V,"raw",{value:j}):V.raw=j,V}var U=Object.create?(function(V,j){Object.defineProperty(V,"default",{enumerable:!0,value:j})}):function(V,j){V.default=j};function P(V){if(V&&V.__esModule)return V;var j={};if(V!=null)for(var I in V)I!=="default"&&Object.prototype.hasOwnProperty.call(V,I)&&v(j,V,I);return U(j,V),j}function Y(V){return V&&V.__esModule?V:{default:V}}function K(V,j,I,X){if(I==="a"&&!X)throw new TypeError("Private accessor was defined without a getter");if(typeof j=="function"?V!==j||!X:!j.has(V))throw new TypeError("Cannot read private member from an object whose class did not declare it");return I==="m"?X:I==="a"?X.call(V):X?X.value:j.get(V)}function Q(V,j,I,X,W){if(X==="m")throw new TypeError("Private method is not writable");if(X==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof j=="function"?V!==j||!W:!j.has(V))throw new TypeError("Cannot write private member to an object whose class did not declare it");return X==="a"?W.call(V,I):W?W.value=I:j.set(V,I),I}}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0}),i.allToUpperCase=i.allToLowerCase=i.encodeBody=i.decodeBody=i.Format=i.promisify=i.trim=i.arrChooseN=i.randomHexString=i.randomString=i.cheapRandStr=i.dataSizeBytes=i.inspectBody=i.inspectError=i.isErrorInfoOrPartialErrorInfo=i.now=i.parseQueryString=i.toQueryString=i.arrPopRandomElement=i.defaultPostHeaders=i.defaultGetHeaders=i.allSame=i.arrEvery=i.arrFilter=i.arrMap=i.safeArrForEach=i.arrForEach=i.forInOwnNonNullProperties=i.valuesArray=i.keysArray=i.arrWithoutValue=i.arrDeleteValue=i.arrIn=i.arrIndexOf=i.arrSubtract=i.arrIntersectOb=i.arrIntersect=i.intersect=i.containsValue=i.inherits=i.prototypicalClone=i.shallowClone=i.isEmptyArg=i.isOnlyPropIn=i.isEmpty=i.isObject=i.ensureArray=i.isArray=i.copy=i.mixin=void 0,i.arrEquals=i.toBase64=i.matchDerivedChannel=i.shallowEquals=i.getGlobalObject=i.getRetryTime=i.getJitterCoefficient=i.getBackoffCoefficient=void 0;var f=r(0),d=f.__importDefault(r(3)),g=f.__importStar(r(8)),m=f.__importDefault(r(4)),_=r(11),C=r(31);function E(ct){return Math.floor(Math.random()*ct.length)}function R(ct){for(var ht=[],ut=1;ut<arguments.length;ut++)ht[ut-1]=arguments[ut];for(var xt=0;xt<ht.length;xt++){var Dt=ht[xt];if(!Dt)break;var $t=Object.prototype.hasOwnProperty;for(var de in Dt)(!$t||$t.call(Dt,de))&&(ct[de]=Dt[de])}return ct}i.mixin=R;function v(ct){return R({},ct)}i.copy=v,i.isArray=Array.isArray||function(ct){return Object.prototype.toString.call(ct)=="[object Array]"};function D(ct){return M(ct)?[]:(0,i.isArray)(ct)?ct:[ct]}i.ensureArray=D;function z(ct){return Object.prototype.toString.call(ct)=="[object Object]"}i.isObject=z;function L(ct){for(var ht in ct)return!1;return!0}i.isEmpty=L;function N(ct,ht){for(var ut in ct)if(ut!==ht)return!1;return!0}i.isOnlyPropIn=N;function M(ct){return ct==null}i.isEmptyArg=M;function G(ct){var ht=new Object;for(var ut in ct)ht[ut]=ct[ut];return ht}i.shallowClone=G;function w(ct,ht){var ut=(function(){function Dt(){}return Dt})();ut.prototype=ct;var xt=new ut;return ht&&R(xt,ht),xt}i.prototypicalClone=w;var O=function(ct,ht){if(d.default.Config.inherits){d.default.Config.inherits(ct,ht);return}ct.super_=ht,ct.prototype=w(ht.prototype,{constructor:ct})};i.inherits=O;function A(ct,ht){for(var ut in ct)if(ct[ut]==ht)return!0;return!1}i.containsValue=A;function y(ct,ht){return(0,i.isArray)(ht)?B(ct,ht):U(ct,ht)}i.intersect=y;function B(ct,ht){for(var ut=[],xt=0;xt<ct.length;xt++){var Dt=ct[xt];(0,i.arrIndexOf)(ht,Dt)!=-1&&ut.push(Dt)}return ut}i.arrIntersect=B;function U(ct,ht){for(var ut=[],xt=0;xt<ct.length;xt++){var Dt=ct[xt];Dt in ht&&ut.push(Dt)}return ut}i.arrIntersectOb=U;function P(ct,ht){for(var ut=[],xt=0;xt<ct.length;xt++){var Dt=ct[xt];(0,i.arrIndexOf)(ht,Dt)==-1&&ut.push(Dt)}return ut}i.arrSubtract=P,i.arrIndexOf=Array.prototype.indexOf?function(ct,ht,ut){return ct.indexOf(ht,ut)}:function(ct,ht,ut){ut=ut||0;for(var xt=ct.length;ut<xt;ut++)if(ct[ut]===ht)return ut;return-1};function Y(ct,ht){return(0,i.arrIndexOf)(ct,ht)!==-1}i.arrIn=Y;function K(ct,ht){var ut=(0,i.arrIndexOf)(ct,ht),xt=ut!=-1;return xt&&ct.splice(ut,1),xt}i.arrDeleteValue=K;function Q(ct,ht){var ut=ct.slice();return K(ut,ht),ut}i.arrWithoutValue=Q;function V(ct,ht){var ut=[];for(var xt in ct)ht&&!Object.prototype.hasOwnProperty.call(ct,xt)||ut.push(xt);return ut}i.keysArray=V;function j(ct,ht){var ut=[];for(var xt in ct)ht&&!Object.prototype.hasOwnProperty.call(ct,xt)||ut.push(ct[xt]);return ut}i.valuesArray=j;function I(ct,ht){for(var ut in ct)Object.prototype.hasOwnProperty.call(ct,ut)&&ct[ut]&&ht(ut)}i.forInOwnNonNullProperties=I,i.arrForEach=Array.prototype.forEach?function(ct,ht){ct.forEach(ht)}:function(ct,ht){for(var ut=ct.length,xt=0;xt<ut;xt++)ht(ct[xt],xt,ct)};function X(ct,ht){return(0,i.arrForEach)(ct.slice(),ht)}i.safeArrForEach=X,i.arrMap=Array.prototype.map?function(ct,ht){return ct.map(ht)}:function(ct,ht){for(var ut=[],xt=ct.length,Dt=0;Dt<xt;Dt++)ut.push(ht(ct[Dt],Dt,ct));return ut},i.arrFilter=Array.prototype.filter?function(ct,ht){return ct.filter(ht)}:function(ct,ht){for(var ut=[],xt=ct.length,Dt=0;Dt<xt;Dt++)ht(ct[Dt])&&ut.push(ct[Dt]);return ut},i.arrEvery=Array.prototype.every?function(ct,ht){return ct.every(ht)}:function(ct,ht){for(var ut=ct.length,xt=0;xt<ut;xt++)if(!ht(ct[xt],xt,ct))return!1;return!0};function W(ct,ht){if(ct.length===0)return!0;var ut=ct[0][ht];return(0,i.arrEvery)(ct,function(xt){return xt[ht]===ut})}i.allSame=W;var at={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function J(ct,ht){var ut=at[ht||be.json];return{accept:ut,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ct)}}i.defaultGetHeaders=J;function rt(ct,ht){var ut,xt=ut=at[ht||be.json];return{accept:xt,"content-type":ut,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ct)}}i.defaultPostHeaders=rt;function it(ct){return ct.splice(E(ct),1)[0]}i.arrPopRandomElement=it;function q(ct){var ht=[];if(ct)for(var ut in ct)ht.push(encodeURIComponent(ut)+"="+encodeURIComponent(ct[ut]));return ht.length?"?"+ht.join("&"):""}i.toQueryString=q;function F(ct){for(var ht,ut=/([^?&=]+)=?([^&]*)/g,xt={};ht=ut.exec(ct);)xt[decodeURIComponent(ht[1])]=decodeURIComponent(ht[2]);return xt}i.parseQueryString=F,i.now=Date.now||function(){return new Date().getTime()};function tt(ct){return typeof ct=="object"&&ct!==null&&(ct.constructor.name=="ErrorInfo"||ct.constructor.name=="PartialErrorInfo")}i.isErrorInfoOrPartialErrorInfo=tt;function nt(ct){var ht,ut;return ct instanceof Error||((ht=ct==null?void 0:ct.constructor)===null||ht===void 0?void 0:ht.name)==="ErrorInfo"||((ut=ct==null?void 0:ct.constructor)===null||ut===void 0?void 0:ut.name)==="PartialErrorInfo"?ct.toString():d.default.Config.inspect(ct)}i.inspectError=nt;function gt(ct){return d.default.BufferUtils.isBuffer(ct)?ct.toString():typeof ct=="string"?ct:d.default.Config.inspect(ct)}i.inspectBody=gt;function At(ct){if(d.default.BufferUtils.isBuffer(ct))return d.default.BufferUtils.byteLength(ct);if(typeof ct=="string")return d.default.Config.stringByteSize(ct);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof ct)}i.dataSizeBytes=At;function Bt(){return String(Math.random()).substr(2)}i.cheapRandStr=Bt;var qt=function(ct){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var ht=new Uint8Array(ct);return d.default.Config.getRandomValues(ht),d.default.BufferUtils.base64Encode(ht)}for(var ut=d.default.BufferUtils.base64CharSet,xt=Math.round(ct*4/3),Dt="",$t=0;$t<xt;$t++)Dt+=ut[E(ut)];return Dt};i.randomString=qt;var Jt=function(ct){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var ht=new Uint8Array(ct);return d.default.Config.getRandomValues(ht),d.default.BufferUtils.hexEncode(ht)}for(var ut=d.default.BufferUtils.hexCharSet,xt=ct*2,Dt="",$t=0;$t<xt;$t++)Dt+=ut[E(ut)];return Dt};i.randomHexString=Jt;function ee(ct,ht){for(var ut=Math.min(ht,ct.length),xt=ct.slice(),Dt=[],$t=0;$t<ut;$t++)Dt.push(it(xt));return Dt}i.arrChooseN=ee,i.trim=String.prototype.trim?function(ct){return ct.trim()}:function(ct){return ct.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function Gt(ct,ht,ut){return new Promise(function(xt,Dt){ct[ht].apply(ct,f.__spreadArray(f.__spreadArray([],ut,!1),[function($t,de){$t?Dt($t):xt(de)}],!1))})}i.promisify=Gt;var be;(function(ct){ct.msgpack="msgpack",ct.json="json"})(be=i.Format||(i.Format={}));function Re(ct,ht){return ht=="msgpack"?d.default.Config.msgpack.decode(ct):JSON.parse(String(ct))}i.decodeBody=Re;function tn(ct,ht){return ht=="msgpack"?d.default.Config.msgpack.encode(ct,!0):JSON.stringify(ct)}i.encodeBody=tn;function Rt(ct){return ct.map(function(ht){return ht&&ht.toLowerCase()})}i.allToLowerCase=Rt;function Kt(ct){return ct.map(function(ht){return ht&&ht.toUpperCase()})}i.allToUpperCase=Kt;function Be(ct){return Math.min((ct+2)/3,2)}i.getBackoffCoefficient=Be;function te(){return 1-Math.random()*.2}i.getJitterCoefficient=te;function ae(ct,ht){return ct*Be(ht)*te()}i.getRetryTime=ae;function qe(){return l||(typeof window<"u"?window:self)}i.getGlobalObject=qe;function xe(ct,ht){return Object.keys(ct).every(function(ut){return ct[ut]===ht[ut]})&&Object.keys(ht).every(function(ut){return ht[ut]===ct[ut]})}i.shallowEquals=xe;function an(ct){var ht=/^(\[([^?]*)(?:(.*))\])?(.+)$/,ut=ct.match(ht);if(!ut||!ut.length||ut.length<5)throw new m.default("regex match failed",400,40010);if(ut[2])throw new m.default("cannot use a derived option with a ".concat(ut[2]," channel"),400,40010);return{qualifierParam:ut[3]||"",channelName:ut[4]}}i.matchDerivedChannel=an;function yn(ct){return d.default.Config.createHmac?Buffer.from(ct,"ascii").toString("base64"):(0,_.stringify)((0,C.parse)(ct))}i.toBase64=yn;function hn(ct,ht){return ct.length===ht.length&&(0,i.arrEvery)(ct,function(ut,xt){return ut===ht[xt]})}i.arrEquals=hn}).call(this,r(13))}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),d=f.__importDefault(r(3)),g=l||(typeof window<"u"?window:self),m;(function(v){v[v.None=0]="None",v[v.Error=1]="Error",v[v.Major=2]="Major",v[v.Minor=3]="Minor",v[v.Micro=4]="Micro"})(m||(m={}));function _(v,D){return"".concat(v).padStart(D?3:2,"0")}function C(v){return d.default.Config.logTimestamps?function(D){var z=new Date;v(_(z.getHours())+":"+_(z.getMinutes())+":"+_(z.getSeconds())+"."+_(z.getMilliseconds(),1)+" "+D)}:v}var E=function(){var v,D,z,L;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((D=(v=g==null?void 0:g.console)===null||v===void 0?void 0:v.log)===null||D===void 0?void 0:D.apply)=="function"?(z=function(){for(var N=[],M=0;M<arguments.length;M++)N[M]=arguments[M];console.log.apply(console,N)},L=console.warn?function(){for(var N=[],M=0;M<arguments.length;M++)N[M]=arguments[M];console.warn.apply(console,N)}:z):g!=null&&g.console.log?z=L=function(){Function.prototype.apply.call(console.log,console,arguments)}:z=L=function(){},[z,L].map(C)},R=(function(){function v(){v.logLevel=v.LOG_DEFAULT}return v.initLogHandlers=function(){var D=E(),z=D[0],L=D[1];this.logHandler=z,this.logErrorHandler=L},v.renamedClientOption=function(D,z){v.deprecationWarning("The `".concat(D,"` client option has been renamed to `").concat(z,"`. Please update your code to use `").concat(z,"` instead. `").concat(D,"` will be removed in a future version."))},v.renamedMethod=function(D,z,L){v.deprecationWarning("`".concat(D,"`’s `").concat(z,"` method has been renamed to `").concat(L,"`. Please update your code to use `").concat(L,"` instead. `").concat(z,"` will be removed in a future version."))},v.deprecationWarning=function(D){v.shouldLog(m.Error)&&v.logErrorHandler("Ably: Deprecation warning - ".concat(D))},v.logLevel=m.Error,v.LOG_NONE=m.None,v.LOG_ERROR=m.Error,v.LOG_MAJOR=m.Major,v.LOG_MINOR=m.Minor,v.LOG_MICRO=m.Micro,v.LOG_DEFAULT=m.Error,v.LOG_DEBUG=m.Micro,v.logAction=function(D,z,L){v.shouldLog(D)&&(D===m.Error?v.logErrorHandler:v.logHandler)("Ably: "+z+": "+L)},v.deprecated=function(D,z){v.deprecationWarning("".concat(D," is deprecated and will be removed in a future version. ").concat(z))},v.shouldLog=function(D){return D<=v.logLevel},v.setLog=function(D,z){D!==void 0&&(v.logLevel=D),z!==void 0&&(v.logHandler=v.logErrorHandler=z)},v})();i.default=R}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function f(){}return f})();i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.PartialErrorInfo=void 0;var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1));function g(C){var E="["+C.constructor.name;return C.message&&(E+=": "+C.message),C.statusCode&&(E+="; statusCode="+C.statusCode),C.code&&(E+="; code="+C.code),C.cause&&(E+="; cause="+d.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(E+="; see "+C.href+" "),E+="]",E}var m=(function(C){l.__extends(E,C);function E(R,v,D,z){var L=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(L,E.prototype),L.code=v,L.statusCode=D,L.cause=z,L}return E.prototype.toString=function(){return g(this)},E.fromValues=function(R){var v=R,D=v.message,z=v.code,L=v.statusCode;if(typeof D!="string"||typeof z!="number"||typeof L!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+f.default.Config.inspect(R));var N=Object.assign(new E(D,z,L),R);return N.code&&!N.href&&(N.href="https://help.ably.io/error/"+N.code),N},E})(Error);i.default=m;var _=(function(C){l.__extends(E,C);function E(R,v,D,z){var L=C.call(this,R)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(L,E.prototype),L.code=v,L.statusCode=D,L.cause=z,L}return E.prototype.toString=function(){return g(this)},E})(Error);i.PartialErrorInfo=_}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){if(typeof ArrayBuffer=="function"){var f=l,d=f.lib,g=d.WordArray,m=g.init,_=g.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var E=C.byteLength,R=[],v=0;v<E;v++)R[v>>>2]|=C[v]<<24-v%4*8;m.call(this,R,E)}else m.apply(this,arguments)};_.prototype=g}})(),l.lib.WordArray})}),(function(n,i,r){(function(l){(function(f,d){n.exports=d()})(this,function(){var f=f||(function(d,g){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof l<"u"&&l.crypto&&(m=l.crypto),!m)try{m=r(44)}catch{}var _=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||(function(){function O(){}return function(A){var y;return O.prototype=A,y=new O,O.prototype=null,y}})(),E={},R=E.lib={},v=R.Base=(function(){return{extend:function(O){var A=C(this);return O&&A.mixIn(O),(!A.hasOwnProperty("init")||this.init===A.init)&&(A.init=function(){A.$super.init.apply(this,arguments)}),A.init.prototype=A,A.$super=this,A},create:function(){var O=this.extend();return O.init.apply(O,arguments),O},init:function(){},mixIn:function(O){for(var A in O)O.hasOwnProperty(A)&&(this[A]=O[A]);O.hasOwnProperty("toString")&&(this.toString=O.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),D=R.WordArray=v.extend({init:function(O,A){O=this.words=O||[],A!=g?this.sigBytes=A:this.sigBytes=O.length*4},toString:function(O){return(O||L).stringify(this)},concat:function(O){var A=this.words,y=O.words,B=this.sigBytes,U=O.sigBytes;if(this.clamp(),B%4)for(var P=0;P<U;P++){var Y=y[P>>>2]>>>24-P%4*8&255;A[B+P>>>2]|=Y<<24-(B+P)%4*8}else for(var P=0;P<U;P+=4)A[B+P>>>2]=y[P>>>2];return this.sigBytes+=U,this},clamp:function(){var O=this.words,A=this.sigBytes;O[A>>>2]&=4294967295<<32-A%4*8,O.length=d.ceil(A/4)},clone:function(){var O=v.clone.call(this);return O.words=this.words.slice(0),O},random:function(O){for(var A=[],y=0;y<O;y+=4)A.push(_());return new D.init(A,O)}}),z=E.enc={},L=z.Hex={stringify:function(O){for(var A=O.words,y=O.sigBytes,B=[],U=0;U<y;U++){var P=A[U>>>2]>>>24-U%4*8&255;B.push((P>>>4).toString(16)),B.push((P&15).toString(16))}return B.join("")},parse:function(O){for(var A=O.length,y=[],B=0;B<A;B+=2)y[B>>>3]|=parseInt(O.substr(B,2),16)<<24-B%8*4;return new D.init(y,A/2)}},N=z.Latin1={stringify:function(O){for(var A=O.words,y=O.sigBytes,B=[],U=0;U<y;U++){var P=A[U>>>2]>>>24-U%4*8&255;B.push(String.fromCharCode(P))}return B.join("")},parse:function(O){for(var A=O.length,y=[],B=0;B<A;B++)y[B>>>2]|=(O.charCodeAt(B)&255)<<24-B%4*8;return new D.init(y,A)}},M=z.Utf8={stringify:function(O){try{return decodeURIComponent(escape(N.stringify(O)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(O){return N.parse(unescape(encodeURIComponent(O)))}},G=R.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new D.init,this._nDataBytes=0},_append:function(O){typeof O=="string"&&(O=M.parse(O)),this._data.concat(O),this._nDataBytes+=O.sigBytes},_process:function(O){var A,y=this._data,B=y.words,U=y.sigBytes,P=this.blockSize,Y=P*4,K=U/Y;O?K=d.ceil(K):K=d.max((K|0)-this._minBufferSize,0);var Q=K*P,V=d.min(Q*4,U);if(Q){for(var j=0;j<Q;j+=P)this._doProcessBlock(B,j);A=B.splice(0,Q),y.sigBytes-=V}return new D.init(A,V)},clone:function(){var O=v.clone.call(this);return O._data=this._data.clone(),O},_minBufferSize:0});R.Hasher=G.extend({cfg:v.extend(),init:function(O){this.cfg=this.cfg.extend(O),this.reset()},reset:function(){G.reset.call(this),this._doReset()},update:function(O){return this._append(O),this._process(),this},finalize:function(O){O&&this._append(O);var A=this._doFinalize();return A},blockSize:16,_createHelper:function(O){return function(A,y){return new O.init(y).finalize(A)}},_createHmacHelper:function(O){return function(A,y){return new w.HMAC.init(O,y).finalize(A)}}});var w=E.algo={};return E})(Math);return f})}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(3));function m(E,R,v){try{R.apply(E,v)}catch(D){d.default.logAction(d.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+D+"; stack = "+(D&&D.stack))}}function _(E,R,v){for(var D,z,L,N=0;N<E.length;N++)if(D=E[N],v&&(D=D[v]),f.isArray(D)){for(;(z=f.arrIndexOf(D,R))!==-1;)D.splice(z,1);v&&D.length===0&&delete E[N][v]}else if(f.isObject(D))for(L in D)Object.prototype.hasOwnProperty.call(D,L)&&f.isArray(D[L])&&_([D],R,L)}var C=(function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var R=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];if(v.length===1){var z=v[0];if(typeof z=="function")this.any.push(z);else throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v))}if(v.length===2){var L=v[0],N=v[1];if(typeof N!="function")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));if(f.isEmptyArg(L))this.any.push(N);else if(f.isArray(L))L.forEach(function(G){R.on(G,N)});else{if(typeof L!="string")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));var M=this.events[L]||(this.events[L]=[]);M.push(N)}}},E.prototype.off=function(){for(var R,v=this,D=[],z=0;z<arguments.length;z++)D[z]=arguments[z];if(D.length==0||f.isEmptyArg(D[0])&&f.isEmptyArg(D[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var L=D[0],N=D[1],M=null,G=null;if(D.length===1||!N)typeof L=="function"?M=L:G=L;else{if(typeof N!="function")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));R=[L,N],G=R[0],M=R[1]}if(M&&f.isEmptyArg(G)){_([this.any,this.events,this.anyOnce,this.eventsOnce],M);return}if(f.isArray(G)){G.forEach(function(w){v.off(w,M)});return}if(typeof G!="string")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));M?_([this.events,this.eventsOnce],M,G):(delete this.events[G],delete this.eventsOnce[G])},E.prototype.listeners=function(R){if(R){var v=this.events[R]||[];return this.eventsOnce[R]&&Array.prototype.push.apply(v,this.eventsOnce[R]),v.length?v:null}return this.any.length?this.any:null},E.prototype.emit=function(R){for(var v=[],D=1;D<arguments.length;D++)v[D-1]=arguments[D];var z={event:R},L=[];this.anyOnce.length&&(Array.prototype.push.apply(L,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(L,this.any);var N=this.eventsOnce[R];N&&(Array.prototype.push.apply(L,N),delete this.eventsOnce[R]);var M=this.events[R];M&&Array.prototype.push.apply(L,M),f.arrForEach(L,function(G){m(z,G,v)})},E.prototype.once=function(){for(var R=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];var z=v.length;if((z===0||z===1&&typeof v[0]!="function")&&g.default.Config.Promise){var L=v[0];return new g.default.Config.Promise(function(A){R.once(L,A)})}var N=v[0],M=v[1];if(v.length===1&&typeof N=="function")this.anyOnce.push(N);else if(f.isEmptyArg(N)){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));this.anyOnce.push(M)}else if(f.isArray(N)){var G=this,w=function(){var A=Array.prototype.slice.call(arguments);if(f.arrForEach(N,function(y){G.off(y,w)}),typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));M.apply(this,A)};f.arrForEach(N,function(A){G.on(A,w)})}else{if(typeof N!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));var O=this.eventsOnce[N]||(this.eventsOnce[N]=[]);if(M){if(typeof M!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));O.push(M)}}},E.prototype.whenState=function(R,v,D){for(var z=this,L=[],N=3;N<arguments.length;N++)L[N-3]=arguments[N];var M={event:R};if(typeof R!="string"||typeof v!="string")throw"whenState requires a valid event String argument";if(typeof D!="function"&&g.default.Config.Promise)return new g.default.Config.Promise(function(G){E.prototype.whenState.apply(z,[R,v,G].concat(L))});R===v?m(M,D,L):this.once(R,D)},E})();i.default=C}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.getDefaults=i.normaliseOptions=i.objectifyOptions=i.getAgentString=i.getHosts=i.getFallbackHosts=i.environmentFallbackHosts=i.getHttpScheme=i.getPort=i.getHost=void 0;var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(4)),_=r(43),C="ably-js/"+_.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:_.version,protocolVersion:2,agent:C,getHost:R,getPort:v,getHttpScheme:D,environmentFallbackHosts:z,getFallbackHosts:L,getHosts:N,checkHost:M,objectifyOptions:A,normaliseOptions:y};function R(U,P,Y){return Y?P=P==U.restHost&&U.realtimeHost||P||U.realtimeHost:P=P||U.restHost,P}i.getHost=R;function v(U,P){return P||U.tls?U.tlsPort:U.port}i.getPort=v;function D(U){return U.tls?"https://":"http://"}i.getHttpScheme=D;function z(U){return[U+"-a-fallback.ably-realtime.com",U+"-b-fallback.ably-realtime.com",U+"-c-fallback.ably-realtime.com",U+"-d-fallback.ably-realtime.com",U+"-e-fallback.ably-realtime.com"]}i.environmentFallbackHosts=z;function L(U){var P=U.fallbackHosts,Y=typeof U.httpMaxRetryCount<"u"?U.httpMaxRetryCount:E.httpMaxRetryCount;return P?d.arrChooseN(P,Y):[]}i.getFallbackHosts=L;function N(U){return[U.restHost].concat(L(U))}i.getHosts=N;function M(U){if(typeof U!="string")throw new m.default("host must be a string; was a "+typeof U,4e4,400);if(!U.length)throw new m.default("host must not be zero-length",4e4,400)}function G(U,P,Y){return U.realtimeHost?U.realtimeHost:U.restHost?(g.default.logAction(g.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+U.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+U.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),U.restHost):P?E.REALTIME_HOST:Y+"-"+E.REALTIME_HOST}function w(U){var P={};for(var Y in E.TIMEOUTS)P[Y]=U[Y]||E.TIMEOUTS[Y];return P}function O(U){var P=E.agent;if(U.agents)for(var Y in U.agents)P+=" "+Y+"/"+U.agents[Y];return P}i.getAgentString=O;function A(U){return typeof U=="string"?U.indexOf(":")==-1?{token:U}:{key:U}:U}i.objectifyOptions=A;function y(U){if(U.host&&(g.default.renamedClientOption("host","restHost"),U.restHost=U.host),U.wsHost&&(g.default.renamedClientOption("wsHost","realtimeHost"),U.realtimeHost=U.wsHost),U.queueEvents&&(g.default.renamedClientOption("queueEvents","queueMessages"),U.queueMessages=U.queueEvents),U.headers&&g.default.deprecated("the `headers` client option",""),U.fallbackHostsUseDefault){if(U.fallbackHosts){var P="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}if(U.port||U.tlsPort){var P="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}U.environment?g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),U.fallbackHosts=E.FALLBACK_HOSTS}U.recover===!0&&(g.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),U.recover=function(it,q){q(!0)}),typeof U.recover=="function"&&U.closeOnUnload===!0&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),U.recover=void 0),"closeOnUnload"in U||(U.closeOnUnload=!U.recover),U.transports&&d.arrIn(U.transports,"xhr")&&(g.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),d.arrDeleteValue(U.transports,"xhr"),U.transports.push("xhr_streaming")),"queueMessages"in U||(U.queueMessages=!0);var Y=U.environment&&String(U.environment).toLowerCase()||E.ENVIRONMENT,K=!Y||Y==="production";!U.fallbackHosts&&!U.restHost&&!U.realtimeHost&&!U.port&&!U.tlsPort&&(U.fallbackHosts=K?E.FALLBACK_HOSTS:z(Y));var Q=U.restHost||(K?E.REST_HOST:Y+"-"+E.REST_HOST),V=G(U,K,Y);d.arrForEach((U.fallbackHosts||[]).concat(Q,V),M),U.port=U.port||E.PORT,U.tlsPort=U.tlsPort||E.TLS_PORT,"tls"in U||(U.tls=!0);var j=w(U);if("useBinaryProtocol"in U?U.useBinaryProtocol=f.default.Config.supportsBinary&&U.useBinaryProtocol:U.useBinaryProtocol=f.default.Config.preferBinary,U.clientId){var I=U.headers=U.headers||{};I["X-Ably-ClientId"]=f.default.BufferUtils.base64Encode(f.default.BufferUtils.utf8Encode(U.clientId))}"idempotentRestPublishing"in U||(U.idempotentRestPublishing=!0),U.promises&&!f.default.Config.Promise&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),U.promises=!1);var X=null,W=U.connectivityCheckUrl;if(U.connectivityCheckUrl){var at=U.connectivityCheckUrl.split("?"),J=at[0],rt=at[1];X=rt?d.parseQueryString(rt):{},J.indexOf("://")===-1&&(J="https://"+J),W=J}return l.__assign(l.__assign({},U),{useBinaryProtocol:"useBinaryProtocol"in U?f.default.Config.supportsBinary&&U.useBinaryProtocol:f.default.Config.preferBinary,realtimeHost:V,restHost:Q,maxMessageSize:U.maxMessageSize||E.maxMessageSize,timeouts:j,connectivityCheckParams:X,connectivityCheckUrl:W})}i.normaliseOptions=y,i.default=E;function B(U){return Object.assign(E,U)}i.getDefaults=B}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importDefault(r(2)),g=l.__importDefault(r(4)),m=l.__importStar(r(1));function _(v){return!v||!v.channelOptions?{channelOptions:v,plugins:{},baseEncodedPreviousPayload:void 0}:v}function C(v){if(v&&v.cipher){if(!f.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var D=f.default.Crypto.getCipher(v.cipher);return{cipher:D.cipherParams,channelCipher:D.cipher}}return v??{}}function E(v){var D=0;return v.name&&(D+=v.name.length),v.clientId&&(D+=v.clientId.length),v.extras&&(D+=JSON.stringify(v.extras).length),v.data&&(D+=m.dataSizeBytes(v.data)),D}var R=(function(){function v(){}return v.prototype.toJSON=function(){var D=this.encoding,z=this.data;return z&&f.default.BufferUtils.isBuffer(z)&&(arguments.length>0?(D=D?D+"/base64":"base64",z=f.default.BufferUtils.base64Encode(z)):z=f.default.BufferUtils.toBuffer(z)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:D,data:z}},v.prototype.toString=function(){var D="[Message";return this.name&&(D+="; name="+this.name),this.id&&(D+="; id="+this.id),this.timestamp&&(D+="; timestamp="+this.timestamp),this.clientId&&(D+="; clientId="+this.clientId),this.connectionId&&(D+="; connectionId="+this.connectionId),this.encoding&&(D+="; encoding="+this.encoding),this.extras&&(D+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?D+="; data="+this.data:f.default.BufferUtils.isBuffer(this.data)?D+="; data (buffer)="+f.default.BufferUtils.base64Encode(this.data):D+="; data (json)="+JSON.stringify(this.data)),this.extras&&(D+="; extras="+JSON.stringify(this.extras)),D+="]",D},v.encrypt=function(D,z,L){var N=D.data,M=D.encoding,G=z.channelCipher;M=M?M+"/":"",f.default.BufferUtils.isBuffer(N)||(N=f.default.BufferUtils.utf8Encode(String(N)),M=M+"utf-8/"),G.encrypt(N,function(w,O){if(w){L(w);return}D.data=O,D.encoding=M+"cipher+"+G.algorithm,L(null,D)})},v.encode=function(D,z,L){var N=D.data,M=typeof N=="string"||f.default.BufferUtils.isBuffer(N)||N===null||N===void 0;if(!M)if(m.isObject(N)||m.isArray(N))D.data=JSON.stringify(N),D.encoding=D.encoding?D.encoding+"/json":"json";else throw new g.default("Data type is unsupported",40013,400);z!=null&&z.cipher?v.encrypt(D,z,L):L(null,D)},v.encodeArray=function(D,z,L){for(var N=0,M=0;M<D.length;M++)v.encode(D[M],z,function(G){if(G){L(G);return}N++,N==D.length&&L(null,D)})},v.decode=function(D,z){var L=_(z),N=D.data,M=D.encoding;if(M){var G=M.split("/"),w=void 0,O=G.length,A=D.data,y="";try{for(;(w=O)>0;){var B=G[--O].match(/([-\w]+)(\+([\w-]+))?/);if(!B)break;switch(y=B[1],y){case"base64":A=f.default.BufferUtils.base64Decode(String(A)),w==G.length&&(N=A);continue;case"utf-8":A=f.default.BufferUtils.utf8Decode(A);continue;case"json":A=JSON.parse(A);continue;case"cipher":if(L.channelOptions!=null&&L.channelOptions.cipher&&L.channelOptions.channelCipher){var U=B[3],P=L.channelOptions.channelCipher;if(U!=P.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");A=P.decrypt(A);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!L.plugins||!L.plugins.vcdiff)throw new g.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new g.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var Y=L.baseEncodedPreviousPayload;typeof Y=="string"&&(Y=f.default.BufferUtils.utf8Encode(Y)),Y=f.default.BufferUtils.toBuffer(Y),A=f.default.BufferUtils.toBuffer(A),A=f.default.BufferUtils.typedArrayToBuffer(L.plugins.vcdiff.decode(A,Y)),N=A}catch(Q){throw new g.default("Vcdiff delta decode failed with "+Q,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(Q){var K=Q;throw new g.default("Error processing the "+y+" encoding, decoder returned ‘"+K.message+"’",K.code||40013,400)}finally{D.encoding=w<=0?null:G.slice(0,w).join("/"),D.data=A}}L.baseEncodedPreviousPayload=N},v.fromResponseBody=function(D,z,L){L&&(D=m.decodeBody(D,L));for(var N=0;N<D.length;N++){var M=D[N]=v.fromValues(D[N]);try{v.decode(M,z)}catch(G){d.default.logAction(d.default.LOG_ERROR,"Message.fromResponseBody()",G.toString())}}return D},v.fromValues=function(D){return Object.assign(new v,D)},v.fromValuesArray=function(D){for(var z=D.length,L=new Array(z),N=0;N<z;N++)L[N]=v.fromValues(D[N]);return L},v.fromEncoded=function(D,z){var L=v.fromValues(D),N=C(z??null);try{v.decode(L,N)}catch(M){d.default.logAction(d.default.LOG_ERROR,"Message.fromEncoded()",M.toString())}return L},v.fromEncodedArray=function(D,z){return D.map(function(L){return v.fromEncoded(L,z)})},v.getMessagesSize=function(D){for(var z,L=0,N=0;N<D.length;N++)z=D[N],L+=z.size||(z.size=E(z));return L},v.serialize=m.encodeBody,v})();i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(4)),g=l.__importDefault(r(9)),m=l.__importDefault(r(16)),_={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(_).forEach(function(L){C[_[L]]=L});var E={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},R=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function v(L){var N=[];if(L)for(var M=0;M<L.length;M++)N.push(L[M].toString());return"[ "+N.join(", ")+" ]"}var D="id channel channelSerial connectionId count msgSerial timestamp".split(" "),z=(function(){function L(){var N=this;this.hasFlag=function(M){return(N.flags&E[M])>0}}return L.prototype.setFlag=function(N){return this.flags=this.flags|E[N]},L.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},L.prototype.encodeModesToFlags=function(N){var M=this;N.forEach(function(G){return M.setFlag(G)})},L.prototype.decodeModesFromFlags=function(){var N=this,M=[];return L.channelModes.forEach(function(G){N.hasFlag(G)&&M.push(G)}),M.length>0?M:void 0},L.fromValues=function(N){return Object.assign(new L,N)},L.Action=_,L.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],L.ActionName=C,L.serialize=f.encodeBody,L.deserialize=function(N,M){var G=f.decodeBody(N,M);return L.fromDeserialized(G)},L.fromDeserialized=function(N){var M=N.error;M&&(N.error=d.default.fromValues(M));var G=N.messages;if(G)for(var w=0;w<G.length;w++)G[w]=g.default.fromValues(G[w]);var O=N.presence;if(O)for(var w=0;w<O.length;w++)O[w]=m.default.fromValues(O[w],!0);return Object.assign(new L,N)},L.stringify=function(N){var M="[ProtocolMessage";N.action!==void 0&&(M+="; action="+L.ActionName[N.action]||!1);for(var G,w=0;w<D.length;w++)G=D[w],N[G]!==void 0&&(M+="; "+G+"="+N[G]);if(N.messages&&(M+="; messages="+v(g.default.fromValuesArray(N.messages))),N.presence&&(M+="; presence="+v(m.default.fromValuesArray(N.presence))),N.error&&(M+="; error="+d.default.fromValues(N.error).toString()),N.auth&&N.auth.accessToken&&(M+="; token="+N.auth.accessToken),N.flags&&(M+="; flags="+R.filter(N.hasFlag).join(",")),N.params){var O="";f.forInOwnNonNullProperties(N.params,function(A){O.length>0&&(O+="; "),O+=A+"="+N.params[A]}),O.length>0&&(M+="; params=["+O+"]")}return M+="]",M},L})();i.default=z}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=f.enc;m.Base64={stringify:function(C){var E=C.words,R=C.sigBytes,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var D=[],z=0;z<R;z+=3)for(var L=E[z>>>2]>>>24-z%4*8&255,N=E[z+1>>>2]>>>24-(z+1)%4*8&255,M=E[z+2>>>2]>>>24-(z+2)%4*8&255,G=L<<16|N<<8|M,w=0;w<4&&z+w*.75<R;w++)D.push(v.charAt(G>>>6*(3-w)&63));var O=v.charAt(64);if(O)for(;D.length%4;)D.push(O);return D.join("")},parse:function(C){var E=C.length,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var D=0;D<R.length;D++)v[R.charCodeAt(D)]=D}var z=R.charAt(64);if(z){var L=C.indexOf(z);L!==-1&&(E=L)}return _(C,E,v)}};function _(C,E,R){for(var v=[],D=0,z=0;z<E;z++)if(z%4){var L=R[C.charCodeAt(z-1)]<<z%4*2,N=R[C.charCodeAt(z)]>>>6-z%4*2,M=L|N;v[D>>>2]|=M<<24-D%4*8,D++}return g.create(v,D)}})(),l.enc.Base64})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(10)),g=l.__importDefault(r(26)),m=l.__importDefault(r(2)),_=l.__importDefault(r(8)),C=l.__importDefault(r(21)),E=l.__importDefault(r(18)),R=l.__importDefault(r(4)),v=l.__importDefault(r(22)),D=l.__importDefault(r(3));function z(M){var G=[80015,80017,80030];return M.code?E.default.isTokenErr(M)?!1:f.arrIn(G,M.code)?!0:M.code>=4e4&&M.code<5e4:!1}function L(M){return z(M)?[d.default.fromValues({action:d.default.Action.ERROR,error:M})]:[d.default.fromValues({action:d.default.Action.DISCONNECTED,error:M})]}var N=(function(M){l.__extends(G,M);function G(w,O,A){var y=M.call(this,w,O,A,!0)||this;return y.onAuthUpdated=function(B){y.authParams={access_token:B.token}},y.stream="stream"in A?A.stream:!0,y.sendRequest=null,y.recvRequest=null,y.pendingCallback=null,y.pendingItems=null,y}return G.prototype.connect=function(){var w=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","starting"),g.default.prototype.connect.call(this);var O=this.params,A=O.options,y=_.default.getHost(A,O.host),B=_.default.getPort(A),U=A.tls?"https://":"http://";this.baseUri=U+y+":"+B+"/comet/";var P=this.baseUri+"connect";m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","uri: "+P),this.auth.getAuthParams(function(Y,K){if(Y){w.disconnect(Y);return}if(!w.isDisposed){w.authParams=K;var Q=w.params.getConnectParams(K);"stream"in Q&&(w.stream=Q.stream),m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+f.toQueryString(Q));var V=!1,j=w.recvRequest=w.createRequest(P,null,Q,null,w.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV);j.on("data",function(I){w.recvRequest&&(V||(V=!0,w.emit("preconnect")),w.onData(I))}),j.on("complete",function(I){if(w.recvRequest||(I=I||new R.default("Request cancelled",80003,400)),w.recvRequest=null,!V&&!I&&(V=!0,w.emit("preconnect")),w.onActivity(),I){I.code?w.onData(L(I)):w.disconnect(I);return}D.default.Config.nextTick(function(){w.recv()})}),j.exec()}})},G.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},G.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},G.prototype._requestCloseOrDisconnect=function(w){var O=this,A=w?this.closeUri:this.disconnectUri;if(A){var y=this.createRequest(A,null,this.authParams,null,v.default.REQ_SEND);y.on("complete",function(B){B&&(m.default.logAction(m.default.LOG_ERROR,"CometTransport.request"+(w?"Close()":"Disconnect()"),"request returned err = "+f.inspectError(B)),O.finish("disconnected",B))}),y.exec()}},G.prototype.dispose=function(){var w=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),D.default.Config.nextTick(function(){w.emit("disposed")}))},G.prototype.onConnect=function(w){var O;if(!this.isDisposed){var A=(O=w.connectionDetails)===null||O===void 0?void 0:O.connectionKey;g.default.prototype.onConnect.call(this,w);var y=this.baseUri+A;m.default.logAction(m.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+y),this.sendUri=y+"/send",this.recvUri=y+"/recv",this.closeUri=y+"/close",this.disconnectUri=y+"/disconnect"}},G.prototype.send=function(w){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(w);return}var O=this.pendingItems||[];O.push(w),this.pendingItems=null,this.sendItems(O)},G.prototype.sendAnyPending=function(){var w=this.pendingItems;w&&(this.pendingItems=null,this.sendItems(w))},G.prototype.sendItems=function(w){var O=this,A=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(w),v.default.REQ_SEND);A.on("complete",function(y,B){if(y&&m.default.logAction(m.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+f.inspectError(y)),O.sendRequest=null,y){y.code?O.onData(L(y)):O.disconnect(y);return}B&&O.onData(B),O.pendingItems&&D.default.Config.nextTick(function(){O.sendRequest||O.sendAnyPending()})}),A.exec()},G.prototype.recv=function(){var w=this;if(!this.recvRequest&&this.isConnected){var O=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV_POLL);O.on("data",function(A){w.onData(A)}),O.on("complete",function(A){if(w.recvRequest=null,w.onActivity(),A){A.code?w.onData(L(A)):w.disconnect(A);return}D.default.Config.nextTick(function(){w.recv()})}),O.exec()}},G.prototype.onData=function(w){try{var O=this.decodeResponse(w);if(O&&O.length)for(var A=0;A<O.length;A++)this.onProtocolMessage(d.default.fromDeserialized(O[A]))}catch(y){m.default.logAction(m.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+y.stack)}},G.prototype.encodeRequest=function(w){return JSON.stringify(w)},G.prototype.decodeResponse=function(w){return typeof w=="string"?JSON.parse(w):w},G})(g.default);i.default=N}),(function(n,i){var r;r=(function(){return this})();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.isSuccessCode=void 0;var l;(function(d){d[d.Success=200]="Success",d[d.NoContent=204]="NoContent",d[d.BadRequest=400]="BadRequest",d[d.Unauthorized=401]="Unauthorized",d[d.Forbidden=403]="Forbidden",d[d.RequestTimeout=408]="RequestTimeout",d[d.InternalServerError=500]="InternalServerError"})(l||(l={}));function f(d){return d>=l.Success&&d<l.BadRequest}i.isSuccessCode=f,i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(18)),_=l.__importDefault(r(19)),C=r(4),E=l.__importDefault(r(14));function R(M,G,w,O,A){M.http.supportsAuthHeaders?M.auth.getAuthHeaders(function(y,B){y?O(y):A(d.mixin(B,G),w)}):M.auth.getAuthParams(function(y,B){y?O(y):A(G,d.mixin(B,w))})}function v(M,G){return function(w,O,A,y,B){if(w&&!O){M(w);return}if(B===E.default.NoContent){M(w,[],A,!0,B);return}if(!y)try{O=d.decodeBody(O,G)}catch(V){d.isErrorInfoOrPartialErrorInfo(V)?M(V):M(new C.PartialErrorInfo(d.inspectError(V),null));return}if(!O){M(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var U=O,P=U.statusCode,Y=U.response,K=U.headers;if(P===void 0){M(w,O,A,!0,B);return}if(P<200||P>=300){var Q=Y&&Y.error||w;Q||(Q=new Error("Error in unenveloping "+O),Q.statusCode=P),M(Q,Y,K,!0,P);return}M(w,Y,K,!0,P)}}function D(M){var G=[];if(M)for(var w in M)G.push(w+"="+M[w]);return G.join("&")}function z(M,G){return M+(G?"?":"")+D(G)}function L(M,G,w,O){return function(A,y,B,U,P){A?g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received Error; "+z(w,O)+"; Error: "+d.inspectError(A)):g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received; "+z(w,O)+"; Headers: "+D(B)+"; StatusCode: "+P+"; Body: "+(f.default.BufferUtils.isBuffer(y)?y.toString():y)),M&&M(A,y,B,U,P)}}var N=(function(){function M(){}return M.get=function(G,w,O,A,y,B){M.do(_.default.Get,G,w,null,O,A,y,B)},M.delete=function(G,w,O,A,y,B){M.do(_.default.Delete,G,w,null,O,A,y,B)},M.post=function(G,w,O,A,y,B,U){M.do(_.default.Post,G,w,O,A,y,B,U)},M.patch=function(G,w,O,A,y,B,U){M.do(_.default.Patch,G,w,O,A,y,B,U)},M.put=function(G,w,O,A,y,B,U){M.do(_.default.Put,G,w,O,A,y,B,U)},M.do=function(G,w,O,A,y,B,U,P){g.default.shouldLog(g.default.LOG_MICRO)&&(P=L(P,G,O,B)),U&&(P=P&&v(P,U),(B=B||{}).envelope=U);function Y(K,Q){var V;if(g.default.shouldLog(g.default.LOG_MICRO)&&g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+z(O,Q)),g.default.shouldLog(g.default.LOG_MICRO)){var j=A;if(((V=K["content-type"])===null||V===void 0?void 0:V.indexOf("msgpack"))>0)try{j=f.default.Config.msgpack.decode(A)}catch(I){g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending MsgPack Decoding Error: "+d.inspectError(I))}g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+z(O,Q)+"; Body: "+j)}w.http.do(G,w,O,K,A,Q,function(I,X,W,at,J){if(I&&m.default.isTokenErr(I)){w.auth.authorize(null,null,function(rt){if(rt){P(rt);return}R(w,K,Q,P,Y)});return}P(I,X,W,at,J)})}R(w,y,B,P,Y)},M})();i.default=N}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=l.__importDefault(r(3)),g=l.__importDefault(r(9)),m=l.__importStar(r(1));function _(E){return C.Actions.indexOf(E)}var C=(function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var R=this.id.split(":");return{connectionId:R[0],msgSerial:parseInt(R[1],10),index:parseInt(R[2],10)}},E.prototype.toJSON=function(){var R=this.data,v=this.encoding;return R&&d.default.BufferUtils.isBuffer(R)&&(arguments.length>0?(v=v?v+"/base64":"base64",R=d.default.BufferUtils.base64Encode(R)):R=d.default.BufferUtils.toBuffer(R)),{id:this.id,clientId:this.clientId,action:_(this.action),data:R,encoding:v,extras:this.extras}},E.prototype.toString=function(){var R="[PresenceMessage";return R+="; action="+this.action,this.id&&(R+="; id="+this.id),this.timestamp&&(R+="; timestamp="+this.timestamp),this.clientId&&(R+="; clientId="+this.clientId),this.connectionId&&(R+="; connectionId="+this.connectionId),this.encoding&&(R+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?R+="; data="+this.data:d.default.BufferUtils.isBuffer(this.data)?R+="; data (buffer)="+d.default.BufferUtils.base64Encode(this.data):R+="; data (json)="+JSON.stringify(this.data)),this.extras&&(R+="; extras="+JSON.stringify(this.extras)),R+="]",R},E.fromResponseBody=function(R,v,D){var z=[];D&&(R=m.decodeBody(R,D));for(var L=0;L<R.length;L++){var N=z[L]=E.fromValues(R[L],!0);try{E.decode(N,v)}catch(M){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",M.toString())}}return z},E.fromValues=function(R,v){return v&&(R.action=E.Actions[R.action]),Object.assign(new E,R)},E.fromValuesArray=function(R){for(var v=R.length,D=new Array(v),z=0;z<v;z++)D[z]=E.fromValues(R[z]);return D},E.fromEncoded=function(R,v){var D=E.fromValues(R,!0);try{E.decode(D,v??{})}catch(z){f.default.logAction(f.default.LOG_ERROR,"PresenceMessage.fromEncoded()",z.toString())}return D},E.fromEncodedArray=function(R,v){return R.map(function(D){return E.fromEncoded(D,v)})},E.fromData=function(R){return R instanceof E?R:E.fromValues({data:R})},E.Actions=["absent","present","enter","leave","update"],E.encode=g.default.encode,E.decode=g.default.decode,E.getMessagesSize=g.default.getMessagesSize,E})();i.default=C}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),d=f.__importStar(r(1)),g=f.__importDefault(r(7)),m=f.__importStar(r(4)),_=f.__importDefault(r(2)),C=f.__importDefault(r(8)),E=f.__importDefault(r(22)),R=f.__importDefault(r(3));function v(U,P){return d.arrIn(d.allToLowerCase(d.keysArray(P)),"x-ably-errorcode")}function D(U,P){if(v(U,P))return U.error&&m.default.fromValues(U.error)}var z=function(){},L=0,N={},M=typeof l<"u"&&l.XDomainRequest;function G(){var U=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return U&&Number(U[1])}function w(){var U;return M&&(U=G())&&U===10}function O(U,P){return U.getResponseHeader&&U.getResponseHeader(P)}function A(U){return U.getResponseHeader&&(U.getResponseHeader("transfer-encoding")||!U.getResponseHeader("content-length"))}function y(U){for(var P=d.trim(U.getAllResponseHeaders()).split(`\r
`),Y={},K=0;K<P.length;K++){var Q=P[K].split(":").map(d.trim);Y[Q[0].toLowerCase()]=Q[1]}return Y}var B=(function(U){f.__extends(P,U);function P(Y,K,Q,V,j,I,X){var W=U.call(this)||this;return Q=Q||{},Q.rnd=d.cheapRandStr(),w()&&!Q.envelope&&(Q.envelope="json"),W.uri=Y+d.toQueryString(Q),W.headers=K||{},W.body=V,W.method=X?X.toUpperCase():d.isEmptyArg(V)?"GET":"POST",W.requestMode=j,W.timeouts=I,W.timedOut=!1,W.requestComplete=!1,W.id=String(++L),N[W.id]=W,W}return P.createRequest=function(Y,K,Q,V,j,I,X){var W=I||C.default.TIMEOUTS;return new P(Y,K,d.copy(Q),V,j,W,X)},P.prototype.complete=function(Y,K,Q,V,j){this.requestComplete||(this.requestComplete=!0,!Y&&K&&this.emit("data",K),this.emit("complete",Y,K,Q,V,j),this.dispose())},P.prototype.abort=function(){this.dispose()},P.prototype.exec=function(){var Y=this,K=this.headers,Q=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,V=this.timer=setTimeout(function(){Y.timedOut=!0,I.abort()},Q),j=this.method,I=this.xhr=new XMLHttpRequest,X=K.accept,W=this.body,at="text";if(X?X.indexOf("application/x-msgpack")===0&&(at="arraybuffer"):K.accept="application/json",W){var J=K["content-type"]||(K["content-type"]="application/json");J.indexOf("application/json")>-1&&typeof W!="string"&&(W=JSON.stringify(W))}I.open(j,this.uri,!0),I.responseType=at,"authorization"in K&&(I.withCredentials=!0);for(var rt in K)I.setRequestHeader(rt,K[rt]);var it=function(Gt,be,Re,tn){var Rt,Kt=be+" (event type: "+Gt.type+")";!((Rt=Y==null?void 0:Y.xhr)===null||Rt===void 0)&&Rt.statusText&&(Kt+=", current statusText is "+Y.xhr.statusText),_.default.logAction(_.default.LOG_ERROR,"Request.on"+Gt.type+"()",Kt),Y.complete(new m.PartialErrorInfo(Kt,Re,tn))};I.onerror=function(Gt){it(Gt,"XHR error occurred",null,400)},I.onabort=function(Gt){Y.timedOut?it(Gt,"Request aborted due to request timeout expiring",null,408):it(Gt,"Request cancelled",null,400)},I.ontimeout=function(Gt){it(Gt,"Request timed out",null,408)};var q,F,tt,nt=0,gt=!1,At=function(){if(clearTimeout(V),tt=F<400,F==204){Y.complete(null,null,null,null,F);return}q=Y.requestMode==E.default.REQ_RECV_STREAM&&tt&&A(I)},Bt=function(){var Gt;try{var be=O(I,"content-type"),Re=be?be.indexOf("application/json")>=0:I.responseType=="text";if(Re){var tn=I.responseType==="arraybuffer"?R.default.BufferUtils.utf8Decode(I.response):String(I.responseText);tn.length?Gt=JSON.parse(tn):Gt=tn,gt=!0}else Gt=I.response;Gt.response!==void 0?(F=Gt.statusCode,tt=F<400,K=Gt.headers,Gt=Gt.response):K=y(I)}catch(Kt){Y.complete(new m.PartialErrorInfo("Malformed response body from server: "+Kt.message,null,400));return}if(tt||d.isArray(Gt)){Y.complete(null,Gt,K,gt,F);return}var Rt=D(Gt,K);Rt||(Rt=new m.PartialErrorInfo("Error response received from server: "+F+" body was: "+R.default.Config.inspect(Gt),null,F)),Y.complete(Rt,Gt,K,gt,F)};function qt(){for(var Gt=I.responseText,be=Gt.length-1,Re,tn;nt<be&&(Re=Gt.indexOf(`
`,nt))>-1;)tn=Gt.slice(nt,Re),nt=Re+1,Jt(tn)}var Jt=function(Gt){try{Gt=JSON.parse(Gt)}catch(be){Y.complete(new m.PartialErrorInfo("Malformed response body from server: "+be.message,null,400));return}Y.emit("data",Gt)},ee=function(){qt(),Y.streamComplete=!0,R.default.Config.nextTick(function(){Y.complete()})};I.onreadystatechange=function(){var Gt=I.readyState;Gt<3||I.status!==0&&(F===void 0&&(F=I.status,F===1223&&(F=204),At()),Gt==3&&q?qt():Gt==4&&(q?ee():Bt()))},I.send(W)},P.prototype.dispose=function(){var Y=this.xhr;if(Y){Y.onreadystatechange=Y.onerror=Y.onabort=Y.ontimeout=z,this.xhr=null;var K=this.timer;K&&(clearTimeout(K),this.timer=null),this.requestComplete||Y.abort()}delete N[this.id]},P})(g.default);i.default=B}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=l.__importStar(r(1)),g=l.__importDefault(r(24)),m=l.__importDefault(r(4)),_=l.__importDefault(r(45)),C=r(11),E=l.__importDefault(r(19)),R=l.__importDefault(r(14)),v=l.__importDefault(r(3)),D=l.__importDefault(r(15)),z=Math.pow(2,17);function L(){}function N(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function M(Q){return!!Q.connection}function G(Q){return d.isErrorInfoOrPartialErrorInfo(Q)?(Q.code||(Q.statusCode===403?Q.code=40300:(Q.code=40170,Q.statusCode=401)),Q):new m.default(d.inspectError(Q),Q.code||40170,Q.statusCode||401)}var w=function(Q,V){if(v.default.Config.createHmac){var j=v.default.Config.createHmac("SHA256",V);return j.update(Q),j.digest("base64")}return(0,C.stringify)((0,_.default)(Q,V))};function O(Q){if(!Q)return"";typeof Q=="string"&&(Q=JSON.parse(Q));var V=Object.create(null),j=d.keysArray(Q,!0);if(!j)return"";j.sort();for(var I=0;I<j.length;I++)V[j[I]]=Q[j[I]].sort();return JSON.stringify(V)}function A(Q){if(Q.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(Q.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(Q.key)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(Q.tokenDetails)f.default.logAction(f.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var V="authOptions must include valid authentication parameters";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",V),new Error(V)}}function y(Q){return"useTokenAuth"in Q&&!Q.useTokenAuth}function B(Q){return Q.useTokenAuth||!y(Q)&&(Q.authCallback||Q.authUrl||Q.token||Q.tokenDetails)}function U(Q){return!Q.key&&!Q.authCallback&&!Q.authUrl}var P=0;function Y(){return P++}var K=(function(){function Q(V,j){if(this.authOptions={},this.client=V,this.tokenParams=j.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,B(j)){if(j.key&&!w){var I="client-side token request signing not supported";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new Error(I)}U(j)&&f.default.logAction(f.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(j.defaultTokenParams,j),A(this.authOptions)}else{if(!j.key){var I="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw f.default.logAction(f.default.LOG_ERROR,"Auth()",I),new m.default(I,40160,401)}f.default.logAction(f.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(j)}}return Q.prototype.authorize=function(V,j,I){var X=this,W;if(typeof V=="function"&&!I?(I=V,W=V=null):typeof j=="function"&&!I?(I=j,W=null):W=j,!I&&this.client.options.promises)return d.promisify(this,"authorize",arguments);if(W&&W.key&&this.authOptions.key!==W.key)throw new m.default("Unable to update auth options with incompatible key",40102,401);W&&"force"in W&&(f.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),d.isOnlyPropIn(W,"force")&&(W=null)),this._forceNewToken(V,W,function(at,J){if(at){X.client.connection&&at.statusCode===R.default.Forbidden&&X.client.connection.connectionManager.actOnErrorFromAuthorize(at),I==null||I(at);return}M(X.client)?X.client.connection.connectionManager.onAuthUpdated(J,I||L):I==null||I(null,J)})},Q.prototype.authorise=function(V,j,I){f.default.renamedMethod("Auth","authorise","authorize"),this.authorize(V,j,I)},Q.prototype._forceNewToken=function(V,j,I){var X=this;this.tokenDetails=null,this._saveTokenOptions(V,j),A(this.authOptions),this._ensureValidAuthCredentials(!0,function(W,at){delete X.tokenParams.timestamp,delete X.authOptions.queryTime,I(W,at)})},Q.prototype.requestToken=function(V,j,I){var X=this;if(typeof V=="function"&&!I?(I=V,j=V=null):typeof j=="function"&&!I&&(I=j,j=null),!I&&this.client.options.promises)return d.promisify(this,"requestToken",arguments);j=j||this.authOptions,V=V||d.copy(this.tokenParams);var W=I||L,at,J=this.client;if(j.authCallback)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),at=j.authCallback;else if(j.authUrl)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),at=function(nt,gt){var At=d.mixin({accept:"application/json, text/plain"},j.authHeaders),Bt=j.authMethod&&j.authMethod.toLowerCase()==="post",qt,Jt=j.authUrl.indexOf("?");Jt>-1&&(qt=d.parseQueryString(j.authUrl.slice(Jt)),j.authUrl=j.authUrl.slice(0,Jt),Bt||(j.authParams=d.mixin(qt,j.authParams)));var ee=d.mixin({},j.authParams||{},nt),Gt=function(tn,Rt,Kt,Be){var te;if(tn?f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+d.inspectError(tn)):(te=Kt["content-type"],f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+te+"; body: "+d.inspectBody(Rt))),tn||Be)return gt(tn,Rt);if(v.default.BufferUtils.isBuffer(Rt)&&(Rt=Rt.toString()),!te){gt(new m.default("authUrl response is missing a content-type header",40170,401));return}var ae=te.indexOf("application/json")>-1,qe=te.indexOf("text/plain")>-1||te.indexOf("application/jwt")>-1;if(!ae&&!qe){gt(new m.default("authUrl responded with unacceptable content-type "+te+", should be either text/plain, application/jwt or application/json",40170,401));return}if(ae){if(Rt.length>z){gt(new m.default("authUrl response exceeded max permitted length",40170,401));return}try{Rt=JSON.parse(Rt)}catch(xe){gt(new m.default("Unexpected error processing authURL response; err = "+xe.message,40170,401));return}}gt(null,Rt,te)};if(f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+j.authUrl+"; Params: "+JSON.stringify(ee)+"; method: "+(Bt?"POST":"GET")),Bt){var be=At||{};be["content-type"]="application/x-www-form-urlencoded";var Re=d.toQueryString(ee).slice(1);X.client.http.doUri(E.default.Post,J,j.authUrl,be,Re,qt,Gt)}else X.client.http.doUri(E.default.Get,J,j.authUrl,At||{},null,ee,Gt)};else if(j.key)f.default.logAction(f.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),at=function(nt,gt){X.createTokenRequest(nt,j,gt)};else{var rt="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";f.default.logAction(f.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),W(new m.default(rt,40171,403));return}"capability"in V&&(V.capability=O(V.capability));var it=function(nt,gt){var At=nt.keyName,Bt="/keys/"+At+"/requestToken",qt=function(ee){return J.baseUri(ee)+Bt},Jt=d.defaultPostHeaders(X.client.options);j.requestHeaders&&d.mixin(Jt,j.requestHeaders),f.default.logAction(f.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+Bt+"; Token params: "+JSON.stringify(nt)),X.client.http.do(E.default.Post,J,qt,Jt,JSON.stringify(nt),null,gt)},q=!1,F=this.client.options.timeouts.realtimeRequestTimeout,tt=setTimeout(function(){q=!0;var nt="Token request callback timed out after "+F/1e3+" seconds";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",nt),W(new m.default(nt,40170,401))},F);at(V,function(nt,gt,At){if(!q){if(clearTimeout(tt),nt){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+d.inspectError(nt)),W(G(nt));return}if(typeof gt=="string"){gt.length===0?W(new m.default("Token string is empty",40170,401)):gt.length>z?W(new m.default("Token string exceeded max permitted length (was "+gt.length+" bytes)",40170,401)):gt==="undefined"||gt==="null"?W(new m.default("Token string was literal null/undefined",40170,401)):gt[0]==="{"&&!(At&&At.indexOf("application/jwt")>-1)?W(new m.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):W(null,{token:gt});return}if(typeof gt!="object"){var Bt="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof gt;f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",Bt),W(new m.default(Bt,40170,401));return}var qt=JSON.stringify(gt).length;if(qt>z&&!j.suppressMaxLengthCheck){W(new m.default("Token request/details object exceeded max permitted stringified size (was "+qt+" bytes)",40170,401));return}if("issued"in gt){W(null,gt);return}if(!("keyName"in gt)){var Bt="Expected token request callback to call back with a token string, token request object, or token details object";f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()",Bt),W(new m.default(Bt,40170,401));return}it(gt,function(Jt,ee,Gt,be){if(Jt){f.default.logAction(f.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+d.inspectError(Jt)),W(G(Jt));return}be||(ee=JSON.parse(ee)),f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","token received"),W(null,ee)})}})},Q.prototype.createTokenRequest=function(V,j,I){var X=this;if(typeof V=="function"&&!I?(I=V,j=V=null):typeof j=="function"&&!I&&(I=j,j=null),!I&&this.client.options.promises)return d.promisify(this,"createTokenRequest",arguments);j=j||this.authOptions,V=V||d.copy(this.tokenParams);var W=j.key;if(!W){I(new m.default("No key specified",40101,403));return}var at=W.split(":"),J=at[0],rt=at[1];if(!rt){I(new m.default("Invalid key specified",40101,403));return}if(V.clientId===""){I(new m.default("clientId can’t be an empty string",40012,400));return}"capability"in V&&(V.capability=O(V.capability));var it=d.mixin({keyName:J},V),q=V.clientId||"",F=V.ttl||"",tt=V.capability||"";(function(nt){if(it.timestamp){nt();return}X.getTimestamp(j&&j.queryTime,function(gt,At){if(gt){I(gt);return}it.timestamp=At,nt()})})(function(){var nt=it.nonce||(it.nonce=N()),gt=it.timestamp,At=it.keyName+`
`+F+`
`+tt+`
`+q+`
`+gt+`
`+nt+`
`;it.mac=it.mac||w(At,rt),f.default.logAction(f.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),I(null,it)})},Q.prototype.getAuthParams=function(V){this.method=="basic"?V(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(j,I){if(j){V(j);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{access_token:I.token})})},Q.prototype.getAuthHeaders=function(V){this.method=="basic"?V(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(j,I){if(j){V(j);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{authorization:"Bearer "+d.toBase64(I.token)})})},Q.prototype.getTimestamp=function(V,j){!this.isTimeOffsetSet()&&(V||this.authOptions.queryTime)?this.client.time(j):j(null,this.getTimestampUsingOffset())},Q.prototype.getTimestampUsingOffset=function(){return d.now()+(this.client.serverTimeOffset||0)},Q.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},Q.prototype._saveBasicOptions=function(V){this.method="basic",this.key=V.key,this.basicKey=d.toBase64(V.key),this.authOptions=V||{},"clientId"in V&&this._userSetClientId(V.clientId)},Q.prototype._saveTokenOptions=function(V,j){this.method="token",V&&(this.tokenParams=V),j&&(j.token&&(j.tokenDetails=typeof j.token=="string"?{token:j.token}:j.token),j.tokenDetails&&(this.tokenDetails=j.tokenDetails),"clientId"in j&&this._userSetClientId(j.clientId),this.authOptions=j)},Q.prototype._ensureValidAuthCredentials=function(V,j){var I=this,X=this.tokenDetails;if(X){if(this._tokenClientIdMismatch(X.clientId)){j(new m.default("Mismatch between clientId in token ("+X.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!X.expires||X.expires>=this.getTimestampUsingOffset()){f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+X.expires),j(null,X);return}f.default.logAction(f.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=g.default.create())).push(j),!(this.currentTokenRequestId!==null&&!V)){var W=this.currentTokenRequestId=Y();this.requestToken(this.tokenParams,this.authOptions,function(at,J){if(I.currentTokenRequestId>W){f.default.logAction(f.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}I.currentTokenRequestId=null;var rt=I.waitingForTokenRequest||L;if(I.waitingForTokenRequest=null,at){rt(at);return}rt(null,I.tokenDetails=J)})}},Q.prototype._userSetClientId=function(V){if(typeof V=="string"||V===null){if(V==="*")throw new m.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var j=this._uncheckedSetClientId(V);if(j)throw j}else throw new m.default("clientId must be either a string or null",40012,400)},Q.prototype._uncheckedSetClientId=function(V){if(this._tokenClientIdMismatch(V)){var j="Unexpected clientId mismatch: client has "+this.clientId+", requested "+V,I=new m.default(j,40102,401);return f.default.logAction(f.default.LOG_ERROR,"Auth._uncheckedSetClientId()",j),I}else return this.clientId=this.tokenParams.clientId=V,null},Q.prototype._tokenClientIdMismatch=function(V){return!!(this.clientId&&this.clientId!=="*"&&V&&V!=="*"&&this.clientId!==V)},Q.isTokenErr=function(V){return V.code&&V.code>=40140&&V.code<40150},Q.prototype.revokeTokens=function(V,j,I){if(B(this.client.options))throw new m.default("Cannot revoke tokens when using token auth",40162,401);var X=this.client.options.keyName,W;if(typeof j=="function"?(I=j,W={}):W=j??{},I===void 0){if(this.client.options.promises)return d.promisify(this,"revokeTokens",[V,W]);I=L}var at=I,J=l.__assign({targets:V.map(function(F){return"".concat(F.type,":").concat(F.value)})},W),rt=this.client.options.useBinaryProtocol?d.Format.msgpack:d.Format.json,it=d.defaultPostHeaders(this.client.options,rt);this.client.options.headers&&d.mixin(it,this.client.options.headers);var q=d.encodeBody(J,rt);D.default.post(this.client,"/keys/".concat(X,"/revokeTokens"),q,it,{newBatchResponse:"true"},null,function(F,tt,nt,gt){if(F){at(F);return}var At=gt?tt:d.decodeBody(tt,rt);at(null,At)})},Q})();i.default=K}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(f){f.Get="get",f.Delete="delete",f.Post="post",f.Put="put",f.Patch="patch"})(l||(l={})),i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.HttpPaginatedResponse=i.PaginatedResult=void 0;var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(15)),m=l.__importDefault(r(14));function _(z){var L=z.match(/^\.\/(\w+)\?(.*)$/);return L&&L[2]&&f.parseQueryString(L[2])}function C(z){typeof z=="string"&&(z=z.split(","));for(var L={},N=0;N<z.length;N++){var M=z[N].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(M){var G=_(M[1]);G&&(L[M[2]]=G)}}return L}function E(z,L,N){return!(N&&(L||typeof z.code=="number"))}var R=(function(){function z(L,N,M,G,w,O){this.rest=L,this.path=N,this.headers=M,this.envelope=G??null,this.bodyHandler=w,this.useHttpPaginatedResponse=O||!1}return z.prototype.get=function(L,N){var M=this;g.default.get(this.rest,this.path,this.headers,L,this.envelope,function(G,w,O,A,y){M.handlePage(G,w,O,A,y,N)})},z.prototype.delete=function(L,N){var M=this;g.default.delete(this.rest,this.path,this.headers,L,this.envelope,function(G,w,O,A,y){M.handlePage(G,w,O,A,y,N)})},z.prototype.post=function(L,N,M){var G=this;g.default.post(this.rest,this.path,N,this.headers,L,this.envelope,function(w,O,A,y,B){M&&G.handlePage(w,O,A,y,B,M)})},z.prototype.put=function(L,N,M){var G=this;g.default.put(this.rest,this.path,N,this.headers,L,this.envelope,function(w,O,A,y,B){M&&G.handlePage(w,O,A,y,B,M)})},z.prototype.patch=function(L,N,M){var G=this;g.default.patch(this.rest,this.path,N,this.headers,L,this.envelope,function(w,O,A,y,B){M&&G.handlePage(w,O,A,y,B,M)})},z.prototype.handlePage=function(L,N,M,G,w,O){if(L&&E(L,N,this.useHttpPaginatedResponse)){d.default.logAction(d.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+f.inspectError(L)),O==null||O(L);return}var A,y,B;try{A=w==m.default.NoContent?[]:this.bodyHandler(N,M||{},G)}catch(U){O==null||O(L||U);return}M&&(y=M.Link||M.link)&&(B=C(y)),this.useHttpPaginatedResponse?O(null,new D(this,A,M||{},w,B,L)):O(null,new v(this,A,B))},z})(),v=(function(){function z(L,N,M){var G=this;this.resource=L,this.items=N;var w=this;M&&("first"in M&&(this.first=function(O){if(!O&&w.resource.rest.options.promises)return f.promisify(w,"first",[]);w.get(M.first,O)}),"current"in M&&(this.current=function(O){if(!O&&w.resource.rest.options.promises)return f.promisify(w,"current",[]);w.get(M.current,O)}),this.next=function(O){if(!O&&w.resource.rest.options.promises)return f.promisify(w,"next",[]);"next"in M?w.get(M.next,O):O(null,null)},this.hasNext=function(){return"next"in M},this.isLast=function(){var O;return!(!((O=G.hasNext)===null||O===void 0)&&O.call(G))})}return z.prototype.get=function(L,N){var M=this.resource;g.default.get(M.rest,M.path,M.headers,L,M.envelope,function(G,w,O,A,y){M.handlePage(G,w,O,A,y,N)})},z})();i.PaginatedResult=v;var D=(function(z){l.__extends(L,z);function L(N,M,G,w,O,A){var y=z.call(this,N,M,O)||this;return y.statusCode=w,y.success=w<300&&w>=200,y.headers=G,y.errorCode=A&&A.code,y.errorMessage=A&&A.message,y}return L.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},L})(v);i.HttpPaginatedResponse=D,i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.isRetriable=void 0;var l=r(0),f=l.__importDefault(r(4)),d={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},g={disconnected:function(){return f.default.fromValues({statusCode:400,code:d.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return f.default.fromValues({statusCode:400,code:d.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return f.default.fromValues({statusCode:400,code:d.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return f.default.fromValues({statusCode:400,code:d.CLOSING,message:"Connection closing"})},closed:function(){return f.default.fromValues({statusCode:400,code:d.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return f.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return f.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function m(_){return!_.statusCode||!_.code||_.statusCode>=500?!0:Object.values(d).includes(_.code)}i.isRetriable=m,i.default=g}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(f){f[f.REQ_SEND=0]="REQ_SEND",f[f.REQ_RECV=1]="REQ_RECV",f[f.REQ_RECV_POLL=2]="REQ_RECV_POLL",f[f.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(l||(l={})),i.default=l}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(l){return l})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(2)),d=(function(){function g(m){this.members=m||[]}return g.prototype.call=function(){for(var m=[],_=0;_<arguments.length;_++)m[_]=arguments[_];for(var C=0,E=this.members;C<E.length;C++){var R=E[C];if(R)try{R.apply(void 0,m)}catch(v){f.default.logAction(f.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+v+"; stack = "+v.stack)}}},g.prototype.push=function(){for(var m,_=[],C=0;C<arguments.length;C++)_[C]=arguments[C];(m=this.members).push.apply(m,_)},g.create=function(m){var _=new g(m);return Object.assign(function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];return _.call.apply(_,C)},{push:function(C){return _.push(C)}})},g})();i.default=d}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){(function(){var f=l,d=f.lib,g=d.Base,m=f.enc,_=m.Utf8,C=f.algo;C.HMAC=g.extend({init:function(E,R){E=this._hasher=new E.init,typeof R=="string"&&(R=_.parse(R));var v=E.blockSize,D=v*4;R.sigBytes>D&&(R=E.finalize(R)),R.clamp();for(var z=this._oKey=R.clone(),L=this._iKey=R.clone(),N=z.words,M=L.words,G=0;G<v;G++)N[G]^=1549556828,M[G]^=909522486;z.sigBytes=L.sigBytes=D,this.reset()},reset:function(){var E=this._hasher;E.reset(),E.update(this._iKey)},update:function(E){return this._hasher.update(E),this},finalize:function(E){var R=this._hasher,v=R.finalize(E);R.reset();var D=R.finalize(this._oKey.clone().concat(v));return D}})})()})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(21)),C=l.__importDefault(r(4)),E=l.__importDefault(r(3)),R=f.default.Action,v=f.default.fromValues({action:R.CLOSE}),D=f.default.fromValues({action:R.DISCONNECT}),z=(function(L){l.__extends(N,L);function N(M,G,w,O){var A=L.call(this)||this;return O&&(w.format=void 0,w.heartbeats=!0),A.connectionManager=M,M.registerProposedTransport(A),A.auth=G,A.params=w,A.timeouts=w.options.timeouts,A.format=w.format,A.isConnected=!1,A.isFinished=!1,A.isDisposed=!1,A.maxIdleInterval=null,A.idleTimer=null,A.lastActivity=null,A}return N.prototype.connect=function(){},N.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",_.default.closed())},N.prototype.disconnect=function(M){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",M||_.default.disconnected())},N.prototype.fail=function(M){this.isConnected&&this.requestDisconnect(),this.finish("failed",M||_.default.failed())},N.prototype.finish=function(M,G){var w;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((w=this.idleTimer)!==null&&w!==void 0?w:void 0),this.idleTimer=null,this.emit(M,G),this.dispose())},N.prototype.onProtocolMessage=function(M){switch(m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+f.default.stringify(M)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),M.action){case R.HEARTBEAT:m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",M.id);break;case R.CONNECTED:this.onConnect(M),this.emit("connected",M.error,M.connectionId,M.connectionDetails,M);break;case R.CLOSED:this.onClose(M);break;case R.DISCONNECTED:this.onDisconnect(M);break;case R.ACK:this.emit("ack",M.msgSerial,M.count);break;case R.NACK:this.emit("nack",M.msgSerial,M.count,M.error);break;case R.SYNC:this.connectionManager.onChannelMessage(M,this);break;case R.ACTIVATE:break;case R.AUTH:this.auth.authorize(function(G){G&&m.default.logAction(m.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+d.inspectError(G))});break;case R.ERROR:if(m.default.logAction(m.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(M.error)+(M.channel?", channel: "+M.channel:"")),M.channel===void 0){this.onFatalError(M);break}this.connectionManager.onChannelMessage(M,this);break;default:this.connectionManager.onChannelMessage(M,this)}},N.prototype.onConnect=function(M){if(this.isConnected=!0,!M.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var G=M.connectionDetails.maxIdleInterval;G&&(this.maxIdleInterval=G+this.timeouts.realtimeRequestTimeout,this.onActivity())},N.prototype.onDisconnect=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onDisconnect()","err = "+d.inspectError(G)),this.finish("disconnected",G)},N.prototype.onFatalError=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onFatalError()","err = "+d.inspectError(G)),this.finish("failed",G)},N.prototype.onClose=function(M){var G=M&&M.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onClose()","err = "+d.inspectError(G)),this.finish("closed",G)},N.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestClose()",""),this.send(v)},N.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(D)},N.prototype.ping=function(M){var G={action:f.default.Action.HEARTBEAT};M&&(G.id=M),this.send(f.default.fromValues(G))},N.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},N.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=d.now(),this.setIdleTimer(this.maxIdleInterval+100))},N.prototype.setIdleTimer=function(M){var G=this;this.idleTimer||(this.idleTimer=setTimeout(function(){G.onIdleTimerExpire()},M))},N.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var M=d.now()-this.lastActivity,G=this.maxIdleInterval-M;if(G<=0){var w="No activity seen from realtime in "+M+"ms; assuming connection has dropped";m.default.logAction(m.default.LOG_ERROR,"Transport.onIdleTimerExpire()",w),this.disconnect(new C.default(w,80003,408))}else this.setIdleTimer(G+100)},N.tryConnect=function(M,G,w,O,A){var y=new M(G,w,O),B,U=function(Y){clearTimeout(B),A({event:this.event,error:Y})},P=G.options.timeouts.realtimeRequestTimeout;B=setTimeout(function(){y.off(["preconnect","disconnected","failed"]),y.dispose(),U.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},P),y.on(["failed","disconnected"],U),y.on("preconnect",function(){m.default.logAction(m.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+y),clearTimeout(B),y.off(["failed","disconnected"],U),A(null,y)}),y.connect()},N})(g.default);i.default=z}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(40),r(25))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.Base,m=d.WordArray,_=f.algo,C=_.MD5,E=_.EvpKDF=g.extend({cfg:g.extend({keySize:128/32,hasher:C,iterations:1}),init:function(R){this.cfg=this.cfg.extend(R)},compute:function(R,v){for(var D,z=this.cfg,L=z.hasher.create(),N=m.create(),M=N.words,G=z.keySize,w=z.iterations;M.length<G;){D&&L.update(D),D=L.update(R).finalize(v),L.reset();for(var O=1;O<w;O++)D=L.finalize(D),L.reset();N.concat(D)}return N.sigBytes=G*4,N}});f.EvpKDF=function(R,v,D){return E.create(D).compute(R,v)}})(),l.EvpKDF})}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(27))})(this,function(l){l.lib.Cipher||(function(f){var d=l,g=d.lib,m=g.Base,_=g.WordArray,C=g.BufferedBlockAlgorithm,E=d.enc;E.Utf8;var R=E.Base64,v=d.algo,D=v.EvpKDF,z=g.Cipher=C.extend({cfg:m.extend(),createEncryptor:function(K,Q){return this.create(this._ENC_XFORM_MODE,K,Q)},createDecryptor:function(K,Q){return this.create(this._DEC_XFORM_MODE,K,Q)},init:function(K,Q,V){this.cfg=this.cfg.extend(V),this._xformMode=K,this._key=Q,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(K){return this._append(K),this._process()},finalize:function(K){K&&this._append(K);var Q=this._doFinalize();return Q},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function K(Q){return typeof Q=="string"?Y:B}return function(Q){return{encrypt:function(V,j,I){return K(j).encrypt(Q,V,j,I)},decrypt:function(V,j,I){return K(j).decrypt(Q,V,j,I)}}}})()});g.StreamCipher=z.extend({_doFinalize:function(){var K=this._process(!0);return K},blockSize:1});var L=d.mode={},N=g.BlockCipherMode=m.extend({createEncryptor:function(K,Q){return this.Encryptor.create(K,Q)},createDecryptor:function(K,Q){return this.Decryptor.create(K,Q)},init:function(K,Q){this._cipher=K,this._iv=Q}}),M=L.CBC=(function(){var K=N.extend();K.Encryptor=K.extend({processBlock:function(V,j){var I=this._cipher,X=I.blockSize;Q.call(this,V,j,X),I.encryptBlock(V,j),this._prevBlock=V.slice(j,j+X)}}),K.Decryptor=K.extend({processBlock:function(V,j){var I=this._cipher,X=I.blockSize,W=V.slice(j,j+X);I.decryptBlock(V,j),Q.call(this,V,j,X),this._prevBlock=W}});function Q(V,j,I){var X,W=this._iv;W?(X=W,this._iv=f):X=this._prevBlock;for(var at=0;at<I;at++)V[j+at]^=X[at]}return K})(),G=d.pad={},w=G.Pkcs7={pad:function(K,Q){for(var V=Q*4,j=V-K.sigBytes%V,I=j<<24|j<<16|j<<8|j,X=[],W=0;W<j;W+=4)X.push(I);var at=_.create(X,j);K.concat(at)},unpad:function(K){var Q=K.words[K.sigBytes-1>>>2]&255;K.sigBytes-=Q}};g.BlockCipher=z.extend({cfg:z.cfg.extend({mode:M,padding:w}),reset:function(){var K;z.reset.call(this);var Q=this.cfg,V=Q.iv,j=Q.mode;this._xformMode==this._ENC_XFORM_MODE?K=j.createEncryptor:(K=j.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==K?this._mode.init(this,V&&V.words):(this._mode=K.call(j,this,V&&V.words),this._mode.__creator=K)},_doProcessBlock:function(K,Q){this._mode.processBlock(K,Q)},_doFinalize:function(){var K,Q=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Q.pad(this._data,this.blockSize),K=this._process(!0)):(K=this._process(!0),Q.unpad(K)),K},blockSize:128/32});var O=g.CipherParams=m.extend({init:function(K){this.mixIn(K)},toString:function(K){return(K||this.formatter).stringify(this)}}),A=d.format={},y=A.OpenSSL={stringify:function(K){var Q,V=K.ciphertext,j=K.salt;return j?Q=_.create([1398893684,1701076831]).concat(j).concat(V):Q=V,Q.toString(R)},parse:function(K){var Q,V=R.parse(K),j=V.words;return j[0]==1398893684&&j[1]==1701076831&&(Q=_.create(j.slice(2,4)),j.splice(0,4),V.sigBytes-=16),O.create({ciphertext:V,salt:Q})}},B=g.SerializableCipher=m.extend({cfg:m.extend({format:y}),encrypt:function(K,Q,V,j){j=this.cfg.extend(j);var I=K.createEncryptor(V,j),X=I.finalize(Q),W=I.cfg;return O.create({ciphertext:X,key:V,iv:W.iv,algorithm:K,mode:W.mode,padding:W.padding,blockSize:K.blockSize,formatter:j.format})},decrypt:function(K,Q,V,j){j=this.cfg.extend(j),Q=this._parse(Q,j.format);var I=K.createDecryptor(V,j).finalize(Q.ciphertext);return I},_parse:function(K,Q){return typeof K=="string"?Q.parse(K,this):K}}),U=d.kdf={},P=U.OpenSSL={execute:function(K,Q,V,j){j||(j=_.random(64/8));var I=D.create({keySize:Q+V}).compute(K,j),X=_.create(I.words.slice(Q),V*4);return I.sigBytes=Q*4,O.create({key:I,iv:X,salt:j})}},Y=g.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:P}),encrypt:function(K,Q,V,j){j=this.cfg.extend(j);var I=j.kdf.execute(V,K.keySize,K.ivSize);j.iv=I.iv;var X=B.encrypt.call(this,K,Q,I.key,j);return X.mixIn(I),X},decrypt:function(K,Q,V,j){j=this.cfg.extend(j),Q=this._parse(Q,j.format);var I=j.kdf.execute(V,K.keySize,K.ivSize,Q.salt);j.iv=I.iv;var X=B.decrypt.call(this,K,Q,I.key,j);return X}})})()})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.Request=i.createRequest=void 0;var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(12)),g=l.__importDefault(r(3)),m=l.__importDefault(r(7)),_=r(4),C=l.__importDefault(r(8)),E=l.__importDefault(r(2)),R=l.__importDefault(r(22)),v=f.getGlobalObject(),D=function(){},z=v._ablyjs_jsonp={};z._=function(A){return z["_"+A]||D};var L=1,N="jsonp";function M(A,y,B,U,P,Y,K){return Y=Y||C.default.TIMEOUTS,new w(void 0,A,y,f.copy(B),U,P,Y,K)}i.createRequest=M;var G=(function(A){l.__extends(y,A);function y(B,U,P){var Y=A.call(this,B,U,P)||this;return Y.shortName=N,P.stream=!1,Y}return y.isAvailable=function(){return g.default.Config.jsonpSupported&&g.default.Config.allowComet},y.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},y.prototype.createRequest=function(B,U,P,Y,K,Q,V){return Q=(this===null||this===void 0?void 0:this.timeouts)||Q||C.default.TIMEOUTS,M(B,U,P,Y,K,Q,V)},y})(d.default),w=(function(A){l.__extends(y,A);function y(B,U,P,Y,K,Q,V,j){var I=A.call(this)||this;return B===void 0&&(B=L++),I.id=B,I.uri=U,I.params=Y||{},I.params.rnd=f.cheapRandStr(),P&&(P["X-Ably-Version"]&&(I.params.v=P["X-Ably-Version"]),P["X-Ably-Lib"]&&(I.params.lib=P["X-Ably-Lib"])),I.body=K,I.method=j,I.requestMode=Q,I.timeouts=V,I.requestComplete=!1,I}return y.prototype.exec=function(){var B=this,U=this.id,P=this.body,Y=this.method,K=this.uri,Q=this.params;Q.callback="_ablyjs_jsonp._("+U+")",Q.envelope="jsonp",P&&(Q.body=P),Y&&Y!=="get"&&(Q.method=Y);var V=this.script=document.createElement("script"),j=K+f.toQueryString(Q);V.src=j,V.src.split("/").slice(-1)[0]!==j.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),V.async=!0,V.type="text/javascript",V.charset="UTF-8",V.onerror=function(W){B.complete(new _.PartialErrorInfo("JSONP script error (event: "+g.default.Config.inspect(W)+")",null,400))},z["_"+U]=function(W){if(W.statusCode){var at=W.response;if(W.statusCode==204)B.complete(null,null,null,W.statusCode);else if(!at)B.complete(new _.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(W.statusCode<400||f.isArray(at))B.complete(null,at,W.headers,W.statusCode);else{var J=at.error||new _.PartialErrorInfo("Error response received from server",null,W.statusCode);B.complete(J)}}else B.complete(null,W)};var I=this.requestMode==R.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),I);var X=document.getElementsByTagName("head")[0];X.insertBefore(V,X.firstChild)},y.prototype.complete=function(B,U,P,Y){if(P=P||{},!this.requestComplete){this.requestComplete=!0;var K=void 0;U&&(K=typeof U=="string"?"text/plain":"application/json",P["content-type"]=K,this.emit("data",U)),this.emit("complete",B,U,P,!0,Y),this.dispose()}},y.prototype.abort=function(){this.dispose()},y.prototype.dispose=function(){var B=this.timer;B&&(clearTimeout(B),this.timer=null);var U=this.script;U.parentNode&&U.parentNode.removeChild(U),delete z[this.id],this.emit("disposed")},y})(m.default);i.Request=w;function O(A){return v.JSONPTransport=G,G.isAvailable()&&(A.supportedTransports[N]=G),G}i.default=O}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(8)),m=l.__importDefault(r(18)),_=l.__importDefault(r(46)),C=l.__importDefault(r(20)),E=l.__importDefault(r(33)),R=l.__importDefault(r(4)),v=l.__importDefault(r(49)),D=l.__importDefault(r(19)),z=l.__importDefault(r(3)),L=l.__importDefault(r(9)),N=l.__importDefault(r(16)),M=l.__importDefault(r(15)),G=function(){},w=(function(){function A(y){if(!y){var B="no options provided";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new Error(B)}var U=g.default.objectifyOptions(y);U.log?(d.default.setLog(U.log.level,U.log.handler),d.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):d.default.setLog(U.logLevel,U.logHandler),d.default.logAction(d.default.LOG_MICRO,"Rest()","initialized with clientOptions "+z.default.Config.inspect(y));var P=this.options=g.default.normaliseOptions(U);if(P.key){var Y=P.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!Y){var B="invalid key parameter";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new R.default(B,40400,404)}P.keyName=Y[1],P.keySecret=Y[2]}if("clientId"in P)if(typeof P.clientId=="string"||P.clientId===null){if(P.clientId==="*")throw new R.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new R.default("clientId must be either a string or null",40012,400);d.default.logAction(d.default.LOG_MINOR,"Rest()","started; version = "+g.default.version),this.baseUri=this.authority=function(K){return g.default.getHttpScheme(P)+K+":"+g.default.getPort(P,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new z.default.Http(P),this.auth=new m.default(this,P),this.channels=new O(this),this.push=new _.default(this)}return A.prototype.stats=function(y,B){if(B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.options.promises)return f.promisify(this,"stats",[y]);B=G}var U=f.defaultGetHeaders(this.options),P=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,Y=this.http.supportsLinkHeaders?void 0:P;this.options.headers&&f.mixin(U,this.options.headers),new C.default(this,"/stats",U,Y,function(K,Q,V){for(var j=V?K:JSON.parse(K),I=0;I<j.length;I++)j[I]=v.default.fromValues(j[I]);return j}).get(y,B)},A.prototype.time=function(y,B){var U=this;if(B===void 0){if(typeof y=="function")B=y,y=null;else if(this.options.promises)return f.promisify(this,"time",[y])}var P=B||G,Y=f.defaultGetHeaders(this.options);this.options.headers&&f.mixin(Y,this.options.headers);var K=function(Q){return U.authority(Q)+"/time"};this.http.do(D.default.Get,this,K,Y,null,y,function(Q,V,j,I){if(Q){P(Q);return}I||(V=JSON.parse(V));var X=V[0];if(!X){P(new R.default("Internal error (unexpected result type from GET /time)",5e4,500));return}U.serverTimeOffset=X-f.now(),P(null,X)})},A.prototype.request=function(y,B,U,P,Y,K){var Q=this.options.useBinaryProtocol,V=Q?z.default.Config.msgpack.encode:JSON.stringify,j=Q?z.default.Config.msgpack.decode:JSON.parse,I=Q?f.Format.msgpack:f.Format.json,X=this.http.supportsLinkHeaders?void 0:I;U=U||{};var W=y.toLowerCase(),at=W=="get"?f.defaultGetHeaders(this.options,I):f.defaultPostHeaders(this.options,I);if(K===void 0){if(this.options.promises)return f.promisify(this,"request",[y,B,U,P,Y]);K=G}typeof P!="string"&&(P=V(P)),this.options.headers&&f.mixin(at,this.options.headers),Y&&f.mixin(at,Y);var J=new C.default(this,B,at,X,function(rt,it,q){return f.ensureArray(q?rt:j(rt))},!0);if(!f.arrIn(z.default.Http.methods,W))throw new R.default("Unsupported method "+W,40500,405);f.arrIn(z.default.Http.methodsWithBody,W)?J[W](U,P,K):J[W](U,K)},A.prototype.batchPublish=function(y,B){if(B===void 0){if(this.options.promises)return f.promisify(this,"batchPublish",[y]);B=G}var U=B,P,Y;f.isArray(y)?(P=y,Y=!1):(P=[y],Y=!0);var K=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,Q=f.defaultPostHeaders(this.options,K);this.options.headers&&f.mixin(Q,this.options.headers);var V=f.encodeBody(P,K);M.default.post(this,"/messages",V,Q,{newBatchResponse:"true"},null,function(j,I,X,W){if(j){U(j);return}var at=W?I:f.decodeBody(I,K);Y?U(null,at[0]):U(null,at)})},A.prototype.batchPresence=function(y,B){if(B===void 0){if(this.options.promises)return f.promisify(this,"batchPresence",[y]);B=G}var U=B,P=this.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,Y=f.defaultPostHeaders(this.options,P);this.options.headers&&f.mixin(Y,this.options.headers);var K=y.join(",");M.default.get(this,"/presence",Y,{newBatchResponse:"true",channels:K},null,function(Q,V,j,I){if(Q){U(Q);return}var X=I?V:f.decodeBody(V,P);U(null,X)})},A.prototype.setLog=function(y){d.default.setLog(y.level,y.handler)},A.Promise=function(y){return y=g.default.objectifyOptions(y),y.promises=!0,new A(y)},A.Callbacks=A,A.Platform=z.default,A.Message=L.default,A.PresenceMessage=N.default,A})(),O=(function(){function A(y){this.rest=y,this.all=Object.create(null)}return A.prototype.get=function(y,B){y=String(y);var U=this.all[y];return U?B&&U.setOptions(B):this.all[y]=U=new E.default(this.rest,y,B),U},A.prototype.release=function(y){delete this.all[String(y)]},A})();i.default=w}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return l.enc.Utf8})}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[],R=[];(function(){function z(G){for(var w=f.sqrt(G),O=2;O<=w;O++)if(!(G%O))return!1;return!0}function L(G){return(G-(G|0))*4294967296|0}for(var N=2,M=0;M<64;)z(N)&&(M<8&&(E[M]=L(f.pow(N,1/2))),R[M]=L(f.pow(N,1/3)),M++),N++})();var v=[],D=C.SHA256=_.extend({_doReset:function(){this._hash=new m.init(E.slice(0))},_doProcessBlock:function(z,L){for(var N=this._hash.words,M=N[0],G=N[1],w=N[2],O=N[3],A=N[4],y=N[5],B=N[6],U=N[7],P=0;P<64;P++){if(P<16)v[P]=z[L+P]|0;else{var Y=v[P-15],K=(Y<<25|Y>>>7)^(Y<<14|Y>>>18)^Y>>>3,Q=v[P-2],V=(Q<<15|Q>>>17)^(Q<<13|Q>>>19)^Q>>>10;v[P]=K+v[P-7]+V+v[P-16]}var j=A&y^~A&B,I=M&G^M&w^G&w,X=(M<<30|M>>>2)^(M<<19|M>>>13)^(M<<10|M>>>22),W=(A<<26|A>>>6)^(A<<21|A>>>11)^(A<<7|A>>>25),at=U+W+j+R[P]+v[P],J=X+I;U=B,B=y,y=A,A=O+at|0,O=w,w=G,G=M,M=at+J|0}N[0]=N[0]+M|0,N[1]=N[1]+G|0,N[2]=N[2]+w|0,N[3]=N[3]+O|0,N[4]=N[4]+A|0,N[5]=N[5]+y|0,N[6]=N[6]+B|0,N[7]=N[7]+U|0},_doFinalize:function(){var z=this._data,L=z.words,N=this._nDataBytes*8,M=z.sigBytes*8;return L[M>>>5]|=128<<24-M%32,L[(M+64>>>9<<4)+14]=f.floor(N/4294967296),L[(M+64>>>9<<4)+15]=N,z.sigBytes=L.length*4,this._process(),this._hash},clone:function(){var z=_.clone.call(this);return z._hash=this._hash.clone(),z}});d.SHA256=_._createHelper(D),d.HmacSHA256=_._createHmacHelper(D)})(Math),l.SHA256})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(34)),_=l.__importDefault(r(9)),C=l.__importDefault(r(4)),E=l.__importDefault(r(20)),R=l.__importDefault(r(15)),v=l.__importDefault(r(3));function D(){}var z=9;function L(G){return f.arrEvery(G,function(w){return!w.id})}function N(G){var w=G||{};if(w.cipher){if(!v.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var O=v.default.Crypto.getCipher(w.cipher);w.cipher=O.cipherParams,w.channelCipher=O.cipher}else"cipher"in w&&(w.cipher=void 0,w.channelCipher=null);return w}var M=(function(G){l.__extends(w,G);function w(O,A,y){var B=G.call(this)||this;return g.default.logAction(g.default.LOG_MINOR,"Channel()","started; name = "+A),B.rest=O,B.name=A,B.basePath="/channels/"+encodeURIComponent(A),B.presence=new m.default(B),B.channelOptions=N(y),B}return w.prototype.setOptions=function(O){this.channelOptions=N(O)},w.prototype.history=function(O,A){if(g.default.logAction(g.default.LOG_MICRO,"Channel.history()","channel = "+this.name),A===void 0)if(typeof O=="function")A=O,O=null;else{if(this.rest.options.promises)return f.promisify(this,"history",arguments);A=D}this._history(O,A)},w.prototype._history=function(O,A){var y=this.rest,B=y.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,U=this.rest.http.supportsLinkHeaders?void 0:B,P=f.defaultGetHeaders(y.options,B);y.options.headers&&f.mixin(P,y.options.headers);var Y=this.channelOptions;new E.default(y,this.basePath+"/messages",P,U,function(K,Q,V){return _.default.fromResponseBody(K,Y,V?void 0:B)}).get(O,A)},w.prototype.publish=function(){var O=this,A=arguments.length,y=arguments[0],B=arguments[1],U=arguments[A-1],P,Y;if(typeof U!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);U=D}if(typeof y=="string"||y===null)P=[_.default.fromValues({name:y,data:B})],Y=arguments[2];else if(f.isObject(y))P=[_.default.fromValues(y)],Y=arguments[1];else if(f.isArray(y))P=_.default.fromValuesArray(y),Y=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof Y!="object"||!Y)&&(Y={});var K=this.rest,Q=K.options,V=Q.useBinaryProtocol?f.Format.msgpack:f.Format.json,j=K.options.idempotentRestPublishing,I=f.defaultPostHeaders(K.options,V);if(Q.headers&&f.mixin(I,Q.headers),j&&L(P)){var X=f.randomString(z);f.arrForEach(P,function(W,at){W.id=X+":"+at.toString()})}_.default.encodeArray(P,this.channelOptions,function(W){if(W){U(W);return}var at=_.default.getMessagesSize(P),J=Q.maxMessageSize;if(at>J){U(new C.default("Maximum size of messages that can be published at once exceeded ( was "+at+" bytes; limit is "+J+" bytes)",40009,400));return}O._publish(_.default.serialize(P,V),I,Y,U)})},w.prototype._publish=function(O,A,y,B){R.default.post(this.rest,this.basePath+"/messages",O,A,y,null,B)},w.prototype.status=function(O){if(typeof O!="function"&&this.rest.options.promises)return f.promisify(this,"status",[]);var A=this.rest.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,y=f.defaultPostHeaders(this.rest.options,A);R.default.get(this.rest,this.basePath,y,{},A,O||D)},w})(d.default);i.default=M}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(20)),_=l.__importDefault(r(16));function C(){}var E=(function(R){l.__extends(v,R);function v(D){var z=R.call(this)||this;return z.channel=D,z.basePath=D.basePath+"/presence",z}return v.prototype.get=function(D,z){if(g.default.logAction(g.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),z===void 0)if(typeof D=="function")z=D,D=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"get",arguments);z=C}var L=this.channel.rest,N=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:N,G=f.defaultGetHeaders(L.options,N);L.options.headers&&f.mixin(G,L.options.headers);var w=this.channel.channelOptions;new m.default(L,this.basePath,G,M,function(O,A,y){return _.default.fromResponseBody(O,w,y?void 0:N)}).get(D,z)},v.prototype.history=function(D,z){return g.default.logAction(g.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(D,z)},v.prototype._history=function(D,z){if(z===void 0)if(typeof D=="function")z=D,D=null;else{if(this.channel.rest.options.promises)return f.promisify(this,"_history",[D]);z=C}var L=this.channel.rest,N=L.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,M=this.channel.rest.http.supportsLinkHeaders?void 0:N,G=f.defaultGetHeaders(L.options,N);L.options.headers&&f.mixin(G,L.options.headers);var w=this.channel.channelOptions;new m.default(L,this.basePath+"/history",G,M,function(O,A,y){return _.default.fromResponseBody(O,w,y?void 0:N)}).get(D,z)},v})(d.default);i.default=E}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0}),i.TransportParams=void 0;var f=r(0),d=f.__importDefault(r(10)),g=f.__importStar(r(1)),m=f.__importStar(r(52)),_=f.__importStar(r(8)),C=f.__importDefault(r(3)),E=f.__importDefault(r(7)),R=f.__importDefault(r(36)),v=f.__importDefault(r(2)),D=f.__importDefault(r(37)),z=f.__importStar(r(21)),L=f.__importStar(r(4)),N=f.__importDefault(r(18)),M=f.__importDefault(r(9)),G=f.__importDefault(r(24)),w=f.__importDefault(r(53)),O=f.__importDefault(r(26)),A=f.__importDefault(r(14)),y=function(){var rt;return typeof C.default.WebStorage<"u"&&((rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.localSupported)},B=function(){var rt;return typeof C.default.WebStorage<"u"&&((rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.sessionSupported)},U=d.default.Action,P=function(){},Y="ably-transport-preference",K="ably-connection-recovery";function Q(){var rt,it;return B()&&((it=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.getSession)===null||it===void 0?void 0:it.call(rt,K))}function V(rt){var it,q;return B()&&((q=(it=C.default.WebStorage)===null||it===void 0?void 0:it.setSession)===null||q===void 0?void 0:q.call(it,K,rt))}function j(){var rt,it;return B()&&((it=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.removeSession)===null||it===void 0?void 0:it.call(rt,K))}function I(rt,it){return g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,rt.shortName)>g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,it.shortName)}function X(rt,it,q){var F;if(rt.channel!==it.channel||(F=rt.action)!==U.PRESENCE&&F!==U.MESSAGE||F!==it.action)return!1;var tt=F===U.PRESENCE?"presence":"messages",nt=rt[tt].concat(it[tt]),gt=M.default.getMessagesSize(nt);return gt>q||!g.allSame(nt,"clientId")||!g.arrEvery(nt,function(At){return!At.id})?!1:(rt[tt]=nt,!0)}function W(rt){try{return JSON.parse(rt)}catch{return null}}var at=(function(){function rt(it,q,F,tt){this.options=it,this.host=q,this.mode=F,this.connectionKey=tt,this.format=it.useBinaryProtocol?g.Format.msgpack:g.Format.json}return rt.prototype.getConnectParams=function(it){var q=it?g.copy(it):{},F=this.options;switch(this.mode){case"upgrade":q.upgrade=this.connectionKey;break;case"resume":q.resume=this.connectionKey;break;case"recover":{var tt=W(F.recover);tt&&(q.recover=tt.connectionKey);break}}return F.clientId!==void 0&&(q.clientId=F.clientId),F.echoMessages===!1&&(q.echo="false"),this.format!==void 0&&(q.format=this.format),this.stream!==void 0&&(q.stream=this.stream),this.heartbeats!==void 0&&(q.heartbeats=this.heartbeats),q.v=_.default.protocolVersion,q.agent=(0,_.getAgentString)(this.options),F.transportParams!==void 0&&g.mixin(q,F.transportParams),q},rt.prototype.toString=function(){var it="[mode="+this.mode;return this.host&&(it+=",host="+this.host),this.connectionKey&&(it+=",connectionKey="+this.connectionKey),this.format&&(it+=",format="+this.format),it+="]",it},rt})();i.TransportParams=at;var J=(function(rt){f.__extends(it,rt);function it(q,F){var tt=rt.call(this)||this;tt.disconnectedRetryCount=0,it.initTransports(),tt.realtime=q,tt.options=F;var nt=F.timeouts,gt=nt.preferenceConnectTimeout+nt.realtimeRequestTimeout;if(tt.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:gt,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:nt.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:nt.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},tt.state=tt.states.initialized,tt.errorReason=null,tt.queuedMessages=new R.default,tt.msgSerial=0,tt.connectionDetails=void 0,tt.connectionId=void 0,tt.connectionKey=void 0,tt.connectionStateTtl=nt.connectionStateTtl,tt.maxIdleInterval=null,tt.transports=g.intersect(F.transports||_.default.defaultTransports,it.supportedTransports),tt.baseTransport=g.intersect(_.default.baseTransportOrder,tt.transports)[0],tt.upgradeTransports=g.intersect(tt.transports,_.default.upgradeTransports),tt.transportPreference=null,tt.httpHosts=_.default.getHosts(F),tt.activeProtocol=null,tt.proposedTransports=[],tt.pendingTransports=[],tt.host=null,tt.lastAutoReconnectAttempt=null,tt.lastActivity=null,tt.forceFallbackHost=!1,tt.connectCounter=0,v.default.logAction(v.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(F.transports||_.default.defaultTransports)+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+tt.transports+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+tt.httpHosts+"]"),!tt.transports.length){var At="no requested transports available";throw v.default.logAction(v.default.LOG_ERROR,"realtime.ConnectionManager()",At),new Error(At)}var Bt=C.default.Config.addEventListener;return Bt&&(B()&&typeof F.recover=="function"&&Bt("beforeunload",tt.persistConnection.bind(tt)),F.closeOnUnload===!0&&Bt("beforeunload",function(){v.default.logAction(v.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),tt.requestState({state:"closing"})}),Bt("online",function(){tt.state==tt.states.disconnected||tt.state==tt.states.suspended?(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),tt.requestState({state:"connecting"})):tt.state==tt.states.connecting&&(tt.pendingTransports.forEach(function(qt){qt.off()}),tt.disconnectAllTransports(),tt.startConnect())}),Bt("offline",function(){tt.state==tt.states.connected&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),tt.disconnectAllTransports())})),tt}return it.initTransports=function(){(0,w.default)(it),g.arrForEach(C.default.Transports,function(q){q(it)})},it.prototype.createTransportParams=function(q,F){return new at(this.options,q,F,this.connectionKey)},it.prototype.getTransportParams=function(q){var F=this,tt=function(nt){if(F.connectionKey){nt("resume");return}if(typeof F.options.recover=="string"){nt("recover");return}var gt=F.options.recover,At=Q();if(At&&typeof gt=="function"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),gt(At,function(Bt){Bt?(F.options.recover=At.recoveryKey,nt("recover")):nt("clean")});return}nt("clean")};tt(function(nt){var gt=F.createTransportParams(null,nt);if(nt==="recover"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+F.options.recover);var At=W(F.options.recover);At&&(F.msgSerial=At.msgSerial)}else v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+gt.toString());q(gt)})},it.prototype.tryATransport=function(q,F,tt){var nt=this;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+F),O.default.tryConnect(it.supportedTransports[F],this,this.realtime.auth,q,function(gt,At){var Bt=nt.state;if(Bt==nt.states.closing||Bt==nt.states.closed||Bt==nt.states.failed){At&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+Bt.state+" while we were attempting the transport; closing "+At),At.close()),tt(!0);return}if(gt){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+F+" "+gt.event+", err: "+gt.error.toString()),N.default.isTokenErr(gt.error)&&!(nt.errorReason&&N.default.isTokenErr(nt.errorReason))?(nt.errorReason=gt.error,nt.realtime.auth._forceNewToken(null,null,function(qt){if(qt){nt.actOnErrorFromAuthorize(qt);return}nt.tryATransport(q,F,tt)})):gt.event==="failed"?(nt.notifyState({state:"failed",error:gt.error}),tt(!0)):gt.event==="disconnected"&&((0,z.isRetriable)(gt.error)?tt(!1):(nt.notifyState({state:nt.states.connecting.failState,error:gt.error}),tt(!0)));return}v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+F+"; setting pending"),nt.setTransportPending(At,q),tt(null,At)})},it.prototype.setTransportPending=function(q,F){var tt=this,nt=F.mode;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+q+"; mode = "+nt),g.arrDeleteValue(this.proposedTransports,q),this.pendingTransports.push(q);var gt=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];q.once("connected",function(Bt,qt,Jt){nt=="upgrade"&&tt.activeProtocol?q.shortName!==gt&&g.arrIn(tt.getUpgradePossibilities(),gt)&&tt.activeProtocol?setTimeout(function(){tt.scheduleTransportActivation(Bt,q,qt,Jt)},tt.options.timeouts.parallelUpgradeDelay):tt.scheduleTransportActivation(Bt,q,qt,Jt):(tt.activateTransport(Bt,q,qt,Jt),C.default.Config.nextTick(function(){tt.connectImpl(F)})),nt==="recover"&&tt.options.recover&&(tt.options.recover=null,tt.unpersistConnection())});var At=this;q.on(["disconnected","closed","failed"],function(Bt){At.deactivateTransport(q,this.event,Bt)}),this.emit("transport.pending",q)},it.prototype.scheduleTransportActivation=function(q,F,tt,nt){var gt=this,At=this.activeProtocol&&this.activeProtocol.getTransport(),Bt=function(){F.disconnect(),g.arrDeleteValue(gt.pendingTransports,F)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+F.shortName),Bt();return}if(At&&!I(F,At)){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+F.shortName+" is no better than current active transport "+At.shortName+" - abandoning upgrade"),Bt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+F);var qt=null;if(!F.isConnected){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+F.shortName+"is no longer connected; abandoning upgrade"),Bt();return}if(this.state===this.states.connected)v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,qt=this.activeProtocol;else if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+F.shortName),Bt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+F);var Jt=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+F),F.send(d.default.fromValues({action:U.ACTIVATE})),gt.activateTransport(q,F,tt,nt),gt.state===gt.states.synchronizing?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+F),gt.state=gt.states.connected):v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+gt.state.state+", so leaving unchanged"),gt.state.sendEvents&&gt.sendQueuedMessages()};qt?qt.onceIdle(Jt):Jt()},it.prototype.activateTransport=function(q,F,tt,nt){var gt=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+F),q&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+q),tt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+tt),nt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(nt)),this.persistTransportPreference(F);var At=this.state,Bt=this.states.connected.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+At.state),At.state==this.states.closing.state||At.state==this.states.closed.state||At.state==this.states.failed.state)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),F.disconnect(),!1;if(g.arrDeleteValue(this.pendingTransports,F),!F.isConnected)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+F+" since it appears to no longer be connected"),!1;var qt=this.activeProtocol;this.activeProtocol=new m.default(F),this.host=F.params.host;var Jt=nt.connectionKey;if(Jt&&this.connectionKey!=Jt&&this.setConnection(tt,nt,!!q),this.onConnectionDetailsUpdate(nt,F),C.default.Config.nextTick(function(){F.on("connected",function(Gt,be,Re){gt.onConnectionDetailsUpdate(Re,F),gt.emit("update",new D.default(Bt,Bt,null,Gt))})}),At.state===this.states.connected.state?q&&(this.errorReason=this.realtime.connection.errorReason=q,this.emit("update",new D.default(Bt,Bt,null,q))):(this.notifyState({state:"connected",error:q}),this.errorReason=this.realtime.connection.errorReason=q||null),this.emit("transport.active",F),qt)if(qt.messageQueue.count()>0&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+qt.transport.shortName+", new one is "+F.shortName+") finishing with "+qt.messageQueue.count()+" messages still pending"),qt.transport===F){var ee="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+F.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",ee)}else qt.finish();return g.safeArrForEach(this.pendingTransports,function(Gt){if(Gt===F){var be="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+F.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",be),g.arrDeleteValue(gt.pendingTransports,F)}else Gt.disconnect()}),g.safeArrForEach(this.proposedTransports,function(Gt){Gt===F?(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+F.shortName+"; stack = "+new Error().stack),g.arrDeleteValue(gt.proposedTransports,F)):Gt.dispose()}),!0},it.prototype.deactivateTransport=function(q,F,tt){var nt=this.activeProtocol,gt=nt&&nt.getTransport()===q,At=g.arrDeleteValue(this.pendingTransports,q),Bt=g.arrDeleteValue(this.proposedTransports,q),qt=this.noTransportsScheduledForActivation();if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+q),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+F+(gt?"; was active":At?"; was pending":Bt?"; was proposed":"")+(qt?"":"; another transport is scheduled for activation")),tt&&tt.message&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+tt.message),gt&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(nt.getPendingMessages()),C.default.Config.nextTick(function(){nt.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",q),gt&&qt||gt&&F==="failed"||F==="closed"||nt===null&&At&&this.pendingTransports.length===0){if(F==="disconnected"&&tt&&tt.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:F,error:tt,retryImmediately:!0});return}var Jt=F==="failed"&&N.default.isTokenErr(tt)?"disconnected":F;this.notifyState({state:Jt,error:tt});return}gt&&F==="disconnected"&&this.state!==this.states.synchronizing&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:tt}))},it.prototype.noTransportsScheduledForActivation=function(){return g.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(q){return!q.isConnected})},it.prototype.setConnection=function(q,F,tt){var nt=this.connectionId,gt=nt&&nt!==q,At=!nt&&tt;(gt||At)&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==q&&v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=q,this.realtime.connection.key=this.connectionKey=F.connectionKey},it.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},it.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},it.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var q=g.now()-this.lastActivity;q>this.connectionStateTtl+this.maxIdleInterval&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+q+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},it.prototype.persistConnection=function(){if(B()){var q=this.createRecoveryKey();q&&V({recoveryKey:q,disconnectedAt:g.now(),location:l.location,clientId:this.realtime.auth.clientId})}},it.prototype.unpersistConnection=function(){j()},it.prototype.getError=function(){return this.errorReason||this.getStateError()},it.prototype.getStateError=function(){var q,F;return(F=(q=z.default)[this.state.state])===null||F===void 0?void 0:F.call(q)},it.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},it.prototype.enactStateChange=function(q){var F=q.current==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(F,"Connection state",q.current+(q.reason?"; reason: "+q.reason:"")),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+q.current+"; reason = "+(q.reason&&q.reason.message));var tt=this.state=this.states[q.current];q.reason&&(this.errorReason=q.reason,this.realtime.connection.errorReason=q.reason),(tt.terminal||tt.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",q)},it.prototype.startTransitionTimer=function(q){var F=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+q.state),this.transitionTimer&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){F.transitionTimer&&(F.transitionTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager "+q.state+" timer expired","requesting new state: "+q.failState),F.notifyState({state:q.failState}))},q.retryDelay)},it.prototype.cancelTransitionTimer=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},it.prototype.startSuspendTimer=function(){var q=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){q.suspendTimer&&(q.suspendTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),q.states.connecting.failState="suspended",q.notifyState({state:"suspended"}))},this.connectionStateTtl))},it.prototype.checkSuspendTimer=function(q){q!=="disconnected"&&q!=="suspended"&&q!=="connecting"&&this.cancelSuspendTimer()},it.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},it.prototype.startRetryTimer=function(q){var F=this;this.retryTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),F.retryTimer=null,F.requestState({state:"connecting"})},q)},it.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},it.prototype.notifyState=function(q){var F=this,tt,nt,gt=q.state,At=gt==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||q.retryImmediately||this.state===this.states.connecting&&q.error&&N.default.isTokenErr(q.error)&&!(this.errorReason&&N.default.isTokenErr(this.errorReason)));if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+gt+(At?"; will retry connection immediately":"")),gt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(q.state),(gt==="suspended"||gt==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var Bt=this.states[q.state],qt=Bt.retryDelay;Bt.state==="disconnected"&&(this.disconnectedRetryCount++,qt=g.getRetryTime(Bt.retryDelay,this.disconnectedRetryCount));var Jt=new D.default(this.state.state,Bt.state,qt,q.error||((nt=(tt=z.default)[Bt.state])===null||nt===void 0?void 0:nt.call(tt)));if(At){var ee=function(){F.state===F.states.disconnected&&(F.lastAutoReconnectAttempt=g.now(),F.requestState({state:"connecting"}))},Gt=this.lastAutoReconnectAttempt&&g.now()-this.lastAutoReconnectAttempt+1;Gt&&Gt<1e3?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+Gt+"ms ago, waiting another "+(1e3-Gt)+"ms before trying again"),setTimeout(ee,1e3-Gt)):C.default.Config.nextTick(ee)}else(gt==="disconnected"||gt==="suspended")&&this.startRetryTimer(qt);(gt==="disconnected"&&!At||gt==="suspended"||Bt.terminal)&&C.default.Config.nextTick(function(){F.disconnectAllTransports()}),gt=="connected"&&!this.activeProtocol&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(Jt),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(gt,Jt.reason),this.failQueuedMessages(Jt.reason))}},it.prototype.requestState=function(q){var F=this,tt,nt,gt=q.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+gt+"; current state: "+this.state.state),gt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(gt),!(gt=="connecting"&&this.state.state=="connected")&&!(gt=="closing"&&this.state.state=="closed"))){var At=this.states[gt],Bt=new D.default(this.state.state,At.state,null,q.error||((nt=(tt=z.default)[At.state])===null||nt===void 0?void 0:nt.call(tt)));this.enactStateChange(Bt),gt=="connecting"&&C.default.Config.nextTick(function(){F.startConnect()}),gt=="closing"&&this.closeImpl()}},it.prototype.startConnect=function(){var q=this;if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var F=this.realtime.auth,tt=++this.connectCounter,nt=function(){q.checkConnectionStateFreshness(),q.getTransportParams(function(At){if(At.mode==="recover"&&At.options.recover){var Bt=W(At.options.recover);Bt&&q.realtime.channels.recoverChannels(Bt.channelSerials)}tt===q.connectCounter&&q.connectImpl(At,tt)})};if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),F.method==="basic")nt();else{var gt=function(At){tt===q.connectCounter&&(At?q.actOnErrorFromAuthorize(At):nt())};this.errorReason&&N.default.isTokenErr(this.errorReason)?F._forceNewToken(null,null,gt):F._ensureValidAuthCredentials(!1,gt)}},it.prototype.connectImpl=function(q,F){var tt=this.state.state;tt!==this.states.connecting.state&&tt!==this.states.connected.state?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+tt):this.pendingTransports.length?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):tt==this.states.connected.state?this.upgradeIfNeeded(q):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(q,F):this.connectBase(q,F)},it.prototype.connectPreference=function(q,F){var tt=this,nt=this.getTransportPreference(),gt=!1;g.arrIn(this.transports,nt)||(this.unpersistTransportPreference(),this.connectImpl(q,F)),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+nt);var At=setTimeout(function(){gt=!0,tt.state.state!==tt.states.connected.state&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+nt+" failed; clearing preference and trying from scratch"),tt.disconnectAllTransports(),tt.unpersistTransportPreference()),tt.connectImpl(q,F)},this.options.timeouts.preferenceConnectTimeout);q.host=this.httpHosts[0],this.tryATransport(q,nt,function(Bt,qt){clearTimeout(At),gt&&qt?(qt.off(),qt.disconnect(),g.arrDeleteValue(tt.pendingTransports,qt)):!qt&&!Bt&&(tt.unpersistTransportPreference(),tt.connectImpl(q,F))})},it.prototype.connectBase=function(q,F){var tt=this,nt=function(Jt){tt.notifyState({state:tt.states.connecting.failState,error:Jt})},gt=this.httpHosts.slice(),At=function(Jt,ee){F===tt.connectCounter&&!ee&&!Jt&&qt()};v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var Bt=gt.shift();if(!Bt){nt(new L.default("Unable to connect (no available host)",80003,404));return}q.host=Bt;var qt=function(){if(!gt.length){nt(new L.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!tt.realtime.http.checkConnectivity){nt(new L.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}tt.realtime.http.checkConnectivity(function(Jt,ee){if(F===tt.connectCounter){if(Jt){nt(Jt);return}if(!ee){nt(new L.default("Unable to connect (network unreachable)",80003,404));return}q.host=g.arrPopRandomElement(gt),tt.tryATransport(q,tt.baseTransport,At)}})};if(this.forceFallbackHost&&gt.length){this.forceFallbackHost=!1,qt();return}this.tryATransport(q,this.baseTransport,At)},it.prototype.getUpgradePossibilities=function(){var q=this.activeProtocol.getTransport().shortName,F=g.arrIndexOf(this.upgradeTransports,q);return this.upgradeTransports.slice(F+1)},it.prototype.upgradeIfNeeded=function(q){var F=this,tt=this.getUpgradePossibilities();v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect(tt)),tt.length&&g.arrForEach(tt,function(nt){var gt=F.createTransportParams(q.host,"upgrade");F.tryATransport(gt,nt,P)})},it.prototype.closeImpl=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),g.safeArrForEach(this.pendingTransports,function(q){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+q),q&&q.close()}),g.safeArrForEach(this.proposedTransports,function(q){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+q),q&&q.dispose()}),this.activeProtocol&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},it.prototype.onAuthUpdated=function(q,F){var tt=this,nt;switch(this.state.state){case"connected":{if(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var gt=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){tt.state.state==="connected"&&tt.upgradeIfNeeded(gt)})}var At=(nt=this.activeProtocol)===null||nt===void 0?void 0:nt.getTransport();At&&At.onAuthUpdated&&At.onAuthUpdated(q);var Bt=d.default.fromValues({action:U.AUTH,auth:{accessToken:q.token}});this.send(Bt);var qt=function(){tt.off(Jt),F(null,q)},Jt=function(Gt){Gt.current==="failed"&&(tt.off(qt),tt.off(Jt),F(Gt.reason||tt.getStateError()))};this.once("connectiondetails",qt),this.on("connectionstate",Jt);break}case"connecting":v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var ee=function(Gt){switch(Gt.current){case"connected":tt.off(ee),F(null,q);break;case"failed":case"closed":case"suspended":tt.off(ee),F(Gt.reason||tt.getStateError());break}};this.on("connectionstate",ee),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},it.prototype.disconnectAllTransports=function(q){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(q?" except the active transport":"")),this.connectCounter++,g.safeArrForEach(this.pendingTransports,function(F){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+F),F&&F.disconnect()}),this.pendingTransports=[],g.safeArrForEach(this.proposedTransports,function(F){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+F),F&&F.dispose()}),this.proposedTransports=[],this.activeProtocol&&!q&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},it.prototype.send=function(q,F,tt){tt=tt||P;var nt=this.state;if(nt.sendEvents){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new m.PendingMessage(q,tt));return}var gt=F&&nt.queueEvents||nt.forceQueueEvents;if(!gt){var At="rejecting event, queueEvent was "+F+", state was "+nt.state;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()",At),tt(this.errorReason||new L.default(At,9e4,400));return}v.default.shouldLog(v.default.LOG_MICRO)&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+d.default.stringify(q)),this.queue(q,tt)},it.prototype.sendImpl=function(q){var F=q.message;q.ackRequired&&!q.sendAttempted&&(F.msgSerial=this.msgSerial++);try{this.activeProtocol.send(q)}catch(tt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+tt.stack)}},it.prototype.queue=function(q,F){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var tt=this.queuedMessages.last(),nt=this.options.maxMessageSize;tt&&!tt.sendAttempted&&X(tt.message,q,nt)?(tt.merged||(tt.callback=G.default.create([tt.callback]),tt.merged=!0),tt.callback.push(F)):this.queuedMessages.push(new m.PendingMessage(q,F))},it.prototype.sendQueuedMessages=function(){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var q;q=this.queuedMessages.shift();)this.sendImpl(q)},it.prototype.queuePendingMessages=function(q){q&&q.length&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+q.length+" pending messages"),this.queuedMessages.prepend(q))},it.prototype.failQueuedMessages=function(q){var F=this.queuedMessages.count();F>0&&(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+F+" queued messages, err = "+g.inspectError(q)),this.queuedMessages.completeAllMessages(q))},it.prototype.onChannelMessage=function(q,F){var tt=this.activeProtocol&&F===this.activeProtocol.getTransport(),nt=g.arrIn(this.pendingTransports,F)&&this.state==this.states.synchronizing;tt||nt?this.realtime.channels.onChannelMessage(q):g.arrIndexOf([U.ACK,U.NACK,U.ERROR],q.action)>-1?this.realtime.channels.onChannelMessage(q):v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(q)+"on defunct transport; discarding")},it.prototype.ping=function(q,F){var tt=this;if(q){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+q);var nt=function(){q.off("heartbeat",Bt),F(new L.default("Timeout waiting for heartbeat response",5e4,500))},gt=g.now(),At=g.cheapRandStr(),Bt=function(be){if(be===At){q.off("heartbeat",Bt),clearTimeout(qt);var Re=g.now()-gt;F(null,Re)}},qt=setTimeout(nt,this.options.timeouts.realtimeRequestTimeout);q.on("heartbeat",Bt),q.ping(At);return}if(this.state.state!=="connected"){F(new L.default("Unable to ping service; not connected",4e4,400));return}var Jt=!1,ee=function(be,Re){tt.off("transport.active",Gt),Jt||(Jt=!0,F(be,Re))},Gt=function(){Jt||(Jt=!0,C.default.Config.nextTick(function(){tt.ping(null,F)}))};this.on("transport.active",Gt),this.ping(this.activeProtocol.getTransport(),ee)},it.prototype.abort=function(q){this.activeProtocol.getTransport().fail(q)},it.prototype.registerProposedTransport=function(q){this.proposedTransports.push(q)},it.prototype.getTransportPreference=function(){var q,F;return this.transportPreference||y()&&((F=(q=C.default.WebStorage)===null||q===void 0?void 0:q.get)===null||F===void 0?void 0:F.call(q,Y))},it.prototype.persistTransportPreference=function(q){var F,tt;g.arrIn(_.default.upgradeTransports,q.shortName)&&(this.transportPreference=q.shortName,y()&&((tt=(F=C.default.WebStorage)===null||F===void 0?void 0:F.set)===null||tt===void 0||tt.call(F,Y,q.shortName)))},it.prototype.unpersistTransportPreference=function(){var q,F;this.transportPreference=null,y()&&((F=(q=C.default.WebStorage)===null||q===void 0?void 0:q.remove)===null||F===void 0||F.call(q,Y))},it.prototype.actOnErrorFromAuthorize=function(q){if(q.code===40171)this.notifyState({state:"failed",error:q});else if(q.code===40102)this.notifyState({state:"failed",error:q});else if(q.statusCode===A.default.Forbidden){var F="Client configured authentication provider returned 403; failing the connection";v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",F),this.notifyState({state:"failed",error:new L.default(F,80019,403,q)})}else{var F="Client configured authentication provider request failed";v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",F),this.notifyState({state:this.state.failState,error:new L.default(F,80019,401,q)})}},it.prototype.onConnectionDetailsUpdate=function(q,F){if(q){this.connectionDetails=q,q.maxMessageSize&&(this.options.maxMessageSize=q.maxMessageSize);var tt=q.clientId;if(tt){var nt=this.realtime.auth._uncheckedSetClientId(tt);if(nt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",nt.message),F.fail(nt);return}}var gt=q.connectionStateTtl;gt&&(this.connectionStateTtl=gt),this.maxIdleInterval=q.maxIdleInterval,this.emit("connectiondetails",q)}},it.supportedTransports={},it})(E.default);i.default=J}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(7)),d=l.__importDefault(r(2)),g=(function(m){l.__extends(_,m);function _(){var C=m.call(this)||this;return C.messages=[],C}return _.prototype.count=function(){return this.messages.length},_.prototype.push=function(C){this.messages.push(C)},_.prototype.shift=function(){return this.messages.shift()},_.prototype.last=function(){return this.messages[this.messages.length-1]},_.prototype.copyAll=function(){return this.messages.slice()},_.prototype.append=function(C){this.messages.push.apply(this.messages,C)},_.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},_.prototype.completeMessages=function(C,E,R){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+E),R=R||null;var v=this.messages;if(v.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var D=v[0];if(D){var z=D.message.msgSerial,L=C+E;if(L>z)for(var N=v.splice(0,L-z),M=0,G=N;M<G.length;M++){var w=G[M];w.callback(R)}v.length==0&&this.emit("idle")}},_.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},_.prototype.resetSendAttempted=function(){for(var C=0,E=this.messages;C<E.length;C++){var R=E[C];R.sendAttempted=!1}},_.prototype.clear=function(){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},_})(f.default);i.default=g}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function f(d,g,m,_){this.previous=d,this.current=g,m&&(this.retryIn=m),_&&(this.reason=_)}return f})();i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(10)),d=l.__importDefault(r(7)),g=l.__importStar(r(1)),m=l.__importDefault(r(33)),_=l.__importDefault(r(2)),C=l.__importDefault(r(54)),E=l.__importDefault(r(9)),R=l.__importDefault(r(39)),v=l.__importStar(r(4)),D=l.__importDefault(r(16)),z=l.__importDefault(r(21)),L=f.default.Action,N=function(){};function M(O){if(O&&"params"in O&&!g.isObject(O.params))return new v.default("options.params must be an object",4e4,400);if(O&&"modes"in O){if(!g.isArray(O.modes))return new v.default("options.modes must be an array",4e4,400);for(var A=0;A<O.modes.length;A++){var y=O.modes[A];if(!y||typeof y!="string"||!g.arrIn(f.default.channelModes,String.prototype.toUpperCase.call(y)))return new v.default("Invalid channel mode: "+y,4e4,400)}}}var G=(function(O){l.__extends(A,O);function A(y,B,U){var P=O.call(this,y,B,U)||this;return P.retryCount=0,P.history=function(Y,K){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),K===void 0)if(typeof Y=="function")K=Y,Y=null;else{if(this.rest.options.promises)return g.promisify(this,"history",arguments);K=N}if(Y&&Y.untilAttach){if(this.state!=="attached"){K(new v.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){K(new v.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete Y.untilAttach,Y.from_serial=this.properties.attachSerial}m.default.prototype._history.call(this,Y,K)},P.whenState=(function(Y,K){return d.default.prototype.whenState.call(P,Y,P.state,K)}),_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel()","started; name = "+B),P.realtime=y,P.presence=new C.default(P),P.connectionManager=y.connection.connectionManager,P.state="initialized",P.subscriptions=new d.default,P.syncChannelSerial=void 0,P.properties={attachSerial:void 0,channelSerial:void 0},P.setOptions(U),P.errorReason=null,P._requestedFlags=null,P._mode=null,P._attachResume=!1,P._decodingContext={channelOptions:P.channelOptions,plugins:y.options.plugins||{},baseEncodedPreviousPayload:void 0},P._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},P._allChannelChanges=new d.default,P}return A.prototype.invalidStateError=function(){return new v.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},A.processListenerArgs=function(y){return y=Array.prototype.slice.call(y),typeof y[0]=="function"&&y.unshift(null),y[y.length-1]==null&&y.pop(),y},A.prototype.setOptions=function(y,B){var U=this.channelOptions;if(!B&&this.rest.options.promises)return g.promisify(this,"setOptions",arguments);var P=B||function(K){K&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+K.toString())},Y=M(y);if(Y){P(Y);return}m.default.prototype.setOptions.call(this,y),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(y,U)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(K){switch(this.event){case"update":case"attached":P==null||P(null);return;default:P==null||P(K.reason);return}})):P()},A.prototype._shouldReattachToSetOptions=function(y,B){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(y!=null&&y.params){var U=w(y.params),P=w(B.params);if(Object.keys(U).length!==Object.keys(P).length||!g.shallowEquals(P,U))return!0}return!!(y!=null&&y.modes&&(!B.modes||!g.arrEquals(y.modes,B.modes)))},A.prototype.publish=function(){for(var y=this,B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];var P=B[0],Y=B.length,K=B[Y-1];if(typeof K!="function"){if(this.realtime.options.promises)return g.promisify(this,"publish",arguments);K=N,++Y}if(!this.connectionManager.activeState()){K(this.connectionManager.getError());return}if(Y==2)if(g.isObject(P))P=[E.default.fromValues(P)];else if(g.isArray(P))P=E.default.fromValuesArray(P);else throw new v.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else P=[E.default.fromValues({name:B[0],data:B[1]})];var Q=this.realtime.options.maxMessageSize;E.default.encodeArray(P,this.channelOptions,function(V){if(V){K(V);return}var j=E.default.getMessagesSize(P);if(j>Q){K(new v.default("Maximum size of messages that can be published at once exceeded ( was "+j+" bytes; limit is "+Q+" bytes)",40009,400));return}y.__publish(P,K)})},A.prototype.__publish=function(y,B){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+y.length);var U=this.state;switch(U){case"failed":case"suspended":B(v.default.fromValues(this.invalidStateError()));break;default:{_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+U);var P=new f.default;P.action=L.MESSAGE,P.channel=this.name,P.messages=y,this.sendMessage(P,B);break}}},A.prototype.onEvent=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var B=this.subscriptions,U=0;U<y.length;U++){var P=y[U];B.emit(P.name,P)}},A.prototype.attach=function(y,B){var U;if(typeof y=="function"?(B=y,U=null):U=y,!B){if(this.realtime.options.promises)return g.promisify(this,"attach",arguments);B=function(P){P&&_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+P.toString())}}if(U)_.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=U;else if(this.state==="attached"){B(null,null);return}this._attach(!1,null,B)},A.prototype._attach=function(y,B,U){U||(U=function(Y){Y&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+Y.toString())});var P=this.connectionManager;if(!P.activeState()){U(P.getError());return}(this.state!=="attaching"||y)&&this.requestState("attaching",B),this.once(function(Y){switch(this.event){case"attached":U==null||U(null,Y);break;case"detached":case"suspended":case"failed":U==null||U(Y.reason||P.getError()||new v.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":U==null||U(new v.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},A.prototype.attachImpl=function(){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var y=f.default.fromValues({action:L.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?y.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&y.encodeModesToFlags(g.allToUpperCase(this.channelOptions.modes)),this._attachResume&&y.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(y.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(y,N)},A.prototype.detach=function(y){if(!y){if(this.realtime.options.promises)return g.promisify(this,"detach",arguments);y=N}var B=this.connectionManager;if(!B.activeState()){y(B.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),y();break;case"detached":y();break;case"failed":y(new v.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(U){switch(this.event){case"detached":y();break;case"attached":case"suspended":case"failed":y(U.reason||B.getError()||new v.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":y(new v.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},A.prototype.detachImpl=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var B=f.default.fromValues({action:L.DETACH,channel:this.name});this.sendMessage(B,y||N)},A.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=A.processListenerArgs(y),P=U[0],Y=U[1],K=U[2];if(!K&&this.realtime.options.promises)return g.promisify(this,"subscribe",[P,Y]);if(this.state==="failed"){K==null||K(v.default.fromValues(this.invalidStateError()));return}return P&&typeof P=="object"&&!Array.isArray(P)?this._subscribeFilter(P,Y):this.subscriptions.on(P,Y),this.attach(K||N)},A.prototype._subscribeFilter=function(y,B){var U=function(P){var Y,K,Q,V,j,I,X={name:P.name,refTimeserial:(K=(Y=P.extras)===null||Y===void 0?void 0:Y.ref)===null||K===void 0?void 0:K.timeserial,refType:(V=(Q=P.extras)===null||Q===void 0?void 0:Q.ref)===null||V===void 0?void 0:V.type,isRef:!!(!((I=(j=P.extras)===null||j===void 0?void 0:j.ref)===null||I===void 0)&&I.timeserial),clientId:P.clientId};Object.entries(y).find(function(W){var at=W[0],J=W[1];return J!==void 0?X[at]!==J:!1})||B(P)};this._addFilteredSubscription(y,B,U),this.subscriptions.on(U)},A.prototype._addFilteredSubscription=function(y,B,U){var P;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(B)){var Y=this.filteredSubscriptions.get(B);Y.set(y,((P=Y==null?void 0:Y.get(y))===null||P===void 0?void 0:P.concat(U))||[U])}else this.filteredSubscriptions.set(B,new Map([[y,[U]]]))},A.prototype._getAndDeleteFilteredSubscriptions=function(y,B){var U=this;if(!this.filteredSubscriptions)return[];if(!B&&y)return Array.from(this.filteredSubscriptions.entries()).map(function(Q){var V,j=Q[0],I=Q[1],X=I.get(y);return I.delete(y),I.size===0&&((V=U.filteredSubscriptions)===null||V===void 0||V.delete(j)),X}).reduce(function(Q,V){var j;return V?(j=Q).concat.apply(j,V):Q},[]);if(!B||!this.filteredSubscriptions.has(B))return[];var P=this.filteredSubscriptions.get(B);if(!y){var Y=Array.from(P.values()).reduce(function(Q,V){return Q.concat.apply(Q,V)},[]);return this.filteredSubscriptions.delete(B),Y}var K=P.get(y);return P.delete(y),K||[]},A.prototype.unsubscribe=function(){for(var y=this,B,U=[],P=0;P<arguments.length;P++)U[P]=arguments[P];var Y=A.processListenerArgs(U),K=Y[0],Q=Y[1];if(typeof K=="object"&&!Q||!((B=this.filteredSubscriptions)===null||B===void 0)&&B.has(Q)){this._getAndDeleteFilteredSubscriptions(K,Q).forEach(function(V){return y.subscriptions.off(V)});return}this.subscriptions.off(K,Q)},A.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new v.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var y=this.connectionManager;if(!y.activeState())throw y.getError();var B=f.default.fromValues({action:L.SYNC,channel:this.name});this.syncChannelSerial&&(B.channelSerial=this.syncChannelSerial),y.send(B)},A.prototype.sendMessage=function(y,B){this.connectionManager.send(y,this.realtime.options.queueMessages,B)},A.prototype.sendPresence=function(y,B){var U=f.default.fromValues({action:L.PRESENCE,channel:this.name,presence:g.isArray(y)?D.default.fromValuesArray(y):[D.default.fromValues(y)]});this.sendMessage(U,B)},A.prototype.onMessage=function(y){(y.action===L.ATTACHED||y.action===L.MESSAGE||y.action===L.PRESENCE)&&this.setChannelSerial(y.channelSerial);var B,U=!1;switch(y.action){case L.ATTACHED:{this.properties.attachSerial=y.channelSerial,this._mode=y.getMode(),this.params=y.params||{};var P=y.decodeModesFromFlags();this.modes=P&&g.allToLowerCase(P)||void 0;var Y=y.hasFlag("RESUMED"),K=y.hasFlag("HAS_PRESENCE"),Q=y.hasFlag("HAS_BACKLOG");if(this.state==="attached"){Y||this.presence.onAttached(K);var V=new R.default(this.state,this.state,Y,Q,y.error);this._allChannelChanges.emit("update",V),(!Y||this.channelOptions.updateOnAttached)&&this.emit("update",V)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",y.error,Y,K,Q);break}case L.DETACHED:{var j=y.error?v.default.fromValues(y.error):new v.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",j):this.state==="attaching"?this.notifyState("suspended",j):this.requestState("attaching",j);break}case L.SYNC:if(U=!0,B=this.syncChannelSerial=y.channelSerial,!y.presence)break;case L.PRESENCE:{for(var I=y.presence,X=y.id,W=y.connectionId,at=y.timestamp,J=this.channelOptions,rt=void 0,it=0;it<I.length;it++)try{rt=I[it],D.default.decode(rt,J),rt.connectionId||(rt.connectionId=W),rt.timestamp||(rt.timestamp=at),rt.id||(rt.id=X+":"+it)}catch(At){_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",At.toString())}this.presence.setPresence(I,U,B);break}case L.MESSAGE:{if(this.state!=="attached"){_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+y.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var q=y.messages,F=q[0],tt=q[q.length-1],X=y.id,W=y.connectionId,at=y.timestamp;if(F.extras&&F.extras.delta&&F.extras.delta.from!==this._lastPayload.messageId){var nt='Delta message decode failure - previous message not available for message "'+y.id+'" on this channel "'+this.name+'".';_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",nt),this._startDecodeFailureRecovery(new v.default(nt,40018,400));break}for(var it=0;it<q.length;it++){var nt=q[it];try{E.default.decode(nt,this._decodingContext)}catch(Gt){switch(_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",Gt.toString()),Gt.code){case 40018:this._startDecodeFailureRecovery(Gt);return;case 40019:case 40021:this.notifyState("failed",Gt);return}}nt.connectionId||(nt.connectionId=W),nt.timestamp||(nt.timestamp=at),nt.id||(nt.id=X+":"+it)}this._lastPayload.messageId=tt.id,this._lastPayload.protocolMessageChannelSerial=y.channelSerial,this.onEvent(q);break}case L.ERROR:{var gt=y.error;gt&&gt.code==80016?this.checkPendingState():this.notifyState("failed",v.default.fromValues(gt));break}default:_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+y.action+")"),this.connectionManager.abort(z.default.unknownChannelErr())}},A.prototype._startDecodeFailureRecovery=function(y){var B=this;this._lastPayload.decodeFailureRecoveryInProgress||(_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,y,function(){B._lastPayload.decodeFailureRecoveryInProgress=!1}))},A.prototype.onAttached=function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},A.prototype.notifyState=function(y,B,U,P,Y){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+y),this.clearStateTimer(),g.arrIn(["detached","suspended","failed"],y)&&(this.properties.channelSerial=null),y!==this.state){this.presence.actOnChannelState(y,P,B),y==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),B&&(this.errorReason=B);var K=new R.default(this.state,y,U,Y,B),Q=y==="failed"?_.default.LOG_ERROR:_.default.LOG_MAJOR;_.default.logAction(Q,'Channel state for channel "'+this.name+'"',y+(B?"; reason: "+B:"")),y!=="attaching"&&y!=="suspended"&&(this.retryCount=0),y==="attached"&&this.onAttached(),y==="attached"?this._attachResume=!0:(y==="detaching"||y==="failed")&&(this._attachResume=!1),this.state=y,this._allChannelChanges.emit(y,K),this.emit(y,K)}},A.prototype.requestState=function(y,B){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+y),this.notifyState(y,B),this.checkPendingState()},A.prototype.checkPendingState=function(){var y=this.connectionManager.state;if(!(y.sendEvents||y.forceQueueEvents)){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},A.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var y=new v.default("Channel attach timed out",90007,408);this.notifyState("suspended",y);break}case"detaching":{var y=new v.default("Channel detach timed out",90007,408);this.notifyState("attached",y);break}default:this.checkPendingState();break}},A.prototype.startStateTimerIfNotRunning=function(){var y=this;this.stateTimer||(this.stateTimer=setTimeout(function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),y.stateTimer=null,y.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},A.prototype.clearStateTimer=function(){var y=this.stateTimer;y&&(clearTimeout(y),this.stateTimer=null)},A.prototype.startRetryTimer=function(){var y=this;if(!this.retryTimer){this.retryCount++;var B=g.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){y.state==="suspended"&&y.connectionManager.state.sendEvents&&(y.retryTimer=null,_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),y.requestState("attaching"))},B)}},A.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},A.prototype.getReleaseErr=function(){var y=this.state;return y==="initialized"||y==="detached"||y==="failed"?null:new v.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+y,90001,400)},A.prototype.setChannelSerial=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+y+"; previous = "+this.properties.channelSerial),y&&(this.properties.channelSerial=y)},A})(m.default);function w(O){var A=O||{};A.agent;var y=l.__rest(A,["agent"]);return y}i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function f(d,g,m,_,C){this.previous=d,this.current=g,g==="attached"&&(this.resumed=m,this.hasBacklog=_),C&&(this.reason=C)}return f})();i.default=l}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=d.Hasher,_=f.algo,C=[],E=_.SHA1=m.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(R,v){for(var D=this._hash.words,z=D[0],L=D[1],N=D[2],M=D[3],G=D[4],w=0;w<80;w++){if(w<16)C[w]=R[v+w]|0;else{var O=C[w-3]^C[w-8]^C[w-14]^C[w-16];C[w]=O<<1|O>>>31}var A=(z<<5|z>>>27)+G+C[w];w<20?A+=(L&N|~L&M)+1518500249:w<40?A+=(L^N^M)+1859775393:w<60?A+=(L&N|L&M|N&M)-1894007588:A+=(L^N^M)-899497514,G=M,M=N,N=L<<30|L>>>2,L=z,z=A}D[0]=D[0]+z|0,D[1]=D[1]+L|0,D[2]=D[2]+N|0,D[3]=D[3]+M|0,D[4]=D[4]+G|0},_doFinalize:function(){var R=this._data,v=R.words,D=this._nDataBytes*8,z=R.sigBytes*8;return v[z>>>5]|=128<<24-z%32,v[(z+64>>>9<<4)+14]=Math.floor(D/4294967296),v[(z+64>>>9<<4)+15]=D,R.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var R=m.clone.call(this);return R._hash=this._hash.clone(),R}});f.SHA1=m._createHelper(E),f.HmacSHA1=m._createHmacHelper(E)})(),l.SHA1})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});function l(w){if(w===void 0)return"undefined";var O,A;if(w instanceof ArrayBuffer?(A="ArrayBuffer",O=new DataView(w)):w instanceof DataView&&(A="DataView",O=w),!O)return JSON.stringify(w);for(var y=[],B=0;B<w.byteLength;B++){if(B>20){y.push("...");break}var U=O.getUint8(B).toString(16);U.length===1&&(U="0"+U),y.push(U)}return"<"+A+" "+y.join(" ")+">"}function f(w,O,A){for(var y=0,B=A.length;y<B;y++){var U=A.charCodeAt(y);if(U<128){w.setUint8(O++,U>>>0&127|0);continue}if(U<2048){w.setUint8(O++,U>>>6&31|192),w.setUint8(O++,U>>>0&63|128);continue}if(U<65536){w.setUint8(O++,U>>>12&15|224),w.setUint8(O++,U>>>6&63|128),w.setUint8(O++,U>>>0&63|128);continue}if(U<1114112){w.setUint8(O++,U>>>18&7|240),w.setUint8(O++,U>>>12&63|128),w.setUint8(O++,U>>>6&63|128),w.setUint8(O++,U>>>0&63|128);continue}throw new Error("bad codepoint "+U)}}function d(w,O,A){for(var y="",B=O,U=O+A;B<U;B++){var P=w.getUint8(B);if((P&128)===0){y+=String.fromCharCode(P);continue}if((P&224)===192){y+=String.fromCharCode((P&15)<<6|w.getUint8(++B)&63);continue}if((P&240)===224){y+=String.fromCharCode((P&15)<<12|(w.getUint8(++B)&63)<<6|(w.getUint8(++B)&63)<<0);continue}if((P&248)===240){y+=String.fromCharCode((P&7)<<18|(w.getUint8(++B)&63)<<12|(w.getUint8(++B)&63)<<6|(w.getUint8(++B)&63)<<0);continue}throw new Error("Invalid byte "+P.toString(16))}return y}function g(w){for(var O=0,A=0,y=w.length;A<y;A++){var B=w.charCodeAt(A);if(B<128){O+=1;continue}if(B<2048){O+=2;continue}if(B<65536){O+=3;continue}if(B<1114112){O+=4;continue}throw new Error("bad codepoint "+B)}return O}function m(w,O){var A=G(w,O);if(A!==0){var y=new ArrayBuffer(A),B=new DataView(y);return M(w,B,0,O),y}}var _=65536*65536,C=1/_;function E(w,O){return O=O||0,w.getInt32(O)*_+w.getUint32(O+4)}function R(w,O){return O=O||0,w.getUint32(O)*_+w.getUint32(O+4)}function v(w,O,A){A<9223372036854776e3?(w.setInt32(O,Math.floor(A*C)),w.setInt32(O+4,A&-1)):(w.setUint32(O,2147483647),w.setUint32(O+4,2147483647))}function D(w,O,A){A<18446744073709552e3?(w.setUint32(O,Math.floor(A*C)),w.setInt32(O+4,A&-1)):(w.setUint32(O,4294967295),w.setUint32(O+4,4294967295))}var z=(function(){function w(O,A){var y=this;this.map=function(B){for(var U={},P=0;P<B;P++){var Y=y.parse();U[Y]=y.parse()}return U},this.bin=function(B){var U=new ArrayBuffer(B);return new Uint8Array(U).set(new Uint8Array(y.view.buffer,y.offset,B),0),y.offset+=B,U},this.buf=this.bin,this.str=function(B){var U=d(y.view,y.offset,B);return y.offset+=B,U},this.array=function(B){for(var U=new Array(B),P=0;P<B;P++)U[P]=y.parse();return U},this.ext=function(B){return y.offset+=B,{type:y.view.getInt8(y.offset),data:y.buf(B)}},this.parse=function(){var B=y.view.getUint8(y.offset),U,P;if((B&128)===0)return y.offset++,B;if((B&240)===128)return P=B&15,y.offset++,y.map(P);if((B&240)===144)return P=B&15,y.offset++,y.array(P);if((B&224)===160)return P=B&31,y.offset++,y.str(P);if((B&224)===224)return U=y.view.getInt8(y.offset),y.offset++,U;switch(B){case 192:return y.offset++,null;case 193:y.offset++;return;case 194:return y.offset++,!1;case 195:return y.offset++,!0;case 196:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.bin(P);case 197:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.bin(P);case 198:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.bin(P);case 199:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.ext(P);case 200:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.ext(P);case 201:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.ext(P);case 202:return U=y.view.getFloat32(y.offset+1),y.offset+=5,U;case 203:return U=y.view.getFloat64(y.offset+1),y.offset+=9,U;case 204:return U=y.view.getUint8(y.offset+1),y.offset+=2,U;case 205:return U=y.view.getUint16(y.offset+1),y.offset+=3,U;case 206:return U=y.view.getUint32(y.offset+1),y.offset+=5,U;case 207:return U=R(y.view,y.offset+1),y.offset+=9,U;case 208:return U=y.view.getInt8(y.offset+1),y.offset+=2,U;case 209:return U=y.view.getInt16(y.offset+1),y.offset+=3,U;case 210:return U=y.view.getInt32(y.offset+1),y.offset+=5,U;case 211:return U=E(y.view,y.offset+1),y.offset+=9,U;case 212:return P=1,y.offset++,y.ext(P);case 213:return P=2,y.offset++,y.ext(P);case 214:return P=4,y.offset++,y.ext(P);case 215:return P=8,y.offset++,y.ext(P);case 216:return P=16,y.offset++,y.ext(P);case 217:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.str(P);case 218:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.str(P);case 219:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.str(P);case 220:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.array(P);case 221:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.array(P);case 222:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.map(P);case 223:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.map(P)}throw new Error("Unknown type 0x"+B.toString(16))},this.offset=A||0,this.view=O}return w})();function L(w){var O=new DataView(w),A=new z(O),y=A.parse();if(A.offset!==w.byteLength)throw new Error(w.byteLength-A.offset+" trailing bytes");return y}function N(w,O){return Object.keys(w).filter(function(A){var y=w[A],B=typeof y;return(!O||y!=null)&&(B!=="function"||!!y.toJSON)})}function M(w,O,A,y){var B=typeof w;if(typeof w=="string"){var U=g(w);if(U<32)return O.setUint8(A,U|160),f(O,A+1,w),1+U;if(U<256)return O.setUint8(A,217),O.setUint8(A+1,U),f(O,A+2,w),2+U;if(U<65536)return O.setUint8(A,218),O.setUint16(A+1,U),f(O,A+3,w),3+U;if(U<4294967296)return O.setUint8(A,219),O.setUint32(A+1,U),f(O,A+5,w),5+U}if(ArrayBuffer.isView&&ArrayBuffer.isView(w)&&(w=w.buffer),w instanceof ArrayBuffer){var P=w.byteLength;if(P<256)return O.setUint8(A,196),O.setUint8(A+1,P),new Uint8Array(O.buffer).set(new Uint8Array(w),A+2),2+P;if(P<65536)return O.setUint8(A,197),O.setUint16(A+1,P),new Uint8Array(O.buffer).set(new Uint8Array(w),A+3),3+P;if(P<4294967296)return O.setUint8(A,198),O.setUint32(A+1,P),new Uint8Array(O.buffer).set(new Uint8Array(w),A+5),5+P}if(typeof w=="number"){if(Math.floor(w)!==w)return O.setUint8(A,203),O.setFloat64(A+1,w),9;if(w>=0){if(w<128)return O.setUint8(A,w),1;if(w<256)return O.setUint8(A,204),O.setUint8(A+1,w),2;if(w<65536)return O.setUint8(A,205),O.setUint16(A+1,w),3;if(w<4294967296)return O.setUint8(A,206),O.setUint32(A+1,w),5;if(w<18446744073709552e3)return O.setUint8(A,207),D(O,A+1,w),9;throw new Error("Number too big 0x"+w.toString(16))}if(w>=-32)return O.setInt8(A,w),1;if(w>=-128)return O.setUint8(A,208),O.setInt8(A+1,w),2;if(w>=-32768)return O.setUint8(A,209),O.setInt16(A+1,w),3;if(w>=-2147483648)return O.setUint8(A,210),O.setInt32(A+1,w),5;if(w>=-9223372036854776e3)return O.setUint8(A,211),v(O,A+1,w),9;throw new Error("Number too small -0x"+(-w).toString(16).substr(1))}if(B==="undefined")return y?0:(O.setUint8(A,212),O.setUint8(A+1,0),O.setUint8(A+2,0),3);if(w===null)return y?0:(O.setUint8(A,192),1);if(B==="boolean")return O.setUint8(A,w?195:194),1;if(typeof w.toJSON=="function")return M(w.toJSON(),O,A,y);if(B==="object"){var Y,K=0,Q=void 0,V=Array.isArray(w);if(V?Y=w.length:(Q=N(w,y),Y=Q.length),Y<16?(O.setUint8(A,Y|(V?144:128)),K=1):Y<65536?(O.setUint8(A,V?220:222),O.setUint16(A+1,Y),K=3):Y<4294967296&&(O.setUint8(A,V?221:223),O.setUint32(A+1,Y),K=5),V)for(var j=0;j<Y;j++)K+=M(w[j],O,A+K,y);else if(Q)for(var j=0;j<Y;j++){var I=Q[j];K+=M(I,O,A+K),K+=M(w[I],O,A+K,y)}return K}if(B==="function")return 0;throw new Error("Unknown type "+B)}function G(w,O){var A=typeof w;if(A==="string"){var y=g(w);if(y<32)return 1+y;if(y<256)return 2+y;if(y<65536)return 3+y;if(y<4294967296)return 5+y}if(ArrayBuffer.isView&&ArrayBuffer.isView(w)&&(w=w.buffer),w instanceof ArrayBuffer){var B=w.byteLength;if(B<256)return 2+B;if(B<65536)return 3+B;if(B<4294967296)return 5+B}if(typeof w=="number"){if(Math.floor(w)!==w)return 9;if(w>=0){if(w<128)return 1;if(w<256)return 2;if(w<65536)return 3;if(w<4294967296)return 5;if(w<18446744073709552e3)return 9;throw new Error("Number too big 0x"+w.toString(16))}if(w>=-32)return 1;if(w>=-128)return 2;if(w>=-32768)return 3;if(w>=-2147483648)return 5;if(w>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+w.toString(16).substr(1))}if(A==="boolean")return 1;if(w===null)return O?0:1;if(w===void 0)return O?0:3;if(typeof w.toJSON=="function")return G(w.toJSON(),O);if(A==="object"){var U,P=0;if(Array.isArray(w)){U=w.length;for(var Y=0;Y<U;Y++)P+=G(w[Y],O)}else{var K=N(w,O);U=K.length;for(var Y=0;Y<U;Y++){var Q=K[Y];P+=G(Q)+G(w[Q],O)}}if(U<16)return 1+P;if(U<65536)return 3+P;if(U<4294967296)return 5+P;throw new Error("Array or object too long 0x"+U.toString(16))}if(A==="function")return 0;throw new Error("Unknown type "+A)}i.default={encode:m,decode:L,inspect:l,utf8Write:f,utf8Read:d,utf8ByteCount:g}}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(30)),d=l.__importDefault(r(50)),g=l.__importDefault(r(3)),m=l.__importDefault(r(4)),_=l.__importDefault(r(55)),C=l.__importDefault(r(57)),E=l.__importDefault(r(62)),R=l.__importDefault(r(64)),v=l.__importDefault(r(68)),D=l.__importDefault(r(2)),z=r(8),L=l.__importDefault(r(65)),N=l.__importDefault(r(66)),M=l.__importDefault(r(41)),G=(0,C.default)(R.default,_.default);g.default.Crypto=G,g.default.BufferUtils=_.default,g.default.Http=E.default,g.default.Config=R.default,g.default.Transports=v.default,g.default.WebStorage=L.default,f.default.Crypto=G,d.default.Crypto=G,D.default.initLogHandlers(),g.default.Defaults=(0,z.getDefaults)(N.default),g.default.Config.agent&&(g.default.Defaults.agent+=" "+g.default.Config.agent),g.default.Config.noUpgrade&&(g.default.Defaults.upgradeTransports=[]),i.default={ErrorInfo:m.default,Rest:f.default,Realtime:d.default,msgpack:M.default}}),(function(n){n.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')}),(function(n,i){}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(32),r(25))})(this,function(l){return l.HmacSHA256})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(47)),g=l.__importDefault(r(15)),m=l.__importDefault(r(20)),_=l.__importDefault(r(4)),C=l.__importDefault(r(48)),E=function(){},R=(function(){function L(N){this.rest=N,this.admin=new v(N)}return L})(),v=(function(){function L(N){this.rest=N,this.deviceRegistrations=new D(N),this.channelSubscriptions=new z(N)}return L.prototype.publish=function(N,M,G){var w=this.rest,O=w.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultPostHeaders(w.options,O),y={},B=f.mixin({recipient:N},M);if(typeof G!="function"){if(this.rest.options.promises)return f.promisify(this,"publish",arguments);G=E}w.options.headers&&f.mixin(A,w.options.headers),w.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var U=f.encodeBody(B,O);g.default.post(w,"/push/publish",U,A,y,null,function(P){return G(P)})},L})(),D=(function(){function L(N){this.rest=N}return L.prototype.save=function(N,M){var G=this.rest,w=d.default.fromValues(N),O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultPostHeaders(G.options,O),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}G.options.headers&&f.mixin(A,G.options.headers),G.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var B=f.encodeBody(w,O);g.default.put(G,"/push/deviceRegistrations/"+encodeURIComponent(N.id),B,A,y,null,function(U,P,Y,K){M(U,U?void 0:d.default.fromResponseBody(P,K?void 0:O))})},L.prototype.get=function(N,M){var G=this.rest,w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=f.defaultGetHeaders(G.options,w),A=N.id||N;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"get",arguments);M=E}if(typeof A!="string"||!A.length){M(new _.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&f.mixin(O,G.options.headers),g.default.get(G,"/push/deviceRegistrations/"+encodeURIComponent(A),O,{},null,function(y,B,U,P){M(y,y?void 0:d.default.fromResponseBody(B,P?void 0:w))})},L.prototype.list=function(N,M){var G=this.rest,w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=this.rest.http.supportsLinkHeaders?void 0:w,A=f.defaultGetHeaders(G.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}G.options.headers&&f.mixin(A,G.options.headers),new m.default(G,"/push/deviceRegistrations",A,O,function(y,B,U){return d.default.fromResponseBody(y,U?void 0:w)}).get(N,M)},L.prototype.remove=function(N,M){var G=this.rest,w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=f.defaultGetHeaders(G.options,w),A={},y=N.id||N;if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"remove",arguments);M=E}if(typeof y!="string"||!y.length){M(new _.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&f.mixin(O,G.options.headers),G.options.pushFullWait&&f.mixin(A,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations/"+encodeURIComponent(y),O,A,null,function(B){return M(B)})},L.prototype.removeWhere=function(N,M){var G=this.rest,w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=f.defaultGetHeaders(G.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}G.options.headers&&f.mixin(O,G.options.headers),G.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations",O,N,null,function(A){return M(A)})},L})(),z=(function(){function L(N){this.remove=L.prototype.removeWhere,this.rest=N}return L.prototype.save=function(N,M){var G=this.rest,w=C.default.fromValues(N),O=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,A=f.defaultPostHeaders(G.options,O),y={};if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"save",arguments);M=E}G.options.headers&&f.mixin(A,G.options.headers),G.options.pushFullWait&&f.mixin(y,{fullWait:"true"});var B=f.encodeBody(w,O);g.default.post(G,"/push/channelSubscriptions",B,A,y,null,function(U,P,Y,K){M(U,!U&&C.default.fromResponseBody(P,K?void 0:O))})},L.prototype.list=function(N,M){var G=this.rest,w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=this.rest.http.supportsLinkHeaders?void 0:w,A=f.defaultGetHeaders(G.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"list",arguments);M=E}G.options.headers&&f.mixin(A,G.options.headers),new m.default(G,"/push/channelSubscriptions",A,O,function(y,B,U){return C.default.fromResponseBody(y,U?void 0:w)}).get(N,M)},L.prototype.removeWhere=function(N,M){var G=this.rest,w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=f.defaultGetHeaders(G.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"removeWhere",arguments);M=E}G.options.headers&&f.mixin(O,G.options.headers),G.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),g.default.delete(G,"/push/channelSubscriptions",O,N,null,function(A){return M(A)})},L.prototype.listChannels=function(N,M){var G=this.rest,w=G.options.useBinaryProtocol?f.Format.msgpack:f.Format.json,O=this.rest.http.supportsLinkHeaders?void 0:w,A=f.defaultGetHeaders(G.options,w);if(typeof M!="function"){if(this.rest.options.promises)return f.promisify(this,"listChannels",arguments);M=E}G.options.headers&&f.mixin(A,G.options.headers),G.options.pushFullWait&&f.mixin(N,{fullWait:"true"}),new m.default(G,"/push/channels",A,O,function(y,B,U){for(var P=!U&&w?f.decodeBody(y,w):y,Y=0;Y<P.length;Y++)P[Y]=String(P[Y]);return P}).get(N,M)},L})();i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(4)),g;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(g||(g={}));var m;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(m||(m={}));var _=(function(){function C(){}return C.prototype.toJSON=function(){var E,R,v;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(R=this.push)===null||R===void 0?void 0:R.state,error:(v=this.push)===null||v===void 0?void 0:v.error}}},C.prototype.toString=function(){var E,R,v,D,z="[DeviceDetails";return this.id&&(z+="; id="+this.id),this.platform&&(z+="; platform="+this.platform),this.formFactor&&(z+="; formFactor="+this.formFactor),this.clientId&&(z+="; clientId="+this.clientId),this.metadata&&(z+="; metadata="+this.metadata),this.deviceIdentityToken&&(z+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(z+="; push.recipient="+JSON.stringify(this.push.recipient)),!((R=this.push)===null||R===void 0)&&R.state&&(z+="; push.state="+this.push.state),!((v=this.push)===null||v===void 0)&&v.error&&(z+="; push.error="+JSON.stringify(this.push.error)),!((D=this.push)===null||D===void 0)&&D.metadata&&(z+="; push.metadata="+this.push.metadata),z+="]",z},C.fromResponseBody=function(E,R){return R&&(E=f.decodeBody(E,R)),f.isArray(E)?C.fromValuesArray(E):C.fromValues(E)},C.fromValues=function(E){return E.error=E.error&&d.default.fromValues(E.error),Object.assign(new C,E)},C.fromValuesArray=function(E){for(var R=E.length,v=new Array(R),D=0;D<R;D++)v[D]=C.fromValues(E[D]);return v},C.toRequestBody=f.encodeBody,C})();i.default=_}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=(function(){function g(){}return g.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},g.prototype.toString=function(){var m="[PushChannelSubscription";return this.channel&&(m+="; channel="+this.channel),this.deviceId&&(m+="; deviceId="+this.deviceId),this.clientId&&(m+="; clientId="+this.clientId),m+="]",m},g.fromResponseBody=function(m,_){return _&&(m=f.decodeBody(m,_)),f.isArray(m)?g.fromValuesArray(m):g.fromValues(m)},g.fromValues=function(m){return Object.assign(new g,m)},g.fromValuesArray=function(m){for(var _=m.length,C=new Array(_),E=0;E<_;E++)C[E]=g.fromValues(m[E]);return C},g.toRequestBody=f.encodeBody,g})();i.default=d}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=(function(){function G(w){this.count=w&&w.count||0,this.data=w&&w.data||0,this.uncompressedData=w&&w.uncompressedData||0,this.failed=w&&w.failed||0,this.refused=w&&w.refused||0}return G})(),g=(function(G){l.__extends(w,G);function w(O){var A=G.call(this,O)||this;return O&&O.category&&(A.category={},f.forInOwnNonNullProperties(O.category,function(y){A.category[y]=new d(O.category[y])})),A}return w})(d),m=(function(){function G(w){this.peak=w&&w.peak||0,this.min=w&&w.min||0,this.mean=w&&w.mean||0,this.opened=w&&w.opened||0,this.refused=w&&w.refused||0}return G})(),_=(function(){function G(w){this.succeeded=w&&w.succeeded||0,this.failed=w&&w.failed||0,this.refused=w&&w.refused||0}return G})(),C=(function(){function G(w){this.plain=new m(w&&w.plain),this.tls=new m(w&&w.tls),this.all=new m(w&&w.all)}return G})(),E=(function(){function G(w){this.messages=new g(w&&w.messages),this.presence=new g(w&&w.presence),this.all=new g(w&&w.all)}return G})(),R=(function(){function G(w){this.realtime=new E(w&&w.realtime),this.rest=new E(w&&w.rest),this.webhook=new E(w&&w.webhook),this.sharedQueue=new E(w&&w.sharedQueue),this.externalQueue=new E(w&&w.externalQueue),this.httpEvent=new E(w&&w.httpEvent),this.push=new E(w&&w.push),this.all=new E(w&&w.all)}return G})(),v=(function(){function G(w){this.all=new E(w&&w.all),this.inbound=new R(w&&w.inbound),this.outbound=new R(w&&w.outbound)}return G})(),D=(function(){function G(w){this.all=new E(w&&w.all),this.producerPaid=new v(w&&w.producerPaid),this.consumerPaid=new v(w&&w.consumerPaid)}return G})(),z=(function(){function G(w){this.messages=w&&w.messages||0;var O=w&&w.notifications;this.notifications={invalid:O&&O.invalid||0,attempted:O&&O.attempted||0,successful:O&&O.successful||0,failed:O&&O.failed||0},this.directPublishes=w&&w.directPublishes||0}return G})(),L=(function(){function G(w){this.succeeded=w&&w.succeeded||0,this.skipped=w&&w.skipped||0,this.failed=w&&w.failed||0}return G})(),N=(function(){function G(w){var O=this;this.delta=void 0,w&&w.delta&&(this.delta={},f.forInOwnNonNullProperties(w.delta,function(A){O.delta[A]=new L(w.delta[A])}))}return G})(),M=(function(G){l.__extends(w,G);function w(O){var A=G.call(this,O)||this;return A.persisted=new E(O&&O.persisted),A.connections=new C(O&&O.connections),A.channels=new m(O&&O.channels),A.apiRequests=new _(O&&O.apiRequests),A.tokenRequests=new _(O&&O.tokenRequests),A.xchgProducer=new D(O&&O.xchgProducer),A.xchgConsumer=new D(O&&O.xchgConsumer),A.push=new z(O&&O.pushStats),A.processed=new N(O&&O.processed),A.inProgress=O&&O.inProgress||void 0,A.unit=O&&O.unit||void 0,A.intervalId=O&&O.intervalId||void 0,A}return w.fromValues=function(O){return new w(O)},w})(v);i.default=M}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(30)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(51)),C=l.__importDefault(r(38)),E=l.__importDefault(r(8)),R=l.__importDefault(r(4)),v=l.__importDefault(r(10)),D=l.__importDefault(r(35)),z=l.__importDefault(r(3)),L=l.__importDefault(r(9)),N=(function(G){l.__extends(w,G);function w(O){var A=G.call(this,O)||this;return m.default.logAction(m.default.LOG_MINOR,"Realtime()",""),A.connection=new _.default(A,A.options),A.channels=new M(A),O.autoConnect!==!1&&A.connect(),A}return w.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},w.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},w.Promise=function(O){return O=E.default.objectifyOptions(O),O.promises=!0,new w(O)},w.Callbacks=w,w.Utils=f,w.ConnectionManager=D.default,w.Platform=z.default,w.ProtocolMessage=v.default,w.Message=L.default,w})(d.default),M=(function(G){l.__extends(w,G);function w(O){var A=G.call(this)||this;return A.realtime=O,A.all=Object.create(null),O.connection.connectionManager.on("transport.active",function(){A.onTransportActive()}),A}return w.prototype.channelSerials=function(){for(var O={},A=0,y=f.keysArray(this.all,!0);A<y.length;A++){var B=y[A],U=this.all[B];U.properties.channelSerial&&(O[B]=U.properties.channelSerial)}return O},w.prototype.recoverChannels=function(O){for(var A=0,y=f.keysArray(O,!0);A<y.length;A++){var B=y[A],U=this.get(B);U.properties.channelSerial=O[B]}},w.prototype.onChannelMessage=function(O){var A=O.channel;if(A===void 0){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+O.action);return}var y=this.all[A];if(!y){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+A);return}y.onMessage(O)},w.prototype.onTransportActive=function(){for(var O in this.all){var A=this.all[O];A.state==="attaching"||A.state==="detaching"?A.checkPendingState():A.state==="suspended"?A._attach(!1,null):A.state==="attached"&&A.requestState("attaching")}},w.prototype.propogateConnectionInterruption=function(O,A){var y={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},B=["attaching","attached","detaching","suspended"],U=y[O];for(var P in this.all){var Y=this.all[P];f.arrIn(B,Y.state)&&Y.notifyState(U,A)}},w.prototype.get=function(O,A){O=String(O);var y=this.all[O];if(!y)y=this.all[O]=new C.default(this.realtime,O,A);else if(A){if(y._shouldReattachToSetOptions(A,y.channelOptions))throw new R.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);y.setOptions(A)}return y},w.prototype.getDerived=function(O,A,y){if(A.filter){var B=f.toBase64(A.filter),U=f.matchDerivedChannel(O);O="[filter=".concat(B).concat(U.qualifierParam,"]").concat(U.channelName)}return this.get(O,y)},w.prototype.release=function(O){O=String(O);var A=this.all[O];if(A){var y=A.getReleaseErr();if(y)throw y;delete this.all[O]}},w})(g.default);i.default=N}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(35)),m=l.__importDefault(r(2)),_=l.__importDefault(r(37)),C=l.__importDefault(r(3));function E(){}var R=(function(v){l.__extends(D,v);function D(z,L){var N=v.call(this)||this;return N.whenState=(function(M,G){return d.default.prototype.whenState.call(N,M,N.state,G,new _.default(void 0,M))}),N.ably=z,N.connectionManager=new g.default(z,L),N.state=N.connectionManager.state.state,N.key=void 0,N.id=void 0,N.errorReason=null,N.connectionManager.on("connectionstate",function(M){var G=N.state=M.current;C.default.Config.nextTick(function(){N.emit(G,M)})}),N.connectionManager.on("update",function(M){C.default.Config.nextTick(function(){N.emit("update",M)})}),N}return D.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},D.prototype.ping=function(z){if(m.default.logAction(m.default.LOG_MINOR,"Connection.ping()",""),!z){if(this.ably.options.promises)return f.promisify(this,"ping",arguments);z=E}this.connectionManager.ping(null,z)},D.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(D.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),D.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},D})(d.default);i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.PendingMessage=void 0;var l=r(0),f=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(36)),C=l.__importDefault(r(4)),E=f.default.Action,R=(function(){function D(z,L){this.message=z,this.callback=L,this.merged=!1;var N=z.action;this.sendAttempted=!1,this.ackRequired=N==E.MESSAGE||N==E.PRESENCE}return D})();i.PendingMessage=R;var v=(function(D){l.__extends(z,D);function z(L){var N=D.call(this)||this;return N.transport=L,N.messageQueue=new _.default,L.on("ack",function(M,G){N.onAck(M,G)}),L.on("nack",function(M,G,w){N.onNack(M,G,w)}),N}return z.prototype.onAck=function(L,N){m.default.logAction(m.default.LOG_MICRO,"Protocol.onAck()","serial = "+L+"; count = "+N),this.messageQueue.completeMessages(L,N)},z.prototype.onNack=function(L,N,M){m.default.logAction(m.default.LOG_ERROR,"Protocol.onNack()","serial = "+L+"; count = "+N+"; err = "+d.inspectError(M)),M||(M=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(L,N,M)},z.prototype.onceIdle=function(L){var N=this.messageQueue;if(N.count()===0){L();return}N.once("idle",L)},z.prototype.send=function(L){L.ackRequired&&this.messageQueue.push(L),m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Protocol.send()","sending msg; "+f.default.stringify(L.message)),L.sendAttempted=!0,this.transport.send(L.message)},z.prototype.getTransport=function(){return this.transport},z.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},z.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},z.prototype.finish=function(){var L=this.transport;this.onceIdle(function(){L.disconnect()})},z})(g.default);i.default=v}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(26)),m=l.__importDefault(r(8)),_=l.__importDefault(r(2)),C=l.__importDefault(r(10)),E=l.__importDefault(r(4)),R="web_socket";function v(L){return!!L.on}var D=(function(L){l.__extends(N,L);function N(M,G,w){var O=L.call(this,M,G,w)||this;return O.shortName=R,w.heartbeats=f.default.Config.useProtocolHeartbeats,O.wsHost=m.default.getHost(w.options,w.host,!0),O}return N.isAvailable=function(){return!!f.default.Config.WebSocket},N.prototype.createWebSocket=function(M,G){return this.uri=M+d.toQueryString(G),new f.default.Config.WebSocket(this.uri)},N.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},N.prototype.connect=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),g.default.prototype.connect.call(this);var M=this,G=this.params,w=G.options,O=w.tls?"wss://":"ws://",A=O+this.wsHost+":"+m.default.getPort(w)+"/";_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+A),this.auth.getAuthParams(function(y,B){if(!M.isDisposed){var U="";for(var P in B)U+=" "+P+": "+B[P]+";";if(_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+U+" err: "+y),y){M.disconnect(y);return}var Y=G.getConnectParams(B);try{var K=M.wsConnection=M.createWebSocket(A,Y);K.binaryType=f.default.Config.binaryType,K.onopen=function(){M.onWsOpen()},K.onclose=function(Q){M.onWsClose(Q)},K.onmessage=function(Q){M.onWsData(Q.data)},K.onerror=function(Q){M.onWsError(Q)},v(K)&&K.on("ping",function(){M.onActivity()})}catch(Q){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(Q.stack||Q.message)),M.disconnect(Q)}}})},N.prototype.send=function(M){var G=this.wsConnection;if(!G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{G.send(C.default.serialize(M,this.params.format))}catch(O){var w="Exception from ws connection when trying to send: "+d.inspectError(O);_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()",w),this.finish("disconnected",new E.default(w,5e4,500))}},N.prototype.onWsData=function(M){_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+M.length+"; type = "+typeof M);try{this.onProtocolMessage(C.default.deserialize(M,this.format))}catch(G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+G.stack)}},N.prototype.onWsOpen=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},N.prototype.onWsClose=function(M){var G,w;if(typeof M=="object"?(w=M.code,G=M.wasClean||w===1e3):(w=M,G=w==1e3),delete this.wsConnection,G){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var O=new E.default("Websocket closed",80003,400);this.finish("disconnected",O)}else{var A="Unclean disconnection of WebSocket ; code = "+w,O=new E.default(A,80003,400);_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()",A),this.finish("disconnected",O)}this.emit("disposed")},N.prototype.onWsError=function(M){var G=this;_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+M.message),f.default.Config.nextTick(function(){G.disconnect(Error(M.message))})},N.prototype.dispose=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var M=this.wsConnection;M&&(M.onmessage=function(){},delete this.wsConnection,f.default.Config.nextTick(function(){if(_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!M)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");M.close()}))},N})(g.default);function z(L){return D.isAvailable()&&(L.supportedTransports[R]=D),D}i.default=z}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(1)),d=l.__importDefault(r(34)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(16)),C=l.__importStar(r(4)),E=l.__importDefault(r(38)),R=l.__importDefault(r(24)),v=l.__importDefault(r(39)),D=function(){};function z(O){return O.channel.realtime.auth.clientId}function L(O){var A=O.channel.realtime,y=A.auth.clientId;return(!y||y==="*")&&A.connection.state==="connected"}function N(O,A,y){switch(O.state){case"attached":case"suspended":y();break;case"initialized":case"detached":case"detaching":case"attaching":O.attach(function(B){B?A(B):y()});break;default:A(C.default.fromValues(O.invalidStateError()))}}function M(O,A){if(O.isSynthesized()||A.isSynthesized())return O.timestamp>=A.timestamp;var y=O.parseId(),B=A.parseId();return y.msgSerial===B.msgSerial?y.index>B.index:y.msgSerial>B.msgSerial}var G=(function(O){l.__extends(A,O);function A(y){var B=O.call(this,y)||this;return B.channel=y,B.syncComplete=!1,B.members=new w(B,function(U){return U.clientId+":"+U.connectionId}),B._myMembers=new w(B,function(U){return U.clientId}),B.subscriptions=new g.default,B.pendingPresence=[],B}return A.prototype.enter=function(y,B){if(L(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"enter",B)},A.prototype.update=function(y,B){if(L(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"update",B)},A.prototype.enterClient=function(y,B,U){return this._enterOrUpdateClient(void 0,y,B,"enter",U)},A.prototype.updateClient=function(y,B,U){return this._enterOrUpdateClient(void 0,y,B,"update",U)},A.prototype._enterOrUpdateClient=function(y,B,U,P,Y){var K=this;if(!Y)if(typeof U=="function")Y=U,U=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"_enterOrUpdateClient",[y,B,U,P]);Y=D}var Q=this.channel;if(!Q.connectionManager.activeState()){Y(Q.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence."+P+"Client()","channel = "+Q.name+", id = "+y+", client = "+(B||"(implicit) "+z(this)));var V=_.default.fromData(U);V.action=P,y&&(V.id=y),B&&(V.clientId=B),_.default.encode(V,Q.channelOptions,function(j){if(j){Y(j);return}switch(Q.state){case"attached":Q.sendPresence(V,Y);break;case"initialized":case"detached":Q.attach();case"attaching":K.pendingPresence.push({presence:V,callback:Y});break;default:j=new C.PartialErrorInfo("Unable to "+P+" presence channel while in "+Q.state+" state",90001),j.code=90001,Y(j)}})},A.prototype.leave=function(y,B){if(L(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,y,B)},A.prototype.leaveClient=function(y,B,U){if(!U)if(typeof B=="function")U=B,B=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"leaveClient",[y,B]);U=D}var P=this.channel;if(!P.connectionManager.activeState()){U==null||U(P.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+y);var Y=_.default.fromData(B);switch(Y.action="leave",y&&(Y.clientId=y),P.state){case"attached":P.sendPresence(Y,U);break;case"attaching":this.pendingPresence.push({presence:Y,callback:U});break;case"initialized":case"failed":{var K=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);U==null||U(K);break}default:U==null||U(P.invalidStateError())}},A.prototype.get=function(y,B){var U=this,P=Array.prototype.slice.call(arguments);P.length==1&&typeof P[0]=="function"&&P.unshift(null),y=P[0],B=P[1];var Y=!y||("waitForSync"in y?y.waitForSync:!0);if(!B){if(this.channel.realtime.options.promises)return f.promisify(this,"get",P);B=D}function K(Q){B(null,y?Q.list(y):Q.values())}if(this.channel.state==="suspended"){Y?B(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):K(this.members);return}N(this.channel,B,function(){var Q=U.members;Y?Q.waitSync(function(){K(Q)}):K(Q)})},A.prototype.history=function(y,B){if(m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.channel.realtime.options.promises)return f.promisify(this,"history",arguments);B=D}y&&y.untilAttach&&(this.channel.state==="attached"?(delete y.untilAttach,y.from_serial=this.channel.properties.attachSerial):B(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),d.default.prototype._history.call(this,y,B)},A.prototype.setPresence=function(y,B,U){m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+y.length+" participants; syncChannelSerial = "+U);var P,Y,K=this.members,Q=this._myMembers,V=[],j=this.channel.connectionManager.connectionId;B&&(this.members.startSync(),U&&(Y=U.match(/^[\w-]+:(.*)$/))&&(P=Y[1]));for(var I=0;I<y.length;I++){var X=_.default.fromValues(y[I]);switch(X.action){case"leave":K.remove(X)&&V.push(X),X.connectionId===j&&!X.isSynthesized()&&Q.remove(X);break;case"enter":case"present":case"update":K.put(X)&&V.push(X),X.connectionId===j&&Q.put(X);break}}B&&!P&&(K.endSync(),this.channel.syncChannelSerial=null);for(var I=0;I<V.length;I++){var X=V[I];this.subscriptions.emit(X.action,X)}},A.prototype.onAttached=function(y){m.default.logAction(m.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+y),y?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var B=this.pendingPresence,U=B.length;if(U){this.pendingPresence=[];var P=[],Y=R.default.create();m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+U+" queued presence messages");for(var K=0;K<U;K++){var Q=B[K];P.push(Q.presence),Y.push(Q.callback)}this.channel.sendPresence(P,Y)}},A.prototype.actOnChannelState=function(y,B,U){switch(y){case"attached":this.onAttached(B);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(U);break}},A.prototype.failPendingPresence=function(y){if(this.pendingPresence.length){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+f.inspectError(y));for(var B=0;B<this.pendingPresence.length;B++)try{this.pendingPresence[B].callback(y)}catch{}this.pendingPresence=[]}},A.prototype._clearMyMembers=function(){this._myMembers.clear()},A.prototype._ensureMyMembersPresent=function(){var y=this,B=this._myMembers,U=function(K){if(K){var Q="Presence auto-re-enter failed: "+K.toString(),V=new C.default(Q,91004,400);m.default.logAction(m.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",Q);var j=new v.default(y.channel.state,y.channel.state,!0,!1,V);y.channel.emit("update",j)}};for(var P in B.map){var Y=B.map[P];m.default.logAction(m.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+Y.clientId+'" into the presence set'),this._enterOrUpdateClient(Y.id,Y.clientId,Y.data,"enter",U)}},A.prototype._synthesizeLeaves=function(y){var B=this.subscriptions;f.arrForEach(y,function(U){var P=_.default.fromValues({action:"leave",connectionId:U.connectionId,clientId:U.clientId,data:U.data,encoding:U.encoding,timestamp:f.now()});B.emit("leave",P)})},A.prototype.on=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,y)},A.prototype.off=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,y)},A.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=E.default.processListenerArgs(y),P=U[0],Y=U[1],K=U[2],Q=this.channel;if(!K){if(this.channel.realtime.options.promises)return f.promisify(this,"subscribe",[P,Y]);K=D}if(Q.state==="failed"){K(C.default.fromValues(Q.invalidStateError()));return}this.subscriptions.on(P,Y),Q.attach(K)},A.prototype.unsubscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var U=E.default.processListenerArgs(y),P=U[0],Y=U[1];this.subscriptions.off(P,Y)},A})(d.default),w=(function(O){l.__extends(A,O);function A(y,B){var U=O.call(this)||this;return U.presence=y,U.map=Object.create(null),U.syncInProgress=!1,U.residualMembers=null,U.memberKey=B,U}return A.prototype.get=function(y){return this.map[y]},A.prototype.getClient=function(y){var B=this.map,U=[];for(var P in B){var Y=B[P];Y.clientId==y&&Y.action!="absent"&&U.push(Y)}return U},A.prototype.list=function(y){var B=this.map,U=y&&y.clientId,P=y&&y.connectionId,Y=[];for(var K in B){var Q=B[K];Q.action!=="absent"&&(U&&U!=Q.clientId||P&&P!=Q.connectionId||Y.push(Q))}return Y},A.prototype.put=function(y){(y.action==="enter"||y.action==="update")&&(y=_.default.fromValues(y),y.action="present");var B=this.map,U=this.memberKey(y);this.residualMembers&&delete this.residualMembers[U];var P=B[U];return P&&!M(y,P)?!1:(B[U]=y,!0)},A.prototype.values=function(){var y=this.map,B=[];for(var U in y){var P=y[U];P.action!="absent"&&B.push(P)}return B},A.prototype.remove=function(y){var B=this.map,U=this.memberKey(y),P=B[U];return P&&!M(y,P)?!1:(this.syncInProgress?(y=_.default.fromValues(y),y.action="absent",B[U]=y):delete B[U],!0)},A.prototype.startSync=function(){var y=this.map,B=this.syncInProgress;m.default.logAction(m.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),this.syncInProgress||(this.residualMembers=f.copy(y),this.setInProgress(!0))},A.prototype.endSync=function(){var y=this.map,B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),B){for(var U in y){var P=y[U];P.action==="absent"&&delete y[U]}this.presence._synthesizeLeaves(f.valuesArray(this.residualMembers));for(var U in this.residualMembers)delete y[U];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},A.prototype.waitSync=function(y){var B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),!B){y();return}this.once("sync",y)},A.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},A.prototype.setInProgress=function(y){m.default.logAction(m.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+y),this.syncInProgress=y,this.presence.syncComplete=!y},A})(g.default);i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=r(56),d=r(31),g=r(11),m=l.__importDefault(r(5)),_=l.__importDefault(r(3)),C=(function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(R){return R!=null&&R.sigBytes!==void 0},E.prototype.isArrayBuffer=function(R){return R!=null&&R.constructor===ArrayBuffer},E.prototype.isTypedArray=function(R){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(R)},E.prototype.uint8ViewToBase64=function(R){for(var v="",D=this.base64CharSet,z=R.byteLength,L=z%3,N=z-L,M,G,w,O,A,y=0;y<N;y=y+3)A=R[y]<<16|R[y+1]<<8|R[y+2],M=(A&16515072)>>18,G=(A&258048)>>12,w=(A&4032)>>6,O=A&63,v+=D[M]+D[G]+D[w]+D[O];return L==1?(A=R[N],M=(A&252)>>2,G=(A&3)<<4,v+=D[M]+D[G]+"=="):L==2&&(A=R[N]<<8|R[N+1],M=(A&64512)>>10,G=(A&1008)>>4,w=(A&15)<<2,v+=D[M]+D[G]+D[w]+"="),v},E.prototype.base64ToArrayBuffer=function(R){for(var v=atob==null?void 0:atob(R),D=v.length,z=new Uint8Array(D),L=0;L<D;L++){var N=v.charCodeAt(L);z[L]=N}return z.buffer},E.prototype.isBuffer=function(R){return this.isArrayBuffer(R)||this.isWordArray(R)||this.isTypedArray(R)},E.prototype.toBuffer=function(R){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(R))return new Uint8Array(R);if(this.isTypedArray(R))return new Uint8Array(R.buffer);if(this.isWordArray(R)){for(var v=new ArrayBuffer(R.sigBytes),D=new Uint8Array(v),z=0;z<R.sigBytes;z++)D[z]=R.words[z>>>2]>>>24-z%4*8&255;return D}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(R){return this.isArrayBuffer(R)?R:this.toBuffer(R).buffer},E.prototype.toWordArray=function(R){return this.isTypedArray(R)&&(R=R.buffer),this.isWordArray(R)?R:m.default.create(R)},E.prototype.base64Encode=function(R){return this.isWordArray(R)?(0,g.stringify)(R):this.uint8ViewToBase64(this.toBuffer(R))},E.prototype.base64Decode=function(R){return ArrayBuffer&&_.default.Config.atob?this.base64ToArrayBuffer(R):(0,g.parse)(R)},E.prototype.hexEncode=function(R){return(0,f.stringify)(this.toWordArray(R))},E.prototype.hexDecode=function(R){var v=(0,f.parse)(R);return ArrayBuffer?this.toArrayBuffer(v):v},E.prototype.utf8Encode=function(R){return _.default.Config.TextEncoder?new _.default.Config.TextEncoder().encode(R).buffer:(0,d.parse)(R)},E.prototype.utf8Decode=function(R){if(!this.isBuffer(R))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(R)?new TextDecoder().decode(R):(R=this.toWordArray(R),(0,d.stringify)(R))},E.prototype.bufferCompare=function(R,v){if(!R)return-1;if(!v)return 1;var D=this.toWordArray(R),z=this.toWordArray(v);D.clamp(),z.clamp();var L=D.sigBytes-z.sigBytes;if(L!=0)return L;for(var N=D.words,M=z.words,G=0;G<N.length;G++)if(L=N[G]-M[G],L!=0)return L;return 0},E.prototype.byteLength=function(R){return this.isArrayBuffer(R)||this.isTypedArray(R)?R.byteLength:this.isWordArray(R)?R.sigBytes:-1},E.prototype.typedArrayToBuffer=function(R){return R.buffer},E})();i.default=new C}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return l.enc.Hex})}),(function(n,i,r){r.r(i);var l=r(5),f=r.n(l),d=r(11),g=r(23),m=r.n(g),_=r(2),C=r.n(_),E=r(4),R=r.n(E),v=function(D,z){var L="aes",N=256,M="cbc",G=16,w=4,O=4294967296,A=2147483648,y;if(D.getRandomWordArray)y=D.getRandomWordArray;else if(typeof Uint32Array<"u"&&D.getRandomValues){var B=new Uint32Array(w);y=function(I,X){var W=I/4,at=W==w?B:new Uint32Array(W);D.getRandomValues(at,function(J){typeof X<"u"&&X(J,z.toWordArray(at))})}}else y=function(I,X){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var W=I/4,at=new Array(W),J=0;J<W;J++)at[J]=Math.floor(Math.random()*O)-A;X(null,f.a.create(at))};function U(I){return I+G&-G}function P(I){if(I.algorithm==="aes"&&I.mode==="cbc"){if(I.keyLength===128||I.keyLength===256)return;throw new Error("Unsupported key length "+I.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function Y(I){return I.replace("_","/").replace("-","+")}var K=[f.a.create([269488144,269488144,269488144,269488144],16),f.a.create([16777216],1),f.a.create([33685504],2),f.a.create([50529024],3),f.a.create([67372036],4),f.a.create([84215045,83886080],5),f.a.create([101058054,101056512],6),f.a.create([117901063,117901056],7),f.a.create([134744072,134744072],8),f.a.create([151587081,151587081,150994944],9),f.a.create([168430090,168430090,168427520],10),f.a.create([185273099,185273099,185273088],11),f.a.create([202116108,202116108,202116108],12),f.a.create([218959117,218959117,218959117,218103808],13),f.a.create([235802126,235802126,235802126,235798528],14),f.a.create([252645135,252645135,252645135,252645135],15),f.a.create([269488144,269488144,269488144,269488144],16)];function Q(){}function V(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}Q.CipherParams=V,Q.getDefaultParams=function(I){var X;if(typeof I=="function"||typeof I=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof I=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),Q.generateRandomKey(function(at){I(null,Q.getDefaultParams({key:at}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,Q.getDefaultParams({key:I}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!I.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof I.key=="string"?X=Object(d.parse)(Y(I.key)):X=z.toWordArray(I.key);var W=new V;if(W.key=X,W.algorithm=I.algorithm||L,W.keyLength=X.words.length*32,W.mode=I.mode||M,I.keyLength&&I.keyLength!==W.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+I.keyLength+" was specified, but the key actually has length "+W.keyLength);return P(W),W},Q.generateRandomKey=function(I,X){arguments.length==1&&typeof I=="function"&&(X=I,I=void 0),y((I||N)/8,function(W,at){X!==void 0&&X(W?R.a.fromValues(W):null,at)})},Q.getCipher=function(I){var X=I instanceof V?I:Q.getDefaultParams(I);return{cipherParams:X,cipher:new j(X,w,I.iv)}};function j(I,X,W){this.algorithm=I.algorithm+"-"+String(I.keyLength)+"-"+I.mode,this.cjsAlgorithm=I.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=z.toWordArray(I.key),W&&(this.iv=z.toWordArray(W).clone()),this.blockLengthWords=X}return j.prototype.encrypt=function(I,X){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),I=z.toWordArray(I);var W=I.sigBytes,at=U(W),J=this,rt=function(){J.getIv(function(it,q){if(it){X(it);return}var F=J.encryptCipher.process(I.concat(K[at-W])),tt=q.concat(F);X(null,tt)})};this.encryptCipher?rt():this.iv?(this.encryptCipher=m.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),rt()):y(G,function(it,q){if(it){X(it);return}J.encryptCipher=m.a.algo[J.cjsAlgorithm].createEncryptor(J.key,{iv:q}),J.iv=q,rt()})},j.prototype.decrypt=function(I){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),I=z.toWordArray(I);var X=this.blockLengthWords,W=I.words,at=f.a.create(W.slice(0,X)),J=f.a.create(W.slice(X)),rt=m.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:at}),it=rt.process(J),q=rt.finalize();return rt.reset(),q&&q.sigBytes&&it.concat(q),it},j.prototype.getIv=function(I){if(this.iv){var X=this.iv;this.iv=null,I(null,X);return}var W=this;y(G,function(at,J){if(at){I(at);return}I(null,W.encryptCipher.process(J))})},Q};i.default=v}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.WordArray,m=f.enc;m.Utf16=m.Utf16BE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],D=0;D<R;D+=2){var z=E[D>>>2]>>>16-D%4*8&65535;v.push(String.fromCharCode(z))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=C.charCodeAt(v)<<16-v%2*16;return g.create(R,E*2)}},m.Utf16LE={stringify:function(C){for(var E=C.words,R=C.sigBytes,v=[],D=0;D<R;D+=2){var z=_(E[D>>>2]>>>16-D%4*8&65535);v.push(String.fromCharCode(z))}return v.join("")},parse:function(C){for(var E=C.length,R=[],v=0;v<E;v++)R[v>>>1]|=_(C.charCodeAt(v)<<16-v%2*16);return g.create(R,E*2)}};function _(C){return C<<8&4278255360|C>>>8&16711935}})(),l.enc.Utf16})}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(28))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.CipherParams,_=d.enc,C=_.Hex,E=d.format;E.Hex={stringify:function(R){return R.ciphertext.toString(C)},parse:function(R){var v=C.parse(R);return m.create({ciphertext:v})}}})(),l.format.Hex})}),(function(n,i,r){(function(l,f){n.exports=f(r(6),r(11),r(61),r(27),r(28))})(this,function(l){return(function(){var f=l,d=f.lib,g=d.BlockCipher,m=f.algo,_=[],C=[],E=[],R=[],v=[],D=[],z=[],L=[],N=[],M=[];(function(){for(var O=[],A=0;A<256;A++)A<128?O[A]=A<<1:O[A]=A<<1^283;for(var y=0,B=0,A=0;A<256;A++){var U=B^B<<1^B<<2^B<<3^B<<4;U=U>>>8^U&255^99,_[y]=U,C[U]=y;var P=O[y],Y=O[P],K=O[Y],Q=O[U]*257^U*16843008;E[y]=Q<<24|Q>>>8,R[y]=Q<<16|Q>>>16,v[y]=Q<<8|Q>>>24,D[y]=Q;var Q=K*16843009^Y*65537^P*257^y*16843008;z[U]=Q<<24|Q>>>8,L[U]=Q<<16|Q>>>16,N[U]=Q<<8|Q>>>24,M[U]=Q,y?(y=P^O[O[O[K^P]]],B^=O[O[B]]):y=B=1}})();var G=[0,1,2,4,8,16,32,64,128,27,54],w=m.AES=g.extend({_doReset:function(){var O;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var A=this._keyPriorReset=this._key,y=A.words,B=A.sigBytes/4,U=this._nRounds=B+6,P=(U+1)*4,Y=this._keySchedule=[],K=0;K<P;K++)K<B?Y[K]=y[K]:(O=Y[K-1],K%B?B>6&&K%B==4&&(O=_[O>>>24]<<24|_[O>>>16&255]<<16|_[O>>>8&255]<<8|_[O&255]):(O=O<<8|O>>>24,O=_[O>>>24]<<24|_[O>>>16&255]<<16|_[O>>>8&255]<<8|_[O&255],O^=G[K/B|0]<<24),Y[K]=Y[K-B]^O);for(var Q=this._invKeySchedule=[],V=0;V<P;V++){var K=P-V;if(V%4)var O=Y[K];else var O=Y[K-4];V<4||K<=4?Q[V]=O:Q[V]=z[_[O>>>24]]^L[_[O>>>16&255]]^N[_[O>>>8&255]]^M[_[O&255]]}}},encryptBlock:function(O,A){this._doCryptBlock(O,A,this._keySchedule,E,R,v,D,_)},decryptBlock:function(O,A){var y=O[A+1];O[A+1]=O[A+3],O[A+3]=y,this._doCryptBlock(O,A,this._invKeySchedule,z,L,N,M,C);var y=O[A+1];O[A+1]=O[A+3],O[A+3]=y},_doCryptBlock:function(O,A,y,B,U,P,Y,K){for(var Q=this._nRounds,V=O[A]^y[0],j=O[A+1]^y[1],I=O[A+2]^y[2],X=O[A+3]^y[3],W=4,at=1;at<Q;at++){var J=B[V>>>24]^U[j>>>16&255]^P[I>>>8&255]^Y[X&255]^y[W++],rt=B[j>>>24]^U[I>>>16&255]^P[X>>>8&255]^Y[V&255]^y[W++],it=B[I>>>24]^U[X>>>16&255]^P[V>>>8&255]^Y[j&255]^y[W++],q=B[X>>>24]^U[V>>>16&255]^P[j>>>8&255]^Y[I&255]^y[W++];V=J,j=rt,I=it,X=q}var J=(K[V>>>24]<<24|K[j>>>16&255]<<16|K[I>>>8&255]<<8|K[X&255])^y[W++],rt=(K[j>>>24]<<24|K[I>>>16&255]<<16|K[X>>>8&255]<<8|K[V&255])^y[W++],it=(K[I>>>24]<<24|K[X>>>16&255]<<16|K[V>>>8&255]<<8|K[j&255])^y[W++],q=(K[X>>>24]<<24|K[V>>>16&255]<<16|K[j>>>8&255]<<8|K[I&255])^y[W++];O[A]=J,O[A+1]=rt,O[A+2]=it,O[A+3]=q},keySize:256/32});f.AES=g._createHelper(w)})(),l.AES})}),(function(n,i,r){(function(l,f){n.exports=f(r(6))})(this,function(l){return(function(f){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[];(function(){for(var N=0;N<64;N++)E[N]=f.abs(f.sin(N+1))*4294967296|0})();var R=C.MD5=_.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(N,M){for(var G=0;G<16;G++){var w=M+G,O=N[w];N[w]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360}var A=this._hash.words,y=N[M+0],B=N[M+1],U=N[M+2],P=N[M+3],Y=N[M+4],K=N[M+5],Q=N[M+6],V=N[M+7],j=N[M+8],I=N[M+9],X=N[M+10],W=N[M+11],at=N[M+12],J=N[M+13],rt=N[M+14],it=N[M+15],q=A[0],F=A[1],tt=A[2],nt=A[3];q=v(q,F,tt,nt,y,7,E[0]),nt=v(nt,q,F,tt,B,12,E[1]),tt=v(tt,nt,q,F,U,17,E[2]),F=v(F,tt,nt,q,P,22,E[3]),q=v(q,F,tt,nt,Y,7,E[4]),nt=v(nt,q,F,tt,K,12,E[5]),tt=v(tt,nt,q,F,Q,17,E[6]),F=v(F,tt,nt,q,V,22,E[7]),q=v(q,F,tt,nt,j,7,E[8]),nt=v(nt,q,F,tt,I,12,E[9]),tt=v(tt,nt,q,F,X,17,E[10]),F=v(F,tt,nt,q,W,22,E[11]),q=v(q,F,tt,nt,at,7,E[12]),nt=v(nt,q,F,tt,J,12,E[13]),tt=v(tt,nt,q,F,rt,17,E[14]),F=v(F,tt,nt,q,it,22,E[15]),q=D(q,F,tt,nt,B,5,E[16]),nt=D(nt,q,F,tt,Q,9,E[17]),tt=D(tt,nt,q,F,W,14,E[18]),F=D(F,tt,nt,q,y,20,E[19]),q=D(q,F,tt,nt,K,5,E[20]),nt=D(nt,q,F,tt,X,9,E[21]),tt=D(tt,nt,q,F,it,14,E[22]),F=D(F,tt,nt,q,Y,20,E[23]),q=D(q,F,tt,nt,I,5,E[24]),nt=D(nt,q,F,tt,rt,9,E[25]),tt=D(tt,nt,q,F,P,14,E[26]),F=D(F,tt,nt,q,j,20,E[27]),q=D(q,F,tt,nt,J,5,E[28]),nt=D(nt,q,F,tt,U,9,E[29]),tt=D(tt,nt,q,F,V,14,E[30]),F=D(F,tt,nt,q,at,20,E[31]),q=z(q,F,tt,nt,K,4,E[32]),nt=z(nt,q,F,tt,j,11,E[33]),tt=z(tt,nt,q,F,W,16,E[34]),F=z(F,tt,nt,q,rt,23,E[35]),q=z(q,F,tt,nt,B,4,E[36]),nt=z(nt,q,F,tt,Y,11,E[37]),tt=z(tt,nt,q,F,V,16,E[38]),F=z(F,tt,nt,q,X,23,E[39]),q=z(q,F,tt,nt,J,4,E[40]),nt=z(nt,q,F,tt,y,11,E[41]),tt=z(tt,nt,q,F,P,16,E[42]),F=z(F,tt,nt,q,Q,23,E[43]),q=z(q,F,tt,nt,I,4,E[44]),nt=z(nt,q,F,tt,at,11,E[45]),tt=z(tt,nt,q,F,it,16,E[46]),F=z(F,tt,nt,q,U,23,E[47]),q=L(q,F,tt,nt,y,6,E[48]),nt=L(nt,q,F,tt,V,10,E[49]),tt=L(tt,nt,q,F,rt,15,E[50]),F=L(F,tt,nt,q,K,21,E[51]),q=L(q,F,tt,nt,at,6,E[52]),nt=L(nt,q,F,tt,P,10,E[53]),tt=L(tt,nt,q,F,X,15,E[54]),F=L(F,tt,nt,q,B,21,E[55]),q=L(q,F,tt,nt,j,6,E[56]),nt=L(nt,q,F,tt,it,10,E[57]),tt=L(tt,nt,q,F,Q,15,E[58]),F=L(F,tt,nt,q,J,21,E[59]),q=L(q,F,tt,nt,Y,6,E[60]),nt=L(nt,q,F,tt,W,10,E[61]),tt=L(tt,nt,q,F,U,15,E[62]),F=L(F,tt,nt,q,I,21,E[63]),A[0]=A[0]+q|0,A[1]=A[1]+F|0,A[2]=A[2]+tt|0,A[3]=A[3]+nt|0},_doFinalize:function(){var N=this._data,M=N.words,G=this._nDataBytes*8,w=N.sigBytes*8;M[w>>>5]|=128<<24-w%32;var O=f.floor(G/4294967296),A=G;M[(w+64>>>9<<4)+15]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,M[(w+64>>>9<<4)+14]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,N.sigBytes=(M.length+1)*4,this._process();for(var y=this._hash,B=y.words,U=0;U<4;U++){var P=B[U];B[U]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return y},clone:function(){var N=_.clone.call(this);return N._hash=this._hash.clone(),N}});function v(N,M,G,w,O,A,y){var B=N+(M&G|~M&w)+O+y;return(B<<A|B>>>32-A)+M}function D(N,M,G,w,O,A,y){var B=N+(M&w|G&~w)+O+y;return(B<<A|B>>>32-A)+M}function z(N,M,G,w,O,A,y){var B=N+(M^G^w)+O+y;return(B<<A|B>>>32-A)+M}function L(N,M,G,w,O,A,y){var B=N+(G^(M|~w))+O+y;return(B<<A|B>>>32-A)+M}d.MD5=_._createHelper(R),d.HmacMD5=_._createHmacHelper(R)})(Math),l.MD5})}),(function(n,i,r){var l;Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),d=f.__importDefault(r(3)),g=f.__importStar(r(1)),m=f.__importDefault(r(8)),_=r(4),C=f.__importDefault(r(19)),E=f.__importDefault(r(17)),R=f.__importDefault(r(22)),v=f.__importDefault(r(2)),D=r(29),z=f.__importDefault(r(63)),L=r(14);function N(w){var O=w.statusCode;return O===408&&!w.code||O===400&&!w.code||O>=500&&O<=504}function M(w){var O=w.connection,A=O&&O.connectionManager.host;return A?[A].concat(m.default.getFallbackHosts(w.options)):m.default.getHosts(w.options)}var G=(l=(function(){function w(O){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=M,this.options=O||{};var A=this.options.connectivityCheckUrl||m.default.connectivityCheckUrl,y=this.options.connectivityCheckParams,B=!this.options.connectivityCheckUrl;d.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(U,P,Y,K,Q,V,j){var I=E.default.createRequest(Y,K,Q,V,R.default.REQ_SEND,P&&P.options.timeouts,U);return I.once("complete",j),I.exec(),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+A),this.doUri(C.default.Get,null,A,null,null,y,function(P,Y,K,Q,V){var j=!1;B?j=!P&&(Y==null?void 0:Y.replace(/\n/,""))=="yes":j=!P&&(0,L.isSuccessCode)(V),v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+j),U(null,j)})}):d.default.Config.jsonpSupported?(this.Request=function(U,P,Y,K,Q,V,j){var I=(0,D.createRequest)(Y,K,Q,V,R.default.REQ_SEND,P&&P.options.timeouts,U);return I.once("complete",j),d.default.Config.nextTick(function(){I.exec()}),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(U){U(null,!0)}:this.checkConnectivity=function(U){var P=this,Y=m.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(U);return}this.checksInProgress=[U],v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+Y);var K=new D.Request("isTheInternetUp",Y,null,null,null,R.default.REQ_SEND,m.default.TIMEOUTS);K.once("complete",function(Q,V){var j=!Q&&V;v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+j);for(var I=0;I<P.checksInProgress.length;I++)P.checksInProgress[I](null,j);P.checksInProgress=null}),d.default.Config.nextTick(function(){K.exec()})}):d.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=z.default,this.checkConnectivity=function(U){v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+A),this.doUri(C.default.Get,null,A,null,null,null,function(P,Y){var K=!P&&(Y==null?void 0:Y.replace(/\n/,""))=="yes";v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+K),U(null,K)})}):this.Request=function(U,P,Y,K,Q,V,j){j(new _.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return w.prototype.do=function(O,A,y,B,U,P,Y){var K=this,Q=typeof y=="function"?y:function(X){return A.baseUri(X)+y},V=A._currentFallback;if(V)if(V.validUntil>g.now()){if(!this.Request){Y==null||Y(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(O,A,Q(V.host),B,P,U,function(X){for(var W=[],at=1;at<arguments.length;at++)W[at-1]=arguments[at];if(X&&N(X)){A._currentFallback=null,K.do(O,A,y,B,U,P,Y);return}Y==null||Y.apply(void 0,f.__spreadArray([X],W,!1))});return}else A._currentFallback=null;var j=M(A);if(j.length===1){this.doUri(O,A,Q(j[0]),B,U,P,Y);return}var I=function(X,W){var at=X.shift();K.doUri(O,A,Q(at),B,U,P,function(J){for(var rt=[],it=1;it<arguments.length;it++)rt[it-1]=arguments[it];if(J&&N(J)&&X.length){I(X,!0);return}W&&(A._currentFallback={host:at,validUntil:g.now()+A.options.timeouts.fallbackRetryTimeout}),Y==null||Y.apply(void 0,f.__spreadArray([J],rt,!1))})};I(j)},w.prototype.doUri=function(O,A,y,B,U,P,Y){if(!this.Request){Y(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(O,A,y,B,P,U,Y)},w})(),l.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],l.methodsWithoutBody=[C.default.Get,C.default.Delete],l.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],l);i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importStar(r(4)),d=l.__importDefault(r(3)),g=l.__importDefault(r(8)),m=l.__importStar(r(1)),_=r(1);function C(v,D){return!!D.get("x-ably-errorcode")}function E(v,D){if(C(v,D))return v.error&&f.default.fromValues(v.error)}function R(v,D,z,L,N,M,G){var w=new Headers(L||{}),O=v?v.toUpperCase():m.isEmptyArg(M)?"GET":"POST",A=new AbortController,y=setTimeout(function(){A.abort(),G(new f.PartialErrorInfo("Request timed out",null,408))},D?D.options.timeouts.httpRequestTimeout:g.default.TIMEOUTS.httpRequestTimeout),B={method:O,headers:w,body:M};d.default.Config.isWebworker||(B.credentials=w.has("authorization")?"include":"same-origin"),(0,_.getGlobalObject)().fetch(z+"?"+new URLSearchParams(N||{}),B).then(function(U){clearTimeout(y);var P=U.headers.get("Content-Type"),Y;P&&P.indexOf("application/x-msgpack")>-1?Y=U.arrayBuffer():P&&P.indexOf("application/json")>-1?Y=U.json():Y=U.text(),Y.then(function(K){var Q=!!P&&P.indexOf("application/x-msgpack")===-1;if(U.ok)G(null,K,U.headers,Q,U.status);else{var V=E(K,U.headers)||new f.PartialErrorInfo("Error response received from server: "+U.status+" body was: "+d.default.Config.inspect(K),null,U.status);G(V,K,U.headers,Q,U.status)}})}).catch(function(U){clearTimeout(y),G(U)})}i.default=R}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(41)),d=l.__importStar(r(1)),g=d.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function m(){var R=g.location;return!g.WebSocket||!R||!R.origin||R.origin.indexOf("http")>-1}var _=g.navigator&&g.navigator.userAgent.toString(),C=g.location&&g.location.href,E={agent:"browser",logTimestamps:!0,userAgent:_,currentUrl:C,noUpgrade:_&&!!_.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:g.WebSocket,fetchSupported:!!g.fetch,xhrSupported:g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:m(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:f.default,supportsBinary:!!g.TextDecoder,preferBinary:!1,ArrayBuffer:g.ArrayBuffer,atob:g.atob,nextTick:typeof g.setImmediate<"u"?g.setImmediate.bind(g):function(R){setTimeout(R,0)},addEventListener:g.addEventListener,inspect:JSON.stringify,stringByteSize:function(R){return g.TextDecoder&&new g.TextEncoder().encode(R).length||R.length},TextEncoder:g.TextEncoder,TextDecoder:g.TextDecoder,Promise:g.Promise,getRandomValues:(function(R){if(R!==void 0)return function(v,D){R.getRandomValues(v),D&&D(null)}})(g.crypto||msCrypto)};i.default=E}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var f=r(0),d=f.__importStar(r(1)),g="ablyjs-storage-test",m=(function(){function _(){try{l.sessionStorage.setItem(g,g),l.sessionStorage.removeItem(g),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{l.localStorage.setItem(g,g),l.localStorage.removeItem(g),this.localSupported=!0}catch{this.localSupported=!1}}return _.prototype.get=function(C){return this._get(C,!1)},_.prototype.getSession=function(C){return this._get(C,!0)},_.prototype.remove=function(C){return this._remove(C,!1)},_.prototype.removeSession=function(C){return this._remove(C,!0)},_.prototype.set=function(C,E,R){return this._set(C,E,R,!1)},_.prototype.setSession=function(C,E,R){return this._set(C,E,R,!0)},_.prototype._set=function(C,E,R,v){var D={value:E};return R&&(D.expires=d.now()+R),this.storageInterface(v).setItem(C,JSON.stringify(D))},_.prototype._get=function(C,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var R=this.storageInterface(E).getItem(C);if(!R)return null;var v=JSON.parse(R);return v.expires&&v.expires<d.now()?(this.storageInterface(E).removeItem(C),null):v.value},_.prototype._remove=function(C,E){return this.storageInterface(E).removeItem(C)},_.prototype.storageInterface=function(C){return C?l.sessionStorage:l.localStorage},_})();i.default=new m}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),f=l.__importDefault(r(67)),d={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],baseTransportOrder:[f.default.XhrPolling,f.default.XhrStreaming,f.default.JsonP,f.default.WebSocket],transportPreferenceOrder:[f.default.JsonP,f.default.XhrPolling,f.default.XhrStreaming,f.default.WebSocket],upgradeTransports:[f.default.XhrStreaming,f.default.WebSocket]};i.default=d}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(f){f.WebSocket="web_socket",f.Comet="comet",f.XhrStreaming="xhr_streaming",f.XhrPolling="xhr_polling",f.JsonP="jsonp"})(l||(l={})),i.default=l}),(function(n,i,r){r.r(i);var l=r(29),f=r.n(l),d=r(1),g=r(3),m=r.n(g),_=r(12),C=r.n(_),E=r(17),R=r.n(E),v=function(N){var M="xhr_polling";function G(w,O,A){A.stream=!1,C.a.call(this,w,O,A),this.shortName=M}return d.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(w,O,A,y,B){return R.a.createRequest(w,O,A,y,B,this.timeouts)},typeof N<"u"&&G.isAvailable()&&(N.supportedTransports[M]=G),G},D=v,z=function(N){var M="xhr_streaming";function G(w,O,A){C.a.call(this,w,O,A),this.shortName=M}return d.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.streamingSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(w,O,A,y,B){return R.a.createRequest(w,O,A,y,B,this.timeouts)},typeof N<"u"&&G.isAvailable()&&(N.supportedTransports[M]=G),G},L=z;i.default=[f.a,D,L]})]).default})})(Gp)),Gp.exports}var $8=dS(),Um=function(o,t){return Um=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},Um(o,t)};function gS(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Um(o,t);function n(){this.constructor=o}o.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var mg=function(){return mg=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},mg.apply(this,arguments)};function pf(o,t){var n={};for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&t.indexOf(i)<0&&(n[i]=o[i]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(o);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(o,i[r])&&(n[i[r]]=o[i[r]]);return n}function pS(o,t,n,i){var r=arguments.length,l=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,t,n,i);else for(var d=o.length-1;d>=0;d--)(f=o[d])&&(l=(r<3?f(l):r>3?f(t,n,l):f(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l}function mS(o,t){return function(n,i){t(n,i,o)}}function vS(o,t,n,i,r,l){function f(L){if(L!==void 0&&typeof L!="function")throw new TypeError("Function expected");return L}for(var d=i.kind,g=d==="getter"?"get":d==="setter"?"set":"value",m=!t&&o?i.static?o:o.prototype:null,_=t||(m?Object.getOwnPropertyDescriptor(m,i.name):{}),C,E=!1,R=n.length-1;R>=0;R--){var v={};for(var D in i)v[D]=D==="access"?{}:i[D];for(var D in i.access)v.access[D]=i.access[D];v.addInitializer=function(L){if(E)throw new TypeError("Cannot add initializers after decoration has completed");l.push(f(L||null))};var z=(0,n[R])(d==="accessor"?{get:_.get,set:_.set}:_[g],v);if(d==="accessor"){if(z===void 0)continue;if(z===null||typeof z!="object")throw new TypeError("Object expected");(C=f(z.get))&&(_.get=C),(C=f(z.set))&&(_.set=C),(C=f(z.init))&&r.unshift(C)}else(C=f(z))&&(d==="field"?r.unshift(C):_[g]=C)}m&&Object.defineProperty(m,i.name,_),E=!0}function yS(o,t,n){for(var i=arguments.length>2,r=0;r<t.length;r++)n=i?t[r].call(o,n):t[r].call(o);return i?n:void 0}function SS(o){return typeof o=="symbol"?o:"".concat(o)}function bS(o,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function _S(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function Wt(o,t,n,i){function r(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function d(_){try{m(i.next(_))}catch(C){f(C)}}function g(_){try{m(i.throw(_))}catch(C){f(C)}}function m(_){_.done?l(_.value):r(_.value).then(d,g)}m((i=i.apply(o,t||[])).next())})}function ES(o,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,r,l,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=d(0),f.throw=d(1),f.return=d(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function d(m){return function(_){return g([m,_])}}function g(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,r&&(l=m[0]&2?r.return:m[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,m[1])).done)return l;switch(r=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(o,n)}catch(_){m=[6,_],r=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Mg=Object.create?(function(o,t,n,i){i===void 0&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(o,i,r)}):(function(o,t,n,i){i===void 0&&(i=n),o[i]=t[n]});function CS(o,t){for(var n in o)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Mg(t,o,n)}function vg(o){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&o[t],i=0;if(n)return n.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function rv(o,t){var n=typeof Symbol=="function"&&o[Symbol.iterator];if(!n)return o;var i=n.call(o),r,l=[],f;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(d){f={error:d}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(f)throw f.error}}return l}function TS(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(rv(arguments[t]));return o}function AS(){for(var o=0,t=0,n=arguments.length;t<n;t++)o+=arguments[t].length;for(var i=Array(o),r=0,t=0;t<n;t++)for(var l=arguments[t],f=0,d=l.length;f<d;f++,r++)i[r]=l[f];return i}function OS(o,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,l;i<r;i++)(l||!(i in t))&&(l||(l=Array.prototype.slice.call(t,0,i)),l[i]=t[i]);return o.concat(l||Array.prototype.slice.call(t))}function uf(o){return this instanceof uf?(this.v=o,this):new uf(o)}function RS(o,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(o,t||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",f),r[Symbol.asyncIterator]=function(){return this},r;function f(R){return function(v){return Promise.resolve(v).then(R,C)}}function d(R,v){i[R]&&(r[R]=function(D){return new Promise(function(z,L){l.push([R,D,z,L])>1||g(R,D)})},v&&(r[R]=v(r[R])))}function g(R,v){try{m(i[R](v))}catch(D){E(l[0][3],D)}}function m(R){R.value instanceof uf?Promise.resolve(R.value.v).then(_,C):E(l[0][2],R)}function _(R){g("next",R)}function C(R){g("throw",R)}function E(R,v){R(v),l.shift(),l.length&&g(l[0][0],l[0][1])}}function wS(o){var t,n;return t={},i("next"),i("throw",function(r){throw r}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(r,l){t[r]=o[r]?function(f){return(n=!n)?{value:uf(o[r](f)),done:!1}:l?l(f):f}:l}}function xS(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],n;return t?t.call(o):(o=typeof vg=="function"?vg(o):o[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(l){n[l]=o[l]&&function(f){return new Promise(function(d,g){f=o[l](f),r(d,g,f.done,f.value)})}}function r(l,f,d,g){Promise.resolve(g).then(function(m){l({value:m,done:d})},f)}}function MS(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}var t_=Object.create?(function(o,t){Object.defineProperty(o,"default",{enumerable:!0,value:t})}):function(o,t){o.default=t},Bm=function(o){return Bm=Object.getOwnPropertyNames||function(t){var n=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[n.length]=i);return n},Bm(o)};function NS(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var n=Bm(o),i=0;i<n.length;i++)n[i]!=="default"&&Mg(t,o,n[i]);return t_(t,o),t}function DS(o){return o&&o.__esModule?o:{default:o}}function jS(o,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!i:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(o):i?i.value:t.get(o)}function US(o,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!r:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(o,n):r?r.value=n:t.set(o,n),n}function BS(o,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?t===o:o.has(t)}function zS(o,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var i,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],n&&(r=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");r&&(i=function(){try{r.call(this)}catch(l){return Promise.reject(l)}}),o.stack.push({value:t,dispose:i,async:n})}else n&&o.stack.push({async:!0});return t}var e_=typeof SuppressedError=="function"?SuppressedError:function(o,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=o,i.suppressed=t,i};function LS(o){function t(l){o.error=o.hasError?new e_(l,o.error,"An error was suppressed during disposal."):l,o.hasError=!0}var n,i=0;function r(){for(;n=o.stack.pop();)try{if(!n.async&&i===1)return i=0,o.stack.push(n),Promise.resolve().then(r);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(l).then(r,function(f){return t(f),r()})}else i|=1}catch(f){t(f)}if(i===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return r()}function GS(o,t){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,i,r,l,f){return i?t?".jsx":".js":r&&(!l||!f)?n:r+l+"."+f.toLowerCase()+"js"}):o}const n_={__extends:gS,__assign:mg,__rest:pf,__decorate:pS,__param:mS,__esDecorate:vS,__runInitializers:yS,__propKey:SS,__setFunctionName:bS,__metadata:_S,__awaiter:Wt,__generator:ES,__createBinding:Mg,__exportStar:CS,__values:vg,__read:rv,__spread:TS,__spreadArrays:AS,__spreadArray:OS,__await:uf,__asyncGenerator:RS,__asyncDelegator:wS,__asyncValues:xS,__makeTemplateObject:MS,__importStar:NS,__importDefault:DS,__classPrivateFieldGet:jS,__classPrivateFieldSet:US,__classPrivateFieldIn:BS,__addDisposableResource:zS,__disposeResources:LS,__rewriteRelativeImportExtension:GS},i_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:zS,get __assign(){return mg},__asyncDelegator:wS,__asyncGenerator:RS,__asyncValues:xS,__await:uf,__awaiter:Wt,__classPrivateFieldGet:jS,__classPrivateFieldIn:BS,__classPrivateFieldSet:US,__createBinding:Mg,__decorate:pS,__disposeResources:LS,__esDecorate:vS,__exportStar:CS,__extends:gS,__generator:ES,__importDefault:DS,__importStar:NS,__makeTemplateObject:MS,__metadata:_S,__param:mS,__propKey:SS,__read:rv,__rest:pf,__rewriteRelativeImportExtension:GS,__runInitializers:yS,__setFunctionName:bS,__spread:TS,__spreadArray:OS,__spreadArrays:AS,__values:vg,default:n_},Symbol.toStringTag,{value:"Module"})),a_="modulepreload",r_=function(o){return"/"+o},oy={},mf=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){let f=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=f(n.map(m=>{if(m=r_(m),m in oy)return;oy[m]=!0;const _=m.endsWith(".css"),C=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${C}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":a_,_||(E.as="script"),E.crossOrigin="",E.href=m,g&&E.setAttribute("nonce",g),document.head.appendChild(E),_)return new Promise((R,v)=>{E.addEventListener("load",R),E.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(f){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=f,window.dispatchEvent(d),!d.defaultPrevented)throw f}return r.then(f=>{for(const d of f||[])d.status==="rejected"&&l(d.reason);return t().catch(l)})},s_=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>mf(async()=>{const{default:i}=await Promise.resolve().then(()=>Su);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)};class sv extends Error{constructor(t,n="FunctionsError",i){super(t),this.name=n,this.context=i}}class uy extends sv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class cy extends sv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class fy extends sv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var zm;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(zm||(zm={}));class l_{constructor(t,{headers:n={},customFetch:i,region:r=zm.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=s_(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Wt(this,arguments,void 0,function*(n,i={}){var r;try{const{headers:l,method:f,body:d,signal:g}=i;let m={},{region:_}=i;_||(_=this.region);const C=new URL(`${this.url}/${n}`);_&&_!=="any"&&(m["x-region"]=_,C.searchParams.set("forceFunctionRegion",_));let E;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=d):typeof d=="string"?(m["Content-Type"]="text/plain",E=d):typeof FormData<"u"&&d instanceof FormData?E=d:(m["Content-Type"]="application/json",E=JSON.stringify(d)):E=d;const R=yield this.fetch(C.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),l),body:E,signal:g}).catch(L=>{throw L.name==="AbortError"?L:new uy(L)}),v=R.headers.get("x-relay-error");if(v&&v==="true")throw new cy(R);if(!R.ok)throw new fy(R);let D=((r=R.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),z;return D==="application/json"?z=yield R.json():D==="application/octet-stream"||D==="application/pdf"?z=yield R.blob():D==="text/event-stream"?z=R:D==="multipart/form-data"?z=yield R.formData():z=yield R.text(),{data:z,error:null,response:R}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new uy(l)}:{data:null,error:l,response:l instanceof fy||l instanceof cy?l.context:void 0}}})}}var Yi={};const vf=m2(i_);var tg={},eg={},ng={},ig={},ag={},o_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},cf=o_();const u_=cf.fetch,HS=cf.fetch.bind(cf),PS=cf.Headers,c_=cf.Request,f_=cf.Response,Su=Object.freeze(Object.defineProperty({__proto__:null,Headers:PS,Request:c_,Response:f_,default:HS,fetch:u_},Symbol.toStringTag,{value:"Module"})),h_=m2(Su);var rg={},hy;function IS(){if(hy)return rg;hy=1,Object.defineProperty(rg,"__esModule",{value:!0});class o extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return rg.default=o,rg}var dy;function kS(){if(dy)return ag;dy=1,Object.defineProperty(ag,"__esModule",{value:!0});const o=vf,t=o.__importDefault(h_),n=o.__importDefault(IS());class i{constructor(l){var f,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(f=l.shouldThrowOnError)!==null&&f!==void 0?f:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,f){return this.headers=new Headers(this.headers),this.headers.set(l,f),this}then(l,f){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let g=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var _,C,E,R;let v=null,D=null,z=null,L=m.status,N=m.statusText;if(m.ok){if(this.method!=="HEAD"){const O=await m.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((_=this.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?D=O:D=JSON.parse(O))}const G=(C=this.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),w=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");G&&w&&w.length>1&&(z=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(D)&&(D.length>1?(v={code:"PGRST116",details:`Results contain ${D.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},D=null,z=null,L=406,N="Not Acceptable"):D.length===1?D=D[0]:D=null)}else{const G=await m.text();try{v=JSON.parse(G),Array.isArray(v)&&m.status===404&&(D=[],v=null,L=200,N="OK")}catch{m.status===404&&G===""?(L=204,N="No Content"):v={message:G}}if(v&&this.isMaybeSingle&&(!((R=v==null?void 0:v.details)===null||R===void 0)&&R.includes("0 rows"))&&(v=null,L=200,N="OK"),v&&this.shouldThrowOnError)throw new n.default(v)}return{error:v,data:D,count:z,status:L,statusText:N}});return this.shouldThrowOnError||(g=g.catch(m=>{var _,C,E;return{error:{message:`${(_=m==null?void 0:m.name)!==null&&_!==void 0?_:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(C=m==null?void 0:m.stack)!==null&&C!==void 0?C:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),g.then(l,f)}returns(){return this}overrideTypes(){return this}}return ag.default=i,ag}var gy;function qS(){if(gy)return ig;gy=1,Object.defineProperty(ig,"__esModule",{value:!0});const t=vf.__importDefault(kS());class n extends t.default{select(r){let l=!1;const f=(r??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:l=!0,nullsFirst:f,foreignTable:d,referencedTable:g=d}={}){const m=g?`${g}.order`:"order",_=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${_?`${_},`:""}${r}.${l?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:l,referencedTable:f=l}={}){const d=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(d,`${r}`),this}range(r,l,{foreignTable:f,referencedTable:d=f}={}){const g=typeof d>"u"?"offset":`${d}.offset`,m=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(g,`${r}`),this.url.searchParams.set(m,`${l-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:l=!1,settings:f=!1,buffers:d=!1,wal:g=!1,format:m="text"}={}){var _;const C=[r?"analyze":null,l?"verbose":null,f?"settings":null,d?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${C};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return ig.default=n,ig}var py;function lv(){if(py)return ng;py=1,Object.defineProperty(ng,"__esModule",{value:!0});const t=vf.__importDefault(qS());class n extends t.default{eq(r,l){return this.url.searchParams.append(r,`eq.${l}`),this}neq(r,l){return this.url.searchParams.append(r,`neq.${l}`),this}gt(r,l){return this.url.searchParams.append(r,`gt.${l}`),this}gte(r,l){return this.url.searchParams.append(r,`gte.${l}`),this}lt(r,l){return this.url.searchParams.append(r,`lt.${l}`),this}lte(r,l){return this.url.searchParams.append(r,`lte.${l}`),this}like(r,l){return this.url.searchParams.append(r,`like.${l}`),this}likeAllOf(r,l){return this.url.searchParams.append(r,`like(all).{${l.join(",")}}`),this}likeAnyOf(r,l){return this.url.searchParams.append(r,`like(any).{${l.join(",")}}`),this}ilike(r,l){return this.url.searchParams.append(r,`ilike.${l}`),this}ilikeAllOf(r,l){return this.url.searchParams.append(r,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(r,l){return this.url.searchParams.append(r,`ilike(any).{${l.join(",")}}`),this}is(r,l){return this.url.searchParams.append(r,`is.${l}`),this}in(r,l){const f=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(r,`in.(${f})`),this}contains(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cs.{${l.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(l)}`),this}containedBy(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cd.{${l.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(l)}`),this}rangeGt(r,l){return this.url.searchParams.append(r,`sr.${l}`),this}rangeGte(r,l){return this.url.searchParams.append(r,`nxl.${l}`),this}rangeLt(r,l){return this.url.searchParams.append(r,`sl.${l}`),this}rangeLte(r,l){return this.url.searchParams.append(r,`nxr.${l}`),this}rangeAdjacent(r,l){return this.url.searchParams.append(r,`adj.${l}`),this}overlaps(r,l){return typeof l=="string"?this.url.searchParams.append(r,`ov.${l}`):this.url.searchParams.append(r,`ov.{${l.join(",")}}`),this}textSearch(r,l,{config:f,type:d}={}){let g="";d==="plain"?g="pl":d==="phrase"?g="ph":d==="websearch"&&(g="w");const m=f===void 0?"":`(${f})`;return this.url.searchParams.append(r,`${g}fts${m}.${l}`),this}match(r){return Object.entries(r).forEach(([l,f])=>{this.url.searchParams.append(l,`eq.${f}`)}),this}not(r,l,f){return this.url.searchParams.append(r,`not.${l}.${f}`),this}or(r,{foreignTable:l,referencedTable:f=l}={}){const d=f?`${f}.or`:"or";return this.url.searchParams.append(d,`(${r})`),this}filter(r,l,f){return this.url.searchParams.append(r,`${l}.${f}`),this}}return ng.default=n,ng}var my;function VS(){if(my)return eg;my=1,Object.defineProperty(eg,"__esModule",{value:!0});const t=vf.__importDefault(lv());class n{constructor(r,{headers:l={},schema:f,fetch:d}){this.url=r,this.headers=new Headers(l),this.schema=f,this.fetch=d}select(r,l){const{head:f=!1,count:d}=l??{},g=f?"HEAD":"GET";let m=!1;const _=(r??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",_),d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:l,defaultToNull:f=!0}={}){var d;const g="POST";if(l&&this.headers.append("Prefer",`count=${l}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((_,C)=>_.concat(Object.keys(C)),[]);if(m.length>0){const _=[...new Set(m)].map(C=>`"${C}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(r,{onConflict:l,ignoreDuplicates:f=!1,count:d,defaultToNull:g=!0}={}){var m;const _="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const C=r.reduce((E,R)=>E.concat(Object.keys(R)),[]);if(C.length>0){const E=[...new Set(C)].map(R=>`"${R}"`);this.url.searchParams.set("columns",E.join(","))}}return new t.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:l}={}){var f;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:r}={}){var l;const f="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return eg.default=n,eg}var vy;function d_(){if(vy)return tg;vy=1,Object.defineProperty(tg,"__esModule",{value:!0});const o=vf,t=o.__importDefault(VS()),n=o.__importDefault(lv());class i{constructor(l,{headers:f={},schema:d,fetch:g}={}){this.url=l,this.headers=new Headers(f),this.schemaName=d,this.fetch=g}from(l){const f=new URL(`${this.url}/${l}`);return new t.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new i(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,f={},{head:d=!1,get:g=!1,count:m}={}){var _;let C;const E=new URL(`${this.url}/rpc/${l}`);let R;d||g?(C=d?"HEAD":"GET",Object.entries(f).filter(([D,z])=>z!==void 0).map(([D,z])=>[D,Array.isArray(z)?`{${z.join(",")}}`:`${z}`]).forEach(([D,z])=>{E.searchParams.append(D,z)})):(C="POST",R=f);const v=new Headers(this.headers);return m&&v.set("Prefer",`count=${m}`),new n.default({method:C,url:E,headers:v,schema:this.schemaName,body:R,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}}return tg.default=i,tg}var yy;function g_(){if(yy)return Yi;yy=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.PostgrestError=Yi.PostgrestBuilder=Yi.PostgrestTransformBuilder=Yi.PostgrestFilterBuilder=Yi.PostgrestQueryBuilder=Yi.PostgrestClient=void 0;const o=vf,t=o.__importDefault(d_());Yi.PostgrestClient=t.default;const n=o.__importDefault(VS());Yi.PostgrestQueryBuilder=n.default;const i=o.__importDefault(lv());Yi.PostgrestFilterBuilder=i.default;const r=o.__importDefault(qS());Yi.PostgrestTransformBuilder=r.default;const l=o.__importDefault(kS());Yi.PostgrestBuilder=l.default;const f=o.__importDefault(IS());return Yi.PostgrestError=f.default,Yi.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:l.default,PostgrestError:f.default},Yi}var p_=g_();const m_=ff(p_),{PostgrestClient:v_,PostgrestQueryBuilder:wT,PostgrestFilterBuilder:xT,PostgrestTransformBuilder:MT,PostgrestBuilder:NT,PostgrestError:DT}=m_;class y_{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const i=n.node,r=parseInt(i.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const i=this.getWebSocketConstructor();return new i(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const S_="2.76.1",b_=`realtime-js/${S_}`,__="1.0.0",Lm=1e4,E_=1e3,C_=100;var ad;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(ad||(ad={}));var fi;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(fi||(fi={}));var Lr;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(Lr||(Lr={}));var Gm;(function(o){o.websocket="websocket"})(Gm||(Gm={}));var uu;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(uu||(uu={}));class T_{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,n,i)}_decodeBroadcast(t,n,i){const r=n.getUint8(1),l=n.getUint8(2);let f=this.HEADER_LENGTH+2;const d=i.decode(t.slice(f,f+r));f=f+r;const g=i.decode(t.slice(f,f+l));f=f+l;const m=JSON.parse(i.decode(t.slice(f,t.byteLength)));return{ref:null,topic:d,event:g,payload:m}}}class YS{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _n;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(_n||(_n={}));const Sy=(o,t,n={})=>{var i;const r=(i=n.skipTypes)!==null&&i!==void 0?i:[];return t?Object.keys(t).reduce((l,f)=>(l[f]=A_(f,o,t,r),l),{}):{}},A_=(o,t,n,i)=>{const r=t.find(d=>d.name===o),l=r==null?void 0:r.type,f=n[o];return l&&!i.includes(l)?KS(l,f):Hm(f)},KS=(o,t)=>{if(o.charAt(0)==="_"){const n=o.slice(1,o.length);return x_(t,n)}switch(o){case _n.bool:return O_(t);case _n.float4:case _n.float8:case _n.int2:case _n.int4:case _n.int8:case _n.numeric:case _n.oid:return R_(t);case _n.json:case _n.jsonb:return w_(t);case _n.timestamp:return M_(t);case _n.abstime:case _n.date:case _n.daterange:case _n.int4range:case _n.int8range:case _n.money:case _n.reltime:case _n.text:case _n.time:case _n.timestamptz:case _n.timetz:case _n.tsrange:case _n.tstzrange:return Hm(t);default:return Hm(t)}},Hm=o=>o,O_=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},R_=o=>{if(typeof o=="string"){const t=parseFloat(o);if(!Number.isNaN(t))return t}return o},w_=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(t){return console.log(`JSON parse error: ${t}`),o}return o},x_=(o,t)=>{if(typeof o!="string")return o;const n=o.length-1,i=o[n];if(o[0]==="{"&&i==="}"){let l;const f=o.slice(1,n);try{l=JSON.parse("["+f+"]")}catch{l=f?f.split(","):[]}return l.map(d=>KS(t,d))}return o},M_=o=>typeof o=="string"?o.replace(" ","T"):o,QS=o=>{const t=new URL(o);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Hp{constructor(t,n,i={},r=Lm){this.channel=t,this.event=n,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var i;return this._hasReceived(t)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var by;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(by||(by={}));class rd{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:l,onLeave:f,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rd.syncState(this.state,r,l,f),this.pendingDiffs.forEach(g=>{this.state=rd.syncDiff(this.state,g,l,f)}),this.pendingDiffs=[],d()}),this.channel._on(i.diff,{},r=>{const{onJoin:l,onLeave:f,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=rd.syncDiff(this.state,r,l,f),d())}),this.onJoin((r,l,f)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:l,newPresences:f})}),this.onLeave((r,l,f)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:l,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,i,r){const l=this.cloneDeep(t),f=this.transformState(n),d={},g={};return this.map(l,(m,_)=>{f[m]||(g[m]=_)}),this.map(f,(m,_)=>{const C=l[m];if(C){const E=_.map(z=>z.presence_ref),R=C.map(z=>z.presence_ref),v=_.filter(z=>R.indexOf(z.presence_ref)<0),D=C.filter(z=>E.indexOf(z.presence_ref)<0);v.length>0&&(d[m]=v),D.length>0&&(g[m]=D)}else d[m]=_}),this.syncDiff(l,{joins:d,leaves:g},i,r)}static syncDiff(t,n,i,r){const{joins:l,leaves:f}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(l,(d,g)=>{var m;const _=(m=t[d])!==null&&m!==void 0?m:[];if(t[d]=this.cloneDeep(g),_.length>0){const C=t[d].map(R=>R.presence_ref),E=_.filter(R=>C.indexOf(R.presence_ref)<0);t[d].unshift(...E)}i(d,_,g)}),this.map(f,(d,g)=>{let m=t[d];if(!m)return;const _=g.map(C=>C.presence_ref);m=m.filter(C=>_.indexOf(C.presence_ref)<0),t[d]=m,r(d,m,g),m.length===0&&delete t[d]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(i=>n(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,i)=>{const r=t[i];return"metas"in r?n[i]=r.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[i]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _y;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(_y||(_y={}));var sd;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(sd||(sd={}));var hl;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(hl||(hl={}));class ov{constructor(t,n={config:{}},i){var r,l;if(this.topic=t,this.params=n,this.socket=i,this.bindings={},this.state=fi.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Hp(this,Lr.join,this.params,this.timeout),this.rejoinTimer=new YS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=fi.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=fi.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=fi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=fi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=fi.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Lr.reply,{},(f,d)=>{this._trigger(this._replyEventName(d),f)}),this.presence=new rd(this),this.broadcastEndpointURL=QS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var i,r,l;if(this.socket.isConnected()||this.socket.connect(),this.state==fi.closed){const{config:{broadcast:f,presence:d,private:g}}=this.params,m=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(R=>R.filter))!==null&&r!==void 0?r:[],_=!!this.bindings[sd.PRESENCE]&&this.bindings[sd.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,C={},E={broadcast:f,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(R=>t==null?void 0:t(hl.CHANNEL_ERROR,R)),this._onClose(()=>t==null?void 0:t(hl.CLOSED)),this.updateJoinPayload(Object.assign({config:E},C)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:R})=>{var v;if(this.socket.setAuth(),R===void 0){t==null||t(hl.SUBSCRIBED);return}else{const D=this.bindings.postgres_changes,z=(v=D==null?void 0:D.length)!==null&&v!==void 0?v:0,L=[];for(let N=0;N<z;N++){const M=D[N],{filter:{event:G,schema:w,table:O,filter:A}}=M,y=R&&R[N];if(y&&y.event===G&&y.schema===w&&y.table===O&&y.filter===A)L.push(Object.assign(Object.assign({},M),{id:y.id}));else{this.unsubscribe(),this.state=fi.errored,t==null||t(hl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,t&&t(hl.SUBSCRIBED);return}}).receive("error",R=>{this.state=fi.errored,t==null||t(hl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(R).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(hl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,i){return this.state===fi.joined&&t===sd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,i)}async httpSend(t,n,i={}){var r;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(r=i.timeout)!==null&&r!==void 0?r:this.timeout);if(d.status===202)return{success:!0};let g=d.statusText;try{const m=await d.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(t,n={}){var i,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:f}=t,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var f,d,g;const m=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((g=(d=(f=this.params)===null||f===void 0?void 0:f.config)===null||d===void 0?void 0:d.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=fi.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Lr.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Hp(this,Lr.leave,{},t),i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=fi.closed,this.bindings={}}async _fetchWithTimeout(t,n,i){const r=new AbortController,l=setTimeout(()=>r.abort(),i),f=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(l),f}_push(t,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Hp(this,t,n,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>C_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,i){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,i){var r,l;const f=t.toLocaleLowerCase(),{close:d,error:g,leave:m,join:_}=Lr;if(i&&[d,g,m,_].indexOf(f)>=0&&i!==this._joinRef())return;let E=this._onMessage(f,n,i);if(n&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(R=>{var v,D,z;return((v=R.filter)===null||v===void 0?void 0:v.event)==="*"||((z=(D=R.filter)===null||D===void 0?void 0:D.event)===null||z===void 0?void 0:z.toLocaleLowerCase())===f}).map(R=>R.callback(E,i)):(l=this.bindings[f])===null||l===void 0||l.filter(R=>{var v,D,z,L,N,M;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in R){const G=R.id,w=(v=R.filter)===null||v===void 0?void 0:v.event;return G&&((D=n.ids)===null||D===void 0?void 0:D.includes(G))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((z=n.data)===null||z===void 0?void 0:z.type.toLocaleLowerCase()))}else{const G=(N=(L=R==null?void 0:R.filter)===null||L===void 0?void 0:L.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return G==="*"||G===((M=n==null?void 0:n.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===f}).map(R=>{if(typeof E=="object"&&"ids"in E){const v=E.data,{schema:D,table:z,commit_timestamp:L,type:N,errors:M}=v;E=Object.assign(Object.assign({},{schema:D,table:z,commit_timestamp:L,eventType:N,new:{},old:{},errors:M}),this._getPayloadRecords(v))}R.callback(E,i)})}_isClosed(){return this.state===fi.closed}_isJoined(){return this.state===fi.joined}_isJoining(){return this.state===fi.joining}_isLeaving(){return this.state===fi.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,i){const r=t.toLocaleLowerCase(),l={type:r,filter:n,callback:i};return this.bindings[r]?this.bindings[r].push(l):this.bindings[r]=[l],this}_off(t,n){const i=t.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var l;return!(((l=r.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&ov.isEqual(r.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(t[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Lr.close,{},t)}_onError(t){this._on(Lr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=fi.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=Sy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=Sy(t.columns,t.old_record)),n}}const Pp=()=>{},sg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},N_=[1e3,2e3,5e3,1e4],D_=1e4,j_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class U_{constructor(t,n){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Lm,this.transport=null,this.heartbeatIntervalMs=sg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Pp,this.ref=0,this.reconnectTimer=null,this.logger=Pp,this.conn=null,this.sendBuffer=[],this.serializer=new T_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let l;return r?l=r:typeof fetch>"u"?l=(...f)=>mf(async()=>{const{default:d}=await Promise.resolve().then(()=>Su);return{default:d}},void 0).then(({default:d})=>d(...f)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...f)=>l(...f)},!(!((i=n==null?void 0:n.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${Gm.websocket}`,this.httpEndpoint=QS(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=y_.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:__}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,i){this.logger(t,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case ad.connecting:return uu.Connecting;case ad.open:return uu.Open;case ad.closing:return uu.Closing;default:return uu.Closed}}isConnected(){return this.connectionState()===uu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const i=`realtime:${t}`,r=this.getChannels().find(l=>l.topic===i);if(r)return r;{const l=new ov(`realtime:${t}`,n,this);return this.channels.push(l),l}}push(t){const{topic:n,event:i,payload:r,ref:l}=t,f=()=>{this.encode(t,d=>{var g;(g=this.conn)===null||g===void 0||g.send(d)})};this.log("push",`${n} ${i} (${l})`,r),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(E_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},sg.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:l,ref:f}=n,d=f?`(${f})`:"",g=l.status||"";this.log("receive",`${g} ${i} ${r} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(r,l,f)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Lr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const i=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${i}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const i=new Blob([j_],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(i=>{const r={access_token:n,version:b_};n&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Lr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(i=>{try{i(n)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(i){this.log("error",`error triggering ${t} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new YS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},sg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,i,r,l,f,d,g,m,_;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(i=t==null?void 0:t.timeout)!==null&&i!==void 0?i:Lm,this.heartbeatIntervalMs=(r=t==null?void 0:t.heartbeatIntervalMs)!==null&&r!==void 0?r:sg.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(f=t==null?void 0:t.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(d=t==null?void 0:t.heartbeatCallback)!==null&&d!==void 0?d:Pp,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(C=>N_[C-1]||D_),this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((C,E)=>E(JSON.stringify(C))),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class uv extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Un(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class B_ extends uv{constructor(t,n,i){super(t),this.name="StorageApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Pm extends uv{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const cv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>mf(async()=>{const{default:i}=await Promise.resolve().then(()=>Su);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},z_=()=>Wt(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield mf(()=>Promise.resolve().then(()=>Su),void 0)).Response:Response}),Im=o=>{if(Array.isArray(o))return o.map(n=>Im(n));if(typeof o=="function"||o!==Object(o))return o;const t={};return Object.entries(o).forEach(([n,i])=>{const r=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[r]=Im(i)}),t},L_=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Ip=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),G_=(o,t,n)=>Wt(void 0,void 0,void 0,function*(){const i=yield z_();o instanceof i&&!(n!=null&&n.noResolveJson)?o.json().then(r=>{const l=o.status||500,f=(r==null?void 0:r.statusCode)||l+"";t(new B_(Ip(r),l,f))}).catch(r=>{t(new Pm(Ip(r),r))}):t(new Pm(Ip(o),o))}),H_=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"||!i?r:(L_(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,t!=null&&t.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),n))};function pd(o,t,n,i,r,l){return Wt(this,void 0,void 0,function*(){return new Promise((f,d)=>{o(n,H_(t,i,r,l)).then(g=>{if(!g.ok)throw g;return i!=null&&i.noResolveJson?g:g.json()}).then(g=>f(g)).catch(g=>G_(g,d,i))})})}function cd(o,t,n,i){return Wt(this,void 0,void 0,function*(){return pd(o,"GET",t,n,i)})}function zr(o,t,n,i,r){return Wt(this,void 0,void 0,function*(){return pd(o,"POST",t,i,r,n)})}function km(o,t,n,i,r){return Wt(this,void 0,void 0,function*(){return pd(o,"PUT",t,i,r,n)})}function P_(o,t,n,i){return Wt(this,void 0,void 0,function*(){return pd(o,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function fv(o,t,n,i,r){return Wt(this,void 0,void 0,function*(){return pd(o,"DELETE",t,i,r,n)})}class I_{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return Wt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Un(t))return{data:null,error:t};throw t}})}}var XS;class k_{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[XS]="BlobDownloadBuilder",this.promise=null}asStream(){return new I_(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Wt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Un(t))return{data:null,error:t};throw t}})}}XS=Symbol.toStringTag;const q_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ey={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class V_{constructor(t,n={},i,r){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=i,this.fetch=cv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,i,r){return Wt(this,void 0,void 0,function*(){try{let l;const f=Object.assign(Object.assign({},Ey),r);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(f.upsert)});const g=f.metadata;typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",f.cacheControl),g&&l.append("metadata",this.encodeMetadata(g)),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.append("cacheControl",f.cacheControl),g&&l.append("metadata",this.encodeMetadata(g))):(l=i,d["cache-control"]=`max-age=${f.cacheControl}`,d["content-type"]=f.contentType,g&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),r!=null&&r.headers&&(d=Object.assign(Object.assign({},d),r.headers));const m=this._removeEmptyFolders(n),_=this._getFinalPath(m),C=yield(t=="PUT"?km:zr)(this.fetch,`${this.url}/object/${_}`,l,Object.assign({headers:d},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:C.Id,fullPath:C.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Un(l))return{data:null,error:l};throw l}})}upload(t,n,i){return Wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,i)})}uploadToSignedUrl(t,n,i,r){return Wt(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),f=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${f}`);d.searchParams.set("token",n);try{let g;const m=Object.assign({upsert:Ey.upsert},r),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&i instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",i)):typeof FormData<"u"&&i instanceof FormData?(g=i,g.append("cacheControl",m.cacheControl)):(g=i,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType);const C=yield km(this.fetch,d.toString(),g,{headers:_});return{data:{path:l,fullPath:C.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(Un(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(t,n){return Wt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const l=yield zr(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),f=new URL(this.url+l.url),d=f.searchParams.get("token");if(!d)throw new uv("No token returned by API");return{data:{signedUrl:f.toString(),path:t,token:d},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Un(i))return{data:null,error:i};throw i}})}update(t,n,i){return Wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,i)})}move(t,n,i){return Wt(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Un(r))return{data:null,error:r};throw r}})}copy(t,n,i){return Wt(this,void 0,void 0,function*(){try{return{data:{path:(yield zr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Un(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,i){return Wt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),l=yield zr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const f=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${f}`)},{data:l,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Un(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,i){return Wt(this,void 0,void 0,function*(){try{const r=yield zr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),l=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${l}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Un(r))return{data:null,error:r};throw r}})}download(t,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),f=l?`?${l}`:"",d=this._getFinalPath(t),g=()=>cd(this.fetch,`${this.url}/${r}/${d}${f}`,{headers:this.headers,noResolveJson:!0});return new k_(g,this.shouldThrowOnError)}info(t){return Wt(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const i=yield cd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Im(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Un(i))return{data:null,error:i};throw i}})}exists(t){return Wt(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield P_(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Un(i)&&i instanceof Pm){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,n){const i=this._getFinalPath(t),r=[],l=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&r.push(l);const d=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});g!==""&&r.push(g);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${i}${m}`)}}}remove(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield fv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Un(n))return{data:null,error:n};throw n}})}list(t,n,i){return Wt(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},q_),n),{prefix:t||""});return{data:yield zr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Un(r))return{data:null,error:r};throw r}})}listV2(t,n){return Wt(this,void 0,void 0,function*(){try{const i=Object.assign({},t);return{data:yield zr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Un(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const FS="2.76.1",JS={"X-Client-Info":`storage-js/${FS}`};class Y_{constructor(t,n={},i,r){this.shouldThrowOnError=!1;const l=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},JS),n),this.fetch=cv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Wt(this,void 0,void 0,function*(){try{return{data:yield cd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Un(t))return{data:null,error:t};throw t}})}getBucket(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield cd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Un(n))return{data:null,error:n};throw n}})}createBucket(t){return Wt(this,arguments,void 0,function*(n,i={public:!1}){try{return{data:yield zr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Un(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return Wt(this,void 0,void 0,function*(){try{return{data:yield km(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Un(i))return{data:null,error:i};throw i}})}emptyBucket(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Un(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield fv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Un(n))return{data:null,error:n};throw n}})}}class K_{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},JS),n),this.fetch=cv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Un(n))return{data:null,error:n};throw n}})}listBuckets(t){return Wt(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const i=n.toString(),r=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`,l=yield cd(this.fetch,r,{headers:this.headers});return{data:Array.isArray(l)?l.filter(d=>d.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Un(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield fv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Un(n))return{data:null,error:n};throw n}})}}const hv={"X-Client-Info":`storage-js/${FS}`,"Content-Type":"application/json"};class ZS extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ja(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class kp extends ZS{constructor(t,n,i){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Q_ extends ZS{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var Cy;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Cy||(Cy={}));const dv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>mf(async()=>{const{default:i}=await Promise.resolve().then(()=>Su);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},X_=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Ty=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),F_=(o,t,n)=>Wt(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!(n!=null&&n.noResolveJson)){const r=o.status||500,l=o;if(typeof l.json=="function")l.json().then(f=>{const d=(f==null?void 0:f.statusCode)||(f==null?void 0:f.code)||r+"";t(new kp(Ty(f),r,d))}).catch(()=>{const f=r+"",d=l.statusText||`HTTP ${r} error`;t(new kp(d,r,f))});else{const f=r+"",d=l.statusText||`HTTP ${r} error`;t(new kp(d,r,f))}}else t(new Q_(Ty(o),o))}),J_=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return i?(X_(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),n)):r};function Z_(o,t,n,i,r,l){return Wt(this,void 0,void 0,function*(){return new Promise((f,d)=>{o(n,J_(t,i,r,l)).then(g=>{if(!g.ok)throw g;if(i!=null&&i.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>f(g)).catch(g=>F_(g,d,i))})})}function Ua(o,t,n,i,r){return Wt(this,void 0,void 0,function*(){return Z_(o,"POST",t,i,r,n)})}class W_{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hv),n),this.fetch=dv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Wt(this,void 0,void 0,function*(){try{return{data:(yield Ua(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}getIndex(t,n){return Wt(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ja(i))return{data:null,error:i};throw i}})}listIndexes(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return Wt(this,void 0,void 0,function*(){try{return{data:(yield Ua(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ja(i))return{data:null,error:i};throw i}})}}class $_{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hv),n),this.fetch=dv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Wt(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Ua(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}getVectors(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}listVectors(t){return Wt(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Ua(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}queryVectors(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}deleteVectors(t){return Wt(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Ua(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}}class tE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hv),n),this.fetch=dv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Wt(this,void 0,void 0,function*(){try{return{data:(yield Ua(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}getBucket(t){return Wt(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}listBuckets(){return Wt(this,arguments,void 0,function*(t={}){try{return{data:yield Ua(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Wt(this,void 0,void 0,function*(){try{return{data:(yield Ua(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ja(n))return{data:null,error:n};throw n}})}}class eE extends tE{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new nE(this.url,this.headers,t,this.fetch)}}class nE extends W_{constructor(t,n,i,r){super(t,n,r),this.vectorBucketName=i}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Wt(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Wt(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Wt(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Wt(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new iE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class iE extends $_{constructor(t,n,i,r,l){super(t,n,l),this.vectorBucketName=i,this.indexName=r}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Wt(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Wt(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Wt(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Wt(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Wt(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class aE extends Y_{constructor(t,n={},i,r){super(t,n,i,r)}from(t){return new V_(this.url,this.headers,t,this.fetch)}get vectors(){return new eE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new K_(this.url+"/iceberg",this.headers,this.fetch)}}const rE="2.76.1";let $h="";typeof Deno<"u"?$h="deno":typeof document<"u"?$h="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$h="react-native":$h="node";const sE={"X-Client-Info":`supabase-js-${$h}/${rE}`},lE={headers:sE},oE={schema:"public"},uE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},cE={},fE=o=>{let t;return o?t=o:typeof fetch>"u"?t=HS:t=fetch,(...n)=>t(...n)},hE=()=>typeof Headers>"u"?PS:Headers,dE=(o,t,n)=>{const i=fE(n),r=hE();return async(l,f)=>{var d;const g=(d=await t())!==null&&d!==void 0?d:o;let m=new r(f==null?void 0:f.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),i(l,Object.assign(Object.assign({},f),{headers:m}))}};function gE(o){return o.endsWith("/")?o:o+"/"}function pE(o,t){var n,i;const{db:r,auth:l,realtime:f,global:d}=o,{db:g,auth:m,realtime:_,global:C}=t,E={db:Object.assign(Object.assign({},g),r),auth:Object.assign(Object.assign({},m),l),realtime:Object.assign(Object.assign({},_),f),storage:{},global:Object.assign(Object.assign(Object.assign({},C),d),{headers:Object.assign(Object.assign({},(n=C==null?void 0:C.headers)!==null&&n!==void 0?n:{}),(i=d==null?void 0:d.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return o.accessToken?E.accessToken=o.accessToken:delete E.accessToken,E}function mE(o){const t=o==null?void 0:o.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(gE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const WS="2.76.1",ef=30*1e3,qm=3,qp=qm*ef,vE="http://localhost:9999",yE="supabase.auth.token",SE={"X-Client-Info":`gotrue-js/${WS}`},Vm="X-Supabase-Api-Version",$S={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,_E=600*1e3;class fd extends Error{constructor(t,n,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function ue(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class EE extends fd{constructor(t,n,i){super(t,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function CE(o){return ue(o)&&o.name==="AuthApiError"}class cu extends fd{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class mo extends fd{constructor(t,n,i,r){super(t,i,r),this.name=n,this.status=i}}class so extends mo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function TE(o){return ue(o)&&o.name==="AuthSessionMissingError"}class Qc extends mo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class lg extends mo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class og extends mo{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function AE(o){return ue(o)&&o.name==="AuthImplicitGrantRedirectError"}class Ay extends mo{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ym extends mo{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Vp(o){return ue(o)&&o.name==="AuthRetryableFetchError"}class Oy extends mo{constructor(t,n,i){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}class Km extends mo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const yg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ry=` 	
\r=`.split(""),OE=(()=>{const o=new Array(128);for(let t=0;t<o.length;t+=1)o[t]=-1;for(let t=0;t<Ry.length;t+=1)o[Ry[t].charCodeAt(0)]=-2;for(let t=0;t<yg.length;t+=1)o[yg[t].charCodeAt(0)]=t;return o})();function wy(o,t,n){if(o!==null)for(t.queue=t.queue<<8|o,t.queuedBits+=8;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(yg[i]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(yg[i]),t.queuedBits-=6}}function t4(o,t,n){const i=OE[o];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function xy(o){const t=[],n=f=>{t.push(String.fromCodePoint(f))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},l=f=>{xE(f,i,n)};for(let f=0;f<o.length;f+=1)t4(o.charCodeAt(f),r,l);return t.join("")}function RE(o,t){if(o<=127){t(o);return}else if(o<=2047){t(192|o>>6),t(128|o&63);return}else if(o<=65535){t(224|o>>12),t(128|o>>6&63),t(128|o&63);return}else if(o<=1114111){t(240|o>>18),t(128|o>>12&63),t(128|o>>6&63),t(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function wE(o,t){for(let n=0;n<o.length;n+=1){let i=o.charCodeAt(n);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(o.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}RE(i,t)}}function xE(o,t,n){if(t.utf8seq===0){if(o<=127){n(o);return}for(let i=1;i<6;i+=1)if((o>>7-i&1)===0){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=o&31;else if(t.utf8seq===3)t.codepoint=o&15;else if(t.utf8seq===4)t.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|o&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function rf(o){const t=[],n={queue:0,queuedBits:0},i=r=>{t.push(r)};for(let r=0;r<o.length;r+=1)t4(o.charCodeAt(r),n,i);return new Uint8Array(t)}function ME(o){const t=[];return wE(o,n=>t.push(n)),new Uint8Array(t)}function hu(o){const t=[],n={queue:0,queuedBits:0},i=r=>{t.push(r)};return o.forEach(r=>wy(r,n,i)),wy(null,n,i),t.join("")}function NE(o){return Math.round(Date.now()/1e3)+o}function DE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o=="x"?t:t&3|8).toString(16)})}const Na=()=>typeof window<"u"&&typeof document<"u",su={tested:!1,writable:!1},e4=()=>{if(!Na())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(su.tested)return su.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),su.tested=!0,su.writable=!0}catch{su.tested=!0,su.writable=!1}return su.writable};function jE(o){const t={},n=new URL(o);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,l)=>{t[l]=r})}catch{}return n.searchParams.forEach((i,r)=>{t[r]=i}),t}const n4=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>mf(async()=>{const{default:i}=await Promise.resolve().then(()=>Su);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},UE=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",nf=async(o,t,n)=>{await o.setItem(t,JSON.stringify(n))},lu=async(o,t)=>{const n=await o.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},no=async(o,t)=>{await o.removeItem(t)};class Ng{constructor(){this.promise=new Ng.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Ng.promiseConstructor=Promise;function Yp(o){const t=o.split(".");if(t.length!==3)throw new Km("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!bE.test(t[i]))throw new Km("JWT not in base64url format");return{header:JSON.parse(xy(t[0])),payload:JSON.parse(xy(t[1])),signature:rf(t[2]),raw:{header:t[0],payload:t[1]}}}async function BE(o){return await new Promise(t=>{setTimeout(()=>t(null),o)})}function zE(o,t){return new Promise((i,r)=>{(async()=>{for(let l=0;l<1/0;l++)try{const f=await o(l);if(!t(l,null,f)){i(f);return}}catch(f){if(!t(l,f)){r(f);return}}})()})}function LE(o){return("0"+o.toString(16)).substr(-2)}function GE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let r="";for(let l=0;l<56;l++)r+=n.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(t),Array.from(t,LE).join("")}async function HE(o){const n=new TextEncoder().encode(o),i=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(i);return Array.from(r).map(l=>String.fromCharCode(l)).join("")}async function PE(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const n=await HE(o);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Xc(o,t,n=!1){const i=GE();let r=i;n&&(r+="/PASSWORD_RECOVERY"),await nf(o,`${t}-code-verifier`,r);const l=await PE(i);return[l,i===l?"plain":"s256"]}const IE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function kE(o){const t=o.headers.get(Vm);if(!t||!t.match(IE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function qE(o){if(!o)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(o<=t)throw new Error("JWT has expired")}function VE(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const YE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Fc(o){if(!YE.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Kp(){const o={};return new Proxy(o,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function My(o){return JSON.parse(JSON.stringify(o))}const ou=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),KE=[502,503,504];async function Ny(o){var t;if(!UE(o))throw new Ym(ou(o),0);if(KE.includes(o.status))throw new Ym(ou(o),o.status);let n;try{n=await o.json()}catch(l){throw new cu(ou(l),l)}let i;const r=kE(o);if(r&&r.getTime()>=$S["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new Oy(ou(n),o.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new so}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,f)=>l&&typeof f=="string",!0))throw new Oy(ou(n),o.status,n.weak_password.reasons);throw new EE(ou(n),o.status||500,i)}const QE=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))};async function Se(o,t,n,i){var r;const l=Object.assign({},i==null?void 0:i.headers);l[Vm]||(l[Vm]=$S["2024-01-01"].name),i!=null&&i.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const f=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(f.redirect_to=i.redirectTo);const d=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",g=await XE(o,t,n+d,{headers:l,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(g):{data:Object.assign({},g),error:null}}async function XE(o,t,n,i,r,l){const f=QE(t,i,r,l);let d;try{d=await o(n,Object.assign({},f))}catch(g){throw console.error(g),new Ym(ou(g),0)}if(d.ok||await Ny(d),i!=null&&i.noResolveJson)return d;try{return await d.json()}catch(g){await Ny(g)}}function Br(o){var t;let n=null;ZE(o)&&(n=Object.assign({},o),o.expires_at||(n.expires_at=NE(o.expires_in)));const i=(t=o.user)!==null&&t!==void 0?t:o;return{data:{session:n,user:i},error:null}}function Dy(o){const t=Br(o);return!t.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(t.data.weak_password=o.weak_password),t}function oo(o){var t;return{data:{user:(t=o.user)!==null&&t!==void 0?t:o},error:null}}function FE(o){return{data:o,error:null}}function JE(o){const{action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:l}=o,f=pf(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:l},g=Object.assign({},f);return{data:{properties:d,user:g},error:null}}function jy(o){return o}function ZE(o){return o.access_token&&o.refresh_token&&o.expires_in}const Qp=["global","local","others"];class WE{constructor({url:t="",headers:n={},fetch:i}){this.url=t,this.headers=n,this.fetch=n4(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Qp[0]){if(Qp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Qp.join(", ")}`);try{return await Se(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(ue(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,n={}){try{return await Se(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:oo})}catch(i){if(ue(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:n}=t,i=pf(t,["options"]),r=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await Se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:JE,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ue(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Se(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:oo})}catch(n){if(ue(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,i,r,l,f,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:jy});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(v.split(";")[1].split("=")[1]);m[`${z}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(ue(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){Fc(t);try{return await Se(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:oo})}catch(n){if(ue(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Fc(t);try{return await Se(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:oo})}catch(i){if(ue(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,n=!1){Fc(t);try{return await Se(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:oo})}catch(i){if(ue(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){Fc(t.userId);try{const{data:n,error:i}=await Se(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:i}}catch(n){if(ue(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Fc(t.userId),Fc(t.id);try{return{data:await Se(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(ue(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,i,r,l,f,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:jy});if(_.error)throw _.error;const C=await _.json(),E=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return R.length>0&&(R.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(v.split(";")[1].split("=")[1]);m[`${z}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(ue(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ue(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ue(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Se(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ue(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ue(n))return{data:null,error:n};throw n}}}function Uy(o={}){return{getItem:t=>o[t]||null,setItem:(t,n)=>{o[t]=n},removeItem:t=>{delete o[t]}}}const Jc={debug:!!(globalThis&&e4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class i4 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class $E extends i4{}async function tC(o,t,n){Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,r.name);try{return await n()}finally{Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,r.name)}}else{if(t===0)throw Jc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new $E(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Jc.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function eC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function a4(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function nC(o){return parseInt(o,16)}function iC(o){const t=new TextEncoder().encode(o);return"0x"+Array.from(t,i=>i.toString(16).padStart(2,"0")).join("")}function aC(o){var t;const{chainId:n,domain:i,expirationTime:r,issuedAt:l=new Date,nonce:f,notBefore:d,requestId:g,resources:m,scheme:_,uri:C,version:E}=o;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((t=o.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const R=a4(o.address),v=_?`${_}://${i}`:i,D=o.statement?`${o.statement}
`:"",z=`${v} wants you to sign in with your Ethereum account:
${R}

${D}`;let L=`URI: ${C}
Version: ${E}
Chain ID: ${n}${f?`
Nonce: ${f}`:""}
Issued At: ${l.toISOString()}`;if(r&&(L+=`
Expiration Time: ${r.toISOString()}`),d&&(L+=`
Not Before: ${d.toISOString()}`),g&&(L+=`
Request ID: ${g}`),m){let N=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);N+=`
- ${M}`}L+=N}return`${z}
${L}`}class $n extends Error{constructor({message:t,code:n,cause:i,name:r}){var l;super(t,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=r??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class Sg extends $n{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function rC({error:o,options:t}){var n,i,r;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $n({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new $n({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(t.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new $n({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new $n({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new $n({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new $n({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new $n({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new $n({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const f=window.location.hostname;if(r4(f)){if(l.rp.id!==f)return new $n({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new $n({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new $n({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new $n({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new $n({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function sC({error:o,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $n({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new $n({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const i=window.location.hostname;if(r4(i)){if(n.rpId!==i)return new $n({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new $n({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new $n({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new $n({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class lC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const oC=new lC;function uC(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:t,user:n,excludeCredentials:i}=o,r=pf(o,["challenge","user","excludeCredentials"]),l=rf(t).buffer,f=Object.assign(Object.assign({},n),{id:rf(n.id).buffer}),d=Object.assign(Object.assign({},r),{challenge:l,user:f});if(i&&i.length>0){d.excludeCredentials=new Array(i.length);for(let g=0;g<i.length;g++){const m=i[g];d.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:rf(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function cC(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:t,allowCredentials:n}=o,i=pf(o,["challenge","allowCredentials"]),r=rf(t).buffer,l=Object.assign(Object.assign({},i),{challenge:r});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const d=n[f];l.allowCredentials[f]=Object.assign(Object.assign({},d),{id:rf(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function fC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o;return{id:o.id,rawId:o.id,response:{attestationObject:hu(new Uint8Array(o.response.attestationObject)),clientDataJSON:hu(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function hC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o,i=o.getClientExtensionResults(),r=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:hu(new Uint8Array(r.authenticatorData)),clientDataJSON:hu(new Uint8Array(r.clientDataJSON)),signature:hu(new Uint8Array(r.signature)),userHandle:r.userHandle?hu(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function r4(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function By(){var o,t;return!!(Na()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator==null?void 0:navigator.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function dC(o){try{const t=await navigator.credentials.create(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sg("Browser returned unexpected credential type",t)}:{data:null,error:new Sg("Empty credential response",t)}}catch(t){return{data:null,error:rC({error:t,options:o})}}}async function gC(o){try{const t=await navigator.credentials.get(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sg("Browser returned unexpected credential type",t)}:{data:null,error:new Sg("Empty credential response",t)}}catch(t){return{data:null,error:sC({error:t,options:o})}}}const pC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},mC={userVerification:"preferred",hints:["security-key"]};function bg(...o){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),i={};for(const r of o)if(r)for(const l in r){const f=r[l];if(f!==void 0)if(Array.isArray(f))i[l]=f;else if(n(f))i[l]=f;else if(t(f)){const d=i[l];t(d)?i[l]=bg(d,f):i[l]=bg(f)}else i[l]=f}return i}function vC(o,t){return bg(pC,o,t||{})}function yC(o,t){return bg(mC,o,t||{})}class SC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:i,signal:r},l){try{const{data:f,error:d}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!f)return{data:null,error:d};const g=r??oC.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=vC(f.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:C}=await dC({publicKey:m,signal:g});return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}case"request":{const m=yC(f.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:C}=await gC(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}}}catch(f){return ue(f)?{data:null,error:f}:{data:null,error:new cu("Unexpected error in challenge",f)}}}async _verify({challengeId:t,factorId:n,webauthn:i}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:i})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r}},l){if(!n)return{data:null,error:new fd("rpId is required for WebAuthn authentication")};try{if(!By())return{data:null,error:new cu("Browser does not support WebAuthn",null)};const{data:f,error:d}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:i},signal:r},{request:l});if(!f)return{data:null,error:d};const{webauthn:g}=f;return this._verify({factorId:t,challengeId:f.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:i,credential_response:g.credential_response}})}catch(f){return ue(f)?{data:null,error:f}:{data:null,error:new cu("Unexpected error in authenticate",f)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r},l){if(!n)return{data:null,error:new fd("rpId is required for WebAuthn registration")};try{if(!By())return{data:null,error:new cu("Browser does not support WebAuthn",null)};const{data:f,error:d}=await this._enroll({friendlyName:t});if(!f)return await this.client.mfa.listFactors().then(_=>{var C;return(C=_.data)===null||C===void 0?void 0:C.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===t&&E.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:d};const{data:g,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:n,rpOrigins:i},signal:r},{create:l});return g?this._verify({factorId:f.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:i,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(f){return ue(f)?{data:null,error:f}:{data:null,error:new cu("Unexpected error in register",f)}}}}eC();const bC={url:vE,storageKey:yE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:SE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function zy(o,t,n){return await n()}const Zc={};class hd{get jwks(){var t,n;return(n=(t=Zc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Zc[this.storageKey]=Object.assign(Object.assign({},Zc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Zc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Zc[this.storageKey]=Object.assign(Object.assign({},Zc[this.storageKey]),{cachedAt:t})}constructor(t){var n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=hd.nextInstanceID,hd.nextInstanceID+=1,this.instanceID>0&&Na()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},bC),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new WE({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=n4(r.fetch),this.lock=r.lock||zy,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Na()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=tC:this.lock=zy,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new SC(this)},this.persistSession?(r.storage?this.storage=r.storage:e4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Uy(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=Uy(this.memoryStorage)),Na()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${WS}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=jE(window.location.href);let i="none";if(this._isImplicitGrantCallback(n)?i="implicit":await this._isPKCECallback(n)&&(i="pkce"),Na()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:l}=await this._getSessionFromURL(n,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),AE(l)){const g=(t=l.details)===null||t===void 0?void 0:t.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:f,redirectType:d}=r;return this._debug("#_initialize()","detected session in URL",f,"redirect type",d),await this._saveSession(f),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ue(n)?{error:n}:{error:new cu("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,i,r;try{const l=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:Br}),{data:f,error:d}=l;if(d||!f)return{data:{user:null,session:null},error:d};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(ue(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var n,i,r;try{let l;if("email"in t){const{email:_,password:C,options:E}=t;let R=null,v=null;this.flowType==="pkce"&&([R,v]=await Xc(this.storage,this.storageKey)),l=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:_,password:C,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:R,code_challenge_method:v},xform:Br})}else if("phone"in t){const{phone:_,password:C,options:E}=t;l=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:C,data:(i=E==null?void 0:E.data)!==null&&i!==void 0?i:{},channel:(r=E==null?void 0:E.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:Br})}else throw new lg("You must provide either an email or phone number and a password");const{data:f,error:d}=l;if(d||!f)return{data:{user:null,session:null},error:d};const g=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(ue(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:f,options:d}=t;n=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:f,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Dy})}else if("phone"in t){const{phone:l,password:f,options:d}=t;n=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:f,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Dy})}else throw new lg("You must provide either an email or phone number and a password");const{data:i,error:r}=n;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Qc}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(n){if(ue(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,i,r,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,i,r,l,f,d,g,m,_,C,E;let R,v;if("message"in t)R=t.message,v=t.signature;else{const{chain:D,wallet:z,statement:L,options:N}=t;let M;if(Na())if(typeof z=="object")M=z;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")M=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof z!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=z}const G=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href),w=await M.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!w||w.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=a4(w[0]);let A=(i=N==null?void 0:N.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!A){const B=await M.request({method:"eth_chainId"});A=nC(B)}const y={domain:G.host,address:O,statement:L,uri:G.href,version:"1",chainId:A,nonce:(r=N==null?void 0:N.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(f=(l=N==null?void 0:N.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(d=N==null?void 0:N.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(g=N==null?void 0:N.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=N==null?void 0:N.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=N==null?void 0:N.signInWithEthereum)===null||_===void 0?void 0:_.resources};R=aC(y),v=await M.request({method:"personal_sign",params:[iC(R),O]})}try{const{data:D,error:z}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:R,signature:v},!((C=t.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(E=t.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:Br});if(z)throw z;return!D||!D.session||!D.user?{data:{user:null,session:null},error:new Qc}:(D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),{data:Object.assign({},D),error:z})}catch(D){if(ue(D))return{data:{user:null,session:null},error:D};throw D}}async signInWithSolana(t){var n,i,r,l,f,d,g,m,_,C,E,R;let v,D;if("message"in t)v=t.message,D=t.signature;else{const{chain:z,wallet:L,statement:N,options:M}=t;let G;if(Na())if(typeof L=="object")G=L;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))G=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(M!=null&&M.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=L}const w=new URL((n=M==null?void 0:M.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in G&&G.signIn){const O=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M==null?void 0:M.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),N?{statement:N}:null));let A;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")A=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)A=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)v=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),D=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${w.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${(r=(i=M==null?void 0:M.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((l=M==null?void 0:M.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((f=M==null?void 0:M.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((d=M==null?void 0:M.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((g=M==null?void 0:M.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M==null?void 0:M.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((C=(_=M==null?void 0:M.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||C===void 0)&&C.length?["Resources",...M.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const O=await G.signMessage(new TextEncoder().encode(v),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=O}}try{const{data:z,error:L}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:hu(D)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(R=t.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:Br});if(L)throw L;return!z||!z.session||!z.user?{data:{user:null,session:null},error:new Qc}:(z.session&&(await this._saveSession(z.session),await this._notifyAllSubscribers("SIGNED_IN",z.session)),{data:Object.assign({},z),error:L})}catch(z){if(ue(z))return{data:{user:null,session:null},error:z};throw z}}async _exchangeCodeForSession(t){const n=await lu(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(n??"").split("/");try{const{data:l,error:f}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:Br});if(await no(this.storage,`${this.storageKey}-code-verifier`),f)throw f;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Qc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:r??null}),error:f})}catch(l){if(ue(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:n,provider:i,token:r,access_token:l,nonce:f}=t,d=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:l,nonce:f,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Br}),{data:g,error:m}=d;return m?{data:{user:null,session:null},error:m}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Qc}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:m})}catch(n){if(ue(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,i,r,l,f;try{if("email"in t){const{email:d,options:g}=t;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await Xc(this.storage,this.storageKey));const{error:C}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(i=g==null?void 0:g.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:d,options:g}=t,{data:m,error:_}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(f=g==null?void 0:g.channel)!==null&&f!==void 0?f:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_}}throw new lg("You must provide either an email or phone number.")}catch(d){if(ue(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(t){var n,i;try{let r,l;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:f,error:d}=await Se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:r,xform:Br});if(d)throw d;if(!f)throw new Error("An error occurred on token verification.");const g=f.session,m=f.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(r){if(ue(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,i,r;try{let l=null,f=null;return this.flowType==="pkce"&&([l,f]=await Xc(this.storage,this.storageKey)),await Se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:f}),headers:this.headers,xform:FE})}catch(l){if(ue(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;if(i)throw i;if(!n)throw new so;const{error:r}=await Se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:i,type:r,options:l}=t,{error:f}=await Se(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}else if("phone"in t){const{phone:i,type:r,options:l}=t,{data:f,error:d}=await Se(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:d}}throw new lg("You must provide either an email or phone number and a type")}catch(n){if(ue(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await lu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at*1e3-Date.now()<qp:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.userStorage){const f=await lu(this.userStorage,this.storageKey+"-user");f!=null&&f.user?t.user=f.user:t.user=Kp()}if(this.storage.isServer&&t.user){let f=this.suppressGetSessionWarning;t=new Proxy(t,{get:(g,m,_)=>(!f&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),f=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,m,_))})}return{data:{session:t},error:null}}const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:oo}):await this._useSession(async n=>{var i,r,l;const{data:f,error:d}=n;if(d)throw d;return!(!((i=f.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new so}:await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(r=f.session)===null||r===void 0?void 0:r.access_token)!==null&&l!==void 0?l:void 0,xform:oo})})}catch(n){if(ue(n))return TE(n)&&(await this._removeSession(),await no(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async i=>{const{data:r,error:l}=i;if(l)throw l;if(!r.session)throw new so;const f=r.session;let d=null,g=null;this.flowType==="pkce"&&t.email!=null&&([d,g]=await Xc(this.storage,this.storageKey));const{data:m,error:_}=await Se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:g}),jwt:f.access_token,xform:oo});if(_)throw _;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(i){if(ue(i))return{data:{user:null},error:i};throw i}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new so;const n=Date.now()/1e3;let i=n,r=!0,l=null;const{payload:f}=Yp(t.access_token);if(f.exp&&(i=f.exp,r=i<=n),r){const{data:d,error:g}=await this._callRefreshToken(t.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:g}=await this._getUser(t.access_token);if(g)throw g;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(n){if(ue(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var i;if(!t){const{data:f,error:d}=n;if(d)throw d;t=(i=f.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new so;const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ue(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Na())throw new og("No browser detected.");if(t.error||t.error_description||t.error_code)throw new og(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Ay("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new og("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ay("No code detected.");const{data:N,error:M}=await this._exchangeCodeForSession(t.code);if(M)throw M;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:l,refresh_token:f,expires_in:d,expires_at:g,token_type:m}=t;if(!l||!d||!f||!m)throw new og("No session defined in URL");const _=Math.round(Date.now()/1e3),C=parseInt(d);let E=_+C;g&&(E=parseInt(g));const R=E-_;R*1e3<=ef&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${C}s`);const v=E-C;_-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,E,_):_-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,E,_);const{data:D,error:z}=await this._getUser(l);if(z)throw z;const L={provider_token:i,provider_refresh_token:r,access_token:l,expires_in:C,expires_at:E,refresh_token:f,token_type:m,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:L,redirectType:t.type},error:null}}catch(i){if(ue(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await lu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{error:l};const f=(i=r.session)===null||i===void 0?void 0:i.access_token;if(f){const{error:d}=await this.admin.signOut(f,t);if(d&&!(CE(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return t!=="others"&&(await this._removeSession(),await no(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=DE(),i={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async n=>{var i,r;try{const{data:{session:l},error:f}=n;if(f)throw f;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await Xc(this.storage,this.storageKey,!0));try{return await Se(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(ue(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(ue(n))return{data:null,error:n};throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:i,error:r}=await this._useSession(async l=>{var f,d,g,m,_;const{data:C,error:E}=l;if(E)throw E;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(f=t.options)===null||f===void 0?void 0:f.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=t.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Se(this.fetch,"GET",R,{headers:this.headers,jwt:(_=(m=C.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(r)throw r;return Na()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(ue(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var i;try{const{error:r,data:{session:l}}=n;if(r)throw r;const{options:f,provider:d,token:g,access_token:m,nonce:_}=t,C=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l==null?void 0:l.access_token)!==null&&i!==void 0?i:void 0,body:{provider:d,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Br}),{data:E,error:R}=C;return R?{data:{user:null,session:null},error:R}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new Qc}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:R})}catch(r){if(ue(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var i,r;const{data:l,error:f}=n;if(f)throw f;return await Se(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(ue(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await zE(async r=>(r>0&&await BE(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await Se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Br})),(r,l)=>{const f=200*Math.pow(2,r);return l&&Vp(l)&&Date.now()+f-i<ef})}catch(i){if(this._debug(n,"error",i),ue(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",i),Na()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t,n;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await lu(this.storage,this.storageKey);if(r&&this.userStorage){let f=await lu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:r.user},await nf(this.userStorage,this.storageKey+"-user",f)),r.user=(t=f==null?void 0:f.user)!==null&&t!==void 0?t:Kp()}else if(r&&!r.user&&!r.user){const f=await lu(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(r.user=f.user,await no(this.storage,this.storageKey+"-user"),await nf(this.storage,this.storageKey,r)):r.user=Kp()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const l=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<qp;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${qp}s`),l){if(this.autoRefreshToken&&r.refresh_token){const{error:f}=await this._callRefreshToken(r.refresh_token);f&&(console.error(f),Vp(f)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:d}=await this._getUser(r.access_token);!d&&(f!=null&&f.user)?(r.user=f.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(i,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(t){var n,i;if(!t)throw new so;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Ng;const{data:l,error:f}=await this._refreshAccessToken(t);if(f)throw f;if(!l.session)throw new so;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(r,"error",l),ue(l)){const f={data:null,error:l};return Vp(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(f),f}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,i=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],f=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,n)}catch(g){l.push(g)}});if(await Promise.all(f),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),i=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&n.user&&await nf(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const l=My(r);await nf(this.storage,this.storageKey,l)}else{const r=My(n);await nf(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await no(this.storage,this.storageKey),await no(this.storage,this.storageKey+"-code-verifier"),await no(this.storage,this.storageKey+"-user"),this.userStorage&&await no(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Na()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ef);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-t)/ef);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${ef}ms, refresh threshold is ${qm} ticks`),r<=qm&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof i4)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Na()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,i){const r=[`provider=${encodeURIComponent(n)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,f]=await Xc(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(f)}`});r.push(d.toString())}if(i!=null&&i.queryParams){const l=new URLSearchParams(i.queryParams);r.push(l.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;return l?{data:null,error:l}:await Se(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(ue(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var i,r;const{data:l,error:f}=n;if(f)return{data:null,error:f};const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:g,error:m}=await Se(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return m?{data:null,error:m}:(t.factorType==="totp"&&g.type==="totp"&&(!((r=g==null?void 0:g.totp)===null||r===void 0)&&r.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(n){if(ue(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{data:null,error:l};const f=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?fC(t.webauthn.credential_response):hC(t.webauthn.credential_response)})}:{code:t.code}),{data:d,error:g}=await Se(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:f,headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:g})})}catch(n){if(ue(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{data:null,error:l};const f=await Se(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});if(f.error)return f;const{data:d}=f;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:uC(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:cC(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(ue(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:i}=await this.getUser();if(i)return{data:null,error:i};const r={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])r.all.push(l),l.status==="verified"&&r[l.factor_type].push(l);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,i;const{data:{session:r},error:l}=t;if(l)return{data:null,error:l};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=Yp(r.access_token);let d=null;f.aal&&(d=f.aal);let g=d;((i=(n=r.user.factors)===null||n===void 0?void 0:n.filter(C=>C.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(g="aal2");const _=f.amr||[];return{data:{currentLevel:d,nextLevel:g,currentAuthenticationMethods:_},error:null}}))}async fetchJwk(t,n={keys:[]}){let i=n.keys.find(d=>d.kid===t);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(d=>d.kid===t),i&&this.jwks_cached_at+_E>r)return i;const{data:l,error:f}=await Se(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=r,i=l.keys.find(d=>d.kid===t),!i)?null:i}async getClaims(t,n={}){try{let i=t;if(!i){const{data:R,error:v}=await this.getSession();if(v||!R.session)return{data:null,error:v};i=R.session.access_token}const{header:r,payload:l,signature:f,raw:{header:d,payload:g}}=Yp(i);n!=null&&n.allowExpired||qE(l.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!m){const{error:R}=await this.getUser(i);if(R)throw R;return{data:{claims:l,header:r,signature:f},error:null}}const _=VE(r.alg),C=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,C,f,ME(`${d}.${g}`)))throw new Km("Invalid JWT signature");return{data:{claims:l,header:r,signature:f},error:null}}catch(i){if(ue(i))return{data:null,error:i};throw i}}}hd.nextInstanceID=0;const _C=hd;class EC extends _C{constructor(t){super(t)}}class CC{constructor(t,n,i){var r,l,f;this.supabaseUrl=t,this.supabaseKey=n;const d=mE(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const g=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:oE,realtime:cE,auth:Object.assign(Object.assign({},uE),{storageKey:g}),global:lE},_=pE(i??{},m);this.storageKey=(r=_.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(l=_.global.headers)!==null&&l!==void 0?l:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(C,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=_.auth)!==null&&f!==void 0?f:{},this.headers,_.global.fetch),this.fetch=dE(n,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new v_(new URL("rest/v1",d).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new aE(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new l_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,i)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:i}=await this.auth.getSession();return(n=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:l,storageKey:f,flowType:d,lock:g,debug:m},_,C){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new EC({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),_),storageKey:f,autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:l,flowType:d,lock:g,debug:m,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(R=>R.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new U_(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,n,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const TC=(o,t,n)=>new CC(o,t,n);function AC(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const t=o.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}AC()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const OC=void 0,RC=void 0;console.error("Missing Supabase environment variables. Please check your .env file.");const Ni=TC(OC,RC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xC=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase()),Ly=o=>{const t=xC(o);return t.charAt(0).toUpperCase()+t.slice(1)},s4=(...o)=>o.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim(),MC=o=>{for(const t in o)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var NC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DC=dt.forwardRef(({color:o="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:l,iconNode:f,...d},g)=>dt.createElement("svg",{ref:g,...NC,width:t,height:t,stroke:o,strokeWidth:i?Number(n)*24/Number(t):n,className:s4("lucide",r),...!l&&!MC(d)&&{"aria-hidden":"true"},...d},[...f.map(([m,_])=>dt.createElement(m,_)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=(o,t)=>{const n=dt.forwardRef(({className:i,...r},l)=>dt.createElement(DC,{ref:l,iconNode:t,className:s4(`lucide-${wC(Ly(o))}`,`lucide-${o}`,i),...r}));return n.displayName=Ly(o),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jC=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],UC=md("eraser",jC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],zC=md("pen",BC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LC=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],GC=md("redo",LC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],PC=md("trash-2",HC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],kC=md("undo",IC),cl={width:800,height:600},qC=.65,VC=2.2,ug="studentCanvasPrefs",Xp=2,Gy=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,YC=({sharedImage:o,canvasWidth:t,canvasHeight:n})=>{const[i,r]=dt.useState(null);if(dt.useEffect(()=>{if(!o){r(null);return}const C=new window.Image;C.src=o.dataUrl,C.onload=()=>{r(C)}},[o]),!o||!i)return null;const l=o.width/o.height,f=t/n;let d,g,m,_;return l>f?(d=t,g=t/l,m=0,_=(n-g)/2):(g=n,d=n*l,m=(t-d)/2,_=0),Z.jsx(iv,{image:i,x:m,y:_,width:d,height:g,listening:!1})};function KC(){const[o]=Fm(),t=dd(),n=o.get("room"),i=o.get("name"),[r,l]=dt.useState(null),[f]=dt.useState(`student-${Math.random().toString(36).substr(2,9)}`),[d,g]=dt.useState(!1),[m,_]=dt.useState(null),[C,E]=dt.useState(null),[R,v]=dt.useState("loading"),[D,z]=dt.useState(null),[L,N]=dt.useState([]),[M,G]=dt.useState([]),[w,O]=dt.useState(null),[A,y]=dt.useState("pen"),[B,U]=dt.useState("black"),[P,Y]=dt.useState(3),[K,Q]=dt.useState(!1),[V,j]=dt.useState("stylus-only"),[I,X]=dt.useState("left"),[W,at]=dt.useState(Gy());dt.useEffect(()=>{if(sessionStorage.getItem("student-logout-on-load")==="true"){sessionStorage.removeItem("student-logout-on-load"),t("/student-login");return}(!n||!i)&&t(`/student-login${n?`?room=${n}`:""}`)},[n,i,t]),dt.useEffect(()=>{if(!(typeof window>"u")){console.log("🔵 [STUDENT] Loading preferences from localStorage...");try{const ht=localStorage.getItem(ug);if(ht){const ut=JSON.parse(ht);if(console.log("🔵 [STUDENT] Found stored preferences:",ut),ut.version!==Xp){console.log("🔵 [STUDENT] Version mismatch! Expected:",Xp,"Got:",ut.version),console.log("🔵 [STUDENT] Clearing old preferences..."),localStorage.removeItem(ug);return}console.log("🔵 [STUDENT] Applying preferences..."),ut.tool&&y(ut.tool),ut.color&&U(ut.color),typeof ut.brushSize=="number"&&Y(ut.brushSize),ut.inputMode&&j(ut.inputMode),ut.toolbarPosition&&X(ut.toolbarPosition),console.log("🔵 [STUDENT] Preferences loaded successfully!")}else console.log("🔵 [STUDENT] No stored preferences found, using defaults")}catch(ht){console.warn("🔵 [STUDENT] Failed to load student prefs",ht),localStorage.removeItem(ug)}}},[]),dt.useEffect(()=>{const ht=()=>{at(Gy())};return window.addEventListener("resize",ht),()=>window.removeEventListener("resize",ht)},[]),dt.useEffect(()=>{W&&(j("all"),Y(3))},[W]),dt.useEffect(()=>{if(typeof window>"u")return;if(it.current){it.current=!1,console.log("💾 [STUDENT] Skipping save on first render");return}const ht={version:Xp,tool:A,color:B,brushSize:P,inputMode:V,toolbarPosition:I};console.log("💾 [STUDENT] Saving preferences to localStorage:",ht),localStorage.setItem(ug,JSON.stringify(ht))},[A,B,P,V,I]);const J=dt.useRef([]),rt=dt.useRef([]),it=dt.useRef(!0),q=dt.useRef(L);dt.useEffect(()=>{q.current=L},[L]);const F=dt.useRef(!1),tt=dt.useRef(!1),nt=dt.useRef(null),gt=dt.useRef(null);dt.useEffect(()=>()=>{gt.current&&cancelAnimationFrame(gt.current)},[]),dt.useEffect(()=>{const ht=At.current;if(!ht)return;const ut=$t=>{const de=$t.target;de.closest("button")||de.closest(".student-toolbar")||de.closest(".student-topbar")||$t.preventDefault()},xt=$t=>{$t.preventDefault()},Dt=$t=>{if(K)return $t.preventDefault(),!1};return ht.addEventListener("touchstart",ut,{passive:!1}),ht.addEventListener("touchmove",ut,{passive:!1}),ht.addEventListener("gesturestart",xt,{passive:!1}),ht.addEventListener("gesturechange",xt,{passive:!1}),document.addEventListener("selectstart",Dt),()=>{ht&&(ht.removeEventListener("touchstart",ut),ht.removeEventListener("touchmove",ut),ht.removeEventListener("gesturestart",xt),ht.removeEventListener("gesturechange",xt)),document.removeEventListener("selectstart",Dt)}},[K]);const At=dt.useRef(null),Bt=dt.useRef(null),[qt,Jt]=dt.useState(cl),ee=dt.useMemo(()=>cl.width?qt.width/cl.width:1,[qt.width]);dt.useEffect(()=>{(async()=>{try{console.log("📝 Student validating session for room:",n);const{data:ut,error:xt}=await Ni.from("sessions").select("*").ilike("room_code",n).order("created_at",{ascending:!1}).limit(1);if(xt){console.error("Failed to query session:",xt),v("ended");return}if(!ut||ut.length===0){console.log("❌ No session found for room:",n),v("ended");return}const Dt=ut[0];console.log("✅ Session found:",Dt),_(Dt.id),v(Dt.status==="active"?"active":"waiting");const{data:$t,error:de}=await Ni.from("participants").insert([{session_id:Dt.id,client_id:f,name:i,role:"student"}]).select().single();if(de){console.error("Failed to create participant:",de);return}console.log("👤 Participant created:",$t),E($t.id)}catch(ut){console.error("Error initializing session:",ut),v("ended")}})()},[n,f,i]),dt.useEffect(()=>{(async()=>{try{const ut=new $8.Realtime({authUrl:"/api/token",authParams:{clientId:f}});ut.connection.on("connected",()=>{console.log("Connected to Ably"),g(!0)}),ut.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),g(!1)});const xt=ut.channels.get(`room-${n}`);return xt.subscribe("student-layer",Dt=>{Dt.clientId===f&&(F.current=!0,N(Dt.data.lines||[]),setTimeout(()=>{F.current=!1},100))}),xt.subscribe("teacher-annotation",Dt=>{Dt.data.targetStudentId===f&&(F.current=!0,G(Dt.data.annotations||[]),setTimeout(()=>{F.current=!1},100))}),xt.subscribe("teacher-image",Dt=>{var $t,de,Fe,Je;O({dataUrl:($t=Dt.data)==null?void 0:$t.dataUrl,width:(de=Dt.data)==null?void 0:de.width,height:(Fe=Dt.data)==null?void 0:Fe.height,timestamp:(Je=Dt.data)==null?void 0:Je.timestamp})}),xt.subscribe("teacher-template",Dt=>{var $t,de,Fe,Je,Ki;O({dataUrl:($t=Dt.data)==null?void 0:$t.dataUrl,width:(de=Dt.data)==null?void 0:de.width,height:(Fe=Dt.data)==null?void 0:Fe.height,type:(Je=Dt.data)==null?void 0:Je.type,timestamp:(Ki=Dt.data)==null?void 0:Ki.timestamp})}),xt.subscribe("teacher-clear",Dt=>{O(null)}),xt.subscribe("sync-question-state",Dt=>{Dt.data.targetClientId===f&&(console.log("📥 Received current question state"),O(Dt.data.content))}),xt.subscribe("clear-all-drawings",Dt=>{var $t;console.log("📝 Clearing all drawings (teacher sent new content)"),($t=Dt.data)!=null&&$t.questionId&&z(Dt.data.questionId),F.current=!0,N([]),G([]),setTimeout(()=>{F.current=!1},100)}),xt.subscribe("session-started",Dt=>{console.log("🎉 Session started!"),v("active")}),xt.subscribe("session-ended",Dt=>{var $t;console.log("🛑 Session ended:",($t=Dt.data)==null?void 0:$t.reason),v("ended"),setTimeout(()=>{t("/student-login")},3e3)}),await xt.presence.enter({name:i}),console.log(`Joined room ${n} as ${i}`),l(xt),setTimeout(()=>{xt.publish("request-current-state",{clientId:f,timestamp:Date.now()}),console.log("📞 Requested current question state from teacher")},1e3),()=>{xt?xt.presence.leave().then(()=>{console.log("👋 Left presence as",f),ut.close()}).catch(Dt=>{console.error("Error leaving presence:",Dt),ut.close()}):ut.close()}}catch(ut){console.error("Failed to initialize Ably:",ut)}})()},[f,n]),dt.useEffect(()=>{const ht=At.current;if(!ht)return;const ut=()=>{if(!At.current)return;const Dt=At.current.getBoundingClientRect(),$t=W?16:48,de=Math.max(280,Dt.width-$t),Fe=Math.max(210,Dt.height-$t),Je=de/cl.width,Ki=Fe/cl.height,ur=Math.min(Je,Ki),Di=Math.max(W?.35:qC,Math.min(VC,ur)),la=Math.round(Di*20)/20;Jt({width:Math.round(cl.width*la),height:Math.round(cl.height*la)})};ut(),window.addEventListener("resize",ut);let xt;return window.ResizeObserver&&(xt=new ResizeObserver(()=>ut()),xt.observe(ht)),()=>{window.removeEventListener("resize",ut),xt&&xt.disconnect()}},[I,W]),dt.useEffect(()=>{if(!F.current&&r){const ht=setTimeout(()=>{r.publish("student-layer",{lines:L,clientId:f,meta:{base:cl,display:qt,scale:ee}}),console.log("Published student layer:",L.length,"lines")},150);return()=>clearTimeout(ht)}},[L,r,f,qt,ee]),dt.useEffect(()=>{const ht=ut=>(sessionStorage.setItem("student-logout-on-load","true"),ut.preventDefault(),ut.returnValue="Are you sure you want to leave? You will be logged out.",ut.returnValue);return window.addEventListener("beforeunload",ht),()=>{window.removeEventListener("beforeunload",ht)}},[]),dt.useEffect(()=>{if(!m||!C||!D||R!=="active")return;const ut=setInterval(async()=>{try{const{data:xt,error:Dt}=await Ni.from("annotations").select("id").eq("question_id",D).eq("participant_id",C).maybeSingle(),$t={session_id:m,question_id:D,participant_id:C,student_lines:q.current};if(Dt){console.error("Failed to query annotation:",Dt);return}if(xt){const{error:de}=await Ni.from("annotations").update($t).eq("id",xt.id);de?console.error("Failed to update annotation:",de):console.log("💾 Auto-saved student work")}else{const{error:de}=await Ni.from("annotations").insert([$t]);de?console.error("Failed to create annotation:",de):console.log("💾 Created new annotation")}}catch(xt){console.error("Auto-save error:",xt)}},1e4);return()=>clearInterval(ut)},[m,C,D,R]),dt.useEffect(()=>{if(!m||!C||!D||R!=="active")return;(async()=>{try{const{data:ut}=await Ni.from("annotations").select("id").eq("question_id",D).eq("participant_id",C).maybeSingle(),xt={session_id:m,question_id:D,participant_id:C,student_lines:L};ut?await Ni.from("annotations").update(xt).eq("id",ut.id):await Ni.from("annotations").insert([xt]),console.log("💾 Saved work for new question")}catch(ut){console.error("Error saving on question change:",ut)}})()},[D]);const Gt=ht=>V!=="stylus-only"?!0:(ht==null?void 0:ht.pointerType)==="pen",be=ht=>{const ut=ht.evt;if(!Gt(ut)){ut!=null&&ut.preventDefault&&ut.preventDefault();return}const xt=ht.target.getStage();if(xt&&ut.pointerId!==void 0){const Dt=xt.content;if(Dt&&Dt.setPointerCapture)try{Dt.setPointerCapture(ut.pointerId)}catch{}}if(A==="pen"){Q(!0);const Dt=xt.getPointerPosition(),$t=Dt.x/ee,de=Dt.y/ee,Fe={tool:A,points:[$t,de],color:B,strokeWidth:P/ee};nt.current=Fe,J.current.push([...L]),rt.current=[],N([...L,Fe])}else A==="eraser"&&(Q(!0),tt.current=!1);ut.preventDefault&&ut.preventDefault(),ut.stopPropagation&&ut.stopPropagation()},Re=ht=>{if(!K)return;const ut=ht.evt;if(!Gt(ut)){ut!=null&&ut.preventDefault&&ut.preventDefault();return}const Dt=ht.target.getStage().getPointerPosition();if(A==="pen"){if(nt.current){const $t=Dt.x/ee,de=Dt.y/ee;nt.current.points=nt.current.points.concat([$t,de]);const Fe=nt.current;gt.current&&cancelAnimationFrame(gt.current),gt.current=requestAnimationFrame(()=>{Fe&&N(Je=>Je.length>0?[...Je.slice(0,-1),Fe]:Je)})}}else if(A==="eraser"){const $t=L.length,de=Dt.x,Fe=Dt.y,Je=20,Ki=L.filter(ur=>{for(let sa=0;sa<ur.points.length;sa+=2){const Di=ur.points[sa]*ee,la=ur.points[sa+1]*ee;if(Math.sqrt(Math.pow(Di-de,2)+Math.pow(la-Fe,2))<Je)return!1}return!0});Ki.length<$t&&!tt.current&&(J.current.push([...L]),rt.current=[],tt.current=!0),N(Ki)}ut!=null&&ut.preventDefault&&ut.preventDefault(),ut!=null&&ut.stopPropagation&&ut.stopPropagation()},tn=ht=>{const ut=ht==null?void 0:ht.evt;if(!Gt(ut)){ut!=null&&ut.preventDefault&&ut.preventDefault();return}Q(!1),nt.current=null},Rt=()=>{if(J.current.length>0){const ht=J.current.pop();rt.current.push([...L]),N(ht)}},Kt=()=>{if(rt.current.length>0){const ht=rt.current.pop();J.current.push([...L]),N(ht)}},Be=async()=>{J.current.push([...L]),rt.current=[],N([]),r&&(await r.publish("student-layer",{lines:[],clientId:f,meta:{base:cl,display:qt,scale:ee}}),console.log("Published student clear"))},te=()=>{var ht;return((ht=f.split("-")[1])==null?void 0:ht.substring(0,3))||f},ae=()=>{j(ht=>ht==="stylus-only"?"all":"stylus-only")},qe=()=>{X(ht=>ht==="left"?"right":"left")},xe=()=>`Connected as ${i&&i!=="Anonymous"?i:te()}`,an=d?"Connected":"Reconnecting…",yn=d?"online":"offline",hn=ht=>ht.map((ut,xt)=>ut*ee),ct=ht=>(ht.strokeWidth||3)*ee;return!n||!i?null:Z.jsxs("div",{className:"student-canvas-page",children:[R==="loading"&&Z.jsx("div",{className:"session-overlay",children:Z.jsxs("div",{className:"session-message",children:[Z.jsx("div",{className:"session-spinner"}),Z.jsx("h2",{children:"Connecting to session..."}),Z.jsx("p",{children:"Please wait while we verify your session"})]})}),R==="waiting"&&Z.jsx("div",{className:"session-overlay",children:Z.jsxs("div",{className:"session-message",children:[Z.jsx("div",{className:"session-icon waiting",children:"⏳"}),Z.jsx("h2",{children:"Waiting for teacher"}),Z.jsx("p",{children:"Your teacher hasn't started the session yet. Please wait..."})]})}),R==="ended"&&Z.jsx("div",{className:"session-overlay",children:Z.jsxs("div",{className:"session-message",children:[Z.jsx("div",{className:"session-icon ended",children:"✓"}),Z.jsx("h2",{children:"Session ended"}),Z.jsx("p",{children:"Thank you for participating! The teacher has ended this session."}),Z.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",opacity:.8},children:"Redirecting to login..."})]})}),Z.jsxs("div",{className:"student-canvas-container",children:[Z.jsxs("div",{className:"student-status-bar",children:[Z.jsxs("div",{className:"student-status-text",children:[Z.jsx("h1",{children:"Student Canvas"}),Z.jsx("p",{children:xe()})]}),Z.jsxs("div",{className:"student-status-actions",children:[!W&&Z.jsxs(Z.Fragment,{children:[Z.jsx("div",{className:"tool-status-indicator",children:Z.jsxs("span",{className:"tool-status-text",children:[Z.jsx("i",{className:A==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",V==="all"?"All inputs":"Stylus only"]})}),Z.jsxs("div",{className:`connection-pill ${yn}`,"aria-live":"polite",children:[Z.jsx("span",{className:"connection-indicator-dot"}),Z.jsx("span",{children:an})]}),Z.jsxs("button",{className:"move-toolbar-btn",onClick:qe,children:["Move toolbar to ",I==="left"?"right":"left"]})]}),W&&Z.jsxs("div",{className:`connection-pill ${yn}`,"aria-live":"polite",children:[Z.jsx("span",{className:"connection-indicator-dot"}),Z.jsx("span",{children:an})]})]})]}),Z.jsxs("div",{className:`student-workspace ${I==="right"?"toolbar-right":""} ${W?"mobile-view":""}`,children:[W?Z.jsxs("div",{className:"mobile-toolbar",children:[Z.jsxs("div",{className:"mobile-colors",children:[Z.jsx("button",{onClick:()=>U("black"),className:`mobile-color-button ${B==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),Z.jsx("button",{onClick:()=>U("#0066FF"),className:`mobile-color-button ${B==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),Z.jsx("button",{onClick:()=>U("#00AA00"),className:`mobile-color-button ${B==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]}),Z.jsxs("div",{className:"mobile-tools",children:[Z.jsx("button",{onClick:()=>y("pen"),className:`mobile-tool-button ${A==="pen"?"active":""}`,"aria-label":"Pen",children:Z.jsx(zC,{size:20})}),Z.jsx("button",{onClick:()=>y("eraser"),className:`mobile-tool-button ${A==="eraser"?"active":""}`,"aria-label":"Eraser",children:Z.jsx(UC,{size:20})}),Z.jsx("button",{onClick:Rt,className:"mobile-tool-button",disabled:J.current.length===0,"aria-label":"Undo",children:Z.jsx(kC,{size:20})}),Z.jsx("button",{onClick:Kt,className:"mobile-tool-button",disabled:rt.current.length===0,"aria-label":"Redo",children:Z.jsx(GC,{size:20})}),Z.jsx("button",{onClick:Be,className:"mobile-tool-button danger","aria-label":"Clear",children:Z.jsx(PC,{size:20})})]})]}):Z.jsxs("div",{className:"student-sidebar",children:[Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"COLORS"}),Z.jsxs("div",{className:"color-buttons",children:[Z.jsx("button",{onClick:()=>U("black"),className:`color-button ${B==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),Z.jsx("button",{onClick:()=>U("#0066FF"),className:`color-button ${B==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),Z.jsx("button",{onClick:()=>U("#00AA00"),className:`color-button ${B==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),Z.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[Z.jsxs("button",{onClick:()=>y("pen"),className:`tool-icon-button ${A==="pen"?"active":""}`,title:"Pen",children:[Z.jsx("i",{className:"pi pi-pencil tool-icon"}),Z.jsx("span",{className:"tool-label",children:"Pen"})]}),Z.jsxs("button",{onClick:()=>y("eraser"),className:`tool-icon-button ${A==="eraser"?"active":""}`,title:"Eraser",children:[Z.jsx("i",{className:"pi pi-eraser tool-icon"}),Z.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),Z.jsx("div",{className:"brush-size-control",children:Z.jsxs("div",{className:"brush-slider-container",children:[Z.jsx("input",{type:"range",min:"1",max:"10",value:P,onChange:ht=>Y(parseInt(ht.target.value)),className:"brush-slider"}),Z.jsx("span",{className:"brush-value",children:P})]})})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),Z.jsx("button",{className:`input-mode-toggle ${V==="all"?"all-inputs":""}`,onClick:ae,children:V==="stylus-only"?"Stylus mode (pen only)":"All inputs"})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),Z.jsxs("div",{className:"history-buttons",children:[Z.jsx("button",{onClick:Rt,className:"history-button",disabled:J.current.length===0,children:"Undo"}),Z.jsx("button",{onClick:Kt,className:"history-button",disabled:rt.current.length===0,children:"Redo"}),Z.jsx("button",{onClick:Be,className:"history-button danger",children:"Clear"})]})]})]}),Z.jsx("div",{className:"student-canvas-panel",ref:At,children:Z.jsx("div",{className:"student-canvas-frame",children:Z.jsx("div",{className:"student-canvas-surface",style:{width:`${qt.width}px`,height:`${qt.height}px`},children:Z.jsxs(av,{ref:Bt,width:qt.width,height:qt.height,onPointerDown:be,onPointerMove:Re,onPointerUp:tn,onPointerLeave:tn,onTouchStart:ht=>{var ut,xt;(xt=(ut=ht.evt)==null?void 0:ut.preventDefault)==null||xt.call(ut)},onTouchMove:ht=>{var ut,xt;(xt=(ut=ht.evt)==null?void 0:ut.preventDefault)==null||xt.call(ut)},onTouchEnd:ht=>{var ut,xt;(xt=(ut=ht.evt)==null?void 0:ut.preventDefault)==null||xt.call(ut)},className:"canvas-stage",style:{touchAction:"none"},perfectDrawEnabled:!1,children:[Z.jsx(dl,{listening:!1,children:Z.jsx(YC,{sharedImage:w,canvasWidth:qt.width,canvasHeight:qt.height})}),Z.jsx(dl,{children:L.map((ht,ut)=>Z.jsx(of,{points:hn(ht.points),stroke:ht.color,strokeWidth:ct(ht),tension:.5,lineCap:"round",lineJoin:"round"},`student-${ut}`))}),Z.jsx(dl,{listening:!1,children:M.map((ht,ut)=>Z.jsx(of,{points:hn(ht.points),stroke:ht.color,strokeWidth:ct(ht),tension:.5,lineCap:"round",lineJoin:"round"},`teacher-${ut}`))})]})})})})]})]})]})}const Hy="Feather_username";function QC(){const[o]=Fm(),t=dd(),[n,i]=dt.useState(""),[r,l]=dt.useState((o.get("room")||"").toUpperCase()),[f,d]=dt.useState("");dt.useEffect(()=>{const m=localStorage.getItem(Hy);m&&i(m)},[]);const g=m=>{if(m.preventDefault(),!n.trim()){d("Please enter your name");return}if(!r.trim()){d("Please enter a session code");return}localStorage.setItem(Hy,n.trim()),t(`/student?room=${r.trim().toUpperCase()}&name=${encodeURIComponent(n.trim())}`)};return Z.jsx("div",{className:"student-login-page",children:Z.jsxs("div",{className:"student-login-card",children:[Z.jsx("h1",{children:"Student Login"}),Z.jsx("p",{className:"login-subtitle",children:"Join your classroom session to start drawing."}),Z.jsxs("form",{onSubmit:g,children:[Z.jsxs("div",{className:"form-group",children:[Z.jsx("label",{htmlFor:"name",children:"Name"}),Z.jsx("input",{id:"name",type:"text",placeholder:"Your name",value:n,onChange:m=>{i(m.target.value),d("")},autoFocus:!0,maxLength:50})]}),Z.jsxs("div",{className:"form-group",children:[Z.jsx("label",{htmlFor:"sessionCode",children:"Session code"}),Z.jsx("input",{id:"sessionCode",type:"text",placeholder:"SESSION CODE (E.G., ABC123)",value:r,onChange:m=>{l(m.target.value.toUpperCase()),d("")},maxLength:10})]}),f&&Z.jsx("div",{className:"login-error",children:f}),Z.jsx("button",{type:"submit",className:"join-button",children:"Join Session"})]})]})})}var Fp,Py;function XC(){if(Py)return Fp;Py=1;function o(l){return typeof l=="string"&&(l=l.indexOf(":")==-1?{token:l}:{key:l}),l.promises=!0,l}var t=dS(),n=function(l,f,d,g){return new t.ErrorInfo(l,f,d,g)},i=function(l){return new t.Rest(o(l))};Object.assign(i,t.Rest);var r=function(l){return new t.Realtime(o(l))};return Object.assign(r,t.Realtime),Fp={ErrorInfo:n,Rest:i,Realtime:r},Fp}var FC=XC();const JC=ff(FC);var Wc={},Jp,Iy;function ZC(){return Iy||(Iy=1,Jp=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Jp}var Zp={},io={},ky;function bu(){if(ky)return io;ky=1;let o;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return io.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},io.getSymbolTotalCodewords=function(i){return t[i]},io.getBCHDigit=function(n){let i=0;for(;n!==0;)i++,n>>>=1;return i},io.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');o=i},io.isKanjiModeEnabled=function(){return typeof o<"u"},io.toSJIS=function(i){return o(i)},io}var Wp={},qy;function gv(){return qy||(qy=1,(function(o){o.L={bit:1},o.M={bit:0},o.Q={bit:3},o.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return o.L;case"m":case"medium":return o.M;case"q":case"quartile":return o.Q;case"h":case"high":return o.H;default:throw new Error("Unknown EC Level: "+n)}}o.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},o.from=function(i,r){if(o.isValid(i))return i;try{return t(i)}catch{return r}}})(Wp)),Wp}var $p,Vy;function WC(){if(Vy)return $p;Vy=1;function o(){this.buffer=[],this.length=0}return o.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let i=0;i<n;i++)this.putBit((t>>>n-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},$p=o,$p}var tm,Yy;function $C(){if(Yy)return tm;Yy=1;function o(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return o.prototype.set=function(t,n,i,r){const l=t*this.size+n;this.data[l]=i,r&&(this.reservedBit[l]=!0)},o.prototype.get=function(t,n){return this.data[t*this.size+n]},o.prototype.xor=function(t,n,i){this.data[t*this.size+n]^=i},o.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},tm=o,tm}var em={},Ky;function tT(){return Ky||(Ky=1,(function(o){const t=bu().getSymbolSize;o.getRowColCoords=function(i){if(i===1)return[];const r=Math.floor(i/7)+2,l=t(i),f=l===145?26:Math.ceil((l-13)/(2*r-2))*2,d=[l-7];for(let g=1;g<r-1;g++)d[g]=d[g-1]-f;return d.push(6),d.reverse()},o.getPositions=function(i){const r=[],l=o.getRowColCoords(i),f=l.length;for(let d=0;d<f;d++)for(let g=0;g<f;g++)d===0&&g===0||d===0&&g===f-1||d===f-1&&g===0||r.push([l[d],l[g]]);return r}})(em)),em}var nm={},Qy;function eT(){if(Qy)return nm;Qy=1;const o=bu().getSymbolSize,t=7;return nm.getPositions=function(i){const r=o(i);return[[0,0],[r-t,0],[0,r-t]]},nm}var im={},Xy;function nT(){return Xy||(Xy=1,(function(o){o.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};o.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},o.from=function(r){return o.isValid(r)?parseInt(r,10):void 0},o.getPenaltyN1=function(r){const l=r.size;let f=0,d=0,g=0,m=null,_=null;for(let C=0;C<l;C++){d=g=0,m=_=null;for(let E=0;E<l;E++){let R=r.get(C,E);R===m?d++:(d>=5&&(f+=t.N1+(d-5)),m=R,d=1),R=r.get(E,C),R===_?g++:(g>=5&&(f+=t.N1+(g-5)),_=R,g=1)}d>=5&&(f+=t.N1+(d-5)),g>=5&&(f+=t.N1+(g-5))}return f},o.getPenaltyN2=function(r){const l=r.size;let f=0;for(let d=0;d<l-1;d++)for(let g=0;g<l-1;g++){const m=r.get(d,g)+r.get(d,g+1)+r.get(d+1,g)+r.get(d+1,g+1);(m===4||m===0)&&f++}return f*t.N2},o.getPenaltyN3=function(r){const l=r.size;let f=0,d=0,g=0;for(let m=0;m<l;m++){d=g=0;for(let _=0;_<l;_++)d=d<<1&2047|r.get(m,_),_>=10&&(d===1488||d===93)&&f++,g=g<<1&2047|r.get(_,m),_>=10&&(g===1488||g===93)&&f++}return f*t.N3},o.getPenaltyN4=function(r){let l=0;const f=r.data.length;for(let g=0;g<f;g++)l+=r.data[g];return Math.abs(Math.ceil(l*100/f/5)-10)*t.N4};function n(i,r,l){switch(i){case o.Patterns.PATTERN000:return(r+l)%2===0;case o.Patterns.PATTERN001:return r%2===0;case o.Patterns.PATTERN010:return l%3===0;case o.Patterns.PATTERN011:return(r+l)%3===0;case o.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(l/3))%2===0;case o.Patterns.PATTERN101:return r*l%2+r*l%3===0;case o.Patterns.PATTERN110:return(r*l%2+r*l%3)%2===0;case o.Patterns.PATTERN111:return(r*l%3+(r+l)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}o.applyMask=function(r,l){const f=l.size;for(let d=0;d<f;d++)for(let g=0;g<f;g++)l.isReserved(g,d)||l.xor(g,d,n(r,g,d))},o.getBestMask=function(r,l){const f=Object.keys(o.Patterns).length;let d=0,g=1/0;for(let m=0;m<f;m++){l(m),o.applyMask(m,r);const _=o.getPenaltyN1(r)+o.getPenaltyN2(r)+o.getPenaltyN3(r)+o.getPenaltyN4(r);o.applyMask(m,r),_<g&&(g=_,d=m)}return d}})(im)),im}var cg={},Fy;function l4(){if(Fy)return cg;Fy=1;const o=gv(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return cg.getBlocksCount=function(r,l){switch(l){case o.L:return t[(r-1)*4+0];case o.M:return t[(r-1)*4+1];case o.Q:return t[(r-1)*4+2];case o.H:return t[(r-1)*4+3];default:return}},cg.getTotalCodewordsCount=function(r,l){switch(l){case o.L:return n[(r-1)*4+0];case o.M:return n[(r-1)*4+1];case o.Q:return n[(r-1)*4+2];case o.H:return n[(r-1)*4+3];default:return}},cg}var am={},Kh={},Jy;function iT(){if(Jy)return Kh;Jy=1;const o=new Uint8Array(512),t=new Uint8Array(256);return(function(){let i=1;for(let r=0;r<255;r++)o[r]=i,t[i]=r,i<<=1,i&256&&(i^=285);for(let r=255;r<512;r++)o[r]=o[r-255]})(),Kh.log=function(i){if(i<1)throw new Error("log("+i+")");return t[i]},Kh.exp=function(i){return o[i]},Kh.mul=function(i,r){return i===0||r===0?0:o[t[i]+t[r]]},Kh}var Zy;function aT(){return Zy||(Zy=1,(function(o){const t=iT();o.mul=function(i,r){const l=new Uint8Array(i.length+r.length-1);for(let f=0;f<i.length;f++)for(let d=0;d<r.length;d++)l[f+d]^=t.mul(i[f],r[d]);return l},o.mod=function(i,r){let l=new Uint8Array(i);for(;l.length-r.length>=0;){const f=l[0];for(let g=0;g<r.length;g++)l[g]^=t.mul(r[g],f);let d=0;for(;d<l.length&&l[d]===0;)d++;l=l.slice(d)}return l},o.generateECPolynomial=function(i){let r=new Uint8Array([1]);for(let l=0;l<i;l++)r=o.mul(r,new Uint8Array([1,t.exp(l)]));return r}})(am)),am}var rm,Wy;function rT(){if(Wy)return rm;Wy=1;const o=aT();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(i){this.degree=i,this.genPoly=o.generateECPolynomial(this.degree)},t.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(i.length+this.degree);r.set(i);const l=o.mod(r,this.genPoly),f=this.degree-l.length;if(f>0){const d=new Uint8Array(this.degree);return d.set(l,f),d}return l},rm=t,rm}var sm={},lm={},om={},$y;function o4(){return $y||($y=1,om.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),om}var ps={},t2;function u4(){if(t2)return ps;t2=1;const o="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;ps.KANJI=new RegExp(n,"g"),ps.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),ps.BYTE=new RegExp(i,"g"),ps.NUMERIC=new RegExp(o,"g"),ps.ALPHANUMERIC=new RegExp(t,"g");const r=new RegExp("^"+n+"$"),l=new RegExp("^"+o+"$"),f=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return ps.testKanji=function(g){return r.test(g)},ps.testNumeric=function(g){return l.test(g)},ps.testAlphanumeric=function(g){return f.test(g)},ps}var e2;function _u(){return e2||(e2=1,(function(o){const t=o4(),n=u4();o.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},o.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},o.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},o.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},o.MIXED={bit:-1},o.getCharCountIndicator=function(l,f){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!t.isValid(f))throw new Error("Invalid version: "+f);return f>=1&&f<10?l.ccBits[0]:f<27?l.ccBits[1]:l.ccBits[2]},o.getBestModeForData=function(l){return n.testNumeric(l)?o.NUMERIC:n.testAlphanumeric(l)?o.ALPHANUMERIC:n.testKanji(l)?o.KANJI:o.BYTE},o.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},o.isValid=function(l){return l&&l.bit&&l.ccBits};function i(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return o.NUMERIC;case"alphanumeric":return o.ALPHANUMERIC;case"kanji":return o.KANJI;case"byte":return o.BYTE;default:throw new Error("Unknown mode: "+r)}}o.from=function(l,f){if(o.isValid(l))return l;try{return i(l)}catch{return f}}})(lm)),lm}var n2;function sT(){return n2||(n2=1,(function(o){const t=bu(),n=l4(),i=gv(),r=_u(),l=o4(),f=7973,d=t.getBCHDigit(f);function g(E,R,v){for(let D=1;D<=40;D++)if(R<=o.getCapacity(D,v,E))return D}function m(E,R){return r.getCharCountIndicator(E,R)+4}function _(E,R){let v=0;return E.forEach(function(D){const z=m(D.mode,R);v+=z+D.getBitsLength()}),v}function C(E,R){for(let v=1;v<=40;v++)if(_(E,v)<=o.getCapacity(v,R,r.MIXED))return v}o.from=function(R,v){return l.isValid(R)?parseInt(R,10):v},o.getCapacity=function(R,v,D){if(!l.isValid(R))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=r.BYTE);const z=t.getSymbolTotalCodewords(R),L=n.getTotalCodewordsCount(R,v),N=(z-L)*8;if(D===r.MIXED)return N;const M=N-m(D,R);switch(D){case r.NUMERIC:return Math.floor(M/10*3);case r.ALPHANUMERIC:return Math.floor(M/11*2);case r.KANJI:return Math.floor(M/13);case r.BYTE:default:return Math.floor(M/8)}},o.getBestVersionForData=function(R,v){let D;const z=i.from(v,i.M);if(Array.isArray(R)){if(R.length>1)return C(R,z);if(R.length===0)return 1;D=R[0]}else D=R;return g(D.mode,D.getLength(),z)},o.getEncodedBits=function(R){if(!l.isValid(R)||R<7)throw new Error("Invalid QR Code version");let v=R<<12;for(;t.getBCHDigit(v)-d>=0;)v^=f<<t.getBCHDigit(v)-d;return R<<12|v}})(sm)),sm}var um={},i2;function lT(){if(i2)return um;i2=1;const o=bu(),t=1335,n=21522,i=o.getBCHDigit(t);return um.getEncodedBits=function(l,f){const d=l.bit<<3|f;let g=d<<10;for(;o.getBCHDigit(g)-i>=0;)g^=t<<o.getBCHDigit(g)-i;return(d<<10|g)^n},um}var cm={},fm,a2;function oT(){if(a2)return fm;a2=1;const o=_u();function t(n){this.mode=o.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(i){let r,l,f;for(r=0;r+3<=this.data.length;r+=3)l=this.data.substr(r,3),f=parseInt(l,10),i.put(f,10);const d=this.data.length-r;d>0&&(l=this.data.substr(r),f=parseInt(l,10),i.put(f,d*3+1))},fm=t,fm}var hm,r2;function uT(){if(r2)return hm;r2=1;const o=_u(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(i){this.mode=o.ALPHANUMERIC,this.data=i}return n.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let l;for(l=0;l+2<=this.data.length;l+=2){let f=t.indexOf(this.data[l])*45;f+=t.indexOf(this.data[l+1]),r.put(f,11)}this.data.length%2&&r.put(t.indexOf(this.data[l]),6)},hm=n,hm}var dm,s2;function cT(){if(s2)return dm;s2=1;const o=_u();function t(n){this.mode=o.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(i){return i*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let i=0,r=this.data.length;i<r;i++)n.put(this.data[i],8)},dm=t,dm}var gm,l2;function fT(){if(l2)return gm;l2=1;const o=_u(),t=bu();function n(i){this.mode=o.KANJI,this.data=i}return n.getBitsLength=function(r){return r*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(i){let r;for(r=0;r<this.data.length;r++){let l=t.toSJIS(this.data[r]);if(l>=33088&&l<=40956)l-=33088;else if(l>=57408&&l<=60351)l-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);l=(l>>>8&255)*192+(l&255),i.put(l,13)}},gm=n,gm}var pm={exports:{}},o2;function hT(){return o2||(o2=1,(function(o){var t={single_source_shortest_paths:function(n,i,r){var l={},f={};f[i]=0;var d=t.PriorityQueue.make();d.push(i,0);for(var g,m,_,C,E,R,v,D,z;!d.empty();){g=d.pop(),m=g.value,C=g.cost,E=n[m]||{};for(_ in E)E.hasOwnProperty(_)&&(R=E[_],v=C+R,D=f[_],z=typeof f[_]>"u",(z||D>v)&&(f[_]=v,d.push(_,v),l[_]=m))}if(typeof r<"u"&&typeof f[r]>"u"){var L=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(L)}return l},extract_shortest_path_from_predecessor_list:function(n,i){for(var r=[],l=i;l;)r.push(l),n[l],l=n[l];return r.reverse(),r},find_path:function(n,i,r){var l=t.single_source_shortest_paths(n,i,r);return t.extract_shortest_path_from_predecessor_list(l,r)},PriorityQueue:{make:function(n){var i=t.PriorityQueue,r={},l;n=n||{};for(l in i)i.hasOwnProperty(l)&&(r[l]=i[l]);return r.queue=[],r.sorter=n.sorter||i.default_sorter,r},default_sorter:function(n,i){return n.cost-i.cost},push:function(n,i){var r={value:n,cost:i};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};o.exports=t})(pm)),pm.exports}var u2;function dT(){return u2||(u2=1,(function(o){const t=_u(),n=oT(),i=uT(),r=cT(),l=fT(),f=u4(),d=bu(),g=hT();function m(L){return unescape(encodeURIComponent(L)).length}function _(L,N,M){const G=[];let w;for(;(w=L.exec(M))!==null;)G.push({data:w[0],index:w.index,mode:N,length:w[0].length});return G}function C(L){const N=_(f.NUMERIC,t.NUMERIC,L),M=_(f.ALPHANUMERIC,t.ALPHANUMERIC,L);let G,w;return d.isKanjiModeEnabled()?(G=_(f.BYTE,t.BYTE,L),w=_(f.KANJI,t.KANJI,L)):(G=_(f.BYTE_KANJI,t.BYTE,L),w=[]),N.concat(M,G,w).sort(function(A,y){return A.index-y.index}).map(function(A){return{data:A.data,mode:A.mode,length:A.length}})}function E(L,N){switch(N){case t.NUMERIC:return n.getBitsLength(L);case t.ALPHANUMERIC:return i.getBitsLength(L);case t.KANJI:return l.getBitsLength(L);case t.BYTE:return r.getBitsLength(L)}}function R(L){return L.reduce(function(N,M){const G=N.length-1>=0?N[N.length-1]:null;return G&&G.mode===M.mode?(N[N.length-1].data+=M.data,N):(N.push(M),N)},[])}function v(L){const N=[];for(let M=0;M<L.length;M++){const G=L[M];switch(G.mode){case t.NUMERIC:N.push([G,{data:G.data,mode:t.ALPHANUMERIC,length:G.length},{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.ALPHANUMERIC:N.push([G,{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.KANJI:N.push([G,{data:G.data,mode:t.BYTE,length:m(G.data)}]);break;case t.BYTE:N.push([{data:G.data,mode:t.BYTE,length:m(G.data)}])}}return N}function D(L,N){const M={},G={start:{}};let w=["start"];for(let O=0;O<L.length;O++){const A=L[O],y=[];for(let B=0;B<A.length;B++){const U=A[B],P=""+O+B;y.push(P),M[P]={node:U,lastCount:0},G[P]={};for(let Y=0;Y<w.length;Y++){const K=w[Y];M[K]&&M[K].node.mode===U.mode?(G[K][P]=E(M[K].lastCount+U.length,U.mode)-E(M[K].lastCount,U.mode),M[K].lastCount+=U.length):(M[K]&&(M[K].lastCount=U.length),G[K][P]=E(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,N))}}w=y}for(let O=0;O<w.length;O++)G[w[O]].end=0;return{map:G,table:M}}function z(L,N){let M;const G=t.getBestModeForData(L);if(M=t.from(N,G),M!==t.BYTE&&M.bit<G.bit)throw new Error('"'+L+'" cannot be encoded with mode '+t.toString(M)+`.
 Suggested mode is: `+t.toString(G));switch(M===t.KANJI&&!d.isKanjiModeEnabled()&&(M=t.BYTE),M){case t.NUMERIC:return new n(L);case t.ALPHANUMERIC:return new i(L);case t.KANJI:return new l(L);case t.BYTE:return new r(L)}}o.fromArray=function(N){return N.reduce(function(M,G){return typeof G=="string"?M.push(z(G,null)):G.data&&M.push(z(G.data,G.mode)),M},[])},o.fromString=function(N,M){const G=C(N,d.isKanjiModeEnabled()),w=v(G),O=D(w,M),A=g.find_path(O.map,"start","end"),y=[];for(let B=1;B<A.length-1;B++)y.push(O.table[A[B]].node);return o.fromArray(R(y))},o.rawSplit=function(N){return o.fromArray(C(N,d.isKanjiModeEnabled()))}})(cm)),cm}var c2;function gT(){if(c2)return Zp;c2=1;const o=bu(),t=gv(),n=WC(),i=$C(),r=tT(),l=eT(),f=nT(),d=l4(),g=rT(),m=sT(),_=lT(),C=_u(),E=dT();function R(O,A){const y=O.size,B=l.getPositions(A);for(let U=0;U<B.length;U++){const P=B[U][0],Y=B[U][1];for(let K=-1;K<=7;K++)if(!(P+K<=-1||y<=P+K))for(let Q=-1;Q<=7;Q++)Y+Q<=-1||y<=Y+Q||(K>=0&&K<=6&&(Q===0||Q===6)||Q>=0&&Q<=6&&(K===0||K===6)||K>=2&&K<=4&&Q>=2&&Q<=4?O.set(P+K,Y+Q,!0,!0):O.set(P+K,Y+Q,!1,!0))}}function v(O){const A=O.size;for(let y=8;y<A-8;y++){const B=y%2===0;O.set(y,6,B,!0),O.set(6,y,B,!0)}}function D(O,A){const y=r.getPositions(A);for(let B=0;B<y.length;B++){const U=y[B][0],P=y[B][1];for(let Y=-2;Y<=2;Y++)for(let K=-2;K<=2;K++)Y===-2||Y===2||K===-2||K===2||Y===0&&K===0?O.set(U+Y,P+K,!0,!0):O.set(U+Y,P+K,!1,!0)}}function z(O,A){const y=O.size,B=m.getEncodedBits(A);let U,P,Y;for(let K=0;K<18;K++)U=Math.floor(K/3),P=K%3+y-8-3,Y=(B>>K&1)===1,O.set(U,P,Y,!0),O.set(P,U,Y,!0)}function L(O,A,y){const B=O.size,U=_.getEncodedBits(A,y);let P,Y;for(P=0;P<15;P++)Y=(U>>P&1)===1,P<6?O.set(P,8,Y,!0):P<8?O.set(P+1,8,Y,!0):O.set(B-15+P,8,Y,!0),P<8?O.set(8,B-P-1,Y,!0):P<9?O.set(8,15-P-1+1,Y,!0):O.set(8,15-P-1,Y,!0);O.set(B-8,8,1,!0)}function N(O,A){const y=O.size;let B=-1,U=y-1,P=7,Y=0;for(let K=y-1;K>0;K-=2)for(K===6&&K--;;){for(let Q=0;Q<2;Q++)if(!O.isReserved(U,K-Q)){let V=!1;Y<A.length&&(V=(A[Y]>>>P&1)===1),O.set(U,K-Q,V),P--,P===-1&&(Y++,P=7)}if(U+=B,U<0||y<=U){U-=B,B=-B;break}}}function M(O,A,y){const B=new n;y.forEach(function(Q){B.put(Q.mode.bit,4),B.put(Q.getLength(),C.getCharCountIndicator(Q.mode,O)),Q.write(B)});const U=o.getSymbolTotalCodewords(O),P=d.getTotalCodewordsCount(O,A),Y=(U-P)*8;for(B.getLengthInBits()+4<=Y&&B.put(0,4);B.getLengthInBits()%8!==0;)B.putBit(0);const K=(Y-B.getLengthInBits())/8;for(let Q=0;Q<K;Q++)B.put(Q%2?17:236,8);return G(B,O,A)}function G(O,A,y){const B=o.getSymbolTotalCodewords(A),U=d.getTotalCodewordsCount(A,y),P=B-U,Y=d.getBlocksCount(A,y),K=B%Y,Q=Y-K,V=Math.floor(B/Y),j=Math.floor(P/Y),I=j+1,X=V-j,W=new g(X);let at=0;const J=new Array(Y),rt=new Array(Y);let it=0;const q=new Uint8Array(O.buffer);for(let At=0;At<Y;At++){const Bt=At<Q?j:I;J[At]=q.slice(at,at+Bt),rt[At]=W.encode(J[At]),at+=Bt,it=Math.max(it,Bt)}const F=new Uint8Array(B);let tt=0,nt,gt;for(nt=0;nt<it;nt++)for(gt=0;gt<Y;gt++)nt<J[gt].length&&(F[tt++]=J[gt][nt]);for(nt=0;nt<X;nt++)for(gt=0;gt<Y;gt++)F[tt++]=rt[gt][nt];return F}function w(O,A,y,B){let U;if(Array.isArray(O))U=E.fromArray(O);else if(typeof O=="string"){let V=A;if(!V){const j=E.rawSplit(O);V=m.getBestVersionForData(j,y)}U=E.fromString(O,V||40)}else throw new Error("Invalid data");const P=m.getBestVersionForData(U,y);if(!P)throw new Error("The amount of data is too big to be stored in a QR Code");if(!A)A=P;else if(A<P)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+P+`.
`);const Y=M(A,y,U),K=o.getSymbolSize(A),Q=new i(K);return R(Q,A),v(Q),D(Q,A),L(Q,y,0),A>=7&&z(Q,A),N(Q,Y),isNaN(B)&&(B=f.getBestMask(Q,L.bind(null,Q,y))),f.applyMask(B,Q),L(Q,y,B),{modules:Q,version:A,errorCorrectionLevel:y,maskPattern:B,segments:U}}return Zp.create=function(A,y){if(typeof A>"u"||A==="")throw new Error("No input text");let B=t.M,U,P;return typeof y<"u"&&(B=t.from(y.errorCorrectionLevel,t.M),U=m.from(y.version),P=f.from(y.maskPattern),y.toSJISFunc&&o.setToSJISFunction(y.toSJISFunc)),w(A,U,B,P)},Zp}var mm={},vm={},f2;function c4(){return f2||(f2=1,(function(o){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let i=n.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+n);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(l){return[l,l]}))),i.length===6&&i.push("F","F");const r=parseInt(i.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+i.slice(0,6).join("")}}o.getOptions=function(i){i||(i={}),i.color||(i.color={});const r=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,l=i.width&&i.width>=21?i.width:void 0,f=i.scale||4;return{width:l,scale:l?4:f,margin:r,color:{dark:t(i.color.dark||"#000000ff"),light:t(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},o.getScale=function(i,r){return r.width&&r.width>=i+r.margin*2?r.width/(i+r.margin*2):r.scale},o.getImageWidth=function(i,r){const l=o.getScale(i,r);return Math.floor((i+r.margin*2)*l)},o.qrToImageData=function(i,r,l){const f=r.modules.size,d=r.modules.data,g=o.getScale(f,l),m=Math.floor((f+l.margin*2)*g),_=l.margin*g,C=[l.color.light,l.color.dark];for(let E=0;E<m;E++)for(let R=0;R<m;R++){let v=(E*m+R)*4,D=l.color.light;if(E>=_&&R>=_&&E<m-_&&R<m-_){const z=Math.floor((E-_)/g),L=Math.floor((R-_)/g);D=C[d[z*f+L]?1:0]}i[v++]=D.r,i[v++]=D.g,i[v++]=D.b,i[v]=D.a}}})(vm)),vm}var h2;function pT(){return h2||(h2=1,(function(o){const t=c4();function n(r,l,f){r.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=f,l.width=f,l.style.height=f+"px",l.style.width=f+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}o.render=function(l,f,d){let g=d,m=f;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),f||(m=i()),g=t.getOptions(g);const _=t.getImageWidth(l.modules.size,g),C=m.getContext("2d"),E=C.createImageData(_,_);return t.qrToImageData(E.data,l,g),n(C,m,_),C.putImageData(E,0,0),m},o.renderToDataURL=function(l,f,d){let g=d;typeof g>"u"&&(!f||!f.getContext)&&(g=f,f=void 0),g||(g={});const m=o.render(l,f,g),_=g.type||"image/png",C=g.rendererOpts||{};return m.toDataURL(_,C.quality)}})(mm)),mm}var ym={},d2;function mT(){if(d2)return ym;d2=1;const o=c4();function t(r,l){const f=r.a/255,d=l+'="'+r.hex+'"';return f<1?d+" "+l+'-opacity="'+f.toFixed(2).slice(1)+'"':d}function n(r,l,f){let d=r+l;return typeof f<"u"&&(d+=" "+f),d}function i(r,l,f){let d="",g=0,m=!1,_=0;for(let C=0;C<r.length;C++){const E=Math.floor(C%l),R=Math.floor(C/l);!E&&!m&&(m=!0),r[C]?(_++,C>0&&E>0&&r[C-1]||(d+=m?n("M",E+f,.5+R+f):n("m",g,0),g=0,m=!1),E+1<l&&r[C+1]||(d+=n("h",_),_=0)):g++}return d}return ym.render=function(l,f,d){const g=o.getOptions(f),m=l.modules.size,_=l.modules.data,C=m+g.margin*2,E=g.color.light.a?"<path "+t(g.color.light,"fill")+' d="M0 0h'+C+"v"+C+'H0z"/>':"",R="<path "+t(g.color.dark,"stroke")+' d="'+i(_,m,g.margin)+'"/>',v='viewBox="0 0 '+C+" "+C+'"',z='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+v+' shape-rendering="crispEdges">'+E+R+`</svg>
`;return typeof d=="function"&&d(null,z),z},ym}var g2;function vT(){if(g2)return Wc;g2=1;const o=ZC(),t=gT(),n=pT(),i=mT();function r(l,f,d,g,m){const _=[].slice.call(arguments,1),C=_.length,E=typeof _[C-1]=="function";if(!E&&!o())throw new Error("Callback required as last argument");if(E){if(C<2)throw new Error("Too few arguments provided");C===2?(m=d,d=f,f=g=void 0):C===3&&(f.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=d,d=f,f=void 0))}else{if(C<1)throw new Error("Too few arguments provided");return C===1?(d=f,f=g=void 0):C===2&&!f.getContext&&(g=d,d=f,f=void 0),new Promise(function(R,v){try{const D=t.create(d,g);R(l(D,f,g))}catch(D){v(D)}})}try{const R=t.create(d,g);m(null,l(R,f,g))}catch(R){m(R)}}return Wc.create=t.create,Wc.toCanvas=r.bind(null,n.render),Wc.toDataURL=r.bind(null,n.renderToDataURL),Wc.toString=r.bind(null,function(l,f,d){return i.render(l,d)}),Wc}var yT=vT();const ST=ff(yT),f4=({active:o=!1,size:t=20})=>{const n=o?"#ff4d4f":"#b8c1cc",i=o?"#ff4d4f":"transparent";return Z.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[Z.jsx("path",{d:"M5 2.5V17.5",stroke:n,strokeWidth:"1.6",strokeLinecap:"round"}),Z.jsx("path",{d:"M5 3h10l-2 3 2 3H5V3Z",fill:i,stroke:n,strokeWidth:"1.4",strokeLinejoin:"round"})]})},bT=({student:o,onClick:t,onToggleFlag:n,teacherAnnotations:i=[],sharedImage:r,hideNames:l=!1})=>{var G,w,O,A;const f=dt.useRef(null),d=dt.useRef(null),[g,m]=dt.useState(null),[_,C]=dt.useState(300);dt.useEffect(()=>{if(!r){m(null);return}const y=new window.Image;y.src=r.dataUrl,y.onload=()=>{m(y)}},[r]),dt.useEffect(()=>{if(!d.current)return;const y=()=>{d.current&&C(d.current.clientWidth)};y();const B=new ResizeObserver(y);return B.observe(d.current),()=>B.disconnect()},[]);const E=()=>{if(o!=null&&o.name)return o.name;if(!(o!=null&&o.clientId))return"Unknown Student";const y=o.clientId.match(/student-(\d+)/);return y?`Student ${y[1]}`:o.clientId},R=()=>{if(!o.lastUpdate)return"Just joined";const y=Math.floor((Date.now()-o.lastUpdate)/1e3);return y<5?"Just now":y<60?`${y}s ago`:`${Math.floor(y/60)}m ago`},v=((w=(G=o.meta)==null?void 0:G.base)==null?void 0:w.width)||800,D=((A=(O=o.meta)==null?void 0:O.base)==null?void 0:A.height)||600,z=_/v,L=y=>{y.stopPropagation(),n&&n(o.clientId)},M=(()=>{if(!r||!g)return null;const y=r.width/r.height,B=v/D;let U,P,Y,K;return y>B?(U=v,P=v/y,Y=0,K=(D-P)/2):(P=D,U=D*y,Y=(v-U)/2,K=0),{x:Y,y:K,width:U,height:P}})();return Z.jsxs("div",{className:`student-card ${o.isActive?"active":"inactive"}`,onClick:()=>t(o),children:[Z.jsxs("div",{className:"student-card-header",children:[Z.jsxs("div",{className:"student-name",children:[Z.jsx("span",{className:"student-icon",children:"👤"}),l?"•••":E()]}),Z.jsxs("div",{className:"student-header-actions",children:[Z.jsx("button",{className:`flag-button ${o.isFlagged?"active":""}`,onClick:L,"aria-label":o.isFlagged?"Remove flag":"Flag student",title:o.isFlagged?"Remove flag":"Flag student",children:Z.jsx(f4,{active:o.isFlagged,size:18})}),Z.jsx("div",{className:"student-status",children:Z.jsx("span",{className:`status-dot ${o.isActive?"online":"offline"}`})})]})]}),Z.jsxs("div",{className:"student-card-canvas",ref:d,children:[Z.jsxs(av,{ref:f,width:v,height:D,scaleX:z,scaleY:z,style:{transformOrigin:"top left",width:"100%",height:"100%"},children:[M&&Z.jsx(dl,{listening:!1,children:Z.jsx(iv,{image:g,x:M.x,y:M.y,width:M.width,height:M.height})}),Z.jsx(dl,{children:o.lines&&o.lines.map((y,B)=>Z.jsx(of,{points:y.points,stroke:y.color||"black",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`preview-${o.clientId}-${B}`))}),Z.jsx(dl,{children:i.map((y,B)=>Z.jsx(of,{points:y.points,stroke:y.color||"#FF0000",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${o.clientId}-${B}`))})]}),(!o.lines||o.lines.length===0)&&Z.jsxs("div",{className:"no-drawing",children:[Z.jsx("span",{children:"✏️"}),Z.jsx("p",{children:"No drawing yet"})]}),o.lines&&o.lines.length>0&&Z.jsxs("div",{className:"stroke-count",children:[o.lines.length," stroke",o.lines.length!==1?"s":""]})]}),Z.jsxs("div",{className:"student-card-footer",children:[Z.jsx("span",{className:"last-update",children:R()}),Z.jsx("span",{className:"click-hint",children:"Click to annotate →"})]})]})},$c={width:800,height:600},fg="teacherAnnotationPrefs",Sm=2,p2=[{label:"Red",value:"#FF3B30"},{label:"Purple",value:"#7C3AED"},{label:"Teal",value:"#0EA5E9"}],_T=({student:o,isOpen:t,onClose:n,onAnnotate:i,existingAnnotations:r=[],isFlagged:l=!1,onToggleFlag:f,sharedImage:d})=>{const[g,m]=dt.useState("pen"),[_,C]=dt.useState(p2[0].value),[E,R]=dt.useState(3),[v,D]=dt.useState(!1),[z,L]=dt.useState([]),[N,M]=dt.useState("stylus-only"),[G,w]=dt.useState("left"),[O,A]=dt.useState(null),y=dt.useRef([]),B=dt.useRef([]),U=dt.useRef(!1),P=dt.useRef(null),Y=dt.useRef(!0),K=dt.useRef(null),Q=dt.useRef(null);dt.useEffect(()=>{if(!d){A(null);return}const Rt=new window.Image;Rt.src=d.dataUrl,Rt.onload=()=>{A(Rt)}},[d]);const V=dt.useRef(null),j=dt.useRef(null),[I,X]=dt.useState({width:960,height:720}),W=dt.useMemo(()=>({x:I.width/$c.width,y:I.height/$c.height}),[I]);dt.useEffect(()=>{if(!(typeof window>"u")){console.log("🟣 [TEACHER ANNOTATION] Loading preferences from localStorage...");try{const Rt=localStorage.getItem(fg);if(Rt){const Kt=JSON.parse(Rt);if(console.log("🟣 [TEACHER ANNOTATION] Found stored preferences:",Kt),Kt.version!==Sm){console.log("🟣 [TEACHER ANNOTATION] Version mismatch! Expected:",Sm,"Got:",Kt.version),console.log("🟣 [TEACHER ANNOTATION] Clearing old preferences..."),localStorage.removeItem(fg);return}console.log("🟣 [TEACHER ANNOTATION] Applying preferences..."),Kt.tool&&m(Kt.tool),Kt.color&&C(Kt.color),typeof Kt.brushSize=="number"&&R(Kt.brushSize),Kt.inputMode&&M(Kt.inputMode),Kt.toolbarPosition&&w(Kt.toolbarPosition),console.log("🟣 [TEACHER ANNOTATION] Preferences loaded successfully!")}else console.log("🟣 [TEACHER ANNOTATION] No stored preferences found, using defaults")}catch(Rt){console.warn("🟣 [TEACHER ANNOTATION] Failed to load teacher annotation prefs",Rt),localStorage.removeItem(fg)}}},[]),dt.useEffect(()=>{if(typeof window>"u")return;if(Y.current){Y.current=!1,console.log("💾 [TEACHER ANNOTATION] Skipping save on first render");return}const Rt={version:Sm,tool:g,color:_,brushSize:E,inputMode:N,toolbarPosition:G};console.log("💾 [TEACHER ANNOTATION] Saving preferences to localStorage:",Rt),localStorage.setItem(fg,JSON.stringify(Rt))},[g,_,E,N,G]),dt.useEffect(()=>{t&&o&&o.clientId!==P.current&&(P.current=o.clientId,L(r),y.current=[],B.current=[])},[t,o,r]),dt.useEffect(()=>{t&&o&&L(r)},[r,t,o]),dt.useEffect(()=>()=>{Q.current&&cancelAnimationFrame(Q.current)},[]),dt.useEffect(()=>{if(t){const Rt=document.body.style.overflow,Kt=document.body.style.position,Be=document.body.style.touchAction;document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.touchAction="none";const te=V.current;if(!te)return;const ae=an=>{const yn=an.target;yn.closest("button")||yn.closest(".annotation-sidebar")||yn.closest(".annotation-status-actions")||an.preventDefault()},qe=an=>{an.preventDefault()},xe=an=>{if(v)return an.preventDefault(),!1};return te.addEventListener("touchstart",ae,{passive:!1}),te.addEventListener("touchmove",ae,{passive:!1}),te.addEventListener("gesturestart",qe,{passive:!1}),te.addEventListener("gesturechange",qe,{passive:!1}),document.addEventListener("selectstart",xe),()=>{document.body.style.overflow=Rt,document.body.style.position=Kt,document.body.style.touchAction=Be,te&&(te.removeEventListener("touchstart",ae),te.removeEventListener("touchmove",ae),te.removeEventListener("gesturestart",qe),te.removeEventListener("gesturechange",qe)),document.removeEventListener("selectstart",xe)}}},[t,v]),dt.useEffect(()=>{if(!t)return;const Rt=()=>{if(!V.current)return;const Kt=V.current.getBoundingClientRect(),ae=24+4,qe=Math.max(320,Kt.width-ae),xe=Math.max(240,Kt.height-ae),an=qe/$c.width,yn=xe/$c.height,hn=Math.min(an,yn);X({width:Math.round($c.width*hn),height:Math.round($c.height*hn)})};return Rt(),window.addEventListener("resize",Rt),()=>window.removeEventListener("resize",Rt)},[G,t]);const at=()=>{if(!d||!O)return null;const Rt=d.width/d.height,Kt=I.width/I.height;let Be,te,ae,qe;return Rt>Kt?(Be=I.width,te=I.width/Rt,ae=0,qe=(I.height-te)/2):(te=I.height,Be=I.height*Rt,ae=(I.width-Be)/2,qe=0),{x:ae,y:qe,width:Be,height:te}};if(!t||!o)return null;const J=at(),rt=()=>{if(o.name)return o.name;const Rt=o.clientId.match(/student-(\d+)/)||o.clientId.match(/load-test-student-(\d+)/);return Rt?`Student ${Rt[1]}`:o.clientId},it=Rt=>N!=="stylus-only"?!0:(Rt==null?void 0:Rt.pointerType)==="pen",q=(Rt=[])=>Rt.map((Kt,Be)=>Be%2===0?Kt*W.x:Kt*W.y),F=Rt=>({x:Rt.x/W.x,y:Rt.y/W.y}),tt=Rt=>(Rt.strokeWidth||3)*W.x,nt=Rt=>{const Kt=Rt.evt;if(Kt!=null&&Kt.preventDefault&&Kt.preventDefault(),Kt!=null&&Kt.stopPropagation&&Kt.stopPropagation(),!it(Kt))return;const Be=Rt.target.getStage();if(Be&&Kt.pointerId!==void 0){const te=Be.content;if(te&&te.setPointerCapture)try{te.setPointerCapture(Kt.pointerId)}catch{}}if(g==="pen"){D(!0);const te=Be.getPointerPosition(),{x:ae,y:qe}=F(te),xe={tool:"pen",points:[ae,qe],color:_,strokeWidth:E};y.current.push([...z]),B.current=[],K.current=xe,L([...z,xe])}else g==="eraser"&&(D(!0),U.current=!1)},gt=Rt=>{const Kt=Rt.evt;if(Kt!=null&&Kt.preventDefault&&Kt.preventDefault(),Kt!=null&&Kt.stopPropagation&&Kt.stopPropagation(),!v||!it(Kt))return;const te=Rt.target.getStage().getPointerPosition();if(g==="pen"){if(K.current){const{x:ae,y:qe}=F(te);K.current.points=K.current.points.concat([ae,qe]);const xe=K.current;Q.current&&cancelAnimationFrame(Q.current),Q.current=requestAnimationFrame(()=>{xe&&L(an=>an.length===0?an:[...an.slice(0,-1),xe])})}}else if(g==="eraser"){const ae=z.length,qe=20,xe=z.filter(an=>{for(let yn=0;yn<an.points.length;yn+=2){const hn=an.points[yn]*W.x,ct=an.points[yn+1]*W.y;if(Math.sqrt(Math.pow(hn-te.x,2)+Math.pow(ct-te.y,2))<qe)return!1}return!0});xe.length<ae&&!U.current&&(y.current.push([...z]),B.current=[],U.current=!0),L(xe)}},At=Rt=>{const Kt=Rt==null?void 0:Rt.evt;if(!it(Kt)){Kt!=null&&Kt.preventDefault&&Kt.preventDefault();return}if(D(!1),Q.current&&(cancelAnimationFrame(Q.current),Q.current=null),K.current&&g==="pen"){const Be=K.current;L(te=>{if(te.length===0)return te;const ae=[...te.slice(0,-1),Be];return setTimeout(()=>i(ae),0),ae}),K.current=null}else setTimeout(()=>i(z),0)},Bt=()=>{if(y.current.length>0){const Rt=y.current.pop();B.current.push([...z]),L(Rt),i(Rt)}},qt=()=>{if(B.current.length>0){const Rt=B.current.pop();y.current.push([...z]),L(Rt),i(Rt)}},Jt=()=>{y.current.push([...z]),B.current=[];const Rt=[];L(Rt),i(Rt)},ee=()=>{f&&f(o.clientId)},Gt=()=>{D(!1),n()},be=()=>{M(Rt=>Rt==="stylus-only"?"all":"stylus-only")},Re=()=>{w(Rt=>Rt==="left"?"right":"left")},tn=Rt=>{Rt.preventDefault(),Rt.stopPropagation()};return Z.jsx("div",{className:"annotation-modal-overlay",onTouchMove:tn,onTouchStart:tn,children:Z.jsx("div",{className:"annotation-modal student-console",children:Z.jsxs("div",{className:"annotation-console",children:[Z.jsxs("div",{className:"annotation-status-bar",children:[Z.jsxs("div",{className:"annotation-status-text",children:[Z.jsx("h1",{children:"Annotate Student"}),Z.jsx("p",{children:rt()})]}),Z.jsxs("div",{className:"annotation-status-actions",children:[Z.jsx("div",{className:"tool-status-indicator",children:Z.jsxs("span",{className:"tool-status-text",children:[Z.jsx("i",{className:g==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",N==="all"?"All inputs":"Stylus only"]})}),Z.jsxs("button",{className:`flag-pill ${l?"active":""}`,onClick:ee,children:[Z.jsx(f4,{active:l,size:16}),l?"Flagged":"Flag"]}),Z.jsxs("button",{className:"status-badge",onClick:Re,children:["Move toolbar to ",G==="left"?"right":"left"]}),Z.jsx("button",{className:"status-badge danger",onClick:Gt,children:"✕ Close"})]})]}),Z.jsxs("div",{className:`annotation-workspace ${G==="right"?"toolbar-right":""}`,children:[Z.jsxs("div",{className:"annotation-sidebar",children:[Z.jsxs("div",{className:"sidebar-header",children:[Z.jsx("h2",{children:"Annotation Console"}),Z.jsx("p",{children:"Mirror of student workspace"})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"COLORS"}),Z.jsx("div",{className:"color-row",children:p2.map(Rt=>Z.jsx("button",{className:`color-button ${_===Rt.value?"active":""}`,style:{background:Rt.value},onClick:()=>C(Rt.value),"aria-label":Rt.label},Rt.value))})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),Z.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[Z.jsxs("button",{onClick:()=>m("pen"),className:`tool-icon-button ${g==="pen"?"active":""}`,title:"Pen",children:[Z.jsx("i",{className:"pi pi-pencil tool-icon"}),Z.jsx("span",{className:"tool-label",children:"Pen"})]}),Z.jsxs("button",{onClick:()=>m("eraser"),className:`tool-icon-button ${g==="eraser"?"active":""}`,title:"Eraser",children:[Z.jsx("i",{className:"pi pi-eraser tool-icon"}),Z.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),Z.jsxs("div",{className:"brush-size-control",children:[Z.jsx("input",{type:"range",min:"1",max:"10",value:E,onChange:Rt=>R(parseInt(Rt.target.value)),className:"brush-slider"}),Z.jsx("span",{className:"brush-value",children:E})]})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),Z.jsx("button",{className:`input-mode-toggle ${N==="all"?"all":""}`,onClick:be,children:N==="stylus-only"?"Stylus only":"All inputs"})]}),Z.jsxs("div",{className:"sidebar-section",children:[Z.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),Z.jsxs("div",{className:"history-buttons",children:[Z.jsx("button",{onClick:Bt,className:"history-button",disabled:y.current.length===0,children:"Undo"}),Z.jsx("button",{onClick:qt,className:"history-button",disabled:B.current.length===0,children:"Redo"}),Z.jsx("button",{onClick:Jt,className:"history-button danger",children:"Clear"})]})]})]}),Z.jsx("div",{className:"annotation-canvas-panel",children:Z.jsx("div",{className:"annotation-canvas-frame",ref:V,onTouchMove:Rt=>Rt.preventDefault(),onTouchStart:Rt=>Rt.preventDefault(),children:Z.jsxs(av,{ref:j,width:I.width,height:I.height,onPointerDown:nt,onPointerMove:gt,onPointerUp:At,onPointerLeave:At,onTouchStart:Rt=>Rt.preventDefault(),onTouchMove:Rt=>Rt.preventDefault(),onTouchEnd:Rt=>Rt.preventDefault(),className:"annotation-stage",perfectDrawEnabled:!1,children:[J&&Z.jsx(dl,{listening:!1,children:Z.jsx(iv,{image:O,x:J.x,y:J.y,width:J.width,height:J.height})}),Z.jsx(dl,{listening:!1,children:o.lines&&o.lines.map((Rt,Kt)=>Z.jsx(of,{points:q(Rt.points),stroke:Rt.color||"black",strokeWidth:(Rt.strokeWidth||3)*W.x,tension:.5,lineCap:"round",lineJoin:"round"},`student-${Kt}`))}),Z.jsx(dl,{children:z.map((Rt,Kt)=>Z.jsx(of,{points:q(Rt.points),stroke:Rt.color,strokeWidth:tt(Rt),tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${Kt}`))})]})})})]})]})})})},ET=async(o,t=800,n=600,i=.7)=>{const r=await createImageBitmap(o),l=Math.min(t/r.width,n/r.height,1),f=Math.round(r.width*l),d=Math.round(r.height*l),g=document.createElement("canvas");g.width=f,g.height=d,g.getContext("2d").drawImage(r,0,0,f,d);const _=await new Promise((E,R)=>{g.toBlob(v=>{v?E(v):R(new Error("Failed to compress image"))},"image/jpeg",i)}),C=await new Promise((E,R)=>{const v=new FileReader;v.onload=()=>E(v.result),v.onerror=R,v.readAsDataURL(_)});return{blob:_,dataUrl:C,width:f,height:d,size:_.size}},CT=()=>{const[o,t]=Fm(),n=dd(),i=()=>{const Ut="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let Yt="";for(let re=0;re<6;re++)Yt+=Ut.charAt(Math.floor(Math.random()*Ut.length));return Yt},r=()=>{const Ut=o.get("room");if(Ut)return Ut.toUpperCase();const Yt=i();return t({room:Yt}),Yt},[l]=In.useState(r),[f,d]=dt.useState(null),[g,m]=dt.useState(null),[_,C]=dt.useState(null),[E,R]=dt.useState(0),[v,D]=dt.useState("created"),[z,L]=dt.useState(null),[N,M]=dt.useState(null),[G,w]=dt.useState(!1),[O]=dt.useState(`teacher-${Math.random().toString(36).substring(7)}`),[A,y]=dt.useState(()=>{const Ut=parseInt(o.get("bot"))||0,Yt={};if(Ut>0)for(let re=1;re<=Ut;re++){const ce=`bot-${re}`;Yt[ce]={clientId:ce,name:`Bot ${re}`,lines:[],lastUpdate:Date.now()-re*1e3,isActive:!0,isFlagged:!1}}return Yt}),[B,U]=dt.useState(null),[P,Y]=dt.useState({}),[K,Q]=dt.useState(""),[V,j]=dt.useState("all"),[I,X]=dt.useState(()=>{const Ut=localStorage.getItem("teacherDashboardHideNames");return Ut?JSON.parse(Ut):!1}),[W,at]=dt.useState(()=>{const Ut=localStorage.getItem("teacherDashboardCardsPerRow");return Ut?parseInt(Ut):3}),[J,rt]=dt.useState("blank"),[it,q]=dt.useState(null),[F,tt]=dt.useState(null),[nt,gt]=dt.useState(""),[At,Bt]=dt.useState(!1),[qt,Jt]=dt.useState(null),ee=dt.useRef(null),Gt=dt.useRef(null),[be,Re]=dt.useState(!1),[tn,Rt]=dt.useState(""),[Kt,Be]=dt.useState([]),te=dt.useRef(!1);dt.useEffect(()=>{ee.current=qt},[qt]);const ae=(Ut,Yt="info")=>{const re=Date.now();Be(ce=>[...ce,{id:re,message:Ut,type:Yt}]),setTimeout(()=>{Be(ce=>ce.filter(Ht=>Ht.id!==re))},4e3)};dt.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(I))},[I]),dt.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",W.toString())},[W]),dt.useEffect(()=>{(async()=>{try{console.log("📝 Initializing session in Supabase with room code:",l);const{data:Yt,error:re}=await Ni.from("sessions").select("*").ilike("room_code",l).order("created_at",{ascending:!1}).limit(1);if(re){console.error("Failed to query sessions:",re);return}let ce=null;if(Yt&&Yt.length>0){const Ht=Yt[0];if(Ht.status==="ended"){console.log("⏸️ Found ended session, resetting to created status");const{data:ze,error:ne}=await Ni.from("sessions").update({status:"created",started_at:null,ended_at:null}).eq("id",Ht.id).select().single();if(ne){console.error("Failed to update session:",ne);return}ce=ze,console.log("✅ Session reset to created:",ce)}else console.log("♻️ Reusing existing session:",Ht),ce=Ht}else{console.log("🆕 No existing session found, creating new one");const{data:Ht,error:ze}=await Ni.from("sessions").insert([{room_code:l,status:"created"}]).select().single();if(ze){console.error("Failed to create session:",ze);return}ce=Ht,console.log("✅ Session created:",ce)}if(ce){d(ce.id),D(ce.status);const{data:Ht,error:ze}=await Ni.from("participants").insert([{session_id:ce.id,client_id:O,name:"Teacher",role:"teacher"}]).select().single();ze?console.error("Failed to create teacher participant:",ze):(console.log("👤 Teacher participant created:",Ht),m(Ht.id))}}catch(Yt){console.error("Error initializing session:",Yt)}})()},[l]),dt.useEffect(()=>(f&&(async()=>{try{const Yt=`/api/token?clientId=${O}`,ce=await(await fetch(Yt)).json(),Ht=new JC.Realtime({authCallback:async(ne,Me)=>{Me(null,ce)},clientId:O});Ht.connection.on("connected",()=>{console.log("Connected to Ably"),w(!0)}),Ht.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),w(!1)}),L(Ht);const ze=Ht.channels.get(`room-${l}`);if(ze.subscribe("student-layer",ne=>{console.log("📥 Teacher received student layer from",ne.clientId),te.current=!0,y(Me=>{var _e,ti,oa;return{...Me,[ne.clientId]:{...Me[ne.clientId]||{},clientId:ne.clientId,name:((_e=Me[ne.clientId])==null?void 0:_e.name)||qe(ne.clientId),lines:ne.data.lines||[],meta:ne.data.meta||((ti=Me[ne.clientId])==null?void 0:ti.meta)||null,lastUpdate:Date.now(),isActive:!0,isFlagged:((oa=Me[ne.clientId])==null?void 0:oa.isFlagged)||!1}}}),setTimeout(()=>{te.current=!1},100)}),ze.presence.subscribe("enter",ne=>{var Me;if(ne.clientId!==O&&ne.clientId.includes("student")){const _e=((Me=ne.data)==null?void 0:Me.name)||qe(ne.clientId);console.log("👋 Student joined:",ne.clientId,"Name:",_e),ae(`${_e} joined`,"success"),y(ti=>{var oa;return{...ti,[ne.clientId]:{...ti[ne.clientId]||{},clientId:ne.clientId,name:_e,isActive:!0,lastUpdate:Date.now(),isFlagged:((oa=ti[ne.clientId])==null?void 0:oa.isFlagged)||!1}}}),setTimeout(()=>{ee.current&&(ze.publish("sync-question-state",{targetClientId:ne.clientId,content:ee.current,timestamp:Date.now()}),console.log("📤 Sent current question state to",ne.clientId))},500)}}),ze.presence.subscribe("leave",ne=>{ne.clientId!==O&&ne.clientId.includes("student")&&(console.log("👋 Student left:",ne.clientId),y(Me=>{const _e=Me[ne.clientId],ti=(_e==null?void 0:_e.name)||qe(ne.clientId);ae(`${ti} left`,"info");const{[ne.clientId]:oa,...vs}=Me;return vs}))}),ze.subscribe("teacher-image",ne=>{console.log("📸 Teacher dashboard received shared image"),Jt(ne.data)}),ze.subscribe("request-current-state",ne=>{console.log("📞 Student requesting current state:",ne.clientId),setTimeout(()=>{ee.current?(ze.publish("sync-question-state",{targetClientId:ne.clientId,content:ee.current,timestamp:Date.now()}),console.log("📤 Sent current question state to",ne.clientId)):console.log("📭 No question state to send (blank canvas)")},100)}),await ze.presence.enter(),M(ze),f)try{const{data:ne,error:Me}=await Ni.from("participants").insert([{session_id:f,client_id:O,role:"teacher"}]).select().single();Me?console.error("Failed to create teacher participant:",Me):(console.log("✅ Teacher participant created:",ne),m(ne.id))}catch(ne){console.error("Error creating teacher participant:",ne)}}catch(Yt){console.error("Failed to connect to Ably:",Yt)}})(),()=>{z&&z.close()}),[l,O,f]),dt.useEffect(()=>{const Ut=async Yt=>{if((v==="active"||v==="created")&&(Yt.preventDefault(),Yt.returnValue="This will end the session for all students. Are you sure?",f))try{await Ni.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",f),N&&await N.publish("session-ended",{timestamp:Date.now(),reason:"teacher_left"}),console.log("✅ Session ended")}catch(re){console.error("Error ending session:",re)}};return window.addEventListener("beforeunload",Ut),()=>{window.removeEventListener("beforeunload",Ut)}},[v,f,N]);const qe=Ut=>{const Yt=Ut.match(/student-(\d+)/)||Ut.match(/student-([\w]+)/);return Yt?`Student ${Yt[1]}`:Ut},xe=Ut=>{U(A[Ut.clientId]||Ut)},an=()=>{U(null)},yn=Ut=>{if(!B||!N)return;const Yt=B.clientId;Y(re=>({...re,[Yt]:Ut})),N.publish("teacher-annotation",{targetStudentId:Yt,annotations:Ut,teacherId:O,timestamp:Date.now()}),console.log("📤 Published annotations for",Yt)},hn=Ut=>{y(Yt=>{const re=Yt[Ut];return re?{...Yt,[Ut]:{...re,isFlagged:!re.isFlagged}}:Yt}),U(Yt=>Yt&&Yt.clientId===Ut?{...Yt,isFlagged:!Yt.isFlagged}:Yt)},ct=()=>{Gt.current&&(Gt.current.value="",Gt.current.click())},ht=async Ut=>{var re;const Yt=(re=Ut.target.files)==null?void 0:re[0];if(!Yt){gt("No file selected.");return}Bt(!0),gt("");try{const{dataUrl:ce,width:Ht,height:ze}=await ET(Yt),ne={dataUrl:ce,width:Ht,height:ze,filename:Yt.name,timestamp:Date.now()};tt(ne),gt("Image ready to send.")}catch(ce){console.error("Failed to upload image from dashboard:",ce),gt("Upload failed. Please try again.")}finally{Bt(!1)}},ut=()=>{tt(null),gt(""),Gt.current&&(Gt.current.value="")},xt=Ut=>{const Yt=document.createElement("canvas"),re=800,ce=600;Yt.width=re,Yt.height=ce;const Ht=Yt.getContext("2d");if(Ht.fillStyle="#FFFFFF",Ht.fillRect(0,0,re,ce),Ut==="hanzi"){const Me=(re-450)/2,_e=(ce-450)/2;Ht.strokeStyle="#0F9D83",Ht.lineWidth=4,Ht.strokeRect(Me,_e,450,450),Ht.strokeStyle="#B0E8D8",Ht.lineWidth=2,Ht.setLineDash([8,8]),Ht.beginPath(),Ht.moveTo(re/2,_e),Ht.lineTo(re/2,_e+450),Ht.stroke(),Ht.beginPath(),Ht.moveTo(Me,ce/2),Ht.lineTo(Me+450,ce/2),Ht.stroke()}else if(Ut==="graph-corner"){Ht.strokeStyle="#E0E0E0",Ht.lineWidth=1,Ht.setLineDash([]);for(let _e=80;_e<=re-80;_e+=40)Ht.beginPath(),Ht.moveTo(_e,80),Ht.lineTo(_e,ce-80),Ht.stroke();for(let _e=80;_e<=ce-80;_e+=40)Ht.beginPath(),Ht.moveTo(80,_e),Ht.lineTo(re-80,_e),Ht.stroke();Ht.strokeStyle="#5B9BD5",Ht.lineWidth=3,Ht.beginPath(),Ht.moveTo(80,ce-80),Ht.lineTo(re-80,ce-80),Ht.stroke(),Ht.beginPath(),Ht.moveTo(80,80),Ht.lineTo(80,ce-80),Ht.stroke()}else if(Ut==="graph-cross"){Ht.strokeStyle="#E0E0E0",Ht.lineWidth=1,Ht.setLineDash([]);for(let _e=80;_e<=re-80;_e+=40)Ht.beginPath(),Ht.moveTo(_e,80),Ht.lineTo(_e,ce-80),Ht.stroke();for(let _e=80;_e<=ce-80;_e+=40)Ht.beginPath(),Ht.moveTo(80,_e),Ht.lineTo(re-80,_e),Ht.stroke();Ht.strokeStyle="#5B9BD5",Ht.lineWidth=3,Ht.beginPath(),Ht.moveTo(80,ce/2),Ht.lineTo(re-80,ce/2),Ht.stroke(),Ht.beginPath(),Ht.moveTo(re/2,80),Ht.lineTo(re/2,ce-80),Ht.stroke()}const ze=Yt.toDataURL("image/png");return{type:Ut,dataUrl:ze,width:re,height:ce,timestamp:Date.now()}},Dt=Ut=>{const Yt=xt(Ut);q(Yt),gt(`Template ready: ${Ut}`)},$t=async()=>{if(!(!N||!f))try{if(v==="created"){console.log("🎬 Starting session...");const{error:Me}=await Ni.from("sessions").update({status:"active",started_at:new Date().toISOString()}).eq("id",f);if(Me){console.error("Failed to start session:",Me),gt("Failed to start session. Please try again.");return}D("active"),await N.publish("session-started",{timestamp:Date.now(),sessionId:f}),console.log("✅ Session started!")}const Yt=E+1;R(Yt);let re="blank",ce=null,Ht=null;J==="templates"&&it?(re="template",ce=it.type,Ht={dataUrl:it.dataUrl,width:it.width,height:it.height}):J==="image"&&F&&(re="image",Ht={dataUrl:F.dataUrl,width:F.width,height:F.height,filename:F.filename});const{data:ze,error:ne}=await Ni.from("questions").insert([{session_id:f,question_number:Yt,content_type:re,template_type:ce,image_data:Ht}]).select().single();if(ne){console.error("Failed to create question:",ne),gt("Failed to save question. Please try again.");return}console.log("✅ Question created:",ze),C(ze.id),await N.publish("clear-all-drawings",{timestamp:Date.now(),questionId:ze.id}),y(Me=>{const _e={};return Object.keys(Me).forEach(ti=>{_e[ti]={...Me[ti],lines:[]}}),_e}),Y({}),J==="blank"?(await N.publish("teacher-clear",{timestamp:Date.now()}),Jt(null),q(null),gt(`Question ${Yt}: Blank canvas sent to all students.`),ae(`Question ${Yt} sent!`,"success")):J==="templates"&&it?(await N.publish("teacher-template",it),Jt(it),gt(`Question ${Yt}: Template sent to all students.`),ae(`Question ${Yt} sent!`,"success")):J==="image"&&F&&(await N.publish("teacher-image",F),Jt(F),gt(`Question ${Yt}: Image sent to all students.`),ae(`Question ${Yt} sent!`,"success"))}catch(Ut){console.error("Failed to send to class:",Ut),gt("Failed to send. Please try again."),ae("Failed to send question","error")}},de=async()=>{if(f&&(v==="active"||v==="created"))try{await Ni.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",f),N&&await N.publish("session-ended",{timestamp:Date.now(),reason:"teacher_ended"}),console.log("✅ Session ended")}catch(Ut){console.error("Error ending session:",Ut)}z&&z.close(),n("/")},Fe=async()=>{const Ut=`${window.location.origin}/student?room=${l}`;try{const Yt=await ST.toDataURL(Ut,{width:300,margin:2,color:{dark:"#0F172A",light:"#FFFFFF"}});Rt(Yt),Re(!0)}catch(Yt){console.error("Failed to generate QR code:",Yt)}},Je=async()=>{const Ut=`${window.location.origin}/student?room=${l}`;try{await navigator.clipboard.writeText(Ut),alert("Link copied to clipboard!")}catch(Yt){console.error("Failed to copy link:",Yt),alert("Failed to copy link. Please copy manually.")}},Ki=()=>Object.values(A).sort((Ut,Yt)=>Ut.isActive&&!Yt.isActive?-1:!Ut.isActive&&Yt.isActive?1:(Yt.lastUpdate||0)-(Ut.lastUpdate||0)),ur=()=>{const Ut=Ki(),Yt=K.trim().toLowerCase();return Ut.filter(re=>{const ce=Yt?(re.name||re.clientId).toLowerCase().includes(Yt):!0,Ht=V==="all"||V==="flagged"&&re.isFlagged;return ce&&Ht})},sa=Ki(),Di=ur(),la=sa.filter(Ut=>Ut.isActive).length,gi=B?A[B.clientId]||B:null,Sa=nt?!/fail|no file/i.test(nt):!1;return Z.jsxs("div",{className:"teacher-dashboard",children:[Z.jsx("div",{className:"toast-container",children:Kt.map(Ut=>Z.jsxs("div",{className:`toast toast-${Ut.type}`,children:[Ut.type==="success"&&Z.jsx("span",{className:"toast-icon",children:"✓"}),Ut.type==="info"&&Z.jsx("span",{className:"toast-icon",children:"ℹ"}),Ut.type==="error"&&Z.jsx("span",{className:"toast-icon",children:"✕"}),Z.jsx("span",{className:"toast-message",children:Ut.message})]},Ut.id))}),Z.jsxs("div",{className:"dashboard-shell",children:[Z.jsx("button",{className:"back-link",onClick:de,children:"← Exit class"}),Z.jsxs("section",{className:"hero-card glass-panel",children:[Z.jsxs("div",{className:"hero-top",children:[Z.jsxs("div",{className:"hero-copy",children:[Z.jsx("p",{className:"eyebrow",children:"Teacher dashboard"}),Z.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),Z.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),Z.jsxs("div",{className:"session-info",children:[Z.jsxs("div",{className:"session-code-pill clickable",onClick:Fe,style:{cursor:"pointer"},children:[Z.jsx("span",{className:"pill-label",children:"Session code"}),Z.jsx("span",{className:"pill-value",children:l})]}),Z.jsxs("div",{className:"status-group",children:[Z.jsx("span",{className:"status-pill session-pill",children:"Session live"}),Z.jsx("span",{className:`status-pill connection-pill ${G?"online":"offline"}`,children:G?"Connected":"Disconnected"}),Z.jsxs("span",{className:"status-pill count-pill",children:[Z.jsx("strong",{children:la}),Z.jsx("span",{children:"online"})]})]})]})]}),Z.jsxs("div",{className:"hero-controls",children:[Z.jsxs("div",{className:"search-input-wrapper",children:[Z.jsx("span",{className:"search-icon",children:"🔍"}),Z.jsx("input",{type:"text",placeholder:"Filter students",value:K,onChange:Ut=>Q(Ut.target.value),className:"search-input"}),K&&Z.jsx("button",{className:"clear-search-btn",onClick:()=>Q(""),title:"Clear search",children:"✕"})]}),Z.jsxs("div",{className:"control-set",children:[Z.jsxs("label",{className:"hide-names-checkbox",children:[Z.jsx("input",{type:"checkbox",checked:I,onChange:Ut=>X(Ut.target.checked)}),Z.jsx("span",{children:"Hide names"})]}),Z.jsx("button",{type:"button",className:`chip-button ${V==="flagged"?"active":""}`,onClick:()=>j(Ut=>Ut==="flagged"?"all":"flagged"),children:"Flagged only"}),Z.jsxs("div",{className:"cards-select",children:[Z.jsx("span",{children:"Cards/row"}),Z.jsxs("select",{value:W,onChange:Ut=>at(Number(Ut.target.value)),children:[Z.jsx("option",{value:2,children:"2"}),Z.jsx("option",{value:3,children:"3"}),Z.jsx("option",{value:4,children:"4"})]})]})]})]})]}),Z.jsxs("section",{className:"prep-card glass-panel",children:[Z.jsxs("div",{className:"prep-header",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"eyebrow",children:"Prepare next question"}),it&&Z.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",it.type==="hanzi"?"Hanzi":it.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),Z.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),Z.jsx("button",{className:"send-to-class-btn",onClick:$t,disabled:J==="image"&&!F,children:"Send to class"})]}),Z.jsxs("div",{className:"prep-controls",children:[Z.jsxs("div",{className:"prep-tabs",children:[Z.jsx("button",{type:"button",className:`prep-tab ${J==="blank"?"active":""}`,onClick:()=>{rt("blank"),q(null),tt(null)},children:"Blank canvas"}),Z.jsx("button",{type:"button",className:`prep-tab ${J==="templates"?"active":""}`,onClick:()=>{rt("templates"),tt(null)},children:"Templates"}),Z.jsx("button",{type:"button",className:`prep-tab ${J==="image"?"active":""} ${F?"ready":""}`,onClick:()=>{rt("image"),q(null)},disabled:At,children:At?"Uploading…":"Send image"})]}),Z.jsx("input",{ref:Gt,type:"file",accept:"image/*",onChange:ht,style:{display:"none"}}),J==="templates"&&Z.jsxs("div",{className:"template-selector",children:[Z.jsxs("div",{className:"template-buttons",children:[Z.jsx("button",{type:"button",className:`template-btn ${(it==null?void 0:it.type)==="hanzi"?"active":""}`,onClick:()=>Dt("hanzi"),children:"Hanzi box"}),Z.jsx("button",{type:"button",className:`template-btn ${(it==null?void 0:it.type)==="graph-corner"?"active":""}`,onClick:()=>Dt("graph-corner"),children:"Graph (corner)"}),Z.jsx("button",{type:"button",className:`template-btn ${(it==null?void 0:it.type)==="graph-cross"?"active":""}`,onClick:()=>Dt("graph-cross"),children:"Graph (cross)"})]}),it&&Z.jsxs("div",{className:"template-preview",children:[Z.jsx("img",{src:it.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),Z.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),J==="image"&&Z.jsx(Z.Fragment,{children:F?Z.jsxs("div",{className:"image-preview-surface",children:[Z.jsx("img",{src:F.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),Z.jsxs("div",{className:"preview-meta",children:[Z.jsx("p",{className:"preview-title",children:F.filename||"Prepared image"}),Z.jsx("p",{className:"preview-subtitle",children:F.width&&F.height?`${Math.round(F.width)} × ${Math.round(F.height)} px`:"Ready to send"}),Z.jsxs("div",{className:"image-actions",children:[Z.jsx("button",{className:"ghost-btn",onClick:ct,children:"Choose another"}),Z.jsx("button",{className:"ghost-btn",onClick:ut,children:"Clear"})]}),nt&&Z.jsx("span",{className:`image-message ${Sa?"success":"error"}`,children:nt})]})]}):Z.jsxs("button",{type:"button",className:"image-dropzone",onClick:ct,children:[Z.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),Z.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),Z.jsx("span",{children:"Click to upload an image"}),nt&&Z.jsx("span",{className:`image-message ${Sa?"success":"error"}`,children:nt})]})}),J==="blank"&&Z.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:Z.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),Z.jsx("section",{className:"students-panel",children:Z.jsx("div",{className:"students-surface glass-panel",children:sa.length===0?Z.jsxs("div",{className:"waiting-card",children:[Z.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),Z.jsx("h2",{children:"Waiting for students to join…"}),Z.jsxs("p",{children:["Share the ",Z.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):Di.length===0?Z.jsxs("div",{className:"no-results",children:[Z.jsx("div",{className:"no-results-icon",children:"🔍"}),Z.jsx("h3",{children:"No students found"}),Z.jsxs("p",{children:['No students match "',K,'"']}),Z.jsx("button",{className:"clear-filter-btn",onClick:()=>Q(""),children:"Clear filter"})]}):Z.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${W}, 1fr)`},children:Di.filter(Ut=>Ut&&Ut.clientId).map(Ut=>Z.jsx(bT,{student:Ut,onClick:xe,onToggleFlag:hn,teacherAnnotations:P[Ut.clientId]||[],sharedImage:qt,hideNames:I},Ut.clientId))})})})]}),Z.jsx(_T,{student:gi,isOpen:!!gi,isFlagged:gi==null?void 0:gi.isFlagged,onToggleFlag:hn,onClose:an,onAnnotate:yn,existingAnnotations:gi?P[gi.clientId]||[]:[],sharedImage:qt}),Z.jsx("div",{className:"dashboard-footer",children:Z.jsxs("p",{children:["💡 ",Z.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),be&&Z.jsx("div",{className:"qr-modal-overlay",onClick:()=>Re(!1),children:Z.jsxs("div",{className:"qr-modal",onClick:Ut=>Ut.stopPropagation(),children:[Z.jsxs("div",{className:"qr-modal-header",children:[Z.jsxs("h2",{children:["Join Session: ",l]}),Z.jsx("button",{className:"qr-close-btn",onClick:()=>Re(!1),children:"✕"})]}),Z.jsxs("div",{className:"qr-modal-content",children:[Z.jsx("div",{className:"qr-code-container",children:tn&&Z.jsx("img",{src:tn,alt:"QR Code",className:"qr-code-image"})}),Z.jsxs("div",{className:"qr-instructions",children:[Z.jsxs("p",{className:"qr-instruction-text",children:[Z.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),Z.jsxs("div",{className:"qr-link-box",children:[Z.jsx("input",{type:"text",value:`${window.location.origin}/student?room=${l}`,readOnly:!0,className:"qr-link-input"}),Z.jsx("button",{className:"qr-copy-btn",onClick:Je,children:"Copy Link"})]})]})]})]})})]})};function TT(){return Z.jsx(r3,{children:Z.jsxs(e3,{children:[Z.jsx(Qh,{path:"/",element:Z.jsx(s3,{})}),Z.jsx(Qh,{path:"/student-login",element:Z.jsx(QC,{})}),Z.jsx(Qh,{path:"/student",element:Z.jsx(KC,{})}),Z.jsx(Qh,{path:"/teacher",element:Z.jsx(CT,{})})]})})}ub.createRoot(document.getElementById("root")).render(Z.jsx(In.StrictMode,{children:Z.jsx(TT,{})}));
