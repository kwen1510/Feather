function r4(o,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in o)){const l=Object.getOwnPropertyDescriptor(i,r);l&&Object.defineProperty(o,r,l.get?l:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function hf(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function v2(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var t=o.default;if(typeof t=="function"){var n=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(i){var r=Object.getOwnPropertyDescriptor(o,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return o[i]}})}),n}var mp={exports:{}},qh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ay;function s4(){if(ay)return qh;ay=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(i,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var d in r)d!=="key"&&(l[d]=r[d])}else l=r;return r=l.ref,{$$typeof:o,type:i,key:c,ref:r!==void 0?r:null,props:l}}return qh.Fragment=t,qh.jsx=n,qh.jsxs=n,qh}var ry;function l4(){return ry||(ry=1,mp.exports=s4()),mp.exports}var k=l4(),vp={exports:{}},Te={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sy;function o4(){if(sy)return Te;sy=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),E=Symbol.iterator;function O(Z){return Z===null||typeof Z!="object"?null:(Z=E&&Z[E]||Z["@@iterator"],typeof Z=="function"?Z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,L={};function z(Z,rt,it){this.props=Z,this.context=rt,this.refs=L,this.updater=it||v}z.prototype.isReactComponent={},z.prototype.setState=function(Z,rt){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,rt,"setState")},z.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function M(){}M.prototype=z.prototype;function N(Z,rt,it){this.props=Z,this.context=rt,this.refs=L,this.updater=it||v}var G=N.prototype=new M;G.constructor=N,D(G,z.prototype),G.isPureReactComponent=!0;var R=Array.isArray;function A(){}var T={H:null,A:null,T:null,S:null},y=Object.prototype.hasOwnProperty;function B(Z,rt,it){var Y=it.ref;return{$$typeof:o,type:Z,key:rt,ref:Y!==void 0?Y:null,props:it}}function j(Z,rt){return B(Z.type,rt,Z.props)}function H(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===o}function Q(Z){var rt={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(it){return rt[it]})}var K=/\/+/g;function X(Z,rt){return typeof Z=="object"&&Z!==null&&Z.key!=null?Q(""+Z.key):rt.toString(36)}function V(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(A,A):(Z.status="pending",Z.then(function(rt){Z.status==="pending"&&(Z.status="fulfilled",Z.value=rt)},function(rt){Z.status==="pending"&&(Z.status="rejected",Z.reason=rt)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function U(Z,rt,it,Y,J){var tt=typeof Z;(tt==="undefined"||tt==="boolean")&&(Z=null);var et=!1;if(Z===null)et=!0;else switch(tt){case"bigint":case"string":case"number":et=!0;break;case"object":switch(Z.$$typeof){case o:case t:et=!0;break;case _:return et=Z._init,U(et(Z._payload),rt,it,Y,J)}}if(et)return J=J(Z),et=Y===""?"."+X(Z,0):Y,R(J)?(it="",et!=null&&(it=et.replace(K,"$&/")+"/"),U(J,rt,it,"",function(Dt){return Dt})):J!=null&&(H(J)&&(J=j(J,it+(J.key==null||Z&&Z.key===J.key?"":(""+J.key).replace(K,"$&/")+"/")+et)),rt.push(J)),1;et=0;var gt=Y===""?".":Y+":";if(R(Z))for(var At=0;At<Z.length;At++)Y=Z[At],tt=gt+X(Y,At),et+=U(Y,rt,it,tt,J);else if(At=O(Z),typeof At=="function")for(Z=At.call(Z),At=0;!(Y=Z.next()).done;)Y=Y.value,tt=gt+X(Y,At++),et+=U(Y,rt,it,tt,J);else if(tt==="object"){if(typeof Z.then=="function")return U(V(Z),rt,it,Y,J);throw rt=String(Z),Error("Objects are not valid as a React child (found: "+(rt==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":rt)+"). If you meant to render a collection of children, use an array instead.")}return et}function I(Z,rt,it){if(Z==null)return Z;var Y=[],J=0;return U(Z,Y,"","",function(tt){return rt.call(it,tt,J++)}),Y}function F(Z){if(Z._status===-1){var rt=Z._result;rt=rt(),rt.then(function(it){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=it)},function(it){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=it)}),Z._status===-1&&(Z._status=0,Z._result=rt)}if(Z._status===1)return Z._result.default;throw Z._result}var W=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var rt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(rt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},at={map:I,forEach:function(Z,rt,it){I(Z,function(){rt.apply(this,arguments)},it)},count:function(Z){var rt=0;return I(Z,function(){rt++}),rt},toArray:function(Z){return I(Z,function(rt){return rt})||[]},only:function(Z){if(!H(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return Te.Activity=C,Te.Children=at,Te.Component=z,Te.Fragment=n,Te.Profiler=r,Te.PureComponent=N,Te.StrictMode=i,Te.Suspense=g,Te.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,Te.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return T.H.useMemoCache(Z)}},Te.cache=function(Z){return function(){return Z.apply(null,arguments)}},Te.cacheSignal=function(){return null},Te.cloneElement=function(Z,rt,it){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var Y=D({},Z.props),J=Z.key;if(rt!=null)for(tt in rt.key!==void 0&&(J=""+rt.key),rt)!y.call(rt,tt)||tt==="key"||tt==="__self"||tt==="__source"||tt==="ref"&&rt.ref===void 0||(Y[tt]=rt[tt]);var tt=arguments.length-2;if(tt===1)Y.children=it;else if(1<tt){for(var et=Array(tt),gt=0;gt<tt;gt++)et[gt]=arguments[gt+2];Y.children=et}return B(Z.type,J,Y)},Te.createContext=function(Z){return Z={$$typeof:c,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:l,_context:Z},Z},Te.createElement=function(Z,rt,it){var Y,J={},tt=null;if(rt!=null)for(Y in rt.key!==void 0&&(tt=""+rt.key),rt)y.call(rt,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(J[Y]=rt[Y]);var et=arguments.length-2;if(et===1)J.children=it;else if(1<et){for(var gt=Array(et),At=0;At<et;At++)gt[At]=arguments[At+2];J.children=gt}if(Z&&Z.defaultProps)for(Y in et=Z.defaultProps,et)J[Y]===void 0&&(J[Y]=et[Y]);return B(Z,tt,J)},Te.createRef=function(){return{current:null}},Te.forwardRef=function(Z){return{$$typeof:d,render:Z}},Te.isValidElement=H,Te.lazy=function(Z){return{$$typeof:_,_payload:{_status:-1,_result:Z},_init:F}},Te.memo=function(Z,rt){return{$$typeof:m,type:Z,compare:rt===void 0?null:rt}},Te.startTransition=function(Z){var rt=T.T,it={};T.T=it;try{var Y=Z(),J=T.S;J!==null&&J(it,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(A,W)}catch(tt){W(tt)}finally{rt!==null&&it.types!==null&&(rt.types=it.types),T.T=rt}},Te.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},Te.use=function(Z){return T.H.use(Z)},Te.useActionState=function(Z,rt,it){return T.H.useActionState(Z,rt,it)},Te.useCallback=function(Z,rt){return T.H.useCallback(Z,rt)},Te.useContext=function(Z){return T.H.useContext(Z)},Te.useDebugValue=function(){},Te.useDeferredValue=function(Z,rt){return T.H.useDeferredValue(Z,rt)},Te.useEffect=function(Z,rt){return T.H.useEffect(Z,rt)},Te.useEffectEvent=function(Z){return T.H.useEffectEvent(Z)},Te.useId=function(){return T.H.useId()},Te.useImperativeHandle=function(Z,rt,it){return T.H.useImperativeHandle(Z,rt,it)},Te.useInsertionEffect=function(Z,rt){return T.H.useInsertionEffect(Z,rt)},Te.useLayoutEffect=function(Z,rt){return T.H.useLayoutEffect(Z,rt)},Te.useMemo=function(Z,rt){return T.H.useMemo(Z,rt)},Te.useOptimistic=function(Z,rt){return T.H.useOptimistic(Z,rt)},Te.useReducer=function(Z,rt,it){return T.H.useReducer(Z,rt,it)},Te.useRef=function(Z){return T.H.useRef(Z)},Te.useState=function(Z){return T.H.useState(Z)},Te.useSyncExternalStore=function(Z,rt,it){return T.H.useSyncExternalStore(Z,rt,it)},Te.useTransition=function(){return T.H.useTransition()},Te.version="19.2.0",Te}var ly;function Eg(){return ly||(ly=1,vp.exports=o4()),vp.exports}var lt=Eg();const qn=hf(lt),u4=r4({__proto__:null,default:qn},[lt]);var yp={exports:{}},Vh={},Sp={exports:{}},bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy;function c4(){return oy||(oy=1,(function(o){function t(U,I){var F=U.length;U.push(I);t:for(;0<F;){var W=F-1>>>1,at=U[W];if(0<r(at,I))U[W]=I,U[F]=at,F=W;else break t}}function n(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var I=U[0],F=U.pop();if(F!==I){U[0]=F;t:for(var W=0,at=U.length,Z=at>>>1;W<Z;){var rt=2*(W+1)-1,it=U[rt],Y=rt+1,J=U[Y];if(0>r(it,F))Y<at&&0>r(J,it)?(U[W]=J,U[Y]=F,W=Y):(U[W]=it,U[rt]=F,W=rt);else if(Y<at&&0>r(J,F))U[W]=J,U[Y]=F,W=Y;else break t}}return I}function r(U,I){var F=U.sortIndex-I.sortIndex;return F!==0?F:U.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],_=1,C=null,E=3,O=!1,v=!1,D=!1,L=!1,z=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function G(U){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=U)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function R(U){if(D=!1,G(U),!v)if(n(g)!==null)v=!0,A||(A=!0,Q());else{var I=n(m);I!==null&&V(R,I.startTime-U)}}var A=!1,T=-1,y=5,B=-1;function j(){return L?!0:!(o.unstable_now()-B<y)}function H(){if(L=!1,A){var U=o.unstable_now();B=U;var I=!0;try{t:{v=!1,D&&(D=!1,M(T),T=-1),O=!0;var F=E;try{e:{for(G(U),C=n(g);C!==null&&!(C.expirationTime>U&&j());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var at=W(C.expirationTime<=U);if(U=o.unstable_now(),typeof at=="function"){C.callback=at,G(U),I=!0;break e}C===n(g)&&i(g),G(U)}else i(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&V(R,Z.startTime-U),I=!1}}break t}finally{C=null,E=F,O=!1}I=void 0}}finally{I?Q():A=!1}}}var Q;if(typeof N=="function")Q=function(){N(H)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=H,Q=function(){X.postMessage(null)}}else Q=function(){z(H,0)};function V(U,I){T=z(function(){U(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(U){U.callback=null},o.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<U?Math.floor(1e3/U):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(U){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return U()}finally{E=F}},o.unstable_requestPaint=function(){L=!0},o.unstable_runWithPriority=function(U,I){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var F=E;E=U;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(U,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,U){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=F+at,U={id:_++,callback:I,priorityLevel:U,startTime:F,expirationTime:at,sortIndex:-1},F>W?(U.sortIndex=F,t(m,U),n(g)===null&&U===n(m)&&(D?(M(T),T=-1):D=!0,V(R,F-W))):(U.sortIndex=at,t(g,U),v||O||(v=!0,A||(A=!0,Q()))),U},o.unstable_shouldYield=j,o.unstable_wrapCallback=function(U){var I=E;return function(){var F=E;E=I;try{return U.apply(this,arguments)}finally{E=F}}}})(bp)),bp}var uy;function f4(){return uy||(uy=1,Sp.exports=c4()),Sp.exports}var _p={exports:{}},Fi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy;function h4(){if(cy)return Fi;cy=1;var o=Eg();function t(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(g,m,_){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:C==null?null:""+C,children:g,containerInfo:m,implementation:_}}var c=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Fi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Fi.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(g,m,null,_)},Fi.flushSync=function(g){var m=c.T,_=i.p;try{if(c.T=null,i.p=2,g)return g()}finally{c.T=m,i.p=_,i.d.f()}},Fi.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},Fi.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Fi.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,O=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:C,integrity:E,fetchPriority:O}):_==="script"&&i.d.X(g,{crossOrigin:C,integrity:E,fetchPriority:O,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Fi.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=d(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},Fi.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin);i.d.L(g,_,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Fi.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=d(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},Fi.requestFormReset=function(g){i.d.r(g)},Fi.unstable_batchedUpdates=function(g,m){return g(m)},Fi.useFormState=function(g,m,_){return c.H.useFormState(g,m,_)},Fi.useFormStatus=function(){return c.H.useHostTransitionStatus()},Fi.version="19.2.0",Fi}var fy;function y2(){if(fy)return _p.exports;fy=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),_p.exports=h4(),_p.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function d4(){if(hy)return Vh;hy=1;var o=f4(),t=Eg(),n=y2();function i(e){var a="https://react.dev/errors/"+e;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)a+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+e+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var a=e,f=e;if(e.alternate)for(;a.return;)a=a.return;else{e=a;do a=e,(a.flags&4098)!==0&&(f=a.return),e=a.return;while(e)}return a.tag===3?f:null}function c(e){if(e.tag===13){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function d(e){if(e.tag===31){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function g(e){if(l(e)!==e)throw Error(i(188))}function m(e){var a=e.alternate;if(!a){if(a=l(e),a===null)throw Error(i(188));return a!==e?null:e}for(var f=e,h=a;;){var b=f.return;if(b===null)break;var w=b.alternate;if(w===null){if(h=b.return,h!==null){f=h;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===f)return g(b),e;if(w===h)return g(b),a;w=w.sibling}throw Error(i(188))}if(f.return!==h.return)f=b,h=w;else{for(var q=!1,$=b.child;$;){if($===f){q=!0,f=b,h=w;break}if($===h){q=!0,h=b,f=w;break}$=$.sibling}if(!q){for($=w.child;$;){if($===f){q=!0,f=w,h=b;break}if($===h){q=!0,h=w,f=b;break}$=$.sibling}if(!q)throw Error(i(189))}}if(f.alternate!==h)throw Error(i(190))}if(f.tag!==3)throw Error(i(188));return f.stateNode.current===f?e:a}function _(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e;for(e=e.child;e!==null;){if(a=_(e),a!==null)return a;e=e.sibling}return null}var C=Object.assign,E=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),N=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function Q(e){return e===null||typeof e!="object"?null:(e=H&&e[H]||e["@@iterator"],typeof e=="function"?e:null)}var K=Symbol.for("react.client.reference");function X(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===K?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case D:return"Fragment";case z:return"Profiler";case L:return"StrictMode";case R:return"Suspense";case A:return"SuspenseList";case B:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case N:return e.displayName||"Context";case M:return(e._context.displayName||"Context")+".Consumer";case G:var a=e.render;return e=e.displayName,e||(e=a.displayName||a.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case T:return a=e.displayName||null,a!==null?a:X(e.type)||"Memo";case y:a=e._payload,e=e._init;try{return X(e(a))}catch{}}return null}var V=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},W=[],at=-1;function Z(e){return{current:e}}function rt(e){0>at||(e.current=W[at],W[at]=null,at--)}function it(e,a){at++,W[at]=e.current,e.current=a}var Y=Z(null),J=Z(null),tt=Z(null),et=Z(null);function gt(e,a){switch(it(tt,a),it(J,e),it(Y,null),a.nodeType){case 9:case 11:e=(e=a.documentElement)&&(e=e.namespaceURI)?Ov(e):0;break;default:if(e=a.tagName,a=a.namespaceURI)a=Ov(a),e=Rv(a,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}rt(Y),it(Y,e)}function At(){rt(Y),rt(J),rt(tt)}function Dt(e){e.memoizedState!==null&&it(et,e);var a=Y.current,f=Rv(a,e.type);a!==f&&(it(J,e),it(Y,f))}function Qt(e){J.current===e&&(rt(Y),rt(J)),et.current===e&&(rt(et),Hh._currentValue=F)}var ee,le;function kt(e){if(ee===void 0)try{throw Error()}catch(f){var a=f.stack.trim().match(/\n( *(at )?)/);ee=a&&a[1]||"",le=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ee+e+le}var ye=!1;function _e(e,a){if(!e||ye)return"";ye=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var Mt=function(){throw Error()};if(Object.defineProperty(Mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Mt,[])}catch(Tt){var Et=Tt}Reflect.construct(e,[],Mt)}else{try{Mt.call()}catch(Tt){Et=Tt}e.call(Mt.prototype)}}else{try{throw Error()}catch(Tt){Et=Tt}(Mt=e())&&typeof Mt.catch=="function"&&Mt.catch(function(){})}}catch(Tt){if(Tt&&Et&&typeof Tt.stack=="string")return[Tt.stack,Et.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),q=w[0],$=w[1];if(q&&$){var ot=q.split(`
`),St=$.split(`
`);for(b=h=0;h<ot.length&&!ot[h].includes("DetermineComponentFrameRoot");)h++;for(;b<St.length&&!St[b].includes("DetermineComponentFrameRoot");)b++;if(h===ot.length||b===St.length)for(h=ot.length-1,b=St.length-1;1<=h&&0<=b&&ot[h]!==St[b];)b--;for(;1<=h&&0<=b;h--,b--)if(ot[h]!==St[b]){if(h!==1||b!==1)do if(h--,b--,0>b||ot[h]!==St[b]){var Rt=`
`+ot[h].replace(" at new "," at ");return e.displayName&&Rt.includes("<anonymous>")&&(Rt=Rt.replace("<anonymous>",e.displayName)),Rt}while(1<=h&&0<=b);break}}}finally{ye=!1,Error.prepareStackTrace=f}return(f=e?e.displayName||e.name:"")?kt(f):""}function Xe(e,a){switch(e.tag){case 26:case 27:case 5:return kt(e.type);case 16:return kt("Lazy");case 13:return e.child!==a&&a!==null?kt("Suspense Fallback"):kt("Suspense");case 19:return kt("SuspenseList");case 0:case 15:return _e(e.type,!1);case 11:return _e(e.type.render,!1);case 1:return _e(e.type,!0);case 31:return kt("Activity");default:return""}}function xt(e){try{var a="",f=null;do a+=Xe(e,f),f=e,e=e.return;while(e);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Xt=Object.prototype.hasOwnProperty,Ue=o.unstable_scheduleCallback,ae=o.unstable_cancelCallback,ge=o.unstable_shouldYield,Fe=o.unstable_requestPaint,Me=o.unstable_now,He=o.unstable_getCurrentPriorityLevel,en=o.unstable_ImmediatePriority,dn=o.unstable_UserBlockingPriority,ft=o.unstable_NormalPriority,ht=o.unstable_LowPriority,ct=o.unstable_IdlePriority,wt=o.log,jt=o.unstable_setDisableYieldValue,Ot=null,Gt=null;function Bt(e){if(typeof wt=="function"&&jt(e),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(Ot,e)}catch{}}var be=Math.clz32?Math.clz32:Pe,we=Math.log,te=Math.LN2;function Pe(e){return e>>>=0,e===0?32:31-(we(e)/te|0)|0}var sn=256,Nn=262144,Bn=4194304;function Zi(e){var a=e&42;if(a!==0)return a;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function La(e,a,f){var h=e.pendingLanes;if(h===0)return 0;var b=0,w=e.suspendedLanes,q=e.pingedLanes;e=e.warmLanes;var $=h&134217727;return $!==0?(h=$&~w,h!==0?b=Zi(h):(q&=$,q!==0?b=Zi(q):f||(f=$&~e,f!==0&&(b=Zi(f))))):($=h&~w,$!==0?b=Zi($):q!==0?b=Zi(q):f||(f=h&~e,f!==0&&(b=Zi(f)))),b===0?0:a!==0&&a!==b&&(a&w)===0&&(w=b&-b,f=a&-a,w>=f||w===32&&(f&4194048)!==0)?a:b}function cr(e,a){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&a)===0}function Cu(e,a){switch(e){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ba(){var e=Bn;return Bn<<=1,(Bn&62914560)===0&&(Bn=4194304),e}function fr(e){for(var a=[],f=0;31>f;f++)a.push(e);return a}function zt(e,a){e.pendingLanes|=a,a!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Yt(e,a,f,h,b,w){var q=e.pendingLanes;e.pendingLanes=f,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=f,e.entangledLanes&=f,e.errorRecoveryDisabledLanes&=f,e.shellSuspendCounter=0;var $=e.entanglements,ot=e.expirationTimes,St=e.hiddenUpdates;for(f=q&~f;0<f;){var Rt=31-be(f),Mt=1<<Rt;$[Rt]=0,ot[Rt]=-1;var Et=St[Rt];if(Et!==null)for(St[Rt]=null,Rt=0;Rt<Et.length;Rt++){var Tt=Et[Rt];Tt!==null&&(Tt.lane&=-536870913)}f&=~Mt}h!==0&&$t(e,h,0),w!==0&&b===0&&e.tag!==0&&(e.suspendedLanes|=w&~(q&~a))}function $t(e,a,f){e.pendingLanes|=a,e.suspendedLanes&=~a;var h=31-be(a);e.entangledLanes|=a,e.entanglements[h]=e.entanglements[h]|1073741824|f&261930}function oe(e,a){var f=e.entangledLanes|=a;for(e=e.entanglements;f;){var h=31-be(f),b=1<<h;b&a|e[h]&a&&(e[h]|=a),f&=~b}}function It(e,a){var f=a&-a;return f=(f&42)!==0?1:ze(f),(f&(e.suspendedLanes|a))!==0?0:f}function ze(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Jn(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Kt(){var e=I.p;return e!==0?e:(e=window.event,e===void 0?32:Zv(e.type))}function ie(e,a){var f=I.p;try{return I.p=e,a()}finally{I.p=f}}var Ie=Math.random().toString(36).slice(2),xe="__reactFiber$"+Ie,We="__reactProps$"+Ie,Ai="__reactContainer$"+Ie,Tu="__reactEvents$"+Ie,yd="__reactListeners$"+Ie,Sd="__reactHandles$"+Ie,Au="__reactResources$"+Ie,ys="__reactMarker$"+Ie;function Mn(e){delete e[xe],delete e[We],delete e[Tu],delete e[yd],delete e[Sd]}function Ir(e){var a=e[xe];if(a)return a;for(var f=e.parentNode;f;){if(a=f[Ai]||f[xe]){if(f=a.alternate,a.child!==null||f!==null&&f.child!==null)for(e=Bv(e);e!==null;){if(f=e[xe])return f;e=Bv(e)}return a}e=f,f=e.parentNode}return null}function kr(e){if(e=e[xe]||e[Ai]){var a=e.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return e}return null}function ml(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e.stateNode;throw Error(i(33))}function Ss(e){var a=e[Au];return a||(a=e[Au]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function ti(e){e[ys]=!0}var wu=new Set,Ou={};function hr(e,a){Zn(e,a),Zn(e+"Capture",a)}function Zn(e,a){for(Ou[e]=a,e=0;e<a.length;e++)wu.add(a[e])}var Yn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ru={},vl={};function xu(e){return Xt.call(vl,e)?!0:Xt.call(Ru,e)?!1:Yn.test(e)?vl[e]=!0:(Ru[e]=!0,!1)}function yl(e,a,f){if(xu(a))if(f===null)e.removeAttribute(a);else{switch(typeof f){case"undefined":case"function":case"symbol":e.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){e.removeAttribute(a);return}}e.setAttribute(a,""+f)}}function fa(e,a,f){if(f===null)e.removeAttribute(a);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttribute(a,""+f)}}function ha(e,a,f,h){if(h===null)e.removeAttribute(f);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(f);return}e.setAttributeNS(a,f,""+h)}}function Gi(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Nu(e){var a=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function bd(e,a,f){var h=Object.getOwnPropertyDescriptor(e.constructor.prototype,a);if(!e.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var b=h.get,w=h.set;return Object.defineProperty(e,a,{configurable:!0,get:function(){return b.call(this)},set:function(q){f=""+q,w.call(this,q)}}),Object.defineProperty(e,a,{enumerable:h.enumerable}),{getValue:function(){return f},setValue:function(q){f=""+q},stopTracking:function(){e._valueTracker=null,delete e[a]}}}}function Mu(e){if(!e._valueTracker){var a=Nu(e)?"checked":"value";e._valueTracker=bd(e,a,""+e[a])}}function bf(e){if(!e)return!1;var a=e._valueTracker;if(!a)return!0;var f=a.getValue(),h="";return e&&(h=Nu(e)?e.checked?"true":"false":e.value),e=h,e!==f?(a.setValue(e),!0):!1}function vo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var _d=/[\n"\\]/g;function Wi(e){return e.replace(_d,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function yo(e,a,f,h,b,w,q,$){e.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?e.type=q:e.removeAttribute("type"),a!=null?q==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+Gi(a)):e.value!==""+Gi(a)&&(e.value=""+Gi(a)):q!=="submit"&&q!=="reset"||e.removeAttribute("value"),a!=null?Ef(e,q,Gi(a)):f!=null?Ef(e,q,Gi(f)):h!=null&&e.removeAttribute("value"),b==null&&w!=null&&(e.defaultChecked=!!w),b!=null&&(e.checked=b&&typeof b!="function"&&typeof b!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?e.name=""+Gi($):e.removeAttribute("name")}function _f(e,a,f,h,b,w,q,$){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.type=w),a!=null||f!=null){if(!(w!=="submit"&&w!=="reset"||a!=null)){Mu(e);return}f=f!=null?""+Gi(f):"",a=a!=null?""+Gi(a):f,$||a===e.value||(e.value=a),e.defaultValue=a}h=h??b,h=typeof h!="function"&&typeof h!="symbol"&&!!h,e.checked=$?e.checked:!!h,e.defaultChecked=!!h,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(e.name=q),Mu(e)}function Ef(e,a,f){a==="number"&&vo(e.ownerDocument)===e||e.defaultValue===""+f||(e.defaultValue=""+f)}function bs(e,a,f,h){if(e=e.options,a){a={};for(var b=0;b<f.length;b++)a["$"+f[b]]=!0;for(f=0;f<e.length;f++)b=a.hasOwnProperty("$"+e[f].value),e[f].selected!==b&&(e[f].selected=b),b&&h&&(e[f].defaultSelected=!0)}else{for(f=""+Gi(f),a=null,b=0;b<e.length;b++){if(e[b].value===f){e[b].selected=!0,h&&(e[b].defaultSelected=!0);return}a!==null||e[b].disabled||(a=e[b])}a!==null&&(a.selected=!0)}}function Cf(e,a,f){if(a!=null&&(a=""+Gi(a),a!==e.value&&(e.value=a),f==null)){e.defaultValue!==a&&(e.defaultValue=a);return}e.defaultValue=f!=null?""+Gi(f):""}function Tf(e,a,f,h){if(a==null){if(h!=null){if(f!=null)throw Error(i(92));if(V(h)){if(1<h.length)throw Error(i(93));h=h[0]}f=h}f==null&&(f=""),a=f}f=Gi(a),e.defaultValue=f,h=e.textContent,h===f&&h!==""&&h!==null&&(e.value=h),Mu(e)}function qr(e,a){if(a){var f=e.firstChild;if(f&&f===e.lastChild&&f.nodeType===3){f.nodeValue=a;return}}e.textContent=a}var Ed=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Af(e,a,f){var h=a.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?h?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="":h?e.setProperty(a,f):typeof f!="number"||f===0||Ed.has(a)?a==="float"?e.cssFloat=f:e[a]=(""+f).trim():e[a]=f+"px"}function wf(e,a,f){if(a!=null&&typeof a!="object")throw Error(i(62));if(e=e.style,f!=null){for(var h in f)!f.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?e.setProperty(h,""):h==="float"?e.cssFloat="":e[h]="");for(var b in a)h=a[b],a.hasOwnProperty(b)&&f[b]!==h&&Af(e,b,h)}else for(var w in a)a.hasOwnProperty(w)&&Af(e,w,a[w])}function Du(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ug=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function So(e){return Ug.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Hi(){}var Sl=null;function ju(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var dr=null,Ga=null;function Of(e){var a=kr(e);if(a&&(e=a.stateNode)){var f=e[We]||null;t:switch(e=a.stateNode,a.type){case"input":if(yo(e,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),a=f.name,f.type==="radio"&&a!=null){for(f=e;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Wi(""+a)+'"][type="radio"]'),a=0;a<f.length;a++){var h=f[a];if(h!==e&&h.form===e.form){var b=h[We]||null;if(!b)throw Error(i(90));yo(h,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(a=0;a<f.length;a++)h=f[a],h.form===e.form&&bf(h)}break t;case"textarea":Cf(e,f.value,f.defaultValue);break t;case"select":a=f.value,a!=null&&bs(e,!!f.multiple,a,!1)}}}var Uu=!1;function Rf(e,a,f){if(Uu)return e(a,f);Uu=!0;try{var h=e(a);return h}finally{if(Uu=!1,(dr!==null||Ga!==null)&&(Kl(),dr&&(a=dr,e=Ga,Ga=dr=null,Of(a),e)))for(a=0;a<e.length;a++)Of(e[a])}}function bl(e,a){var f=e.stateNode;if(f===null)return null;var h=f[We]||null;if(h===null)return null;f=h[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break t;default:e=!1}if(e)return null;if(f&&typeof f!="function")throw Error(i(231,a,typeof f));return f}var Ha=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bu=!1;if(Ha)try{var _s={};Object.defineProperty(_s,"passive",{get:function(){Bu=!0}}),window.addEventListener("test",_s,_s),window.removeEventListener("test",_s,_s)}catch{Bu=!1}var gr=null,zu=null,_l=null;function xf(){if(_l)return _l;var e,a=zu,f=a.length,h,b="value"in gr?gr.value:gr.textContent,w=b.length;for(e=0;e<f&&a[e]===b[e];e++);var q=f-e;for(h=1;h<=q&&a[f-h]===b[w-h];h++);return _l=b.slice(e,1<h?1-h:void 0)}function bo(e){var a=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&a===13&&(e=13)):e=a,e===10&&(e=13),32<=e||e===13?e:0}function _o(){return!0}function Lu(){return!1}function wi(e){function a(f,h,b,w,q){this._reactName=f,this._targetInst=b,this.type=h,this.nativeEvent=w,this.target=q,this.currentTarget=null;for(var $ in e)e.hasOwnProperty($)&&(f=e[$],this[$]=f?f(w):w[$]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?_o:Lu,this.isPropagationStopped=Lu,this}return C(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=_o)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=_o)},persist:function(){},isPersistent:_o}),a}var Vr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gu=wi(Vr),Eo=C({},Vr,{view:0,detail:0}),Td=wi(Eo),Es,Co,Yr,To=C({},Eo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:El,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yr&&(Yr&&e.type==="mousemove"?(Es=e.screenX-Yr.screenX,Co=e.screenY-Yr.screenY):Co=Es=0,Yr=e),Es)},movementY:function(e){return"movementY"in e?e.movementY:Co}}),Nf=wi(To),Hu=C({},To,{dataTransfer:0}),Ao=wi(Hu),Pu=C({},Eo,{relatedTarget:0}),Iu=wi(Pu),Ad=C({},Vr,{animationName:0,elapsedTime:0,pseudoElement:0}),Kr=wi(Ad),wd=C({},Vr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Qr=wi(wd),pr=C({},Vr,{data:0}),wo=wi(pr),Mf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Od={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cs(e){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(e):(e=Rd[e])?!!a[e]:!1}function El(){return Cs}var xd=C({},Eo,{key:function(e){if(e.key){var a=Mf[e.key]||e.key;if(a!=="Unidentified")return a}return e.type==="keypress"?(e=bo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Od[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:El,charCode:function(e){return e.type==="keypress"?bo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Df=wi(xd),Nd=C({},To,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jf=wi(Nd),Bg=C({},Eo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:El}),li=wi(Bg),Md=C({},Vr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dd=wi(Md),jd=C({},To,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ud=wi(jd),Bd=C({},Vr,{newState:0,oldState:0}),ku=wi(Bd),Uf=[9,13,27,32],qu=Ha&&"CompositionEvent"in window,Cl=null;Ha&&"documentMode"in document&&(Cl=document.documentMode);var zd=Ha&&"TextEvent"in window&&!Cl,Vu=Ha&&(!qu||Cl&&8<Cl&&11>=Cl),Yu=" ",Bf=!1;function Ku(e,a){switch(e){case"keyup":return Uf.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oo(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xr=!1;function Ld(e,a){switch(e){case"compositionend":return Oo(a);case"keypress":return a.which!==32?null:(Bf=!0,Yu);case"textInput":return e=a.data,e===Yu&&Bf?null:e;default:return null}}function zf(e,a){if(Xr)return e==="compositionend"||!qu&&Ku(e,a)?(e=xf(),_l=zu=gr=null,Xr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Vu&&a.locale!=="ko"?null:a.data;default:return null}}var Gd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pa(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a==="input"?!!Gd[e.type]:a==="textarea"}function Qu(e,a,f,h){dr?Ga?Ga.push(h):Ga=[h]:dr=h,a=x0(a,"onChange"),0<a.length&&(f=new Gu("onChange","change",null,f,h),e.push({event:f,listeners:a}))}var Ro=null,Tl=null;function $i(e){_v(e,0)}function xo(e){var a=ml(e);if(bf(a))return e}function Xu(e,a){if(e==="change")return a}var Lf=!1;if(Ha){var Fu;if(Ha){var No="oninput"in document;if(!No){var Ju=document.createElement("div");Ju.setAttribute("oninput","return;"),No=typeof Ju.oninput=="function"}Fu=No}else Fu=!1;Lf=Fu&&(!document.documentMode||9<document.documentMode)}function Gf(){Ro&&(Ro.detachEvent("onpropertychange",Mo),Tl=Ro=null)}function Mo(e){if(e.propertyName==="value"&&xo(Tl)){var a=[];Qu(a,Tl,e,ju(e)),Rf($i,a)}}function Do(e,a,f){e==="focusin"?(Gf(),Ro=a,Tl=f,Ro.attachEvent("onpropertychange",Mo)):e==="focusout"&&Gf()}function Dn(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xo(Tl)}function zg(e,a){if(e==="click")return xo(a)}function Lg(e,a){if(e==="input"||e==="change")return xo(a)}function Hd(e,a){return e===a&&(e!==0||1/e===1/a)||e!==e&&a!==a}var oi=typeof Object.is=="function"?Object.is:Hd;function da(e,a){if(oi(e,a))return!0;if(typeof e!="object"||e===null||typeof a!="object"||a===null)return!1;var f=Object.keys(e),h=Object.keys(a);if(f.length!==h.length)return!1;for(h=0;h<f.length;h++){var b=f[h];if(!Xt.call(a,b)||!oi(e[b],a[b]))return!1}return!0}function Hf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pf(e,a){var f=Hf(e);e=0;for(var h;f;){if(f.nodeType===3){if(h=e+f.textContent.length,e<=a&&h>=a)return{node:f,offset:a-e};e=h}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=Hf(f)}}function Al(e,a){return e&&a?e===a?!0:e&&e.nodeType===3?!1:a&&a.nodeType===3?Al(e,a.parentNode):"contains"in e?e.contains(a):e.compareDocumentPosition?!!(e.compareDocumentPosition(a)&16):!1:!1}function _a(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var a=vo(e.document);a instanceof e.HTMLIFrameElement;){try{var f=typeof a.contentWindow.location.href=="string"}catch{f=!1}if(f)e=a.contentWindow;else break;a=vo(e.document)}return a}function Zu(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a&&(a==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||a==="textarea"||e.contentEditable==="true")}var If=Ha&&"documentMode"in document&&11>=document.documentMode,Ts=null,jo=null,As=null,wl=!1;function kf(e,a,f){var h=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;wl||Ts==null||Ts!==vo(h)||(h=Ts,"selectionStart"in h&&Zu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),As&&da(As,h)||(As=h,h=x0(jo,"onSelect"),0<h.length&&(a=new Gu("onSelect","select",null,a,f),e.push({event:a,listeners:h}),a.target=Ts)))}function Fr(e,a){var f={};return f[e.toLowerCase()]=a.toLowerCase(),f["Webkit"+e]="webkit"+a,f["Moz"+e]="moz"+a,f}var Ol={animationend:Fr("Animation","AnimationEnd"),animationiteration:Fr("Animation","AnimationIteration"),animationstart:Fr("Animation","AnimationStart"),transitionrun:Fr("Transition","TransitionRun"),transitionstart:Fr("Transition","TransitionStart"),transitioncancel:Fr("Transition","TransitionCancel"),transitionend:Fr("Transition","TransitionEnd")},Wu={},qf={};Ha&&(qf=document.createElement("div").style,"AnimationEvent"in window||(delete Ol.animationend.animation,delete Ol.animationiteration.animation,delete Ol.animationstart.animation),"TransitionEvent"in window||delete Ol.transitionend.transition);function ui(e){if(Wu[e])return Wu[e];if(!Ol[e])return e;var a=Ol[e],f;for(f in a)if(a.hasOwnProperty(f)&&f in qf)return Wu[e]=a[f];return e}var $u=ui("animationend"),Vf=ui("animationiteration"),Pd=ui("animationstart"),Yf=ui("transitionrun"),Oi=ui("transitionstart"),Id=ui("transitioncancel"),Ri=ui("transitionend"),Kf=new Map,Ia="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ia.push("scrollEnd");function ci(e,a){Kf.set(e,a),hr(a,[e])}var Ea=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Pi=[],Jr=0,ga=0;function Uo(){for(var e=Jr,a=ga=Jr=0;a<e;){var f=Pi[a];Pi[a++]=null;var h=Pi[a];Pi[a++]=null;var b=Pi[a];Pi[a++]=null;var w=Pi[a];if(Pi[a++]=null,h!==null&&b!==null){var q=h.pending;q===null?b.next=b:(b.next=q.next,q.next=b),h.pending=b}w!==0&&Qf(f,b,w)}}function mr(e,a,f,h){Pi[Jr++]=e,Pi[Jr++]=a,Pi[Jr++]=f,Pi[Jr++]=h,ga|=h,e.lanes|=h,e=e.alternate,e!==null&&(e.lanes|=h)}function ws(e,a,f,h){return mr(e,a,f,h),Bo(e)}function ta(e,a){return mr(e,null,null,a),Bo(e)}function Qf(e,a,f){e.lanes|=f;var h=e.alternate;h!==null&&(h.lanes|=f);for(var b=!1,w=e.return;w!==null;)w.childLanes|=f,h=w.alternate,h!==null&&(h.childLanes|=f),w.tag===22&&(e=w.stateNode,e===null||e._visibility&1||(b=!0)),e=w,w=w.return;return e.tag===3?(w=e.stateNode,b&&a!==null&&(b=31-be(f),e=w.hiddenUpdates,h=e[b],h===null?e[b]=[a]:h.push(a),a.lane=f|536870912),w):null}function Bo(e){if(50<rl)throw rl=0,sl=null,Error(i(185));for(var a=e.return;a!==null;)e=a,a=e.return;return e.tag===3?e.stateNode:null}var ka={};function kd(e,a,f,h){this.tag=e,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bi(e,a,f,h){return new kd(e,a,f,h)}function tc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ca(e,a){var f=e.alternate;return f===null?(f=bi(e.tag,a,e.key,e.mode),f.elementType=e.elementType,f.type=e.type,f.stateNode=e.stateNode,f.alternate=e,e.alternate=f):(f.pendingProps=a,f.type=e.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=e.flags&65011712,f.childLanes=e.childLanes,f.lanes=e.lanes,f.child=e.child,f.memoizedProps=e.memoizedProps,f.memoizedState=e.memoizedState,f.updateQueue=e.updateQueue,a=e.dependencies,f.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},f.sibling=e.sibling,f.index=e.index,f.ref=e.ref,f.refCleanup=e.refCleanup,f}function ec(e,a){e.flags&=65011714;var f=e.alternate;return f===null?(e.childLanes=0,e.lanes=a,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=f.childLanes,e.lanes=f.lanes,e.child=f.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=f.memoizedProps,e.memoizedState=f.memoizedState,e.updateQueue=f.updateQueue,e.type=f.type,a=f.dependencies,e.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),e}function Rl(e,a,f,h,b,w){var q=0;if(h=e,typeof e=="function")tc(e)&&(q=1);else if(typeof e=="string")q=Qb(e,f,Y.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case B:return e=bi(31,f,a,b),e.elementType=B,e.lanes=w,e;case D:return Zr(f.children,b,w,a);case L:q=8,b|=24;break;case z:return e=bi(12,f,a,b|2),e.elementType=z,e.lanes=w,e;case R:return e=bi(13,f,a,b),e.elementType=R,e.lanes=w,e;case A:return e=bi(19,f,a,b),e.elementType=A,e.lanes=w,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case N:q=10;break t;case M:q=9;break t;case G:q=11;break t;case T:q=14;break t;case y:q=16,h=null;break t}q=29,f=Error(i(130,e===null?"null":typeof e,"")),h=null}return a=bi(q,f,a,b),a.elementType=e,a.type=h,a.lanes=w,a}function Zr(e,a,f,h){return e=bi(7,e,h,a),e.lanes=f,e}function zo(e,a,f){return e=bi(6,e,null,a),e.lanes=f,e}function Ii(e){var a=bi(18,null,null,0);return a.stateNode=e,a}function nc(e,a,f){return a=bi(4,e.children!==null?e.children:[],e.key,a),a.lanes=f,a.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},a}var ki=new WeakMap;function ea(e,a){if(typeof e=="object"&&e!==null){var f=ki.get(e);return f!==void 0?f:(a={value:e,source:a,stack:xt(a)},ki.set(e,a),a)}return{value:e,source:a,stack:xt(a)}}var Os=[],xl=0,Ta=null,Nl=0,qi=[],fi=0,vr=null,Aa=1,wa="";function qa(e,a){Os[xl++]=Nl,Os[xl++]=Ta,Ta=e,Nl=a}function ic(e,a,f){qi[fi++]=Aa,qi[fi++]=wa,qi[fi++]=vr,vr=e;var h=Aa;e=wa;var b=32-be(h)-1;h&=~(1<<b),f+=1;var w=32-be(a)+b;if(30<w){var q=b-b%5;w=(h&(1<<q)-1).toString(32),h>>=q,b-=q,Aa=1<<32-be(a)+b|f<<b|h,wa=w+e}else Aa=1<<w|f<<b|h,wa=e}function Lo(e){e.return!==null&&(qa(e,1),ic(e,1,0))}function Xf(e){for(;e===Ta;)Ta=Os[--xl],Os[xl]=null,Nl=Os[--xl],Os[xl]=null;for(;e===vr;)vr=qi[--fi],qi[fi]=null,wa=qi[--fi],qi[fi]=null,Aa=qi[--fi],qi[fi]=null}function qd(e,a){qi[fi++]=Aa,qi[fi++]=wa,qi[fi++]=vr,Aa=a.id,wa=a.overflow,vr=e}var hi=null,gn=null,Le=!1,na=null,xi=!1,ac=Error(i(519));function yr(e){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ml(ea(a,e)),ac}function Ff(e){var a=e.stateNode,f=e.type,h=e.memoizedProps;switch(a[xe]=e,a[We]=h,f){case"dialog":qe("cancel",a),qe("close",a);break;case"iframe":case"object":case"embed":qe("load",a);break;case"video":case"audio":for(f=0;f<Uh.length;f++)qe(Uh[f],a);break;case"source":qe("error",a);break;case"img":case"image":case"link":qe("error",a),qe("load",a);break;case"details":qe("toggle",a);break;case"input":qe("invalid",a),_f(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":qe("invalid",a);break;case"textarea":qe("invalid",a),Tf(a,h.value,h.defaultValue,h.children)}f=h.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||a.textContent===""+f||h.suppressHydrationWarning===!0||Av(a.textContent,f)?(h.popover!=null&&(qe("beforetoggle",a),qe("toggle",a)),h.onScroll!=null&&qe("scroll",a),h.onScrollEnd!=null&&qe("scrollend",a),h.onClick!=null&&(a.onclick=Hi),a=!0):a=!1,a||yr(e,!0)}function Jf(e){for(hi=e.return;hi;)switch(hi.tag){case 5:case 31:case 13:xi=!1;return;case 27:case 3:xi=!0;return;default:hi=hi.return}}function Rs(e){if(e!==hi)return!1;if(!Le)return Jf(e),Le=!0,!1;var a=e.tag,f;if((f=a!==3&&a!==27)&&((f=a===5)&&(f=e.type,f=!(f!=="form"&&f!=="button")||ep(e.type,e.memoizedProps)),f=!f),f&&gn&&yr(e),Jf(e),a===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));gn=Uv(e)}else if(a===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));gn=Uv(e)}else a===27?(a=gn,Fl(e.type)?(e=sp,sp=null,gn=e):gn=a):gn=hi?lr(e.stateNode.nextSibling):null;return!0}function Wr(){gn=hi=null,Le=!1}function xs(){var e=na;return e!==null&&(vn===null?vn=e:vn.push.apply(vn,e),na=null),e}function Ml(e){na===null?na=[e]:na.push(e)}var rc=Z(null),ke=null,Oa=null;function $r(e,a,f){it(rc,a._currentValue),a._currentValue=f}function Va(e){e._currentValue=rc.current,rt(rc)}function Zf(e,a,f){for(;e!==null;){var h=e.alternate;if((e.childLanes&a)!==a?(e.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),e===f)break;e=e.return}}function Wf(e,a,f,h){var b=e.child;for(b!==null&&(b.return=e);b!==null;){var w=b.dependencies;if(w!==null){var q=b.child;w=w.firstContext;t:for(;w!==null;){var $=w;w=b;for(var ot=0;ot<a.length;ot++)if($.context===a[ot]){w.lanes|=f,$=w.alternate,$!==null&&($.lanes|=f),Zf(w.return,f,e),h||(q=null);break t}w=$.next}}else if(b.tag===18){if(q=b.return,q===null)throw Error(i(341));q.lanes|=f,w=q.alternate,w!==null&&(w.lanes|=f),Zf(q,f,e),q=null}else q=b.child;if(q!==null)q.return=b;else for(q=b;q!==null;){if(q===e){q=null;break}if(b=q.sibling,b!==null){b.return=q.return,q=b;break}q=q.return}b=q}}function Dl(e,a,f,h){e=null;for(var b=a,w=!1;b!==null;){if(!w){if((b.flags&524288)!==0)w=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var q=b.alternate;if(q===null)throw Error(i(387));if(q=q.memoizedProps,q!==null){var $=b.type;oi(b.pendingProps.value,q.value)||(e!==null?e.push($):e=[$])}}else if(b===et.current){if(q=b.alternate,q===null)throw Error(i(387));q.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(e!==null?e.push(Hh):e=[Hh])}b=b.return}e!==null&&Wf(a,e,f,h),a.flags|=262144}function sc(e){for(e=e.firstContext;e!==null;){if(!oi(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Sr(e){ke=e,Oa=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function bn(e){return Ho(ke,e)}function Go(e,a){return ke===null&&Sr(e),Ho(e,a)}function Ho(e,a){var f=a._currentValue;if(a={context:a,memoizedValue:f,next:null},Oa===null){if(e===null)throw Error(i(308));Oa=a,e.dependencies={lanes:0,firstContext:a},e.flags|=524288}else Oa=Oa.next=a;return f}var Ns=typeof AbortController<"u"?AbortController:function(){var e=[],a=this.signal={aborted:!1,addEventListener:function(f,h){e.push(h)}};this.abort=function(){a.aborted=!0,e.forEach(function(f){return f()})}},$f=o.unstable_scheduleCallback,th=o.unstable_NormalPriority,Kn={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lc(){return{controller:new Ns,data:new Map,refCount:0}}function jl(e){e.refCount--,e.refCount===0&&$f(th,function(){e.controller.abort()})}var Ul=null,oc=0,Ms=0,ts=null;function Be(e,a){if(Ul===null){var f=Ul=[];oc=0,Ms=Kg(),ts={status:"pending",value:void 0,then:function(h){f.push(h)}}}return oc++,a.then(Vd,Vd),a}function Vd(){if(--oc===0&&Ul!==null){ts!==null&&(ts.status="fulfilled");var e=Ul;Ul=null,Ms=0,ts=null;for(var a=0;a<e.length;a++)(0,e[a])()}}function ia(e,a){var f=[],h={status:"pending",value:null,reason:null,then:function(b){f.push(b)}};return e.then(function(){h.status="fulfilled",h.value=a;for(var b=0;b<f.length;b++)(0,f[b])(a)},function(b){for(h.status="rejected",h.reason=b,b=0;b<f.length;b++)(0,f[b])(void 0)}),h}var uc=U.S;U.S=function(e,a){zc=Me(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Be(e,a),uc!==null&&uc(e,a)};var Ds=Z(null);function Bl(){var e=Ds.current;return e!==null?e:Ne.pooledCache}function br(e,a){a===null?it(Ds,Ds.current):it(Ds,a.pool)}function js(){var e=Bl();return e===null?null:{parent:Kn._currentValue,pool:e}}var Us=Error(i(460)),Po=Error(i(474)),cc=Error(i(542)),Io={then:function(){}};function _r(e){return e=e.status,e==="fulfilled"||e==="rejected"}function fc(e,a,f){switch(f=e[f],f===void 0?e.push(a):f!==a&&(a.then(Hi,Hi),a=f),a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,Tr(e),e;default:if(typeof a.status=="string")a.then(Hi,Hi);else{if(e=Ne,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=a,e.status="pending",e.then(function(h){if(a.status==="pending"){var b=a;b.status="fulfilled",b.value=h}},function(h){if(a.status==="pending"){var b=a;b.status="rejected",b.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,Tr(e),e}throw Cr=a,Us}}function Er(e){try{var a=e._init;return a(e._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Cr=f,Us):f}}var Cr=null;function hc(){if(Cr===null)throw Error(i(459));var e=Cr;return Cr=null,e}function Tr(e){if(e===Us||e===cc)throw Error(i(483))}var es=null,ko=0;function qo(e){var a=ko;return ko+=1,es===null&&(es=[]),fc(es,e,a)}function Vo(e,a){a=a.props.ref,e.ref=a!==void 0?a:null}function Bs(e,a){throw a.$$typeof===E?Error(i(525)):(e=Object.prototype.toString.call(a),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":e)))}function ce(e){function a(mt,dt){if(e){var yt=mt.deletions;yt===null?(mt.deletions=[dt],mt.flags|=16):yt.push(dt)}}function f(mt,dt){if(!e)return null;for(;dt!==null;)a(mt,dt),dt=dt.sibling;return null}function h(mt){for(var dt=new Map;mt!==null;)mt.key!==null?dt.set(mt.key,mt):dt.set(mt.index,mt),mt=mt.sibling;return dt}function b(mt,dt){return mt=Ca(mt,dt),mt.index=0,mt.sibling=null,mt}function w(mt,dt,yt){return mt.index=yt,e?(yt=mt.alternate,yt!==null?(yt=yt.index,yt<dt?(mt.flags|=67108866,dt):yt):(mt.flags|=67108866,dt)):(mt.flags|=1048576,dt)}function q(mt){return e&&mt.alternate===null&&(mt.flags|=67108866),mt}function $(mt,dt,yt,Nt){return dt===null||dt.tag!==6?(dt=zo(yt,mt.mode,Nt),dt.return=mt,dt):(dt=b(dt,yt),dt.return=mt,dt)}function ot(mt,dt,yt,Nt){var ue=yt.type;return ue===D?Rt(mt,dt,yt.props.children,Nt,yt.key):dt!==null&&(dt.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===y&&Er(ue)===dt.type)?(dt=b(dt,yt.props),Vo(dt,yt),dt.return=mt,dt):(dt=Rl(yt.type,yt.key,yt.props,null,mt.mode,Nt),Vo(dt,yt),dt.return=mt,dt)}function St(mt,dt,yt,Nt){return dt===null||dt.tag!==4||dt.stateNode.containerInfo!==yt.containerInfo||dt.stateNode.implementation!==yt.implementation?(dt=nc(yt,mt.mode,Nt),dt.return=mt,dt):(dt=b(dt,yt.children||[]),dt.return=mt,dt)}function Rt(mt,dt,yt,Nt,ue){return dt===null||dt.tag!==7?(dt=Zr(yt,mt.mode,Nt,ue),dt.return=mt,dt):(dt=b(dt,yt),dt.return=mt,dt)}function Mt(mt,dt,yt){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return dt=zo(""+dt,mt.mode,yt),dt.return=mt,dt;if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case O:return yt=Rl(dt.type,dt.key,dt.props,null,mt.mode,yt),Vo(yt,dt),yt.return=mt,yt;case v:return dt=nc(dt,mt.mode,yt),dt.return=mt,dt;case y:return dt=Er(dt),Mt(mt,dt,yt)}if(V(dt)||Q(dt))return dt=Zr(dt,mt.mode,yt,null),dt.return=mt,dt;if(typeof dt.then=="function")return Mt(mt,qo(dt),yt);if(dt.$$typeof===N)return Mt(mt,Go(mt,dt),yt);Bs(mt,dt)}return null}function Et(mt,dt,yt,Nt){var ue=dt!==null?dt.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return ue!==null?null:$(mt,dt,""+yt,Nt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case O:return yt.key===ue?ot(mt,dt,yt,Nt):null;case v:return yt.key===ue?St(mt,dt,yt,Nt):null;case y:return yt=Er(yt),Et(mt,dt,yt,Nt)}if(V(yt)||Q(yt))return ue!==null?null:Rt(mt,dt,yt,Nt,null);if(typeof yt.then=="function")return Et(mt,dt,qo(yt),Nt);if(yt.$$typeof===N)return Et(mt,dt,Go(mt,yt),Nt);Bs(mt,yt)}return null}function Tt(mt,dt,yt,Nt,ue){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return mt=mt.get(yt)||null,$(dt,mt,""+Nt,ue);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case O:return mt=mt.get(Nt.key===null?yt:Nt.key)||null,ot(dt,mt,Nt,ue);case v:return mt=mt.get(Nt.key===null?yt:Nt.key)||null,St(dt,mt,Nt,ue);case y:return Nt=Er(Nt),Tt(mt,dt,yt,Nt,ue)}if(V(Nt)||Q(Nt))return mt=mt.get(yt)||null,Rt(dt,mt,Nt,ue,null);if(typeof Nt.then=="function")return Tt(mt,dt,yt,qo(Nt),ue);if(Nt.$$typeof===N)return Tt(mt,dt,yt,Go(dt,Nt),ue);Bs(dt,Nt)}return null}function ne(mt,dt,yt,Nt){for(var ue=null,an=null,re=dt,je=dt=0,Ve=null;re!==null&&je<yt.length;je++){re.index>je?(Ve=re,re=null):Ve=re.sibling;var rn=Et(mt,re,yt[je],Nt);if(rn===null){re===null&&(re=Ve);break}e&&re&&rn.alternate===null&&a(mt,re),dt=w(rn,dt,je),an===null?ue=rn:an.sibling=rn,an=rn,re=Ve}if(je===yt.length)return f(mt,re),Le&&qa(mt,je),ue;if(re===null){for(;je<yt.length;je++)re=Mt(mt,yt[je],Nt),re!==null&&(dt=w(re,dt,je),an===null?ue=re:an.sibling=re,an=re);return Le&&qa(mt,je),ue}for(re=h(re);je<yt.length;je++)Ve=Tt(re,mt,je,yt[je],Nt),Ve!==null&&(e&&Ve.alternate!==null&&re.delete(Ve.key===null?je:Ve.key),dt=w(Ve,dt,je),an===null?ue=Ve:an.sibling=Ve,an=Ve);return e&&re.forEach(function(to){return a(mt,to)}),Le&&qa(mt,je),ue}function me(mt,dt,yt,Nt){if(yt==null)throw Error(i(151));for(var ue=null,an=null,re=dt,je=dt=0,Ve=null,rn=yt.next();re!==null&&!rn.done;je++,rn=yt.next()){re.index>je?(Ve=re,re=null):Ve=re.sibling;var to=Et(mt,re,rn.value,Nt);if(to===null){re===null&&(re=Ve);break}e&&re&&to.alternate===null&&a(mt,re),dt=w(to,dt,je),an===null?ue=to:an.sibling=to,an=to,re=Ve}if(rn.done)return f(mt,re),Le&&qa(mt,je),ue;if(re===null){for(;!rn.done;je++,rn=yt.next())rn=Mt(mt,rn.value,Nt),rn!==null&&(dt=w(rn,dt,je),an===null?ue=rn:an.sibling=rn,an=rn);return Le&&qa(mt,je),ue}for(re=h(re);!rn.done;je++,rn=yt.next())rn=Tt(re,mt,je,rn.value,Nt),rn!==null&&(e&&rn.alternate!==null&&re.delete(rn.key===null?je:rn.key),dt=w(rn,dt,je),an===null?ue=rn:an.sibling=rn,an=rn);return e&&re.forEach(function(a4){return a(mt,a4)}),Le&&qa(mt,je),ue}function Sn(mt,dt,yt,Nt){if(typeof yt=="object"&&yt!==null&&yt.type===D&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case O:t:{for(var ue=yt.key;dt!==null;){if(dt.key===ue){if(ue=yt.type,ue===D){if(dt.tag===7){f(mt,dt.sibling),Nt=b(dt,yt.props.children),Nt.return=mt,mt=Nt;break t}}else if(dt.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===y&&Er(ue)===dt.type){f(mt,dt.sibling),Nt=b(dt,yt.props),Vo(Nt,yt),Nt.return=mt,mt=Nt;break t}f(mt,dt);break}else a(mt,dt);dt=dt.sibling}yt.type===D?(Nt=Zr(yt.props.children,mt.mode,Nt,yt.key),Nt.return=mt,mt=Nt):(Nt=Rl(yt.type,yt.key,yt.props,null,mt.mode,Nt),Vo(Nt,yt),Nt.return=mt,mt=Nt)}return q(mt);case v:t:{for(ue=yt.key;dt!==null;){if(dt.key===ue)if(dt.tag===4&&dt.stateNode.containerInfo===yt.containerInfo&&dt.stateNode.implementation===yt.implementation){f(mt,dt.sibling),Nt=b(dt,yt.children||[]),Nt.return=mt,mt=Nt;break t}else{f(mt,dt);break}else a(mt,dt);dt=dt.sibling}Nt=nc(yt,mt.mode,Nt),Nt.return=mt,mt=Nt}return q(mt);case y:return yt=Er(yt),Sn(mt,dt,yt,Nt)}if(V(yt))return ne(mt,dt,yt,Nt);if(Q(yt)){if(ue=Q(yt),typeof ue!="function")throw Error(i(150));return yt=ue.call(yt),me(mt,dt,yt,Nt)}if(typeof yt.then=="function")return Sn(mt,dt,qo(yt),Nt);if(yt.$$typeof===N)return Sn(mt,dt,Go(mt,yt),Nt);Bs(mt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint"?(yt=""+yt,dt!==null&&dt.tag===6?(f(mt,dt.sibling),Nt=b(dt,yt),Nt.return=mt,mt=Nt):(f(mt,dt),Nt=zo(yt,mt.mode,Nt),Nt.return=mt,mt=Nt),q(mt)):f(mt,dt)}return function(mt,dt,yt,Nt){try{ko=0;var ue=Sn(mt,dt,yt,Nt);return es=null,ue}catch(re){if(re===Us||re===cc)throw re;var an=bi(29,re,null,mt.mode);return an.lanes=Nt,an.return=mt,an}finally{}}}var zs=ce(!0),Yd=ce(!1),Ar=!1;function Ls(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function eh(e,a){e=e.updateQueue,a.updateQueue===e&&(a.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ns(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function is(e,a,f){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,(he&2)!==0){var b=h.pending;return b===null?a.next=a:(a.next=b.next,b.next=a),h.pending=a,a=Bo(e),Qf(e,null,f),a}return mr(e,h,a,f),Bo(e)}function Yo(e,a,f){if(a=a.updateQueue,a!==null&&(a=a.shared,(f&4194048)!==0)){var h=a.lanes;h&=e.pendingLanes,f|=h,a.lanes=f,oe(e,f)}}function nh(e,a){var f=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,f===h)){var b=null,w=null;if(f=f.firstBaseUpdate,f!==null){do{var q={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};w===null?b=w=q:w=w.next=q,f=f.next}while(f!==null);w===null?b=w=a:w=w.next=a}else b=w=a;f={baseState:h.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},e.updateQueue=f;return}e=f.lastBaseUpdate,e===null?f.firstBaseUpdate=a:e.next=a,f.lastBaseUpdate=a}var Ko=!1;function zl(){if(Ko){var e=ts;if(e!==null)throw e}}function as(e,a,f,h){Ko=!1;var b=e.updateQueue;Ar=!1;var w=b.firstBaseUpdate,q=b.lastBaseUpdate,$=b.shared.pending;if($!==null){b.shared.pending=null;var ot=$,St=ot.next;ot.next=null,q===null?w=St:q.next=St,q=ot;var Rt=e.alternate;Rt!==null&&(Rt=Rt.updateQueue,$=Rt.lastBaseUpdate,$!==q&&($===null?Rt.firstBaseUpdate=St:$.next=St,Rt.lastBaseUpdate=ot))}if(w!==null){var Mt=b.baseState;q=0,Rt=St=ot=null,$=w;do{var Et=$.lane&-536870913,Tt=Et!==$.lane;if(Tt?(Oe&Et)===Et:(h&Et)===Et){Et!==0&&Et===Ms&&(Ko=!0),Rt!==null&&(Rt=Rt.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});t:{var ne=e,me=$;Et=a;var Sn=f;switch(me.tag){case 1:if(ne=me.payload,typeof ne=="function"){Mt=ne.call(Sn,Mt,Et);break t}Mt=ne;break t;case 3:ne.flags=ne.flags&-65537|128;case 0:if(ne=me.payload,Et=typeof ne=="function"?ne.call(Sn,Mt,Et):ne,Et==null)break t;Mt=C({},Mt,Et);break t;case 2:Ar=!0}}Et=$.callback,Et!==null&&(e.flags|=64,Tt&&(e.flags|=8192),Tt=b.callbacks,Tt===null?b.callbacks=[Et]:Tt.push(Et))}else Tt={lane:Et,tag:$.tag,payload:$.payload,callback:$.callback,next:null},Rt===null?(St=Rt=Tt,ot=Mt):Rt=Rt.next=Tt,q|=Et;if($=$.next,$===null){if($=b.shared.pending,$===null)break;Tt=$,$=Tt.next,Tt.next=null,b.lastBaseUpdate=Tt,b.shared.pending=null}}while(!0);Rt===null&&(ot=Mt),b.baseState=ot,b.firstBaseUpdate=St,b.lastBaseUpdate=Rt,w===null&&(b.shared.lanes=0),hs|=q,e.lanes=q,e.memoizedState=Mt}}function ih(e,a){if(typeof e!="function")throw Error(i(191,e));e.call(a)}function Kd(e,a){var f=e.callbacks;if(f!==null)for(e.callbacks=null,e=0;e<f.length;e++)ih(f[e],a)}var Ll=Z(null),Ya=Z(0);function Ka(e,a){e=ya,it(Ya,e),it(Ll,a),ya=e|a.baseLanes}function ei(){it(Ya,ya),it(Ll,Ll.current)}function Qa(){ya=Ya.current,rt(Ll),rt(Ya)}var An=Z(null),pa=null;function rs(e){var a=e.alternate;it(Ln,Ln.current&1),it(An,e),pa===null&&(a===null||Ll.current!==null||a.memoizedState!==null)&&(pa=e)}function Qn(e){it(Ln,Ln.current),it(An,e),pa===null&&(pa=e)}function Xa(e){e.tag===22?(it(Ln,Ln.current),it(An,e),pa===null&&(pa=e)):ss()}function ss(){it(Ln,Ln.current),it(An,An.current)}function aa(e){rt(An),pa===e&&(pa=null),rt(Ln)}var Ln=Z(0);function dc(e){for(var a=e;a!==null;){if(a.tag===13){var f=a.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||ap(f)||rp(f)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Fa=0,Ee=null,ln=null,Xn=null,wr=!1,ma=!1,Gs=!1,gc=0,Qo=0,Ja=null,Gg=0;function zn(){throw Error(i(321))}function ah(e,a){if(a===null)return!1;for(var f=0;f<a.length&&f<e.length;f++)if(!oi(e[f],a[f]))return!1;return!0}function Hs(e,a,f,h,b,w){return Fa=w,Ee=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,U.H=e===null||e.memoizedState===null?Ps:Zo,Gs=!1,w=f(h,b),Gs=!1,ma&&(w=Xd(a,f,h,b)),Qd(e),w}function Qd(e){U.H=Hl;var a=ln!==null&&ln.next!==null;if(Fa=0,Xn=ln=Ee=null,wr=!1,Qo=0,Ja=null,a)throw Error(i(300));e===null||Fn||(e=e.dependencies,e!==null&&sc(e)&&(Fn=!0))}function Xd(e,a,f,h){Ee=e;var b=0;do{if(ma&&(Ja=null),Qo=0,ma=!1,25<=b)throw Error(i(301));if(b+=1,Xn=ln=null,e.updateQueue!=null){var w=e.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}U.H=Is,w=a(f,h)}while(ma);return w}function Hg(){var e=U.H,a=e.useState()[0];return a=typeof a.then=="function"?Xo(a):a,e=e.useState()[0],(ln!==null?ln.memoizedState:null)!==e&&(Ee.flags|=1024),a}function rh(){var e=gc!==0;return gc=0,e}function sh(e,a,f){a.updateQueue=e.updateQueue,a.flags&=-2053,e.lanes&=~f}function lh(e){if(wr){for(e=e.memoizedState;e!==null;){var a=e.queue;a!==null&&(a.pending=null),e=e.next}wr=!1}Fa=0,Xn=ln=Ee=null,ma=!1,Qo=gc=0,Ja=null}function Ni(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xn===null?Ee.memoizedState=Xn=e:Xn=Xn.next=e,Xn}function Gn(){if(ln===null){var e=Ee.alternate;e=e!==null?e.memoizedState:null}else e=ln.next;var a=Xn===null?Ee.memoizedState:Xn.next;if(a!==null)Xn=a,ln=e;else{if(e===null)throw Ee.alternate===null?Error(i(467)):Error(i(310));ln=e,e={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},Xn===null?Ee.memoizedState=Xn=e:Xn=Xn.next=e}return Xn}function pc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xo(e){var a=Qo;return Qo+=1,Ja===null&&(Ja=[]),e=fc(Ja,e,a),a=Ee,(Xn===null?a.memoizedState:Xn.next)===null&&(a=a.alternate,U.H=a===null||a.memoizedState===null?Ps:Zo),e}function mc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Xo(e);if(e.$$typeof===N)return bn(e)}throw Error(i(438,String(e)))}function oh(e){var a=null,f=Ee.updateQueue;if(f!==null&&(a=f.memoCache),a==null){var h=Ee.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(b){return b.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),f===null&&(f=pc(),Ee.updateQueue=f),f.memoCache=a,f=a.data[a.index],f===void 0)for(f=a.data[a.index]=Array(e),h=0;h<e;h++)f[h]=j;return a.index++,f}function Za(e,a){return typeof a=="function"?a(e):a}function vc(e){var a=Gn();return uh(a,ln,e)}function uh(e,a,f){var h=e.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=f;var b=e.baseQueue,w=h.pending;if(w!==null){if(b!==null){var q=b.next;b.next=w.next,w.next=q}a.baseQueue=b=w,h.pending=null}if(w=e.baseState,b===null)e.memoizedState=w;else{a=b.next;var $=q=null,ot=null,St=a,Rt=!1;do{var Mt=St.lane&-536870913;if(Mt!==St.lane?(Oe&Mt)===Mt:(Fa&Mt)===Mt){var Et=St.revertLane;if(Et===0)ot!==null&&(ot=ot.next={lane:0,revertLane:0,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),Mt===Ms&&(Rt=!0);else if((Fa&Et)===Et){St=St.next,Et===Ms&&(Rt=!0);continue}else Mt={lane:0,revertLane:St.revertLane,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ot===null?($=ot=Mt,q=w):ot=ot.next=Mt,Ee.lanes|=Et,hs|=Et;Mt=St.action,Gs&&f(w,Mt),w=St.hasEagerState?St.eagerState:f(w,Mt)}else Et={lane:Mt,revertLane:St.revertLane,gesture:St.gesture,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ot===null?($=ot=Et,q=w):ot=ot.next=Et,Ee.lanes|=Mt,hs|=Mt;St=St.next}while(St!==null&&St!==a);if(ot===null?q=w:ot.next=$,!oi(w,e.memoizedState)&&(Fn=!0,Rt&&(f=ts,f!==null)))throw f;e.memoizedState=w,e.baseState=q,e.baseQueue=ot,h.lastRenderedState=w}return b===null&&(h.lanes=0),[e.memoizedState,h.dispatch]}function ch(e){var a=Gn(),f=a.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=e;var h=f.dispatch,b=f.pending,w=a.memoizedState;if(b!==null){f.pending=null;var q=b=b.next;do w=e(w,q.action),q=q.next;while(q!==b);oi(w,a.memoizedState)||(Fn=!0),a.memoizedState=w,a.baseQueue===null&&(a.baseState=w),f.lastRenderedState=w}return[w,h]}function Fd(e,a,f){var h=Ee,b=Gn(),w=Le;if(w){if(f===void 0)throw Error(i(407));f=f()}else f=a();var q=!oi((ln||b).memoizedState,f);if(q&&(b.memoizedState=f,Fn=!0),b=b.queue,mh(fh.bind(null,h,b,e),[e]),b.getSnapshot!==a||q||Xn!==null&&Xn.memoizedState.tag&1){if(h.flags|=2048,Gl(9,{destroy:void 0},Zd.bind(null,h,b,f,a),null),Ne===null)throw Error(i(349));w||(Fa&127)!==0||Jd(h,a,f)}return f}function Jd(e,a,f){e.flags|=16384,e={getSnapshot:a,value:f},a=Ee.updateQueue,a===null?(a=pc(),Ee.updateQueue=a,a.stores=[e]):(f=a.stores,f===null?a.stores=[e]:f.push(e))}function Zd(e,a,f,h){a.value=f,a.getSnapshot=h,hh(a)&&Wd(e)}function fh(e,a,f){return f(function(){hh(a)&&Wd(e)})}function hh(e){var a=e.getSnapshot;e=e.value;try{var f=a();return!oi(e,f)}catch{return!0}}function Wd(e){var a=ta(e,2);a!==null&&nn(a,e,2)}function yc(e){var a=Ni();if(typeof e=="function"){var f=e;if(e=f(),Gs){Bt(!0);try{f()}finally{Bt(!1)}}}return a.memoizedState=a.baseState=e,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:e},a}function dh(e,a,f,h){return e.baseState=f,uh(e,ln,typeof h=="function"?h:Za)}function $d(e,a,f,h,b){if(Jo(e))throw Error(i(485));if(e=a.action,e!==null){var w={payload:b,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){w.listeners.push(q)}};U.T!==null?f(!0):w.isTransition=!1,h(w),f=a.pending,f===null?(w.next=a.pending=w,Sc(a,w)):(w.next=f.next,a.pending=f.next=w)}}function Sc(e,a){var f=a.action,h=a.payload,b=e.state;if(a.isTransition){var w=U.T,q={};U.T=q;try{var $=f(b,h),ot=U.S;ot!==null&&ot(q,$),bc(e,a,$)}catch(St){gh(e,a,St)}finally{w!==null&&q.types!==null&&(w.types=q.types),U.T=w}}else try{w=f(b,h),bc(e,a,w)}catch(St){gh(e,a,St)}}function bc(e,a,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(h){t0(e,a,h)},function(h){return gh(e,a,h)}):t0(e,a,f)}function t0(e,a,f){a.status="fulfilled",a.value=f,e0(a),e.state=f,a=e.pending,a!==null&&(f=a.next,f===a?e.pending=null:(f=f.next,a.next=f,Sc(e,f)))}function gh(e,a,f){var h=e.pending;if(e.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=f,e0(a),a=a.next;while(a!==h)}e.action=null}function e0(e){e=e.listeners;for(var a=0;a<e.length;a++)(0,e[a])()}function n0(e,a){return a}function ph(e,a){if(Le){var f=Ne.formState;if(f!==null){t:{var h=Ee;if(Le){if(gn){e:{for(var b=gn,w=xi;b.nodeType!==8;){if(!w){b=null;break e}if(b=lr(b.nextSibling),b===null){b=null;break e}}w=b.data,b=w==="F!"||w==="F"?b:null}if(b){gn=lr(b.nextSibling),h=b.data==="F!";break t}}yr(h)}h=!1}h&&(a=f[0])}}return f=Ni(),f.memoizedState=f.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n0,lastRenderedState:a},f.queue=h,f=bh.bind(null,Ee,h),h.dispatch=f,h=yc(!1),w=Hn.bind(null,Ee,!1,h.queue),h=Ni(),b={state:a,dispatch:null,action:e,pending:null},h.queue=b,f=$d.bind(null,Ee,b,w,f),b.dispatch=f,h.memoizedState=e,[a,f,!1]}function i0(e){var a=Gn();return a0(a,ln,e)}function a0(e,a,f){if(a=uh(e,a,n0)[0],e=vc(Za)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=Xo(a)}catch(q){throw q===Us?cc:q}else h=a;a=Gn();var b=a.queue,w=b.dispatch;return f!==a.memoizedState&&(Ee.flags|=2048,Gl(9,{destroy:void 0},Pg.bind(null,b,f),null)),[h,w,e]}function Pg(e,a){e.action=a}function r0(e){var a=Gn(),f=ln;if(f!==null)return a0(a,f,e);Gn(),a=a.memoizedState,f=Gn();var h=f.queue.dispatch;return f.memoizedState=e,[a,h,!1]}function Gl(e,a,f,h){return e={tag:e,create:f,deps:h,inst:a,next:null},a=Ee.updateQueue,a===null&&(a=pc(),Ee.updateQueue=a),f=a.lastEffect,f===null?a.lastEffect=e.next=e:(h=f.next,f.next=e,e.next=h,a.lastEffect=e),e}function s0(){return Gn().memoizedState}function _c(e,a,f,h){var b=Ni();Ee.flags|=e,b.memoizedState=Gl(1|a,{destroy:void 0},f,h===void 0?null:h)}function Ec(e,a,f,h){var b=Gn();h=h===void 0?null:h;var w=b.memoizedState.inst;ln!==null&&h!==null&&ah(h,ln.memoizedState.deps)?b.memoizedState=Gl(a,w,f,h):(Ee.flags|=e,b.memoizedState=Gl(1|a,w,f,h))}function l0(e,a){_c(8390656,8,e,a)}function mh(e,a){Ec(2048,8,e,a)}function Ig(e){Ee.flags|=4;var a=Ee.updateQueue;if(a===null)a=pc(),Ee.updateQueue=a,a.events=[e];else{var f=a.events;f===null?a.events=[e]:f.push(e)}}function o0(e){var a=Gn().memoizedState;return Ig({ref:a,nextImpl:e}),function(){if((he&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function u0(e,a){return Ec(4,2,e,a)}function c0(e,a){return Ec(4,4,e,a)}function f0(e,a){if(typeof a=="function"){e=e();var f=a(e);return function(){typeof f=="function"?f():a(null)}}if(a!=null)return e=e(),a.current=e,function(){a.current=null}}function h0(e,a,f){f=f!=null?f.concat([e]):null,Ec(4,4,f0.bind(null,a,e),f)}function Cc(){}function d0(e,a){var f=Gn();a=a===void 0?null:a;var h=f.memoizedState;return a!==null&&ah(a,h[1])?h[0]:(f.memoizedState=[e,a],e)}function g0(e,a){var f=Gn();a=a===void 0?null:a;var h=f.memoizedState;if(a!==null&&ah(a,h[1]))return h[0];if(h=e(),Gs){Bt(!0);try{e()}finally{Bt(!1)}}return f.memoizedState=[h,a],h}function ra(e,a,f){return f===void 0||(Fa&1073741824)!==0&&(Oe&261930)===0?e.memoizedState=a:(e.memoizedState=f,e=jr(),Ee.lanes|=e,hs|=e,f)}function vh(e,a,f,h){return oi(f,a)?f:Ll.current!==null?(e=ra(e,f,h),oi(e,a)||(Fn=!0),e):(Fa&42)===0||(Fa&1073741824)!==0&&(Oe&261930)===0?(Fn=!0,e.memoizedState=f):(e=jr(),Ee.lanes|=e,hs|=e,a)}function Tc(e,a,f,h,b){var w=I.p;I.p=w!==0&&8>w?w:8;var q=U.T,$={};U.T=$,Hn(e,!1,a,f);try{var ot=b(),St=U.S;if(St!==null&&St($,ot),ot!==null&&typeof ot=="object"&&typeof ot.then=="function"){var Rt=ia(ot,h);Fo(e,a,Rt,Ti(e))}else Fo(e,a,h,Ti(e))}catch(Mt){Fo(e,a,{then:function(){},status:"rejected",reason:Mt},Ti())}finally{I.p=w,q!==null&&$.types!==null&&(q.types=$.types),U.T=q}}function p0(){}function Ac(e,a,f,h){if(e.tag!==5)throw Error(i(476));var b=yh(e).queue;Tc(e,b,a,F,f===null?p0:function(){return m0(e),f(h)})}function yh(e){var a=e.memoizedState;if(a!==null)return a;a={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:F},next:null};var f={};return a.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:f},next:null},e.memoizedState=a,e=e.alternate,e!==null&&(e.memoizedState=a),a}function m0(e){var a=yh(e);a.next===null&&(a=e.alternate.memoizedState),Fo(e,a.next.queue,{},Ti())}function wc(){return bn(Hh)}function Sh(){return Gn().memoizedState}function v0(){return Gn().memoizedState}function kg(e){for(var a=e.return;a!==null;){switch(a.tag){case 24:case 3:var f=Ti();e=ns(f);var h=is(a,e,f);h!==null&&(nn(h,a,f),Yo(h,a,f)),a={cache:lc()},e.payload=a;return}a=a.return}}function qg(e,a,f){var h=Ti();f={lane:h,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Jo(e)?y0(a,f):(f=ws(e,a,f,h),f!==null&&(nn(f,e,h),_h(f,a,h)))}function bh(e,a,f){var h=Ti();Fo(e,a,f,h)}function Fo(e,a,f,h){var b={lane:h,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Jo(e))y0(a,b);else{var w=e.alternate;if(e.lanes===0&&(w===null||w.lanes===0)&&(w=a.lastRenderedReducer,w!==null))try{var q=a.lastRenderedState,$=w(q,f);if(b.hasEagerState=!0,b.eagerState=$,oi($,q))return mr(e,a,b,0),Ne===null&&Uo(),!1}catch{}finally{}if(f=ws(e,a,b,h),f!==null)return nn(f,e,h),_h(f,a,h),!0}return!1}function Hn(e,a,f,h){if(h={lane:2,revertLane:Kg(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Jo(e)){if(a)throw Error(i(479))}else a=ws(e,f,h,2),a!==null&&nn(a,e,2)}function Jo(e){var a=e.alternate;return e===Ee||a!==null&&a===Ee}function y0(e,a){ma=wr=!0;var f=e.pending;f===null?a.next=a:(a.next=f.next,f.next=a),e.pending=a}function _h(e,a,f){if((f&4194048)!==0){var h=a.lanes;h&=e.pendingLanes,f|=h,a.lanes=f,oe(e,f)}}var Hl={readContext:bn,use:mc,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useLayoutEffect:zn,useInsertionEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useSyncExternalStore:zn,useId:zn,useHostTransitionStatus:zn,useFormState:zn,useActionState:zn,useOptimistic:zn,useMemoCache:zn,useCacheRefresh:zn};Hl.useEffectEvent=zn;var Ps={readContext:bn,use:mc,useCallback:function(e,a){return Ni().memoizedState=[e,a===void 0?null:a],e},useContext:bn,useEffect:l0,useImperativeHandle:function(e,a,f){f=f!=null?f.concat([e]):null,_c(4194308,4,f0.bind(null,a,e),f)},useLayoutEffect:function(e,a){return _c(4194308,4,e,a)},useInsertionEffect:function(e,a){_c(4,2,e,a)},useMemo:function(e,a){var f=Ni();a=a===void 0?null:a;var h=e();if(Gs){Bt(!0);try{e()}finally{Bt(!1)}}return f.memoizedState=[h,a],h},useReducer:function(e,a,f){var h=Ni();if(f!==void 0){var b=f(a);if(Gs){Bt(!0);try{f(a)}finally{Bt(!1)}}}else b=a;return h.memoizedState=h.baseState=b,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:b},h.queue=e,e=e.dispatch=qg.bind(null,Ee,e),[h.memoizedState,e]},useRef:function(e){var a=Ni();return e={current:e},a.memoizedState=e},useState:function(e){e=yc(e);var a=e.queue,f=bh.bind(null,Ee,a);return a.dispatch=f,[e.memoizedState,f]},useDebugValue:Cc,useDeferredValue:function(e,a){var f=Ni();return ra(f,e,a)},useTransition:function(){var e=yc(!1);return e=Tc.bind(null,Ee,e.queue,!0,!1),Ni().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,a,f){var h=Ee,b=Ni();if(Le){if(f===void 0)throw Error(i(407));f=f()}else{if(f=a(),Ne===null)throw Error(i(349));(Oe&127)!==0||Jd(h,a,f)}b.memoizedState=f;var w={value:f,getSnapshot:a};return b.queue=w,l0(fh.bind(null,h,w,e),[e]),h.flags|=2048,Gl(9,{destroy:void 0},Zd.bind(null,h,w,f,a),null),f},useId:function(){var e=Ni(),a=Ne.identifierPrefix;if(Le){var f=wa,h=Aa;f=(h&~(1<<32-be(h)-1)).toString(32)+f,a="_"+a+"R_"+f,f=gc++,0<f&&(a+="H"+f.toString(32)),a+="_"}else f=Gg++,a="_"+a+"r_"+f.toString(32)+"_";return e.memoizedState=a},useHostTransitionStatus:wc,useFormState:ph,useActionState:ph,useOptimistic:function(e){var a=Ni();a.memoizedState=a.baseState=e;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=f,a=Hn.bind(null,Ee,!0,f),f.dispatch=a,[e,a]},useMemoCache:oh,useCacheRefresh:function(){return Ni().memoizedState=kg.bind(null,Ee)},useEffectEvent:function(e){var a=Ni(),f={impl:e};return a.memoizedState=f,function(){if((he&2)!==0)throw Error(i(440));return f.impl.apply(void 0,arguments)}}},Zo={readContext:bn,use:mc,useCallback:d0,useContext:bn,useEffect:mh,useImperativeHandle:h0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:g0,useReducer:vc,useRef:s0,useState:function(){return vc(Za)},useDebugValue:Cc,useDeferredValue:function(e,a){var f=Gn();return vh(f,ln.memoizedState,e,a)},useTransition:function(){var e=vc(Za)[0],a=Gn().memoizedState;return[typeof e=="boolean"?e:Xo(e),a]},useSyncExternalStore:Fd,useId:Sh,useHostTransitionStatus:wc,useFormState:i0,useActionState:i0,useOptimistic:function(e,a){var f=Gn();return dh(f,ln,e,a)},useMemoCache:oh,useCacheRefresh:v0};Zo.useEffectEvent=o0;var Is={readContext:bn,use:mc,useCallback:d0,useContext:bn,useEffect:mh,useImperativeHandle:h0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:g0,useReducer:ch,useRef:s0,useState:function(){return ch(Za)},useDebugValue:Cc,useDeferredValue:function(e,a){var f=Gn();return ln===null?ra(f,e,a):vh(f,ln.memoizedState,e,a)},useTransition:function(){var e=ch(Za)[0],a=Gn().memoizedState;return[typeof e=="boolean"?e:Xo(e),a]},useSyncExternalStore:Fd,useId:Sh,useHostTransitionStatus:wc,useFormState:r0,useActionState:r0,useOptimistic:function(e,a){var f=Gn();return ln!==null?dh(f,ln,e,a):(f.baseState=e,[e,f.queue.dispatch])},useMemoCache:oh,useCacheRefresh:v0};Is.useEffectEvent=o0;function ls(e,a,f,h){a=e.memoizedState,f=f(h,a),f=f==null?a:C({},a,f),e.memoizedState=f,e.lanes===0&&(e.updateQueue.baseState=f)}var Mi={enqueueSetState:function(e,a,f){e=e._reactInternals;var h=Ti(),b=ns(h);b.payload=a,f!=null&&(b.callback=f),a=is(e,b,h),a!==null&&(nn(a,e,h),Yo(a,e,h))},enqueueReplaceState:function(e,a,f){e=e._reactInternals;var h=Ti(),b=ns(h);b.tag=1,b.payload=a,f!=null&&(b.callback=f),a=is(e,b,h),a!==null&&(nn(a,e,h),Yo(a,e,h))},enqueueForceUpdate:function(e,a){e=e._reactInternals;var f=Ti(),h=ns(f);h.tag=2,a!=null&&(h.callback=a),a=is(e,h,f),a!==null&&(nn(a,e,f),Yo(a,e,f))}};function S0(e,a,f,h,b,w,q){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,w,q):a.prototype&&a.prototype.isPureReactComponent?!da(f,h)||!da(b,w):!0}function b0(e,a,f,h){e=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(f,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(f,h),a.state!==e&&Mi.enqueueReplaceState(a,a.state,null)}function Wa(e,a){var f=a;if("ref"in a){f={};for(var h in a)h!=="ref"&&(f[h]=a[h])}if(e=e.defaultProps){f===a&&(f=C({},f));for(var b in e)f[b]===void 0&&(f[b]=e[b])}return f}function Wo(e){Ea(e)}function $o(e){console.error(e)}function Oc(e){Ea(e)}function Rc(e,a){try{var f=e.onUncaughtError;f(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function _0(e,a,f){try{var h=e.onCaughtError;h(f.value,{componentStack:f.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function sa(e,a,f){return f=ns(f),f.tag=3,f.payload={element:null},f.callback=function(){Rc(e,a)},f}function Eh(e){return e=ns(e),e.tag=3,e}function E0(e,a,f,h){var b=f.type.getDerivedStateFromError;if(typeof b=="function"){var w=h.value;e.payload=function(){return b(w)},e.callback=function(){_0(a,f,h)}}var q=f.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(e.callback=function(){_0(a,f,h),typeof b!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this));var $=h.stack;this.componentDidCatch(h.value,{componentStack:$!==null?$:""})})}function Ch(e,a,f,h,b){if(f.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=f.alternate,a!==null&&Dl(a,f,b,!0),f=An.current,f!==null){switch(f.tag){case 31:case 13:return pa===null?S():f.alternate===null&&mn===0&&(mn=3),f.flags&=-257,f.flags|=65536,f.lanes=b,h===Io?f.flags|=16384:(a=f.updateQueue,a===null?f.updateQueue=new Set([h]):a.add(h),hn(e,h,b)),!1;case 22:return f.flags|=65536,h===Io?f.flags|=16384:(a=f.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},f.updateQueue=a):(f=a.retryQueue,f===null?a.retryQueue=new Set([h]):f.add(h)),hn(e,h,b)),!1}throw Error(i(435,f.tag))}return hn(e,h,b),S(),!1}if(Le)return a=An.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=b,h!==ac&&(e=Error(i(422),{cause:h}),Ml(ea(e,f)))):(h!==ac&&(a=Error(i(423),{cause:h}),Ml(ea(a,f))),e=e.current.alternate,e.flags|=65536,b&=-b,e.lanes|=b,h=ea(h,f),b=sa(e.stateNode,h,b),nh(e,b),mn!==4&&(mn=2)),!1;var w=Error(i(520),{cause:h});if(w=ea(w,f),Ye===null?Ye=[w]:Ye.push(w),mn!==4&&(mn=2),a===null)return!0;h=ea(h,f),f=a;do{switch(f.tag){case 3:return f.flags|=65536,e=b&-b,f.lanes|=e,e=sa(f.stateNode,h,e),nh(f,e),!1;case 1:if(a=f.type,w=f.stateNode,(f.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Bi===null||!Bi.has(w))))return f.flags|=65536,b&=-b,f.lanes|=b,b=Eh(b),E0(b,e,f,h),nh(f,b),!1}f=f.return}while(f!==null);return!1}var Th=Error(i(461)),Fn=!1;function di(e,a,f,h){a.child=e===null?Yd(a,null,f,h):zs(a,e.child,f,h)}function Pl(e,a,f,h,b){f=f.render;var w=a.ref;if("ref"in h){var q={};for(var $ in h)$!=="ref"&&(q[$]=h[$])}else q=h;return Sr(a),h=Hs(e,a,f,q,w,b),$=rh(),e!==null&&!Fn?(sh(e,a,b),Na(e,a,b)):(Le&&$&&Lo(a),a.flags|=1,di(e,a,h,b),a.child)}function Vi(e,a,f,h,b){if(e===null){var w=f.type;return typeof w=="function"&&!tc(w)&&w.defaultProps===void 0&&f.compare===null?(a.tag=15,a.type=w,xc(e,a,w,h,b)):(e=Rl(f.type,null,h,a,a.mode,b),e.ref=a.ref,e.return=a,a.child=e)}if(w=e.child,!Di(e,b)){var q=w.memoizedProps;if(f=f.compare,f=f!==null?f:da,f(q,h)&&e.ref===a.ref)return Na(e,a,b)}return a.flags|=1,e=Ca(w,h),e.ref=a.ref,e.return=a,a.child=e}function xc(e,a,f,h,b){if(e!==null){var w=e.memoizedProps;if(da(w,h)&&e.ref===a.ref)if(Fn=!1,a.pendingProps=h=w,Di(e,b))(e.flags&131072)!==0&&(Fn=!0);else return a.lanes=e.lanes,Na(e,a,b)}return Yi(e,a,f,h,b)}function Ah(e,a,f,h){var b=h.children,w=e!==null?e.memoizedState:null;if(e===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((a.flags&128)!==0){if(w=w!==null?w.baseLanes|f:f,e!==null){for(h=a.child=e.child,b=0;h!==null;)b=b|h.lanes|h.childLanes,h=h.sibling;h=b&~w}else h=0,a.child=null;return wh(e,a,w,f,h)}if((f&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},e!==null&&br(a,w!==null?w.cachePool:null),w!==null?Ka(a,w):ei(),Xa(a);else return h=a.lanes=536870912,wh(e,a,w!==null?w.baseLanes|f:f,f,h)}else w!==null?(br(a,w.cachePool),Ka(a,w),ss(),a.memoizedState=null):(e!==null&&br(a,null),ei(),ss());return di(e,a,b,f),a.child}function ks(e,a){return e!==null&&e.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function wh(e,a,f,h,b){var w=Bl();return w=w===null?null:{parent:Kn._currentValue,pool:w},a.memoizedState={baseLanes:f,cachePool:w},e!==null&&br(a,null),ei(),Xa(a),e!==null&&Dl(e,a,h,!0),a.childLanes=b,null}function Or(e,a){return a=ni({mode:a.mode,children:a.children},e.mode),a.ref=e.ref,e.child=a,a.return=e,a}function qs(e,a,f){return zs(a,e.child,null,f),e=Or(a,a.pendingProps),e.flags|=2,aa(a),a.memoizedState=null,e}function Nc(e,a,f){var h=a.pendingProps,b=(a.flags&128)!==0;if(a.flags&=-129,e===null){if(Le){if(h.mode==="hidden")return e=Or(a,h),a.lanes=536870912,ks(null,e);if(Qn(a),(e=gn)?(e=jv(e,xi),e=e!==null&&e.data==="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:vr!==null?{id:Aa,overflow:wa}:null,retryLane:536870912,hydrationErrors:null},f=Ii(e),f.return=a,a.child=f,hi=a,gn=null)):e=null,e===null)throw yr(a);return a.lanes=536870912,null}return Or(a,h)}var w=e.memoizedState;if(w!==null){var q=w.dehydrated;if(Qn(a),b)if(a.flags&256)a.flags&=-257,a=qs(e,a,f);else if(a.memoizedState!==null)a.child=e.child,a.flags|=128,a=null;else throw Error(i(558));else if(Fn||Dl(e,a,f,!1),b=(f&e.childLanes)!==0,Fn||b){if(h=Ne,h!==null&&(q=It(h,f),q!==0&&q!==w.retryLane))throw w.retryLane=q,ta(e,q),nn(h,e,q),Th;S(),a=qs(e,a,f)}else e=w.treeContext,gn=lr(q.nextSibling),hi=a,Le=!0,na=null,xi=!1,e!==null&&qd(a,e),a=Or(a,h),a.flags|=4096;return a}return e=Ca(e.child,{mode:h.mode,children:h.children}),e.ref=a.ref,a.child=e,e.return=a,e}function Vs(e,a){var f=a.ref;if(f===null)e!==null&&e.ref!==null&&(a.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(i(284));(e===null||e.ref!==f)&&(a.flags|=4194816)}}function Yi(e,a,f,h,b){return Sr(a),f=Hs(e,a,f,h,void 0,b),h=rh(),e!==null&&!Fn?(sh(e,a,b),Na(e,a,b)):(Le&&h&&Lo(a),a.flags|=1,di(e,a,f,b),a.child)}function la(e,a,f,h,b,w){return Sr(a),a.updateQueue=null,f=Xd(a,h,f,b),Qd(e),h=rh(),e!==null&&!Fn?(sh(e,a,w),Na(e,a,w)):(Le&&h&&Lo(a),a.flags|=1,di(e,a,f,w),a.child)}function os(e,a,f,h,b){if(Sr(a),a.stateNode===null){var w=ka,q=f.contextType;typeof q=="object"&&q!==null&&(w=bn(q)),w=new f(h,w),a.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Mi,a.stateNode=w,w._reactInternals=a,w=a.stateNode,w.props=h,w.state=a.memoizedState,w.refs={},Ls(a),q=f.contextType,w.context=typeof q=="object"&&q!==null?bn(q):ka,w.state=a.memoizedState,q=f.getDerivedStateFromProps,typeof q=="function"&&(ls(a,f,q,h),w.state=a.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(q=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),q!==w.state&&Mi.enqueueReplaceState(w,w.state,null),as(a,h,w,b),zl(),w.state=a.memoizedState),typeof w.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(e===null){w=a.stateNode;var $=a.memoizedProps,ot=Wa(f,$);w.props=ot;var St=w.context,Rt=f.contextType;q=ka,typeof Rt=="object"&&Rt!==null&&(q=bn(Rt));var Mt=f.getDerivedStateFromProps;Rt=typeof Mt=="function"||typeof w.getSnapshotBeforeUpdate=="function",$=a.pendingProps!==$,Rt||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||($||St!==q)&&b0(a,w,h,q),Ar=!1;var Et=a.memoizedState;w.state=Et,as(a,h,w,b),zl(),St=a.memoizedState,$||Et!==St||Ar?(typeof Mt=="function"&&(ls(a,f,Mt,h),St=a.memoizedState),(ot=Ar||S0(a,f,ot,h,Et,St,q))?(Rt||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(a.flags|=4194308)):(typeof w.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=St),w.props=h,w.state=St,w.context=q,h=ot):(typeof w.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{w=a.stateNode,eh(e,a),q=a.memoizedProps,Rt=Wa(f,q),w.props=Rt,Mt=a.pendingProps,Et=w.context,St=f.contextType,ot=ka,typeof St=="object"&&St!==null&&(ot=bn(St)),$=f.getDerivedStateFromProps,(St=typeof $=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(q!==Mt||Et!==ot)&&b0(a,w,h,ot),Ar=!1,Et=a.memoizedState,w.state=Et,as(a,h,w,b),zl();var Tt=a.memoizedState;q!==Mt||Et!==Tt||Ar||e!==null&&e.dependencies!==null&&sc(e.dependencies)?(typeof $=="function"&&(ls(a,f,$,h),Tt=a.memoizedState),(Rt=Ar||S0(a,f,Rt,h,Et,Tt,ot)||e!==null&&e.dependencies!==null&&sc(e.dependencies))?(St||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,Tt,ot),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,Tt,ot)),typeof w.componentDidUpdate=="function"&&(a.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(a.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=Tt),w.props=h,w.state=Tt,w.context=ot,h=Rt):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(a.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(a.flags|=1024),h=!1)}return w=h,Vs(e,a),h=(a.flags&128)!==0,w||h?(w=a.stateNode,f=h&&typeof f.getDerivedStateFromError!="function"?null:w.render(),a.flags|=1,e!==null&&h?(a.child=zs(a,e.child,null,b),a.child=zs(a,null,f,b)):di(e,a,f,b),a.memoizedState=w.state,e=a.child):e=Na(e,a,b),e}function $a(e,a,f,h){return Wr(),a.flags|=256,di(e,a,f,h),a.child}var Ra={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wn(e){return{baseLanes:e,cachePool:js()}}function Ys(e,a,f){return e=e!==null?e.childLanes&~f:0,a&&(e|=pe),e}function Rr(e,a,f){var h=a.pendingProps,b=!1,w=(a.flags&128)!==0,q;if((q=w)||(q=e!==null&&e.memoizedState===null?!1:(Ln.current&2)!==0),q&&(b=!0,a.flags&=-129),q=(a.flags&32)!==0,a.flags&=-33,e===null){if(Le){if(b?rs(a):ss(),(e=gn)?(e=jv(e,xi),e=e!==null&&e.data!=="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:vr!==null?{id:Aa,overflow:wa}:null,retryLane:536870912,hydrationErrors:null},f=Ii(e),f.return=a,a.child=f,hi=a,gn=null)):e=null,e===null)throw yr(a);return rp(e)?a.lanes=32:a.lanes=536870912,null}var $=h.children;return h=h.fallback,b?(ss(),b=a.mode,$=ni({mode:"hidden",children:$},b),h=Zr(h,b,f,null),$.return=a,h.return=a,$.sibling=h,a.child=$,h=a.child,h.memoizedState=Wn(f),h.childLanes=Ys(e,q,f),a.memoizedState=Ra,ks(null,h)):(rs(a),Il(a,$))}var ot=e.memoizedState;if(ot!==null&&($=ot.dehydrated,$!==null)){if(w)a.flags&256?(rs(a),a.flags&=-257,a=Pn(e,a,f)):a.memoizedState!==null?(ss(),a.child=e.child,a.flags|=128,a=null):(ss(),$=h.fallback,b=a.mode,h=ni({mode:"visible",children:h.children},b),$=Zr($,b,f,null),$.flags|=2,h.return=a,$.return=a,h.sibling=$,a.child=h,zs(a,e.child,null,f),h=a.child,h.memoizedState=Wn(f),h.childLanes=Ys(e,q,f),a.memoizedState=Ra,a=ks(null,h));else if(rs(a),rp($)){if(q=$.nextSibling&&$.nextSibling.dataset,q)var St=q.dgst;q=St,h=Error(i(419)),h.stack="",h.digest=q,Ml({value:h,source:null,stack:null}),a=Pn(e,a,f)}else if(Fn||Dl(e,a,f,!1),q=(f&e.childLanes)!==0,Fn||q){if(q=Ne,q!==null&&(h=It(q,f),h!==0&&h!==ot.retryLane))throw ot.retryLane=h,ta(e,h),nn(q,e,h),Th;ap($)||S(),a=Pn(e,a,f)}else ap($)?(a.flags|=192,a.child=e.child,a=null):(e=ot.treeContext,gn=lr($.nextSibling),hi=a,Le=!0,na=null,xi=!1,e!==null&&qd(a,e),a=Il(a,h.children),a.flags|=4096);return a}return b?(ss(),$=h.fallback,b=a.mode,ot=e.child,St=ot.sibling,h=Ca(ot,{mode:"hidden",children:h.children}),h.subtreeFlags=ot.subtreeFlags&65011712,St!==null?$=Ca(St,$):($=Zr($,b,f,null),$.flags|=2),$.return=a,h.return=a,h.sibling=$,a.child=h,ks(null,h),h=a.child,$=e.child.memoizedState,$===null?$=Wn(f):(b=$.cachePool,b!==null?(ot=Kn._currentValue,b=b.parent!==ot?{parent:ot,pool:ot}:b):b=js(),$={baseLanes:$.baseLanes|f,cachePool:b}),h.memoizedState=$,h.childLanes=Ys(e,q,f),a.memoizedState=Ra,ks(e.child,h)):(rs(a),f=e.child,e=f.sibling,f=Ca(f,{mode:"visible",children:h.children}),f.return=a,f.sibling=null,e!==null&&(q=a.deletions,q===null?(a.deletions=[e],a.flags|=16):q.push(e)),a.child=f,a.memoizedState=null,f)}function Il(e,a){return a=ni({mode:"visible",children:a},e.mode),a.return=e,e.child=a}function ni(e,a){return e=bi(22,e,null,a),e.lanes=0,e}function Pn(e,a,f){return zs(a,e.child,null,f),e=Il(a,a.pendingProps.children),e.flags|=2,a.memoizedState=null,e}function Je(e,a,f){e.lanes|=a;var h=e.alternate;h!==null&&(h.lanes|=a),Zf(e.return,a,f)}function xr(e,a,f,h,b,w){var q=e.memoizedState;q===null?e.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:f,tailMode:b,treeForkCount:w}:(q.isBackwards=a,q.rendering=null,q.renderingStartTime=0,q.last=h,q.tail=f,q.tailMode=b,q.treeForkCount=w)}function xa(e,a,f){var h=a.pendingProps,b=h.revealOrder,w=h.tail;h=h.children;var q=Ln.current,$=(q&2)!==0;if($?(q=q&1|2,a.flags|=128):q&=1,it(Ln,q),di(e,a,h,f),h=Le?Nl:0,!$&&e!==null&&(e.flags&128)!==0)t:for(e=a.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Je(e,f,a);else if(e.tag===19)Je(e,f,a);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===a)break t;for(;e.sibling===null;){if(e.return===null||e.return===a)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(b){case"forwards":for(f=a.child,b=null;f!==null;)e=f.alternate,e!==null&&dc(e)===null&&(b=f),f=f.sibling;f=b,f===null?(b=a.child,a.child=null):(b=f.sibling,f.sibling=null),xr(a,!1,b,f,w,h);break;case"backwards":case"unstable_legacy-backwards":for(f=null,b=a.child,a.child=null;b!==null;){if(e=b.alternate,e!==null&&dc(e)===null){a.child=b;break}e=b.sibling,b.sibling=f,f=b,b=e}xr(a,!0,f,null,w,h);break;case"together":xr(a,!1,null,null,void 0,h);break;default:a.memoizedState=null}return a.child}function Na(e,a,f){if(e!==null&&(a.dependencies=e.dependencies),hs|=a.lanes,(f&a.childLanes)===0)if(e!==null){if(Dl(e,a,f,!1),(f&a.childLanes)===0)return null}else return null;if(e!==null&&a.child!==e.child)throw Error(i(153));if(a.child!==null){for(e=a.child,f=Ca(e,e.pendingProps),a.child=f,f.return=a;e.sibling!==null;)e=e.sibling,f=f.sibling=Ca(e,e.pendingProps),f.return=a;f.sibling=null}return a.child}function Di(e,a){return(e.lanes&a)!==0?!0:(e=e.dependencies,!!(e!==null&&sc(e)))}function Mc(e,a,f){switch(a.tag){case 3:gt(a,a.stateNode.containerInfo),$r(a,Kn,e.memoizedState.cache),Wr();break;case 27:case 5:Dt(a);break;case 4:gt(a,a.stateNode.containerInfo);break;case 10:$r(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Qn(a),null;break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(rs(a),a.flags|=128,null):(f&a.child.childLanes)!==0?Rr(e,a,f):(rs(a),e=Na(e,a,f),e!==null?e.sibling:null);rs(a);break;case 19:var b=(e.flags&128)!==0;if(h=(f&a.childLanes)!==0,h||(Dl(e,a,f,!1),h=(f&a.childLanes)!==0),b){if(h)return xa(e,a,f);a.flags|=128}if(b=a.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),it(Ln,Ln.current),h)break;return null;case 22:return a.lanes=0,Ah(e,a,f,a.pendingProps);case 24:$r(a,Kn,e.memoizedState.cache)}return Na(e,a,f)}function us(e,a,f){if(e!==null)if(e.memoizedProps!==a.pendingProps)Fn=!0;else{if(!Di(e,f)&&(a.flags&128)===0)return Fn=!1,Mc(e,a,f);Fn=(e.flags&131072)!==0}else Fn=!1,Le&&(a.flags&1048576)!==0&&ic(a,Nl,a.index);switch(a.lanes=0,a.tag){case 16:t:{var h=a.pendingProps;if(e=Er(a.elementType),a.type=e,typeof e=="function")tc(e)?(h=Wa(e,h),a.tag=1,a=os(null,a,e,h,f)):(a.tag=0,a=Yi(null,a,e,h,f));else{if(e!=null){var b=e.$$typeof;if(b===G){a.tag=11,a=Pl(null,a,e,h,f);break t}else if(b===T){a.tag=14,a=Vi(null,a,e,h,f);break t}}throw a=X(e)||e,Error(i(306,a,""))}}return a;case 0:return Yi(e,a,a.type,a.pendingProps,f);case 1:return h=a.type,b=Wa(h,a.pendingProps),os(e,a,h,b,f);case 3:t:{if(gt(a,a.stateNode.containerInfo),e===null)throw Error(i(387));h=a.pendingProps;var w=a.memoizedState;b=w.element,eh(e,a),as(a,h,null,f);var q=a.memoizedState;if(h=q.cache,$r(a,Kn,h),h!==w.cache&&Wf(a,[Kn],f,!0),zl(),h=q.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:q.cache},a.updateQueue.baseState=w,a.memoizedState=w,a.flags&256){a=$a(e,a,h,f);break t}else if(h!==b){b=ea(Error(i(424)),a),Ml(b),a=$a(e,a,h,f);break t}else{switch(e=a.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(gn=lr(e.firstChild),hi=a,Le=!0,na=null,xi=!0,f=Yd(a,null,h,f),a.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Wr(),h===b){a=Na(e,a,f);break t}di(e,a,h,f)}a=a.child}return a;case 26:return Vs(e,a),e===null?(f=Hv(a.type,null,a.pendingProps,null))?a.memoizedState=f:Le||(f=a.type,e=a.pendingProps,h=N0(tt.current).createElement(f),h[xe]=a,h[We]=e,zi(h,f,e),ti(h),a.stateNode=h):a.memoizedState=Hv(a.type,e.memoizedProps,a.pendingProps,e.memoizedState),null;case 27:return Dt(a),e===null&&Le&&(h=a.stateNode=zv(a.type,a.pendingProps,tt.current),hi=a,xi=!0,b=gn,Fl(a.type)?(sp=b,gn=lr(h.firstChild)):gn=b),di(e,a,a.pendingProps.children,f),Vs(e,a),e===null&&(a.flags|=4194304),a.child;case 5:return e===null&&Le&&((b=h=gn)&&(h=Ub(h,a.type,a.pendingProps,xi),h!==null?(a.stateNode=h,hi=a,gn=lr(h.firstChild),xi=!1,b=!0):b=!1),b||yr(a)),Dt(a),b=a.type,w=a.pendingProps,q=e!==null?e.memoizedProps:null,h=w.children,ep(b,w)?h=null:q!==null&&ep(b,q)&&(a.flags|=32),a.memoizedState!==null&&(b=Hs(e,a,Hg,null,null,f),Hh._currentValue=b),Vs(e,a),di(e,a,h,f),a.child;case 6:return e===null&&Le&&((e=f=gn)&&(f=Bb(f,a.pendingProps,xi),f!==null?(a.stateNode=f,hi=a,gn=null,e=!0):e=!1),e||yr(a)),null;case 13:return Rr(e,a,f);case 4:return gt(a,a.stateNode.containerInfo),h=a.pendingProps,e===null?a.child=zs(a,null,h,f):di(e,a,h,f),a.child;case 11:return Pl(e,a,a.type,a.pendingProps,f);case 7:return di(e,a,a.pendingProps,f),a.child;case 8:return di(e,a,a.pendingProps.children,f),a.child;case 12:return di(e,a,a.pendingProps.children,f),a.child;case 10:return h=a.pendingProps,$r(a,a.type,h.value),di(e,a,h.children,f),a.child;case 9:return b=a.type._context,h=a.pendingProps.children,Sr(a),b=bn(b),h=h(b),a.flags|=1,di(e,a,h,f),a.child;case 14:return Vi(e,a,a.type,a.pendingProps,f);case 15:return xc(e,a,a.type,a.pendingProps,f);case 19:return xa(e,a,f);case 31:return Nc(e,a,f);case 22:return Ah(e,a,f,a.pendingProps);case 24:return Sr(a),h=bn(Kn),e===null?(b=Bl(),b===null&&(b=Ne,w=lc(),b.pooledCache=w,w.refCount++,w!==null&&(b.pooledCacheLanes|=f),b=w),a.memoizedState={parent:h,cache:b},Ls(a),$r(a,Kn,b)):((e.lanes&f)!==0&&(eh(e,a),as(a,null,null,f),zl()),b=e.memoizedState,w=a.memoizedState,b.parent!==h?(b={parent:h,cache:h},a.memoizedState=b,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=b),$r(a,Kn,h)):(h=w.cache,$r(a,Kn,h),h!==b.cache&&Wf(a,[Kn],f,!0))),di(e,a,a.pendingProps.children,f),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function gi(e){e.flags|=4}function Oh(e,a,f,h,b){if((a=(e.mode&32)!==0)&&(a=!1),a){if(e.flags|=16777216,(b&335544128)===b)if(e.stateNode.complete)e.flags|=8192;else if(s())e.flags|=8192;else throw Cr=Io,Po}else e.flags&=-16777217}function C0(e,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Vv(a))if(s())e.flags|=8192;else throw Cr=Io,Po}function Dc(e,a){a!==null&&(e.flags|=4),e.flags&16384&&(a=e.tag!==22?ba():536870912,e.lanes|=a,De|=a)}function pn(e,a){if(!Le)switch(e.tailMode){case"hidden":a=e.tail;for(var f=null;a!==null;)a.alternate!==null&&(f=a),a=a.sibling;f===null?e.tail=null:f.sibling=null;break;case"collapsed":f=e.tail;for(var h=null;f!==null;)f.alternate!==null&&(h=f),f=f.sibling;h===null?a||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function cn(e){var a=e.alternate!==null&&e.alternate.child===e.child,f=0,h=0;if(a)for(var b=e.child;b!==null;)f|=b.lanes|b.childLanes,h|=b.subtreeFlags&65011712,h|=b.flags&65011712,b.return=e,b=b.sibling;else for(b=e.child;b!==null;)f|=b.lanes|b.childLanes,h|=b.subtreeFlags,h|=b.flags,b.return=e,b=b.sibling;return e.subtreeFlags|=h,e.childLanes=f,a}function kl(e,a,f){var h=a.pendingProps;switch(Xf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(a),null;case 1:return cn(a),null;case 3:return f=a.stateNode,h=null,e!==null&&(h=e.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),Va(Kn),At(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(e===null||e.child===null)&&(Rs(a)?gi(a):e===null||e.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,xs())),cn(a),null;case 26:var b=a.type,w=a.memoizedState;return e===null?(gi(a),w!==null?(cn(a),C0(a,w)):(cn(a),Oh(a,b,null,h,f))):w?w!==e.memoizedState?(gi(a),cn(a),C0(a,w)):(cn(a),a.flags&=-16777217):(e=e.memoizedProps,e!==h&&gi(a),cn(a),Oh(a,b,e,h,f)),null;case 27:if(Qt(a),f=tt.current,b=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==h&&gi(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return cn(a),null}e=Y.current,Rs(a)?Ff(a):(e=zv(b,h,f),a.stateNode=e,gi(a))}return cn(a),null;case 5:if(Qt(a),b=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==h&&gi(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return cn(a),null}if(w=Y.current,Rs(a))Ff(a);else{var q=N0(tt.current);switch(w){case 1:w=q.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:w=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":w=q.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":w=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":w=q.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof h.is=="string"?q.createElement("select",{is:h.is}):q.createElement("select"),h.multiple?w.multiple=!0:h.size&&(w.size=h.size);break;default:w=typeof h.is=="string"?q.createElement(b,{is:h.is}):q.createElement(b)}}w[xe]=a,w[We]=h;t:for(q=a.child;q!==null;){if(q.tag===5||q.tag===6)w.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===a)break t;for(;q.sibling===null;){if(q.return===null||q.return===a)break t;q=q.return}q.sibling.return=q.return,q=q.sibling}a.stateNode=w;t:switch(zi(w,b,h),b){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&gi(a)}}return cn(a),Oh(a,a.type,e===null?null:e.memoizedProps,a.pendingProps,f),null;case 6:if(e&&a.stateNode!=null)e.memoizedProps!==h&&gi(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(i(166));if(e=tt.current,Rs(a)){if(e=a.stateNode,f=a.memoizedProps,h=null,b=hi,b!==null)switch(b.tag){case 27:case 5:h=b.memoizedProps}e[xe]=a,e=!!(e.nodeValue===f||h!==null&&h.suppressHydrationWarning===!0||Av(e.nodeValue,f)),e||yr(a,!0)}else e=N0(e).createTextNode(h),e[xe]=a,a.stateNode=e}return cn(a),null;case 31:if(f=a.memoizedState,e===null||e.memoizedState!==null){if(h=Rs(a),f!==null){if(e===null){if(!h)throw Error(i(318));if(e=a.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[xe]=a}else Wr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;cn(a),e=!1}else f=xs(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),e=!0;if(!e)return a.flags&256?(aa(a),a):(aa(a),null);if((a.flags&128)!==0)throw Error(i(558))}return cn(a),null;case 13:if(h=a.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(b=Rs(a),h!==null&&h.dehydrated!==null){if(e===null){if(!b)throw Error(i(318));if(b=a.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(i(317));b[xe]=a}else Wr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;cn(a),b=!1}else b=xs(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=b),b=!0;if(!b)return a.flags&256?(aa(a),a):(aa(a),null)}return aa(a),(a.flags&128)!==0?(a.lanes=f,a):(f=h!==null,e=e!==null&&e.memoizedState!==null,f&&(h=a.child,b=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(b=h.alternate.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==b&&(h.flags|=2048)),f!==e&&f&&(a.child.flags|=8192),Dc(a,a.updateQueue),cn(a),null);case 4:return At(),e===null&&Jg(a.stateNode.containerInfo),cn(a),null;case 10:return Va(a.type),cn(a),null;case 19:if(rt(Ln),h=a.memoizedState,h===null)return cn(a),null;if(b=(a.flags&128)!==0,w=h.rendering,w===null)if(b)pn(h,!1);else{if(mn!==0||e!==null&&(e.flags&128)!==0)for(e=a.child;e!==null;){if(w=dc(e),w!==null){for(a.flags|=128,pn(h,!1),e=w.updateQueue,a.updateQueue=e,Dc(a,e),a.subtreeFlags=0,e=f,f=a.child;f!==null;)ec(f,e),f=f.sibling;return it(Ln,Ln.current&1|2),Le&&qa(a,h.treeForkCount),a.child}e=e.sibling}h.tail!==null&&Me()>Sa&&(a.flags|=128,b=!0,pn(h,!1),a.lanes=4194304)}else{if(!b)if(e=dc(w),e!==null){if(a.flags|=128,b=!0,e=e.updateQueue,a.updateQueue=e,Dc(a,e),pn(h,!0),h.tail===null&&h.tailMode==="hidden"&&!w.alternate&&!Le)return cn(a),null}else 2*Me()-h.renderingStartTime>Sa&&f!==536870912&&(a.flags|=128,b=!0,pn(h,!1),a.lanes=4194304);h.isBackwards?(w.sibling=a.child,a.child=w):(e=h.last,e!==null?e.sibling=w:a.child=w,h.last=w)}return h.tail!==null?(e=h.tail,h.rendering=e,h.tail=e.sibling,h.renderingStartTime=Me(),e.sibling=null,f=Ln.current,it(Ln,b?f&1|2:f&1),Le&&qa(a,h.treeForkCount),e):(cn(a),null);case 22:case 23:return aa(a),Qa(),h=a.memoizedState!==null,e!==null?e.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(f&536870912)!==0&&(a.flags&128)===0&&(cn(a),a.subtreeFlags&6&&(a.flags|=8192)):cn(a),f=a.updateQueue,f!==null&&Dc(a,f.retryQueue),f=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(f=e.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==f&&(a.flags|=2048),e!==null&&rt(Ds),null;case 24:return f=null,e!==null&&(f=e.memoizedState.cache),a.memoizedState.cache!==f&&(a.flags|=2048),Va(Kn),cn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Rh(e,a){switch(Xf(a),a.tag){case 1:return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 3:return Va(Kn),At(),e=a.flags,(e&65536)!==0&&(e&128)===0?(a.flags=e&-65537|128,a):null;case 26:case 27:case 5:return Qt(a),null;case 31:if(a.memoizedState!==null){if(aa(a),a.alternate===null)throw Error(i(340));Wr()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 13:if(aa(a),e=a.memoizedState,e!==null&&e.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Wr()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 19:return rt(Ln),null;case 4:return At(),null;case 10:return Va(a.type),null;case 22:case 23:return aa(a),Qa(),e!==null&&rt(Ds),e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 24:return Va(Kn),null;case 25:return null;default:return null}}function tu(e,a){switch(Xf(a),a.tag){case 3:Va(Kn),At();break;case 26:case 27:case 5:Qt(a);break;case 4:At();break;case 31:a.memoizedState!==null&&aa(a);break;case 13:aa(a);break;case 19:rt(Ln);break;case 10:Va(a.type);break;case 22:case 23:aa(a),Qa(),e!==null&&rt(Ds);break;case 24:Va(Kn)}}function Ks(e,a){try{var f=a.updateQueue,h=f!==null?f.lastEffect:null;if(h!==null){var b=h.next;f=b;do{if((f.tag&e)===e){h=void 0;var w=f.create,q=f.inst;h=w(),q.destroy=h}f=f.next}while(f!==b)}}catch($){Ft(a,a.return,$)}}function oa(e,a,f){try{var h=a.updateQueue,b=h!==null?h.lastEffect:null;if(b!==null){var w=b.next;h=w;do{if((h.tag&e)===e){var q=h.inst,$=q.destroy;if($!==void 0){q.destroy=void 0,b=a;var ot=f,St=$;try{St()}catch(Rt){Ft(b,ot,Rt)}}}h=h.next}while(h!==w)}}catch(Rt){Ft(a,a.return,Rt)}}function ql(e){var a=e.updateQueue;if(a!==null){var f=e.stateNode;try{Kd(a,f)}catch(h){Ft(e,e.return,h)}}}function jc(e,a,f){f.props=Wa(e.type,e.memoizedProps),f.state=e.memoizedState;try{f.componentWillUnmount()}catch(h){Ft(e,a,h)}}function tr(e,a){try{var f=e.ref;if(f!==null){switch(e.tag){case 26:case 27:case 5:var h=e.stateNode;break;case 30:h=e.stateNode;break;default:h=e.stateNode}typeof f=="function"?e.refCleanup=f(h):f.current=h}}catch(b){Ft(e,a,b)}}function ji(e,a){var f=e.ref,h=e.refCleanup;if(f!==null)if(typeof h=="function")try{h()}catch(b){Ft(e,a,b)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(b){Ft(e,a,b)}else f.current=null}function xh(e){var a=e.type,f=e.memoizedProps,h=e.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":f.autoFocus&&h.focus();break t;case"img":f.src?h.src=f.src:f.srcSet&&(h.srcset=f.srcSet)}}catch(b){Ft(e,e.return,b)}}function Nr(e,a,f){try{var h=e.stateNode;Rb(h,e.type,f,a),h[We]=a}catch(b){Ft(e,e.return,b)}}function T0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Fl(e.type)||e.tag===4}function Qs(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||T0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Fl(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function eu(e,a,f){var h=e.tag;if(h===5||h===6)e=e.stateNode,a?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(e,a):(a=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,a.appendChild(e),f=f._reactRootContainer,f!=null||a.onclick!==null||(a.onclick=Hi));else if(h!==4&&(h===27&&Fl(e.type)&&(f=e.stateNode,a=null),e=e.child,e!==null))for(eu(e,a,f),e=e.sibling;e!==null;)eu(e,a,f),e=e.sibling}function Xs(e,a,f){var h=e.tag;if(h===5||h===6)e=e.stateNode,a?f.insertBefore(e,a):f.appendChild(e);else if(h!==4&&(h===27&&Fl(e.type)&&(f=e.stateNode),e=e.child,e!==null))for(Xs(e,a,f),e=e.sibling;e!==null;)Xs(e,a,f),e=e.sibling}function nu(e){var a=e.stateNode,f=e.memoizedProps;try{for(var h=e.type,b=a.attributes;b.length;)a.removeAttributeNode(b[0]);zi(a,h,f),a[xe]=e,a[We]=f}catch(w){Ft(e,e.return,w)}}var Ki=!1,$e=!1,cs=!1,Uc=typeof WeakSet=="function"?WeakSet:Set,_n=null;function Nh(e,a){if(e=e.containerInfo,$g=L0,e=_a(e),Zu(e)){if("selectionStart"in e)var f={start:e.selectionStart,end:e.selectionEnd};else t:{f=(f=e.ownerDocument)&&f.defaultView||window;var h=f.getSelection&&f.getSelection();if(h&&h.rangeCount!==0){f=h.anchorNode;var b=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{f.nodeType,w.nodeType}catch{f=null;break t}var q=0,$=-1,ot=-1,St=0,Rt=0,Mt=e,Et=null;e:for(;;){for(var Tt;Mt!==f||b!==0&&Mt.nodeType!==3||($=q+b),Mt!==w||h!==0&&Mt.nodeType!==3||(ot=q+h),Mt.nodeType===3&&(q+=Mt.nodeValue.length),(Tt=Mt.firstChild)!==null;)Et=Mt,Mt=Tt;for(;;){if(Mt===e)break e;if(Et===f&&++St===b&&($=q),Et===w&&++Rt===h&&(ot=q),(Tt=Mt.nextSibling)!==null)break;Mt=Et,Et=Mt.parentNode}Mt=Tt}f=$===-1||ot===-1?null:{start:$,end:ot}}else f=null}f=f||{start:0,end:0}}else f=null;for(tp={focusedElem:e,selectionRange:f},L0=!1,_n=a;_n!==null;)if(a=_n,e=a.child,(a.subtreeFlags&1028)!==0&&e!==null)e.return=a,_n=e;else for(;_n!==null;){switch(a=_n,w=a.alternate,e=a.flags,a.tag){case 0:if((e&4)!==0&&(e=a.updateQueue,e=e!==null?e.events:null,e!==null))for(f=0;f<e.length;f++)b=e[f],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&w!==null){e=void 0,f=a,b=w.memoizedProps,w=w.memoizedState,h=f.stateNode;try{var ne=Wa(f.type,b);e=h.getSnapshotBeforeUpdate(ne,w),h.__reactInternalSnapshotBeforeUpdate=e}catch(me){Ft(f,f.return,me)}}break;case 3:if((e&1024)!==0){if(e=a.stateNode.containerInfo,f=e.nodeType,f===9)ip(e);else if(f===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ip(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=a.sibling,e!==null){e.return=a.return,_n=e;break}_n=a.return}}function Fs(e,a,f){var h=f.flags;switch(f.tag){case 0:case 11:case 15:er(e,f),h&4&&Ks(5,f);break;case 1:if(er(e,f),h&4)if(e=f.stateNode,a===null)try{e.componentDidMount()}catch(q){Ft(f,f.return,q)}else{var b=Wa(f.type,a.memoizedProps);a=a.memoizedState;try{e.componentDidUpdate(b,a,e.__reactInternalSnapshotBeforeUpdate)}catch(q){Ft(f,f.return,q)}}h&64&&ql(f),h&512&&tr(f,f.return);break;case 3:if(er(e,f),h&64&&(e=f.updateQueue,e!==null)){if(a=null,f.child!==null)switch(f.child.tag){case 27:case 5:a=f.child.stateNode;break;case 1:a=f.child.stateNode}try{Kd(e,a)}catch(q){Ft(f,f.return,q)}}break;case 27:a===null&&h&4&&nu(f);case 26:case 5:er(e,f),a===null&&h&4&&xh(f),h&512&&tr(f,f.return);break;case 12:er(e,f);break;case 31:er(e,f),h&4&&au(e,f);break;case 13:er(e,f),h&4&&Js(e,f),h&64&&(e=f.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(f=ri.bind(null,f),zb(e,f))));break;case 22:if(h=f.memoizedState!==null||Ki,!h){a=a!==null&&a.memoizedState!==null||$e,b=Ki;var w=$e;Ki=h,($e=a)&&!w?Qi(e,f,(f.subtreeFlags&8772)!==0):er(e,f),Ki=b,$e=w}break;case 30:break;default:er(e,f)}}function iu(e){var a=e.alternate;a!==null&&(e.alternate=null,iu(a)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(a=e.stateNode,a!==null&&Mn(a)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var tn=null,fe=!1;function Ge(e,a,f){for(f=f.child;f!==null;)In(e,a,f),f=f.sibling}function In(e,a,f){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(Ot,f)}catch{}switch(f.tag){case 26:$e||ji(f,a),Ge(e,a,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:$e||ji(f,a);var h=tn,b=fe;Fl(f.type)&&(tn=f.stateNode,fe=!1),Ge(e,a,f),zh(f.stateNode),tn=h,fe=b;break;case 5:$e||ji(f,a);case 6:if(h=tn,b=fe,tn=null,Ge(e,a,f),tn=h,fe=b,tn!==null)if(fe)try{(tn.nodeType===9?tn.body:tn.nodeName==="HTML"?tn.ownerDocument.body:tn).removeChild(f.stateNode)}catch(w){Ft(f,a,w)}else try{tn.removeChild(f.stateNode)}catch(w){Ft(f,a,w)}break;case 18:tn!==null&&(fe?(e=tn,Mv(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,f.stateNode),Yc(e)):Mv(tn,f.stateNode));break;case 4:h=tn,b=fe,tn=f.stateNode.containerInfo,fe=!0,Ge(e,a,f),tn=h,fe=b;break;case 0:case 11:case 14:case 15:oa(2,f,a),$e||oa(4,f,a),Ge(e,a,f);break;case 1:$e||(ji(f,a),h=f.stateNode,typeof h.componentWillUnmount=="function"&&jc(f,a,h)),Ge(e,a,f);break;case 21:Ge(e,a,f);break;case 22:$e=(h=$e)||f.memoizedState!==null,Ge(e,a,f),$e=h;break;default:Ge(e,a,f)}}function au(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Yc(e)}catch(f){Ft(a,a.return,f)}}}function Js(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Yc(e)}catch(f){Ft(a,a.return,f)}}function Zs(e){switch(e.tag){case 31:case 13:case 19:var a=e.stateNode;return a===null&&(a=e.stateNode=new Uc),a;case 22:return e=e.stateNode,a=e._retryCache,a===null&&(a=e._retryCache=new Uc),a;default:throw Error(i(435,e.tag))}}function Ws(e,a){var f=Zs(e);a.forEach(function(h){if(!f.has(h)){f.add(h);var b=Ze.bind(null,e,h);h.then(b,b)}})}function ii(e,a){var f=a.deletions;if(f!==null)for(var h=0;h<f.length;h++){var b=f[h],w=e,q=a,$=q;t:for(;$!==null;){switch($.tag){case 27:if(Fl($.type)){tn=$.stateNode,fe=!1;break t}break;case 5:tn=$.stateNode,fe=!1;break t;case 3:case 4:tn=$.stateNode.containerInfo,fe=!0;break t}$=$.return}if(tn===null)throw Error(i(160));In(w,q,b),tn=null,fe=!1,w=b.alternate,w!==null&&(w.return=null),b.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)A0(a,e),a=a.sibling}var _i=null;function A0(e,a){var f=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ii(a,e),pi(e),h&4&&(oa(3,e,e.return),Ks(3,e),oa(5,e,e.return));break;case 1:ii(a,e),pi(e),h&512&&($e||f===null||ji(f,f.return)),h&64&&Ki&&(e=e.updateQueue,e!==null&&(h=e.callbacks,h!==null&&(f=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=f===null?h:f.concat(h))));break;case 26:var b=_i;if(ii(a,e),pi(e),h&512&&($e||f===null||ji(f,f.return)),h&4){var w=f!==null?f.memoizedState:null;if(h=e.memoizedState,f===null)if(h===null)if(e.stateNode===null){t:{h=e.type,f=e.memoizedProps,b=b.ownerDocument||b;e:switch(h){case"title":w=b.getElementsByTagName("title")[0],(!w||w[ys]||w[xe]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=b.createElement(h),b.head.insertBefore(w,b.querySelector("head > title"))),zi(w,h,f),w[xe]=e,ti(w),h=w;break t;case"link":var q=kv("link","href",b).get(h+(f.href||""));if(q){for(var $=0;$<q.length;$++)if(w=q[$],w.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&w.getAttribute("rel")===(f.rel==null?null:f.rel)&&w.getAttribute("title")===(f.title==null?null:f.title)&&w.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){q.splice($,1);break e}}w=b.createElement(h),zi(w,h,f),b.head.appendChild(w);break;case"meta":if(q=kv("meta","content",b).get(h+(f.content||""))){for($=0;$<q.length;$++)if(w=q[$],w.getAttribute("content")===(f.content==null?null:""+f.content)&&w.getAttribute("name")===(f.name==null?null:f.name)&&w.getAttribute("property")===(f.property==null?null:f.property)&&w.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&w.getAttribute("charset")===(f.charSet==null?null:f.charSet)){q.splice($,1);break e}}w=b.createElement(h),zi(w,h,f),b.head.appendChild(w);break;default:throw Error(i(468,h))}w[xe]=e,ti(w),h=w}e.stateNode=h}else qv(b,e.type,e.stateNode);else e.stateNode=Iv(b,h,e.memoizedProps);else w!==h?(w===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):w.count--,h===null?qv(b,e.type,e.stateNode):Iv(b,h,e.memoizedProps)):h===null&&e.stateNode!==null&&Nr(e,e.memoizedProps,f.memoizedProps)}break;case 27:ii(a,e),pi(e),h&512&&($e||f===null||ji(f,f.return)),f!==null&&h&4&&Nr(e,e.memoizedProps,f.memoizedProps);break;case 5:if(ii(a,e),pi(e),h&512&&($e||f===null||ji(f,f.return)),e.flags&32){b=e.stateNode;try{qr(b,"")}catch(ne){Ft(e,e.return,ne)}}h&4&&e.stateNode!=null&&(b=e.memoizedProps,Nr(e,b,f!==null?f.memoizedProps:b)),h&1024&&(cs=!0);break;case 6:if(ii(a,e),pi(e),h&4){if(e.stateNode===null)throw Error(i(162));h=e.memoizedProps,f=e.stateNode;try{f.nodeValue=h}catch(ne){Ft(e,e.return,ne)}}break;case 3:if(j0=null,b=_i,_i=M0(a.containerInfo),ii(a,e),_i=b,pi(e),h&4&&f!==null&&f.memoizedState.isDehydrated)try{Yc(a.containerInfo)}catch(ne){Ft(e,e.return,ne)}cs&&(cs=!1,Mh(e));break;case 4:h=_i,_i=M0(e.stateNode.containerInfo),ii(a,e),pi(e),_i=h;break;case 12:ii(a,e),pi(e);break;case 31:ii(a,e),pi(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ws(e,h)));break;case 13:ii(a,e),pi(e),e.child.flags&8192&&e.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Dr=Me()),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ws(e,h)));break;case 22:b=e.memoizedState!==null;var ot=f!==null&&f.memoizedState!==null,St=Ki,Rt=$e;if(Ki=St||b,$e=Rt||ot,ii(a,e),$e=Rt,Ki=St,pi(e),h&8192)t:for(a=e.stateNode,a._visibility=b?a._visibility&-2:a._visibility|1,b&&(f===null||ot||Ki||$e||$s(e)),f=null,a=e;;){if(a.tag===5||a.tag===26){if(f===null){ot=f=a;try{if(w=ot.stateNode,b)q=w.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{$=ot.stateNode;var Mt=ot.memoizedProps.style,Et=Mt!=null&&Mt.hasOwnProperty("display")?Mt.display:null;$.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(ne){Ft(ot,ot.return,ne)}}}else if(a.tag===6){if(f===null){ot=a;try{ot.stateNode.nodeValue=b?"":ot.memoizedProps}catch(ne){Ft(ot,ot.return,ne)}}}else if(a.tag===18){if(f===null){ot=a;try{var Tt=ot.stateNode;b?Dv(Tt,!0):Dv(ot.stateNode,!1)}catch(ne){Ft(ot,ot.return,ne)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===e)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break t;for(;a.sibling===null;){if(a.return===null||a.return===e)break t;f===a&&(f=null),a=a.return}f===a&&(f=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=e.updateQueue,h!==null&&(f=h.retryQueue,f!==null&&(h.retryQueue=null,Ws(e,f))));break;case 19:ii(a,e),pi(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,Ws(e,h)));break;case 30:break;case 21:break;default:ii(a,e),pi(e)}}function pi(e){var a=e.flags;if(a&2){try{for(var f,h=e.return;h!==null;){if(T0(h)){f=h;break}h=h.return}if(f==null)throw Error(i(160));switch(f.tag){case 27:var b=f.stateNode,w=Qs(e);Xs(e,w,b);break;case 5:var q=f.stateNode;f.flags&32&&(qr(q,""),f.flags&=-33);var $=Qs(e);Xs(e,$,q);break;case 3:case 4:var ot=f.stateNode.containerInfo,St=Qs(e);eu(e,St,ot);break;default:throw Error(i(161))}}catch(Rt){Ft(e,e.return,Rt)}e.flags&=-3}a&4096&&(e.flags&=-4097)}function Mh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var a=e;Mh(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),e=e.sibling}}function er(e,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Fs(e,a.alternate,a),a=a.sibling}function $s(e){for(e=e.child;e!==null;){var a=e;switch(a.tag){case 0:case 11:case 14:case 15:oa(4,a,a.return),$s(a);break;case 1:ji(a,a.return);var f=a.stateNode;typeof f.componentWillUnmount=="function"&&jc(a,a.return,f),$s(a);break;case 27:zh(a.stateNode);case 26:case 5:ji(a,a.return),$s(a);break;case 22:a.memoizedState===null&&$s(a);break;case 30:$s(a);break;default:$s(a)}e=e.sibling}}function Qi(e,a,f){for(f=f&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,b=e,w=a,q=w.flags;switch(w.tag){case 0:case 11:case 15:Qi(b,w,f),Ks(4,w);break;case 1:if(Qi(b,w,f),h=w,b=h.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(St){Ft(h,h.return,St)}if(h=w,b=h.updateQueue,b!==null){var $=h.stateNode;try{var ot=b.shared.hiddenCallbacks;if(ot!==null)for(b.shared.hiddenCallbacks=null,b=0;b<ot.length;b++)ih(ot[b],$)}catch(St){Ft(h,h.return,St)}}f&&q&64&&ql(w),tr(w,w.return);break;case 27:nu(w);case 26:case 5:Qi(b,w,f),f&&h===null&&q&4&&xh(w),tr(w,w.return);break;case 12:Qi(b,w,f);break;case 31:Qi(b,w,f),f&&q&4&&au(b,w);break;case 13:Qi(b,w,f),f&&q&4&&Js(b,w);break;case 22:w.memoizedState===null&&Qi(b,w,f),tr(w,w.return);break;case 30:break;default:Qi(b,w,f)}a=a.sibling}}function tl(e,a){var f=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(f=e.memoizedState.cachePool.pool),e=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(e=a.memoizedState.cachePool.pool),e!==f&&(e!=null&&e.refCount++,f!=null&&jl(f))}function fs(e,a){e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&jl(e))}function va(e,a,f,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ua(e,a,f,h),a=a.sibling}function ua(e,a,f,h){var b=a.flags;switch(a.tag){case 0:case 11:case 15:va(e,a,f,h),b&2048&&Ks(9,a);break;case 1:va(e,a,f,h);break;case 3:va(e,a,f,h),b&2048&&(e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&jl(e)));break;case 12:if(b&2048){va(e,a,f,h),e=a.stateNode;try{var w=a.memoizedProps,q=w.id,$=w.onPostCommit;typeof $=="function"&&$(q,a.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(ot){Ft(a,a.return,ot)}}else va(e,a,f,h);break;case 31:va(e,a,f,h);break;case 13:va(e,a,f,h);break;case 23:break;case 22:w=a.stateNode,q=a.alternate,a.memoizedState!==null?w._visibility&2?va(e,a,f,h):jn(e,a):w._visibility&2?va(e,a,f,h):(w._visibility|=2,Ui(e,a,f,h,(a.subtreeFlags&10256)!==0||!1)),b&2048&&tl(q,a);break;case 24:va(e,a,f,h),b&2048&&fs(a.alternate,a);break;default:va(e,a,f,h)}}function Ui(e,a,f,h,b){for(b=b&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var w=e,q=a,$=f,ot=h,St=q.flags;switch(q.tag){case 0:case 11:case 15:Ui(w,q,$,ot,b),Ks(8,q);break;case 23:break;case 22:var Rt=q.stateNode;q.memoizedState!==null?Rt._visibility&2?Ui(w,q,$,ot,b):jn(w,q):(Rt._visibility|=2,Ui(w,q,$,ot,b)),b&&St&2048&&tl(q.alternate,q);break;case 24:Ui(w,q,$,ot,b),b&&St&2048&&fs(q.alternate,q);break;default:Ui(w,q,$,ot,b)}a=a.sibling}}function jn(e,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var f=e,h=a,b=h.flags;switch(h.tag){case 22:jn(f,h),b&2048&&tl(h.alternate,h);break;case 24:jn(f,h),b&2048&&fs(h.alternate,h);break;default:jn(f,h)}a=a.sibling}}var el=8192;function nl(e,a,f){if(e.subtreeFlags&el)for(e=e.child;e!==null;)Dh(e,a,f),e=e.sibling}function Dh(e,a,f){switch(e.tag){case 26:nl(e,a,f),e.flags&el&&e.memoizedState!==null&&Xb(f,_i,e.memoizedState,e.memoizedProps);break;case 5:nl(e,a,f);break;case 3:case 4:var h=_i;_i=M0(e.stateNode.containerInfo),nl(e,a,f),_i=h;break;case 22:e.memoizedState===null&&(h=e.alternate,h!==null&&h.memoizedState!==null?(h=el,el=16777216,nl(e,a,f),el=h):nl(e,a,f));break;default:nl(e,a,f)}}function $n(e){var a=e.alternate;if(a!==null&&(e=a.child,e!==null)){a.child=null;do a=e.sibling,e.sibling=null,e=a;while(e!==null)}}function il(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var f=0;f<a.length;f++){var h=a[f];_n=h,Bc(h,e)}$n(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)nr(e),e=e.sibling}function nr(e){switch(e.tag){case 0:case 11:case 15:il(e),e.flags&2048&&oa(9,e,e.return);break;case 3:il(e);break;case 12:il(e);break;case 22:var a=e.stateNode;e.memoizedState!==null&&a._visibility&2&&(e.return===null||e.return.tag!==13)?(a._visibility&=-3,wn(e)):il(e);break;default:il(e)}}function wn(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var f=0;f<a.length;f++){var h=a[f];_n=h,Bc(h,e)}$n(e)}for(e=e.child;e!==null;){switch(a=e,a.tag){case 0:case 11:case 15:oa(8,a,a.return),wn(a);break;case 22:f=a.stateNode,f._visibility&2&&(f._visibility&=-3,wn(a));break;default:wn(a)}e=e.sibling}}function Bc(e,a){for(;_n!==null;){var f=_n;switch(f.tag){case 0:case 11:case 15:oa(8,f,a);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var h=f.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:jl(f.memoizedState.cache)}if(h=f.child,h!==null)h.return=f,_n=h;else t:for(f=e;_n!==null;){h=_n;var b=h.sibling,w=h.return;if(iu(h),h===f){_n=null;break t}if(b!==null){b.return=w,_n=b;break t}_n=w}}}var w0={getCacheForType:function(e){var a=bn(Kn),f=a.data.get(e);return f===void 0&&(f=e(),a.data.set(e,f)),f},cacheSignal:function(){return bn(Kn).controller.signal}},ai=typeof WeakMap=="function"?WeakMap:Map,he=0,Ne=null,Se=null,Oe=0,on=0,Ei=null,Ma=!1,Mr=!1,Vl=!1,ya=0,mn=0,hs=0,Re=0,fn=0,pe=0,De=0,Ye=null,vn=null,ir=!1,Dr=0,zc=0,Sa=1/0,En=null,Bi=null,Cn=0,ar=null,mi=null,Xi=0,al=0,Ci=null,Lc=null,rl=0,sl=null;function Ti(){return(he&2)!==0&&Oe!==0?Oe&-Oe:U.T!==null?Kg():Kt()}function jr(){if(pe===0)if((Oe&536870912)===0||Le){var e=Nn;Nn<<=1,(Nn&3932160)===0&&(Nn=262144),pe=e}else pe=536870912;return e=An.current,e!==null&&(e.flags|=32),pe}function nn(e,a,f){(e===Ne&&(on===2||on===9)||e.cancelPendingCommit!==null)&&(sr(e,0),rr(e,Oe,pe,!1)),zt(e,f),((he&2)===0||e!==Ne)&&(e===Ne&&((he&2)===0&&(Re|=f),mn===4&&rr(e,Oe,pe,!1)),ps(e))}function Ur(e,a,f){if((he&6)!==0)throw Error(i(327));var h=!f&&(a&127)===0&&(a&e.expiredLanes)===0||cr(e,a),b=h?nt(e,a):x(e,a,!0),w=h;do{if(b===0){Mr&&!h&&rr(e,a,0,!1);break}else{if(f=e.current.alternate,w&&!Yl(f)){b=x(e,a,!1),w=!1;continue}if(b===2){if(w=a,e.errorRecoveryDisabledLanes&w)var q=0;else q=e.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){a=q;t:{var $=e;b=Ye;var ot=$.current.memoizedState.isDehydrated;if(ot&&(sr($,q).flags|=256),q=x($,q,!1),q!==2){if(Vl&&!ot){$.errorRecoveryDisabledLanes|=w,Re|=w,b=4;break t}w=vn,vn=b,w!==null&&(vn===null?vn=w:vn.push.apply(vn,w))}b=q}if(w=!1,b!==2)continue}}if(b===1){sr(e,0),rr(e,a,0,!0);break}t:{switch(h=e,w=b,w){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:rr(h,a,pe,!Ma);break t;case 2:vn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(b=Dr+300-Me(),10<b)){if(rr(h,a,pe,!Ma),La(h,0,!0)!==0)break t;Xi=a,h.timeoutHandle=xv(ll.bind(null,h,f,vn,En,ir,a,pe,Re,De,Ma,w,"Throttled",-0,0),b);break t}ll(h,f,vn,En,ir,a,pe,Re,De,Ma,w,null,-0,0)}}break}while(!0);ps(e)}function ll(e,a,f,h,b,w,q,$,ot,St,Rt,Mt,Et,Tt){if(e.timeoutHandle=-1,Mt=a.subtreeFlags,Mt&8192||(Mt&16785408)===16785408){Mt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Hi},Dh(a,w,Mt);var ne=(w&62914560)===w?Dr-Me():(w&4194048)===w?zc-Me():0;if(ne=Fb(Mt,ne),ne!==null){Xi=w,e.cancelPendingCommit=ne(Ce.bind(null,e,a,w,f,h,b,q,$,ot,Rt,Mt,null,Et,Tt)),rr(e,w,q,!St);return}}Ce(e,a,w,f,h,b,q,$,ot)}function Yl(e){for(var a=e;;){var f=a.tag;if((f===0||f===11||f===15)&&a.flags&16384&&(f=a.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var h=0;h<f.length;h++){var b=f[h],w=b.getSnapshot;b=b.value;try{if(!oi(w(),b))return!1}catch{return!1}}if(f=a.child,a.subtreeFlags&16384&&f!==null)f.return=a,a=f;else{if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function rr(e,a,f,h){a&=~fn,a&=~Re,e.suspendedLanes|=a,e.pingedLanes&=~a,h&&(e.warmLanes|=a),h=e.expirationTimes;for(var b=a;0<b;){var w=31-be(b),q=1<<w;h[w]=-1,b&=~q}f!==0&&$t(e,f,a)}function Kl(){return(he&6)===0?(jh(0),!1):!0}function Gc(){if(Se!==null){if(on===0)var e=Se.return;else e=Se,Oa=ke=null,lh(e),es=null,ko=0,e=Se;for(;e!==null;)tu(e.alternate,e),e=e.return;Se=null}}function sr(e,a){var f=e.timeoutHandle;f!==-1&&(e.timeoutHandle=-1,Mb(f)),f=e.cancelPendingCommit,f!==null&&(e.cancelPendingCommit=null,f()),Xi=0,Gc(),Ne=e,Se=f=Ca(e.current,null),Oe=a,on=0,Ei=null,Ma=!1,Mr=cr(e,a),Vl=!1,De=pe=fn=Re=hs=mn=0,vn=Ye=null,ir=!1,(a&8)!==0&&(a|=a&32);var h=e.entangledLanes;if(h!==0)for(e=e.entanglements,h&=a;0<h;){var b=31-be(h),w=1<<b;a|=e[b],h&=~w}return ya=a,Uo(),f}function Hc(e,a){Ee=null,U.H=Hl,a===Us||a===cc?(a=hc(),on=3):a===Po?(a=hc(),on=4):on=a===Th?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ei=a,Se===null&&(mn=1,Rc(e,ea(a,e.current)))}function s(){var e=An.current;return e===null?!0:(Oe&4194048)===Oe?pa===null:(Oe&62914560)===Oe||(Oe&536870912)!==0?e===pa:!1}function u(){var e=U.H;return U.H=Hl,e===null?Hl:e}function p(){var e=U.A;return U.A=w0,e}function S(){mn=4,Ma||(Oe&4194048)!==Oe&&An.current!==null||(Mr=!0),(hs&134217727)===0&&(Re&134217727)===0||Ne===null||rr(Ne,Oe,pe,!1)}function x(e,a,f){var h=he;he|=2;var b=u(),w=p();(Ne!==e||Oe!==a)&&(En=null,sr(e,a)),a=!1;var q=mn;t:do try{if(on!==0&&Se!==null){var $=Se,ot=Ei;switch(on){case 8:Gc(),q=6;break t;case 3:case 2:case 9:case 6:An.current===null&&(a=!0);var St=on;if(on=0,Ei=null,Ht(e,$,ot,St),f&&Mr){q=0;break t}break;default:St=on,on=0,Ei=null,Ht(e,$,ot,St)}}P(),q=mn;break}catch(Rt){Hc(e,Rt)}while(!0);return a&&e.shellSuspendCounter++,Oa=ke=null,he=h,U.H=b,U.A=w,Se===null&&(Ne=null,Oe=0,Uo()),q}function P(){for(;Se!==null;)_t(Se)}function nt(e,a){var f=he;he|=2;var h=u(),b=p();Ne!==e||Oe!==a?(En=null,Sa=Me()+500,sr(e,a)):Mr=cr(e,a);t:do try{if(on!==0&&Se!==null){a=Se;var w=Ei;e:switch(on){case 1:on=0,Ei=null,Ht(e,a,w,1);break;case 2:case 9:if(_r(w)){on=0,Ei=null,Ut(a);break}a=function(){on!==2&&on!==9||Ne!==e||(on=7),ps(e)},w.then(a,a);break t;case 3:on=7;break t;case 4:on=5;break t;case 7:_r(w)?(on=0,Ei=null,Ut(a)):(on=0,Ei=null,Ht(e,a,w,7));break;case 5:var q=null;switch(Se.tag){case 26:q=Se.memoizedState;case 5:case 27:var $=Se;if(q?Vv(q):$.stateNode.complete){on=0,Ei=null;var ot=$.sibling;if(ot!==null)Se=ot;else{var St=$.return;St!==null?(Se=St,Zt(St)):Se=null}break e}}on=0,Ei=null,Ht(e,a,w,5);break;case 6:on=0,Ei=null,Ht(e,a,w,6);break;case 8:Gc(),mn=6;break t;default:throw Error(i(462))}}ut();break}catch(Rt){Hc(e,Rt)}while(!0);return Oa=ke=null,U.H=h,U.A=b,he=f,Se!==null?0:(Ne=null,Oe=0,Uo(),mn)}function ut(){for(;Se!==null&&!ge();)_t(Se)}function _t(e){var a=us(e.alternate,e,ya);e.memoizedProps=e.pendingProps,a===null?Zt(e):Se=a}function Ut(e){var a=e,f=a.alternate;switch(a.tag){case 15:case 0:a=la(f,a,a.pendingProps,a.type,void 0,Oe);break;case 11:a=la(f,a,a.pendingProps,a.type.render,a.ref,Oe);break;case 5:lh(a);default:tu(f,a),a=Se=ec(a,ya),a=us(f,a,ya)}e.memoizedProps=e.pendingProps,a===null?Zt(e):Se=a}function Ht(e,a,f,h){Oa=ke=null,lh(a),es=null,ko=0;var b=a.return;try{if(Ch(e,b,a,f,Oe)){mn=1,Rc(e,ea(f,e.current)),Se=null;return}}catch(w){if(b!==null)throw Se=b,w;mn=1,Rc(e,ea(f,e.current)),Se=null;return}a.flags&32768?(Le||h===1?e=!0:Mr||(Oe&536870912)!==0?e=!1:(Ma=e=!0,(h===2||h===9||h===3||h===6)&&(h=An.current,h!==null&&h.tag===13&&(h.flags|=16384))),Wt(a,e)):Zt(a)}function Zt(e){var a=e;do{if((a.flags&32768)!==0){Wt(a,Ma);return}e=a.return;var f=kl(a.alternate,a,ya);if(f!==null){Se=f;return}if(a=a.sibling,a!==null){Se=a;return}Se=a=e}while(a!==null);mn===0&&(mn=5)}function Wt(e,a){do{var f=Rh(e.alternate,e);if(f!==null){f.flags&=32767,Se=f;return}if(f=e.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!a&&(e=e.sibling,e!==null)){Se=e;return}Se=e=f}while(e!==null);mn=6,Se=null}function Ce(e,a,f,h,b,w,q,$,ot){e.cancelPendingCommit=null;do pt();while(Cn!==0);if((he&6)!==0)throw Error(i(327));if(a!==null){if(a===e.current)throw Error(i(177));if(w=a.lanes|a.childLanes,w|=ga,Yt(e,f,w,q,$,ot),e===Ne&&(Se=Ne=null,Oe=0),mi=a,ar=e,Xi=f,al=w,Ci=b,Lc=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,gs(ft,function(){return Ct(),null})):(e.callbackNode=null,e.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=U.T,U.T=null,b=I.p,I.p=2,q=he,he|=4;try{Nh(e,a,f)}finally{he=q,I.p=b,U.T=h}}Cn=1,ca(),Ql(),ds()}}function ca(){if(Cn===1){Cn=0;var e=ar,a=mi,f=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||f){f=U.T,U.T=null;var h=I.p;I.p=2;var b=he;he|=4;try{A0(a,e);var w=tp,q=_a(e.containerInfo),$=w.focusedElem,ot=w.selectionRange;if(q!==$&&$&&$.ownerDocument&&Al($.ownerDocument.documentElement,$)){if(ot!==null&&Zu($)){var St=ot.start,Rt=ot.end;if(Rt===void 0&&(Rt=St),"selectionStart"in $)$.selectionStart=St,$.selectionEnd=Math.min(Rt,$.value.length);else{var Mt=$.ownerDocument||document,Et=Mt&&Mt.defaultView||window;if(Et.getSelection){var Tt=Et.getSelection(),ne=$.textContent.length,me=Math.min(ot.start,ne),Sn=ot.end===void 0?me:Math.min(ot.end,ne);!Tt.extend&&me>Sn&&(q=Sn,Sn=me,me=q);var mt=Pf($,me),dt=Pf($,Sn);if(mt&&dt&&(Tt.rangeCount!==1||Tt.anchorNode!==mt.node||Tt.anchorOffset!==mt.offset||Tt.focusNode!==dt.node||Tt.focusOffset!==dt.offset)){var yt=Mt.createRange();yt.setStart(mt.node,mt.offset),Tt.removeAllRanges(),me>Sn?(Tt.addRange(yt),Tt.extend(dt.node,dt.offset)):(yt.setEnd(dt.node,dt.offset),Tt.addRange(yt))}}}}for(Mt=[],Tt=$;Tt=Tt.parentNode;)Tt.nodeType===1&&Mt.push({element:Tt,left:Tt.scrollLeft,top:Tt.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<Mt.length;$++){var Nt=Mt[$];Nt.element.scrollLeft=Nt.left,Nt.element.scrollTop=Nt.top}}L0=!!$g,tp=$g=null}finally{he=b,I.p=h,U.T=f}}e.current=a,Cn=2}}function Ql(){if(Cn===2){Cn=0;var e=ar,a=mi,f=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||f){f=U.T,U.T=null;var h=I.p;I.p=2;var b=he;he|=4;try{Fs(e,a.alternate,a)}finally{he=b,I.p=h,U.T=f}}Cn=3}}function ds(){if(Cn===4||Cn===3){Cn=0,Fe();var e=ar,a=mi,f=Xi,h=Lc;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Cn=5:(Cn=0,mi=ar=null,bt(e,e.pendingLanes));var b=e.pendingLanes;if(b===0&&(Bi=null),Jn(f),a=a.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(Ot,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=U.T,b=I.p,I.p=2,U.T=null;try{for(var w=e.onRecoverableError,q=0;q<h.length;q++){var $=h[q];w($.value,{componentStack:$.stack})}}finally{U.T=a,I.p=b}}(Xi&3)!==0&&pt(),ps(e),b=e.pendingLanes,(f&261930)!==0&&(b&42)!==0?e===sl?rl++:(rl=0,sl=e):rl=0,jh(0)}}function bt(e,a){(e.pooledCacheLanes&=a)===0&&(a=e.pooledCache,a!=null&&(e.pooledCache=null,jl(a)))}function pt(){return ca(),Ql(),ds(),Ct()}function Ct(){if(Cn!==5)return!1;var e=ar,a=al;al=0;var f=Jn(Xi),h=U.T,b=I.p;try{I.p=32>f?32:f,U.T=null,f=Ci,Ci=null;var w=ar,q=Xi;if(Cn=0,mi=ar=null,Xi=0,(he&6)!==0)throw Error(i(331));var $=he;if(he|=4,nr(w.current),ua(w,w.current,q,f),he=$,jh(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(Ot,w)}catch{}return!0}finally{I.p=b,U.T=h,bt(e,a)}}function Pt(e,a,f){a=ea(f,a),a=sa(e.stateNode,a,2),e=is(e,a,2),e!==null&&(zt(e,2),ps(e))}function Ft(e,a,f){if(e.tag===3)Pt(e,e,f);else for(;a!==null;){if(a.tag===3){Pt(a,e,f);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Bi===null||!Bi.has(h))){e=ea(f,e),f=Eh(2),h=is(a,f,2),h!==null&&(E0(f,h,a,e),zt(h,2),ps(h));break}}a=a.return}}function hn(e,a,f){var h=e.pingCache;if(h===null){h=e.pingCache=new ai;var b=new Set;h.set(a,b)}else b=h.get(a),b===void 0&&(b=new Set,h.set(a,b));b.has(f)||(Vl=!0,b.add(f),e=ve.bind(null,e,a,f),a.then(e,e))}function ve(e,a,f){var h=e.pingCache;h!==null&&h.delete(a),e.pingedLanes|=e.suspendedLanes&f,e.warmLanes&=~f,Ne===e&&(Oe&f)===f&&(mn===4||mn===3&&(Oe&62914560)===Oe&&300>Me()-Dr?(he&2)===0&&sr(e,0):fn|=f,De===Oe&&(De=0)),ps(e)}function Ke(e,a){a===0&&(a=ba()),e=ta(e,a),e!==null&&(zt(e,a),ps(e))}function ri(e){var a=e.memoizedState,f=0;a!==null&&(f=a.retryLane),Ke(e,f)}function Ze(e,a){var f=0;switch(e.tag){case 31:case 13:var h=e.stateNode,b=e.memoizedState;b!==null&&(f=b.retryLane);break;case 19:h=e.stateNode;break;case 22:h=e.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(a),Ke(e,f)}function gs(e,a){return Ue(e,a)}var Pc=null,Ic=null,Vg=!1,O0=!1,Yg=!1,Xl=0;function ps(e){e!==Ic&&e.next===null&&(Ic===null?Pc=Ic=e:Ic=Ic.next=e),O0=!0,Vg||(Vg=!0,bb())}function jh(e,a){if(!Yg&&O0){Yg=!0;do for(var f=!1,h=Pc;h!==null;){if(e!==0){var b=h.pendingLanes;if(b===0)var w=0;else{var q=h.suspendedLanes,$=h.pingedLanes;w=(1<<31-be(42|e)+1)-1,w&=b&~(q&~$),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(f=!0,yv(h,w))}else w=Oe,w=La(h,h===Ne?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||cr(h,w)||(f=!0,yv(h,w));h=h.next}while(f);Yg=!1}}function Sb(){pv()}function pv(){O0=Vg=!1;var e=0;Xl!==0&&Nb()&&(e=Xl);for(var a=Me(),f=null,h=Pc;h!==null;){var b=h.next,w=mv(h,a);w===0?(h.next=null,f===null?Pc=b:f.next=b,b===null&&(Ic=f)):(f=h,(e!==0||(w&3)!==0)&&(O0=!0)),h=b}Cn!==0&&Cn!==5||jh(e),Xl!==0&&(Xl=0)}function mv(e,a){for(var f=e.suspendedLanes,h=e.pingedLanes,b=e.expirationTimes,w=e.pendingLanes&-62914561;0<w;){var q=31-be(w),$=1<<q,ot=b[q];ot===-1?(($&f)===0||($&h)!==0)&&(b[q]=Cu($,a)):ot<=a&&(e.expiredLanes|=$),w&=~$}if(a=Ne,f=Oe,f=La(e,e===a?f:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h=e.callbackNode,f===0||e===a&&(on===2||on===9)||e.cancelPendingCommit!==null)return h!==null&&h!==null&&ae(h),e.callbackNode=null,e.callbackPriority=0;if((f&3)===0||cr(e,f)){if(a=f&-f,a===e.callbackPriority)return a;switch(h!==null&&ae(h),Jn(f)){case 2:case 8:f=dn;break;case 32:f=ft;break;case 268435456:f=ct;break;default:f=ft}return h=vv.bind(null,e),f=Ue(f,h),e.callbackPriority=a,e.callbackNode=f,a}return h!==null&&h!==null&&ae(h),e.callbackPriority=2,e.callbackNode=null,2}function vv(e,a){if(Cn!==0&&Cn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var f=e.callbackNode;if(pt()&&e.callbackNode!==f)return null;var h=Oe;return h=La(e,e===Ne?h:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h===0?null:(Ur(e,h,a),mv(e,Me()),e.callbackNode!=null&&e.callbackNode===f?vv.bind(null,e):null)}function yv(e,a){if(pt())return null;Ur(e,a,!0)}function bb(){Db(function(){(he&6)!==0?Ue(en,Sb):pv()})}function Kg(){if(Xl===0){var e=Ms;e===0&&(e=sn,sn<<=1,(sn&261888)===0&&(sn=256)),Xl=e}return Xl}function Sv(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:So(""+e)}function bv(e,a){var f=a.ownerDocument.createElement("input");return f.name=a.name,f.value=a.value,e.id&&f.setAttribute("form",e.id),a.parentNode.insertBefore(f,a),e=new FormData(e),f.parentNode.removeChild(f),e}function _b(e,a,f,h,b){if(a==="submit"&&f&&f.stateNode===b){var w=Sv((b[We]||null).action),q=h.submitter;q&&(a=(a=q[We]||null)?Sv(a.formAction):q.getAttribute("formAction"),a!==null&&(w=a,q=null));var $=new Gu("action","action",null,h,b);e.push({event:$,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Xl!==0){var ot=q?bv(b,q):new FormData(b);Ac(f,{pending:!0,data:ot,method:b.method,action:w},null,ot)}}else typeof w=="function"&&($.preventDefault(),ot=q?bv(b,q):new FormData(b),Ac(f,{pending:!0,data:ot,method:b.method,action:w},w,ot))},currentTarget:b}]})}}for(var Qg=0;Qg<Ia.length;Qg++){var Xg=Ia[Qg],Eb=Xg.toLowerCase(),Cb=Xg[0].toUpperCase()+Xg.slice(1);ci(Eb,"on"+Cb)}ci($u,"onAnimationEnd"),ci(Vf,"onAnimationIteration"),ci(Pd,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(Yf,"onTransitionRun"),ci(Oi,"onTransitionStart"),ci(Id,"onTransitionCancel"),ci(Ri,"onTransitionEnd"),Zn("onMouseEnter",["mouseout","mouseover"]),Zn("onMouseLeave",["mouseout","mouseover"]),Zn("onPointerEnter",["pointerout","pointerover"]),Zn("onPointerLeave",["pointerout","pointerover"]),hr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),hr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),hr("onBeforeInput",["compositionend","keypress","textInput","paste"]),hr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),hr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),hr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Uh));function _v(e,a){a=(a&4)!==0;for(var f=0;f<e.length;f++){var h=e[f],b=h.event;h=h.listeners;t:{var w=void 0;if(a)for(var q=h.length-1;0<=q;q--){var $=h[q],ot=$.instance,St=$.currentTarget;if($=$.listener,ot!==w&&b.isPropagationStopped())break t;w=$,b.currentTarget=St;try{w(b)}catch(Rt){Ea(Rt)}b.currentTarget=null,w=ot}else for(q=0;q<h.length;q++){if($=h[q],ot=$.instance,St=$.currentTarget,$=$.listener,ot!==w&&b.isPropagationStopped())break t;w=$,b.currentTarget=St;try{w(b)}catch(Rt){Ea(Rt)}b.currentTarget=null,w=ot}}}}function qe(e,a){var f=a[Tu];f===void 0&&(f=a[Tu]=new Set);var h=e+"__bubble";f.has(h)||(Ev(a,e,2,!1),f.add(h))}function Fg(e,a,f){var h=0;a&&(h|=4),Ev(f,e,h,a)}var R0="_reactListening"+Math.random().toString(36).slice(2);function Jg(e){if(!e[R0]){e[R0]=!0,wu.forEach(function(f){f!=="selectionchange"&&(Tb.has(f)||Fg(f,!1,e),Fg(f,!0,e))});var a=e.nodeType===9?e:e.ownerDocument;a===null||a[R0]||(a[R0]=!0,Fg("selectionchange",!1,a))}}function Ev(e,a,f,h){switch(Zv(a)){case 2:var b=Wb;break;case 8:b=$b;break;default:b=fp}f=b.bind(null,a,f,e),b=void 0,!Bu||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(b=!0),h?b!==void 0?e.addEventListener(a,f,{capture:!0,passive:b}):e.addEventListener(a,f,!0):b!==void 0?e.addEventListener(a,f,{passive:b}):e.addEventListener(a,f,!1)}function Zg(e,a,f,h,b){var w=h;if((a&1)===0&&(a&2)===0&&h!==null)t:for(;;){if(h===null)return;var q=h.tag;if(q===3||q===4){var $=h.stateNode.containerInfo;if($===b)break;if(q===4)for(q=h.return;q!==null;){var ot=q.tag;if((ot===3||ot===4)&&q.stateNode.containerInfo===b)return;q=q.return}for(;$!==null;){if(q=Ir($),q===null)return;if(ot=q.tag,ot===5||ot===6||ot===26||ot===27){h=w=q;continue t}$=$.parentNode}}h=h.return}Rf(function(){var St=w,Rt=ju(f),Mt=[];t:{var Et=Kf.get(e);if(Et!==void 0){var Tt=Gu,ne=e;switch(e){case"keypress":if(bo(f)===0)break t;case"keydown":case"keyup":Tt=Df;break;case"focusin":ne="focus",Tt=Iu;break;case"focusout":ne="blur",Tt=Iu;break;case"beforeblur":case"afterblur":Tt=Iu;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Tt=Nf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Tt=Ao;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Tt=li;break;case $u:case Vf:case Pd:Tt=Kr;break;case Ri:Tt=Dd;break;case"scroll":case"scrollend":Tt=Td;break;case"wheel":Tt=Ud;break;case"copy":case"cut":case"paste":Tt=Qr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Tt=jf;break;case"toggle":case"beforetoggle":Tt=ku}var me=(a&4)!==0,Sn=!me&&(e==="scroll"||e==="scrollend"),mt=me?Et!==null?Et+"Capture":null:Et;me=[];for(var dt=St,yt;dt!==null;){var Nt=dt;if(yt=Nt.stateNode,Nt=Nt.tag,Nt!==5&&Nt!==26&&Nt!==27||yt===null||mt===null||(Nt=bl(dt,mt),Nt!=null&&me.push(Bh(dt,Nt,yt))),Sn)break;dt=dt.return}0<me.length&&(Et=new Tt(Et,ne,null,f,Rt),Mt.push({event:Et,listeners:me}))}}if((a&7)===0){t:{if(Et=e==="mouseover"||e==="pointerover",Tt=e==="mouseout"||e==="pointerout",Et&&f!==Sl&&(ne=f.relatedTarget||f.fromElement)&&(Ir(ne)||ne[Ai]))break t;if((Tt||Et)&&(Et=Rt.window===Rt?Rt:(Et=Rt.ownerDocument)?Et.defaultView||Et.parentWindow:window,Tt?(ne=f.relatedTarget||f.toElement,Tt=St,ne=ne?Ir(ne):null,ne!==null&&(Sn=l(ne),me=ne.tag,ne!==Sn||me!==5&&me!==27&&me!==6)&&(ne=null)):(Tt=null,ne=St),Tt!==ne)){if(me=Nf,Nt="onMouseLeave",mt="onMouseEnter",dt="mouse",(e==="pointerout"||e==="pointerover")&&(me=jf,Nt="onPointerLeave",mt="onPointerEnter",dt="pointer"),Sn=Tt==null?Et:ml(Tt),yt=ne==null?Et:ml(ne),Et=new me(Nt,dt+"leave",Tt,f,Rt),Et.target=Sn,Et.relatedTarget=yt,Nt=null,Ir(Rt)===St&&(me=new me(mt,dt+"enter",ne,f,Rt),me.target=yt,me.relatedTarget=Sn,Nt=me),Sn=Nt,Tt&&ne)e:{for(me=Ab,mt=Tt,dt=ne,yt=0,Nt=mt;Nt;Nt=me(Nt))yt++;Nt=0;for(var ue=dt;ue;ue=me(ue))Nt++;for(;0<yt-Nt;)mt=me(mt),yt--;for(;0<Nt-yt;)dt=me(dt),Nt--;for(;yt--;){if(mt===dt||dt!==null&&mt===dt.alternate){me=mt;break e}mt=me(mt),dt=me(dt)}me=null}else me=null;Tt!==null&&Cv(Mt,Et,Tt,me,!1),ne!==null&&Sn!==null&&Cv(Mt,Sn,ne,me,!0)}}t:{if(Et=St?ml(St):window,Tt=Et.nodeName&&Et.nodeName.toLowerCase(),Tt==="select"||Tt==="input"&&Et.type==="file")var an=Xu;else if(Pa(Et))if(Lf)an=Lg;else{an=Dn;var re=Do}else Tt=Et.nodeName,!Tt||Tt.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?St&&Du(St.elementType)&&(an=Xu):an=zg;if(an&&(an=an(e,St))){Qu(Mt,an,f,Rt);break t}re&&re(e,Et,St),e==="focusout"&&St&&Et.type==="number"&&St.memoizedProps.value!=null&&Ef(Et,"number",Et.value)}switch(re=St?ml(St):window,e){case"focusin":(Pa(re)||re.contentEditable==="true")&&(Ts=re,jo=St,As=null);break;case"focusout":As=jo=Ts=null;break;case"mousedown":wl=!0;break;case"contextmenu":case"mouseup":case"dragend":wl=!1,kf(Mt,f,Rt);break;case"selectionchange":if(If)break;case"keydown":case"keyup":kf(Mt,f,Rt)}var je;if(qu)t:{switch(e){case"compositionstart":var Ve="onCompositionStart";break t;case"compositionend":Ve="onCompositionEnd";break t;case"compositionupdate":Ve="onCompositionUpdate";break t}Ve=void 0}else Xr?Ku(e,f)&&(Ve="onCompositionEnd"):e==="keydown"&&f.keyCode===229&&(Ve="onCompositionStart");Ve&&(Vu&&f.locale!=="ko"&&(Xr||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&Xr&&(je=xf()):(gr=Rt,zu="value"in gr?gr.value:gr.textContent,Xr=!0)),re=x0(St,Ve),0<re.length&&(Ve=new wo(Ve,e,null,f,Rt),Mt.push({event:Ve,listeners:re}),je?Ve.data=je:(je=Oo(f),je!==null&&(Ve.data=je)))),(je=zd?Ld(e,f):zf(e,f))&&(Ve=x0(St,"onBeforeInput"),0<Ve.length&&(re=new wo("onBeforeInput","beforeinput",null,f,Rt),Mt.push({event:re,listeners:Ve}),re.data=je)),_b(Mt,e,St,f,Rt)}_v(Mt,a)})}function Bh(e,a,f){return{instance:e,listener:a,currentTarget:f}}function x0(e,a){for(var f=a+"Capture",h=[];e!==null;){var b=e,w=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||w===null||(b=bl(e,f),b!=null&&h.unshift(Bh(e,b,w)),b=bl(e,a),b!=null&&h.push(Bh(e,b,w))),e.tag===3)return h;e=e.return}return[]}function Ab(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Cv(e,a,f,h,b){for(var w=a._reactName,q=[];f!==null&&f!==h;){var $=f,ot=$.alternate,St=$.stateNode;if($=$.tag,ot!==null&&ot===h)break;$!==5&&$!==26&&$!==27||St===null||(ot=St,b?(St=bl(f,w),St!=null&&q.unshift(Bh(f,St,ot))):b||(St=bl(f,w),St!=null&&q.push(Bh(f,St,ot)))),f=f.return}q.length!==0&&e.push({event:a,listeners:q})}var wb=/\r\n?/g,Ob=/\u0000|\uFFFD/g;function Tv(e){return(typeof e=="string"?e:""+e).replace(wb,`
`).replace(Ob,"")}function Av(e,a){return a=Tv(a),Tv(e)===a}function yn(e,a,f,h,b,w){switch(f){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||qr(e,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&qr(e,""+h);break;case"className":fa(e,"class",h);break;case"tabIndex":fa(e,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":fa(e,f,h);break;case"style":wf(e,h,w);break;case"data":if(a!=="object"){fa(e,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||f!=="href")){e.removeAttribute(f);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(f);break}h=So(""+h),e.setAttribute(f,h);break;case"action":case"formAction":if(typeof h=="function"){e.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(f==="formAction"?(a!=="input"&&yn(e,a,"name",b.name,b,null),yn(e,a,"formEncType",b.formEncType,b,null),yn(e,a,"formMethod",b.formMethod,b,null),yn(e,a,"formTarget",b.formTarget,b,null)):(yn(e,a,"encType",b.encType,b,null),yn(e,a,"method",b.method,b,null),yn(e,a,"target",b.target,b,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(f);break}h=So(""+h),e.setAttribute(f,h);break;case"onClick":h!=null&&(e.onclick=Hi);break;case"onScroll":h!=null&&qe("scroll",e);break;case"onScrollEnd":h!=null&&qe("scrollend",e);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(f=h.__html,f!=null){if(b.children!=null)throw Error(i(60));e.innerHTML=f}}break;case"multiple":e.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":e.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){e.removeAttribute("xlink:href");break}f=So(""+h),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,""+h):e.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,""):e.removeAttribute(f);break;case"capture":case"download":h===!0?e.setAttribute(f,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,h):e.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?e.setAttribute(f,h):e.removeAttribute(f);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?e.removeAttribute(f):e.setAttribute(f,h);break;case"popover":qe("beforetoggle",e),qe("toggle",e),yl(e,"popover",h);break;case"xlinkActuate":ha(e,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":ha(e,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":ha(e,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":ha(e,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":ha(e,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":ha(e,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":ha(e,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":ha(e,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":ha(e,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":yl(e,"is",h);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Cd.get(f)||f,yl(e,f,h))}}function Wg(e,a,f,h,b,w){switch(f){case"style":wf(e,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(f=h.__html,f!=null){if(b.children!=null)throw Error(i(60));e.innerHTML=f}}break;case"children":typeof h=="string"?qr(e,h):(typeof h=="number"||typeof h=="bigint")&&qr(e,""+h);break;case"onScroll":h!=null&&qe("scroll",e);break;case"onScrollEnd":h!=null&&qe("scrollend",e);break;case"onClick":h!=null&&(e.onclick=Hi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ou.hasOwnProperty(f))t:{if(f[0]==="o"&&f[1]==="n"&&(b=f.endsWith("Capture"),a=f.slice(2,b?f.length-7:void 0),w=e[We]||null,w=w!=null?w[f]:null,typeof w=="function"&&e.removeEventListener(a,w,b),typeof h=="function")){typeof w!="function"&&w!==null&&(f in e?e[f]=null:e.hasAttribute(f)&&e.removeAttribute(f)),e.addEventListener(a,h,b);break t}f in e?e[f]=h:h===!0?e.setAttribute(f,""):yl(e,f,h)}}}function zi(e,a,f){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qe("error",e),qe("load",e);var h=!1,b=!1,w;for(w in f)if(f.hasOwnProperty(w)){var q=f[w];if(q!=null)switch(w){case"src":h=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:yn(e,a,w,q,f,null)}}b&&yn(e,a,"srcSet",f.srcSet,f,null),h&&yn(e,a,"src",f.src,f,null);return;case"input":qe("invalid",e);var $=w=q=b=null,ot=null,St=null;for(h in f)if(f.hasOwnProperty(h)){var Rt=f[h];if(Rt!=null)switch(h){case"name":b=Rt;break;case"type":q=Rt;break;case"checked":ot=Rt;break;case"defaultChecked":St=Rt;break;case"value":w=Rt;break;case"defaultValue":$=Rt;break;case"children":case"dangerouslySetInnerHTML":if(Rt!=null)throw Error(i(137,a));break;default:yn(e,a,h,Rt,f,null)}}_f(e,w,$,ot,St,q,b,!1);return;case"select":qe("invalid",e),h=q=w=null;for(b in f)if(f.hasOwnProperty(b)&&($=f[b],$!=null))switch(b){case"value":w=$;break;case"defaultValue":q=$;break;case"multiple":h=$;default:yn(e,a,b,$,f,null)}a=w,f=q,e.multiple=!!h,a!=null?bs(e,!!h,a,!1):f!=null&&bs(e,!!h,f,!0);return;case"textarea":qe("invalid",e),w=b=h=null;for(q in f)if(f.hasOwnProperty(q)&&($=f[q],$!=null))switch(q){case"value":h=$;break;case"defaultValue":b=$;break;case"children":w=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(i(91));break;default:yn(e,a,q,$,f,null)}Tf(e,h,b,w);return;case"option":for(ot in f)if(f.hasOwnProperty(ot)&&(h=f[ot],h!=null))switch(ot){case"selected":e.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:yn(e,a,ot,h,f,null)}return;case"dialog":qe("beforetoggle",e),qe("toggle",e),qe("cancel",e),qe("close",e);break;case"iframe":case"object":qe("load",e);break;case"video":case"audio":for(h=0;h<Uh.length;h++)qe(Uh[h],e);break;case"image":qe("error",e),qe("load",e);break;case"details":qe("toggle",e);break;case"embed":case"source":case"link":qe("error",e),qe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(St in f)if(f.hasOwnProperty(St)&&(h=f[St],h!=null))switch(St){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:yn(e,a,St,h,f,null)}return;default:if(Du(a)){for(Rt in f)f.hasOwnProperty(Rt)&&(h=f[Rt],h!==void 0&&Wg(e,a,Rt,h,f,void 0));return}}for($ in f)f.hasOwnProperty($)&&(h=f[$],h!=null&&yn(e,a,$,h,f,null))}function Rb(e,a,f,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,w=null,q=null,$=null,ot=null,St=null,Rt=null;for(Tt in f){var Mt=f[Tt];if(f.hasOwnProperty(Tt)&&Mt!=null)switch(Tt){case"checked":break;case"value":break;case"defaultValue":ot=Mt;default:h.hasOwnProperty(Tt)||yn(e,a,Tt,null,h,Mt)}}for(var Et in h){var Tt=h[Et];if(Mt=f[Et],h.hasOwnProperty(Et)&&(Tt!=null||Mt!=null))switch(Et){case"type":w=Tt;break;case"name":b=Tt;break;case"checked":St=Tt;break;case"defaultChecked":Rt=Tt;break;case"value":q=Tt;break;case"defaultValue":$=Tt;break;case"children":case"dangerouslySetInnerHTML":if(Tt!=null)throw Error(i(137,a));break;default:Tt!==Mt&&yn(e,a,Et,Tt,h,Mt)}}yo(e,q,$,ot,St,Rt,w,b);return;case"select":Tt=q=$=Et=null;for(w in f)if(ot=f[w],f.hasOwnProperty(w)&&ot!=null)switch(w){case"value":break;case"multiple":Tt=ot;default:h.hasOwnProperty(w)||yn(e,a,w,null,h,ot)}for(b in h)if(w=h[b],ot=f[b],h.hasOwnProperty(b)&&(w!=null||ot!=null))switch(b){case"value":Et=w;break;case"defaultValue":$=w;break;case"multiple":q=w;default:w!==ot&&yn(e,a,b,w,h,ot)}a=$,f=q,h=Tt,Et!=null?bs(e,!!f,Et,!1):!!h!=!!f&&(a!=null?bs(e,!!f,a,!0):bs(e,!!f,f?[]:"",!1));return;case"textarea":Tt=Et=null;for($ in f)if(b=f[$],f.hasOwnProperty($)&&b!=null&&!h.hasOwnProperty($))switch($){case"value":break;case"children":break;default:yn(e,a,$,null,h,b)}for(q in h)if(b=h[q],w=f[q],h.hasOwnProperty(q)&&(b!=null||w!=null))switch(q){case"value":Et=b;break;case"defaultValue":Tt=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(i(91));break;default:b!==w&&yn(e,a,q,b,h,w)}Cf(e,Et,Tt);return;case"option":for(var ne in f)if(Et=f[ne],f.hasOwnProperty(ne)&&Et!=null&&!h.hasOwnProperty(ne))switch(ne){case"selected":e.selected=!1;break;default:yn(e,a,ne,null,h,Et)}for(ot in h)if(Et=h[ot],Tt=f[ot],h.hasOwnProperty(ot)&&Et!==Tt&&(Et!=null||Tt!=null))switch(ot){case"selected":e.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:yn(e,a,ot,Et,h,Tt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var me in f)Et=f[me],f.hasOwnProperty(me)&&Et!=null&&!h.hasOwnProperty(me)&&yn(e,a,me,null,h,Et);for(St in h)if(Et=h[St],Tt=f[St],h.hasOwnProperty(St)&&Et!==Tt&&(Et!=null||Tt!=null))switch(St){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(i(137,a));break;default:yn(e,a,St,Et,h,Tt)}return;default:if(Du(a)){for(var Sn in f)Et=f[Sn],f.hasOwnProperty(Sn)&&Et!==void 0&&!h.hasOwnProperty(Sn)&&Wg(e,a,Sn,void 0,h,Et);for(Rt in h)Et=h[Rt],Tt=f[Rt],!h.hasOwnProperty(Rt)||Et===Tt||Et===void 0&&Tt===void 0||Wg(e,a,Rt,Et,h,Tt);return}}for(var mt in f)Et=f[mt],f.hasOwnProperty(mt)&&Et!=null&&!h.hasOwnProperty(mt)&&yn(e,a,mt,null,h,Et);for(Mt in h)Et=h[Mt],Tt=f[Mt],!h.hasOwnProperty(Mt)||Et===Tt||Et==null&&Tt==null||yn(e,a,Mt,Et,h,Tt)}function wv(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function xb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,a=0,f=performance.getEntriesByType("resource"),h=0;h<f.length;h++){var b=f[h],w=b.transferSize,q=b.initiatorType,$=b.duration;if(w&&$&&wv(q)){for(q=0,$=b.responseEnd,h+=1;h<f.length;h++){var ot=f[h],St=ot.startTime;if(St>$)break;var Rt=ot.transferSize,Mt=ot.initiatorType;Rt&&wv(Mt)&&(ot=ot.responseEnd,q+=Rt*(ot<$?1:($-St)/(ot-St)))}if(--h,a+=8*(w+q)/(b.duration/1e3),e++,10<e)break}}if(0<e)return a/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var $g=null,tp=null;function N0(e){return e.nodeType===9?e:e.ownerDocument}function Ov(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Rv(e,a){if(e===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&a==="foreignObject"?0:e}function ep(e,a){return e==="textarea"||e==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var np=null;function Nb(){var e=window.event;return e&&e.type==="popstate"?e===np?!1:(np=e,!0):(np=null,!1)}var xv=typeof setTimeout=="function"?setTimeout:void 0,Mb=typeof clearTimeout=="function"?clearTimeout:void 0,Nv=typeof Promise=="function"?Promise:void 0,Db=typeof queueMicrotask=="function"?queueMicrotask:typeof Nv<"u"?function(e){return Nv.resolve(null).then(e).catch(jb)}:xv;function jb(e){setTimeout(function(){throw e})}function Fl(e){return e==="head"}function Mv(e,a){var f=a,h=0;do{var b=f.nextSibling;if(e.removeChild(f),b&&b.nodeType===8)if(f=b.data,f==="/$"||f==="/&"){if(h===0){e.removeChild(b),Yc(a);return}h--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")h++;else if(f==="html")zh(e.ownerDocument.documentElement);else if(f==="head"){f=e.ownerDocument.head,zh(f);for(var w=f.firstChild;w;){var q=w.nextSibling,$=w.nodeName;w[ys]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&w.rel.toLowerCase()==="stylesheet"||f.removeChild(w),w=q}}else f==="body"&&zh(e.ownerDocument.body);f=b}while(f);Yc(a)}function Dv(e,a){var f=e;e=0;do{var h=f.nextSibling;if(f.nodeType===1?a?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(a?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),h&&h.nodeType===8)if(f=h.data,f==="/$"){if(e===0)break;e--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||e++;f=h}while(f)}function ip(e){var a=e.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var f=a;switch(a=a.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":ip(f),Mn(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}e.removeChild(f)}}function Ub(e,a,f,h){for(;e.nodeType===1;){var b=f;if(e.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(h){if(!e[ys])switch(a){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(w=e.getAttribute("rel"),w==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(w!==b.rel||e.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||e.getAttribute("title")!==(b.title==null?null:b.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(w=e.getAttribute("src"),(w!==(b.src==null?null:b.src)||e.getAttribute("type")!==(b.type==null?null:b.type)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&w&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(a==="input"&&e.type==="hidden"){var w=b.name==null?null:""+b.name;if(b.type==="hidden"&&e.getAttribute("name")===w)return e}else return e;if(e=lr(e.nextSibling),e===null)break}return null}function Bb(e,a,f){if(a==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!f||(e=lr(e.nextSibling),e===null))return null;return e}function jv(e,a){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=lr(e.nextSibling),e===null))return null;return e}function ap(e){return e.data==="$?"||e.data==="$~"}function rp(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function zb(e,a){var f=e.ownerDocument;if(e.data==="$~")e._reactRetry=a;else if(e.data!=="$?"||f.readyState!=="loading")a();else{var h=function(){a(),f.removeEventListener("DOMContentLoaded",h)};f.addEventListener("DOMContentLoaded",h),e._reactRetry=h}}function lr(e){for(;e!=null;e=e.nextSibling){var a=e.nodeType;if(a===1||a===3)break;if(a===8){if(a=e.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return e}var sp=null;function Uv(e){e=e.nextSibling;for(var a=0;e;){if(e.nodeType===8){var f=e.data;if(f==="/$"||f==="/&"){if(a===0)return lr(e.nextSibling);a--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||a++}e=e.nextSibling}return null}function Bv(e){e=e.previousSibling;for(var a=0;e;){if(e.nodeType===8){var f=e.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(a===0)return e;a--}else f!=="/$"&&f!=="/&"||a++}e=e.previousSibling}return null}function zv(e,a,f){switch(a=N0(f),e){case"html":if(e=a.documentElement,!e)throw Error(i(452));return e;case"head":if(e=a.head,!e)throw Error(i(453));return e;case"body":if(e=a.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function zh(e){for(var a=e.attributes;a.length;)e.removeAttributeNode(a[0]);Mn(e)}var or=new Map,Lv=new Set;function M0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ol=I.d;I.d={f:Lb,r:Gb,D:Hb,C:Pb,L:Ib,m:kb,X:Vb,S:qb,M:Yb};function Lb(){var e=ol.f(),a=Kl();return e||a}function Gb(e){var a=kr(e);a!==null&&a.tag===5&&a.type==="form"?m0(a):ol.r(e)}var kc=typeof document>"u"?null:document;function Gv(e,a,f){var h=kc;if(h&&typeof a=="string"&&a){var b=Wi(a);b='link[rel="'+e+'"][href="'+b+'"]',typeof f=="string"&&(b+='[crossorigin="'+f+'"]'),Lv.has(b)||(Lv.add(b),e={rel:e,crossOrigin:f,href:a},h.querySelector(b)===null&&(a=h.createElement("link"),zi(a,"link",e),ti(a),h.head.appendChild(a)))}}function Hb(e){ol.D(e),Gv("dns-prefetch",e,null)}function Pb(e,a){ol.C(e,a),Gv("preconnect",e,a)}function Ib(e,a,f){ol.L(e,a,f);var h=kc;if(h&&e&&a){var b='link[rel="preload"][as="'+Wi(a)+'"]';a==="image"&&f&&f.imageSrcSet?(b+='[imagesrcset="'+Wi(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(b+='[imagesizes="'+Wi(f.imageSizes)+'"]')):b+='[href="'+Wi(e)+'"]';var w=b;switch(a){case"style":w=qc(e);break;case"script":w=Vc(e)}or.has(w)||(e=C({rel:"preload",href:a==="image"&&f&&f.imageSrcSet?void 0:e,as:a},f),or.set(w,e),h.querySelector(b)!==null||a==="style"&&h.querySelector(Lh(w))||a==="script"&&h.querySelector(Gh(w))||(a=h.createElement("link"),zi(a,"link",e),ti(a),h.head.appendChild(a)))}}function kb(e,a){ol.m(e,a);var f=kc;if(f&&e){var h=a&&typeof a.as=="string"?a.as:"script",b='link[rel="modulepreload"][as="'+Wi(h)+'"][href="'+Wi(e)+'"]',w=b;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Vc(e)}if(!or.has(w)&&(e=C({rel:"modulepreload",href:e},a),or.set(w,e),f.querySelector(b)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Gh(w)))return}h=f.createElement("link"),zi(h,"link",e),ti(h),f.head.appendChild(h)}}}function qb(e,a,f){ol.S(e,a,f);var h=kc;if(h&&e){var b=Ss(h).hoistableStyles,w=qc(e);a=a||"default";var q=b.get(w);if(!q){var $={loading:0,preload:null};if(q=h.querySelector(Lh(w)))$.loading=5;else{e=C({rel:"stylesheet",href:e,"data-precedence":a},f),(f=or.get(w))&&lp(e,f);var ot=q=h.createElement("link");ti(ot),zi(ot,"link",e),ot._p=new Promise(function(St,Rt){ot.onload=St,ot.onerror=Rt}),ot.addEventListener("load",function(){$.loading|=1}),ot.addEventListener("error",function(){$.loading|=2}),$.loading|=4,D0(q,a,h)}q={type:"stylesheet",instance:q,count:1,state:$},b.set(w,q)}}}function Vb(e,a){ol.X(e,a);var f=kc;if(f&&e){var h=Ss(f).hoistableScripts,b=Vc(e),w=h.get(b);w||(w=f.querySelector(Gh(b)),w||(e=C({src:e,async:!0},a),(a=or.get(b))&&op(e,a),w=f.createElement("script"),ti(w),zi(w,"link",e),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(b,w))}}function Yb(e,a){ol.M(e,a);var f=kc;if(f&&e){var h=Ss(f).hoistableScripts,b=Vc(e),w=h.get(b);w||(w=f.querySelector(Gh(b)),w||(e=C({src:e,async:!0,type:"module"},a),(a=or.get(b))&&op(e,a),w=f.createElement("script"),ti(w),zi(w,"link",e),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(b,w))}}function Hv(e,a,f,h){var b=(b=tt.current)?M0(b):null;if(!b)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(a=qc(f.href),f=Ss(b).hoistableStyles,h=f.get(a),h||(h={type:"style",instance:null,count:0,state:null},f.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){e=qc(f.href);var w=Ss(b).hoistableStyles,q=w.get(e);if(q||(b=b.ownerDocument||b,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(e,q),(w=b.querySelector(Lh(e)))&&!w._p&&(q.instance=w,q.state.loading=5),or.has(e)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},or.set(e,f),w||Kb(b,e,f,q.state))),a&&h===null)throw Error(i(528,""));return q}if(a&&h!==null)throw Error(i(529,""));return null;case"script":return a=f.async,f=f.src,typeof f=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Vc(f),f=Ss(b).hoistableScripts,h=f.get(a),h||(h={type:"script",instance:null,count:0,state:null},f.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function qc(e){return'href="'+Wi(e)+'"'}function Lh(e){return'link[rel="stylesheet"]['+e+"]"}function Pv(e){return C({},e,{"data-precedence":e.precedence,precedence:null})}function Kb(e,a,f,h){e.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=e.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),zi(a,"link",f),ti(a),e.head.appendChild(a))}function Vc(e){return'[src="'+Wi(e)+'"]'}function Gh(e){return"script[async]"+e}function Iv(e,a,f){if(a.count++,a.instance===null)switch(a.type){case"style":var h=e.querySelector('style[data-href~="'+Wi(f.href)+'"]');if(h)return a.instance=h,ti(h),h;var b=C({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return h=(e.ownerDocument||e).createElement("style"),ti(h),zi(h,"style",b),D0(h,f.precedence,e),a.instance=h;case"stylesheet":b=qc(f.href);var w=e.querySelector(Lh(b));if(w)return a.state.loading|=4,a.instance=w,ti(w),w;h=Pv(f),(b=or.get(b))&&lp(h,b),w=(e.ownerDocument||e).createElement("link"),ti(w);var q=w;return q._p=new Promise(function($,ot){q.onload=$,q.onerror=ot}),zi(w,"link",h),a.state.loading|=4,D0(w,f.precedence,e),a.instance=w;case"script":return w=Vc(f.src),(b=e.querySelector(Gh(w)))?(a.instance=b,ti(b),b):(h=f,(b=or.get(w))&&(h=C({},f),op(h,b)),e=e.ownerDocument||e,b=e.createElement("script"),ti(b),zi(b,"link",h),e.head.appendChild(b),a.instance=b);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,D0(h,f.precedence,e));return a.instance}function D0(e,a,f){for(var h=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=h.length?h[h.length-1]:null,w=b,q=0;q<h.length;q++){var $=h[q];if($.dataset.precedence===a)w=$;else if(w!==b)break}w?w.parentNode.insertBefore(e,w.nextSibling):(a=f.nodeType===9?f.head:f,a.insertBefore(e,a.firstChild))}function lp(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.title==null&&(e.title=a.title)}function op(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.integrity==null&&(e.integrity=a.integrity)}var j0=null;function kv(e,a,f){if(j0===null){var h=new Map,b=j0=new Map;b.set(f,h)}else b=j0,h=b.get(f),h||(h=new Map,b.set(f,h));if(h.has(e))return h;for(h.set(e,null),f=f.getElementsByTagName(e),b=0;b<f.length;b++){var w=f[b];if(!(w[ys]||w[xe]||e==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var q=w.getAttribute(a)||"";q=e+q;var $=h.get(q);$?$.push(w):h.set(q,[w])}}return h}function qv(e,a,f){e=e.ownerDocument||e,e.head.insertBefore(f,a==="title"?e.querySelector("head > title"):null)}function Qb(e,a,f){if(f===1||a.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return e=a.disabled,typeof a.precedence=="string"&&e==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Vv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Xb(e,a,f,h){if(f.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var b=qc(h.href),w=a.querySelector(Lh(b));if(w){a=w._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(e.count++,e=U0.bind(e),a.then(e,e)),f.state.loading|=4,f.instance=w,ti(w);return}w=a.ownerDocument||a,h=Pv(h),(b=or.get(b))&&lp(h,b),w=w.createElement("link"),ti(w);var q=w;q._p=new Promise(function($,ot){q.onload=$,q.onerror=ot}),zi(w,"link",h),f.instance=w}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(f,a),(a=f.state.preload)&&(f.state.loading&3)===0&&(e.count++,f=U0.bind(e),a.addEventListener("load",f),a.addEventListener("error",f))}}var up=0;function Fb(e,a){return e.stylesheets&&e.count===0&&z0(e,e.stylesheets),0<e.count||0<e.imgCount?function(f){var h=setTimeout(function(){if(e.stylesheets&&z0(e,e.stylesheets),e.unsuspend){var w=e.unsuspend;e.unsuspend=null,w()}},6e4+a);0<e.imgBytes&&up===0&&(up=62500*xb());var b=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&z0(e,e.stylesheets),e.unsuspend)){var w=e.unsuspend;e.unsuspend=null,w()}},(e.imgBytes>up?50:800)+a);return e.unsuspend=f,function(){e.unsuspend=null,clearTimeout(h),clearTimeout(b)}}:null}function U0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)z0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var B0=null;function z0(e,a){e.stylesheets=null,e.unsuspend!==null&&(e.count++,B0=new Map,a.forEach(Jb,e),B0=null,U0.call(e))}function Jb(e,a){if(!(a.state.loading&4)){var f=B0.get(e);if(f)var h=f.get(null);else{f=new Map,B0.set(e,f);for(var b=e.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<b.length;w++){var q=b[w];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(f.set(q.dataset.precedence,q),h=q)}h&&f.set(null,h)}b=a.instance,q=b.getAttribute("data-precedence"),w=f.get(q)||h,w===h&&f.set(null,b),f.set(q,b),this.count++,h=U0.bind(this),b.addEventListener("load",h),b.addEventListener("error",h),w?w.parentNode.insertBefore(b,w.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(b,e.firstChild)),a.state.loading|=4}}var Hh={$$typeof:N,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function Zb(e,a,f,h,b,w,q,$,ot){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fr(0),this.hiddenUpdates=fr(null),this.identifierPrefix=h,this.onUncaughtError=b,this.onCaughtError=w,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ot,this.incompleteTransitions=new Map}function Yv(e,a,f,h,b,w,q,$,ot,St,Rt,Mt){return e=new Zb(e,a,f,q,ot,St,Rt,Mt,$),a=1,w===!0&&(a|=24),w=bi(3,null,null,a),e.current=w,w.stateNode=e,a=lc(),a.refCount++,e.pooledCache=a,a.refCount++,w.memoizedState={element:h,isDehydrated:f,cache:a},Ls(w),e}function Kv(e){return e?(e=ka,e):ka}function Qv(e,a,f,h,b,w){b=Kv(b),h.context===null?h.context=b:h.pendingContext=b,h=ns(a),h.payload={element:f},w=w===void 0?null:w,w!==null&&(h.callback=w),f=is(e,h,a),f!==null&&(nn(f,e,a),Yo(f,e,a))}function Xv(e,a){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var f=e.retryLane;e.retryLane=f!==0&&f<a?f:a}}function cp(e,a){Xv(e,a),(e=e.alternate)&&Xv(e,a)}function Fv(e){if(e.tag===13||e.tag===31){var a=ta(e,67108864);a!==null&&nn(a,e,67108864),cp(e,67108864)}}function Jv(e){if(e.tag===13||e.tag===31){var a=Ti();a=ze(a);var f=ta(e,a);f!==null&&nn(f,e,a),cp(e,a)}}var L0=!0;function Wb(e,a,f,h){var b=U.T;U.T=null;var w=I.p;try{I.p=2,fp(e,a,f,h)}finally{I.p=w,U.T=b}}function $b(e,a,f,h){var b=U.T;U.T=null;var w=I.p;try{I.p=8,fp(e,a,f,h)}finally{I.p=w,U.T=b}}function fp(e,a,f,h){if(L0){var b=hp(h);if(b===null)Zg(e,a,h,G0,f),Wv(e,h);else if(e4(b,e,a,f,h))h.stopPropagation();else if(Wv(e,h),a&4&&-1<t4.indexOf(e)){for(;b!==null;){var w=kr(b);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var q=Zi(w.pendingLanes);if(q!==0){var $=w;for($.pendingLanes|=2,$.entangledLanes|=2;q;){var ot=1<<31-be(q);$.entanglements[1]|=ot,q&=~ot}ps(w),(he&6)===0&&(Sa=Me()+500,jh(0))}}break;case 31:case 13:$=ta(w,2),$!==null&&nn($,w,2),Kl(),cp(w,2)}if(w=hp(h),w===null&&Zg(e,a,h,G0,f),w===b)break;b=w}b!==null&&h.stopPropagation()}else Zg(e,a,h,null,f)}}function hp(e){return e=ju(e),dp(e)}var G0=null;function dp(e){if(G0=null,e=Ir(e),e!==null){var a=l(e);if(a===null)e=null;else{var f=a.tag;if(f===13){if(e=c(a),e!==null)return e;e=null}else if(f===31){if(e=d(a),e!==null)return e;e=null}else if(f===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;e=null}else a!==e&&(e=null)}}return G0=e,null}function Zv(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(He()){case en:return 2;case dn:return 8;case ft:case ht:return 32;case ct:return 268435456;default:return 32}default:return 32}}var gp=!1,Jl=null,Zl=null,Wl=null,Ph=new Map,Ih=new Map,$l=[],t4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Wv(e,a){switch(e){case"focusin":case"focusout":Jl=null;break;case"dragenter":case"dragleave":Zl=null;break;case"mouseover":case"mouseout":Wl=null;break;case"pointerover":case"pointerout":Ph.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ih.delete(a.pointerId)}}function kh(e,a,f,h,b,w){return e===null||e.nativeEvent!==w?(e={blockedOn:a,domEventName:f,eventSystemFlags:h,nativeEvent:w,targetContainers:[b]},a!==null&&(a=kr(a),a!==null&&Fv(a)),e):(e.eventSystemFlags|=h,a=e.targetContainers,b!==null&&a.indexOf(b)===-1&&a.push(b),e)}function e4(e,a,f,h,b){switch(a){case"focusin":return Jl=kh(Jl,e,a,f,h,b),!0;case"dragenter":return Zl=kh(Zl,e,a,f,h,b),!0;case"mouseover":return Wl=kh(Wl,e,a,f,h,b),!0;case"pointerover":var w=b.pointerId;return Ph.set(w,kh(Ph.get(w)||null,e,a,f,h,b)),!0;case"gotpointercapture":return w=b.pointerId,Ih.set(w,kh(Ih.get(w)||null,e,a,f,h,b)),!0}return!1}function $v(e){var a=Ir(e.target);if(a!==null){var f=l(a);if(f!==null){if(a=f.tag,a===13){if(a=c(f),a!==null){e.blockedOn=a,ie(e.priority,function(){Jv(f)});return}}else if(a===31){if(a=d(f),a!==null){e.blockedOn=a,ie(e.priority,function(){Jv(f)});return}}else if(a===3&&f.stateNode.current.memoizedState.isDehydrated){e.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}e.blockedOn=null}function H0(e){if(e.blockedOn!==null)return!1;for(var a=e.targetContainers;0<a.length;){var f=hp(e.nativeEvent);if(f===null){f=e.nativeEvent;var h=new f.constructor(f.type,f);Sl=h,f.target.dispatchEvent(h),Sl=null}else return a=kr(f),a!==null&&Fv(a),e.blockedOn=f,!1;a.shift()}return!0}function ty(e,a,f){H0(e)&&f.delete(a)}function n4(){gp=!1,Jl!==null&&H0(Jl)&&(Jl=null),Zl!==null&&H0(Zl)&&(Zl=null),Wl!==null&&H0(Wl)&&(Wl=null),Ph.forEach(ty),Ih.forEach(ty)}function P0(e,a){e.blockedOn===a&&(e.blockedOn=null,gp||(gp=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,n4)))}var I0=null;function ey(e){I0!==e&&(I0=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){I0===e&&(I0=null);for(var a=0;a<e.length;a+=3){var f=e[a],h=e[a+1],b=e[a+2];if(typeof h!="function"){if(dp(h||f)===null)continue;break}var w=kr(f);w!==null&&(e.splice(a,3),a-=3,Ac(w,{pending:!0,data:b,method:f.method,action:h},h,b))}}))}function Yc(e){function a(ot){return P0(ot,e)}Jl!==null&&P0(Jl,e),Zl!==null&&P0(Zl,e),Wl!==null&&P0(Wl,e),Ph.forEach(a),Ih.forEach(a);for(var f=0;f<$l.length;f++){var h=$l[f];h.blockedOn===e&&(h.blockedOn=null)}for(;0<$l.length&&(f=$l[0],f.blockedOn===null);)$v(f),f.blockedOn===null&&$l.shift();if(f=(e.ownerDocument||e).$$reactFormReplay,f!=null)for(h=0;h<f.length;h+=3){var b=f[h],w=f[h+1],q=b[We]||null;if(typeof w=="function")q||ey(f);else if(q){var $=null;if(w&&w.hasAttribute("formAction")){if(b=w,q=w[We]||null)$=q.formAction;else if(dp(b)!==null)continue}else $=q.action;typeof $=="function"?f[h+1]=$:(f.splice(h,3),h-=3),ey(f)}}}function ny(){function e(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(q){return b=q})},focusReset:"manual",scroll:"manual"})}function a(){b!==null&&(b(),b=null),h||setTimeout(f,20)}function f(){if(!h&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,b=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(f,100),function(){h=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),b!==null&&(b(),b=null)}}}function pp(e){this._internalRoot=e}k0.prototype.render=pp.prototype.render=function(e){var a=this._internalRoot;if(a===null)throw Error(i(409));var f=a.current,h=Ti();Qv(f,h,e,a,null,null)},k0.prototype.unmount=pp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var a=e.containerInfo;Qv(e.current,2,null,e,null,null),Kl(),a[Ai]=null}};function k0(e){this._internalRoot=e}k0.prototype.unstable_scheduleHydration=function(e){if(e){var a=Kt();e={blockedOn:null,target:e,priority:a};for(var f=0;f<$l.length&&a!==0&&a<$l[f].priority;f++);$l.splice(f,0,e),f===0&&$v(e)}};var iy=t.version;if(iy!=="19.2.0")throw Error(i(527,iy,"19.2.0"));I.findDOMNode=function(e){var a=e._reactInternals;if(a===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(a),e=e!==null?_(e):null,e=e===null?null:e.stateNode,e};var i4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var q0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q0.isDisabled&&q0.supportsFiber)try{Ot=q0.inject(i4),Gt=q0}catch{}}return Vh.createRoot=function(e,a){if(!r(e))throw Error(i(299));var f=!1,h="",b=Wo,w=$o,q=Oc;return a!=null&&(a.unstable_strictMode===!0&&(f=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(b=a.onUncaughtError),a.onCaughtError!==void 0&&(w=a.onCaughtError),a.onRecoverableError!==void 0&&(q=a.onRecoverableError)),a=Yv(e,1,!1,null,null,f,h,null,b,w,q,ny),e[Ai]=a.current,Jg(e),new pp(a)},Vh.hydrateRoot=function(e,a,f){if(!r(e))throw Error(i(299));var h=!1,b="",w=Wo,q=$o,$=Oc,ot=null;return f!=null&&(f.unstable_strictMode===!0&&(h=!0),f.identifierPrefix!==void 0&&(b=f.identifierPrefix),f.onUncaughtError!==void 0&&(w=f.onUncaughtError),f.onCaughtError!==void 0&&(q=f.onCaughtError),f.onRecoverableError!==void 0&&($=f.onRecoverableError),f.formState!==void 0&&(ot=f.formState)),a=Yv(e,1,!0,a,f??null,h,b,ot,w,q,$,ny),a.context=Kv(null),f=a.current,h=Ti(),h=ze(h),b=ns(h),b.callback=null,is(f,b,h),f=h,a.current.lanes=f,zt(a,f),ps(a),e[Ai]=a.current,Jg(e),new k0(a)},Vh.version="19.2.0",Vh}var dy;function g4(){if(dy)return yp.exports;dy=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),yp.exports=d4(),yp.exports}var p4=g4();const m4=hf(p4);y2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function od(){return od=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},od.apply(this,arguments)}var oo;(function(o){o.Pop="POP",o.Push="PUSH",o.Replace="REPLACE"})(oo||(oo={}));const gy="popstate";function v4(o){o===void 0&&(o={});function t(i,r){let{pathname:l,search:c,hash:d}=i.location;return Em("",{pathname:l,search:c,hash:d},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:b2(r)}return S4(t,n,null,o)}function yi(o,t){if(o===!1||o===null||typeof o>"u")throw new Error(t)}function S2(o,t){if(!o){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function y4(){return Math.random().toString(36).substr(2,8)}function py(o,t){return{usr:o.state,key:o.key,idx:t}}function Em(o,t,n,i){return n===void 0&&(n=null),od({pathname:typeof o=="string"?o:o.pathname,search:"",hash:""},typeof t=="string"?df(t):t,{state:n,key:t&&t.key||i||y4()})}function b2(o){let{pathname:t="/",search:n="",hash:i=""}=o;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function df(o){let t={};if(o){let n=o.indexOf("#");n>=0&&(t.hash=o.substr(n),o=o.substr(0,n));let i=o.indexOf("?");i>=0&&(t.search=o.substr(i),o=o.substr(0,i)),o&&(t.pathname=o)}return t}function S4(o,t,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:l=!1}=i,c=r.history,d=oo.Pop,g=null,m=_();m==null&&(m=0,c.replaceState(od({},c.state,{idx:m}),""));function _(){return(c.state||{idx:null}).idx}function C(){d=oo.Pop;let L=_(),z=L==null?null:L-m;m=L,g&&g({action:d,location:D.location,delta:z})}function E(L,z){d=oo.Push;let M=Em(D.location,L,z);m=_()+1;let N=py(M,m),G=D.createHref(M);try{c.pushState(N,"",G)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;r.location.assign(G)}l&&g&&g({action:d,location:D.location,delta:1})}function O(L,z){d=oo.Replace;let M=Em(D.location,L,z);m=_();let N=py(M,m),G=D.createHref(M);c.replaceState(N,"",G),l&&g&&g({action:d,location:D.location,delta:0})}function v(L){let z=r.location.origin!=="null"?r.location.origin:r.location.href,M=typeof L=="string"?L:b2(L);return M=M.replace(/ $/,"%20"),yi(z,"No window.location.(origin|href) available to create URL for href: "+M),new URL(M,z)}let D={get action(){return d},get location(){return o(r,c)},listen(L){if(g)throw new Error("A history only accepts one active listener");return r.addEventListener(gy,C),g=L,()=>{r.removeEventListener(gy,C),g=null}},createHref(L){return t(r,L)},createURL:v,encodeLocation(L){let z=v(L);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:E,replace:O,go(L){return c.go(L)}};return D}var my;(function(o){o.data="data",o.deferred="deferred",o.redirect="redirect",o.error="error"})(my||(my={}));function b4(o,t,n){return n===void 0&&(n="/"),_4(o,t,n)}function _4(o,t,n,i){let r=typeof t=="string"?df(t):t,l=C2(r.pathname||"/",n);if(l==null)return null;let c=_2(o);E4(c);let d=null;for(let g=0;d==null&&g<c.length;++g){let m=U4(l);d=M4(c[g],m)}return d}function _2(o,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(l,c,d)=>{let g={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};g.relativePath.startsWith("/")&&(yi(g.relativePath.startsWith(i),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(i.length));let m=gu([i,g.relativePath]),_=n.concat(g);l.children&&l.children.length>0&&(yi(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),_2(l.children,t,_,m)),!(l.path==null&&!l.index)&&t.push({path:m,score:x4(m,l.index),routesMeta:_})};return o.forEach((l,c)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))r(l,c);else for(let g of E2(l.path))r(l,c,g)}),t}function E2(o){let t=o.split("/");if(t.length===0)return[];let[n,...i]=t,r=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return r?[l,""]:[l];let c=E2(i.join("/")),d=[];return d.push(...c.map(g=>g===""?l:[l,g].join("/"))),r&&d.push(...c),d.map(g=>o.startsWith("/")&&g===""?"/":g)}function E4(o){o.sort((t,n)=>t.score!==n.score?n.score-t.score:N4(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const C4=/^:[\w-]+$/,T4=3,A4=2,w4=1,O4=10,R4=-2,vy=o=>o==="*";function x4(o,t){let n=o.split("/"),i=n.length;return n.some(vy)&&(i+=R4),t&&(i+=A4),n.filter(r=>!vy(r)).reduce((r,l)=>r+(C4.test(l)?T4:l===""?w4:O4),i)}function N4(o,t){return o.length===t.length&&o.slice(0,-1).every((i,r)=>i===t[r])?o[o.length-1]-t[t.length-1]:0}function M4(o,t,n){let{routesMeta:i}=o,r={},l="/",c=[];for(let d=0;d<i.length;++d){let g=i[d],m=d===i.length-1,_=l==="/"?t:t.slice(l.length)||"/",C=D4({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},_),E=g.route;if(!C)return null;Object.assign(r,C.params),c.push({params:r,pathname:gu([l,C.pathname]),pathnameBase:P4(gu([l,C.pathnameBase])),route:E}),C.pathnameBase!=="/"&&(l=gu([l,C.pathnameBase]))}return c}function D4(o,t){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[n,i]=j4(o.path,o.caseSensitive,o.end),r=t.match(n);if(!r)return null;let l=r[0],c=l.replace(/(.)\/+$/,"$1"),d=r.slice(1);return{params:i.reduce((m,_,C)=>{let{paramName:E,isOptional:O}=_;if(E==="*"){let D=d[C]||"";c=l.slice(0,l.length-D.length).replace(/(.)\/+$/,"$1")}const v=d[C];return O&&!v?m[E]=void 0:m[E]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:c,pattern:o}}function j4(o,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),S2(o==="*"||!o.endsWith("*")||o.endsWith("/*"),'Route path "'+o+'" will be treated as if it were '+('"'+o.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+o.replace(/\*$/,"/*")+'".'));let i=[],r="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,g)=>(i.push({paramName:d,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(i.push({paramName:"*"}),r+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":o!==""&&o!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function U4(o){try{return o.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return S2(!1,'The URL path "'+o+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),o}}function C2(o,t){if(t==="/")return o;if(!o.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=o.charAt(n);return i&&i!=="/"?null:o.slice(n)||"/"}function B4(o,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:r=""}=typeof o=="string"?df(o):o;return{pathname:n?n.startsWith("/")?n:z4(n,t):t,search:I4(i),hash:k4(r)}}function z4(o,t){let n=t.replace(/\/+$/,"").split("/");return o.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Ep(o,t,n,i){return"Cannot include a '"+o+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function L4(o){return o.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function G4(o,t){let n=L4(o);return t?n.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function H4(o,t,n,i){i===void 0&&(i=!1);let r;typeof o=="string"?r=df(o):(r=od({},o),yi(!r.pathname||!r.pathname.includes("?"),Ep("?","pathname","search",r)),yi(!r.pathname||!r.pathname.includes("#"),Ep("#","pathname","hash",r)),yi(!r.search||!r.search.includes("#"),Ep("#","search","hash",r)));let l=o===""||r.pathname==="",c=l?"/":r.pathname,d;if(c==null)d=n;else{let C=t.length-1;if(!i&&c.startsWith("..")){let E=c.split("/");for(;E[0]==="..";)E.shift(),C-=1;r.pathname=E.join("/")}d=C>=0?t[C]:"/"}let g=B4(r,d),m=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(m||_)&&(g.pathname+="/"),g}const gu=o=>o.join("/").replace(/\/\/+/g,"/"),P4=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),I4=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,k4=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function q4(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}const T2=["post","put","patch","delete"];new Set(T2);const V4=["get",...T2];new Set(V4);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ud(){return ud=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},ud.apply(this,arguments)}const Fm=lt.createContext(null),Y4=lt.createContext(null),Cg=lt.createContext(null),Tg=lt.createContext(null),gf=lt.createContext({outlet:null,matches:[],isDataRoute:!1}),A2=lt.createContext(null);function Ag(){return lt.useContext(Tg)!=null}function Jm(){return Ag()||yi(!1),lt.useContext(Tg).location}function w2(o){lt.useContext(Cg).static||lt.useLayoutEffect(o)}function pf(){let{isDataRoute:o}=lt.useContext(gf);return o?a3():K4()}function K4(){Ag()||yi(!1);let o=lt.useContext(Fm),{basename:t,future:n,navigator:i}=lt.useContext(Cg),{matches:r}=lt.useContext(gf),{pathname:l}=Jm(),c=JSON.stringify(G4(r,n.v7_relativeSplatPath)),d=lt.useRef(!1);return w2(()=>{d.current=!0}),lt.useCallback(function(m,_){if(_===void 0&&(_={}),!d.current)return;if(typeof m=="number"){i.go(m);return}let C=H4(m,JSON.parse(c),l,_.relative==="path");o==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:gu([t,C.pathname])),(_.replace?i.replace:i.push)(C,_.state,_)},[t,i,c,l,o])}function Q4(o,t){return X4(o,t)}function X4(o,t,n,i){Ag()||yi(!1);let{navigator:r}=lt.useContext(Cg),{matches:l}=lt.useContext(gf),c=l[l.length-1],d=c?c.params:{};c&&c.pathname;let g=c?c.pathnameBase:"/";c&&c.route;let m=Jm(),_;if(t){var C;let L=typeof t=="string"?df(t):t;g==="/"||(C=L.pathname)!=null&&C.startsWith(g)||yi(!1),_=L}else _=m;let E=_.pathname||"/",O=E;if(g!=="/"){let L=g.replace(/^\//,"").split("/");O="/"+E.replace(/^\//,"").split("/").slice(L.length).join("/")}let v=b4(o,{pathname:O}),D=$4(v&&v.map(L=>Object.assign({},L,{params:Object.assign({},d,L.params),pathname:gu([g,r.encodeLocation?r.encodeLocation(L.pathname).pathname:L.pathname]),pathnameBase:L.pathnameBase==="/"?g:gu([g,r.encodeLocation?r.encodeLocation(L.pathnameBase).pathname:L.pathnameBase])})),l,n,i);return t&&D?lt.createElement(Tg.Provider,{value:{location:ud({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:oo.Pop}},D):D}function F4(){let o=i3(),t=q4(o)?o.status+" "+o.statusText:o instanceof Error?o.message:JSON.stringify(o),n=o instanceof Error?o.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return lt.createElement(lt.Fragment,null,lt.createElement("h2",null,"Unexpected Application Error!"),lt.createElement("h3",{style:{fontStyle:"italic"}},t),n?lt.createElement("pre",{style:r},n):null,null)}const J4=lt.createElement(F4,null);class Z4 extends lt.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?lt.createElement(gf.Provider,{value:this.props.routeContext},lt.createElement(A2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function W4(o){let{routeContext:t,match:n,children:i}=o,r=lt.useContext(Fm);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),lt.createElement(gf.Provider,{value:t},i)}function $4(o,t,n,i){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),o==null){var l;if(!n)return null;if(n.errors)o=n.matches;else if((l=i)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)o=n.matches;else return null}let c=o,d=(r=n)==null?void 0:r.errors;if(d!=null){let _=c.findIndex(C=>C.route.id&&(d==null?void 0:d[C.route.id])!==void 0);_>=0||yi(!1),c=c.slice(0,Math.min(c.length,_+1))}let g=!1,m=-1;if(n&&i&&i.v7_partialHydration)for(let _=0;_<c.length;_++){let C=c[_];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(m=_),C.route.id){let{loaderData:E,errors:O}=n,v=C.route.loader&&E[C.route.id]===void 0&&(!O||O[C.route.id]===void 0);if(C.route.lazy||v){g=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((_,C,E)=>{let O,v=!1,D=null,L=null;n&&(O=d&&C.route.id?d[C.route.id]:void 0,D=C.route.errorElement||J4,g&&(m<0&&E===0?(r3("route-fallback"),v=!0,L=null):m===E&&(v=!0,L=C.route.hydrateFallbackElement||null)));let z=t.concat(c.slice(0,E+1)),M=()=>{let N;return O?N=D:v?N=L:C.route.Component?N=lt.createElement(C.route.Component,null):C.route.element?N=C.route.element:N=_,lt.createElement(W4,{match:C,routeContext:{outlet:_,matches:z,isDataRoute:n!=null},children:N})};return n&&(C.route.ErrorBoundary||C.route.errorElement||E===0)?lt.createElement(Z4,{location:n.location,revalidation:n.revalidation,component:D,error:O,children:M(),routeContext:{outlet:null,matches:z,isDataRoute:!0}}):M()},null)}var O2=(function(o){return o.UseBlocker="useBlocker",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o})(O2||{}),R2=(function(o){return o.UseBlocker="useBlocker",o.UseLoaderData="useLoaderData",o.UseActionData="useActionData",o.UseRouteError="useRouteError",o.UseNavigation="useNavigation",o.UseRouteLoaderData="useRouteLoaderData",o.UseMatches="useMatches",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o.UseRouteId="useRouteId",o})(R2||{});function t3(o){let t=lt.useContext(Fm);return t||yi(!1),t}function e3(o){let t=lt.useContext(Y4);return t||yi(!1),t}function n3(o){let t=lt.useContext(gf);return t||yi(!1),t}function x2(o){let t=n3(),n=t.matches[t.matches.length-1];return n.route.id||yi(!1),n.route.id}function i3(){var o;let t=lt.useContext(A2),n=e3(),i=x2();return t!==void 0?t:(o=n.errors)==null?void 0:o[i]}function a3(){let{router:o}=t3(O2.UseNavigateStable),t=x2(R2.UseNavigateStable),n=lt.useRef(!1);return w2(()=>{n.current=!0}),lt.useCallback(function(r,l){l===void 0&&(l={}),n.current&&(typeof r=="number"?o.navigate(r):o.navigate(r,ud({fromRouteId:t},l)))},[o,t])}const yy={};function r3(o,t,n){yy[o]||(yy[o]=!0)}function s3(o,t){o==null||o.v7_startTransition,o==null||o.v7_relativeSplatPath}function ou(o){yi(!1)}function l3(o){let{basename:t="/",children:n=null,location:i,navigationType:r=oo.Pop,navigator:l,static:c=!1,future:d}=o;Ag()&&yi(!1);let g=t.replace(/^\/*/,"/"),m=lt.useMemo(()=>({basename:g,navigator:l,static:c,future:ud({v7_relativeSplatPath:!1},d)}),[g,d,l,c]);typeof i=="string"&&(i=df(i));let{pathname:_="/",search:C="",hash:E="",state:O=null,key:v="default"}=i,D=lt.useMemo(()=>{let L=C2(_,g);return L==null?null:{location:{pathname:L,search:C,hash:E,state:O,key:v},navigationType:r}},[g,_,C,E,O,v,r]);return D==null?null:lt.createElement(Cg.Provider,{value:m},lt.createElement(Tg.Provider,{children:n,value:D}))}function o3(o){let{children:t,location:n}=o;return Q4(Cm(t),n)}new Promise(()=>{});function Cm(o,t){t===void 0&&(t=[]);let n=[];return lt.Children.forEach(o,(i,r)=>{if(!lt.isValidElement(i))return;let l=[...t,r];if(i.type===lt.Fragment){n.push.apply(n,Cm(i.props.children,l));return}i.type!==ou&&yi(!1),!i.props.index||!i.props.children||yi(!1);let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Cm(i.props.children,l)),n.push(c)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tm(o){return o===void 0&&(o=""),new URLSearchParams(typeof o=="string"||Array.isArray(o)||o instanceof URLSearchParams?o:Object.keys(o).reduce((t,n)=>{let i=o[n];return t.concat(Array.isArray(i)?i.map(r=>[n,r]):[[n,i]])},[]))}function u3(o,t){let n=Tm(o);return t&&t.forEach((i,r)=>{n.has(r)||t.getAll(r).forEach(l=>{n.append(r,l)})}),n}const c3="6";try{window.__reactRouterVersion=c3}catch{}const f3="startTransition",Sy=u4[f3];function h3(o){let{basename:t,children:n,future:i,window:r}=o,l=lt.useRef();l.current==null&&(l.current=v4({window:r,v5Compat:!0}));let c=l.current,[d,g]=lt.useState({action:c.action,location:c.location}),{v7_startTransition:m}=i||{},_=lt.useCallback(C=>{m&&Sy?Sy(()=>g(C)):g(C)},[g,m]);return lt.useLayoutEffect(()=>c.listen(_),[c,_]),lt.useEffect(()=>s3(i),[i]),lt.createElement(l3,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:c,future:i})}var by;(function(o){o.UseScrollRestoration="useScrollRestoration",o.UseSubmit="useSubmit",o.UseSubmitFetcher="useSubmitFetcher",o.UseFetcher="useFetcher",o.useViewTransitionState="useViewTransitionState"})(by||(by={}));var _y;(function(o){o.UseFetcher="useFetcher",o.UseFetchers="useFetchers",o.UseScrollRestoration="useScrollRestoration"})(_y||(_y={}));function gd(o){let t=lt.useRef(Tm(o)),n=lt.useRef(!1),i=Jm(),r=lt.useMemo(()=>u3(i.search,n.current?null:t.current),[i.search]),l=pf(),c=lt.useCallback((d,g)=>{const m=Tm(typeof d=="function"?d(r):d);n.current=!0,l("?"+m,g)},[l,r]);return[r,c]}function d3(){const o=pf(),[t,n]=lt.useState(!1),[i,r]=lt.useState(""),[l,c]=lt.useState("demo"),d=g=>{g.preventDefault(),i.trim()&&l.trim()&&o(`/student?room=${l}&name=${encodeURIComponent(i.trim())}`)};return t?k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsx("div",{className:"glass-surface landing-container",style:{maxWidth:"500px"},children:k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",style:{fontSize:"2rem"},children:"Join as Student"}),k.jsx("p",{className:"landing-description",children:"Enter your name and room code to start drawing"})]}),k.jsxs("form",{onSubmit:d,style:{width:"100%",marginTop:"2rem"},children:[k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"studentName",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Your Name"}),k.jsx("input",{id:"studentName",type:"text",value:i,onChange:g=>r(g.target.value),placeholder:"Enter your name",autoFocus:!0,required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"roomCode",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Room Code"}),k.jsx("input",{id:"roomCode",type:"text",value:l,onChange:g=>c(g.target.value.toUpperCase()),placeholder:"Enter room code",required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s",fontFamily:"monospace",letterSpacing:"2px"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[k.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"2px solid #ddd",borderRadius:"8px",background:"white",cursor:"pointer",transition:"all 0.2s"},children:" Back"}),k.jsx("button",{type:"submit",style:{flex:2,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:g=>g.target.style.transform="translateY(-2px)",onMouseOut:g=>g.target.style.transform="translateY(0)",children:"Join Room "})]})]})]})})})]}):k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsxs("div",{className:"glass-surface landing-container",children:[k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",children:"Teach visually. Collaborate instantly."}),k.jsx("p",{className:"landing-description",children:"Feather streams pencil-perfect strokes between teachers and students in real time. Instant sync, buttery smooth annotation tools, and delightful classroom-ready controls built for iPad and stylus workflows."})]}),k.jsxs("dl",{className:"features",children:[k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Palm rejection"}),k.jsx("dd",{className:"feature-subtitle",children:"Silky palm drawing"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Frameless logos"}),k.jsx("dd",{className:"feature-subtitle",children:"Delightful annotations"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Realtime sync"}),k.jsx("dd",{className:"feature-subtitle",children:"Sub-second latency"})]})]})]}),k.jsxs("div",{className:"workspace-section",children:[k.jsx("p",{className:"workspace-label",children:"PICK YOUR WORKSPACE"}),k.jsxs("div",{className:"workspace-cards",children:[k.jsxs("a",{onClick:()=>o("/teacher?room=demo"),className:"glass-button teacher-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Teacher dashboard"}),k.jsx("p",{className:"workspace-description",children:"Monitor your students, sync views, and annotate the board. Assign templates/images, and manage the class."})]}),k.jsx("span",{className:"workspace-emoji",children:""})]}),k.jsxs("a",{onClick:()=>n(!0),className:"glass-button student-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Student workspace"}),k.jsx("p",{className:"workspace-description",children:"Sketch on a public or draw alongside the class, with undo/redo, templates, and stylus-first controls."})]}),k.jsx("span",{className:"workspace-emoji",children:""})]})]})]})]})})]})}const g3=Math.PI/180;function p3(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const hu=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Jt={_global:hu,version:"10.0.7",isBrowser:p3(),isUnminified:/param/.test((function(o){}).toString()),dblClickWindow:400,getAngle(o){return Jt.angleDeg?o*g3:o},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Jt.DD.isDragging},isTransforming(){var o,t;return(t=(o=Jt.Transformer)===null||o===void 0?void 0:o.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!Jt.DD.node},releaseCanvasOnDestroy:!0,document:hu.document,_injectGlobal(o){typeof hu.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),hu.Konva=o}},Vn=o=>{Jt[o.prototype.getClassName()]=o};Jt._injectGlobal(Jt);const m3=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Ey=()=>{if(typeof document>"u")throw new Error(m3)};class ja{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new ja(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const n=this.m;return{x:n[0]*t.x+n[2]*t.y+n[4],y:n[1]*t.x+n[3]*t.y+n[5]}}translate(t,n){return this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n,this}scale(t,n){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n,this}rotate(t){const n=Math.cos(t),i=Math.sin(t),r=this.m[0]*n+this.m[2]*i,l=this.m[1]*n+this.m[3]*i,c=this.m[0]*-i+this.m[2]*n,d=this.m[1]*-i+this.m[3]*n;return this.m[0]=r,this.m[1]=l,this.m[2]=c,this.m[3]=d,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,n){const i=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,l=this.m[2]+this.m[0]*t,c=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=r,this.m[2]=l,this.m[3]=c,this}multiply(t){const n=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],l=this.m[1]*t.m[2]+this.m[3]*t.m[3],c=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],d=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=l,this.m[4]=c,this.m[5]=d,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,i=-this.m[1]*t,r=-this.m[2]*t,l=this.m[0]*t,c=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),d=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=l,this.m[4]=c,this.m[5]=d,this}getMatrix(){return this.m}decompose(){const t=this.m[0],n=this.m[1],i=this.m[2],r=this.m[3],l=this.m[4],c=this.m[5],d=t*r-n*i,g={x:l,y:c,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){const m=Math.sqrt(t*t+n*n);g.rotation=n>0?Math.acos(t/m):-Math.acos(t/m),g.scaleX=m,g.scaleY=d/m,g.skewX=(t*i+n*r)/d,g.skewY=0}else if(i!=0||r!=0){const m=Math.sqrt(i*i+r*r);g.rotation=Math.PI/2-(r>0?Math.acos(-i/m):-Math.acos(i/m)),g.scaleX=d/m,g.scaleY=m,g.skewX=0,g.skewY=(t*i+n*r)/d}return g.rotation=vt._getRotation(g.rotation),g}}const v3="[object Array]",y3="[object Number]",S3="[object String]",b3="[object Boolean]",_3=Math.PI/180,E3=180/Math.PI,Cp="#",C3="",T3="0",A3="Konva warning: ",Cy="Konva error: ",w3="rgb(",Tp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},O3=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let V0=[];const R3=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(o){setTimeout(o,60)},vt={_isElement(o){return!!(o&&o.nodeType==1)},_isFunction(o){return!!(o&&o.constructor&&o.call&&o.apply)},_isPlainObject(o){return!!o&&o.constructor===Object},_isArray(o){return Object.prototype.toString.call(o)===v3},_isNumber(o){return Object.prototype.toString.call(o)===y3&&!isNaN(o)&&isFinite(o)},_isString(o){return Object.prototype.toString.call(o)===S3},_isBoolean(o){return Object.prototype.toString.call(o)===b3},isObject(o){return o instanceof Object},isValidSelector(o){if(typeof o!="string")return!1;const t=o[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(o){return o===0||o>0?1:-1},requestAnimFrame(o){V0.push(o),V0.length===1&&R3(function(){const t=V0;V0=[],t.forEach(function(n){n()})})},createCanvasElement(){Ey();const o=document.createElement("canvas");try{o.style=o.style||{}}catch{}return o},createImageElement(){return Ey(),document.createElement("img")},_isInDocument(o){for(;o=o.parentNode;)if(o==document)return!0;return!1},_urlToImage(o,t){const n=vt.createImageElement();n.onload=function(){t(n)},n.src=o},_rgbToHex(o,t,n){return((1<<24)+(o<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(o){o=o.replace(Cp,C3);const t=parseInt(o,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let o=(Math.random()*16777215<<0).toString(16);for(;o.length<6;)o=T3+o;return Cp+o},getRGB(o){let t;return o in Tp?(t=Tp[o],{r:t[0],g:t[1],b:t[2]}):o[0]===Cp?this._hexToRgb(o.substring(1)):o.substr(0,4)===w3?(t=O3.exec(o.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(o){return o=o||"black",vt._namedColorToRBA(o)||vt._hex3ColorToRGBA(o)||vt._hex4ColorToRGBA(o)||vt._hex6ColorToRGBA(o)||vt._hex8ColorToRGBA(o)||vt._rgbColorToRGBA(o)||vt._rgbaColorToRGBA(o)||vt._hslColorToRGBA(o)},_namedColorToRBA(o){const t=Tp[o.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(o){if(o.indexOf("rgb(")===0){o=o.match(/rgb\(([^)]+)\)/)[1];const t=o.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(o){if(o.indexOf("rgba(")===0){o=o.match(/rgba\(([^)]+)\)/)[1];const t=o.split(/ *, */).map((n,i)=>n.slice(-1)==="%"?i===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(o){if(o[0]==="#"&&o.length===9)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:parseInt(o.slice(7,9),16)/255}},_hex6ColorToRGBA(o){if(o[0]==="#"&&o.length===7)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:1}},_hex4ColorToRGBA(o){if(o[0]==="#"&&o.length===5)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:parseInt(o[4]+o[4],16)/255}},_hex3ColorToRGBA(o){if(o[0]==="#"&&o.length===4)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:1}},_hslColorToRGBA(o){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(o)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o),i=Number(n[0])/360,r=Number(n[1])/100,l=Number(n[2])/100;let c,d,g;if(r===0)return g=l*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};l<.5?c=l*(1+r):c=l+r-l*r;const m=2*l-c,_=[0,0,0];for(let C=0;C<3;C++)d=i+1/3*-(C-1),d<0&&d++,d>1&&d--,6*d<1?g=m+(c-m)*6*d:2*d<1?g=c:3*d<2?g=m+(c-m)*(2/3-d)*6:g=m,_[C]=g*255;return{r:Math.round(_[0]),g:Math.round(_[1]),b:Math.round(_[2]),a:1}}},haveIntersection(o,t){return!(t.x>o.x+o.width||t.x+t.width<o.x||t.y>o.y+o.height||t.y+t.height<o.y)},cloneObject(o){const t={};for(const n in o)this._isPlainObject(o[n])?t[n]=this.cloneObject(o[n]):this._isArray(o[n])?t[n]=this.cloneArray(o[n]):t[n]=o[n];return t},cloneArray(o){return o.slice(0)},degToRad(o){return o*_3},radToDeg(o){return o*E3},_degToRad(o){return vt.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),vt.degToRad(o)},_radToDeg(o){return vt.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),vt.radToDeg(o)},_getRotation(o){return Jt.angleDeg?vt.radToDeg(o):o},_capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},throw(o){throw new Error(Cy+o)},error(o){console.error(Cy+o)},warn(o){Jt.showWarnings&&console.warn(A3+o)},each(o,t){for(const n in o)t(n,o[n])},_inRange(o,t,n){return t<=o&&o<n},_getProjectionToSegment(o,t,n,i,r,l){let c,d,g;const m=(o-n)*(o-n)+(t-i)*(t-i);if(m==0)c=o,d=t,g=(r-n)*(r-n)+(l-i)*(l-i);else{const _=((r-o)*(n-o)+(l-t)*(i-t))/m;_<0?(c=o,d=t,g=(o-r)*(o-r)+(t-l)*(t-l)):_>1?(c=n,d=i,g=(n-r)*(n-r)+(i-l)*(i-l)):(c=o+_*(n-o),d=t+_*(i-t),g=(c-r)*(c-r)+(d-l)*(d-l))}return[c,d,g]},_getProjectionToLine(o,t,n){const i=vt.cloneObject(o);let r=Number.MAX_VALUE;return t.forEach(function(l,c){if(!n&&c===t.length-1)return;const d=t[(c+1)%t.length],g=vt._getProjectionToSegment(l.x,l.y,d.x,d.y,o.x,o.y),m=g[0],_=g[1],C=g[2];C<r&&(i.x=m,i.y=_,r=C)}),i},_prepareArrayForTween(o,t,n){const i=[],r=[];if(o.length>t.length){const c=t;t=o,o=c}for(let c=0;c<o.length;c+=2)i.push({x:o[c],y:o[c+1]});for(let c=0;c<t.length;c+=2)r.push({x:t[c],y:t[c+1]});const l=[];return r.forEach(function(c){const d=vt._getProjectionToLine(c,i,n);l.push(d.x),l.push(d.y)}),l},_prepareToStringify(o){let t;o.visitedByCircularReferenceRemoval=!0;for(const n in o)if(o.hasOwnProperty(n)&&o[n]&&typeof o[n]=="object"){if(t=Object.getOwnPropertyDescriptor(o,n),o[n].visitedByCircularReferenceRemoval||vt._isElement(o[n]))if(t.configurable)delete o[n];else return null;else if(vt._prepareToStringify(o[n])===null)if(t.configurable)delete o[n];else return null}return delete o.visitedByCircularReferenceRemoval,o},_assign(o,t){for(const n in t)o[n]=t[n];return o},_getFirstPointerId(o){return o.touches?o.changedTouches[0].identifier:o.pointerId||999},releaseCanvas(...o){Jt.releaseCanvasOnDestroy&&o.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(o,t,n,i){let r=t<0?t:0,l=n<0?n:0;t=Math.abs(t),n=Math.abs(n);let c=0,d=0,g=0,m=0;typeof i=="number"?c=d=g=m=Math.min(i,t/2,n/2):(c=Math.min(i[0]||0,t/2,n/2),d=Math.min(i[1]||0,t/2,n/2),m=Math.min(i[2]||0,t/2,n/2),g=Math.min(i[3]||0,t/2,n/2)),o.moveTo(r+c,l),o.lineTo(r+t-d,l),o.arc(r+t-d,l+d,d,Math.PI*3/2,0,!1),o.lineTo(r+t,l+n-m),o.arc(r+t-m,l+n-m,m,0,Math.PI/2,!1),o.lineTo(r+g,l+n),o.arc(r+g,l+n-g,g,Math.PI/2,Math.PI,!1),o.lineTo(r,l+c),o.arc(r+c,l+c,c,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(o,t,n,i,r){i=Math.abs(i);for(let l=0;l<n;l++){const c=t[(l-1+n)%n],d=t[l],g=t[(l+1)%n],m={x:d.x-c.x,y:d.y-c.y},_={x:g.x-d.x,y:g.y-d.y},C=Math.hypot(m.x,m.y),E=Math.hypot(_.x,_.y);let O;typeof r=="number"?O=r:O=l<r.length?r[l]:0,O=i*Math.cos(Math.PI/n)*Math.min(1,O/i*2);const D={x:m.x/C,y:m.y/C},L={x:_.x/E,y:_.y/E},z={x:d.x-D.x*O,y:d.y-D.y*O},M={x:d.x+L.x*O,y:d.y+L.y*O};l===0?o.moveTo(z.x,z.y):o.lineTo(z.x,z.y),o.arcTo(d.x,d.y,M.x,M.y,O)}}};function x3(o){const t=[],n=o.length,i=vt;for(let r=0;r<n;r++){let l=o[r];i._isNumber(l)?l=Math.round(l*1e3)/1e3:i._isString(l)||(l=l+""),t.push(l)}return t}const Ty=",",N3="(",M3=")",D3="([",j3="])",U3=";",B3="()",z3="=",Ay=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],L3=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],G3=100;let Y0=null;function wy(){if(Y0!==null)return Y0;try{const t=vt.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Y0=!1,!1)}catch{return Y0=!1,!1}}class wg{constructor(t){this.canvas=t,Jt.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,n){let i=this.traceArr,r=i.length,l="",c,d,g,m;for(c=0;c<r;c++)d=i[c],g=d.method,g?(m=d.args,l+=g,t?l+=B3:vt._isArray(m[0])?l+=D3+m.join(Ty)+j3:(n&&(m=m.map(_=>typeof _=="number"?Math.floor(_):_)),l+=N3+m.join(Ty)+M3)):(l+=d.property,t||(l+=z3+d.val)),l+=U3;return l}clearTrace(){this.traceArr=[]}_trace(t){let n=this.traceArr,i;n.push(t),i=n.length,i>=G3&&n.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const n=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(t){const n=t.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(t){const n=t.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(t){const n=t.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(t){const n=t.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(t,n){this._context[t]=n}arc(t,n,i,r,l,c){this._context.arc(t,n,i,r,l,c)}arcTo(t,n,i,r,l){this._context.arcTo(t,n,i,r,l)}beginPath(){this._context.beginPath()}bezierCurveTo(t,n,i,r,l,c){this._context.bezierCurveTo(t,n,i,r,l,c)}clearRect(t,n,i,r){this._context.clearRect(t,n,i,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,n){const i=arguments;if(i.length===2)return this._context.createImageData(t,n);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,n,i,r){return this._context.createLinearGradient(t,n,i,r)}createPattern(t,n){return this._context.createPattern(t,n)}createRadialGradient(t,n,i,r,l,c){return this._context.createRadialGradient(t,n,i,r,l,c)}drawImage(t,n,i,r,l,c,d,g,m){const _=arguments,C=this._context;_.length===3?C.drawImage(t,n,i):_.length===5?C.drawImage(t,n,i,r,l):_.length===9&&C.drawImage(t,n,i,r,l,c,d,g,m)}ellipse(t,n,i,r,l,c,d,g){this._context.ellipse(t,n,i,r,l,c,d,g)}isPointInPath(t,n,i,r){return i?this._context.isPointInPath(i,t,n,r):this._context.isPointInPath(t,n,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,n,i,r){this._context.fillRect(t,n,i,r)}strokeRect(t,n,i,r){this._context.strokeRect(t,n,i,r)}fillText(t,n,i,r){r?this._context.fillText(t,n,i,r):this._context.fillText(t,n,i)}measureText(t){return this._context.measureText(t)}getImageData(t,n,i,r){return this._context.getImageData(t,n,i,r)}lineTo(t,n){this._context.lineTo(t,n)}moveTo(t,n){this._context.moveTo(t,n)}rect(t,n,i,r){this._context.rect(t,n,i,r)}roundRect(t,n,i,r,l){this._context.roundRect(t,n,i,r,l)}putImageData(t,n,i){this._context.putImageData(t,n,i)}quadraticCurveTo(t,n,i,r){this._context.quadraticCurveTo(t,n,i,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,n){this._context.scale(t,n)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,n,i,r,l,c){this._context.setTransform(t,n,i,r,l,c)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,n,i,r){this._context.strokeText(t,n,i,r)}transform(t,n,i,r,l,c){this._context.transform(t,n,i,r,l,c)}translate(t,n){this._context.translate(t,n)}_enableTrace(){let t=this,n=Ay.length,i=this.setAttr,r,l;const c=function(d){let g=t[d],m;t[d]=function(){return l=x3(Array.prototype.slice.call(arguments,0)),m=g.apply(t,arguments),t._trace({method:d,args:l}),m}};for(r=0;r<n;r++)c(Ay[r]);t.setAttr=function(){i.apply(t,arguments);const d=arguments[0];let g=arguments[1];(d==="shadowOffsetX"||d==="shadowOffsetY"||d==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),t._trace({property:d,val:g})}}_applyGlobalCompositeOperation(t){const n=t.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}L3.forEach(function(o){Object.defineProperty(wg.prototype,o,{get(){return this._context[o]},set(t){this._context[o]=t}})});class H3 extends wg{constructor(t,{willReadFrequently:n=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(t){const n=t.fill();this.setAttr("fillStyle",n),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const n=t._getLinearGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fillRadialGradient(t){const n=t._getRadialGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fill(t){const n=t.fill(),i=t.getFillPriority();if(n&&i==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&i==="pattern"){this._fillPattern(t);return}const l=t.getFillLinearGradientColorStops();if(l&&i==="linear-gradient"){this._fillLinearGradient(t);return}const c=t.getFillRadialGradientColorStops();if(c&&i==="radial-gradient"){this._fillRadialGradient(t);return}n?this._fillColor(t):r?this._fillPattern(t):l?this._fillLinearGradient(t):c&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const n=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),l=this.createLinearGradient(n.x,n.y,i.x,i.y);if(r){for(let c=0;c<r.length;c+=2)l.addColorStop(r[c],r[c+1]);this.setAttr("strokeStyle",l)}}_stroke(t){const n=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t),n&&t.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var n,i,r;const l=(n=t.getShadowRGBA())!==null&&n!==void 0?n:"black",c=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,d=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},g=t.getAbsoluteScale(),m=this.canvas.getPixelRatio(),_=g.x*m,C=g.y*m;this.setAttr("shadowColor",l),this.setAttr("shadowBlur",c*Math.min(Math.abs(_),Math.abs(C))),this.setAttr("shadowOffsetX",d.x*_),this.setAttr("shadowOffsetY",d.y*C)}}class P3 extends wg{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const n=t.getStrokeScaleEnabled();if(!n){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t);const i=t.hitStrokeWidth(),r=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),n||this.restore()}}}let K0;function I3(){if(K0)return K0;const o=vt.createCanvasElement(),t=o.getContext("2d");return K0=(function(){const n=Jt._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i})(),vt.releaseCanvas(o),K0}class Zm{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const i=(t||{}).pixelRatio||Jt.pixelRatio||I3();this.pixelRatio=i,this._canvas=vt.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const n=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,n){this.setWidth(t||0),this.setHeight(n||0)}toDataURL(t,n){try{return this._canvas.toDataURL(t,n)}catch{try{return this._canvas.toDataURL()}catch(r){return vt.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class so extends Zm{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new H3(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function Oy(){const o=vt.createCanvasElement();o.width=1,o.height=1;const t=o.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data;return!(n[0]===255&&n[1]===0&&n[2]===255&&n[3]===255)}function Ry(){var o,t;return typeof navigator>"u"?!1:(t=(o=navigator.brave)===null||o===void 0?void 0:o.isBrave())!==null&&t!==void 0?t:!1}let xy=!1;function k3(){return Ry()&&Oy()&&!xy&&(xy=!0,vt.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),Ry()&&Oy()}class Wm extends Zm{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new P3(this),this.setSize(t.width,t.height),k3()}}const un={get isDragging(){let o=!1;return un._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(o=!0)}),o},justDragged:!1,get node(){let o;return un._dragElements.forEach(t=>{o=t.node}),o},_dragElements:new Map,_drag(o){const t=[];un._dragElements.forEach((n,i)=>{const{node:r}=n,l=r.getStage();l.setPointersPositions(o),n.pointerId===void 0&&(n.pointerId=vt._getFirstPointerId(o));const c=l._changedPointerPositions.find(d=>d.id===n.pointerId);if(c){if(n.dragStatus!=="dragging"){const d=r.dragDistance();if(Math.max(Math.abs(c.x-n.startPointerPos.x),Math.abs(c.y-n.startPointerPos.y))<d||(r.startDrag({evt:o}),!r.isDragging()))return}r._setDragPosition(o,n),t.push(r)}}),t.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:o},!0)})},_endDragBefore(o){const t=[];un._dragElements.forEach(n=>{const{node:i}=n,r=i.getStage();if(o&&r.setPointersPositions(o),!r._changedPointerPositions.find(d=>d.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(un.justDragged=!0,Jt._mouseListenClick=!1,Jt._touchListenClick=!1,Jt._pointerListenClick=!1,n.dragStatus="stopped");const c=n.node.getLayer()||n.node instanceof Jt.Stage&&n.node;c&&t.indexOf(c)===-1&&t.push(c)}),t.forEach(n=>{n.draw()})},_endDragAfter(o){un._dragElements.forEach((t,n)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:o},!0),t.dragStatus!=="dragging"&&un._dragElements.delete(n)})}};Jt.isBrowser&&(window.addEventListener("mouseup",un._endDragBefore,!0),window.addEventListener("touchend",un._endDragBefore,!0),window.addEventListener("touchcancel",un._endDragBefore,!0),window.addEventListener("mousemove",un._drag),window.addEventListener("touchmove",un._drag),window.addEventListener("mouseup",un._endDragAfter,!1),window.addEventListener("touchend",un._endDragAfter,!1),window.addEventListener("touchcancel",un._endDragAfter,!1));function co(o){return vt._isString(o)?'"'+o+'"':Object.prototype.toString.call(o)==="[object Number]"||vt._isBoolean(o)?o:Object.prototype.toString.call(o)}function N2(o){return o>255?255:o<0?0:Math.round(o)}function Vt(){if(Jt.isUnminified)return function(o,t){return vt._isNumber(o)||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),o}}function Og(o){if(Jt.isUnminified)return function(t,n){let i=vt._isNumber(t),r=vt._isArray(t)&&t.length==o;return!i&&!r&&vt.warn(co(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+o+")"),t}}function $m(){if(Jt.isUnminified)return function(o,t){return vt._isNumber(o)||o==="auto"||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),o}}function pu(){if(Jt.isUnminified)return function(o,t){return vt._isString(o)||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),o}}function M2(){if(Jt.isUnminified)return function(o,t){const n=vt._isString(o),i=Object.prototype.toString.call(o)==="[object CanvasGradient]"||o&&o.addColorStop;return n||i||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),o}}function q3(){if(Jt.isUnminified)return function(o,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&o instanceof n||(vt._isArray(o)?o.forEach(function(i){vt._isNumber(i)||vt.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),o}}function Hr(){if(Jt.isUnminified)return function(o,t){return o===!0||o===!1||vt.warn(co(o)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),o}}function V3(o){if(Jt.isUnminified)return function(t,n){return t==null||vt.isObject(t)||vt.warn(co(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+o),t}}const Yh="get",Kh="set",st={addGetterSetter(o,t,n,i,r){st.addGetter(o,t,n),st.addSetter(o,t,i,r),st.addOverloadedGetterSetter(o,t)},addGetter(o,t,n){const i=Yh+vt._capitalize(t);o.prototype[i]=o.prototype[i]||function(){const r=this.attrs[t];return r===void 0?n:r}},addSetter(o,t,n,i){const r=Kh+vt._capitalize(t);o.prototype[r]||st.overWriteSetter(o,t,n,i)},overWriteSetter(o,t,n,i){const r=Kh+vt._capitalize(t);o.prototype[r]=function(l){return n&&l!==void 0&&l!==null&&(l=n.call(this,l,t)),this._setAttr(t,l),i&&i.call(this),this}},addComponentsGetterSetter(o,t,n,i,r){const l=n.length,c=vt._capitalize,d=Yh+c(t),g=Kh+c(t);o.prototype[d]=function(){const _={};for(let C=0;C<l;C++){const E=n[C];_[E]=this.getAttr(t+c(E))}return _};const m=V3(n);o.prototype[g]=function(_){const C=this.attrs[t];i&&(_=i.call(this,_,t)),m&&m.call(this,_,t);for(const E in _)_.hasOwnProperty(E)&&this._setAttr(t+c(E),_[E]);return _||n.forEach(E=>{this._setAttr(t+c(E),void 0)}),this._fireChangeEvent(t,C,_),r&&r.call(this),this},st.addOverloadedGetterSetter(o,t)},addOverloadedGetterSetter(o,t){const n=vt._capitalize(t),i=Kh+n,r=Yh+n;o.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(o,t,n,i){vt.error("Adding deprecated "+t);const r=Yh+vt._capitalize(t),l=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[r]=function(){vt.error(l);const c=this.attrs[t];return c===void 0?n:c},st.addSetter(o,t,i,function(){vt.error(l)}),st.addOverloadedGetterSetter(o,t)},backCompat(o,t){vt.each(t,function(n,i){const r=o.prototype[i],l=Yh+vt._capitalize(n),c=Kh+vt._capitalize(n);function d(){r.apply(this,arguments),vt.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}o.prototype[n]=d,o.prototype[l]=d,o.prototype[c]=d})},afterSetFilter(){this._filterUpToDate=!1}};function Y3(o){const t=/(\w+)\(([^)]+)\)/g;let n;for(;(n=t.exec(o))!==null;){const[,i,r]=n;switch(i){case"blur":{const l=parseFloat(r.replace("px",""));return function(c){this.blurRadius(l*.5);const d=Jt.Filters;d&&d.Blur&&d.Blur.call(this,c)}}case"brightness":{const l=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(c){this.brightness(l);const d=Jt.Filters;d&&d.Brightness&&d.Brightness.call(this,c)}}case"contrast":{const l=parseFloat(r);return function(c){const d=100*(Math.sqrt(l)-1);this.contrast(d);const g=Jt.Filters;g&&g.Contrast&&g.Contrast.call(this,c)}}case"grayscale":return function(l){const c=Jt.Filters;c&&c.Grayscale&&c.Grayscale.call(this,l)};case"sepia":return function(l){const c=Jt.Filters;c&&c.Sepia&&c.Sepia.call(this,l)};case"invert":return function(l){const c=Jt.Filters;c&&c.Invert&&c.Invert.call(this,l)};default:vt.warn(`CSS filter "${i}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const dg="absoluteOpacity",Q0="allEventListeners",fl="absoluteTransform",Ny="absoluteScale",ru="canvas",K3="Change",Q3="children",X3="konva",Am="listening",F3="mouseenter",J3="mouseleave",Z3="pointerenter",W3="pointerleave",$3="touchenter",t5="touchleave",My="set",Dy="Shape",gg=" ",jy="stage",io="transform",e5="Stage",wm="visible",n5=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(gg);let i5=1;class qt{constructor(t){this._id=i5++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===io||t===fl)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,n){let i=this._cache.get(t);return(i===void 0||(t===io||t===fl)&&i.dirty===!0)&&(i=n.call(this),this._cache.set(t,i)),i}_calculate(t,n,i){if(!this._attachedDepsListeners.get(t)){const r=n.map(l=>l+"Change.konva").join(gg);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(ru)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===fl&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ru)){const{scene:t,filter:n,hit:i,buffer:r}=this._cache.get(ru);vt.releaseCanvas(t,n,i,r),this._cache.delete(ru)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const n=t||{};let i={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(n.width||i.width),l=Math.ceil(n.height||i.height),c=n.pixelRatio,d=n.x===void 0?Math.floor(i.x):n.x,g=n.y===void 0?Math.floor(i.y):n.y,m=n.offset||0,_=n.drawBorder||!1,C=n.hitCanvasPixelRatio||1;if(!r||!l){vt.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const E=Math.abs(Math.round(i.x)-d)>.5?1:0,O=Math.abs(Math.round(i.y)-g)>.5?1:0;r+=m*2+E,l+=m*2+O,d-=m,g-=m;const v=new so({pixelRatio:c,width:r,height:l}),D=new so({pixelRatio:c,width:0,height:0,willReadFrequently:!0}),L=new Wm({pixelRatio:C,width:r,height:l}),z=v.getContext(),M=L.getContext(),N=new so({width:v.width/v.pixelRatio+Math.abs(d),height:v.height/v.pixelRatio+Math.abs(g),pixelRatio:v.pixelRatio}),G=N.getContext();return L.isCache=!0,v.isCache=!0,this._cache.delete(ru),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,D.getContext()._context.imageSmoothingEnabled=!1),z.save(),M.save(),G.save(),z.translate(-d,-g),M.translate(-d,-g),G.translate(-d,-g),N.x=d,N.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(dg),this._clearSelfAndDescendantCache(Ny),this.drawScene(v,this,N),this.drawHit(L,this),this._isUnderCache=!1,z.restore(),M.restore(),_&&(z.save(),z.beginPath(),z.rect(0,0,r,l),z.closePath(),z.setAttr("strokeStyle","red"),z.setAttr("lineWidth",5),z.stroke(),z.restore()),this._cache.set(ru,{scene:v,filter:D,hit:L,buffer:N,x:d,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(ru)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,n){const i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,l=1/0,c=-1/0,d=-1/0;const g=this.getAbsoluteTransform(n);return i.forEach(function(m){const _=g.point(m);r===void 0&&(r=c=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),c=Math.max(c,_.x),d=Math.max(d,_.y)}),{x:r,y:l,width:c-r,height:d-l}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();t.translate(n.x,n.y);const i=this._getCachedSceneCanvas(),r=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/r,i.height/r),t.restore()}_drawCachedHitCanvas(t){const n=this._getCanvasCache(),i=n.hit;t.save(),t.translate(n.x,n.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),n=this._getCanvasCache(),i=n.scene,r=n.filter,l=r.getContext(),c,d,g,m;if(!t||t.length===0)return i;if(this._filterUpToDate)return r;let _=!0;for(let E=0;E<t.length;E++)if(typeof t[E]=="string"&&wy(),typeof t[E]!="string"||!wy()){_=!1;break}const C=i.pixelRatio;if(r.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio),_){const E=t.join(" ");return l.save(),l.setAttr("filter",E),l.drawImage(i._canvas,0,0,i.getWidth()/C,i.getHeight()/C),l.restore(),this._filterUpToDate=!0,r}try{for(c=t.length,l.clear(),l.drawImage(i._canvas,0,0,i.getWidth()/C,i.getHeight()/C),d=l.getImageData(0,0,r.getWidth(),r.getHeight()),g=0;g<c;g++)m=t[g],typeof m=="string"&&(m=Y3(m)),m.call(this,d),l.putImageData(d,0,0)}catch(E){vt.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,n){if(this._cache&&this._cache.delete(Q0),arguments.length===3)return this._delegate.apply(this,arguments);const i=t.split(gg);for(let r=0;r<i.length;r++){const c=i[r].split("."),d=c[0],g=c[1]||"";this.eventListeners[d]||(this.eventListeners[d]=[]),this.eventListeners[d].push({name:g,handler:n})}return this}off(t,n){let i=(t||"").split(gg),r=i.length,l,c,d,g,m,_;if(this._cache&&this._cache.delete(Q0),!t)for(c in this.eventListeners)this._off(c);for(l=0;l<r;l++)if(d=i[l],g=d.split("."),m=g[0],_=g[1],m)this.eventListeners[m]&&this._off(m,_,n);else for(c in this.eventListeners)this._off(c,_,n);return this}dispatchEvent(t){const n={target:this,type:t.type,evt:t};return this.fire(t.type,n),this}addEventListener(t,n){return this.on(t,function(i){n.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,n,i){const r=this;this.on(t,function(l){const c=l.target.findAncestors(n,!0,r);for(let d=0;d<c.length;d++)l=vt.cloneObject(l),l.currentTarget=c[d],i.call(c[d],l)})}remove(){return this.isDragging()&&this.stopDrag(),un._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(fl),this._clearSelfAndDescendantCache(dg),this._clearSelfAndDescendantCache(Ny),this._clearSelfAndDescendantCache(jy),this._clearSelfAndDescendantCache(wm),this._clearSelfAndDescendantCache(Am)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const n="get"+vt._capitalize(t);return vt._isFunction(this[n])?this[n]():this.attrs[t]}getAncestors(){let t=this.getParent(),n=[];for(;t;)n.push(t),t=t.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let n,i;if(!t)return this;for(n in t)n!==Q3&&(i=My+vt._capitalize(n),vt._isFunction(this[i])?this[i](t[n]):this._setAttr(n,t[n]))}),this}isListening(){return this._getCache(Am,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(wm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,n=!1){if(t)return this._isVisible(t)&&this._isListening(t);const i=this.getLayer();let r=!1;un._dragElements.forEach(c=>{c.dragStatus==="dragging"&&(c.node.nodeType==="Stage"||c.node.getLayer()===i)&&(r=!0)});const l=!n&&!Jt.hitOnDragEnabled&&(r||Jt.isTransforming());return this.isListening()&&this.isVisible()&&!l}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),n=this,i=0,r,l,c,d;function g(_){for(r=[],l=_.length,c=0;c<l;c++)d=_[c],i++,d.nodeType!==Dy&&(r=r.concat(d.getChildren().slice())),d._id===n._id&&(c=l);r.length>0&&r[0].getDepth()<=t&&g(r)}const m=this.getStage();return n.nodeType!==e5&&m&&g(m.getChildren()),i}getDepth(){let t=0,n=this.parent;for(;n;)t++,n=n.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(io),this._clearSelfAndDescendantCache(fl)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const n=t.getPointerPosition();if(!n)return null;const i=this.getAbsoluteTransform().copy();return i.invert(),i.point(n)}getAbsolutePosition(t){let n=!1,i=this.parent;for(;i;){if(i.isCached()){n=!0;break}i=i.parent}n&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),l=new ja,c=this.offset();return l.m=r.slice(),l.translate(c.x,c.y),l.getTranslation()}setAbsolutePosition(t){const{x:n,y:i,...r}=this._clearTransform();this.attrs.x=n,this.attrs.y=i,this._clearCache(io);const l=this._getAbsoluteTransform().copy();return l.invert(),l.translate(t.x,t.y),t={x:this.attrs.x+l.getTranslation().x,y:this.attrs.y+l.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(io),this._clearSelfAndDescendantCache(fl),this}_setTransform(t){let n;for(n in t)this.attrs[n]=t[n]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let n=t.x,i=t.y,r=this.x(),l=this.y();return n!==void 0&&(r+=n),i!==void 0&&(l+=i),this.setPosition({x:r,y:l}),this}_eachAncestorReverse(t,n){let i=[],r=this.getParent(),l,c;if(!(n&&n._id===this._id)){for(i.unshift(this);r&&(!n||r._id!==n._id);)i.unshift(r),r=r.parent;for(l=i.length,c=0;c<l;c++)t(i[c])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return vt.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return vt.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return vt.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return vt.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return vt.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&vt.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(dg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(t*=n.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),n,i,r,l,c;const d={attrs:{},className:this.getClassName()};for(n in t)i=t[n],c=vt.isObject(i)&&!vt._isPlainObject(i)&&!vt._isArray(i),!c&&(r=typeof this[n]=="function"&&this[n],delete t[n],l=r?r.call(this):null,t[n]=i,l!==i&&(d.attrs[n]=i));return vt._prepareToStringify(d)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,n,i){const r=[];n&&this._isMatch(t)&&r.push(this);let l=this.parent;for(;l;){if(l===i)return r;l._isMatch(t)&&r.push(l),l=l.parent}return r}isAncestorOf(t){return!1}findAncestor(t,n,i){return this.findAncestors(t,n,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let n=t.replace(/ /g,"").split(","),i=n.length,r,l;for(r=0;r<i;r++)if(l=n[r],vt.isValidSelector(l)||(vt.warn('Selector "'+l+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),vt.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),vt.warn("Konva is awesome, right?")),l.charAt(0)==="#"){if(this.id()===l.slice(1))return!0}else if(l.charAt(0)==="."){if(this.hasName(l.slice(1)))return!0}else if(this.className===l||this.nodeType===l)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(jy,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,n={},i){return n.target=n.target||this,i?this._fireAndBubble(t,n):this._fire(t,n),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(fl,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let n;if(t)return n=new ja,this._eachAncestorReverse(function(i){const r=i.transformsEnabled();r==="all"?n.multiply(i.getTransform()):r==="position"&&n.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},t),n;{n=this._cache.get(fl)||new ja,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const i=this.transformsEnabled();if(i==="all")n.multiply(this.getTransform());else if(i==="position"){const r=this.attrs.x||0,l=this.attrs.y||0,c=this.attrs.offsetX||0,d=this.attrs.offsetY||0;n.translate(r-c,l-d)}return n.dirty=!1,n}}getAbsoluteScale(t){let n=this;for(;n;)n._isUnderCache&&(t=n),n=n.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(io,this._getTransform)}_getTransform(){var t,n;const i=this._cache.get(io)||new ja;i.reset();const r=this.x(),l=this.y(),c=Jt.getAngle(this.rotation()),d=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,_=this.attrs.skewY||0,C=this.attrs.offsetX||0,E=this.attrs.offsetY||0;return(r!==0||l!==0)&&i.translate(r,l),c!==0&&i.rotate(c),(m!==0||_!==0)&&i.skew(m,_),(d!==1||g!==1)&&i.scale(d,g),(C!==0||E!==0)&&i.translate(-1*C,-1*E),i.dirty=!1,i}clone(t){let n=vt.cloneObject(this.attrs),i,r,l,c,d;for(i in t)n[i]=t[i];const g=new this.constructor(n);for(i in this.eventListeners)for(r=this.eventListeners[i],l=r.length,c=0;c<l;c++)d=r[c],d.name.indexOf(X3)<0&&(g.eventListeners[i]||(g.eventListeners[i]=[]),g.eventListeners[i].push(d));return g}_toKonvaCanvas(t){t=t||{};const n=this.getClientRect(),i=this.getStage(),r=t.x!==void 0?t.x:Math.floor(n.x),l=t.y!==void 0?t.y:Math.floor(n.y),c=t.pixelRatio||1,d=new so({width:t.width||Math.ceil(n.width)||(i?i.width():0),height:t.height||Math.ceil(n.height)||(i?i.height():0),pixelRatio:c}),g=d.getContext(),m=new so({width:d.width/d.pixelRatio+Math.abs(r),height:d.height/d.pixelRatio+Math.abs(l),pixelRatio:d.pixelRatio});return t.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(r||l)&&g.translate(-1*r,-1*l),this.drawScene(d,void 0,m),g.restore(),d}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const n=t.mimeType||null,i=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(n,i);return t.callback&&t.callback(r),r}toImage(t){return new Promise((n,i)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,vt._urlToImage(this.toDataURL(t),function(l){n(l),r==null||r(l)})}catch(r){i(r)}})}toBlob(t){return new Promise((n,i)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(l=>{n(l),r==null||r(l)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(r){i(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Jt.dragDistance}_off(t,n,i){let r=this.eventListeners[t],l,c,d;for(l=0;l<r.length;l++)if(c=r[l].name,d=r[l].handler,(c!=="konva"||n==="konva")&&(!n||c===n)&&(!i||i===d)){if(r.splice(l,1),r.length===0){delete this.eventListeners[t];break}l--}}_fireChangeEvent(t,n,i){this._fire(t+K3,{oldVal:n,newVal:i})}addName(t){if(!this.hasName(t)){const n=this.name(),i=n?n+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const n=(this.name()||"").split(/\s/g),i=n.indexOf(t);return i!==-1&&(n.splice(i,1),this.name(n.join(" "))),this}setAttr(t,n){const i=this[My+vt._capitalize(t)];return vt._isFunction(i)?i.call(this,n):this._setAttr(t,n),this}_requestDraw(){if(Jt.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,n){const i=this.attrs[t];i===n&&!vt.isObject(n)||(n==null?delete this.attrs[t]:this.attrs[t]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,n),this._requestDraw())}_setComponentAttr(t,n,i){let r;i!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][n]=i,this._fireChangeEvent(t,r,i))}_fireAndBubble(t,n,i){n&&this.nodeType===Dy&&(n.target=this);const r=[F3,J3,Z3,W3,$3,t5];if(!(r.indexOf(t)!==-1&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i))){this._fire(t,n);const c=r.indexOf(t)!==-1&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!c&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,n,i):this._fireAndBubble.call(this.parent,t,n))}}_getProtoListeners(t){var n,i,r;const l=(n=this._cache.get(Q0))!==null&&n!==void 0?n:{};let c=l==null?void 0:l[t];if(c===void 0){c=[];let d=Object.getPrototypeOf(this);for(;d;){const g=(r=(i=d.eventListeners)===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:[];c.push(...g),d=Object.getPrototypeOf(d)}l[t]=c,this._cache.set(Q0,l)}return c}_fire(t,n){n=n||{},n.currentTarget=this,n.type=t;const i=this._getProtoListeners(t);if(i)for(let l=0;l<i.length;l++)i[l].handler.call(this,n);const r=this.eventListeners[t];if(r)for(let l=0;l<r.length;l++)r[l].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const n=t?t.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition();if(!i)return;const l=i._getPointerById(n)||i._changedPointerPositions[0]||r;un._dragElements.set(this._id,{node:this,startPointerPos:l,offset:{x:l.x-r.x,y:l.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(t,n=!0){un._dragElements.has(this._id)||this._createDragElement(t);const i=un._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},n)}_setDragPosition(t,n){const i=this.getStage()._getPointerById(n.pointerId);if(!i)return;let r={x:i.x-n.offset.x,y:i.y-n.offset.y};const l=this.dragBoundFunc();if(l!==void 0){const c=l.call(this,r,t);c?r=c:vt.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const n=un._dragElements.get(this._id);n&&(n.dragStatus="stopped"),un._endDragBefore(t),un._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=un._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Jt.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;un._dragElements.forEach(l=>{this.isAncestorOf(l.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=un._dragElements.get(this._id),i=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";i?this.stopDrag():r&&un._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const n=this.getStage();if(!n)return!1;const i={x:-t.x,y:-t.y,width:n.width()+2*t.x,height:n.height()+2*t.y};return vt.haveIntersection(i,this.getClientRect())}static create(t,n){return vt._isString(t)&&(t=JSON.parse(t)),this._createNode(t,n)}static _createNode(t,n){let i=qt.prototype.getClassName.call(t),r=t.children,l,c,d;n&&(t.attrs.container=n),Jt[i]||(vt.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const g=Jt[i];if(l=new g(t.attrs),r)for(c=r.length,d=0;d<c;d++)l.add(qt._createNode(r[d]));return l}}qt.prototype.nodeType="Node";qt.prototype._attrsAffectingSize=[];qt.prototype.eventListeners={};qt.prototype.on.call(qt.prototype,n5,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(io),this._clearSelfAndDescendantCache(fl)});qt.prototype.on.call(qt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(wm)});qt.prototype.on.call(qt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Am)});qt.prototype.on.call(qt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(dg)});const Tn=st.addGetterSetter;Tn(qt,"zIndex");Tn(qt,"absolutePosition");Tn(qt,"position");Tn(qt,"x",0,Vt());Tn(qt,"y",0,Vt());Tn(qt,"globalCompositeOperation","source-over",pu());Tn(qt,"opacity",1,Vt());Tn(qt,"name","",pu());Tn(qt,"id","",pu());Tn(qt,"rotation",0,Vt());st.addComponentsGetterSetter(qt,"scale",["x","y"]);Tn(qt,"scaleX",1,Vt());Tn(qt,"scaleY",1,Vt());st.addComponentsGetterSetter(qt,"skew",["x","y"]);Tn(qt,"skewX",0,Vt());Tn(qt,"skewY",0,Vt());st.addComponentsGetterSetter(qt,"offset",["x","y"]);Tn(qt,"offsetX",0,Vt());Tn(qt,"offsetY",0,Vt());Tn(qt,"dragDistance",void 0,Vt());Tn(qt,"width",0,Vt());Tn(qt,"height",0,Vt());Tn(qt,"listening",!0,Hr());Tn(qt,"preventDefault",!0,Hr());Tn(qt,"filters",void 0,function(o){return this._filterUpToDate=!1,o});Tn(qt,"visible",!0,Hr());Tn(qt,"transformsEnabled","all",pu());Tn(qt,"size");Tn(qt,"dragBoundFunc");Tn(qt,"draggable",!1,Hr());st.backCompat(qt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class za extends qt{constructor(){super(...arguments),this.children=[]}getChildren(t){const n=this.children||[];return t?n.filter(t):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let i=0;i<t.length;i++)this.add(t[i]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const n=this._generalFind(t,!0);return n.length>0?n[0]:void 0}_generalFind(t,n){const i=[];return this._descendants(r=>{const l=r._isMatch(t);return l&&i.push(r),!!(l&&n)}),i}_descendants(t){let n=!1;const i=this.getChildren();for(const r of i){if(n=t(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(t),n))return!0}return!1}toObject(){const t=qt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(n=>{t.children.push(n.toObject())}),t}isAncestorOf(t){let n=t.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(t){const n=qt.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){n.add(i.clone())}),n}getAllIntersections(t){const n=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&n.push(i)}),n}_clearSelfAndDescendantCache(t){var n;super._clearSelfAndDescendantCache(t),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(n,i){n.index=i}),this._requestDraw()}drawScene(t,n,i){const r=this.getLayer(),l=t||r&&r.getCanvas(),c=l&&l.getContext(),d=this._getCanvasCache(),g=d&&d.scene,m=l&&l.isCache;if(!this.isVisible()&&!m)return this;if(g){c.save();const _=this.getAbsoluteTransform(n).getMatrix();c.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",l,n,i);return this}drawHit(t,n){if(!this.shouldDrawHit(n))return this;const i=this.getLayer(),r=t||i&&i.hitCanvas,l=r&&r.getContext(),c=this._getCanvasCache();if(c&&c.hit){l.save();const g=this.getAbsoluteTransform(n).getMatrix();l.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(l),l.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(t,n,i,r){var l;const c=n&&n.getContext(),d=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),_=typeof d=="number"&&typeof g=="number"||m,C=i===this;if(_){c.save();const O=this.getAbsoluteTransform(i);let v=O.getMatrix();c.transform(v[0],v[1],v[2],v[3],v[4],v[5]),c.beginPath();let D;if(m)D=m.call(this,c,this);else{const L=this.clipX(),z=this.clipY();c.rect(L||0,z||0,d,g)}c.clip.apply(c,D),v=O.copy().invert().getMatrix(),c.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const E=!C&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(c.save(),c._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(O){O[t](n,i,r)}),E&&c.restore(),_&&c.restore()}getClientRect(t={}){var n;const i=t.skipTransform,r=t.relativeTo;let l,c,d,g,m={x:1/0,y:1/0,width:0,height:0};const _=this;(n=this.children)===null||n===void 0||n.forEach(function(O){if(!O.visible())return;const v=O.getClientRect({relativeTo:_,skipShadow:t.skipShadow,skipStroke:t.skipStroke});v.width===0&&v.height===0||(l===void 0?(l=v.x,c=v.y,d=v.x+v.width,g=v.y+v.height):(l=Math.min(l,v.x),c=Math.min(c,v.y),d=Math.max(d,v.x+v.width),g=Math.max(g,v.y+v.height)))});const C=this.find("Shape");let E=!1;for(let O=0;O<C.length;O++)if(C[O]._isVisible(this)){E=!0;break}return E&&l!==void 0?m={x:l,y:c,width:d-l,height:g-c}:m={x:0,y:0,width:0,height:0},i?m:this._transformedRect(m,r)}}st.addComponentsGetterSetter(za,"clip",["x","y","width","height"]);st.addGetterSetter(za,"clipX",void 0,Vt());st.addGetterSetter(za,"clipY",void 0,Vt());st.addGetterSetter(za,"clipWidth",void 0,Vt());st.addGetterSetter(za,"clipHeight",void 0,Vt());st.addGetterSetter(za,"clipFunc");const cd=new Map,D2=Jt._global.PointerEvent!==void 0;function Ap(o){return cd.get(o)}function tv(o){return{evt:o,pointerId:o.pointerId}}function j2(o,t){return cd.get(o)===t}function U2(o,t){ed(o),t.getStage()&&(cd.set(o,t),D2&&t._fire("gotpointercapture",tv(new PointerEvent("gotpointercapture"))))}function ed(o,t){const n=cd.get(o);if(!n)return;const i=n.getStage();i&&i.content,cd.delete(o),D2&&n._fire("lostpointercapture",tv(new PointerEvent("lostpointercapture")))}const a5="Stage",r5="string",Uy="px",s5="mouseout",B2="mouseleave",z2="mouseover",L2="mouseenter",G2="mousemove",H2="mousedown",P2="mouseup",Fh="pointermove",Jh="pointerdown",sf="pointerup",Zh="pointercancel",l5="lostpointercapture",X0="pointerout",Wh="pointerleave",F0="pointerover",J0="pointerenter",Om="contextmenu",I2="touchstart",k2="touchend",q2="touchmove",V2="touchcancel",Rm="wheel",o5=5,u5=[[L2,"_pointerenter"],[H2,"_pointerdown"],[G2,"_pointermove"],[P2,"_pointerup"],[B2,"_pointerleave"],[I2,"_pointerdown"],[q2,"_pointermove"],[k2,"_pointerup"],[V2,"_pointercancel"],[z2,"_pointerover"],[Rm,"_wheel"],[Om,"_contextmenu"],[Jh,"_pointerdown"],[Fh,"_pointermove"],[sf,"_pointerup"],[Zh,"_pointercancel"],[Wh,"_pointerleave"],[l5,"_lostpointercapture"]],wp={mouse:{[X0]:s5,[Wh]:B2,[F0]:z2,[J0]:L2,[Fh]:G2,[Jh]:H2,[sf]:P2,[Zh]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[X0]:"touchout",[Wh]:"touchleave",[F0]:"touchover",[J0]:"touchenter",[Fh]:q2,[Jh]:I2,[sf]:k2,[Zh]:V2,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[X0]:X0,[Wh]:Wh,[F0]:F0,[J0]:J0,[Fh]:Fh,[Jh]:Jh,[sf]:sf,[Zh]:Zh,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},$h=o=>o.indexOf("pointer")>=0?"pointer":o.indexOf("touch")>=0?"touch":"mouse",Kc=o=>{const t=$h(o);if(t==="pointer")return Jt.pointerEventsEnabled&&wp.pointer;if(t==="touch")return wp.touch;if(t==="mouse")return wp.mouse};function By(o={}){return(o.clipFunc||o.clipWidth||o.clipHeight)&&vt.warn("Stage does not support clipping. Please use clip for Layers or Groups."),o}const c5="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",nd=[];let Rg=class extends za{constructor(t){super(By(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),nd.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{By(this.attrs)}),this._checkVisibility()}_validateAdd(t){const n=t.getType()==="Layer",i=t.getType()==="FastLayer";n||i||vt.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===r5){let n;if(t.charAt(0)==="."){const i=t.slice(1);t=document.getElementsByClassName(i)[0]}else t.charAt(0)!=="#"?n=t:n=t.slice(1),t=document.getElementById(n);if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,n=t.length;for(let i=0;i<n;i++)t[i].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),za.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&vt._isInDocument(t)&&this.container().removeChild(t);const n=nd.indexOf(this);return n>-1&&nd.splice(n,1),vt.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(vt.warn(c5),null)}_getPointerById(t){return this._pointerPositions.find(n=>n.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const n=new so({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=n.getContext()._context,r=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),r.forEach(function(l){if(!l.isVisible())return;const c=l._toKonvaCanvas(t);i.drawImage(c._canvas,t.x,t.y,c.getWidth()/c.getPixelRatio(),c.getHeight()/c.getPixelRatio())}),n}getIntersection(t){if(!t)return null;const n=this.children,i=n.length,r=i-1;for(let l=r;l>=0;l--){const c=n[l].getIntersection(t);if(c)return c}return null}_resizeDOM(){const t=this.width(),n=this.height();this.content&&(this.content.style.width=t+Uy,this.content.style.height=n+Uy),this.bufferCanvas.setSize(t,n),this.bufferHitCanvas.setSize(t,n),this.children.forEach(i=>{i.setSize({width:t,height:n}),i.draw()})}add(t,...n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const i=this.children.length;return i>o5&&vt.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Jt.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return j2(t,this)}setPointerCapture(t){U2(t,this)}releaseCapture(t){ed(t)}getLayers(){return this.children}_bindContentEvents(){Jt.isBrowser&&u5.forEach(([t,n])=>{this.content.addEventListener(t,i=>{this[n](i)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const n=Kc(t.type);n&&this._fire(n.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const n=Kc(t.type);n&&this._fire(n.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let n=this[t+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(t){const n=Kc(t.type),i=$h(t.type);if(!n)return;this.setPointersPositions(t);const r=this._getTargetShape(i),l=!(Jt.isDragging()||Jt.isTransforming())||Jt.hitOnDragEnabled;r&&l?(r._fireAndBubble(n.pointerout,{evt:t}),r._fireAndBubble(n.pointerleave,{evt:t}),this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):l&&(this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const n=Kc(t.type),i=$h(t.type);if(!n)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(l=>{const c=this.getIntersection(l);if(un.justDragged=!1,Jt["_"+i+"ListenClick"]=!0,!c||!c.isListening()){this[i+"ClickStartShape"]=void 0;return}Jt.capturePointerEventsEnabled&&c.setPointerCapture(l.id),this[i+"ClickStartShape"]=c,c._fireAndBubble(n.pointerdown,{evt:t,pointerId:l.id}),r=!0;const d=t.type.indexOf("touch")>=0;c.preventDefault()&&t.cancelable&&d&&t.preventDefault()}),r||this._fire(n.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const n=Kc(t.type),i=$h(t.type);if(!n)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(Jt.isDragging()&&un.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(Jt.isDragging()||Jt.isTransforming())||Jt.hitOnDragEnabled))return;const c={};let d=!1;const g=this._getTargetShape(i);this._changedPointerPositions.forEach(m=>{const _=Ap(m.id)||this.getIntersection(m),C=m.id,E={evt:t,pointerId:C},O=g!==_;if(O&&g&&(g._fireAndBubble(n.pointerout,{...E},_),g._fireAndBubble(n.pointerleave,{...E},_)),_){if(c[_._id])return;c[_._id]=!0}_&&_.isListening()?(d=!0,O&&(_._fireAndBubble(n.pointerover,{...E},g),_._fireAndBubble(n.pointerenter,{...E},g),this[i+"targetShape"]=_),_._fireAndBubble(n.pointermove,{...E})):g&&(this._fire(n.pointerover,{evt:t,target:this,currentTarget:this,pointerId:C}),this[i+"targetShape"]=null)}),d||this._fire(n.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const n=Kc(t.type),i=$h(t.type);if(!n)return;this.setPointersPositions(t);const r=this[i+"ClickStartShape"],l=this[i+"ClickEndShape"],c={};let d=!1;this._changedPointerPositions.forEach(g=>{const m=Ap(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),c[m._id])return;c[m._id]=!0}const _=g.id,C={evt:t,pointerId:_};let E=!1;Jt["_"+i+"InDblClickWindow"]?(E=!0,clearTimeout(this[i+"DblTimeout"])):un.justDragged||(Jt["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){Jt["_"+i+"InDblClickWindow"]=!1},Jt.dblClickWindow),m&&m.isListening()?(d=!0,this[i+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...C}),Jt["_"+i+"ListenClick"]&&r&&r===m&&(m._fireAndBubble(n.pointerclick,{...C}),E&&l&&l===m&&m._fireAndBubble(n.pointerdblclick,{...C}))):(this[i+"ClickEndShape"]=null,d||(this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),d=!0),Jt["_"+i+"ListenClick"]&&this._fire(n.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:_}),E&&this._fire(n.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:_}))}),d||this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Jt["_"+i+"ListenClick"]=!1,t.cancelable&&i!=="touch"&&i!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Om,{evt:t}):this._fire(Om,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Rm,{evt:t}):this._fire(Rm,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const n=Ap(t.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(sf,tv(t)),ed(t.pointerId)}_lostpointercapture(t){ed(t.pointerId)}setPointersPositions(t){const n=this._getContentPosition();let i=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,l=>{this._pointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,l=>{this._changedPointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})})):(i=(t.clientX-n.left)/n.scaleX,r=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:i,y:r},this._pointerPositions=[{x:i,y:r,id:vt._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:r,id:vt._getFirstPointerId(t)}])}_setPointerPosition(t){vt.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new so({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Wm({pixelRatio:1,width:this.width(),height:this.height()}),!Jt.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return vt.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Rg.prototype.nodeType=a5;Vn(Rg);st.addGetterSetter(Rg,"container");Jt.isBrowser&&document.addEventListener("visibilitychange",()=>{nd.forEach(o=>{o.batchDraw()})});const Y2="hasShadow",K2="shadowRGBA",Q2="patternImage",X2="linearGradient",F2="radialGradient";let Z0;function Op(){return Z0||(Z0=vt.createCanvasElement().getContext("2d"),Z0)}const id={};function f5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function h5(o){o.stroke()}function d5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function g5(o){o.stroke()}function p5(){this._clearCache(Y2)}function m5(){this._clearCache(K2)}function v5(){this._clearCache(Q2)}function y5(){this._clearCache(X2)}function S5(){this._clearCache(F2)}class Lt extends qt{constructor(t){super(t);let n;for(;n=vt.getRandomColor(),!(n&&!(n in id)););this.colorKey=n,id[n]=this}getContext(){return vt.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return vt.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(Y2,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Q2,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Op().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const i=new ja;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(Jt.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=i.getMatrix(),l=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(l)}return n}}_getLinearGradient(){return this._getCache(X2,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const n=Op(),i=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),l=n.createLinearGradient(i.x,i.y,r.x,r.y);for(let c=0;c<t.length;c+=2)l.addColorStop(t[c],t[c+1]);return l}}_getRadialGradient(){return this._getCache(F2,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const n=Op(),i=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),l=n.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let c=0;c<t.length;c+=2)l.addColorStop(t[c],t[c+1]);return l}}getShadowRGBA(){return this._getCache(K2,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=vt.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const n=this.getStage();if(!n)return!1;const i=n.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,void 0,!0),i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return qt.prototype.destroy.call(this),delete id[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=t||this.hasFill(),l=this.hasStroke(),c=this.getAbsoluteOpacity()!==1;if(r&&l&&c)return!0;const d=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(r&&l&&d&&g)}setStrokeHitEnabled(t){vt.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let n=!1,i=this.getParent();for(;i;){if(i.isCached()){n=!0;break}i=i.getParent()}const r=t.skipTransform,l=t.relativeTo||n&&this.getStage()||void 0,c=this.getSelfRect(),g=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=c.width+g,_=c.height+g,C=!t.skipShadow&&this.hasShadow(),E=C?this.shadowOffsetX():0,O=C?this.shadowOffsetY():0,v=m+Math.abs(E),D=_+Math.abs(O),L=C&&this.shadowBlur()||0,z=v+L*2,M=D+L*2,N={width:z,height:M,x:-(g/2+L)+Math.min(E,0)+c.x,y:-(g/2+L)+Math.min(O,0)+c.y};return r?N:this._transformedRect(N,l)}drawScene(t,n,i){const r=this.getLayer(),l=t||r.getCanvas(),c=l.getContext(),d=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let _;const C=n===this;if(!this.isVisible()&&!C)return this;if(d){c.save();const E=this.getAbsoluteTransform(n).getMatrix();return c.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedSceneCanvas(c),c.restore(),this}if(!g)return this;if(c.save(),this._useBufferCanvas()){_=this.getStage();const E=i||_.bufferCanvas,O=E.getContext();O.clear(),O.save(),O._applyLineJoin(this),O._applyMiterLimit(this);const v=this.getAbsoluteTransform(n).getMatrix();O.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.call(this,O,this),O.restore();const D=E.pixelRatio;m&&c._applyShadow(this),c._applyOpacity(this),c._applyGlobalCompositeOperation(this),c.drawImage(E._canvas,E.x||0,E.y||0,E.width/D,E.height/D)}else{if(c._applyLineJoin(this),c._applyMiterLimit(this),!C){const E=this.getAbsoluteTransform(n).getMatrix();c.transform(E[0],E[1],E[2],E[3],E[4],E[5]),c._applyOpacity(this),c._applyGlobalCompositeOperation(this)}m&&c._applyShadow(this),g.call(this,c,this)}return c.restore(),this}drawHit(t,n,i=!1){if(!this.shouldDrawHit(n,i))return this;const r=this.getLayer(),l=t||r.hitCanvas,c=l&&l.getContext(),d=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||vt.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){c.save();const C=this.getAbsoluteTransform(n).getMatrix();return c.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._drawCachedHitCanvas(c),c.restore(),this}if(!d)return this;if(c.save(),c._applyLineJoin(this),c._applyMiterLimit(this),!(this===n)){const C=this.getAbsoluteTransform(n).getMatrix();c.transform(C[0],C[1],C[2],C[3],C[4],C[5])}return d.call(this,c,this),c.restore(),this}drawHitFromCache(t=0){const n=this._getCanvasCache(),i=this._getCachedSceneCanvas(),r=n.hit,l=r.getContext(),c=r.getWidth(),d=r.getHeight();l.clear(),l.drawImage(i._canvas,0,0,c,d);try{const g=l.getImageData(0,0,c,d),m=g.data,_=m.length,C=vt._hexToRgb(this.colorKey);for(let E=0;E<_;E+=4)m[E+3]>t?(m[E]=C.r,m[E+1]=C.g,m[E+2]=C.b,m[E+3]=255):m[E+3]=0;l.putImageData(g,0,0)}catch(g){vt.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return j2(t,this)}setPointerCapture(t){U2(t,this)}releaseCapture(t){ed(t)}}Lt.prototype._fillFunc=f5;Lt.prototype._strokeFunc=h5;Lt.prototype._fillFuncHit=d5;Lt.prototype._strokeFuncHit=g5;Lt.prototype._centroid=!1;Lt.prototype.nodeType="Shape";Vn(Lt);Lt.prototype.eventListeners={};Lt.prototype.on.call(Lt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",p5);Lt.prototype.on.call(Lt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",m5);Lt.prototype.on.call(Lt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",v5);Lt.prototype.on.call(Lt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",y5);Lt.prototype.on.call(Lt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",S5);st.addGetterSetter(Lt,"stroke",void 0,M2());st.addGetterSetter(Lt,"strokeWidth",2,Vt());st.addGetterSetter(Lt,"fillAfterStrokeEnabled",!1);st.addGetterSetter(Lt,"hitStrokeWidth","auto",$m());st.addGetterSetter(Lt,"strokeHitEnabled",!0,Hr());st.addGetterSetter(Lt,"perfectDrawEnabled",!0,Hr());st.addGetterSetter(Lt,"shadowForStrokeEnabled",!0,Hr());st.addGetterSetter(Lt,"lineJoin");st.addGetterSetter(Lt,"lineCap");st.addGetterSetter(Lt,"miterLimit");st.addGetterSetter(Lt,"sceneFunc");st.addGetterSetter(Lt,"hitFunc");st.addGetterSetter(Lt,"dash");st.addGetterSetter(Lt,"dashOffset",0,Vt());st.addGetterSetter(Lt,"shadowColor",void 0,pu());st.addGetterSetter(Lt,"shadowBlur",0,Vt());st.addGetterSetter(Lt,"shadowOpacity",1,Vt());st.addComponentsGetterSetter(Lt,"shadowOffset",["x","y"]);st.addGetterSetter(Lt,"shadowOffsetX",0,Vt());st.addGetterSetter(Lt,"shadowOffsetY",0,Vt());st.addGetterSetter(Lt,"fillPatternImage");st.addGetterSetter(Lt,"fill",void 0,M2());st.addGetterSetter(Lt,"fillPatternX",0,Vt());st.addGetterSetter(Lt,"fillPatternY",0,Vt());st.addGetterSetter(Lt,"fillLinearGradientColorStops");st.addGetterSetter(Lt,"strokeLinearGradientColorStops");st.addGetterSetter(Lt,"fillRadialGradientStartRadius",0);st.addGetterSetter(Lt,"fillRadialGradientEndRadius",0);st.addGetterSetter(Lt,"fillRadialGradientColorStops");st.addGetterSetter(Lt,"fillPatternRepeat","repeat");st.addGetterSetter(Lt,"fillEnabled",!0);st.addGetterSetter(Lt,"strokeEnabled",!0);st.addGetterSetter(Lt,"shadowEnabled",!0);st.addGetterSetter(Lt,"dashEnabled",!0);st.addGetterSetter(Lt,"strokeScaleEnabled",!0);st.addGetterSetter(Lt,"fillPriority","color");st.addComponentsGetterSetter(Lt,"fillPatternOffset",["x","y"]);st.addGetterSetter(Lt,"fillPatternOffsetX",0,Vt());st.addGetterSetter(Lt,"fillPatternOffsetY",0,Vt());st.addComponentsGetterSetter(Lt,"fillPatternScale",["x","y"]);st.addGetterSetter(Lt,"fillPatternScaleX",1,Vt());st.addGetterSetter(Lt,"fillPatternScaleY",1,Vt());st.addComponentsGetterSetter(Lt,"fillLinearGradientStartPoint",["x","y"]);st.addComponentsGetterSetter(Lt,"strokeLinearGradientStartPoint",["x","y"]);st.addGetterSetter(Lt,"fillLinearGradientStartPointX",0);st.addGetterSetter(Lt,"strokeLinearGradientStartPointX",0);st.addGetterSetter(Lt,"fillLinearGradientStartPointY",0);st.addGetterSetter(Lt,"strokeLinearGradientStartPointY",0);st.addComponentsGetterSetter(Lt,"fillLinearGradientEndPoint",["x","y"]);st.addComponentsGetterSetter(Lt,"strokeLinearGradientEndPoint",["x","y"]);st.addGetterSetter(Lt,"fillLinearGradientEndPointX",0);st.addGetterSetter(Lt,"strokeLinearGradientEndPointX",0);st.addGetterSetter(Lt,"fillLinearGradientEndPointY",0);st.addGetterSetter(Lt,"strokeLinearGradientEndPointY",0);st.addComponentsGetterSetter(Lt,"fillRadialGradientStartPoint",["x","y"]);st.addGetterSetter(Lt,"fillRadialGradientStartPointX",0);st.addGetterSetter(Lt,"fillRadialGradientStartPointY",0);st.addComponentsGetterSetter(Lt,"fillRadialGradientEndPoint",["x","y"]);st.addGetterSetter(Lt,"fillRadialGradientEndPointX",0);st.addGetterSetter(Lt,"fillRadialGradientEndPointY",0);st.addGetterSetter(Lt,"fillPatternRotation",0);st.addGetterSetter(Lt,"fillRule",void 0,pu());st.backCompat(Lt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const b5="#",_5="beforeDraw",E5="draw",J2=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],C5=J2.length;let mu=class extends za{constructor(t){super(t),this.canvas=new so,this.hitCanvas=new Wm({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),t<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[t+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){qt.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!qt.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(qt.prototype.moveDown.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(qt.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return qt.prototype.remove.call(this),t&&t.parentNode&&vt._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:n}){return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&vt.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),qt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){vt.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){vt.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,vt.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let n=1,i=!1;for(;;){for(let r=0;r<C5;r++){const l=J2[r],c=this._getIntersection({x:t.x+l.x*n,y:t.y+l.y*n}),d=c.shape;if(d)return d;if(i=!!c.antialiased,!c.antialiased)break}if(i)n+=1;else return null}}_getIntersection(t){const n=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*n),Math.round(t.y*n),1,1).data,r=i[3];if(r===255){const l=vt._rgbToHex(i[0],i[1],i[2]),c=id[b5+l];return c?{shape:c}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,n,i){const r=this.getLayer(),l=t||r&&r.getCanvas();return this._fire(_5,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),za.prototype.drawScene.call(this,l,n,i),this._fire(E5,{node:this}),this}drawHit(t,n){const i=this.getLayer(),r=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),za.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){vt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return vt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return vt.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};mu.prototype.nodeType="Layer";Vn(mu);st.addGetterSetter(mu,"imageSmoothingEnabled",!0);st.addGetterSetter(mu,"clearBeforeDraw",!0);st.addGetterSetter(mu,"hitGraphEnabled",!0,Hr());class ev extends mu{constructor(t){super(t),this.listening(!1),vt.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}ev.prototype.nodeType="FastLayer";Vn(ev);class of extends za{_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&vt.throw("You may only add groups and shapes to groups.")}}of.prototype.nodeType="Group";Vn(of);const Rp=(function(){return hu.performance&&hu.performance.now?function(){return hu.performance.now()}:function(){return new Date().getTime()}})();class ur{constructor(t,n){this.id=ur.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Rp(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(t){let n=[];return t&&(n=Array.isArray(t)?t:[t]),this.layers=n,this}getLayers(){return this.layers}addLayer(t){const n=this.layers,i=n.length;for(let r=0;r<i;r++)if(n[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const n=ur.animations,i=n.length;for(let r=0;r<i;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Rp(),ur._addAnimation(this),this}stop(){return ur._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const n=t.id,i=this.animations,r=i.length;for(let l=0;l<r;l++)if(i[l].id===n){this.animations.splice(l,1);break}}static _runFrames(){const t={},n=this.animations;for(let i=0;i<n.length;i++){const r=n[i],l=r.layers,c=r.func;r._updateFrameObject(Rp());const d=l.length;let g;if(c?g=c.call(r,r.frame)!==!1:g=!0,!!g)for(let m=0;m<d;m++){const _=l[m];_._id!==void 0&&(t[_._id]=_)}}for(const i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=ur;t.animations.length?(t._runFrames(),vt.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,vt.requestAnimFrame(this._animationLoop))}}ur.animations=[];ur.animIdCounter=0;ur.animRunning=!1;const T5={node:1,duration:1,easing:1,onFinish:1,yoyo:1},A5=1,zy=2,Ly=3,Gy=["fill","stroke","shadowColor"];let w5=0;class O5{constructor(t,n,i,r,l,c,d){this.prop=t,this.propFunc=n,this.begin=r,this._pos=r,this.duration=c,this._change=0,this.prevPos=0,this.yoyo=d,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=l-this.begin,this.pause()}fire(t){const n=this[t];n&&n()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=zy,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Ly,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===zy?this.setTime(t):this.state===Ly&&this.setTime(this.duration-t)}pause(){this.state=A5,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Rn{constructor(t){const n=this,i=t.node,r=i._id,l=t.easing||ad.Linear,c=!!t.yoyo;let d,g;typeof t.duration>"u"?d=.3:t.duration===0?d=.001:d=t.duration,this.node=i,this._id=w5++;const m=i.getLayer()||(i instanceof Jt.Stage?i.getLayers():null);m||vt.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new ur(function(){n.tween.onEnterFrame()},m),this.tween=new O5(g,function(_){n._tweenFunc(_)},l,0,1,d*1e3,c),this._addListeners(),Rn.attrs[r]||(Rn.attrs[r]={}),Rn.attrs[r][this._id]||(Rn.attrs[r][this._id]={}),Rn.tweens[r]||(Rn.tweens[r]={});for(g in t)T5[g]===void 0&&this._addAttr(g,t[g]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,n){const i=this.node,r=i._id;let l,c,d,g,m;const _=Rn.tweens[r][t];_&&delete Rn.attrs[r][_][t];let C=i.getAttr(t);if(vt._isArray(n))if(l=[],c=Math.max(n.length,C.length),t==="points"&&n.length!==C.length&&(n.length>C.length?(g=C,C=vt._prepareArrayForTween(C,n,i.closed())):(d=n,n=vt._prepareArrayForTween(n,C,i.closed()))),t.indexOf("fill")===0)for(let E=0;E<c;E++)if(E%2===0)l.push(n[E]-C[E]);else{const O=vt.colorToRGBA(C[E]);m=vt.colorToRGBA(n[E]),C[E]=O,l.push({r:m.r-O.r,g:m.g-O.g,b:m.b-O.b,a:m.a-O.a})}else for(let E=0;E<c;E++)l.push(n[E]-C[E]);else Gy.indexOf(t)!==-1?(C=vt.colorToRGBA(C),m=vt.colorToRGBA(n),l={r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a}):l=n-C;Rn.attrs[r][this._id][t]={start:C,diff:l,end:n,trueEnd:d,trueStart:g},Rn.tweens[r][t]=this._id}_tweenFunc(t){const n=this.node,i=Rn.attrs[n._id][this._id];let r,l,c,d,g,m,_,C;for(r in i){if(l=i[r],c=l.start,d=l.diff,C=l.end,vt._isArray(c))if(g=[],_=Math.max(c.length,C.length),r.indexOf("fill")===0)for(m=0;m<_;m++)m%2===0?g.push((c[m]||0)+d[m]*t):g.push("rgba("+Math.round(c[m].r+d[m].r*t)+","+Math.round(c[m].g+d[m].g*t)+","+Math.round(c[m].b+d[m].b*t)+","+(c[m].a+d[m].a*t)+")");else for(m=0;m<_;m++)g.push((c[m]||0)+d[m]*t);else Gy.indexOf(r)!==-1?g="rgba("+Math.round(c.r+d.r*t)+","+Math.round(c.g+d.g*t)+","+Math.round(c.b+d.b*t)+","+(c.a+d.a*t)+")":g=c+d*t;n.setAttr(r,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,n=Rn.attrs[t._id][this._id];n.points&&n.points.trueEnd&&t.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,n=Rn.attrs[t._id][this._id];n.points&&n.points.trueStart&&t.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,n=this._id,i=Rn.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in i)delete Rn.tweens[t][r];delete Rn.attrs[t][n],Rn.tweens[t]&&(Object.keys(Rn.tweens[t]).length===0&&delete Rn.tweens[t],Object.keys(Rn.attrs[t]).length===0&&delete Rn.attrs[t])}}Rn.attrs={};Rn.tweens={};qt.prototype.to=function(o){const t=o.onFinish;o.node=this,o.onFinish=function(){this.destroy(),t&&t()},new Rn(o).play()};const ad={BackEaseIn(o,t,n,i){return n*(o/=i)*o*((1.70158+1)*o-1.70158)+t},BackEaseOut(o,t,n,i){return n*((o=o/i-1)*o*((1.70158+1)*o+1.70158)+1)+t},BackEaseInOut(o,t,n,i){let r=1.70158;return(o/=i/2)<1?n/2*(o*o*(((r*=1.525)+1)*o-r))+t:n/2*((o-=2)*o*(((r*=1.525)+1)*o+r)+2)+t},ElasticEaseIn(o,t,n,i,r,l){let c=0;return o===0?t:(o/=i)===1?t+n:(l||(l=i*.3),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(o-=1))*Math.sin((o*i-c)*(2*Math.PI)/l))+t)},ElasticEaseOut(o,t,n,i,r,l){let c=0;return o===0?t:(o/=i)===1?t+n:(l||(l=i*.3),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*o)*Math.sin((o*i-c)*(2*Math.PI)/l)+n+t)},ElasticEaseInOut(o,t,n,i,r,l){let c=0;return o===0?t:(o/=i/2)===2?t+n:(l||(l=i*(.3*1.5)),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),o<1?-.5*(r*Math.pow(2,10*(o-=1))*Math.sin((o*i-c)*(2*Math.PI)/l))+t:r*Math.pow(2,-10*(o-=1))*Math.sin((o*i-c)*(2*Math.PI)/l)*.5+n+t)},BounceEaseOut(o,t,n,i){return(o/=i)<1/2.75?n*(7.5625*o*o)+t:o<2/2.75?n*(7.5625*(o-=1.5/2.75)*o+.75)+t:o<2.5/2.75?n*(7.5625*(o-=2.25/2.75)*o+.9375)+t:n*(7.5625*(o-=2.625/2.75)*o+.984375)+t},BounceEaseIn(o,t,n,i){return n-ad.BounceEaseOut(i-o,0,n,i)+t},BounceEaseInOut(o,t,n,i){return o<i/2?ad.BounceEaseIn(o*2,0,n,i)*.5+t:ad.BounceEaseOut(o*2-i,0,n,i)*.5+n*.5+t},EaseIn(o,t,n,i){return n*(o/=i)*o+t},EaseOut(o,t,n,i){return-n*(o/=i)*(o-2)+t},EaseInOut(o,t,n,i){return(o/=i/2)<1?n/2*o*o+t:-n/2*(--o*(o-2)-1)+t},StrongEaseIn(o,t,n,i){return n*(o/=i)*o*o*o*o+t},StrongEaseOut(o,t,n,i){return n*((o=o/i-1)*o*o*o*o+1)+t},StrongEaseInOut(o,t,n,i){return(o/=i/2)<1?n/2*o*o*o*o*o+t:n/2*((o-=2)*o*o*o*o+2)+t},Linear(o,t,n,i){return n*o/i+t}},uf=vt._assign(Jt,{Util:vt,Transform:ja,Node:qt,Container:za,Stage:Rg,stages:nd,Layer:mu,FastLayer:ev,Group:of,DD:un,Shape:Lt,shapes:id,Animation:ur,Tween:Rn,Easings:ad,Context:wg,Canvas:Zm});class dl extends Lt{_sceneFunc(t){const n=Jt.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,n,i),t.arc(0,0,this.innerRadius(),n,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),n=this.outerRadius(),i=this.clockwise(),r=Jt.getAngle(i?360-this.angle():this.angle()),l=Math.cos(Math.min(r,Math.PI)),c=1,d=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),g=Math.sin(Math.min(r,Math.PI/2)),m=l*(l>0?t:n),_=c*n,C=d*(d>0?t:n),E=g*(g>0?n:t);return{x:m,y:i?-1*E:C,width:_-m,height:E-C}}}dl.prototype._centroid=!0;dl.prototype.className="Arc";dl.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];Vn(dl);st.addGetterSetter(dl,"innerRadius",0,Vt());st.addGetterSetter(dl,"outerRadius",0,Vt());st.addGetterSetter(dl,"angle",0,Vt());st.addGetterSetter(dl,"clockwise",!1,Hr());function xm(o,t,n,i,r,l,c){const d=Math.sqrt(Math.pow(n-o,2)+Math.pow(i-t,2)),g=Math.sqrt(Math.pow(r-n,2)+Math.pow(l-i,2)),m=c*d/(d+g),_=c*g/(d+g),C=n-m*(r-o),E=i-m*(l-t),O=n+_*(r-o),v=i+_*(l-t);return[C,E,O,v]}function Hy(o,t){const n=o.length,i=[];for(let r=2;r<n-2;r+=2){const l=xm(o[r-2],o[r-1],o[r],o[r+1],o[r+2],o[r+3],t);isNaN(l[0])||(i.push(l[0]),i.push(l[1]),i.push(o[r]),i.push(o[r+1]),i.push(l[2]),i.push(l[3]))}return i}let gl=class extends Lt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const n=this.points(),i=n.length,r=this.tension(),l=this.closed(),c=this.bezier();if(!i)return;let d=0;if(t.beginPath(),t.moveTo(n[0],n[1]),r!==0&&i>4){const g=this.getTensionPoints(),m=g.length;for(d=l?0:4,l||t.quadraticCurveTo(g[0],g[1],g[2],g[3]);d<m-2;)t.bezierCurveTo(g[d++],g[d++],g[d++],g[d++],g[d++],g[d++]);l||t.quadraticCurveTo(g[m-2],g[m-1],n[i-2],n[i-1])}else if(c)for(d=2;d<i;)t.bezierCurveTo(n[d++],n[d++],n[d++],n[d++],n[d++],n[d++]);else for(d=2;d<i;d+=2)t.lineTo(n[d],n[d+1]);l?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Hy(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),n=t.length,i=this.tension(),r=xm(t[n-2],t[n-1],t[0],t[1],t[2],t[3],i),l=xm(t[n-4],t[n-3],t[n-2],t[n-1],t[0],t[1],i),c=Hy(t,i);return[r[2],r[3]].concat(c).concat([l[0],l[1],t[n-2],t[n-1],l[2],l[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let n=t[0],i=t[0],r=t[1],l=t[1],c,d;for(let g=0;g<t.length/2;g++)c=t[g*2],d=t[g*2+1],n=Math.min(n,c),i=Math.max(i,c),r=Math.min(r,d),l=Math.max(l,d);return{x:n,y:r,width:i-n,height:l-r}}};gl.prototype.className="Line";gl.prototype._attrsAffectingSize=["points","bezier","tension"];Vn(gl);st.addGetterSetter(gl,"closed",!1);st.addGetterSetter(gl,"bezier",!1);st.addGetterSetter(gl,"tension",0,Vt());st.addGetterSetter(gl,"points",[],q3());const R5=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],x5=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],N5=[[1],[1,1],[1,2,1],[1,3,3,1]],Py=(o,t,n)=>{let i,r;const c=n/2;i=0;for(let d=0;d<20;d++)r=c*R5[20][d]+c,i+=x5[20][d]*M5(o,t,r);return c*i},Iy=(o,t,n)=>{n===void 0&&(n=1);const i=o[0]-2*o[1]+o[2],r=t[0]-2*t[1]+t[2],l=2*o[1]-2*o[0],c=2*t[1]-2*t[0],d=4*(i*i+r*r),g=4*(i*l+r*c),m=l*l+c*c;if(d===0)return n*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(t[2]-t[0],2));const _=g/(2*d),C=m/d,E=n+_,O=C-_*_,v=E*E+O>0?Math.sqrt(E*E+O):0,D=_*_+O>0?Math.sqrt(_*_+O):0,L=_+Math.sqrt(_*_+O)!==0?O*Math.log(Math.abs((E+v)/(_+D))):0;return Math.sqrt(d)/2*(E*v-_*D+L)};function M5(o,t,n){const i=Nm(1,n,o),r=Nm(1,n,t),l=i*i+r*r;return Math.sqrt(l)}const Nm=(o,t,n)=>{const i=n.length-1;let r,l;if(i===0)return 0;if(o===0){l=0;for(let c=0;c<=i;c++)l+=N5[i][c]*Math.pow(1-t,i-c)*Math.pow(t,c)*n[c];return l}else{r=new Array(i);for(let c=0;c<i;c++)r[c]=i*(n[c+1]-n[c]);return Nm(o-1,t,r)}},ky=(o,t,n)=>{let i=1,r=o/t,l=(o-n(r))/t,c=0;for(;i>.001;){const d=n(r+l),g=Math.abs(o-d)/t;if(g<i)i=g,r+=l;else{const m=n(r-l),_=Math.abs(o-m)/t;_<i?(i=_,r-=l):l/=2}if(c++,c>500)break}return r};class xn extends Lt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=xn.parsePathData(this.data()),this.pathLength=xn.getPathLength(this.dataArray)}_sceneFunc(t){const n=this.dataArray;t.beginPath();let i=!1;for(let r=0;r<n.length;r++){const l=n[r].command,c=n[r].points;switch(l){case"L":t.lineTo(c[0],c[1]);break;case"M":t.moveTo(c[0],c[1]);break;case"C":t.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":t.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":const d=c[0],g=c[1],m=c[2],_=c[3],C=c[4],E=c[5],O=c[6],v=c[7],D=m>_?m:_,L=m>_?1:m/_,z=m>_?_/m:1;t.translate(d,g),t.rotate(O),t.scale(L,z),t.arc(0,0,D,C,C+E,1-v),t.scale(1/L,1/z),t.rotate(-O),t.translate(-d,-g);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],_=g.points[5],C=g.points[4]+_;let E=Math.PI/180;if(Math.abs(m-C)<E&&(E=Math.abs(m-C)),_<0)for(let O=m-E;O>C;O-=E){const v=xn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],O,0);t.push(v.x,v.y)}else for(let O=m+E;O<C;O+=E){const v=xn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],O,0);t.push(v.x,v.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const _=xn.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);t.push(_.x,_.y)}else t=t.concat(g.points)});let n=t[0],i=t[0],r=t[1],l=t[1],c,d;for(let g=0;g<t.length/2;g++)c=t[g*2],d=t[g*2+1],isNaN(c)||(n=Math.min(n,c),i=Math.max(i,c)),isNaN(d)||(r=Math.min(r,d),l=Math.max(l,d));return{x:n,y:r,width:i-n,height:l-r}}getLength(){return this.pathLength}getPointAtLength(t){return xn.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,n,i,r){return Math.sqrt((i-t)*(i-t)+(r-n)*(r-n))}static getPathLength(t){let n=0;for(let i=0;i<t.length;++i)n+=t[i].pathLength;return n}static getPointAtLengthOfDataArray(t,n){let i,r=0,l=n.length;if(!l)return null;for(;r<l&&t>n[r].pathLength;)t-=n[r].pathLength,++r;if(r===l)return i=n[r-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return n[r].command==="M"?(i=n[r].points.slice(0,2),{x:i[0],y:i[1]}):{x:n[r].start.x,y:n[r].start.y};const c=n[r],d=c.points;switch(c.command){case"L":return xn.getPointOnLine(t,c.start.x,c.start.y,d[0],d[1]);case"C":return xn.getPointOnCubicBezier(ky(t,xn.getPathLength(n),D=>Py([c.start.x,d[0],d[2],d[4]],[c.start.y,d[1],d[3],d[5]],D)),c.start.x,c.start.y,d[0],d[1],d[2],d[3],d[4],d[5]);case"Q":return xn.getPointOnQuadraticBezier(ky(t,xn.getPathLength(n),D=>Iy([c.start.x,d[0],d[2]],[c.start.y,d[1],d[3]],D)),c.start.x,c.start.y,d[0],d[1],d[2],d[3]);case"A":const g=d[0],m=d[1],_=d[2],C=d[3],E=d[5],O=d[6];let v=d[4];return v+=E*t/c.pathLength,xn.getPointOnEllipticalArc(g,m,_,C,v,O)}return null}static getPointOnLine(t,n,i,r,l,c,d){c=c??n,d=d??i;const g=this.getLineLength(n,i,r,l);if(g<1e-10)return{x:n,y:i};if(r===n)return{x:c,y:d+(l>i?t:-t)};const m=(l-i)/(r-n),_=Math.sqrt(t*t/(1+m*m))*(r<n?-1:1),C=m*_;if(Math.abs(d-i-m*(c-n))<1e-10)return{x:c+_,y:d+C};const E=((c-n)*(r-n)+(d-i)*(l-i))/(g*g),O=n+E*(r-n),v=i+E*(l-i),D=this.getLineLength(c,d,O,v),L=Math.sqrt(t*t-D*D),z=Math.sqrt(L*L/(1+m*m))*(r<n?-1:1),M=m*z;return{x:O+z,y:v+M}}static getPointOnCubicBezier(t,n,i,r,l,c,d,g,m){function _(L){return L*L*L}function C(L){return 3*L*L*(1-L)}function E(L){return 3*L*(1-L)*(1-L)}function O(L){return(1-L)*(1-L)*(1-L)}const v=g*_(t)+c*C(t)+r*E(t)+n*O(t),D=m*_(t)+d*C(t)+l*E(t)+i*O(t);return{x:v,y:D}}static getPointOnQuadraticBezier(t,n,i,r,l,c,d){function g(O){return O*O}function m(O){return 2*O*(1-O)}function _(O){return(1-O)*(1-O)}const C=c*g(t)+r*m(t)+n*_(t),E=d*g(t)+l*m(t)+i*_(t);return{x:C,y:E}}static getPointOnEllipticalArc(t,n,i,r,l,c){const d=Math.cos(c),g=Math.sin(c),m={x:i*Math.cos(l),y:r*Math.sin(l)};return{x:t+(m.x*d-m.y*g),y:n+(m.x*g+m.y*d)}}static parsePathData(t){if(!t)return[];let n=t;const i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let C=0;C<i.length;C++)n=n.replace(new RegExp(i[C],"g"),"|"+i[C]);const r=n.split("|"),l=[],c=[];let d=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let C=1;C<r.length;C++){let E=r[C],O=E.charAt(0);for(E=E.slice(1),c.length=0;_=m.exec(E);)c.push(_[0]);let v=[],D=O==="A"||O==="a"?0:-1;for(let L=0,z=c.length;L<z;L++){const M=c[L];if(M==="00"){v.push(0,0),D>=0&&(D+=2,D>=7&&(D-=7));continue}if(D>=0){if(D===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(M)){v.push(parseInt(M[0],10)),v.push(parseInt(M[1],10)),v.push(parseFloat(M.slice(2))),D+=3,D>=7&&(D-=7);continue}if(M==="11"||M==="10"||M==="01"){v.push(parseInt(M[0],10)),v.push(parseInt(M[1],10)),D+=2,D>=7&&(D-=7);continue}if(M==="0"||M==="1"){v.push(parseInt(M,10)),D+=1,D>=7&&(D-=7);continue}}else if(D===4){if(/^[01]\d+(?:\.\d+)?$/.test(M)){v.push(parseInt(M[0],10)),v.push(parseFloat(M.slice(1))),D+=2,D>=7&&(D-=7);continue}if(M==="0"||M==="1"){v.push(parseInt(M,10)),D+=1,D>=7&&(D-=7);continue}}const N=parseFloat(M);isNaN(N)?v.push(0):v.push(N),D+=1,D>=7&&(D-=7)}else{const N=parseFloat(M);isNaN(N)?v.push(0):v.push(N)}}for(;v.length>0&&!isNaN(v[0]);){let L="",z=[];const M=d,N=g;let G,R,A,T,y,B,j,H,Q,K;switch(O){case"l":d+=v.shift(),g+=v.shift(),L="L",z.push(d,g);break;case"L":d=v.shift(),g=v.shift(),z.push(d,g);break;case"m":const X=v.shift(),V=v.shift();if(d+=X,g+=V,L="M",l.length>2&&l[l.length-1].command==="z"){for(let U=l.length-2;U>=0;U--)if(l[U].command==="M"){d=l[U].points[0]+X,g=l[U].points[1]+V;break}}z.push(d,g),O="l";break;case"M":d=v.shift(),g=v.shift(),L="M",z.push(d,g),O="L";break;case"h":d+=v.shift(),L="L",z.push(d,g);break;case"H":d=v.shift(),L="L",z.push(d,g);break;case"v":g+=v.shift(),L="L",z.push(d,g);break;case"V":g=v.shift(),L="L",z.push(d,g);break;case"C":z.push(v.shift(),v.shift(),v.shift(),v.shift()),d=v.shift(),g=v.shift(),z.push(d,g);break;case"c":z.push(d+v.shift(),g+v.shift(),d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),L="C",z.push(d,g);break;case"S":R=d,A=g,G=l[l.length-1],G.command==="C"&&(R=d+(d-G.points[2]),A=g+(g-G.points[3])),z.push(R,A,v.shift(),v.shift()),d=v.shift(),g=v.shift(),L="C",z.push(d,g);break;case"s":R=d,A=g,G=l[l.length-1],G.command==="C"&&(R=d+(d-G.points[2]),A=g+(g-G.points[3])),z.push(R,A,d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),L="C",z.push(d,g);break;case"Q":z.push(v.shift(),v.shift()),d=v.shift(),g=v.shift(),z.push(d,g);break;case"q":z.push(d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),L="Q",z.push(d,g);break;case"T":R=d,A=g,G=l[l.length-1],G.command==="Q"&&(R=d+(d-G.points[0]),A=g+(g-G.points[1])),d=v.shift(),g=v.shift(),L="Q",z.push(R,A,d,g);break;case"t":R=d,A=g,G=l[l.length-1],G.command==="Q"&&(R=d+(d-G.points[0]),A=g+(g-G.points[1])),d+=v.shift(),g+=v.shift(),L="Q",z.push(R,A,d,g);break;case"A":T=v.shift(),y=v.shift(),B=v.shift(),j=v.shift(),H=v.shift(),Q=d,K=g,d=v.shift(),g=v.shift(),L="A",z=this.convertEndpointToCenterParameterization(Q,K,d,g,j,H,T,y,B);break;case"a":T=v.shift(),y=v.shift(),B=v.shift(),j=v.shift(),H=v.shift(),Q=d,K=g,d+=v.shift(),g+=v.shift(),L="A",z=this.convertEndpointToCenterParameterization(Q,K,d,g,j,H,T,y,B);break}l.push({command:L||O,points:z,start:{x:M,y:N},pathLength:this.calcLength(M,N,L||O,z)})}(O==="z"||O==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(t,n,i,r){let l,c,d,g;const m=xn;switch(i){case"L":return m.getLineLength(t,n,r[0],r[1]);case"C":return Py([t,r[0],r[2],r[4]],[n,r[1],r[3],r[5]],1);case"Q":return Iy([t,r[0],r[2]],[n,r[1],r[3]],1);case"A":l=0;const _=r[4],C=r[5],E=r[4]+C;let O=Math.PI/180;if(Math.abs(_-E)<O&&(O=Math.abs(_-E)),c=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],_,0),C<0)for(g=_-O;g>E;g-=O)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),c=d;else for(g=_+O;g<E;g+=O)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),c=d;return d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],E,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),l}return 0}static convertEndpointToCenterParameterization(t,n,i,r,l,c,d,g,m){const _=m*(Math.PI/180),C=Math.cos(_)*(t-i)/2+Math.sin(_)*(n-r)/2,E=-1*Math.sin(_)*(t-i)/2+Math.cos(_)*(n-r)/2,O=C*C/(d*d)+E*E/(g*g);O>1&&(d*=Math.sqrt(O),g*=Math.sqrt(O));let v=Math.sqrt((d*d*(g*g)-d*d*(E*E)-g*g*(C*C))/(d*d*(E*E)+g*g*(C*C)));l===c&&(v*=-1),isNaN(v)&&(v=0);const D=v*d*E/g,L=v*-g*C/d,z=(t+i)/2+Math.cos(_)*D-Math.sin(_)*L,M=(n+r)/2+Math.sin(_)*D+Math.cos(_)*L,N=function(j){return Math.sqrt(j[0]*j[0]+j[1]*j[1])},G=function(j,H){return(j[0]*H[0]+j[1]*H[1])/(N(j)*N(H))},R=function(j,H){return(j[0]*H[1]<j[1]*H[0]?-1:1)*Math.acos(G(j,H))},A=R([1,0],[(C-D)/d,(E-L)/g]),T=[(C-D)/d,(E-L)/g],y=[(-1*C-D)/d,(-1*E-L)/g];let B=R(T,y);return G(T,y)<=-1&&(B=Math.PI),G(T,y)>=1&&(B=0),c===0&&B>0&&(B=B-2*Math.PI),c===1&&B<0&&(B=B+2*Math.PI),[z,M,d,g,A,B,_,c]}}xn.prototype.className="Path";xn.prototype._attrsAffectingSize=["data"];Vn(xn);st.addGetterSetter(xn,"data");class vu extends gl{_sceneFunc(t){super._sceneFunc(t);const n=Math.PI*2,i=this.points();let r=i;const l=this.tension()!==0&&i.length>4;l&&(r=this.getTensionPoints());const c=this.pointerLength(),d=i.length;let g,m;if(l){const E=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],i[d-2],i[d-1]],O=xn.calcLength(r[r.length-4],r[r.length-3],"C",E),v=xn.getPointOnQuadraticBezier(Math.min(1,1-c/O),E[0],E[1],E[2],E[3],E[4],E[5]);g=i[d-2]-v.x,m=i[d-1]-v.y}else g=i[d-2]-i[d-4],m=i[d-1]-i[d-3];const _=(Math.atan2(m,g)+n)%n,C=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[d-2],i[d-1]),t.rotate(_),t.moveTo(0,0),t.lineTo(-c,C/2),t.lineTo(-c,-C/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),l?(g=(r[0]+r[2])/2-i[0],m=(r[1]+r[3])/2-i[1]):(g=i[2]-i[0],m=i[3]-i[1]),t.rotate((Math.atan2(-m,-g)+n)%n),t.moveTo(0,0),t.lineTo(-c,C/2),t.lineTo(-c,-C/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),n=this.pointerWidth()/2;return{x:t.x,y:t.y-n,width:t.width,height:t.height+n*2}}}vu.prototype.className="Arrow";Vn(vu);st.addGetterSetter(vu,"pointerLength",10,Vt());st.addGetterSetter(vu,"pointerWidth",10,Vt());st.addGetterSetter(vu,"pointerAtBeginning",!1);st.addGetterSetter(vu,"pointerAtEnding",!0);class mf extends Lt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}mf.prototype._centroid=!0;mf.prototype.className="Circle";mf.prototype._attrsAffectingSize=["radius"];Vn(mf);st.addGetterSetter(mf,"radius",0,Vt());class fo extends Lt{_sceneFunc(t){const n=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),n!==i&&t.scale(1,i/n),t.arc(0,0,n,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}fo.prototype.className="Ellipse";fo.prototype._centroid=!0;fo.prototype._attrsAffectingSize=["radiusX","radiusY"];Vn(fo);st.addComponentsGetterSetter(fo,"radius",["x","y"]);st.addGetterSetter(fo,"radiusX",0,Vt());st.addGetterSetter(fo,"radiusY",0,Vt());let Pr=class Z2 extends Lt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),n=this.hasShadow();return t&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const n=this.getWidth(),i=this.getHeight(),r=this.cornerRadius(),l=this.attrs.image;let c;if(l){const d=this.attrs.cropWidth,g=this.attrs.cropHeight;d&&g?c=[l,this.cropX(),this.cropY(),d,g,0,0,n,i]:c=[l,0,0,n,i]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?vt.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)),l&&(r&&t.clip(),t.drawImage.apply(t,c))}_hitFunc(t){const n=this.width(),i=this.height(),r=this.cornerRadius();t.beginPath(),r?vt.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,n,i;return(i=(t=this.attrs.width)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&i!==void 0?i:0}getHeight(){var t,n,i;return(i=(t=this.attrs.height)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&i!==void 0?i:0}static fromURL(t,n,i=null){const r=vt.createImageElement();r.onload=function(){const l=new Z2({image:r});n(l)},r.onerror=i,r.crossOrigin="Anonymous",r.src=t}};Pr.prototype.className="Image";Pr.prototype._attrsAffectingSize=["image"];Vn(Pr);st.addGetterSetter(Pr,"cornerRadius",0,Og(4));st.addGetterSetter(Pr,"image");st.addComponentsGetterSetter(Pr,"crop",["x","y","width","height"]);st.addGetterSetter(Pr,"cropX",0,Vt());st.addGetterSetter(Pr,"cropY",0,Vt());st.addGetterSetter(Pr,"cropWidth",0,Vt());st.addGetterSetter(Pr,"cropHeight",0,Vt());const W2=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],D5="Change.konva",j5="none",Mm="up",Dm="right",jm="down",Um="left",U5=W2.length;class nv extends of{constructor(t){super(t),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let n=this,i;const r=function(){n._sync()};for(i=0;i<U5;i++)t.on(W2[i]+D5,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),n=this.getTag(),i,r,l,c,d,g,m;if(t&&n){switch(i=t.width(),r=t.height(),l=n.pointerDirection(),c=n.pointerWidth(),m=n.pointerHeight(),d=0,g=0,l){case Mm:d=i/2,g=-1*m;break;case Dm:d=i+c,g=r/2;break;case jm:d=i/2,g=r+m;break;case Um:d=-1*c,g=r/2;break}n.setAttrs({x:-1*d,y:-1*g,width:i,height:r}),t.setAttrs({x:-1*d,y:-1*g})}}}nv.prototype.className="Label";Vn(nv);class yu extends Lt{_sceneFunc(t){const n=this.width(),i=this.height(),r=this.pointerDirection(),l=this.pointerWidth(),c=this.pointerHeight(),d=this.cornerRadius();let g=0,m=0,_=0,C=0;typeof d=="number"?g=m=_=C=Math.min(d,n/2,i/2):(g=Math.min(d[0]||0,n/2,i/2),m=Math.min(d[1]||0,n/2,i/2),C=Math.min(d[2]||0,n/2,i/2),_=Math.min(d[3]||0,n/2,i/2)),t.beginPath(),t.moveTo(g,0),r===Mm&&(t.lineTo((n-l)/2,0),t.lineTo(n/2,-1*c),t.lineTo((n+l)/2,0)),t.lineTo(n-m,0),t.arc(n-m,m,m,Math.PI*3/2,0,!1),r===Dm&&(t.lineTo(n,(i-c)/2),t.lineTo(n+l,i/2),t.lineTo(n,(i+c)/2)),t.lineTo(n,i-C),t.arc(n-C,i-C,C,0,Math.PI/2,!1),r===jm&&(t.lineTo((n+l)/2,i),t.lineTo(n/2,i+c),t.lineTo((n-l)/2,i)),t.lineTo(_,i),t.arc(_,i-_,_,Math.PI/2,Math.PI,!1),r===Um&&(t.lineTo(0,(i+c)/2),t.lineTo(-1*l,i/2),t.lineTo(0,(i-c)/2)),t.lineTo(0,g),t.arc(g,g,g,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,n=0,i=this.pointerWidth(),r=this.pointerHeight(),l=this.pointerDirection(),c=this.width(),d=this.height();return l===Mm?(n-=r,d+=r):l===jm?d+=r:l===Um?(t-=i*1.5,c+=i):l===Dm&&(c+=i*1.5),{x:t,y:n,width:c,height:d}}}yu.prototype.className="Tag";Vn(yu);st.addGetterSetter(yu,"pointerDirection",j5);st.addGetterSetter(yu,"pointerWidth",0,Vt());st.addGetterSetter(yu,"pointerHeight",0,Vt());st.addGetterSetter(yu,"cornerRadius",0,Og(4));class pd extends Lt{_sceneFunc(t){const n=this.cornerRadius(),i=this.width(),r=this.height();t.beginPath(),n?vt.drawRoundedRectPath(t,i,r,n):t.rect(0,0,i,r),t.closePath(),t.fillStrokeShape(this)}}pd.prototype.className="Rect";Vn(pd);st.addGetterSetter(pd,"cornerRadius",0,Og(4));class ho extends Lt{_sceneFunc(t){const n=this._getPoints(),i=this.radius(),r=this.sides(),l=this.cornerRadius();if(t.beginPath(),l)vt.drawRoundedPolygonPath(t,n,r,i,l);else{t.moveTo(n[0].x,n[0].y);for(let c=1;c<n.length;c++)t.lineTo(n[c].x,n[c].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,n=this.attrs.radius||0,i=[];for(let r=0;r<t;r++)i.push({x:n*Math.sin(r*2*Math.PI/t),y:-1*n*Math.cos(r*2*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();let n=t[0].x,i=t[0].y,r=t[0].x,l=t[0].y;return t.forEach(c=>{n=Math.min(n,c.x),i=Math.max(i,c.x),r=Math.min(r,c.y),l=Math.max(l,c.y)}),{x:n,y:r,width:i-n,height:l-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}ho.prototype.className="RegularPolygon";ho.prototype._centroid=!0;ho.prototype._attrsAffectingSize=["radius"];Vn(ho);st.addGetterSetter(ho,"radius",0,Vt());st.addGetterSetter(ho,"sides",0,Vt());st.addGetterSetter(ho,"cornerRadius",0,Og(4));const qy=Math.PI*2;class Su extends Lt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,qy,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),qy,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Su.prototype.className="Ring";Su.prototype._centroid=!0;Su.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Vn(Su);st.addGetterSetter(Su,"innerRadius",0,Vt());st.addGetterSetter(Su,"outerRadius",0,Vt());class vs extends Lt{constructor(t){super(t),this._updated=!0,this.anim=new ur(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const n=this.animation(),i=this.frameIndex(),r=i*4,l=this.animations()[n],c=this.frameOffsets(),d=l[r+0],g=l[r+1],m=l[r+2],_=l[r+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,m,_),t.closePath(),t.fillStrokeShape(this)),C)if(c){const E=c[n],O=i*2;t.drawImage(C,d,g,m,_,E[O+0],E[O+1],m,_)}else t.drawImage(C,d,g,m,_,0,0,m,_)}_hitFunc(t){const n=this.animation(),i=this.frameIndex(),r=i*4,l=this.animations()[n],c=this.frameOffsets(),d=l[r+2],g=l[r+3];if(t.beginPath(),c){const m=c[n],_=i*2;t.rect(m[_+0],m[_+1],d,g)}else t.rect(0,0,d,g);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),n=this.animation(),i=this.animations(),r=i[n],l=r.length/4;t<l-1?this.frameIndex(t+1):this.frameIndex(0)}}vs.prototype.className="Sprite";Vn(vs);st.addGetterSetter(vs,"animation");st.addGetterSetter(vs,"animations");st.addGetterSetter(vs,"frameOffsets");st.addGetterSetter(vs,"image");st.addGetterSetter(vs,"frameIndex",0,Vt());st.addGetterSetter(vs,"frameRate",17,Vt());st.backCompat(vs,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class go extends Lt{_sceneFunc(t){const n=this.innerRadius(),i=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(let l=1;l<r*2;l++){const c=l%2===0?i:n,d=c*Math.sin(l*Math.PI/r),g=-1*c*Math.cos(l*Math.PI/r);t.lineTo(d,g)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}go.prototype.className="Star";go.prototype._centroid=!0;go.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Vn(go);st.addGetterSetter(go,"numPoints",5,Vt());st.addGetterSetter(go,"innerRadius",0,Vt());st.addGetterSetter(go,"outerRadius",0,Vt());function ao(o){return[...o].reduce((t,n,i,r)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const l=r[i+1];l&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(l)?(t.push(n+l),r[i+1]=""):t.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(r[i+1]||""))?t.push(n+r[i+1]):i>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?t[t.length-1]+=n:n&&t.push(n);return t},[])}const Qc="auto",B5="center",$2="inherit",Xc="justify",z5="Change.konva",L5="2d",Vy="-",tS="left",G5="text",H5="Text",P5="top",I5="bottom",Yy="middle",eS="normal",k5="px ",W0=" ",q5="right",Ky="rtl",V5="word",Y5="char",Qy="none",xp="",nS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],K5=nS.length;function Q5(o){return o.split(",").map(t=>{t=t.trim();const n=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return n&&!i&&(t=`"${t}"`),t}).join(", ")}let $0;function Np(){return $0||($0=vt.createCanvasElement().getContext(L5),$0)}function X5(o){o.fillText(this._partialText,this._partialTextX,this._partialTextY)}function F5(o){o.setAttr("miterLimit",2),o.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function J5(o){return o=o||{},!o.fillLinearGradientColorStops&&!o.fillRadialGradientColorStops&&!o.fillPatternImage&&(o.fill=o.fill||"black"),o}class Un extends Lt{constructor(t){super(J5(t)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<K5;n++)this.on(nS[n]+z5,this._setTextData);this._setTextData()}_sceneFunc(t){var n,i;const r=this.textArr,l=r.length;if(!this.text())return;let c=this.padding(),d=this.fontSize(),g=this.lineHeight()*d,m=this.verticalAlign(),_=this.direction(),C=0,E=this.align(),O=this.getWidth(),v=this.letterSpacing(),D=this.charRenderFunc(),L=this.fill(),z=this.textDecoration(),M=z.indexOf("underline")!==-1,N=z.indexOf("line-through")!==-1,G;_=_===$2?t.direction:_;let R=g/2,A=Yy;if(!Jt.legacyTextRendering){const T=this.measureSize("M");A="alphabetic";const y=(n=T.fontBoundingBoxAscent)!==null&&n!==void 0?n:T.actualBoundingBoxAscent,B=(i=T.fontBoundingBoxDescent)!==null&&i!==void 0?i:T.actualBoundingBoxDescent;R=(y-B)/2+g/2}for(_===Ky&&t.setAttr("direction",_),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",A),t.setAttr("textAlign",tS),m===Yy?C=(this.getHeight()-l*g-c*2)/2:m===I5&&(C=this.getHeight()-l*g-c*2),t.translate(c,C+c),G=0;G<l;G++){let T=0,y=0;const B=r[G],j=B.text,H=B.width,Q=B.lastInParagraph;if(t.save(),E===q5?T+=O-H-c*2:E===B5&&(T+=(O-H-c*2)/2),M){t.save(),t.beginPath();const K=Jt.legacyTextRendering?Math.round(d/2):Math.round(d/4),X=T,V=R+y+K;t.moveTo(X,V);const U=E===Xc&&!Q?O-c*2:H;t.lineTo(X+Math.round(U),V),t.lineWidth=d/15;const I=this._getLinearGradient();t.strokeStyle=I||L,t.stroke(),t.restore()}if(_!==Ky&&(v!==0||E===Xc||D)){const K=j.split(" ").length-1,X=ao(j);for(let V=0;V<X.length;V++){const U=X[V];if(U===" "&&!Q&&E===Xc&&(T+=(O-c*2-H)/K),this._partialTextX=T,this._partialTextY=R+y,this._partialText=U,D){t.save();const F=r.slice(0,G).reduce((at,Z)=>at+ao(Z.text).length,0),W=V+F;D({char:U,index:W,x:T,y:R+y,lineIndex:G,column:V,isLastInLine:Q,width:this.measureSize(U).width,context:t})}t.fillStrokeShape(this),D&&t.restore(),T+=this.measureSize(U).width+v}}else v!==0&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=T,this._partialTextY=R+y,this._partialText=j,t.fillStrokeShape(this);if(N){t.save(),t.beginPath();const K=Jt.legacyTextRendering?0:-Math.round(d/4),X=E===Xc?0:T;t.moveTo(X,R+y+K);const V=E===Xc&&!Q?O-c*2:H;t.lineTo(X+Math.round(V),R+y+K),t.lineWidth=d/15;const U=this._getLinearGradient();t.strokeStyle=U||L,t.stroke(),t.restore()}t.restore(),l>1&&(R+=g)}}_hitFunc(t){const n=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}setText(t){const n=vt._isString(t)?t:t==null?"":t+"";return this._setAttr(G5,n),this}getWidth(){return this.attrs.width===Qc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Qc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return vt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var n,i,r,l,c,d,g,m,_,C,E;let O=Np(),v=this.fontSize(),D;O.save(),O.font=this._getContextFont(),D=O.measureText(t),O.restore();const L=v/100;return{actualBoundingBoxAscent:(n=D.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*L,actualBoundingBoxDescent:(i=D.actualBoundingBoxDescent)!==null&&i!==void 0?i:0,actualBoundingBoxLeft:(r=D.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*L,actualBoundingBoxRight:(l=D.actualBoundingBoxRight)!==null&&l!==void 0?l:75.732421875*L,alphabeticBaseline:(c=D.alphabeticBaseline)!==null&&c!==void 0?c:0,emHeightAscent:(d=D.emHeightAscent)!==null&&d!==void 0?d:100*L,emHeightDescent:(g=D.emHeightDescent)!==null&&g!==void 0?g:-20*L,fontBoundingBoxAscent:(m=D.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*L,fontBoundingBoxDescent:(_=D.fontBoundingBoxDescent)!==null&&_!==void 0?_:21*L,hangingBaseline:(C=D.hangingBaseline)!==null&&C!==void 0?C:72.80000305175781*L,ideographicBaseline:(E=D.ideographicBaseline)!==null&&E!==void 0?E:-21*L,width:D.width,height:v}}_getContextFont(){return this.fontStyle()+W0+this.fontVariant()+W0+(this.fontSize()+k5)+Q5(this.fontFamily())}_addTextLine(t){this.align()===Xc&&(t=t.trim());const i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){const n=this.letterSpacing(),i=t.length;return Np().measureText(t).width+n*i}_setTextData(){let t=this.text().split(`
`),n=+this.fontSize(),i=0,r=this.lineHeight()*n,l=this.attrs.width,c=this.attrs.height,d=l!==Qc&&l!==void 0,g=c!==Qc&&c!==void 0,m=this.padding(),_=l-m*2,C=c-m*2,E=0,O=this.wrap(),v=O!==Qy,D=O!==Y5&&v,L=this.ellipsis();this.textArr=[],Np().font=this._getContextFont();const z=L?this._getTextWidth(xp):0;for(let M=0,N=t.length;M<N;++M){let G=t[M],R=this._getTextWidth(G);if(d&&R>_)for(;G.length>0;){let A=0,T=ao(G).length,y="",B=0;for(;A<T;){const j=A+T>>>1,H=ao(G),Q=H.slice(0,j+1).join(""),K=this._getTextWidth(Q);(L&&g&&E+r>C?K+z:K)<=_?(A=j+1,y=Q,B=K):T=j}if(y){if(D){const Q=ao(G),K=ao(y),X=Q[K.length],V=X===W0||X===Vy;let U;if(V&&B<=_)U=K.length;else{const I=K.lastIndexOf(W0),F=K.lastIndexOf(Vy);U=Math.max(I,F)+1}U>0&&(A=U,y=Q.slice(0,A).join(""),B=this._getTextWidth(y))}if(y=y.trimRight(),this._addTextLine(y),i=Math.max(i,B),E+=r,this._shouldHandleEllipsis(E)){this._tryToAddEllipsisToLastLine();break}if(G=ao(G).slice(A).join("").trimLeft(),G.length>0&&(R=this._getTextWidth(G),R<=_)){this._addTextLine(G),E+=r,i=Math.max(i,R);break}}else break}else this._addTextLine(G),E+=r,i=Math.max(i,R),this._shouldHandleEllipsis(E)&&M<N-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&E+r>C)break}this.textHeight=n,this.textWidth=i}_shouldHandleEllipsis(t){const n=+this.fontSize(),i=this.lineHeight()*n,r=this.attrs.height,l=r!==Qc&&r!==void 0,c=this.padding(),d=r-c*2;return!(this.wrap()!==Qy)||l&&t+i>d}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,n=t!==Qc&&t!==void 0,i=this.padding(),r=t-i*2,l=this.ellipsis(),c=this.textArr[this.textArr.length-1];!c||!l||(n&&(this._getTextWidth(c.text+xp)<r||(c.text=c.text.slice(0,c.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(c.text+xp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return t&&n?!0:super._useBufferCanvas()}}Un.prototype._fillFunc=X5;Un.prototype._strokeFunc=F5;Un.prototype.className=H5;Un.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Vn(Un);st.overWriteSetter(Un,"width",$m());st.overWriteSetter(Un,"height",$m());st.addGetterSetter(Un,"direction",$2);st.addGetterSetter(Un,"fontFamily","Arial");st.addGetterSetter(Un,"fontSize",12,Vt());st.addGetterSetter(Un,"fontStyle",eS);st.addGetterSetter(Un,"fontVariant",eS);st.addGetterSetter(Un,"padding",0,Vt());st.addGetterSetter(Un,"align",tS);st.addGetterSetter(Un,"verticalAlign",P5);st.addGetterSetter(Un,"lineHeight",1,Vt());st.addGetterSetter(Un,"wrap",V5);st.addGetterSetter(Un,"ellipsis",!1,Hr());st.addGetterSetter(Un,"letterSpacing",0,Vt());st.addGetterSetter(Un,"text","",pu());st.addGetterSetter(Un,"textDecoration","");st.addGetterSetter(Un,"charRenderFunc",void 0);const Z5="",iS="normal";function aS(o){o.fillText(this.partialText,0,0)}function rS(o){o.strokeText(this.partialText,0,0)}class Si extends Lt{constructor(t){super(t),this.dummyCanvas=vt.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return xn.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const n=this.pathLength;return t>n?null:xn.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=xn.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const n=this.textDecoration(),i=this.fill(),r=this.fontSize(),l=this.glyphInfo,c=n.indexOf("underline")!==-1,d=n.indexOf("line-through")!==-1;c&&t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),this.partialText=l[g].text,t.fillStrokeShape(this),c&&(g===0&&t.moveTo(0,r/2+1),t.lineTo(l[g].width,r/2+1)),t.restore()}if(c&&(t.strokeStyle=i,t.lineWidth=r/20,t.stroke()),d){t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),g===0&&t.moveTo(0,0),t.lineTo(l[g].width,0),t.restore()}t.strokeStyle=i,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const n=this.glyphInfo;if(n.length>=1){const i=n[0].p0;t.moveTo(i.x,i.y)}for(let i=0;i<n.length;i++){const r=n[i].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return vt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Un.prototype.setText.call(this,t)}_getContextFont(){return Un.prototype._getContextFont.call(this)}_getTextSize(t){const i=this.dummyCanvas.getContext("2d");i.save(),i.font=this._getContextFont();const r=i.measureText(t);return i.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=ao(this.text()),n=[];let i=0;for(let C=0;C<t.length;C++)n.push({char:t[C],width:this._getTextSize(t[C]).width}),i+=n[C].width;const{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=i,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const l=this.letterSpacing(),c=this.align(),d=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*l,0);let m=0;c==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),c==="right"&&(m=Math.max(0,this.pathLength-g));let _=m;for(let C=0;C<n.length;C++){const E=this._getPointAtLength(_);if(!E)return;const O=n[C].char;let v=n[C].width+l;if(O===" "&&c==="justify"){const G=this.text().split(" ").length-1;v+=(this.pathLength-g)/G}const D=this._getPointAtLength(_+v);if(!D)return;const L=xn.getLineLength(E.x,E.y,D.x,D.y);let z=0;if(d)try{z=d(n[C-1].char,O)*this.fontSize()}catch{z=0}E.x+=z,D.x+=z,this.textWidth+=z;const M=xn.getPointOnLine(z+L/2,E.x,E.y,D.x,D.y),N=Math.atan2(D.y-E.y,D.x-E.x);this.glyphInfo.push({transposeX:M.x,transposeY:M.y,text:t[C],rotation:N,p0:E,p1:D,width:L}),_+=v}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});let n=t[0]||0,i=t[0]||0,r=t[1]||0,l=t[1]||0,c,d;for(let m=0;m<t.length/2;m++)c=t[m*2],d=t[m*2+1],n=Math.min(n,c),i=Math.max(i,c),r=Math.min(r,d),l=Math.max(l,d);const g=this.fontSize();return{x:n-g/2,y:r-g/2,width:i-n+g,height:l-r+g}}destroy(){return vt.releaseCanvas(this.dummyCanvas),super.destroy()}}Si.prototype._fillFunc=aS;Si.prototype._strokeFunc=rS;Si.prototype._fillFuncHit=aS;Si.prototype._strokeFuncHit=rS;Si.prototype.className="TextPath";Si.prototype._attrsAffectingSize=["text","fontSize","data"];Vn(Si);st.addGetterSetter(Si,"data");st.addGetterSetter(Si,"fontFamily","Arial");st.addGetterSetter(Si,"fontSize",12,Vt());st.addGetterSetter(Si,"fontStyle",iS);st.addGetterSetter(Si,"align","left");st.addGetterSetter(Si,"letterSpacing",0,Vt());st.addGetterSetter(Si,"textBaseline","middle");st.addGetterSetter(Si,"fontVariant",iS);st.addGetterSetter(Si,"text",Z5);st.addGetterSetter(Si,"textDecoration","");st.addGetterSetter(Si,"kerningFunc",void 0);const sS="tr-konva",W5=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(o=>o+`.${sS}`).join(" "),Xy="nodesRect",$5=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],t6={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},e6="ontouchstart"in Jt._global;function n6(o,t,n){if(o==="rotater")return n;t+=vt.degToRad(t6[o]||0);const i=(vt.radToDeg(t)%360+360)%360;return vt._inRange(i,315+22.5,360)||vt._inRange(i,0,22.5)?"ns-resize":vt._inRange(i,45-22.5,45+22.5)?"nesw-resize":vt._inRange(i,90-22.5,90+22.5)?"ew-resize":vt._inRange(i,135-22.5,135+22.5)?"nwse-resize":vt._inRange(i,180-22.5,180+22.5)?"ns-resize":vt._inRange(i,225-22.5,225+22.5)?"nesw-resize":vt._inRange(i,270-22.5,270+22.5)?"ew-resize":vt._inRange(i,315-22.5,315+22.5)?"nwse-resize":(vt.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}const pg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function i6(o){return{x:o.x+o.width/2*Math.cos(o.rotation)+o.height/2*Math.sin(-o.rotation),y:o.y+o.height/2*Math.cos(o.rotation)+o.width/2*Math.sin(o.rotation)}}function lS(o,t,n){const i=n.x+(o.x-n.x)*Math.cos(t)-(o.y-n.y)*Math.sin(t),r=n.y+(o.x-n.x)*Math.sin(t)+(o.y-n.y)*Math.cos(t);return{...o,rotation:o.rotation+t,x:i,y:r}}function a6(o,t){const n=i6(o);return lS(o,t,n)}function r6(o,t,n){let i=t;for(let r=0;r<o.length;r++){const l=Jt.getAngle(o[r]),c=Math.abs(l-t)%(Math.PI*2);Math.min(c,Math.PI*2-c)<n&&(i=l)}return i}let Bm=0;class Qe extends of{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(W5,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return vt.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return sS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const n=t.filter(r=>r.isAncestorOf(this)?(vt.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=n,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){const c=r._attrsAffectingSize.map(d=>d+"Change."+this._getEventNamespace()).join(" ");r.on(c,l)}r.on($5.map(c=>c+`.${this._getEventNamespace()}`).join(" "),l),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let n;t.on(`dragstart.${this._getEventNamespace()}`,i=>{n=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(i,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!n)return;const r=t.getAbsolutePosition(),l=r.x-n.x,c=r.y-n.y;this.nodes().forEach(d=>{if(d===t||d.isDragging())return;const g=d.getAbsolutePosition();d.setAbsolutePosition({x:g.x+l,y:g.y+c}),d.startDrag(i)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Xy),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Xy,this.__getNodeRect)}__getNodeShape(t,n=this.rotation(),i){const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=t.getAbsoluteScale(i),c=t.getAbsolutePosition(i),d=r.x*l.x-t.offsetX()*l.x,g=r.y*l.y-t.offsetY()*l.y,m=(Jt.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),_={x:c.x+d*Math.cos(m)+g*Math.sin(-m),y:c.y+g*Math.cos(m)+d*Math.sin(m),width:r.width*l.x,height:r.height*l.y,rotation:m};return lS(_,-Jt.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const _=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),C=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}],E=m.getAbsoluteTransform();C.forEach(function(O){const v=E.point(O);n.push(v)})});const i=new ja;i.rotate(-Jt.getAngle(this.rotation()));let r=1/0,l=1/0,c=-1/0,d=-1/0;n.forEach(function(m){const _=i.point(m);r===void 0&&(r=c=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),c=Math.max(c,_.x),d=Math.max(d,_.y)}),i.invert();const g=i.point({x:r,y:l});return{x:g.x,y:g.y,width:c-r,height:d-l,rotation:Jt.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),pg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const n=new pd({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:e6?10:"auto"}),i=this;n.on("mousedown touchstart",function(r){i._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{const r=Jt.getAngle(this.rotation()),l=this.rotateAnchorCursor(),c=n6(t,r,l);n.getStage().content&&(n.getStage().content.style.cursor=c),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const t=new Lt({name:"back",width:0,height:0,sceneFunc(n,i){const r=i.getParent(),l=r.padding();n.beginPath(),n.rect(-l,-l,i.width()+l*2,i.height()+l*2),n.moveTo(i.width()/2,-l),r.rotateEnabled()&&r.rotateLineVisible()&&n.lineTo(i.width()/2,-r.rotateAnchorOffset()*vt._sign(i.height())-l),n.fillStrokeShape(i)},hitFunc:(n,i)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();n.beginPath(),n.rect(-r,-r,i.width()+r*2,i.height()+r*2),n.fillStrokeShape(i)}});this.add(t),this._proxyDrag(t),t.on("dragstart",n=>{n.cancelBubble=!0}),t.on("dragmove",n=>{n.cancelBubble=!0}),t.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const n=this._getNodeRect(),i=n.width,r=n.height,l=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));this.sin=Math.abs(r/l),this.cos=Math.abs(i/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const c=t.target.getAbsolutePosition(),d=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:d.x-c.x,y:d.y-c.y},Bm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:t.evt,target:g})})}_handleMouseMove(t){let n,i,r;const l=this.findOne("."+this._movingAnchorName),c=l.getStage();c.setPointersPositions(t);const d=c.getPointerPosition();let g={x:d.x-this._anchorDragOffset.x,y:d.y-this._anchorDragOffset.y};const m=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,t)),l.setAbsolutePosition(g);const _=l.getAbsolutePosition();if(m.x===_.x&&m.y===_.y)return;if(this._movingAnchorName==="rotater"){const M=this._getNodeRect();n=l.x()-M.width/2,i=-l.y()+M.height/2;let N=Math.atan2(-i,n)+Math.PI/2;M.height<0&&(N-=Math.PI);const R=Jt.getAngle(this.rotation())+N,A=Jt.getAngle(this.rotationSnapTolerance()),y=r6(this.rotationSnaps(),R,A)-M.rotation,B=a6(M,y);this._fitNodesInto(B,t);return}const C=this.shiftBehavior();let E;C==="inverted"?E=this.keepRatio()&&!t.shiftKey:C==="none"?E=this.keepRatio():E=this.keepRatio()||t.shiftKey;let O=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(E){const M=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(M.x-l.x(),2)+Math.pow(M.y-l.y(),2));const N=this.findOne(".top-left").x()>M.x?-1:1,G=this.findOne(".top-left").y()>M.y?-1:1;n=r*this.cos*N,i=r*this.sin*G,this.findOne(".top-left").x(M.x-n),this.findOne(".top-left").y(M.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(E){const M=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(l.x()-M.x,2)+Math.pow(M.y-l.y(),2));const N=this.findOne(".top-right").x()<M.x?-1:1,G=this.findOne(".top-right").y()>M.y?-1:1;n=r*this.cos*N,i=r*this.sin*G,this.findOne(".top-right").x(M.x+n),this.findOne(".top-right").y(M.y-i)}var v=l.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(E){const M=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(M.x-l.x(),2)+Math.pow(l.y()-M.y,2));const N=M.x<l.x()?-1:1,G=l.y()<M.y?-1:1;n=r*this.cos*N,i=r*this.sin*G,l.x(M.x-n),l.y(M.y+i)}v=l.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(E){const M=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(l.x()-M.x,2)+Math.pow(l.y()-M.y,2));const N=this.findOne(".bottom-right").x()<M.x?-1:1,G=this.findOne(".bottom-right").y()<M.y?-1:1;n=r*this.cos*N,i=r*this.sin*G,this.findOne(".bottom-right").x(M.x+n),this.findOne(".bottom-right").y(M.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(O=this.centeredScaling()||t.altKey,O){const M=this.findOne(".top-left"),N=this.findOne(".bottom-right"),G=M.x(),R=M.y(),A=this.getWidth()-N.x(),T=this.getHeight()-N.y();N.move({x:-G,y:-R}),M.move({x:A,y:T})}const D=this.findOne(".top-left").getAbsolutePosition();n=D.x,i=D.y;const L=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),z=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:i,width:L,height:z,rotation:Jt.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const i=this.getNode();Bm--,this._fire("transformend",{evt:t,target:i}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),i&&this._nodes.forEach(r=>{var l;r._fire("transformend",{evt:t,target:r}),(l=r.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,n){const i=this._getNodeRect(),r=1;if(vt._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(vt._inRange(t.height,-this.padding()*2-r,r)){this.update();return}const l=new ja;if(l.rotate(Jt.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=l.point({x:-this.padding()*2,y:0});t.x+=E.x,t.y+=E.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=l.point({x:0,y:-this.padding()*2});t.x+=E.x,t.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(i,t);E?t=E:vt.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const c=1e7,d=new ja;d.translate(i.x,i.y),d.rotate(i.rotation),d.scale(i.width/c,i.height/c);const g=new ja,m=t.width/c,_=t.height/c;this.flipEnabled()===!1?(g.translate(t.x,t.y),g.rotate(t.rotation),g.translate(t.width<0?t.width:0,t.height<0?t.height:0),g.scale(Math.abs(m),Math.abs(_))):(g.translate(t.x,t.y),g.rotate(t.rotation),g.scale(m,_));const C=g.multiply(d.invert());this._nodes.forEach(E=>{var O;if(!E.getStage())return;const v=E.getParent().getAbsoluteTransform(),D=E.getTransform().copy();D.translate(E.offsetX(),E.offsetY());const L=new ja;L.multiply(v.copy().invert()).multiply(C).multiply(v).multiply(D);const z=L.decompose();E.setAttrs(z),(O=E.getLayer())===null||O===void 0||O.batchDraw()}),this.rotation(vt._getRotation(t.rotation)),this._nodes.forEach(E=>{this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,n){this.findOne(t).setAttrs(n)}update(){var t;const n=this._getNodeRect();this.rotation(vt._getRotation(n.rotation));const i=n.width,r=n.height,l=this.enabledAnchors(),c=this.resizeEnabled(),d=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(C=>{C.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+d,offsetY:g/2+d,visible:c&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:g/2+d,visible:c&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:g/2-d,offsetY:g/2+d,visible:c&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:g/2+d,visible:c&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:r/2,offsetX:g/2-d,visible:c&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:g/2+d,offsetY:g/2-d,visible:c&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:r,offsetY:g/2-d,visible:c&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:r,offsetX:g/2-d,offsetY:g/2-d,visible:c&&l.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*vt._sign(r)-d,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(C=>C.draggable()),x:0,y:0});const _=this.anchorStyleFunc();_&&m.forEach(C=>{_(C)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),of.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return qt.prototype.toObject.call(this)}clone(t){return qt.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Qe.isTransforming=()=>Bm>0;function s6(o){return o instanceof Array||vt.warn("enabledAnchors value should be an array"),o instanceof Array&&o.forEach(function(t){pg.indexOf(t)===-1&&vt.warn("Unknown anchor name: "+t+". Available names are: "+pg.join(", "))}),o||[]}Qe.prototype.className="Transformer";Vn(Qe);st.addGetterSetter(Qe,"enabledAnchors",pg,s6);st.addGetterSetter(Qe,"flipEnabled",!0,Hr());st.addGetterSetter(Qe,"resizeEnabled",!0);st.addGetterSetter(Qe,"anchorSize",10,Vt());st.addGetterSetter(Qe,"rotateEnabled",!0);st.addGetterSetter(Qe,"rotateLineVisible",!0);st.addGetterSetter(Qe,"rotationSnaps",[]);st.addGetterSetter(Qe,"rotateAnchorOffset",50,Vt());st.addGetterSetter(Qe,"rotateAnchorCursor","crosshair");st.addGetterSetter(Qe,"rotationSnapTolerance",5,Vt());st.addGetterSetter(Qe,"borderEnabled",!0);st.addGetterSetter(Qe,"anchorStroke","rgb(0, 161, 255)");st.addGetterSetter(Qe,"anchorStrokeWidth",1,Vt());st.addGetterSetter(Qe,"anchorFill","white");st.addGetterSetter(Qe,"anchorCornerRadius",0,Vt());st.addGetterSetter(Qe,"borderStroke","rgb(0, 161, 255)");st.addGetterSetter(Qe,"borderStrokeWidth",1,Vt());st.addGetterSetter(Qe,"borderDash");st.addGetterSetter(Qe,"keepRatio",!0);st.addGetterSetter(Qe,"shiftBehavior","default");st.addGetterSetter(Qe,"centeredScaling",!1);st.addGetterSetter(Qe,"ignoreStroke",!1);st.addGetterSetter(Qe,"padding",0,Vt());st.addGetterSetter(Qe,"nodes");st.addGetterSetter(Qe,"node");st.addGetterSetter(Qe,"boundBoxFunc");st.addGetterSetter(Qe,"anchorDragBoundFunc");st.addGetterSetter(Qe,"anchorStyleFunc");st.addGetterSetter(Qe,"shouldOverdrawWholeArea",!1);st.addGetterSetter(Qe,"useSingleNodeRotation",!0);st.backCompat(Qe,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class pl extends Lt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Jt.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}pl.prototype.className="Wedge";pl.prototype._centroid=!0;pl.prototype._attrsAffectingSize=["radius"];Vn(pl);st.addGetterSetter(pl,"radius",0,Vt());st.addGetterSetter(pl,"angle",0,Vt());st.addGetterSetter(pl,"clockwise",!1);st.backCompat(pl,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Fy(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const l6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function u6(o,t){const n=o.data,i=o.width,r=o.height;let l,c,d,g,m,_,C,E,O,v,D,L,z,M,N,G,R,A,T,y;const B=t+t+1,j=i-1,H=r-1,Q=t+1,K=Q*(Q+1)/2,X=new Fy,V=l6[t],U=o6[t];let I=null,F=X,W=null,at=null;for(let Z=1;Z<B;Z++)F=F.next=new Fy,Z===Q&&(I=F);F.next=X,d=c=0;for(let Z=0;Z<r;Z++){L=z=M=N=g=m=_=C=0,E=Q*(G=n[c]),O=Q*(R=n[c+1]),v=Q*(A=n[c+2]),D=Q*(T=n[c+3]),g+=K*G,m+=K*R,_+=K*A,C+=K*T,F=X;for(let rt=0;rt<Q;rt++)F.r=G,F.g=R,F.b=A,F.a=T,F=F.next;for(let rt=1;rt<Q;rt++)l=c+((j<rt?j:rt)<<2),g+=(F.r=G=n[l])*(y=Q-rt),m+=(F.g=R=n[l+1])*y,_+=(F.b=A=n[l+2])*y,C+=(F.a=T=n[l+3])*y,L+=G,z+=R,M+=A,N+=T,F=F.next;W=X,at=I;for(let rt=0;rt<i;rt++)n[c+3]=T=C*V>>U,T!==0?(T=255/T,n[c]=(g*V>>U)*T,n[c+1]=(m*V>>U)*T,n[c+2]=(_*V>>U)*T):n[c]=n[c+1]=n[c+2]=0,g-=E,m-=O,_-=v,C-=D,E-=W.r,O-=W.g,v-=W.b,D-=W.a,l=d+((l=rt+t+1)<j?l:j)<<2,L+=W.r=n[l],z+=W.g=n[l+1],M+=W.b=n[l+2],N+=W.a=n[l+3],g+=L,m+=z,_+=M,C+=N,W=W.next,E+=G=at.r,O+=R=at.g,v+=A=at.b,D+=T=at.a,L-=G,z-=R,M-=A,N-=T,at=at.next,c+=4;d+=i}for(let Z=0;Z<i;Z++){z=M=N=L=m=_=C=g=0,c=Z<<2,E=Q*(G=n[c]),O=Q*(R=n[c+1]),v=Q*(A=n[c+2]),D=Q*(T=n[c+3]),g+=K*G,m+=K*R,_+=K*A,C+=K*T,F=X;for(let it=0;it<Q;it++)F.r=G,F.g=R,F.b=A,F.a=T,F=F.next;let rt=i;for(let it=1;it<=t;it++)c=rt+Z<<2,g+=(F.r=G=n[c])*(y=Q-it),m+=(F.g=R=n[c+1])*y,_+=(F.b=A=n[c+2])*y,C+=(F.a=T=n[c+3])*y,L+=G,z+=R,M+=A,N+=T,F=F.next,it<H&&(rt+=i);c=Z,W=X,at=I;for(let it=0;it<r;it++)l=c<<2,n[l+3]=T=C*V>>U,T>0?(T=255/T,n[l]=(g*V>>U)*T,n[l+1]=(m*V>>U)*T,n[l+2]=(_*V>>U)*T):n[l]=n[l+1]=n[l+2]=0,g-=E,m-=O,_-=v,C-=D,E-=W.r,O-=W.g,v-=W.b,D-=W.a,l=Z+((l=it+Q)<H?l:H)*i<<2,g+=L+=W.r=n[l],m+=z+=W.g=n[l+1],_+=M+=W.b=n[l+2],C+=N+=W.a=n[l+3],W=W.next,E+=G=at.r,O+=R=at.g,v+=A=at.b,D+=T=at.a,L-=G,z-=R,M-=A,N-=T,at=at.next,c+=i}}const c6=function(t){const n=Math.round(this.blurRadius());n>0&&u6(t,n)};st.addGetterSetter(qt,"blurRadius",0,Vt(),st.afterSetFilter);const f6=function(o){const t=this.brightness()*255,n=o.data,i=n.length;for(let r=0;r<i;r+=4)n[r]+=t,n[r+1]+=t,n[r+2]+=t};st.addGetterSetter(qt,"brightness",0,Vt(),st.afterSetFilter);const h6=function(o){const t=this.brightness(),n=o.data,i=n.length;for(let r=0;r<i;r+=4)n[r]=Math.min(255,n[r]*t),n[r+1]=Math.min(255,n[r+1]*t),n[r+2]=Math.min(255,n[r+2]*t)},d6=function(o){const t=Math.pow((this.contrast()+100)/100,2),n=o.data,i=n.length;let r=150,l=150,c=150;for(let d=0;d<i;d+=4)r=n[d],l=n[d+1],c=n[d+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,l/=255,l-=.5,l*=t,l+=.5,l*=255,c/=255,c-=.5,c*=t,c+=.5,c*=255,r=r<0?0:r>255?255:r,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,n[d]=r,n[d+1]=l,n[d+2]=c};st.addGetterSetter(qt,"contrast",0,Vt(),st.afterSetFilter);const g6=function(o){var t,n,i,r,l,c,d,g,m;const _=o.data,C=o.width,E=o.height,O=Math.min(1,Math.max(0,(n=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:.5)),v=Math.min(1,Math.max(0,(r=(i=this.embossWhiteLevel)===null||i===void 0?void 0:i.call(this))!==null&&r!==void 0?r:.5)),L=(d={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(c=(l=this.embossDirection)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0?c:"top-left"])!==null&&d!==void 0?d:315,z=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),M=O*10,N=v*255,G=L*Math.PI/180,R=Math.cos(G),A=Math.sin(G),T=128/1020*M,y=new Uint8ClampedArray(_),B=new Float32Array(C*E);for(let X=0,V=0;V<_.length;V+=4,X++)B[X]=.2126*y[V]+.7152*y[V+1]+.0722*y[V+2];const j=[-1,0,1,-2,0,2,-1,0,1],H=[-1,-2,-1,0,0,0,1,2,1],Q=[-C-1,-C,-C+1,-1,0,1,C-1,C,C+1],K=X=>X<0?0:X>255?255:X;for(let X=1;X<E-1;X++)for(let V=1;V<C-1;V++){const U=X*C+V;let I=0,F=0;I+=B[U+Q[0]]*j[0],F+=B[U+Q[0]]*H[0],I+=B[U+Q[1]]*j[1],F+=B[U+Q[1]]*H[1],I+=B[U+Q[2]]*j[2],F+=B[U+Q[2]]*H[2],I+=B[U+Q[3]]*j[3],F+=B[U+Q[3]]*H[3],I+=B[U+Q[5]]*j[5],F+=B[U+Q[5]]*H[5],I+=B[U+Q[6]]*j[6],F+=B[U+Q[6]]*H[6],I+=B[U+Q[7]]*j[7],F+=B[U+Q[7]]*H[7],I+=B[U+Q[8]]*j[8],F+=B[U+Q[8]]*H[8];const W=R*I+A*F,at=K(N+W*T),Z=U*4;if(z){const rt=at-N;_[Z]=K(y[Z]+rt),_[Z+1]=K(y[Z+1]+rt),_[Z+2]=K(y[Z+2]+rt),_[Z+3]=y[Z+3]}else _[Z]=_[Z+1]=_[Z+2]=at,_[Z+3]=y[Z+3]}for(let X=0;X<C;X++){let V=X*4,U=((E-1)*C+X)*4;_[V]=y[V],_[V+1]=y[V+1],_[V+2]=y[V+2],_[V+3]=y[V+3],_[U]=y[U],_[U+1]=y[U+1],_[U+2]=y[U+2],_[U+3]=y[U+3]}for(let X=1;X<E-1;X++){let V=X*C*4,U=(X*C+(C-1))*4;_[V]=y[V],_[V+1]=y[V+1],_[V+2]=y[V+2],_[V+3]=y[V+3],_[U]=y[U],_[U+1]=y[U+1],_[U+2]=y[U+2],_[U+3]=y[U+3]}return o};st.addGetterSetter(qt,"embossStrength",.5,Vt(),st.afterSetFilter);st.addGetterSetter(qt,"embossWhiteLevel",.5,Vt(),st.afterSetFilter);st.addGetterSetter(qt,"embossDirection","top-left",void 0,st.afterSetFilter);st.addGetterSetter(qt,"embossBlend",!1,void 0,st.afterSetFilter);function Mp(o,t,n,i,r){const l=n-t,c=r-i;if(l===0)return i+c/2;if(c===0)return i;let d=(o-t)/l;return d=c*d+i,d}const p6=function(o){const t=o.data,n=t.length;let i=t[0],r=i,l,c=t[1],d=c,g,m=t[2],_=m,C;const E=this.enhance();if(E===0)return;for(let N=0;N<n;N+=4)l=t[N+0],l<i?i=l:l>r&&(r=l),g=t[N+1],g<c?c=g:g>d&&(d=g),C=t[N+2],C<m?m=C:C>_&&(_=C);r===i&&(r=255,i=0),d===c&&(d=255,c=0),_===m&&(_=255,m=0);let O,v,D,L,z,M;if(E>0)O=r+E*(255-r),v=i-E*(i-0),D=d+E*(255-d),L=c-E*(c-0),z=_+E*(255-_),M=m-E*(m-0);else{const N=(r+i)*.5;O=r+E*(r-N),v=i+E*(i-N);const G=(d+c)*.5;D=d+E*(d-G),L=c+E*(c-G);const R=(_+m)*.5;z=_+E*(_-R),M=m+E*(m-R)}for(let N=0;N<n;N+=4)t[N+0]=Mp(t[N+0],i,r,v,O),t[N+1]=Mp(t[N+1],c,d,L,D),t[N+2]=Mp(t[N+2],m,_,M,z)};st.addGetterSetter(qt,"enhance",0,Vt(),st.afterSetFilter);const m6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4){const r=.34*t[i]+.5*t[i+1]+.16*t[i+2];t[i]=r,t[i+1]=r,t[i+2]=r}};st.addGetterSetter(qt,"hue",0,Vt(),st.afterSetFilter);st.addGetterSetter(qt,"saturation",0,Vt(),st.afterSetFilter);st.addGetterSetter(qt,"luminance",0,Vt(),st.afterSetFilter);const v6=function(o){const t=o.data,n=t.length,i=1,r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=this.luminance()*127,d=i*r*Math.cos(l*Math.PI/180),g=i*r*Math.sin(l*Math.PI/180),m=.299*i+.701*d+.167*g,_=.587*i-.587*d+.33*g,C=.114*i-.114*d-.497*g,E=.299*i-.299*d-.328*g,O=.587*i+.413*d+.035*g,v=.114*i-.114*d+.293*g,D=.299*i-.3*d+1.25*g,L=.587*i-.586*d-1.05*g,z=.114*i+.886*d-.2*g;let M,N,G,R;for(let A=0;A<n;A+=4)M=t[A+0],N=t[A+1],G=t[A+2],R=t[A+3],t[A+0]=m*M+_*N+C*G+c,t[A+1]=E*M+O*N+v*G+c,t[A+2]=D*M+L*N+z*G+c,t[A+3]=R},y6=function(o){const t=o.data,n=t.length,i=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=i*r*Math.cos(l*Math.PI/180),d=i*r*Math.sin(l*Math.PI/180),g=.299*i+.701*c+.167*d,m=.587*i-.587*c+.33*d,_=.114*i-.114*c-.497*d,C=.299*i-.299*c-.328*d,E=.587*i+.413*c+.035*d,O=.114*i-.114*c+.293*d,v=.299*i-.3*c+1.25*d,D=.587*i-.586*c-1.05*d,L=.114*i+.886*c-.2*d;for(let z=0;z<n;z+=4){const M=t[z+0],N=t[z+1],G=t[z+2],R=t[z+3];t[z+0]=g*M+m*N+_*G,t[z+1]=C*M+E*N+O*G,t[z+2]=v*M+D*N+L*G,t[z+3]=R}};st.addGetterSetter(qt,"hue",0,Vt(),st.afterSetFilter);st.addGetterSetter(qt,"saturation",0,Vt(),st.afterSetFilter);st.addGetterSetter(qt,"value",0,Vt(),st.afterSetFilter);const S6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]},b6=function(o,t,n){const i=o.data,r=t.data,l=o.width,c=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||c/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=c-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const O=c,v=l,D=360/v*Math.PI/180;for(let L=0;L<v;L+=1){const z=Math.sin(L*D),M=Math.cos(L*D);for(let N=0;N<O;N+=1){_=Math.floor(d+m*N/O*M),C=Math.floor(g+m*N/O*z);let G=(C*l+_)*4;const R=i[G+0],A=i[G+1],T=i[G+2],y=i[G+3];G=(L+N*l)*4,r[G+0]=R,r[G+1]=A,r[G+2]=T,r[G+3]=y}}},_6=function(o,t,n){const i=o.data,r=t.data,l=o.width,c=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||c/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=c-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const O=c,v=l,D=0;let L,z;for(_=0;_<l;_+=1)for(C=0;C<c;C+=1){const M=_-d,N=C-g,G=Math.sqrt(M*M+N*N)*O/m;let R=(Math.atan2(N,M)*180/Math.PI+360+D)%360;R=R*v/360,L=Math.floor(R),z=Math.floor(G);let A=(z*l+L)*4;const T=i[A+0],y=i[A+1],B=i[A+2],j=i[A+3];A=(C*l+_)*4,r[A+0]=T,r[A+1]=y,r[A+2]=B,r[A+3]=j}},E6=function(o){const t=o.width,n=o.height;let i,r,l,c,d,g,m,_,C,E,O=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),D=Math.floor(t*(v%360)/360);if(O<1)return;const L=vt.createCanvasElement();L.width=t,L.height=n;const z=L.getContext("2d").getImageData(0,0,t,n);vt.releaseCanvas(L),b6(o,z,{polarCenterX:t/2,polarCenterY:n/2});let M=t/Math.pow(2,O);for(;M<=8;)M=M*2,O-=1;M=Math.ceil(M);let N=M,G=0,R=N,A=1;for(D+M>t&&(G=N,R=0,A=-1),r=0;r<n;r+=1)for(i=G;i!==R;i+=A)l=Math.round(i+D)%t,C=(t*r+l)*4,d=z.data[C+0],g=z.data[C+1],m=z.data[C+2],_=z.data[C+3],E=(t*r+i)*4,z.data[E+0]=d,z.data[E+1]=g,z.data[E+2]=m,z.data[E+3]=_;for(r=0;r<n;r+=1)for(N=Math.floor(M),c=0;c<O;c+=1){for(i=0;i<N+1;i+=1)C=(t*r+i)*4,d=z.data[C+0],g=z.data[C+1],m=z.data[C+2],_=z.data[C+3],E=(t*r+N*2-i-1)*4,z.data[E+0]=d,z.data[E+1]=g,z.data[E+2]=m,z.data[E+3]=_;N*=2}_6(z,o,{})};st.addGetterSetter(qt,"kaleidoscopePower",2,Vt(),st.afterSetFilter);st.addGetterSetter(qt,"kaleidoscopeAngle",0,Vt(),st.afterSetFilter);function tg(o,t,n){let i=(n*o.width+t)*4;const r=[];return r.push(o.data[i++],o.data[i++],o.data[i++],o.data[i++]),r}function Qh(o,t){return Math.sqrt(Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)+Math.pow(o[2]-t[2],2))}function C6(o){const t=[0,0,0];for(let n=0;n<o.length;n++)t[0]+=o[n][0],t[1]+=o[n][1],t[2]+=o[n][2];return t[0]/=o.length,t[1]/=o.length,t[2]/=o.length,t}function T6(o,t){const n=tg(o,0,0),i=tg(o,o.width-1,0),r=tg(o,0,o.height-1),l=tg(o,o.width-1,o.height-1),c=t||10;if(Qh(n,i)<c&&Qh(i,l)<c&&Qh(l,r)<c&&Qh(r,n)<c){const d=C6([i,n,l,r]),g=[];for(let m=0;m<o.width*o.height;m++){const _=Qh(d,[o.data[m*4],o.data[m*4+1],o.data[m*4+2]]);g[m]=_<c?0:255}return g}}function A6(o,t){for(let n=0;n<o.width*o.height;n++)o.data[4*n+3]=t[n]}function w6(o,t,n){const i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const O=d+C-l,v=g+E-l;if(O>=0&&O<n&&v>=0&&v<t){const D=O*t+v,L=i[C*r+E];_+=o[D]*L}}c[m]=_===2040?255:0}return c}function O6(o,t,n){const i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const O=d+C-l,v=g+E-l;if(O>=0&&O<n&&v>=0&&v<t){const D=O*t+v,L=i[C*r+E];_+=o[D]*L}}c[m]=_>=1020?255:0}return c}function R6(o,t,n){const i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(i.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const O=d+C-l,v=g+E-l;if(O>=0&&O<n&&v>=0&&v<t){const D=O*t+v,L=i[C*r+E];_+=o[D]*L}}c[m]=_}return c}const x6=function(o){const t=this.threshold();let n=T6(o,t);return n&&(n=w6(n,o.width,o.height),n=O6(n,o.width,o.height),n=R6(n,o.width,o.height),A6(o,n)),o};st.addGetterSetter(qt,"threshold",0,Vt(),st.afterSetFilter);const N6=function(o){const t=this.noise()*255,n=o.data,i=n.length,r=t/2;for(let l=0;l<i;l+=4)n[l+0]+=r-2*r*Math.random(),n[l+1]+=r-2*r*Math.random(),n[l+2]+=r-2*r*Math.random()};st.addGetterSetter(qt,"noise",.2,Vt(),st.afterSetFilter);const M6=function(o){let t=Math.ceil(this.pixelSize()),n=o.width,i=o.height,r=Math.ceil(n/t),l=Math.ceil(i/t),c=o.data;if(t<=0){vt.error("pixelSize value can not be <= 0");return}for(let d=0;d<r;d+=1)for(let g=0;g<l;g+=1){let m=0,_=0,C=0,E=0;const O=d*t,v=O+t,D=g*t,L=D+t;let z=0;for(let M=O;M<v;M+=1)if(!(M>=n))for(let N=D;N<L;N+=1){if(N>=i)continue;const G=(n*N+M)*4;m+=c[G+0],_+=c[G+1],C+=c[G+2],E+=c[G+3],z+=1}m=m/z,_=_/z,C=C/z,E=E/z;for(let M=O;M<v;M+=1)if(!(M>=n))for(let N=D;N<L;N+=1){if(N>=i)continue;const G=(n*N+M)*4;c[G+0]=m,c[G+1]=_,c[G+2]=C,c[G+3]=E}}};st.addGetterSetter(qt,"pixelSize",8,Vt(),st.afterSetFilter);const D6=function(o){const t=Math.round(this.levels()*254)+1,n=o.data,i=n.length,r=255/t;for(let l=0;l<i;l+=1)n[l]=Math.floor(n[l]/r)*r};st.addGetterSetter(qt,"levels",.5,Vt(),st.afterSetFilter);const j6=function(o){const t=o.data,n=t.length,i=this.red(),r=this.green(),l=this.blue();for(let c=0;c<n;c+=4){const d=(.34*t[c]+.5*t[c+1]+.16*t[c+2])/255;t[c]=d*i,t[c+1]=d*r,t[c+2]=d*l,t[c+3]=t[c+3]}};st.addGetterSetter(qt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(qt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(qt,"blue",0,N2,st.afterSetFilter);const U6=function(o){const t=o.data,n=t.length,i=this.red(),r=this.green(),l=this.blue(),c=this.alpha();for(let d=0;d<n;d+=4){const g=1-c;t[d]=i*c+t[d]*g,t[d+1]=r*c+t[d+1]*g,t[d+2]=l*c+t[d+2]*g}};st.addGetterSetter(qt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(qt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(qt,"blue",0,N2,st.afterSetFilter);st.addGetterSetter(qt,"alpha",1,function(o){return this._filterUpToDate=!1,o>1?1:o<0?0:o});const B6=function(o){const t=o.data,n=t.length;for(let i=0;i<n;i+=4){const r=t[i+0],l=t[i+1],c=t[i+2];t[i+0]=Math.min(255,r*.393+l*.769+c*.189),t[i+1]=Math.min(255,r*.349+l*.686+c*.168),t[i+2]=Math.min(255,r*.272+l*.534+c*.131)}},z6=function(o){const n=o.data;for(let i=0;i<n.length;i+=4){const r=n[i],l=n[i+1],c=n[i+2];.2126*r+.7152*l+.0722*c>=128&&(n[i]=255-r,n[i+1]=255-l,n[i+2]=255-c)}return o},L6=function(o){const t=this.threshold()*255,n=o.data,i=n.length;for(let r=0;r<i;r+=1)n[r]=n[r]<t?0:255};st.addGetterSetter(qt,"threshold",.5,Vt(),st.afterSetFilter);uf.Util._assign(uf,{Arc:dl,Arrow:vu,Circle:mf,Ellipse:fo,Image:Pr,Label:nv,Tag:yu,Line:gl,Path:xn,Rect:pd,RegularPolygon:ho,Ring:Su,Sprite:vs,Star:go,Text:Un,TextPath:Si,Transformer:Qe,Wedge:pl,Filters:{Blur:c6,Brightness:h6,Brighten:f6,Contrast:d6,Emboss:g6,Enhance:p6,Grayscale:m6,HSL:v6,HSV:y6,Invert:S6,Kaleidoscope:E6,Mask:x6,Noise:N6,Pixelate:M6,Posterize:D6,RGB:j6,RGBA:U6,Sepia:B6,Solarize:z6,Threshold:L6}});var Dp={exports:{}},jp={exports:{}},Up={exports:{}},Bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy;function G6(){return Jy||(Jy=1,(function(o){function t(U,I){var F=U.length;U.push(I);t:for(;0<F;){var W=F-1>>>1,at=U[W];if(0<r(at,I))U[W]=I,U[F]=at,F=W;else break t}}function n(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var I=U[0],F=U.pop();if(F!==I){U[0]=F;t:for(var W=0,at=U.length,Z=at>>>1;W<Z;){var rt=2*(W+1)-1,it=U[rt],Y=rt+1,J=U[Y];if(0>r(it,F))Y<at&&0>r(J,it)?(U[W]=J,U[Y]=F,W=Y):(U[W]=it,U[rt]=F,W=rt);else if(Y<at&&0>r(J,F))U[W]=J,U[Y]=F,W=Y;else break t}}return I}function r(U,I){var F=U.sortIndex-I.sortIndex;return F!==0?F:U.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],_=1,C=null,E=3,O=!1,v=!1,D=!1,L=!1,z=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function G(U){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=U)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function R(U){if(D=!1,G(U),!v)if(n(g)!==null)v=!0,A||(A=!0,Q());else{var I=n(m);I!==null&&V(R,I.startTime-U)}}var A=!1,T=-1,y=5,B=-1;function j(){return L?!0:!(o.unstable_now()-B<y)}function H(){if(L=!1,A){var U=o.unstable_now();B=U;var I=!0;try{t:{v=!1,D&&(D=!1,M(T),T=-1),O=!0;var F=E;try{e:{for(G(U),C=n(g);C!==null&&!(C.expirationTime>U&&j());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var at=W(C.expirationTime<=U);if(U=o.unstable_now(),typeof at=="function"){C.callback=at,G(U),I=!0;break e}C===n(g)&&i(g),G(U)}else i(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&V(R,Z.startTime-U),I=!1}}break t}finally{C=null,E=F,O=!1}I=void 0}}finally{I?Q():A=!1}}}var Q;if(typeof N=="function")Q=function(){N(H)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=H,Q=function(){X.postMessage(null)}}else Q=function(){z(H,0)};function V(U,I){T=z(function(){U(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(U){U.callback=null},o.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<U?Math.floor(1e3/U):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(U){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return U()}finally{E=F}},o.unstable_requestPaint=function(){L=!0},o.unstable_runWithPriority=function(U,I){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var F=E;E=U;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(U,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,U){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=F+at,U={id:_++,callback:I,priorityLevel:U,startTime:F,expirationTime:at,sortIndex:-1},F>W?(U.sortIndex=F,t(m,U),n(g)===null&&U===n(m)&&(D?(M(T),T=-1):D=!0,V(R,F-W))):(U.sortIndex=at,t(g,U),v||O||(v=!0,A||(A=!0,Q()))),U},o.unstable_shouldYield=j,o.unstable_wrapCallback=function(U){var I=E;return function(){var F=E;E=I;try{return U.apply(this,arguments)}finally{E=F}}}})(Bp)),Bp}var Zy;function H6(){return Zy||(Zy=1,Up.exports=G6()),Up.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function P6(){return Wy||(Wy=1,(function(o){o.exports=function(t){function n(s,u,p,S){return new sc(s,u,p,S)}function i(){}function r(s){var u="https://react.dev/errors/"+s;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){var u=s,p=s;if(s.alternate)for(;u.return;)u=u.return;else{s=u;do u=s,(u.flags&4098)!==0&&(p=u.return),s=u.return;while(s)}return u.tag===3?p:null}function c(s){if(l(s)!==s)throw Error(r(188))}function d(s){var u=s.alternate;if(!u){if(u=l(s),u===null)throw Error(r(188));return u!==s?null:s}for(var p=s,S=u;;){var x=p.return;if(x===null)break;var P=x.alternate;if(P===null){if(S=x.return,S!==null){p=S;continue}break}if(x.child===P.child){for(P=x.child;P;){if(P===p)return c(x),s;if(P===S)return c(x),u;P=P.sibling}throw Error(r(188))}if(p.return!==S.return)p=x,S=P;else{for(var nt=!1,ut=x.child;ut;){if(ut===p){nt=!0,p=x,S=P;break}if(ut===S){nt=!0,S=x,p=P;break}ut=ut.sibling}if(!nt){for(ut=P.child;ut;){if(ut===p){nt=!0,p=P,S=x;break}if(ut===S){nt=!0,S=P,p=x;break}ut=ut.sibling}if(!nt)throw Error(r(189))}}if(p.alternate!==S)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:u}function g(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(u=g(s),u!==null)return u;s=s.sibling}return null}function m(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(s.tag!==4&&(u=m(s),u!==null))return u;s=s.sibling}return null}function _(s){return s===null||typeof s!="object"?null:(s=qo&&s[qo]||s["@@iterator"],typeof s=="function"?s:null)}function C(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Vo?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case js:return"Fragment";case Po:return"Profiler";case Us:return"StrictMode";case Er:return"Suspense";case Cr:return"SuspenseList";case es:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case br:return"Portal";case _r:return(s.displayName||"Context")+".Provider";case Io:return(s._context.displayName||"Context")+".Consumer";case fc:var u=s.render;return s=s.displayName,s||(s=u.displayName||u.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case hc:return u=s.displayName||null,u!==null?u:C(s.type)||"Memo";case Tr:u=s._payload,s=s._init;try{return C(s(u))}catch{}}return null}function E(s){return{current:s}}function O(s){0>Is||(s.current=Zo[Is],Zo[Is]=null,Is--)}function v(s,u){Is++,Zo[Is]=s.current,s.current=u}function D(s){return s>>>=0,s===0?32:31-(S0(s)/b0|0)|0}function L(s){var u=s&42;if(u!==0)return u;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function z(s,u,p){var S=s.pendingLanes;if(S===0)return 0;var x=0,P=s.suspendedLanes,nt=s.pingedLanes;s=s.warmLanes;var ut=S&134217727;return ut!==0?(S=ut&~P,S!==0?x=L(S):(nt&=ut,nt!==0?x=L(nt):p||(p=ut&~s,p!==0&&(x=L(p))))):(ut=S&~P,ut!==0?x=L(ut):nt!==0?x=L(nt):p||(p=S&~s,p!==0&&(x=L(p)))),x===0?0:u!==0&&u!==x&&(u&P)===0&&(P=x&-x,p=u&-u,P>=p||P===32&&(p&4194048)!==0)?u:x}function M(s,u){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&u)===0}function N(s,u){switch(s){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G(){var s=Wa;return Wa<<=1,(Wa&4194048)===0&&(Wa=256),s}function R(){var s=Wo;return Wo<<=1,(Wo&62914560)===0&&(Wo=4194304),s}function A(s){for(var u=[],p=0;31>p;p++)u.push(s);return u}function T(s,u){s.pendingLanes|=u,u!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function y(s,u,p,S,x,P){var nt=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ut=s.entanglements,_t=s.expirationTimes,Ut=s.hiddenUpdates;for(p=nt&~p;0<p;){var Ht=31-Mi(p),Zt=1<<Ht;ut[Ht]=0,_t[Ht]=-1;var Wt=Ut[Ht];if(Wt!==null)for(Ut[Ht]=null,Ht=0;Ht<Wt.length;Ht++){var Ce=Wt[Ht];Ce!==null&&(Ce.lane&=-536870913)}p&=~Zt}S!==0&&B(s,S,0),P!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=P&~(nt&~u))}function B(s,u,p){s.pendingLanes|=u,s.suspendedLanes&=~u;var S=31-Mi(u);s.entangledLanes|=u,s.entanglements[S]=s.entanglements[S]|1073741824|p&4194090}function j(s,u){var p=s.entangledLanes|=u;for(s=s.entanglements;p;){var S=31-Mi(p),x=1<<S;x&u|s[S]&u&&(s[S]|=u),p&=~x}}function H(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Q(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function K(s){if(typeof Fn=="function"&&di(s),Vi&&typeof Vi.setStrictMode=="function")try{Vi.setStrictMode(Pl,s)}catch{}}function X(s){if(xc===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);xc=u&&u[1]||"",Ah=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xc+s+Ah}function V(s,u){if(!s||ks)return"";ks=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(u){var Zt=function(){throw Error()};if(Object.defineProperty(Zt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Zt,[])}catch(Ce){var Wt=Ce}Reflect.construct(s,[],Zt)}else{try{Zt.call()}catch(Ce){Wt=Ce}s.call(Zt.prototype)}}else{try{throw Error()}catch(Ce){Wt=Ce}(Zt=s())&&typeof Zt.catch=="function"&&Zt.catch(function(){})}}catch(Ce){if(Ce&&Wt&&typeof Ce.stack=="string")return[Ce.stack,Wt.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=S.DetermineComponentFrameRoot(),nt=P[0],ut=P[1];if(nt&&ut){var _t=nt.split(`
`),Ut=ut.split(`
`);for(x=S=0;S<_t.length&&!_t[S].includes("DetermineComponentFrameRoot");)S++;for(;x<Ut.length&&!Ut[x].includes("DetermineComponentFrameRoot");)x++;if(S===_t.length||x===Ut.length)for(S=_t.length-1,x=Ut.length-1;1<=S&&0<=x&&_t[S]!==Ut[x];)x--;for(;1<=S&&0<=x;S--,x--)if(_t[S]!==Ut[x]){if(S!==1||x!==1)do if(S--,x--,0>x||_t[S]!==Ut[x]){var Ht=`
`+_t[S].replace(" at new "," at ");return s.displayName&&Ht.includes("<anonymous>")&&(Ht=Ht.replace("<anonymous>",s.displayName)),Ht}while(1<=S&&0<=x);break}}}finally{ks=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?X(p):""}function U(s){switch(s.tag){case 26:case 27:case 5:return X(s.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return V(s.type,!1);case 11:return V(s.type.render,!1);case 1:return V(s.type,!0);case 31:return X("Activity");default:return""}}function I(s){try{var u="";do u+=U(s),s=s.return;while(s);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function F(s,u){if(typeof s=="object"&&s!==null){var p=wh.get(s);return p!==void 0?p:(u={value:s,source:u,stack:I(u)},wh.set(s,u),u)}return{value:s,source:u,stack:I(u)}}function W(s,u){Or[qs++]=Vs,Or[qs++]=Nc,Nc=s,Vs=u}function at(s,u,p){Yi[la++]=$a,Yi[la++]=Ra,Yi[la++]=os,os=s;var S=$a;s=Ra;var x=32-Mi(S)-1;S&=~(1<<x),p+=1;var P=32-Mi(u)+x;if(30<P){var nt=x-x%5;P=(S&(1<<nt)-1).toString(32),S>>=nt,x-=nt,$a=1<<32-Mi(u)+x|p<<x|S,Ra=P+s}else $a=1<<P|p<<x|S,Ra=s}function Z(s){s.return!==null&&(W(s,1),at(s,1,0))}function rt(s){for(;s===Nc;)Nc=Or[--qs],Or[qs]=null,Vs=Or[--qs],Or[qs]=null;for(;s===os;)os=Yi[--la],Yi[la]=null,Ra=Yi[--la],Yi[la]=null,$a=Yi[--la],Yi[la]=null}function it(s,u){v(Rr,u),v(Ys,s),v(Wn,null),s=eh(u),O(Wn),v(Wn,s)}function Y(){O(Wn),O(Ys),O(Rr)}function J(s){s.memoizedState!==null&&v(Il,s);var u=Wn.current,p=ns(u,s.type);u!==p&&(v(Ys,s),v(Wn,p))}function tt(s){Ys.current===s&&(O(Wn),O(Ys)),Il.current===s&&(O(Il),Ka?ma._currentValue=wr:ma._currentValue2=wr)}function et(s){var u=Error(r(418,""));throw le(F(u,s)),Na}function gt(s,u){if(!An)throw Error(r(175));l0(s.stateNode,s.type,s.memoizedProps,u,s)||et(s)}function At(s){for(ni=s.return;ni;)switch(ni.tag){case 5:case 13:xa=!1;return;case 27:case 3:xa=!0;return;default:ni=ni.return}}function Dt(s){if(!An||s!==ni)return!1;if(!Je)return At(s),Je=!0,!1;var u=s.tag;if(Hn?u!==3&&u!==27&&(u!==5||Cc(s.type)&&!as(s.type,s.memoizedProps))&&Pn&&et(s):u!==3&&(u!==5||Cc(s.type)&&!as(s.type,s.memoizedProps))&&Pn&&et(s),At(s),u===13){if(!An)throw Error(r(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Pn=o0(s)}else Pn=Hn&&u===27?i0(s.type,Pn):ni?ph(s.stateNode):null;return!0}function Qt(){An&&(Pn=ni=null,Je=!1)}function ee(){var s=xr;return s!==null&&(Ci===null?Ci=s:Ci.push.apply(Ci,s),xr=null),s}function le(s){xr===null?xr=[s]:xr.push(s)}function kt(s,u){return s===u&&(s!==0||1/s===1/u)||s!==s&&u!==u}function ye(s,u,p){Ka?(v(Mc,u._currentValue),u._currentValue=p):(v(Mc,u._currentValue2),u._currentValue2=p)}function _e(s){var u=Mc.current;Ka?s._currentValue=u:s._currentValue2=u,O(Mc)}function Xe(s,u,p){for(;s!==null;){var S=s.alternate;if((s.childLanes&u)!==u?(s.childLanes|=u,S!==null&&(S.childLanes|=u)):S!==null&&(S.childLanes&u)!==u&&(S.childLanes|=u),s===p)break;s=s.return}}function xt(s,u,p,S){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var P=x.dependencies;if(P!==null){var nt=x.child;P=P.firstContext;t:for(;P!==null;){var ut=P;P=x;for(var _t=0;_t<u.length;_t++)if(ut.context===u[_t]){P.lanes|=p,ut=P.alternate,ut!==null&&(ut.lanes|=p),Xe(P.return,p,s),S||(nt=null);break t}P=ut.next}}else if(x.tag===18){if(nt=x.return,nt===null)throw Error(r(341));nt.lanes|=p,P=nt.alternate,P!==null&&(P.lanes|=p),Xe(nt,p,s),nt=null}else nt=x.child;if(nt!==null)nt.return=x;else for(nt=x;nt!==null;){if(nt===s){nt=null;break}if(x=nt.sibling,x!==null){x.return=nt.return,nt=x;break}nt=nt.return}x=nt}}function Xt(s,u,p,S){s=null;for(var x=u,P=!1;x!==null;){if(!P){if((x.flags&524288)!==0)P=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var nt=x.alternate;if(nt===null)throw Error(r(387));if(nt=nt.memoizedProps,nt!==null){var ut=x.type;Di(x.pendingProps.value,nt.value)||(s!==null?s.push(ut):s=[ut])}}else if(x===Il.current){if(nt=x.alternate,nt===null)throw Error(r(387));nt.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(ma):s=[ma])}x=x.return}s!==null&&xt(u,s,p,S),u.flags|=262144}function Ue(s){for(s=s.firstContext;s!==null;){var u=s.context;if(!Di(Ka?u._currentValue:u._currentValue2,s.memoizedValue))return!0;s=s.next}return!1}function ae(s){us=s,gi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ge(s){return Me(us,s)}function Fe(s,u){return us===null&&ae(s),Me(s,u)}function Me(s,u){var p=Ka?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},gi===null){if(s===null)throw Error(r(308));gi=u,s.dependencies={lanes:0,firstContext:u},s.flags|=524288}else gi=gi.next=u;return p}function He(){return{controller:new Oh,data:new Map,refCount:0}}function en(s){s.refCount--,s.refCount===0&&C0(Dc,function(){s.controller.abort()})}function dn(s){s!==kl&&s.next===null&&(kl===null?cn=kl=s:kl=kl.next=s),tu=!0,Rh||(Rh=!0,Gt())}function ft(s,u){if(!Ks&&tu){Ks=!0;do for(var p=!1,S=cn;S!==null;){if(s!==0){var x=S.pendingLanes;if(x===0)var P=0;else{var nt=S.suspendedLanes,ut=S.pingedLanes;P=(1<<31-Mi(42|s)+1)-1,P&=x&~(nt&~ut),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(p=!0,Ot(S,P))}else P=De,P=z(S,S===fn?P:0,S.cancelPendingCommit!==null||S.timeoutHandle!==Ya),(P&3)===0||M(S,P)||(p=!0,Ot(S,P));S=S.next}while(p);Ks=!1}}function ht(){ct()}function ct(){tu=Rh=!1;var s=0;oa!==0&&(aa()&&(s=oa),oa=0);for(var u=sa(),p=null,S=cn;S!==null;){var x=S.next,P=wt(S,u);P===0?(S.next=null,p===null?cn=x:p.next=x,x===null&&(kl=p)):(p=S,(s!==0||(P&3)!==0)&&(tu=!0)),S=x}ft(s)}function wt(s,u){for(var p=s.suspendedLanes,S=s.pingedLanes,x=s.expirationTimes,P=s.pendingLanes&-62914561;0<P;){var nt=31-Mi(P),ut=1<<nt,_t=x[nt];_t===-1?((ut&p)===0||(ut&S)!==0)&&(x[nt]=N(ut,u)):_t<=u&&(s.expiredLanes|=ut),P&=~ut}if(u=fn,p=De,p=z(s,s===u?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==Ya),S=s.callbackNode,p===0||s===u&&(Ye===2||Ye===9)||s.cancelPendingCommit!==null)return S!==null&&S!==null&&Oc(S),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||M(s,p)){if(u=p&-p,u===s.callbackPriority)return u;switch(S!==null&&Oc(S),Q(p)){case 2:case 8:p=E0;break;case 32:p=Ch;break;case 268435456:p=Th;break;default:p=Ch}return S=jt.bind(null,s),p=$o(p,S),s.callbackPriority=u,s.callbackNode=p,u}return S!==null&&S!==null&&Oc(S),s.callbackPriority=2,s.callbackNode=null,2}function jt(s,u){if(nn!==0&&nn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(xs()&&s.callbackNode!==p)return null;var S=De;return S=z(s,s===fn?S:0,s.cancelPendingCommit!==null||s.timeoutHandle!==Ya),S===0?null:(ea(s,S,u),wt(s,sa()),s.callbackNode!=null&&s.callbackNode===p?jt.bind(null,s):null)}function Ot(s,u){if(xs())return null;ea(s,u,!0)}function Gt(){gc?Qo(function(){(Re&6)!==0?$o(Eh,ht):ct()}):$o(Eh,ht)}function Bt(){return oa===0&&(oa=G()),oa}function be(s,u){if(ql===null){var p=ql=[];jc=0,tr=Bt(),ji={status:"pending",value:void 0,then:function(S){p.push(S)}}}return jc++,u.then(we,we),u}function we(){if(--jc===0&&ql!==null){ji!==null&&(ji.status="fulfilled");var s=ql;ql=null,tr=0,ji=null;for(var u=0;u<s.length;u++)(0,s[u])()}}function te(s,u){var p=[],S={status:"pending",value:null,reason:null,then:function(x){p.push(x)}};return s.then(function(){S.status="fulfilled",S.value=u;for(var x=0;x<p.length;x++)(0,p[x])(u)},function(x){for(S.status="rejected",S.reason=x,x=0;x<p.length;x++)(0,p[x])(void 0)}),S}function Pe(){var s=Nr.current;return s!==null?s:fn.pooledCache}function sn(s,u){u===null?v(Nr,Nr.current):v(Nr,u.pool)}function Nn(){var s=Pe();return s===null?null:{parent:Ka?pn._currentValue:pn._currentValue2,pool:s}}function Bn(s,u){if(Di(s,u))return!0;if(typeof s!="object"||s===null||typeof u!="object"||u===null)return!1;var p=Object.keys(s),S=Object.keys(u);if(p.length!==S.length)return!1;for(S=0;S<p.length;S++){var x=p[S];if(!T0.call(u,x)||!Di(s[x],u[x]))return!1}return!0}function Zi(s){return s=s.status,s==="fulfilled"||s==="rejected"}function La(){}function cr(s,u,p){switch(p=s[p],p===void 0?s.push(u):p!==u&&(u.then(La,La),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,ba(s),s;default:if(typeof u.status=="string")u.then(La,La);else{if(s=fn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=u,s.status="pending",s.then(function(S){if(u.status==="pending"){var x=u;x.status="fulfilled",x.value=S}},function(S){if(u.status==="pending"){var x=u;x.status="rejected",x.reason=S}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,ba(s),s}throw Ki=u,Qs}}function Cu(){if(Ki===null)throw Error(r(459));var s=Ki;return Ki=null,s}function ba(s){if(s===Qs||s===Xs)throw Error(r(483))}function fr(){for(var s=cs,u=Uc=cs=0;u<s;){var p=$e[u];$e[u++]=null;var S=$e[u];$e[u++]=null;var x=$e[u];$e[u++]=null;var P=$e[u];if($e[u++]=null,S!==null&&x!==null){var nt=S.pending;nt===null?x.next=x:(x.next=nt.next,nt.next=x),S.pending=x}P!==0&&oe(p,x,P)}}function zt(s,u,p,S){$e[cs++]=s,$e[cs++]=u,$e[cs++]=p,$e[cs++]=S,Uc|=S,s.lanes|=S,s=s.alternate,s!==null&&(s.lanes|=S)}function Yt(s,u,p,S){return zt(s,u,p,S),It(s)}function $t(s,u){return zt(s,null,null,u),It(s)}function oe(s,u,p){s.lanes|=p;var S=s.alternate;S!==null&&(S.lanes|=p);for(var x=!1,P=s.return;P!==null;)P.childLanes|=p,S=P.alternate,S!==null&&(S.childLanes|=p),P.tag===22&&(s=P.stateNode,s===null||s._visibility&1||(x=!0)),s=P,P=P.return;return s.tag===3?(P=s.stateNode,x&&u!==null&&(x=31-Mi(p),s=P.hiddenUpdates,S=s[x],S===null?s[x]=[u]:S.push(u),u.lane=p|536870912),P):null}function It(s){if(50<sr)throw sr=0,Hc=null,Error(r(185));for(var u=s.return;u!==null;)s=u,u=s.return;return s.tag===3?s.stateNode:null}function ze(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jn(s,u){s=s.updateQueue,u.updateQueue===s&&(u.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Kt(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ie(s,u,p){var S=s.updateQueue;if(S===null)return null;if(S=S.shared,(Re&2)!==0){var x=S.pending;return x===null?u.next=u:(u.next=x.next,x.next=u),S.pending=u,u=It(s),oe(s,null,p),u}return zt(s,S,u,p),It(s)}function Ie(s,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,j(s,p)}}function xe(s,u){var p=s.updateQueue,S=s.alternate;if(S!==null&&(S=S.updateQueue,p===S)){var x=null,P=null;if(p=p.firstBaseUpdate,p!==null){do{var nt={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};P===null?x=P=nt:P=P.next=nt,p=p.next}while(p!==null);P===null?x=P=u:P=P.next=u}else x=P=u;p={baseState:S.baseState,firstBaseUpdate:x,lastBaseUpdate:P,shared:S.shared,callbacks:S.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=u:s.next=u,p.lastBaseUpdate=u}function We(){if(Nh){var s=ji;if(s!==null)throw s}}function Ai(s,u,p,S){Nh=!1;var x=s.updateQueue;_n=!1;var P=x.firstBaseUpdate,nt=x.lastBaseUpdate,ut=x.shared.pending;if(ut!==null){x.shared.pending=null;var _t=ut,Ut=_t.next;_t.next=null,nt===null?P=Ut:nt.next=Ut,nt=_t;var Ht=s.alternate;Ht!==null&&(Ht=Ht.updateQueue,ut=Ht.lastBaseUpdate,ut!==nt&&(ut===null?Ht.firstBaseUpdate=Ut:ut.next=Ut,Ht.lastBaseUpdate=_t))}if(P!==null){var Zt=x.baseState;nt=0,Ht=Ut=_t=null,ut=P;do{var Wt=ut.lane&-536870913,Ce=Wt!==ut.lane;if(Ce?(De&Wt)===Wt:(S&Wt)===Wt){Wt!==0&&Wt===tr&&(Nh=!0),Ht!==null&&(Ht=Ht.next={lane:0,tag:ut.tag,payload:ut.payload,callback:null,next:null});t:{var ca=s,Ql=ut;Wt=u;var ds=p;switch(Ql.tag){case 1:if(ca=Ql.payload,typeof ca=="function"){Zt=ca.call(ds,Zt,Wt);break t}Zt=ca;break t;case 3:ca.flags=ca.flags&-65537|128;case 0:if(ca=Ql.payload,Wt=typeof ca=="function"?ca.call(ds,Zt,Wt):ca,Wt==null)break t;Zt=uc({},Zt,Wt);break t;case 2:_n=!0}}Wt=ut.callback,Wt!==null&&(s.flags|=64,Ce&&(s.flags|=8192),Ce=x.callbacks,Ce===null?x.callbacks=[Wt]:Ce.push(Wt))}else Ce={lane:Wt,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null},Ht===null?(Ut=Ht=Ce,_t=Zt):Ht=Ht.next=Ce,nt|=Wt;if(ut=ut.next,ut===null){if(ut=x.shared.pending,ut===null)break;Ce=ut,ut=Ce.next,Ce.next=null,x.lastBaseUpdate=Ce,x.shared.pending=null}}while(!0);Ht===null&&(_t=Zt),x.baseState=_t,x.firstBaseUpdate=Ut,x.lastBaseUpdate=Ht,P===null&&(x.shared.lanes=0),Bi|=nt,s.lanes=nt,s.memoizedState=Zt}}function Tu(s,u){if(typeof s!="function")throw Error(r(191,s));s.call(u)}function yd(s,u){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Tu(p[s],u)}function Sd(s,u){s=Sa,v(iu,s),v(Fs,u),Sa=s|u.baseLanes}function Au(){v(iu,Sa),v(Fs,Fs.current)}function ys(){Sa=iu.current,O(Fs),O(iu)}function Mn(){throw Error(r(321))}function Ir(s,u){if(u===null)return!1;for(var p=0;p<u.length&&p<s.length;p++)if(!Di(s[p],u[p]))return!1;return!0}function kr(s,u,p,S,x,P){return tn=P,fe=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ce.H=s===null||s.memoizedState===null?Mh:er,Zs=!1,P=p(S,x),Zs=!1,Js&&(P=Ss(u,p,S,x)),ml(s),P}function ml(s){ce.H=pi;var u=Ge!==null&&Ge.next!==null;if(tn=0,In=Ge=fe=null,au=!1,ii=0,_i=null,u)throw Error(r(300));s===null||$n||(s=s.dependencies,s!==null&&Ue(s)&&($n=!0))}function Ss(s,u,p,S){fe=s;var x=0;do{if(Js&&(_i=null),ii=0,Js=!1,25<=x)throw Error(r(301));if(x+=1,In=Ge=null,s.updateQueue!=null){var P=s.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}ce.H=$s,P=u(p,S)}while(Js);return P}function ti(){var s=ce.H,u=s.useState()[0];return u=typeof u.then=="function"?vl(u):u,s=s.useState()[0],(Ge!==null?Ge.memoizedState:null)!==s&&(fe.flags|=1024),u}function wu(){var s=Ws!==0;return Ws=0,s}function Ou(s,u,p){u.updateQueue=s.updateQueue,u.flags&=-2053,s.lanes&=~p}function hr(s){if(au){for(s=s.memoizedState;s!==null;){var u=s.queue;u!==null&&(u.pending=null),s=s.next}au=!1}tn=0,In=Ge=fe=null,Js=!1,ii=Ws=0,_i=null}function Zn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return In===null?fe.memoizedState=In=s:In=In.next=s,In}function Yn(){if(Ge===null){var s=fe.alternate;s=s!==null?s.memoizedState:null}else s=Ge.next;var u=In===null?fe.memoizedState:In.next;if(u!==null)In=u,Ge=s;else{if(s===null)throw fe.alternate===null?Error(r(467)):Error(r(310));Ge=s,s={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},In===null?fe.memoizedState=In=s:In=In.next=s}return In}function Ru(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function vl(s){var u=ii;return ii+=1,_i===null&&(_i=[]),s=cr(_i,s,u),u=fe,(In===null?u.memoizedState:In.next)===null&&(u=u.alternate,ce.H=u===null||u.memoizedState===null?Mh:er),s}function xu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return vl(s);if(s.$$typeof===_r)return ge(s)}throw Error(r(438,String(s)))}function yl(s){var u=null,p=fe.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var S=fe.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(u={data:S.data.map(function(x){return x.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Ru(),fe.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(s),S=0;S<s;S++)p[S]=ko;return u.index++,p}function fa(s,u){return typeof u=="function"?u(s):u}function ha(s){var u=Yn();return Gi(u,Ge,s)}function Gi(s,u,p){var S=s.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=p;var x=s.baseQueue,P=S.pending;if(P!==null){if(x!==null){var nt=x.next;x.next=P.next,P.next=nt}u.baseQueue=x=P,S.pending=null}if(P=s.baseState,x===null)s.memoizedState=P;else{u=x.next;var ut=nt=null,_t=null,Ut=u,Ht=!1;do{var Zt=Ut.lane&-536870913;if(Zt!==Ut.lane?(De&Zt)===Zt:(tn&Zt)===Zt){var Wt=Ut.revertLane;if(Wt===0)_t!==null&&(_t=_t.next={lane:0,revertLane:0,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null}),Zt===tr&&(Ht=!0);else if((tn&Wt)===Wt){Ut=Ut.next,Wt===tr&&(Ht=!0);continue}else Zt={lane:0,revertLane:Ut.revertLane,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null},_t===null?(ut=_t=Zt,nt=P):_t=_t.next=Zt,fe.lanes|=Wt,Bi|=Wt;Zt=Ut.action,Zs&&p(P,Zt),P=Ut.hasEagerState?Ut.eagerState:p(P,Zt)}else Wt={lane:Zt,revertLane:Ut.revertLane,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null},_t===null?(ut=_t=Wt,nt=P):_t=_t.next=Wt,fe.lanes|=Zt,Bi|=Zt;Ut=Ut.next}while(Ut!==null&&Ut!==u);if(_t===null?nt=P:_t.next=ut,!Di(P,s.memoizedState)&&($n=!0,Ht&&(p=ji,p!==null)))throw p;s.memoizedState=P,s.baseState=nt,s.baseQueue=_t,S.lastRenderedState=P}return x===null&&(S.lanes=0),[s.memoizedState,S.dispatch]}function Nu(s){var u=Yn(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var S=p.dispatch,x=p.pending,P=u.memoizedState;if(x!==null){p.pending=null;var nt=x=x.next;do P=s(P,nt.action),nt=nt.next;while(nt!==x);Di(P,u.memoizedState)||($n=!0),u.memoizedState=P,u.baseQueue===null&&(u.baseState=P),p.lastRenderedState=P}return[P,S]}function bd(s,u,p){var S=fe,x=Yn(),P=Je;if(P){if(p===void 0)throw Error(r(407));p=p()}else p=u();var nt=!Di((Ge||x).memoizedState,p);nt&&(x.memoizedState=p,$n=!0),x=x.queue;var ut=vo.bind(null,S,x,s);if(Ga(2048,8,ut,[s]),x.getSnapshot!==u||nt||In!==null&&In.memoizedState.tag&1){if(S.flags|=2048,Hi(9,Sl(),bf.bind(null,S,x,p,u),null),fn===null)throw Error(r(349));P||(tn&124)!==0||Mu(S,u,p)}return p}function Mu(s,u,p){s.flags|=16384,s={getSnapshot:u,value:p},u=fe.updateQueue,u===null?(u=Ru(),fe.updateQueue=u,u.stores=[s]):(p=u.stores,p===null?u.stores=[s]:p.push(s))}function bf(s,u,p,S){u.value=p,u.getSnapshot=S,_d(u)&&Wi(s)}function vo(s,u,p){return p(function(){_d(u)&&Wi(s)})}function _d(s){var u=s.getSnapshot;s=s.value;try{var p=u();return!Di(s,p)}catch{return!0}}function Wi(s){var u=$t(s,2);u!==null&&ki(u,s,2)}function yo(s){var u=Zn();if(typeof s=="function"){var p=s;if(s=p(),Zs){K(!0);try{p()}finally{K(!1)}}}return u.memoizedState=u.baseState=s,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:s},u}function _f(s,u,p,S){return s.baseState=p,Gi(s,Ge,typeof S=="function"?S:fa)}function Ef(s,u,p,S,x){if(Yr(s))throw Error(r(485));if(s=u.action,s!==null){var P={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(nt){P.listeners.push(nt)}};ce.T!==null?p(!0):P.isTransition=!1,S(P),p=u.pending,p===null?(P.next=u.pending=P,bs(u,P)):(P.next=p.next,u.pending=p.next=P)}}function bs(s,u){var p=u.action,S=u.payload,x=s.state;if(u.isTransition){var P=ce.T,nt={};ce.T=nt;try{var ut=p(x,S),_t=ce.S;_t!==null&&_t(nt,ut),Cf(s,u,ut)}catch(Ut){qr(s,u,Ut)}finally{ce.T=P}}else try{P=p(x,S),Cf(s,u,P)}catch(Ut){qr(s,u,Ut)}}function Cf(s,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(S){Tf(s,u,S)},function(S){return qr(s,u,S)}):Tf(s,u,p)}function Tf(s,u,p){u.status="fulfilled",u.value=p,Ed(u),s.state=p,u=s.pending,u!==null&&(p=u.next,p===u?s.pending=null:(p=p.next,u.next=p,bs(s,p)))}function qr(s,u,p){var S=s.pending;if(s.pending=null,S!==null){S=S.next;do u.status="rejected",u.reason=p,Ed(u),u=u.next;while(u!==S)}s.action=null}function Ed(s){s=s.listeners;for(var u=0;u<s.length;u++)(0,s[u])()}function Af(s,u){return u}function wf(s,u){if(Je){var p=fn.formState;if(p!==null){t:{var S=fe;if(Je){if(Pn){var x=e0(Pn,xa);if(x){Pn=ph(x),S=n0(x);break t}}et(S)}S=!1}S&&(u=p[0])}}p=Zn(),p.memoizedState=p.baseState=u,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Af,lastRenderedState:u},p.queue=S,p=Td.bind(null,fe,S),S.dispatch=p,S=yo(!1);var P=Co.bind(null,fe,!1,S.queue);return S=Zn(),x={state:u,dispatch:null,action:s,pending:null},S.queue=x,p=Ef.bind(null,fe,x,P,p),x.dispatch=p,S.memoizedState=s,[u,p,!1]}function Du(s){var u=Yn();return Cd(u,Ge,s)}function Cd(s,u,p){if(u=Gi(s,u,Af)[0],s=ha(fa)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var S=vl(u)}catch(nt){throw nt===Qs?Xs:nt}else S=u;u=Yn();var x=u.queue,P=x.dispatch;return p!==u.memoizedState&&(fe.flags|=2048,Hi(9,Sl(),Ug.bind(null,x,p),null)),[S,P,s]}function Ug(s,u){s.action=u}function So(s){var u=Yn(),p=Ge;if(p!==null)return Cd(u,p,s);Yn(),u=u.memoizedState,p=Yn();var S=p.queue.dispatch;return p.memoizedState=s,[u,S,!1]}function Hi(s,u,p,S){return s={tag:s,create:p,deps:S,inst:u,next:null},u=fe.updateQueue,u===null&&(u=Ru(),fe.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=s.next=s:(S=p.next,p.next=s,s.next=S,u.lastEffect=s),s}function Sl(){return{destroy:void 0,resource:void 0}}function ju(){return Yn().memoizedState}function dr(s,u,p,S){var x=Zn();S=S===void 0?null:S,fe.flags|=s,x.memoizedState=Hi(1|u,Sl(),p,S)}function Ga(s,u,p,S){var x=Yn();S=S===void 0?null:S;var P=x.memoizedState.inst;Ge!==null&&S!==null&&Ir(S,Ge.memoizedState.deps)?x.memoizedState=Hi(u,P,p,S):(fe.flags|=s,x.memoizedState=Hi(1|u,P,p,S))}function Of(s,u){dr(8390656,8,s,u)}function Uu(s,u){Ga(2048,8,s,u)}function Rf(s,u){return Ga(4,2,s,u)}function bl(s,u){return Ga(4,4,s,u)}function Ha(s,u){if(typeof u=="function"){s=s();var p=u(s);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return s=s(),u.current=s,function(){u.current=null}}function Bu(s,u,p){p=p!=null?p.concat([s]):null,Ga(4,4,Ha.bind(null,u,s),p)}function _s(){}function gr(s,u){var p=Yn();u=u===void 0?null:u;var S=p.memoizedState;return u!==null&&Ir(u,S[1])?S[0]:(p.memoizedState=[s,u],s)}function zu(s,u){var p=Yn();u=u===void 0?null:u;var S=p.memoizedState;if(u!==null&&Ir(u,S[1]))return S[0];if(S=s(),Zs){K(!0);try{s()}finally{K(!1)}}return p.memoizedState=[S,u],S}function _l(s,u,p){return p===void 0||(tn&1073741824)!==0?s.memoizedState=u:(s.memoizedState=p,s=nc(),fe.lanes|=s,Bi|=s,p)}function xf(s,u,p,S){return Di(p,u)?p:Fs.current!==null?(s=_l(s,p,S),Di(s,u)||($n=!0),s):(tn&42)===0?($n=!0,s.memoizedState=p):(s=nc(),fe.lanes|=s,Bi|=s,u)}function bo(s,u,p,S,x){var P=Xa();Qn(P!==0&&8>P?P:8);var nt=ce.T,ut={};ce.T=ut,Co(s,!1,u,p);try{var _t=x(),Ut=ce.S;if(Ut!==null&&Ut(ut,_t),_t!==null&&typeof _t=="object"&&typeof _t.then=="function"){var Ht=te(_t,S);Es(s,u,Ht,Ii(s))}else Es(s,u,S,Ii(s))}catch(Zt){Es(s,u,{then:function(){},status:"rejected",reason:Zt},Ii())}finally{Qn(P),ce.T=nt}}function _o(s){var u=s.memoizedState;if(u!==null)return u;u={memoizedState:wr,baseState:wr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:wr},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:p},next:null},s.memoizedState=u,s=s.alternate,s!==null&&(s.memoizedState=u),u}function Lu(){return ge(ma)}function wi(){return Yn().memoizedState}function Vr(){return Yn().memoizedState}function Gu(s){for(var u=s.return;u!==null;){switch(u.tag){case 24:case 3:var p=Ii();s=Kt(p);var S=ie(u,s,p);S!==null&&(ki(S,u,p),Ie(S,u,p)),u={cache:He()},s.payload=u;return}u=u.return}}function Eo(s,u,p){var S=Ii();p={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Yr(s)?To(u,p):(p=Yt(s,u,p,S),p!==null&&(ki(p,s,S),Nf(p,u,S)))}function Td(s,u,p){var S=Ii();Es(s,u,p,S)}function Es(s,u,p,S){var x={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Yr(s))To(u,x);else{var P=s.alternate;if(s.lanes===0&&(P===null||P.lanes===0)&&(P=u.lastRenderedReducer,P!==null))try{var nt=u.lastRenderedState,ut=P(nt,p);if(x.hasEagerState=!0,x.eagerState=ut,Di(ut,nt))return zt(s,u,x,0),fn===null&&fr(),!1}catch{}finally{}if(p=Yt(s,u,x,S),p!==null)return ki(p,s,S),Nf(p,u,S),!0}return!1}function Co(s,u,p,S){if(S={lane:2,revertLane:Bt(),action:S,hasEagerState:!1,eagerState:null,next:null},Yr(s)){if(u)throw Error(r(479))}else u=Yt(s,p,S,2),u!==null&&ki(u,s,2)}function Yr(s){var u=s.alternate;return s===fe||u!==null&&u===fe}function To(s,u){Js=au=!0;var p=s.pending;p===null?u.next=u:(u.next=p.next,p.next=u),s.pending=u}function Nf(s,u,p){if((p&4194048)!==0){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,j(s,p)}}function Hu(s){var u=tl;return tl+=1,Qi===null&&(Qi=[]),cr(Qi,s,u)}function Ao(s,u){u=u.props.ref,s.ref=u!==void 0?u:null}function Pu(s,u){throw u.$$typeof===Ds?Error(r(525)):(s=Object.prototype.toString.call(u),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":s)))}function Iu(s){var u=s._init;return u(s._payload)}function Ad(s){function u(bt,pt){if(s){var Ct=bt.deletions;Ct===null?(bt.deletions=[pt],bt.flags|=16):Ct.push(pt)}}function p(bt,pt){if(!s)return null;for(;pt!==null;)u(bt,pt),pt=pt.sibling;return null}function S(bt){for(var pt=new Map;bt!==null;)bt.key!==null?pt.set(bt.key,bt):pt.set(bt.index,bt),bt=bt.sibling;return pt}function x(bt,pt){return bt=bn(bt,pt),bt.index=0,bt.sibling=null,bt}function P(bt,pt,Ct){return bt.index=Ct,s?(Ct=bt.alternate,Ct!==null?(Ct=Ct.index,Ct<pt?(bt.flags|=67108866,pt):Ct):(bt.flags|=67108866,pt)):(bt.flags|=1048576,pt)}function nt(bt){return s&&bt.alternate===null&&(bt.flags|=67108866),bt}function ut(bt,pt,Ct,Pt){return pt===null||pt.tag!==6?(pt=$f(Ct,bt.mode,Pt),pt.return=bt,pt):(pt=x(pt,Ct),pt.return=bt,pt)}function _t(bt,pt,Ct,Pt){var Ft=Ct.type;return Ft===js?Ht(bt,pt,Ct.props.children,Pt,Ct.key):pt!==null&&(pt.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===Tr&&Iu(Ft)===pt.type)?(pt=x(pt,Ct.props),Ao(pt,Ct),pt.return=bt,pt):(pt=Ho(Ct.type,Ct.key,Ct.props,null,bt.mode,Pt),Ao(pt,Ct),pt.return=bt,pt)}function Ut(bt,pt,Ct,Pt){return pt===null||pt.tag!==4||pt.stateNode.containerInfo!==Ct.containerInfo||pt.stateNode.implementation!==Ct.implementation?(pt=th(Ct,bt.mode,Pt),pt.return=bt,pt):(pt=x(pt,Ct.children||[]),pt.return=bt,pt)}function Ht(bt,pt,Ct,Pt,Ft){return pt===null||pt.tag!==7?(pt=Ns(Ct,bt.mode,Pt,Ft),pt.return=bt,pt):(pt=x(pt,Ct),pt.return=bt,pt)}function Zt(bt,pt,Ct){if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return pt=$f(""+pt,bt.mode,Ct),pt.return=bt,pt;if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case Bl:return Ct=Ho(pt.type,pt.key,pt.props,null,bt.mode,Ct),Ao(Ct,pt),Ct.return=bt,Ct;case br:return pt=th(pt,bt.mode,Ct),pt.return=bt,pt;case Tr:var Pt=pt._init;return pt=Pt(pt._payload),Zt(bt,pt,Ct)}if(Bs(pt)||_(pt))return pt=Ns(pt,bt.mode,Ct,null),pt.return=bt,pt;if(typeof pt.then=="function")return Zt(bt,Hu(pt),Ct);if(pt.$$typeof===_r)return Zt(bt,Fe(bt,pt),Ct);Pu(bt,pt)}return null}function Wt(bt,pt,Ct,Pt){var Ft=pt!==null?pt.key:null;if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return Ft!==null?null:ut(bt,pt,""+Ct,Pt);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case Bl:return Ct.key===Ft?_t(bt,pt,Ct,Pt):null;case br:return Ct.key===Ft?Ut(bt,pt,Ct,Pt):null;case Tr:return Ft=Ct._init,Ct=Ft(Ct._payload),Wt(bt,pt,Ct,Pt)}if(Bs(Ct)||_(Ct))return Ft!==null?null:Ht(bt,pt,Ct,Pt,null);if(typeof Ct.then=="function")return Wt(bt,pt,Hu(Ct),Pt);if(Ct.$$typeof===_r)return Wt(bt,pt,Fe(bt,Ct),Pt);Pu(bt,Ct)}return null}function Ce(bt,pt,Ct,Pt,Ft){if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number"||typeof Pt=="bigint")return bt=bt.get(Ct)||null,ut(pt,bt,""+Pt,Ft);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case Bl:return bt=bt.get(Pt.key===null?Ct:Pt.key)||null,_t(pt,bt,Pt,Ft);case br:return bt=bt.get(Pt.key===null?Ct:Pt.key)||null,Ut(pt,bt,Pt,Ft);case Tr:var hn=Pt._init;return Pt=hn(Pt._payload),Ce(bt,pt,Ct,Pt,Ft)}if(Bs(Pt)||_(Pt))return bt=bt.get(Ct)||null,Ht(pt,bt,Pt,Ft,null);if(typeof Pt.then=="function")return Ce(bt,pt,Ct,Hu(Pt),Ft);if(Pt.$$typeof===_r)return Ce(bt,pt,Ct,Fe(pt,Pt),Ft);Pu(pt,Pt)}return null}function ca(bt,pt,Ct,Pt){for(var Ft=null,hn=null,ve=pt,Ke=pt=0,ri=null;ve!==null&&Ke<Ct.length;Ke++){ve.index>Ke?(ri=ve,ve=null):ri=ve.sibling;var Ze=Wt(bt,ve,Ct[Ke],Pt);if(Ze===null){ve===null&&(ve=ri);break}s&&ve&&Ze.alternate===null&&u(bt,ve),pt=P(Ze,pt,Ke),hn===null?Ft=Ze:hn.sibling=Ze,hn=Ze,ve=ri}if(Ke===Ct.length)return p(bt,ve),Je&&W(bt,Ke),Ft;if(ve===null){for(;Ke<Ct.length;Ke++)ve=Zt(bt,Ct[Ke],Pt),ve!==null&&(pt=P(ve,pt,Ke),hn===null?Ft=ve:hn.sibling=ve,hn=ve);return Je&&W(bt,Ke),Ft}for(ve=S(ve);Ke<Ct.length;Ke++)ri=Ce(ve,bt,Ke,Ct[Ke],Pt),ri!==null&&(s&&ri.alternate!==null&&ve.delete(ri.key===null?Ke:ri.key),pt=P(ri,pt,Ke),hn===null?Ft=ri:hn.sibling=ri,hn=ri);return s&&ve.forEach(function(gs){return u(bt,gs)}),Je&&W(bt,Ke),Ft}function Ql(bt,pt,Ct,Pt){if(Ct==null)throw Error(r(151));for(var Ft=null,hn=null,ve=pt,Ke=pt=0,ri=null,Ze=Ct.next();ve!==null&&!Ze.done;Ke++,Ze=Ct.next()){ve.index>Ke?(ri=ve,ve=null):ri=ve.sibling;var gs=Wt(bt,ve,Ze.value,Pt);if(gs===null){ve===null&&(ve=ri);break}s&&ve&&gs.alternate===null&&u(bt,ve),pt=P(gs,pt,Ke),hn===null?Ft=gs:hn.sibling=gs,hn=gs,ve=ri}if(Ze.done)return p(bt,ve),Je&&W(bt,Ke),Ft;if(ve===null){for(;!Ze.done;Ke++,Ze=Ct.next())Ze=Zt(bt,Ze.value,Pt),Ze!==null&&(pt=P(Ze,pt,Ke),hn===null?Ft=Ze:hn.sibling=Ze,hn=Ze);return Je&&W(bt,Ke),Ft}for(ve=S(ve);!Ze.done;Ke++,Ze=Ct.next())Ze=Ce(ve,bt,Ke,Ze.value,Pt),Ze!==null&&(s&&Ze.alternate!==null&&ve.delete(Ze.key===null?Ke:Ze.key),pt=P(Ze,pt,Ke),hn===null?Ft=Ze:hn.sibling=Ze,hn=Ze);return s&&ve.forEach(function(Pc){return u(bt,Pc)}),Je&&W(bt,Ke),Ft}function ds(bt,pt,Ct,Pt){if(typeof Ct=="object"&&Ct!==null&&Ct.type===js&&Ct.key===null&&(Ct=Ct.props.children),typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case Bl:t:{for(var Ft=Ct.key;pt!==null;){if(pt.key===Ft){if(Ft=Ct.type,Ft===js){if(pt.tag===7){p(bt,pt.sibling),Pt=x(pt,Ct.props.children),Pt.return=bt,bt=Pt;break t}}else if(pt.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===Tr&&Iu(Ft)===pt.type){p(bt,pt.sibling),Pt=x(pt,Ct.props),Ao(Pt,Ct),Pt.return=bt,bt=Pt;break t}p(bt,pt);break}else u(bt,pt);pt=pt.sibling}Ct.type===js?(Pt=Ns(Ct.props.children,bt.mode,Pt,Ct.key),Pt.return=bt,bt=Pt):(Pt=Ho(Ct.type,Ct.key,Ct.props,null,bt.mode,Pt),Ao(Pt,Ct),Pt.return=bt,bt=Pt)}return nt(bt);case br:t:{for(Ft=Ct.key;pt!==null;){if(pt.key===Ft)if(pt.tag===4&&pt.stateNode.containerInfo===Ct.containerInfo&&pt.stateNode.implementation===Ct.implementation){p(bt,pt.sibling),Pt=x(pt,Ct.children||[]),Pt.return=bt,bt=Pt;break t}else{p(bt,pt);break}else u(bt,pt);pt=pt.sibling}Pt=th(Ct,bt.mode,Pt),Pt.return=bt,bt=Pt}return nt(bt);case Tr:return Ft=Ct._init,Ct=Ft(Ct._payload),ds(bt,pt,Ct,Pt)}if(Bs(Ct))return ca(bt,pt,Ct,Pt);if(_(Ct)){if(Ft=_(Ct),typeof Ft!="function")throw Error(r(150));return Ct=Ft.call(Ct),Ql(bt,pt,Ct,Pt)}if(typeof Ct.then=="function")return ds(bt,pt,Hu(Ct),Pt);if(Ct.$$typeof===_r)return ds(bt,pt,Fe(bt,Ct),Pt);Pu(bt,Ct)}return typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint"?(Ct=""+Ct,pt!==null&&pt.tag===6?(p(bt,pt.sibling),Pt=x(pt,Ct),Pt.return=bt,bt=Pt):(p(bt,pt),Pt=$f(Ct,bt.mode,Pt),Pt.return=bt,bt=Pt),nt(bt)):p(bt,pt)}return function(bt,pt,Ct,Pt){try{tl=0;var Ft=ds(bt,pt,Ct,Pt);return Qi=null,Ft}catch(ve){if(ve===Qs||ve===Xs)throw ve;var hn=n(29,ve,null,bt.mode);return hn.lanes=Pt,hn.return=bt,hn}finally{}}}function Kr(s){var u=s.alternate;v(jn,jn.current&1),v(ua,s),Ui===null&&(u===null||Fs.current!==null||u.memoizedState!==null)&&(Ui=s)}function wd(s){if(s.tag===22){if(v(jn,jn.current),v(ua,s),Ui===null){var u=s.alternate;u!==null&&u.memoizedState!==null&&(Ui=s)}}else Qr()}function Qr(){v(jn,jn.current),v(ua,ua.current)}function pr(s){O(ua),Ui===s&&(Ui=null),O(jn)}function wo(s){for(var u=s;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Sc(p)||bc(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function Mf(s,u,p,S){u=s.memoizedState,p=p(S,u),p=p==null?u:uc({},u,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}function Od(s,u,p,S,x,P,nt){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(S,P,nt):u.prototype&&u.prototype.isPureReactComponent?!Bn(p,S)||!Bn(x,P):!0}function Rd(s,u,p,S){s=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,S),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,S),u.state!==s&&el.enqueueReplaceState(u,u.state,null)}function Cs(s,u){var p=u;if("ref"in u){p={};for(var S in u)S!=="ref"&&(p[S]=u[S])}if(s=s.defaultProps){p===u&&(p=uc({},p));for(var x in s)p[x]===void 0&&(p[x]=s[x])}return p}function El(s,u){try{var p=s.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(S){setTimeout(function(){throw S})}}function xd(s,u,p){try{var S=s.onCaughtError;S(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Df(s,u,p){return p=Kt(p),p.tag=3,p.payload={element:null},p.callback=function(){El(s,u)},p}function Nd(s){return s=Kt(s),s.tag=3,s}function jf(s,u,p,S){var x=p.type.getDerivedStateFromError;if(typeof x=="function"){var P=S.value;s.payload=function(){return x(P)},s.callback=function(){xd(u,p,S)}}var nt=p.stateNode;nt!==null&&typeof nt.componentDidCatch=="function"&&(s.callback=function(){xd(u,p,S),typeof x!="function"&&(jr===null?jr=new Set([this]):jr.add(this));var ut=S.stack;this.componentDidCatch(S.value,{componentStack:ut!==null?ut:""})})}function Bg(s,u,p,S,x){if(p.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(u=p.alternate,u!==null&&Xt(u,p,x,!0),p=ua.current,p!==null){switch(p.tag){case 13:return Ui===null?ic():p.alternate===null&&En===0&&(En=3),p.flags&=-257,p.flags|=65536,p.lanes=x,S===nu?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([S]):u.add(S),Oa(s,S,x)),!1;case 22:return p.flags|=65536,S===nu?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([S])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([S]):p.add(S)),Oa(s,S,x)),!1}throw Error(r(435,p.tag))}return Oa(s,S,x),ic(),!1}if(Je)return u=ua.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=x,S!==Na&&(s=Error(r(422),{cause:S}),le(F(s,p)))):(S!==Na&&(u=Error(r(423),{cause:S}),le(F(u,p))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,S=F(S,p),x=Df(s.stateNode,S,x),xe(s,x),En!==4&&(En=2)),!1;var P=Error(r(520),{cause:S});if(P=F(P,p),al===null?al=[P]:al.push(P),En!==4&&(En=2),u===null)return!0;S=F(S,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,s=x&-x,p.lanes|=s,s=Df(p.stateNode,S,s),xe(p,s),!1;case 1:if(u=p.type,P=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(jr===null||!jr.has(P))))return p.flags|=65536,x&=-x,p.lanes|=x,x=Nd(x),jf(x,s,p,S),xe(p,x),!1}p=p.return}while(p!==null);return!1}function li(s,u,p,S){u.child=s===null?va(u,null,p,S):fs(u,s.child,p,S)}function Md(s,u,p,S,x){p=p.render;var P=u.ref;if("ref"in S){var nt={};for(var ut in S)ut!=="ref"&&(nt[ut]=S[ut])}else nt=S;return ae(u),S=kr(s,u,p,nt,P,x),ut=wu(),s!==null&&!$n?(Ou(s,u,x),Pa(s,u,x)):(Je&&ut&&Z(u),u.flags|=1,li(s,u,S,x),u.child)}function Dd(s,u,p,S,x){if(s===null){var P=p.type;return typeof P=="function"&&!Sr(P)&&P.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=P,jd(s,u,P,S,x)):(s=Ho(p.type,null,S,u,u.mode,x),s.ref=u.ref,s.return=u,u.child=s)}if(P=s.child,!Qu(s,x)){var nt=P.memoizedProps;if(p=p.compare,p=p!==null?p:Bn,p(nt,S)&&s.ref===u.ref)return Pa(s,u,x)}return u.flags|=1,s=bn(P,S),s.ref=u.ref,s.return=u,u.child=s}function jd(s,u,p,S,x){if(s!==null){var P=s.memoizedProps;if(Bn(P,S)&&s.ref===u.ref)if($n=!1,u.pendingProps=S=P,Qu(s,x))(s.flags&131072)!==0&&($n=!0);else return u.lanes=s.lanes,Pa(s,u,x)}return Uf(s,u,p,S,x)}function Ud(s,u,p){var S=u.pendingProps,x=S.children,P=s!==null?s.memoizedState:null;if(S.mode==="hidden"){if((u.flags&128)!==0){if(S=P!==null?P.baseLanes|p:p,s!==null){for(x=u.child=s.child,P=0;x!==null;)P=P|x.lanes|x.childLanes,x=x.sibling;u.childLanes=P&~S}else u.childLanes=0,u.child=null;return Bd(s,u,S,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},s!==null&&sn(u,P!==null?P.cachePool:null),P!==null?Sd(u,P):Au(),wd(u);else return u.lanes=u.childLanes=536870912,Bd(s,u,P!==null?P.baseLanes|p:p,p)}else P!==null?(sn(u,P.cachePool),Sd(u,P),Qr(),u.memoizedState=null):(s!==null&&sn(u,null),Au(),Qr());return li(s,u,x,p),u.child}function Bd(s,u,p,S){var x=Pe();return x=x===null?null:{parent:Ka?pn._currentValue:pn._currentValue2,pool:x},u.memoizedState={baseLanes:p,cachePool:x},s!==null&&sn(u,null),Au(),wd(u),s!==null&&Xt(s,u,S,!0),null}function ku(s,u){var p=u.ref;if(p===null)s!==null&&s.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(u.flags|=4194816)}}function Uf(s,u,p,S,x){return ae(u),p=kr(s,u,p,S,void 0,x),S=wu(),s!==null&&!$n?(Ou(s,u,x),Pa(s,u,x)):(Je&&S&&Z(u),u.flags|=1,li(s,u,p,x),u.child)}function qu(s,u,p,S,x,P){return ae(u),u.updateQueue=null,p=Ss(u,S,p,x),ml(s),S=wu(),s!==null&&!$n?(Ou(s,u,P),Pa(s,u,P)):(Je&&S&&Z(u),u.flags|=1,li(s,u,p,P),u.child)}function Cl(s,u,p,S,x){if(ae(u),u.stateNode===null){var P=ls,nt=p.contextType;typeof nt=="object"&&nt!==null&&(P=ge(nt)),P=new p(S,P),u.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=el,u.stateNode=P,P._reactInternals=u,P=u.stateNode,P.props=S,P.state=u.memoizedState,P.refs={},ze(u),nt=p.contextType,P.context=typeof nt=="object"&&nt!==null?ge(nt):ls,P.state=u.memoizedState,nt=p.getDerivedStateFromProps,typeof nt=="function"&&(Mf(u,p,nt,S),P.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(nt=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),nt!==P.state&&el.enqueueReplaceState(P,P.state,null),Ai(u,S,P,x),We(),P.state=u.memoizedState),typeof P.componentDidMount=="function"&&(u.flags|=4194308),S=!0}else if(s===null){P=u.stateNode;var ut=u.memoizedProps,_t=Cs(p,ut);P.props=_t;var Ut=P.context,Ht=p.contextType;nt=ls,typeof Ht=="object"&&Ht!==null&&(nt=ge(Ht));var Zt=p.getDerivedStateFromProps;Ht=typeof Zt=="function"||typeof P.getSnapshotBeforeUpdate=="function",ut=u.pendingProps!==ut,Ht||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(ut||Ut!==nt)&&Rd(u,P,S,nt),_n=!1;var Wt=u.memoizedState;P.state=Wt,Ai(u,S,P,x),We(),Ut=u.memoizedState,ut||Wt!==Ut||_n?(typeof Zt=="function"&&(Mf(u,p,Zt,S),Ut=u.memoizedState),(_t=_n||Od(u,p,_t,S,Wt,Ut,nt))?(Ht||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(u.flags|=4194308)):(typeof P.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=S,u.memoizedState=Ut),P.props=S,P.state=Ut,P.context=nt,S=_t):(typeof P.componentDidMount=="function"&&(u.flags|=4194308),S=!1)}else{P=u.stateNode,Jn(s,u),nt=u.memoizedProps,Ht=Cs(p,nt),P.props=Ht,Zt=u.pendingProps,Wt=P.context,Ut=p.contextType,_t=ls,typeof Ut=="object"&&Ut!==null&&(_t=ge(Ut)),ut=p.getDerivedStateFromProps,(Ut=typeof ut=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(nt!==Zt||Wt!==_t)&&Rd(u,P,S,_t),_n=!1,Wt=u.memoizedState,P.state=Wt,Ai(u,S,P,x),We();var Ce=u.memoizedState;nt!==Zt||Wt!==Ce||_n||s!==null&&s.dependencies!==null&&Ue(s.dependencies)?(typeof ut=="function"&&(Mf(u,p,ut,S),Ce=u.memoizedState),(Ht=_n||Od(u,p,Ht,S,Wt,Ce,_t)||s!==null&&s.dependencies!==null&&Ue(s.dependencies))?(Ut||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(S,Ce,_t),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(S,Ce,_t)),typeof P.componentDidUpdate=="function"&&(u.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof P.componentDidUpdate!="function"||nt===s.memoizedProps&&Wt===s.memoizedState||(u.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||nt===s.memoizedProps&&Wt===s.memoizedState||(u.flags|=1024),u.memoizedProps=S,u.memoizedState=Ce),P.props=S,P.state=Ce,P.context=_t,S=Ht):(typeof P.componentDidUpdate!="function"||nt===s.memoizedProps&&Wt===s.memoizedState||(u.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||nt===s.memoizedProps&&Wt===s.memoizedState||(u.flags|=1024),S=!1)}return P=S,ku(s,u),S=(u.flags&128)!==0,P||S?(P=u.stateNode,p=S&&typeof p.getDerivedStateFromError!="function"?null:P.render(),u.flags|=1,s!==null&&S?(u.child=fs(u,s.child,null,x),u.child=fs(u,null,p,x)):li(s,u,p,x),u.memoizedState=P.state,s=u.child):s=Pa(s,u,x),s}function zd(s,u,p,S){return Qt(),u.flags|=256,li(s,u,p,S),u.child}function Vu(s){return{baseLanes:s,cachePool:Nn()}}function Yu(s,u,p){return s=s!==null?s.childLanes&~p:0,u&&(s|=mi),s}function Bf(s,u,p){var S=u.pendingProps,x=!1,P=(u.flags&128)!==0,nt;if((nt=P)||(nt=s!==null&&s.memoizedState===null?!1:(jn.current&2)!==0),nt&&(x=!0,u.flags&=-129),nt=(u.flags&32)!==0,u.flags&=-33,s===null){if(Je){if(x?Kr(u):Qr(),Je){var ut=Pn,_t;(_t=ut)&&(ut=Ec(ut,xa),ut!==null?(u.memoizedState={dehydrated:ut,treeContext:os!==null?{id:$a,overflow:Ra}:null,retryLane:536870912,hydrationErrors:null},_t=n(18,null,null,0),_t.stateNode=ut,_t.return=u,u.child=_t,ni=u,Pn=null,_t=!0):_t=!1),_t||et(u)}if(ut=u.memoizedState,ut!==null&&(ut=ut.dehydrated,ut!==null))return bc(ut)?u.lanes=32:u.lanes=536870912,null;pr(u)}return ut=S.children,S=S.fallback,x?(Qr(),x=u.mode,ut=Oo({mode:"hidden",children:ut},x),S=Ns(S,x,p,null),ut.return=u,S.return=u,ut.sibling=S,u.child=ut,x=u.child,x.memoizedState=Vu(p),x.childLanes=Yu(s,nt,p),u.memoizedState=il,S):(Kr(u),Ku(u,ut))}if(_t=s.memoizedState,_t!==null&&(ut=_t.dehydrated,ut!==null)){if(P)u.flags&256?(Kr(u),u.flags&=-257,u=Xr(s,u,p)):u.memoizedState!==null?(Qr(),u.child=s.child,u.flags|=128,u=null):(Qr(),x=S.fallback,ut=u.mode,S=Oo({mode:"visible",children:S.children},ut),x=Ns(x,ut,p,null),x.flags|=2,S.return=u,x.return=u,S.sibling=x,u.child=S,fs(u,s.child,null,p),S=u.child,S.memoizedState=Vu(p),S.childLanes=Yu(s,nt,p),u.memoizedState=il,u=x);else if(Kr(u),bc(ut))nt=t0(ut).digest,S=Error(r(419)),S.stack="",S.digest=nt,le({value:S,source:null,stack:null}),u=Xr(s,u,p);else if($n||Xt(s,u,p,!1),nt=(p&s.childLanes)!==0,$n||nt){if(nt=fn,nt!==null&&(S=p&-p,S=(S&42)!==0?1:H(S),S=(S&(nt.suspendedLanes|p))!==0?0:S,S!==0&&S!==_t.retryLane))throw _t.retryLane=S,$t(s,S),ki(nt,s,S),Dh;Sc(ut)||ic(),u=Xr(s,u,p)}else Sc(ut)?(u.flags|=192,u.child=s.child,u=null):(s=_t.treeContext,An&&(Pn=r0(ut),ni=u,Je=!0,xr=null,xa=!1,s!==null&&(Yi[la++]=$a,Yi[la++]=Ra,Yi[la++]=os,$a=s.id,Ra=s.overflow,os=u)),u=Ku(u,S.children),u.flags|=4096);return u}return x?(Qr(),x=S.fallback,ut=u.mode,_t=s.child,P=_t.sibling,S=bn(_t,{mode:"hidden",children:S.children}),S.subtreeFlags=_t.subtreeFlags&65011712,P!==null?x=bn(P,x):(x=Ns(x,ut,p,null),x.flags|=2),x.return=u,S.return=u,S.sibling=x,u.child=S,S=x,x=u.child,ut=s.child.memoizedState,ut===null?ut=Vu(p):(_t=ut.cachePool,_t!==null?(P=Ka?pn._currentValue:pn._currentValue2,_t=_t.parent!==P?{parent:P,pool:P}:_t):_t=Nn(),ut={baseLanes:ut.baseLanes|p,cachePool:_t}),x.memoizedState=ut,x.childLanes=Yu(s,nt,p),u.memoizedState=il,S):(Kr(u),p=s.child,s=p.sibling,p=bn(p,{mode:"visible",children:S.children}),p.return=u,p.sibling=null,s!==null&&(nt=u.deletions,nt===null?(u.deletions=[s],u.flags|=16):nt.push(s)),u.child=p,u.memoizedState=null,p)}function Ku(s,u){return u=Oo({mode:"visible",children:u},s.mode),u.return=s,s.child=u}function Oo(s,u){return s=n(22,s,null,u),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Xr(s,u,p){return fs(u,s.child,null,p),s=Ku(u,u.pendingProps.children),s.flags|=2,u.memoizedState=null,s}function Ld(s,u,p){s.lanes|=u;var S=s.alternate;S!==null&&(S.lanes|=u),Xe(s.return,u,p)}function zf(s,u,p,S,x){var P=s.memoizedState;P===null?s.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:S,tail:p,tailMode:x}:(P.isBackwards=u,P.rendering=null,P.renderingStartTime=0,P.last=S,P.tail=p,P.tailMode=x)}function Gd(s,u,p){var S=u.pendingProps,x=S.revealOrder,P=S.tail;if(li(s,u,S.children,p),S=jn.current,(S&2)!==0)S=S&1|2,u.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=u.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ld(s,p,u);else if(s.tag===19)Ld(s,p,u);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===u)break t;for(;s.sibling===null;){if(s.return===null||s.return===u)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}S&=1}switch(v(jn,S),x){case"forwards":for(p=u.child,x=null;p!==null;)s=p.alternate,s!==null&&wo(s)===null&&(x=p),p=p.sibling;p=x,p===null?(x=u.child,u.child=null):(x=p.sibling,p.sibling=null),zf(u,!1,x,p,P);break;case"backwards":for(p=null,x=u.child,u.child=null;x!==null;){if(s=x.alternate,s!==null&&wo(s)===null){u.child=x;break}s=x.sibling,x.sibling=p,p=x,x=s}zf(u,!0,p,null,P);break;case"together":zf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Pa(s,u,p){if(s!==null&&(u.dependencies=s.dependencies),Bi|=u.lanes,(p&u.childLanes)===0)if(s!==null){if(Xt(s,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(s!==null&&u.child!==s.child)throw Error(r(153));if(u.child!==null){for(s=u.child,p=bn(s,s.pendingProps),u.child=p,p.return=u;s.sibling!==null;)s=s.sibling,p=p.sibling=bn(s,s.pendingProps),p.return=u;p.sibling=null}return u.child}function Qu(s,u){return(s.lanes&u)!==0?!0:(s=s.dependencies,!!(s!==null&&Ue(s)))}function Ro(s,u,p){switch(u.tag){case 3:it(u,u.stateNode.containerInfo),ye(u,pn,s.memoizedState.cache),Qt();break;case 27:case 5:J(u);break;case 4:it(u,u.stateNode.containerInfo);break;case 10:ye(u,u.type,u.memoizedProps.value);break;case 13:var S=u.memoizedState;if(S!==null)return S.dehydrated!==null?(Kr(u),u.flags|=128,null):(p&u.child.childLanes)!==0?Bf(s,u,p):(Kr(u),s=Pa(s,u,p),s!==null?s.sibling:null);Kr(u);break;case 19:var x=(s.flags&128)!==0;if(S=(p&u.childLanes)!==0,S||(Xt(s,u,p,!1),S=(p&u.childLanes)!==0),x){if(S)return Gd(s,u,p);u.flags|=128}if(x=u.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),v(jn,jn.current),S)break;return null;case 22:case 23:return u.lanes=0,Ud(s,u,p);case 24:ye(u,pn,s.memoizedState.cache)}return Pa(s,u,p)}function Tl(s,u,p){if(s!==null)if(s.memoizedProps!==u.pendingProps)$n=!0;else{if(!Qu(s,p)&&(u.flags&128)===0)return $n=!1,Ro(s,u,p);$n=(s.flags&131072)!==0}else $n=!1,Je&&(u.flags&1048576)!==0&&at(u,Vs,u.index);switch(u.lanes=0,u.tag){case 16:t:{s=u.pendingProps;var S=u.elementType,x=S._init;if(S=x(S._payload),u.type=S,typeof S=="function")Sr(S)?(s=Cs(S,s),u.tag=1,u=Cl(null,u,S,s,p)):(u.tag=0,u=Uf(null,u,S,s,p));else{if(S!=null){if(x=S.$$typeof,x===fc){u.tag=11,u=Md(null,u,S,s,p);break t}else if(x===hc){u.tag=14,u=Dd(null,u,S,s,p);break t}}throw u=C(S)||S,Error(r(306,u,""))}}return u;case 0:return Uf(s,u,u.type,u.pendingProps,p);case 1:return S=u.type,x=Cs(S,u.pendingProps),Cl(s,u,S,x,p);case 3:t:{if(it(u,u.stateNode.containerInfo),s===null)throw Error(r(387));var P=u.pendingProps;x=u.memoizedState,S=x.element,Jn(s,u),Ai(u,P,null,p);var nt=u.memoizedState;if(P=nt.cache,ye(u,pn,P),P!==x.cache&&xt(u,[pn],p,!0),We(),P=nt.element,An&&x.isDehydrated)if(x={element:P,isDehydrated:!1,cache:nt.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=zd(s,u,P,p);break t}else if(P!==S){S=F(Error(r(424)),u),le(S),u=zd(s,u,P,p);break t}else for(An&&(Pn=Pg(u.stateNode.containerInfo),ni=u,Je=!0,xr=null,xa=!0),p=va(u,null,P,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Qt(),P===S){u=Pa(s,u,p);break t}li(s,u,P,p)}u=u.child}return u;case 26:if(ra)return ku(s,u),s===null?(p=p0(u.type,null,u.pendingProps,null))?u.memoizedState=p:Je||(u.stateNode=v0(u.type,u.pendingProps,Rr.current,u)):u.memoizedState=p0(u.type,s.memoizedProps,u.pendingProps,s.memoizedState),null;case 27:if(Hn)return J(u),s===null&&Hn&&Je&&(S=u.stateNode=Jo(u.type,u.pendingProps,Rr.current,Wn.current,!1),ni=u,xa=!0,Pn=Gl(u.type,S,Pn)),li(s,u,u.pendingProps.children,p),ku(s,u),s===null&&(u.flags|=4194304),u.child;case 5:return s===null&&Je&&(d0(u.type,u.pendingProps,Wn.current),(x=S=Pn)&&(S=s0(S,u.type,u.pendingProps,xa),S!==null?(u.stateNode=S,ni=u,Pn=a0(S),xa=!1,x=!0):x=!1),x||et(u)),J(u),x=u.type,P=u.pendingProps,nt=s!==null?s.memoizedProps:null,S=P.children,as(x,P)?S=null:nt!==null&&as(x,nt)&&(u.flags|=32),u.memoizedState!==null&&(x=kr(s,u,ti,null,null,p),Ka?ma._currentValue=x:ma._currentValue2=x),ku(s,u),li(s,u,S,p),u.child;case 6:return s===null&&Je&&(g0(u.pendingProps,Wn.current),(s=p=Pn)&&(p=_c(p,u.pendingProps,xa),p!==null?(u.stateNode=p,ni=u,Pn=null,s=!0):s=!1),s||et(u)),null;case 13:return Bf(s,u,p);case 4:return it(u,u.stateNode.containerInfo),S=u.pendingProps,s===null?u.child=fs(u,null,S,p):li(s,u,S,p),u.child;case 11:return Md(s,u,u.type,u.pendingProps,p);case 7:return li(s,u,u.pendingProps,p),u.child;case 8:return li(s,u,u.pendingProps.children,p),u.child;case 12:return li(s,u,u.pendingProps.children,p),u.child;case 10:return S=u.pendingProps,ye(u,u.type,S.value),li(s,u,S.children,p),u.child;case 9:return x=u.type._context,S=u.pendingProps.children,ae(u),x=ge(x),S=S(x),u.flags|=1,li(s,u,S,p),u.child;case 14:return Dd(s,u,u.type,u.pendingProps,p);case 15:return jd(s,u,u.type,u.pendingProps,p);case 19:return Gd(s,u,p);case 31:return S=u.pendingProps,p=u.mode,S={mode:S.mode,children:S.children},s===null?(p=Oo(S,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=bn(s.child,S),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return Ud(s,u,p);case 24:return ae(u),S=ge(pn),s===null?(x=Pe(),x===null&&(x=fn,P=He(),x.pooledCache=P,P.refCount++,P!==null&&(x.pooledCacheLanes|=p),x=P),u.memoizedState={parent:S,cache:x},ze(u),ye(u,pn,x)):((s.lanes&p)!==0&&(Jn(s,u),Ai(u,null,null,p),We()),x=s.memoizedState,P=u.memoizedState,x.parent!==S?(x={parent:S,cache:S},u.memoizedState=x,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=x),ye(u,pn,S)):(S=P.cache,ye(u,pn,S),S!==x.cache&&xt(u,[pn],p,!0))),li(s,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function $i(s){s.flags|=4}function xo(s,u){if(s!==null&&s.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(s=u.child;s!==null;){if((s.flags&13878)!==0||(s.subtreeFlags&13878)!==0)return!0;s=s.sibling}return!1}function Xu(s,u,p,S){if(ei)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)Ko(s,p.stateNode);else if(!(p.tag===4||Hn&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(Qa)for(var x=u.child;x!==null;){if(x.tag===5){var P=x.stateNode;p&&S&&(P=dh(P,x.type,x.memoizedProps)),Ko(s,P)}else if(x.tag===6)P=x.stateNode,p&&S&&(P=$d(P,x.memoizedProps)),Ko(s,P);else if(x.tag!==4){if(x.tag===22&&x.memoizedState!==null)P=x.child,P!==null&&(P.return=x),Xu(s,x,!0,!0);else if(x.child!==null){x.child.return=x,x=x.child;continue}}if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return}x.sibling.return=x.return,x=x.sibling}}function Lf(s,u,p,S){var x=!1;if(Qa)for(var P=u.child;P!==null;){if(P.tag===5){var nt=P.stateNode;p&&S&&(nt=dh(nt,P.type,P.memoizedProps)),hh(s,nt)}else if(P.tag===6)nt=P.stateNode,p&&S&&(nt=$d(nt,P.memoizedProps)),hh(s,nt);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)x=P.child,x!==null&&(x.return=P),Lf(s,P,!0,!0),x=!0;else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===u)break;for(;P.sibling===null;){if(P.return===null||P.return===u)return x;P=P.return}P.sibling.return=P.return,P=P.sibling}return x}function Fu(s,u){if(Qa&&xo(s,u)){s=u.stateNode;var p=s.containerInfo,S=fh();Lf(S,u,!1,!1),s.pendingChildren=S,$i(u),Wd(p,S)}}function No(s,u,p,S){if(ei)s.memoizedProps!==S&&$i(u);else if(Qa){var x=s.stateNode,P=s.memoizedProps;if((s=xo(s,u))||P!==S){var nt=Wn.current;P=Zd(x,p,P,S,!s,null),P===x?u.stateNode=x:(zl(P,p,S,nt)&&$i(u),u.stateNode=P,s?Xu(P,u,!1,!1):$i(u))}else u.stateNode=x}}function Ju(s,u,p){if(dc(u,p)){if(s.flags|=16777216,!Fa(u,p))if(Aa())s.flags|=8192;else throw Ki=nu,eu}else s.flags&=-16777217}function Gf(s,u){if(qg(u)){if(s.flags|=16777216,!bh(u))if(Aa())s.flags|=8192;else throw Ki=nu,eu}else s.flags&=-16777217}function Mo(s,u){u!==null&&(s.flags|=4),s.flags&16384&&(u=s.tag!==22?R():536870912,s.lanes|=u,Xi|=u)}function Do(s,u){if(!Je)switch(s.tailMode){case"hidden":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?u||s.tail===null?s.tail=null:s.tail.sibling=null:S.sibling=null}}function Dn(s){var u=s.alternate!==null&&s.alternate.child===s.child,p=0,S=0;if(u)for(var x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags&65011712,S|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags,S|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=S,s.childLanes=p,u}function zg(s,u,p){var S=u.pendingProps;switch(rt(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dn(u),null;case 1:return Dn(u),null;case 3:return p=u.stateNode,S=null,s!==null&&(S=s.memoizedState.cache),u.memoizedState.cache!==S&&(u.flags|=2048),_e(pn),Y(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Dt(u)?$i(u):s===null||s.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,ee())),Fu(s,u),Dn(u),null;case 26:if(ra){p=u.type;var x=u.memoizedState;return s===null?($i(u),x!==null?(Dn(u),Gf(u,x)):(Dn(u),Ju(u,p,S))):x?x!==s.memoizedState?($i(u),Dn(u),Gf(u,x)):(Dn(u),u.flags&=-16777217):(ei?s.memoizedProps!==S&&$i(u):No(s,u,p,S),Dn(u),Ju(u,p,S)),null}case 27:if(Hn){if(tt(u),p=Rr.current,x=u.type,s!==null&&u.stateNode!=null)ei?s.memoizedProps!==S&&$i(u):No(s,u,x,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return Dn(u),null}s=Wn.current,Dt(u)?gt(u,s):(s=Jo(x,S,p,s,!0),u.stateNode=s,$i(u))}return Dn(u),null}case 5:if(tt(u),p=u.type,s!==null&&u.stateNode!=null)No(s,u,p,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return Dn(u),null}s=Wn.current,Dt(u)?gt(u,s):(x=nh(p,S,Rr.current,s,u),Xu(x,u,!1,!1),u.stateNode=x,zl(x,p,S,s)&&$i(u))}return Dn(u),Ju(u,u.type,u.pendingProps),null;case 6:if(s&&u.stateNode!=null)p=s.memoizedProps,ei?p!==S&&$i(u):Qa&&(p!==S?(u.stateNode=ih(S,Rr.current,Wn.current,u),$i(u)):u.stateNode=s.stateNode);else{if(typeof S!="string"&&u.stateNode===null)throw Error(r(166));if(s=Rr.current,p=Wn.current,Dt(u)){if(!An)throw Error(r(176));if(s=u.stateNode,p=u.memoizedProps,S=null,x=ni,x!==null)switch(x.tag){case 27:case 5:S=x.memoizedProps}mh(s,p,u,S)||et(u)}else u.stateNode=ih(S,s,p,u)}return Dn(u),null;case 13:if(S=u.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=Dt(u),S!==null&&S.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(!An)throw Error(r(344));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));Ig(x,u)}else Qt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Dn(u),x=!1}else x=ee(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return u.flags&256?(pr(u),u):(pr(u),null)}if(pr(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=S!==null,s=s!==null&&s.memoizedState!==null,p){S=u.child,x=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(x=S.alternate.memoizedState.cachePool.pool);var P=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(P=S.memoizedState.cachePool.pool),P!==x&&(S.flags|=2048)}return p!==s&&p&&(u.child.flags|=8192),Mo(u,u.updateQueue),Dn(u),null;case 4:return Y(),Fu(s,u),s===null&&rs(u.stateNode.containerInfo),Dn(u),null;case 10:return _e(u.type),Dn(u),null;case 19:if(O(jn),x=u.memoizedState,x===null)return Dn(u),null;if(S=(u.flags&128)!==0,P=x.rendering,P===null)if(S)Do(x,!1);else{if(En!==0||s!==null&&(s.flags&128)!==0)for(s=u.child;s!==null;){if(P=wo(s),P!==null){for(u.flags|=128,Do(x,!1),s=P.updateQueue,u.updateQueue=s,Mo(u,s),u.subtreeFlags=0,s=p,p=u.child;p!==null;)Go(p,s),p=p.sibling;return v(jn,jn.current&1|2),u.child}s=s.sibling}x.tail!==null&&sa()>sl&&(u.flags|=128,S=!0,Do(x,!1),u.lanes=4194304)}else{if(!S)if(s=wo(P),s!==null){if(u.flags|=128,S=!0,s=s.updateQueue,u.updateQueue=s,Mo(u,s),Do(x,!0),x.tail===null&&x.tailMode==="hidden"&&!P.alternate&&!Je)return Dn(u),null}else 2*sa()-x.renderingStartTime>sl&&p!==536870912&&(u.flags|=128,S=!0,Do(x,!1),u.lanes=4194304);x.isBackwards?(P.sibling=u.child,u.child=P):(s=x.last,s!==null?s.sibling=P:u.child=P,x.last=P)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=sa(),u.sibling=null,s=jn.current,v(jn,S?s&1|2:s&1),u):(Dn(u),null);case 22:case 23:return pr(u),ys(),S=u.memoizedState!==null,s!==null?s.memoizedState!==null!==S&&(u.flags|=8192):S&&(u.flags|=8192),S?(p&536870912)!==0&&(u.flags&128)===0&&(Dn(u),u.subtreeFlags&6&&(u.flags|=8192)):Dn(u),p=u.updateQueue,p!==null&&Mo(u,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),S=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(S=u.memoizedState.cachePool.pool),S!==p&&(u.flags|=2048),s!==null&&O(Nr),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),_e(pn),Dn(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function Lg(s,u){switch(rt(u),u.tag){case 1:return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 3:return _e(pn),Y(),s=u.flags,(s&65536)!==0&&(s&128)===0?(u.flags=s&-65537|128,u):null;case 26:case 27:case 5:return tt(u),null;case 13:if(pr(u),s=u.memoizedState,s!==null&&s.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Qt()}return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 19:return O(jn),null;case 4:return Y(),null;case 10:return _e(u.type),null;case 22:case 23:return pr(u),ys(),s!==null&&O(Nr),s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 24:return _e(pn),null;case 25:return null;default:return null}}function Hd(s,u){switch(rt(u),u.tag){case 3:_e(pn),Y();break;case 26:case 27:case 5:tt(u);break;case 4:Y();break;case 13:pr(u);break;case 19:O(jn);break;case 10:_e(u.type);break;case 22:case 23:pr(u),ys(),s!==null&&O(Nr);break;case 24:_e(pn)}}function oi(s,u){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var x=S.next;p=x;do{if((p.tag&s)===s){S=void 0;var P=p.create,nt=p.inst;S=P(),nt.destroy=S}p=p.next}while(p!==x)}}catch(ut){ke(u,u.return,ut)}}function da(s,u,p){try{var S=u.updateQueue,x=S!==null?S.lastEffect:null;if(x!==null){var P=x.next;S=P;do{if((S.tag&s)===s){var nt=S.inst,ut=nt.destroy;if(ut!==void 0){nt.destroy=void 0,x=u;var _t=p,Ut=ut;try{Ut()}catch(Ht){ke(x,_t,Ht)}}}S=S.next}while(S!==P)}}catch(Ht){ke(u,u.return,Ht)}}function Hf(s){var u=s.updateQueue;if(u!==null){var p=s.stateNode;try{yd(u,p)}catch(S){ke(s,s.return,S)}}}function Pf(s,u,p){p.props=Cs(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(S){ke(s,u,S)}}function Al(s,u){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var S=Ls(s.stateNode);break;case 30:S=s.stateNode;break;default:S=s.stateNode}typeof p=="function"?s.refCleanup=p(S):p.current=S}}catch(x){ke(s,u,x)}}function _a(s,u){var p=s.ref,S=s.refCleanup;if(p!==null)if(typeof S=="function")try{S()}catch(x){ke(s,u,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(x){ke(s,u,x)}else p.current=null}function Zu(s){var u=s.type,p=s.memoizedProps,S=s.stateNode;try{Ni(S,u,p,s)}catch(x){ke(s,s.return,x)}}function If(s,u,p){try{Gn(s.stateNode,s.type,p,u,s)}catch(S){ke(s,s.return,S)}}function Ts(s){return s.tag===5||s.tag===3||(ra?s.tag===26:!1)||(Hn?s.tag===27&&Ps(s.type):!1)||s.tag===4}function jo(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||Ts(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(Hn&&s.tag===27&&Ps(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function As(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?Xo(p,s,u):sh(p,s);else if(S!==4&&(Hn&&S===27&&Ps(s.type)&&(p=s.stateNode,u=null),s=s.child,s!==null))for(As(s,u,p),s=s.sibling;s!==null;)As(s,u,p),s=s.sibling}function wl(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?pc(p,s,u):rh(p,s);else if(S!==4&&(Hn&&S===27&&Ps(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(wl(s,u,p),s=s.sibling;s!==null;)wl(s,u,p),s=s.sibling}function kf(s,u,p){s=s.containerInfo;try{yc(s,p)}catch(S){ke(u,u.return,S)}}function Fr(s){var u=s.stateNode,p=s.memoizedProps;try{y0(s.type,p,u,s)}catch(S){ke(s,s.return,S)}}function Ol(s,u){for(is(s.containerInfo),ai=u;ai!==null;)if(s=ai,u=s.child,(s.subtreeFlags&1024)!==0&&u!==null)u.return=s,ai=u;else for(;ai!==null;){s=ai;var p=s.alternate;switch(u=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0;var S=s,x=p.memoizedProps;p=p.memoizedState;var P=S.stateNode;try{var nt=Cs(S.type,x,S.elementType===S.type);u=P.getSnapshotBeforeUpdate(nt,p),P.__reactInternalSnapshotBeforeUpdate=u}catch(ut){ke(S,S.return,ut)}}break;case 3:(u&1024)!==0&&ei&&Jd(s.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=s.sibling,u!==null){u.return=s.return,ai=u;break}ai=s.return}}function Wu(s,u,p){var S=p.flags;switch(p.tag){case 0:case 11:case 15:Ia(s,p),S&4&&oi(5,p);break;case 1:if(Ia(s,p),S&4)if(s=p.stateNode,u===null)try{s.componentDidMount()}catch(nt){ke(p,p.return,nt)}else{var x=Cs(p.type,u.memoizedProps);u=u.memoizedState;try{s.componentDidUpdate(x,u,s.__reactInternalSnapshotBeforeUpdate)}catch(nt){ke(p,p.return,nt)}}S&64&&Hf(p),S&512&&Al(p,p.return);break;case 3:if(Ia(s,p),S&64&&(s=p.updateQueue,s!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=Ls(p.child.stateNode);break;case 1:u=p.child.stateNode}try{yd(s,u)}catch(nt){ke(p,p.return,nt)}}break;case 27:Hn&&u===null&&S&4&&Fr(p);case 26:case 5:Ia(s,p),u===null&&S&4&&Zu(p),S&512&&Al(p,p.return);break;case 12:Ia(s,p);break;case 13:Ia(s,p),S&4&&Vf(s,p),S&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Zf.bind(null,p),gh(s,p))));break;case 22:if(S=p.memoizedState!==null||nr,!S){u=u!==null&&u.memoizedState!==null||wn,x=nr;var P=wn;nr=S,(wn=u)&&!P?Ea(s,p,(p.subtreeFlags&8772)!==0):Ia(s,p),nr=x,wn=P}break;case 30:break;default:Ia(s,p)}}function qf(s){var u=s.alternate;u!==null&&(s.alternate=null,qf(u)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(u=s.stateNode,u!==null&&Ln(u)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function ui(s,u,p){for(p=p.child;p!==null;)$u(s,u,p),p=p.sibling}function $u(s,u,p){if(Vi&&typeof Vi.onCommitFiberUnmount=="function")try{Vi.onCommitFiberUnmount(Pl,p)}catch{}switch(p.tag){case 26:if(ra){wn||_a(p,u),ui(s,u,p),p.memoizedState?yh(p.memoizedState):p.stateNode&&Sh(p.stateNode);break}case 27:if(Hn){wn||_a(p,u);var S=he,x=Ne;Ps(p.type)&&(he=p.stateNode,Ne=!1),ui(s,u,p),_h(p.stateNode),he=S,Ne=x;break}case 5:wn||_a(p,u);case 6:if(ei){if(S=he,x=Ne,he=null,ui(s,u,p),he=S,Ne=x,he!==null)if(Ne)try{oh(he,p.stateNode)}catch(P){ke(p,u,P)}else try{mc(he,p.stateNode)}catch(P){ke(p,u,P)}}else ui(s,u,p);break;case 18:ei&&he!==null&&(Ne?h0(he,p.stateNode):f0(he,p.stateNode));break;case 4:ei?(S=he,x=Ne,he=p.stateNode.containerInfo,Ne=!0,ui(s,u,p),he=S,Ne=x):(Qa&&kf(p.stateNode,p,fh()),ui(s,u,p));break;case 0:case 11:case 14:case 15:wn||da(2,p,u),wn||da(4,p,u),ui(s,u,p);break;case 1:wn||(_a(p,u),S=p.stateNode,typeof S.componentWillUnmount=="function"&&Pf(p,u,S)),ui(s,u,p);break;case 21:ui(s,u,p);break;case 22:wn=(S=wn)||p.memoizedState!==null,ui(s,u,p),wn=S;break;default:ui(s,u,p)}}function Vf(s,u){if(An&&u.memoizedState===null&&(s=u.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{c0(s)}catch(p){ke(u,u.return,p)}}function Pd(s){switch(s.tag){case 13:case 19:var u=s.stateNode;return u===null&&(u=s.stateNode=new w0),u;case 22:return s=s.stateNode,u=s._retryCache,u===null&&(u=s._retryCache=new w0),u;default:throw Error(r(435,s.tag))}}function Yf(s,u){var p=Pd(s);u.forEach(function(S){var x=Wf.bind(null,s,S);p.has(S)||(p.add(S),S.then(x,x))})}function Oi(s,u){var p=u.deletions;if(p!==null)for(var S=0;S<p.length;S++){var x=p[S],P=s,nt=u;if(ei){var ut=nt;t:for(;ut!==null;){switch(ut.tag){case 27:if(Hn){if(Ps(ut.type)){he=ut.stateNode,Ne=!1;break t}break}case 5:he=ut.stateNode,Ne=!1;break t;case 3:case 4:he=ut.stateNode.containerInfo,Ne=!0;break t}ut=ut.return}if(he===null)throw Error(r(160));$u(P,nt,x),he=null,Ne=!1}else $u(P,nt,x);P=x.alternate,P!==null&&(P.return=null),x.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Id(u,s),u=u.sibling}function Id(s,u){var p=s.alternate,S=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Oi(u,s),Ri(s),S&4&&(da(3,s,s.return),oi(3,s),da(5,s,s.return));break;case 1:Oi(u,s),Ri(s),S&512&&(wn||p===null||_a(p,p.return)),S&64&&nr&&(s=s.updateQueue,s!==null&&(S=s.callbacks,S!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?S:p.concat(S))));break;case 26:if(ra){var x=Se;if(Oi(u,s),Ri(s),S&512&&(wn||p===null||_a(p,p.return)),S&4){S=p!==null?p.memoizedState:null;var P=s.memoizedState;p===null?P===null?s.stateNode===null?s.stateNode=m0(x,s.type,s.memoizedProps,s):wc(x,s.type,s.stateNode):s.stateNode=Ac(x,P,s.memoizedProps):S!==P?(S===null?p.stateNode!==null&&Sh(p.stateNode):yh(S),P===null?wc(x,s.type,s.stateNode):Ac(x,P,s.memoizedProps)):P===null&&s.stateNode!==null&&If(s,s.memoizedProps,p.memoizedProps)}break}case 27:if(Hn){Oi(u,s),Ri(s),S&512&&(wn||p===null||_a(p,p.return)),p!==null&&S&4&&If(s,s.memoizedProps,p.memoizedProps);break}case 5:if(Oi(u,s),Ri(s),S&512&&(wn||p===null||_a(p,p.return)),ei){if(s.flags&32){x=s.stateNode;try{Za(x)}catch(Ht){ke(s,s.return,Ht)}}S&4&&s.stateNode!=null&&(x=s.memoizedProps,If(s,x,p!==null?p.memoizedProps:x)),S&1024&&(Bc=!0)}break;case 6:if(Oi(u,s),Ri(s),S&4&&ei){if(s.stateNode===null)throw Error(r(162));S=s.memoizedProps,p=p!==null?p.memoizedProps:S,x=s.stateNode;try{lh(x,p,S)}catch(Ht){ke(s,s.return,Ht)}}break;case 3:if(ra?(kg(),x=Se,Se=Tc(u.containerInfo),Oi(u,s),Se=x):Oi(u,s),Ri(s),S&4){if(ei&&An&&p!==null&&p.memoizedState.isDehydrated)try{u0(u.containerInfo)}catch(Ht){ke(s,s.return,Ht)}if(Qa){S=u.containerInfo,p=u.pendingChildren;try{yc(S,p)}catch(Ht){ke(s,s.return,Ht)}}}Bc&&(Bc=!1,Kf(s));break;case 4:ra?(p=Se,Se=Tc(s.stateNode.containerInfo),Oi(u,s),Ri(s),Se=p):(Oi(u,s),Ri(s)),S&4&&Qa&&kf(s.stateNode,s,s.stateNode.pendingChildren);break;case 12:Oi(u,s),Ri(s);break;case 13:Oi(u,s),Ri(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(rl=sa()),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Yf(s,S)));break;case 22:x=s.memoizedState!==null;var nt=p!==null&&p.memoizedState!==null,ut=nr,_t=wn;if(nr=ut||x,wn=_t||nt,Oi(u,s),wn=_t,nr=ut,Ri(s),S&8192&&(u=s.stateNode,u._visibility=x?u._visibility&-2:u._visibility|1,x&&(p===null||nt||nr||wn||ci(s)),ei)){t:if(p=null,ei)for(u=s;;){if(u.tag===5||ra&&u.tag===26){if(p===null){nt=p=u;try{P=nt.stateNode,x?vc(P):ch(nt.stateNode,nt.memoizedProps)}catch(Ht){ke(nt,nt.return,Ht)}}}else if(u.tag===6){if(p===null){nt=u;try{var Ut=nt.stateNode;x?uh(Ut):Fd(Ut,nt.memoizedProps)}catch(Ht){ke(nt,nt.return,Ht)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===s)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break t;for(;u.sibling===null;){if(u.return===null||u.return===s)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}S&4&&(S=s.updateQueue,S!==null&&(p=S.retryQueue,p!==null&&(S.retryQueue=null,Yf(s,p))));break;case 19:Oi(u,s),Ri(s),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Yf(s,S)));break;case 30:break;case 21:break;default:Oi(u,s),Ri(s)}}function Ri(s){var u=s.flags;if(u&2){try{if(ei){for(var p,S=s.return;S!==null;){if(Ts(S)){p=S;break}S=S.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:if(Hn){var x=p.stateNode,P=jo(s);wl(s,P,x);break}case 5:var nt=p.stateNode;p.flags&32&&(Za(nt),p.flags&=-33);var ut=jo(s);wl(s,ut,nt);break;case 3:case 4:var _t=p.stateNode.containerInfo,Ut=jo(s);As(s,Ut,_t);break;default:throw Error(r(161))}}}catch(Ht){ke(s,s.return,Ht)}s.flags&=-3}u&4096&&(s.flags&=-4097)}function Kf(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var u=s;Kf(u),u.tag===5&&u.flags&1024&&Gs(u.stateNode),s=s.sibling}}function Ia(s,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Wu(s,u.alternate,u),u=u.sibling}function ci(s){for(s=s.child;s!==null;){var u=s;switch(u.tag){case 0:case 11:case 14:case 15:da(4,u,u.return),ci(u);break;case 1:_a(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&Pf(u,u.return,p),ci(u);break;case 27:Hn&&_h(u.stateNode);case 26:case 5:_a(u,u.return),ci(u);break;case 22:u.memoizedState===null&&ci(u);break;case 30:ci(u);break;default:ci(u)}s=s.sibling}}function Ea(s,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var S=u.alternate,x=s,P=u,nt=P.flags;switch(P.tag){case 0:case 11:case 15:Ea(x,P,p),oi(4,P);break;case 1:if(Ea(x,P,p),S=P,x=S.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Ut){ke(S,S.return,Ut)}if(S=P,x=S.updateQueue,x!==null){var ut=S.stateNode;try{var _t=x.shared.hiddenCallbacks;if(_t!==null)for(x.shared.hiddenCallbacks=null,x=0;x<_t.length;x++)Tu(_t[x],ut)}catch(Ut){ke(S,S.return,Ut)}}p&&nt&64&&Hf(P),Al(P,P.return);break;case 27:Hn&&Fr(P);case 26:case 5:Ea(x,P,p),p&&S===null&&nt&4&&Zu(P),Al(P,P.return);break;case 12:Ea(x,P,p);break;case 13:Ea(x,P,p),p&&nt&4&&Vf(x,P);break;case 22:P.memoizedState===null&&Ea(x,P,p),Al(P,P.return);break;case 30:break;default:Ea(x,P,p)}u=u.sibling}}function Pi(s,u){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(s=u.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&en(p))}function Jr(s,u){s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&en(s))}function ga(s,u,p,S){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Uo(s,u,p,S),u=u.sibling}function Uo(s,u,p,S){var x=u.flags;switch(u.tag){case 0:case 11:case 15:ga(s,u,p,S),x&2048&&oi(9,u);break;case 1:ga(s,u,p,S);break;case 3:ga(s,u,p,S),x&2048&&(s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&en(s)));break;case 12:if(x&2048){ga(s,u,p,S),s=u.stateNode;try{var P=u.memoizedProps,nt=P.id,ut=P.onPostCommit;typeof ut=="function"&&ut(nt,u.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(_t){ke(u,u.return,_t)}}else ga(s,u,p,S);break;case 13:ga(s,u,p,S);break;case 23:break;case 22:P=u.stateNode,nt=u.alternate,u.memoizedState!==null?P._visibility&2?ga(s,u,p,S):ws(s,u):P._visibility&2?ga(s,u,p,S):(P._visibility|=2,mr(s,u,p,S,(u.subtreeFlags&10256)!==0)),x&2048&&Pi(nt,u);break;case 24:ga(s,u,p,S),x&2048&&Jr(u.alternate,u);break;default:ga(s,u,p,S)}}function mr(s,u,p,S,x){for(x=x&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var P=s,nt=u,ut=p,_t=S,Ut=nt.flags;switch(nt.tag){case 0:case 11:case 15:mr(P,nt,ut,_t,x),oi(8,nt);break;case 23:break;case 22:var Ht=nt.stateNode;nt.memoizedState!==null?Ht._visibility&2?mr(P,nt,ut,_t,x):ws(P,nt):(Ht._visibility|=2,mr(P,nt,ut,_t,x)),x&&Ut&2048&&Pi(nt.alternate,nt);break;case 24:mr(P,nt,ut,_t,x),x&&Ut&2048&&Jr(nt.alternate,nt);break;default:mr(P,nt,ut,_t,x)}u=u.sibling}}function ws(s,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=s,S=u,x=S.flags;switch(S.tag){case 22:ws(p,S),x&2048&&Pi(S.alternate,S);break;case 24:ws(p,S),x&2048&&Jr(S.alternate,S);break;default:ws(p,S)}u=u.sibling}}function ta(s){if(s.subtreeFlags&Oe)for(s=s.child;s!==null;)Qf(s),s=s.sibling}function Qf(s){switch(s.tag){case 26:ta(s),s.flags&Oe&&(s.memoizedState!==null?Fo(Se,s.memoizedState,s.memoizedProps):ln(s.type,s.memoizedProps));break;case 5:ta(s),s.flags&Oe&&ln(s.type,s.memoizedProps);break;case 3:case 4:if(ra){var u=Se;Se=Tc(s.stateNode.containerInfo),ta(s),Se=u}else ta(s);break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Oe,Oe=16777216,ta(s),Oe=u):ta(s));break;default:ta(s)}}function Bo(s){var u=s.alternate;if(u!==null&&(s=u.child,s!==null)){u.child=null;do u=s.sibling,s.sibling=null,s=u;while(s!==null)}}function ka(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];ai=S,tc(S,s)}Bo(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)kd(s),s=s.sibling}function kd(s){switch(s.tag){case 0:case 11:case 15:ka(s),s.flags&2048&&da(9,s,s.return);break;case 3:ka(s);break;case 12:ka(s);break;case 22:var u=s.stateNode;s.memoizedState!==null&&u._visibility&2&&(s.return===null||s.return.tag!==13)?(u._visibility&=-3,bi(s)):ka(s);break;default:ka(s)}}function bi(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];ai=S,tc(S,s)}Bo(s)}for(s=s.child;s!==null;){switch(u=s,u.tag){case 0:case 11:case 15:da(8,u,u.return),bi(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,bi(u));break;default:bi(u)}s=s.sibling}}function tc(s,u){for(;ai!==null;){var p=ai;switch(p.tag){case 0:case 11:case 15:da(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var S=p.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:en(p.memoizedState.cache)}if(S=p.child,S!==null)S.return=p,ai=S;else t:for(p=s;ai!==null;){S=ai;var x=S.sibling,P=S.return;if(qf(S),S===p){ai=null;break t}if(x!==null){x.return=P,ai=x;break t}ai=P}}}function Ca(s){var u=pa(s);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(r(364));return u}if(s=Gg(s),s===null)throw Error(r(362));return s.stateNode.current}function ec(s,u){var p=s.tag;switch(u.$$typeof){case Ei:if(s.type===u.value)return!0;break;case Ma:t:{for(u=u.value,s=[s,0],p=0;p<s.length;){var S=s[p++],x=S.tag,P=s[p++],nt=u[P];if(x!==5&&x!==26&&x!==27||!Hs(S)){for(;nt!=null&&ec(S,nt);)P++,nt=u[P];if(P===u.length){u=!0;break t}else for(S=S.child;S!==null;)s.push(S,P),S=S.sibling}}u=!1}return u;case Mr:if((p===5||p===26||p===27)&&Qd(s.stateNode,u.value))return!0;break;case ya:if((p===5||p===6||p===26||p===27)&&(s=ah(s),s!==null&&0<=s.indexOf(u.value)))return!0;break;case Vl:if((p===5||p===26||p===27)&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Rl(s){switch(s.$$typeof){case Ei:return"<"+(C(s.value)||"Unknown")+">";case Ma:return":has("+(Rl(s)||"")+")";case Mr:return'[role="'+s.value+'"]';case ya:return'"'+s.value+'"';case Vl:return'[data-testname="'+s.value+'"]';default:throw Error(r(365))}}function Zr(s,u){var p=[];s=[s,0];for(var S=0;S<s.length;){var x=s[S++],P=x.tag,nt=s[S++],ut=u[nt];if(P!==5&&P!==26&&P!==27||!Hs(x)){for(;ut!=null&&ec(x,ut);)nt++,ut=u[nt];if(nt===u.length)p.push(x);else for(x=x.child;x!==null;)s.push(x,nt),x=x.sibling}}return p}function zo(s,u){if(!Ja)throw Error(r(363));s=Ca(s),s=Zr(s,u),u=[],s=Array.from(s);for(var p=0;p<s.length;){var S=s[p++],x=S.tag;if(x===5||x===26||x===27)Hs(S)||u.push(S.stateNode);else for(S=S.child;S!==null;)s.push(S),S=S.sibling}return u}function Ii(){if((Re&2)!==0&&De!==0)return De&-De;if(ce.T!==null){var s=tr;return s!==0?s:Bt()}return ss()}function nc(){mi===0&&(mi=(De&536870912)===0||Je?G():536870912);var s=ua.current;return s!==null&&(s.flags|=32),mi}function ki(s,u,p){(s===fn&&(Ye===2||Ye===9)||s.cancelPendingCommit!==null)&&(fi(s,0),Ta(s,De,mi,!1)),T(s,p),((Re&2)===0||s!==fn)&&(s===fn&&((Re&2)===0&&(Cn|=p),En===4&&Ta(s,De,mi,!1)),dn(s))}function ea(s,u,p){if((Re&6)!==0)throw Error(r(327));var S=!p&&(u&124)===0&&(u&s.expiredLanes)===0||M(s,u),x=S?qd(s,u):Lo(s,u,!0),P=S;do{if(x===0){Dr&&!S&&Ta(s,u,0,!1);break}else{if(p=s.current.alternate,P&&!xl(p)){x=Lo(s,u,!1),P=!1;continue}if(x===2){if(P=u,s.errorRecoveryDisabledLanes&P)var nt=0;else nt=s.pendingLanes&-536870913,nt=nt!==0?nt:nt&536870912?536870912:0;if(nt!==0){u=nt;t:{var ut=s;x=al;var _t=An&&ut.current.memoizedState.isDehydrated;if(_t&&(fi(ut,nt).flags|=256),nt=Lo(ut,nt,!1),nt!==2){if(zc&&!_t){ut.errorRecoveryDisabledLanes|=P,Cn|=P,x=4;break t}P=Ci,Ci=x,P!==null&&(Ci===null?Ci=P:Ci.push.apply(Ci,P))}x=nt}if(P=!1,x!==2)continue}}if(x===1){fi(s,0),Ta(s,u,0,!0);break}t:{switch(S=s,P=x,P){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:Ta(S,u,mi,!ir);break t;case 2:Ci=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(x=rl+300-sa(),10<x)){if(Ta(S,u,mi,!ir),z(S,0,!0)!==0)break t;S.timeoutHandle=Kd(Os.bind(null,S,p,Ci,Ti,Lc,u,mi,Cn,Xi,ir,P,2,-0,0),x);break t}Os(S,p,Ci,Ti,Lc,u,mi,Cn,Xi,ir,P,0,-0,0)}}break}while(!0);dn(s)}function Os(s,u,p,S,x,P,nt,ut,_t,Ut,Ht,Zt,Wt,Ce){if(s.timeoutHandle=Ya,Zt=u.subtreeFlags,(Zt&8192||(Zt&16785408)===16785408)&&(Ee(),Qf(u),Zt=Xn(),Zt!==null)){s.cancelPendingCommit=Zt(yr.bind(null,s,u,P,p,S,x,nt,ut,_t,Ht,1,Wt,Ce)),Ta(s,P,nt,!Ut);return}yr(s,u,P,p,S,x,nt,ut,_t)}function xl(s){for(var u=s;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var S=0;S<p.length;S++){var x=p[S],P=x.getSnapshot;x=x.value;try{if(!Di(P(),x))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Ta(s,u,p,S){u&=~ar,u&=~Cn,s.suspendedLanes|=u,s.pingedLanes&=~u,S&&(s.warmLanes|=u),S=s.expirationTimes;for(var x=u;0<x;){var P=31-Mi(x),nt=1<<P;S[P]=-1,x&=~nt}p!==0&&B(s,p,u)}function Nl(){return(Re&6)===0?(ft(0),!1):!0}function qi(){if(pe!==null){if(Ye===0)var s=pe.return;else s=pe,gi=us=null,hr(s),Qi=null,tl=0,s=pe;for(;s!==null;)Hd(s.alternate,s),s=s.return;pe=null}}function fi(s,u){var p=s.timeoutHandle;p!==Ya&&(s.timeoutHandle=Ya,Ll(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),qi(),fn=s,pe=p=bn(s.current,null),De=u,Ye=0,vn=null,ir=!1,Dr=M(s,u),zc=!1,Xi=mi=ar=Cn=Bi=En=0,Ci=al=null,Lc=!1,(u&8)!==0&&(u|=u&32);var S=s.entangledLanes;if(S!==0)for(s=s.entanglements,S&=u;0<S;){var x=31-Mi(S),P=1<<x;u|=s[x],S&=~P}return Sa=u,fr(),p}function vr(s,u){fe=null,ce.H=pi,u===Qs||u===Xs?(u=Cu(),Ye=3):u===eu?(u=Cu(),Ye=4):Ye=u===Dh?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,vn=u,pe===null&&(En=1,El(s,F(u,s.current)))}function Aa(){var s=ua.current;return s===null?!0:(De&4194048)===De?Ui===null:(De&62914560)===De||(De&536870912)!==0?s===Ui:!1}function wa(){var s=ce.H;return ce.H=pi,s===null?pi:s}function qa(){var s=ce.A;return ce.A=on,s}function ic(){En=4,ir||(De&4194048)!==De&&ua.current!==null||(Dr=!0),(Bi&134217727)===0&&(Cn&134217727)===0||fn===null||Ta(fn,De,mi,!1)}function Lo(s,u,p){var S=Re;Re|=2;var x=wa(),P=qa();(fn!==s||De!==u)&&(Ti=null,fi(s,u)),u=!1;var nt=En;t:do try{if(Ye!==0&&pe!==null){var ut=pe,_t=vn;switch(Ye){case 8:qi(),nt=6;break t;case 3:case 2:case 9:case 6:ua.current===null&&(u=!0);var Ut=Ye;if(Ye=0,vn=null,na(s,ut,_t,Ut),p&&Dr){nt=0;break t}break;default:Ut=Ye,Ye=0,vn=null,na(s,ut,_t,Ut)}}Xf(),nt=En;break}catch(Ht){vr(s,Ht)}while(!0);return u&&s.shellSuspendCounter++,gi=us=null,Re=S,ce.H=x,ce.A=P,pe===null&&(fn=null,De=0,fr()),nt}function Xf(){for(;pe!==null;)gn(pe)}function qd(s,u){var p=Re;Re|=2;var S=wa(),x=qa();fn!==s||De!==u?(Ti=null,sl=sa()+500,fi(s,u)):Dr=M(s,u);t:do try{if(Ye!==0&&pe!==null){u=pe;var P=vn;e:switch(Ye){case 1:Ye=0,vn=null,na(s,u,P,1);break;case 2:case 9:if(Zi(P)){Ye=0,vn=null,Le(u);break}u=function(){Ye!==2&&Ye!==9||fn!==s||(Ye=7),dn(s)},P.then(u,u);break t;case 3:Ye=7;break t;case 4:Ye=5;break t;case 7:Zi(P)?(Ye=0,vn=null,Le(u)):(Ye=0,vn=null,na(s,u,P,7));break;case 5:var nt=null;switch(pe.tag){case 26:nt=pe.memoizedState;case 5:case 27:var ut=pe,_t=ut.type,Ut=ut.pendingProps;if(nt?bh(nt):Fa(_t,Ut)){Ye=0,vn=null;var Ht=ut.sibling;if(Ht!==null)pe=Ht;else{var Zt=ut.return;Zt!==null?(pe=Zt,xi(Zt)):pe=null}break e}}Ye=0,vn=null,na(s,u,P,5);break;case 6:Ye=0,vn=null,na(s,u,P,6);break;case 8:qi(),En=6;break t;default:throw Error(r(462))}}hi();break}catch(Wt){vr(s,Wt)}while(!0);return gi=us=null,ce.H=S,ce.A=x,Re=p,pe!==null?0:(fn=null,De=0,fr(),En)}function hi(){for(;pe!==null&&!Rc();)gn(pe)}function gn(s){var u=Tl(s.alternate,s,Sa);s.memoizedProps=s.pendingProps,u===null?xi(s):pe=u}function Le(s){var u=s,p=u.alternate;switch(u.tag){case 15:case 0:u=qu(p,u,u.pendingProps,u.type,void 0,De);break;case 11:u=qu(p,u,u.pendingProps,u.type.render,u.ref,De);break;case 5:hr(u);default:Hd(p,u),u=pe=Go(u,Sa),u=Tl(p,u,Sa)}s.memoizedProps=s.pendingProps,u===null?xi(s):pe=u}function na(s,u,p,S){gi=us=null,hr(u),Qi=null,tl=0;var x=u.return;try{if(Bg(s,x,u,p,De)){En=1,El(s,F(p,s.current)),pe=null;return}}catch(P){if(x!==null)throw pe=x,P;En=1,El(s,F(p,s.current)),pe=null;return}u.flags&32768?(Je||S===1?s=!0:Dr||(De&536870912)!==0?s=!1:(ir=s=!0,(S===2||S===9||S===3||S===6)&&(S=ua.current,S!==null&&S.tag===13&&(S.flags|=16384))),ac(u,s)):xi(u)}function xi(s){var u=s;do{if((u.flags&32768)!==0){ac(u,ir);return}s=u.return;var p=zg(u.alternate,u,Sa);if(p!==null){pe=p;return}if(u=u.sibling,u!==null){pe=u;return}pe=u=s}while(u!==null);En===0&&(En=5)}function ac(s,u){do{var p=Lg(s.alternate,s);if(p!==null){p.flags&=32767,pe=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(s=s.sibling,s!==null)){pe=s;return}pe=s=p}while(s!==null);En=6,pe=null}function yr(s,u,p,S,x,P,nt,ut,_t){s.cancelPendingCommit=null;do xs();while(nn!==0);if((Re&6)!==0)throw Error(r(327));if(u!==null){if(u===s.current)throw Error(r(177));if(P=u.lanes|u.childLanes,P|=Uc,y(s,p,P,nt,ut,_t),s===fn&&(pe=fn=null,De=0),ll=u,Ur=s,Yl=p,rr=P,Kl=x,Gc=S,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Dl(Ch,function(){return Ml(),null})):(s.callbackNode=null,s.callbackPriority=0),S=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||S){S=ce.T,ce.T=null,x=Xa(),Qn(2),nt=Re,Re|=4;try{Ol(s,u,p)}finally{Re=nt,Qn(x),ce.T=S}}nn=1,Ff(),Jf(),Rs()}}function Ff(){if(nn===1){nn=0;var s=Ur,u=ll,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=ce.T,ce.T=null;var S=Xa();Qn(2);var x=Re;Re|=4;try{Id(u,s),Yo(s.containerInfo)}finally{Re=x,Qn(S),ce.T=p}}s.current=u,nn=2}}function Jf(){if(nn===2){nn=0;var s=Ur,u=ll,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=ce.T,ce.T=null;var S=Xa();Qn(2);var x=Re;Re|=4;try{Wu(s,u.alternate,u)}finally{Re=x,Qn(S),ce.T=p}}nn=3}}function Rs(){if(nn===4||nn===3){nn=0,_0();var s=Ur,u=ll,p=Yl,S=Gc;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?nn=5:(nn=0,ll=Ur=null,Wr(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(jr=null),Q(p),u=u.stateNode,Vi&&typeof Vi.onCommitFiberRoot=="function")try{Vi.onCommitFiberRoot(Pl,u,void 0,(u.current.flags&128)===128)}catch{}if(S!==null){u=ce.T,x=Xa(),Qn(2),ce.T=null;try{for(var P=s.onRecoverableError,nt=0;nt<S.length;nt++){var ut=S[nt];P(ut.value,{componentStack:ut.stack})}}finally{ce.T=u,Qn(x)}}(Yl&3)!==0&&xs(),dn(s),x=s.pendingLanes,(p&4194090)!==0&&(x&42)!==0?s===Hc?sr++:(sr=0,Hc=s):sr=0,ft(0)}}function Wr(s,u){(s.pooledCacheLanes&=u)===0&&(u=s.pooledCache,u!=null&&(s.pooledCache=null,en(u)))}function xs(s){return Ff(),Jf(),Rs(),Ml()}function Ml(){if(nn!==5)return!1;var s=Ur,u=rr;rr=0;var p=Q(Yl),S=32>p?32:p;p=ce.T;var x=Xa();try{Qn(S),ce.T=null,S=Kl,Kl=null;var P=Ur,nt=Yl;if(nn=0,ll=Ur=null,Yl=0,(Re&6)!==0)throw Error(r(331));var ut=Re;if(Re|=4,kd(P.current),Uo(P,P.current,nt,S),Re=ut,ft(0,!1),Vi&&typeof Vi.onPostCommitFiberRoot=="function")try{Vi.onPostCommitFiberRoot(Pl,P)}catch{}return!0}finally{Qn(x),ce.T=p,Wr(s,u)}}function rc(s,u,p){u=F(p,u),u=Df(s.stateNode,u,2),s=ie(s,u,2),s!==null&&(T(s,2),dn(s))}function ke(s,u,p){if(s.tag===3)rc(s,s,p);else for(;u!==null;){if(u.tag===3){rc(u,s,p);break}else if(u.tag===1){var S=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(jr===null||!jr.has(S))){s=F(p,s),p=Nd(2),S=ie(u,p,2),S!==null&&(jf(p,S,u,s),T(S,2),dn(S));break}}u=u.return}}function Oa(s,u,p){var S=s.pingCache;if(S===null){S=s.pingCache=new hs;var x=new Set;S.set(u,x)}else x=S.get(u),x===void 0&&(x=new Set,S.set(u,x));x.has(p)||(zc=!0,x.add(p),s=$r.bind(null,s,u,p),u.then(s,s))}function $r(s,u,p){var S=s.pingCache;S!==null&&S.delete(u),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,fn===s&&(De&p)===p&&(En===4||En===3&&(De&62914560)===De&&300>sa()-rl?(Re&2)===0&&fi(s,0):ar|=p,Xi===De&&(Xi=0)),dn(s)}function Va(s,u){u===0&&(u=R()),s=$t(s,u),s!==null&&(T(s,u),dn(s))}function Zf(s){var u=s.memoizedState,p=0;u!==null&&(p=u.retryLane),Va(s,p)}function Wf(s,u){var p=0;switch(s.tag){case 13:var S=s.stateNode,x=s.memoizedState;x!==null&&(p=x.retryLane);break;case 19:S=s.stateNode;break;case 22:S=s.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(u),Va(s,p)}function Dl(s,u){return $o(s,u)}function sc(s,u,p,S){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function bn(s,u){var p=s.alternate;return p===null?(p=n(s.tag,u,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=u,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,u=s.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Go(s,u){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,u=p.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),s}function Ho(s,u,p,S,x,P){var nt=0;if(S=s,typeof s=="function")Sr(s)&&(nt=1);else if(typeof s=="string")nt=ra&&Hn?vh(s,p,Wn.current)?26:Hl(s)?27:5:ra?vh(s,p,Wn.current)?26:5:Hn&&Hl(s)?27:5;else t:switch(s){case es:return s=n(31,p,u,x),s.elementType=es,s.lanes=P,s;case js:return Ns(p.children,x,P,u);case Us:nt=8,x|=24;break;case Po:return s=n(12,p,u,x|2),s.elementType=Po,s.lanes=P,s;case Er:return s=n(13,p,u,x),s.elementType=Er,s.lanes=P,s;case Cr:return s=n(19,p,u,x),s.elementType=Cr,s.lanes=P,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case cc:case _r:nt=10;break t;case Io:nt=9;break t;case fc:nt=11;break t;case hc:nt=14;break t;case Tr:nt=16,S=null;break t}nt=29,p=Error(r(130,s===null?"null":typeof s,"")),S=null}return u=n(nt,p,u,x),u.elementType=s,u.type=S,u.lanes=P,u}function Ns(s,u,p,S){return s=n(7,s,S,u),s.lanes=p,s}function $f(s,u,p){return s=n(6,s,null,u),s.lanes=p,s}function th(s,u,p){return u=n(4,s.children!==null?s.children:[],s.key,u),u.lanes=p,u.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},u}function Kn(s,u,p,S,x,P,nt,ut){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ya,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=A(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=A(0),this.hiddenUpdates=A(null),this.identifierPrefix=S,this.onUncaughtError=x,this.onCaughtError=P,this.onRecoverableError=nt,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ut,this.incompleteTransitions=new Map}function lc(s,u,p,S,x,P,nt,ut,_t,Ut,Ht,Zt){return s=new Kn(s,u,p,nt,ut,_t,Ut,Zt),u=1,P===!0&&(u|=24),P=n(3,null,null,u),s.current=P,P.stateNode=s,u=He(),u.refCount++,s.pooledCache=u,u.refCount++,P.memoizedState={element:S,isDehydrated:p,cache:u},ze(P),s}function jl(s){return s?(s=ls,s):ls}function Ul(s){var u=s._reactInternals;if(u===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(u),s=s!==null?g(s):null,s===null?null:Ls(s.stateNode)}function oc(s,u,p,S,x,P){x=jl(x),S.context===null?S.context=x:S.pendingContext=x,S=Kt(u),S.payload={element:p},P=P===void 0?null:P,P!==null&&(S.callback=P),p=ie(s,S,u),p!==null&&(ki(p,s,u),Ie(p,s,u))}function Ms(s,u){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<u?p:u}}function ts(s,u){Ms(s,u),(s=s.alternate)&&Ms(s,u)}var Be={},Vd=Eg(),ia=H6(),uc=Object.assign,Ds=Symbol.for("react.element"),Bl=Symbol.for("react.transitional.element"),br=Symbol.for("react.portal"),js=Symbol.for("react.fragment"),Us=Symbol.for("react.strict_mode"),Po=Symbol.for("react.profiler"),cc=Symbol.for("react.provider"),Io=Symbol.for("react.consumer"),_r=Symbol.for("react.context"),fc=Symbol.for("react.forward_ref"),Er=Symbol.for("react.suspense"),Cr=Symbol.for("react.suspense_list"),hc=Symbol.for("react.memo"),Tr=Symbol.for("react.lazy"),es=Symbol.for("react.activity"),ko=Symbol.for("react.memo_cache_sentinel"),qo=Symbol.iterator,Vo=Symbol.for("react.client.reference"),Bs=Array.isArray,ce=Vd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,zs=t.rendererVersion,Yd=t.rendererPackageName,Ar=t.extraDevToolsConfig,Ls=t.getPublicInstance,eh=t.getRootHostContext,ns=t.getChildHostContext,is=t.prepareForCommit,Yo=t.resetAfterCommit,nh=t.createInstance;t.cloneMutableInstance;var Ko=t.appendInitialChild,zl=t.finalizeInitialChildren,as=t.shouldSetTextContent,ih=t.createTextInstance;t.cloneMutableTextInstance;var Kd=t.scheduleTimeout,Ll=t.cancelTimeout,Ya=t.noTimeout,Ka=t.isPrimaryRenderer;t.warnsIfNotActing;var ei=t.supportsMutation,Qa=t.supportsPersistence,An=t.supportsHydration,pa=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var rs=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var Qn=t.setCurrentUpdatePriority,Xa=t.getCurrentUpdatePriority,ss=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var aa=t.shouldAttemptEagerTransition,Ln=t.detachDeletedInstance;t.requestPostPaintCallback;var dc=t.maySuspendCommit,Fa=t.preloadInstance,Ee=t.startSuspendingCommit,ln=t.suspendInstance;t.suspendOnActiveViewTransition;var Xn=t.waitForCommitToBeReady,wr=t.NotPendingTransition,ma=t.HostTransitionContext,Gs=t.resetFormInstance;t.bindToConsole;var gc=t.supportsMicrotasks,Qo=t.scheduleMicrotask,Ja=t.supportsTestSelectors,Gg=t.findFiberRoot,zn=t.getBoundingRect,ah=t.getTextContent,Hs=t.isHiddenSubtree,Qd=t.matchAccessibilityRole,Xd=t.setFocusIfFocusable,Hg=t.setupIntersectionObserver,rh=t.appendChild,sh=t.appendChildToContainer,lh=t.commitTextUpdate,Ni=t.commitMount,Gn=t.commitUpdate,pc=t.insertBefore,Xo=t.insertInContainerBefore,mc=t.removeChild,oh=t.removeChildFromContainer,Za=t.resetTextContent,vc=t.hideInstance,uh=t.hideTextInstance,ch=t.unhideInstance,Fd=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopGestureTransition,t.getCurrentGestureOffset,t.subscribeToGestureDirection,t.createViewTransitionInstance;var Jd=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var Zd=t.cloneInstance,fh=t.createContainerChildSet,hh=t.appendChildToContainerChildSet,Wd=t.finalizeContainerChildren,yc=t.replaceContainerChildren,dh=t.cloneHiddenInstance,$d=t.cloneHiddenTextInstance,Sc=t.isSuspenseInstancePending,bc=t.isSuspenseInstanceFallback,t0=t.getSuspenseInstanceFallbackErrorDetails,gh=t.registerSuspenseInstanceRetry,e0=t.canHydrateFormStateMarker,n0=t.isFormStateMarkerMatching,ph=t.getNextHydratableSibling,i0=t.getNextHydratableSiblingAfterSingleton,a0=t.getFirstHydratableChild,Pg=t.getFirstHydratableChildWithinContainer,r0=t.getFirstHydratableChildWithinSuspenseInstance,Gl=t.getFirstHydratableChildWithinSingleton,s0=t.canHydrateInstance,_c=t.canHydrateTextInstance,Ec=t.canHydrateSuspenseInstance,l0=t.hydrateInstance,mh=t.hydrateTextInstance,Ig=t.hydrateSuspenseInstance,o0=t.getNextHydratableInstanceAfterSuspenseInstance,u0=t.commitHydratedContainer,c0=t.commitHydratedSuspenseInstance,f0=t.clearSuspenseBoundary,h0=t.clearSuspenseBoundaryFromContainer,Cc=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var d0=t.validateHydratableInstance,g0=t.validateHydratableTextInstance,ra=t.supportsResources,vh=t.isHostHoistableType,Tc=t.getHoistableRoot,p0=t.getResource,Ac=t.acquireResource,yh=t.releaseResource,m0=t.hydrateHoistable,wc=t.mountHoistable,Sh=t.unmountHoistable,v0=t.createHoistableInstance,kg=t.prepareToCommitHoistables,qg=t.mayResourceSuspendCommit,bh=t.preloadResource,Fo=t.suspendResource,Hn=t.supportsSingletons,Jo=t.resolveSingletonInstance,y0=t.acquireSingletonInstance,_h=t.releaseSingletonInstance,Hl=t.isHostSingletonType,Ps=t.isSingletonScope,Zo=[],Is=-1,ls={},Mi=Math.clz32?Math.clz32:D,S0=Math.log,b0=Math.LN2,Wa=256,Wo=4194304,$o=ia.unstable_scheduleCallback,Oc=ia.unstable_cancelCallback,Rc=ia.unstable_shouldYield,_0=ia.unstable_requestPaint,sa=ia.unstable_now,Eh=ia.unstable_ImmediatePriority,E0=ia.unstable_UserBlockingPriority,Ch=ia.unstable_NormalPriority,Th=ia.unstable_IdlePriority,Fn=ia.log,di=ia.unstable_setDisableYieldValue,Pl=null,Vi=null,xc,Ah,ks=!1,wh=new WeakMap,Or=[],qs=0,Nc=null,Vs=0,Yi=[],la=0,os=null,$a=1,Ra="",Wn=E(null),Ys=E(null),Rr=E(null),Il=E(null),ni=null,Pn=null,Je=!1,xr=null,xa=!1,Na=Error(r(519)),Di=typeof Object.is=="function"?Object.is:kt,Mc=E(null),us=null,gi=null,Oh=typeof AbortController<"u"?AbortController:function(){var s=[],u=this.signal={aborted:!1,addEventListener:function(p,S){s.push(S)}};this.abort=function(){u.aborted=!0,s.forEach(function(p){return p()})}},C0=ia.unstable_scheduleCallback,Dc=ia.unstable_NormalPriority,pn={$$typeof:_r,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},cn=null,kl=null,Rh=!1,tu=!1,Ks=!1,oa=0,ql=null,jc=0,tr=0,ji=null,xh=ce.S;ce.S=function(s,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&be(s,u),xh!==null&&xh(s,u)};var Nr=E(null),T0=Object.prototype.hasOwnProperty,Qs=Error(r(460)),eu=Error(r(474)),Xs=Error(r(542)),nu={then:function(){}},Ki=null,$e=[],cs=0,Uc=0,_n=!1,Nh=!1,Fs=E(null),iu=E(0),tn=0,fe=null,Ge=null,In=null,au=!1,Js=!1,Zs=!1,Ws=0,ii=0,_i=null,A0=0,pi={readContext:ge,use:xu,useCallback:Mn,useContext:Mn,useEffect:Mn,useImperativeHandle:Mn,useLayoutEffect:Mn,useInsertionEffect:Mn,useMemo:Mn,useReducer:Mn,useRef:Mn,useState:Mn,useDebugValue:Mn,useDeferredValue:Mn,useTransition:Mn,useSyncExternalStore:Mn,useId:Mn,useHostTransitionStatus:Mn,useFormState:Mn,useActionState:Mn,useOptimistic:Mn,useMemoCache:Mn,useCacheRefresh:Mn},Mh={readContext:ge,use:xu,useCallback:function(s,u){return Zn().memoizedState=[s,u===void 0?null:u],s},useContext:ge,useEffect:Of,useImperativeHandle:function(s,u,p){p=p!=null?p.concat([s]):null,dr(4194308,4,Ha.bind(null,u,s),p)},useLayoutEffect:function(s,u){return dr(4194308,4,s,u)},useInsertionEffect:function(s,u){dr(4,2,s,u)},useMemo:function(s,u){var p=Zn();u=u===void 0?null:u;var S=s();if(Zs){K(!0);try{s()}finally{K(!1)}}return p.memoizedState=[S,u],S},useReducer:function(s,u,p){var S=Zn();if(p!==void 0){var x=p(u);if(Zs){K(!0);try{p(u)}finally{K(!1)}}}else x=u;return S.memoizedState=S.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},S.queue=s,s=s.dispatch=Eo.bind(null,fe,s),[S.memoizedState,s]},useRef:function(s){var u=Zn();return s={current:s},u.memoizedState=s},useState:function(s){s=yo(s);var u=s.queue,p=Td.bind(null,fe,u);return u.dispatch=p,[s.memoizedState,p]},useDebugValue:_s,useDeferredValue:function(s,u){var p=Zn();return _l(p,s,u)},useTransition:function(){var s=yo(!1);return s=bo.bind(null,fe,s.queue,!0,!1),Zn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,u,p){var S=fe,x=Zn();if(Je){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),fn===null)throw Error(r(349));(De&124)!==0||Mu(S,u,p)}x.memoizedState=p;var P={value:p,getSnapshot:u};return x.queue=P,Of(vo.bind(null,S,P,s),[s]),S.flags|=2048,Hi(9,Sl(),bf.bind(null,S,P,p,u),null),p},useId:function(){var s=Zn(),u=fn.identifierPrefix;if(Je){var p=Ra,S=$a;p=(S&~(1<<32-Mi(S)-1)).toString(32)+p,u=""+u+"R"+p,p=Ws++,0<p&&(u+="H"+p.toString(32)),u+=""}else p=A0++,u=""+u+"r"+p.toString(32)+"";return s.memoizedState=u},useHostTransitionStatus:Lu,useFormState:wf,useActionState:wf,useOptimistic:function(s){var u=Zn();u.memoizedState=u.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=Co.bind(null,fe,!0,p),p.dispatch=u,[s,u]},useMemoCache:yl,useCacheRefresh:function(){return Zn().memoizedState=Gu.bind(null,fe)}},er={readContext:ge,use:xu,useCallback:gr,useContext:ge,useEffect:Uu,useImperativeHandle:Bu,useInsertionEffect:Rf,useLayoutEffect:bl,useMemo:zu,useReducer:ha,useRef:ju,useState:function(){return ha(fa)},useDebugValue:_s,useDeferredValue:function(s,u){var p=Yn();return xf(p,Ge.memoizedState,s,u)},useTransition:function(){var s=ha(fa)[0],u=Yn().memoizedState;return[typeof s=="boolean"?s:vl(s),u]},useSyncExternalStore:bd,useId:wi,useHostTransitionStatus:Lu,useFormState:Du,useActionState:Du,useOptimistic:function(s,u){var p=Yn();return _f(p,Ge,s,u)},useMemoCache:yl,useCacheRefresh:Vr},$s={readContext:ge,use:xu,useCallback:gr,useContext:ge,useEffect:Uu,useImperativeHandle:Bu,useInsertionEffect:Rf,useLayoutEffect:bl,useMemo:zu,useReducer:Nu,useRef:ju,useState:function(){return Nu(fa)},useDebugValue:_s,useDeferredValue:function(s,u){var p=Yn();return Ge===null?_l(p,s,u):xf(p,Ge.memoizedState,s,u)},useTransition:function(){var s=Nu(fa)[0],u=Yn().memoizedState;return[typeof s=="boolean"?s:vl(s),u]},useSyncExternalStore:bd,useId:wi,useHostTransitionStatus:Lu,useFormState:So,useActionState:So,useOptimistic:function(s,u){var p=Yn();return Ge!==null?_f(p,Ge,s,u):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:yl,useCacheRefresh:Vr},Qi=null,tl=0,fs=Ad(!0),va=Ad(!1),ua=E(null),Ui=null,jn=E(0),el={enqueueSetState:function(s,u,p){s=s._reactInternals;var S=Ii(),x=Kt(S);x.payload=u,p!=null&&(x.callback=p),u=ie(s,x,S),u!==null&&(ki(u,s,S),Ie(u,s,S))},enqueueReplaceState:function(s,u,p){s=s._reactInternals;var S=Ii(),x=Kt(S);x.tag=1,x.payload=u,p!=null&&(x.callback=p),u=ie(s,x,S),u!==null&&(ki(u,s,S),Ie(u,s,S))},enqueueForceUpdate:function(s,u){s=s._reactInternals;var p=Ii(),S=Kt(p);S.tag=2,u!=null&&(S.callback=u),u=ie(s,S,p),u!==null&&(ki(u,s,p),Ie(u,s,p))}},nl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Dh=Error(r(461)),$n=!1,il={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},nr=!1,wn=!1,Bc=!1,w0=typeof WeakSet=="function"?WeakSet:Set,ai=null,he=null,Ne=!1,Se=null,Oe=8192,on={getCacheForType:function(s){var u=ge(pn),p=u.data.get(s);return p===void 0&&(p=s(),u.data.set(s,p)),p}},Ei=0,Ma=1,Mr=2,Vl=3,ya=4;if(typeof Symbol=="function"&&Symbol.for){var mn=Symbol.for;Ei=mn("selector.component"),Ma=mn("selector.has_pseudo_class"),Mr=mn("selector.role"),Vl=mn("selector.test_id"),ya=mn("selector.text")}var hs=typeof WeakMap=="function"?WeakMap:Map,Re=0,fn=null,pe=null,De=0,Ye=0,vn=null,ir=!1,Dr=!1,zc=!1,Sa=0,En=0,Bi=0,Cn=0,ar=0,mi=0,Xi=0,al=null,Ci=null,Lc=!1,rl=0,sl=1/0,Ti=null,jr=null,nn=0,Ur=null,ll=null,Yl=0,rr=0,Kl=null,Gc=null,sr=0,Hc=null;return Be.attemptContinuousHydration=function(s){if(s.tag===13){var u=$t(s,67108864);u!==null&&ki(u,s,67108864),ts(s,67108864)}},Be.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var u=Ii();u=H(u);var p=$t(s,u);p!==null&&ki(p,s,u),ts(s,u)}},Be.attemptSynchronousHydration=function(s){switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var u=L(s.pendingLanes);if(u!==0){for(s.pendingLanes|=2,s.entangledLanes|=2;u;){var p=1<<31-Mi(u);s.entanglements[1]|=p,u&=~p}dn(s),(Re&6)===0&&(sl=sa()+500,ft(0))}}break;case 13:u=$t(s,2),u!==null&&ki(u,s,2),Nl(),ts(s,2)}},Be.batchedUpdates=function(s,u){return s(u)},Be.createComponentSelector=function(s){return{$$typeof:Ei,value:s}},Be.createContainer=function(s,u,p,S,x,P,nt,ut,_t,Ut){return lc(s,u,!1,null,p,S,P,nt,ut,_t,Ut,null)},Be.createHasPseudoClassSelector=function(s){return{$$typeof:Ma,value:s}},Be.createHydrationContainer=function(s,u,p,S,x,P,nt,ut,_t,Ut,Ht,Zt,Wt){return s=lc(p,S,!0,s,x,P,ut,_t,Ut,Ht,Zt,Wt),s.context=jl(null),p=s.current,S=Ii(),S=H(S),x=Kt(S),x.callback=u??null,ie(p,x,S),u=S,s.current.lanes=u,T(s,u),dn(s),s},Be.createPortal=function(s,u,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:br,key:S==null?null:""+S,children:s,containerInfo:u,implementation:p}},Be.createRoleSelector=function(s){return{$$typeof:Mr,value:s}},Be.createTestNameSelector=function(s){return{$$typeof:Vl,value:s}},Be.createTextSelector=function(s){return{$$typeof:ya,value:s}},Be.defaultOnCaughtError=function(s){console.error(s)},Be.defaultOnRecoverableError=function(s){nl(s)},Be.defaultOnUncaughtError=function(s){nl(s)},Be.deferredUpdates=function(s){var u=ce.T,p=Xa();try{return Qn(32),ce.T=null,s()}finally{Qn(p),ce.T=u}},Be.discreteUpdates=function(s,u,p,S,x){var P=ce.T,nt=Xa();try{return Qn(2),ce.T=null,s(u,p,S,x)}finally{Qn(nt),ce.T=P,Re===0&&(sl=sa()+500)}},Be.findAllNodes=zo,Be.findBoundingRects=function(s,u){if(!Ja)throw Error(r(363));u=zo(s,u),s=[];for(var p=0;p<u.length;p++)s.push(zn(u[p]));for(u=s.length-1;0<u;u--){p=s[u];for(var S=p.x,x=S+p.width,P=p.y,nt=P+p.height,ut=u-1;0<=ut;ut--)if(u!==ut){var _t=s[ut],Ut=_t.x,Ht=Ut+_t.width,Zt=_t.y,Wt=Zt+_t.height;if(S>=Ut&&P>=Zt&&x<=Ht&&nt<=Wt){s.splice(u,1);break}else if(S!==Ut||p.width!==_t.width||Wt<P||Zt>nt){if(!(P!==Zt||p.height!==_t.height||Ht<S||Ut>x)){Ut>S&&(_t.width+=Ut-S,_t.x=S),Ht<x&&(_t.width=x-Ut),s.splice(u,1);break}}else{Zt>P&&(_t.height+=Zt-P,_t.y=P),Wt<nt&&(_t.height=nt-Zt),s.splice(u,1);break}}}return s},Be.findHostInstance=Ul,Be.findHostInstanceWithNoPortals=function(s){return s=d(s),s=s!==null?m(s):null,s===null?null:Ls(s.stateNode)},Be.findHostInstanceWithWarning=function(s){return Ul(s)},Be.flushPassiveEffects=xs,Be.flushSyncFromReconciler=function(s){var u=Re;Re|=1;var p=ce.T,S=Xa();try{if(Qn(2),ce.T=null,s)return s()}finally{Qn(S),ce.T=p,Re=u,(Re&6)===0&&ft(0)}},Be.flushSyncWork=Nl,Be.focusWithin=function(s,u){if(!Ja)throw Error(r(363));for(s=Ca(s),u=Zr(s,u),u=Array.from(u),s=0;s<u.length;){var p=u[s++],S=p.tag;if(!Hs(p)){if((S===5||S===26||S===27)&&Xd(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},Be.getFindAllNodesFailureDescription=function(s,u){if(!Ja)throw Error(r(363));var p=0,S=[];s=[Ca(s),0];for(var x=0;x<s.length;){var P=s[x++],nt=P.tag,ut=s[x++],_t=u[ut];if((nt!==5&&nt!==26&&nt!==27||!Hs(P))&&(ec(P,_t)&&(S.push(Rl(_t)),ut++,ut>p&&(p=ut)),ut<u.length))for(P=P.child;P!==null;)s.push(P,ut),P=P.sibling}if(p<u.length){for(s=[];p<u.length;p++)s.push(Rl(u[p]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},Be.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 27:case 5:return Ls(s.child.stateNode);default:return s.child.stateNode}},Be.injectIntoDevTools=function(){var s={bundleType:0,version:zs,rendererPackageName:Yd,currentDispatcherRef:ce,reconcilerVersion:"19.1.0"};if(Ar!==null&&(s.rendererConfig=Ar),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)s=!0;else{try{Pl=u.inject(s),Vi=u}catch{}s=!!u.checkDCE}}return s},Be.isAlreadyRendering=function(){return(Re&6)!==0},Be.observeVisibleRects=function(s,u,p,S){if(!Ja)throw Error(r(363));s=zo(s,u);var x=Hg(s,p,S).disconnect;return{disconnect:function(){x()}}},Be.shouldError=function(){return null},Be.shouldSuspend=function(){return!1},Be.startHostTransition=function(s,u,p,S){if(s.tag!==5)throw Error(r(476));var x=_o(s).queue;bo(s,x,u,wr,p===null?i:function(){var P=_o(s).next.queue;return Es(s,P,{},Ii()),p(S)})},Be.updateContainer=function(s,u,p,S){var x=u.current,P=Ii();return oc(x,P,s,u,p,S),P},Be.updateContainerSync=function(s,u,p,S){return oc(u.current,2,s,u,p,S),2},Be},o.exports.default=o.exports,Object.defineProperty(o.exports,"__esModule",{value:!0})})(jp)),jp.exports}var $y;function I6(){return $y||($y=1,Dp.exports=P6()),Dp.exports}var k6=I6();const q6=hf(k6);var zp={exports:{}},ul={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function V6(){return t1||(t1=1,ul.ConcurrentRoot=1,ul.ContinuousEventPriority=8,ul.DefaultEventPriority=32,ul.DiscreteEventPriority=2,ul.IdleEventPriority=268435456,ul.LegacyRoot=0,ul.NoEventPriority=0),ul}var e1;function Y6(){return e1||(e1=1,zp.exports=V6()),zp.exports}var xg=Y6();const n1={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let i1=!1,a1=!1;const mg=".react-konva-event",K6=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,Q6=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,X6={};function Ng(o,t,n=X6){if(!i1&&"zIndex"in t&&(console.warn(Q6),i1=!0),!a1&&t.draggable){var i=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;i&&!r&&(console.warn(K6),a1=!0)}for(var l in n)if(!n1[l]){var c=l.slice(0,2)==="on",d=n[l]!==t[l];if(c&&d){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),o.off(g,n[l])}var m=!t.hasOwnProperty(l);m&&o.setAttr(l,void 0)}var _=t._useStrictMode,C={},E=!1;const O={};for(var l in t)if(!n1[l]){var c=l.slice(0,2)==="on",v=n[l]!==t[l];if(c&&v){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),t[l]&&(O[g]=t[l])}!c&&(t[l]!==n[l]||_&&t[l]!==o.getAttr(l))&&(E=!0,C[l]=t[l])}E&&(o.setAttrs(C),po(o));for(var g in O)o.off(g+mg),o.on(g+mg,O[g])}function po(o){if(!Jt.autoDrawEnabled){var t=o.getLayer()||o.getStage();t&&t.batchDraw()}}var Lp={exports:{}},Gp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function F6(){return r1||(r1=1,(function(o){function t(U,I){var F=U.length;U.push(I);t:for(;0<F;){var W=F-1>>>1,at=U[W];if(0<r(at,I))U[W]=I,U[F]=at,F=W;else break t}}function n(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var I=U[0],F=U.pop();if(F!==I){U[0]=F;t:for(var W=0,at=U.length,Z=at>>>1;W<Z;){var rt=2*(W+1)-1,it=U[rt],Y=rt+1,J=U[Y];if(0>r(it,F))Y<at&&0>r(J,it)?(U[W]=J,U[Y]=F,W=Y):(U[W]=it,U[rt]=F,W=rt);else if(Y<at&&0>r(J,F))U[W]=J,U[Y]=F,W=Y;else break t}}return I}function r(U,I){var F=U.sortIndex-I.sortIndex;return F!==0?F:U.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],_=1,C=null,E=3,O=!1,v=!1,D=!1,L=!1,z=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function G(U){for(var I=n(m);I!==null;){if(I.callback===null)i(m);else if(I.startTime<=U)i(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function R(U){if(D=!1,G(U),!v)if(n(g)!==null)v=!0,A||(A=!0,Q());else{var I=n(m);I!==null&&V(R,I.startTime-U)}}var A=!1,T=-1,y=5,B=-1;function j(){return L?!0:!(o.unstable_now()-B<y)}function H(){if(L=!1,A){var U=o.unstable_now();B=U;var I=!0;try{t:{v=!1,D&&(D=!1,M(T),T=-1),O=!0;var F=E;try{e:{for(G(U),C=n(g);C!==null&&!(C.expirationTime>U&&j());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var at=W(C.expirationTime<=U);if(U=o.unstable_now(),typeof at=="function"){C.callback=at,G(U),I=!0;break e}C===n(g)&&i(g),G(U)}else i(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&V(R,Z.startTime-U),I=!1}}break t}finally{C=null,E=F,O=!1}I=void 0}}finally{I?Q():A=!1}}}var Q;if(typeof N=="function")Q=function(){N(H)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=H,Q=function(){X.postMessage(null)}}else Q=function(){z(H,0)};function V(U,I){T=z(function(){U(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(U){U.callback=null},o.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<U?Math.floor(1e3/U):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(U){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return U()}finally{E=F}},o.unstable_requestPaint=function(){L=!0},o.unstable_runWithPriority=function(U,I){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var F=E;E=U;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(U,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,U){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=F+at,U={id:_++,callback:I,priorityLevel:U,startTime:F,expirationTime:at,sortIndex:-1},F>W?(U.sortIndex=F,t(m,U),n(g)===null&&U===n(m)&&(D?(M(T),T=-1):D=!0,V(R,F-W))):(U.sortIndex=at,t(g,U),v||O||(v=!0,A||(A=!0,Q()))),U},o.unstable_shouldYield=j,o.unstable_wrapCallback=function(U){var I=E;return function(){var F=E;E=I;try{return U.apply(this,arguments)}finally{E=F}}}})(Gp)),Gp}var s1;function J6(){return s1||(s1=1,Lp.exports=F6()),Lp.exports}var Hp=J6();const oS={},Z6={};uf.Node.prototype._applyProps=Ng;let uS=xg.DefaultEventPriority;function W6(o,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}o.add(t),po(o)}function $6(o,t,n){let i=uf[o];i||(console.error(`Konva has no node with the type ${o}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${o}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),i=uf.Group);const r={},l={};for(var c in t)if(c!=="ref"){var d=c.slice(0,2)==="on";d?l[c]=t[c]:r[c]=t[c]}const g=new i(r);return Ng(g,l),g}function t8(o,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${o}"`)}function e8(o,t,n){return!1}function n8(o){return o}function i8(){return null}function a8(){return null}function r8(o,t,n,i){return Z6}function s8(){}function l8(o){}function o8(o,t){return!1}function u8(){return oS}function c8(){return oS}const f8=setTimeout,h8=clearTimeout,d8=!0,g8=o=>{o()},p8=-1;function m8(o,t){return!1}const v8=!1,y8=!1,S8=!0,b8=!1,_8=!1;function E8(o,t){t.parent===o?t.moveToTop():o.add(t),po(o)}function C8(o,t){t.parent===o?t.moveToTop():o.add(t),po(o)}function cS(o,t,n){t._remove(),o.add(t),t.setZIndex(n.getZIndex()),po(o)}function T8(o,t,n){cS(o,t,n)}function A8(o,t){t.destroy(),t.off(mg),po(o)}function w8(o,t){t.destroy(),t.off(mg),po(o)}function O8(o,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function R8(o,t,n){}function x8(o,t,n,i){Ng(o,i,n)}function N8(o){o.hide(),po(o)}function M8(o){}function D8(o,t){(t.visible==null||t.visible)&&o.show()}function j8(o,t){}function U8(o){}function B8(){}function z8(){return xg.DefaultEventPriority}function L8(){}function G8(){return null}function H8(o){uS=o}function P8(){return uS}function I8(){return xg.DiscreteEventPriority}function k8(){return!1}function q8(){}function V8(){return!1}function Y8(){return!0}function K8(){}function Q8(){}function X8(){return null}const F8=null;function J8(){}const Z8=Object.freeze(Object.defineProperty({__proto__:null,NotPendingTransition:F8,appendChild:E8,appendChildToContainer:C8,appendInitialChild:W6,cancelTimeout:h8,clearContainer:U8,commitMount:R8,commitTextUpdate:O8,commitUpdate:x8,createInstance:$6,createTextInstance:t8,detachDeletedInstance:B8,finalizeInitialChildren:e8,getChildHostContext:c8,getCurrentEventPriority:z8,getCurrentUpdatePriority:P8,getInstanceFromScope:G8,getPublicInstance:n8,getRootHostContext:u8,hideInstance:N8,hideTextInstance:M8,idlePriority:Hp.unstable_IdlePriority,insertBefore:cS,insertInContainerBefore:T8,isPrimaryRenderer:v8,maySuspendCommit:V8,noTimeout:p8,now:Hp.unstable_now,preloadInstance:Y8,prepareForCommit:i8,preparePortalMount:a8,prepareScopeUpdate:L8,prepareUpdate:r8,removeChild:A8,removeChildFromContainer:w8,requestPostPaintCallback:q8,resetAfterCommit:s8,resetFormInstance:J8,resetTextContent:l8,resolveUpdatePriority:I8,run:Hp.unstable_runWithPriority,scheduleMicrotask:g8,scheduleTimeout:f8,setCurrentUpdatePriority:H8,shouldAttemptEagerTransition:k8,shouldDeprioritizeSubtree:o8,shouldSetTextContent:m8,startSuspendingCommit:K8,supportsHydration:_8,supportsMicrotasks:d8,supportsMutation:S8,supportsPersistence:b8,suspendInstance:Q8,unhideInstance:D8,unhideTextInstance:j8,waitForCommitToBeReady:X8,warnsIfNotActing:y8},Symbol.toStringTag,{value:"Module"}));function fS(o,t,n){if(!o)return;if(n(o)===!0)return o;let i=o.child;for(;i;){const r=fS(i,t,n);if(r)return r;i=i.sibling}}function hS(o){try{return Object.defineProperties(o,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return o}}const iv=hS(lt.createContext(null));class dS extends lt.Component{render(){return lt.createElement(iv.Provider,{value:this._reactInternals},this.props.children)}}function W8(){const o=lt.useContext(iv);if(o===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=lt.useId();return lt.useMemo(()=>{for(const n of[o,o==null?void 0:o.alternate]){if(!n)continue;const i=fS(n,!1,r=>{let l=r.memoizedState;for(;l;){if(l.memoizedState===t)return!0;l=l.next}});if(i)return i}},[o,t])}const $8=Symbol.for("react.context"),t_=o=>o!==null&&typeof o=="object"&&"$$typeof"in o&&o.$$typeof===$8;function e_(){const o=W8(),[t]=lt.useState(()=>new Map);t.clear();let n=o;for(;n;){const i=n.type;t_(i)&&i!==iv&&!t.has(i)&&t.set(i,lt.use(hS(i))),n=n.return}return t}function n_(){const o=e_();return lt.useMemo(()=>Array.from(o.keys()).reduce((t,n)=>i=>lt.createElement(t,null,lt.createElement(n.Provider,{...i,value:o.get(n)})),t=>lt.createElement(dS,{...t})),[o])}if(qn.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function i_(o){const t=qn.useRef({});return qn.useLayoutEffect(()=>{t.current=o}),qn.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const a_=()=>{const o=qn.useRef(0);return qn.useMemo(()=>{o.current++},[]),o.current>1},r_=o=>{const t=qn.useRef(null),n=qn.useRef(null),i=qn.useRef(null),r=i_(o),l=n_(),c=qn.useRef(!1),d=m=>{const{forwardedRef:_}=o;_&&(typeof _=="function"?_(m):_.current=m)},g=a_();return qn.useLayoutEffect(()=>c.current&&g?()=>{c.current=!1,d(null),nf.updateContainer(null,i.current,null),n.current.destroy()}:(c.current=!0,n.current=new uf.Stage({width:o.width,height:o.height,container:t.current}),d(n.current),i.current=nf.createContainer(n.current,xg.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),nf.updateContainer(qn.createElement(l,{},o.children),i.current,null,()=>{}),()=>{g||(d(null),nf.updateContainer(null,i.current,null),n.current.destroy())}),[]),qn.useLayoutEffect(()=>{d(n.current),Ng(n.current,o,r),nf.updateContainer(qn.createElement(l,{},o.children),i.current,null)}),qn.createElement("div",{ref:t,id:o.id,accessKey:o.accessKey,className:o.className,role:o.role,style:o.style,tabIndex:o.tabIndex,title:o.title})},Gr="Layer",uo="Line",av="Image",nf=q6(Z8);nf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:qn.version,rendererPackageName:"react-konva"});const Mg=qn.forwardRef((o,t)=>qn.createElement(dS,{},qn.createElement(r_,{...o,forwardedRef:t})));var Pp={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var l1;function gS(){return l1||(l1=1,(function(o,t){(function(i,r){o.exports=r()})(window,function(){return(function(n){var i={};function r(l){if(i[l])return i[l].exports;var c=i[l]={i:l,l:!1,exports:{}};return n[l].call(c.exports,c,c.exports,r),c.l=!0,c.exports}return r.m=n,r.c=i,r.d=function(l,c,d){r.o(l,c)||Object.defineProperty(l,c,{enumerable:!0,get:d})},r.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},r.t=function(l,c){if(c&1&&(l=r(l)),c&8||c&4&&typeof l=="object"&&l&&l.__esModule)return l;var d=Object.create(null);if(r.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:l}),c&2&&typeof l!="string")for(var g in l)r.d(d,g,(function(m){return l[m]}).bind(null,g));return d},r.n=function(l){var c=l&&l.__esModule?function(){return l.default}:function(){return l};return r.d(c,"a",c),c},r.o=function(l,c){return Object.prototype.hasOwnProperty.call(l,c)},r.p="",r(r.s=42)})([(function(n,i,r){r.r(i),r.d(i,"__extends",function(){return c}),r.d(i,"__assign",function(){return d}),r.d(i,"__rest",function(){return g}),r.d(i,"__decorate",function(){return m}),r.d(i,"__param",function(){return _}),r.d(i,"__metadata",function(){return C}),r.d(i,"__awaiter",function(){return E}),r.d(i,"__generator",function(){return O}),r.d(i,"__createBinding",function(){return v}),r.d(i,"__exportStar",function(){return D}),r.d(i,"__values",function(){return L}),r.d(i,"__read",function(){return z}),r.d(i,"__spread",function(){return M}),r.d(i,"__spreadArrays",function(){return N}),r.d(i,"__spreadArray",function(){return G}),r.d(i,"__await",function(){return R}),r.d(i,"__asyncGenerator",function(){return A}),r.d(i,"__asyncDelegator",function(){return T}),r.d(i,"__asyncValues",function(){return y}),r.d(i,"__makeTemplateObject",function(){return B}),r.d(i,"__importStar",function(){return H}),r.d(i,"__importDefault",function(){return Q}),r.d(i,"__classPrivateFieldGet",function(){return K}),r.d(i,"__classPrivateFieldSet",function(){return X});/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */var l=function(V,U){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var W in F)Object.prototype.hasOwnProperty.call(F,W)&&(I[W]=F[W])},l(V,U)};function c(V,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");l(V,U);function I(){this.constructor=V}V.prototype=U===null?Object.create(U):(I.prototype=U.prototype,new I)}var d=function(){return d=Object.assign||function(U){for(var I,F=1,W=arguments.length;F<W;F++){I=arguments[F];for(var at in I)Object.prototype.hasOwnProperty.call(I,at)&&(U[at]=I[at])}return U},d.apply(this,arguments)};function g(V,U){var I={};for(var F in V)Object.prototype.hasOwnProperty.call(V,F)&&U.indexOf(F)<0&&(I[F]=V[F]);if(V!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,F=Object.getOwnPropertySymbols(V);W<F.length;W++)U.indexOf(F[W])<0&&Object.prototype.propertyIsEnumerable.call(V,F[W])&&(I[F[W]]=V[F[W]]);return I}function m(V,U,I,F){var W=arguments.length,at=W<3?U:F===null?F=Object.getOwnPropertyDescriptor(U,I):F,Z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")at=Reflect.decorate(V,U,I,F);else for(var rt=V.length-1;rt>=0;rt--)(Z=V[rt])&&(at=(W<3?Z(at):W>3?Z(U,I,at):Z(U,I))||at);return W>3&&at&&Object.defineProperty(U,I,at),at}function _(V,U){return function(I,F){U(I,F,V)}}function C(V,U){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(V,U)}function E(V,U,I,F){function W(at){return at instanceof I?at:new I(function(Z){Z(at)})}return new(I||(I=Promise))(function(at,Z){function rt(J){try{Y(F.next(J))}catch(tt){Z(tt)}}function it(J){try{Y(F.throw(J))}catch(tt){Z(tt)}}function Y(J){J.done?at(J.value):W(J.value).then(rt,it)}Y((F=F.apply(V,U||[])).next())})}function O(V,U){var I={label:0,sent:function(){if(at[0]&1)throw at[1];return at[1]},trys:[],ops:[]},F,W,at,Z;return Z={next:rt(0),throw:rt(1),return:rt(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function rt(Y){return function(J){return it([Y,J])}}function it(Y){if(F)throw new TypeError("Generator is already executing.");for(;I;)try{if(F=1,W&&(at=Y[0]&2?W.return:Y[0]?W.throw||((at=W.return)&&at.call(W),0):W.next)&&!(at=at.call(W,Y[1])).done)return at;switch(W=0,at&&(Y=[Y[0]&2,at.value]),Y[0]){case 0:case 1:at=Y;break;case 4:return I.label++,{value:Y[1],done:!1};case 5:I.label++,W=Y[1],Y=[0];continue;case 7:Y=I.ops.pop(),I.trys.pop();continue;default:if(at=I.trys,!(at=at.length>0&&at[at.length-1])&&(Y[0]===6||Y[0]===2)){I=0;continue}if(Y[0]===3&&(!at||Y[1]>at[0]&&Y[1]<at[3])){I.label=Y[1];break}if(Y[0]===6&&I.label<at[1]){I.label=at[1],at=Y;break}if(at&&I.label<at[2]){I.label=at[2],I.ops.push(Y);break}at[2]&&I.ops.pop(),I.trys.pop();continue}Y=U.call(V,I)}catch(J){Y=[6,J],W=0}finally{F=at=0}if(Y[0]&5)throw Y[1];return{value:Y[0]?Y[1]:void 0,done:!0}}}var v=Object.create?(function(V,U,I,F){F===void 0&&(F=I),Object.defineProperty(V,F,{enumerable:!0,get:function(){return U[I]}})}):(function(V,U,I,F){F===void 0&&(F=I),V[F]=U[I]});function D(V,U){for(var I in V)I!=="default"&&!Object.prototype.hasOwnProperty.call(U,I)&&v(U,V,I)}function L(V){var U=typeof Symbol=="function"&&Symbol.iterator,I=U&&V[U],F=0;if(I)return I.call(V);if(V&&typeof V.length=="number")return{next:function(){return V&&F>=V.length&&(V=void 0),{value:V&&V[F++],done:!V}}};throw new TypeError(U?"Object is not iterable.":"Symbol.iterator is not defined.")}function z(V,U){var I=typeof Symbol=="function"&&V[Symbol.iterator];if(!I)return V;var F=I.call(V),W,at=[],Z;try{for(;(U===void 0||U-- >0)&&!(W=F.next()).done;)at.push(W.value)}catch(rt){Z={error:rt}}finally{try{W&&!W.done&&(I=F.return)&&I.call(F)}finally{if(Z)throw Z.error}}return at}function M(){for(var V=[],U=0;U<arguments.length;U++)V=V.concat(z(arguments[U]));return V}function N(){for(var V=0,U=0,I=arguments.length;U<I;U++)V+=arguments[U].length;for(var F=Array(V),W=0,U=0;U<I;U++)for(var at=arguments[U],Z=0,rt=at.length;Z<rt;Z++,W++)F[W]=at[Z];return F}function G(V,U,I){if(I||arguments.length===2)for(var F=0,W=U.length,at;F<W;F++)(at||!(F in U))&&(at||(at=Array.prototype.slice.call(U,0,F)),at[F]=U[F]);return V.concat(at||Array.prototype.slice.call(U))}function R(V){return this instanceof R?(this.v=V,this):new R(V)}function A(V,U,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var F=I.apply(V,U||[]),W,at=[];return W={},Z("next"),Z("throw"),Z("return"),W[Symbol.asyncIterator]=function(){return this},W;function Z(et){F[et]&&(W[et]=function(gt){return new Promise(function(At,Dt){at.push([et,gt,At,Dt])>1||rt(et,gt)})})}function rt(et,gt){try{it(F[et](gt))}catch(At){tt(at[0][3],At)}}function it(et){et.value instanceof R?Promise.resolve(et.value.v).then(Y,J):tt(at[0][2],et)}function Y(et){rt("next",et)}function J(et){rt("throw",et)}function tt(et,gt){et(gt),at.shift(),at.length&&rt(at[0][0],at[0][1])}}function T(V){var U,I;return U={},F("next"),F("throw",function(W){throw W}),F("return"),U[Symbol.iterator]=function(){return this},U;function F(W,at){U[W]=V[W]?function(Z){return(I=!I)?{value:R(V[W](Z)),done:W==="return"}:at?at(Z):Z}:at}}function y(V){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var U=V[Symbol.asyncIterator],I;return U?U.call(V):(V=typeof L=="function"?L(V):V[Symbol.iterator](),I={},F("next"),F("throw"),F("return"),I[Symbol.asyncIterator]=function(){return this},I);function F(at){I[at]=V[at]&&function(Z){return new Promise(function(rt,it){Z=V[at](Z),W(rt,it,Z.done,Z.value)})}}function W(at,Z,rt,it){Promise.resolve(it).then(function(Y){at({value:Y,done:rt})},Z)}}function B(V,U){return Object.defineProperty?Object.defineProperty(V,"raw",{value:U}):V.raw=U,V}var j=Object.create?(function(V,U){Object.defineProperty(V,"default",{enumerable:!0,value:U})}):function(V,U){V.default=U};function H(V){if(V&&V.__esModule)return V;var U={};if(V!=null)for(var I in V)I!=="default"&&Object.prototype.hasOwnProperty.call(V,I)&&v(U,V,I);return j(U,V),U}function Q(V){return V&&V.__esModule?V:{default:V}}function K(V,U,I,F){if(I==="a"&&!F)throw new TypeError("Private accessor was defined without a getter");if(typeof U=="function"?V!==U||!F:!U.has(V))throw new TypeError("Cannot read private member from an object whose class did not declare it");return I==="m"?F:I==="a"?F.call(V):F?F.value:U.get(V)}function X(V,U,I,F,W){if(F==="m")throw new TypeError("Private method is not writable");if(F==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof U=="function"?V!==U||!W:!U.has(V))throw new TypeError("Cannot write private member to an object whose class did not declare it");return F==="a"?W.call(V,I):W?W.value=I:U.set(V,I),I}}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0}),i.allToUpperCase=i.allToLowerCase=i.encodeBody=i.decodeBody=i.Format=i.promisify=i.trim=i.arrChooseN=i.randomHexString=i.randomString=i.cheapRandStr=i.dataSizeBytes=i.inspectBody=i.inspectError=i.isErrorInfoOrPartialErrorInfo=i.now=i.parseQueryString=i.toQueryString=i.arrPopRandomElement=i.defaultPostHeaders=i.defaultGetHeaders=i.allSame=i.arrEvery=i.arrFilter=i.arrMap=i.safeArrForEach=i.arrForEach=i.forInOwnNonNullProperties=i.valuesArray=i.keysArray=i.arrWithoutValue=i.arrDeleteValue=i.arrIn=i.arrIndexOf=i.arrSubtract=i.arrIntersectOb=i.arrIntersect=i.intersect=i.containsValue=i.inherits=i.prototypicalClone=i.shallowClone=i.isEmptyArg=i.isOnlyPropIn=i.isEmpty=i.isObject=i.ensureArray=i.isArray=i.copy=i.mixin=void 0,i.arrEquals=i.toBase64=i.matchDerivedChannel=i.shallowEquals=i.getGlobalObject=i.getRetryTime=i.getJitterCoefficient=i.getBackoffCoefficient=void 0;var c=r(0),d=c.__importDefault(r(3)),g=c.__importStar(r(8)),m=c.__importDefault(r(4)),_=r(11),C=r(31);function E(ft){return Math.floor(Math.random()*ft.length)}function O(ft){for(var ht=[],ct=1;ct<arguments.length;ct++)ht[ct-1]=arguments[ct];for(var wt=0;wt<ht.length;wt++){var jt=ht[wt];if(!jt)break;var Ot=Object.prototype.hasOwnProperty;for(var Gt in jt)(!Ot||Ot.call(jt,Gt))&&(ft[Gt]=jt[Gt])}return ft}i.mixin=O;function v(ft){return O({},ft)}i.copy=v,i.isArray=Array.isArray||function(ft){return Object.prototype.toString.call(ft)=="[object Array]"};function D(ft){return N(ft)?[]:(0,i.isArray)(ft)?ft:[ft]}i.ensureArray=D;function L(ft){return Object.prototype.toString.call(ft)=="[object Object]"}i.isObject=L;function z(ft){for(var ht in ft)return!1;return!0}i.isEmpty=z;function M(ft,ht){for(var ct in ft)if(ct!==ht)return!1;return!0}i.isOnlyPropIn=M;function N(ft){return ft==null}i.isEmptyArg=N;function G(ft){var ht=new Object;for(var ct in ft)ht[ct]=ft[ct];return ht}i.shallowClone=G;function R(ft,ht){var ct=(function(){function jt(){}return jt})();ct.prototype=ft;var wt=new ct;return ht&&O(wt,ht),wt}i.prototypicalClone=R;var A=function(ft,ht){if(d.default.Config.inherits){d.default.Config.inherits(ft,ht);return}ft.super_=ht,ft.prototype=R(ht.prototype,{constructor:ft})};i.inherits=A;function T(ft,ht){for(var ct in ft)if(ft[ct]==ht)return!0;return!1}i.containsValue=T;function y(ft,ht){return(0,i.isArray)(ht)?B(ft,ht):j(ft,ht)}i.intersect=y;function B(ft,ht){for(var ct=[],wt=0;wt<ft.length;wt++){var jt=ft[wt];(0,i.arrIndexOf)(ht,jt)!=-1&&ct.push(jt)}return ct}i.arrIntersect=B;function j(ft,ht){for(var ct=[],wt=0;wt<ft.length;wt++){var jt=ft[wt];jt in ht&&ct.push(jt)}return ct}i.arrIntersectOb=j;function H(ft,ht){for(var ct=[],wt=0;wt<ft.length;wt++){var jt=ft[wt];(0,i.arrIndexOf)(ht,jt)==-1&&ct.push(jt)}return ct}i.arrSubtract=H,i.arrIndexOf=Array.prototype.indexOf?function(ft,ht,ct){return ft.indexOf(ht,ct)}:function(ft,ht,ct){ct=ct||0;for(var wt=ft.length;ct<wt;ct++)if(ft[ct]===ht)return ct;return-1};function Q(ft,ht){return(0,i.arrIndexOf)(ft,ht)!==-1}i.arrIn=Q;function K(ft,ht){var ct=(0,i.arrIndexOf)(ft,ht),wt=ct!=-1;return wt&&ft.splice(ct,1),wt}i.arrDeleteValue=K;function X(ft,ht){var ct=ft.slice();return K(ct,ht),ct}i.arrWithoutValue=X;function V(ft,ht){var ct=[];for(var wt in ft)ht&&!Object.prototype.hasOwnProperty.call(ft,wt)||ct.push(wt);return ct}i.keysArray=V;function U(ft,ht){var ct=[];for(var wt in ft)ht&&!Object.prototype.hasOwnProperty.call(ft,wt)||ct.push(ft[wt]);return ct}i.valuesArray=U;function I(ft,ht){for(var ct in ft)Object.prototype.hasOwnProperty.call(ft,ct)&&ft[ct]&&ht(ct)}i.forInOwnNonNullProperties=I,i.arrForEach=Array.prototype.forEach?function(ft,ht){ft.forEach(ht)}:function(ft,ht){for(var ct=ft.length,wt=0;wt<ct;wt++)ht(ft[wt],wt,ft)};function F(ft,ht){return(0,i.arrForEach)(ft.slice(),ht)}i.safeArrForEach=F,i.arrMap=Array.prototype.map?function(ft,ht){return ft.map(ht)}:function(ft,ht){for(var ct=[],wt=ft.length,jt=0;jt<wt;jt++)ct.push(ht(ft[jt],jt,ft));return ct},i.arrFilter=Array.prototype.filter?function(ft,ht){return ft.filter(ht)}:function(ft,ht){for(var ct=[],wt=ft.length,jt=0;jt<wt;jt++)ht(ft[jt])&&ct.push(ft[jt]);return ct},i.arrEvery=Array.prototype.every?function(ft,ht){return ft.every(ht)}:function(ft,ht){for(var ct=ft.length,wt=0;wt<ct;wt++)if(!ht(ft[wt],wt,ft))return!1;return!0};function W(ft,ht){if(ft.length===0)return!0;var ct=ft[0][ht];return(0,i.arrEvery)(ft,function(wt){return wt[ht]===ct})}i.allSame=W;var at={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function Z(ft,ht){var ct=at[ht||ye.json];return{accept:ct,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ft)}}i.defaultGetHeaders=Z;function rt(ft,ht){var ct,wt=ct=at[ht||ye.json];return{accept:wt,"content-type":ct,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ft)}}i.defaultPostHeaders=rt;function it(ft){return ft.splice(E(ft),1)[0]}i.arrPopRandomElement=it;function Y(ft){var ht=[];if(ft)for(var ct in ft)ht.push(encodeURIComponent(ct)+"="+encodeURIComponent(ft[ct]));return ht.length?"?"+ht.join("&"):""}i.toQueryString=Y;function J(ft){for(var ht,ct=/([^?&=]+)=?([^&]*)/g,wt={};ht=ct.exec(ft);)wt[decodeURIComponent(ht[1])]=decodeURIComponent(ht[2]);return wt}i.parseQueryString=J,i.now=Date.now||function(){return new Date().getTime()};function tt(ft){return typeof ft=="object"&&ft!==null&&(ft.constructor.name=="ErrorInfo"||ft.constructor.name=="PartialErrorInfo")}i.isErrorInfoOrPartialErrorInfo=tt;function et(ft){var ht,ct;return ft instanceof Error||((ht=ft==null?void 0:ft.constructor)===null||ht===void 0?void 0:ht.name)==="ErrorInfo"||((ct=ft==null?void 0:ft.constructor)===null||ct===void 0?void 0:ct.name)==="PartialErrorInfo"?ft.toString():d.default.Config.inspect(ft)}i.inspectError=et;function gt(ft){return d.default.BufferUtils.isBuffer(ft)?ft.toString():typeof ft=="string"?ft:d.default.Config.inspect(ft)}i.inspectBody=gt;function At(ft){if(d.default.BufferUtils.isBuffer(ft))return d.default.BufferUtils.byteLength(ft);if(typeof ft=="string")return d.default.Config.stringByteSize(ft);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof ft)}i.dataSizeBytes=At;function Dt(){return String(Math.random()).substr(2)}i.cheapRandStr=Dt;var Qt=function(ft){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var ht=new Uint8Array(ft);return d.default.Config.getRandomValues(ht),d.default.BufferUtils.base64Encode(ht)}for(var ct=d.default.BufferUtils.base64CharSet,wt=Math.round(ft*4/3),jt="",Ot=0;Ot<wt;Ot++)jt+=ct[E(ct)];return jt};i.randomString=Qt;var ee=function(ft){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var ht=new Uint8Array(ft);return d.default.Config.getRandomValues(ht),d.default.BufferUtils.hexEncode(ht)}for(var ct=d.default.BufferUtils.hexCharSet,wt=ft*2,jt="",Ot=0;Ot<wt;Ot++)jt+=ct[E(ct)];return jt};i.randomHexString=ee;function le(ft,ht){for(var ct=Math.min(ht,ft.length),wt=ft.slice(),jt=[],Ot=0;Ot<ct;Ot++)jt.push(it(wt));return jt}i.arrChooseN=le,i.trim=String.prototype.trim?function(ft){return ft.trim()}:function(ft){return ft.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function kt(ft,ht,ct){return new Promise(function(wt,jt){ft[ht].apply(ft,c.__spreadArray(c.__spreadArray([],ct,!1),[function(Ot,Gt){Ot?jt(Ot):wt(Gt)}],!1))})}i.promisify=kt;var ye;(function(ft){ft.msgpack="msgpack",ft.json="json"})(ye=i.Format||(i.Format={}));function _e(ft,ht){return ht=="msgpack"?d.default.Config.msgpack.decode(ft):JSON.parse(String(ft))}i.decodeBody=_e;function Xe(ft,ht){return ht=="msgpack"?d.default.Config.msgpack.encode(ft,!0):JSON.stringify(ft)}i.encodeBody=Xe;function xt(ft){return ft.map(function(ht){return ht&&ht.toLowerCase()})}i.allToLowerCase=xt;function Xt(ft){return ft.map(function(ht){return ht&&ht.toUpperCase()})}i.allToUpperCase=Xt;function Ue(ft){return Math.min((ft+2)/3,2)}i.getBackoffCoefficient=Ue;function ae(){return 1-Math.random()*.2}i.getJitterCoefficient=ae;function ge(ft,ht){return ft*Ue(ht)*ae()}i.getRetryTime=ge;function Fe(){return l||(typeof window<"u"?window:self)}i.getGlobalObject=Fe;function Me(ft,ht){return Object.keys(ft).every(function(ct){return ft[ct]===ht[ct]})&&Object.keys(ht).every(function(ct){return ht[ct]===ft[ct]})}i.shallowEquals=Me;function He(ft){var ht=/^(\[([^?]*)(?:(.*))\])?(.+)$/,ct=ft.match(ht);if(!ct||!ct.length||ct.length<5)throw new m.default("regex match failed",400,40010);if(ct[2])throw new m.default("cannot use a derived option with a ".concat(ct[2]," channel"),400,40010);return{qualifierParam:ct[3]||"",channelName:ct[4]}}i.matchDerivedChannel=He;function en(ft){return d.default.Config.createHmac?Buffer.from(ft,"ascii").toString("base64"):(0,_.stringify)((0,C.parse)(ft))}i.toBase64=en;function dn(ft,ht){return ft.length===ht.length&&(0,i.arrEvery)(ft,function(ct,wt){return ct===ht[wt]})}i.arrEquals=dn}).call(this,r(13))}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var c=r(0),d=c.__importDefault(r(3)),g=l||(typeof window<"u"?window:self),m;(function(v){v[v.None=0]="None",v[v.Error=1]="Error",v[v.Major=2]="Major",v[v.Minor=3]="Minor",v[v.Micro=4]="Micro"})(m||(m={}));function _(v,D){return"".concat(v).padStart(D?3:2,"0")}function C(v){return d.default.Config.logTimestamps?function(D){var L=new Date;v(_(L.getHours())+":"+_(L.getMinutes())+":"+_(L.getSeconds())+"."+_(L.getMilliseconds(),1)+" "+D)}:v}var E=function(){var v,D,L,z;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((D=(v=g==null?void 0:g.console)===null||v===void 0?void 0:v.log)===null||D===void 0?void 0:D.apply)=="function"?(L=function(){for(var M=[],N=0;N<arguments.length;N++)M[N]=arguments[N];console.log.apply(console,M)},z=console.warn?function(){for(var M=[],N=0;N<arguments.length;N++)M[N]=arguments[N];console.warn.apply(console,M)}:L):g!=null&&g.console.log?L=z=function(){Function.prototype.apply.call(console.log,console,arguments)}:L=z=function(){},[L,z].map(C)},O=(function(){function v(){v.logLevel=v.LOG_DEFAULT}return v.initLogHandlers=function(){var D=E(),L=D[0],z=D[1];this.logHandler=L,this.logErrorHandler=z},v.renamedClientOption=function(D,L){v.deprecationWarning("The `".concat(D,"` client option has been renamed to `").concat(L,"`. Please update your code to use `").concat(L,"` instead. `").concat(D,"` will be removed in a future version."))},v.renamedMethod=function(D,L,z){v.deprecationWarning("`".concat(D,"`s `").concat(L,"` method has been renamed to `").concat(z,"`. Please update your code to use `").concat(z,"` instead. `").concat(L,"` will be removed in a future version."))},v.deprecationWarning=function(D){v.shouldLog(m.Error)&&v.logErrorHandler("Ably: Deprecation warning - ".concat(D))},v.logLevel=m.Error,v.LOG_NONE=m.None,v.LOG_ERROR=m.Error,v.LOG_MAJOR=m.Major,v.LOG_MINOR=m.Minor,v.LOG_MICRO=m.Micro,v.LOG_DEFAULT=m.Error,v.LOG_DEBUG=m.Micro,v.logAction=function(D,L,z){v.shouldLog(D)&&(D===m.Error?v.logErrorHandler:v.logHandler)("Ably: "+L+": "+z)},v.deprecated=function(D,L){v.deprecationWarning("".concat(D," is deprecated and will be removed in a future version. ").concat(L))},v.shouldLog=function(D){return D<=v.logLevel},v.setLog=function(D,L){D!==void 0&&(v.logLevel=D),L!==void 0&&(v.logHandler=v.logErrorHandler=L)},v})();i.default=O}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function c(){}return c})();i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.PartialErrorInfo=void 0;var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1));function g(C){var E="["+C.constructor.name;return C.message&&(E+=": "+C.message),C.statusCode&&(E+="; statusCode="+C.statusCode),C.code&&(E+="; code="+C.code),C.cause&&(E+="; cause="+d.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(E+="; see "+C.href+" "),E+="]",E}var m=(function(C){l.__extends(E,C);function E(O,v,D,L){var z=C.call(this,O)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(z,E.prototype),z.code=v,z.statusCode=D,z.cause=L,z}return E.prototype.toString=function(){return g(this)},E.fromValues=function(O){var v=O,D=v.message,L=v.code,z=v.statusCode;if(typeof D!="string"||typeof L!="number"||typeof z!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+c.default.Config.inspect(O));var M=Object.assign(new E(D,L,z),O);return M.code&&!M.href&&(M.href="https://help.ably.io/error/"+M.code),M},E})(Error);i.default=m;var _=(function(C){l.__extends(E,C);function E(O,v,D,L){var z=C.call(this,O)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(z,E.prototype),z.code=v,z.statusCode=D,z.cause=L,z}return E.prototype.toString=function(){return g(this)},E})(Error);i.PartialErrorInfo=_}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){if(typeof ArrayBuffer=="function"){var c=l,d=c.lib,g=d.WordArray,m=g.init,_=g.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var E=C.byteLength,O=[],v=0;v<E;v++)O[v>>>2]|=C[v]<<24-v%4*8;m.call(this,O,E)}else m.apply(this,arguments)};_.prototype=g}})(),l.lib.WordArray})}),(function(n,i,r){(function(l){(function(c,d){n.exports=d()})(this,function(){var c=c||(function(d,g){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof l<"u"&&l.crypto&&(m=l.crypto),!m)try{m=r(44)}catch{}var _=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||(function(){function A(){}return function(T){var y;return A.prototype=T,y=new A,A.prototype=null,y}})(),E={},O=E.lib={},v=O.Base=(function(){return{extend:function(A){var T=C(this);return A&&T.mixIn(A),(!T.hasOwnProperty("init")||this.init===T.init)&&(T.init=function(){T.$super.init.apply(this,arguments)}),T.init.prototype=T,T.$super=this,T},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var T in A)A.hasOwnProperty(T)&&(this[T]=A[T]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),D=O.WordArray=v.extend({init:function(A,T){A=this.words=A||[],T!=g?this.sigBytes=T:this.sigBytes=A.length*4},toString:function(A){return(A||z).stringify(this)},concat:function(A){var T=this.words,y=A.words,B=this.sigBytes,j=A.sigBytes;if(this.clamp(),B%4)for(var H=0;H<j;H++){var Q=y[H>>>2]>>>24-H%4*8&255;T[B+H>>>2]|=Q<<24-(B+H)%4*8}else for(var H=0;H<j;H+=4)T[B+H>>>2]=y[H>>>2];return this.sigBytes+=j,this},clamp:function(){var A=this.words,T=this.sigBytes;A[T>>>2]&=4294967295<<32-T%4*8,A.length=d.ceil(T/4)},clone:function(){var A=v.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var T=[],y=0;y<A;y+=4)T.push(_());return new D.init(T,A)}}),L=E.enc={},z=L.Hex={stringify:function(A){for(var T=A.words,y=A.sigBytes,B=[],j=0;j<y;j++){var H=T[j>>>2]>>>24-j%4*8&255;B.push((H>>>4).toString(16)),B.push((H&15).toString(16))}return B.join("")},parse:function(A){for(var T=A.length,y=[],B=0;B<T;B+=2)y[B>>>3]|=parseInt(A.substr(B,2),16)<<24-B%8*4;return new D.init(y,T/2)}},M=L.Latin1={stringify:function(A){for(var T=A.words,y=A.sigBytes,B=[],j=0;j<y;j++){var H=T[j>>>2]>>>24-j%4*8&255;B.push(String.fromCharCode(H))}return B.join("")},parse:function(A){for(var T=A.length,y=[],B=0;B<T;B++)y[B>>>2]|=(A.charCodeAt(B)&255)<<24-B%4*8;return new D.init(y,T)}},N=L.Utf8={stringify:function(A){try{return decodeURIComponent(escape(M.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return M.parse(unescape(encodeURIComponent(A)))}},G=O.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new D.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=N.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var T,y=this._data,B=y.words,j=y.sigBytes,H=this.blockSize,Q=H*4,K=j/Q;A?K=d.ceil(K):K=d.max((K|0)-this._minBufferSize,0);var X=K*H,V=d.min(X*4,j);if(X){for(var U=0;U<X;U+=H)this._doProcessBlock(B,U);T=B.splice(0,X),y.sigBytes-=V}return new D.init(T,V)},clone:function(){var A=v.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});O.Hasher=G.extend({cfg:v.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){G.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var T=this._doFinalize();return T},blockSize:16,_createHelper:function(A){return function(T,y){return new A.init(y).finalize(T)}},_createHmacHelper:function(A){return function(T,y){return new R.HMAC.init(A,y).finalize(T)}}});var R=E.algo={};return E})(Math);return c})}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(3));function m(E,O,v){try{O.apply(E,v)}catch(D){d.default.logAction(d.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+D+"; stack = "+(D&&D.stack))}}function _(E,O,v){for(var D,L,z,M=0;M<E.length;M++)if(D=E[M],v&&(D=D[v]),c.isArray(D)){for(;(L=c.arrIndexOf(D,O))!==-1;)D.splice(L,1);v&&D.length===0&&delete E[M][v]}else if(c.isObject(D))for(z in D)Object.prototype.hasOwnProperty.call(D,z)&&c.isArray(D[z])&&_([D],O,z)}var C=(function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var O=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];if(v.length===1){var L=v[0];if(typeof L=="function")this.any.push(L);else throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v))}if(v.length===2){var z=v[0],M=v[1];if(typeof M!="function")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));if(c.isEmptyArg(z))this.any.push(M);else if(c.isArray(z))z.forEach(function(G){O.on(G,M)});else{if(typeof z!="string")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));var N=this.events[z]||(this.events[z]=[]);N.push(M)}}},E.prototype.off=function(){for(var O,v=this,D=[],L=0;L<arguments.length;L++)D[L]=arguments[L];if(D.length==0||c.isEmptyArg(D[0])&&c.isEmptyArg(D[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var z=D[0],M=D[1],N=null,G=null;if(D.length===1||!M)typeof z=="function"?N=z:G=z;else{if(typeof M!="function")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));O=[z,M],G=O[0],N=O[1]}if(N&&c.isEmptyArg(G)){_([this.any,this.events,this.anyOnce,this.eventsOnce],N);return}if(c.isArray(G)){G.forEach(function(R){v.off(R,N)});return}if(typeof G!="string")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(D));N?_([this.events,this.eventsOnce],N,G):(delete this.events[G],delete this.eventsOnce[G])},E.prototype.listeners=function(O){if(O){var v=this.events[O]||[];return this.eventsOnce[O]&&Array.prototype.push.apply(v,this.eventsOnce[O]),v.length?v:null}return this.any.length?this.any:null},E.prototype.emit=function(O){for(var v=[],D=1;D<arguments.length;D++)v[D-1]=arguments[D];var L={event:O},z=[];this.anyOnce.length&&(Array.prototype.push.apply(z,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(z,this.any);var M=this.eventsOnce[O];M&&(Array.prototype.push.apply(z,M),delete this.eventsOnce[O]);var N=this.events[O];N&&Array.prototype.push.apply(z,N),c.arrForEach(z,function(G){m(L,G,v)})},E.prototype.once=function(){for(var O=this,v=[],D=0;D<arguments.length;D++)v[D]=arguments[D];var L=v.length;if((L===0||L===1&&typeof v[0]!="function")&&g.default.Config.Promise){var z=v[0];return new g.default.Config.Promise(function(T){O.once(z,T)})}var M=v[0],N=v[1];if(v.length===1&&typeof M=="function")this.anyOnce.push(M);else if(c.isEmptyArg(M)){if(typeof N!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));this.anyOnce.push(N)}else if(c.isArray(M)){var G=this,R=function(){var T=Array.prototype.slice.call(arguments);if(c.arrForEach(M,function(y){G.off(y,R)}),typeof N!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));N.apply(this,T)};c.arrForEach(M,function(T){G.on(T,R)})}else{if(typeof M!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));var A=this.eventsOnce[M]||(this.eventsOnce[M]=[]);if(N){if(typeof N!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));A.push(N)}}},E.prototype.whenState=function(O,v,D){for(var L=this,z=[],M=3;M<arguments.length;M++)z[M-3]=arguments[M];var N={event:O};if(typeof O!="string"||typeof v!="string")throw"whenState requires a valid event String argument";if(typeof D!="function"&&g.default.Config.Promise)return new g.default.Config.Promise(function(G){E.prototype.whenState.apply(L,[O,v,G].concat(z))});O===v?m(N,D,z):this.once(O,D)},E})();i.default=C}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.getDefaults=i.normaliseOptions=i.objectifyOptions=i.getAgentString=i.getHosts=i.getFallbackHosts=i.environmentFallbackHosts=i.getHttpScheme=i.getPort=i.getHost=void 0;var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(4)),_=r(43),C="ably-js/"+_.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:_.version,protocolVersion:2,agent:C,getHost:O,getPort:v,getHttpScheme:D,environmentFallbackHosts:L,getFallbackHosts:z,getHosts:M,checkHost:N,objectifyOptions:T,normaliseOptions:y};function O(j,H,Q){return Q?H=H==j.restHost&&j.realtimeHost||H||j.realtimeHost:H=H||j.restHost,H}i.getHost=O;function v(j,H){return H||j.tls?j.tlsPort:j.port}i.getPort=v;function D(j){return j.tls?"https://":"http://"}i.getHttpScheme=D;function L(j){return[j+"-a-fallback.ably-realtime.com",j+"-b-fallback.ably-realtime.com",j+"-c-fallback.ably-realtime.com",j+"-d-fallback.ably-realtime.com",j+"-e-fallback.ably-realtime.com"]}i.environmentFallbackHosts=L;function z(j){var H=j.fallbackHosts,Q=typeof j.httpMaxRetryCount<"u"?j.httpMaxRetryCount:E.httpMaxRetryCount;return H?d.arrChooseN(H,Q):[]}i.getFallbackHosts=z;function M(j){return[j.restHost].concat(z(j))}i.getHosts=M;function N(j){if(typeof j!="string")throw new m.default("host must be a string; was a "+typeof j,4e4,400);if(!j.length)throw new m.default("host must not be zero-length",4e4,400)}function G(j,H,Q){return j.realtimeHost?j.realtimeHost:j.restHost?(g.default.logAction(g.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+j.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+j.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),j.restHost):H?E.REALTIME_HOST:Q+"-"+E.REALTIME_HOST}function R(j){var H={};for(var Q in E.TIMEOUTS)H[Q]=j[Q]||E.TIMEOUTS[Q];return H}function A(j){var H=E.agent;if(j.agents)for(var Q in j.agents)H+=" "+Q+"/"+j.agents[Q];return H}i.getAgentString=A;function T(j){return typeof j=="string"?j.indexOf(":")==-1?{token:j}:{key:j}:j}i.objectifyOptions=T;function y(j){if(j.host&&(g.default.renamedClientOption("host","restHost"),j.restHost=j.host),j.wsHost&&(g.default.renamedClientOption("wsHost","realtimeHost"),j.realtimeHost=j.wsHost),j.queueEvents&&(g.default.renamedClientOption("queueEvents","queueMessages"),j.queueMessages=j.queueEvents),j.headers&&g.default.deprecated("the `headers` client option",""),j.fallbackHostsUseDefault){if(j.fallbackHosts){var H="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",H),new m.default(H,4e4,400)}if(j.port||j.tlsPort){var H="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",H),new m.default(H,4e4,400)}j.environment?g.default.deprecated("The `fallbackHostsUseDefault` client option","If youre using this client option to force the library to make use of fallback hosts even though youve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):g.default.deprecated("The `fallbackHostsUseDefault` client option","If youre using this client option to force the library to make use of fallback hosts even though youre not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if youre using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),j.fallbackHosts=E.FALLBACK_HOSTS}j.recover===!0&&(g.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),j.recover=function(it,Y){Y(!0)}),typeof j.recover=="function"&&j.closeOnUnload===!0&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),j.recover=void 0),"closeOnUnload"in j||(j.closeOnUnload=!j.recover),j.transports&&d.arrIn(j.transports,"xhr")&&(g.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),d.arrDeleteValue(j.transports,"xhr"),j.transports.push("xhr_streaming")),"queueMessages"in j||(j.queueMessages=!0);var Q=j.environment&&String(j.environment).toLowerCase()||E.ENVIRONMENT,K=!Q||Q==="production";!j.fallbackHosts&&!j.restHost&&!j.realtimeHost&&!j.port&&!j.tlsPort&&(j.fallbackHosts=K?E.FALLBACK_HOSTS:L(Q));var X=j.restHost||(K?E.REST_HOST:Q+"-"+E.REST_HOST),V=G(j,K,Q);d.arrForEach((j.fallbackHosts||[]).concat(X,V),N),j.port=j.port||E.PORT,j.tlsPort=j.tlsPort||E.TLS_PORT,"tls"in j||(j.tls=!0);var U=R(j);if("useBinaryProtocol"in j?j.useBinaryProtocol=c.default.Config.supportsBinary&&j.useBinaryProtocol:j.useBinaryProtocol=c.default.Config.preferBinary,j.clientId){var I=j.headers=j.headers||{};I["X-Ably-ClientId"]=c.default.BufferUtils.base64Encode(c.default.BufferUtils.utf8Encode(j.clientId))}"idempotentRestPublishing"in j||(j.idempotentRestPublishing=!0),j.promises&&!c.default.Config.Promise&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),j.promises=!1);var F=null,W=j.connectivityCheckUrl;if(j.connectivityCheckUrl){var at=j.connectivityCheckUrl.split("?"),Z=at[0],rt=at[1];F=rt?d.parseQueryString(rt):{},Z.indexOf("://")===-1&&(Z="https://"+Z),W=Z}return l.__assign(l.__assign({},j),{useBinaryProtocol:"useBinaryProtocol"in j?c.default.Config.supportsBinary&&j.useBinaryProtocol:c.default.Config.preferBinary,realtimeHost:V,restHost:X,maxMessageSize:j.maxMessageSize||E.maxMessageSize,timeouts:U,connectivityCheckParams:F,connectivityCheckUrl:W})}i.normaliseOptions=y,i.default=E;function B(j){return Object.assign(E,j)}i.getDefaults=B}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importDefault(r(2)),g=l.__importDefault(r(4)),m=l.__importStar(r(1));function _(v){return!v||!v.channelOptions?{channelOptions:v,plugins:{},baseEncodedPreviousPayload:void 0}:v}function C(v){if(v&&v.cipher){if(!c.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var D=c.default.Crypto.getCipher(v.cipher);return{cipher:D.cipherParams,channelCipher:D.cipher}}return v??{}}function E(v){var D=0;return v.name&&(D+=v.name.length),v.clientId&&(D+=v.clientId.length),v.extras&&(D+=JSON.stringify(v.extras).length),v.data&&(D+=m.dataSizeBytes(v.data)),D}var O=(function(){function v(){}return v.prototype.toJSON=function(){var D=this.encoding,L=this.data;return L&&c.default.BufferUtils.isBuffer(L)&&(arguments.length>0?(D=D?D+"/base64":"base64",L=c.default.BufferUtils.base64Encode(L)):L=c.default.BufferUtils.toBuffer(L)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:D,data:L}},v.prototype.toString=function(){var D="[Message";return this.name&&(D+="; name="+this.name),this.id&&(D+="; id="+this.id),this.timestamp&&(D+="; timestamp="+this.timestamp),this.clientId&&(D+="; clientId="+this.clientId),this.connectionId&&(D+="; connectionId="+this.connectionId),this.encoding&&(D+="; encoding="+this.encoding),this.extras&&(D+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?D+="; data="+this.data:c.default.BufferUtils.isBuffer(this.data)?D+="; data (buffer)="+c.default.BufferUtils.base64Encode(this.data):D+="; data (json)="+JSON.stringify(this.data)),this.extras&&(D+="; extras="+JSON.stringify(this.extras)),D+="]",D},v.encrypt=function(D,L,z){var M=D.data,N=D.encoding,G=L.channelCipher;N=N?N+"/":"",c.default.BufferUtils.isBuffer(M)||(M=c.default.BufferUtils.utf8Encode(String(M)),N=N+"utf-8/"),G.encrypt(M,function(R,A){if(R){z(R);return}D.data=A,D.encoding=N+"cipher+"+G.algorithm,z(null,D)})},v.encode=function(D,L,z){var M=D.data,N=typeof M=="string"||c.default.BufferUtils.isBuffer(M)||M===null||M===void 0;if(!N)if(m.isObject(M)||m.isArray(M))D.data=JSON.stringify(M),D.encoding=D.encoding?D.encoding+"/json":"json";else throw new g.default("Data type is unsupported",40013,400);L!=null&&L.cipher?v.encrypt(D,L,z):z(null,D)},v.encodeArray=function(D,L,z){for(var M=0,N=0;N<D.length;N++)v.encode(D[N],L,function(G){if(G){z(G);return}M++,M==D.length&&z(null,D)})},v.decode=function(D,L){var z=_(L),M=D.data,N=D.encoding;if(N){var G=N.split("/"),R=void 0,A=G.length,T=D.data,y="";try{for(;(R=A)>0;){var B=G[--A].match(/([-\w]+)(\+([\w-]+))?/);if(!B)break;switch(y=B[1],y){case"base64":T=c.default.BufferUtils.base64Decode(String(T)),R==G.length&&(M=T);continue;case"utf-8":T=c.default.BufferUtils.utf8Decode(T);continue;case"json":T=JSON.parse(T);continue;case"cipher":if(z.channelOptions!=null&&z.channelOptions.cipher&&z.channelOptions.channelCipher){var j=B[3],H=z.channelOptions.channelCipher;if(j!=H.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");T=H.decrypt(T);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!z.plugins||!z.plugins.vcdiff)throw new g.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new g.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var Q=z.baseEncodedPreviousPayload;typeof Q=="string"&&(Q=c.default.BufferUtils.utf8Encode(Q)),Q=c.default.BufferUtils.toBuffer(Q),T=c.default.BufferUtils.toBuffer(T),T=c.default.BufferUtils.typedArrayToBuffer(z.plugins.vcdiff.decode(T,Q)),M=T}catch(X){throw new g.default("Vcdiff delta decode failed with "+X,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(X){var K=X;throw new g.default("Error processing the "+y+" encoding, decoder returned "+K.message+"",K.code||40013,400)}finally{D.encoding=R<=0?null:G.slice(0,R).join("/"),D.data=T}}z.baseEncodedPreviousPayload=M},v.fromResponseBody=function(D,L,z){z&&(D=m.decodeBody(D,z));for(var M=0;M<D.length;M++){var N=D[M]=v.fromValues(D[M]);try{v.decode(N,L)}catch(G){d.default.logAction(d.default.LOG_ERROR,"Message.fromResponseBody()",G.toString())}}return D},v.fromValues=function(D){return Object.assign(new v,D)},v.fromValuesArray=function(D){for(var L=D.length,z=new Array(L),M=0;M<L;M++)z[M]=v.fromValues(D[M]);return z},v.fromEncoded=function(D,L){var z=v.fromValues(D),M=C(L??null);try{v.decode(z,M)}catch(N){d.default.logAction(d.default.LOG_ERROR,"Message.fromEncoded()",N.toString())}return z},v.fromEncodedArray=function(D,L){return D.map(function(z){return v.fromEncoded(z,L)})},v.getMessagesSize=function(D){for(var L,z=0,M=0;M<D.length;M++)L=D[M],z+=L.size||(L.size=E(L));return z},v.serialize=m.encodeBody,v})();i.default=O}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(4)),g=l.__importDefault(r(9)),m=l.__importDefault(r(16)),_={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(_).forEach(function(z){C[_[z]]=z});var E={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},O=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function v(z){var M=[];if(z)for(var N=0;N<z.length;N++)M.push(z[N].toString());return"[ "+M.join(", ")+" ]"}var D="id channel channelSerial connectionId count msgSerial timestamp".split(" "),L=(function(){function z(){var M=this;this.hasFlag=function(N){return(M.flags&E[N])>0}}return z.prototype.setFlag=function(M){return this.flags=this.flags|E[M]},z.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},z.prototype.encodeModesToFlags=function(M){var N=this;M.forEach(function(G){return N.setFlag(G)})},z.prototype.decodeModesFromFlags=function(){var M=this,N=[];return z.channelModes.forEach(function(G){M.hasFlag(G)&&N.push(G)}),N.length>0?N:void 0},z.fromValues=function(M){return Object.assign(new z,M)},z.Action=_,z.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],z.ActionName=C,z.serialize=c.encodeBody,z.deserialize=function(M,N){var G=c.decodeBody(M,N);return z.fromDeserialized(G)},z.fromDeserialized=function(M){var N=M.error;N&&(M.error=d.default.fromValues(N));var G=M.messages;if(G)for(var R=0;R<G.length;R++)G[R]=g.default.fromValues(G[R]);var A=M.presence;if(A)for(var R=0;R<A.length;R++)A[R]=m.default.fromValues(A[R],!0);return Object.assign(new z,M)},z.stringify=function(M){var N="[ProtocolMessage";M.action!==void 0&&(N+="; action="+z.ActionName[M.action]||!1);for(var G,R=0;R<D.length;R++)G=D[R],M[G]!==void 0&&(N+="; "+G+"="+M[G]);if(M.messages&&(N+="; messages="+v(g.default.fromValuesArray(M.messages))),M.presence&&(N+="; presence="+v(m.default.fromValuesArray(M.presence))),M.error&&(N+="; error="+d.default.fromValues(M.error).toString()),M.auth&&M.auth.accessToken&&(N+="; token="+M.auth.accessToken),M.flags&&(N+="; flags="+O.filter(M.hasFlag).join(",")),M.params){var A="";c.forInOwnNonNullProperties(M.params,function(T){A.length>0&&(A+="; "),A+=T+"="+M.params[T]}),A.length>0&&(N+="; params=["+A+"]")}return N+="]",N},z})();i.default=L}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=c.enc;m.Base64={stringify:function(C){var E=C.words,O=C.sigBytes,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var D=[],L=0;L<O;L+=3)for(var z=E[L>>>2]>>>24-L%4*8&255,M=E[L+1>>>2]>>>24-(L+1)%4*8&255,N=E[L+2>>>2]>>>24-(L+2)%4*8&255,G=z<<16|M<<8|N,R=0;R<4&&L+R*.75<O;R++)D.push(v.charAt(G>>>6*(3-R)&63));var A=v.charAt(64);if(A)for(;D.length%4;)D.push(A);return D.join("")},parse:function(C){var E=C.length,O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var D=0;D<O.length;D++)v[O.charCodeAt(D)]=D}var L=O.charAt(64);if(L){var z=C.indexOf(L);z!==-1&&(E=z)}return _(C,E,v)}};function _(C,E,O){for(var v=[],D=0,L=0;L<E;L++)if(L%4){var z=O[C.charCodeAt(L-1)]<<L%4*2,M=O[C.charCodeAt(L)]>>>6-L%4*2,N=z|M;v[D>>>2]|=N<<24-D%4*8,D++}return g.create(v,D)}})(),l.enc.Base64})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(10)),g=l.__importDefault(r(26)),m=l.__importDefault(r(2)),_=l.__importDefault(r(8)),C=l.__importDefault(r(21)),E=l.__importDefault(r(18)),O=l.__importDefault(r(4)),v=l.__importDefault(r(22)),D=l.__importDefault(r(3));function L(N){var G=[80015,80017,80030];return N.code?E.default.isTokenErr(N)?!1:c.arrIn(G,N.code)?!0:N.code>=4e4&&N.code<5e4:!1}function z(N){return L(N)?[d.default.fromValues({action:d.default.Action.ERROR,error:N})]:[d.default.fromValues({action:d.default.Action.DISCONNECTED,error:N})]}var M=(function(N){l.__extends(G,N);function G(R,A,T){var y=N.call(this,R,A,T,!0)||this;return y.onAuthUpdated=function(B){y.authParams={access_token:B.token}},y.stream="stream"in T?T.stream:!0,y.sendRequest=null,y.recvRequest=null,y.pendingCallback=null,y.pendingItems=null,y}return G.prototype.connect=function(){var R=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","starting"),g.default.prototype.connect.call(this);var A=this.params,T=A.options,y=_.default.getHost(T,A.host),B=_.default.getPort(T),j=T.tls?"https://":"http://";this.baseUri=j+y+":"+B+"/comet/";var H=this.baseUri+"connect";m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","uri: "+H),this.auth.getAuthParams(function(Q,K){if(Q){R.disconnect(Q);return}if(!R.isDisposed){R.authParams=K;var X=R.params.getConnectParams(K);"stream"in X&&(R.stream=X.stream),m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+c.toQueryString(X));var V=!1,U=R.recvRequest=R.createRequest(H,null,X,null,R.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV);U.on("data",function(I){R.recvRequest&&(V||(V=!0,R.emit("preconnect")),R.onData(I))}),U.on("complete",function(I){if(R.recvRequest||(I=I||new O.default("Request cancelled",80003,400)),R.recvRequest=null,!V&&!I&&(V=!0,R.emit("preconnect")),R.onActivity(),I){I.code?R.onData(z(I)):R.disconnect(I);return}D.default.Config.nextTick(function(){R.recv()})}),U.exec()}})},G.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},G.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},G.prototype._requestCloseOrDisconnect=function(R){var A=this,T=R?this.closeUri:this.disconnectUri;if(T){var y=this.createRequest(T,null,this.authParams,null,v.default.REQ_SEND);y.on("complete",function(B){B&&(m.default.logAction(m.default.LOG_ERROR,"CometTransport.request"+(R?"Close()":"Disconnect()"),"request returned err = "+c.inspectError(B)),A.finish("disconnected",B))}),y.exec()}},G.prototype.dispose=function(){var R=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),D.default.Config.nextTick(function(){R.emit("disposed")}))},G.prototype.onConnect=function(R){var A;if(!this.isDisposed){var T=(A=R.connectionDetails)===null||A===void 0?void 0:A.connectionKey;g.default.prototype.onConnect.call(this,R);var y=this.baseUri+T;m.default.logAction(m.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+y),this.sendUri=y+"/send",this.recvUri=y+"/recv",this.closeUri=y+"/close",this.disconnectUri=y+"/disconnect"}},G.prototype.send=function(R){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(R);return}var A=this.pendingItems||[];A.push(R),this.pendingItems=null,this.sendItems(A)},G.prototype.sendAnyPending=function(){var R=this.pendingItems;R&&(this.pendingItems=null,this.sendItems(R))},G.prototype.sendItems=function(R){var A=this,T=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(R),v.default.REQ_SEND);T.on("complete",function(y,B){if(y&&m.default.logAction(m.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+c.inspectError(y)),A.sendRequest=null,y){y.code?A.onData(z(y)):A.disconnect(y);return}B&&A.onData(B),A.pendingItems&&D.default.Config.nextTick(function(){A.sendRequest||A.sendAnyPending()})}),T.exec()},G.prototype.recv=function(){var R=this;if(!this.recvRequest&&this.isConnected){var A=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV_POLL);A.on("data",function(T){R.onData(T)}),A.on("complete",function(T){if(R.recvRequest=null,R.onActivity(),T){T.code?R.onData(z(T)):R.disconnect(T);return}D.default.Config.nextTick(function(){R.recv()})}),A.exec()}},G.prototype.onData=function(R){try{var A=this.decodeResponse(R);if(A&&A.length)for(var T=0;T<A.length;T++)this.onProtocolMessage(d.default.fromDeserialized(A[T]))}catch(y){m.default.logAction(m.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+y.stack)}},G.prototype.encodeRequest=function(R){return JSON.stringify(R)},G.prototype.decodeResponse=function(R){return typeof R=="string"?JSON.parse(R):R},G})(g.default);i.default=M}),(function(n,i){var r;r=(function(){return this})();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.isSuccessCode=void 0;var l;(function(d){d[d.Success=200]="Success",d[d.NoContent=204]="NoContent",d[d.BadRequest=400]="BadRequest",d[d.Unauthorized=401]="Unauthorized",d[d.Forbidden=403]="Forbidden",d[d.RequestTimeout=408]="RequestTimeout",d[d.InternalServerError=500]="InternalServerError"})(l||(l={}));function c(d){return d>=l.Success&&d<l.BadRequest}i.isSuccessCode=c,i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(18)),_=l.__importDefault(r(19)),C=r(4),E=l.__importDefault(r(14));function O(N,G,R,A,T){N.http.supportsAuthHeaders?N.auth.getAuthHeaders(function(y,B){y?A(y):T(d.mixin(B,G),R)}):N.auth.getAuthParams(function(y,B){y?A(y):T(G,d.mixin(B,R))})}function v(N,G){return function(R,A,T,y,B){if(R&&!A){N(R);return}if(B===E.default.NoContent){N(R,[],T,!0,B);return}if(!y)try{A=d.decodeBody(A,G)}catch(V){d.isErrorInfoOrPartialErrorInfo(V)?N(V):N(new C.PartialErrorInfo(d.inspectError(V),null));return}if(!A){N(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var j=A,H=j.statusCode,Q=j.response,K=j.headers;if(H===void 0){N(R,A,T,!0,B);return}if(H<200||H>=300){var X=Q&&Q.error||R;X||(X=new Error("Error in unenveloping "+A),X.statusCode=H),N(X,Q,K,!0,H);return}N(R,Q,K,!0,H)}}function D(N){var G=[];if(N)for(var R in N)G.push(R+"="+N[R]);return G.join("&")}function L(N,G){return N+(G?"?":"")+D(G)}function z(N,G,R,A){return function(T,y,B,j,H){T?g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received Error; "+L(R,A)+"; Error: "+d.inspectError(T)):g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received; "+L(R,A)+"; Headers: "+D(B)+"; StatusCode: "+H+"; Body: "+(c.default.BufferUtils.isBuffer(y)?y.toString():y)),N&&N(T,y,B,j,H)}}var M=(function(){function N(){}return N.get=function(G,R,A,T,y,B){N.do(_.default.Get,G,R,null,A,T,y,B)},N.delete=function(G,R,A,T,y,B){N.do(_.default.Delete,G,R,null,A,T,y,B)},N.post=function(G,R,A,T,y,B,j){N.do(_.default.Post,G,R,A,T,y,B,j)},N.patch=function(G,R,A,T,y,B,j){N.do(_.default.Patch,G,R,A,T,y,B,j)},N.put=function(G,R,A,T,y,B,j){N.do(_.default.Put,G,R,A,T,y,B,j)},N.do=function(G,R,A,T,y,B,j,H){g.default.shouldLog(g.default.LOG_MICRO)&&(H=z(H,G,A,B)),j&&(H=H&&v(H,j),(B=B||{}).envelope=j);function Q(K,X){var V;if(g.default.shouldLog(g.default.LOG_MICRO)&&g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+L(A,X)),g.default.shouldLog(g.default.LOG_MICRO)){var U=T;if(((V=K["content-type"])===null||V===void 0?void 0:V.indexOf("msgpack"))>0)try{U=c.default.Config.msgpack.decode(T)}catch(I){g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending MsgPack Decoding Error: "+d.inspectError(I))}g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+L(A,X)+"; Body: "+U)}R.http.do(G,R,A,K,T,X,function(I,F,W,at,Z){if(I&&m.default.isTokenErr(I)){R.auth.authorize(null,null,function(rt){if(rt){H(rt);return}O(R,K,X,H,Q)});return}H(I,F,W,at,Z)})}O(R,y,B,H,Q)},N})();i.default=M}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=l.__importDefault(r(3)),g=l.__importDefault(r(9)),m=l.__importStar(r(1));function _(E){return C.Actions.indexOf(E)}var C=(function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var O=this.id.split(":");return{connectionId:O[0],msgSerial:parseInt(O[1],10),index:parseInt(O[2],10)}},E.prototype.toJSON=function(){var O=this.data,v=this.encoding;return O&&d.default.BufferUtils.isBuffer(O)&&(arguments.length>0?(v=v?v+"/base64":"base64",O=d.default.BufferUtils.base64Encode(O)):O=d.default.BufferUtils.toBuffer(O)),{id:this.id,clientId:this.clientId,action:_(this.action),data:O,encoding:v,extras:this.extras}},E.prototype.toString=function(){var O="[PresenceMessage";return O+="; action="+this.action,this.id&&(O+="; id="+this.id),this.timestamp&&(O+="; timestamp="+this.timestamp),this.clientId&&(O+="; clientId="+this.clientId),this.connectionId&&(O+="; connectionId="+this.connectionId),this.encoding&&(O+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?O+="; data="+this.data:d.default.BufferUtils.isBuffer(this.data)?O+="; data (buffer)="+d.default.BufferUtils.base64Encode(this.data):O+="; data (json)="+JSON.stringify(this.data)),this.extras&&(O+="; extras="+JSON.stringify(this.extras)),O+="]",O},E.fromResponseBody=function(O,v,D){var L=[];D&&(O=m.decodeBody(O,D));for(var z=0;z<O.length;z++){var M=L[z]=E.fromValues(O[z],!0);try{E.decode(M,v)}catch(N){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",N.toString())}}return L},E.fromValues=function(O,v){return v&&(O.action=E.Actions[O.action]),Object.assign(new E,O)},E.fromValuesArray=function(O){for(var v=O.length,D=new Array(v),L=0;L<v;L++)D[L]=E.fromValues(O[L]);return D},E.fromEncoded=function(O,v){var D=E.fromValues(O,!0);try{E.decode(D,v??{})}catch(L){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromEncoded()",L.toString())}return D},E.fromEncodedArray=function(O,v){return O.map(function(D){return E.fromEncoded(D,v)})},E.fromData=function(O){return O instanceof E?O:E.fromValues({data:O})},E.Actions=["absent","present","enter","leave","update"],E.encode=g.default.encode,E.decode=g.default.decode,E.getMessagesSize=g.default.getMessagesSize,E})();i.default=C}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var c=r(0),d=c.__importStar(r(1)),g=c.__importDefault(r(7)),m=c.__importStar(r(4)),_=c.__importDefault(r(2)),C=c.__importDefault(r(8)),E=c.__importDefault(r(22)),O=c.__importDefault(r(3));function v(j,H){return d.arrIn(d.allToLowerCase(d.keysArray(H)),"x-ably-errorcode")}function D(j,H){if(v(j,H))return j.error&&m.default.fromValues(j.error)}var L=function(){},z=0,M={},N=typeof l<"u"&&l.XDomainRequest;function G(){var j=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return j&&Number(j[1])}function R(){var j;return N&&(j=G())&&j===10}function A(j,H){return j.getResponseHeader&&j.getResponseHeader(H)}function T(j){return j.getResponseHeader&&(j.getResponseHeader("transfer-encoding")||!j.getResponseHeader("content-length"))}function y(j){for(var H=d.trim(j.getAllResponseHeaders()).split(`\r
`),Q={},K=0;K<H.length;K++){var X=H[K].split(":").map(d.trim);Q[X[0].toLowerCase()]=X[1]}return Q}var B=(function(j){c.__extends(H,j);function H(Q,K,X,V,U,I,F){var W=j.call(this)||this;return X=X||{},X.rnd=d.cheapRandStr(),R()&&!X.envelope&&(X.envelope="json"),W.uri=Q+d.toQueryString(X),W.headers=K||{},W.body=V,W.method=F?F.toUpperCase():d.isEmptyArg(V)?"GET":"POST",W.requestMode=U,W.timeouts=I,W.timedOut=!1,W.requestComplete=!1,W.id=String(++z),M[W.id]=W,W}return H.createRequest=function(Q,K,X,V,U,I,F){var W=I||C.default.TIMEOUTS;return new H(Q,K,d.copy(X),V,U,W,F)},H.prototype.complete=function(Q,K,X,V,U){this.requestComplete||(this.requestComplete=!0,!Q&&K&&this.emit("data",K),this.emit("complete",Q,K,X,V,U),this.dispose())},H.prototype.abort=function(){this.dispose()},H.prototype.exec=function(){var Q=this,K=this.headers,X=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,V=this.timer=setTimeout(function(){Q.timedOut=!0,I.abort()},X),U=this.method,I=this.xhr=new XMLHttpRequest,F=K.accept,W=this.body,at="text";if(F?F.indexOf("application/x-msgpack")===0&&(at="arraybuffer"):K.accept="application/json",W){var Z=K["content-type"]||(K["content-type"]="application/json");Z.indexOf("application/json")>-1&&typeof W!="string"&&(W=JSON.stringify(W))}I.open(U,this.uri,!0),I.responseType=at,"authorization"in K&&(I.withCredentials=!0);for(var rt in K)I.setRequestHeader(rt,K[rt]);var it=function(kt,ye,_e,Xe){var xt,Xt=ye+" (event type: "+kt.type+")";!((xt=Q==null?void 0:Q.xhr)===null||xt===void 0)&&xt.statusText&&(Xt+=", current statusText is "+Q.xhr.statusText),_.default.logAction(_.default.LOG_ERROR,"Request.on"+kt.type+"()",Xt),Q.complete(new m.PartialErrorInfo(Xt,_e,Xe))};I.onerror=function(kt){it(kt,"XHR error occurred",null,400)},I.onabort=function(kt){Q.timedOut?it(kt,"Request aborted due to request timeout expiring",null,408):it(kt,"Request cancelled",null,400)},I.ontimeout=function(kt){it(kt,"Request timed out",null,408)};var Y,J,tt,et=0,gt=!1,At=function(){if(clearTimeout(V),tt=J<400,J==204){Q.complete(null,null,null,null,J);return}Y=Q.requestMode==E.default.REQ_RECV_STREAM&&tt&&T(I)},Dt=function(){var kt;try{var ye=A(I,"content-type"),_e=ye?ye.indexOf("application/json")>=0:I.responseType=="text";if(_e){var Xe=I.responseType==="arraybuffer"?O.default.BufferUtils.utf8Decode(I.response):String(I.responseText);Xe.length?kt=JSON.parse(Xe):kt=Xe,gt=!0}else kt=I.response;kt.response!==void 0?(J=kt.statusCode,tt=J<400,K=kt.headers,kt=kt.response):K=y(I)}catch(Xt){Q.complete(new m.PartialErrorInfo("Malformed response body from server: "+Xt.message,null,400));return}if(tt||d.isArray(kt)){Q.complete(null,kt,K,gt,J);return}var xt=D(kt,K);xt||(xt=new m.PartialErrorInfo("Error response received from server: "+J+" body was: "+O.default.Config.inspect(kt),null,J)),Q.complete(xt,kt,K,gt,J)};function Qt(){for(var kt=I.responseText,ye=kt.length-1,_e,Xe;et<ye&&(_e=kt.indexOf(`
`,et))>-1;)Xe=kt.slice(et,_e),et=_e+1,ee(Xe)}var ee=function(kt){try{kt=JSON.parse(kt)}catch(ye){Q.complete(new m.PartialErrorInfo("Malformed response body from server: "+ye.message,null,400));return}Q.emit("data",kt)},le=function(){Qt(),Q.streamComplete=!0,O.default.Config.nextTick(function(){Q.complete()})};I.onreadystatechange=function(){var kt=I.readyState;kt<3||I.status!==0&&(J===void 0&&(J=I.status,J===1223&&(J=204),At()),kt==3&&Y?Qt():kt==4&&(Y?le():Dt()))},I.send(W)},H.prototype.dispose=function(){var Q=this.xhr;if(Q){Q.onreadystatechange=Q.onerror=Q.onabort=Q.ontimeout=L,this.xhr=null;var K=this.timer;K&&(clearTimeout(K),this.timer=null),this.requestComplete||Q.abort()}delete M[this.id]},H})(g.default);i.default=B}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=l.__importStar(r(1)),g=l.__importDefault(r(24)),m=l.__importDefault(r(4)),_=l.__importDefault(r(45)),C=r(11),E=l.__importDefault(r(19)),O=l.__importDefault(r(14)),v=l.__importDefault(r(3)),D=l.__importDefault(r(15)),L=Math.pow(2,17);function z(){}function M(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function N(X){return!!X.connection}function G(X){return d.isErrorInfoOrPartialErrorInfo(X)?(X.code||(X.statusCode===403?X.code=40300:(X.code=40170,X.statusCode=401)),X):new m.default(d.inspectError(X),X.code||40170,X.statusCode||401)}var R=function(X,V){if(v.default.Config.createHmac){var U=v.default.Config.createHmac("SHA256",V);return U.update(X),U.digest("base64")}return(0,C.stringify)((0,_.default)(X,V))};function A(X){if(!X)return"";typeof X=="string"&&(X=JSON.parse(X));var V=Object.create(null),U=d.keysArray(X,!0);if(!U)return"";U.sort();for(var I=0;I<U.length;I++)V[U[I]]=X[U[I]].sort();return JSON.stringify(V)}function T(X){if(X.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(X.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(X.key)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(X.tokenDetails)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var V="authOptions must include valid authentication parameters";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",V),new Error(V)}}function y(X){return"useTokenAuth"in X&&!X.useTokenAuth}function B(X){return X.useTokenAuth||!y(X)&&(X.authCallback||X.authUrl||X.token||X.tokenDetails)}function j(X){return!X.key&&!X.authCallback&&!X.authUrl}var H=0;function Q(){return H++}var K=(function(){function X(V,U){if(this.authOptions={},this.client=V,this.tokenParams=U.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,B(U)){if(U.key&&!R){var I="client-side token request signing not supported";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",I),new Error(I)}j(U)&&c.default.logAction(c.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(U.defaultTokenParams,U),T(this.authOptions)}else{if(!U.key){var I="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",I),new m.default(I,40160,401)}c.default.logAction(c.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(U)}}return X.prototype.authorize=function(V,U,I){var F=this,W;if(typeof V=="function"&&!I?(I=V,W=V=null):typeof U=="function"&&!I?(I=U,W=null):W=U,!I&&this.client.options.promises)return d.promisify(this,"authorize",arguments);if(W&&W.key&&this.authOptions.key!==W.key)throw new m.default("Unable to update auth options with incompatible key",40102,401);W&&"force"in W&&(c.default.deprecated("The `force` auth option","If youre using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the librarys stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if youre currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),d.isOnlyPropIn(W,"force")&&(W=null)),this._forceNewToken(V,W,function(at,Z){if(at){F.client.connection&&at.statusCode===O.default.Forbidden&&F.client.connection.connectionManager.actOnErrorFromAuthorize(at),I==null||I(at);return}N(F.client)?F.client.connection.connectionManager.onAuthUpdated(Z,I||z):I==null||I(null,Z)})},X.prototype.authorise=function(V,U,I){c.default.renamedMethod("Auth","authorise","authorize"),this.authorize(V,U,I)},X.prototype._forceNewToken=function(V,U,I){var F=this;this.tokenDetails=null,this._saveTokenOptions(V,U),T(this.authOptions),this._ensureValidAuthCredentials(!0,function(W,at){delete F.tokenParams.timestamp,delete F.authOptions.queryTime,I(W,at)})},X.prototype.requestToken=function(V,U,I){var F=this;if(typeof V=="function"&&!I?(I=V,U=V=null):typeof U=="function"&&!I&&(I=U,U=null),!I&&this.client.options.promises)return d.promisify(this,"requestToken",arguments);U=U||this.authOptions,V=V||d.copy(this.tokenParams);var W=I||z,at,Z=this.client;if(U.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),at=U.authCallback;else if(U.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),at=function(et,gt){var At=d.mixin({accept:"application/json, text/plain"},U.authHeaders),Dt=U.authMethod&&U.authMethod.toLowerCase()==="post",Qt,ee=U.authUrl.indexOf("?");ee>-1&&(Qt=d.parseQueryString(U.authUrl.slice(ee)),U.authUrl=U.authUrl.slice(0,ee),Dt||(U.authParams=d.mixin(Qt,U.authParams)));var le=d.mixin({},U.authParams||{},et),kt=function(Xe,xt,Xt,Ue){var ae;if(Xe?c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+d.inspectError(Xe)):(ae=Xt["content-type"],c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+ae+"; body: "+d.inspectBody(xt))),Xe||Ue)return gt(Xe,xt);if(v.default.BufferUtils.isBuffer(xt)&&(xt=xt.toString()),!ae){gt(new m.default("authUrl response is missing a content-type header",40170,401));return}var ge=ae.indexOf("application/json")>-1,Fe=ae.indexOf("text/plain")>-1||ae.indexOf("application/jwt")>-1;if(!ge&&!Fe){gt(new m.default("authUrl responded with unacceptable content-type "+ae+", should be either text/plain, application/jwt or application/json",40170,401));return}if(ge){if(xt.length>L){gt(new m.default("authUrl response exceeded max permitted length",40170,401));return}try{xt=JSON.parse(xt)}catch(Me){gt(new m.default("Unexpected error processing authURL response; err = "+Me.message,40170,401));return}}gt(null,xt,ae)};if(c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+U.authUrl+"; Params: "+JSON.stringify(le)+"; method: "+(Dt?"POST":"GET")),Dt){var ye=At||{};ye["content-type"]="application/x-www-form-urlencoded";var _e=d.toQueryString(le).slice(1);F.client.http.doUri(E.default.Post,Z,U.authUrl,ye,_e,Qt,kt)}else F.client.http.doUri(E.default.Get,Z,U.authUrl,At||{},null,le,kt)};else if(U.key)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),at=function(et,gt){F.createTokenRequest(et,U,gt)};else{var rt="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";c.default.logAction(c.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),W(new m.default(rt,40171,403));return}"capability"in V&&(V.capability=A(V.capability));var it=function(et,gt){var At=et.keyName,Dt="/keys/"+At+"/requestToken",Qt=function(le){return Z.baseUri(le)+Dt},ee=d.defaultPostHeaders(F.client.options);U.requestHeaders&&d.mixin(ee,U.requestHeaders),c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+Dt+"; Token params: "+JSON.stringify(et)),F.client.http.do(E.default.Post,Z,Qt,ee,JSON.stringify(et),null,gt)},Y=!1,J=this.client.options.timeouts.realtimeRequestTimeout,tt=setTimeout(function(){Y=!0;var et="Token request callback timed out after "+J/1e3+" seconds";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",et),W(new m.default(et,40170,401))},J);at(V,function(et,gt,At){if(!Y){if(clearTimeout(tt),et){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+d.inspectError(et)),W(G(et));return}if(typeof gt=="string"){gt.length===0?W(new m.default("Token string is empty",40170,401)):gt.length>L?W(new m.default("Token string exceeded max permitted length (was "+gt.length+" bytes)",40170,401)):gt==="undefined"||gt==="null"?W(new m.default("Token string was literal null/undefined",40170,401)):gt[0]==="{"&&!(At&&At.indexOf("application/jwt")>-1)?W(new m.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):W(null,{token:gt});return}if(typeof gt!="object"){var Dt="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof gt;c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",Dt),W(new m.default(Dt,40170,401));return}var Qt=JSON.stringify(gt).length;if(Qt>L&&!U.suppressMaxLengthCheck){W(new m.default("Token request/details object exceeded max permitted stringified size (was "+Qt+" bytes)",40170,401));return}if("issued"in gt){W(null,gt);return}if(!("keyName"in gt)){var Dt="Expected token request callback to call back with a token string, token request object, or token details object";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",Dt),W(new m.default(Dt,40170,401));return}it(gt,function(ee,le,kt,ye){if(ee){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+d.inspectError(ee)),W(G(ee));return}ye||(le=JSON.parse(le)),c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","token received"),W(null,le)})}})},X.prototype.createTokenRequest=function(V,U,I){var F=this;if(typeof V=="function"&&!I?(I=V,U=V=null):typeof U=="function"&&!I&&(I=U,U=null),!I&&this.client.options.promises)return d.promisify(this,"createTokenRequest",arguments);U=U||this.authOptions,V=V||d.copy(this.tokenParams);var W=U.key;if(!W){I(new m.default("No key specified",40101,403));return}var at=W.split(":"),Z=at[0],rt=at[1];if(!rt){I(new m.default("Invalid key specified",40101,403));return}if(V.clientId===""){I(new m.default("clientId cant be an empty string",40012,400));return}"capability"in V&&(V.capability=A(V.capability));var it=d.mixin({keyName:Z},V),Y=V.clientId||"",J=V.ttl||"",tt=V.capability||"";(function(et){if(it.timestamp){et();return}F.getTimestamp(U&&U.queryTime,function(gt,At){if(gt){I(gt);return}it.timestamp=At,et()})})(function(){var et=it.nonce||(it.nonce=M()),gt=it.timestamp,At=it.keyName+`
`+J+`
`+tt+`
`+Y+`
`+gt+`
`+et+`
`;it.mac=it.mac||R(At,rt),c.default.logAction(c.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),I(null,it)})},X.prototype.getAuthParams=function(V){this.method=="basic"?V(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(U,I){if(U){V(U);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{access_token:I.token})})},X.prototype.getAuthHeaders=function(V){this.method=="basic"?V(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(U,I){if(U){V(U);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{authorization:"Bearer "+d.toBase64(I.token)})})},X.prototype.getTimestamp=function(V,U){!this.isTimeOffsetSet()&&(V||this.authOptions.queryTime)?this.client.time(U):U(null,this.getTimestampUsingOffset())},X.prototype.getTimestampUsingOffset=function(){return d.now()+(this.client.serverTimeOffset||0)},X.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},X.prototype._saveBasicOptions=function(V){this.method="basic",this.key=V.key,this.basicKey=d.toBase64(V.key),this.authOptions=V||{},"clientId"in V&&this._userSetClientId(V.clientId)},X.prototype._saveTokenOptions=function(V,U){this.method="token",V&&(this.tokenParams=V),U&&(U.token&&(U.tokenDetails=typeof U.token=="string"?{token:U.token}:U.token),U.tokenDetails&&(this.tokenDetails=U.tokenDetails),"clientId"in U&&this._userSetClientId(U.clientId),this.authOptions=U)},X.prototype._ensureValidAuthCredentials=function(V,U){var I=this,F=this.tokenDetails;if(F){if(this._tokenClientIdMismatch(F.clientId)){U(new m.default("Mismatch between clientId in token ("+F.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!F.expires||F.expires>=this.getTimestampUsingOffset()){c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+F.expires),U(null,F);return}c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=g.default.create())).push(U),!(this.currentTokenRequestId!==null&&!V)){var W=this.currentTokenRequestId=Q();this.requestToken(this.tokenParams,this.authOptions,function(at,Z){if(I.currentTokenRequestId>W){c.default.logAction(c.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}I.currentTokenRequestId=null;var rt=I.waitingForTokenRequest||z;if(I.waitingForTokenRequest=null,at){rt(at);return}rt(null,I.tokenDetails=Z)})}},X.prototype._userSetClientId=function(V){if(typeof V=="string"||V===null){if(V==="*")throw new m.default('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var U=this._uncheckedSetClientId(V);if(U)throw U}else throw new m.default("clientId must be either a string or null",40012,400)},X.prototype._uncheckedSetClientId=function(V){if(this._tokenClientIdMismatch(V)){var U="Unexpected clientId mismatch: client has "+this.clientId+", requested "+V,I=new m.default(U,40102,401);return c.default.logAction(c.default.LOG_ERROR,"Auth._uncheckedSetClientId()",U),I}else return this.clientId=this.tokenParams.clientId=V,null},X.prototype._tokenClientIdMismatch=function(V){return!!(this.clientId&&this.clientId!=="*"&&V&&V!=="*"&&this.clientId!==V)},X.isTokenErr=function(V){return V.code&&V.code>=40140&&V.code<40150},X.prototype.revokeTokens=function(V,U,I){if(B(this.client.options))throw new m.default("Cannot revoke tokens when using token auth",40162,401);var F=this.client.options.keyName,W;if(typeof U=="function"?(I=U,W={}):W=U??{},I===void 0){if(this.client.options.promises)return d.promisify(this,"revokeTokens",[V,W]);I=z}var at=I,Z=l.__assign({targets:V.map(function(J){return"".concat(J.type,":").concat(J.value)})},W),rt=this.client.options.useBinaryProtocol?d.Format.msgpack:d.Format.json,it=d.defaultPostHeaders(this.client.options,rt);this.client.options.headers&&d.mixin(it,this.client.options.headers);var Y=d.encodeBody(Z,rt);D.default.post(this.client,"/keys/".concat(F,"/revokeTokens"),Y,it,{newBatchResponse:"true"},null,function(J,tt,et,gt){if(J){at(J);return}var At=gt?tt:d.decodeBody(tt,rt);at(null,At)})},X})();i.default=K}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(c){c.Get="get",c.Delete="delete",c.Post="post",c.Put="put",c.Patch="patch"})(l||(l={})),i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.HttpPaginatedResponse=i.PaginatedResult=void 0;var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(15)),m=l.__importDefault(r(14));function _(L){var z=L.match(/^\.\/(\w+)\?(.*)$/);return z&&z[2]&&c.parseQueryString(z[2])}function C(L){typeof L=="string"&&(L=L.split(","));for(var z={},M=0;M<L.length;M++){var N=L[M].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(N){var G=_(N[1]);G&&(z[N[2]]=G)}}return z}function E(L,z,M){return!(M&&(z||typeof L.code=="number"))}var O=(function(){function L(z,M,N,G,R,A){this.rest=z,this.path=M,this.headers=N,this.envelope=G??null,this.bodyHandler=R,this.useHttpPaginatedResponse=A||!1}return L.prototype.get=function(z,M){var N=this;g.default.get(this.rest,this.path,this.headers,z,this.envelope,function(G,R,A,T,y){N.handlePage(G,R,A,T,y,M)})},L.prototype.delete=function(z,M){var N=this;g.default.delete(this.rest,this.path,this.headers,z,this.envelope,function(G,R,A,T,y){N.handlePage(G,R,A,T,y,M)})},L.prototype.post=function(z,M,N){var G=this;g.default.post(this.rest,this.path,M,this.headers,z,this.envelope,function(R,A,T,y,B){N&&G.handlePage(R,A,T,y,B,N)})},L.prototype.put=function(z,M,N){var G=this;g.default.put(this.rest,this.path,M,this.headers,z,this.envelope,function(R,A,T,y,B){N&&G.handlePage(R,A,T,y,B,N)})},L.prototype.patch=function(z,M,N){var G=this;g.default.patch(this.rest,this.path,M,this.headers,z,this.envelope,function(R,A,T,y,B){N&&G.handlePage(R,A,T,y,B,N)})},L.prototype.handlePage=function(z,M,N,G,R,A){if(z&&E(z,M,this.useHttpPaginatedResponse)){d.default.logAction(d.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+c.inspectError(z)),A==null||A(z);return}var T,y,B;try{T=R==m.default.NoContent?[]:this.bodyHandler(M,N||{},G)}catch(j){A==null||A(z||j);return}N&&(y=N.Link||N.link)&&(B=C(y)),this.useHttpPaginatedResponse?A(null,new D(this,T,N||{},R,B,z)):A(null,new v(this,T,B))},L})(),v=(function(){function L(z,M,N){var G=this;this.resource=z,this.items=M;var R=this;N&&("first"in N&&(this.first=function(A){if(!A&&R.resource.rest.options.promises)return c.promisify(R,"first",[]);R.get(N.first,A)}),"current"in N&&(this.current=function(A){if(!A&&R.resource.rest.options.promises)return c.promisify(R,"current",[]);R.get(N.current,A)}),this.next=function(A){if(!A&&R.resource.rest.options.promises)return c.promisify(R,"next",[]);"next"in N?R.get(N.next,A):A(null,null)},this.hasNext=function(){return"next"in N},this.isLast=function(){var A;return!(!((A=G.hasNext)===null||A===void 0)&&A.call(G))})}return L.prototype.get=function(z,M){var N=this.resource;g.default.get(N.rest,N.path,N.headers,z,N.envelope,function(G,R,A,T,y){N.handlePage(G,R,A,T,y,M)})},L})();i.PaginatedResult=v;var D=(function(L){l.__extends(z,L);function z(M,N,G,R,A,T){var y=L.call(this,M,N,A)||this;return y.statusCode=R,y.success=R<300&&R>=200,y.headers=G,y.errorCode=T&&T.code,y.errorMessage=T&&T.message,y}return z.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},z})(v);i.HttpPaginatedResponse=D,i.default=O}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.isRetriable=void 0;var l=r(0),c=l.__importDefault(r(4)),d={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},g={disconnected:function(){return c.default.fromValues({statusCode:400,code:d.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return c.default.fromValues({statusCode:400,code:d.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return c.default.fromValues({statusCode:400,code:d.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return c.default.fromValues({statusCode:400,code:d.CLOSING,message:"Connection closing"})},closed:function(){return c.default.fromValues({statusCode:400,code:d.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return c.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return c.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function m(_){return!_.statusCode||!_.code||_.statusCode>=500?!0:Object.values(d).includes(_.code)}i.isRetriable=m,i.default=g}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(c){c[c.REQ_SEND=0]="REQ_SEND",c[c.REQ_RECV=1]="REQ_RECV",c[c.REQ_RECV_POLL=2]="REQ_RECV_POLL",c[c.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(l||(l={})),i.default=l}),(function(n,i,r){(function(l,c){n.exports=c(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(l){return l})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=(function(){function g(m){this.members=m||[]}return g.prototype.call=function(){for(var m=[],_=0;_<arguments.length;_++)m[_]=arguments[_];for(var C=0,E=this.members;C<E.length;C++){var O=E[C];if(O)try{O.apply(void 0,m)}catch(v){c.default.logAction(c.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+v+"; stack = "+v.stack)}}},g.prototype.push=function(){for(var m,_=[],C=0;C<arguments.length;C++)_[C]=arguments[C];(m=this.members).push.apply(m,_)},g.create=function(m){var _=new g(m);return Object.assign(function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];return _.call.apply(_,C)},{push:function(C){return _.push(C)}})},g})();i.default=d}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){(function(){var c=l,d=c.lib,g=d.Base,m=c.enc,_=m.Utf8,C=c.algo;C.HMAC=g.extend({init:function(E,O){E=this._hasher=new E.init,typeof O=="string"&&(O=_.parse(O));var v=E.blockSize,D=v*4;O.sigBytes>D&&(O=E.finalize(O)),O.clamp();for(var L=this._oKey=O.clone(),z=this._iKey=O.clone(),M=L.words,N=z.words,G=0;G<v;G++)M[G]^=1549556828,N[G]^=909522486;L.sigBytes=z.sigBytes=D,this.reset()},reset:function(){var E=this._hasher;E.reset(),E.update(this._iKey)},update:function(E){return this._hasher.update(E),this},finalize:function(E){var O=this._hasher,v=O.finalize(E);O.reset();var D=O.finalize(this._oKey.clone().concat(v));return D}})})()})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(21)),C=l.__importDefault(r(4)),E=l.__importDefault(r(3)),O=c.default.Action,v=c.default.fromValues({action:O.CLOSE}),D=c.default.fromValues({action:O.DISCONNECT}),L=(function(z){l.__extends(M,z);function M(N,G,R,A){var T=z.call(this)||this;return A&&(R.format=void 0,R.heartbeats=!0),T.connectionManager=N,N.registerProposedTransport(T),T.auth=G,T.params=R,T.timeouts=R.options.timeouts,T.format=R.format,T.isConnected=!1,T.isFinished=!1,T.isDisposed=!1,T.maxIdleInterval=null,T.idleTimer=null,T.lastActivity=null,T}return M.prototype.connect=function(){},M.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",_.default.closed())},M.prototype.disconnect=function(N){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",N||_.default.disconnected())},M.prototype.fail=function(N){this.isConnected&&this.requestDisconnect(),this.finish("failed",N||_.default.failed())},M.prototype.finish=function(N,G){var R;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((R=this.idleTimer)!==null&&R!==void 0?R:void 0),this.idleTimer=null,this.emit(N,G),this.dispose())},M.prototype.onProtocolMessage=function(N){switch(m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+c.default.stringify(N)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),N.action){case O.HEARTBEAT:m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",N.id);break;case O.CONNECTED:this.onConnect(N),this.emit("connected",N.error,N.connectionId,N.connectionDetails,N);break;case O.CLOSED:this.onClose(N);break;case O.DISCONNECTED:this.onDisconnect(N);break;case O.ACK:this.emit("ack",N.msgSerial,N.count);break;case O.NACK:this.emit("nack",N.msgSerial,N.count,N.error);break;case O.SYNC:this.connectionManager.onChannelMessage(N,this);break;case O.ACTIVATE:break;case O.AUTH:this.auth.authorize(function(G){G&&m.default.logAction(m.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+d.inspectError(G))});break;case O.ERROR:if(m.default.logAction(m.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(N.error)+(N.channel?", channel: "+N.channel:"")),N.channel===void 0){this.onFatalError(N);break}this.connectionManager.onChannelMessage(N,this);break;default:this.connectionManager.onChannelMessage(N,this)}},M.prototype.onConnect=function(N){if(this.isConnected=!0,!N.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var G=N.connectionDetails.maxIdleInterval;G&&(this.maxIdleInterval=G+this.timeouts.realtimeRequestTimeout,this.onActivity())},M.prototype.onDisconnect=function(N){var G=N&&N.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onDisconnect()","err = "+d.inspectError(G)),this.finish("disconnected",G)},M.prototype.onFatalError=function(N){var G=N&&N.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onFatalError()","err = "+d.inspectError(G)),this.finish("failed",G)},M.prototype.onClose=function(N){var G=N&&N.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onClose()","err = "+d.inspectError(G)),this.finish("closed",G)},M.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestClose()",""),this.send(v)},M.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(D)},M.prototype.ping=function(N){var G={action:c.default.Action.HEARTBEAT};N&&(G.id=N),this.send(c.default.fromValues(G))},M.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},M.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=d.now(),this.setIdleTimer(this.maxIdleInterval+100))},M.prototype.setIdleTimer=function(N){var G=this;this.idleTimer||(this.idleTimer=setTimeout(function(){G.onIdleTimerExpire()},N))},M.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var N=d.now()-this.lastActivity,G=this.maxIdleInterval-N;if(G<=0){var R="No activity seen from realtime in "+N+"ms; assuming connection has dropped";m.default.logAction(m.default.LOG_ERROR,"Transport.onIdleTimerExpire()",R),this.disconnect(new C.default(R,80003,408))}else this.setIdleTimer(G+100)},M.tryConnect=function(N,G,R,A,T){var y=new N(G,R,A),B,j=function(Q){clearTimeout(B),T({event:this.event,error:Q})},H=G.options.timeouts.realtimeRequestTimeout;B=setTimeout(function(){y.off(["preconnect","disconnected","failed"]),y.dispose(),j.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},H),y.on(["failed","disconnected"],j),y.on("preconnect",function(){m.default.logAction(m.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+y),clearTimeout(B),y.off(["failed","disconnected"],j),T(null,y)}),y.connect()},M})(g.default);i.default=L}),(function(n,i,r){(function(l,c){n.exports=c(r(6),r(40),r(25))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.Base,m=d.WordArray,_=c.algo,C=_.MD5,E=_.EvpKDF=g.extend({cfg:g.extend({keySize:128/32,hasher:C,iterations:1}),init:function(O){this.cfg=this.cfg.extend(O)},compute:function(O,v){for(var D,L=this.cfg,z=L.hasher.create(),M=m.create(),N=M.words,G=L.keySize,R=L.iterations;N.length<G;){D&&z.update(D),D=z.update(O).finalize(v),z.reset();for(var A=1;A<R;A++)D=z.finalize(D),z.reset();M.concat(D)}return M.sigBytes=G*4,M}});c.EvpKDF=function(O,v,D){return E.create(D).compute(O,v)}})(),l.EvpKDF})}),(function(n,i,r){(function(l,c){n.exports=c(r(6),r(27))})(this,function(l){l.lib.Cipher||(function(c){var d=l,g=d.lib,m=g.Base,_=g.WordArray,C=g.BufferedBlockAlgorithm,E=d.enc;E.Utf8;var O=E.Base64,v=d.algo,D=v.EvpKDF,L=g.Cipher=C.extend({cfg:m.extend(),createEncryptor:function(K,X){return this.create(this._ENC_XFORM_MODE,K,X)},createDecryptor:function(K,X){return this.create(this._DEC_XFORM_MODE,K,X)},init:function(K,X,V){this.cfg=this.cfg.extend(V),this._xformMode=K,this._key=X,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(K){return this._append(K),this._process()},finalize:function(K){K&&this._append(K);var X=this._doFinalize();return X},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function K(X){return typeof X=="string"?Q:B}return function(X){return{encrypt:function(V,U,I){return K(U).encrypt(X,V,U,I)},decrypt:function(V,U,I){return K(U).decrypt(X,V,U,I)}}}})()});g.StreamCipher=L.extend({_doFinalize:function(){var K=this._process(!0);return K},blockSize:1});var z=d.mode={},M=g.BlockCipherMode=m.extend({createEncryptor:function(K,X){return this.Encryptor.create(K,X)},createDecryptor:function(K,X){return this.Decryptor.create(K,X)},init:function(K,X){this._cipher=K,this._iv=X}}),N=z.CBC=(function(){var K=M.extend();K.Encryptor=K.extend({processBlock:function(V,U){var I=this._cipher,F=I.blockSize;X.call(this,V,U,F),I.encryptBlock(V,U),this._prevBlock=V.slice(U,U+F)}}),K.Decryptor=K.extend({processBlock:function(V,U){var I=this._cipher,F=I.blockSize,W=V.slice(U,U+F);I.decryptBlock(V,U),X.call(this,V,U,F),this._prevBlock=W}});function X(V,U,I){var F,W=this._iv;W?(F=W,this._iv=c):F=this._prevBlock;for(var at=0;at<I;at++)V[U+at]^=F[at]}return K})(),G=d.pad={},R=G.Pkcs7={pad:function(K,X){for(var V=X*4,U=V-K.sigBytes%V,I=U<<24|U<<16|U<<8|U,F=[],W=0;W<U;W+=4)F.push(I);var at=_.create(F,U);K.concat(at)},unpad:function(K){var X=K.words[K.sigBytes-1>>>2]&255;K.sigBytes-=X}};g.BlockCipher=L.extend({cfg:L.cfg.extend({mode:N,padding:R}),reset:function(){var K;L.reset.call(this);var X=this.cfg,V=X.iv,U=X.mode;this._xformMode==this._ENC_XFORM_MODE?K=U.createEncryptor:(K=U.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==K?this._mode.init(this,V&&V.words):(this._mode=K.call(U,this,V&&V.words),this._mode.__creator=K)},_doProcessBlock:function(K,X){this._mode.processBlock(K,X)},_doFinalize:function(){var K,X=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(X.pad(this._data,this.blockSize),K=this._process(!0)):(K=this._process(!0),X.unpad(K)),K},blockSize:128/32});var A=g.CipherParams=m.extend({init:function(K){this.mixIn(K)},toString:function(K){return(K||this.formatter).stringify(this)}}),T=d.format={},y=T.OpenSSL={stringify:function(K){var X,V=K.ciphertext,U=K.salt;return U?X=_.create([1398893684,1701076831]).concat(U).concat(V):X=V,X.toString(O)},parse:function(K){var X,V=O.parse(K),U=V.words;return U[0]==1398893684&&U[1]==1701076831&&(X=_.create(U.slice(2,4)),U.splice(0,4),V.sigBytes-=16),A.create({ciphertext:V,salt:X})}},B=g.SerializableCipher=m.extend({cfg:m.extend({format:y}),encrypt:function(K,X,V,U){U=this.cfg.extend(U);var I=K.createEncryptor(V,U),F=I.finalize(X),W=I.cfg;return A.create({ciphertext:F,key:V,iv:W.iv,algorithm:K,mode:W.mode,padding:W.padding,blockSize:K.blockSize,formatter:U.format})},decrypt:function(K,X,V,U){U=this.cfg.extend(U),X=this._parse(X,U.format);var I=K.createDecryptor(V,U).finalize(X.ciphertext);return I},_parse:function(K,X){return typeof K=="string"?X.parse(K,this):K}}),j=d.kdf={},H=j.OpenSSL={execute:function(K,X,V,U){U||(U=_.random(64/8));var I=D.create({keySize:X+V}).compute(K,U),F=_.create(I.words.slice(X),V*4);return I.sigBytes=X*4,A.create({key:I,iv:F,salt:U})}},Q=g.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:H}),encrypt:function(K,X,V,U){U=this.cfg.extend(U);var I=U.kdf.execute(V,K.keySize,K.ivSize);U.iv=I.iv;var F=B.encrypt.call(this,K,X,I.key,U);return F.mixIn(I),F},decrypt:function(K,X,V,U){U=this.cfg.extend(U),X=this._parse(X,U.format);var I=U.kdf.execute(V,K.keySize,K.ivSize,X.salt);U.iv=I.iv;var F=B.decrypt.call(this,K,X,I.key,U);return F}})})()})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.Request=i.createRequest=void 0;var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(12)),g=l.__importDefault(r(3)),m=l.__importDefault(r(7)),_=r(4),C=l.__importDefault(r(8)),E=l.__importDefault(r(2)),O=l.__importDefault(r(22)),v=c.getGlobalObject(),D=function(){},L=v._ablyjs_jsonp={};L._=function(T){return L["_"+T]||D};var z=1,M="jsonp";function N(T,y,B,j,H,Q,K){return Q=Q||C.default.TIMEOUTS,new R(void 0,T,y,c.copy(B),j,H,Q,K)}i.createRequest=N;var G=(function(T){l.__extends(y,T);function y(B,j,H){var Q=T.call(this,B,j,H)||this;return Q.shortName=M,H.stream=!1,Q}return y.isAvailable=function(){return g.default.Config.jsonpSupported&&g.default.Config.allowComet},y.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},y.prototype.createRequest=function(B,j,H,Q,K,X,V){return X=(this===null||this===void 0?void 0:this.timeouts)||X||C.default.TIMEOUTS,N(B,j,H,Q,K,X,V)},y})(d.default),R=(function(T){l.__extends(y,T);function y(B,j,H,Q,K,X,V,U){var I=T.call(this)||this;return B===void 0&&(B=z++),I.id=B,I.uri=j,I.params=Q||{},I.params.rnd=c.cheapRandStr(),H&&(H["X-Ably-Version"]&&(I.params.v=H["X-Ably-Version"]),H["X-Ably-Lib"]&&(I.params.lib=H["X-Ably-Lib"])),I.body=K,I.method=U,I.requestMode=X,I.timeouts=V,I.requestComplete=!1,I}return y.prototype.exec=function(){var B=this,j=this.id,H=this.body,Q=this.method,K=this.uri,X=this.params;X.callback="_ablyjs_jsonp._("+j+")",X.envelope="jsonp",H&&(X.body=H),Q&&Q!=="get"&&(X.method=Q);var V=this.script=document.createElement("script"),U=K+c.toQueryString(X);V.src=U,V.src.split("/").slice(-1)[0]!==U.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),V.async=!0,V.type="text/javascript",V.charset="UTF-8",V.onerror=function(W){B.complete(new _.PartialErrorInfo("JSONP script error (event: "+g.default.Config.inspect(W)+")",null,400))},L["_"+j]=function(W){if(W.statusCode){var at=W.response;if(W.statusCode==204)B.complete(null,null,null,W.statusCode);else if(!at)B.complete(new _.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(W.statusCode<400||c.isArray(at))B.complete(null,at,W.headers,W.statusCode);else{var Z=at.error||new _.PartialErrorInfo("Error response received from server",null,W.statusCode);B.complete(Z)}}else B.complete(null,W)};var I=this.requestMode==O.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),I);var F=document.getElementsByTagName("head")[0];F.insertBefore(V,F.firstChild)},y.prototype.complete=function(B,j,H,Q){if(H=H||{},!this.requestComplete){this.requestComplete=!0;var K=void 0;j&&(K=typeof j=="string"?"text/plain":"application/json",H["content-type"]=K,this.emit("data",j)),this.emit("complete",B,j,H,!0,Q),this.dispose()}},y.prototype.abort=function(){this.dispose()},y.prototype.dispose=function(){var B=this.timer;B&&(clearTimeout(B),this.timer=null);var j=this.script;j.parentNode&&j.parentNode.removeChild(j),delete L[this.id],this.emit("disposed")},y})(m.default);i.Request=R;function A(T){return v.JSONPTransport=G,G.isAvailable()&&(T.supportedTransports[M]=G),G}i.default=A}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(8)),m=l.__importDefault(r(18)),_=l.__importDefault(r(46)),C=l.__importDefault(r(20)),E=l.__importDefault(r(33)),O=l.__importDefault(r(4)),v=l.__importDefault(r(49)),D=l.__importDefault(r(19)),L=l.__importDefault(r(3)),z=l.__importDefault(r(9)),M=l.__importDefault(r(16)),N=l.__importDefault(r(15)),G=function(){},R=(function(){function T(y){if(!y){var B="no options provided";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new Error(B)}var j=g.default.objectifyOptions(y);j.log?(d.default.setLog(j.log.level,j.log.handler),d.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):d.default.setLog(j.logLevel,j.logHandler),d.default.logAction(d.default.LOG_MICRO,"Rest()","initialized with clientOptions "+L.default.Config.inspect(y));var H=this.options=g.default.normaliseOptions(j);if(H.key){var Q=H.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!Q){var B="invalid key parameter";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new O.default(B,40400,404)}H.keyName=Q[1],H.keySecret=Q[2]}if("clientId"in H)if(typeof H.clientId=="string"||H.clientId===null){if(H.clientId==="*")throw new O.default('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new O.default("clientId must be either a string or null",40012,400);d.default.logAction(d.default.LOG_MINOR,"Rest()","started; version = "+g.default.version),this.baseUri=this.authority=function(K){return g.default.getHttpScheme(H)+K+":"+g.default.getPort(H,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new L.default.Http(H),this.auth=new m.default(this,H),this.channels=new A(this),this.push=new _.default(this)}return T.prototype.stats=function(y,B){if(B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.options.promises)return c.promisify(this,"stats",[y]);B=G}var j=c.defaultGetHeaders(this.options),H=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,Q=this.http.supportsLinkHeaders?void 0:H;this.options.headers&&c.mixin(j,this.options.headers),new C.default(this,"/stats",j,Q,function(K,X,V){for(var U=V?K:JSON.parse(K),I=0;I<U.length;I++)U[I]=v.default.fromValues(U[I]);return U}).get(y,B)},T.prototype.time=function(y,B){var j=this;if(B===void 0){if(typeof y=="function")B=y,y=null;else if(this.options.promises)return c.promisify(this,"time",[y])}var H=B||G,Q=c.defaultGetHeaders(this.options);this.options.headers&&c.mixin(Q,this.options.headers);var K=function(X){return j.authority(X)+"/time"};this.http.do(D.default.Get,this,K,Q,null,y,function(X,V,U,I){if(X){H(X);return}I||(V=JSON.parse(V));var F=V[0];if(!F){H(new O.default("Internal error (unexpected result type from GET /time)",5e4,500));return}j.serverTimeOffset=F-c.now(),H(null,F)})},T.prototype.request=function(y,B,j,H,Q,K){var X=this.options.useBinaryProtocol,V=X?L.default.Config.msgpack.encode:JSON.stringify,U=X?L.default.Config.msgpack.decode:JSON.parse,I=X?c.Format.msgpack:c.Format.json,F=this.http.supportsLinkHeaders?void 0:I;j=j||{};var W=y.toLowerCase(),at=W=="get"?c.defaultGetHeaders(this.options,I):c.defaultPostHeaders(this.options,I);if(K===void 0){if(this.options.promises)return c.promisify(this,"request",[y,B,j,H,Q]);K=G}typeof H!="string"&&(H=V(H)),this.options.headers&&c.mixin(at,this.options.headers),Q&&c.mixin(at,Q);var Z=new C.default(this,B,at,F,function(rt,it,Y){return c.ensureArray(Y?rt:U(rt))},!0);if(!c.arrIn(L.default.Http.methods,W))throw new O.default("Unsupported method "+W,40500,405);c.arrIn(L.default.Http.methodsWithBody,W)?Z[W](j,H,K):Z[W](j,K)},T.prototype.batchPublish=function(y,B){if(B===void 0){if(this.options.promises)return c.promisify(this,"batchPublish",[y]);B=G}var j=B,H,Q;c.isArray(y)?(H=y,Q=!1):(H=[y],Q=!0);var K=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,X=c.defaultPostHeaders(this.options,K);this.options.headers&&c.mixin(X,this.options.headers);var V=c.encodeBody(H,K);N.default.post(this,"/messages",V,X,{newBatchResponse:"true"},null,function(U,I,F,W){if(U){j(U);return}var at=W?I:c.decodeBody(I,K);Q?j(null,at[0]):j(null,at)})},T.prototype.batchPresence=function(y,B){if(B===void 0){if(this.options.promises)return c.promisify(this,"batchPresence",[y]);B=G}var j=B,H=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,Q=c.defaultPostHeaders(this.options,H);this.options.headers&&c.mixin(Q,this.options.headers);var K=y.join(",");N.default.get(this,"/presence",Q,{newBatchResponse:"true",channels:K},null,function(X,V,U,I){if(X){j(X);return}var F=I?V:c.decodeBody(V,H);j(null,F)})},T.prototype.setLog=function(y){d.default.setLog(y.level,y.handler)},T.Promise=function(y){return y=g.default.objectifyOptions(y),y.promises=!0,new T(y)},T.Callbacks=T,T.Platform=L.default,T.Message=z.default,T.PresenceMessage=M.default,T})(),A=(function(){function T(y){this.rest=y,this.all=Object.create(null)}return T.prototype.get=function(y,B){y=String(y);var j=this.all[y];return j?B&&j.setOptions(B):this.all[y]=j=new E.default(this.rest,y,B),j},T.prototype.release=function(y){delete this.all[String(y)]},T})();i.default=R}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return l.enc.Utf8})}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[],O=[];(function(){function L(G){for(var R=c.sqrt(G),A=2;A<=R;A++)if(!(G%A))return!1;return!0}function z(G){return(G-(G|0))*4294967296|0}for(var M=2,N=0;N<64;)L(M)&&(N<8&&(E[N]=z(c.pow(M,1/2))),O[N]=z(c.pow(M,1/3)),N++),M++})();var v=[],D=C.SHA256=_.extend({_doReset:function(){this._hash=new m.init(E.slice(0))},_doProcessBlock:function(L,z){for(var M=this._hash.words,N=M[0],G=M[1],R=M[2],A=M[3],T=M[4],y=M[5],B=M[6],j=M[7],H=0;H<64;H++){if(H<16)v[H]=L[z+H]|0;else{var Q=v[H-15],K=(Q<<25|Q>>>7)^(Q<<14|Q>>>18)^Q>>>3,X=v[H-2],V=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;v[H]=K+v[H-7]+V+v[H-16]}var U=T&y^~T&B,I=N&G^N&R^G&R,F=(N<<30|N>>>2)^(N<<19|N>>>13)^(N<<10|N>>>22),W=(T<<26|T>>>6)^(T<<21|T>>>11)^(T<<7|T>>>25),at=j+W+U+O[H]+v[H],Z=F+I;j=B,B=y,y=T,T=A+at|0,A=R,R=G,G=N,N=at+Z|0}M[0]=M[0]+N|0,M[1]=M[1]+G|0,M[2]=M[2]+R|0,M[3]=M[3]+A|0,M[4]=M[4]+T|0,M[5]=M[5]+y|0,M[6]=M[6]+B|0,M[7]=M[7]+j|0},_doFinalize:function(){var L=this._data,z=L.words,M=this._nDataBytes*8,N=L.sigBytes*8;return z[N>>>5]|=128<<24-N%32,z[(N+64>>>9<<4)+14]=c.floor(M/4294967296),z[(N+64>>>9<<4)+15]=M,L.sigBytes=z.length*4,this._process(),this._hash},clone:function(){var L=_.clone.call(this);return L._hash=this._hash.clone(),L}});d.SHA256=_._createHelper(D),d.HmacSHA256=_._createHmacHelper(D)})(Math),l.SHA256})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(34)),_=l.__importDefault(r(9)),C=l.__importDefault(r(4)),E=l.__importDefault(r(20)),O=l.__importDefault(r(15)),v=l.__importDefault(r(3));function D(){}var L=9;function z(G){return c.arrEvery(G,function(R){return!R.id})}function M(G){var R=G||{};if(R.cipher){if(!v.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var A=v.default.Crypto.getCipher(R.cipher);R.cipher=A.cipherParams,R.channelCipher=A.cipher}else"cipher"in R&&(R.cipher=void 0,R.channelCipher=null);return R}var N=(function(G){l.__extends(R,G);function R(A,T,y){var B=G.call(this)||this;return g.default.logAction(g.default.LOG_MINOR,"Channel()","started; name = "+T),B.rest=A,B.name=T,B.basePath="/channels/"+encodeURIComponent(T),B.presence=new m.default(B),B.channelOptions=M(y),B}return R.prototype.setOptions=function(A){this.channelOptions=M(A)},R.prototype.history=function(A,T){if(g.default.logAction(g.default.LOG_MICRO,"Channel.history()","channel = "+this.name),T===void 0)if(typeof A=="function")T=A,A=null;else{if(this.rest.options.promises)return c.promisify(this,"history",arguments);T=D}this._history(A,T)},R.prototype._history=function(A,T){var y=this.rest,B=y.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,j=this.rest.http.supportsLinkHeaders?void 0:B,H=c.defaultGetHeaders(y.options,B);y.options.headers&&c.mixin(H,y.options.headers);var Q=this.channelOptions;new E.default(y,this.basePath+"/messages",H,j,function(K,X,V){return _.default.fromResponseBody(K,Q,V?void 0:B)}).get(A,T)},R.prototype.publish=function(){var A=this,T=arguments.length,y=arguments[0],B=arguments[1],j=arguments[T-1],H,Q;if(typeof j!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);j=D}if(typeof y=="string"||y===null)H=[_.default.fromValues({name:y,data:B})],Q=arguments[2];else if(c.isObject(y))H=[_.default.fromValues(y)],Q=arguments[1];else if(c.isArray(y))H=_.default.fromValuesArray(y),Q=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof Q!="object"||!Q)&&(Q={});var K=this.rest,X=K.options,V=X.useBinaryProtocol?c.Format.msgpack:c.Format.json,U=K.options.idempotentRestPublishing,I=c.defaultPostHeaders(K.options,V);if(X.headers&&c.mixin(I,X.headers),U&&z(H)){var F=c.randomString(L);c.arrForEach(H,function(W,at){W.id=F+":"+at.toString()})}_.default.encodeArray(H,this.channelOptions,function(W){if(W){j(W);return}var at=_.default.getMessagesSize(H),Z=X.maxMessageSize;if(at>Z){j(new C.default("Maximum size of messages that can be published at once exceeded ( was "+at+" bytes; limit is "+Z+" bytes)",40009,400));return}A._publish(_.default.serialize(H,V),I,Q,j)})},R.prototype._publish=function(A,T,y,B){O.default.post(this.rest,this.basePath+"/messages",A,T,y,null,B)},R.prototype.status=function(A){if(typeof A!="function"&&this.rest.options.promises)return c.promisify(this,"status",[]);var T=this.rest.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,y=c.defaultPostHeaders(this.rest.options,T);O.default.get(this.rest,this.basePath,y,{},T,A||D)},R})(d.default);i.default=N}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(20)),_=l.__importDefault(r(16));function C(){}var E=(function(O){l.__extends(v,O);function v(D){var L=O.call(this)||this;return L.channel=D,L.basePath=D.basePath+"/presence",L}return v.prototype.get=function(D,L){if(g.default.logAction(g.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),L===void 0)if(typeof D=="function")L=D,D=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"get",arguments);L=C}var z=this.channel.rest,M=z.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,N=this.channel.rest.http.supportsLinkHeaders?void 0:M,G=c.defaultGetHeaders(z.options,M);z.options.headers&&c.mixin(G,z.options.headers);var R=this.channel.channelOptions;new m.default(z,this.basePath,G,N,function(A,T,y){return _.default.fromResponseBody(A,R,y?void 0:M)}).get(D,L)},v.prototype.history=function(D,L){return g.default.logAction(g.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(D,L)},v.prototype._history=function(D,L){if(L===void 0)if(typeof D=="function")L=D,D=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"_history",[D]);L=C}var z=this.channel.rest,M=z.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,N=this.channel.rest.http.supportsLinkHeaders?void 0:M,G=c.defaultGetHeaders(z.options,M);z.options.headers&&c.mixin(G,z.options.headers);var R=this.channel.channelOptions;new m.default(z,this.basePath+"/history",G,N,function(A,T,y){return _.default.fromResponseBody(A,R,y?void 0:M)}).get(D,L)},v})(d.default);i.default=E}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0}),i.TransportParams=void 0;var c=r(0),d=c.__importDefault(r(10)),g=c.__importStar(r(1)),m=c.__importStar(r(52)),_=c.__importStar(r(8)),C=c.__importDefault(r(3)),E=c.__importDefault(r(7)),O=c.__importDefault(r(36)),v=c.__importDefault(r(2)),D=c.__importDefault(r(37)),L=c.__importStar(r(21)),z=c.__importStar(r(4)),M=c.__importDefault(r(18)),N=c.__importDefault(r(9)),G=c.__importDefault(r(24)),R=c.__importDefault(r(53)),A=c.__importDefault(r(26)),T=c.__importDefault(r(14)),y=function(){var rt;return typeof C.default.WebStorage<"u"&&((rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.localSupported)},B=function(){var rt;return typeof C.default.WebStorage<"u"&&((rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.sessionSupported)},j=d.default.Action,H=function(){},Q="ably-transport-preference",K="ably-connection-recovery";function X(){var rt,it;return B()&&((it=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.getSession)===null||it===void 0?void 0:it.call(rt,K))}function V(rt){var it,Y;return B()&&((Y=(it=C.default.WebStorage)===null||it===void 0?void 0:it.setSession)===null||Y===void 0?void 0:Y.call(it,K,rt))}function U(){var rt,it;return B()&&((it=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.removeSession)===null||it===void 0?void 0:it.call(rt,K))}function I(rt,it){return g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,rt.shortName)>g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,it.shortName)}function F(rt,it,Y){var J;if(rt.channel!==it.channel||(J=rt.action)!==j.PRESENCE&&J!==j.MESSAGE||J!==it.action)return!1;var tt=J===j.PRESENCE?"presence":"messages",et=rt[tt].concat(it[tt]),gt=N.default.getMessagesSize(et);return gt>Y||!g.allSame(et,"clientId")||!g.arrEvery(et,function(At){return!At.id})?!1:(rt[tt]=et,!0)}function W(rt){try{return JSON.parse(rt)}catch{return null}}var at=(function(){function rt(it,Y,J,tt){this.options=it,this.host=Y,this.mode=J,this.connectionKey=tt,this.format=it.useBinaryProtocol?g.Format.msgpack:g.Format.json}return rt.prototype.getConnectParams=function(it){var Y=it?g.copy(it):{},J=this.options;switch(this.mode){case"upgrade":Y.upgrade=this.connectionKey;break;case"resume":Y.resume=this.connectionKey;break;case"recover":{var tt=W(J.recover);tt&&(Y.recover=tt.connectionKey);break}}return J.clientId!==void 0&&(Y.clientId=J.clientId),J.echoMessages===!1&&(Y.echo="false"),this.format!==void 0&&(Y.format=this.format),this.stream!==void 0&&(Y.stream=this.stream),this.heartbeats!==void 0&&(Y.heartbeats=this.heartbeats),Y.v=_.default.protocolVersion,Y.agent=(0,_.getAgentString)(this.options),J.transportParams!==void 0&&g.mixin(Y,J.transportParams),Y},rt.prototype.toString=function(){var it="[mode="+this.mode;return this.host&&(it+=",host="+this.host),this.connectionKey&&(it+=",connectionKey="+this.connectionKey),this.format&&(it+=",format="+this.format),it+="]",it},rt})();i.TransportParams=at;var Z=(function(rt){c.__extends(it,rt);function it(Y,J){var tt=rt.call(this)||this;tt.disconnectedRetryCount=0,it.initTransports(),tt.realtime=Y,tt.options=J;var et=J.timeouts,gt=et.preferenceConnectTimeout+et.realtimeRequestTimeout;if(tt.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:gt,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:et.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:et.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:et.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},tt.state=tt.states.initialized,tt.errorReason=null,tt.queuedMessages=new O.default,tt.msgSerial=0,tt.connectionDetails=void 0,tt.connectionId=void 0,tt.connectionKey=void 0,tt.connectionStateTtl=et.connectionStateTtl,tt.maxIdleInterval=null,tt.transports=g.intersect(J.transports||_.default.defaultTransports,it.supportedTransports),tt.baseTransport=g.intersect(_.default.baseTransportOrder,tt.transports)[0],tt.upgradeTransports=g.intersect(tt.transports,_.default.upgradeTransports),tt.transportPreference=null,tt.httpHosts=_.default.getHosts(J),tt.activeProtocol=null,tt.proposedTransports=[],tt.pendingTransports=[],tt.host=null,tt.lastAutoReconnectAttempt=null,tt.lastActivity=null,tt.forceFallbackHost=!1,tt.connectCounter=0,v.default.logAction(v.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(J.transports||_.default.defaultTransports)+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+tt.transports+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+tt.httpHosts+"]"),!tt.transports.length){var At="no requested transports available";throw v.default.logAction(v.default.LOG_ERROR,"realtime.ConnectionManager()",At),new Error(At)}var Dt=C.default.Config.addEventListener;return Dt&&(B()&&typeof J.recover=="function"&&Dt("beforeunload",tt.persistConnection.bind(tt)),J.closeOnUnload===!0&&Dt("beforeunload",function(){v.default.logAction(v.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),tt.requestState({state:"closing"})}),Dt("online",function(){tt.state==tt.states.disconnected||tt.state==tt.states.suspended?(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser online event","reattempting connection"),tt.requestState({state:"connecting"})):tt.state==tt.states.connecting&&(tt.pendingTransports.forEach(function(Qt){Qt.off()}),tt.disconnectAllTransports(),tt.startConnect())}),Dt("offline",function(){tt.state==tt.states.connected&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser offline event","disconnecting active transport"),tt.disconnectAllTransports())})),tt}return it.initTransports=function(){(0,R.default)(it),g.arrForEach(C.default.Transports,function(Y){Y(it)})},it.prototype.createTransportParams=function(Y,J){return new at(this.options,Y,J,this.connectionKey)},it.prototype.getTransportParams=function(Y){var J=this,tt=function(et){if(J.connectionKey){et("resume");return}if(typeof J.options.recover=="string"){et("recover");return}var gt=J.options.recover,At=X();if(At&&typeof gt=="function"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),gt(At,function(Dt){Dt?(J.options.recover=At.recoveryKey,et("recover")):et("clean")});return}et("clean")};tt(function(et){var gt=J.createTransportParams(null,et);if(et==="recover"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+J.options.recover);var At=W(J.options.recover);At&&(J.msgSerial=At.msgSerial)}else v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+gt.toString());Y(gt)})},it.prototype.tryATransport=function(Y,J,tt){var et=this;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+J),A.default.tryConnect(it.supportedTransports[J],this,this.realtime.auth,Y,function(gt,At){var Dt=et.state;if(Dt==et.states.closing||Dt==et.states.closed||Dt==et.states.failed){At&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+Dt.state+" while we were attempting the transport; closing "+At),At.close()),tt(!0);return}if(gt){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+J+" "+gt.event+", err: "+gt.error.toString()),M.default.isTokenErr(gt.error)&&!(et.errorReason&&M.default.isTokenErr(et.errorReason))?(et.errorReason=gt.error,et.realtime.auth._forceNewToken(null,null,function(Qt){if(Qt){et.actOnErrorFromAuthorize(Qt);return}et.tryATransport(Y,J,tt)})):gt.event==="failed"?(et.notifyState({state:"failed",error:gt.error}),tt(!0)):gt.event==="disconnected"&&((0,L.isRetriable)(gt.error)?tt(!1):(et.notifyState({state:et.states.connecting.failState,error:gt.error}),tt(!0)));return}v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+J+"; setting pending"),et.setTransportPending(At,Y),tt(null,At)})},it.prototype.setTransportPending=function(Y,J){var tt=this,et=J.mode;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+Y+"; mode = "+et),g.arrDeleteValue(this.proposedTransports,Y),this.pendingTransports.push(Y);var gt=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];Y.once("connected",function(Dt,Qt,ee){et=="upgrade"&&tt.activeProtocol?Y.shortName!==gt&&g.arrIn(tt.getUpgradePossibilities(),gt)&&tt.activeProtocol?setTimeout(function(){tt.scheduleTransportActivation(Dt,Y,Qt,ee)},tt.options.timeouts.parallelUpgradeDelay):tt.scheduleTransportActivation(Dt,Y,Qt,ee):(tt.activateTransport(Dt,Y,Qt,ee),C.default.Config.nextTick(function(){tt.connectImpl(J)})),et==="recover"&&tt.options.recover&&(tt.options.recover=null,tt.unpersistConnection())});var At=this;Y.on(["disconnected","closed","failed"],function(Dt){At.deactivateTransport(Y,this.event,Dt)}),this.emit("transport.pending",Y)},it.prototype.scheduleTransportActivation=function(Y,J,tt,et){var gt=this,At=this.activeProtocol&&this.activeProtocol.getTransport(),Dt=function(){J.disconnect(),g.arrDeleteValue(gt.pendingTransports,J)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),Dt();return}if(At&&!I(J,At)){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+" is no better than current active transport "+At.shortName+" - abandoning upgrade"),Dt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+J);var Qt=null;if(!J.isConnected){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+"is no longer connected; abandoning upgrade"),Dt();return}if(this.state===this.states.connected)v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,Qt=this.activeProtocol;else if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),Dt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+J);var ee=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+J),J.send(d.default.fromValues({action:j.ACTIVATE})),gt.activateTransport(Y,J,tt,et),gt.state===gt.states.synchronizing?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+J),gt.state=gt.states.connected):v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+gt.state.state+", so leaving unchanged"),gt.state.sendEvents&&gt.sendQueuedMessages()};Qt?Qt.onceIdle(ee):ee()},it.prototype.activateTransport=function(Y,J,tt,et){var gt=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+J),Y&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+Y),tt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+tt),et&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(et)),this.persistTransportPreference(J);var At=this.state,Dt=this.states.connected.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+At.state),At.state==this.states.closing.state||At.state==this.states.closed.state||At.state==this.states.failed.state)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),J.disconnect(),!1;if(g.arrDeleteValue(this.pendingTransports,J),!J.isConnected)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+J+" since it appears to no longer be connected"),!1;var Qt=this.activeProtocol;this.activeProtocol=new m.default(J),this.host=J.params.host;var ee=et.connectionKey;if(ee&&this.connectionKey!=ee&&this.setConnection(tt,et,!!Y),this.onConnectionDetailsUpdate(et,J),C.default.Config.nextTick(function(){J.on("connected",function(kt,ye,_e){gt.onConnectionDetailsUpdate(_e,J),gt.emit("update",new D.default(Dt,Dt,null,kt))})}),At.state===this.states.connected.state?Y&&(this.errorReason=this.realtime.connection.errorReason=Y,this.emit("update",new D.default(Dt,Dt,null,Y))):(this.notifyState({state:"connected",error:Y}),this.errorReason=this.realtime.connection.errorReason=Y||null),this.emit("transport.active",J),Qt)if(Qt.messageQueue.count()>0&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+Qt.transport.shortName+", new one is "+J.shortName+") finishing with "+Qt.messageQueue.count()+" messages still pending"),Qt.transport===J){var le="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",le)}else Qt.finish();return g.safeArrForEach(this.pendingTransports,function(kt){if(kt===J){var ye="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",ye),g.arrDeleteValue(gt.pendingTransports,J)}else kt.disconnect()}),g.safeArrForEach(this.proposedTransports,function(kt){kt===J?(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+J.shortName+"; stack = "+new Error().stack),g.arrDeleteValue(gt.proposedTransports,J)):kt.dispose()}),!0},it.prototype.deactivateTransport=function(Y,J,tt){var et=this.activeProtocol,gt=et&&et.getTransport()===Y,At=g.arrDeleteValue(this.pendingTransports,Y),Dt=g.arrDeleteValue(this.proposedTransports,Y),Qt=this.noTransportsScheduledForActivation();if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+Y),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+J+(gt?"; was active":At?"; was pending":Dt?"; was proposed":"")+(Qt?"":"; another transport is scheduled for activation")),tt&&tt.message&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+tt.message),gt&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(et.getPendingMessages()),C.default.Config.nextTick(function(){et.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",Y),gt&&Qt||gt&&J==="failed"||J==="closed"||et===null&&At&&this.pendingTransports.length===0){if(J==="disconnected"&&tt&&tt.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:J,error:tt,retryImmediately:!0});return}var ee=J==="failed"&&M.default.isTokenErr(tt)?"disconnected":J;this.notifyState({state:ee,error:tt});return}gt&&J==="disconnected"&&this.state!==this.states.synchronizing&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:tt}))},it.prototype.noTransportsScheduledForActivation=function(){return g.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(Y){return!Y.isConnected})},it.prototype.setConnection=function(Y,J,tt){var et=this.connectionId,gt=et&&et!==Y,At=!et&&tt;(gt||At)&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==Y&&v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=Y,this.realtime.connection.key=this.connectionKey=J.connectionKey},it.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},it.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},it.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var Y=g.now()-this.lastActivity;Y>this.connectionStateTtl+this.maxIdleInterval&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+Y+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},it.prototype.persistConnection=function(){if(B()){var Y=this.createRecoveryKey();Y&&V({recoveryKey:Y,disconnectedAt:g.now(),location:l.location,clientId:this.realtime.auth.clientId})}},it.prototype.unpersistConnection=function(){U()},it.prototype.getError=function(){return this.errorReason||this.getStateError()},it.prototype.getStateError=function(){var Y,J;return(J=(Y=L.default)[this.state.state])===null||J===void 0?void 0:J.call(Y)},it.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},it.prototype.enactStateChange=function(Y){var J=Y.current==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(J,"Connection state",Y.current+(Y.reason?"; reason: "+Y.reason:"")),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+Y.current+"; reason = "+(Y.reason&&Y.reason.message));var tt=this.state=this.states[Y.current];Y.reason&&(this.errorReason=Y.reason,this.realtime.connection.errorReason=Y.reason),(tt.terminal||tt.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",Y)},it.prototype.startTransitionTimer=function(Y){var J=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+Y.state),this.transitionTimer&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){J.transitionTimer&&(J.transitionTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager "+Y.state+" timer expired","requesting new state: "+Y.failState),J.notifyState({state:Y.failState}))},Y.retryDelay)},it.prototype.cancelTransitionTimer=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},it.prototype.startSuspendTimer=function(){var Y=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){Y.suspendTimer&&(Y.suspendTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),Y.states.connecting.failState="suspended",Y.notifyState({state:"suspended"}))},this.connectionStateTtl))},it.prototype.checkSuspendTimer=function(Y){Y!=="disconnected"&&Y!=="suspended"&&Y!=="connecting"&&this.cancelSuspendTimer()},it.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},it.prototype.startRetryTimer=function(Y){var J=this;this.retryTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),J.retryTimer=null,J.requestState({state:"connecting"})},Y)},it.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},it.prototype.notifyState=function(Y){var J=this,tt,et,gt=Y.state,At=gt==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||Y.retryImmediately||this.state===this.states.connecting&&Y.error&&M.default.isTokenErr(Y.error)&&!(this.errorReason&&M.default.isTokenErr(this.errorReason)));if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+gt+(At?"; will retry connection immediately":"")),gt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(Y.state),(gt==="suspended"||gt==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var Dt=this.states[Y.state],Qt=Dt.retryDelay;Dt.state==="disconnected"&&(this.disconnectedRetryCount++,Qt=g.getRetryTime(Dt.retryDelay,this.disconnectedRetryCount));var ee=new D.default(this.state.state,Dt.state,Qt,Y.error||((et=(tt=L.default)[Dt.state])===null||et===void 0?void 0:et.call(tt)));if(At){var le=function(){J.state===J.states.disconnected&&(J.lastAutoReconnectAttempt=g.now(),J.requestState({state:"connecting"}))},kt=this.lastAutoReconnectAttempt&&g.now()-this.lastAutoReconnectAttempt+1;kt&&kt<1e3?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+kt+"ms ago, waiting another "+(1e3-kt)+"ms before trying again"),setTimeout(le,1e3-kt)):C.default.Config.nextTick(le)}else(gt==="disconnected"||gt==="suspended")&&this.startRetryTimer(Qt);(gt==="disconnected"&&!At||gt==="suspended"||Dt.terminal)&&C.default.Config.nextTick(function(){J.disconnectAllTransports()}),gt=="connected"&&!this.activeProtocol&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(ee),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(gt,ee.reason),this.failQueuedMessages(ee.reason))}},it.prototype.requestState=function(Y){var J=this,tt,et,gt=Y.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+gt+"; current state: "+this.state.state),gt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(gt),!(gt=="connecting"&&this.state.state=="connected")&&!(gt=="closing"&&this.state.state=="closed"))){var At=this.states[gt],Dt=new D.default(this.state.state,At.state,null,Y.error||((et=(tt=L.default)[At.state])===null||et===void 0?void 0:et.call(tt)));this.enactStateChange(Dt),gt=="connecting"&&C.default.Config.nextTick(function(){J.startConnect()}),gt=="closing"&&this.closeImpl()}},it.prototype.startConnect=function(){var Y=this;if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var J=this.realtime.auth,tt=++this.connectCounter,et=function(){Y.checkConnectionStateFreshness(),Y.getTransportParams(function(At){if(At.mode==="recover"&&At.options.recover){var Dt=W(At.options.recover);Dt&&Y.realtime.channels.recoverChannels(Dt.channelSerials)}tt===Y.connectCounter&&Y.connectImpl(At,tt)})};if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),J.method==="basic")et();else{var gt=function(At){tt===Y.connectCounter&&(At?Y.actOnErrorFromAuthorize(At):et())};this.errorReason&&M.default.isTokenErr(this.errorReason)?J._forceNewToken(null,null,gt):J._ensureValidAuthCredentials(!1,gt)}},it.prototype.connectImpl=function(Y,J){var tt=this.state.state;tt!==this.states.connecting.state&&tt!==this.states.connected.state?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+tt):this.pendingTransports.length?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):tt==this.states.connected.state?this.upgradeIfNeeded(Y):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(Y,J):this.connectBase(Y,J)},it.prototype.connectPreference=function(Y,J){var tt=this,et=this.getTransportPreference(),gt=!1;g.arrIn(this.transports,et)||(this.unpersistTransportPreference(),this.connectImpl(Y,J)),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+et);var At=setTimeout(function(){gt=!0,tt.state.state!==tt.states.connected.state&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+et+" failed; clearing preference and trying from scratch"),tt.disconnectAllTransports(),tt.unpersistTransportPreference()),tt.connectImpl(Y,J)},this.options.timeouts.preferenceConnectTimeout);Y.host=this.httpHosts[0],this.tryATransport(Y,et,function(Dt,Qt){clearTimeout(At),gt&&Qt?(Qt.off(),Qt.disconnect(),g.arrDeleteValue(tt.pendingTransports,Qt)):!Qt&&!Dt&&(tt.unpersistTransportPreference(),tt.connectImpl(Y,J))})},it.prototype.connectBase=function(Y,J){var tt=this,et=function(ee){tt.notifyState({state:tt.states.connecting.failState,error:ee})},gt=this.httpHosts.slice(),At=function(ee,le){J===tt.connectCounter&&!le&&!ee&&Qt()};v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var Dt=gt.shift();if(!Dt){et(new z.default("Unable to connect (no available host)",80003,404));return}Y.host=Dt;var Qt=function(){if(!gt.length){et(new z.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!tt.realtime.http.checkConnectivity){et(new z.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}tt.realtime.http.checkConnectivity(function(ee,le){if(J===tt.connectCounter){if(ee){et(ee);return}if(!le){et(new z.default("Unable to connect (network unreachable)",80003,404));return}Y.host=g.arrPopRandomElement(gt),tt.tryATransport(Y,tt.baseTransport,At)}})};if(this.forceFallbackHost&&gt.length){this.forceFallbackHost=!1,Qt();return}this.tryATransport(Y,this.baseTransport,At)},it.prototype.getUpgradePossibilities=function(){var Y=this.activeProtocol.getTransport().shortName,J=g.arrIndexOf(this.upgradeTransports,Y);return this.upgradeTransports.slice(J+1)},it.prototype.upgradeIfNeeded=function(Y){var J=this,tt=this.getUpgradePossibilities();v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect(tt)),tt.length&&g.arrForEach(tt,function(et){var gt=J.createTransportParams(Y.host,"upgrade");J.tryATransport(gt,et,H)})},it.prototype.closeImpl=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),g.safeArrForEach(this.pendingTransports,function(Y){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+Y),Y&&Y.close()}),g.safeArrForEach(this.proposedTransports,function(Y){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+Y),Y&&Y.dispose()}),this.activeProtocol&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},it.prototype.onAuthUpdated=function(Y,J){var tt=this,et;switch(this.state.state){case"connected":{if(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var gt=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){tt.state.state==="connected"&&tt.upgradeIfNeeded(gt)})}var At=(et=this.activeProtocol)===null||et===void 0?void 0:et.getTransport();At&&At.onAuthUpdated&&At.onAuthUpdated(Y);var Dt=d.default.fromValues({action:j.AUTH,auth:{accessToken:Y.token}});this.send(Dt);var Qt=function(){tt.off(ee),J(null,Y)},ee=function(kt){kt.current==="failed"&&(tt.off(Qt),tt.off(ee),J(kt.reason||tt.getStateError()))};this.once("connectiondetails",Qt),this.on("connectionstate",ee);break}case"connecting":v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var le=function(kt){switch(kt.current){case"connected":tt.off(le),J(null,Y);break;case"failed":case"closed":case"suspended":tt.off(le),J(kt.reason||tt.getStateError());break}};this.on("connectionstate",le),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},it.prototype.disconnectAllTransports=function(Y){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(Y?" except the active transport":"")),this.connectCounter++,g.safeArrForEach(this.pendingTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+J),J&&J.disconnect()}),this.pendingTransports=[],g.safeArrForEach(this.proposedTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+J),J&&J.dispose()}),this.proposedTransports=[],this.activeProtocol&&!Y&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},it.prototype.send=function(Y,J,tt){tt=tt||H;var et=this.state;if(et.sendEvents){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new m.PendingMessage(Y,tt));return}var gt=J&&et.queueEvents||et.forceQueueEvents;if(!gt){var At="rejecting event, queueEvent was "+J+", state was "+et.state;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()",At),tt(this.errorReason||new z.default(At,9e4,400));return}v.default.shouldLog(v.default.LOG_MICRO)&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+d.default.stringify(Y)),this.queue(Y,tt)},it.prototype.sendImpl=function(Y){var J=Y.message;Y.ackRequired&&!Y.sendAttempted&&(J.msgSerial=this.msgSerial++);try{this.activeProtocol.send(Y)}catch(tt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+tt.stack)}},it.prototype.queue=function(Y,J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var tt=this.queuedMessages.last(),et=this.options.maxMessageSize;tt&&!tt.sendAttempted&&F(tt.message,Y,et)?(tt.merged||(tt.callback=G.default.create([tt.callback]),tt.merged=!0),tt.callback.push(J)):this.queuedMessages.push(new m.PendingMessage(Y,J))},it.prototype.sendQueuedMessages=function(){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var Y;Y=this.queuedMessages.shift();)this.sendImpl(Y)},it.prototype.queuePendingMessages=function(Y){Y&&Y.length&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+Y.length+" pending messages"),this.queuedMessages.prepend(Y))},it.prototype.failQueuedMessages=function(Y){var J=this.queuedMessages.count();J>0&&(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+J+" queued messages, err = "+g.inspectError(Y)),this.queuedMessages.completeAllMessages(Y))},it.prototype.onChannelMessage=function(Y,J){var tt=this.activeProtocol&&J===this.activeProtocol.getTransport(),et=g.arrIn(this.pendingTransports,J)&&this.state==this.states.synchronizing;tt||et?this.realtime.channels.onChannelMessage(Y):g.arrIndexOf([j.ACK,j.NACK,j.ERROR],Y.action)>-1?this.realtime.channels.onChannelMessage(Y):v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(Y)+"on defunct transport; discarding")},it.prototype.ping=function(Y,J){var tt=this;if(Y){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+Y);var et=function(){Y.off("heartbeat",Dt),J(new z.default("Timeout waiting for heartbeat response",5e4,500))},gt=g.now(),At=g.cheapRandStr(),Dt=function(ye){if(ye===At){Y.off("heartbeat",Dt),clearTimeout(Qt);var _e=g.now()-gt;J(null,_e)}},Qt=setTimeout(et,this.options.timeouts.realtimeRequestTimeout);Y.on("heartbeat",Dt),Y.ping(At);return}if(this.state.state!=="connected"){J(new z.default("Unable to ping service; not connected",4e4,400));return}var ee=!1,le=function(ye,_e){tt.off("transport.active",kt),ee||(ee=!0,J(ye,_e))},kt=function(){ee||(ee=!0,C.default.Config.nextTick(function(){tt.ping(null,J)}))};this.on("transport.active",kt),this.ping(this.activeProtocol.getTransport(),le)},it.prototype.abort=function(Y){this.activeProtocol.getTransport().fail(Y)},it.prototype.registerProposedTransport=function(Y){this.proposedTransports.push(Y)},it.prototype.getTransportPreference=function(){var Y,J;return this.transportPreference||y()&&((J=(Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.get)===null||J===void 0?void 0:J.call(Y,Q))},it.prototype.persistTransportPreference=function(Y){var J,tt;g.arrIn(_.default.upgradeTransports,Y.shortName)&&(this.transportPreference=Y.shortName,y()&&((tt=(J=C.default.WebStorage)===null||J===void 0?void 0:J.set)===null||tt===void 0||tt.call(J,Q,Y.shortName)))},it.prototype.unpersistTransportPreference=function(){var Y,J;this.transportPreference=null,y()&&((J=(Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.remove)===null||J===void 0||J.call(Y,Q))},it.prototype.actOnErrorFromAuthorize=function(Y){if(Y.code===40171)this.notifyState({state:"failed",error:Y});else if(Y.code===40102)this.notifyState({state:"failed",error:Y});else if(Y.statusCode===T.default.Forbidden){var J="Client configured authentication provider returned 403; failing the connection";v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",J),this.notifyState({state:"failed",error:new z.default(J,80019,403,Y)})}else{var J="Client configured authentication provider request failed";v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",J),this.notifyState({state:this.state.failState,error:new z.default(J,80019,401,Y)})}},it.prototype.onConnectionDetailsUpdate=function(Y,J){if(Y){this.connectionDetails=Y,Y.maxMessageSize&&(this.options.maxMessageSize=Y.maxMessageSize);var tt=Y.clientId;if(tt){var et=this.realtime.auth._uncheckedSetClientId(tt);if(et){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",et.message),J.fail(et);return}}var gt=Y.connectionStateTtl;gt&&(this.connectionStateTtl=gt),this.maxIdleInterval=Y.maxIdleInterval,this.emit("connectiondetails",Y)}},it.supportedTransports={},it})(E.default);i.default=Z}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(7)),d=l.__importDefault(r(2)),g=(function(m){l.__extends(_,m);function _(){var C=m.call(this)||this;return C.messages=[],C}return _.prototype.count=function(){return this.messages.length},_.prototype.push=function(C){this.messages.push(C)},_.prototype.shift=function(){return this.messages.shift()},_.prototype.last=function(){return this.messages[this.messages.length-1]},_.prototype.copyAll=function(){return this.messages.slice()},_.prototype.append=function(C){this.messages.push.apply(this.messages,C)},_.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},_.prototype.completeMessages=function(C,E,O){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+E),O=O||null;var v=this.messages;if(v.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var D=v[0];if(D){var L=D.message.msgSerial,z=C+E;if(z>L)for(var M=v.splice(0,z-L),N=0,G=M;N<G.length;N++){var R=G[N];R.callback(O)}v.length==0&&this.emit("idle")}},_.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},_.prototype.resetSendAttempted=function(){for(var C=0,E=this.messages;C<E.length;C++){var O=E[C];O.sendAttempted=!1}},_.prototype.clear=function(){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},_})(c.default);i.default=g}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function c(d,g,m,_){this.previous=d,this.current=g,m&&(this.retryIn=m),_&&(this.reason=_)}return c})();i.default=l}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(10)),d=l.__importDefault(r(7)),g=l.__importStar(r(1)),m=l.__importDefault(r(33)),_=l.__importDefault(r(2)),C=l.__importDefault(r(54)),E=l.__importDefault(r(9)),O=l.__importDefault(r(39)),v=l.__importStar(r(4)),D=l.__importDefault(r(16)),L=l.__importDefault(r(21)),z=c.default.Action,M=function(){};function N(A){if(A&&"params"in A&&!g.isObject(A.params))return new v.default("options.params must be an object",4e4,400);if(A&&"modes"in A){if(!g.isArray(A.modes))return new v.default("options.modes must be an array",4e4,400);for(var T=0;T<A.modes.length;T++){var y=A.modes[T];if(!y||typeof y!="string"||!g.arrIn(c.default.channelModes,String.prototype.toUpperCase.call(y)))return new v.default("Invalid channel mode: "+y,4e4,400)}}}var G=(function(A){l.__extends(T,A);function T(y,B,j){var H=A.call(this,y,B,j)||this;return H.retryCount=0,H.history=function(Q,K){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),K===void 0)if(typeof Q=="function")K=Q,Q=null;else{if(this.rest.options.promises)return g.promisify(this,"history",arguments);K=M}if(Q&&Q.untilAttach){if(this.state!=="attached"){K(new v.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){K(new v.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete Q.untilAttach,Q.from_serial=this.properties.attachSerial}m.default.prototype._history.call(this,Q,K)},H.whenState=(function(Q,K){return d.default.prototype.whenState.call(H,Q,H.state,K)}),_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel()","started; name = "+B),H.realtime=y,H.presence=new C.default(H),H.connectionManager=y.connection.connectionManager,H.state="initialized",H.subscriptions=new d.default,H.syncChannelSerial=void 0,H.properties={attachSerial:void 0,channelSerial:void 0},H.setOptions(j),H.errorReason=null,H._requestedFlags=null,H._mode=null,H._attachResume=!1,H._decodingContext={channelOptions:H.channelOptions,plugins:y.options.plugins||{},baseEncodedPreviousPayload:void 0},H._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},H._allChannelChanges=new d.default,H}return T.prototype.invalidStateError=function(){return new v.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},T.processListenerArgs=function(y){return y=Array.prototype.slice.call(y),typeof y[0]=="function"&&y.unshift(null),y[y.length-1]==null&&y.pop(),y},T.prototype.setOptions=function(y,B){var j=this.channelOptions;if(!B&&this.rest.options.promises)return g.promisify(this,"setOptions",arguments);var H=B||function(K){K&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+K.toString())},Q=N(y);if(Q){H(Q);return}m.default.prototype.setOptions.call(this,y),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(y,j)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(K){switch(this.event){case"update":case"attached":H==null||H(null);return;default:H==null||H(K.reason);return}})):H()},T.prototype._shouldReattachToSetOptions=function(y,B){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(y!=null&&y.params){var j=R(y.params),H=R(B.params);if(Object.keys(j).length!==Object.keys(H).length||!g.shallowEquals(H,j))return!0}return!!(y!=null&&y.modes&&(!B.modes||!g.arrEquals(y.modes,B.modes)))},T.prototype.publish=function(){for(var y=this,B=[],j=0;j<arguments.length;j++)B[j]=arguments[j];var H=B[0],Q=B.length,K=B[Q-1];if(typeof K!="function"){if(this.realtime.options.promises)return g.promisify(this,"publish",arguments);K=M,++Q}if(!this.connectionManager.activeState()){K(this.connectionManager.getError());return}if(Q==2)if(g.isObject(H))H=[E.default.fromValues(H)];else if(g.isArray(H))H=E.default.fromValuesArray(H);else throw new v.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else H=[E.default.fromValues({name:B[0],data:B[1]})];var X=this.realtime.options.maxMessageSize;E.default.encodeArray(H,this.channelOptions,function(V){if(V){K(V);return}var U=E.default.getMessagesSize(H);if(U>X){K(new v.default("Maximum size of messages that can be published at once exceeded ( was "+U+" bytes; limit is "+X+" bytes)",40009,400));return}y.__publish(H,K)})},T.prototype.__publish=function(y,B){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+y.length);var j=this.state;switch(j){case"failed":case"suspended":B(v.default.fromValues(this.invalidStateError()));break;default:{_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+j);var H=new c.default;H.action=z.MESSAGE,H.channel=this.name,H.messages=y,this.sendMessage(H,B);break}}},T.prototype.onEvent=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var B=this.subscriptions,j=0;j<y.length;j++){var H=y[j];B.emit(H.name,H)}},T.prototype.attach=function(y,B){var j;if(typeof y=="function"?(B=y,j=null):j=y,!B){if(this.realtime.options.promises)return g.promisify(this,"attach",arguments);B=function(H){H&&_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+H.toString())}}if(j)_.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=j;else if(this.state==="attached"){B(null,null);return}this._attach(!1,null,B)},T.prototype._attach=function(y,B,j){j||(j=function(Q){Q&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+Q.toString())});var H=this.connectionManager;if(!H.activeState()){j(H.getError());return}(this.state!=="attaching"||y)&&this.requestState("attaching",B),this.once(function(Q){switch(this.event){case"attached":j==null||j(null,Q);break;case"detached":case"suspended":case"failed":j==null||j(Q.reason||H.getError()||new v.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":j==null||j(new v.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},T.prototype.attachImpl=function(){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var y=c.default.fromValues({action:z.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?y.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&y.encodeModesToFlags(g.allToUpperCase(this.channelOptions.modes)),this._attachResume&&y.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(y.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(y,M)},T.prototype.detach=function(y){if(!y){if(this.realtime.options.promises)return g.promisify(this,"detach",arguments);y=M}var B=this.connectionManager;if(!B.activeState()){y(B.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),y();break;case"detached":y();break;case"failed":y(new v.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(j){switch(this.event){case"detached":y();break;case"attached":case"suspended":case"failed":y(j.reason||B.getError()||new v.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":y(new v.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},T.prototype.detachImpl=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var B=c.default.fromValues({action:z.DETACH,channel:this.name});this.sendMessage(B,y||M)},T.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var j=T.processListenerArgs(y),H=j[0],Q=j[1],K=j[2];if(!K&&this.realtime.options.promises)return g.promisify(this,"subscribe",[H,Q]);if(this.state==="failed"){K==null||K(v.default.fromValues(this.invalidStateError()));return}return H&&typeof H=="object"&&!Array.isArray(H)?this._subscribeFilter(H,Q):this.subscriptions.on(H,Q),this.attach(K||M)},T.prototype._subscribeFilter=function(y,B){var j=function(H){var Q,K,X,V,U,I,F={name:H.name,refTimeserial:(K=(Q=H.extras)===null||Q===void 0?void 0:Q.ref)===null||K===void 0?void 0:K.timeserial,refType:(V=(X=H.extras)===null||X===void 0?void 0:X.ref)===null||V===void 0?void 0:V.type,isRef:!!(!((I=(U=H.extras)===null||U===void 0?void 0:U.ref)===null||I===void 0)&&I.timeserial),clientId:H.clientId};Object.entries(y).find(function(W){var at=W[0],Z=W[1];return Z!==void 0?F[at]!==Z:!1})||B(H)};this._addFilteredSubscription(y,B,j),this.subscriptions.on(j)},T.prototype._addFilteredSubscription=function(y,B,j){var H;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(B)){var Q=this.filteredSubscriptions.get(B);Q.set(y,((H=Q==null?void 0:Q.get(y))===null||H===void 0?void 0:H.concat(j))||[j])}else this.filteredSubscriptions.set(B,new Map([[y,[j]]]))},T.prototype._getAndDeleteFilteredSubscriptions=function(y,B){var j=this;if(!this.filteredSubscriptions)return[];if(!B&&y)return Array.from(this.filteredSubscriptions.entries()).map(function(X){var V,U=X[0],I=X[1],F=I.get(y);return I.delete(y),I.size===0&&((V=j.filteredSubscriptions)===null||V===void 0||V.delete(U)),F}).reduce(function(X,V){var U;return V?(U=X).concat.apply(U,V):X},[]);if(!B||!this.filteredSubscriptions.has(B))return[];var H=this.filteredSubscriptions.get(B);if(!y){var Q=Array.from(H.values()).reduce(function(X,V){return X.concat.apply(X,V)},[]);return this.filteredSubscriptions.delete(B),Q}var K=H.get(y);return H.delete(y),K||[]},T.prototype.unsubscribe=function(){for(var y=this,B,j=[],H=0;H<arguments.length;H++)j[H]=arguments[H];var Q=T.processListenerArgs(j),K=Q[0],X=Q[1];if(typeof K=="object"&&!X||!((B=this.filteredSubscriptions)===null||B===void 0)&&B.has(X)){this._getAndDeleteFilteredSubscriptions(K,X).forEach(function(V){return y.subscriptions.off(V)});return}this.subscriptions.off(K,X)},T.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new v.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var y=this.connectionManager;if(!y.activeState())throw y.getError();var B=c.default.fromValues({action:z.SYNC,channel:this.name});this.syncChannelSerial&&(B.channelSerial=this.syncChannelSerial),y.send(B)},T.prototype.sendMessage=function(y,B){this.connectionManager.send(y,this.realtime.options.queueMessages,B)},T.prototype.sendPresence=function(y,B){var j=c.default.fromValues({action:z.PRESENCE,channel:this.name,presence:g.isArray(y)?D.default.fromValuesArray(y):[D.default.fromValues(y)]});this.sendMessage(j,B)},T.prototype.onMessage=function(y){(y.action===z.ATTACHED||y.action===z.MESSAGE||y.action===z.PRESENCE)&&this.setChannelSerial(y.channelSerial);var B,j=!1;switch(y.action){case z.ATTACHED:{this.properties.attachSerial=y.channelSerial,this._mode=y.getMode(),this.params=y.params||{};var H=y.decodeModesFromFlags();this.modes=H&&g.allToLowerCase(H)||void 0;var Q=y.hasFlag("RESUMED"),K=y.hasFlag("HAS_PRESENCE"),X=y.hasFlag("HAS_BACKLOG");if(this.state==="attached"){Q||this.presence.onAttached(K);var V=new O.default(this.state,this.state,Q,X,y.error);this._allChannelChanges.emit("update",V),(!Q||this.channelOptions.updateOnAttached)&&this.emit("update",V)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",y.error,Q,K,X);break}case z.DETACHED:{var U=y.error?v.default.fromValues(y.error):new v.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",U):this.state==="attaching"?this.notifyState("suspended",U):this.requestState("attaching",U);break}case z.SYNC:if(j=!0,B=this.syncChannelSerial=y.channelSerial,!y.presence)break;case z.PRESENCE:{for(var I=y.presence,F=y.id,W=y.connectionId,at=y.timestamp,Z=this.channelOptions,rt=void 0,it=0;it<I.length;it++)try{rt=I[it],D.default.decode(rt,Z),rt.connectionId||(rt.connectionId=W),rt.timestamp||(rt.timestamp=at),rt.id||(rt.id=F+":"+it)}catch(At){_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",At.toString())}this.presence.setPresence(I,j,B);break}case z.MESSAGE:{if(this.state!=="attached"){_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+y.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var Y=y.messages,J=Y[0],tt=Y[Y.length-1],F=y.id,W=y.connectionId,at=y.timestamp;if(J.extras&&J.extras.delta&&J.extras.delta.from!==this._lastPayload.messageId){var et='Delta message decode failure - previous message not available for message "'+y.id+'" on this channel "'+this.name+'".';_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",et),this._startDecodeFailureRecovery(new v.default(et,40018,400));break}for(var it=0;it<Y.length;it++){var et=Y[it];try{E.default.decode(et,this._decodingContext)}catch(kt){switch(_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",kt.toString()),kt.code){case 40018:this._startDecodeFailureRecovery(kt);return;case 40019:case 40021:this.notifyState("failed",kt);return}}et.connectionId||(et.connectionId=W),et.timestamp||(et.timestamp=at),et.id||(et.id=F+":"+it)}this._lastPayload.messageId=tt.id,this._lastPayload.protocolMessageChannelSerial=y.channelSerial,this.onEvent(Y);break}case z.ERROR:{var gt=y.error;gt&&gt.code==80016?this.checkPendingState():this.notifyState("failed",v.default.fromValues(gt));break}default:_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+y.action+")"),this.connectionManager.abort(L.default.unknownChannelErr())}},T.prototype._startDecodeFailureRecovery=function(y){var B=this;this._lastPayload.decodeFailureRecoveryInProgress||(_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,y,function(){B._lastPayload.decodeFailureRecoveryInProgress=!1}))},T.prototype.onAttached=function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},T.prototype.notifyState=function(y,B,j,H,Q){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+y),this.clearStateTimer(),g.arrIn(["detached","suspended","failed"],y)&&(this.properties.channelSerial=null),y!==this.state){this.presence.actOnChannelState(y,H,B),y==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),B&&(this.errorReason=B);var K=new O.default(this.state,y,j,Q,B),X=y==="failed"?_.default.LOG_ERROR:_.default.LOG_MAJOR;_.default.logAction(X,'Channel state for channel "'+this.name+'"',y+(B?"; reason: "+B:"")),y!=="attaching"&&y!=="suspended"&&(this.retryCount=0),y==="attached"&&this.onAttached(),y==="attached"?this._attachResume=!0:(y==="detaching"||y==="failed")&&(this._attachResume=!1),this.state=y,this._allChannelChanges.emit(y,K),this.emit(y,K)}},T.prototype.requestState=function(y,B){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+y),this.notifyState(y,B),this.checkPendingState()},T.prototype.checkPendingState=function(){var y=this.connectionManager.state;if(!(y.sendEvents||y.forceQueueEvents)){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},T.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var y=new v.default("Channel attach timed out",90007,408);this.notifyState("suspended",y);break}case"detaching":{var y=new v.default("Channel detach timed out",90007,408);this.notifyState("attached",y);break}default:this.checkPendingState();break}},T.prototype.startStateTimerIfNotRunning=function(){var y=this;this.stateTimer||(this.stateTimer=setTimeout(function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),y.stateTimer=null,y.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},T.prototype.clearStateTimer=function(){var y=this.stateTimer;y&&(clearTimeout(y),this.stateTimer=null)},T.prototype.startRetryTimer=function(){var y=this;if(!this.retryTimer){this.retryCount++;var B=g.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){y.state==="suspended"&&y.connectionManager.state.sendEvents&&(y.retryTimer=null,_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),y.requestState("attaching"))},B)}},T.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},T.prototype.getReleaseErr=function(){var y=this.state;return y==="initialized"||y==="detached"||y==="failed"?null:new v.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+y,90001,400)},T.prototype.setChannelSerial=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+y+"; previous = "+this.properties.channelSerial),y&&(this.properties.channelSerial=y)},T})(m.default);function R(A){var T=A||{};T.agent;var y=l.__rest(T,["agent"]);return y}i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=(function(){function c(d,g,m,_,C){this.previous=d,this.current=g,g==="attached"&&(this.resumed=m,this.hasBacklog=_),C&&(this.reason=C)}return c})();i.default=l}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=d.Hasher,_=c.algo,C=[],E=_.SHA1=m.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(O,v){for(var D=this._hash.words,L=D[0],z=D[1],M=D[2],N=D[3],G=D[4],R=0;R<80;R++){if(R<16)C[R]=O[v+R]|0;else{var A=C[R-3]^C[R-8]^C[R-14]^C[R-16];C[R]=A<<1|A>>>31}var T=(L<<5|L>>>27)+G+C[R];R<20?T+=(z&M|~z&N)+1518500249:R<40?T+=(z^M^N)+1859775393:R<60?T+=(z&M|z&N|M&N)-1894007588:T+=(z^M^N)-899497514,G=N,N=M,M=z<<30|z>>>2,z=L,L=T}D[0]=D[0]+L|0,D[1]=D[1]+z|0,D[2]=D[2]+M|0,D[3]=D[3]+N|0,D[4]=D[4]+G|0},_doFinalize:function(){var O=this._data,v=O.words,D=this._nDataBytes*8,L=O.sigBytes*8;return v[L>>>5]|=128<<24-L%32,v[(L+64>>>9<<4)+14]=Math.floor(D/4294967296),v[(L+64>>>9<<4)+15]=D,O.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var O=m.clone.call(this);return O._hash=this._hash.clone(),O}});c.SHA1=m._createHelper(E),c.HmacSHA1=m._createHmacHelper(E)})(),l.SHA1})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});function l(R){if(R===void 0)return"undefined";var A,T;if(R instanceof ArrayBuffer?(T="ArrayBuffer",A=new DataView(R)):R instanceof DataView&&(T="DataView",A=R),!A)return JSON.stringify(R);for(var y=[],B=0;B<R.byteLength;B++){if(B>20){y.push("...");break}var j=A.getUint8(B).toString(16);j.length===1&&(j="0"+j),y.push(j)}return"<"+T+" "+y.join(" ")+">"}function c(R,A,T){for(var y=0,B=T.length;y<B;y++){var j=T.charCodeAt(y);if(j<128){R.setUint8(A++,j>>>0&127|0);continue}if(j<2048){R.setUint8(A++,j>>>6&31|192),R.setUint8(A++,j>>>0&63|128);continue}if(j<65536){R.setUint8(A++,j>>>12&15|224),R.setUint8(A++,j>>>6&63|128),R.setUint8(A++,j>>>0&63|128);continue}if(j<1114112){R.setUint8(A++,j>>>18&7|240),R.setUint8(A++,j>>>12&63|128),R.setUint8(A++,j>>>6&63|128),R.setUint8(A++,j>>>0&63|128);continue}throw new Error("bad codepoint "+j)}}function d(R,A,T){for(var y="",B=A,j=A+T;B<j;B++){var H=R.getUint8(B);if((H&128)===0){y+=String.fromCharCode(H);continue}if((H&224)===192){y+=String.fromCharCode((H&15)<<6|R.getUint8(++B)&63);continue}if((H&240)===224){y+=String.fromCharCode((H&15)<<12|(R.getUint8(++B)&63)<<6|(R.getUint8(++B)&63)<<0);continue}if((H&248)===240){y+=String.fromCharCode((H&7)<<18|(R.getUint8(++B)&63)<<12|(R.getUint8(++B)&63)<<6|(R.getUint8(++B)&63)<<0);continue}throw new Error("Invalid byte "+H.toString(16))}return y}function g(R){for(var A=0,T=0,y=R.length;T<y;T++){var B=R.charCodeAt(T);if(B<128){A+=1;continue}if(B<2048){A+=2;continue}if(B<65536){A+=3;continue}if(B<1114112){A+=4;continue}throw new Error("bad codepoint "+B)}return A}function m(R,A){var T=G(R,A);if(T!==0){var y=new ArrayBuffer(T),B=new DataView(y);return N(R,B,0,A),y}}var _=65536*65536,C=1/_;function E(R,A){return A=A||0,R.getInt32(A)*_+R.getUint32(A+4)}function O(R,A){return A=A||0,R.getUint32(A)*_+R.getUint32(A+4)}function v(R,A,T){T<9223372036854776e3?(R.setInt32(A,Math.floor(T*C)),R.setInt32(A+4,T&-1)):(R.setUint32(A,2147483647),R.setUint32(A+4,2147483647))}function D(R,A,T){T<18446744073709552e3?(R.setUint32(A,Math.floor(T*C)),R.setInt32(A+4,T&-1)):(R.setUint32(A,4294967295),R.setUint32(A+4,4294967295))}var L=(function(){function R(A,T){var y=this;this.map=function(B){for(var j={},H=0;H<B;H++){var Q=y.parse();j[Q]=y.parse()}return j},this.bin=function(B){var j=new ArrayBuffer(B);return new Uint8Array(j).set(new Uint8Array(y.view.buffer,y.offset,B),0),y.offset+=B,j},this.buf=this.bin,this.str=function(B){var j=d(y.view,y.offset,B);return y.offset+=B,j},this.array=function(B){for(var j=new Array(B),H=0;H<B;H++)j[H]=y.parse();return j},this.ext=function(B){return y.offset+=B,{type:y.view.getInt8(y.offset),data:y.buf(B)}},this.parse=function(){var B=y.view.getUint8(y.offset),j,H;if((B&128)===0)return y.offset++,B;if((B&240)===128)return H=B&15,y.offset++,y.map(H);if((B&240)===144)return H=B&15,y.offset++,y.array(H);if((B&224)===160)return H=B&31,y.offset++,y.str(H);if((B&224)===224)return j=y.view.getInt8(y.offset),y.offset++,j;switch(B){case 192:return y.offset++,null;case 193:y.offset++;return;case 194:return y.offset++,!1;case 195:return y.offset++,!0;case 196:return H=y.view.getUint8(y.offset+1),y.offset+=2,y.bin(H);case 197:return H=y.view.getUint16(y.offset+1),y.offset+=3,y.bin(H);case 198:return H=y.view.getUint32(y.offset+1),y.offset+=5,y.bin(H);case 199:return H=y.view.getUint8(y.offset+1),y.offset+=2,y.ext(H);case 200:return H=y.view.getUint16(y.offset+1),y.offset+=3,y.ext(H);case 201:return H=y.view.getUint32(y.offset+1),y.offset+=5,y.ext(H);case 202:return j=y.view.getFloat32(y.offset+1),y.offset+=5,j;case 203:return j=y.view.getFloat64(y.offset+1),y.offset+=9,j;case 204:return j=y.view.getUint8(y.offset+1),y.offset+=2,j;case 205:return j=y.view.getUint16(y.offset+1),y.offset+=3,j;case 206:return j=y.view.getUint32(y.offset+1),y.offset+=5,j;case 207:return j=O(y.view,y.offset+1),y.offset+=9,j;case 208:return j=y.view.getInt8(y.offset+1),y.offset+=2,j;case 209:return j=y.view.getInt16(y.offset+1),y.offset+=3,j;case 210:return j=y.view.getInt32(y.offset+1),y.offset+=5,j;case 211:return j=E(y.view,y.offset+1),y.offset+=9,j;case 212:return H=1,y.offset++,y.ext(H);case 213:return H=2,y.offset++,y.ext(H);case 214:return H=4,y.offset++,y.ext(H);case 215:return H=8,y.offset++,y.ext(H);case 216:return H=16,y.offset++,y.ext(H);case 217:return H=y.view.getUint8(y.offset+1),y.offset+=2,y.str(H);case 218:return H=y.view.getUint16(y.offset+1),y.offset+=3,y.str(H);case 219:return H=y.view.getUint32(y.offset+1),y.offset+=5,y.str(H);case 220:return H=y.view.getUint16(y.offset+1),y.offset+=3,y.array(H);case 221:return H=y.view.getUint32(y.offset+1),y.offset+=5,y.array(H);case 222:return H=y.view.getUint16(y.offset+1),y.offset+=3,y.map(H);case 223:return H=y.view.getUint32(y.offset+1),y.offset+=5,y.map(H)}throw new Error("Unknown type 0x"+B.toString(16))},this.offset=T||0,this.view=A}return R})();function z(R){var A=new DataView(R),T=new L(A),y=T.parse();if(T.offset!==R.byteLength)throw new Error(R.byteLength-T.offset+" trailing bytes");return y}function M(R,A){return Object.keys(R).filter(function(T){var y=R[T],B=typeof y;return(!A||y!=null)&&(B!=="function"||!!y.toJSON)})}function N(R,A,T,y){var B=typeof R;if(typeof R=="string"){var j=g(R);if(j<32)return A.setUint8(T,j|160),c(A,T+1,R),1+j;if(j<256)return A.setUint8(T,217),A.setUint8(T+1,j),c(A,T+2,R),2+j;if(j<65536)return A.setUint8(T,218),A.setUint16(T+1,j),c(A,T+3,R),3+j;if(j<4294967296)return A.setUint8(T,219),A.setUint32(T+1,j),c(A,T+5,R),5+j}if(ArrayBuffer.isView&&ArrayBuffer.isView(R)&&(R=R.buffer),R instanceof ArrayBuffer){var H=R.byteLength;if(H<256)return A.setUint8(T,196),A.setUint8(T+1,H),new Uint8Array(A.buffer).set(new Uint8Array(R),T+2),2+H;if(H<65536)return A.setUint8(T,197),A.setUint16(T+1,H),new Uint8Array(A.buffer).set(new Uint8Array(R),T+3),3+H;if(H<4294967296)return A.setUint8(T,198),A.setUint32(T+1,H),new Uint8Array(A.buffer).set(new Uint8Array(R),T+5),5+H}if(typeof R=="number"){if(Math.floor(R)!==R)return A.setUint8(T,203),A.setFloat64(T+1,R),9;if(R>=0){if(R<128)return A.setUint8(T,R),1;if(R<256)return A.setUint8(T,204),A.setUint8(T+1,R),2;if(R<65536)return A.setUint8(T,205),A.setUint16(T+1,R),3;if(R<4294967296)return A.setUint8(T,206),A.setUint32(T+1,R),5;if(R<18446744073709552e3)return A.setUint8(T,207),D(A,T+1,R),9;throw new Error("Number too big 0x"+R.toString(16))}if(R>=-32)return A.setInt8(T,R),1;if(R>=-128)return A.setUint8(T,208),A.setInt8(T+1,R),2;if(R>=-32768)return A.setUint8(T,209),A.setInt16(T+1,R),3;if(R>=-2147483648)return A.setUint8(T,210),A.setInt32(T+1,R),5;if(R>=-9223372036854776e3)return A.setUint8(T,211),v(A,T+1,R),9;throw new Error("Number too small -0x"+(-R).toString(16).substr(1))}if(B==="undefined")return y?0:(A.setUint8(T,212),A.setUint8(T+1,0),A.setUint8(T+2,0),3);if(R===null)return y?0:(A.setUint8(T,192),1);if(B==="boolean")return A.setUint8(T,R?195:194),1;if(typeof R.toJSON=="function")return N(R.toJSON(),A,T,y);if(B==="object"){var Q,K=0,X=void 0,V=Array.isArray(R);if(V?Q=R.length:(X=M(R,y),Q=X.length),Q<16?(A.setUint8(T,Q|(V?144:128)),K=1):Q<65536?(A.setUint8(T,V?220:222),A.setUint16(T+1,Q),K=3):Q<4294967296&&(A.setUint8(T,V?221:223),A.setUint32(T+1,Q),K=5),V)for(var U=0;U<Q;U++)K+=N(R[U],A,T+K,y);else if(X)for(var U=0;U<Q;U++){var I=X[U];K+=N(I,A,T+K),K+=N(R[I],A,T+K,y)}return K}if(B==="function")return 0;throw new Error("Unknown type "+B)}function G(R,A){var T=typeof R;if(T==="string"){var y=g(R);if(y<32)return 1+y;if(y<256)return 2+y;if(y<65536)return 3+y;if(y<4294967296)return 5+y}if(ArrayBuffer.isView&&ArrayBuffer.isView(R)&&(R=R.buffer),R instanceof ArrayBuffer){var B=R.byteLength;if(B<256)return 2+B;if(B<65536)return 3+B;if(B<4294967296)return 5+B}if(typeof R=="number"){if(Math.floor(R)!==R)return 9;if(R>=0){if(R<128)return 1;if(R<256)return 2;if(R<65536)return 3;if(R<4294967296)return 5;if(R<18446744073709552e3)return 9;throw new Error("Number too big 0x"+R.toString(16))}if(R>=-32)return 1;if(R>=-128)return 2;if(R>=-32768)return 3;if(R>=-2147483648)return 5;if(R>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+R.toString(16).substr(1))}if(T==="boolean")return 1;if(R===null)return A?0:1;if(R===void 0)return A?0:3;if(typeof R.toJSON=="function")return G(R.toJSON(),A);if(T==="object"){var j,H=0;if(Array.isArray(R)){j=R.length;for(var Q=0;Q<j;Q++)H+=G(R[Q],A)}else{var K=M(R,A);j=K.length;for(var Q=0;Q<j;Q++){var X=K[Q];H+=G(X)+G(R[X],A)}}if(j<16)return 1+H;if(j<65536)return 3+H;if(j<4294967296)return 5+H;throw new Error("Array or object too long 0x"+j.toString(16))}if(T==="function")return 0;throw new Error("Unknown type "+T)}i.default={encode:m,decode:z,inspect:l,utf8Write:c,utf8Read:d,utf8ByteCount:g}}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(30)),d=l.__importDefault(r(50)),g=l.__importDefault(r(3)),m=l.__importDefault(r(4)),_=l.__importDefault(r(55)),C=l.__importDefault(r(57)),E=l.__importDefault(r(62)),O=l.__importDefault(r(64)),v=l.__importDefault(r(68)),D=l.__importDefault(r(2)),L=r(8),z=l.__importDefault(r(65)),M=l.__importDefault(r(66)),N=l.__importDefault(r(41)),G=(0,C.default)(O.default,_.default);g.default.Crypto=G,g.default.BufferUtils=_.default,g.default.Http=E.default,g.default.Config=O.default,g.default.Transports=v.default,g.default.WebStorage=z.default,c.default.Crypto=G,d.default.Crypto=G,D.default.initLogHandlers(),g.default.Defaults=(0,L.getDefaults)(M.default),g.default.Config.agent&&(g.default.Defaults.agent+=" "+g.default.Config.agent),g.default.Config.noUpgrade&&(g.default.Defaults.upgradeTransports=[]),i.default={ErrorInfo:m.default,Rest:c.default,Realtime:d.default,msgpack:N.default}}),(function(n){n.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')}),(function(n,i){}),(function(n,i,r){(function(l,c){n.exports=c(r(6),r(32),r(25))})(this,function(l){return l.HmacSHA256})}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(47)),g=l.__importDefault(r(15)),m=l.__importDefault(r(20)),_=l.__importDefault(r(4)),C=l.__importDefault(r(48)),E=function(){},O=(function(){function z(M){this.rest=M,this.admin=new v(M)}return z})(),v=(function(){function z(M){this.rest=M,this.deviceRegistrations=new D(M),this.channelSubscriptions=new L(M)}return z.prototype.publish=function(M,N,G){var R=this.rest,A=R.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultPostHeaders(R.options,A),y={},B=c.mixin({recipient:M},N);if(typeof G!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);G=E}R.options.headers&&c.mixin(T,R.options.headers),R.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var j=c.encodeBody(B,A);g.default.post(R,"/push/publish",j,T,y,null,function(H){return G(H)})},z})(),D=(function(){function z(M){this.rest=M}return z.prototype.save=function(M,N){var G=this.rest,R=d.default.fromValues(M),A=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultPostHeaders(G.options,A),y={};if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),G.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var B=c.encodeBody(R,A);g.default.put(G,"/push/deviceRegistrations/"+encodeURIComponent(M.id),B,T,y,null,function(j,H,Q,K){N(j,j?void 0:d.default.fromResponseBody(H,K?void 0:A))})},z.prototype.get=function(M,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultGetHeaders(G.options,R),T=M.id||M;if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"get",arguments);N=E}if(typeof T!="string"||!T.length){N(new _.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&c.mixin(A,G.options.headers),g.default.get(G,"/push/deviceRegistrations/"+encodeURIComponent(T),A,{},null,function(y,B,j,H){N(y,y?void 0:d.default.fromResponseBody(B,H?void 0:R))})},z.prototype.list=function(M,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:R,T=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),new m.default(G,"/push/deviceRegistrations",T,A,function(y,B,j){return d.default.fromResponseBody(y,j?void 0:R)}).get(M,N)},z.prototype.remove=function(M,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultGetHeaders(G.options,R),T={},y=M.id||M;if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"remove",arguments);N=E}if(typeof y!="string"||!y.length){N(new _.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&c.mixin(A,G.options.headers),G.options.pushFullWait&&c.mixin(T,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations/"+encodeURIComponent(y),A,T,null,function(B){return N(B)})},z.prototype.removeWhere=function(M,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);N=E}G.options.headers&&c.mixin(A,G.options.headers),G.options.pushFullWait&&c.mixin(M,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations",A,M,null,function(T){return N(T)})},z})(),L=(function(){function z(M){this.remove=z.prototype.removeWhere,this.rest=M}return z.prototype.save=function(M,N){var G=this.rest,R=C.default.fromValues(M),A=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultPostHeaders(G.options,A),y={};if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),G.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var B=c.encodeBody(R,A);g.default.post(G,"/push/channelSubscriptions",B,T,y,null,function(j,H,Q,K){N(j,!j&&C.default.fromResponseBody(H,K?void 0:A))})},z.prototype.list=function(M,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:R,T=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),new m.default(G,"/push/channelSubscriptions",T,A,function(y,B,j){return C.default.fromResponseBody(y,j?void 0:R)}).get(M,N)},z.prototype.removeWhere=function(M,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);N=E}G.options.headers&&c.mixin(A,G.options.headers),G.options.pushFullWait&&c.mixin(M,{fullWait:"true"}),g.default.delete(G,"/push/channelSubscriptions",A,M,null,function(T){return N(T)})},z.prototype.listChannels=function(M,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:R,T=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"listChannels",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),G.options.pushFullWait&&c.mixin(M,{fullWait:"true"}),new m.default(G,"/push/channels",T,A,function(y,B,j){for(var H=!j&&R?c.decodeBody(y,R):y,Q=0;Q<H.length;Q++)H[Q]=String(H[Q]);return H}).get(M,N)},z})();i.default=O}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(4)),g;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(g||(g={}));var m;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(m||(m={}));var _=(function(){function C(){}return C.prototype.toJSON=function(){var E,O,v;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(O=this.push)===null||O===void 0?void 0:O.state,error:(v=this.push)===null||v===void 0?void 0:v.error}}},C.prototype.toString=function(){var E,O,v,D,L="[DeviceDetails";return this.id&&(L+="; id="+this.id),this.platform&&(L+="; platform="+this.platform),this.formFactor&&(L+="; formFactor="+this.formFactor),this.clientId&&(L+="; clientId="+this.clientId),this.metadata&&(L+="; metadata="+this.metadata),this.deviceIdentityToken&&(L+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(L+="; push.recipient="+JSON.stringify(this.push.recipient)),!((O=this.push)===null||O===void 0)&&O.state&&(L+="; push.state="+this.push.state),!((v=this.push)===null||v===void 0)&&v.error&&(L+="; push.error="+JSON.stringify(this.push.error)),!((D=this.push)===null||D===void 0)&&D.metadata&&(L+="; push.metadata="+this.push.metadata),L+="]",L},C.fromResponseBody=function(E,O){return O&&(E=c.decodeBody(E,O)),c.isArray(E)?C.fromValuesArray(E):C.fromValues(E)},C.fromValues=function(E){return E.error=E.error&&d.default.fromValues(E.error),Object.assign(new C,E)},C.fromValuesArray=function(E){for(var O=E.length,v=new Array(O),D=0;D<O;D++)v[D]=C.fromValues(E[D]);return v},C.toRequestBody=c.encodeBody,C})();i.default=_}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=(function(){function g(){}return g.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},g.prototype.toString=function(){var m="[PushChannelSubscription";return this.channel&&(m+="; channel="+this.channel),this.deviceId&&(m+="; deviceId="+this.deviceId),this.clientId&&(m+="; clientId="+this.clientId),m+="]",m},g.fromResponseBody=function(m,_){return _&&(m=c.decodeBody(m,_)),c.isArray(m)?g.fromValuesArray(m):g.fromValues(m)},g.fromValues=function(m){return Object.assign(new g,m)},g.fromValuesArray=function(m){for(var _=m.length,C=new Array(_),E=0;E<_;E++)C[E]=g.fromValues(m[E]);return C},g.toRequestBody=c.encodeBody,g})();i.default=d}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=(function(){function G(R){this.count=R&&R.count||0,this.data=R&&R.data||0,this.uncompressedData=R&&R.uncompressedData||0,this.failed=R&&R.failed||0,this.refused=R&&R.refused||0}return G})(),g=(function(G){l.__extends(R,G);function R(A){var T=G.call(this,A)||this;return A&&A.category&&(T.category={},c.forInOwnNonNullProperties(A.category,function(y){T.category[y]=new d(A.category[y])})),T}return R})(d),m=(function(){function G(R){this.peak=R&&R.peak||0,this.min=R&&R.min||0,this.mean=R&&R.mean||0,this.opened=R&&R.opened||0,this.refused=R&&R.refused||0}return G})(),_=(function(){function G(R){this.succeeded=R&&R.succeeded||0,this.failed=R&&R.failed||0,this.refused=R&&R.refused||0}return G})(),C=(function(){function G(R){this.plain=new m(R&&R.plain),this.tls=new m(R&&R.tls),this.all=new m(R&&R.all)}return G})(),E=(function(){function G(R){this.messages=new g(R&&R.messages),this.presence=new g(R&&R.presence),this.all=new g(R&&R.all)}return G})(),O=(function(){function G(R){this.realtime=new E(R&&R.realtime),this.rest=new E(R&&R.rest),this.webhook=new E(R&&R.webhook),this.sharedQueue=new E(R&&R.sharedQueue),this.externalQueue=new E(R&&R.externalQueue),this.httpEvent=new E(R&&R.httpEvent),this.push=new E(R&&R.push),this.all=new E(R&&R.all)}return G})(),v=(function(){function G(R){this.all=new E(R&&R.all),this.inbound=new O(R&&R.inbound),this.outbound=new O(R&&R.outbound)}return G})(),D=(function(){function G(R){this.all=new E(R&&R.all),this.producerPaid=new v(R&&R.producerPaid),this.consumerPaid=new v(R&&R.consumerPaid)}return G})(),L=(function(){function G(R){this.messages=R&&R.messages||0;var A=R&&R.notifications;this.notifications={invalid:A&&A.invalid||0,attempted:A&&A.attempted||0,successful:A&&A.successful||0,failed:A&&A.failed||0},this.directPublishes=R&&R.directPublishes||0}return G})(),z=(function(){function G(R){this.succeeded=R&&R.succeeded||0,this.skipped=R&&R.skipped||0,this.failed=R&&R.failed||0}return G})(),M=(function(){function G(R){var A=this;this.delta=void 0,R&&R.delta&&(this.delta={},c.forInOwnNonNullProperties(R.delta,function(T){A.delta[T]=new z(R.delta[T])}))}return G})(),N=(function(G){l.__extends(R,G);function R(A){var T=G.call(this,A)||this;return T.persisted=new E(A&&A.persisted),T.connections=new C(A&&A.connections),T.channels=new m(A&&A.channels),T.apiRequests=new _(A&&A.apiRequests),T.tokenRequests=new _(A&&A.tokenRequests),T.xchgProducer=new D(A&&A.xchgProducer),T.xchgConsumer=new D(A&&A.xchgConsumer),T.push=new L(A&&A.pushStats),T.processed=new M(A&&A.processed),T.inProgress=A&&A.inProgress||void 0,T.unit=A&&A.unit||void 0,T.intervalId=A&&A.intervalId||void 0,T}return R.fromValues=function(A){return new R(A)},R})(v);i.default=N}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(30)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(51)),C=l.__importDefault(r(38)),E=l.__importDefault(r(8)),O=l.__importDefault(r(4)),v=l.__importDefault(r(10)),D=l.__importDefault(r(35)),L=l.__importDefault(r(3)),z=l.__importDefault(r(9)),M=(function(G){l.__extends(R,G);function R(A){var T=G.call(this,A)||this;return m.default.logAction(m.default.LOG_MINOR,"Realtime()",""),T.connection=new _.default(T,T.options),T.channels=new N(T),A.autoConnect!==!1&&T.connect(),T}return R.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},R.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},R.Promise=function(A){return A=E.default.objectifyOptions(A),A.promises=!0,new R(A)},R.Callbacks=R,R.Utils=c,R.ConnectionManager=D.default,R.Platform=L.default,R.ProtocolMessage=v.default,R.Message=z.default,R})(d.default),N=(function(G){l.__extends(R,G);function R(A){var T=G.call(this)||this;return T.realtime=A,T.all=Object.create(null),A.connection.connectionManager.on("transport.active",function(){T.onTransportActive()}),T}return R.prototype.channelSerials=function(){for(var A={},T=0,y=c.keysArray(this.all,!0);T<y.length;T++){var B=y[T],j=this.all[B];j.properties.channelSerial&&(A[B]=j.properties.channelSerial)}return A},R.prototype.recoverChannels=function(A){for(var T=0,y=c.keysArray(A,!0);T<y.length;T++){var B=y[T],j=this.get(B);j.properties.channelSerial=A[B]}},R.prototype.onChannelMessage=function(A){var T=A.channel;if(T===void 0){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+A.action);return}var y=this.all[T];if(!y){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+T);return}y.onMessage(A)},R.prototype.onTransportActive=function(){for(var A in this.all){var T=this.all[A];T.state==="attaching"||T.state==="detaching"?T.checkPendingState():T.state==="suspended"?T._attach(!1,null):T.state==="attached"&&T.requestState("attaching")}},R.prototype.propogateConnectionInterruption=function(A,T){var y={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},B=["attaching","attached","detaching","suspended"],j=y[A];for(var H in this.all){var Q=this.all[H];c.arrIn(B,Q.state)&&Q.notifyState(j,T)}},R.prototype.get=function(A,T){A=String(A);var y=this.all[A];if(!y)y=this.all[A]=new C.default(this.realtime,A,T);else if(T){if(y._shouldReattachToSetOptions(T,y.channelOptions))throw new O.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);y.setOptions(T)}return y},R.prototype.getDerived=function(A,T,y){if(T.filter){var B=c.toBase64(T.filter),j=c.matchDerivedChannel(A);A="[filter=".concat(B).concat(j.qualifierParam,"]").concat(j.channelName)}return this.get(A,y)},R.prototype.release=function(A){A=String(A);var T=this.all[A];if(T){var y=T.getReleaseErr();if(y)throw y;delete this.all[A]}},R})(g.default);i.default=M}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(35)),m=l.__importDefault(r(2)),_=l.__importDefault(r(37)),C=l.__importDefault(r(3));function E(){}var O=(function(v){l.__extends(D,v);function D(L,z){var M=v.call(this)||this;return M.whenState=(function(N,G){return d.default.prototype.whenState.call(M,N,M.state,G,new _.default(void 0,N))}),M.ably=L,M.connectionManager=new g.default(L,z),M.state=M.connectionManager.state.state,M.key=void 0,M.id=void 0,M.errorReason=null,M.connectionManager.on("connectionstate",function(N){var G=M.state=N.current;C.default.Config.nextTick(function(){M.emit(G,N)})}),M.connectionManager.on("update",function(N){C.default.Config.nextTick(function(){M.emit("update",N)})}),M}return D.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},D.prototype.ping=function(L){if(m.default.logAction(m.default.LOG_MINOR,"Connection.ping()",""),!L){if(this.ably.options.promises)return c.promisify(this,"ping",arguments);L=E}this.connectionManager.ping(null,L)},D.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(D.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),D.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},D})(d.default);i.default=O}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.PendingMessage=void 0;var l=r(0),c=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(36)),C=l.__importDefault(r(4)),E=c.default.Action,O=(function(){function D(L,z){this.message=L,this.callback=z,this.merged=!1;var M=L.action;this.sendAttempted=!1,this.ackRequired=M==E.MESSAGE||M==E.PRESENCE}return D})();i.PendingMessage=O;var v=(function(D){l.__extends(L,D);function L(z){var M=D.call(this)||this;return M.transport=z,M.messageQueue=new _.default,z.on("ack",function(N,G){M.onAck(N,G)}),z.on("nack",function(N,G,R){M.onNack(N,G,R)}),M}return L.prototype.onAck=function(z,M){m.default.logAction(m.default.LOG_MICRO,"Protocol.onAck()","serial = "+z+"; count = "+M),this.messageQueue.completeMessages(z,M)},L.prototype.onNack=function(z,M,N){m.default.logAction(m.default.LOG_ERROR,"Protocol.onNack()","serial = "+z+"; count = "+M+"; err = "+d.inspectError(N)),N||(N=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(z,M,N)},L.prototype.onceIdle=function(z){var M=this.messageQueue;if(M.count()===0){z();return}M.once("idle",z)},L.prototype.send=function(z){z.ackRequired&&this.messageQueue.push(z),m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Protocol.send()","sending msg; "+c.default.stringify(z.message)),z.sendAttempted=!0,this.transport.send(z.message)},L.prototype.getTransport=function(){return this.transport},L.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},L.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},L.prototype.finish=function(){var z=this.transport;this.onceIdle(function(){z.disconnect()})},L})(g.default);i.default=v}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(26)),m=l.__importDefault(r(8)),_=l.__importDefault(r(2)),C=l.__importDefault(r(10)),E=l.__importDefault(r(4)),O="web_socket";function v(z){return!!z.on}var D=(function(z){l.__extends(M,z);function M(N,G,R){var A=z.call(this,N,G,R)||this;return A.shortName=O,R.heartbeats=c.default.Config.useProtocolHeartbeats,A.wsHost=m.default.getHost(R.options,R.host,!0),A}return M.isAvailable=function(){return!!c.default.Config.WebSocket},M.prototype.createWebSocket=function(N,G){return this.uri=N+d.toQueryString(G),new c.default.Config.WebSocket(this.uri)},M.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},M.prototype.connect=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),g.default.prototype.connect.call(this);var N=this,G=this.params,R=G.options,A=R.tls?"wss://":"ws://",T=A+this.wsHost+":"+m.default.getPort(R)+"/";_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+T),this.auth.getAuthParams(function(y,B){if(!N.isDisposed){var j="";for(var H in B)j+=" "+H+": "+B[H]+";";if(_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+j+" err: "+y),y){N.disconnect(y);return}var Q=G.getConnectParams(B);try{var K=N.wsConnection=N.createWebSocket(T,Q);K.binaryType=c.default.Config.binaryType,K.onopen=function(){N.onWsOpen()},K.onclose=function(X){N.onWsClose(X)},K.onmessage=function(X){N.onWsData(X.data)},K.onerror=function(X){N.onWsError(X)},v(K)&&K.on("ping",function(){N.onActivity()})}catch(X){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(X.stack||X.message)),N.disconnect(X)}}})},M.prototype.send=function(N){var G=this.wsConnection;if(!G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{G.send(C.default.serialize(N,this.params.format))}catch(A){var R="Exception from ws connection when trying to send: "+d.inspectError(A);_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()",R),this.finish("disconnected",new E.default(R,5e4,500))}},M.prototype.onWsData=function(N){_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+N.length+"; type = "+typeof N);try{this.onProtocolMessage(C.default.deserialize(N,this.format))}catch(G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+G.stack)}},M.prototype.onWsOpen=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},M.prototype.onWsClose=function(N){var G,R;if(typeof N=="object"?(R=N.code,G=N.wasClean||R===1e3):(R=N,G=R==1e3),delete this.wsConnection,G){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var A=new E.default("Websocket closed",80003,400);this.finish("disconnected",A)}else{var T="Unclean disconnection of WebSocket ; code = "+R,A=new E.default(T,80003,400);_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()",T),this.finish("disconnected",A)}this.emit("disposed")},M.prototype.onWsError=function(N){var G=this;_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+N.message),c.default.Config.nextTick(function(){G.disconnect(Error(N.message))})},M.prototype.dispose=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var N=this.wsConnection;N&&(N.onmessage=function(){},delete this.wsConnection,c.default.Config.nextTick(function(){if(_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!N)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");N.close()}))},M})(g.default);function L(z){return D.isAvailable()&&(z.supportedTransports[O]=D),D}i.default=L}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(34)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(16)),C=l.__importStar(r(4)),E=l.__importDefault(r(38)),O=l.__importDefault(r(24)),v=l.__importDefault(r(39)),D=function(){};function L(A){return A.channel.realtime.auth.clientId}function z(A){var T=A.channel.realtime,y=T.auth.clientId;return(!y||y==="*")&&T.connection.state==="connected"}function M(A,T,y){switch(A.state){case"attached":case"suspended":y();break;case"initialized":case"detached":case"detaching":case"attaching":A.attach(function(B){B?T(B):y()});break;default:T(C.default.fromValues(A.invalidStateError()))}}function N(A,T){if(A.isSynthesized()||T.isSynthesized())return A.timestamp>=T.timestamp;var y=A.parseId(),B=T.parseId();return y.msgSerial===B.msgSerial?y.index>B.index:y.msgSerial>B.msgSerial}var G=(function(A){l.__extends(T,A);function T(y){var B=A.call(this,y)||this;return B.channel=y,B.syncComplete=!1,B.members=new R(B,function(j){return j.clientId+":"+j.connectionId}),B._myMembers=new R(B,function(j){return j.clientId}),B.subscriptions=new g.default,B.pendingPresence=[],B}return T.prototype.enter=function(y,B){if(z(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"enter",B)},T.prototype.update=function(y,B){if(z(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"update",B)},T.prototype.enterClient=function(y,B,j){return this._enterOrUpdateClient(void 0,y,B,"enter",j)},T.prototype.updateClient=function(y,B,j){return this._enterOrUpdateClient(void 0,y,B,"update",j)},T.prototype._enterOrUpdateClient=function(y,B,j,H,Q){var K=this;if(!Q)if(typeof j=="function")Q=j,j=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"_enterOrUpdateClient",[y,B,j,H]);Q=D}var X=this.channel;if(!X.connectionManager.activeState()){Q(X.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence."+H+"Client()","channel = "+X.name+", id = "+y+", client = "+(B||"(implicit) "+L(this)));var V=_.default.fromData(j);V.action=H,y&&(V.id=y),B&&(V.clientId=B),_.default.encode(V,X.channelOptions,function(U){if(U){Q(U);return}switch(X.state){case"attached":X.sendPresence(V,Q);break;case"initialized":case"detached":X.attach();case"attaching":K.pendingPresence.push({presence:V,callback:Q});break;default:U=new C.PartialErrorInfo("Unable to "+H+" presence channel while in "+X.state+" state",90001),U.code=90001,Q(U)}})},T.prototype.leave=function(y,B){if(z(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,y,B)},T.prototype.leaveClient=function(y,B,j){if(!j)if(typeof B=="function")j=B,B=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"leaveClient",[y,B]);j=D}var H=this.channel;if(!H.connectionManager.activeState()){j==null||j(H.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+y);var Q=_.default.fromData(B);switch(Q.action="leave",y&&(Q.clientId=y),H.state){case"attached":H.sendPresence(Q,j);break;case"attaching":this.pendingPresence.push({presence:Q,callback:j});break;case"initialized":case"failed":{var K=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);j==null||j(K);break}default:j==null||j(H.invalidStateError())}},T.prototype.get=function(y,B){var j=this,H=Array.prototype.slice.call(arguments);H.length==1&&typeof H[0]=="function"&&H.unshift(null),y=H[0],B=H[1];var Q=!y||("waitForSync"in y?y.waitForSync:!0);if(!B){if(this.channel.realtime.options.promises)return c.promisify(this,"get",H);B=D}function K(X){B(null,y?X.list(y):X.values())}if(this.channel.state==="suspended"){Q?B(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):K(this.members);return}M(this.channel,B,function(){var X=j.members;Q?X.waitSync(function(){K(X)}):K(X)})},T.prototype.history=function(y,B){if(m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"history",arguments);B=D}y&&y.untilAttach&&(this.channel.state==="attached"?(delete y.untilAttach,y.from_serial=this.channel.properties.attachSerial):B(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),d.default.prototype._history.call(this,y,B)},T.prototype.setPresence=function(y,B,j){m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+y.length+" participants; syncChannelSerial = "+j);var H,Q,K=this.members,X=this._myMembers,V=[],U=this.channel.connectionManager.connectionId;B&&(this.members.startSync(),j&&(Q=j.match(/^[\w-]+:(.*)$/))&&(H=Q[1]));for(var I=0;I<y.length;I++){var F=_.default.fromValues(y[I]);switch(F.action){case"leave":K.remove(F)&&V.push(F),F.connectionId===U&&!F.isSynthesized()&&X.remove(F);break;case"enter":case"present":case"update":K.put(F)&&V.push(F),F.connectionId===U&&X.put(F);break}}B&&!H&&(K.endSync(),this.channel.syncChannelSerial=null);for(var I=0;I<V.length;I++){var F=V[I];this.subscriptions.emit(F.action,F)}},T.prototype.onAttached=function(y){m.default.logAction(m.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+y),y?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var B=this.pendingPresence,j=B.length;if(j){this.pendingPresence=[];var H=[],Q=O.default.create();m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+j+" queued presence messages");for(var K=0;K<j;K++){var X=B[K];H.push(X.presence),Q.push(X.callback)}this.channel.sendPresence(H,Q)}},T.prototype.actOnChannelState=function(y,B,j){switch(y){case"attached":this.onAttached(B);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(j);break}},T.prototype.failPendingPresence=function(y){if(this.pendingPresence.length){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+c.inspectError(y));for(var B=0;B<this.pendingPresence.length;B++)try{this.pendingPresence[B].callback(y)}catch{}this.pendingPresence=[]}},T.prototype._clearMyMembers=function(){this._myMembers.clear()},T.prototype._ensureMyMembersPresent=function(){var y=this,B=this._myMembers,j=function(K){if(K){var X="Presence auto-re-enter failed: "+K.toString(),V=new C.default(X,91004,400);m.default.logAction(m.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",X);var U=new v.default(y.channel.state,y.channel.state,!0,!1,V);y.channel.emit("update",U)}};for(var H in B.map){var Q=B.map[H];m.default.logAction(m.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+Q.clientId+'" into the presence set'),this._enterOrUpdateClient(Q.id,Q.clientId,Q.data,"enter",j)}},T.prototype._synthesizeLeaves=function(y){var B=this.subscriptions;c.arrForEach(y,function(j){var H=_.default.fromValues({action:"leave",connectionId:j.connectionId,clientId:j.clientId,data:j.data,encoding:j.encoding,timestamp:c.now()});B.emit("leave",H)})},T.prototype.on=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,y)},T.prototype.off=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,y)},T.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var j=E.default.processListenerArgs(y),H=j[0],Q=j[1],K=j[2],X=this.channel;if(!K){if(this.channel.realtime.options.promises)return c.promisify(this,"subscribe",[H,Q]);K=D}if(X.state==="failed"){K(C.default.fromValues(X.invalidStateError()));return}this.subscriptions.on(H,Q),X.attach(K)},T.prototype.unsubscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var j=E.default.processListenerArgs(y),H=j[0],Q=j[1];this.subscriptions.off(H,Q)},T})(d.default),R=(function(A){l.__extends(T,A);function T(y,B){var j=A.call(this)||this;return j.presence=y,j.map=Object.create(null),j.syncInProgress=!1,j.residualMembers=null,j.memberKey=B,j}return T.prototype.get=function(y){return this.map[y]},T.prototype.getClient=function(y){var B=this.map,j=[];for(var H in B){var Q=B[H];Q.clientId==y&&Q.action!="absent"&&j.push(Q)}return j},T.prototype.list=function(y){var B=this.map,j=y&&y.clientId,H=y&&y.connectionId,Q=[];for(var K in B){var X=B[K];X.action!=="absent"&&(j&&j!=X.clientId||H&&H!=X.connectionId||Q.push(X))}return Q},T.prototype.put=function(y){(y.action==="enter"||y.action==="update")&&(y=_.default.fromValues(y),y.action="present");var B=this.map,j=this.memberKey(y);this.residualMembers&&delete this.residualMembers[j];var H=B[j];return H&&!N(y,H)?!1:(B[j]=y,!0)},T.prototype.values=function(){var y=this.map,B=[];for(var j in y){var H=y[j];H.action!="absent"&&B.push(H)}return B},T.prototype.remove=function(y){var B=this.map,j=this.memberKey(y),H=B[j];return H&&!N(y,H)?!1:(this.syncInProgress?(y=_.default.fromValues(y),y.action="absent",B[j]=y):delete B[j],!0)},T.prototype.startSync=function(){var y=this.map,B=this.syncInProgress;m.default.logAction(m.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),this.syncInProgress||(this.residualMembers=c.copy(y),this.setInProgress(!0))},T.prototype.endSync=function(){var y=this.map,B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),B){for(var j in y){var H=y[j];H.action==="absent"&&delete y[j]}this.presence._synthesizeLeaves(c.valuesArray(this.residualMembers));for(var j in this.residualMembers)delete y[j];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},T.prototype.waitSync=function(y){var B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),!B){y();return}this.once("sync",y)},T.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},T.prototype.setInProgress=function(y){m.default.logAction(m.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+y),this.syncInProgress=y,this.presence.syncComplete=!y},T})(g.default);i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=r(56),d=r(31),g=r(11),m=l.__importDefault(r(5)),_=l.__importDefault(r(3)),C=(function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(O){return O!=null&&O.sigBytes!==void 0},E.prototype.isArrayBuffer=function(O){return O!=null&&O.constructor===ArrayBuffer},E.prototype.isTypedArray=function(O){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(O)},E.prototype.uint8ViewToBase64=function(O){for(var v="",D=this.base64CharSet,L=O.byteLength,z=L%3,M=L-z,N,G,R,A,T,y=0;y<M;y=y+3)T=O[y]<<16|O[y+1]<<8|O[y+2],N=(T&16515072)>>18,G=(T&258048)>>12,R=(T&4032)>>6,A=T&63,v+=D[N]+D[G]+D[R]+D[A];return z==1?(T=O[M],N=(T&252)>>2,G=(T&3)<<4,v+=D[N]+D[G]+"=="):z==2&&(T=O[M]<<8|O[M+1],N=(T&64512)>>10,G=(T&1008)>>4,R=(T&15)<<2,v+=D[N]+D[G]+D[R]+"="),v},E.prototype.base64ToArrayBuffer=function(O){for(var v=atob==null?void 0:atob(O),D=v.length,L=new Uint8Array(D),z=0;z<D;z++){var M=v.charCodeAt(z);L[z]=M}return L.buffer},E.prototype.isBuffer=function(O){return this.isArrayBuffer(O)||this.isWordArray(O)||this.isTypedArray(O)},E.prototype.toBuffer=function(O){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(O))return new Uint8Array(O);if(this.isTypedArray(O))return new Uint8Array(O.buffer);if(this.isWordArray(O)){for(var v=new ArrayBuffer(O.sigBytes),D=new Uint8Array(v),L=0;L<O.sigBytes;L++)D[L]=O.words[L>>>2]>>>24-L%4*8&255;return D}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(O){return this.isArrayBuffer(O)?O:this.toBuffer(O).buffer},E.prototype.toWordArray=function(O){return this.isTypedArray(O)&&(O=O.buffer),this.isWordArray(O)?O:m.default.create(O)},E.prototype.base64Encode=function(O){return this.isWordArray(O)?(0,g.stringify)(O):this.uint8ViewToBase64(this.toBuffer(O))},E.prototype.base64Decode=function(O){return ArrayBuffer&&_.default.Config.atob?this.base64ToArrayBuffer(O):(0,g.parse)(O)},E.prototype.hexEncode=function(O){return(0,c.stringify)(this.toWordArray(O))},E.prototype.hexDecode=function(O){var v=(0,c.parse)(O);return ArrayBuffer?this.toArrayBuffer(v):v},E.prototype.utf8Encode=function(O){return _.default.Config.TextEncoder?new _.default.Config.TextEncoder().encode(O).buffer:(0,d.parse)(O)},E.prototype.utf8Decode=function(O){if(!this.isBuffer(O))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(O)?new TextDecoder().decode(O):(O=this.toWordArray(O),(0,d.stringify)(O))},E.prototype.bufferCompare=function(O,v){if(!O)return-1;if(!v)return 1;var D=this.toWordArray(O),L=this.toWordArray(v);D.clamp(),L.clamp();var z=D.sigBytes-L.sigBytes;if(z!=0)return z;for(var M=D.words,N=L.words,G=0;G<M.length;G++)if(z=M[G]-N[G],z!=0)return z;return 0},E.prototype.byteLength=function(O){return this.isArrayBuffer(O)||this.isTypedArray(O)?O.byteLength:this.isWordArray(O)?O.sigBytes:-1},E.prototype.typedArrayToBuffer=function(O){return O.buffer},E})();i.default=new C}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return l.enc.Hex})}),(function(n,i,r){r.r(i);var l=r(5),c=r.n(l),d=r(11),g=r(23),m=r.n(g),_=r(2),C=r.n(_),E=r(4),O=r.n(E),v=function(D,L){var z="aes",M=256,N="cbc",G=16,R=4,A=4294967296,T=2147483648,y;if(D.getRandomWordArray)y=D.getRandomWordArray;else if(typeof Uint32Array<"u"&&D.getRandomValues){var B=new Uint32Array(R);y=function(I,F){var W=I/4,at=W==R?B:new Uint32Array(W);D.getRandomValues(at,function(Z){typeof F<"u"&&F(Z,L.toWordArray(at))})}}else y=function(I,F){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var W=I/4,at=new Array(W),Z=0;Z<W;Z++)at[Z]=Math.floor(Math.random()*A)-T;F(null,c.a.create(at))};function j(I){return I+G&-G}function H(I){if(I.algorithm==="aes"&&I.mode==="cbc"){if(I.keyLength===128||I.keyLength===256)return;throw new Error("Unsupported key length "+I.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function Q(I){return I.replace("_","/").replace("-","+")}var K=[c.a.create([269488144,269488144,269488144,269488144],16),c.a.create([16777216],1),c.a.create([33685504],2),c.a.create([50529024],3),c.a.create([67372036],4),c.a.create([84215045,83886080],5),c.a.create([101058054,101056512],6),c.a.create([117901063,117901056],7),c.a.create([134744072,134744072],8),c.a.create([151587081,151587081,150994944],9),c.a.create([168430090,168430090,168427520],10),c.a.create([185273099,185273099,185273088],11),c.a.create([202116108,202116108,202116108],12),c.a.create([218959117,218959117,218959117,218103808],13),c.a.create([235802126,235802126,235802126,235798528],14),c.a.create([252645135,252645135,252645135,252645135],15),c.a.create([269488144,269488144,269488144,269488144],16)];function X(){}function V(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}X.CipherParams=V,X.getDefaultParams=function(I){var F;if(typeof I=="function"||typeof I=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof I=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),X.generateRandomKey(function(at){I(null,X.getDefaultParams({key:at}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,X.getDefaultParams({key:I}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!I.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof I.key=="string"?F=Object(d.parse)(Q(I.key)):F=L.toWordArray(I.key);var W=new V;if(W.key=F,W.algorithm=I.algorithm||z,W.keyLength=F.words.length*32,W.mode=I.mode||N,I.keyLength&&I.keyLength!==W.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+I.keyLength+" was specified, but the key actually has length "+W.keyLength);return H(W),W},X.generateRandomKey=function(I,F){arguments.length==1&&typeof I=="function"&&(F=I,I=void 0),y((I||M)/8,function(W,at){F!==void 0&&F(W?O.a.fromValues(W):null,at)})},X.getCipher=function(I){var F=I instanceof V?I:X.getDefaultParams(I);return{cipherParams:F,cipher:new U(F,R,I.iv)}};function U(I,F,W){this.algorithm=I.algorithm+"-"+String(I.keyLength)+"-"+I.mode,this.cjsAlgorithm=I.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=L.toWordArray(I.key),W&&(this.iv=L.toWordArray(W).clone()),this.blockLengthWords=F}return U.prototype.encrypt=function(I,F){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),I=L.toWordArray(I);var W=I.sigBytes,at=j(W),Z=this,rt=function(){Z.getIv(function(it,Y){if(it){F(it);return}var J=Z.encryptCipher.process(I.concat(K[at-W])),tt=Y.concat(J);F(null,tt)})};this.encryptCipher?rt():this.iv?(this.encryptCipher=m.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),rt()):y(G,function(it,Y){if(it){F(it);return}Z.encryptCipher=m.a.algo[Z.cjsAlgorithm].createEncryptor(Z.key,{iv:Y}),Z.iv=Y,rt()})},U.prototype.decrypt=function(I){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),I=L.toWordArray(I);var F=this.blockLengthWords,W=I.words,at=c.a.create(W.slice(0,F)),Z=c.a.create(W.slice(F)),rt=m.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:at}),it=rt.process(Z),Y=rt.finalize();return rt.reset(),Y&&Y.sigBytes&&it.concat(Y),it},U.prototype.getIv=function(I){if(this.iv){var F=this.iv;this.iv=null,I(null,F);return}var W=this;y(G,function(at,Z){if(at){I(at);return}I(null,W.encryptCipher.process(Z))})},X};i.default=v}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=c.enc;m.Utf16=m.Utf16BE={stringify:function(C){for(var E=C.words,O=C.sigBytes,v=[],D=0;D<O;D+=2){var L=E[D>>>2]>>>16-D%4*8&65535;v.push(String.fromCharCode(L))}return v.join("")},parse:function(C){for(var E=C.length,O=[],v=0;v<E;v++)O[v>>>1]|=C.charCodeAt(v)<<16-v%2*16;return g.create(O,E*2)}},m.Utf16LE={stringify:function(C){for(var E=C.words,O=C.sigBytes,v=[],D=0;D<O;D+=2){var L=_(E[D>>>2]>>>16-D%4*8&65535);v.push(String.fromCharCode(L))}return v.join("")},parse:function(C){for(var E=C.length,O=[],v=0;v<E;v++)O[v>>>1]|=_(C.charCodeAt(v)<<16-v%2*16);return g.create(O,E*2)}};function _(C){return C<<8&4278255360|C>>>8&16711935}})(),l.enc.Utf16})}),(function(n,i,r){(function(l,c){n.exports=c(r(6),r(28))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.CipherParams,_=d.enc,C=_.Hex,E=d.format;E.Hex={stringify:function(O){return O.ciphertext.toString(C)},parse:function(O){var v=C.parse(O);return m.create({ciphertext:v})}}})(),l.format.Hex})}),(function(n,i,r){(function(l,c){n.exports=c(r(6),r(11),r(61),r(27),r(28))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.BlockCipher,m=c.algo,_=[],C=[],E=[],O=[],v=[],D=[],L=[],z=[],M=[],N=[];(function(){for(var A=[],T=0;T<256;T++)T<128?A[T]=T<<1:A[T]=T<<1^283;for(var y=0,B=0,T=0;T<256;T++){var j=B^B<<1^B<<2^B<<3^B<<4;j=j>>>8^j&255^99,_[y]=j,C[j]=y;var H=A[y],Q=A[H],K=A[Q],X=A[j]*257^j*16843008;E[y]=X<<24|X>>>8,O[y]=X<<16|X>>>16,v[y]=X<<8|X>>>24,D[y]=X;var X=K*16843009^Q*65537^H*257^y*16843008;L[j]=X<<24|X>>>8,z[j]=X<<16|X>>>16,M[j]=X<<8|X>>>24,N[j]=X,y?(y=H^A[A[A[K^H]]],B^=A[A[B]]):y=B=1}})();var G=[0,1,2,4,8,16,32,64,128,27,54],R=m.AES=g.extend({_doReset:function(){var A;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var T=this._keyPriorReset=this._key,y=T.words,B=T.sigBytes/4,j=this._nRounds=B+6,H=(j+1)*4,Q=this._keySchedule=[],K=0;K<H;K++)K<B?Q[K]=y[K]:(A=Q[K-1],K%B?B>6&&K%B==4&&(A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255]):(A=A<<8|A>>>24,A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255],A^=G[K/B|0]<<24),Q[K]=Q[K-B]^A);for(var X=this._invKeySchedule=[],V=0;V<H;V++){var K=H-V;if(V%4)var A=Q[K];else var A=Q[K-4];V<4||K<=4?X[V]=A:X[V]=L[_[A>>>24]]^z[_[A>>>16&255]]^M[_[A>>>8&255]]^N[_[A&255]]}}},encryptBlock:function(A,T){this._doCryptBlock(A,T,this._keySchedule,E,O,v,D,_)},decryptBlock:function(A,T){var y=A[T+1];A[T+1]=A[T+3],A[T+3]=y,this._doCryptBlock(A,T,this._invKeySchedule,L,z,M,N,C);var y=A[T+1];A[T+1]=A[T+3],A[T+3]=y},_doCryptBlock:function(A,T,y,B,j,H,Q,K){for(var X=this._nRounds,V=A[T]^y[0],U=A[T+1]^y[1],I=A[T+2]^y[2],F=A[T+3]^y[3],W=4,at=1;at<X;at++){var Z=B[V>>>24]^j[U>>>16&255]^H[I>>>8&255]^Q[F&255]^y[W++],rt=B[U>>>24]^j[I>>>16&255]^H[F>>>8&255]^Q[V&255]^y[W++],it=B[I>>>24]^j[F>>>16&255]^H[V>>>8&255]^Q[U&255]^y[W++],Y=B[F>>>24]^j[V>>>16&255]^H[U>>>8&255]^Q[I&255]^y[W++];V=Z,U=rt,I=it,F=Y}var Z=(K[V>>>24]<<24|K[U>>>16&255]<<16|K[I>>>8&255]<<8|K[F&255])^y[W++],rt=(K[U>>>24]<<24|K[I>>>16&255]<<16|K[F>>>8&255]<<8|K[V&255])^y[W++],it=(K[I>>>24]<<24|K[F>>>16&255]<<16|K[V>>>8&255]<<8|K[U&255])^y[W++],Y=(K[F>>>24]<<24|K[V>>>16&255]<<16|K[U>>>8&255]<<8|K[I&255])^y[W++];A[T]=Z,A[T+1]=rt,A[T+2]=it,A[T+3]=Y},keySize:256/32});c.AES=g._createHelper(R)})(),l.AES})}),(function(n,i,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[];(function(){for(var M=0;M<64;M++)E[M]=c.abs(c.sin(M+1))*4294967296|0})();var O=C.MD5=_.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(M,N){for(var G=0;G<16;G++){var R=N+G,A=M[R];M[R]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var T=this._hash.words,y=M[N+0],B=M[N+1],j=M[N+2],H=M[N+3],Q=M[N+4],K=M[N+5],X=M[N+6],V=M[N+7],U=M[N+8],I=M[N+9],F=M[N+10],W=M[N+11],at=M[N+12],Z=M[N+13],rt=M[N+14],it=M[N+15],Y=T[0],J=T[1],tt=T[2],et=T[3];Y=v(Y,J,tt,et,y,7,E[0]),et=v(et,Y,J,tt,B,12,E[1]),tt=v(tt,et,Y,J,j,17,E[2]),J=v(J,tt,et,Y,H,22,E[3]),Y=v(Y,J,tt,et,Q,7,E[4]),et=v(et,Y,J,tt,K,12,E[5]),tt=v(tt,et,Y,J,X,17,E[6]),J=v(J,tt,et,Y,V,22,E[7]),Y=v(Y,J,tt,et,U,7,E[8]),et=v(et,Y,J,tt,I,12,E[9]),tt=v(tt,et,Y,J,F,17,E[10]),J=v(J,tt,et,Y,W,22,E[11]),Y=v(Y,J,tt,et,at,7,E[12]),et=v(et,Y,J,tt,Z,12,E[13]),tt=v(tt,et,Y,J,rt,17,E[14]),J=v(J,tt,et,Y,it,22,E[15]),Y=D(Y,J,tt,et,B,5,E[16]),et=D(et,Y,J,tt,X,9,E[17]),tt=D(tt,et,Y,J,W,14,E[18]),J=D(J,tt,et,Y,y,20,E[19]),Y=D(Y,J,tt,et,K,5,E[20]),et=D(et,Y,J,tt,F,9,E[21]),tt=D(tt,et,Y,J,it,14,E[22]),J=D(J,tt,et,Y,Q,20,E[23]),Y=D(Y,J,tt,et,I,5,E[24]),et=D(et,Y,J,tt,rt,9,E[25]),tt=D(tt,et,Y,J,H,14,E[26]),J=D(J,tt,et,Y,U,20,E[27]),Y=D(Y,J,tt,et,Z,5,E[28]),et=D(et,Y,J,tt,j,9,E[29]),tt=D(tt,et,Y,J,V,14,E[30]),J=D(J,tt,et,Y,at,20,E[31]),Y=L(Y,J,tt,et,K,4,E[32]),et=L(et,Y,J,tt,U,11,E[33]),tt=L(tt,et,Y,J,W,16,E[34]),J=L(J,tt,et,Y,rt,23,E[35]),Y=L(Y,J,tt,et,B,4,E[36]),et=L(et,Y,J,tt,Q,11,E[37]),tt=L(tt,et,Y,J,V,16,E[38]),J=L(J,tt,et,Y,F,23,E[39]),Y=L(Y,J,tt,et,Z,4,E[40]),et=L(et,Y,J,tt,y,11,E[41]),tt=L(tt,et,Y,J,H,16,E[42]),J=L(J,tt,et,Y,X,23,E[43]),Y=L(Y,J,tt,et,I,4,E[44]),et=L(et,Y,J,tt,at,11,E[45]),tt=L(tt,et,Y,J,it,16,E[46]),J=L(J,tt,et,Y,j,23,E[47]),Y=z(Y,J,tt,et,y,6,E[48]),et=z(et,Y,J,tt,V,10,E[49]),tt=z(tt,et,Y,J,rt,15,E[50]),J=z(J,tt,et,Y,K,21,E[51]),Y=z(Y,J,tt,et,at,6,E[52]),et=z(et,Y,J,tt,H,10,E[53]),tt=z(tt,et,Y,J,F,15,E[54]),J=z(J,tt,et,Y,B,21,E[55]),Y=z(Y,J,tt,et,U,6,E[56]),et=z(et,Y,J,tt,it,10,E[57]),tt=z(tt,et,Y,J,X,15,E[58]),J=z(J,tt,et,Y,Z,21,E[59]),Y=z(Y,J,tt,et,Q,6,E[60]),et=z(et,Y,J,tt,W,10,E[61]),tt=z(tt,et,Y,J,j,15,E[62]),J=z(J,tt,et,Y,I,21,E[63]),T[0]=T[0]+Y|0,T[1]=T[1]+J|0,T[2]=T[2]+tt|0,T[3]=T[3]+et|0},_doFinalize:function(){var M=this._data,N=M.words,G=this._nDataBytes*8,R=M.sigBytes*8;N[R>>>5]|=128<<24-R%32;var A=c.floor(G/4294967296),T=G;N[(R+64>>>9<<4)+15]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,N[(R+64>>>9<<4)+14]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,M.sigBytes=(N.length+1)*4,this._process();for(var y=this._hash,B=y.words,j=0;j<4;j++){var H=B[j];B[j]=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360}return y},clone:function(){var M=_.clone.call(this);return M._hash=this._hash.clone(),M}});function v(M,N,G,R,A,T,y){var B=M+(N&G|~N&R)+A+y;return(B<<T|B>>>32-T)+N}function D(M,N,G,R,A,T,y){var B=M+(N&R|G&~R)+A+y;return(B<<T|B>>>32-T)+N}function L(M,N,G,R,A,T,y){var B=M+(N^G^R)+A+y;return(B<<T|B>>>32-T)+N}function z(M,N,G,R,A,T,y){var B=M+(G^(N|~R))+A+y;return(B<<T|B>>>32-T)+N}d.MD5=_._createHelper(O),d.HmacMD5=_._createHmacHelper(O)})(Math),l.MD5})}),(function(n,i,r){var l;Object.defineProperty(i,"__esModule",{value:!0});var c=r(0),d=c.__importDefault(r(3)),g=c.__importStar(r(1)),m=c.__importDefault(r(8)),_=r(4),C=c.__importDefault(r(19)),E=c.__importDefault(r(17)),O=c.__importDefault(r(22)),v=c.__importDefault(r(2)),D=r(29),L=c.__importDefault(r(63)),z=r(14);function M(R){var A=R.statusCode;return A===408&&!R.code||A===400&&!R.code||A>=500&&A<=504}function N(R){var A=R.connection,T=A&&A.connectionManager.host;return T?[T].concat(m.default.getFallbackHosts(R.options)):m.default.getHosts(R.options)}var G=(l=(function(){function R(A){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=N,this.options=A||{};var T=this.options.connectivityCheckUrl||m.default.connectivityCheckUrl,y=this.options.connectivityCheckParams,B=!this.options.connectivityCheckUrl;d.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(j,H,Q,K,X,V,U){var I=E.default.createRequest(Q,K,X,V,O.default.REQ_SEND,H&&H.options.timeouts,j);return I.once("complete",U),I.exec(),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(j){j(null,!0)}:this.checkConnectivity=function(j){v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,y,function(H,Q,K,X,V){var U=!1;B?U=!H&&(Q==null?void 0:Q.replace(/\n/,""))=="yes":U=!H&&(0,z.isSuccessCode)(V),v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+U),j(null,U)})}):d.default.Config.jsonpSupported?(this.Request=function(j,H,Q,K,X,V,U){var I=(0,D.createRequest)(Q,K,X,V,O.default.REQ_SEND,H&&H.options.timeouts,j);return I.once("complete",U),d.default.Config.nextTick(function(){I.exec()}),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(j){j(null,!0)}:this.checkConnectivity=function(j){var H=this,Q=m.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(j);return}this.checksInProgress=[j],v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+Q);var K=new D.Request("isTheInternetUp",Q,null,null,null,O.default.REQ_SEND,m.default.TIMEOUTS);K.once("complete",function(X,V){var U=!X&&V;v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+U);for(var I=0;I<H.checksInProgress.length;I++)H.checksInProgress[I](null,U);H.checksInProgress=null}),d.default.Config.nextTick(function(){K.exec()})}):d.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=L.default,this.checkConnectivity=function(j){v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,null,function(H,Q){var K=!H&&(Q==null?void 0:Q.replace(/\n/,""))=="yes";v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+K),j(null,K)})}):this.Request=function(j,H,Q,K,X,V,U){U(new _.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return R.prototype.do=function(A,T,y,B,j,H,Q){var K=this,X=typeof y=="function"?y:function(F){return T.baseUri(F)+y},V=T._currentFallback;if(V)if(V.validUntil>g.now()){if(!this.Request){Q==null||Q(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,T,X(V.host),B,H,j,function(F){for(var W=[],at=1;at<arguments.length;at++)W[at-1]=arguments[at];if(F&&M(F)){T._currentFallback=null,K.do(A,T,y,B,j,H,Q);return}Q==null||Q.apply(void 0,c.__spreadArray([F],W,!1))});return}else T._currentFallback=null;var U=N(T);if(U.length===1){this.doUri(A,T,X(U[0]),B,j,H,Q);return}var I=function(F,W){var at=F.shift();K.doUri(A,T,X(at),B,j,H,function(Z){for(var rt=[],it=1;it<arguments.length;it++)rt[it-1]=arguments[it];if(Z&&M(Z)&&F.length){I(F,!0);return}W&&(T._currentFallback={host:at,validUntil:g.now()+T.options.timeouts.fallbackRetryTimeout}),Q==null||Q.apply(void 0,c.__spreadArray([Z],rt,!1))})};I(U)},R.prototype.doUri=function(A,T,y,B,j,H,Q){if(!this.Request){Q(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,T,y,B,H,j,Q)},R})(),l.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],l.methodsWithoutBody=[C.default.Get,C.default.Delete],l.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],l);i.default=G}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(4)),d=l.__importDefault(r(3)),g=l.__importDefault(r(8)),m=l.__importStar(r(1)),_=r(1);function C(v,D){return!!D.get("x-ably-errorcode")}function E(v,D){if(C(v,D))return v.error&&c.default.fromValues(v.error)}function O(v,D,L,z,M,N,G){var R=new Headers(z||{}),A=v?v.toUpperCase():m.isEmptyArg(N)?"GET":"POST",T=new AbortController,y=setTimeout(function(){T.abort(),G(new c.PartialErrorInfo("Request timed out",null,408))},D?D.options.timeouts.httpRequestTimeout:g.default.TIMEOUTS.httpRequestTimeout),B={method:A,headers:R,body:N};d.default.Config.isWebworker||(B.credentials=R.has("authorization")?"include":"same-origin"),(0,_.getGlobalObject)().fetch(L+"?"+new URLSearchParams(M||{}),B).then(function(j){clearTimeout(y);var H=j.headers.get("Content-Type"),Q;H&&H.indexOf("application/x-msgpack")>-1?Q=j.arrayBuffer():H&&H.indexOf("application/json")>-1?Q=j.json():Q=j.text(),Q.then(function(K){var X=!!H&&H.indexOf("application/x-msgpack")===-1;if(j.ok)G(null,K,j.headers,X,j.status);else{var V=E(K,j.headers)||new c.PartialErrorInfo("Error response received from server: "+j.status+" body was: "+d.default.Config.inspect(K),null,j.status);G(V,K,j.headers,X,j.status)}})}).catch(function(j){clearTimeout(y),G(j)})}i.default=O}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(41)),d=l.__importStar(r(1)),g=d.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function m(){var O=g.location;return!g.WebSocket||!O||!O.origin||O.origin.indexOf("http")>-1}var _=g.navigator&&g.navigator.userAgent.toString(),C=g.location&&g.location.href,E={agent:"browser",logTimestamps:!0,userAgent:_,currentUrl:C,noUpgrade:_&&!!_.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:g.WebSocket,fetchSupported:!!g.fetch,xhrSupported:g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:m(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:c.default,supportsBinary:!!g.TextDecoder,preferBinary:!1,ArrayBuffer:g.ArrayBuffer,atob:g.atob,nextTick:typeof g.setImmediate<"u"?g.setImmediate.bind(g):function(O){setTimeout(O,0)},addEventListener:g.addEventListener,inspect:JSON.stringify,stringByteSize:function(O){return g.TextDecoder&&new g.TextEncoder().encode(O).length||O.length},TextEncoder:g.TextEncoder,TextDecoder:g.TextDecoder,Promise:g.Promise,getRandomValues:(function(O){if(O!==void 0)return function(v,D){O.getRandomValues(v),D&&D(null)}})(g.crypto||msCrypto)};i.default=E}),(function(n,i,r){(function(l){Object.defineProperty(i,"__esModule",{value:!0});var c=r(0),d=c.__importStar(r(1)),g="ablyjs-storage-test",m=(function(){function _(){try{l.sessionStorage.setItem(g,g),l.sessionStorage.removeItem(g),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{l.localStorage.setItem(g,g),l.localStorage.removeItem(g),this.localSupported=!0}catch{this.localSupported=!1}}return _.prototype.get=function(C){return this._get(C,!1)},_.prototype.getSession=function(C){return this._get(C,!0)},_.prototype.remove=function(C){return this._remove(C,!1)},_.prototype.removeSession=function(C){return this._remove(C,!0)},_.prototype.set=function(C,E,O){return this._set(C,E,O,!1)},_.prototype.setSession=function(C,E,O){return this._set(C,E,O,!0)},_.prototype._set=function(C,E,O,v){var D={value:E};return O&&(D.expires=d.now()+O),this.storageInterface(v).setItem(C,JSON.stringify(D))},_.prototype._get=function(C,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var O=this.storageInterface(E).getItem(C);if(!O)return null;var v=JSON.parse(O);return v.expires&&v.expires<d.now()?(this.storageInterface(E).removeItem(C),null):v.value},_.prototype._remove=function(C,E){return this.storageInterface(E).removeItem(C)},_.prototype.storageInterface=function(C){return C?l.sessionStorage:l.localStorage},_})();i.default=new m}).call(this,r(13))}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(67)),d={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],baseTransportOrder:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],transportPreferenceOrder:[c.default.JsonP,c.default.XhrPolling,c.default.XhrStreaming,c.default.WebSocket],upgradeTransports:[c.default.XhrStreaming,c.default.WebSocket]};i.default=d}),(function(n,i,r){Object.defineProperty(i,"__esModule",{value:!0});var l;(function(c){c.WebSocket="web_socket",c.Comet="comet",c.XhrStreaming="xhr_streaming",c.XhrPolling="xhr_polling",c.JsonP="jsonp"})(l||(l={})),i.default=l}),(function(n,i,r){r.r(i);var l=r(29),c=r.n(l),d=r(1),g=r(3),m=r.n(g),_=r(12),C=r.n(_),E=r(17),O=r.n(E),v=function(M){var N="xhr_polling";function G(R,A,T){T.stream=!1,C.a.call(this,R,A,T),this.shortName=N}return d.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(R,A,T,y,B){return O.a.createRequest(R,A,T,y,B,this.timeouts)},typeof M<"u"&&G.isAvailable()&&(M.supportedTransports[N]=G),G},D=v,L=function(M){var N="xhr_streaming";function G(R,A,T){C.a.call(this,R,A,T),this.shortName=N}return d.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.streamingSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(R,A,T,y,B){return O.a.createRequest(R,A,T,y,B,this.timeouts)},typeof M<"u"&&G.isAvailable()&&(M.supportedTransports[N]=G),G},z=L;i.default=[c.a,D,z]})]).default})})(Pp)),Pp.exports}var pS=gS(),zm=function(o,t){return zm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},zm(o,t)};function mS(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");zm(o,t);function n(){this.constructor=o}o.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var vg=function(){return vg=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},vg.apply(this,arguments)};function vf(o,t){var n={};for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&t.indexOf(i)<0&&(n[i]=o[i]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(o);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(o,i[r])&&(n[i[r]]=o[i[r]]);return n}function vS(o,t,n,i){var r=arguments.length,l=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,t,n,i);else for(var d=o.length-1;d>=0;d--)(c=o[d])&&(l=(r<3?c(l):r>3?c(t,n,l):c(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l}function yS(o,t){return function(n,i){t(n,i,o)}}function SS(o,t,n,i,r,l){function c(z){if(z!==void 0&&typeof z!="function")throw new TypeError("Function expected");return z}for(var d=i.kind,g=d==="getter"?"get":d==="setter"?"set":"value",m=!t&&o?i.static?o:o.prototype:null,_=t||(m?Object.getOwnPropertyDescriptor(m,i.name):{}),C,E=!1,O=n.length-1;O>=0;O--){var v={};for(var D in i)v[D]=D==="access"?{}:i[D];for(var D in i.access)v.access[D]=i.access[D];v.addInitializer=function(z){if(E)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(z||null))};var L=(0,n[O])(d==="accessor"?{get:_.get,set:_.set}:_[g],v);if(d==="accessor"){if(L===void 0)continue;if(L===null||typeof L!="object")throw new TypeError("Object expected");(C=c(L.get))&&(_.get=C),(C=c(L.set))&&(_.set=C),(C=c(L.init))&&r.unshift(C)}else(C=c(L))&&(d==="field"?r.unshift(C):_[g]=C)}m&&Object.defineProperty(m,i.name,_),E=!0}function bS(o,t,n){for(var i=arguments.length>2,r=0;r<t.length;r++)n=i?t[r].call(o,n):t[r].call(o);return i?n:void 0}function _S(o){return typeof o=="symbol"?o:"".concat(o)}function ES(o,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function CS(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function se(o,t,n,i){function r(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(_){try{m(i.next(_))}catch(C){c(C)}}function g(_){try{m(i.throw(_))}catch(C){c(C)}}function m(_){_.done?l(_.value):r(_.value).then(d,g)}m((i=i.apply(o,t||[])).next())})}function TS(o,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,r,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(m){return function(_){return g([m,_])}}function g(m){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(n=0)),n;)try{if(i=1,r&&(l=m[0]&2?r.return:m[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,m[1])).done)return l;switch(r=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(o,n)}catch(_){m=[6,_],r=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Dg=Object.create?(function(o,t,n,i){i===void 0&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(o,i,r)}):(function(o,t,n,i){i===void 0&&(i=n),o[i]=t[n]});function AS(o,t){for(var n in o)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Dg(t,o,n)}function yg(o){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&o[t],i=0;if(n)return n.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function rv(o,t){var n=typeof Symbol=="function"&&o[Symbol.iterator];if(!n)return o;var i=n.call(o),r,l=[],c;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(d){c={error:d}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(c)throw c.error}}return l}function wS(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(rv(arguments[t]));return o}function OS(){for(var o=0,t=0,n=arguments.length;t<n;t++)o+=arguments[t].length;for(var i=Array(o),r=0,t=0;t<n;t++)for(var l=arguments[t],c=0,d=l.length;c<d;c++,r++)i[r]=l[c];return i}function RS(o,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,l;i<r;i++)(l||!(i in t))&&(l||(l=Array.prototype.slice.call(t,0,i)),l[i]=t[i]);return o.concat(l||Array.prototype.slice.call(t))}function cf(o){return this instanceof cf?(this.v=o,this):new cf(o)}function xS(o,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(o,t||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(O){return function(v){return Promise.resolve(v).then(O,C)}}function d(O,v){i[O]&&(r[O]=function(D){return new Promise(function(L,z){l.push([O,D,L,z])>1||g(O,D)})},v&&(r[O]=v(r[O])))}function g(O,v){try{m(i[O](v))}catch(D){E(l[0][3],D)}}function m(O){O.value instanceof cf?Promise.resolve(O.value.v).then(_,C):E(l[0][2],O)}function _(O){g("next",O)}function C(O){g("throw",O)}function E(O,v){O(v),l.shift(),l.length&&g(l[0][0],l[0][1])}}function NS(o){var t,n;return t={},i("next"),i("throw",function(r){throw r}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(r,l){t[r]=o[r]?function(c){return(n=!n)?{value:cf(o[r](c)),done:!1}:l?l(c):c}:l}}function MS(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],n;return t?t.call(o):(o=typeof yg=="function"?yg(o):o[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(l){n[l]=o[l]&&function(c){return new Promise(function(d,g){c=o[l](c),r(d,g,c.done,c.value)})}}function r(l,c,d,g){Promise.resolve(g).then(function(m){l({value:m,done:d})},c)}}function DS(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}var s_=Object.create?(function(o,t){Object.defineProperty(o,"default",{enumerable:!0,value:t})}):function(o,t){o.default=t},Lm=function(o){return Lm=Object.getOwnPropertyNames||function(t){var n=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[n.length]=i);return n},Lm(o)};function jS(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var n=Lm(o),i=0;i<n.length;i++)n[i]!=="default"&&Dg(t,o,n[i]);return s_(t,o),t}function US(o){return o&&o.__esModule?o:{default:o}}function BS(o,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!i:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(o):i?i.value:t.get(o)}function zS(o,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!r:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(o,n):r?r.value=n:t.set(o,n),n}function LS(o,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?t===o:o.has(t)}function GS(o,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var i,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],n&&(r=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");r&&(i=function(){try{r.call(this)}catch(l){return Promise.reject(l)}}),o.stack.push({value:t,dispose:i,async:n})}else n&&o.stack.push({async:!0});return t}var l_=typeof SuppressedError=="function"?SuppressedError:function(o,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=o,i.suppressed=t,i};function HS(o){function t(l){o.error=o.hasError?new l_(l,o.error,"An error was suppressed during disposal."):l,o.hasError=!0}var n,i=0;function r(){for(;n=o.stack.pop();)try{if(!n.async&&i===1)return i=0,o.stack.push(n),Promise.resolve().then(r);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(l).then(r,function(c){return t(c),r()})}else i|=1}catch(c){t(c)}if(i===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return r()}function PS(o,t){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,i,r,l,c){return i?t?".jsx":".js":r&&(!l||!c)?n:r+l+"."+c.toLowerCase()+"js"}):o}const o_={__extends:mS,__assign:vg,__rest:vf,__decorate:vS,__param:yS,__esDecorate:SS,__runInitializers:bS,__propKey:_S,__setFunctionName:ES,__metadata:CS,__awaiter:se,__generator:TS,__createBinding:Dg,__exportStar:AS,__values:yg,__read:rv,__spread:wS,__spreadArrays:OS,__spreadArray:RS,__await:cf,__asyncGenerator:xS,__asyncDelegator:NS,__asyncValues:MS,__makeTemplateObject:DS,__importStar:jS,__importDefault:US,__classPrivateFieldGet:BS,__classPrivateFieldSet:zS,__classPrivateFieldIn:LS,__addDisposableResource:GS,__disposeResources:HS,__rewriteRelativeImportExtension:PS},u_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:GS,get __assign(){return vg},__asyncDelegator:NS,__asyncGenerator:xS,__asyncValues:MS,__await:cf,__awaiter:se,__classPrivateFieldGet:BS,__classPrivateFieldIn:LS,__classPrivateFieldSet:zS,__createBinding:Dg,__decorate:vS,__disposeResources:HS,__esDecorate:SS,__exportStar:AS,__extends:mS,__generator:TS,__importDefault:US,__importStar:jS,__makeTemplateObject:DS,__metadata:CS,__param:yS,__propKey:_S,__read:rv,__rest:vf,__rewriteRelativeImportExtension:PS,__runInitializers:bS,__setFunctionName:ES,__spread:wS,__spreadArray:RS,__spreadArrays:OS,__values:yg,default:o_},Symbol.toStringTag,{value:"Module"})),c_="modulepreload",f_=function(o){return"/"+o},o1={},yf=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){let c=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=c(n.map(m=>{if(m=f_(m),m in o1)return;o1[m]=!0;const _=m.endsWith(".css"),C=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${C}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":c_,_||(E.as="script"),E.crossOrigin="",E.href=m,g&&E.setAttribute("nonce",g),document.head.appendChild(E),_)return new Promise((O,v)=>{E.addEventListener("load",O),E.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return r.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return t().catch(l)})},h_=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>yf(async()=>{const{default:i}=await Promise.resolve().then(()=>bu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)};class sv extends Error{constructor(t,n="FunctionsError",i){super(t),this.name=n,this.context=i}}class u1 extends sv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class c1 extends sv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class f1 extends sv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Gm;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Gm||(Gm={}));class d_{constructor(t,{headers:n={},customFetch:i,region:r=Gm.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=h_(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return se(this,arguments,void 0,function*(n,i={}){var r;try{const{headers:l,method:c,body:d,signal:g}=i;let m={},{region:_}=i;_||(_=this.region);const C=new URL(`${this.url}/${n}`);_&&_!=="any"&&(m["x-region"]=_,C.searchParams.set("forceFunctionRegion",_));let E;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=d):typeof d=="string"?(m["Content-Type"]="text/plain",E=d):typeof FormData<"u"&&d instanceof FormData?E=d:(m["Content-Type"]="application/json",E=JSON.stringify(d)):E=d;const O=yield this.fetch(C.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),l),body:E,signal:g}).catch(z=>{throw z.name==="AbortError"?z:new u1(z)}),v=O.headers.get("x-relay-error");if(v&&v==="true")throw new c1(O);if(!O.ok)throw new f1(O);let D=((r=O.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),L;return D==="application/json"?L=yield O.json():D==="application/octet-stream"||D==="application/pdf"?L=yield O.blob():D==="text/event-stream"?L=O:D==="multipart/form-data"?L=yield O.formData():L=yield O.text(),{data:L,error:null,response:O}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new u1(l)}:{data:null,error:l,response:l instanceof f1||l instanceof c1?l.context:void 0}}})}}var Ji={};const Sf=v2(u_);var eg={},ng={},ig={},ag={},rg={},g_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ff=g_();const p_=ff.fetch,IS=ff.fetch.bind(ff),kS=ff.Headers,m_=ff.Request,v_=ff.Response,bu=Object.freeze(Object.defineProperty({__proto__:null,Headers:kS,Request:m_,Response:v_,default:IS,fetch:p_},Symbol.toStringTag,{value:"Module"})),y_=v2(bu);var sg={},h1;function qS(){if(h1)return sg;h1=1,Object.defineProperty(sg,"__esModule",{value:!0});class o extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return sg.default=o,sg}var d1;function VS(){if(d1)return rg;d1=1,Object.defineProperty(rg,"__esModule",{value:!0});const o=Sf,t=o.__importDefault(y_),n=o.__importDefault(qS());class i{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let g=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var _,C,E,O;let v=null,D=null,L=null,z=m.status,M=m.statusText;if(m.ok){if(this.method!=="HEAD"){const A=await m.text();A===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((_=this.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?D=A:D=JSON.parse(A))}const G=(C=this.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),R=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");G&&R&&R.length>1&&(L=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(D)&&(D.length>1?(v={code:"PGRST116",details:`Results contain ${D.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},D=null,L=null,z=406,M="Not Acceptable"):D.length===1?D=D[0]:D=null)}else{const G=await m.text();try{v=JSON.parse(G),Array.isArray(v)&&m.status===404&&(D=[],v=null,z=200,M="OK")}catch{m.status===404&&G===""?(z=204,M="No Content"):v={message:G}}if(v&&this.isMaybeSingle&&(!((O=v==null?void 0:v.details)===null||O===void 0)&&O.includes("0 rows"))&&(v=null,z=200,M="OK"),v&&this.shouldThrowOnError)throw new n.default(v)}return{error:v,data:D,count:L,status:z,statusText:M}});return this.shouldThrowOnError||(g=g.catch(m=>{var _,C,E;return{error:{message:`${(_=m==null?void 0:m.name)!==null&&_!==void 0?_:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(C=m==null?void 0:m.stack)!==null&&C!==void 0?C:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),g.then(l,c)}returns(){return this}overrideTypes(){return this}}return rg.default=i,rg}var g1;function YS(){if(g1)return ag;g1=1,Object.defineProperty(ag,"__esModule",{value:!0});const t=Sf.__importDefault(VS());class n extends t.default{select(r){let l=!1;const c=(r??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:g=d}={}){const m=g?`${g}.order`:"order",_=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${_?`${_},`:""}${r}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${r}`),this}range(r,l,{foreignTable:c,referencedTable:d=c}={}){const g=typeof d>"u"?"offset":`${d}.offset`,m=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(g,`${r}`),this.url.searchParams.set(m,`${l-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:g=!1,format:m="text"}={}){var _;const C=[r?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${C};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return ag.default=n,ag}var p1;function lv(){if(p1)return ig;p1=1,Object.defineProperty(ig,"__esModule",{value:!0});const t=Sf.__importDefault(YS());class n extends t.default{eq(r,l){return this.url.searchParams.append(r,`eq.${l}`),this}neq(r,l){return this.url.searchParams.append(r,`neq.${l}`),this}gt(r,l){return this.url.searchParams.append(r,`gt.${l}`),this}gte(r,l){return this.url.searchParams.append(r,`gte.${l}`),this}lt(r,l){return this.url.searchParams.append(r,`lt.${l}`),this}lte(r,l){return this.url.searchParams.append(r,`lte.${l}`),this}like(r,l){return this.url.searchParams.append(r,`like.${l}`),this}likeAllOf(r,l){return this.url.searchParams.append(r,`like(all).{${l.join(",")}}`),this}likeAnyOf(r,l){return this.url.searchParams.append(r,`like(any).{${l.join(",")}}`),this}ilike(r,l){return this.url.searchParams.append(r,`ilike.${l}`),this}ilikeAllOf(r,l){return this.url.searchParams.append(r,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(r,l){return this.url.searchParams.append(r,`ilike(any).{${l.join(",")}}`),this}is(r,l){return this.url.searchParams.append(r,`is.${l}`),this}in(r,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(r,`in.(${c})`),this}contains(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cs.{${l.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(l)}`),this}containedBy(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cd.{${l.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(l)}`),this}rangeGt(r,l){return this.url.searchParams.append(r,`sr.${l}`),this}rangeGte(r,l){return this.url.searchParams.append(r,`nxl.${l}`),this}rangeLt(r,l){return this.url.searchParams.append(r,`sl.${l}`),this}rangeLte(r,l){return this.url.searchParams.append(r,`nxr.${l}`),this}rangeAdjacent(r,l){return this.url.searchParams.append(r,`adj.${l}`),this}overlaps(r,l){return typeof l=="string"?this.url.searchParams.append(r,`ov.${l}`):this.url.searchParams.append(r,`ov.{${l.join(",")}}`),this}textSearch(r,l,{config:c,type:d}={}){let g="";d==="plain"?g="pl":d==="phrase"?g="ph":d==="websearch"&&(g="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(r,`${g}fts${m}.${l}`),this}match(r){return Object.entries(r).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(r,l,c){return this.url.searchParams.append(r,`not.${l}.${c}`),this}or(r,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${r})`),this}filter(r,l,c){return this.url.searchParams.append(r,`${l}.${c}`),this}}return ig.default=n,ig}var m1;function KS(){if(m1)return ng;m1=1,Object.defineProperty(ng,"__esModule",{value:!0});const t=Sf.__importDefault(lv());class n{constructor(r,{headers:l={},schema:c,fetch:d}){this.url=r,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(r,l){const{head:c=!1,count:d}=l??{},g=c?"HEAD":"GET";let m=!1;const _=(r??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",_),d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:l,defaultToNull:c=!0}={}){var d;const g="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((_,C)=>_.concat(Object.keys(C)),[]);if(m.length>0){const _=[...new Set(m)].map(C=>`"${C}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(r,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:g=!0}={}){var m;const _="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const C=r.reduce((E,O)=>E.concat(Object.keys(O)),[]);if(C.length>0){const E=[...new Set(C)].map(O=>`"${O}"`);this.url.searchParams.set("columns",E.join(","))}}return new t.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:r}={}){var l;const c="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return ng.default=n,ng}var v1;function S_(){if(v1)return eg;v1=1,Object.defineProperty(eg,"__esModule",{value:!0});const o=Sf,t=o.__importDefault(KS()),n=o.__importDefault(lv());class i{constructor(l,{headers:c={},schema:d,fetch:g}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=g}from(l){const c=new URL(`${this.url}/${l}`);return new t.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new i(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:g=!1,count:m}={}){var _;let C;const E=new URL(`${this.url}/rpc/${l}`);let O;d||g?(C=d?"HEAD":"GET",Object.entries(c).filter(([D,L])=>L!==void 0).map(([D,L])=>[D,Array.isArray(L)?`{${L.join(",")}}`:`${L}`]).forEach(([D,L])=>{E.searchParams.append(D,L)})):(C="POST",O=c);const v=new Headers(this.headers);return m&&v.set("Prefer",`count=${m}`),new n.default({method:C,url:E,headers:v,schema:this.schemaName,body:O,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}}return eg.default=i,eg}var y1;function b_(){if(y1)return Ji;y1=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.PostgrestError=Ji.PostgrestBuilder=Ji.PostgrestTransformBuilder=Ji.PostgrestFilterBuilder=Ji.PostgrestQueryBuilder=Ji.PostgrestClient=void 0;const o=Sf,t=o.__importDefault(S_());Ji.PostgrestClient=t.default;const n=o.__importDefault(KS());Ji.PostgrestQueryBuilder=n.default;const i=o.__importDefault(lv());Ji.PostgrestFilterBuilder=i.default;const r=o.__importDefault(YS());Ji.PostgrestTransformBuilder=r.default;const l=o.__importDefault(VS());Ji.PostgrestBuilder=l.default;const c=o.__importDefault(qS());return Ji.PostgrestError=c.default,Ji.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:l.default,PostgrestError:c.default},Ji}var __=b_();const E_=hf(__),{PostgrestClient:C_,PostgrestQueryBuilder:MT,PostgrestFilterBuilder:DT,PostgrestTransformBuilder:jT,PostgrestBuilder:UT,PostgrestError:BT}=E_;class T_{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const i=n.node,r=parseInt(i.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const i=this.getWebSocketConstructor();return new i(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const A_="2.76.1",w_=`realtime-js/${A_}`,O_="1.0.0",Hm=1e4,R_=1e3,x_=100;var rd;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(rd||(rd={}));var vi;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(vi||(vi={}));var Lr;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(Lr||(Lr={}));var Pm;(function(o){o.websocket="websocket"})(Pm||(Pm={}));var cu;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(cu||(cu={}));class N_{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,n,i)}_decodeBroadcast(t,n,i){const r=n.getUint8(1),l=n.getUint8(2);let c=this.HEADER_LENGTH+2;const d=i.decode(t.slice(c,c+r));c=c+r;const g=i.decode(t.slice(c,c+l));c=c+l;const m=JSON.parse(i.decode(t.slice(c,t.byteLength)));return{ref:null,topic:d,event:g,payload:m}}}class QS{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var On;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(On||(On={}));const S1=(o,t,n={})=>{var i;const r=(i=n.skipTypes)!==null&&i!==void 0?i:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=M_(c,o,t,r),l),{}):{}},M_=(o,t,n,i)=>{const r=t.find(d=>d.name===o),l=r==null?void 0:r.type,c=n[o];return l&&!i.includes(l)?XS(l,c):Im(c)},XS=(o,t)=>{if(o.charAt(0)==="_"){const n=o.slice(1,o.length);return B_(t,n)}switch(o){case On.bool:return D_(t);case On.float4:case On.float8:case On.int2:case On.int4:case On.int8:case On.numeric:case On.oid:return j_(t);case On.json:case On.jsonb:return U_(t);case On.timestamp:return z_(t);case On.abstime:case On.date:case On.daterange:case On.int4range:case On.int8range:case On.money:case On.reltime:case On.text:case On.time:case On.timestamptz:case On.timetz:case On.tsrange:case On.tstzrange:return Im(t);default:return Im(t)}},Im=o=>o,D_=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},j_=o=>{if(typeof o=="string"){const t=parseFloat(o);if(!Number.isNaN(t))return t}return o},U_=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(t){return console.log(`JSON parse error: ${t}`),o}return o},B_=(o,t)=>{if(typeof o!="string")return o;const n=o.length-1,i=o[n];if(o[0]==="{"&&i==="}"){let l;const c=o.slice(1,n);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>XS(t,d))}return o},z_=o=>typeof o=="string"?o.replace(" ","T"):o,FS=o=>{const t=new URL(o);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Ip{constructor(t,n,i={},r=Hm){this.channel=t,this.event=n,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var i;return this._hasReceived(t)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var b1;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(b1||(b1={}));class sd{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=sd.syncState(this.state,r,l,c),this.pendingDiffs.forEach(g=>{this.state=sd.syncDiff(this.state,g,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(i.diff,{},r=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=sd.syncDiff(this.state,r,l,c),d())}),this.onJoin((r,l,c)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:l,newPresences:c})}),this.onLeave((r,l,c)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,i,r){const l=this.cloneDeep(t),c=this.transformState(n),d={},g={};return this.map(l,(m,_)=>{c[m]||(g[m]=_)}),this.map(c,(m,_)=>{const C=l[m];if(C){const E=_.map(L=>L.presence_ref),O=C.map(L=>L.presence_ref),v=_.filter(L=>O.indexOf(L.presence_ref)<0),D=C.filter(L=>E.indexOf(L.presence_ref)<0);v.length>0&&(d[m]=v),D.length>0&&(g[m]=D)}else d[m]=_}),this.syncDiff(l,{joins:d,leaves:g},i,r)}static syncDiff(t,n,i,r){const{joins:l,leaves:c}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(l,(d,g)=>{var m;const _=(m=t[d])!==null&&m!==void 0?m:[];if(t[d]=this.cloneDeep(g),_.length>0){const C=t[d].map(O=>O.presence_ref),E=_.filter(O=>C.indexOf(O.presence_ref)<0);t[d].unshift(...E)}i(d,_,g)}),this.map(c,(d,g)=>{let m=t[d];if(!m)return;const _=g.map(C=>C.presence_ref);m=m.filter(C=>_.indexOf(C.presence_ref)<0),t[d]=m,r(d,m,g),m.length===0&&delete t[d]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(i=>n(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,i)=>{const r=t[i];return"metas"in r?n[i]=r.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[i]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _1;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(_1||(_1={}));var ld;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(ld||(ld={}));var hl;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(hl||(hl={}));class ov{constructor(t,n={config:{}},i){var r,l;if(this.topic=t,this.params=n,this.socket=i,this.bindings={},this.state=vi.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Ip(this,Lr.join,this.params,this.timeout),this.rejoinTimer=new QS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=vi.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=vi.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=vi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=vi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=vi.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Lr.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new sd(this),this.broadcastEndpointURL=FS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var i,r,l;if(this.socket.isConnected()||this.socket.connect(),this.state==vi.closed){const{config:{broadcast:c,presence:d,private:g}}=this.params,m=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(O=>O.filter))!==null&&r!==void 0?r:[],_=!!this.bindings[ld.PRESENCE]&&this.bindings[ld.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,C={},E={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(O=>t==null?void 0:t(hl.CHANNEL_ERROR,O)),this._onClose(()=>t==null?void 0:t(hl.CLOSED)),this.updateJoinPayload(Object.assign({config:E},C)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:O})=>{var v;if(this.socket.setAuth(),O===void 0){t==null||t(hl.SUBSCRIBED);return}else{const D=this.bindings.postgres_changes,L=(v=D==null?void 0:D.length)!==null&&v!==void 0?v:0,z=[];for(let M=0;M<L;M++){const N=D[M],{filter:{event:G,schema:R,table:A,filter:T}}=N,y=O&&O[M];if(y&&y.event===G&&y.schema===R&&y.table===A&&y.filter===T)z.push(Object.assign(Object.assign({},N),{id:y.id}));else{this.unsubscribe(),this.state=vi.errored,t==null||t(hl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=z,t&&t(hl.SUBSCRIBED);return}}).receive("error",O=>{this.state=vi.errored,t==null||t(hl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(O).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(hl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,i){return this.state===vi.joined&&t===ld.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,i)}async httpSend(t,n,i={}){var r;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=i.timeout)!==null&&r!==void 0?r:this.timeout);if(d.status===202)return{success:!0};let g=d.statusText;try{const m=await d.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(t,n={}){var i,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,g;const m=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((g=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=vi.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Lr.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Ip(this,Lr.leave,{},t),i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=vi.closed,this.bindings={}}async _fetchWithTimeout(t,n,i){const r=new AbortController,l=setTimeout(()=>r.abort(),i),c=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(l),c}_push(t,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Ip(this,t,n,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>x_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,i){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,i){var r,l;const c=t.toLocaleLowerCase(),{close:d,error:g,leave:m,join:_}=Lr;if(i&&[d,g,m,_].indexOf(c)>=0&&i!==this._joinRef())return;let E=this._onMessage(c,n,i);if(n&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(O=>{var v,D,L;return((v=O.filter)===null||v===void 0?void 0:v.event)==="*"||((L=(D=O.filter)===null||D===void 0?void 0:D.event)===null||L===void 0?void 0:L.toLocaleLowerCase())===c}).map(O=>O.callback(E,i)):(l=this.bindings[c])===null||l===void 0||l.filter(O=>{var v,D,L,z,M,N;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in O){const G=O.id,R=(v=O.filter)===null||v===void 0?void 0:v.event;return G&&((D=n.ids)===null||D===void 0?void 0:D.includes(G))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((L=n.data)===null||L===void 0?void 0:L.type.toLocaleLowerCase()))}else{const G=(M=(z=O==null?void 0:O.filter)===null||z===void 0?void 0:z.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return G==="*"||G===((N=n==null?void 0:n.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return O.type.toLocaleLowerCase()===c}).map(O=>{if(typeof E=="object"&&"ids"in E){const v=E.data,{schema:D,table:L,commit_timestamp:z,type:M,errors:N}=v;E=Object.assign(Object.assign({},{schema:D,table:L,commit_timestamp:z,eventType:M,new:{},old:{},errors:N}),this._getPayloadRecords(v))}O.callback(E,i)})}_isClosed(){return this.state===vi.closed}_isJoined(){return this.state===vi.joined}_isJoining(){return this.state===vi.joining}_isLeaving(){return this.state===vi.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,i){const r=t.toLocaleLowerCase(),l={type:r,filter:n,callback:i};return this.bindings[r]?this.bindings[r].push(l):this.bindings[r]=[l],this}_off(t,n){const i=t.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var l;return!(((l=r.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&ov.isEqual(r.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(t[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Lr.close,{},t)}_onError(t){this._on(Lr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=vi.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=S1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=S1(t.columns,t.old_record)),n}}const kp=()=>{},lg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},L_=[1e3,2e3,5e3,1e4],G_=1e4,H_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class P_{constructor(t,n){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Hm,this.transport=null,this.heartbeatIntervalMs=lg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=kp,this.ref=0,this.reconnectTimer=null,this.logger=kp,this.conn=null,this.sendBuffer=[],this.serializer=new N_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let l;return r?l=r:typeof fetch>"u"?l=(...c)=>yf(async()=>{const{default:d}=await Promise.resolve().then(()=>bu);return{default:d}},void 0).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((i=n==null?void 0:n.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${Pm.websocket}`,this.httpEndpoint=FS(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=T_.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:O_}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,i){this.logger(t,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case rd.connecting:return cu.Connecting;case rd.open:return cu.Open;case rd.closing:return cu.Closing;default:return cu.Closed}}isConnected(){return this.connectionState()===cu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const i=`realtime:${t}`,r=this.getChannels().find(l=>l.topic===i);if(r)return r;{const l=new ov(`realtime:${t}`,n,this);return this.channels.push(l),l}}push(t){const{topic:n,event:i,payload:r,ref:l}=t,c=()=>{this.encode(t,d=>{var g;(g=this.conn)===null||g===void 0||g.send(d)})};this.log("push",`${n} ${i} (${l})`,r),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(R_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},lg.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:l,ref:c}=n,d=c?`(${c})`:"",g=l.status||"";this.log("receive",`${g} ${i} ${r} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(r,l,c)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Lr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const i=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${i}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const i=new Blob([H_],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(i=>{const r={access_token:n,version:w_};n&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Lr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(i=>{try{i(n)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(i){this.log("error",`error triggering ${t} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new QS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,i,r,l,c,d,g,m,_;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(i=t==null?void 0:t.timeout)!==null&&i!==void 0?i:Hm,this.heartbeatIntervalMs=(r=t==null?void 0:t.heartbeatIntervalMs)!==null&&r!==void 0?r:lg.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t==null?void 0:t.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=t==null?void 0:t.heartbeatCallback)!==null&&d!==void 0?d:kp,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(C=>L_[C-1]||G_),this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((C,E)=>E(JSON.stringify(C))),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class uv extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function kn(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class I_ extends uv{constructor(t,n,i){super(t),this.name="StorageApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class km extends uv{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const cv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>yf(async()=>{const{default:i}=await Promise.resolve().then(()=>bu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},k_=()=>se(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield yf(()=>Promise.resolve().then(()=>bu),void 0)).Response:Response}),qm=o=>{if(Array.isArray(o))return o.map(n=>qm(n));if(typeof o=="function"||o!==Object(o))return o;const t={};return Object.entries(o).forEach(([n,i])=>{const r=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[r]=qm(i)}),t},q_=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},qp=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),V_=(o,t,n)=>se(void 0,void 0,void 0,function*(){const i=yield k_();o instanceof i&&!(n!=null&&n.noResolveJson)?o.json().then(r=>{const l=o.status||500,c=(r==null?void 0:r.statusCode)||l+"";t(new I_(qp(r),l,c))}).catch(r=>{t(new km(qp(r),r))}):t(new km(qp(o),o))}),Y_=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"||!i?r:(q_(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,t!=null&&t.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),n))};function md(o,t,n,i,r,l){return se(this,void 0,void 0,function*(){return new Promise((c,d)=>{o(n,Y_(t,i,r,l)).then(g=>{if(!g.ok)throw g;return i!=null&&i.noResolveJson?g:g.json()}).then(g=>c(g)).catch(g=>V_(g,d,i))})})}function fd(o,t,n,i){return se(this,void 0,void 0,function*(){return md(o,"GET",t,n,i)})}function zr(o,t,n,i,r){return se(this,void 0,void 0,function*(){return md(o,"POST",t,i,r,n)})}function Vm(o,t,n,i,r){return se(this,void 0,void 0,function*(){return md(o,"PUT",t,i,r,n)})}function K_(o,t,n,i){return se(this,void 0,void 0,function*(){return md(o,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function fv(o,t,n,i,r){return se(this,void 0,void 0,function*(){return md(o,"DELETE",t,i,r,n)})}class Q_{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return se(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(kn(t))return{data:null,error:t};throw t}})}}var JS;class X_{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[JS]="BlobDownloadBuilder",this.promise=null}asStream(){return new Q_(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return se(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(kn(t))return{data:null,error:t};throw t}})}}JS=Symbol.toStringTag;const F_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},E1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class J_{constructor(t,n={},i,r){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=i,this.fetch=cv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,i,r){return se(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},E1),r);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(c.upsert)});const g=c.metadata;typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",this.encodeMetadata(g)),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",this.encodeMetadata(g))):(l=i,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,g&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),r!=null&&r.headers&&(d=Object.assign(Object.assign({},d),r.headers));const m=this._removeEmptyFolders(n),_=this._getFinalPath(m),C=yield(t=="PUT"?Vm:zr)(this.fetch,`${this.url}/object/${_}`,l,Object.assign({headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:C.Id,fullPath:C.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(kn(l))return{data:null,error:l};throw l}})}upload(t,n,i){return se(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,i)})}uploadToSignedUrl(t,n,i,r){return se(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",n);try{let g;const m=Object.assign({upsert:E1.upsert},r),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&i instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",i)):typeof FormData<"u"&&i instanceof FormData?(g=i,g.append("cacheControl",m.cacheControl)):(g=i,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType);const C=yield Vm(this.fetch,d.toString(),g,{headers:_});return{data:{path:l,fullPath:C.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(kn(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(t,n){return se(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const l=yield zr(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new uv("No token returned by API");return{data:{signedUrl:c.toString(),path:t,token:d},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(kn(i))return{data:null,error:i};throw i}})}update(t,n,i){return se(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,i)})}move(t,n,i){return se(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}copy(t,n,i){return se(this,void 0,void 0,function*(){try{return{data:{path:(yield zr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,i){return se(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),l=yield zr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const c=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,i){return se(this,void 0,void 0,function*(){try{const r=yield zr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),l=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}download(t,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),c=l?`?${l}`:"",d=this._getFinalPath(t),g=()=>fd(this.fetch,`${this.url}/${r}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new X_(g,this.shouldThrowOnError)}info(t){return se(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const i=yield fd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:qm(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(kn(i))return{data:null,error:i};throw i}})}exists(t){return se(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield K_(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(kn(i)&&i instanceof km){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,n){const i=this._getFinalPath(t),r=[],l=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&r.push(l);const d=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});g!==""&&r.push(g);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${i}${m}`)}}}remove(t){return se(this,void 0,void 0,function*(){try{return{data:yield fv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}list(t,n,i){return se(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},F_),n),{prefix:t||""});return{data:yield zr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}listV2(t,n){return se(this,void 0,void 0,function*(){try{const i=Object.assign({},t);return{data:yield zr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(kn(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const ZS="2.76.1",WS={"X-Client-Info":`storage-js/${ZS}`};class Z_{constructor(t,n={},i,r){this.shouldThrowOnError=!1;const l=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},WS),n),this.fetch=cv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return se(this,void 0,void 0,function*(){try{return{data:yield fd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(kn(t))return{data:null,error:t};throw t}})}getBucket(t){return se(this,void 0,void 0,function*(){try{return{data:yield fd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}createBucket(t){return se(this,arguments,void 0,function*(n,i={public:!1}){try{return{data:yield zr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return se(this,void 0,void 0,function*(){try{return{data:yield Vm(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(kn(i))return{data:null,error:i};throw i}})}emptyBucket(t){return se(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return se(this,void 0,void 0,function*(){try{return{data:yield fv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}}class W_{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},WS),n),this.fetch=cv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return se(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}listBuckets(t){return se(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const i=n.toString(),r=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`,l=yield fd(this.fetch,r,{headers:this.headers});return{data:Array.isArray(l)?l.filter(d=>d.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return se(this,void 0,void 0,function*(){try{return{data:yield fv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}}const hv={"X-Client-Info":`storage-js/${ZS}`,"Content-Type":"application/json"};class $S extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Ua(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class Vp extends $S{constructor(t,n,i){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class $_ extends $S{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var C1;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(C1||(C1={}));const dv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>yf(async()=>{const{default:i}=await Promise.resolve().then(()=>bu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},tE=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},T1=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),eE=(o,t,n)=>se(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!(n!=null&&n.noResolveJson)){const r=o.status||500,l=o;if(typeof l.json=="function")l.json().then(c=>{const d=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||r+"";t(new Vp(T1(c),r,d))}).catch(()=>{const c=r+"",d=l.statusText||`HTTP ${r} error`;t(new Vp(d,r,c))});else{const c=r+"",d=l.statusText||`HTTP ${r} error`;t(new Vp(d,r,c))}}else t(new $_(T1(o),o))}),nE=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return i?(tE(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),n)):r};function iE(o,t,n,i,r,l){return se(this,void 0,void 0,function*(){return new Promise((c,d)=>{o(n,nE(t,i,r,l)).then(g=>{if(!g.ok)throw g;if(i!=null&&i.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>c(g)).catch(g=>eE(g,d,i))})})}function Ba(o,t,n,i,r){return se(this,void 0,void 0,function*(){return iE(o,"POST",t,i,r,n)})}class aE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hv),n),this.fetch=dv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return se(this,void 0,void 0,function*(){try{return{data:(yield Ba(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}getIndex(t,n){return se(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ua(i))return{data:null,error:i};throw i}})}listIndexes(t){return se(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return se(this,void 0,void 0,function*(){try{return{data:(yield Ba(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ua(i))return{data:null,error:i};throw i}})}}class rE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hv),n),this.fetch=dv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return se(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Ba(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}getVectors(t){return se(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}listVectors(t){return se(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Ba(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}queryVectors(t){return se(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}deleteVectors(t){return se(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Ba(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}}class sE{constructor(t,n={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hv),n),this.fetch=dv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return se(this,void 0,void 0,function*(){try{return{data:(yield Ba(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}getBucket(t){return se(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}listBuckets(){return se(this,arguments,void 0,function*(t={}){try{return{data:yield Ba(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}deleteBucket(t){return se(this,void 0,void 0,function*(){try{return{data:(yield Ba(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ua(n))return{data:null,error:n};throw n}})}}class lE extends sE{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new oE(this.url,this.headers,t,this.fetch)}}class oE extends aE{constructor(t,n,i,r){super(t,n,r),this.vectorBucketName=i}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return se(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return se(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return se(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return se(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new uE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class uE extends rE{constructor(t,n,i,r,l){super(t,n,l),this.vectorBucketName=i,this.indexName=r}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return se(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return se(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return se(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return se(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return se(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class cE extends Z_{constructor(t,n={},i,r){super(t,n,i,r)}from(t){return new J_(this.url,this.headers,t,this.fetch)}get vectors(){return new lE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new W_(this.url+"/iceberg",this.headers,this.fetch)}}const fE="2.76.1";let td="";typeof Deno<"u"?td="deno":typeof document<"u"?td="web":typeof navigator<"u"&&navigator.product==="ReactNative"?td="react-native":td="node";const hE={"X-Client-Info":`supabase-js-${td}/${fE}`},dE={headers:hE},gE={schema:"public"},pE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},mE={},vE=o=>{let t;return o?t=o:typeof fetch>"u"?t=IS:t=fetch,(...n)=>t(...n)},yE=()=>typeof Headers>"u"?kS:Headers,SE=(o,t,n)=>{const i=vE(n),r=yE();return async(l,c)=>{var d;const g=(d=await t())!==null&&d!==void 0?d:o;let m=new r(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),i(l,Object.assign(Object.assign({},c),{headers:m}))}};function bE(o){return o.endsWith("/")?o:o+"/"}function _E(o,t){var n,i;const{db:r,auth:l,realtime:c,global:d}=o,{db:g,auth:m,realtime:_,global:C}=t,E={db:Object.assign(Object.assign({},g),r),auth:Object.assign(Object.assign({},m),l),realtime:Object.assign(Object.assign({},_),c),storage:{},global:Object.assign(Object.assign(Object.assign({},C),d),{headers:Object.assign(Object.assign({},(n=C==null?void 0:C.headers)!==null&&n!==void 0?n:{}),(i=d==null?void 0:d.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return o.accessToken?E.accessToken=o.accessToken:delete E.accessToken,E}function EE(o){const t=o==null?void 0:o.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(bE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const tb="2.76.1",af=30*1e3,Ym=3,Yp=Ym*af,CE="http://localhost:9999",TE="supabase.auth.token",AE={"X-Client-Info":`gotrue-js/${tb}`},Km="X-Supabase-Api-Version",eb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},wE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,OE=600*1e3;class hd extends Error{constructor(t,n,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function de(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class RE extends hd{constructor(t,n,i){super(t,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function xE(o){return de(o)&&o.name==="AuthApiError"}class fu extends hd{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class mo extends hd{constructor(t,n,i,r){super(t,i,r),this.name=n,this.status=i}}class ro extends mo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function NE(o){return de(o)&&o.name==="AuthSessionMissingError"}class Fc extends mo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class og extends mo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ug extends mo{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ME(o){return de(o)&&o.name==="AuthImplicitGrantRedirectError"}class A1 extends mo{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qm extends mo{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Kp(o){return de(o)&&o.name==="AuthRetryableFetchError"}class w1 extends mo{constructor(t,n,i){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}class Xm extends mo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Sg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),O1=` 	
\r=`.split(""),DE=(()=>{const o=new Array(128);for(let t=0;t<o.length;t+=1)o[t]=-1;for(let t=0;t<O1.length;t+=1)o[O1[t].charCodeAt(0)]=-2;for(let t=0;t<Sg.length;t+=1)o[Sg[t].charCodeAt(0)]=t;return o})();function R1(o,t,n){if(o!==null)for(t.queue=t.queue<<8|o,t.queuedBits+=8;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(Sg[i]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;n(Sg[i]),t.queuedBits-=6}}function nb(o,t,n){const i=DE[o];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function x1(o){const t=[],n=c=>{t.push(String.fromCodePoint(c))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},l=c=>{BE(c,i,n)};for(let c=0;c<o.length;c+=1)nb(o.charCodeAt(c),r,l);return t.join("")}function jE(o,t){if(o<=127){t(o);return}else if(o<=2047){t(192|o>>6),t(128|o&63);return}else if(o<=65535){t(224|o>>12),t(128|o>>6&63),t(128|o&63);return}else if(o<=1114111){t(240|o>>18),t(128|o>>12&63),t(128|o>>6&63),t(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function UE(o,t){for(let n=0;n<o.length;n+=1){let i=o.charCodeAt(n);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(o.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}jE(i,t)}}function BE(o,t,n){if(t.utf8seq===0){if(o<=127){n(o);return}for(let i=1;i<6;i+=1)if((o>>7-i&1)===0){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=o&31;else if(t.utf8seq===3)t.codepoint=o&15;else if(t.utf8seq===4)t.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|o&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function lf(o){const t=[],n={queue:0,queuedBits:0},i=r=>{t.push(r)};for(let r=0;r<o.length;r+=1)nb(o.charCodeAt(r),n,i);return new Uint8Array(t)}function zE(o){const t=[];return UE(o,n=>t.push(n)),new Uint8Array(t)}function du(o){const t=[],n={queue:0,queuedBits:0},i=r=>{t.push(r)};return o.forEach(r=>R1(r,n,i)),R1(null,n,i),t.join("")}function LE(o){return Math.round(Date.now()/1e3)+o}function GE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o=="x"?t:t&3|8).toString(16)})}const Da=()=>typeof window<"u"&&typeof document<"u",su={tested:!1,writable:!1},ib=()=>{if(!Da())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(su.tested)return su.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),su.tested=!0,su.writable=!0}catch{su.tested=!0,su.writable=!1}return su.writable};function HE(o){const t={},n=new URL(o);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,l)=>{t[l]=r})}catch{}return n.searchParams.forEach((i,r)=>{t[r]=i}),t}const ab=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>yf(async()=>{const{default:i}=await Promise.resolve().then(()=>bu);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},PE=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",rf=async(o,t,n)=>{await o.setItem(t,JSON.stringify(n))},lu=async(o,t)=>{const n=await o.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},eo=async(o,t)=>{await o.removeItem(t)};class jg{constructor(){this.promise=new jg.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}jg.promiseConstructor=Promise;function Qp(o){const t=o.split(".");if(t.length!==3)throw new Xm("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!wE.test(t[i]))throw new Xm("JWT not in base64url format");return{header:JSON.parse(x1(t[0])),payload:JSON.parse(x1(t[1])),signature:lf(t[2]),raw:{header:t[0],payload:t[1]}}}async function IE(o){return await new Promise(t=>{setTimeout(()=>t(null),o)})}function kE(o,t){return new Promise((i,r)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await o(l);if(!t(l,null,c)){i(c);return}}catch(c){if(!t(l,c)){r(c);return}}})()})}function qE(o){return("0"+o.toString(16)).substr(-2)}function VE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let r="";for(let l=0;l<56;l++)r+=n.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(t),Array.from(t,qE).join("")}async function YE(o){const n=new TextEncoder().encode(o),i=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(i);return Array.from(r).map(l=>String.fromCharCode(l)).join("")}async function KE(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const n=await YE(o);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Jc(o,t,n=!1){const i=VE();let r=i;n&&(r+="/PASSWORD_RECOVERY"),await rf(o,`${t}-code-verifier`,r);const l=await KE(i);return[l,i===l?"plain":"s256"]}const QE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function XE(o){const t=o.headers.get(Km);if(!t||!t.match(QE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function FE(o){if(!o)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(o<=t)throw new Error("JWT has expired")}function JE(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ZE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zc(o){if(!ZE.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xp(){const o={};return new Proxy(o,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function N1(o){return JSON.parse(JSON.stringify(o))}const uu=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),WE=[502,503,504];async function M1(o){var t;if(!PE(o))throw new Qm(uu(o),0);if(WE.includes(o.status))throw new Qm(uu(o),o.status);let n;try{n=await o.json()}catch(l){throw new fu(uu(l),l)}let i;const r=XE(o);if(r&&r.getTime()>=eb["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new w1(uu(n),o.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new ro}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new w1(uu(n),o.status,n.weak_password.reasons);throw new RE(uu(n),o.status||500,i)}const $E=(o,t,n,i)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))};async function Ae(o,t,n,i){var r;const l=Object.assign({},i==null?void 0:i.headers);l[Km]||(l[Km]=eb["2024-01-01"].name),i!=null&&i.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const c=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(c.redirect_to=i.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",g=await tC(o,t,n+d,{headers:l,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(g):{data:Object.assign({},g),error:null}}async function tC(o,t,n,i,r,l){const c=$E(t,i,r,l);let d;try{d=await o(n,Object.assign({},c))}catch(g){throw console.error(g),new Qm(uu(g),0)}if(d.ok||await M1(d),i!=null&&i.noResolveJson)return d;try{return await d.json()}catch(g){await M1(g)}}function Br(o){var t;let n=null;iC(o)&&(n=Object.assign({},o),o.expires_at||(n.expires_at=LE(o.expires_in)));const i=(t=o.user)!==null&&t!==void 0?t:o;return{data:{session:n,user:i},error:null}}function D1(o){const t=Br(o);return!t.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(t.data.weak_password=o.weak_password),t}function lo(o){var t;return{data:{user:(t=o.user)!==null&&t!==void 0?t:o},error:null}}function eC(o){return{data:o,error:null}}function nC(o){const{action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:l}=o,c=vf(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:l},g=Object.assign({},c);return{data:{properties:d,user:g},error:null}}function j1(o){return o}function iC(o){return o.access_token&&o.refresh_token&&o.expires_in}const Fp=["global","local","others"];class aC{constructor({url:t="",headers:n={},fetch:i}){this.url=t,this.headers=n,this.fetch=ab(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Fp[0]){if(Fp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fp.join(", ")}`);try{return await Ae(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(de(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,n={}){try{return await Ae(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:lo})}catch(i){if(de(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:n}=t,i=vf(t,["options"]),r=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await Ae(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:nC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(de(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Ae(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:lo})}catch(n){if(de(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,i,r,l,c,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Ae(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:j1});if(_.error)throw _.error;const C=await _.json(),E=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,O=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return O.length>0&&(O.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),L=JSON.parse(v.split(";")[1].split("=")[1]);m[`${L}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(de(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){Zc(t);try{return await Ae(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:lo})}catch(n){if(de(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Zc(t);try{return await Ae(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:lo})}catch(i){if(de(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,n=!1){Zc(t);try{return await Ae(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:lo})}catch(i){if(de(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){Zc(t.userId);try{const{data:n,error:i}=await Ae(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:i}}catch(n){if(de(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Zc(t.userId),Zc(t.id);try{return{data:await Ae(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(de(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,i,r,l,c,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Ae(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:j1});if(_.error)throw _.error;const C=await _.json(),E=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,O=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return O.length>0&&(O.forEach(v=>{const D=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),L=JSON.parse(v.split(";")[1].split("=")[1]);m[`${L}Page`]=D}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(de(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await Ae(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(de(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await Ae(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(de(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ae(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(de(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await Ae(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(de(n))return{data:null,error:n};throw n}}}function U1(o={}){return{getItem:t=>o[t]||null,setItem:(t,n)=>{o[t]=n},removeItem:t=>{delete o[t]}}}const Wc={debug:!!(globalThis&&ib()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rb extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class rC extends rb{}async function sC(o,t,n){Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,r.name);try{return await n()}finally{Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,r.name)}}else{if(t===0)throw Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new rC(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Wc.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function lC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function sb(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function oC(o){return parseInt(o,16)}function uC(o){const t=new TextEncoder().encode(o);return"0x"+Array.from(t,i=>i.toString(16).padStart(2,"0")).join("")}function cC(o){var t;const{chainId:n,domain:i,expirationTime:r,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:g,resources:m,scheme:_,uri:C,version:E}=o;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((t=o.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const O=sb(o.address),v=_?`${_}://${i}`:i,D=o.statement?`${o.statement}
`:"",L=`${v} wants you to sign in with your Ethereum account:
${O}

${D}`;let z=`URI: ${C}
Version: ${E}
Chain ID: ${n}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(r&&(z+=`
Expiration Time: ${r.toISOString()}`),d&&(z+=`
Not Before: ${d.toISOString()}`),g&&(z+=`
Request ID: ${g}`),m){let M=`
Resources:`;for(const N of m){if(!N||typeof N!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${N}`);M+=`
- ${N}`}z+=M}return`${L}
${z}`}class si extends Error{constructor({message:t,code:n,cause:i,name:r}){var l;super(t,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=r??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class bg extends si{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function fC({error:o,options:t}){var n,i,r;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new si({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new si({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(t.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new si({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new si({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new si({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new si({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new si({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new si({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const c=window.location.hostname;if(lb(c)){if(l.rp.id!==c)return new si({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new si({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new si({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new si({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new si({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function hC({error:o,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new si({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new si({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const i=window.location.hostname;if(lb(i)){if(n.rpId!==i)return new si({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new si({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new si({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new si({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class dC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const gC=new dC;function pC(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:t,user:n,excludeCredentials:i}=o,r=vf(o,["challenge","user","excludeCredentials"]),l=lf(t).buffer,c=Object.assign(Object.assign({},n),{id:lf(n.id).buffer}),d=Object.assign(Object.assign({},r),{challenge:l,user:c});if(i&&i.length>0){d.excludeCredentials=new Array(i.length);for(let g=0;g<i.length;g++){const m=i[g];d.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:lf(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function mC(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:t,allowCredentials:n}=o,i=vf(o,["challenge","allowCredentials"]),r=lf(t).buffer,l=Object.assign(Object.assign({},i),{challenge:r});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:lf(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function vC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o;return{id:o.id,rawId:o.id,response:{attestationObject:du(new Uint8Array(o.response.attestationObject)),clientDataJSON:du(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function yC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o,i=o.getClientExtensionResults(),r=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:du(new Uint8Array(r.authenticatorData)),clientDataJSON:du(new Uint8Array(r.clientDataJSON)),signature:du(new Uint8Array(r.signature)),userHandle:r.userHandle?du(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function lb(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function B1(){var o,t;return!!(Da()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator==null?void 0:navigator.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function SC(o){try{const t=await navigator.credentials.create(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new bg("Browser returned unexpected credential type",t)}:{data:null,error:new bg("Empty credential response",t)}}catch(t){return{data:null,error:fC({error:t,options:o})}}}async function bC(o){try{const t=await navigator.credentials.get(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new bg("Browser returned unexpected credential type",t)}:{data:null,error:new bg("Empty credential response",t)}}catch(t){return{data:null,error:hC({error:t,options:o})}}}const _C={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},EC={userVerification:"preferred",hints:["security-key"]};function _g(...o){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),i={};for(const r of o)if(r)for(const l in r){const c=r[l];if(c!==void 0)if(Array.isArray(c))i[l]=c;else if(n(c))i[l]=c;else if(t(c)){const d=i[l];t(d)?i[l]=_g(d,c):i[l]=_g(c)}else i[l]=c}return i}function CC(o,t){return _g(_C,o,t||{})}function TC(o,t){return _g(EC,o,t||{})}class AC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:i,signal:r},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!c)return{data:null,error:d};const g=r??gC.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=CC(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:C}=await SC({publicKey:m,signal:g});return _?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}case"request":{const m=TC(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:C}=await bC(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}}}catch(c){return de(c)?{data:null,error:c}:{data:null,error:new fu("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:n,webauthn:i}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:i})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r}},l){if(!n)return{data:null,error:new hd("rpId is required for WebAuthn authentication")};try{if(!B1())return{data:null,error:new fu("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:i},signal:r},{request:l});if(!c)return{data:null,error:d};const{webauthn:g}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:i,credential_response:g.credential_response}})}catch(c){return de(c)?{data:null,error:c}:{data:null,error:new fu("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r},l){if(!n)return{data:null,error:new hd("rpId is required for WebAuthn registration")};try{if(!B1())return{data:null,error:new fu("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(_=>{var C;return(C=_.data)===null||C===void 0?void 0:C.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===t&&E.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:d};const{data:g,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:n,rpOrigins:i},signal:r},{create:l});return g?this._verify({factorId:c.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:i,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(c){return de(c)?{data:null,error:c}:{data:null,error:new fu("Unexpected error in register",c)}}}}lC();const wC={url:CE,storageKey:TE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:AE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function z1(o,t,n){return await n()}const $c={};class dd{get jwks(){var t,n;return(n=(t=$c[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){$c[this.storageKey]=Object.assign(Object.assign({},$c[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=$c[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){$c[this.storageKey]=Object.assign(Object.assign({},$c[this.storageKey]),{cachedAt:t})}constructor(t){var n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=dd.nextInstanceID,dd.nextInstanceID+=1,this.instanceID>0&&Da()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},wC),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new aC({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=ab(r.fetch),this.lock=r.lock||z1,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Da()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=sC:this.lock=z1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new AC(this)},this.persistSession?(r.storage?this.storage=r.storage:ib()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=U1(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=U1(this.memoryStorage)),Da()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${tb}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=HE(window.location.href);let i="none";if(this._isImplicitGrantCallback(n)?i="implicit":await this._isPKCECallback(n)&&(i="pkce"),Da()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:l}=await this._getSessionFromURL(n,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),ME(l)){const g=(t=l.details)===null||t===void 0?void 0:t.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=r;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return de(n)?{error:n}:{error:new fu("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,i,r;try{const l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:Br}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const g=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(de(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var n,i,r;try{let l;if("email"in t){const{email:_,password:C,options:E}=t;let O=null,v=null;this.flowType==="pkce"&&([O,v]=await Jc(this.storage,this.storageKey)),l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:_,password:C,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:O,code_challenge_method:v},xform:Br})}else if("phone"in t){const{phone:_,password:C,options:E}=t;l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:C,data:(i=E==null?void 0:E.data)!==null&&i!==void 0?i:{},channel:(r=E==null?void 0:E.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:Br})}else throw new og("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const g=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(de(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:c,options:d}=t;n=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:D1})}else if("phone"in t){const{phone:l,password:c,options:d}=t;n=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:D1})}else throw new og("You must provide either an email or phone number and a password");const{data:i,error:r}=n;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Fc}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(n){if(de(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,i,r,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,i,r,l,c,d,g,m,_,C,E;let O,v;if("message"in t)O=t.message,v=t.signature;else{const{chain:D,wallet:L,statement:z,options:M}=t;let N;if(Da())if(typeof L=="object")N=L;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")N=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(M!=null&&M.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=L}const G=new URL((n=M==null?void 0:M.url)!==null&&n!==void 0?n:window.location.href),R=await N.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=sb(R[0]);let T=(i=M==null?void 0:M.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!T){const B=await N.request({method:"eth_chainId"});T=oC(B)}const y={domain:G.host,address:A,statement:z,uri:G.href,version:"1",chainId:T,nonce:(r=M==null?void 0:M.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(c=(l=M==null?void 0:M.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=M==null?void 0:M.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(g=M==null?void 0:M.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=M==null?void 0:M.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=M==null?void 0:M.signInWithEthereum)===null||_===void 0?void 0:_.resources};O=cC(y),v=await N.request({method:"personal_sign",params:[uC(O),A]})}try{const{data:D,error:L}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:O,signature:v},!((C=t.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(E=t.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:Br});if(L)throw L;return!D||!D.session||!D.user?{data:{user:null,session:null},error:new Fc}:(D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),{data:Object.assign({},D),error:L})}catch(D){if(de(D))return{data:{user:null,session:null},error:D};throw D}}async signInWithSolana(t){var n,i,r,l,c,d,g,m,_,C,E,O;let v,D;if("message"in t)v=t.message,D=t.signature;else{const{chain:L,wallet:z,statement:M,options:N}=t;let G;if(Da())if(typeof z=="object")G=z;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))G=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof z!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=z}const R=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in G&&G.signIn){const A=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),M?{statement:M}:null));let T;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")T=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)T=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)v=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),D=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${R.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(r=(i=N==null?void 0:N.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((l=N==null?void 0:N.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((g=N==null?void 0:N.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((m=N==null?void 0:N.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((C=(_=N==null?void 0:N.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||C===void 0)&&C.length?["Resources",...N.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const A=await G.signMessage(new TextEncoder().encode(v),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=A}}try{const{data:L,error:z}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:du(D)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(O=t.options)===null||O===void 0?void 0:O.captchaToken}}:null),xform:Br});if(z)throw z;return!L||!L.session||!L.user?{data:{user:null,session:null},error:new Fc}:(L.session&&(await this._saveSession(L.session),await this._notifyAllSubscribers("SIGNED_IN",L.session)),{data:Object.assign({},L),error:z})}catch(L){if(de(L))return{data:{user:null,session:null},error:L};throw L}}async _exchangeCodeForSession(t){const n=await lu(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(n??"").split("/");try{const{data:l,error:c}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:Br});if(await eo(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Fc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:r??null}),error:c})}catch(l){if(de(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:n,provider:i,token:r,access_token:l,nonce:c}=t,d=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Br}),{data:g,error:m}=d;return m?{data:{user:null,session:null},error:m}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Fc}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:m})}catch(n){if(de(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,i,r,l,c;try{if("email"in t){const{email:d,options:g}=t;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await Jc(this.storage,this.storageKey));const{error:C}=await Ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(i=g==null?void 0:g.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:d,options:g}=t,{data:m,error:_}=await Ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(c=g==null?void 0:g.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_}}throw new og("You must provide either an email or phone number.")}catch(d){if(de(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(t){var n,i;try{let r,l;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:c,error:d}=await Ae(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:r,xform:Br});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const g=c.session,m=c.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(r){if(de(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,i,r;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await Jc(this.storage,this.storageKey)),await Ae(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:eC})}catch(l){if(de(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;if(i)throw i;if(!n)throw new ro;const{error:r}=await Ae(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(de(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:i,type:r,options:l}=t,{error:c}=await Ae(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in t){const{phone:i,type:r,options:l}=t,{data:c,error:d}=await Ae(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new og("You must provide either an email or phone number and a type")}catch(n){if(de(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await lu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at*1e3-Date.now()<Yp:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.userStorage){const c=await lu(this.userStorage,this.storageKey+"-user");c!=null&&c.user?t.user=c.user:t.user=Xp()}if(this.storage.isServer&&t.user){let c=this.suppressGetSessionWarning;t=new Proxy(t,{get:(g,m,_)=>(!c&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,m,_))})}return{data:{session:t},error:null}}const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:lo}):await this._useSession(async n=>{var i,r,l;const{data:c,error:d}=n;if(d)throw d;return!(!((i=c.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ro}:await Ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(r=c.session)===null||r===void 0?void 0:r.access_token)!==null&&l!==void 0?l:void 0,xform:lo})})}catch(n){if(de(n))return NE(n)&&(await this._removeSession(),await eo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async i=>{const{data:r,error:l}=i;if(l)throw l;if(!r.session)throw new ro;const c=r.session;let d=null,g=null;this.flowType==="pkce"&&t.email!=null&&([d,g]=await Jc(this.storage,this.storageKey));const{data:m,error:_}=await Ae(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:g}),jwt:c.access_token,xform:lo});if(_)throw _;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(i){if(de(i))return{data:{user:null},error:i};throw i}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ro;const n=Date.now()/1e3;let i=n,r=!0,l=null;const{payload:c}=Qp(t.access_token);if(c.exp&&(i=c.exp,r=i<=n),r){const{data:d,error:g}=await this._callRefreshToken(t.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:g}=await this._getUser(t.access_token);if(g)throw g;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(n){if(de(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var i;if(!t){const{data:c,error:d}=n;if(d)throw d;t=(i=c.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new ro;const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(de(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Da())throw new ug("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ug(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new A1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ug("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new A1("No code detected.");const{data:M,error:N}=await this._exchangeCodeForSession(t.code);if(N)throw N;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:l,refresh_token:c,expires_in:d,expires_at:g,token_type:m}=t;if(!l||!d||!c||!m)throw new ug("No session defined in URL");const _=Math.round(Date.now()/1e3),C=parseInt(d);let E=_+C;g&&(E=parseInt(g));const O=E-_;O*1e3<=af&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${O}s, should have been closer to ${C}s`);const v=E-C;_-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,E,_):_-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,E,_);const{data:D,error:L}=await this._getUser(l);if(L)throw L;const z={provider_token:i,provider_refresh_token:r,access_token:l,expires_in:C,expires_at:E,refresh_token:c,token_type:m,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:z,redirectType:t.type},error:null}}catch(i){if(de(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await lu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{error:l};const c=(i=r.session)===null||i===void 0?void 0:i.access_token;if(c){const{error:d}=await this.admin.signOut(c,t);if(d&&!(xE(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return t!=="others"&&(await this._removeSession(),await eo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=GE(),i={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async n=>{var i,r;try{const{data:{session:l},error:c}=n;if(c)throw c;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await Jc(this.storage,this.storageKey,!0));try{return await Ae(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(de(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(de(n))return{data:null,error:n};throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:i,error:r}=await this._useSession(async l=>{var c,d,g,m,_;const{data:C,error:E}=l;if(E)throw E;const O=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=t.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Ae(this.fetch,"GET",O,{headers:this.headers,jwt:(_=(m=C.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(r)throw r;return Da()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(de(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var i;try{const{error:r,data:{session:l}}=n;if(r)throw r;const{options:c,provider:d,token:g,access_token:m,nonce:_}=t,C=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l==null?void 0:l.access_token)!==null&&i!==void 0?i:void 0,body:{provider:d,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Br}),{data:E,error:O}=C;return O?{data:{user:null,session:null},error:O}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new Fc}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:O})}catch(r){if(de(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var i,r;const{data:l,error:c}=n;if(c)throw c;return await Ae(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(de(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await kE(async r=>(r>0&&await IE(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await Ae(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Br})),(r,l)=>{const c=200*Math.pow(2,r);return l&&Kp(l)&&Date.now()+c-i<af})}catch(i){if(this._debug(n,"error",i),de(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",i),Da()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t,n;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await lu(this.storage,this.storageKey);if(r&&this.userStorage){let c=await lu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:r.user},await rf(this.userStorage,this.storageKey+"-user",c)),r.user=(t=c==null?void 0:c.user)!==null&&t!==void 0?t:Xp()}else if(r&&!r.user&&!r.user){const c=await lu(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(r.user=c.user,await eo(this.storage,this.storageKey+"-user"),await rf(this.storage,this.storageKey,r)):r.user=Xp()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const l=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Yp;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${Yp}s`),l){if(this.autoRefreshToken&&r.refresh_token){const{error:c}=await this._callRefreshToken(r.refresh_token);c&&(console.error(c),Kp(c)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(r.access_token);!d&&(c!=null&&c.user)?(r.user=c.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(i,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(t){var n,i;if(!t)throw new ro;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new jg;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new ro;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(r,"error",l),de(l)){const c={data:null,error:l};return Kp(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(c),c}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,i=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,n)}catch(g){l.push(g)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),i=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&n.user&&await rf(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const l=N1(r);await rf(this.storage,this.storageKey,l)}else{const r=N1(n);await rf(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await eo(this.storage,this.storageKey),await eo(this.storage,this.storageKey+"-code-verifier"),await eo(this.storage,this.storageKey+"-user"),this.userStorage&&await eo(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Da()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),af);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-t)/af);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${af}ms, refresh threshold is ${Ym} ticks`),r<=Ym&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof rb)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Da()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,i){const r=[`provider=${encodeURIComponent(n)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,c]=await Jc(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});r.push(d.toString())}if(i!=null&&i.queryParams){const l=new URLSearchParams(i.queryParams);r.push(l.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;return l?{data:null,error:l}:await Ae(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(de(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var i,r;const{data:l,error:c}=n;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:g,error:m}=await Ae(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return m?{data:null,error:m}:(t.factorType==="totp"&&g.type==="totp"&&(!((r=g==null?void 0:g.totp)===null||r===void 0)&&r.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(n){if(de(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?vC(t.webauthn.credential_response):yC(t.webauthn.credential_response)})}:{code:t.code}),{data:d,error:g}=await Ae(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:g})})}catch(n){if(de(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:l}=n;if(l)return{data:null,error:l};const c=await Ae(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:pC(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:mC(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(de(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:i}=await this.getUser();if(i)return{data:null,error:i};const r={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])r.all.push(l),l.status==="verified"&&r[l.factor_type].push(l);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,i;const{data:{session:r},error:l}=t;if(l)return{data:null,error:l};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=Qp(r.access_token);let d=null;c.aal&&(d=c.aal);let g=d;((i=(n=r.user.factors)===null||n===void 0?void 0:n.filter(C=>C.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(g="aal2");const _=c.amr||[];return{data:{currentLevel:d,nextLevel:g,currentAuthenticationMethods:_},error:null}}))}async fetchJwk(t,n={keys:[]}){let i=n.keys.find(d=>d.kid===t);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(d=>d.kid===t),i&&this.jwks_cached_at+OE>r)return i;const{data:l,error:c}=await Ae(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=r,i=l.keys.find(d=>d.kid===t),!i)?null:i}async getClaims(t,n={}){try{let i=t;if(!i){const{data:O,error:v}=await this.getSession();if(v||!O.session)return{data:null,error:v};i=O.session.access_token}const{header:r,payload:l,signature:c,raw:{header:d,payload:g}}=Qp(i);n!=null&&n.allowExpired||FE(l.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!m){const{error:O}=await this.getUser(i);if(O)throw O;return{data:{claims:l,header:r,signature:c},error:null}}const _=JE(r.alg),C=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,C,c,zE(`${d}.${g}`)))throw new Xm("Invalid JWT signature");return{data:{claims:l,header:r,signature:c},error:null}}catch(i){if(de(i))return{data:null,error:i};throw i}}}dd.nextInstanceID=0;const OC=dd;class RC extends OC{constructor(t){super(t)}}class xC{constructor(t,n,i){var r,l,c;this.supabaseUrl=t,this.supabaseKey=n;const d=EE(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const g=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:gE,realtime:mE,auth:Object.assign(Object.assign({},pE),{storageKey:g}),global:dE},_=_E(i??{},m);this.storageKey=(r=_.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(l=_.global.headers)!==null&&l!==void 0?l:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(C,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=_.auth)!==null&&c!==void 0?c:{},this.headers,_.global.fetch),this.fetch=SE(n,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new C_(new URL("rest/v1",d).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new cE(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new d_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,i)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:i}=await this.auth.getSession();return(n=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:l,storageKey:c,flowType:d,lock:g,debug:m},_,C){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new RC({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),_),storageKey:c,autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:l,flowType:d,lock:g,debug:m,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(O=>O.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new P_(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,n,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const NC=(o,t,n)=>new xC(o,t,n);function MC(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const t=o.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}MC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const DC=void 0,jC=void 0;console.error("Missing Supabase environment variables. Please check your .env file.");const Li=NC(DC,jC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),BC=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase()),L1=o=>{const t=BC(o);return t.charAt(0).toUpperCase()+t.slice(1)},ob=(...o)=>o.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim(),zC=o=>{for(const t in o)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var LC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=lt.forwardRef(({color:o="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:l,iconNode:c,...d},g)=>lt.createElement("svg",{ref:g,...LC,width:t,height:t,stroke:o,strokeWidth:i?Number(n)*24/Number(t):n,className:ob("lucide",r),...!l&&!zC(d)&&{"aria-hidden":"true"},...d},[...c.map(([m,_])=>lt.createElement(m,_)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=(o,t)=>{const n=lt.forwardRef(({className:i,...r},l)=>lt.createElement(GC,{ref:l,iconNode:t,className:ob(`lucide-${UC(L1(o))}`,`lucide-${o}`,i),...r}));return n.displayName=L1(o),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],PC=vd("eraser",HC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],kC=vd("pen",IC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],VC=vd("redo",qC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],KC=vd("trash-2",YC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],XC=vd("undo",QC),cl={width:800,height:600},FC=.65,JC=2.2,cg="studentCanvasPrefs",Jp=2,G1=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,ZC=({sharedImage:o,canvasWidth:t,canvasHeight:n})=>{const[i,r]=lt.useState(null);if(lt.useEffect(()=>{if(!o){r(null);return}const O=new window.Image;O.src=o.dataUrl,O.onload=()=>{r(O)}},[o]),!o||!i)return null;const l=i.naturalWidth||i.width,c=i.naturalHeight||i.height;if(!l||!c||!t||!n)return null;const d=l/c,g=t/n;let m,_,C,E;return d>g?(m=t,_=t/d,C=0,E=(n-_)/2):(_=n,m=n*d,C=(t-m)/2,E=0),m=Math.min(m,t),_=Math.min(_,n),k.jsx(av,{image:i,x:C,y:E,width:m,height:_,listening:!1})};function WC(){const[o]=gd(),t=pf(),n=o.get("room"),i=o.get("name"),[r,l]=lt.useState(null),[c]=lt.useState(`student-${Math.random().toString(36).substr(2,9)}`),[d,g]=lt.useState(!1),[m,_]=lt.useState(null),[C,E]=lt.useState(null),[O,v]=lt.useState("loading"),[D,L]=lt.useState(null),[z,M]=lt.useState([]),[N,G]=lt.useState([]),[R,A]=lt.useState(null),[T,y]=lt.useState("pen"),[B,j]=lt.useState("black"),[H,Q]=lt.useState(3),[K,X]=lt.useState(!1),[V,U]=lt.useState("stylus-only"),[I,F]=lt.useState("left"),[W,at]=lt.useState(G1());lt.useEffect(()=>{if(sessionStorage.getItem("student-logout-on-load")==="true"){sessionStorage.removeItem("student-logout-on-load"),t("/student-login");return}(!n||!i)&&t(`/student-login${n?`?room=${n}`:""}`)},[n,i,t]),lt.useEffect(()=>{if(!(typeof window>"u")){console.log(" [STUDENT] Loading preferences from localStorage...");try{const ht=localStorage.getItem(cg);if(ht){const ct=JSON.parse(ht);if(console.log(" [STUDENT] Found stored preferences:",ct),ct.version!==Jp){console.log(" [STUDENT] Version mismatch! Expected:",Jp,"Got:",ct.version),console.log(" [STUDENT] Clearing old preferences..."),localStorage.removeItem(cg);return}console.log(" [STUDENT] Applying preferences..."),ct.tool&&y(ct.tool),ct.color&&j(ct.color),typeof ct.brushSize=="number"&&Q(ct.brushSize),ct.inputMode&&U(ct.inputMode),ct.toolbarPosition&&F(ct.toolbarPosition),console.log(" [STUDENT] Preferences loaded successfully!")}else console.log(" [STUDENT] No stored preferences found, using defaults")}catch(ht){console.warn(" [STUDENT] Failed to load student prefs",ht),localStorage.removeItem(cg)}}},[]),lt.useEffect(()=>{const ht=()=>{at(G1())};return window.addEventListener("resize",ht),()=>window.removeEventListener("resize",ht)},[]),lt.useEffect(()=>{W&&(U("all"),Q(3))},[W]),lt.useEffect(()=>{if(typeof window>"u")return;if(it.current){it.current=!1,console.log(" [STUDENT] Skipping save on first render");return}const ht={version:Jp,tool:T,color:B,brushSize:H,inputMode:V,toolbarPosition:I};console.log(" [STUDENT] Saving preferences to localStorage:",ht),localStorage.setItem(cg,JSON.stringify(ht))},[T,B,H,V,I]);const Z=lt.useRef([]),rt=lt.useRef([]),it=lt.useRef(!0),Y=lt.useRef(z);lt.useEffect(()=>{Y.current=z},[z]);const J=lt.useRef(!1),tt=lt.useRef(!1),et=lt.useRef(null),gt=lt.useRef(null);lt.useEffect(()=>()=>{gt.current&&cancelAnimationFrame(gt.current)},[]),lt.useEffect(()=>{const ht=At.current;if(!ht)return;const ct=Ot=>{const Gt=Ot.target;Gt.closest("button")||Gt.closest(".student-toolbar")||Gt.closest(".student-topbar")||Ot.preventDefault()},wt=Ot=>{Ot.preventDefault()},jt=Ot=>{if(K)return Ot.preventDefault(),!1};return ht.addEventListener("touchstart",ct,{passive:!1}),ht.addEventListener("touchmove",ct,{passive:!1}),ht.addEventListener("gesturestart",wt,{passive:!1}),ht.addEventListener("gesturechange",wt,{passive:!1}),document.addEventListener("selectstart",jt),()=>{ht&&(ht.removeEventListener("touchstart",ct),ht.removeEventListener("touchmove",ct),ht.removeEventListener("gesturestart",wt),ht.removeEventListener("gesturechange",wt)),document.removeEventListener("selectstart",jt)}},[K]);const At=lt.useRef(null),Dt=lt.useRef(null),[Qt,ee]=lt.useState(cl),le=lt.useMemo(()=>cl.width?Qt.width/cl.width:1,[Qt.width]);lt.useEffect(()=>{(async()=>{try{console.log(" Student validating session for room:",n);const{data:ct,error:wt}=await Li.from("sessions").select("*").ilike("room_code",n).order("created_at",{ascending:!1}).limit(1);if(wt){console.error("Failed to query session:",wt),v("ended");return}if(!ct||ct.length===0){console.log(" No session found for room:",n),v("ended");return}const jt=ct[0];console.log(" Session found:",jt),_(jt.id),v(jt.status==="active"?"active":"waiting");const{data:Ot,error:Gt}=await Li.from("participants").insert([{session_id:jt.id,client_id:c,name:i,role:"student"}]).select().single();if(Gt){console.error("Failed to create participant:",Gt);return}console.log(" Participant created:",Ot),E(Ot.id)}catch(ct){console.error("Error initializing session:",ct),v("ended")}})()},[n,c,i]),lt.useEffect(()=>{(async()=>{try{const ct=new pS.Realtime({authUrl:"/api/token",authParams:{clientId:c}});ct.connection.on("connected",()=>{console.log("Connected to Ably"),g(!0)}),ct.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),g(!1)});const wt=ct.channels.get(`room-${n}`);return wt.subscribe("student-layer",jt=>{}),wt.subscribe("teacher-annotation",jt=>{jt.data.targetStudentId===c&&(J.current=!0,G(jt.data.annotations||[]),setTimeout(()=>{J.current=!1},100))}),wt.subscribe("teacher-image",jt=>{var Ot,Gt,Bt,be;A({dataUrl:(Ot=jt.data)==null?void 0:Ot.dataUrl,width:(Gt=jt.data)==null?void 0:Gt.width,height:(Bt=jt.data)==null?void 0:Bt.height,timestamp:(be=jt.data)==null?void 0:be.timestamp})}),wt.subscribe("teacher-template",jt=>{var Ot,Gt,Bt,be,we;A({dataUrl:(Ot=jt.data)==null?void 0:Ot.dataUrl,width:(Gt=jt.data)==null?void 0:Gt.width,height:(Bt=jt.data)==null?void 0:Bt.height,type:(be=jt.data)==null?void 0:be.type,timestamp:(we=jt.data)==null?void 0:we.timestamp})}),wt.subscribe("teacher-clear",jt=>{A(null)}),wt.subscribe("sync-question-state",jt=>{jt.data.targetClientId===c&&(console.log(" Received current question state"),A(jt.data.content))}),wt.subscribe("clear-all-drawings",jt=>{var Ot;console.log(" Clearing all drawings (teacher sent new content)"),(Ot=jt.data)!=null&&Ot.questionId&&L(jt.data.questionId),J.current=!0,M([]),G([]),setTimeout(()=>{J.current=!1},100)}),wt.subscribe("session-started",jt=>{console.log(" Session started!"),v("active")}),wt.subscribe("session-ended",jt=>{var Ot;console.log(" Session ended:",(Ot=jt.data)==null?void 0:Ot.reason),v("ended"),t("/student-login")}),await wt.presence.enter({name:i,isVisible:!document.hidden}),console.log(`Joined room ${n} as ${i}`),l(wt),setTimeout(()=>{wt.publish("request-current-state",{clientId:c,timestamp:Date.now()}),console.log(" Requested current question state from teacher")},1e3),()=>{wt?wt.presence.leave().then(()=>{console.log(" Left presence as",c),ct.close()}).catch(jt=>{console.error("Error leaving presence:",jt),ct.close()}):ct.close()}}catch(ct){console.error("Failed to initialize Ably:",ct)}})()},[c,n]),lt.useEffect(()=>{if(!r)return;const ht=()=>{const jt=!document.hidden;console.log(` Tab visibility changed: ${jt?"visible":"hidden"}`),r.presence.update({name:i,isVisible:jt,lastVisibilityChange:Date.now()}),r.publish("student-visibility",{clientId:c,studentName:i,isVisible:jt,timestamp:Date.now()})};document.addEventListener("visibilitychange",ht);const ct=()=>{document.hidden||(console.log(" Window blur detected"),r.publish("student-visibility",{clientId:c,studentName:i,isVisible:!1,reason:"blur",timestamp:Date.now()}))},wt=()=>{document.hidden||(console.log(" Window focus detected"),r.publish("student-visibility",{clientId:c,studentName:i,isVisible:!0,reason:"focus",timestamp:Date.now()}))};return window.addEventListener("blur",ct),window.addEventListener("focus",wt),()=>{document.removeEventListener("visibilitychange",ht),window.removeEventListener("blur",ct),window.removeEventListener("focus",wt)}},[r,c,i]),lt.useEffect(()=>{const ht=At.current;if(!ht)return;const ct=()=>{if(!At.current)return;const jt=At.current.getBoundingClientRect(),Ot=W?16:48,Gt=Math.max(280,jt.width-Ot),Bt=Math.max(210,jt.height-Ot),be=Gt/cl.width,we=Bt/cl.height,te=Math.min(be,we),sn=Math.max(W?.35:FC,Math.min(JC,te)),Nn=Math.round(sn*20)/20;ee({width:Math.round(cl.width*Nn),height:Math.round(cl.height*Nn)})};ct(),window.addEventListener("resize",ct);let wt;return window.ResizeObserver&&(wt=new ResizeObserver(()=>ct()),wt.observe(ht)),()=>{window.removeEventListener("resize",ct),wt&&wt.disconnect()}},[I,W]),lt.useEffect(()=>{if(!J.current&&r){const ht=setTimeout(()=>{r.publish("student-layer",{lines:z,clientId:c,meta:{base:cl,display:Qt,scale:le}}),console.log("Published student layer:",z.length,"lines")},150);return()=>clearTimeout(ht)}},[z,r,c,Qt,le]),lt.useEffect(()=>{if(!r)return;const ht=wt=>{try{r.presence.leaveClient(c)}catch(jt){console.error("Error leaving presence on unload:",jt)}return sessionStorage.setItem("student-logout-on-load","true"),wt.preventDefault(),wt.returnValue="Are you sure you want to leave? You will be logged out.",wt.returnValue},ct=wt=>{console.log(" Page hide event - cleaning up session");try{r.presence.leaveClient(c)}catch(jt){console.error("Error leaving presence on pagehide:",jt)}sessionStorage.setItem("student-logout-on-load","true")};return window.addEventListener("beforeunload",ht),window.addEventListener("pagehide",ct),()=>{window.removeEventListener("beforeunload",ht),window.removeEventListener("pagehide",ct)}},[r,c]),lt.useEffect(()=>{if(!m||!C||!D||O!=="active")return;const ct=setInterval(async()=>{try{const{data:wt,error:jt}=await Li.from("annotations").select("id").eq("question_id",D).eq("participant_id",C).maybeSingle(),Ot={session_id:m,question_id:D,participant_id:C,student_lines:Y.current};if(jt){console.error("Failed to query annotation:",jt);return}if(wt){const{error:Gt}=await Li.from("annotations").update(Ot).eq("id",wt.id);Gt?console.error("Failed to update annotation:",Gt):console.log(" Auto-saved student work")}else{const{error:Gt}=await Li.from("annotations").insert([Ot]);Gt?console.error("Failed to create annotation:",Gt):console.log(" Created new annotation")}}catch(wt){console.error("Auto-save error:",wt)}},1e4);return()=>clearInterval(ct)},[m,C,D,O]),lt.useEffect(()=>{if(!m||!C||!D||O!=="active")return;(async()=>{try{const{data:ct}=await Li.from("annotations").select("id").eq("question_id",D).eq("participant_id",C).maybeSingle(),wt={session_id:m,question_id:D,participant_id:C,student_lines:z};ct?await Li.from("annotations").update(wt).eq("id",ct.id):await Li.from("annotations").insert([wt]),console.log(" Saved work for new question")}catch(ct){console.error("Error saving on question change:",ct)}})()},[D]);const kt=ht=>V!=="stylus-only"?!0:(ht==null?void 0:ht.pointerType)==="pen",ye=ht=>{const ct=ht.evt;if(!kt(ct)){ct!=null&&ct.preventDefault&&ct.preventDefault();return}const wt=ht.target.getStage();if(wt&&ct.pointerId!==void 0){const jt=wt.content;if(jt&&jt.setPointerCapture)try{jt.setPointerCapture(ct.pointerId)}catch{}}if(T==="pen"){X(!0);const jt=wt.getPointerPosition(),Ot=jt.x/le,Gt=jt.y/le,Bt={tool:T,points:[Ot,Gt],color:B,strokeWidth:H/le};et.current=Bt,Z.current.push([...z]),rt.current=[],M([...z,Bt])}else T==="eraser"&&(X(!0),tt.current=!1);ct.preventDefault&&ct.preventDefault(),ct.stopPropagation&&ct.stopPropagation()},_e=ht=>{if(!K)return;const ct=ht.evt;if(!kt(ct)){ct!=null&&ct.preventDefault&&ct.preventDefault();return}const jt=ht.target.getStage().getPointerPosition();if(T==="pen"){if(et.current){const Ot=jt.x/le,Gt=jt.y/le;et.current.points=et.current.points.concat([Ot,Gt]);const Bt=et.current;gt.current&&cancelAnimationFrame(gt.current),gt.current=requestAnimationFrame(()=>{Bt&&M(be=>be.length>0?[...be.slice(0,-1),Bt]:be)})}}else if(T==="eraser"){const Ot=z.length,Gt=jt.x,Bt=jt.y,be=20,we=z.filter(te=>{for(let Pe=0;Pe<te.points.length;Pe+=2){const sn=te.points[Pe]*le,Nn=te.points[Pe+1]*le;if(Math.sqrt(Math.pow(sn-Gt,2)+Math.pow(Nn-Bt,2))<be)return!1}return!0});we.length<Ot&&!tt.current&&(Z.current.push([...z]),rt.current=[],tt.current=!0),M(we)}ct!=null&&ct.preventDefault&&ct.preventDefault(),ct!=null&&ct.stopPropagation&&ct.stopPropagation()},Xe=ht=>{const ct=ht==null?void 0:ht.evt;if(!kt(ct)){ct!=null&&ct.preventDefault&&ct.preventDefault();return}X(!1),et.current=null},xt=()=>{if(Z.current.length>0){const ht=Z.current.pop();rt.current.push([...z]),M(ht)}},Xt=()=>{if(rt.current.length>0){const ht=rt.current.pop();Z.current.push([...z]),M(ht)}},Ue=async()=>{Z.current.push([...z]),rt.current=[],M([]),r&&(await r.publish("student-layer",{lines:[],clientId:c,meta:{base:cl,display:Qt,scale:le}}),console.log("Published student clear"))},ae=()=>{var ht;return((ht=c.split("-")[1])==null?void 0:ht.substring(0,3))||c},ge=()=>{U(ht=>ht==="stylus-only"?"all":"stylus-only")},Fe=()=>{F(ht=>ht==="left"?"right":"left")},Me=()=>`Connected as ${i&&i!=="Anonymous"?i:ae()}`,He=d?"Connected":"Reconnecting",en=d?"online":"offline",dn=ht=>ht.map((ct,wt)=>ct*le),ft=ht=>(ht.strokeWidth||3)*le;return!n||!i?null:k.jsxs("div",{className:"student-canvas-page",children:[O==="loading"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-spinner"}),k.jsx("h2",{children:"Connecting to session..."}),k.jsx("p",{children:"Please wait while we verify your session"})]})}),O==="waiting"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:""}),k.jsx("h2",{children:"Waiting for teacher"}),k.jsx("p",{children:"Your teacher hasn't started the session yet. Please wait..."})]})}),O==="ended"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon ended",children:""}),k.jsx("h2",{children:"Session ended"}),k.jsx("p",{children:"Thank you for participating! The teacher has ended this session."}),k.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",opacity:.8},children:"Redirecting to login..."})]})}),k.jsxs("div",{className:"student-canvas-container",children:[k.jsxs("div",{className:"student-status-bar",children:[k.jsxs("div",{className:"student-status-text",children:[k.jsx("h1",{children:"Student Canvas"}),k.jsx("p",{children:Me()})]}),k.jsxs("div",{className:"student-status-actions",children:[!W&&k.jsxs(k.Fragment,{children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:T==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",V==="all"?"All inputs":"Stylus only"]})}),k.jsxs("div",{className:`connection-pill ${en}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:He})]}),k.jsxs("button",{className:"move-toolbar-btn",onClick:Fe,children:["Move toolbar to ",I==="left"?"right":"left"]})]}),W&&k.jsxs("div",{className:`connection-pill ${en}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:He})]})]})]}),k.jsxs("div",{className:`student-workspace ${I==="right"?"toolbar-right":""} ${W?"mobile-view":""}`,children:[W?k.jsxs("div",{className:"mobile-toolbar",children:[k.jsxs("div",{className:"mobile-colors",children:[k.jsx("button",{onClick:()=>j("black"),className:`mobile-color-button ${B==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>j("#0066FF"),className:`mobile-color-button ${B==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>j("#00AA00"),className:`mobile-color-button ${B==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>y("pen"),className:`mobile-tool-button ${T==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(kC,{size:20})}),k.jsx("button",{onClick:()=>y("eraser"),className:`mobile-tool-button ${T==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(PC,{size:20})}),k.jsx("button",{onClick:xt,className:"mobile-tool-button",disabled:Z.current.length===0,"aria-label":"Undo",children:k.jsx(XC,{size:20})}),k.jsx("button",{onClick:Xt,className:"mobile-tool-button",disabled:rt.current.length===0,"aria-label":"Redo",children:k.jsx(VC,{size:20})}),k.jsx("button",{onClick:Ue,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(KC,{size:20})})]})]}):k.jsxs("div",{className:"student-sidebar",children:[k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsxs("div",{className:"color-buttons",children:[k.jsx("button",{onClick:()=>j("black"),className:`color-button ${B==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>j("#0066FF"),className:`color-button ${B==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>j("#00AA00"),className:`color-button ${B==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>y("pen"),className:`tool-icon-button ${T==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>y("eraser"),className:`tool-icon-button ${T==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsx("div",{className:"brush-size-control",children:k.jsxs("div",{className:"brush-slider-container",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:H,onChange:ht=>Q(parseInt(ht.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:H})]})})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${V==="all"?"all-inputs":""}`,onClick:ge,children:V==="stylus-only"?"Stylus mode (pen only)":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:xt,className:"history-button",disabled:Z.current.length===0,children:"Undo"}),k.jsx("button",{onClick:Xt,className:"history-button",disabled:rt.current.length===0,children:"Redo"}),k.jsx("button",{onClick:Ue,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"student-canvas-panel",ref:At,children:k.jsx("div",{className:"student-canvas-frame",children:k.jsx("div",{className:"student-canvas-surface",style:{width:`${Qt.width}px`,height:`${Qt.height}px`},children:k.jsxs(Mg,{ref:Dt,width:Qt.width,height:Qt.height,onPointerDown:ye,onPointerMove:_e,onPointerUp:Xe,onPointerLeave:Xe,onTouchStart:ht=>{var ct,wt;(wt=(ct=ht.evt)==null?void 0:ct.preventDefault)==null||wt.call(ct)},onTouchMove:ht=>{var ct,wt;(wt=(ct=ht.evt)==null?void 0:ct.preventDefault)==null||wt.call(ct)},onTouchEnd:ht=>{var ct,wt;(wt=(ct=ht.evt)==null?void 0:ct.preventDefault)==null||wt.call(ct)},className:"canvas-stage",style:{touchAction:"none"},perfectDrawEnabled:!1,children:[k.jsx(Gr,{listening:!1,children:k.jsx(ZC,{sharedImage:R,canvasWidth:Qt.width,canvasHeight:Qt.height})}),k.jsx(Gr,{children:z.map((ht,ct)=>k.jsx(uo,{points:dn(ht.points),stroke:ht.color,strokeWidth:ft(ht),tension:.5,lineCap:"round",lineJoin:"round"},`student-${ct}`))}),k.jsx(Gr,{listening:!1,children:N.map((ht,ct)=>k.jsx(uo,{points:dn(ht.points),stroke:ht.color,strokeWidth:ft(ht),tension:.5,lineCap:"round",lineJoin:"round"},`teacher-${ct}`))})]})})})})]})]})]})}const H1="Feather_username";function $C(){const[o]=gd(),t=pf(),[n,i]=lt.useState(""),[r,l]=lt.useState((o.get("room")||"").toUpperCase()),[c,d]=lt.useState(""),[g,m]=lt.useState(!1);lt.useEffect(()=>{const C=localStorage.getItem(H1);C&&i(C)},[]);const _=async C=>{if(C.preventDefault(),!n.trim()){d("Please enter your name");return}if(!r.trim()){d("Please enter a session code");return}m(!0),d("");try{const{data:E,error:O}=await Li.from("sessions").select("id, status, room_code").eq("room_code",r.trim().toUpperCase()).single();if(O||!E){d("Session does not exist. Please check your session code."),m(!1);return}if(E.status==="ended"){d("This session has ended. Please contact your teacher."),m(!1);return}localStorage.setItem(H1,n.trim()),t(`/student?room=${r.trim().toUpperCase()}&name=${encodeURIComponent(n.trim())}`)}catch(E){console.error("Error checking session:",E),d("Failed to verify session. Please try again."),m(!1)}};return k.jsx("div",{className:"student-login-page",children:k.jsxs("div",{className:"student-login-card",children:[k.jsx("h1",{children:"Student Login"}),k.jsx("p",{className:"login-subtitle",children:"Join your classroom session to start drawing."}),k.jsxs("form",{onSubmit:_,children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"name",children:"Name"}),k.jsx("input",{id:"name",type:"text",placeholder:"Your name",value:n,onChange:C=>{i(C.target.value),d("")},autoFocus:!0,maxLength:50})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"sessionCode",children:"Session code"}),k.jsx("input",{id:"sessionCode",type:"text",placeholder:"SESSION CODE (E.G., ABC123)",value:r,onChange:C=>{l(C.target.value.toUpperCase()),d("")},maxLength:10})]}),c&&k.jsx("div",{className:"login-error",children:c}),k.jsx("button",{type:"submit",className:"join-button",disabled:g,children:g?"Checking session...":"Join Session"})]})]})})}var Zp,P1;function tT(){if(P1)return Zp;P1=1;function o(l){return typeof l=="string"&&(l=l.indexOf(":")==-1?{token:l}:{key:l}),l.promises=!0,l}var t=gS(),n=function(l,c,d,g){return new t.ErrorInfo(l,c,d,g)},i=function(l){return new t.Rest(o(l))};Object.assign(i,t.Rest);var r=function(l){return new t.Realtime(o(l))};return Object.assign(r,t.Realtime),Zp={ErrorInfo:n,Rest:i,Realtime:r},Zp}var eT=tT();const ub=hf(eT);var tf={},Wp,I1;function nT(){return I1||(I1=1,Wp=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Wp}var $p={},no={},k1;function _u(){if(k1)return no;k1=1;let o;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return no.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},no.getSymbolTotalCodewords=function(i){return t[i]},no.getBCHDigit=function(n){let i=0;for(;n!==0;)i++,n>>>=1;return i},no.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');o=i},no.isKanjiModeEnabled=function(){return typeof o<"u"},no.toSJIS=function(i){return o(i)},no}var tm={},q1;function gv(){return q1||(q1=1,(function(o){o.L={bit:1},o.M={bit:0},o.Q={bit:3},o.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return o.L;case"m":case"medium":return o.M;case"q":case"quartile":return o.Q;case"h":case"high":return o.H;default:throw new Error("Unknown EC Level: "+n)}}o.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},o.from=function(i,r){if(o.isValid(i))return i;try{return t(i)}catch{return r}}})(tm)),tm}var em,V1;function iT(){if(V1)return em;V1=1;function o(){this.buffer=[],this.length=0}return o.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let i=0;i<n;i++)this.putBit((t>>>n-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},em=o,em}var nm,Y1;function aT(){if(Y1)return nm;Y1=1;function o(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return o.prototype.set=function(t,n,i,r){const l=t*this.size+n;this.data[l]=i,r&&(this.reservedBit[l]=!0)},o.prototype.get=function(t,n){return this.data[t*this.size+n]},o.prototype.xor=function(t,n,i){this.data[t*this.size+n]^=i},o.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},nm=o,nm}var im={},K1;function rT(){return K1||(K1=1,(function(o){const t=_u().getSymbolSize;o.getRowColCoords=function(i){if(i===1)return[];const r=Math.floor(i/7)+2,l=t(i),c=l===145?26:Math.ceil((l-13)/(2*r-2))*2,d=[l-7];for(let g=1;g<r-1;g++)d[g]=d[g-1]-c;return d.push(6),d.reverse()},o.getPositions=function(i){const r=[],l=o.getRowColCoords(i),c=l.length;for(let d=0;d<c;d++)for(let g=0;g<c;g++)d===0&&g===0||d===0&&g===c-1||d===c-1&&g===0||r.push([l[d],l[g]]);return r}})(im)),im}var am={},Q1;function sT(){if(Q1)return am;Q1=1;const o=_u().getSymbolSize,t=7;return am.getPositions=function(i){const r=o(i);return[[0,0],[r-t,0],[0,r-t]]},am}var rm={},X1;function lT(){return X1||(X1=1,(function(o){o.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};o.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},o.from=function(r){return o.isValid(r)?parseInt(r,10):void 0},o.getPenaltyN1=function(r){const l=r.size;let c=0,d=0,g=0,m=null,_=null;for(let C=0;C<l;C++){d=g=0,m=_=null;for(let E=0;E<l;E++){let O=r.get(C,E);O===m?d++:(d>=5&&(c+=t.N1+(d-5)),m=O,d=1),O=r.get(E,C),O===_?g++:(g>=5&&(c+=t.N1+(g-5)),_=O,g=1)}d>=5&&(c+=t.N1+(d-5)),g>=5&&(c+=t.N1+(g-5))}return c},o.getPenaltyN2=function(r){const l=r.size;let c=0;for(let d=0;d<l-1;d++)for(let g=0;g<l-1;g++){const m=r.get(d,g)+r.get(d,g+1)+r.get(d+1,g)+r.get(d+1,g+1);(m===4||m===0)&&c++}return c*t.N2},o.getPenaltyN3=function(r){const l=r.size;let c=0,d=0,g=0;for(let m=0;m<l;m++){d=g=0;for(let _=0;_<l;_++)d=d<<1&2047|r.get(m,_),_>=10&&(d===1488||d===93)&&c++,g=g<<1&2047|r.get(_,m),_>=10&&(g===1488||g===93)&&c++}return c*t.N3},o.getPenaltyN4=function(r){let l=0;const c=r.data.length;for(let g=0;g<c;g++)l+=r.data[g];return Math.abs(Math.ceil(l*100/c/5)-10)*t.N4};function n(i,r,l){switch(i){case o.Patterns.PATTERN000:return(r+l)%2===0;case o.Patterns.PATTERN001:return r%2===0;case o.Patterns.PATTERN010:return l%3===0;case o.Patterns.PATTERN011:return(r+l)%3===0;case o.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(l/3))%2===0;case o.Patterns.PATTERN101:return r*l%2+r*l%3===0;case o.Patterns.PATTERN110:return(r*l%2+r*l%3)%2===0;case o.Patterns.PATTERN111:return(r*l%3+(r+l)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}o.applyMask=function(r,l){const c=l.size;for(let d=0;d<c;d++)for(let g=0;g<c;g++)l.isReserved(g,d)||l.xor(g,d,n(r,g,d))},o.getBestMask=function(r,l){const c=Object.keys(o.Patterns).length;let d=0,g=1/0;for(let m=0;m<c;m++){l(m),o.applyMask(m,r);const _=o.getPenaltyN1(r)+o.getPenaltyN2(r)+o.getPenaltyN3(r)+o.getPenaltyN4(r);o.applyMask(m,r),_<g&&(g=_,d=m)}return d}})(rm)),rm}var fg={},F1;function cb(){if(F1)return fg;F1=1;const o=gv(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return fg.getBlocksCount=function(r,l){switch(l){case o.L:return t[(r-1)*4+0];case o.M:return t[(r-1)*4+1];case o.Q:return t[(r-1)*4+2];case o.H:return t[(r-1)*4+3];default:return}},fg.getTotalCodewordsCount=function(r,l){switch(l){case o.L:return n[(r-1)*4+0];case o.M:return n[(r-1)*4+1];case o.Q:return n[(r-1)*4+2];case o.H:return n[(r-1)*4+3];default:return}},fg}var sm={},Xh={},J1;function oT(){if(J1)return Xh;J1=1;const o=new Uint8Array(512),t=new Uint8Array(256);return(function(){let i=1;for(let r=0;r<255;r++)o[r]=i,t[i]=r,i<<=1,i&256&&(i^=285);for(let r=255;r<512;r++)o[r]=o[r-255]})(),Xh.log=function(i){if(i<1)throw new Error("log("+i+")");return t[i]},Xh.exp=function(i){return o[i]},Xh.mul=function(i,r){return i===0||r===0?0:o[t[i]+t[r]]},Xh}var Z1;function uT(){return Z1||(Z1=1,(function(o){const t=oT();o.mul=function(i,r){const l=new Uint8Array(i.length+r.length-1);for(let c=0;c<i.length;c++)for(let d=0;d<r.length;d++)l[c+d]^=t.mul(i[c],r[d]);return l},o.mod=function(i,r){let l=new Uint8Array(i);for(;l.length-r.length>=0;){const c=l[0];for(let g=0;g<r.length;g++)l[g]^=t.mul(r[g],c);let d=0;for(;d<l.length&&l[d]===0;)d++;l=l.slice(d)}return l},o.generateECPolynomial=function(i){let r=new Uint8Array([1]);for(let l=0;l<i;l++)r=o.mul(r,new Uint8Array([1,t.exp(l)]));return r}})(sm)),sm}var lm,W1;function cT(){if(W1)return lm;W1=1;const o=uT();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(i){this.degree=i,this.genPoly=o.generateECPolynomial(this.degree)},t.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(i.length+this.degree);r.set(i);const l=o.mod(r,this.genPoly),c=this.degree-l.length;if(c>0){const d=new Uint8Array(this.degree);return d.set(l,c),d}return l},lm=t,lm}var om={},um={},cm={},$1;function fb(){return $1||($1=1,cm.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),cm}var ms={},t2;function hb(){if(t2)return ms;t2=1;const o="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;ms.KANJI=new RegExp(n,"g"),ms.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),ms.BYTE=new RegExp(i,"g"),ms.NUMERIC=new RegExp(o,"g"),ms.ALPHANUMERIC=new RegExp(t,"g");const r=new RegExp("^"+n+"$"),l=new RegExp("^"+o+"$"),c=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return ms.testKanji=function(g){return r.test(g)},ms.testNumeric=function(g){return l.test(g)},ms.testAlphanumeric=function(g){return c.test(g)},ms}var e2;function Eu(){return e2||(e2=1,(function(o){const t=fb(),n=hb();o.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},o.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},o.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},o.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},o.MIXED={bit:-1},o.getCharCountIndicator=function(l,c){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!t.isValid(c))throw new Error("Invalid version: "+c);return c>=1&&c<10?l.ccBits[0]:c<27?l.ccBits[1]:l.ccBits[2]},o.getBestModeForData=function(l){return n.testNumeric(l)?o.NUMERIC:n.testAlphanumeric(l)?o.ALPHANUMERIC:n.testKanji(l)?o.KANJI:o.BYTE},o.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},o.isValid=function(l){return l&&l.bit&&l.ccBits};function i(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return o.NUMERIC;case"alphanumeric":return o.ALPHANUMERIC;case"kanji":return o.KANJI;case"byte":return o.BYTE;default:throw new Error("Unknown mode: "+r)}}o.from=function(l,c){if(o.isValid(l))return l;try{return i(l)}catch{return c}}})(um)),um}var n2;function fT(){return n2||(n2=1,(function(o){const t=_u(),n=cb(),i=gv(),r=Eu(),l=fb(),c=7973,d=t.getBCHDigit(c);function g(E,O,v){for(let D=1;D<=40;D++)if(O<=o.getCapacity(D,v,E))return D}function m(E,O){return r.getCharCountIndicator(E,O)+4}function _(E,O){let v=0;return E.forEach(function(D){const L=m(D.mode,O);v+=L+D.getBitsLength()}),v}function C(E,O){for(let v=1;v<=40;v++)if(_(E,v)<=o.getCapacity(v,O,r.MIXED))return v}o.from=function(O,v){return l.isValid(O)?parseInt(O,10):v},o.getCapacity=function(O,v,D){if(!l.isValid(O))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=r.BYTE);const L=t.getSymbolTotalCodewords(O),z=n.getTotalCodewordsCount(O,v),M=(L-z)*8;if(D===r.MIXED)return M;const N=M-m(D,O);switch(D){case r.NUMERIC:return Math.floor(N/10*3);case r.ALPHANUMERIC:return Math.floor(N/11*2);case r.KANJI:return Math.floor(N/13);case r.BYTE:default:return Math.floor(N/8)}},o.getBestVersionForData=function(O,v){let D;const L=i.from(v,i.M);if(Array.isArray(O)){if(O.length>1)return C(O,L);if(O.length===0)return 1;D=O[0]}else D=O;return g(D.mode,D.getLength(),L)},o.getEncodedBits=function(O){if(!l.isValid(O)||O<7)throw new Error("Invalid QR Code version");let v=O<<12;for(;t.getBCHDigit(v)-d>=0;)v^=c<<t.getBCHDigit(v)-d;return O<<12|v}})(om)),om}var fm={},i2;function hT(){if(i2)return fm;i2=1;const o=_u(),t=1335,n=21522,i=o.getBCHDigit(t);return fm.getEncodedBits=function(l,c){const d=l.bit<<3|c;let g=d<<10;for(;o.getBCHDigit(g)-i>=0;)g^=t<<o.getBCHDigit(g)-i;return(d<<10|g)^n},fm}var hm={},dm,a2;function dT(){if(a2)return dm;a2=1;const o=Eu();function t(n){this.mode=o.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(i){let r,l,c;for(r=0;r+3<=this.data.length;r+=3)l=this.data.substr(r,3),c=parseInt(l,10),i.put(c,10);const d=this.data.length-r;d>0&&(l=this.data.substr(r),c=parseInt(l,10),i.put(c,d*3+1))},dm=t,dm}var gm,r2;function gT(){if(r2)return gm;r2=1;const o=Eu(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(i){this.mode=o.ALPHANUMERIC,this.data=i}return n.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let l;for(l=0;l+2<=this.data.length;l+=2){let c=t.indexOf(this.data[l])*45;c+=t.indexOf(this.data[l+1]),r.put(c,11)}this.data.length%2&&r.put(t.indexOf(this.data[l]),6)},gm=n,gm}var pm,s2;function pT(){if(s2)return pm;s2=1;const o=Eu();function t(n){this.mode=o.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(i){return i*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let i=0,r=this.data.length;i<r;i++)n.put(this.data[i],8)},pm=t,pm}var mm,l2;function mT(){if(l2)return mm;l2=1;const o=Eu(),t=_u();function n(i){this.mode=o.KANJI,this.data=i}return n.getBitsLength=function(r){return r*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(i){let r;for(r=0;r<this.data.length;r++){let l=t.toSJIS(this.data[r]);if(l>=33088&&l<=40956)l-=33088;else if(l>=57408&&l<=60351)l-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);l=(l>>>8&255)*192+(l&255),i.put(l,13)}},mm=n,mm}var vm={exports:{}},o2;function vT(){return o2||(o2=1,(function(o){var t={single_source_shortest_paths:function(n,i,r){var l={},c={};c[i]=0;var d=t.PriorityQueue.make();d.push(i,0);for(var g,m,_,C,E,O,v,D,L;!d.empty();){g=d.pop(),m=g.value,C=g.cost,E=n[m]||{};for(_ in E)E.hasOwnProperty(_)&&(O=E[_],v=C+O,D=c[_],L=typeof c[_]>"u",(L||D>v)&&(c[_]=v,d.push(_,v),l[_]=m))}if(typeof r<"u"&&typeof c[r]>"u"){var z=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(z)}return l},extract_shortest_path_from_predecessor_list:function(n,i){for(var r=[],l=i;l;)r.push(l),n[l],l=n[l];return r.reverse(),r},find_path:function(n,i,r){var l=t.single_source_shortest_paths(n,i,r);return t.extract_shortest_path_from_predecessor_list(l,r)},PriorityQueue:{make:function(n){var i=t.PriorityQueue,r={},l;n=n||{};for(l in i)i.hasOwnProperty(l)&&(r[l]=i[l]);return r.queue=[],r.sorter=n.sorter||i.default_sorter,r},default_sorter:function(n,i){return n.cost-i.cost},push:function(n,i){var r={value:n,cost:i};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};o.exports=t})(vm)),vm.exports}var u2;function yT(){return u2||(u2=1,(function(o){const t=Eu(),n=dT(),i=gT(),r=pT(),l=mT(),c=hb(),d=_u(),g=vT();function m(z){return unescape(encodeURIComponent(z)).length}function _(z,M,N){const G=[];let R;for(;(R=z.exec(N))!==null;)G.push({data:R[0],index:R.index,mode:M,length:R[0].length});return G}function C(z){const M=_(c.NUMERIC,t.NUMERIC,z),N=_(c.ALPHANUMERIC,t.ALPHANUMERIC,z);let G,R;return d.isKanjiModeEnabled()?(G=_(c.BYTE,t.BYTE,z),R=_(c.KANJI,t.KANJI,z)):(G=_(c.BYTE_KANJI,t.BYTE,z),R=[]),M.concat(N,G,R).sort(function(T,y){return T.index-y.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function E(z,M){switch(M){case t.NUMERIC:return n.getBitsLength(z);case t.ALPHANUMERIC:return i.getBitsLength(z);case t.KANJI:return l.getBitsLength(z);case t.BYTE:return r.getBitsLength(z)}}function O(z){return z.reduce(function(M,N){const G=M.length-1>=0?M[M.length-1]:null;return G&&G.mode===N.mode?(M[M.length-1].data+=N.data,M):(M.push(N),M)},[])}function v(z){const M=[];for(let N=0;N<z.length;N++){const G=z[N];switch(G.mode){case t.NUMERIC:M.push([G,{data:G.data,mode:t.ALPHANUMERIC,length:G.length},{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.ALPHANUMERIC:M.push([G,{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.KANJI:M.push([G,{data:G.data,mode:t.BYTE,length:m(G.data)}]);break;case t.BYTE:M.push([{data:G.data,mode:t.BYTE,length:m(G.data)}])}}return M}function D(z,M){const N={},G={start:{}};let R=["start"];for(let A=0;A<z.length;A++){const T=z[A],y=[];for(let B=0;B<T.length;B++){const j=T[B],H=""+A+B;y.push(H),N[H]={node:j,lastCount:0},G[H]={};for(let Q=0;Q<R.length;Q++){const K=R[Q];N[K]&&N[K].node.mode===j.mode?(G[K][H]=E(N[K].lastCount+j.length,j.mode)-E(N[K].lastCount,j.mode),N[K].lastCount+=j.length):(N[K]&&(N[K].lastCount=j.length),G[K][H]=E(j.length,j.mode)+4+t.getCharCountIndicator(j.mode,M))}}R=y}for(let A=0;A<R.length;A++)G[R[A]].end=0;return{map:G,table:N}}function L(z,M){let N;const G=t.getBestModeForData(z);if(N=t.from(M,G),N!==t.BYTE&&N.bit<G.bit)throw new Error('"'+z+'" cannot be encoded with mode '+t.toString(N)+`.
 Suggested mode is: `+t.toString(G));switch(N===t.KANJI&&!d.isKanjiModeEnabled()&&(N=t.BYTE),N){case t.NUMERIC:return new n(z);case t.ALPHANUMERIC:return new i(z);case t.KANJI:return new l(z);case t.BYTE:return new r(z)}}o.fromArray=function(M){return M.reduce(function(N,G){return typeof G=="string"?N.push(L(G,null)):G.data&&N.push(L(G.data,G.mode)),N},[])},o.fromString=function(M,N){const G=C(M,d.isKanjiModeEnabled()),R=v(G),A=D(R,N),T=g.find_path(A.map,"start","end"),y=[];for(let B=1;B<T.length-1;B++)y.push(A.table[T[B]].node);return o.fromArray(O(y))},o.rawSplit=function(M){return o.fromArray(C(M,d.isKanjiModeEnabled()))}})(hm)),hm}var c2;function ST(){if(c2)return $p;c2=1;const o=_u(),t=gv(),n=iT(),i=aT(),r=rT(),l=sT(),c=lT(),d=cb(),g=cT(),m=fT(),_=hT(),C=Eu(),E=yT();function O(A,T){const y=A.size,B=l.getPositions(T);for(let j=0;j<B.length;j++){const H=B[j][0],Q=B[j][1];for(let K=-1;K<=7;K++)if(!(H+K<=-1||y<=H+K))for(let X=-1;X<=7;X++)Q+X<=-1||y<=Q+X||(K>=0&&K<=6&&(X===0||X===6)||X>=0&&X<=6&&(K===0||K===6)||K>=2&&K<=4&&X>=2&&X<=4?A.set(H+K,Q+X,!0,!0):A.set(H+K,Q+X,!1,!0))}}function v(A){const T=A.size;for(let y=8;y<T-8;y++){const B=y%2===0;A.set(y,6,B,!0),A.set(6,y,B,!0)}}function D(A,T){const y=r.getPositions(T);for(let B=0;B<y.length;B++){const j=y[B][0],H=y[B][1];for(let Q=-2;Q<=2;Q++)for(let K=-2;K<=2;K++)Q===-2||Q===2||K===-2||K===2||Q===0&&K===0?A.set(j+Q,H+K,!0,!0):A.set(j+Q,H+K,!1,!0)}}function L(A,T){const y=A.size,B=m.getEncodedBits(T);let j,H,Q;for(let K=0;K<18;K++)j=Math.floor(K/3),H=K%3+y-8-3,Q=(B>>K&1)===1,A.set(j,H,Q,!0),A.set(H,j,Q,!0)}function z(A,T,y){const B=A.size,j=_.getEncodedBits(T,y);let H,Q;for(H=0;H<15;H++)Q=(j>>H&1)===1,H<6?A.set(H,8,Q,!0):H<8?A.set(H+1,8,Q,!0):A.set(B-15+H,8,Q,!0),H<8?A.set(8,B-H-1,Q,!0):H<9?A.set(8,15-H-1+1,Q,!0):A.set(8,15-H-1,Q,!0);A.set(B-8,8,1,!0)}function M(A,T){const y=A.size;let B=-1,j=y-1,H=7,Q=0;for(let K=y-1;K>0;K-=2)for(K===6&&K--;;){for(let X=0;X<2;X++)if(!A.isReserved(j,K-X)){let V=!1;Q<T.length&&(V=(T[Q]>>>H&1)===1),A.set(j,K-X,V),H--,H===-1&&(Q++,H=7)}if(j+=B,j<0||y<=j){j-=B,B=-B;break}}}function N(A,T,y){const B=new n;y.forEach(function(X){B.put(X.mode.bit,4),B.put(X.getLength(),C.getCharCountIndicator(X.mode,A)),X.write(B)});const j=o.getSymbolTotalCodewords(A),H=d.getTotalCodewordsCount(A,T),Q=(j-H)*8;for(B.getLengthInBits()+4<=Q&&B.put(0,4);B.getLengthInBits()%8!==0;)B.putBit(0);const K=(Q-B.getLengthInBits())/8;for(let X=0;X<K;X++)B.put(X%2?17:236,8);return G(B,A,T)}function G(A,T,y){const B=o.getSymbolTotalCodewords(T),j=d.getTotalCodewordsCount(T,y),H=B-j,Q=d.getBlocksCount(T,y),K=B%Q,X=Q-K,V=Math.floor(B/Q),U=Math.floor(H/Q),I=U+1,F=V-U,W=new g(F);let at=0;const Z=new Array(Q),rt=new Array(Q);let it=0;const Y=new Uint8Array(A.buffer);for(let At=0;At<Q;At++){const Dt=At<X?U:I;Z[At]=Y.slice(at,at+Dt),rt[At]=W.encode(Z[At]),at+=Dt,it=Math.max(it,Dt)}const J=new Uint8Array(B);let tt=0,et,gt;for(et=0;et<it;et++)for(gt=0;gt<Q;gt++)et<Z[gt].length&&(J[tt++]=Z[gt][et]);for(et=0;et<F;et++)for(gt=0;gt<Q;gt++)J[tt++]=rt[gt][et];return J}function R(A,T,y,B){let j;if(Array.isArray(A))j=E.fromArray(A);else if(typeof A=="string"){let V=T;if(!V){const U=E.rawSplit(A);V=m.getBestVersionForData(U,y)}j=E.fromString(A,V||40)}else throw new Error("Invalid data");const H=m.getBestVersionForData(j,y);if(!H)throw new Error("The amount of data is too big to be stored in a QR Code");if(!T)T=H;else if(T<H)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+H+`.
`);const Q=N(T,y,j),K=o.getSymbolSize(T),X=new i(K);return O(X,T),v(X),D(X,T),z(X,y,0),T>=7&&L(X,T),M(X,Q),isNaN(B)&&(B=c.getBestMask(X,z.bind(null,X,y))),c.applyMask(B,X),z(X,y,B),{modules:X,version:T,errorCorrectionLevel:y,maskPattern:B,segments:j}}return $p.create=function(T,y){if(typeof T>"u"||T==="")throw new Error("No input text");let B=t.M,j,H;return typeof y<"u"&&(B=t.from(y.errorCorrectionLevel,t.M),j=m.from(y.version),H=c.from(y.maskPattern),y.toSJISFunc&&o.setToSJISFunction(y.toSJISFunc)),R(T,j,B,H)},$p}var ym={},Sm={},f2;function db(){return f2||(f2=1,(function(o){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let i=n.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+n);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(l){return[l,l]}))),i.length===6&&i.push("F","F");const r=parseInt(i.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+i.slice(0,6).join("")}}o.getOptions=function(i){i||(i={}),i.color||(i.color={});const r=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,l=i.width&&i.width>=21?i.width:void 0,c=i.scale||4;return{width:l,scale:l?4:c,margin:r,color:{dark:t(i.color.dark||"#000000ff"),light:t(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},o.getScale=function(i,r){return r.width&&r.width>=i+r.margin*2?r.width/(i+r.margin*2):r.scale},o.getImageWidth=function(i,r){const l=o.getScale(i,r);return Math.floor((i+r.margin*2)*l)},o.qrToImageData=function(i,r,l){const c=r.modules.size,d=r.modules.data,g=o.getScale(c,l),m=Math.floor((c+l.margin*2)*g),_=l.margin*g,C=[l.color.light,l.color.dark];for(let E=0;E<m;E++)for(let O=0;O<m;O++){let v=(E*m+O)*4,D=l.color.light;if(E>=_&&O>=_&&E<m-_&&O<m-_){const L=Math.floor((E-_)/g),z=Math.floor((O-_)/g);D=C[d[L*c+z]?1:0]}i[v++]=D.r,i[v++]=D.g,i[v++]=D.b,i[v]=D.a}}})(Sm)),Sm}var h2;function bT(){return h2||(h2=1,(function(o){const t=db();function n(r,l,c){r.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=c,l.width=c,l.style.height=c+"px",l.style.width=c+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}o.render=function(l,c,d){let g=d,m=c;typeof g>"u"&&(!c||!c.getContext)&&(g=c,c=void 0),c||(m=i()),g=t.getOptions(g);const _=t.getImageWidth(l.modules.size,g),C=m.getContext("2d"),E=C.createImageData(_,_);return t.qrToImageData(E.data,l,g),n(C,m,_),C.putImageData(E,0,0),m},o.renderToDataURL=function(l,c,d){let g=d;typeof g>"u"&&(!c||!c.getContext)&&(g=c,c=void 0),g||(g={});const m=o.render(l,c,g),_=g.type||"image/png",C=g.rendererOpts||{};return m.toDataURL(_,C.quality)}})(ym)),ym}var bm={},d2;function _T(){if(d2)return bm;d2=1;const o=db();function t(r,l){const c=r.a/255,d=l+'="'+r.hex+'"';return c<1?d+" "+l+'-opacity="'+c.toFixed(2).slice(1)+'"':d}function n(r,l,c){let d=r+l;return typeof c<"u"&&(d+=" "+c),d}function i(r,l,c){let d="",g=0,m=!1,_=0;for(let C=0;C<r.length;C++){const E=Math.floor(C%l),O=Math.floor(C/l);!E&&!m&&(m=!0),r[C]?(_++,C>0&&E>0&&r[C-1]||(d+=m?n("M",E+c,.5+O+c):n("m",g,0),g=0,m=!1),E+1<l&&r[C+1]||(d+=n("h",_),_=0)):g++}return d}return bm.render=function(l,c,d){const g=o.getOptions(c),m=l.modules.size,_=l.modules.data,C=m+g.margin*2,E=g.color.light.a?"<path "+t(g.color.light,"fill")+' d="M0 0h'+C+"v"+C+'H0z"/>':"",O="<path "+t(g.color.dark,"stroke")+' d="'+i(_,m,g.margin)+'"/>',v='viewBox="0 0 '+C+" "+C+'"',L='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+v+' shape-rendering="crispEdges">'+E+O+`</svg>
`;return typeof d=="function"&&d(null,L),L},bm}var g2;function ET(){if(g2)return tf;g2=1;const o=nT(),t=ST(),n=bT(),i=_T();function r(l,c,d,g,m){const _=[].slice.call(arguments,1),C=_.length,E=typeof _[C-1]=="function";if(!E&&!o())throw new Error("Callback required as last argument");if(E){if(C<2)throw new Error("Too few arguments provided");C===2?(m=d,d=c,c=g=void 0):C===3&&(c.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=d,d=c,c=void 0))}else{if(C<1)throw new Error("Too few arguments provided");return C===1?(d=c,c=g=void 0):C===2&&!c.getContext&&(g=d,d=c,c=void 0),new Promise(function(O,v){try{const D=t.create(d,g);O(l(D,c,g))}catch(D){v(D)}})}try{const O=t.create(d,g);m(null,l(O,c,g))}catch(O){m(O)}}return tf.create=t.create,tf.toCanvas=r.bind(null,n.render),tf.toDataURL=r.bind(null,n.renderToDataURL),tf.toString=r.bind(null,function(l,c,d){return i.render(l,d)}),tf}var CT=ET();const gb=hf(CT),pb=({active:o=!1,size:t=20})=>{const n=o?"#ff4d4f":"#b8c1cc",i=o?"#ff4d4f":"transparent";return k.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[k.jsx("path",{d:"M5 2.5V17.5",stroke:n,strokeWidth:"1.6",strokeLinecap:"round"}),k.jsx("path",{d:"M5 3h10l-2 3 2 3H5V3Z",fill:i,stroke:n,strokeWidth:"1.4",strokeLinejoin:"round"})]})},mb=({student:o,onClick:t,onToggleFlag:n,teacherAnnotations:i=[],sharedImage:r,hideNames:l=!1})=>{var G,R,A,T;const c=lt.useRef(null),d=lt.useRef(null),[g,m]=lt.useState(null),[_,C]=lt.useState(300);lt.useEffect(()=>{if(!r){m(null);return}const y=new window.Image;y.src=r.dataUrl,y.onload=()=>{m(y)}},[r]),lt.useEffect(()=>{if(!d.current)return;const y=()=>{d.current&&C(d.current.clientWidth)};y();const B=new ResizeObserver(y);return B.observe(d.current),()=>B.disconnect()},[]);const E=()=>{if(o!=null&&o.name)return o.name;if(!(o!=null&&o.clientId))return"Unknown Student";const y=o.clientId.match(/student-(\d+)/);return y?`Student ${y[1]}`:o.clientId},O=()=>{if(!o.lastUpdate)return"Just joined";const y=Math.floor((Date.now()-o.lastUpdate)/1e3);return y<5?"Just now":y<60?`${y}s ago`:`${Math.floor(y/60)}m ago`},v=((R=(G=o.meta)==null?void 0:G.base)==null?void 0:R.width)||800,D=((T=(A=o.meta)==null?void 0:A.base)==null?void 0:T.height)||600,L=_/v,z=y=>{y.stopPropagation(),n&&n(o.clientId)},N=(()=>{if(!r||!g)return null;const y=r.width/r.height,B=v/D;let j,H,Q,K;return y>B?(j=v,H=v/y,Q=0,K=(D-H)/2):(H=D,j=D*y,Q=(v-j)/2,K=0),{x:Q,y:K,width:j,height:H}})();return k.jsxs("div",{className:`student-card ${o.isActive?"active":"inactive"}`,onClick:()=>t(o),children:[k.jsxs("div",{className:"student-card-header",children:[k.jsxs("div",{className:"student-name",children:[k.jsx("span",{className:"student-icon",children:""}),l?"":E()]}),k.jsxs("div",{className:"student-header-actions",children:[k.jsx("button",{className:`flag-button ${o.isFlagged?"active":""}`,onClick:z,"aria-label":o.isFlagged?"Remove flag":"Flag student",title:o.isFlagged?"Remove flag":"Flag student",children:k.jsx(pb,{active:o.isFlagged,size:18})}),k.jsxs("div",{className:"student-status",children:[k.jsx("span",{className:`status-dot ${o.isActive?"online":"offline"}`}),o.isVisible===!1&&o.isActive&&k.jsx("span",{className:"visibility-indicator away",title:"Student is distracted (switched away from tab)",children:""})]})]})]}),k.jsxs("div",{className:"student-card-canvas",ref:d,children:[k.jsxs(Mg,{ref:c,width:v,height:D,scaleX:L,scaleY:L,style:{transformOrigin:"top left",width:"100%",height:"100%"},children:[N&&k.jsx(Gr,{listening:!1,children:k.jsx(av,{image:g,x:N.x,y:N.y,width:N.width,height:N.height})}),k.jsx(Gr,{children:o.lines&&o.lines.map((y,B)=>k.jsx(uo,{points:y.points,stroke:y.color||"black",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`preview-${o.clientId}-${B}`))}),k.jsx(Gr,{children:i.map((y,B)=>k.jsx(uo,{points:y.points,stroke:y.color||"#FF0000",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${o.clientId}-${B}`))})]}),(!o.lines||o.lines.length===0)&&k.jsxs("div",{className:"no-drawing",children:[k.jsx("span",{children:""}),k.jsx("p",{children:"No drawing yet"})]}),o.lines&&o.lines.length>0&&k.jsxs("div",{className:"stroke-count",children:[o.lines.length," stroke",o.lines.length!==1?"s":""]})]}),k.jsxs("div",{className:"student-card-footer",children:[k.jsx("span",{className:"last-update",children:O()}),k.jsx("span",{className:"click-hint",children:"Click to annotate "})]})]})},ef={width:800,height:600},hg="teacherAnnotationPrefs",_m=2,p2=[{label:"Red",value:"#FF3B30"},{label:"Purple",value:"#7C3AED"},{label:"Teal",value:"#0EA5E9"}],vb=({student:o,isOpen:t,onClose:n,onAnnotate:i,existingAnnotations:r=[],isFlagged:l=!1,onToggleFlag:c,sharedImage:d})=>{const[g,m]=lt.useState("pen"),[_,C]=lt.useState(p2[0].value),[E,O]=lt.useState(3),[v,D]=lt.useState(!1),[L,z]=lt.useState([]),[M,N]=lt.useState("stylus-only"),[G,R]=lt.useState("left"),[A,T]=lt.useState(null),y=lt.useRef([]),B=lt.useRef([]),j=lt.useRef(!1),H=lt.useRef(null),Q=lt.useRef(!0),K=lt.useRef(null),X=lt.useRef(null);lt.useEffect(()=>{if(!d){T(null);return}const xt=new window.Image;xt.src=d.dataUrl,xt.onload=()=>{T(xt)}},[d]);const V=lt.useRef(null),U=lt.useRef(null),[I,F]=lt.useState({width:960,height:720}),W=lt.useMemo(()=>({x:I.width/ef.width,y:I.height/ef.height}),[I]);lt.useEffect(()=>{if(!(typeof window>"u")){console.log(" [TEACHER ANNOTATION] Loading preferences from localStorage...");try{const xt=localStorage.getItem(hg);if(xt){const Xt=JSON.parse(xt);if(console.log(" [TEACHER ANNOTATION] Found stored preferences:",Xt),Xt.version!==_m){console.log(" [TEACHER ANNOTATION] Version mismatch! Expected:",_m,"Got:",Xt.version),console.log(" [TEACHER ANNOTATION] Clearing old preferences..."),localStorage.removeItem(hg);return}console.log(" [TEACHER ANNOTATION] Applying preferences..."),Xt.tool&&m(Xt.tool),Xt.color&&C(Xt.color),typeof Xt.brushSize=="number"&&O(Xt.brushSize),Xt.inputMode&&N(Xt.inputMode),Xt.toolbarPosition&&R(Xt.toolbarPosition),console.log(" [TEACHER ANNOTATION] Preferences loaded successfully!")}else console.log(" [TEACHER ANNOTATION] No stored preferences found, using defaults")}catch(xt){console.warn(" [TEACHER ANNOTATION] Failed to load teacher annotation prefs",xt),localStorage.removeItem(hg)}}},[]),lt.useEffect(()=>{if(typeof window>"u")return;if(Q.current){Q.current=!1,console.log(" [TEACHER ANNOTATION] Skipping save on first render");return}const xt={version:_m,tool:g,color:_,brushSize:E,inputMode:M,toolbarPosition:G};console.log(" [TEACHER ANNOTATION] Saving preferences to localStorage:",xt),localStorage.setItem(hg,JSON.stringify(xt))},[g,_,E,M,G]),lt.useEffect(()=>{t&&o&&o.clientId!==H.current&&(H.current=o.clientId,z(r),y.current=[],B.current=[])},[t,o,r]),lt.useEffect(()=>{t&&o&&z(r)},[r,t,o]),lt.useEffect(()=>()=>{X.current&&cancelAnimationFrame(X.current)},[]),lt.useEffect(()=>{if(t){const xt=document.body.style.overflow,Xt=document.body.style.position,Ue=document.body.style.touchAction;document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.touchAction="none";const ae=V.current;if(!ae)return;const ge=He=>{const en=He.target;en.closest("button")||en.closest(".annotation-sidebar")||en.closest(".annotation-status-actions")||He.preventDefault()},Fe=He=>{He.preventDefault()},Me=He=>{if(v)return He.preventDefault(),!1};return ae.addEventListener("touchstart",ge,{passive:!1}),ae.addEventListener("touchmove",ge,{passive:!1}),ae.addEventListener("gesturestart",Fe,{passive:!1}),ae.addEventListener("gesturechange",Fe,{passive:!1}),document.addEventListener("selectstart",Me),()=>{document.body.style.overflow=xt,document.body.style.position=Xt,document.body.style.touchAction=Ue,ae&&(ae.removeEventListener("touchstart",ge),ae.removeEventListener("touchmove",ge),ae.removeEventListener("gesturestart",Fe),ae.removeEventListener("gesturechange",Fe)),document.removeEventListener("selectstart",Me)}}},[t,v]),lt.useEffect(()=>{if(!t)return;const xt=()=>{if(!V.current)return;const Xt=V.current.getBoundingClientRect(),ge=24+4,Fe=Math.max(320,Xt.width-ge),Me=Math.max(240,Xt.height-ge),He=Fe/ef.width,en=Me/ef.height,dn=Math.min(He,en);F({width:Math.round(ef.width*dn),height:Math.round(ef.height*dn)})};return xt(),window.addEventListener("resize",xt),()=>window.removeEventListener("resize",xt)},[G,t]);const at=()=>{if(!d||!A)return null;const xt=d.width/d.height,Xt=I.width/I.height;let Ue,ae,ge,Fe;return xt>Xt?(Ue=I.width,ae=I.width/xt,ge=0,Fe=(I.height-ae)/2):(ae=I.height,Ue=I.height*xt,ge=(I.width-Ue)/2,Fe=0),{x:ge,y:Fe,width:Ue,height:ae}};if(!t||!o)return null;const Z=at(),rt=()=>{if(o.name)return o.name;const xt=o.clientId.match(/student-(\d+)/)||o.clientId.match(/load-test-student-(\d+)/);return xt?`Student ${xt[1]}`:o.clientId},it=xt=>M!=="stylus-only"?!0:(xt==null?void 0:xt.pointerType)==="pen",Y=(xt=[])=>xt.map((Xt,Ue)=>Ue%2===0?Xt*W.x:Xt*W.y),J=xt=>({x:xt.x/W.x,y:xt.y/W.y}),tt=xt=>(xt.strokeWidth||3)*W.x,et=xt=>{const Xt=xt.evt;if(Xt!=null&&Xt.preventDefault&&Xt.preventDefault(),Xt!=null&&Xt.stopPropagation&&Xt.stopPropagation(),!it(Xt))return;const Ue=xt.target.getStage();if(Ue&&Xt.pointerId!==void 0){const ae=Ue.content;if(ae&&ae.setPointerCapture)try{ae.setPointerCapture(Xt.pointerId)}catch{}}if(g==="pen"){D(!0);const ae=Ue.getPointerPosition(),{x:ge,y:Fe}=J(ae),Me={tool:"pen",points:[ge,Fe],color:_,strokeWidth:E};y.current.push([...L]),B.current=[],K.current=Me,z([...L,Me])}else g==="eraser"&&(D(!0),j.current=!1)},gt=xt=>{const Xt=xt.evt;if(Xt!=null&&Xt.preventDefault&&Xt.preventDefault(),Xt!=null&&Xt.stopPropagation&&Xt.stopPropagation(),!v||!it(Xt))return;const ae=xt.target.getStage().getPointerPosition();if(g==="pen"){if(K.current){const{x:ge,y:Fe}=J(ae);K.current.points=K.current.points.concat([ge,Fe]);const Me=K.current;X.current&&cancelAnimationFrame(X.current),X.current=requestAnimationFrame(()=>{Me&&z(He=>He.length===0?He:[...He.slice(0,-1),Me])})}}else if(g==="eraser"){const ge=L.length,Fe=20,Me=L.filter(He=>{for(let en=0;en<He.points.length;en+=2){const dn=He.points[en]*W.x,ft=He.points[en+1]*W.y;if(Math.sqrt(Math.pow(dn-ae.x,2)+Math.pow(ft-ae.y,2))<Fe)return!1}return!0});Me.length<ge&&!j.current&&(y.current.push([...L]),B.current=[],j.current=!0),z(Me)}},At=xt=>{const Xt=xt==null?void 0:xt.evt;if(!it(Xt)){Xt!=null&&Xt.preventDefault&&Xt.preventDefault();return}if(D(!1),X.current&&(cancelAnimationFrame(X.current),X.current=null),K.current&&g==="pen"){const Ue=K.current;z(ae=>{if(ae.length===0)return ae;const ge=[...ae.slice(0,-1),Ue];return setTimeout(()=>i(ge),0),ge}),K.current=null}else setTimeout(()=>i(L),0)},Dt=()=>{if(y.current.length>0){const xt=y.current.pop();B.current.push([...L]),z(xt),i(xt)}},Qt=()=>{if(B.current.length>0){const xt=B.current.pop();y.current.push([...L]),z(xt),i(xt)}},ee=()=>{y.current.push([...L]),B.current=[];const xt=[];z(xt),i(xt)},le=()=>{c&&c(o.clientId)},kt=()=>{D(!1),n()},ye=()=>{N(xt=>xt==="stylus-only"?"all":"stylus-only")},_e=()=>{R(xt=>xt==="left"?"right":"left")},Xe=xt=>{xt.preventDefault(),xt.stopPropagation()};return k.jsx("div",{className:"annotation-modal-overlay",onTouchMove:Xe,onTouchStart:Xe,children:k.jsx("div",{className:"annotation-modal student-console",children:k.jsxs("div",{className:"annotation-console",children:[k.jsxs("div",{className:"annotation-status-bar",children:[k.jsxs("div",{className:"annotation-status-text",children:[k.jsx("h1",{children:"Annotate Student"}),k.jsx("p",{children:rt()})]}),k.jsxs("div",{className:"annotation-status-actions",children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:g==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",M==="all"?"All inputs":"Stylus only"]})}),k.jsxs("button",{className:`flag-pill ${l?"active":""}`,onClick:le,children:[k.jsx(pb,{active:l,size:16}),l?"Flagged":"Flag"]}),k.jsxs("button",{className:"status-badge",onClick:_e,children:["Move toolbar to ",G==="left"?"right":"left"]}),k.jsx("button",{className:"status-badge danger",onClick:kt,children:" Close"})]})]}),k.jsxs("div",{className:`annotation-workspace ${G==="right"?"toolbar-right":""}`,children:[k.jsxs("div",{className:"annotation-sidebar",children:[k.jsxs("div",{className:"sidebar-header",children:[k.jsx("h2",{children:"Annotation Console"}),k.jsx("p",{children:"Mirror of student workspace"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsx("div",{className:"color-row",children:p2.map(xt=>k.jsx("button",{className:`color-button ${_===xt.value?"active":""}`,style:{background:xt.value},onClick:()=>C(xt.value),"aria-label":xt.label},xt.value))})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>m("pen"),className:`tool-icon-button ${g==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>m("eraser"),className:`tool-icon-button ${g==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsxs("div",{className:"brush-size-control",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:E,onChange:xt=>O(parseInt(xt.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:E})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${M==="all"?"all":""}`,onClick:ye,children:M==="stylus-only"?"Stylus only":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:Dt,className:"history-button",disabled:y.current.length===0,children:"Undo"}),k.jsx("button",{onClick:Qt,className:"history-button",disabled:B.current.length===0,children:"Redo"}),k.jsx("button",{onClick:ee,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"annotation-canvas-panel",children:k.jsx("div",{className:"annotation-canvas-frame",ref:V,onTouchMove:xt=>xt.preventDefault(),onTouchStart:xt=>xt.preventDefault(),children:k.jsxs(Mg,{ref:U,width:I.width,height:I.height,onPointerDown:et,onPointerMove:gt,onPointerUp:At,onPointerLeave:At,onTouchStart:xt=>xt.preventDefault(),onTouchMove:xt=>xt.preventDefault(),onTouchEnd:xt=>xt.preventDefault(),className:"annotation-stage",perfectDrawEnabled:!1,children:[Z&&k.jsx(Gr,{listening:!1,children:k.jsx(av,{image:A,x:Z.x,y:Z.y,width:Z.width,height:Z.height})}),k.jsx(Gr,{listening:!1,children:o.lines&&o.lines.map((xt,Xt)=>k.jsx(uo,{points:Y(xt.points),stroke:xt.color||"black",strokeWidth:(xt.strokeWidth||3)*W.x,tension:.5,lineCap:"round",lineJoin:"round"},`student-${Xt}`))}),k.jsx(Gr,{children:L.map((xt,Xt)=>k.jsx(uo,{points:Y(xt.points),stroke:xt.color,strokeWidth:tt(xt),tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${Xt}`))})]})})})]})]})})})},yb=async(o,t=800,n=600,i=.7)=>{const r=await createImageBitmap(o),l=Math.min(t/r.width,n/r.height,1),c=Math.round(r.width*l),d=Math.round(r.height*l),g=document.createElement("canvas");g.width=c,g.height=d,g.getContext("2d").drawImage(r,0,0,c,d);const _=await new Promise((E,O)=>{g.toBlob(v=>{v?E(v):O(new Error("Failed to compress image"))},"image/jpeg",i)}),C=await new Promise((E,O)=>{const v=new FileReader;v.onload=()=>E(v.result),v.onerror=O,v.readAsDataURL(_)});return{blob:_,dataUrl:C,width:c,height:d,size:_.size}},TT=()=>{const[o,t]=gd(),n=pf(),i=()=>{const zt="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let Yt="";for(let $t=0;$t<6;$t++)Yt+=zt.charAt(Math.floor(Math.random()*zt.length));return Yt},r=()=>{const zt=o.get("room");if(zt)return zt.toUpperCase();const Yt=i();return t({room:Yt}),Yt},[l]=qn.useState(r),[c,d]=lt.useState(null),[g,m]=lt.useState(null),[_,C]=lt.useState(null),[E,O]=lt.useState(0),[v,D]=lt.useState("created"),[L,z]=lt.useState(null),[M,N]=lt.useState(null),[G,R]=lt.useState(!1),[A]=lt.useState(`teacher-${Math.random().toString(36).substring(7)}`),[T,y]=lt.useState(()=>{const zt=parseInt(o.get("bot"))||0,Yt={};if(zt>0)for(let $t=1;$t<=zt;$t++){const oe=`bot-${$t}`;Yt[oe]={clientId:oe,name:`Bot ${$t}`,lines:[],lastUpdate:Date.now()-$t*1e3,isActive:!0,isFlagged:!1}}return Yt}),[B,j]=lt.useState(null),[H,Q]=lt.useState({}),[K,X]=lt.useState(""),[V,U]=lt.useState("all"),[I,F]=lt.useState("all"),[W,at]=lt.useState(()=>{const zt=localStorage.getItem("teacherDashboardHideNames");return zt?JSON.parse(zt):!1}),[Z,rt]=lt.useState(()=>{const zt=localStorage.getItem("teacherDashboardCardsPerRow");return zt?parseInt(zt):3}),[it,Y]=lt.useState("blank"),[J,tt]=lt.useState(null),[et,gt]=lt.useState(null),[At,Dt]=lt.useState(""),[Qt,ee]=lt.useState(!1),[le,kt]=lt.useState(null),ye=lt.useRef(null),_e=lt.useRef(null),Xe=lt.useRef(null),[xt,Xt]=lt.useState(!1),[Ue,ae]=lt.useState(""),[ge,Fe]=lt.useState([]),Me=lt.useRef(!1);lt.useEffect(()=>{ye.current=le},[le]);const He=(zt,Yt="info")=>{const $t=Date.now();Fe(oe=>[...oe,{id:$t,message:zt,type:Yt}]),setTimeout(()=>{Fe(oe=>oe.filter(It=>It.id!==$t))},4e3)};lt.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(W))},[W]),lt.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",Z.toString())},[Z]),lt.useEffect(()=>{(async()=>{try{console.log(" Initializing session in Supabase with room code:",l);const{data:Yt,error:$t}=await Li.from("sessions").select("*").ilike("room_code",l).order("created_at",{ascending:!1}).limit(1);if($t){console.error("Failed to query sessions:",$t);return}let oe=null;if(Yt&&Yt.length>0){const It=Yt[0];if(It.status==="ended"){console.log(" Found ended session, resetting to created status");const{data:ze,error:Jn}=await Li.from("sessions").update({status:"created",started_at:null,ended_at:null}).eq("id",It.id).select().single();if(Jn){console.error("Failed to update session:",Jn);return}oe=ze,console.log(" Session reset to created:",oe)}else console.log(" Reusing existing session:",It),oe=It}else{console.log(" No existing session found, creating new one");const{data:It,error:ze}=await Li.from("sessions").insert([{room_code:l,status:"created"}]).select().single();if(ze){console.error("Failed to create session:",ze);return}oe=It,console.log(" Session created:",oe)}if(oe){d(oe.id),D(oe.status);const{data:It,error:ze}=await Li.from("participants").insert([{session_id:oe.id,client_id:A,name:"Teacher",role:"teacher"}]).select().single();ze?console.error("Failed to create teacher participant:",ze):(console.log(" Teacher participant created:",It),m(It.id))}}catch(Yt){console.error("Error initializing session:",Yt)}})()},[l]),lt.useEffect(()=>(c&&(async()=>{try{const Yt=`/api/token?clientId=${A}`,oe=await(await fetch(Yt)).json(),It=new ub.Realtime({authCallback:async(Kt,ie)=>{ie(null,oe)},clientId:A});It.connection.on("connected",()=>{console.log("Connected to Ably"),R(!0)}),It.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),R(!1)}),z(It);const ze=It.channels.get(`room-${l}`);ze.subscribe("student-layer",Kt=>{console.log(" Teacher received student layer from",Kt.clientId),Me.current=!0,y(ie=>{var Ie,xe,We;return{...ie,[Kt.clientId]:{...ie[Kt.clientId]||{},clientId:Kt.clientId,name:((Ie=ie[Kt.clientId])==null?void 0:Ie.name)||en(Kt.clientId),lines:Kt.data.lines||[],meta:Kt.data.meta||((xe=ie[Kt.clientId])==null?void 0:xe.meta)||null,lastUpdate:Date.now(),isActive:!0,isFlagged:((We=ie[Kt.clientId])==null?void 0:We.isFlagged)||!1}}}),setTimeout(()=>{Me.current=!1},100)}),ze.presence.subscribe("enter",Kt=>{var ie;if(Kt.clientId!==A&&Kt.clientId.includes("student")){const Ie=((ie=Kt.data)==null?void 0:ie.name)||en(Kt.clientId);console.log(" Student joined:",Kt.clientId,"Name:",Ie),y(xe=>{var We,Ai;return xe[Kt.clientId]||He(`${Ie} joined`,"success"),{...xe,[Kt.clientId]:{...xe[Kt.clientId]||{},clientId:Kt.clientId,name:Ie,isActive:!0,isVisible:((We=Kt.data)==null?void 0:We.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:((Ai=xe[Kt.clientId])==null?void 0:Ai.isFlagged)||!1}}}),setTimeout(()=>{ye.current&&(ze.publish("sync-question-state",{targetClientId:Kt.clientId,content:ye.current,timestamp:Date.now()}),console.log(" Sent current question state to",Kt.clientId))},500)}}),ze.presence.subscribe("leave",Kt=>{Kt.clientId!==A&&Kt.clientId.includes("student")&&(console.log(" Student left:",Kt.clientId),y(ie=>{const Ie=ie[Kt.clientId],xe=(Ie==null?void 0:Ie.name)||en(Kt.clientId);He(`${xe} left`,"info");const{[Kt.clientId]:We,...Ai}=ie;return Ai}))}),ze.presence.subscribe("update",Kt=>{var ie;if(Kt.clientId!==A&&Kt.clientId.includes("student")){const Ie=((ie=Kt.data)==null?void 0:ie.isVisible)!==!1;console.log(` Student visibility update: ${Kt.clientId} - ${Ie?"visible":"hidden"}`),y(xe=>({...xe,[Kt.clientId]:{...xe[Kt.clientId]||{},isVisible:Ie,lastVisibilityChange:Date.now()}}))}}),ze.subscribe("student-visibility",Kt=>{const{clientId:ie,studentName:Ie,isVisible:xe}=Kt.data;console.log(` Student visibility event: ${Ie} - ${xe?"visible":"hidden"}`),y(We=>({...We,[ie]:{...We[ie]||{},isVisible:xe,lastVisibilityChange:Date.now()}})),xe||He(` ${Ie} switched away from the tab`,"warning")}),ze.subscribe("teacher-image",Kt=>{console.log(" Teacher dashboard received shared image"),kt(Kt.data)}),ze.subscribe("request-current-state",Kt=>{console.log(" Student requesting current state:",Kt.clientId),setTimeout(()=>{ye.current?(ze.publish("sync-question-state",{targetClientId:Kt.clientId,content:ye.current,timestamp:Date.now()}),console.log(" Sent current question state to",Kt.clientId)):console.log(" No question state to send (blank canvas)")},100)}),await ze.presence.enter();const Jn=await ze.presence.get();if(console.log(` Found ${Jn.length} existing members`),Jn.forEach(Kt=>{var ie;if(Kt.clientId!==A&&Kt.clientId.includes("student")){const Ie=((ie=Kt.data)==null?void 0:ie.name)||en(Kt.clientId);console.log(" Loading existing student:",Kt.clientId,"Name:",Ie),y(xe=>{var We;return xe[Kt.clientId]?xe:{...xe,[Kt.clientId]:{clientId:Kt.clientId,name:Ie,isActive:!0,isVisible:((We=Kt.data)==null?void 0:We.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:!1,lines:[]}}})}}),N(ze),c)try{const{data:Kt,error:ie}=await Li.from("participants").insert([{session_id:c,client_id:A,role:"teacher"}]).select().single();ie?console.error("Failed to create teacher participant:",ie):(console.log(" Teacher participant created:",Kt),m(Kt.id))}catch(Kt){console.error("Error creating teacher participant:",Kt)}}catch(Yt){console.error("Failed to connect to Ably:",Yt)}})(),()=>{L&&L.close()}),[l,A,c]),lt.useEffect(()=>{const zt=$t=>{if((v==="active"||v==="created")&&($t.preventDefault(),$t.returnValue="This will end the session for all students. Are you sure?",c&&M))try{M.publish("session-ended",{timestamp:Date.now(),reason:"teacher_refresh"});const oe=`${window.location.origin}/api/end-session`,It=JSON.stringify({sessionId:c});navigator.sendBeacon(oe,It)}catch(oe){console.error("Error ending session on unload:",oe)}},Yt=()=>{if(console.log(" Teacher page hide - ending session"),(v==="active"||v==="created")&&c&&M)try{M.publish("session-ended",{timestamp:Date.now(),reason:"teacher_refresh"})}catch($t){console.error("Error ending session on pagehide:",$t)}};return window.addEventListener("beforeunload",zt),window.addEventListener("pagehide",Yt),()=>{window.removeEventListener("beforeunload",zt),window.removeEventListener("pagehide",Yt)}},[v,c,M]);const en=zt=>{const Yt=zt.match(/student-(\d+)/)||zt.match(/student-([\w]+)/);return Yt?`Student ${Yt[1]}`:zt},dn=zt=>{j(T[zt.clientId]||zt)},ft=()=>{j(null)},ht=zt=>{if(!B||!M)return;const Yt=B.clientId;Q($t=>({...$t,[Yt]:zt})),M.publish("teacher-annotation",{targetStudentId:Yt,annotations:zt,teacherId:A,timestamp:Date.now()}),console.log(" Published annotations for",Yt)},ct=zt=>{y(Yt=>{const $t=Yt[zt];return $t?{...Yt,[zt]:{...$t,isFlagged:!$t.isFlagged}}:Yt}),j(Yt=>Yt&&Yt.clientId===zt?{...Yt,isFlagged:!Yt.isFlagged}:Yt)},wt=()=>{_e.current&&(_e.current.value="",_e.current.click())},jt=async zt=>{var $t;const Yt=($t=zt.target.files)==null?void 0:$t[0];if(!Yt){Dt("No file selected.");return}ee(!0),Dt("");try{const{dataUrl:oe,width:It,height:ze}=await yb(Yt),Jn={dataUrl:oe,width:It,height:ze,filename:Yt.name,timestamp:Date.now()};gt(Jn),Dt("Image ready to send.")}catch(oe){console.error("Failed to upload image from dashboard:",oe),Dt("Upload failed. Please try again.")}finally{ee(!1)}},Ot=()=>{gt(null),Dt(""),_e.current&&(_e.current.value="")},Gt=zt=>{const Yt=document.createElement("canvas"),$t=800,oe=600;Yt.width=$t,Yt.height=oe;const It=Yt.getContext("2d");if(It.fillStyle="#FFFFFF",It.fillRect(0,0,$t,oe),zt==="hanzi"){const Kt=($t-450)/2,ie=(oe-450)/2;It.strokeStyle="#0F9D83",It.lineWidth=4,It.strokeRect(Kt,ie,450,450),It.strokeStyle="#B0E8D8",It.lineWidth=2,It.setLineDash([8,8]),It.beginPath(),It.moveTo($t/2,ie),It.lineTo($t/2,ie+450),It.stroke(),It.beginPath(),It.moveTo(Kt,oe/2),It.lineTo(Kt+450,oe/2),It.stroke()}else if(zt==="graph-corner"){It.strokeStyle="#E0E0E0",It.lineWidth=1,It.setLineDash([]);for(let ie=80;ie<=$t-80;ie+=40)It.beginPath(),It.moveTo(ie,80),It.lineTo(ie,oe-80),It.stroke();for(let ie=80;ie<=oe-80;ie+=40)It.beginPath(),It.moveTo(80,ie),It.lineTo($t-80,ie),It.stroke();It.strokeStyle="#5B9BD5",It.lineWidth=3,It.beginPath(),It.moveTo(80,oe-80),It.lineTo($t-80,oe-80),It.stroke(),It.beginPath(),It.moveTo(80,80),It.lineTo(80,oe-80),It.stroke()}else if(zt==="graph-cross"){It.strokeStyle="#E0E0E0",It.lineWidth=1,It.setLineDash([]);for(let ie=80;ie<=$t-80;ie+=40)It.beginPath(),It.moveTo(ie,80),It.lineTo(ie,oe-80),It.stroke();for(let ie=80;ie<=oe-80;ie+=40)It.beginPath(),It.moveTo(80,ie),It.lineTo($t-80,ie),It.stroke();It.strokeStyle="#5B9BD5",It.lineWidth=3,It.beginPath(),It.moveTo(80,oe/2),It.lineTo($t-80,oe/2),It.stroke(),It.beginPath(),It.moveTo($t/2,80),It.lineTo($t/2,oe-80),It.stroke()}const ze=Yt.toDataURL("image/png");return{type:zt,dataUrl:ze,width:$t,height:oe,timestamp:Date.now()}},Bt=zt=>{const Yt=Gt(zt);tt(Yt),Dt(`Template ready: ${zt}`)},be=async()=>{if(!(!M||!c))try{if(v==="created"){console.log(" Starting session...");const{error:Kt}=await Li.from("sessions").update({status:"active",started_at:new Date().toISOString()}).eq("id",c);if(Kt){console.error("Failed to start session:",Kt),Dt("Failed to start session. Please try again.");return}D("active"),await M.publish("session-started",{timestamp:Date.now(),sessionId:c}),console.log(" Session started!")}const Yt=E+1;O(Yt);let $t="blank",oe=null,It=null;it==="templates"&&J?($t="template",oe=J.type,It={dataUrl:J.dataUrl,width:J.width,height:J.height}):it==="image"&&et&&($t="image",It={dataUrl:et.dataUrl,width:et.width,height:et.height,filename:et.filename});const{data:ze,error:Jn}=await Li.from("questions").insert([{session_id:c,question_number:Yt,content_type:$t,template_type:oe,image_data:It}]).select().single();if(Jn){console.error("Failed to create question:",Jn),Dt("Failed to save question. Please try again.");return}console.log(" Question created:",ze),C(ze.id),await M.publish("clear-all-drawings",{timestamp:Date.now(),questionId:ze.id}),y(Kt=>{const ie={};return Object.keys(Kt).forEach(Ie=>{ie[Ie]={...Kt[Ie],lines:[]}}),ie}),Q({}),it==="blank"?(await M.publish("teacher-clear",{timestamp:Date.now()}),kt(null),tt(null),Dt(`Question ${Yt}: Blank canvas sent to all students.`),He(`Question ${Yt} sent!`,"success")):it==="templates"&&J?(await M.publish("teacher-template",J),kt(J),Dt(`Question ${Yt}: Template sent to all students.`),He(`Question ${Yt} sent!`,"success")):it==="image"&&et&&(await M.publish("teacher-image",et),kt(et),Dt(`Question ${Yt}: Image sent to all students.`),He(`Question ${Yt} sent!`,"success"))}catch(zt){console.error("Failed to send to class:",zt),Dt("Failed to send. Please try again."),He("Failed to send question","error")}},we=async(zt="teacher_ended")=>{if(c&&(v==="active"||v==="created"))try{return await Li.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",c),M&&await M.publish("session-ended",{timestamp:Date.now(),reason:zt}),console.log(" Session ended:",zt),!0}catch(Yt){return console.error("Error ending session:",Yt),!1}return!1},te=async()=>{await we("teacher_back"),L&&L.close(),n("/")},Pe=async()=>{window.confirm(`Are you sure you want to end this session?

All students will be logged out and the session will be closed.`)&&(await we("teacher_ended"),L&&L.close(),n("/"))},sn=async()=>{const zt=`${window.location.origin}/student?room=${l}`;try{const Yt=await gb.toDataURL(zt,{width:300,margin:2,color:{dark:"#0F172A",light:"#FFFFFF"}});ae(Yt),Xt(!0)}catch(Yt){console.error("Failed to generate QR code:",Yt)}},Nn=async()=>{const zt=`${window.location.origin}/student?room=${l}`;if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(zt),alert("Link copied to clipboard!");return}catch(Yt){console.error("Clipboard API failed:",Yt)}try{const Yt=Xe.current;if(Yt)if(Yt.select(),Yt.setSelectionRange(0,99999),document.execCommand("copy"))alert("Link copied to clipboard!"),window.getSelection().removeAllRanges();else throw new Error("execCommand failed");else throw new Error("Input ref not available")}catch(Yt){console.error("Fallback copy failed:",Yt),Xe.current&&Xe.current.select(),alert("Please copy the selected link manually (Ctrl+C or Cmd+C)")}},Bn=()=>Object.values(T).sort((zt,Yt)=>{const $t=(zt.name||zt.clientId||"").toLowerCase(),oe=(Yt.name||Yt.clientId||"").toLowerCase();return $t.localeCompare(oe)}),Zi=()=>{const zt=Bn(),Yt=K.trim().toLowerCase();return zt.filter($t=>{const oe=Yt?($t.name||$t.clientId).toLowerCase().includes(Yt):!0,It=V==="all"||V==="flagged"&&$t.isFlagged,ze=I==="all"||I==="distracted"&&$t.isVisible===!1&&$t.isActive;return oe&&It&&ze})},La=Bn(),cr=Zi(),Cu=La.filter(zt=>zt.isActive).length,ba=B?T[B.clientId]||B:null,fr=At?!/fail|no file/i.test(At):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:ge.map(zt=>k.jsxs("div",{className:`toast toast-${zt.type}`,children:[zt.type==="success"&&k.jsx("span",{className:"toast-icon",children:""}),zt.type==="info"&&k.jsx("span",{className:"toast-icon",children:""}),zt.type==="error"&&k.jsx("span",{className:"toast-icon",children:""}),k.jsx("span",{className:"toast-message",children:zt.message})]},zt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsx("button",{className:"back-link",onClick:te,children:" Exit class"}),k.jsxs("section",{className:"hero-card glass-panel",children:[k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"Teacher dashboard"}),k.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:sn,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:l})]}),k.jsx("button",{className:"end-session-btn",onClick:Pe,title:"End session and logout all students",children:"End Session"}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Session live"}),k.jsx("span",{className:`status-pill connection-pill ${G?"online":"offline"}`,children:G?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:Cu}),k.jsx("span",{children:"online"})]})]})]})]}),k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:""}),k.jsx("input",{type:"text",placeholder:"Filter students",value:K,onChange:zt=>X(zt.target.value),className:"search-input"}),K&&k.jsx("button",{className:"clear-search-btn",onClick:()=>X(""),title:"Clear search",children:""})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:W,onChange:zt=>at(zt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${V==="flagged"?"active":""}`,onClick:()=>U(zt=>zt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${I==="distracted"?"active":""}`,onClick:()=>F(zt=>zt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:" Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:Z,onChange:zt=>rt(Number(zt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})]}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),J&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",J.type==="hanzi"?"Hanzi":J.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:be,disabled:it==="image"&&!et,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${it==="blank"?"active":""}`,onClick:()=>{Y("blank"),tt(null),gt(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${it==="templates"?"active":""}`,onClick:()=>{Y("templates"),gt(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${it==="image"?"active":""} ${et?"ready":""}`,onClick:()=>{Y("image"),tt(null)},disabled:Qt,children:Qt?"Uploading":"Send image"})]}),k.jsx("input",{ref:_e,type:"file",accept:"image/*",onChange:jt,style:{display:"none"}}),it==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(J==null?void 0:J.type)==="hanzi"?"active":""}`,onClick:()=>Bt("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(J==null?void 0:J.type)==="graph-corner"?"active":""}`,onClick:()=>Bt("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(J==null?void 0:J.type)==="graph-cross"?"active":""}`,onClick:()=>Bt("graph-cross"),children:"Graph (cross)"})]}),J&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:J.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),it==="image"&&k.jsx(k.Fragment,{children:et?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:et.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:et.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:et.width&&et.height?`${Math.round(et.width)}  ${Math.round(et.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:wt,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:Ot,children:"Clear"})]}),At&&k.jsx("span",{className:`image-message ${fr?"success":"error"}`,children:At})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:wt,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:""}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),At&&k.jsx("span",{className:`image-message ${fr?"success":"error"}`,children:At})]})}),it==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:La.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:""}),k.jsx("h2",{children:"Waiting for students to join"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):cr.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:""}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',K,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>X(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${Z}, 1fr)`},children:cr.filter(zt=>zt&&zt.clientId).map(zt=>k.jsx(mb,{student:zt,onClick:dn,onToggleFlag:ct,teacherAnnotations:H[zt.clientId]||[],sharedImage:le,hideNames:W},zt.clientId))})})})]}),k.jsx(vb,{student:ba,isOpen:!!ba,isFlagged:ba==null?void 0:ba.isFlagged,onToggleFlag:ct,onClose:ft,onAnnotate:ht,existingAnnotations:ba?H[ba.clientId]||[]:[],sharedImage:le}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:[" ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),xt&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>Xt(!1),children:k.jsxs("div",{className:"qr-modal",onClick:zt=>zt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",l]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>Xt(!1),children:""})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:Ue&&k.jsx("img",{src:Ue,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:Xe,type:"text",value:`${window.location.origin}/student?room=${l}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:Nn,children:"Copy Link"})]})]})]})]})})]})},m2={width:800,height:600};function AT(){const[o]=gd(),t=o.get("room")||"load-test",n=o.get("name")||`TestStudent-${Date.now()}`,[i,r]=lt.useState(null),[l]=lt.useState(`test-student-${Math.random().toString(36).substr(2,9)}`),[c,d]=lt.useState(!1),[g,m]=lt.useState([]),[_,C]=lt.useState([]),[E,O]=lt.useState("pen"),[v,D]=lt.useState(!1),L=lt.useRef(!1);lt.useEffect(()=>{(async()=>{try{const A=new pS.Realtime({authUrl:"/api/token",authParams:{clientId:l}});A.connection.on("connected",()=>{console.log("Connected to Ably"),d(!0)}),A.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),d(!1)});const T=A.channels.get(`room-${t}`);await new Promise((B,j)=>{T.once("attached",B),T.once("failed",j),T.attach()}),console.log(" Test Student channel attached");const y={name:n,role:"student",testMode:!0};console.log(" Entering presence with data:",y),await T.presence.enter(y),console.log(" Test Student entered presence as:",n),T.subscribe("student-layer",B=>{L.current=!0;const j=B.data;j.action==="clear"?m([]):j.lines&&m(H=>[...H,...j.lines]),setTimeout(()=>{L.current=!1},0)}),T.subscribe("teacher-layer",B=>{const j=B.data;j.action==="clear"?C([]):j.lines&&C(H=>[...H,...j.lines])}),r(T)}catch(A){console.error("Failed to initialize Ably:",A)}})()},[l,t,n]);const z=R=>{const A=R.target.getStage().getPointerPosition();if(!A)return;D(!0);const T={tool:E,points:[A.x,A.y],color:"black",strokeWidth:3};m([...g,T])},M=R=>{if(!v)return;const T=R.target.getStage().getPointerPosition();if(!T)return;const y=g[g.length-1];y&&(y.points=y.points.concat([T.x,T.y]),m([...g.slice(0,-1),y]))},N=()=>{if(!v||!i){D(!1);return}D(!1);const R=g[g.length-1];R&&R.points.length>=4&&i.publish("student-layer",{lines:[R]})},G=()=>{m([]),i&&i.publish("student-layer",{action:"clear"})};return k.jsxs("div",{className:"student-container",children:[k.jsxs("div",{className:"student-header",children:[k.jsxs("div",{className:"student-info",children:[k.jsx("span",{className:"student-name",children:n}),k.jsxs("span",{className:"room-code",children:["Room: ",t]}),k.jsx("span",{className:`connection-status ${c?"connected":"disconnected"}`,children:c?" Connected":" Disconnected"})]}),k.jsx("div",{className:"test-badge",children:"TEST MODE"})]}),k.jsxs("div",{className:"toolbar",children:[k.jsx("button",{className:`tool-btn ${E==="pen"?"active":""}`,onClick:()=>O("pen"),title:"Pen",children:" Pen"}),k.jsx("button",{className:`tool-btn ${E==="eraser"?"active":""}`,onClick:()=>O("eraser"),title:"Eraser",children:" Eraser"}),k.jsx("button",{className:"tool-btn",onClick:G,title:"Clear Canvas",children:" Clear"})]}),k.jsx("div",{className:"canvas-container",children:k.jsxs(Mg,{width:m2.width,height:m2.height,onMouseDown:z,onMousemove:M,onMouseup:N,onTouchStart:z,onTouchMove:M,onTouchEnd:N,className:"konva-stage",children:[k.jsx(Gr,{children:g.map((R,A)=>k.jsx(uo,{points:R.points,stroke:R.tool==="eraser"?"white":R.color,strokeWidth:R.tool==="eraser"?20:R.strokeWidth,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:R.tool==="eraser"?"destination-out":"source-over"},`student-${A}`))}),k.jsx(Gr,{listening:!1,children:_.map((R,A)=>k.jsx(uo,{points:R.points,stroke:"red",strokeWidth:R.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round",opacity:.7},`teacher-${A}`))})]})}),k.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",background:"#f0f0f0",padding:"10px",borderRadius:"8px",fontSize:"12px"},children:[k.jsx("div",{children:k.jsx("strong",{children:"Test Mode Instructions:"})}),k.jsx("div",{children:" No login required"}),k.jsx("div",{children:" Draw on canvas to test"}),k.jsx("div",{children:" Red lines are from teacher"})]})]})}const wT=()=>{const[o]=gd(),t=pf(),n=()=>{const Ot=o.get("room");return Ot?Ot.toUpperCase():"load-test".toUpperCase()},[i]=qn.useState(n),[r,l]=lt.useState(null),[c,d]=lt.useState(null),[g,m]=lt.useState(!1),[_]=lt.useState(`test-teacher-${Math.random().toString(36).substring(7)}`),[C,E]=lt.useState({}),[O,v]=lt.useState(null),[D,L]=lt.useState({}),[z,M]=lt.useState(""),[N,G]=lt.useState("all"),[R,A]=lt.useState("all"),[T,y]=lt.useState(()=>{const Ot=localStorage.getItem("teacherDashboardHideNames");return Ot?JSON.parse(Ot):!1}),[B,j]=lt.useState(()=>{const Ot=localStorage.getItem("teacherDashboardCardsPerRow");return Ot?parseInt(Ot):3}),[H,Q]=lt.useState("blank"),[K,X]=lt.useState(null),[V,U]=lt.useState(null),[I,F]=lt.useState(""),[W,at]=lt.useState(!1),[Z,rt]=lt.useState(null),it=lt.useRef(null),Y=lt.useRef(null),J=lt.useRef(null),[tt,et]=lt.useState(!1),[gt,At]=lt.useState(""),[Dt,Qt]=lt.useState([]);lt.useRef(!1),lt.useEffect(()=>{it.current=Z},[Z]);const ee=(Ot,Gt="info")=>{const Bt=Date.now();Qt(be=>[...be,{id:Bt,message:Ot,type:Gt}]),setTimeout(()=>{Qt(be=>be.filter(we=>we.id!==Bt))},4e3)};lt.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(T))},[T]),lt.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",B.toString())},[B]),lt.useEffect(()=>((async()=>{try{const Gt=new ub.Realtime({authUrl:"/api/token",authParams:{clientId:_}});Gt.connection.on("connected",()=>{console.log(" Test Teacher connected to Ably"),m(!0)}),Gt.connection.on("disconnected",()=>{console.log(" Test Teacher disconnected"),m(!1)});const Bt=Gt.channels.get(`room-${i}`);await new Promise((te,Pe)=>{Bt.once("attached",te),Bt.once("failed",Pe),Bt.attach()}),console.log(" Channel attached"),Bt.presence.subscribe("enter",te=>{var Pe,sn;console.log(" Member entered:",te.clientId,"Role:",(Pe=te.data)==null?void 0:Pe.role,"Data:",te.data),((sn=te.data)==null?void 0:sn.role)==="student"&&(console.log(" Adding student to dashboard:",te.data.name||te.clientId),E(Nn=>({...Nn,[te.clientId]:{clientId:te.clientId,name:te.data.name||te.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,testMode:te.data.testMode||!1,meta:{base:{width:800,height:600}}}})))}),Bt.presence.subscribe("leave",te=>{console.log(" Student left:",te.clientId),E(Pe=>{const sn={...Pe};return sn[te.clientId]&&(sn[te.clientId].isActive=!1),sn})}),Bt.presence.subscribe("update",te=>{var Pe;((Pe=te.data)==null?void 0:Pe.isVisible)!==void 0&&E(sn=>{const Nn={...sn};return Nn[te.clientId]&&(Nn[te.clientId].isVisible=te.data.isVisible),Nn})});const be=await Bt.presence.get();console.log(` Found ${be.length} members in presence`);const we={};be.forEach(te=>{var Pe,sn,Nn,Bn,Zi;console.log("  - Member:",te.clientId,"Role:",(Pe=te.data)==null?void 0:Pe.role,"Name:",(sn=te.data)==null?void 0:sn.name),((Nn=te.data)==null?void 0:Nn.role)==="student"&&(console.log("     Adding existing student:",te.data.name||te.clientId),we[te.clientId]={clientId:te.clientId,name:te.data.name||te.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:((Bn=te.data)==null?void 0:Bn.isVisible)!==!1,testMode:((Zi=te.data)==null?void 0:Zi.testMode)||!1,meta:{base:{width:800,height:600}}})}),console.log(` Initialized with ${Object.keys(we).length} students`),E(we),Bt.subscribe("student-layer",te=>{const{clientId:Pe}=te,sn=te.data;E(Nn=>{const Bn={...Nn};return Bn[Pe]||(Bn[Pe]={clientId:Pe,name:Pe,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,meta:{base:{width:800,height:600}}}),sn.action==="clear"?Bn[Pe].lines=[]:sn.lines&&(Bn[Pe].lines=[...Bn[Pe].lines,...sn.lines]),Bn[Pe].lastUpdate=Date.now(),Bn})}),await Bt.presence.enter({role:"teacher",name:"Test Teacher",testMode:!0}),l(Gt),d(Bt)}catch(Gt){console.error("Failed to connect to Ably:",Gt)}})(),()=>{c&&c.presence.leave(),r&&r.close()}),[i,_]),lt.useEffect(()=>{if(tt){const Ot=`${window.location.origin}/test/student?room=${i}`;gb.toDataURL(Ot,{width:300,margin:2}).then(Gt=>At(Gt)).catch(Gt=>console.error("Failed to generate QR code:",Gt))}},[tt,i]);const le=()=>{t("/")},kt=()=>{et(!0)},ye=()=>{c&&(c.publish("session-ended",{timestamp:Date.now(),reason:"teacher_ended"}),ee("Session ended","success"))},_e=Ot=>{v(C[Ot.clientId]||Ot)},Xe=()=>{v(null)},xt=Ot=>{if(!O||!c)return;const Gt=O.clientId;L(Bt=>({...Bt,[Gt]:Ot})),c.publish("teacher-annotation",{targetStudentId:Gt,annotations:Ot,teacherId:_,timestamp:Date.now()}),console.log(" Published annotations for",Gt)},Xt=Ot=>{E(Gt=>{const Bt=Gt[Ot];return Bt?{...Gt,[Ot]:{...Bt,isFlagged:!Bt.isFlagged}}:Gt}),v(Gt=>Gt&&Gt.clientId===Ot?{...Gt,isFlagged:!Gt.isFlagged}:Gt)},Ue=Ot=>{const Gt=document.createElement("canvas");Gt.width=800,Gt.height=600;const Bt=Gt.getContext("2d");if(Bt.fillStyle="white",Bt.fillRect(0,0,800,600),Bt.strokeStyle="#ddd",Bt.lineWidth=1,Ot==="hanzi")Bt.strokeRect(250,150,300,300),Bt.beginPath(),Bt.moveTo(400,150),Bt.lineTo(400,450),Bt.moveTo(250,300),Bt.lineTo(550,300),Bt.stroke();else if(Ot==="graph-corner"){Bt.beginPath(),Bt.moveTo(100,500),Bt.lineTo(100,100),Bt.lineTo(700,100),Bt.stroke();for(let we=1;we<10;we++){const te=100+we*60;Bt.beginPath(),Bt.moveTo(te,100),Bt.lineTo(te,500),Bt.stroke()}for(let we=1;we<8;we++){const te=100+we*50;Bt.beginPath(),Bt.moveTo(100,te),Bt.lineTo(700,te),Bt.stroke()}}else if(Ot==="graph-cross"){Bt.beginPath(),Bt.moveTo(50,300),Bt.lineTo(750,300),Bt.moveTo(400,50),Bt.lineTo(400,550),Bt.stroke();for(let we=-6;we<=6;we++){if(we===0)continue;const te=400+we*50;Bt.beginPath(),Bt.moveTo(te,50),Bt.lineTo(te,550),Bt.stroke()}for(let we=-5;we<=5;we++){if(we===0)continue;const te=300+we*50;Bt.beginPath(),Bt.moveTo(50,te),Bt.lineTo(750,te),Bt.stroke()}}const be=Gt.toDataURL("image/png");X({type:Ot,dataUrl:be,width:800,height:600})},ae=()=>{Y.current&&(Y.current.value="",Y.current.click())},ge=async Ot=>{var Bt;const Gt=(Bt=Ot.target.files)==null?void 0:Bt[0];if(!Gt){F("No file selected.");return}at(!0),F("");try{const{dataUrl:be,width:we,height:te}=await yb(Gt),Pe={dataUrl:be,width:we,height:te,filename:Gt.name,timestamp:Date.now()};U(Pe),F("Image ready to send.")}catch(be){console.error("Failed to upload image:",be),F("Upload failed. Please try again.")}finally{at(!1)}},Fe=()=>{U(null),F("")},Me=()=>{if(!c)return;let Ot=null;H==="templates"&&K?Ot=K:H==="image"&&V&&(Ot=V),c.publish("teacher-action",{action:"send-blank-canvas",questionNumber:1,sharedImage:Ot,timestamp:Date.now()}),rt(Ot||null),ee("Sent to all students","success"),console.log(" Sent to class:",H)},He=async()=>{const Ot=`${window.location.origin}/test/student?room=${i}`;try{await navigator.clipboard.writeText(Ot),ee("Link copied to clipboard","success")}catch(Gt){console.error("Clipboard API failed:",Gt);try{J.current&&(J.current.select(),document.execCommand("copy"),ee("Link copied to clipboard","success"))}catch(Bt){console.error("Fallback copy failed:",Bt),J.current&&J.current.select(),alert("Please copy the selected link manually")}}},en=()=>Object.values(C).sort((Ot,Gt)=>Ot.isActive&&!Gt.isActive?-1:!Ot.isActive&&Gt.isActive?1:(Gt.lastUpdate||0)-(Ot.lastUpdate||0)),dn=()=>{const Ot=en(),Gt=z.trim().toLowerCase();return Ot.filter(Bt=>{const be=Gt?(Bt.name||Bt.clientId).toLowerCase().includes(Gt):!0,we=N==="all"||N==="flagged"&&Bt.isFlagged,te=R==="all"||R==="distracted"&&Bt.isVisible===!1&&Bt.isActive;return be&&we&&te})},ft=en(),ht=dn(),ct=ft.filter(Ot=>Ot.isActive).length,wt=O?C[O.clientId]||O:null,jt=I?!/fail|no file/i.test(I):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:Dt.map(Ot=>k.jsxs("div",{className:`toast toast-${Ot.type}`,children:[Ot.type==="success"&&k.jsx("span",{className:"toast-icon",children:""}),Ot.type==="info"&&k.jsx("span",{className:"toast-icon",children:""}),Ot.type==="error"&&k.jsx("span",{className:"toast-icon",children:""}),k.jsx("span",{className:"toast-message",children:Ot.message})]},Ot.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsx("button",{className:"back-link",onClick:le,children:" Exit class"}),k.jsxs("section",{className:"hero-card glass-panel",children:[k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:" Test Teacher dashboard"}),k.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:kt,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:i})]}),k.jsx("button",{className:"end-session-btn",onClick:ye,title:"End session and logout all students",children:"End Session"}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Test mode"}),k.jsx("span",{className:`status-pill connection-pill ${g?"online":"offline"}`,children:g?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:ct}),k.jsx("span",{children:"online"})]})]})]})]}),k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:""}),k.jsx("input",{type:"text",placeholder:"Filter students",value:z,onChange:Ot=>M(Ot.target.value),className:"search-input"}),z&&k.jsx("button",{className:"clear-search-btn",onClick:()=>M(""),title:"Clear search",children:""})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:T,onChange:Ot=>y(Ot.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${N==="flagged"?"active":""}`,onClick:()=>G(Ot=>Ot==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${R==="distracted"?"active":""}`,onClick:()=>A(Ot=>Ot==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:" Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:B,onChange:Ot=>j(Number(Ot.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})]}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),K&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",K.type==="hanzi"?"Hanzi":K.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:Me,disabled:H==="image"&&!V,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${H==="blank"?"active":""}`,onClick:()=>{Q("blank"),X(null),U(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${H==="templates"?"active":""}`,onClick:()=>{Q("templates"),U(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${H==="image"?"active":""} ${V?"ready":""}`,onClick:()=>{Q("image"),X(null)},disabled:W,children:W?"Uploading":"Send image"})]}),k.jsx("input",{ref:Y,type:"file",accept:"image/*",onChange:ge,style:{display:"none"}}),H==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(K==null?void 0:K.type)==="hanzi"?"active":""}`,onClick:()=>Ue("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(K==null?void 0:K.type)==="graph-corner"?"active":""}`,onClick:()=>Ue("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(K==null?void 0:K.type)==="graph-cross"?"active":""}`,onClick:()=>Ue("graph-cross"),children:"Graph (cross)"})]}),K&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:K.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),H==="image"&&k.jsx(k.Fragment,{children:V?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:V.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:V.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:V.width&&V.height?`${Math.round(V.width)}  ${Math.round(V.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:ae,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:Fe,children:"Clear"})]}),I&&k.jsx("span",{className:`image-message ${jt?"success":"error"}`,children:I})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:ae,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:""}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),I&&k.jsx("span",{className:`image-message ${jt?"success":"error"}`,children:I})]})}),H==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:ft.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:""}),k.jsx("h2",{children:"Waiting for students to join"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):ht.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:""}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',z,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>M(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${B}, 1fr)`},children:ht.filter(Ot=>Ot&&Ot.clientId).map(Ot=>k.jsx(mb,{student:Ot,onClick:_e,onToggleFlag:Xt,teacherAnnotations:D[Ot.clientId]||[],sharedImage:Z,hideNames:T},Ot.clientId))})})})]}),k.jsx(vb,{student:wt,isOpen:!!wt,isFlagged:wt==null?void 0:wt.isFlagged,onToggleFlag:Xt,onClose:Xe,onAnnotate:xt,existingAnnotations:wt?D[wt.clientId]||[]:[],sharedImage:Z}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:[" ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),tt&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>et(!1),children:k.jsxs("div",{className:"qr-modal",onClick:Ot=>Ot.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",i]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>et(!1),children:""})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:gt&&k.jsx("img",{src:gt,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:J,type:"text",value:`${window.location.origin}/test/student?room=${i}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:He,children:"Copy Link"})]})]})]})]})})]})};function OT(){return k.jsx(h3,{children:k.jsxs(o3,{children:[k.jsx(ou,{path:"/",element:k.jsx(d3,{})}),k.jsx(ou,{path:"/student-login",element:k.jsx($C,{})}),k.jsx(ou,{path:"/student",element:k.jsx(WC,{})}),k.jsx(ou,{path:"/teacher",element:k.jsx(TT,{})}),k.jsx(ou,{path:"/test/student",element:k.jsx(AT,{})}),k.jsx(ou,{path:"/test/teacher",element:k.jsx(wT,{})})]})})}m4.createRoot(document.getElementById("root")).render(k.jsx(qn.StrictMode,{children:k.jsx(OT,{})}));
