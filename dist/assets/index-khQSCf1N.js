function c4(o,t){for(var n=0;n<t.length;n++){const a=t[n];if(typeof a!="string"&&!Array.isArray(a)){for(const r in a)if(r!=="default"&&!(r in o)){const l=Object.getOwnPropertyDescriptor(a,r);l&&Object.defineProperty(o,r,l.get?l:{enumerable:!0,get:()=>a[r]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function df(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function y2(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var t=o.default;if(typeof t=="function"){var n=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(a){var r=Object.getOwnPropertyDescriptor(o,a);Object.defineProperty(n,a,r.get?r:{enumerable:!0,get:function(){return o[a]}})}),n}var mp={exports:{}},Vh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sy;function f4(){if(sy)return Vh;sy=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(a,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var d in r)d!=="key"&&(l[d]=r[d])}else l=r;return r=l.ref,{$$typeof:o,type:a,key:c,ref:r!==void 0?r:null,props:l}}return Vh.Fragment=t,Vh.jsx=n,Vh.jsxs=n,Vh}var ly;function h4(){return ly||(ly=1,mp.exports=f4()),mp.exports}var k=h4(),vp={exports:{}},Ae={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy;function d4(){if(oy)return Ae;oy=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),E=Symbol.iterator;function O(Z){return Z===null||typeof Z!="object"?null:(Z=E&&Z[E]||Z["@@iterator"],typeof Z=="function"?Z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,z={};function L(Z,rt,at){this.props=Z,this.context=rt,this.refs=z,this.updater=at||v}L.prototype.isReactComponent={},L.prototype.setState=function(Z,rt){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,rt,"setState")},L.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function D(){}D.prototype=L.prototype;function N(Z,rt,at){this.props=Z,this.context=rt,this.refs=z,this.updater=at||v}var G=N.prototype=new D;G.constructor=N,M(G,L.prototype),G.isPureReactComponent=!0;var R=Array.isArray;function A(){}var T={H:null,A:null,T:null,S:null},y=Object.prototype.hasOwnProperty;function B(Z,rt,at){var Y=at.ref;return{$$typeof:o,type:Z,key:rt,ref:Y!==void 0?Y:null,props:at}}function j(Z,rt){return B(Z.type,rt,Z.props)}function P(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===o}function Q(Z){var rt={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(at){return rt[at]})}var K=/\/+/g;function X(Z,rt){return typeof Z=="object"&&Z!==null&&Z.key!=null?Q(""+Z.key):rt.toString(36)}function V(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(A,A):(Z.status="pending",Z.then(function(rt){Z.status==="pending"&&(Z.status="fulfilled",Z.value=rt)},function(rt){Z.status==="pending"&&(Z.status="rejected",Z.reason=rt)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function U(Z,rt,at,Y,J){var tt=typeof Z;(tt==="undefined"||tt==="boolean")&&(Z=null);var et=!1;if(Z===null)et=!0;else switch(tt){case"bigint":case"string":case"number":et=!0;break;case"object":switch(Z.$$typeof){case o:case t:et=!0;break;case _:return et=Z._init,U(et(Z._payload),rt,at,Y,J)}}if(et)return J=J(Z),et=Y===""?"."+X(Z,0):Y,R(J)?(at="",et!=null&&(at=et.replace(K,"$&/")+"/"),U(J,rt,at,"",function(Dt){return Dt})):J!=null&&(P(J)&&(J=j(J,at+(J.key==null||Z&&Z.key===J.key?"":(""+J.key).replace(K,"$&/")+"/")+et)),rt.push(J)),1;et=0;var gt=Y===""?".":Y+":";if(R(Z))for(var wt=0;wt<Z.length;wt++)Y=Z[wt],tt=gt+X(Y,wt),et+=U(Y,rt,at,tt,J);else if(wt=O(Z),typeof wt=="function")for(Z=wt.call(Z),wt=0;!(Y=Z.next()).done;)Y=Y.value,tt=gt+X(Y,wt++),et+=U(Y,rt,at,tt,J);else if(tt==="object"){if(typeof Z.then=="function")return U(V(Z),rt,at,Y,J);throw rt=String(Z),Error("Objects are not valid as a React child (found: "+(rt==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":rt)+"). If you meant to render a collection of children, use an array instead.")}return et}function I(Z,rt,at){if(Z==null)return Z;var Y=[],J=0;return U(Z,Y,"","",function(tt){return rt.call(at,tt,J++)}),Y}function F(Z){if(Z._status===-1){var rt=Z._result;rt=rt(),rt.then(function(at){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=at)},function(at){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=at)}),Z._status===-1&&(Z._status=0,Z._result=rt)}if(Z._status===1)return Z._result.default;throw Z._result}var W=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var rt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(rt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},it={map:I,forEach:function(Z,rt,at){I(Z,function(){rt.apply(this,arguments)},at)},count:function(Z){var rt=0;return I(Z,function(){rt++}),rt},toArray:function(Z){return I(Z,function(rt){return rt})||[]},only:function(Z){if(!P(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return Ae.Activity=C,Ae.Children=it,Ae.Component=L,Ae.Fragment=n,Ae.Profiler=r,Ae.PureComponent=N,Ae.StrictMode=a,Ae.Suspense=g,Ae.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,Ae.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return T.H.useMemoCache(Z)}},Ae.cache=function(Z){return function(){return Z.apply(null,arguments)}},Ae.cacheSignal=function(){return null},Ae.cloneElement=function(Z,rt,at){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var Y=M({},Z.props),J=Z.key;if(rt!=null)for(tt in rt.key!==void 0&&(J=""+rt.key),rt)!y.call(rt,tt)||tt==="key"||tt==="__self"||tt==="__source"||tt==="ref"&&rt.ref===void 0||(Y[tt]=rt[tt]);var tt=arguments.length-2;if(tt===1)Y.children=at;else if(1<tt){for(var et=Array(tt),gt=0;gt<tt;gt++)et[gt]=arguments[gt+2];Y.children=et}return B(Z.type,J,Y)},Ae.createContext=function(Z){return Z={$$typeof:c,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:l,_context:Z},Z},Ae.createElement=function(Z,rt,at){var Y,J={},tt=null;if(rt!=null)for(Y in rt.key!==void 0&&(tt=""+rt.key),rt)y.call(rt,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(J[Y]=rt[Y]);var et=arguments.length-2;if(et===1)J.children=at;else if(1<et){for(var gt=Array(et),wt=0;wt<et;wt++)gt[wt]=arguments[wt+2];J.children=gt}if(Z&&Z.defaultProps)for(Y in et=Z.defaultProps,et)J[Y]===void 0&&(J[Y]=et[Y]);return B(Z,tt,J)},Ae.createRef=function(){return{current:null}},Ae.forwardRef=function(Z){return{$$typeof:d,render:Z}},Ae.isValidElement=P,Ae.lazy=function(Z){return{$$typeof:_,_payload:{_status:-1,_result:Z},_init:F}},Ae.memo=function(Z,rt){return{$$typeof:m,type:Z,compare:rt===void 0?null:rt}},Ae.startTransition=function(Z){var rt=T.T,at={};T.T=at;try{var Y=Z(),J=T.S;J!==null&&J(at,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(A,W)}catch(tt){W(tt)}finally{rt!==null&&at.types!==null&&(rt.types=at.types),T.T=rt}},Ae.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},Ae.use=function(Z){return T.H.use(Z)},Ae.useActionState=function(Z,rt,at){return T.H.useActionState(Z,rt,at)},Ae.useCallback=function(Z,rt){return T.H.useCallback(Z,rt)},Ae.useContext=function(Z){return T.H.useContext(Z)},Ae.useDebugValue=function(){},Ae.useDeferredValue=function(Z,rt){return T.H.useDeferredValue(Z,rt)},Ae.useEffect=function(Z,rt){return T.H.useEffect(Z,rt)},Ae.useEffectEvent=function(Z){return T.H.useEffectEvent(Z)},Ae.useId=function(){return T.H.useId()},Ae.useImperativeHandle=function(Z,rt,at){return T.H.useImperativeHandle(Z,rt,at)},Ae.useInsertionEffect=function(Z,rt){return T.H.useInsertionEffect(Z,rt)},Ae.useLayoutEffect=function(Z,rt){return T.H.useLayoutEffect(Z,rt)},Ae.useMemo=function(Z,rt){return T.H.useMemo(Z,rt)},Ae.useOptimistic=function(Z,rt){return T.H.useOptimistic(Z,rt)},Ae.useReducer=function(Z,rt,at){return T.H.useReducer(Z,rt,at)},Ae.useRef=function(Z){return T.H.useRef(Z)},Ae.useState=function(Z){return T.H.useState(Z)},Ae.useSyncExternalStore=function(Z,rt,at){return T.H.useSyncExternalStore(Z,rt,at)},Ae.useTransition=function(){return T.H.useTransition()},Ae.version="19.2.0",Ae}var uy;function Eg(){return uy||(uy=1,vp.exports=d4()),vp.exports}var lt=Eg();const Vn=df(lt),g4=c4({__proto__:null,default:Vn},[lt]);var yp={exports:{}},Yh={},Sp={exports:{}},bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy;function p4(){return cy||(cy=1,(function(o){function t(U,I){var F=U.length;U.push(I);t:for(;0<F;){var W=F-1>>>1,it=U[W];if(0<r(it,I))U[W]=I,U[F]=it,F=W;else break t}}function n(U){return U.length===0?null:U[0]}function a(U){if(U.length===0)return null;var I=U[0],F=U.pop();if(F!==I){U[0]=F;t:for(var W=0,it=U.length,Z=it>>>1;W<Z;){var rt=2*(W+1)-1,at=U[rt],Y=rt+1,J=U[Y];if(0>r(at,F))Y<it&&0>r(J,at)?(U[W]=J,U[Y]=F,W=Y):(U[W]=at,U[rt]=F,W=rt);else if(Y<it&&0>r(J,F))U[W]=J,U[Y]=F,W=Y;else break t}}return I}function r(U,I){var F=U.sortIndex-I.sortIndex;return F!==0?F:U.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],_=1,C=null,E=3,O=!1,v=!1,M=!1,z=!1,L=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function G(U){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=U)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function R(U){if(M=!1,G(U),!v)if(n(g)!==null)v=!0,A||(A=!0,Q());else{var I=n(m);I!==null&&V(R,I.startTime-U)}}var A=!1,T=-1,y=5,B=-1;function j(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,A){var U=o.unstable_now();B=U;var I=!0;try{t:{v=!1,M&&(M=!1,D(T),T=-1),O=!0;var F=E;try{e:{for(G(U),C=n(g);C!==null&&!(C.expirationTime>U&&j());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=U);if(U=o.unstable_now(),typeof it=="function"){C.callback=it,G(U),I=!0;break e}C===n(g)&&a(g),G(U)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&V(R,Z.startTime-U),I=!1}}break t}finally{C=null,E=F,O=!1}I=void 0}}finally{I?Q():A=!1}}}var Q;if(typeof N=="function")Q=function(){N(P)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=P,Q=function(){X.postMessage(null)}}else Q=function(){L(P,0)};function V(U,I){T=L(function(){U(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(U){U.callback=null},o.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<U?Math.floor(1e3/U):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(U){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return U()}finally{E=F}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(U,I){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var F=E;E=U;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(U,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,U){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,U={id:_++,callback:I,priorityLevel:U,startTime:F,expirationTime:it,sortIndex:-1},F>W?(U.sortIndex=F,t(m,U),n(g)===null&&U===n(m)&&(M?(D(T),T=-1):M=!0,V(R,F-W))):(U.sortIndex=it,t(g,U),v||O||(v=!0,A||(A=!0,Q()))),U},o.unstable_shouldYield=j,o.unstable_wrapCallback=function(U){var I=E;return function(){var F=E;E=I;try{return U.apply(this,arguments)}finally{E=F}}}})(bp)),bp}var fy;function m4(){return fy||(fy=1,Sp.exports=p4()),Sp.exports}var _p={exports:{}},Ja={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function v4(){if(hy)return Ja;hy=1;var o=Eg();function t(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var a={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(g,m,_){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:C==null?null:""+C,children:g,containerInfo:m,implementation:_}}var c=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Ja.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Ja.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(g,m,null,_)},Ja.flushSync=function(g){var m=c.T,_=a.p;try{if(c.T=null,a.p=2,g)return g()}finally{c.T=m,a.p=_,a.d.f()}},Ja.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(g,m))},Ja.prefetchDNS=function(g){typeof g=="string"&&a.d.D(g)},Ja.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,O=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?a.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:C,integrity:E,fetchPriority:O}):_==="script"&&a.d.X(g,{crossOrigin:C,integrity:E,fetchPriority:O,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Ja.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=d(m.as,m.crossOrigin);a.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(g)},Ja.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,C=d(_,m.crossOrigin);a.d.L(g,_,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Ja.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=d(m.as,m.crossOrigin);a.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(g)},Ja.requestFormReset=function(g){a.d.r(g)},Ja.unstable_batchedUpdates=function(g,m){return g(m)},Ja.useFormState=function(g,m,_){return c.H.useFormState(g,m,_)},Ja.useFormStatus=function(){return c.H.useHostTransitionStatus()},Ja.version="19.2.0",Ja}var dy;function S2(){if(dy)return _p.exports;dy=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),_p.exports=v4(),_p.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gy;function y4(){if(gy)return Yh;gy=1;var o=m4(),t=Eg(),n=S2();function a(e){var i="https://react.dev/errors/"+e;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)i+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var i=e,f=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,(i.flags&4098)!==0&&(f=i.return),e=i.return;while(e)}return i.tag===3?f:null}function c(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function d(e){if(e.tag===31){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function g(e){if(l(e)!==e)throw Error(a(188))}function m(e){var i=e.alternate;if(!i){if(i=l(e),i===null)throw Error(a(188));return i!==e?null:e}for(var f=e,h=i;;){var b=f.return;if(b===null)break;var w=b.alternate;if(w===null){if(h=b.return,h!==null){f=h;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===f)return g(b),e;if(w===h)return g(b),i;w=w.sibling}throw Error(a(188))}if(f.return!==h.return)f=b,h=w;else{for(var q=!1,$=b.child;$;){if($===f){q=!0,f=b,h=w;break}if($===h){q=!0,h=b,f=w;break}$=$.sibling}if(!q){for($=w.child;$;){if($===f){q=!0,f=w,h=b;break}if($===h){q=!0,h=w,f=b;break}$=$.sibling}if(!q)throw Error(a(189))}}if(f.alternate!==h)throw Error(a(190))}if(f.tag!==3)throw Error(a(188));return f.stateNode.current===f?e:i}function _(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e;for(e=e.child;e!==null;){if(i=_(e),i!==null)return i;e=e.sibling}return null}var C=Object.assign,E=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),N=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function Q(e){return e===null||typeof e!="object"?null:(e=P&&e[P]||e["@@iterator"],typeof e=="function"?e:null)}var K=Symbol.for("react.client.reference");function X(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===K?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case M:return"Fragment";case L:return"Profiler";case z:return"StrictMode";case R:return"Suspense";case A:return"SuspenseList";case B:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case v:return"Portal";case N:return e.displayName||"Context";case D:return(e._context.displayName||"Context")+".Consumer";case G:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case T:return i=e.displayName||null,i!==null?i:X(e.type)||"Memo";case y:i=e._payload,e=e._init;try{return X(e(i))}catch{}}return null}var V=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},W=[],it=-1;function Z(e){return{current:e}}function rt(e){0>it||(e.current=W[it],W[it]=null,it--)}function at(e,i){it++,W[it]=e.current,e.current=i}var Y=Z(null),J=Z(null),tt=Z(null),et=Z(null);function gt(e,i){switch(at(tt,i),at(J,e),at(Y,null),i.nodeType){case 9:case 11:e=(e=i.documentElement)&&(e=e.namespaceURI)?xv(e):0;break;default:if(e=i.tagName,i=i.namespaceURI)i=xv(i),e=Nv(i,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}rt(Y),at(Y,e)}function wt(){rt(Y),rt(J),rt(tt)}function Dt(e){e.memoizedState!==null&&at(et,e);var i=Y.current,f=Nv(i,e.type);i!==f&&(at(J,e),at(Y,f))}function Qt(e){J.current===e&&(rt(Y),rt(J)),et.current===e&&(rt(et),Hh._currentValue=F)}var te,se;function kt(e){if(te===void 0)try{throw Error()}catch(f){var i=f.stack.trim().match(/\n( *(at )?)/);te=i&&i[1]||"",se=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+te+e+se}var pe=!1;function Ee(e,i){if(!e||pe)return"";pe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(i){var Mt=function(){throw Error()};if(Object.defineProperty(Mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Mt,[])}catch(At){var Et=At}Reflect.construct(e,[],Mt)}else{try{Mt.call()}catch(At){Et=At}e.call(Mt.prototype)}}else{try{throw Error()}catch(At){Et=At}(Mt=e())&&typeof Mt.catch=="function"&&Mt.catch(function(){})}}catch(At){if(At&&Et&&typeof At.stack=="string")return[At.stack,Et.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),q=w[0],$=w[1];if(q&&$){var ot=q.split(`
`),St=$.split(`
`);for(b=h=0;h<ot.length&&!ot[h].includes("DetermineComponentFrameRoot");)h++;for(;b<St.length&&!St[b].includes("DetermineComponentFrameRoot");)b++;if(h===ot.length||b===St.length)for(h=ot.length-1,b=St.length-1;1<=h&&0<=b&&ot[h]!==St[b];)b--;for(;1<=h&&0<=b;h--,b--)if(ot[h]!==St[b]){if(h!==1||b!==1)do if(h--,b--,0>b||ot[h]!==St[b]){var Rt=`
`+ot[h].replace(" at new "," at ");return e.displayName&&Rt.includes("<anonymous>")&&(Rt=Rt.replace("<anonymous>",e.displayName)),Rt}while(1<=h&&0<=b);break}}}finally{pe=!1,Error.prepareStackTrace=f}return(f=e?e.displayName||e.name:"")?kt(f):""}function Ze(e,i){switch(e.tag){case 26:case 27:case 5:return kt(e.type);case 16:return kt("Lazy");case 13:return e.child!==i&&i!==null?kt("Suspense Fallback"):kt("Suspense");case 19:return kt("SuspenseList");case 0:case 15:return Ee(e.type,!1);case 11:return Ee(e.type.render,!1);case 1:return Ee(e.type,!0);case 31:return kt("Activity");default:return""}}function Ve(e){try{var i="",f=null;do i+=Ze(e,f),f=e,e=e.return;while(e);return i}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var tn=Object.prototype.hasOwnProperty,xt=o.unstable_scheduleCallback,Xt=o.unstable_cancelCallback,be=o.unstable_shouldYield,ye=o.unstable_requestPaint,me=o.unstable_now,De=o.unstable_getCurrentPriorityLevel,Ye=o.unstable_ImmediatePriority,Ue=o.unstable_UserBlockingPriority,ft=o.unstable_NormalPriority,ct=o.unstable_LowPriority,ht=o.unstable_IdlePriority,Ot=o.log,Vt=o.unstable_setDisableYieldValue,Ct=null,zt=null;function Bt(e){if(typeof Ot=="function"&&Vt(e),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(Ct,e)}catch{}}var Se=Math.clz32?Math.clz32:He,_e=Math.log,$t=Math.LN2;function He(e){return e>>>=0,e===0?32:31-(_e(e)/$t|0)|0}var sn=256,An=262144,Ln=4194304;function Ga(e){var i=e&42;if(i!==0)return i;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Li(e,i,f){var h=e.pendingLanes;if(h===0)return 0;var b=0,w=e.suspendedLanes,q=e.pingedLanes;e=e.warmLanes;var $=h&134217727;return $!==0?(h=$&~w,h!==0?b=Ga(h):(q&=$,q!==0?b=Ga(q):f||(f=$&~e,f!==0&&(b=Ga(f))))):($=h&~w,$!==0?b=Ga($):q!==0?b=Ga(q):f||(f=h&~e,f!==0&&(b=Ga(f)))),b===0?0:i!==0&&i!==b&&(i&w)===0&&(w=b&-b,f=i&-i,w>=f||w===32&&(f&4194048)!==0)?i:b}function Hr(e,i){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&i)===0}function Gi(e,i){switch(e){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vl(){var e=Ln;return Ln<<=1,(Ln&62914560)===0&&(Ln=4194304),e}function Lt(e){for(var i=[],f=0;31>f;f++)i.push(e);return i}function It(e,i){e.pendingLanes|=i,i!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ne(e,i,f,h,b,w){var q=e.pendingLanes;e.pendingLanes=f,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=f,e.entangledLanes&=f,e.errorRecoveryDisabledLanes&=f,e.shellSuspendCounter=0;var $=e.entanglements,ot=e.expirationTimes,St=e.hiddenUpdates;for(f=q&~f;0<f;){var Rt=31-Se(f),Mt=1<<Rt;$[Rt]=0,ot[Rt]=-1;var Et=St[Rt];if(Et!==null)for(St[Rt]=null,Rt=0;Rt<Et.length;Rt++){var At=Et[Rt];At!==null&&(At.lane&=-536870913)}f&=~Mt}h!==0&&ae(e,h,0),w!==0&&b===0&&e.tag!==0&&(e.suspendedLanes|=w&~(q&~i))}function ae(e,i,f){e.pendingLanes|=i,e.suspendedLanes&=~i;var h=31-Se(i);e.entangledLanes|=i,e.entanglements[h]=e.entanglements[h]|1073741824|f&261930}function qt(e,i){var f=e.entangledLanes|=i;for(e=e.entanglements;f;){var h=31-Se(f),b=1<<h;b&i|e[h]&i&&(e[h]|=i),f&=~b}}function Be(e,i){var f=i&-i;return f=(f&42)!==0?1:Kn(f),(f&(e.suspendedLanes|i))!==0?0:f}function Kn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function wn(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Ut(){var e=I.p;return e!==0?e:(e=window.event,e===void 0?32:$v(e.type))}function je(e,i){var f=I.p;try{return I.p=e,i()}finally{I.p=f}}var en=Math.random().toString(36).slice(2),ze="__reactFiber$"+en,ln="__reactProps$"+en,oa="__reactContainer$"+en,ys="__reactEvents$"+en,yd="__reactListeners$"+en,Sd="__reactHandles$"+en,wu="__reactResources$"+en,Ss="__reactMarker$"+en;function Dn(e){delete e[ze],delete e[ln],delete e[ys],delete e[yd],delete e[Sd]}function Ir(e){var i=e[ze];if(i)return i;for(var f=e.parentNode;f;){if(i=f[oa]||f[ze]){if(f=i.alternate,i.child!==null||f!==null&&f.child!==null)for(e=Lv(e);e!==null;){if(f=e[ze])return f;e=Lv(e)}return i}e=f,f=e.parentNode}return null}function kr(e){if(e=e[ze]||e[oa]){var i=e.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return e}return null}function yl(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e.stateNode;throw Error(a(33))}function bs(e){var i=e[wu];return i||(i=e[wu]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ea(e){e[Ss]=!0}var Ou=new Set,Ru={};function fr(e,i){Wn(e,i),Wn(e+"Capture",i)}function Wn(e,i){for(Ru[e]=i,e=0;e<i.length;e++)Ou.add(i[e])}var Qn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xu={},Sl={};function Nu(e){return tn.call(Sl,e)?!0:tn.call(xu,e)?!1:Qn.test(e)?Sl[e]=!0:(xu[e]=!0,!1)}function bl(e,i,f){if(Nu(i))if(f===null)e.removeAttribute(i);else{switch(typeof f){case"undefined":case"function":case"symbol":e.removeAttribute(i);return;case"boolean":var h=i.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){e.removeAttribute(i);return}}e.setAttribute(i,""+f)}}function hi(e,i,f){if(f===null)e.removeAttribute(i);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttribute(i,""+f)}}function di(e,i,f,h){if(h===null)e.removeAttribute(f);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(f);return}e.setAttributeNS(i,f,""+h)}}function Pa(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Mu(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function bd(e,i,f){var h=Object.getOwnPropertyDescriptor(e.constructor.prototype,i);if(!e.hasOwnProperty(i)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var b=h.get,w=h.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return b.call(this)},set:function(q){f=""+q,w.call(this,q)}}),Object.defineProperty(e,i,{enumerable:h.enumerable}),{getValue:function(){return f},setValue:function(q){f=""+q},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Du(e){if(!e._valueTracker){var i=Mu(e)?"checked":"value";e._valueTracker=bd(e,i,""+e[i])}}function _f(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var f=i.getValue(),h="";return e&&(h=Mu(e)?e.checked?"true":"false":e.value),e=h,e!==f?(i.setValue(e),!0):!1}function So(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var _d=/[\n"\\]/g;function $a(e){return e.replace(_d,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function bo(e,i,f,h,b,w,q,$){e.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?e.type=q:e.removeAttribute("type"),i!=null?q==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+Pa(i)):e.value!==""+Pa(i)&&(e.value=""+Pa(i)):q!=="submit"&&q!=="reset"||e.removeAttribute("value"),i!=null?Cf(e,q,Pa(i)):f!=null?Cf(e,q,Pa(f)):h!=null&&e.removeAttribute("value"),b==null&&w!=null&&(e.defaultChecked=!!w),b!=null&&(e.checked=b&&typeof b!="function"&&typeof b!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?e.name=""+Pa($):e.removeAttribute("name")}function Ef(e,i,f,h,b,w,q,$){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.type=w),i!=null||f!=null){if(!(w!=="submit"&&w!=="reset"||i!=null)){Du(e);return}f=f!=null?""+Pa(f):"",i=i!=null?""+Pa(i):f,$||i===e.value||(e.value=i),e.defaultValue=i}h=h??b,h=typeof h!="function"&&typeof h!="symbol"&&!!h,e.checked=$?e.checked:!!h,e.defaultChecked=!!h,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(e.name=q),Du(e)}function Cf(e,i,f){i==="number"&&So(e.ownerDocument)===e||e.defaultValue===""+f||(e.defaultValue=""+f)}function _s(e,i,f,h){if(e=e.options,i){i={};for(var b=0;b<f.length;b++)i["$"+f[b]]=!0;for(f=0;f<e.length;f++)b=i.hasOwnProperty("$"+e[f].value),e[f].selected!==b&&(e[f].selected=b),b&&h&&(e[f].defaultSelected=!0)}else{for(f=""+Pa(f),i=null,b=0;b<e.length;b++){if(e[b].value===f){e[b].selected=!0,h&&(e[b].defaultSelected=!0);return}i!==null||e[b].disabled||(i=e[b])}i!==null&&(i.selected=!0)}}function Tf(e,i,f){if(i!=null&&(i=""+Pa(i),i!==e.value&&(e.value=i),f==null)){e.defaultValue!==i&&(e.defaultValue=i);return}e.defaultValue=f!=null?""+Pa(f):""}function Af(e,i,f,h){if(i==null){if(h!=null){if(f!=null)throw Error(a(92));if(V(h)){if(1<h.length)throw Error(a(93));h=h[0]}f=h}f==null&&(f=""),i=f}f=Pa(i),e.defaultValue=f,h=e.textContent,h===f&&h!==""&&h!==null&&(e.value=h),Du(e)}function qr(e,i){if(i){var f=e.firstChild;if(f&&f===e.lastChild&&f.nodeType===3){f.nodeValue=i;return}}e.textContent=i}var Ed=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wf(e,i,f){var h=i.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?h?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="":h?e.setProperty(i,f):typeof f!="number"||f===0||Ed.has(i)?i==="float"?e.cssFloat=f:e[i]=(""+f).trim():e[i]=f+"px"}function Of(e,i,f){if(i!=null&&typeof i!="object")throw Error(a(62));if(e=e.style,f!=null){for(var h in f)!f.hasOwnProperty(h)||i!=null&&i.hasOwnProperty(h)||(h.indexOf("--")===0?e.setProperty(h,""):h==="float"?e.cssFloat="":e[h]="");for(var b in i)h=i[b],i.hasOwnProperty(b)&&f[b]!==h&&wf(e,b,h)}else for(var w in i)i.hasOwnProperty(w)&&wf(e,w,i[w])}function ju(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ug=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _o(e){return Ug.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ha(){}var _l=null;function Uu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hr=null,Pi=null;function Rf(e){var i=kr(e);if(i&&(e=i.stateNode)){var f=e[ln]||null;t:switch(e=i.stateNode,i.type){case"input":if(bo(e,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),i=f.name,f.type==="radio"&&i!=null){for(f=e;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+$a(""+i)+'"][type="radio"]'),i=0;i<f.length;i++){var h=f[i];if(h!==e&&h.form===e.form){var b=h[ln]||null;if(!b)throw Error(a(90));bo(h,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(i=0;i<f.length;i++)h=f[i],h.form===e.form&&_f(h)}break t;case"textarea":Tf(e,f.value,f.defaultValue);break t;case"select":i=f.value,i!=null&&_s(e,!!f.multiple,i,!1)}}}var Bu=!1;function xf(e,i,f){if(Bu)return e(i,f);Bu=!0;try{var h=e(i);return h}finally{if(Bu=!1,(hr!==null||Pi!==null)&&(Xl(),hr&&(i=hr,e=Pi,Pi=hr=null,Rf(i),e)))for(i=0;i<e.length;i++)Rf(e[i])}}function El(e,i){var f=e.stateNode;if(f===null)return null;var h=f[ln]||null;if(h===null)return null;f=h[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break t;default:e=!1}if(e)return null;if(f&&typeof f!="function")throw Error(a(231,i,typeof f));return f}var Hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zu=!1;if(Hi)try{var Es={};Object.defineProperty(Es,"passive",{get:function(){zu=!0}}),window.addEventListener("test",Es,Es),window.removeEventListener("test",Es,Es)}catch{zu=!1}var dr=null,Lu=null,Cl=null;function Nf(){if(Cl)return Cl;var e,i=Lu,f=i.length,h,b="value"in dr?dr.value:dr.textContent,w=b.length;for(e=0;e<f&&i[e]===b[e];e++);var q=f-e;for(h=1;h<=q&&i[f-h]===b[w-h];h++);return Cl=b.slice(e,1<h?1-h:void 0)}function Eo(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function Co(){return!0}function Gu(){return!1}function Oa(e){function i(f,h,b,w,q){this._reactName=f,this._targetInst=b,this.type=h,this.nativeEvent=w,this.target=q,this.currentTarget=null;for(var $ in e)e.hasOwnProperty($)&&(f=e[$],this[$]=f?f(w):w[$]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Co:Gu,this.isPropagationStopped=Gu,this}return C(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Co)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Co)},persist:function(){},isPersistent:Co}),i}var Vr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pu=Oa(Vr),To=C({},Vr,{view:0,detail:0}),Td=Oa(To),Cs,Ao,Yr,wo=C({},To,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yr&&(Yr&&e.type==="mousemove"?(Cs=e.screenX-Yr.screenX,Ao=e.screenY-Yr.screenY):Ao=Cs=0,Yr=e),Cs)},movementY:function(e){return"movementY"in e?e.movementY:Ao}}),Mf=Oa(wo),Hu=C({},wo,{dataTransfer:0}),Oo=Oa(Hu),Iu=C({},To,{relatedTarget:0}),ku=Oa(Iu),Ad=C({},Vr,{animationName:0,elapsedTime:0,pseudoElement:0}),Kr=Oa(Ad),wd=C({},Vr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Qr=Oa(wd),gr=C({},Vr,{data:0}),Ro=Oa(gr),Df={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Od={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ts(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Rd[e])?!!i[e]:!1}function Tl(){return Ts}var xd=C({},To,{key:function(e){if(e.key){var i=Df[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=Eo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Od[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tl,charCode:function(e){return e.type==="keypress"?Eo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Eo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jf=Oa(xd),Nd=C({},wo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uf=Oa(Nd),Bg=C({},To,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tl}),ua=Oa(Bg),Md=C({},Vr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dd=Oa(Md),jd=C({},wo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ud=Oa(jd),Bd=C({},Vr,{newState:0,oldState:0}),qu=Oa(Bd),Bf=[9,13,27,32],Vu=Hi&&"CompositionEvent"in window,Al=null;Hi&&"documentMode"in document&&(Al=document.documentMode);var zd=Hi&&"TextEvent"in window&&!Al,Yu=Hi&&(!Vu||Al&&8<Al&&11>=Al),Ku=" ",zf=!1;function Qu(e,i){switch(e){case"keyup":return Bf.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xo(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xr=!1;function Ld(e,i){switch(e){case"compositionend":return xo(i);case"keypress":return i.which!==32?null:(zf=!0,Ku);case"textInput":return e=i.data,e===Ku&&zf?null:e;default:return null}}function Lf(e,i){if(Xr)return e==="compositionend"||!Vu&&Qu(e,i)?(e=Nf(),Cl=Lu=dr=null,Xr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Yu&&i.locale!=="ko"?null:i.data;default:return null}}var Gd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ii(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!Gd[e.type]:i==="textarea"}function Xu(e,i,f,h){hr?Pi?Pi.push(h):Pi=[h]:hr=h,i=x0(i,"onChange"),0<i.length&&(f=new Pu("onChange","change",null,f,h),e.push({event:f,listeners:i}))}var No=null,wl=null;function ti(e){Cv(e,0)}function Mo(e){var i=yl(e);if(_f(i))return e}function Fu(e,i){if(e==="change")return i}var Gf=!1;if(Hi){var Ju;if(Hi){var Do="oninput"in document;if(!Do){var Zu=document.createElement("div");Zu.setAttribute("oninput","return;"),Do=typeof Zu.oninput=="function"}Ju=Do}else Ju=!1;Gf=Ju&&(!document.documentMode||9<document.documentMode)}function Pf(){No&&(No.detachEvent("onpropertychange",jo),wl=No=null)}function jo(e){if(e.propertyName==="value"&&Mo(wl)){var i=[];Xu(i,wl,e,Uu(e)),xf(ti,i)}}function Uo(e,i,f){e==="focusin"?(Pf(),No=i,wl=f,No.attachEvent("onpropertychange",jo)):e==="focusout"&&Pf()}function jn(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Mo(wl)}function zg(e,i){if(e==="click")return Mo(i)}function Lg(e,i){if(e==="input"||e==="change")return Mo(i)}function Pd(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var ca=typeof Object.is=="function"?Object.is:Pd;function gi(e,i){if(ca(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var f=Object.keys(e),h=Object.keys(i);if(f.length!==h.length)return!1;for(h=0;h<f.length;h++){var b=f[h];if(!tn.call(i,b)||!ca(e[b],i[b]))return!1}return!0}function Hf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function If(e,i){var f=Hf(e);e=0;for(var h;f;){if(f.nodeType===3){if(h=e+f.textContent.length,e<=i&&h>=i)return{node:f,offset:i-e};e=h}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=Hf(f)}}function Ol(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Ol(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function _i(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var i=So(e.document);i instanceof e.HTMLIFrameElement;){try{var f=typeof i.contentWindow.location.href=="string"}catch{f=!1}if(f)e=i.contentWindow;else break;i=So(e.document)}return i}function Wu(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}var kf=Hi&&"documentMode"in document&&11>=document.documentMode,As=null,Bo=null,ws=null,Rl=!1;function qf(e,i,f){var h=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Rl||As==null||As!==So(h)||(h=As,"selectionStart"in h&&Wu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ws&&gi(ws,h)||(ws=h,h=x0(Bo,"onSelect"),0<h.length&&(i=new Pu("onSelect","select",null,i,f),e.push({event:i,listeners:h}),i.target=As)))}function Fr(e,i){var f={};return f[e.toLowerCase()]=i.toLowerCase(),f["Webkit"+e]="webkit"+i,f["Moz"+e]="moz"+i,f}var xl={animationend:Fr("Animation","AnimationEnd"),animationiteration:Fr("Animation","AnimationIteration"),animationstart:Fr("Animation","AnimationStart"),transitionrun:Fr("Transition","TransitionRun"),transitionstart:Fr("Transition","TransitionStart"),transitioncancel:Fr("Transition","TransitionCancel"),transitionend:Fr("Transition","TransitionEnd")},$u={},Vf={};Hi&&(Vf=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function fa(e){if($u[e])return $u[e];if(!xl[e])return e;var i=xl[e],f;for(f in i)if(i.hasOwnProperty(f)&&f in Vf)return $u[e]=i[f];return e}var tc=fa("animationend"),Yf=fa("animationiteration"),Hd=fa("animationstart"),Kf=fa("transitionrun"),Ra=fa("transitionstart"),Id=fa("transitioncancel"),xa=fa("transitionend"),Qf=new Map,ki="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ki.push("scrollEnd");function ha(e,i){Qf.set(e,i),fr(i,[e])}var Ei=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ia=[],Jr=0,pi=0;function zo(){for(var e=Jr,i=pi=Jr=0;i<e;){var f=Ia[i];Ia[i++]=null;var h=Ia[i];Ia[i++]=null;var b=Ia[i];Ia[i++]=null;var w=Ia[i];if(Ia[i++]=null,h!==null&&b!==null){var q=h.pending;q===null?b.next=b:(b.next=q.next,q.next=b),h.pending=b}w!==0&&Xf(f,b,w)}}function pr(e,i,f,h){Ia[Jr++]=e,Ia[Jr++]=i,Ia[Jr++]=f,Ia[Jr++]=h,pi|=h,e.lanes|=h,e=e.alternate,e!==null&&(e.lanes|=h)}function Os(e,i,f,h){return pr(e,i,f,h),Lo(e)}function ei(e,i){return pr(e,null,null,i),Lo(e)}function Xf(e,i,f){e.lanes|=f;var h=e.alternate;h!==null&&(h.lanes|=f);for(var b=!1,w=e.return;w!==null;)w.childLanes|=f,h=w.alternate,h!==null&&(h.childLanes|=f),w.tag===22&&(e=w.stateNode,e===null||e._visibility&1||(b=!0)),e=w,w=w.return;return e.tag===3?(w=e.stateNode,b&&i!==null&&(b=31-Se(f),e=w.hiddenUpdates,h=e[b],h===null?e[b]=[i]:h.push(i),i.lane=f|536870912),w):null}function Lo(e){if(50<sl)throw sl=0,ll=null,Error(a(185));for(var i=e.return;i!==null;)e=i,i=e.return;return e.tag===3?e.stateNode:null}var qi={};function kd(e,i,f,h){this.tag=e,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ea(e,i,f,h){return new kd(e,i,f,h)}function ec(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ci(e,i){var f=e.alternate;return f===null?(f=Ea(e.tag,i,e.key,e.mode),f.elementType=e.elementType,f.type=e.type,f.stateNode=e.stateNode,f.alternate=e,e.alternate=f):(f.pendingProps=i,f.type=e.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=e.flags&65011712,f.childLanes=e.childLanes,f.lanes=e.lanes,f.child=e.child,f.memoizedProps=e.memoizedProps,f.memoizedState=e.memoizedState,f.updateQueue=e.updateQueue,i=e.dependencies,f.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},f.sibling=e.sibling,f.index=e.index,f.ref=e.ref,f.refCleanup=e.refCleanup,f}function nc(e,i){e.flags&=65011714;var f=e.alternate;return f===null?(e.childLanes=0,e.lanes=i,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=f.childLanes,e.lanes=f.lanes,e.child=f.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=f.memoizedProps,e.memoizedState=f.memoizedState,e.updateQueue=f.updateQueue,e.type=f.type,i=f.dependencies,e.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),e}function Nl(e,i,f,h,b,w){var q=0;if(h=e,typeof e=="function")ec(e)&&(q=1);else if(typeof e=="string")q=Wb(e,f,Y.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case B:return e=Ea(31,f,i,b),e.elementType=B,e.lanes=w,e;case M:return Zr(f.children,b,w,i);case z:q=8,b|=24;break;case L:return e=Ea(12,f,i,b|2),e.elementType=L,e.lanes=w,e;case R:return e=Ea(13,f,i,b),e.elementType=R,e.lanes=w,e;case A:return e=Ea(19,f,i,b),e.elementType=A,e.lanes=w,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case N:q=10;break t;case D:q=9;break t;case G:q=11;break t;case T:q=14;break t;case y:q=16,h=null;break t}q=29,f=Error(a(130,e===null?"null":typeof e,"")),h=null}return i=Ea(q,f,i,b),i.elementType=e,i.type=h,i.lanes=w,i}function Zr(e,i,f,h){return e=Ea(7,e,h,i),e.lanes=f,e}function Go(e,i,f){return e=Ea(6,e,null,i),e.lanes=f,e}function ka(e){var i=Ea(18,null,null,0);return i.stateNode=e,i}function ac(e,i,f){return i=Ea(4,e.children!==null?e.children:[],e.key,i),i.lanes=f,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}var qa=new WeakMap;function ni(e,i){if(typeof e=="object"&&e!==null){var f=qa.get(e);return f!==void 0?f:(i={value:e,source:i,stack:Ve(i)},qa.set(e,i),i)}return{value:e,source:i,stack:Ve(i)}}var Rs=[],Ml=0,Ti=null,Dl=0,Va=[],da=0,mr=null,Ai=1,wi="";function Vi(e,i){Rs[Ml++]=Dl,Rs[Ml++]=Ti,Ti=e,Dl=i}function ic(e,i,f){Va[da++]=Ai,Va[da++]=wi,Va[da++]=mr,mr=e;var h=Ai;e=wi;var b=32-Se(h)-1;h&=~(1<<b),f+=1;var w=32-Se(i)+b;if(30<w){var q=b-b%5;w=(h&(1<<q)-1).toString(32),h>>=q,b-=q,Ai=1<<32-Se(i)+b|f<<b|h,wi=w+e}else Ai=1<<w|f<<b|h,wi=e}function Po(e){e.return!==null&&(Vi(e,1),ic(e,1,0))}function Ff(e){for(;e===Ti;)Ti=Rs[--Ml],Rs[Ml]=null,Dl=Rs[--Ml],Rs[Ml]=null;for(;e===mr;)mr=Va[--da],Va[da]=null,wi=Va[--da],Va[da]=null,Ai=Va[--da],Va[da]=null}function qd(e,i){Va[da++]=Ai,Va[da++]=wi,Va[da++]=mr,Ai=i.id,wi=i.overflow,mr=e}var ga=null,gn=null,Ge=!1,ai=null,Na=!1,rc=Error(a(519));function vr(e){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw jl(ni(i,e)),rc}function Jf(e){var i=e.stateNode,f=e.type,h=e.memoizedProps;switch(i[ze]=e,i[ln]=h,f){case"dialog":ke("cancel",i),ke("close",i);break;case"iframe":case"object":case"embed":ke("load",i);break;case"video":case"audio":for(f=0;f<Bh.length;f++)ke(Bh[f],i);break;case"source":ke("error",i);break;case"img":case"image":case"link":ke("error",i),ke("load",i);break;case"details":ke("toggle",i);break;case"input":ke("invalid",i),Ef(i,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":ke("invalid",i);break;case"textarea":ke("invalid",i),Af(i,h.value,h.defaultValue,h.children)}f=h.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||i.textContent===""+f||h.suppressHydrationWarning===!0||Ov(i.textContent,f)?(h.popover!=null&&(ke("beforetoggle",i),ke("toggle",i)),h.onScroll!=null&&ke("scroll",i),h.onScrollEnd!=null&&ke("scrollend",i),h.onClick!=null&&(i.onclick=Ha),i=!0):i=!1,i||vr(e,!0)}function Zf(e){for(ga=e.return;ga;)switch(ga.tag){case 5:case 31:case 13:Na=!1;return;case 27:case 3:Na=!0;return;default:ga=ga.return}}function xs(e){if(e!==ga)return!1;if(!Ge)return Zf(e),Ge=!0,!1;var i=e.tag,f;if((f=i!==3&&i!==27)&&((f=i===5)&&(f=e.type,f=!(f!=="form"&&f!=="button")||ep(e.type,e.memoizedProps)),f=!f),f&&gn&&vr(e),Zf(e),i===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));gn=zv(e)}else if(i===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));gn=zv(e)}else i===27?(i=gn,Zl(e.type)?(e=sp,sp=null,gn=e):gn=i):gn=ga?or(e.stateNode.nextSibling):null;return!0}function Wr(){gn=ga=null,Ge=!1}function Ns(){var e=ai;return e!==null&&(vn===null?vn=e:vn.push.apply(vn,e),ai=null),e}function jl(e){ai===null?ai=[e]:ai.push(e)}var sc=Z(null),Ie=null,Oi=null;function $r(e,i,f){at(sc,i._currentValue),i._currentValue=f}function Yi(e){e._currentValue=sc.current,rt(sc)}function Wf(e,i,f){for(;e!==null;){var h=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),e===f)break;e=e.return}}function $f(e,i,f,h){var b=e.child;for(b!==null&&(b.return=e);b!==null;){var w=b.dependencies;if(w!==null){var q=b.child;w=w.firstContext;t:for(;w!==null;){var $=w;w=b;for(var ot=0;ot<i.length;ot++)if($.context===i[ot]){w.lanes|=f,$=w.alternate,$!==null&&($.lanes|=f),Wf(w.return,f,e),h||(q=null);break t}w=$.next}}else if(b.tag===18){if(q=b.return,q===null)throw Error(a(341));q.lanes|=f,w=q.alternate,w!==null&&(w.lanes|=f),Wf(q,f,e),q=null}else q=b.child;if(q!==null)q.return=b;else for(q=b;q!==null;){if(q===e){q=null;break}if(b=q.sibling,b!==null){b.return=q.return,q=b;break}q=q.return}b=q}}function Ul(e,i,f,h){e=null;for(var b=i,w=!1;b!==null;){if(!w){if((b.flags&524288)!==0)w=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var q=b.alternate;if(q===null)throw Error(a(387));if(q=q.memoizedProps,q!==null){var $=b.type;ca(b.pendingProps.value,q.value)||(e!==null?e.push($):e=[$])}}else if(b===et.current){if(q=b.alternate,q===null)throw Error(a(387));q.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(e!==null?e.push(Hh):e=[Hh])}b=b.return}e!==null&&$f(i,e,f,h),i.flags|=262144}function lc(e){for(e=e.firstContext;e!==null;){if(!ca(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function yr(e){Ie=e,Oi=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function bn(e){return Io(Ie,e)}function Ho(e,i){return Ie===null&&yr(e),Io(e,i)}function Io(e,i){var f=i._currentValue;if(i={context:i,memoizedValue:f,next:null},Oi===null){if(e===null)throw Error(a(308));Oi=i,e.dependencies={lanes:0,firstContext:i},e.flags|=524288}else Oi=Oi.next=i;return f}var Ms=typeof AbortController<"u"?AbortController:function(){var e=[],i=this.signal={aborted:!1,addEventListener:function(f,h){e.push(h)}};this.abort=function(){i.aborted=!0,e.forEach(function(f){return f()})}},th=o.unstable_scheduleCallback,eh=o.unstable_NormalPriority,Xn={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function oc(){return{controller:new Ms,data:new Map,refCount:0}}function Bl(e){e.refCount--,e.refCount===0&&th(eh,function(){e.controller.abort()})}var zl=null,uc=0,Ds=0,ts=null;function Le(e,i){if(zl===null){var f=zl=[];uc=0,Ds=Kg(),ts={status:"pending",value:void 0,then:function(h){f.push(h)}}}return uc++,i.then(Vd,Vd),i}function Vd(){if(--uc===0&&zl!==null){ts!==null&&(ts.status="fulfilled");var e=zl;zl=null,Ds=0,ts=null;for(var i=0;i<e.length;i++)(0,e[i])()}}function ii(e,i){var f=[],h={status:"pending",value:null,reason:null,then:function(b){f.push(b)}};return e.then(function(){h.status="fulfilled",h.value=i;for(var b=0;b<f.length;b++)(0,f[b])(i)},function(b){for(h.status="rejected",h.reason=b,b=0;b<f.length;b++)(0,f[b])(void 0)}),h}var cc=U.S;U.S=function(e,i){Lc=me(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&Le(e,i),cc!==null&&cc(e,i)};var js=Z(null);function Ll(){var e=js.current;return e!==null?e:xe.pooledCache}function Sr(e,i){i===null?at(js,js.current):at(js,i.pool)}function Us(){var e=Ll();return e===null?null:{parent:Xn._currentValue,pool:e}}var Bs=Error(a(460)),ko=Error(a(474)),fc=Error(a(542)),qo={then:function(){}};function br(e){return e=e.status,e==="fulfilled"||e==="rejected"}function hc(e,i,f){switch(f=e[f],f===void 0?e.push(i):f!==i&&(i.then(Ha,Ha),i=f),i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,Cr(e),e;default:if(typeof i.status=="string")i.then(Ha,Ha);else{if(e=xe,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=i,e.status="pending",e.then(function(h){if(i.status==="pending"){var b=i;b.status="fulfilled",b.value=h}},function(h){if(i.status==="pending"){var b=i;b.status="rejected",b.reason=h}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,Cr(e),e}throw Er=i,Bs}}function _r(e){try{var i=e._init;return i(e._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Er=f,Bs):f}}var Er=null;function dc(){if(Er===null)throw Error(a(459));var e=Er;return Er=null,e}function Cr(e){if(e===Bs||e===fc)throw Error(a(483))}var es=null,Vo=0;function Yo(e){var i=Vo;return Vo+=1,es===null&&(es=[]),hc(es,e,i)}function Ko(e,i){i=i.props.ref,e.ref=i!==void 0?i:null}function zs(e,i){throw i.$$typeof===E?Error(a(525)):(e=Object.prototype.toString.call(i),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)))}function oe(e){function i(mt,dt){if(e){var yt=mt.deletions;yt===null?(mt.deletions=[dt],mt.flags|=16):yt.push(dt)}}function f(mt,dt){if(!e)return null;for(;dt!==null;)i(mt,dt),dt=dt.sibling;return null}function h(mt){for(var dt=new Map;mt!==null;)mt.key!==null?dt.set(mt.key,mt):dt.set(mt.index,mt),mt=mt.sibling;return dt}function b(mt,dt){return mt=Ci(mt,dt),mt.index=0,mt.sibling=null,mt}function w(mt,dt,yt){return mt.index=yt,e?(yt=mt.alternate,yt!==null?(yt=yt.index,yt<dt?(mt.flags|=67108866,dt):yt):(mt.flags|=67108866,dt)):(mt.flags|=1048576,dt)}function q(mt){return e&&mt.alternate===null&&(mt.flags|=67108866),mt}function $(mt,dt,yt,Nt){return dt===null||dt.tag!==6?(dt=Go(yt,mt.mode,Nt),dt.return=mt,dt):(dt=b(dt,yt),dt.return=mt,dt)}function ot(mt,dt,yt,Nt){var le=yt.type;return le===M?Rt(mt,dt,yt.props.children,Nt,yt.key):dt!==null&&(dt.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===y&&_r(le)===dt.type)?(dt=b(dt,yt.props),Ko(dt,yt),dt.return=mt,dt):(dt=Nl(yt.type,yt.key,yt.props,null,mt.mode,Nt),Ko(dt,yt),dt.return=mt,dt)}function St(mt,dt,yt,Nt){return dt===null||dt.tag!==4||dt.stateNode.containerInfo!==yt.containerInfo||dt.stateNode.implementation!==yt.implementation?(dt=ac(yt,mt.mode,Nt),dt.return=mt,dt):(dt=b(dt,yt.children||[]),dt.return=mt,dt)}function Rt(mt,dt,yt,Nt,le){return dt===null||dt.tag!==7?(dt=Zr(yt,mt.mode,Nt,le),dt.return=mt,dt):(dt=b(dt,yt),dt.return=mt,dt)}function Mt(mt,dt,yt){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return dt=Go(""+dt,mt.mode,yt),dt.return=mt,dt;if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case O:return yt=Nl(dt.type,dt.key,dt.props,null,mt.mode,yt),Ko(yt,dt),yt.return=mt,yt;case v:return dt=ac(dt,mt.mode,yt),dt.return=mt,dt;case y:return dt=_r(dt),Mt(mt,dt,yt)}if(V(dt)||Q(dt))return dt=Zr(dt,mt.mode,yt,null),dt.return=mt,dt;if(typeof dt.then=="function")return Mt(mt,Yo(dt),yt);if(dt.$$typeof===N)return Mt(mt,Ho(mt,dt),yt);zs(mt,dt)}return null}function Et(mt,dt,yt,Nt){var le=dt!==null?dt.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return le!==null?null:$(mt,dt,""+yt,Nt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case O:return yt.key===le?ot(mt,dt,yt,Nt):null;case v:return yt.key===le?St(mt,dt,yt,Nt):null;case y:return yt=_r(yt),Et(mt,dt,yt,Nt)}if(V(yt)||Q(yt))return le!==null?null:Rt(mt,dt,yt,Nt,null);if(typeof yt.then=="function")return Et(mt,dt,Yo(yt),Nt);if(yt.$$typeof===N)return Et(mt,dt,Ho(mt,yt),Nt);zs(mt,yt)}return null}function At(mt,dt,yt,Nt,le){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return mt=mt.get(yt)||null,$(dt,mt,""+Nt,le);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case O:return mt=mt.get(Nt.key===null?yt:Nt.key)||null,ot(dt,mt,Nt,le);case v:return mt=mt.get(Nt.key===null?yt:Nt.key)||null,St(dt,mt,Nt,le);case y:return Nt=_r(Nt),At(mt,dt,yt,Nt,le)}if(V(Nt)||Q(Nt))return mt=mt.get(yt)||null,Rt(dt,mt,Nt,le,null);if(typeof Nt.then=="function")return At(mt,dt,yt,Yo(Nt),le);if(Nt.$$typeof===N)return At(mt,dt,yt,Ho(dt,Nt),le);zs(dt,Nt)}return null}function ee(mt,dt,yt,Nt){for(var le=null,an=null,ie=dt,Me=dt=0,qe=null;ie!==null&&Me<yt.length;Me++){ie.index>Me?(qe=ie,ie=null):qe=ie.sibling;var rn=Et(mt,ie,yt[Me],Nt);if(rn===null){ie===null&&(ie=qe);break}e&&ie&&rn.alternate===null&&i(mt,ie),dt=w(rn,dt,Me),an===null?le=rn:an.sibling=rn,an=rn,ie=qe}if(Me===yt.length)return f(mt,ie),Ge&&Vi(mt,Me),le;if(ie===null){for(;Me<yt.length;Me++)ie=Mt(mt,yt[Me],Nt),ie!==null&&(dt=w(ie,dt,Me),an===null?le=ie:an.sibling=ie,an=ie);return Ge&&Vi(mt,Me),le}for(ie=h(ie);Me<yt.length;Me++)qe=At(ie,mt,Me,yt[Me],Nt),qe!==null&&(e&&qe.alternate!==null&&ie.delete(qe.key===null?Me:qe.key),dt=w(qe,dt,Me),an===null?le=qe:an.sibling=qe,an=qe);return e&&ie.forEach(function(no){return i(mt,no)}),Ge&&Vi(mt,Me),le}function de(mt,dt,yt,Nt){if(yt==null)throw Error(a(151));for(var le=null,an=null,ie=dt,Me=dt=0,qe=null,rn=yt.next();ie!==null&&!rn.done;Me++,rn=yt.next()){ie.index>Me?(qe=ie,ie=null):qe=ie.sibling;var no=Et(mt,ie,rn.value,Nt);if(no===null){ie===null&&(ie=qe);break}e&&ie&&no.alternate===null&&i(mt,ie),dt=w(no,dt,Me),an===null?le=no:an.sibling=no,an=no,ie=qe}if(rn.done)return f(mt,ie),Ge&&Vi(mt,Me),le;if(ie===null){for(;!rn.done;Me++,rn=yt.next())rn=Mt(mt,rn.value,Nt),rn!==null&&(dt=w(rn,dt,Me),an===null?le=rn:an.sibling=rn,an=rn);return Ge&&Vi(mt,Me),le}for(ie=h(ie);!rn.done;Me++,rn=yt.next())rn=At(ie,mt,Me,rn.value,Nt),rn!==null&&(e&&rn.alternate!==null&&ie.delete(rn.key===null?Me:rn.key),dt=w(rn,dt,Me),an===null?le=rn:an.sibling=rn,an=rn);return e&&ie.forEach(function(u4){return i(mt,u4)}),Ge&&Vi(mt,Me),le}function Sn(mt,dt,yt,Nt){if(typeof yt=="object"&&yt!==null&&yt.type===M&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case O:t:{for(var le=yt.key;dt!==null;){if(dt.key===le){if(le=yt.type,le===M){if(dt.tag===7){f(mt,dt.sibling),Nt=b(dt,yt.props.children),Nt.return=mt,mt=Nt;break t}}else if(dt.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===y&&_r(le)===dt.type){f(mt,dt.sibling),Nt=b(dt,yt.props),Ko(Nt,yt),Nt.return=mt,mt=Nt;break t}f(mt,dt);break}else i(mt,dt);dt=dt.sibling}yt.type===M?(Nt=Zr(yt.props.children,mt.mode,Nt,yt.key),Nt.return=mt,mt=Nt):(Nt=Nl(yt.type,yt.key,yt.props,null,mt.mode,Nt),Ko(Nt,yt),Nt.return=mt,mt=Nt)}return q(mt);case v:t:{for(le=yt.key;dt!==null;){if(dt.key===le)if(dt.tag===4&&dt.stateNode.containerInfo===yt.containerInfo&&dt.stateNode.implementation===yt.implementation){f(mt,dt.sibling),Nt=b(dt,yt.children||[]),Nt.return=mt,mt=Nt;break t}else{f(mt,dt);break}else i(mt,dt);dt=dt.sibling}Nt=ac(yt,mt.mode,Nt),Nt.return=mt,mt=Nt}return q(mt);case y:return yt=_r(yt),Sn(mt,dt,yt,Nt)}if(V(yt))return ee(mt,dt,yt,Nt);if(Q(yt)){if(le=Q(yt),typeof le!="function")throw Error(a(150));return yt=le.call(yt),de(mt,dt,yt,Nt)}if(typeof yt.then=="function")return Sn(mt,dt,Yo(yt),Nt);if(yt.$$typeof===N)return Sn(mt,dt,Ho(mt,yt),Nt);zs(mt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint"?(yt=""+yt,dt!==null&&dt.tag===6?(f(mt,dt.sibling),Nt=b(dt,yt),Nt.return=mt,mt=Nt):(f(mt,dt),Nt=Go(yt,mt.mode,Nt),Nt.return=mt,mt=Nt),q(mt)):f(mt,dt)}return function(mt,dt,yt,Nt){try{Vo=0;var le=Sn(mt,dt,yt,Nt);return es=null,le}catch(ie){if(ie===Bs||ie===fc)throw ie;var an=Ea(29,ie,null,mt.mode);return an.lanes=Nt,an.return=mt,an}finally{}}}var Ls=oe(!0),Yd=oe(!1),Tr=!1;function Gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nh(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ns(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function as(e,i,f){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,(ce&2)!==0){var b=h.pending;return b===null?i.next=i:(i.next=b.next,b.next=i),h.pending=i,i=Lo(e),Xf(e,null,f),i}return pr(e,h,i,f),Lo(e)}function Qo(e,i,f){if(i=i.updateQueue,i!==null&&(i=i.shared,(f&4194048)!==0)){var h=i.lanes;h&=e.pendingLanes,f|=h,i.lanes=f,qt(e,f)}}function ah(e,i){var f=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,f===h)){var b=null,w=null;if(f=f.firstBaseUpdate,f!==null){do{var q={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};w===null?b=w=q:w=w.next=q,f=f.next}while(f!==null);w===null?b=w=i:w=w.next=i}else b=w=i;f={baseState:h.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},e.updateQueue=f;return}e=f.lastBaseUpdate,e===null?f.firstBaseUpdate=i:e.next=i,f.lastBaseUpdate=i}var Xo=!1;function Gl(){if(Xo){var e=ts;if(e!==null)throw e}}function is(e,i,f,h){Xo=!1;var b=e.updateQueue;Tr=!1;var w=b.firstBaseUpdate,q=b.lastBaseUpdate,$=b.shared.pending;if($!==null){b.shared.pending=null;var ot=$,St=ot.next;ot.next=null,q===null?w=St:q.next=St,q=ot;var Rt=e.alternate;Rt!==null&&(Rt=Rt.updateQueue,$=Rt.lastBaseUpdate,$!==q&&($===null?Rt.firstBaseUpdate=St:$.next=St,Rt.lastBaseUpdate=ot))}if(w!==null){var Mt=b.baseState;q=0,Rt=St=ot=null,$=w;do{var Et=$.lane&-536870913,At=Et!==$.lane;if(At?(Oe&Et)===Et:(h&Et)===Et){Et!==0&&Et===Ds&&(Xo=!0),Rt!==null&&(Rt=Rt.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});t:{var ee=e,de=$;Et=i;var Sn=f;switch(de.tag){case 1:if(ee=de.payload,typeof ee=="function"){Mt=ee.call(Sn,Mt,Et);break t}Mt=ee;break t;case 3:ee.flags=ee.flags&-65537|128;case 0:if(ee=de.payload,Et=typeof ee=="function"?ee.call(Sn,Mt,Et):ee,Et==null)break t;Mt=C({},Mt,Et);break t;case 2:Tr=!0}}Et=$.callback,Et!==null&&(e.flags|=64,At&&(e.flags|=8192),At=b.callbacks,At===null?b.callbacks=[Et]:At.push(Et))}else At={lane:Et,tag:$.tag,payload:$.payload,callback:$.callback,next:null},Rt===null?(St=Rt=At,ot=Mt):Rt=Rt.next=At,q|=Et;if($=$.next,$===null){if($=b.shared.pending,$===null)break;At=$,$=At.next,At.next=null,b.lastBaseUpdate=At,b.shared.pending=null}}while(!0);Rt===null&&(ot=Mt),b.baseState=ot,b.firstBaseUpdate=St,b.lastBaseUpdate=Rt,w===null&&(b.shared.lanes=0),hs|=q,e.lanes=q,e.memoizedState=Mt}}function ih(e,i){if(typeof e!="function")throw Error(a(191,e));e.call(i)}function Kd(e,i){var f=e.callbacks;if(f!==null)for(e.callbacks=null,e=0;e<f.length;e++)ih(f[e],i)}var Pl=Z(null),Ki=Z(0);function Qi(e,i){e=Si,at(Ki,e),at(Pl,i),Si=e|i.baseLanes}function na(){at(Ki,Si),at(Pl,Pl.current)}function Xi(){Si=Ki.current,rt(Pl),rt(Ki)}var On=Z(null),mi=null;function rs(e){var i=e.alternate;at(Gn,Gn.current&1),at(On,e),mi===null&&(i===null||Pl.current!==null||i.memoizedState!==null)&&(mi=e)}function Fn(e){at(Gn,Gn.current),at(On,e),mi===null&&(mi=e)}function Fi(e){e.tag===22?(at(Gn,Gn.current),at(On,e),mi===null&&(mi=e)):ss()}function ss(){at(Gn,Gn.current),at(On,On.current)}function ri(e){rt(On),mi===e&&(mi=null),rt(Gn)}var Gn=Z(0);function gc(e){for(var i=e;i!==null;){if(i.tag===13){var f=i.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||ip(f)||rp(f)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ji=0,Ce=null,on=null,Jn=null,Ar=!1,vi=!1,Ps=!1,pc=0,Fo=0,Zi=null,Gg=0;function zn(){throw Error(a(321))}function rh(e,i){if(i===null)return!1;for(var f=0;f<i.length&&f<e.length;f++)if(!ca(e[f],i[f]))return!1;return!0}function Hs(e,i,f,h,b,w){return Ji=w,Ce=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,U.H=e===null||e.memoizedState===null?Is:$o,Ps=!1,w=f(h,b),Ps=!1,vi&&(w=Xd(i,f,h,b)),Qd(e),w}function Qd(e){U.H=Il;var i=on!==null&&on.next!==null;if(Ji=0,Jn=on=Ce=null,Ar=!1,Fo=0,Zi=null,i)throw Error(a(300));e===null||Zn||(e=e.dependencies,e!==null&&lc(e)&&(Zn=!0))}function Xd(e,i,f,h){Ce=e;var b=0;do{if(vi&&(Zi=null),Fo=0,vi=!1,25<=b)throw Error(a(301));if(b+=1,Jn=on=null,e.updateQueue!=null){var w=e.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}U.H=ks,w=i(f,h)}while(vi);return w}function Pg(){var e=U.H,i=e.useState()[0];return i=typeof i.then=="function"?Jo(i):i,e=e.useState()[0],(on!==null?on.memoizedState:null)!==e&&(Ce.flags|=1024),i}function sh(){var e=pc!==0;return pc=0,e}function lh(e,i,f){i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~f}function oh(e){if(Ar){for(e=e.memoizedState;e!==null;){var i=e.queue;i!==null&&(i.pending=null),e=e.next}Ar=!1}Ji=0,Jn=on=Ce=null,vi=!1,Fo=pc=0,Zi=null}function Ma(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?Ce.memoizedState=Jn=e:Jn=Jn.next=e,Jn}function Pn(){if(on===null){var e=Ce.alternate;e=e!==null?e.memoizedState:null}else e=on.next;var i=Jn===null?Ce.memoizedState:Jn.next;if(i!==null)Jn=i,on=e;else{if(e===null)throw Ce.alternate===null?Error(a(467)):Error(a(310));on=e,e={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},Jn===null?Ce.memoizedState=Jn=e:Jn=Jn.next=e}return Jn}function mc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Jo(e){var i=Fo;return Fo+=1,Zi===null&&(Zi=[]),e=hc(Zi,e,i),i=Ce,(Jn===null?i.memoizedState:Jn.next)===null&&(i=i.alternate,U.H=i===null||i.memoizedState===null?Is:$o),e}function vc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Jo(e);if(e.$$typeof===N)return bn(e)}throw Error(a(438,String(e)))}function uh(e){var i=null,f=Ce.updateQueue;if(f!==null&&(i=f.memoCache),i==null){var h=Ce.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(i={data:h.data.map(function(b){return b.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),f===null&&(f=mc(),Ce.updateQueue=f),f.memoCache=i,f=i.data[i.index],f===void 0)for(f=i.data[i.index]=Array(e),h=0;h<e;h++)f[h]=j;return i.index++,f}function Wi(e,i){return typeof i=="function"?i(e):i}function yc(e){var i=Pn();return ch(i,on,e)}function ch(e,i,f){var h=e.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=f;var b=e.baseQueue,w=h.pending;if(w!==null){if(b!==null){var q=b.next;b.next=w.next,w.next=q}i.baseQueue=b=w,h.pending=null}if(w=e.baseState,b===null)e.memoizedState=w;else{i=b.next;var $=q=null,ot=null,St=i,Rt=!1;do{var Mt=St.lane&-536870913;if(Mt!==St.lane?(Oe&Mt)===Mt:(Ji&Mt)===Mt){var Et=St.revertLane;if(Et===0)ot!==null&&(ot=ot.next={lane:0,revertLane:0,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),Mt===Ds&&(Rt=!0);else if((Ji&Et)===Et){St=St.next,Et===Ds&&(Rt=!0);continue}else Mt={lane:0,revertLane:St.revertLane,gesture:null,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ot===null?($=ot=Mt,q=w):ot=ot.next=Mt,Ce.lanes|=Et,hs|=Et;Mt=St.action,Ps&&f(w,Mt),w=St.hasEagerState?St.eagerState:f(w,Mt)}else Et={lane:Mt,revertLane:St.revertLane,gesture:St.gesture,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},ot===null?($=ot=Et,q=w):ot=ot.next=Et,Ce.lanes|=Mt,hs|=Mt;St=St.next}while(St!==null&&St!==i);if(ot===null?q=w:ot.next=$,!ca(w,e.memoizedState)&&(Zn=!0,Rt&&(f=ts,f!==null)))throw f;e.memoizedState=w,e.baseState=q,e.baseQueue=ot,h.lastRenderedState=w}return b===null&&(h.lanes=0),[e.memoizedState,h.dispatch]}function fh(e){var i=Pn(),f=i.queue;if(f===null)throw Error(a(311));f.lastRenderedReducer=e;var h=f.dispatch,b=f.pending,w=i.memoizedState;if(b!==null){f.pending=null;var q=b=b.next;do w=e(w,q.action),q=q.next;while(q!==b);ca(w,i.memoizedState)||(Zn=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),f.lastRenderedState=w}return[w,h]}function Fd(e,i,f){var h=Ce,b=Pn(),w=Ge;if(w){if(f===void 0)throw Error(a(407));f=f()}else f=i();var q=!ca((on||b).memoizedState,f);if(q&&(b.memoizedState=f,Zn=!0),b=b.queue,vh(hh.bind(null,h,b,e),[e]),b.getSnapshot!==i||q||Jn!==null&&Jn.memoizedState.tag&1){if(h.flags|=2048,Hl(9,{destroy:void 0},Zd.bind(null,h,b,f,i),null),xe===null)throw Error(a(349));w||(Ji&127)!==0||Jd(h,i,f)}return f}function Jd(e,i,f){e.flags|=16384,e={getSnapshot:i,value:f},i=Ce.updateQueue,i===null?(i=mc(),Ce.updateQueue=i,i.stores=[e]):(f=i.stores,f===null?i.stores=[e]:f.push(e))}function Zd(e,i,f,h){i.value=f,i.getSnapshot=h,dh(i)&&Wd(e)}function hh(e,i,f){return f(function(){dh(i)&&Wd(e)})}function dh(e){var i=e.getSnapshot;e=e.value;try{var f=i();return!ca(e,f)}catch{return!0}}function Wd(e){var i=ei(e,2);i!==null&&nn(i,e,2)}function Sc(e){var i=Ma();if(typeof e=="function"){var f=e;if(e=f(),Ps){Bt(!0);try{f()}finally{Bt(!1)}}}return i.memoizedState=i.baseState=e,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:e},i}function gh(e,i,f,h){return e.baseState=f,ch(e,on,typeof h=="function"?h:Wi)}function $d(e,i,f,h,b){if(Wo(e))throw Error(a(485));if(e=i.action,e!==null){var w={payload:b,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){w.listeners.push(q)}};U.T!==null?f(!0):w.isTransition=!1,h(w),f=i.pending,f===null?(w.next=i.pending=w,bc(i,w)):(w.next=f.next,i.pending=f.next=w)}}function bc(e,i){var f=i.action,h=i.payload,b=e.state;if(i.isTransition){var w=U.T,q={};U.T=q;try{var $=f(b,h),ot=U.S;ot!==null&&ot(q,$),_c(e,i,$)}catch(St){ph(e,i,St)}finally{w!==null&&q.types!==null&&(w.types=q.types),U.T=w}}else try{w=f(b,h),_c(e,i,w)}catch(St){ph(e,i,St)}}function _c(e,i,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(h){t0(e,i,h)},function(h){return ph(e,i,h)}):t0(e,i,f)}function t0(e,i,f){i.status="fulfilled",i.value=f,e0(i),e.state=f,i=e.pending,i!==null&&(f=i.next,f===i?e.pending=null:(f=f.next,i.next=f,bc(e,f)))}function ph(e,i,f){var h=e.pending;if(e.pending=null,h!==null){h=h.next;do i.status="rejected",i.reason=f,e0(i),i=i.next;while(i!==h)}e.action=null}function e0(e){e=e.listeners;for(var i=0;i<e.length;i++)(0,e[i])()}function n0(e,i){return i}function mh(e,i){if(Ge){var f=xe.formState;if(f!==null){t:{var h=Ce;if(Ge){if(gn){e:{for(var b=gn,w=Na;b.nodeType!==8;){if(!w){b=null;break e}if(b=or(b.nextSibling),b===null){b=null;break e}}w=b.data,b=w==="F!"||w==="F"?b:null}if(b){gn=or(b.nextSibling),h=b.data==="F!";break t}}vr(h)}h=!1}h&&(i=f[0])}}return f=Ma(),f.memoizedState=f.baseState=i,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n0,lastRenderedState:i},f.queue=h,f=_h.bind(null,Ce,h),h.dispatch=f,h=Sc(!1),w=Hn.bind(null,Ce,!1,h.queue),h=Ma(),b={state:i,dispatch:null,action:e,pending:null},h.queue=b,f=$d.bind(null,Ce,b,w,f),b.dispatch=f,h.memoizedState=e,[i,f,!1]}function a0(e){var i=Pn();return i0(i,on,e)}function i0(e,i,f){if(i=ch(e,i,n0)[0],e=yc(Wi)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var h=Jo(i)}catch(q){throw q===Bs?fc:q}else h=i;i=Pn();var b=i.queue,w=b.dispatch;return f!==i.memoizedState&&(Ce.flags|=2048,Hl(9,{destroy:void 0},Hg.bind(null,b,f),null)),[h,w,e]}function Hg(e,i){e.action=i}function r0(e){var i=Pn(),f=on;if(f!==null)return i0(i,f,e);Pn(),i=i.memoizedState,f=Pn();var h=f.queue.dispatch;return f.memoizedState=e,[i,h,!1]}function Hl(e,i,f,h){return e={tag:e,create:f,deps:h,inst:i,next:null},i=Ce.updateQueue,i===null&&(i=mc(),Ce.updateQueue=i),f=i.lastEffect,f===null?i.lastEffect=e.next=e:(h=f.next,f.next=e,e.next=h,i.lastEffect=e),e}function s0(){return Pn().memoizedState}function Ec(e,i,f,h){var b=Ma();Ce.flags|=e,b.memoizedState=Hl(1|i,{destroy:void 0},f,h===void 0?null:h)}function Cc(e,i,f,h){var b=Pn();h=h===void 0?null:h;var w=b.memoizedState.inst;on!==null&&h!==null&&rh(h,on.memoizedState.deps)?b.memoizedState=Hl(i,w,f,h):(Ce.flags|=e,b.memoizedState=Hl(1|i,w,f,h))}function l0(e,i){Ec(8390656,8,e,i)}function vh(e,i){Cc(2048,8,e,i)}function Ig(e){Ce.flags|=4;var i=Ce.updateQueue;if(i===null)i=mc(),Ce.updateQueue=i,i.events=[e];else{var f=i.events;f===null?i.events=[e]:f.push(e)}}function o0(e){var i=Pn().memoizedState;return Ig({ref:i,nextImpl:e}),function(){if((ce&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function u0(e,i){return Cc(4,2,e,i)}function c0(e,i){return Cc(4,4,e,i)}function f0(e,i){if(typeof i=="function"){e=e();var f=i(e);return function(){typeof f=="function"?f():i(null)}}if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function h0(e,i,f){f=f!=null?f.concat([e]):null,Cc(4,4,f0.bind(null,i,e),f)}function Tc(){}function d0(e,i){var f=Pn();i=i===void 0?null:i;var h=f.memoizedState;return i!==null&&rh(i,h[1])?h[0]:(f.memoizedState=[e,i],e)}function g0(e,i){var f=Pn();i=i===void 0?null:i;var h=f.memoizedState;if(i!==null&&rh(i,h[1]))return h[0];if(h=e(),Ps){Bt(!0);try{e()}finally{Bt(!1)}}return f.memoizedState=[h,i],h}function si(e,i,f){return f===void 0||(Ji&1073741824)!==0&&(Oe&261930)===0?e.memoizedState=i:(e.memoizedState=f,e=Dr(),Ce.lanes|=e,hs|=e,f)}function yh(e,i,f,h){return ca(f,i)?f:Pl.current!==null?(e=si(e,f,h),ca(e,i)||(Zn=!0),e):(Ji&42)===0||(Ji&1073741824)!==0&&(Oe&261930)===0?(Zn=!0,e.memoizedState=f):(e=Dr(),Ce.lanes|=e,hs|=e,i)}function Ac(e,i,f,h,b){var w=I.p;I.p=w!==0&&8>w?w:8;var q=U.T,$={};U.T=$,Hn(e,!1,i,f);try{var ot=b(),St=U.S;if(St!==null&&St($,ot),ot!==null&&typeof ot=="object"&&typeof ot.then=="function"){var Rt=ii(ot,h);Zo(e,i,Rt,wa(e))}else Zo(e,i,h,wa(e))}catch(Mt){Zo(e,i,{then:function(){},status:"rejected",reason:Mt},wa())}finally{I.p=w,q!==null&&$.types!==null&&(q.types=$.types),U.T=q}}function p0(){}function wc(e,i,f,h){if(e.tag!==5)throw Error(a(476));var b=Sh(e).queue;Ac(e,b,i,F,f===null?p0:function(){return m0(e),f(h)})}function Sh(e){var i=e.memoizedState;if(i!==null)return i;i={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:F},next:null};var f={};return i.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:f},next:null},e.memoizedState=i,e=e.alternate,e!==null&&(e.memoizedState=i),i}function m0(e){var i=Sh(e);i.next===null&&(i=e.alternate.memoizedState),Zo(e,i.next.queue,{},wa())}function Oc(){return bn(Hh)}function bh(){return Pn().memoizedState}function v0(){return Pn().memoizedState}function kg(e){for(var i=e.return;i!==null;){switch(i.tag){case 24:case 3:var f=wa();e=ns(f);var h=as(i,e,f);h!==null&&(nn(h,i,f),Qo(h,i,f)),i={cache:oc()},e.payload=i;return}i=i.return}}function qg(e,i,f){var h=wa();f={lane:h,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Wo(e)?y0(i,f):(f=Os(e,i,f,h),f!==null&&(nn(f,e,h),Eh(f,i,h)))}function _h(e,i,f){var h=wa();Zo(e,i,f,h)}function Zo(e,i,f,h){var b={lane:h,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Wo(e))y0(i,b);else{var w=e.alternate;if(e.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var q=i.lastRenderedState,$=w(q,f);if(b.hasEagerState=!0,b.eagerState=$,ca($,q))return pr(e,i,b,0),xe===null&&zo(),!1}catch{}finally{}if(f=Os(e,i,b,h),f!==null)return nn(f,e,h),Eh(f,i,h),!0}return!1}function Hn(e,i,f,h){if(h={lane:2,revertLane:Kg(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Wo(e)){if(i)throw Error(a(479))}else i=Os(e,f,h,2),i!==null&&nn(i,e,2)}function Wo(e){var i=e.alternate;return e===Ce||i!==null&&i===Ce}function y0(e,i){vi=Ar=!0;var f=e.pending;f===null?i.next=i:(i.next=f.next,f.next=i),e.pending=i}function Eh(e,i,f){if((f&4194048)!==0){var h=i.lanes;h&=e.pendingLanes,f|=h,i.lanes=f,qt(e,f)}}var Il={readContext:bn,use:vc,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useLayoutEffect:zn,useInsertionEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useSyncExternalStore:zn,useId:zn,useHostTransitionStatus:zn,useFormState:zn,useActionState:zn,useOptimistic:zn,useMemoCache:zn,useCacheRefresh:zn};Il.useEffectEvent=zn;var Is={readContext:bn,use:vc,useCallback:function(e,i){return Ma().memoizedState=[e,i===void 0?null:i],e},useContext:bn,useEffect:l0,useImperativeHandle:function(e,i,f){f=f!=null?f.concat([e]):null,Ec(4194308,4,f0.bind(null,i,e),f)},useLayoutEffect:function(e,i){return Ec(4194308,4,e,i)},useInsertionEffect:function(e,i){Ec(4,2,e,i)},useMemo:function(e,i){var f=Ma();i=i===void 0?null:i;var h=e();if(Ps){Bt(!0);try{e()}finally{Bt(!1)}}return f.memoizedState=[h,i],h},useReducer:function(e,i,f){var h=Ma();if(f!==void 0){var b=f(i);if(Ps){Bt(!0);try{f(i)}finally{Bt(!1)}}}else b=i;return h.memoizedState=h.baseState=b,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:b},h.queue=e,e=e.dispatch=qg.bind(null,Ce,e),[h.memoizedState,e]},useRef:function(e){var i=Ma();return e={current:e},i.memoizedState=e},useState:function(e){e=Sc(e);var i=e.queue,f=_h.bind(null,Ce,i);return i.dispatch=f,[e.memoizedState,f]},useDebugValue:Tc,useDeferredValue:function(e,i){var f=Ma();return si(f,e,i)},useTransition:function(){var e=Sc(!1);return e=Ac.bind(null,Ce,e.queue,!0,!1),Ma().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,i,f){var h=Ce,b=Ma();if(Ge){if(f===void 0)throw Error(a(407));f=f()}else{if(f=i(),xe===null)throw Error(a(349));(Oe&127)!==0||Jd(h,i,f)}b.memoizedState=f;var w={value:f,getSnapshot:i};return b.queue=w,l0(hh.bind(null,h,w,e),[e]),h.flags|=2048,Hl(9,{destroy:void 0},Zd.bind(null,h,w,f,i),null),f},useId:function(){var e=Ma(),i=xe.identifierPrefix;if(Ge){var f=wi,h=Ai;f=(h&~(1<<32-Se(h)-1)).toString(32)+f,i="_"+i+"R_"+f,f=pc++,0<f&&(i+="H"+f.toString(32)),i+="_"}else f=Gg++,i="_"+i+"r_"+f.toString(32)+"_";return e.memoizedState=i},useHostTransitionStatus:Oc,useFormState:mh,useActionState:mh,useOptimistic:function(e){var i=Ma();i.memoizedState=i.baseState=e;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=f,i=Hn.bind(null,Ce,!0,f),f.dispatch=i,[e,i]},useMemoCache:uh,useCacheRefresh:function(){return Ma().memoizedState=kg.bind(null,Ce)},useEffectEvent:function(e){var i=Ma(),f={impl:e};return i.memoizedState=f,function(){if((ce&2)!==0)throw Error(a(440));return f.impl.apply(void 0,arguments)}}},$o={readContext:bn,use:vc,useCallback:d0,useContext:bn,useEffect:vh,useImperativeHandle:h0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:g0,useReducer:yc,useRef:s0,useState:function(){return yc(Wi)},useDebugValue:Tc,useDeferredValue:function(e,i){var f=Pn();return yh(f,on.memoizedState,e,i)},useTransition:function(){var e=yc(Wi)[0],i=Pn().memoizedState;return[typeof e=="boolean"?e:Jo(e),i]},useSyncExternalStore:Fd,useId:bh,useHostTransitionStatus:Oc,useFormState:a0,useActionState:a0,useOptimistic:function(e,i){var f=Pn();return gh(f,on,e,i)},useMemoCache:uh,useCacheRefresh:v0};$o.useEffectEvent=o0;var ks={readContext:bn,use:vc,useCallback:d0,useContext:bn,useEffect:vh,useImperativeHandle:h0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:g0,useReducer:fh,useRef:s0,useState:function(){return fh(Wi)},useDebugValue:Tc,useDeferredValue:function(e,i){var f=Pn();return on===null?si(f,e,i):yh(f,on.memoizedState,e,i)},useTransition:function(){var e=fh(Wi)[0],i=Pn().memoizedState;return[typeof e=="boolean"?e:Jo(e),i]},useSyncExternalStore:Fd,useId:bh,useHostTransitionStatus:Oc,useFormState:r0,useActionState:r0,useOptimistic:function(e,i){var f=Pn();return on!==null?gh(f,on,e,i):(f.baseState=e,[e,f.queue.dispatch])},useMemoCache:uh,useCacheRefresh:v0};ks.useEffectEvent=o0;function ls(e,i,f,h){i=e.memoizedState,f=f(h,i),f=f==null?i:C({},i,f),e.memoizedState=f,e.lanes===0&&(e.updateQueue.baseState=f)}var Da={enqueueSetState:function(e,i,f){e=e._reactInternals;var h=wa(),b=ns(h);b.payload=i,f!=null&&(b.callback=f),i=as(e,b,h),i!==null&&(nn(i,e,h),Qo(i,e,h))},enqueueReplaceState:function(e,i,f){e=e._reactInternals;var h=wa(),b=ns(h);b.tag=1,b.payload=i,f!=null&&(b.callback=f),i=as(e,b,h),i!==null&&(nn(i,e,h),Qo(i,e,h))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var f=wa(),h=ns(f);h.tag=2,i!=null&&(h.callback=i),i=as(e,h,f),i!==null&&(nn(i,e,f),Qo(i,e,f))}};function S0(e,i,f,h,b,w,q){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,w,q):i.prototype&&i.prototype.isPureReactComponent?!gi(f,h)||!gi(b,w):!0}function b0(e,i,f,h){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(f,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(f,h),i.state!==e&&Da.enqueueReplaceState(i,i.state,null)}function $i(e,i){var f=i;if("ref"in i){f={};for(var h in i)h!=="ref"&&(f[h]=i[h])}if(e=e.defaultProps){f===i&&(f=C({},f));for(var b in e)f[b]===void 0&&(f[b]=e[b])}return f}function tu(e){Ei(e)}function eu(e){console.error(e)}function Rc(e){Ei(e)}function xc(e,i){try{var f=e.onUncaughtError;f(i.value,{componentStack:i.stack})}catch(h){setTimeout(function(){throw h})}}function _0(e,i,f){try{var h=e.onCaughtError;h(f.value,{componentStack:f.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function li(e,i,f){return f=ns(f),f.tag=3,f.payload={element:null},f.callback=function(){xc(e,i)},f}function Ch(e){return e=ns(e),e.tag=3,e}function E0(e,i,f,h){var b=f.type.getDerivedStateFromError;if(typeof b=="function"){var w=h.value;e.payload=function(){return b(w)},e.callback=function(){_0(i,f,h)}}var q=f.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(e.callback=function(){_0(i,f,h),typeof b!="function"&&(za===null?za=new Set([this]):za.add(this));var $=h.stack;this.componentDidCatch(h.value,{componentStack:$!==null?$:""})})}function Th(e,i,f,h,b){if(f.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(i=f.alternate,i!==null&&Ul(i,f,b,!0),f=On.current,f!==null){switch(f.tag){case 31:case 13:return mi===null?S():f.alternate===null&&mn===0&&(mn=3),f.flags&=-257,f.flags|=65536,f.lanes=b,h===qo?f.flags|=16384:(i=f.updateQueue,i===null?f.updateQueue=new Set([h]):i.add(h),dn(e,h,b)),!1;case 22:return f.flags|=65536,h===qo?f.flags|=16384:(i=f.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([h])},f.updateQueue=i):(f=i.retryQueue,f===null?i.retryQueue=new Set([h]):f.add(h)),dn(e,h,b)),!1}throw Error(a(435,f.tag))}return dn(e,h,b),S(),!1}if(Ge)return i=On.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=b,h!==rc&&(e=Error(a(422),{cause:h}),jl(ni(e,f)))):(h!==rc&&(i=Error(a(423),{cause:h}),jl(ni(i,f))),e=e.current.alternate,e.flags|=65536,b&=-b,e.lanes|=b,h=ni(h,f),b=li(e.stateNode,h,b),ah(e,b),mn!==4&&(mn=2)),!1;var w=Error(a(520),{cause:h});if(w=ni(w,f),Ke===null?Ke=[w]:Ke.push(w),mn!==4&&(mn=2),i===null)return!0;h=ni(h,f),f=i;do{switch(f.tag){case 3:return f.flags|=65536,e=b&-b,f.lanes|=e,e=li(f.stateNode,h,e),ah(f,e),!1;case 1:if(i=f.type,w=f.stateNode,(f.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(za===null||!za.has(w))))return f.flags|=65536,b&=-b,f.lanes|=b,b=Ch(b),E0(b,e,f,h),ah(f,b),!1}f=f.return}while(f!==null);return!1}var Ah=Error(a(461)),Zn=!1;function pa(e,i,f,h){i.child=e===null?Yd(i,null,f,h):Ls(i,e.child,f,h)}function kl(e,i,f,h,b){f=f.render;var w=i.ref;if("ref"in h){var q={};for(var $ in h)$!=="ref"&&(q[$]=h[$])}else q=h;return yr(i),h=Hs(e,i,f,q,w,b),$=sh(),e!==null&&!Zn?(lh(e,i,b),Ni(e,i,b)):(Ge&&$&&Po(i),i.flags|=1,pa(e,i,h,b),i.child)}function Ya(e,i,f,h,b){if(e===null){var w=f.type;return typeof w=="function"&&!ec(w)&&w.defaultProps===void 0&&f.compare===null?(i.tag=15,i.type=w,Nc(e,i,w,h,b)):(e=Nl(f.type,null,h,i,i.mode,b),e.ref=i.ref,e.return=i,i.child=e)}if(w=e.child,!ja(e,b)){var q=w.memoizedProps;if(f=f.compare,f=f!==null?f:gi,f(q,h)&&e.ref===i.ref)return Ni(e,i,b)}return i.flags|=1,e=Ci(w,h),e.ref=i.ref,e.return=i,i.child=e}function Nc(e,i,f,h,b){if(e!==null){var w=e.memoizedProps;if(gi(w,h)&&e.ref===i.ref)if(Zn=!1,i.pendingProps=h=w,ja(e,b))(e.flags&131072)!==0&&(Zn=!0);else return i.lanes=e.lanes,Ni(e,i,b)}return Ka(e,i,f,h,b)}function wh(e,i,f,h){var b=h.children,w=e!==null?e.memoizedState:null;if(e===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((i.flags&128)!==0){if(w=w!==null?w.baseLanes|f:f,e!==null){for(h=i.child=e.child,b=0;h!==null;)b=b|h.lanes|h.childLanes,h=h.sibling;h=b&~w}else h=0,i.child=null;return Oh(e,i,w,f,h)}if((f&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},e!==null&&Sr(i,w!==null?w.cachePool:null),w!==null?Qi(i,w):na(),Fi(i);else return h=i.lanes=536870912,Oh(e,i,w!==null?w.baseLanes|f:f,f,h)}else w!==null?(Sr(i,w.cachePool),Qi(i,w),ss(),i.memoizedState=null):(e!==null&&Sr(i,null),na(),ss());return pa(e,i,b,f),i.child}function qs(e,i){return e!==null&&e.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Oh(e,i,f,h,b){var w=Ll();return w=w===null?null:{parent:Xn._currentValue,pool:w},i.memoizedState={baseLanes:f,cachePool:w},e!==null&&Sr(i,null),na(),Fi(i),e!==null&&Ul(e,i,h,!0),i.childLanes=b,null}function wr(e,i){return i=aa({mode:i.mode,children:i.children},e.mode),i.ref=e.ref,e.child=i,i.return=e,i}function Vs(e,i,f){return Ls(i,e.child,null,f),e=wr(i,i.pendingProps),e.flags|=2,ri(i),i.memoizedState=null,e}function Mc(e,i,f){var h=i.pendingProps,b=(i.flags&128)!==0;if(i.flags&=-129,e===null){if(Ge){if(h.mode==="hidden")return e=wr(i,h),i.lanes=536870912,qs(null,e);if(Fn(i),(e=gn)?(e=Bv(e,Na),e=e!==null&&e.data==="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:mr!==null?{id:Ai,overflow:wi}:null,retryLane:536870912,hydrationErrors:null},f=ka(e),f.return=i,i.child=f,ga=i,gn=null)):e=null,e===null)throw vr(i);return i.lanes=536870912,null}return wr(i,h)}var w=e.memoizedState;if(w!==null){var q=w.dehydrated;if(Fn(i),b)if(i.flags&256)i.flags&=-257,i=Vs(e,i,f);else if(i.memoizedState!==null)i.child=e.child,i.flags|=128,i=null;else throw Error(a(558));else if(Zn||Ul(e,i,f,!1),b=(f&e.childLanes)!==0,Zn||b){if(h=xe,h!==null&&(q=Be(h,f),q!==0&&q!==w.retryLane))throw w.retryLane=q,ei(e,q),nn(h,e,q),Ah;S(),i=Vs(e,i,f)}else e=w.treeContext,gn=or(q.nextSibling),ga=i,Ge=!0,ai=null,Na=!1,e!==null&&qd(i,e),i=wr(i,h),i.flags|=4096;return i}return e=Ci(e.child,{mode:h.mode,children:h.children}),e.ref=i.ref,i.child=e,e.return=i,e}function Ys(e,i){var f=i.ref;if(f===null)e!==null&&e.ref!==null&&(i.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(a(284));(e===null||e.ref!==f)&&(i.flags|=4194816)}}function Ka(e,i,f,h,b){return yr(i),f=Hs(e,i,f,h,void 0,b),h=sh(),e!==null&&!Zn?(lh(e,i,b),Ni(e,i,b)):(Ge&&h&&Po(i),i.flags|=1,pa(e,i,f,b),i.child)}function oi(e,i,f,h,b,w){return yr(i),i.updateQueue=null,f=Xd(i,h,f,b),Qd(e),h=sh(),e!==null&&!Zn?(lh(e,i,w),Ni(e,i,w)):(Ge&&h&&Po(i),i.flags|=1,pa(e,i,f,w),i.child)}function os(e,i,f,h,b){if(yr(i),i.stateNode===null){var w=qi,q=f.contextType;typeof q=="object"&&q!==null&&(w=bn(q)),w=new f(h,w),i.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Da,i.stateNode=w,w._reactInternals=i,w=i.stateNode,w.props=h,w.state=i.memoizedState,w.refs={},Gs(i),q=f.contextType,w.context=typeof q=="object"&&q!==null?bn(q):qi,w.state=i.memoizedState,q=f.getDerivedStateFromProps,typeof q=="function"&&(ls(i,f,q,h),w.state=i.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(q=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),q!==w.state&&Da.enqueueReplaceState(w,w.state,null),is(i,h,w,b),Gl(),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308),h=!0}else if(e===null){w=i.stateNode;var $=i.memoizedProps,ot=$i(f,$);w.props=ot;var St=w.context,Rt=f.contextType;q=qi,typeof Rt=="object"&&Rt!==null&&(q=bn(Rt));var Mt=f.getDerivedStateFromProps;Rt=typeof Mt=="function"||typeof w.getSnapshotBeforeUpdate=="function",$=i.pendingProps!==$,Rt||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||($||St!==q)&&b0(i,w,h,q),Tr=!1;var Et=i.memoizedState;w.state=Et,is(i,h,w,b),Gl(),St=i.memoizedState,$||Et!==St||Tr?(typeof Mt=="function"&&(ls(i,f,Mt,h),St=i.memoizedState),(ot=Tr||S0(i,f,ot,h,Et,St,q))?(Rt||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(i.flags|=4194308)):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=St),w.props=h,w.state=St,w.context=q,h=ot):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{w=i.stateNode,nh(e,i),q=i.memoizedProps,Rt=$i(f,q),w.props=Rt,Mt=i.pendingProps,Et=w.context,St=f.contextType,ot=qi,typeof St=="object"&&St!==null&&(ot=bn(St)),$=f.getDerivedStateFromProps,(St=typeof $=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(q!==Mt||Et!==ot)&&b0(i,w,h,ot),Tr=!1,Et=i.memoizedState,w.state=Et,is(i,h,w,b),Gl();var At=i.memoizedState;q!==Mt||Et!==At||Tr||e!==null&&e.dependencies!==null&&lc(e.dependencies)?(typeof $=="function"&&(ls(i,f,$,h),At=i.memoizedState),(Rt=Tr||S0(i,f,Rt,h,Et,At,ot)||e!==null&&e.dependencies!==null&&lc(e.dependencies))?(St||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,At,ot),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,At,ot)),typeof w.componentDidUpdate=="function"&&(i.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=At),w.props=h,w.state=At,w.context=ot,h=Rt):(typeof w.componentDidUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||q===e.memoizedProps&&Et===e.memoizedState||(i.flags|=1024),h=!1)}return w=h,Ys(e,i),h=(i.flags&128)!==0,w||h?(w=i.stateNode,f=h&&typeof f.getDerivedStateFromError!="function"?null:w.render(),i.flags|=1,e!==null&&h?(i.child=Ls(i,e.child,null,b),i.child=Ls(i,null,f,b)):pa(e,i,f,b),i.memoizedState=w.state,e=i.child):e=Ni(e,i,b),e}function tr(e,i,f,h){return Wr(),i.flags|=256,pa(e,i,f,h),i.child}var Ri={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $n(e){return{baseLanes:e,cachePool:Us()}}function Ks(e,i,f){return e=e!==null?e.childLanes&~f:0,i&&(e|=he),e}function Or(e,i,f){var h=i.pendingProps,b=!1,w=(i.flags&128)!==0,q;if((q=w)||(q=e!==null&&e.memoizedState===null?!1:(Gn.current&2)!==0),q&&(b=!0,i.flags&=-129),q=(i.flags&32)!==0,i.flags&=-33,e===null){if(Ge){if(b?rs(i):ss(),(e=gn)?(e=Bv(e,Na),e=e!==null&&e.data!=="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:mr!==null?{id:Ai,overflow:wi}:null,retryLane:536870912,hydrationErrors:null},f=ka(e),f.return=i,i.child=f,ga=i,gn=null)):e=null,e===null)throw vr(i);return rp(e)?i.lanes=32:i.lanes=536870912,null}var $=h.children;return h=h.fallback,b?(ss(),b=i.mode,$=aa({mode:"hidden",children:$},b),h=Zr(h,b,f,null),$.return=i,h.return=i,$.sibling=h,i.child=$,h=i.child,h.memoizedState=$n(f),h.childLanes=Ks(e,q,f),i.memoizedState=Ri,qs(null,h)):(rs(i),ql(i,$))}var ot=e.memoizedState;if(ot!==null&&($=ot.dehydrated,$!==null)){if(w)i.flags&256?(rs(i),i.flags&=-257,i=In(e,i,f)):i.memoizedState!==null?(ss(),i.child=e.child,i.flags|=128,i=null):(ss(),$=h.fallback,b=i.mode,h=aa({mode:"visible",children:h.children},b),$=Zr($,b,f,null),$.flags|=2,h.return=i,$.return=i,h.sibling=$,i.child=h,Ls(i,e.child,null,f),h=i.child,h.memoizedState=$n(f),h.childLanes=Ks(e,q,f),i.memoizedState=Ri,i=qs(null,h));else if(rs(i),rp($)){if(q=$.nextSibling&&$.nextSibling.dataset,q)var St=q.dgst;q=St,h=Error(a(419)),h.stack="",h.digest=q,jl({value:h,source:null,stack:null}),i=In(e,i,f)}else if(Zn||Ul(e,i,f,!1),q=(f&e.childLanes)!==0,Zn||q){if(q=xe,q!==null&&(h=Be(q,f),h!==0&&h!==ot.retryLane))throw ot.retryLane=h,ei(e,h),nn(q,e,h),Ah;ip($)||S(),i=In(e,i,f)}else ip($)?(i.flags|=192,i.child=e.child,i=null):(e=ot.treeContext,gn=or($.nextSibling),ga=i,Ge=!0,ai=null,Na=!1,e!==null&&qd(i,e),i=ql(i,h.children),i.flags|=4096);return i}return b?(ss(),$=h.fallback,b=i.mode,ot=e.child,St=ot.sibling,h=Ci(ot,{mode:"hidden",children:h.children}),h.subtreeFlags=ot.subtreeFlags&65011712,St!==null?$=Ci(St,$):($=Zr($,b,f,null),$.flags|=2),$.return=i,h.return=i,h.sibling=$,i.child=h,qs(null,h),h=i.child,$=e.child.memoizedState,$===null?$=$n(f):(b=$.cachePool,b!==null?(ot=Xn._currentValue,b=b.parent!==ot?{parent:ot,pool:ot}:b):b=Us(),$={baseLanes:$.baseLanes|f,cachePool:b}),h.memoizedState=$,h.childLanes=Ks(e,q,f),i.memoizedState=Ri,qs(e.child,h)):(rs(i),f=e.child,e=f.sibling,f=Ci(f,{mode:"visible",children:h.children}),f.return=i,f.sibling=null,e!==null&&(q=i.deletions,q===null?(i.deletions=[e],i.flags|=16):q.push(e)),i.child=f,i.memoizedState=null,f)}function ql(e,i){return i=aa({mode:"visible",children:i},e.mode),i.return=e,e.child=i}function aa(e,i){return e=Ea(22,e,null,i),e.lanes=0,e}function In(e,i,f){return Ls(i,e.child,null,f),e=ql(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function Fe(e,i,f){e.lanes|=i;var h=e.alternate;h!==null&&(h.lanes|=i),Wf(e.return,i,f)}function Rr(e,i,f,h,b,w){var q=e.memoizedState;q===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:f,tailMode:b,treeForkCount:w}:(q.isBackwards=i,q.rendering=null,q.renderingStartTime=0,q.last=h,q.tail=f,q.tailMode=b,q.treeForkCount=w)}function xi(e,i,f){var h=i.pendingProps,b=h.revealOrder,w=h.tail;h=h.children;var q=Gn.current,$=(q&2)!==0;if($?(q=q&1|2,i.flags|=128):q&=1,at(Gn,q),pa(e,i,h,f),h=Ge?Dl:0,!$&&e!==null&&(e.flags&128)!==0)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Fe(e,f,i);else if(e.tag===19)Fe(e,f,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(b){case"forwards":for(f=i.child,b=null;f!==null;)e=f.alternate,e!==null&&gc(e)===null&&(b=f),f=f.sibling;f=b,f===null?(b=i.child,i.child=null):(b=f.sibling,f.sibling=null),Rr(i,!1,b,f,w,h);break;case"backwards":case"unstable_legacy-backwards":for(f=null,b=i.child,i.child=null;b!==null;){if(e=b.alternate,e!==null&&gc(e)===null){i.child=b;break}e=b.sibling,b.sibling=f,f=b,b=e}Rr(i,!0,f,null,w,h);break;case"together":Rr(i,!1,null,null,void 0,h);break;default:i.memoizedState=null}return i.child}function Ni(e,i,f){if(e!==null&&(i.dependencies=e.dependencies),hs|=i.lanes,(f&i.childLanes)===0)if(e!==null){if(Ul(e,i,f,!1),(f&i.childLanes)===0)return null}else return null;if(e!==null&&i.child!==e.child)throw Error(a(153));if(i.child!==null){for(e=i.child,f=Ci(e,e.pendingProps),i.child=f,f.return=i;e.sibling!==null;)e=e.sibling,f=f.sibling=Ci(e,e.pendingProps),f.return=i;f.sibling=null}return i.child}function ja(e,i){return(e.lanes&i)!==0?!0:(e=e.dependencies,!!(e!==null&&lc(e)))}function Dc(e,i,f){switch(i.tag){case 3:gt(i,i.stateNode.containerInfo),$r(i,Xn,e.memoizedState.cache),Wr();break;case 27:case 5:Dt(i);break;case 4:gt(i,i.stateNode.containerInfo);break;case 10:$r(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Fn(i),null;break;case 13:var h=i.memoizedState;if(h!==null)return h.dehydrated!==null?(rs(i),i.flags|=128,null):(f&i.child.childLanes)!==0?Or(e,i,f):(rs(i),e=Ni(e,i,f),e!==null?e.sibling:null);rs(i);break;case 19:var b=(e.flags&128)!==0;if(h=(f&i.childLanes)!==0,h||(Ul(e,i,f,!1),h=(f&i.childLanes)!==0),b){if(h)return xi(e,i,f);i.flags|=128}if(b=i.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),at(Gn,Gn.current),h)break;return null;case 22:return i.lanes=0,wh(e,i,f,i.pendingProps);case 24:$r(i,Xn,e.memoizedState.cache)}return Ni(e,i,f)}function us(e,i,f){if(e!==null)if(e.memoizedProps!==i.pendingProps)Zn=!0;else{if(!ja(e,f)&&(i.flags&128)===0)return Zn=!1,Dc(e,i,f);Zn=(e.flags&131072)!==0}else Zn=!1,Ge&&(i.flags&1048576)!==0&&ic(i,Dl,i.index);switch(i.lanes=0,i.tag){case 16:t:{var h=i.pendingProps;if(e=_r(i.elementType),i.type=e,typeof e=="function")ec(e)?(h=$i(e,h),i.tag=1,i=os(null,i,e,h,f)):(i.tag=0,i=Ka(null,i,e,h,f));else{if(e!=null){var b=e.$$typeof;if(b===G){i.tag=11,i=kl(null,i,e,h,f);break t}else if(b===T){i.tag=14,i=Ya(null,i,e,h,f);break t}}throw i=X(e)||e,Error(a(306,i,""))}}return i;case 0:return Ka(e,i,i.type,i.pendingProps,f);case 1:return h=i.type,b=$i(h,i.pendingProps),os(e,i,h,b,f);case 3:t:{if(gt(i,i.stateNode.containerInfo),e===null)throw Error(a(387));h=i.pendingProps;var w=i.memoizedState;b=w.element,nh(e,i),is(i,h,null,f);var q=i.memoizedState;if(h=q.cache,$r(i,Xn,h),h!==w.cache&&$f(i,[Xn],f,!0),Gl(),h=q.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:q.cache},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){i=tr(e,i,h,f);break t}else if(h!==b){b=ni(Error(a(424)),i),jl(b),i=tr(e,i,h,f);break t}else{switch(e=i.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(gn=or(e.firstChild),ga=i,Ge=!0,ai=null,Na=!0,f=Yd(i,null,h,f),i.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Wr(),h===b){i=Ni(e,i,f);break t}pa(e,i,h,f)}i=i.child}return i;case 26:return Ys(e,i),e===null?(f=Iv(i.type,null,i.pendingProps,null))?i.memoizedState=f:Ge||(f=i.type,e=i.pendingProps,h=N0(tt.current).createElement(f),h[ze]=i,h[ln]=e,La(h,f,e),ea(h),i.stateNode=h):i.memoizedState=Iv(i.type,e.memoizedProps,i.pendingProps,e.memoizedState),null;case 27:return Dt(i),e===null&&Ge&&(h=i.stateNode=Gv(i.type,i.pendingProps,tt.current),ga=i,Na=!0,b=gn,Zl(i.type)?(sp=b,gn=or(h.firstChild)):gn=b),pa(e,i,i.pendingProps.children,f),Ys(e,i),e===null&&(i.flags|=4194304),i.child;case 5:return e===null&&Ge&&((b=h=gn)&&(h=Pb(h,i.type,i.pendingProps,Na),h!==null?(i.stateNode=h,ga=i,gn=or(h.firstChild),Na=!1,b=!0):b=!1),b||vr(i)),Dt(i),b=i.type,w=i.pendingProps,q=e!==null?e.memoizedProps:null,h=w.children,ep(b,w)?h=null:q!==null&&ep(b,q)&&(i.flags|=32),i.memoizedState!==null&&(b=Hs(e,i,Pg,null,null,f),Hh._currentValue=b),Ys(e,i),pa(e,i,h,f),i.child;case 6:return e===null&&Ge&&((e=f=gn)&&(f=Hb(f,i.pendingProps,Na),f!==null?(i.stateNode=f,ga=i,gn=null,e=!0):e=!1),e||vr(i)),null;case 13:return Or(e,i,f);case 4:return gt(i,i.stateNode.containerInfo),h=i.pendingProps,e===null?i.child=Ls(i,null,h,f):pa(e,i,h,f),i.child;case 11:return kl(e,i,i.type,i.pendingProps,f);case 7:return pa(e,i,i.pendingProps,f),i.child;case 8:return pa(e,i,i.pendingProps.children,f),i.child;case 12:return pa(e,i,i.pendingProps.children,f),i.child;case 10:return h=i.pendingProps,$r(i,i.type,h.value),pa(e,i,h.children,f),i.child;case 9:return b=i.type._context,h=i.pendingProps.children,yr(i),b=bn(b),h=h(b),i.flags|=1,pa(e,i,h,f),i.child;case 14:return Ya(e,i,i.type,i.pendingProps,f);case 15:return Nc(e,i,i.type,i.pendingProps,f);case 19:return xi(e,i,f);case 31:return Mc(e,i,f);case 22:return wh(e,i,f,i.pendingProps);case 24:return yr(i),h=bn(Xn),e===null?(b=Ll(),b===null&&(b=xe,w=oc(),b.pooledCache=w,w.refCount++,w!==null&&(b.pooledCacheLanes|=f),b=w),i.memoizedState={parent:h,cache:b},Gs(i),$r(i,Xn,b)):((e.lanes&f)!==0&&(nh(e,i),is(i,null,null,f),Gl()),b=e.memoizedState,w=i.memoizedState,b.parent!==h?(b={parent:h,cache:h},i.memoizedState=b,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=b),$r(i,Xn,h)):(h=w.cache,$r(i,Xn,h),h!==b.cache&&$f(i,[Xn],f,!0))),pa(e,i,i.pendingProps.children,f),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function ma(e){e.flags|=4}function Rh(e,i,f,h,b){if((i=(e.mode&32)!==0)&&(i=!1),i){if(e.flags|=16777216,(b&335544128)===b)if(e.stateNode.complete)e.flags|=8192;else if(s())e.flags|=8192;else throw Er=qo,ko}else e.flags&=-16777217}function C0(e,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Kv(i))if(s())e.flags|=8192;else throw Er=qo,ko}function jc(e,i){i!==null&&(e.flags|=4),e.flags&16384&&(i=e.tag!==22?vl():536870912,e.lanes|=i,Ne|=i)}function pn(e,i){if(!Ge)switch(e.tailMode){case"hidden":i=e.tail;for(var f=null;i!==null;)i.alternate!==null&&(f=i),i=i.sibling;f===null?e.tail=null:f.sibling=null;break;case"collapsed":f=e.tail;for(var h=null;f!==null;)f.alternate!==null&&(h=f),f=f.sibling;h===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function fn(e){var i=e.alternate!==null&&e.alternate.child===e.child,f=0,h=0;if(i)for(var b=e.child;b!==null;)f|=b.lanes|b.childLanes,h|=b.subtreeFlags&65011712,h|=b.flags&65011712,b.return=e,b=b.sibling;else for(b=e.child;b!==null;)f|=b.lanes|b.childLanes,h|=b.subtreeFlags,h|=b.flags,b.return=e,b=b.sibling;return e.subtreeFlags|=h,e.childLanes=f,i}function Vl(e,i,f){var h=i.pendingProps;switch(Ff(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fn(i),null;case 1:return fn(i),null;case 3:return f=i.stateNode,h=null,e!==null&&(h=e.memoizedState.cache),i.memoizedState.cache!==h&&(i.flags|=2048),Yi(Xn),wt(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(e===null||e.child===null)&&(xs(i)?ma(i):e===null||e.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ns())),fn(i),null;case 26:var b=i.type,w=i.memoizedState;return e===null?(ma(i),w!==null?(fn(i),C0(i,w)):(fn(i),Rh(i,b,null,h,f))):w?w!==e.memoizedState?(ma(i),fn(i),C0(i,w)):(fn(i),i.flags&=-16777217):(e=e.memoizedProps,e!==h&&ma(i),fn(i),Rh(i,b,e,h,f)),null;case 27:if(Qt(i),f=tt.current,b=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==h&&ma(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return fn(i),null}e=Y.current,xs(i)?Jf(i):(e=Gv(b,h,f),i.stateNode=e,ma(i))}return fn(i),null;case 5:if(Qt(i),b=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==h&&ma(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return fn(i),null}if(w=Y.current,xs(i))Jf(i);else{var q=N0(tt.current);switch(w){case 1:w=q.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:w=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":w=q.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":w=q.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":w=q.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof h.is=="string"?q.createElement("select",{is:h.is}):q.createElement("select"),h.multiple?w.multiple=!0:h.size&&(w.size=h.size);break;default:w=typeof h.is=="string"?q.createElement(b,{is:h.is}):q.createElement(b)}}w[ze]=i,w[ln]=h;t:for(q=i.child;q!==null;){if(q.tag===5||q.tag===6)w.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===i)break t;for(;q.sibling===null;){if(q.return===null||q.return===i)break t;q=q.return}q.sibling.return=q.return,q=q.sibling}i.stateNode=w;t:switch(La(w,b,h),b){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&ma(i)}}return fn(i),Rh(i,i.type,e===null?null:e.memoizedProps,i.pendingProps,f),null;case 6:if(e&&i.stateNode!=null)e.memoizedProps!==h&&ma(i);else{if(typeof h!="string"&&i.stateNode===null)throw Error(a(166));if(e=tt.current,xs(i)){if(e=i.stateNode,f=i.memoizedProps,h=null,b=ga,b!==null)switch(b.tag){case 27:case 5:h=b.memoizedProps}e[ze]=i,e=!!(e.nodeValue===f||h!==null&&h.suppressHydrationWarning===!0||Ov(e.nodeValue,f)),e||vr(i,!0)}else e=N0(e).createTextNode(h),e[ze]=i,i.stateNode=e}return fn(i),null;case 31:if(f=i.memoizedState,e===null||e.memoizedState!==null){if(h=xs(i),f!==null){if(e===null){if(!h)throw Error(a(318));if(e=i.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(557));e[ze]=i}else Wr(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;fn(i),e=!1}else f=Ns(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),e=!0;if(!e)return i.flags&256?(ri(i),i):(ri(i),null);if((i.flags&128)!==0)throw Error(a(558))}return fn(i),null;case 13:if(h=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(b=xs(i),h!==null&&h.dehydrated!==null){if(e===null){if(!b)throw Error(a(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(a(317));b[ze]=i}else Wr(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;fn(i),b=!1}else b=Ns(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=b),b=!0;if(!b)return i.flags&256?(ri(i),i):(ri(i),null)}return ri(i),(i.flags&128)!==0?(i.lanes=f,i):(f=h!==null,e=e!==null&&e.memoizedState!==null,f&&(h=i.child,b=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(b=h.alternate.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==b&&(h.flags|=2048)),f!==e&&f&&(i.child.flags|=8192),jc(i,i.updateQueue),fn(i),null);case 4:return wt(),e===null&&Jg(i.stateNode.containerInfo),fn(i),null;case 10:return Yi(i.type),fn(i),null;case 19:if(rt(Gn),h=i.memoizedState,h===null)return fn(i),null;if(b=(i.flags&128)!==0,w=h.rendering,w===null)if(b)pn(h,!1);else{if(mn!==0||e!==null&&(e.flags&128)!==0)for(e=i.child;e!==null;){if(w=gc(e),w!==null){for(i.flags|=128,pn(h,!1),e=w.updateQueue,i.updateQueue=e,jc(i,e),i.subtreeFlags=0,e=f,f=i.child;f!==null;)nc(f,e),f=f.sibling;return at(Gn,Gn.current&1|2),Ge&&Vi(i,h.treeForkCount),i.child}e=e.sibling}h.tail!==null&&me()>bi&&(i.flags|=128,b=!0,pn(h,!1),i.lanes=4194304)}else{if(!b)if(e=gc(w),e!==null){if(i.flags|=128,b=!0,e=e.updateQueue,i.updateQueue=e,jc(i,e),pn(h,!0),h.tail===null&&h.tailMode==="hidden"&&!w.alternate&&!Ge)return fn(i),null}else 2*me()-h.renderingStartTime>bi&&f!==536870912&&(i.flags|=128,b=!0,pn(h,!1),i.lanes=4194304);h.isBackwards?(w.sibling=i.child,i.child=w):(e=h.last,e!==null?e.sibling=w:i.child=w,h.last=w)}return h.tail!==null?(e=h.tail,h.rendering=e,h.tail=e.sibling,h.renderingStartTime=me(),e.sibling=null,f=Gn.current,at(Gn,b?f&1|2:f&1),Ge&&Vi(i,h.treeForkCount),e):(fn(i),null);case 22:case 23:return ri(i),Xi(),h=i.memoizedState!==null,e!==null?e.memoizedState!==null!==h&&(i.flags|=8192):h&&(i.flags|=8192),h?(f&536870912)!==0&&(i.flags&128)===0&&(fn(i),i.subtreeFlags&6&&(i.flags|=8192)):fn(i),f=i.updateQueue,f!==null&&jc(i,f.retryQueue),f=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(f=e.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==f&&(i.flags|=2048),e!==null&&rt(js),null;case 24:return f=null,e!==null&&(f=e.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),Yi(Xn),fn(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function xh(e,i){switch(Ff(i),i.tag){case 1:return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return Yi(Xn),wt(),e=i.flags,(e&65536)!==0&&(e&128)===0?(i.flags=e&-65537|128,i):null;case 26:case 27:case 5:return Qt(i),null;case 31:if(i.memoizedState!==null){if(ri(i),i.alternate===null)throw Error(a(340));Wr()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 13:if(ri(i),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Wr()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return rt(Gn),null;case 4:return wt(),null;case 10:return Yi(i.type),null;case 22:case 23:return ri(i),Xi(),e!==null&&rt(js),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 24:return Yi(Xn),null;case 25:return null;default:return null}}function nu(e,i){switch(Ff(i),i.tag){case 3:Yi(Xn),wt();break;case 26:case 27:case 5:Qt(i);break;case 4:wt();break;case 31:i.memoizedState!==null&&ri(i);break;case 13:ri(i);break;case 19:rt(Gn);break;case 10:Yi(i.type);break;case 22:case 23:ri(i),Xi(),e!==null&&rt(js);break;case 24:Yi(Xn)}}function Qs(e,i){try{var f=i.updateQueue,h=f!==null?f.lastEffect:null;if(h!==null){var b=h.next;f=b;do{if((f.tag&e)===e){h=void 0;var w=f.create,q=f.inst;h=w(),q.destroy=h}f=f.next}while(f!==b)}}catch($){Ft(i,i.return,$)}}function ui(e,i,f){try{var h=i.updateQueue,b=h!==null?h.lastEffect:null;if(b!==null){var w=b.next;h=w;do{if((h.tag&e)===e){var q=h.inst,$=q.destroy;if($!==void 0){q.destroy=void 0,b=i;var ot=f,St=$;try{St()}catch(Rt){Ft(b,ot,Rt)}}}h=h.next}while(h!==w)}}catch(Rt){Ft(i,i.return,Rt)}}function Yl(e){var i=e.updateQueue;if(i!==null){var f=e.stateNode;try{Kd(i,f)}catch(h){Ft(e,e.return,h)}}}function Uc(e,i,f){f.props=$i(e.type,e.memoizedProps),f.state=e.memoizedState;try{f.componentWillUnmount()}catch(h){Ft(e,i,h)}}function er(e,i){try{var f=e.ref;if(f!==null){switch(e.tag){case 26:case 27:case 5:var h=e.stateNode;break;case 30:h=e.stateNode;break;default:h=e.stateNode}typeof f=="function"?e.refCleanup=f(h):f.current=h}}catch(b){Ft(e,i,b)}}function Ua(e,i){var f=e.ref,h=e.refCleanup;if(f!==null)if(typeof h=="function")try{h()}catch(b){Ft(e,i,b)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(b){Ft(e,i,b)}else f.current=null}function Nh(e){var i=e.type,f=e.memoizedProps,h=e.stateNode;try{t:switch(i){case"button":case"input":case"select":case"textarea":f.autoFocus&&h.focus();break t;case"img":f.src?h.src=f.src:f.srcSet&&(h.srcset=f.srcSet)}}catch(b){Ft(e,e.return,b)}}function xr(e,i,f){try{var h=e.stateNode;jb(h,e.type,f,i),h[ln]=i}catch(b){Ft(e,e.return,b)}}function T0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Zl(e.type)||e.tag===4}function Xs(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||T0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Zl(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function au(e,i,f){var h=e.tag;if(h===5||h===6)e=e.stateNode,i?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(e,i):(i=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,i.appendChild(e),f=f._reactRootContainer,f!=null||i.onclick!==null||(i.onclick=Ha));else if(h!==4&&(h===27&&Zl(e.type)&&(f=e.stateNode,i=null),e=e.child,e!==null))for(au(e,i,f),e=e.sibling;e!==null;)au(e,i,f),e=e.sibling}function Fs(e,i,f){var h=e.tag;if(h===5||h===6)e=e.stateNode,i?f.insertBefore(e,i):f.appendChild(e);else if(h!==4&&(h===27&&Zl(e.type)&&(f=e.stateNode),e=e.child,e!==null))for(Fs(e,i,f),e=e.sibling;e!==null;)Fs(e,i,f),e=e.sibling}function iu(e){var i=e.stateNode,f=e.memoizedProps;try{for(var h=e.type,b=i.attributes;b.length;)i.removeAttributeNode(b[0]);La(i,h,f),i[ze]=e,i[ln]=f}catch(w){Ft(e,e.return,w)}}var Qa=!1,We=!1,cs=!1,Bc=typeof WeakSet=="function"?WeakSet:Set,_n=null;function Mh(e,i){if(e=e.containerInfo,$g=L0,e=_i(e),Wu(e)){if("selectionStart"in e)var f={start:e.selectionStart,end:e.selectionEnd};else t:{f=(f=e.ownerDocument)&&f.defaultView||window;var h=f.getSelection&&f.getSelection();if(h&&h.rangeCount!==0){f=h.anchorNode;var b=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{f.nodeType,w.nodeType}catch{f=null;break t}var q=0,$=-1,ot=-1,St=0,Rt=0,Mt=e,Et=null;e:for(;;){for(var At;Mt!==f||b!==0&&Mt.nodeType!==3||($=q+b),Mt!==w||h!==0&&Mt.nodeType!==3||(ot=q+h),Mt.nodeType===3&&(q+=Mt.nodeValue.length),(At=Mt.firstChild)!==null;)Et=Mt,Mt=At;for(;;){if(Mt===e)break e;if(Et===f&&++St===b&&($=q),Et===w&&++Rt===h&&(ot=q),(At=Mt.nextSibling)!==null)break;Mt=Et,Et=Mt.parentNode}Mt=At}f=$===-1||ot===-1?null:{start:$,end:ot}}else f=null}f=f||{start:0,end:0}}else f=null;for(tp={focusedElem:e,selectionRange:f},L0=!1,_n=i;_n!==null;)if(i=_n,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,_n=e;else for(;_n!==null;){switch(i=_n,w=i.alternate,e=i.flags,i.tag){case 0:if((e&4)!==0&&(e=i.updateQueue,e=e!==null?e.events:null,e!==null))for(f=0;f<e.length;f++)b=e[f],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&w!==null){e=void 0,f=i,b=w.memoizedProps,w=w.memoizedState,h=f.stateNode;try{var ee=$i(f.type,b);e=h.getSnapshotBeforeUpdate(ee,w),h.__reactInternalSnapshotBeforeUpdate=e}catch(de){Ft(f,f.return,de)}}break;case 3:if((e&1024)!==0){if(e=i.stateNode.containerInfo,f=e.nodeType,f===9)ap(e);else if(f===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ap(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=i.sibling,e!==null){e.return=i.return,_n=e;break}_n=i.return}}function Js(e,i,f){var h=f.flags;switch(f.tag){case 0:case 11:case 15:nr(e,f),h&4&&Qs(5,f);break;case 1:if(nr(e,f),h&4)if(e=f.stateNode,i===null)try{e.componentDidMount()}catch(q){Ft(f,f.return,q)}else{var b=$i(f.type,i.memoizedProps);i=i.memoizedState;try{e.componentDidUpdate(b,i,e.__reactInternalSnapshotBeforeUpdate)}catch(q){Ft(f,f.return,q)}}h&64&&Yl(f),h&512&&er(f,f.return);break;case 3:if(nr(e,f),h&64&&(e=f.updateQueue,e!==null)){if(i=null,f.child!==null)switch(f.child.tag){case 27:case 5:i=f.child.stateNode;break;case 1:i=f.child.stateNode}try{Kd(e,i)}catch(q){Ft(f,f.return,q)}}break;case 27:i===null&&h&4&&iu(f);case 26:case 5:nr(e,f),i===null&&h&4&&Nh(f),h&512&&er(f,f.return);break;case 12:nr(e,f);break;case 31:nr(e,f),h&4&&su(e,f);break;case 13:nr(e,f),h&4&&Zs(e,f),h&64&&(e=f.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(f=sa.bind(null,f),Ib(e,f))));break;case 22:if(h=f.memoizedState!==null||Qa,!h){i=i!==null&&i.memoizedState!==null||We,b=Qa;var w=We;Qa=h,(We=i)&&!w?Xa(e,f,(f.subtreeFlags&8772)!==0):nr(e,f),Qa=b,We=w}break;case 30:break;default:nr(e,f)}}function ru(e){var i=e.alternate;i!==null&&(e.alternate=null,ru(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&Dn(i)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var $e=null,ue=!1;function Pe(e,i,f){for(f=f.child;f!==null;)kn(e,i,f),f=f.sibling}function kn(e,i,f){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(Ct,f)}catch{}switch(f.tag){case 26:We||Ua(f,i),Pe(e,i,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:We||Ua(f,i);var h=$e,b=ue;Zl(f.type)&&($e=f.stateNode,ue=!1),Pe(e,i,f),Lh(f.stateNode),$e=h,ue=b;break;case 5:We||Ua(f,i);case 6:if(h=$e,b=ue,$e=null,Pe(e,i,f),$e=h,ue=b,$e!==null)if(ue)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(f.stateNode)}catch(w){Ft(f,i,w)}else try{$e.removeChild(f.stateNode)}catch(w){Ft(f,i,w)}break;case 18:$e!==null&&(ue?(e=$e,jv(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,f.stateNode),Kc(e)):jv($e,f.stateNode));break;case 4:h=$e,b=ue,$e=f.stateNode.containerInfo,ue=!0,Pe(e,i,f),$e=h,ue=b;break;case 0:case 11:case 14:case 15:ui(2,f,i),We||ui(4,f,i),Pe(e,i,f);break;case 1:We||(Ua(f,i),h=f.stateNode,typeof h.componentWillUnmount=="function"&&Uc(f,i,h)),Pe(e,i,f);break;case 21:Pe(e,i,f);break;case 22:We=(h=We)||f.memoizedState!==null,Pe(e,i,f),We=h;break;default:Pe(e,i,f)}}function su(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Kc(e)}catch(f){Ft(i,i.return,f)}}}function Zs(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Kc(e)}catch(f){Ft(i,i.return,f)}}function Ws(e){switch(e.tag){case 31:case 13:case 19:var i=e.stateNode;return i===null&&(i=e.stateNode=new Bc),i;case 22:return e=e.stateNode,i=e._retryCache,i===null&&(i=e._retryCache=new Bc),i;default:throw Error(a(435,e.tag))}}function $s(e,i){var f=Ws(e);i.forEach(function(h){if(!f.has(h)){f.add(h);var b=Je.bind(null,e,h);h.then(b,b)}})}function ia(e,i){var f=i.deletions;if(f!==null)for(var h=0;h<f.length;h++){var b=f[h],w=e,q=i,$=q;t:for(;$!==null;){switch($.tag){case 27:if(Zl($.type)){$e=$.stateNode,ue=!1;break t}break;case 5:$e=$.stateNode,ue=!1;break t;case 3:case 4:$e=$.stateNode.containerInfo,ue=!0;break t}$=$.return}if($e===null)throw Error(a(160));kn(w,q,b),$e=null,ue=!1,w=b.alternate,w!==null&&(w.return=null),b.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)A0(i,e),i=i.sibling}var Ca=null;function A0(e,i){var f=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ia(i,e),va(e),h&4&&(ui(3,e,e.return),Qs(3,e),ui(5,e,e.return));break;case 1:ia(i,e),va(e),h&512&&(We||f===null||Ua(f,f.return)),h&64&&Qa&&(e=e.updateQueue,e!==null&&(h=e.callbacks,h!==null&&(f=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=f===null?h:f.concat(h))));break;case 26:var b=Ca;if(ia(i,e),va(e),h&512&&(We||f===null||Ua(f,f.return)),h&4){var w=f!==null?f.memoizedState:null;if(h=e.memoizedState,f===null)if(h===null)if(e.stateNode===null){t:{h=e.type,f=e.memoizedProps,b=b.ownerDocument||b;e:switch(h){case"title":w=b.getElementsByTagName("title")[0],(!w||w[Ss]||w[ze]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=b.createElement(h),b.head.insertBefore(w,b.querySelector("head > title"))),La(w,h,f),w[ze]=e,ea(w),h=w;break t;case"link":var q=Vv("link","href",b).get(h+(f.href||""));if(q){for(var $=0;$<q.length;$++)if(w=q[$],w.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&w.getAttribute("rel")===(f.rel==null?null:f.rel)&&w.getAttribute("title")===(f.title==null?null:f.title)&&w.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){q.splice($,1);break e}}w=b.createElement(h),La(w,h,f),b.head.appendChild(w);break;case"meta":if(q=Vv("meta","content",b).get(h+(f.content||""))){for($=0;$<q.length;$++)if(w=q[$],w.getAttribute("content")===(f.content==null?null:""+f.content)&&w.getAttribute("name")===(f.name==null?null:f.name)&&w.getAttribute("property")===(f.property==null?null:f.property)&&w.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&w.getAttribute("charset")===(f.charSet==null?null:f.charSet)){q.splice($,1);break e}}w=b.createElement(h),La(w,h,f),b.head.appendChild(w);break;default:throw Error(a(468,h))}w[ze]=e,ea(w),h=w}e.stateNode=h}else Yv(b,e.type,e.stateNode);else e.stateNode=qv(b,h,e.memoizedProps);else w!==h?(w===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):w.count--,h===null?Yv(b,e.type,e.stateNode):qv(b,h,e.memoizedProps)):h===null&&e.stateNode!==null&&xr(e,e.memoizedProps,f.memoizedProps)}break;case 27:ia(i,e),va(e),h&512&&(We||f===null||Ua(f,f.return)),f!==null&&h&4&&xr(e,e.memoizedProps,f.memoizedProps);break;case 5:if(ia(i,e),va(e),h&512&&(We||f===null||Ua(f,f.return)),e.flags&32){b=e.stateNode;try{qr(b,"")}catch(ee){Ft(e,e.return,ee)}}h&4&&e.stateNode!=null&&(b=e.memoizedProps,xr(e,b,f!==null?f.memoizedProps:b)),h&1024&&(cs=!0);break;case 6:if(ia(i,e),va(e),h&4){if(e.stateNode===null)throw Error(a(162));h=e.memoizedProps,f=e.stateNode;try{f.nodeValue=h}catch(ee){Ft(e,e.return,ee)}}break;case 3:if(j0=null,b=Ca,Ca=M0(i.containerInfo),ia(i,e),Ca=b,va(e),h&4&&f!==null&&f.memoizedState.isDehydrated)try{Kc(i.containerInfo)}catch(ee){Ft(e,e.return,ee)}cs&&(cs=!1,Dh(e));break;case 4:h=Ca,Ca=M0(e.stateNode.containerInfo),ia(i,e),va(e),Ca=h;break;case 12:ia(i,e),va(e);break;case 31:ia(i,e),va(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,$s(e,h)));break;case 13:ia(i,e),va(e),e.child.flags&8192&&e.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Mr=me()),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,$s(e,h)));break;case 22:b=e.memoizedState!==null;var ot=f!==null&&f.memoizedState!==null,St=Qa,Rt=We;if(Qa=St||b,We=Rt||ot,ia(i,e),We=Rt,Qa=St,va(e),h&8192)t:for(i=e.stateNode,i._visibility=b?i._visibility&-2:i._visibility|1,b&&(f===null||ot||Qa||We||tl(e)),f=null,i=e;;){if(i.tag===5||i.tag===26){if(f===null){ot=f=i;try{if(w=ot.stateNode,b)q=w.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{$=ot.stateNode;var Mt=ot.memoizedProps.style,Et=Mt!=null&&Mt.hasOwnProperty("display")?Mt.display:null;$.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(ee){Ft(ot,ot.return,ee)}}}else if(i.tag===6){if(f===null){ot=i;try{ot.stateNode.nodeValue=b?"":ot.memoizedProps}catch(ee){Ft(ot,ot.return,ee)}}}else if(i.tag===18){if(f===null){ot=i;try{var At=ot.stateNode;b?Uv(At,!0):Uv(ot.stateNode,!1)}catch(ee){Ft(ot,ot.return,ee)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break t;for(;i.sibling===null;){if(i.return===null||i.return===e)break t;f===i&&(f=null),i=i.return}f===i&&(f=null),i.sibling.return=i.return,i=i.sibling}h&4&&(h=e.updateQueue,h!==null&&(f=h.retryQueue,f!==null&&(h.retryQueue=null,$s(e,f))));break;case 19:ia(i,e),va(e),h&4&&(h=e.updateQueue,h!==null&&(e.updateQueue=null,$s(e,h)));break;case 30:break;case 21:break;default:ia(i,e),va(e)}}function va(e){var i=e.flags;if(i&2){try{for(var f,h=e.return;h!==null;){if(T0(h)){f=h;break}h=h.return}if(f==null)throw Error(a(160));switch(f.tag){case 27:var b=f.stateNode,w=Xs(e);Fs(e,w,b);break;case 5:var q=f.stateNode;f.flags&32&&(qr(q,""),f.flags&=-33);var $=Xs(e);Fs(e,$,q);break;case 3:case 4:var ot=f.stateNode.containerInfo,St=Xs(e);au(e,St,ot);break;default:throw Error(a(161))}}catch(Rt){Ft(e,e.return,Rt)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function Dh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var i=e;Dh(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),e=e.sibling}}function nr(e,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Js(e,i.alternate,i),i=i.sibling}function tl(e){for(e=e.child;e!==null;){var i=e;switch(i.tag){case 0:case 11:case 14:case 15:ui(4,i,i.return),tl(i);break;case 1:Ua(i,i.return);var f=i.stateNode;typeof f.componentWillUnmount=="function"&&Uc(i,i.return,f),tl(i);break;case 27:Lh(i.stateNode);case 26:case 5:Ua(i,i.return),tl(i);break;case 22:i.memoizedState===null&&tl(i);break;case 30:tl(i);break;default:tl(i)}e=e.sibling}}function Xa(e,i,f){for(f=f&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var h=i.alternate,b=e,w=i,q=w.flags;switch(w.tag){case 0:case 11:case 15:Xa(b,w,f),Qs(4,w);break;case 1:if(Xa(b,w,f),h=w,b=h.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(St){Ft(h,h.return,St)}if(h=w,b=h.updateQueue,b!==null){var $=h.stateNode;try{var ot=b.shared.hiddenCallbacks;if(ot!==null)for(b.shared.hiddenCallbacks=null,b=0;b<ot.length;b++)ih(ot[b],$)}catch(St){Ft(h,h.return,St)}}f&&q&64&&Yl(w),er(w,w.return);break;case 27:iu(w);case 26:case 5:Xa(b,w,f),f&&h===null&&q&4&&Nh(w),er(w,w.return);break;case 12:Xa(b,w,f);break;case 31:Xa(b,w,f),f&&q&4&&su(b,w);break;case 13:Xa(b,w,f),f&&q&4&&Zs(b,w);break;case 22:w.memoizedState===null&&Xa(b,w,f),er(w,w.return);break;case 30:break;default:Xa(b,w,f)}i=i.sibling}}function el(e,i){var f=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(f=e.memoizedState.cachePool.pool),e=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(e=i.memoizedState.cachePool.pool),e!==f&&(e!=null&&e.refCount++,f!=null&&Bl(f))}function fs(e,i){e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&Bl(e))}function yi(e,i,f,h){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)ci(e,i,f,h),i=i.sibling}function ci(e,i,f,h){var b=i.flags;switch(i.tag){case 0:case 11:case 15:yi(e,i,f,h),b&2048&&Qs(9,i);break;case 1:yi(e,i,f,h);break;case 3:yi(e,i,f,h),b&2048&&(e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&Bl(e)));break;case 12:if(b&2048){yi(e,i,f,h),e=i.stateNode;try{var w=i.memoizedProps,q=w.id,$=w.onPostCommit;typeof $=="function"&&$(q,i.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(ot){Ft(i,i.return,ot)}}else yi(e,i,f,h);break;case 31:yi(e,i,f,h);break;case 13:yi(e,i,f,h);break;case 23:break;case 22:w=i.stateNode,q=i.alternate,i.memoizedState!==null?w._visibility&2?yi(e,i,f,h):Un(e,i):w._visibility&2?yi(e,i,f,h):(w._visibility|=2,Ba(e,i,f,h,(i.subtreeFlags&10256)!==0||!1)),b&2048&&el(q,i);break;case 24:yi(e,i,f,h),b&2048&&fs(i.alternate,i);break;default:yi(e,i,f,h)}}function Ba(e,i,f,h,b){for(b=b&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var w=e,q=i,$=f,ot=h,St=q.flags;switch(q.tag){case 0:case 11:case 15:Ba(w,q,$,ot,b),Qs(8,q);break;case 23:break;case 22:var Rt=q.stateNode;q.memoizedState!==null?Rt._visibility&2?Ba(w,q,$,ot,b):Un(w,q):(Rt._visibility|=2,Ba(w,q,$,ot,b)),b&&St&2048&&el(q.alternate,q);break;case 24:Ba(w,q,$,ot,b),b&&St&2048&&fs(q.alternate,q);break;default:Ba(w,q,$,ot,b)}i=i.sibling}}function Un(e,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var f=e,h=i,b=h.flags;switch(h.tag){case 22:Un(f,h),b&2048&&el(h.alternate,h);break;case 24:Un(f,h),b&2048&&fs(h.alternate,h);break;default:Un(f,h)}i=i.sibling}}var nl=8192;function al(e,i,f){if(e.subtreeFlags&nl)for(e=e.child;e!==null;)jh(e,i,f),e=e.sibling}function jh(e,i,f){switch(e.tag){case 26:al(e,i,f),e.flags&nl&&e.memoizedState!==null&&$b(f,Ca,e.memoizedState,e.memoizedProps);break;case 5:al(e,i,f);break;case 3:case 4:var h=Ca;Ca=M0(e.stateNode.containerInfo),al(e,i,f),Ca=h;break;case 22:e.memoizedState===null&&(h=e.alternate,h!==null&&h.memoizedState!==null?(h=nl,nl=16777216,al(e,i,f),nl=h):al(e,i,f));break;default:al(e,i,f)}}function ta(e){var i=e.alternate;if(i!==null&&(e=i.child,e!==null)){i.child=null;do i=e.sibling,e.sibling=null,e=i;while(e!==null)}}function il(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var f=0;f<i.length;f++){var h=i[f];_n=h,zc(h,e)}ta(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ar(e),e=e.sibling}function ar(e){switch(e.tag){case 0:case 11:case 15:il(e),e.flags&2048&&ui(9,e,e.return);break;case 3:il(e);break;case 12:il(e);break;case 22:var i=e.stateNode;e.memoizedState!==null&&i._visibility&2&&(e.return===null||e.return.tag!==13)?(i._visibility&=-3,Rn(e)):il(e);break;default:il(e)}}function Rn(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var f=0;f<i.length;f++){var h=i[f];_n=h,zc(h,e)}ta(e)}for(e=e.child;e!==null;){switch(i=e,i.tag){case 0:case 11:case 15:ui(8,i,i.return),Rn(i);break;case 22:f=i.stateNode,f._visibility&2&&(f._visibility&=-3,Rn(i));break;default:Rn(i)}e=e.sibling}}function zc(e,i){for(;_n!==null;){var f=_n;switch(f.tag){case 0:case 11:case 15:ui(8,f,i);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var h=f.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Bl(f.memoizedState.cache)}if(h=f.child,h!==null)h.return=f,_n=h;else t:for(f=e;_n!==null;){h=_n;var b=h.sibling,w=h.return;if(ru(h),h===f){_n=null;break t}if(b!==null){b.return=w,_n=b;break t}_n=w}}}var w0={getCacheForType:function(e){var i=bn(Xn),f=i.data.get(e);return f===void 0&&(f=e(),i.data.set(e,f)),f},cacheSignal:function(){return bn(Xn).controller.signal}},ra=typeof WeakMap=="function"?WeakMap:Map,ce=0,xe=null,ve=null,Oe=0,un=0,Ta=null,Mi=!1,Nr=!1,Kl=!1,Si=0,mn=0,hs=0,Re=0,hn=0,he=0,Ne=0,Ke=null,vn=null,ir=!1,Mr=0,Lc=0,bi=1/0,En=null,za=null,Cn=0,rr=null,ya=null,Fa=0,rl=0,Aa=null,Gc=null,sl=0,ll=null;function wa(){return(ce&2)!==0&&Oe!==0?Oe&-Oe:U.T!==null?Kg():Ut()}function Dr(){if(he===0)if((Oe&536870912)===0||Ge){var e=An;An<<=1,(An&3932160)===0&&(An=262144),he=e}else he=536870912;return e=On.current,e!==null&&(e.flags|=32),he}function nn(e,i,f){(e===xe&&(un===2||un===9)||e.cancelPendingCommit!==null)&&(lr(e,0),sr(e,Oe,he,!1)),It(e,f),((ce&2)===0||e!==xe)&&(e===xe&&((ce&2)===0&&(Re|=f),mn===4&&sr(e,Oe,he,!1)),ps(e))}function jr(e,i,f){if((ce&6)!==0)throw Error(a(327));var h=!f&&(i&127)===0&&(i&e.expiredLanes)===0||Hr(e,i),b=h?nt(e,i):x(e,i,!0),w=h;do{if(b===0){Nr&&!h&&sr(e,i,0,!1);break}else{if(f=e.current.alternate,w&&!Ql(f)){b=x(e,i,!1),w=!1;continue}if(b===2){if(w=i,e.errorRecoveryDisabledLanes&w)var q=0;else q=e.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){i=q;t:{var $=e;b=Ke;var ot=$.current.memoizedState.isDehydrated;if(ot&&(lr($,q).flags|=256),q=x($,q,!1),q!==2){if(Kl&&!ot){$.errorRecoveryDisabledLanes|=w,Re|=w,b=4;break t}w=vn,vn=b,w!==null&&(vn===null?vn=w:vn.push.apply(vn,w))}b=q}if(w=!1,b!==2)continue}}if(b===1){lr(e,0),sr(e,i,0,!0);break}t:{switch(h=e,w=b,w){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:sr(h,i,he,!Mi);break t;case 2:vn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(b=Mr+300-me(),10<b)){if(sr(h,i,he,!Mi),Li(h,0,!0)!==0)break t;Fa=i,h.timeoutHandle=Mv(ol.bind(null,h,f,vn,En,ir,i,he,Re,Ne,Mi,w,"Throttled",-0,0),b);break t}ol(h,f,vn,En,ir,i,he,Re,Ne,Mi,w,null,-0,0)}}break}while(!0);ps(e)}function ol(e,i,f,h,b,w,q,$,ot,St,Rt,Mt,Et,At){if(e.timeoutHandle=-1,Mt=i.subtreeFlags,Mt&8192||(Mt&16785408)===16785408){Mt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ha},jh(i,w,Mt);var ee=(w&62914560)===w?Mr-me():(w&4194048)===w?Lc-me():0;if(ee=t4(Mt,ee),ee!==null){Fa=w,e.cancelPendingCommit=ee(Te.bind(null,e,i,w,f,h,b,q,$,ot,Rt,Mt,null,Et,At)),sr(e,w,q,!St);return}}Te(e,i,w,f,h,b,q,$,ot)}function Ql(e){for(var i=e;;){var f=i.tag;if((f===0||f===11||f===15)&&i.flags&16384&&(f=i.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var h=0;h<f.length;h++){var b=f[h],w=b.getSnapshot;b=b.value;try{if(!ca(w(),b))return!1}catch{return!1}}if(f=i.child,i.subtreeFlags&16384&&f!==null)f.return=i,i=f;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function sr(e,i,f,h){i&=~hn,i&=~Re,e.suspendedLanes|=i,e.pingedLanes&=~i,h&&(e.warmLanes|=i),h=e.expirationTimes;for(var b=i;0<b;){var w=31-Se(b),q=1<<w;h[w]=-1,b&=~q}f!==0&&ae(e,f,i)}function Xl(){return(ce&6)===0?(Uh(0),!1):!0}function Pc(){if(ve!==null){if(un===0)var e=ve.return;else e=ve,Oi=Ie=null,oh(e),es=null,Vo=0,e=ve;for(;e!==null;)nu(e.alternate,e),e=e.return;ve=null}}function lr(e,i){var f=e.timeoutHandle;f!==-1&&(e.timeoutHandle=-1,zb(f)),f=e.cancelPendingCommit,f!==null&&(e.cancelPendingCommit=null,f()),Fa=0,Pc(),xe=e,ve=f=Ci(e.current,null),Oe=i,un=0,Ta=null,Mi=!1,Nr=Hr(e,i),Kl=!1,Ne=he=hn=Re=hs=mn=0,vn=Ke=null,ir=!1,(i&8)!==0&&(i|=i&32);var h=e.entangledLanes;if(h!==0)for(e=e.entanglements,h&=i;0<h;){var b=31-Se(h),w=1<<b;i|=e[b],h&=~w}return Si=i,zo(),f}function Hc(e,i){Ce=null,U.H=Il,i===Bs||i===fc?(i=dc(),un=3):i===ko?(i=dc(),un=4):un=i===Ah?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Ta=i,ve===null&&(mn=1,xc(e,ni(i,e.current)))}function s(){var e=On.current;return e===null?!0:(Oe&4194048)===Oe?mi===null:(Oe&62914560)===Oe||(Oe&536870912)!==0?e===mi:!1}function u(){var e=U.H;return U.H=Il,e===null?Il:e}function p(){var e=U.A;return U.A=w0,e}function S(){mn=4,Mi||(Oe&4194048)!==Oe&&On.current!==null||(Nr=!0),(hs&134217727)===0&&(Re&134217727)===0||xe===null||sr(xe,Oe,he,!1)}function x(e,i,f){var h=ce;ce|=2;var b=u(),w=p();(xe!==e||Oe!==i)&&(En=null,lr(e,i)),i=!1;var q=mn;t:do try{if(un!==0&&ve!==null){var $=ve,ot=Ta;switch(un){case 8:Pc(),q=6;break t;case 3:case 2:case 9:case 6:On.current===null&&(i=!0);var St=un;if(un=0,Ta=null,Pt(e,$,ot,St),f&&Nr){q=0;break t}break;default:St=un,un=0,Ta=null,Pt(e,$,ot,St)}}H(),q=mn;break}catch(Rt){Hc(e,Rt)}while(!0);return i&&e.shellSuspendCounter++,Oi=Ie=null,ce=h,U.H=b,U.A=w,ve===null&&(xe=null,Oe=0,zo()),q}function H(){for(;ve!==null;)_t(ve)}function nt(e,i){var f=ce;ce|=2;var h=u(),b=p();xe!==e||Oe!==i?(En=null,bi=me()+500,lr(e,i)):Nr=Hr(e,i);t:do try{if(un!==0&&ve!==null){i=ve;var w=Ta;e:switch(un){case 1:un=0,Ta=null,Pt(e,i,w,1);break;case 2:case 9:if(br(w)){un=0,Ta=null,jt(i);break}i=function(){un!==2&&un!==9||xe!==e||(un=7),ps(e)},w.then(i,i);break t;case 3:un=7;break t;case 4:un=5;break t;case 7:br(w)?(un=0,Ta=null,jt(i)):(un=0,Ta=null,Pt(e,i,w,7));break;case 5:var q=null;switch(ve.tag){case 26:q=ve.memoizedState;case 5:case 27:var $=ve;if(q?Kv(q):$.stateNode.complete){un=0,Ta=null;var ot=$.sibling;if(ot!==null)ve=ot;else{var St=$.return;St!==null?(ve=St,Zt(St)):ve=null}break e}}un=0,Ta=null,Pt(e,i,w,5);break;case 6:un=0,Ta=null,Pt(e,i,w,6);break;case 8:Pc(),mn=6;break t;default:throw Error(a(462))}}ut();break}catch(Rt){Hc(e,Rt)}while(!0);return Oi=Ie=null,U.H=h,U.A=b,ce=f,ve!==null?0:(xe=null,Oe=0,zo(),mn)}function ut(){for(;ve!==null&&!be();)_t(ve)}function _t(e){var i=us(e.alternate,e,Si);e.memoizedProps=e.pendingProps,i===null?Zt(e):ve=i}function jt(e){var i=e,f=i.alternate;switch(i.tag){case 15:case 0:i=oi(f,i,i.pendingProps,i.type,void 0,Oe);break;case 11:i=oi(f,i,i.pendingProps,i.type.render,i.ref,Oe);break;case 5:oh(i);default:nu(f,i),i=ve=nc(i,Si),i=us(f,i,Si)}e.memoizedProps=e.pendingProps,i===null?Zt(e):ve=i}function Pt(e,i,f,h){Oi=Ie=null,oh(i),es=null,Vo=0;var b=i.return;try{if(Th(e,b,i,f,Oe)){mn=1,xc(e,ni(f,e.current)),ve=null;return}}catch(w){if(b!==null)throw ve=b,w;mn=1,xc(e,ni(f,e.current)),ve=null;return}i.flags&32768?(Ge||h===1?e=!0:Nr||(Oe&536870912)!==0?e=!1:(Mi=e=!0,(h===2||h===9||h===3||h===6)&&(h=On.current,h!==null&&h.tag===13&&(h.flags|=16384))),Wt(i,e)):Zt(i)}function Zt(e){var i=e;do{if((i.flags&32768)!==0){Wt(i,Mi);return}e=i.return;var f=Vl(i.alternate,i,Si);if(f!==null){ve=f;return}if(i=i.sibling,i!==null){ve=i;return}ve=i=e}while(i!==null);mn===0&&(mn=5)}function Wt(e,i){do{var f=xh(e.alternate,e);if(f!==null){f.flags&=32767,ve=f;return}if(f=e.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!i&&(e=e.sibling,e!==null)){ve=e;return}ve=e=f}while(e!==null);mn=6,ve=null}function Te(e,i,f,h,b,w,q,$,ot){e.cancelPendingCommit=null;do pt();while(Cn!==0);if((ce&6)!==0)throw Error(a(327));if(i!==null){if(i===e.current)throw Error(a(177));if(w=i.lanes|i.childLanes,w|=pi,ne(e,f,w,q,$,ot),e===xe&&(ve=xe=null,Oe=0),ya=i,rr=e,Fa=f,rl=w,Aa=b,Gc=h,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,gs(ft,function(){return Tt(),null})):(e.callbackNode=null,e.callbackPriority=0),h=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||h){h=U.T,U.T=null,b=I.p,I.p=2,q=ce,ce|=4;try{Mh(e,i,f)}finally{ce=q,I.p=b,U.T=h}}Cn=1,fi(),Fl(),ds()}}function fi(){if(Cn===1){Cn=0;var e=rr,i=ya,f=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||f){f=U.T,U.T=null;var h=I.p;I.p=2;var b=ce;ce|=4;try{A0(i,e);var w=tp,q=_i(e.containerInfo),$=w.focusedElem,ot=w.selectionRange;if(q!==$&&$&&$.ownerDocument&&Ol($.ownerDocument.documentElement,$)){if(ot!==null&&Wu($)){var St=ot.start,Rt=ot.end;if(Rt===void 0&&(Rt=St),"selectionStart"in $)$.selectionStart=St,$.selectionEnd=Math.min(Rt,$.value.length);else{var Mt=$.ownerDocument||document,Et=Mt&&Mt.defaultView||window;if(Et.getSelection){var At=Et.getSelection(),ee=$.textContent.length,de=Math.min(ot.start,ee),Sn=ot.end===void 0?de:Math.min(ot.end,ee);!At.extend&&de>Sn&&(q=Sn,Sn=de,de=q);var mt=If($,de),dt=If($,Sn);if(mt&&dt&&(At.rangeCount!==1||At.anchorNode!==mt.node||At.anchorOffset!==mt.offset||At.focusNode!==dt.node||At.focusOffset!==dt.offset)){var yt=Mt.createRange();yt.setStart(mt.node,mt.offset),At.removeAllRanges(),de>Sn?(At.addRange(yt),At.extend(dt.node,dt.offset)):(yt.setEnd(dt.node,dt.offset),At.addRange(yt))}}}}for(Mt=[],At=$;At=At.parentNode;)At.nodeType===1&&Mt.push({element:At,left:At.scrollLeft,top:At.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<Mt.length;$++){var Nt=Mt[$];Nt.element.scrollLeft=Nt.left,Nt.element.scrollTop=Nt.top}}L0=!!$g,tp=$g=null}finally{ce=b,I.p=h,U.T=f}}e.current=i,Cn=2}}function Fl(){if(Cn===2){Cn=0;var e=rr,i=ya,f=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||f){f=U.T,U.T=null;var h=I.p;I.p=2;var b=ce;ce|=4;try{Js(e,i.alternate,i)}finally{ce=b,I.p=h,U.T=f}}Cn=3}}function ds(){if(Cn===4||Cn===3){Cn=0,ye();var e=rr,i=ya,f=Fa,h=Gc;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Cn=5:(Cn=0,ya=rr=null,bt(e,e.pendingLanes));var b=e.pendingLanes;if(b===0&&(za=null),wn(f),i=i.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(Ct,i,void 0,(i.current.flags&128)===128)}catch{}if(h!==null){i=U.T,b=I.p,I.p=2,U.T=null;try{for(var w=e.onRecoverableError,q=0;q<h.length;q++){var $=h[q];w($.value,{componentStack:$.stack})}}finally{U.T=i,I.p=b}}(Fa&3)!==0&&pt(),ps(e),b=e.pendingLanes,(f&261930)!==0&&(b&42)!==0?e===ll?sl++:(sl=0,ll=e):sl=0,Uh(0)}}function bt(e,i){(e.pooledCacheLanes&=i)===0&&(i=e.pooledCache,i!=null&&(e.pooledCache=null,Bl(i)))}function pt(){return fi(),Fl(),ds(),Tt()}function Tt(){if(Cn!==5)return!1;var e=rr,i=rl;rl=0;var f=wn(Fa),h=U.T,b=I.p;try{I.p=32>f?32:f,U.T=null,f=Aa,Aa=null;var w=rr,q=Fa;if(Cn=0,ya=rr=null,Fa=0,(ce&6)!==0)throw Error(a(331));var $=ce;if(ce|=4,ar(w.current),ci(w,w.current,q,f),ce=$,Uh(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(Ct,w)}catch{}return!0}finally{I.p=b,U.T=h,bt(e,i)}}function Ht(e,i,f){i=ni(f,i),i=li(e.stateNode,i,2),e=as(e,i,2),e!==null&&(It(e,2),ps(e))}function Ft(e,i,f){if(e.tag===3)Ht(e,e,f);else for(;i!==null;){if(i.tag===3){Ht(i,e,f);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(za===null||!za.has(h))){e=ni(f,e),f=Ch(2),h=as(i,f,2),h!==null&&(E0(f,h,i,e),It(h,2),ps(h));break}}i=i.return}}function dn(e,i,f){var h=e.pingCache;if(h===null){h=e.pingCache=new ra;var b=new Set;h.set(i,b)}else b=h.get(i),b===void 0&&(b=new Set,h.set(i,b));b.has(f)||(Kl=!0,b.add(f),e=ge.bind(null,e,i,f),i.then(e,e))}function ge(e,i,f){var h=e.pingCache;h!==null&&h.delete(i),e.pingedLanes|=e.suspendedLanes&f,e.warmLanes&=~f,xe===e&&(Oe&f)===f&&(mn===4||mn===3&&(Oe&62914560)===Oe&&300>me()-Mr?(ce&2)===0&&lr(e,0):hn|=f,Ne===Oe&&(Ne=0)),ps(e)}function Qe(e,i){i===0&&(i=vl()),e=ei(e,i),e!==null&&(It(e,i),ps(e))}function sa(e){var i=e.memoizedState,f=0;i!==null&&(f=i.retryLane),Qe(e,f)}function Je(e,i){var f=0;switch(e.tag){case 31:case 13:var h=e.stateNode,b=e.memoizedState;b!==null&&(f=b.retryLane);break;case 19:h=e.stateNode;break;case 22:h=e.stateNode._retryCache;break;default:throw Error(a(314))}h!==null&&h.delete(i),Qe(e,f)}function gs(e,i){return xt(e,i)}var Ic=null,kc=null,Vg=!1,O0=!1,Yg=!1,Jl=0;function ps(e){e!==kc&&e.next===null&&(kc===null?Ic=kc=e:kc=kc.next=e),O0=!0,Vg||(Vg=!0,Ab())}function Uh(e,i){if(!Yg&&O0){Yg=!0;do for(var f=!1,h=Ic;h!==null;){if(e!==0){var b=h.pendingLanes;if(b===0)var w=0;else{var q=h.suspendedLanes,$=h.pingedLanes;w=(1<<31-Se(42|e)+1)-1,w&=b&~(q&~$),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(f=!0,bv(h,w))}else w=Oe,w=Li(h,h===xe?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||Hr(h,w)||(f=!0,bv(h,w));h=h.next}while(f);Yg=!1}}function Tb(){vv()}function vv(){O0=Vg=!1;var e=0;Jl!==0&&Bb()&&(e=Jl);for(var i=me(),f=null,h=Ic;h!==null;){var b=h.next,w=yv(h,i);w===0?(h.next=null,f===null?Ic=b:f.next=b,b===null&&(kc=f)):(f=h,(e!==0||(w&3)!==0)&&(O0=!0)),h=b}Cn!==0&&Cn!==5||Uh(e),Jl!==0&&(Jl=0)}function yv(e,i){for(var f=e.suspendedLanes,h=e.pingedLanes,b=e.expirationTimes,w=e.pendingLanes&-62914561;0<w;){var q=31-Se(w),$=1<<q,ot=b[q];ot===-1?(($&f)===0||($&h)!==0)&&(b[q]=Gi($,i)):ot<=i&&(e.expiredLanes|=$),w&=~$}if(i=xe,f=Oe,f=Li(e,e===i?f:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h=e.callbackNode,f===0||e===i&&(un===2||un===9)||e.cancelPendingCommit!==null)return h!==null&&h!==null&&Xt(h),e.callbackNode=null,e.callbackPriority=0;if((f&3)===0||Hr(e,f)){if(i=f&-f,i===e.callbackPriority)return i;switch(h!==null&&Xt(h),wn(f)){case 2:case 8:f=Ue;break;case 32:f=ft;break;case 268435456:f=ht;break;default:f=ft}return h=Sv.bind(null,e),f=xt(f,h),e.callbackPriority=i,e.callbackNode=f,i}return h!==null&&h!==null&&Xt(h),e.callbackPriority=2,e.callbackNode=null,2}function Sv(e,i){if(Cn!==0&&Cn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var f=e.callbackNode;if(pt()&&e.callbackNode!==f)return null;var h=Oe;return h=Li(e,e===xe?h:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),h===0?null:(jr(e,h,i),yv(e,me()),e.callbackNode!=null&&e.callbackNode===f?Sv.bind(null,e):null)}function bv(e,i){if(pt())return null;jr(e,i,!0)}function Ab(){Lb(function(){(ce&6)!==0?xt(Ye,Tb):vv()})}function Kg(){if(Jl===0){var e=Ds;e===0&&(e=sn,sn<<=1,(sn&261888)===0&&(sn=256)),Jl=e}return Jl}function _v(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:_o(""+e)}function Ev(e,i){var f=i.ownerDocument.createElement("input");return f.name=i.name,f.value=i.value,e.id&&f.setAttribute("form",e.id),i.parentNode.insertBefore(f,i),e=new FormData(e),f.parentNode.removeChild(f),e}function wb(e,i,f,h,b){if(i==="submit"&&f&&f.stateNode===b){var w=_v((b[ln]||null).action),q=h.submitter;q&&(i=(i=q[ln]||null)?_v(i.formAction):q.getAttribute("formAction"),i!==null&&(w=i,q=null));var $=new Pu("action","action",null,h,b);e.push({event:$,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Jl!==0){var ot=q?Ev(b,q):new FormData(b);wc(f,{pending:!0,data:ot,method:b.method,action:w},null,ot)}}else typeof w=="function"&&($.preventDefault(),ot=q?Ev(b,q):new FormData(b),wc(f,{pending:!0,data:ot,method:b.method,action:w},w,ot))},currentTarget:b}]})}}for(var Qg=0;Qg<ki.length;Qg++){var Xg=ki[Qg],Ob=Xg.toLowerCase(),Rb=Xg[0].toUpperCase()+Xg.slice(1);ha(Ob,"on"+Rb)}ha(tc,"onAnimationEnd"),ha(Yf,"onAnimationIteration"),ha(Hd,"onAnimationStart"),ha("dblclick","onDoubleClick"),ha("focusin","onFocus"),ha("focusout","onBlur"),ha(Kf,"onTransitionRun"),ha(Ra,"onTransitionStart"),ha(Id,"onTransitionCancel"),ha(xa,"onTransitionEnd"),Wn("onMouseEnter",["mouseout","mouseover"]),Wn("onMouseLeave",["mouseout","mouseover"]),Wn("onPointerEnter",["pointerout","pointerover"]),Wn("onPointerLeave",["pointerout","pointerover"]),fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fr("onBeforeInput",["compositionend","keypress","textInput","paste"]),fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bh));function Cv(e,i){i=(i&4)!==0;for(var f=0;f<e.length;f++){var h=e[f],b=h.event;h=h.listeners;t:{var w=void 0;if(i)for(var q=h.length-1;0<=q;q--){var $=h[q],ot=$.instance,St=$.currentTarget;if($=$.listener,ot!==w&&b.isPropagationStopped())break t;w=$,b.currentTarget=St;try{w(b)}catch(Rt){Ei(Rt)}b.currentTarget=null,w=ot}else for(q=0;q<h.length;q++){if($=h[q],ot=$.instance,St=$.currentTarget,$=$.listener,ot!==w&&b.isPropagationStopped())break t;w=$,b.currentTarget=St;try{w(b)}catch(Rt){Ei(Rt)}b.currentTarget=null,w=ot}}}}function ke(e,i){var f=i[ys];f===void 0&&(f=i[ys]=new Set);var h=e+"__bubble";f.has(h)||(Tv(i,e,2,!1),f.add(h))}function Fg(e,i,f){var h=0;i&&(h|=4),Tv(f,e,h,i)}var R0="_reactListening"+Math.random().toString(36).slice(2);function Jg(e){if(!e[R0]){e[R0]=!0,Ou.forEach(function(f){f!=="selectionchange"&&(xb.has(f)||Fg(f,!1,e),Fg(f,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[R0]||(i[R0]=!0,Fg("selectionchange",!1,i))}}function Tv(e,i,f,h){switch($v(i)){case 2:var b=a4;break;case 8:b=i4;break;default:b=fp}f=b.bind(null,i,f,e),b=void 0,!zu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(b=!0),h?b!==void 0?e.addEventListener(i,f,{capture:!0,passive:b}):e.addEventListener(i,f,!0):b!==void 0?e.addEventListener(i,f,{passive:b}):e.addEventListener(i,f,!1)}function Zg(e,i,f,h,b){var w=h;if((i&1)===0&&(i&2)===0&&h!==null)t:for(;;){if(h===null)return;var q=h.tag;if(q===3||q===4){var $=h.stateNode.containerInfo;if($===b)break;if(q===4)for(q=h.return;q!==null;){var ot=q.tag;if((ot===3||ot===4)&&q.stateNode.containerInfo===b)return;q=q.return}for(;$!==null;){if(q=Ir($),q===null)return;if(ot=q.tag,ot===5||ot===6||ot===26||ot===27){h=w=q;continue t}$=$.parentNode}}h=h.return}xf(function(){var St=w,Rt=Uu(f),Mt=[];t:{var Et=Qf.get(e);if(Et!==void 0){var At=Pu,ee=e;switch(e){case"keypress":if(Eo(f)===0)break t;case"keydown":case"keyup":At=jf;break;case"focusin":ee="focus",At=ku;break;case"focusout":ee="blur",At=ku;break;case"beforeblur":case"afterblur":At=ku;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":At=Mf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":At=Oo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":At=ua;break;case tc:case Yf:case Hd:At=Kr;break;case xa:At=Dd;break;case"scroll":case"scrollend":At=Td;break;case"wheel":At=Ud;break;case"copy":case"cut":case"paste":At=Qr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":At=Uf;break;case"toggle":case"beforetoggle":At=qu}var de=(i&4)!==0,Sn=!de&&(e==="scroll"||e==="scrollend"),mt=de?Et!==null?Et+"Capture":null:Et;de=[];for(var dt=St,yt;dt!==null;){var Nt=dt;if(yt=Nt.stateNode,Nt=Nt.tag,Nt!==5&&Nt!==26&&Nt!==27||yt===null||mt===null||(Nt=El(dt,mt),Nt!=null&&de.push(zh(dt,Nt,yt))),Sn)break;dt=dt.return}0<de.length&&(Et=new At(Et,ee,null,f,Rt),Mt.push({event:Et,listeners:de}))}}if((i&7)===0){t:{if(Et=e==="mouseover"||e==="pointerover",At=e==="mouseout"||e==="pointerout",Et&&f!==_l&&(ee=f.relatedTarget||f.fromElement)&&(Ir(ee)||ee[oa]))break t;if((At||Et)&&(Et=Rt.window===Rt?Rt:(Et=Rt.ownerDocument)?Et.defaultView||Et.parentWindow:window,At?(ee=f.relatedTarget||f.toElement,At=St,ee=ee?Ir(ee):null,ee!==null&&(Sn=l(ee),de=ee.tag,ee!==Sn||de!==5&&de!==27&&de!==6)&&(ee=null)):(At=null,ee=St),At!==ee)){if(de=Mf,Nt="onMouseLeave",mt="onMouseEnter",dt="mouse",(e==="pointerout"||e==="pointerover")&&(de=Uf,Nt="onPointerLeave",mt="onPointerEnter",dt="pointer"),Sn=At==null?Et:yl(At),yt=ee==null?Et:yl(ee),Et=new de(Nt,dt+"leave",At,f,Rt),Et.target=Sn,Et.relatedTarget=yt,Nt=null,Ir(Rt)===St&&(de=new de(mt,dt+"enter",ee,f,Rt),de.target=yt,de.relatedTarget=Sn,Nt=de),Sn=Nt,At&&ee)e:{for(de=Nb,mt=At,dt=ee,yt=0,Nt=mt;Nt;Nt=de(Nt))yt++;Nt=0;for(var le=dt;le;le=de(le))Nt++;for(;0<yt-Nt;)mt=de(mt),yt--;for(;0<Nt-yt;)dt=de(dt),Nt--;for(;yt--;){if(mt===dt||dt!==null&&mt===dt.alternate){de=mt;break e}mt=de(mt),dt=de(dt)}de=null}else de=null;At!==null&&Av(Mt,Et,At,de,!1),ee!==null&&Sn!==null&&Av(Mt,Sn,ee,de,!0)}}t:{if(Et=St?yl(St):window,At=Et.nodeName&&Et.nodeName.toLowerCase(),At==="select"||At==="input"&&Et.type==="file")var an=Fu;else if(Ii(Et))if(Gf)an=Lg;else{an=jn;var ie=Uo}else At=Et.nodeName,!At||At.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?St&&ju(St.elementType)&&(an=Fu):an=zg;if(an&&(an=an(e,St))){Xu(Mt,an,f,Rt);break t}ie&&ie(e,Et,St),e==="focusout"&&St&&Et.type==="number"&&St.memoizedProps.value!=null&&Cf(Et,"number",Et.value)}switch(ie=St?yl(St):window,e){case"focusin":(Ii(ie)||ie.contentEditable==="true")&&(As=ie,Bo=St,ws=null);break;case"focusout":ws=Bo=As=null;break;case"mousedown":Rl=!0;break;case"contextmenu":case"mouseup":case"dragend":Rl=!1,qf(Mt,f,Rt);break;case"selectionchange":if(kf)break;case"keydown":case"keyup":qf(Mt,f,Rt)}var Me;if(Vu)t:{switch(e){case"compositionstart":var qe="onCompositionStart";break t;case"compositionend":qe="onCompositionEnd";break t;case"compositionupdate":qe="onCompositionUpdate";break t}qe=void 0}else Xr?Qu(e,f)&&(qe="onCompositionEnd"):e==="keydown"&&f.keyCode===229&&(qe="onCompositionStart");qe&&(Yu&&f.locale!=="ko"&&(Xr||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&Xr&&(Me=Nf()):(dr=Rt,Lu="value"in dr?dr.value:dr.textContent,Xr=!0)),ie=x0(St,qe),0<ie.length&&(qe=new Ro(qe,e,null,f,Rt),Mt.push({event:qe,listeners:ie}),Me?qe.data=Me:(Me=xo(f),Me!==null&&(qe.data=Me)))),(Me=zd?Ld(e,f):Lf(e,f))&&(qe=x0(St,"onBeforeInput"),0<qe.length&&(ie=new Ro("onBeforeInput","beforeinput",null,f,Rt),Mt.push({event:ie,listeners:qe}),ie.data=Me)),wb(Mt,e,St,f,Rt)}Cv(Mt,i)})}function zh(e,i,f){return{instance:e,listener:i,currentTarget:f}}function x0(e,i){for(var f=i+"Capture",h=[];e!==null;){var b=e,w=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||w===null||(b=El(e,f),b!=null&&h.unshift(zh(e,b,w)),b=El(e,i),b!=null&&h.push(zh(e,b,w))),e.tag===3)return h;e=e.return}return[]}function Nb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Av(e,i,f,h,b){for(var w=i._reactName,q=[];f!==null&&f!==h;){var $=f,ot=$.alternate,St=$.stateNode;if($=$.tag,ot!==null&&ot===h)break;$!==5&&$!==26&&$!==27||St===null||(ot=St,b?(St=El(f,w),St!=null&&q.unshift(zh(f,St,ot))):b||(St=El(f,w),St!=null&&q.push(zh(f,St,ot)))),f=f.return}q.length!==0&&e.push({event:i,listeners:q})}var Mb=/\r\n?/g,Db=/\u0000|\uFFFD/g;function wv(e){return(typeof e=="string"?e:""+e).replace(Mb,`
`).replace(Db,"")}function Ov(e,i){return i=wv(i),wv(e)===i}function yn(e,i,f,h,b,w){switch(f){case"children":typeof h=="string"?i==="body"||i==="textarea"&&h===""||qr(e,h):(typeof h=="number"||typeof h=="bigint")&&i!=="body"&&qr(e,""+h);break;case"className":hi(e,"class",h);break;case"tabIndex":hi(e,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":hi(e,f,h);break;case"style":Of(e,h,w);break;case"data":if(i!=="object"){hi(e,"data",h);break}case"src":case"href":if(h===""&&(i!=="a"||f!=="href")){e.removeAttribute(f);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(f);break}h=_o(""+h),e.setAttribute(f,h);break;case"action":case"formAction":if(typeof h=="function"){e.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(f==="formAction"?(i!=="input"&&yn(e,i,"name",b.name,b,null),yn(e,i,"formEncType",b.formEncType,b,null),yn(e,i,"formMethod",b.formMethod,b,null),yn(e,i,"formTarget",b.formTarget,b,null)):(yn(e,i,"encType",b.encType,b,null),yn(e,i,"method",b.method,b,null),yn(e,i,"target",b.target,b,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){e.removeAttribute(f);break}h=_o(""+h),e.setAttribute(f,h);break;case"onClick":h!=null&&(e.onclick=Ha);break;case"onScroll":h!=null&&ke("scroll",e);break;case"onScrollEnd":h!=null&&ke("scrollend",e);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(f=h.__html,f!=null){if(b.children!=null)throw Error(a(60));e.innerHTML=f}}break;case"multiple":e.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":e.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){e.removeAttribute("xlink:href");break}f=_o(""+h),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,""+h):e.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,""):e.removeAttribute(f);break;case"capture":case"download":h===!0?e.setAttribute(f,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?e.setAttribute(f,h):e.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?e.setAttribute(f,h):e.removeAttribute(f);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?e.removeAttribute(f):e.setAttribute(f,h);break;case"popover":ke("beforetoggle",e),ke("toggle",e),bl(e,"popover",h);break;case"xlinkActuate":di(e,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":di(e,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":di(e,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":di(e,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":di(e,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":di(e,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":di(e,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":di(e,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":di(e,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":bl(e,"is",h);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Cd.get(f)||f,bl(e,f,h))}}function Wg(e,i,f,h,b,w){switch(f){case"style":Of(e,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(f=h.__html,f!=null){if(b.children!=null)throw Error(a(60));e.innerHTML=f}}break;case"children":typeof h=="string"?qr(e,h):(typeof h=="number"||typeof h=="bigint")&&qr(e,""+h);break;case"onScroll":h!=null&&ke("scroll",e);break;case"onScrollEnd":h!=null&&ke("scrollend",e);break;case"onClick":h!=null&&(e.onclick=Ha);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ru.hasOwnProperty(f))t:{if(f[0]==="o"&&f[1]==="n"&&(b=f.endsWith("Capture"),i=f.slice(2,b?f.length-7:void 0),w=e[ln]||null,w=w!=null?w[f]:null,typeof w=="function"&&e.removeEventListener(i,w,b),typeof h=="function")){typeof w!="function"&&w!==null&&(f in e?e[f]=null:e.hasAttribute(f)&&e.removeAttribute(f)),e.addEventListener(i,h,b);break t}f in e?e[f]=h:h===!0?e.setAttribute(f,""):bl(e,f,h)}}}function La(e,i,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ke("error",e),ke("load",e);var h=!1,b=!1,w;for(w in f)if(f.hasOwnProperty(w)){var q=f[w];if(q!=null)switch(w){case"src":h=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:yn(e,i,w,q,f,null)}}b&&yn(e,i,"srcSet",f.srcSet,f,null),h&&yn(e,i,"src",f.src,f,null);return;case"input":ke("invalid",e);var $=w=q=b=null,ot=null,St=null;for(h in f)if(f.hasOwnProperty(h)){var Rt=f[h];if(Rt!=null)switch(h){case"name":b=Rt;break;case"type":q=Rt;break;case"checked":ot=Rt;break;case"defaultChecked":St=Rt;break;case"value":w=Rt;break;case"defaultValue":$=Rt;break;case"children":case"dangerouslySetInnerHTML":if(Rt!=null)throw Error(a(137,i));break;default:yn(e,i,h,Rt,f,null)}}Ef(e,w,$,ot,St,q,b,!1);return;case"select":ke("invalid",e),h=q=w=null;for(b in f)if(f.hasOwnProperty(b)&&($=f[b],$!=null))switch(b){case"value":w=$;break;case"defaultValue":q=$;break;case"multiple":h=$;default:yn(e,i,b,$,f,null)}i=w,f=q,e.multiple=!!h,i!=null?_s(e,!!h,i,!1):f!=null&&_s(e,!!h,f,!0);return;case"textarea":ke("invalid",e),w=b=h=null;for(q in f)if(f.hasOwnProperty(q)&&($=f[q],$!=null))switch(q){case"value":h=$;break;case"defaultValue":b=$;break;case"children":w=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(a(91));break;default:yn(e,i,q,$,f,null)}Af(e,h,b,w);return;case"option":for(ot in f)if(f.hasOwnProperty(ot)&&(h=f[ot],h!=null))switch(ot){case"selected":e.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:yn(e,i,ot,h,f,null)}return;case"dialog":ke("beforetoggle",e),ke("toggle",e),ke("cancel",e),ke("close",e);break;case"iframe":case"object":ke("load",e);break;case"video":case"audio":for(h=0;h<Bh.length;h++)ke(Bh[h],e);break;case"image":ke("error",e),ke("load",e);break;case"details":ke("toggle",e);break;case"embed":case"source":case"link":ke("error",e),ke("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(St in f)if(f.hasOwnProperty(St)&&(h=f[St],h!=null))switch(St){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:yn(e,i,St,h,f,null)}return;default:if(ju(i)){for(Rt in f)f.hasOwnProperty(Rt)&&(h=f[Rt],h!==void 0&&Wg(e,i,Rt,h,f,void 0));return}}for($ in f)f.hasOwnProperty($)&&(h=f[$],h!=null&&yn(e,i,$,h,f,null))}function jb(e,i,f,h){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,w=null,q=null,$=null,ot=null,St=null,Rt=null;for(At in f){var Mt=f[At];if(f.hasOwnProperty(At)&&Mt!=null)switch(At){case"checked":break;case"value":break;case"defaultValue":ot=Mt;default:h.hasOwnProperty(At)||yn(e,i,At,null,h,Mt)}}for(var Et in h){var At=h[Et];if(Mt=f[Et],h.hasOwnProperty(Et)&&(At!=null||Mt!=null))switch(Et){case"type":w=At;break;case"name":b=At;break;case"checked":St=At;break;case"defaultChecked":Rt=At;break;case"value":q=At;break;case"defaultValue":$=At;break;case"children":case"dangerouslySetInnerHTML":if(At!=null)throw Error(a(137,i));break;default:At!==Mt&&yn(e,i,Et,At,h,Mt)}}bo(e,q,$,ot,St,Rt,w,b);return;case"select":At=q=$=Et=null;for(w in f)if(ot=f[w],f.hasOwnProperty(w)&&ot!=null)switch(w){case"value":break;case"multiple":At=ot;default:h.hasOwnProperty(w)||yn(e,i,w,null,h,ot)}for(b in h)if(w=h[b],ot=f[b],h.hasOwnProperty(b)&&(w!=null||ot!=null))switch(b){case"value":Et=w;break;case"defaultValue":$=w;break;case"multiple":q=w;default:w!==ot&&yn(e,i,b,w,h,ot)}i=$,f=q,h=At,Et!=null?_s(e,!!f,Et,!1):!!h!=!!f&&(i!=null?_s(e,!!f,i,!0):_s(e,!!f,f?[]:"",!1));return;case"textarea":At=Et=null;for($ in f)if(b=f[$],f.hasOwnProperty($)&&b!=null&&!h.hasOwnProperty($))switch($){case"value":break;case"children":break;default:yn(e,i,$,null,h,b)}for(q in h)if(b=h[q],w=f[q],h.hasOwnProperty(q)&&(b!=null||w!=null))switch(q){case"value":Et=b;break;case"defaultValue":At=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(a(91));break;default:b!==w&&yn(e,i,q,b,h,w)}Tf(e,Et,At);return;case"option":for(var ee in f)if(Et=f[ee],f.hasOwnProperty(ee)&&Et!=null&&!h.hasOwnProperty(ee))switch(ee){case"selected":e.selected=!1;break;default:yn(e,i,ee,null,h,Et)}for(ot in h)if(Et=h[ot],At=f[ot],h.hasOwnProperty(ot)&&Et!==At&&(Et!=null||At!=null))switch(ot){case"selected":e.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:yn(e,i,ot,Et,h,At)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var de in f)Et=f[de],f.hasOwnProperty(de)&&Et!=null&&!h.hasOwnProperty(de)&&yn(e,i,de,null,h,Et);for(St in h)if(Et=h[St],At=f[St],h.hasOwnProperty(St)&&Et!==At&&(Et!=null||At!=null))switch(St){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(a(137,i));break;default:yn(e,i,St,Et,h,At)}return;default:if(ju(i)){for(var Sn in f)Et=f[Sn],f.hasOwnProperty(Sn)&&Et!==void 0&&!h.hasOwnProperty(Sn)&&Wg(e,i,Sn,void 0,h,Et);for(Rt in h)Et=h[Rt],At=f[Rt],!h.hasOwnProperty(Rt)||Et===At||Et===void 0&&At===void 0||Wg(e,i,Rt,Et,h,At);return}}for(var mt in f)Et=f[mt],f.hasOwnProperty(mt)&&Et!=null&&!h.hasOwnProperty(mt)&&yn(e,i,mt,null,h,Et);for(Mt in h)Et=h[Mt],At=f[Mt],!h.hasOwnProperty(Mt)||Et===At||Et==null&&At==null||yn(e,i,Mt,Et,h,At)}function Rv(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Ub(){if(typeof performance.getEntriesByType=="function"){for(var e=0,i=0,f=performance.getEntriesByType("resource"),h=0;h<f.length;h++){var b=f[h],w=b.transferSize,q=b.initiatorType,$=b.duration;if(w&&$&&Rv(q)){for(q=0,$=b.responseEnd,h+=1;h<f.length;h++){var ot=f[h],St=ot.startTime;if(St>$)break;var Rt=ot.transferSize,Mt=ot.initiatorType;Rt&&Rv(Mt)&&(ot=ot.responseEnd,q+=Rt*(ot<$?1:($-St)/(ot-St)))}if(--h,i+=8*(w+q)/(b.duration/1e3),e++,10<e)break}}if(0<e)return i/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var $g=null,tp=null;function N0(e){return e.nodeType===9?e:e.ownerDocument}function xv(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nv(e,i){if(e===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&i==="foreignObject"?0:e}function ep(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var np=null;function Bb(){var e=window.event;return e&&e.type==="popstate"?e===np?!1:(np=e,!0):(np=null,!1)}var Mv=typeof setTimeout=="function"?setTimeout:void 0,zb=typeof clearTimeout=="function"?clearTimeout:void 0,Dv=typeof Promise=="function"?Promise:void 0,Lb=typeof queueMicrotask=="function"?queueMicrotask:typeof Dv<"u"?function(e){return Dv.resolve(null).then(e).catch(Gb)}:Mv;function Gb(e){setTimeout(function(){throw e})}function Zl(e){return e==="head"}function jv(e,i){var f=i,h=0;do{var b=f.nextSibling;if(e.removeChild(f),b&&b.nodeType===8)if(f=b.data,f==="/$"||f==="/&"){if(h===0){e.removeChild(b),Kc(i);return}h--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")h++;else if(f==="html")Lh(e.ownerDocument.documentElement);else if(f==="head"){f=e.ownerDocument.head,Lh(f);for(var w=f.firstChild;w;){var q=w.nextSibling,$=w.nodeName;w[Ss]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&w.rel.toLowerCase()==="stylesheet"||f.removeChild(w),w=q}}else f==="body"&&Lh(e.ownerDocument.body);f=b}while(f);Kc(i)}function Uv(e,i){var f=e;e=0;do{var h=f.nextSibling;if(f.nodeType===1?i?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(i?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),h&&h.nodeType===8)if(f=h.data,f==="/$"){if(e===0)break;e--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||e++;f=h}while(f)}function ap(e){var i=e.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var f=i;switch(i=i.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":ap(f),Dn(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}e.removeChild(f)}}function Pb(e,i,f,h){for(;e.nodeType===1;){var b=f;if(e.nodeName.toLowerCase()!==i.toLowerCase()){if(!h&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(h){if(!e[Ss])switch(i){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(w=e.getAttribute("rel"),w==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(w!==b.rel||e.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||e.getAttribute("title")!==(b.title==null?null:b.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(w=e.getAttribute("src"),(w!==(b.src==null?null:b.src)||e.getAttribute("type")!==(b.type==null?null:b.type)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&w&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(i==="input"&&e.type==="hidden"){var w=b.name==null?null:""+b.name;if(b.type==="hidden"&&e.getAttribute("name")===w)return e}else return e;if(e=or(e.nextSibling),e===null)break}return null}function Hb(e,i,f){if(i==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!f||(e=or(e.nextSibling),e===null))return null;return e}function Bv(e,i){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=or(e.nextSibling),e===null))return null;return e}function ip(e){return e.data==="$?"||e.data==="$~"}function rp(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Ib(e,i){var f=e.ownerDocument;if(e.data==="$~")e._reactRetry=i;else if(e.data!=="$?"||f.readyState!=="loading")i();else{var h=function(){i(),f.removeEventListener("DOMContentLoaded",h)};f.addEventListener("DOMContentLoaded",h),e._reactRetry=h}}function or(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return e}var sp=null;function zv(e){e=e.nextSibling;for(var i=0;e;){if(e.nodeType===8){var f=e.data;if(f==="/$"||f==="/&"){if(i===0)return or(e.nextSibling);i--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||i++}e=e.nextSibling}return null}function Lv(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var f=e.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(i===0)return e;i--}else f!=="/$"&&f!=="/&"||i++}e=e.previousSibling}return null}function Gv(e,i,f){switch(i=N0(f),e){case"html":if(e=i.documentElement,!e)throw Error(a(452));return e;case"head":if(e=i.head,!e)throw Error(a(453));return e;case"body":if(e=i.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function Lh(e){for(var i=e.attributes;i.length;)e.removeAttributeNode(i[0]);Dn(e)}var ur=new Map,Pv=new Set;function M0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ul=I.d;I.d={f:kb,r:qb,D:Vb,C:Yb,L:Kb,m:Qb,X:Fb,S:Xb,M:Jb};function kb(){var e=ul.f(),i=Xl();return e||i}function qb(e){var i=kr(e);i!==null&&i.tag===5&&i.type==="form"?m0(i):ul.r(e)}var qc=typeof document>"u"?null:document;function Hv(e,i,f){var h=qc;if(h&&typeof i=="string"&&i){var b=$a(i);b='link[rel="'+e+'"][href="'+b+'"]',typeof f=="string"&&(b+='[crossorigin="'+f+'"]'),Pv.has(b)||(Pv.add(b),e={rel:e,crossOrigin:f,href:i},h.querySelector(b)===null&&(i=h.createElement("link"),La(i,"link",e),ea(i),h.head.appendChild(i)))}}function Vb(e){ul.D(e),Hv("dns-prefetch",e,null)}function Yb(e,i){ul.C(e,i),Hv("preconnect",e,i)}function Kb(e,i,f){ul.L(e,i,f);var h=qc;if(h&&e&&i){var b='link[rel="preload"][as="'+$a(i)+'"]';i==="image"&&f&&f.imageSrcSet?(b+='[imagesrcset="'+$a(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(b+='[imagesizes="'+$a(f.imageSizes)+'"]')):b+='[href="'+$a(e)+'"]';var w=b;switch(i){case"style":w=Vc(e);break;case"script":w=Yc(e)}ur.has(w)||(e=C({rel:"preload",href:i==="image"&&f&&f.imageSrcSet?void 0:e,as:i},f),ur.set(w,e),h.querySelector(b)!==null||i==="style"&&h.querySelector(Gh(w))||i==="script"&&h.querySelector(Ph(w))||(i=h.createElement("link"),La(i,"link",e),ea(i),h.head.appendChild(i)))}}function Qb(e,i){ul.m(e,i);var f=qc;if(f&&e){var h=i&&typeof i.as=="string"?i.as:"script",b='link[rel="modulepreload"][as="'+$a(h)+'"][href="'+$a(e)+'"]',w=b;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Yc(e)}if(!ur.has(w)&&(e=C({rel:"modulepreload",href:e},i),ur.set(w,e),f.querySelector(b)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Ph(w)))return}h=f.createElement("link"),La(h,"link",e),ea(h),f.head.appendChild(h)}}}function Xb(e,i,f){ul.S(e,i,f);var h=qc;if(h&&e){var b=bs(h).hoistableStyles,w=Vc(e);i=i||"default";var q=b.get(w);if(!q){var $={loading:0,preload:null};if(q=h.querySelector(Gh(w)))$.loading=5;else{e=C({rel:"stylesheet",href:e,"data-precedence":i},f),(f=ur.get(w))&&lp(e,f);var ot=q=h.createElement("link");ea(ot),La(ot,"link",e),ot._p=new Promise(function(St,Rt){ot.onload=St,ot.onerror=Rt}),ot.addEventListener("load",function(){$.loading|=1}),ot.addEventListener("error",function(){$.loading|=2}),$.loading|=4,D0(q,i,h)}q={type:"stylesheet",instance:q,count:1,state:$},b.set(w,q)}}}function Fb(e,i){ul.X(e,i);var f=qc;if(f&&e){var h=bs(f).hoistableScripts,b=Yc(e),w=h.get(b);w||(w=f.querySelector(Ph(b)),w||(e=C({src:e,async:!0},i),(i=ur.get(b))&&op(e,i),w=f.createElement("script"),ea(w),La(w,"link",e),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(b,w))}}function Jb(e,i){ul.M(e,i);var f=qc;if(f&&e){var h=bs(f).hoistableScripts,b=Yc(e),w=h.get(b);w||(w=f.querySelector(Ph(b)),w||(e=C({src:e,async:!0,type:"module"},i),(i=ur.get(b))&&op(e,i),w=f.createElement("script"),ea(w),La(w,"link",e),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(b,w))}}function Iv(e,i,f,h){var b=(b=tt.current)?M0(b):null;if(!b)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(i=Vc(f.href),f=bs(b).hoistableStyles,h=f.get(i),h||(h={type:"style",instance:null,count:0,state:null},f.set(i,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){e=Vc(f.href);var w=bs(b).hoistableStyles,q=w.get(e);if(q||(b=b.ownerDocument||b,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(e,q),(w=b.querySelector(Gh(e)))&&!w._p&&(q.instance=w,q.state.loading=5),ur.has(e)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},ur.set(e,f),w||Zb(b,e,f,q.state))),i&&h===null)throw Error(a(528,""));return q}if(i&&h!==null)throw Error(a(529,""));return null;case"script":return i=f.async,f=f.src,typeof f=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Yc(f),f=bs(b).hoistableScripts,h=f.get(i),h||(h={type:"script",instance:null,count:0,state:null},f.set(i,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Vc(e){return'href="'+$a(e)+'"'}function Gh(e){return'link[rel="stylesheet"]['+e+"]"}function kv(e){return C({},e,{"data-precedence":e.precedence,precedence:null})}function Zb(e,i,f,h){e.querySelector('link[rel="preload"][as="style"]['+i+"]")?h.loading=1:(i=e.createElement("link"),h.preload=i,i.addEventListener("load",function(){return h.loading|=1}),i.addEventListener("error",function(){return h.loading|=2}),La(i,"link",f),ea(i),e.head.appendChild(i))}function Yc(e){return'[src="'+$a(e)+'"]'}function Ph(e){return"script[async]"+e}function qv(e,i,f){if(i.count++,i.instance===null)switch(i.type){case"style":var h=e.querySelector('style[data-href~="'+$a(f.href)+'"]');if(h)return i.instance=h,ea(h),h;var b=C({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return h=(e.ownerDocument||e).createElement("style"),ea(h),La(h,"style",b),D0(h,f.precedence,e),i.instance=h;case"stylesheet":b=Vc(f.href);var w=e.querySelector(Gh(b));if(w)return i.state.loading|=4,i.instance=w,ea(w),w;h=kv(f),(b=ur.get(b))&&lp(h,b),w=(e.ownerDocument||e).createElement("link"),ea(w);var q=w;return q._p=new Promise(function($,ot){q.onload=$,q.onerror=ot}),La(w,"link",h),i.state.loading|=4,D0(w,f.precedence,e),i.instance=w;case"script":return w=Yc(f.src),(b=e.querySelector(Ph(w)))?(i.instance=b,ea(b),b):(h=f,(b=ur.get(w))&&(h=C({},f),op(h,b)),e=e.ownerDocument||e,b=e.createElement("script"),ea(b),La(b,"link",h),e.head.appendChild(b),i.instance=b);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(h=i.instance,i.state.loading|=4,D0(h,f.precedence,e));return i.instance}function D0(e,i,f){for(var h=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=h.length?h[h.length-1]:null,w=b,q=0;q<h.length;q++){var $=h[q];if($.dataset.precedence===i)w=$;else if(w!==b)break}w?w.parentNode.insertBefore(e,w.nextSibling):(i=f.nodeType===9?f.head:f,i.insertBefore(e,i.firstChild))}function lp(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.title==null&&(e.title=i.title)}function op(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.integrity==null&&(e.integrity=i.integrity)}var j0=null;function Vv(e,i,f){if(j0===null){var h=new Map,b=j0=new Map;b.set(f,h)}else b=j0,h=b.get(f),h||(h=new Map,b.set(f,h));if(h.has(e))return h;for(h.set(e,null),f=f.getElementsByTagName(e),b=0;b<f.length;b++){var w=f[b];if(!(w[Ss]||w[ze]||e==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var q=w.getAttribute(i)||"";q=e+q;var $=h.get(q);$?$.push(w):h.set(q,[w])}}return h}function Yv(e,i,f){e=e.ownerDocument||e,e.head.insertBefore(f,i==="title"?e.querySelector("head > title"):null)}function Wb(e,i,f){if(f===1||i.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return e=i.disabled,typeof i.precedence=="string"&&e==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Kv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function $b(e,i,f,h){if(f.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var b=Vc(h.href),w=i.querySelector(Gh(b));if(w){i=w._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(e.count++,e=U0.bind(e),i.then(e,e)),f.state.loading|=4,f.instance=w,ea(w);return}w=i.ownerDocument||i,h=kv(h),(b=ur.get(b))&&lp(h,b),w=w.createElement("link"),ea(w);var q=w;q._p=new Promise(function($,ot){q.onload=$,q.onerror=ot}),La(w,"link",h),f.instance=w}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(f,i),(i=f.state.preload)&&(f.state.loading&3)===0&&(e.count++,f=U0.bind(e),i.addEventListener("load",f),i.addEventListener("error",f))}}var up=0;function t4(e,i){return e.stylesheets&&e.count===0&&z0(e,e.stylesheets),0<e.count||0<e.imgCount?function(f){var h=setTimeout(function(){if(e.stylesheets&&z0(e,e.stylesheets),e.unsuspend){var w=e.unsuspend;e.unsuspend=null,w()}},6e4+i);0<e.imgBytes&&up===0&&(up=62500*Ub());var b=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&z0(e,e.stylesheets),e.unsuspend)){var w=e.unsuspend;e.unsuspend=null,w()}},(e.imgBytes>up?50:800)+i);return e.unsuspend=f,function(){e.unsuspend=null,clearTimeout(h),clearTimeout(b)}}:null}function U0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)z0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var B0=null;function z0(e,i){e.stylesheets=null,e.unsuspend!==null&&(e.count++,B0=new Map,i.forEach(e4,e),B0=null,U0.call(e))}function e4(e,i){if(!(i.state.loading&4)){var f=B0.get(e);if(f)var h=f.get(null);else{f=new Map,B0.set(e,f);for(var b=e.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<b.length;w++){var q=b[w];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(f.set(q.dataset.precedence,q),h=q)}h&&f.set(null,h)}b=i.instance,q=b.getAttribute("data-precedence"),w=f.get(q)||h,w===h&&f.set(null,b),f.set(q,b),this.count++,h=U0.bind(this),b.addEventListener("load",h),b.addEventListener("error",h),w?w.parentNode.insertBefore(b,w.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(b,e.firstChild)),i.state.loading|=4}}var Hh={$$typeof:N,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function n4(e,i,f,h,b,w,q,$,ot){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Lt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lt(0),this.hiddenUpdates=Lt(null),this.identifierPrefix=h,this.onUncaughtError=b,this.onCaughtError=w,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ot,this.incompleteTransitions=new Map}function Qv(e,i,f,h,b,w,q,$,ot,St,Rt,Mt){return e=new n4(e,i,f,q,ot,St,Rt,Mt,$),i=1,w===!0&&(i|=24),w=Ea(3,null,null,i),e.current=w,w.stateNode=e,i=oc(),i.refCount++,e.pooledCache=i,i.refCount++,w.memoizedState={element:h,isDehydrated:f,cache:i},Gs(w),e}function Xv(e){return e?(e=qi,e):qi}function Fv(e,i,f,h,b,w){b=Xv(b),h.context===null?h.context=b:h.pendingContext=b,h=ns(i),h.payload={element:f},w=w===void 0?null:w,w!==null&&(h.callback=w),f=as(e,h,i),f!==null&&(nn(f,e,i),Qo(f,e,i))}function Jv(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var f=e.retryLane;e.retryLane=f!==0&&f<i?f:i}}function cp(e,i){Jv(e,i),(e=e.alternate)&&Jv(e,i)}function Zv(e){if(e.tag===13||e.tag===31){var i=ei(e,67108864);i!==null&&nn(i,e,67108864),cp(e,67108864)}}function Wv(e){if(e.tag===13||e.tag===31){var i=wa();i=Kn(i);var f=ei(e,i);f!==null&&nn(f,e,i),cp(e,i)}}var L0=!0;function a4(e,i,f,h){var b=U.T;U.T=null;var w=I.p;try{I.p=2,fp(e,i,f,h)}finally{I.p=w,U.T=b}}function i4(e,i,f,h){var b=U.T;U.T=null;var w=I.p;try{I.p=8,fp(e,i,f,h)}finally{I.p=w,U.T=b}}function fp(e,i,f,h){if(L0){var b=hp(h);if(b===null)Zg(e,i,h,G0,f),ty(e,h);else if(s4(b,e,i,f,h))h.stopPropagation();else if(ty(e,h),i&4&&-1<r4.indexOf(e)){for(;b!==null;){var w=kr(b);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var q=Ga(w.pendingLanes);if(q!==0){var $=w;for($.pendingLanes|=2,$.entangledLanes|=2;q;){var ot=1<<31-Se(q);$.entanglements[1]|=ot,q&=~ot}ps(w),(ce&6)===0&&(bi=me()+500,Uh(0))}}break;case 31:case 13:$=ei(w,2),$!==null&&nn($,w,2),Xl(),cp(w,2)}if(w=hp(h),w===null&&Zg(e,i,h,G0,f),w===b)break;b=w}b!==null&&h.stopPropagation()}else Zg(e,i,h,null,f)}}function hp(e){return e=Uu(e),dp(e)}var G0=null;function dp(e){if(G0=null,e=Ir(e),e!==null){var i=l(e);if(i===null)e=null;else{var f=i.tag;if(f===13){if(e=c(i),e!==null)return e;e=null}else if(f===31){if(e=d(i),e!==null)return e;e=null}else if(f===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null)}}return G0=e,null}function $v(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case Ye:return 2;case Ue:return 8;case ft:case ct:return 32;case ht:return 268435456;default:return 32}default:return 32}}var gp=!1,Wl=null,$l=null,to=null,Ih=new Map,kh=new Map,eo=[],r4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ty(e,i){switch(e){case"focusin":case"focusout":Wl=null;break;case"dragenter":case"dragleave":$l=null;break;case"mouseover":case"mouseout":to=null;break;case"pointerover":case"pointerout":Ih.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":kh.delete(i.pointerId)}}function qh(e,i,f,h,b,w){return e===null||e.nativeEvent!==w?(e={blockedOn:i,domEventName:f,eventSystemFlags:h,nativeEvent:w,targetContainers:[b]},i!==null&&(i=kr(i),i!==null&&Zv(i)),e):(e.eventSystemFlags|=h,i=e.targetContainers,b!==null&&i.indexOf(b)===-1&&i.push(b),e)}function s4(e,i,f,h,b){switch(i){case"focusin":return Wl=qh(Wl,e,i,f,h,b),!0;case"dragenter":return $l=qh($l,e,i,f,h,b),!0;case"mouseover":return to=qh(to,e,i,f,h,b),!0;case"pointerover":var w=b.pointerId;return Ih.set(w,qh(Ih.get(w)||null,e,i,f,h,b)),!0;case"gotpointercapture":return w=b.pointerId,kh.set(w,qh(kh.get(w)||null,e,i,f,h,b)),!0}return!1}function ey(e){var i=Ir(e.target);if(i!==null){var f=l(i);if(f!==null){if(i=f.tag,i===13){if(i=c(f),i!==null){e.blockedOn=i,je(e.priority,function(){Wv(f)});return}}else if(i===31){if(i=d(f),i!==null){e.blockedOn=i,je(e.priority,function(){Wv(f)});return}}else if(i===3&&f.stateNode.current.memoizedState.isDehydrated){e.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}e.blockedOn=null}function P0(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var f=hp(e.nativeEvent);if(f===null){f=e.nativeEvent;var h=new f.constructor(f.type,f);_l=h,f.target.dispatchEvent(h),_l=null}else return i=kr(f),i!==null&&Zv(i),e.blockedOn=f,!1;i.shift()}return!0}function ny(e,i,f){P0(e)&&f.delete(i)}function l4(){gp=!1,Wl!==null&&P0(Wl)&&(Wl=null),$l!==null&&P0($l)&&($l=null),to!==null&&P0(to)&&(to=null),Ih.forEach(ny),kh.forEach(ny)}function H0(e,i){e.blockedOn===i&&(e.blockedOn=null,gp||(gp=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,l4)))}var I0=null;function ay(e){I0!==e&&(I0=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){I0===e&&(I0=null);for(var i=0;i<e.length;i+=3){var f=e[i],h=e[i+1],b=e[i+2];if(typeof h!="function"){if(dp(h||f)===null)continue;break}var w=kr(f);w!==null&&(e.splice(i,3),i-=3,wc(w,{pending:!0,data:b,method:f.method,action:h},h,b))}}))}function Kc(e){function i(ot){return H0(ot,e)}Wl!==null&&H0(Wl,e),$l!==null&&H0($l,e),to!==null&&H0(to,e),Ih.forEach(i),kh.forEach(i);for(var f=0;f<eo.length;f++){var h=eo[f];h.blockedOn===e&&(h.blockedOn=null)}for(;0<eo.length&&(f=eo[0],f.blockedOn===null);)ey(f),f.blockedOn===null&&eo.shift();if(f=(e.ownerDocument||e).$$reactFormReplay,f!=null)for(h=0;h<f.length;h+=3){var b=f[h],w=f[h+1],q=b[ln]||null;if(typeof w=="function")q||ay(f);else if(q){var $=null;if(w&&w.hasAttribute("formAction")){if(b=w,q=w[ln]||null)$=q.formAction;else if(dp(b)!==null)continue}else $=q.action;typeof $=="function"?f[h+1]=$:(f.splice(h,3),h-=3),ay(f)}}}function iy(){function e(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(q){return b=q})},focusReset:"manual",scroll:"manual"})}function i(){b!==null&&(b(),b=null),h||setTimeout(f,20)}function f(){if(!h&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,b=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(f,100),function(){h=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),b!==null&&(b(),b=null)}}}function pp(e){this._internalRoot=e}k0.prototype.render=pp.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(a(409));var f=i.current,h=wa();Fv(f,h,e,i,null,null)},k0.prototype.unmount=pp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Fv(e.current,2,null,e,null,null),Xl(),i[oa]=null}};function k0(e){this._internalRoot=e}k0.prototype.unstable_scheduleHydration=function(e){if(e){var i=Ut();e={blockedOn:null,target:e,priority:i};for(var f=0;f<eo.length&&i!==0&&i<eo[f].priority;f++);eo.splice(f,0,e),f===0&&ey(e)}};var ry=t.version;if(ry!=="19.2.0")throw Error(a(527,ry,"19.2.0"));I.findDOMNode=function(e){var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=m(i),e=e!==null?_(e):null,e=e===null?null:e.stateNode,e};var o4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var q0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q0.isDisabled&&q0.supportsFiber)try{Ct=q0.inject(o4),zt=q0}catch{}}return Yh.createRoot=function(e,i){if(!r(e))throw Error(a(299));var f=!1,h="",b=tu,w=eu,q=Rc;return i!=null&&(i.unstable_strictMode===!0&&(f=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(b=i.onUncaughtError),i.onCaughtError!==void 0&&(w=i.onCaughtError),i.onRecoverableError!==void 0&&(q=i.onRecoverableError)),i=Qv(e,1,!1,null,null,f,h,null,b,w,q,iy),e[oa]=i.current,Jg(e),new pp(i)},Yh.hydrateRoot=function(e,i,f){if(!r(e))throw Error(a(299));var h=!1,b="",w=tu,q=eu,$=Rc,ot=null;return f!=null&&(f.unstable_strictMode===!0&&(h=!0),f.identifierPrefix!==void 0&&(b=f.identifierPrefix),f.onUncaughtError!==void 0&&(w=f.onUncaughtError),f.onCaughtError!==void 0&&(q=f.onCaughtError),f.onRecoverableError!==void 0&&($=f.onRecoverableError),f.formState!==void 0&&(ot=f.formState)),i=Qv(e,1,!0,i,f??null,h,b,ot,w,q,$,iy),i.context=Xv(null),f=i.current,h=wa(),h=Kn(h),b=ns(h),b.callback=null,as(f,b,h),f=h,i.current.lanes=f,It(i,f),ps(i),e[oa]=i.current,Jg(e),new k0(i)},Yh.version="19.2.0",Yh}var py;function S4(){if(py)return yp.exports;py=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),yp.exports=y4(),yp.exports}var b4=S4();const _4=df(b4);S2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ud(){return ud=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},ud.apply(this,arguments)}var co;(function(o){o.Pop="POP",o.Push="PUSH",o.Replace="REPLACE"})(co||(co={}));const my="popstate";function E4(o){o===void 0&&(o={});function t(a,r){let{pathname:l,search:c,hash:d}=a.location;return Cm("",{pathname:l,search:c,hash:d},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){return typeof r=="string"?r:_2(r)}return T4(t,n,null,o)}function ba(o,t){if(o===!1||o===null||typeof o>"u")throw new Error(t)}function b2(o,t){if(!o){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function C4(){return Math.random().toString(36).substr(2,8)}function vy(o,t){return{usr:o.state,key:o.key,idx:t}}function Cm(o,t,n,a){return n===void 0&&(n=null),ud({pathname:typeof o=="string"?o:o.pathname,search:"",hash:""},typeof t=="string"?gf(t):t,{state:n,key:t&&t.key||a||C4()})}function _2(o){let{pathname:t="/",search:n="",hash:a=""}=o;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function gf(o){let t={};if(o){let n=o.indexOf("#");n>=0&&(t.hash=o.substr(n),o=o.substr(0,n));let a=o.indexOf("?");a>=0&&(t.search=o.substr(a),o=o.substr(0,a)),o&&(t.pathname=o)}return t}function T4(o,t,n,a){a===void 0&&(a={});let{window:r=document.defaultView,v5Compat:l=!1}=a,c=r.history,d=co.Pop,g=null,m=_();m==null&&(m=0,c.replaceState(ud({},c.state,{idx:m}),""));function _(){return(c.state||{idx:null}).idx}function C(){d=co.Pop;let z=_(),L=z==null?null:z-m;m=z,g&&g({action:d,location:M.location,delta:L})}function E(z,L){d=co.Push;let D=Cm(M.location,z,L);m=_()+1;let N=vy(D,m),G=M.createHref(D);try{c.pushState(N,"",G)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;r.location.assign(G)}l&&g&&g({action:d,location:M.location,delta:1})}function O(z,L){d=co.Replace;let D=Cm(M.location,z,L);m=_();let N=vy(D,m),G=M.createHref(D);c.replaceState(N,"",G),l&&g&&g({action:d,location:M.location,delta:0})}function v(z){let L=r.location.origin!=="null"?r.location.origin:r.location.href,D=typeof z=="string"?z:_2(z);return D=D.replace(/ $/,"%20"),ba(L,"No window.location.(origin|href) available to create URL for href: "+D),new URL(D,L)}let M={get action(){return d},get location(){return o(r,c)},listen(z){if(g)throw new Error("A history only accepts one active listener");return r.addEventListener(my,C),g=z,()=>{r.removeEventListener(my,C),g=null}},createHref(z){return t(r,z)},createURL:v,encodeLocation(z){let L=v(z);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:E,replace:O,go(z){return c.go(z)}};return M}var yy;(function(o){o.data="data",o.deferred="deferred",o.redirect="redirect",o.error="error"})(yy||(yy={}));function A4(o,t,n){return n===void 0&&(n="/"),w4(o,t,n)}function w4(o,t,n,a){let r=typeof t=="string"?gf(t):t,l=T2(r.pathname||"/",n);if(l==null)return null;let c=E2(o);O4(c);let d=null;for(let g=0;d==null&&g<c.length;++g){let m=P4(l);d=z4(c[g],m)}return d}function E2(o,t,n,a){t===void 0&&(t=[]),n===void 0&&(n=[]),a===void 0&&(a="");let r=(l,c,d)=>{let g={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};g.relativePath.startsWith("/")&&(ba(g.relativePath.startsWith(a),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(a.length));let m=mu([a,g.relativePath]),_=n.concat(g);l.children&&l.children.length>0&&(ba(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),E2(l.children,t,_,m)),!(l.path==null&&!l.index)&&t.push({path:m,score:U4(m,l.index),routesMeta:_})};return o.forEach((l,c)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))r(l,c);else for(let g of C2(l.path))r(l,c,g)}),t}function C2(o){let t=o.split("/");if(t.length===0)return[];let[n,...a]=t,r=n.endsWith("?"),l=n.replace(/\?$/,"");if(a.length===0)return r?[l,""]:[l];let c=C2(a.join("/")),d=[];return d.push(...c.map(g=>g===""?l:[l,g].join("/"))),r&&d.push(...c),d.map(g=>o.startsWith("/")&&g===""?"/":g)}function O4(o){o.sort((t,n)=>t.score!==n.score?n.score-t.score:B4(t.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}const R4=/^:[\w-]+$/,x4=3,N4=2,M4=1,D4=10,j4=-2,Sy=o=>o==="*";function U4(o,t){let n=o.split("/"),a=n.length;return n.some(Sy)&&(a+=j4),t&&(a+=N4),n.filter(r=>!Sy(r)).reduce((r,l)=>r+(R4.test(l)?x4:l===""?M4:D4),a)}function B4(o,t){return o.length===t.length&&o.slice(0,-1).every((a,r)=>a===t[r])?o[o.length-1]-t[t.length-1]:0}function z4(o,t,n){let{routesMeta:a}=o,r={},l="/",c=[];for(let d=0;d<a.length;++d){let g=a[d],m=d===a.length-1,_=l==="/"?t:t.slice(l.length)||"/",C=L4({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},_),E=g.route;if(!C)return null;Object.assign(r,C.params),c.push({params:r,pathname:mu([l,C.pathname]),pathnameBase:Y4(mu([l,C.pathnameBase])),route:E}),C.pathnameBase!=="/"&&(l=mu([l,C.pathnameBase]))}return c}function L4(o,t){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[n,a]=G4(o.path,o.caseSensitive,o.end),r=t.match(n);if(!r)return null;let l=r[0],c=l.replace(/(.)\/+$/,"$1"),d=r.slice(1);return{params:a.reduce((m,_,C)=>{let{paramName:E,isOptional:O}=_;if(E==="*"){let M=d[C]||"";c=l.slice(0,l.length-M.length).replace(/(.)\/+$/,"$1")}const v=d[C];return O&&!v?m[E]=void 0:m[E]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:c,pattern:o}}function G4(o,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),b2(o==="*"||!o.endsWith("*")||o.endsWith("/*"),'Route path "'+o+'" will be treated as if it were '+('"'+o.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+o.replace(/\*$/,"/*")+'".'));let a=[],r="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,g)=>(a.push({paramName:d,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(a.push({paramName:"*"}),r+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":o!==""&&o!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function P4(o){try{return o.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return b2(!1,'The URL path "'+o+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),o}}function T2(o,t){if(t==="/")return o;if(!o.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=o.charAt(n);return a&&a!=="/"?null:o.slice(n)||"/"}function H4(o,t){t===void 0&&(t="/");let{pathname:n,search:a="",hash:r=""}=typeof o=="string"?gf(o):o;return{pathname:n?n.startsWith("/")?n:I4(n,t):t,search:K4(a),hash:Q4(r)}}function I4(o,t){let n=t.replace(/\/+$/,"").split("/");return o.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Ep(o,t,n,a){return"Cannot include a '"+o+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function k4(o){return o.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function q4(o,t){let n=k4(o);return t?n.map((a,r)=>r===n.length-1?a.pathname:a.pathnameBase):n.map(a=>a.pathnameBase)}function V4(o,t,n,a){a===void 0&&(a=!1);let r;typeof o=="string"?r=gf(o):(r=ud({},o),ba(!r.pathname||!r.pathname.includes("?"),Ep("?","pathname","search",r)),ba(!r.pathname||!r.pathname.includes("#"),Ep("#","pathname","hash",r)),ba(!r.search||!r.search.includes("#"),Ep("#","search","hash",r)));let l=o===""||r.pathname==="",c=l?"/":r.pathname,d;if(c==null)d=n;else{let C=t.length-1;if(!a&&c.startsWith("..")){let E=c.split("/");for(;E[0]==="..";)E.shift(),C-=1;r.pathname=E.join("/")}d=C>=0?t[C]:"/"}let g=H4(r,d),m=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(m||_)&&(g.pathname+="/"),g}const mu=o=>o.join("/").replace(/\/\/+/g,"/"),Y4=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),K4=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,Q4=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function X4(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}const A2=["post","put","patch","delete"];new Set(A2);const F4=["get",...A2];new Set(F4);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cd(){return cd=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},cd.apply(this,arguments)}const Jm=lt.createContext(null),J4=lt.createContext(null),Cg=lt.createContext(null),Tg=lt.createContext(null),pf=lt.createContext({outlet:null,matches:[],isDataRoute:!1}),w2=lt.createContext(null);function Ag(){return lt.useContext(Tg)!=null}function Zm(){return Ag()||ba(!1),lt.useContext(Tg).location}function O2(o){lt.useContext(Cg).static||lt.useLayoutEffect(o)}function mf(){let{isDataRoute:o}=lt.useContext(pf);return o?u3():Z4()}function Z4(){Ag()||ba(!1);let o=lt.useContext(Jm),{basename:t,future:n,navigator:a}=lt.useContext(Cg),{matches:r}=lt.useContext(pf),{pathname:l}=Zm(),c=JSON.stringify(q4(r,n.v7_relativeSplatPath)),d=lt.useRef(!1);return O2(()=>{d.current=!0}),lt.useCallback(function(m,_){if(_===void 0&&(_={}),!d.current)return;if(typeof m=="number"){a.go(m);return}let C=V4(m,JSON.parse(c),l,_.relative==="path");o==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:mu([t,C.pathname])),(_.replace?a.replace:a.push)(C,_.state,_)},[t,a,c,l,o])}function W4(o,t){return $4(o,t)}function $4(o,t,n,a){Ag()||ba(!1);let{navigator:r}=lt.useContext(Cg),{matches:l}=lt.useContext(pf),c=l[l.length-1],d=c?c.params:{};c&&c.pathname;let g=c?c.pathnameBase:"/";c&&c.route;let m=Zm(),_;if(t){var C;let z=typeof t=="string"?gf(t):t;g==="/"||(C=z.pathname)!=null&&C.startsWith(g)||ba(!1),_=z}else _=m;let E=_.pathname||"/",O=E;if(g!=="/"){let z=g.replace(/^\//,"").split("/");O="/"+E.replace(/^\//,"").split("/").slice(z.length).join("/")}let v=A4(o,{pathname:O}),M=i3(v&&v.map(z=>Object.assign({},z,{params:Object.assign({},d,z.params),pathname:mu([g,r.encodeLocation?r.encodeLocation(z.pathname).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?g:mu([g,r.encodeLocation?r.encodeLocation(z.pathnameBase).pathname:z.pathnameBase])})),l,n,a);return t&&M?lt.createElement(Tg.Provider,{value:{location:cd({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:co.Pop}},M):M}function t3(){let o=o3(),t=X4(o)?o.status+" "+o.statusText:o instanceof Error?o.message:JSON.stringify(o),n=o instanceof Error?o.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return lt.createElement(lt.Fragment,null,lt.createElement("h2",null,"Unexpected Application Error!"),lt.createElement("h3",{style:{fontStyle:"italic"}},t),n?lt.createElement("pre",{style:r},n):null,null)}const e3=lt.createElement(t3,null);class n3 extends lt.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?lt.createElement(pf.Provider,{value:this.props.routeContext},lt.createElement(w2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function a3(o){let{routeContext:t,match:n,children:a}=o,r=lt.useContext(Jm);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),lt.createElement(pf.Provider,{value:t},a)}function i3(o,t,n,a){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),a===void 0&&(a=null),o==null){var l;if(!n)return null;if(n.errors)o=n.matches;else if((l=a)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)o=n.matches;else return null}let c=o,d=(r=n)==null?void 0:r.errors;if(d!=null){let _=c.findIndex(C=>C.route.id&&(d==null?void 0:d[C.route.id])!==void 0);_>=0||ba(!1),c=c.slice(0,Math.min(c.length,_+1))}let g=!1,m=-1;if(n&&a&&a.v7_partialHydration)for(let _=0;_<c.length;_++){let C=c[_];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(m=_),C.route.id){let{loaderData:E,errors:O}=n,v=C.route.loader&&E[C.route.id]===void 0&&(!O||O[C.route.id]===void 0);if(C.route.lazy||v){g=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((_,C,E)=>{let O,v=!1,M=null,z=null;n&&(O=d&&C.route.id?d[C.route.id]:void 0,M=C.route.errorElement||e3,g&&(m<0&&E===0?(c3("route-fallback"),v=!0,z=null):m===E&&(v=!0,z=C.route.hydrateFallbackElement||null)));let L=t.concat(c.slice(0,E+1)),D=()=>{let N;return O?N=M:v?N=z:C.route.Component?N=lt.createElement(C.route.Component,null):C.route.element?N=C.route.element:N=_,lt.createElement(a3,{match:C,routeContext:{outlet:_,matches:L,isDataRoute:n!=null},children:N})};return n&&(C.route.ErrorBoundary||C.route.errorElement||E===0)?lt.createElement(n3,{location:n.location,revalidation:n.revalidation,component:M,error:O,children:D(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):D()},null)}var R2=(function(o){return o.UseBlocker="useBlocker",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o})(R2||{}),x2=(function(o){return o.UseBlocker="useBlocker",o.UseLoaderData="useLoaderData",o.UseActionData="useActionData",o.UseRouteError="useRouteError",o.UseNavigation="useNavigation",o.UseRouteLoaderData="useRouteLoaderData",o.UseMatches="useMatches",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o.UseRouteId="useRouteId",o})(x2||{});function r3(o){let t=lt.useContext(Jm);return t||ba(!1),t}function s3(o){let t=lt.useContext(J4);return t||ba(!1),t}function l3(o){let t=lt.useContext(pf);return t||ba(!1),t}function N2(o){let t=l3(),n=t.matches[t.matches.length-1];return n.route.id||ba(!1),n.route.id}function o3(){var o;let t=lt.useContext(w2),n=s3(),a=N2();return t!==void 0?t:(o=n.errors)==null?void 0:o[a]}function u3(){let{router:o}=r3(R2.UseNavigateStable),t=N2(x2.UseNavigateStable),n=lt.useRef(!1);return O2(()=>{n.current=!0}),lt.useCallback(function(r,l){l===void 0&&(l={}),n.current&&(typeof r=="number"?o.navigate(r):o.navigate(r,cd({fromRouteId:t},l)))},[o,t])}const by={};function c3(o,t,n){by[o]||(by[o]=!0)}function f3(o,t){o==null||o.v7_startTransition,o==null||o.v7_relativeSplatPath}function cu(o){ba(!1)}function h3(o){let{basename:t="/",children:n=null,location:a,navigationType:r=co.Pop,navigator:l,static:c=!1,future:d}=o;Ag()&&ba(!1);let g=t.replace(/^\/*/,"/"),m=lt.useMemo(()=>({basename:g,navigator:l,static:c,future:cd({v7_relativeSplatPath:!1},d)}),[g,d,l,c]);typeof a=="string"&&(a=gf(a));let{pathname:_="/",search:C="",hash:E="",state:O=null,key:v="default"}=a,M=lt.useMemo(()=>{let z=T2(_,g);return z==null?null:{location:{pathname:z,search:C,hash:E,state:O,key:v},navigationType:r}},[g,_,C,E,O,v,r]);return M==null?null:lt.createElement(Cg.Provider,{value:m},lt.createElement(Tg.Provider,{children:n,value:M}))}function d3(o){let{children:t,location:n}=o;return W4(Tm(t),n)}new Promise(()=>{});function Tm(o,t){t===void 0&&(t=[]);let n=[];return lt.Children.forEach(o,(a,r)=>{if(!lt.isValidElement(a))return;let l=[...t,r];if(a.type===lt.Fragment){n.push.apply(n,Tm(a.props.children,l));return}a.type!==cu&&ba(!1),!a.props.index||!a.props.children||ba(!1);let c={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(c.children=Tm(a.props.children,l)),n.push(c)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Am(o){return o===void 0&&(o=""),new URLSearchParams(typeof o=="string"||Array.isArray(o)||o instanceof URLSearchParams?o:Object.keys(o).reduce((t,n)=>{let a=o[n];return t.concat(Array.isArray(a)?a.map(r=>[n,r]):[[n,a]])},[]))}function g3(o,t){let n=Am(o);return t&&t.forEach((a,r)=>{n.has(r)||t.getAll(r).forEach(l=>{n.append(r,l)})}),n}const p3="6";try{window.__reactRouterVersion=p3}catch{}const m3="startTransition",_y=g4[m3];function v3(o){let{basename:t,children:n,future:a,window:r}=o,l=lt.useRef();l.current==null&&(l.current=E4({window:r,v5Compat:!0}));let c=l.current,[d,g]=lt.useState({action:c.action,location:c.location}),{v7_startTransition:m}=a||{},_=lt.useCallback(C=>{m&&_y?_y(()=>g(C)):g(C)},[g,m]);return lt.useLayoutEffect(()=>c.listen(_),[c,_]),lt.useEffect(()=>f3(a),[a]),lt.createElement(h3,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:c,future:a})}var Ey;(function(o){o.UseScrollRestoration="useScrollRestoration",o.UseSubmit="useSubmit",o.UseSubmitFetcher="useSubmitFetcher",o.UseFetcher="useFetcher",o.useViewTransitionState="useViewTransitionState"})(Ey||(Ey={}));var Cy;(function(o){o.UseFetcher="useFetcher",o.UseFetchers="useFetchers",o.UseScrollRestoration="useScrollRestoration"})(Cy||(Cy={}));function pd(o){let t=lt.useRef(Am(o)),n=lt.useRef(!1),a=Zm(),r=lt.useMemo(()=>g3(a.search,n.current?null:t.current),[a.search]),l=mf(),c=lt.useCallback((d,g)=>{const m=Am(typeof d=="function"?d(r):d);n.current=!0,l("?"+m,g)},[l,r]);return[r,c]}function y3(){const o=mf(),[t,n]=lt.useState(!1),[a,r]=lt.useState(""),[l,c]=lt.useState("demo"),d=g=>{g.preventDefault(),a.trim()&&l.trim()&&o(`/student?room=${l}&name=${encodeURIComponent(a.trim())}`)};return t?k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsx("div",{className:"glass-surface landing-container",style:{maxWidth:"500px"},children:k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",style:{fontSize:"2rem"},children:"Join as Student"}),k.jsx("p",{className:"landing-description",children:"Enter your name and room code to start drawing"})]}),k.jsxs("form",{onSubmit:d,style:{width:"100%",marginTop:"2rem"},children:[k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"studentName",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Your Name"}),k.jsx("input",{id:"studentName",type:"text",value:a,onChange:g=>r(g.target.value),placeholder:"Enter your name",autoFocus:!0,required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{htmlFor:"roomCode",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Room Code"}),k.jsx("input",{id:"roomCode",type:"text",value:l,onChange:g=>c(g.target.value.toUpperCase()),placeholder:"Enter room code",required:!0,style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #ddd",borderRadius:"8px",outline:"none",transition:"border-color 0.2s",fontFamily:"monospace",letterSpacing:"2px"},onFocus:g=>g.target.style.borderColor="#667eea",onBlur:g=>g.target.style.borderColor="#ddd"})]}),k.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[k.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"2px solid #ddd",borderRadius:"8px",background:"white",cursor:"pointer",transition:"all 0.2s"},children:"← Back"}),k.jsx("button",{type:"submit",style:{flex:2,padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:g=>g.target.style.transform="translateY(-2px)",onMouseOut:g=>g.target.style.transform="translateY(0)",children:"Join Room →"})]})]})]})})})]}):k.jsxs("div",{className:"landing-page",children:[k.jsxs("div",{className:"background-decorations",children:[k.jsx("div",{className:"bg-blob bg-blob-1"}),k.jsx("div",{className:"bg-blob bg-blob-2"}),k.jsx("div",{className:"bg-gradient-overlay"})]}),k.jsx("main",{className:"landing-main",children:k.jsxs("div",{className:"glass-surface landing-container",children:[k.jsxs("div",{className:"landing-content",children:[k.jsx("span",{className:"glass-pill landing-badge",children:k.jsx("span",{children:"FEATHER"})}),k.jsxs("div",{className:"landing-header",children:[k.jsx("h1",{className:"landing-title",children:"Teach visually. Collaborate instantly."}),k.jsx("p",{className:"landing-description",children:"Feather streams pencil-perfect strokes between teachers and students in real time. Instant sync, buttery smooth annotation tools, and delightful classroom-ready controls built for iPad and stylus workflows."})]}),k.jsxs("dl",{className:"features",children:[k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Palm rejection"}),k.jsx("dd",{className:"feature-subtitle",children:"Silky palm drawing"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Frameless logos"}),k.jsx("dd",{className:"feature-subtitle",children:"Delightful annotations"})]}),k.jsxs("div",{className:"feature-card",children:[k.jsx("dt",{className:"feature-title",children:"Realtime sync"}),k.jsx("dd",{className:"feature-subtitle",children:"Sub-second latency"})]})]})]}),k.jsxs("div",{className:"workspace-section",children:[k.jsx("p",{className:"workspace-label",children:"PICK YOUR WORKSPACE"}),k.jsxs("div",{className:"workspace-cards",children:[k.jsxs("a",{onClick:()=>o("/teacher?room=demo"),className:"glass-button teacher-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Teacher dashboard"}),k.jsx("p",{className:"workspace-description",children:"Monitor your students, sync views, and annotate the board. Assign templates/images, and manage the class."})]}),k.jsx("span",{className:"workspace-emoji",children:"👩‍🏫"})]}),k.jsxs("a",{onClick:()=>n(!0),className:"glass-button student-card",children:[k.jsxs("div",{children:[k.jsx("p",{className:"workspace-title",children:"Student workspace"}),k.jsx("p",{className:"workspace-description",children:"Sketch on a public or draw alongside the class, with undo/redo, templates, and stylus-first controls."})]}),k.jsx("span",{className:"workspace-emoji",children:"👩‍🎓"})]})]})]})]})})]})}const S3=Math.PI/180;function b3(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const gu=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Jt={_global:gu,version:"10.0.7",isBrowser:b3(),isUnminified:/param/.test((function(o){}).toString()),dblClickWindow:400,getAngle(o){return Jt.angleDeg?o*S3:o},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Jt.DD.isDragging},isTransforming(){var o,t;return(t=(o=Jt.Transformer)===null||o===void 0?void 0:o.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!Jt.DD.node},releaseCanvasOnDestroy:!0,document:gu.document,_injectGlobal(o){typeof gu.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),gu.Konva=o}},Yn=o=>{Jt[o.prototype.getClassName()]=o};Jt._injectGlobal(Jt);const _3=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Ty=()=>{if(typeof document>"u")throw new Error(_3)};class ji{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new ji(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const n=this.m;return{x:n[0]*t.x+n[2]*t.y+n[4],y:n[1]*t.x+n[3]*t.y+n[5]}}translate(t,n){return this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n,this}scale(t,n){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n,this}rotate(t){const n=Math.cos(t),a=Math.sin(t),r=this.m[0]*n+this.m[2]*a,l=this.m[1]*n+this.m[3]*a,c=this.m[0]*-a+this.m[2]*n,d=this.m[1]*-a+this.m[3]*n;return this.m[0]=r,this.m[1]=l,this.m[2]=c,this.m[3]=d,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,n){const a=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,l=this.m[2]+this.m[0]*t,c=this.m[3]+this.m[1]*t;return this.m[0]=a,this.m[1]=r,this.m[2]=l,this.m[3]=c,this}multiply(t){const n=this.m[0]*t.m[0]+this.m[2]*t.m[1],a=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],l=this.m[1]*t.m[2]+this.m[3]*t.m[3],c=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],d=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=l,this.m[4]=c,this.m[5]=d,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,a=-this.m[1]*t,r=-this.m[2]*t,l=this.m[0]*t,c=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),d=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=l,this.m[4]=c,this.m[5]=d,this}getMatrix(){return this.m}decompose(){const t=this.m[0],n=this.m[1],a=this.m[2],r=this.m[3],l=this.m[4],c=this.m[5],d=t*r-n*a,g={x:l,y:c,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){const m=Math.sqrt(t*t+n*n);g.rotation=n>0?Math.acos(t/m):-Math.acos(t/m),g.scaleX=m,g.scaleY=d/m,g.skewX=(t*a+n*r)/d,g.skewY=0}else if(a!=0||r!=0){const m=Math.sqrt(a*a+r*r);g.rotation=Math.PI/2-(r>0?Math.acos(-a/m):-Math.acos(a/m)),g.scaleX=d/m,g.scaleY=m,g.skewX=0,g.skewY=(t*a+n*r)/d}return g.rotation=vt._getRotation(g.rotation),g}}const E3="[object Array]",C3="[object Number]",T3="[object String]",A3="[object Boolean]",w3=Math.PI/180,O3=180/Math.PI,Cp="#",R3="",x3="0",N3="Konva warning: ",Ay="Konva error: ",M3="rgb(",Tp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},D3=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let V0=[];const j3=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(o){setTimeout(o,60)},vt={_isElement(o){return!!(o&&o.nodeType==1)},_isFunction(o){return!!(o&&o.constructor&&o.call&&o.apply)},_isPlainObject(o){return!!o&&o.constructor===Object},_isArray(o){return Object.prototype.toString.call(o)===E3},_isNumber(o){return Object.prototype.toString.call(o)===C3&&!isNaN(o)&&isFinite(o)},_isString(o){return Object.prototype.toString.call(o)===T3},_isBoolean(o){return Object.prototype.toString.call(o)===A3},isObject(o){return o instanceof Object},isValidSelector(o){if(typeof o!="string")return!1;const t=o[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(o){return o===0||o>0?1:-1},requestAnimFrame(o){V0.push(o),V0.length===1&&j3(function(){const t=V0;V0=[],t.forEach(function(n){n()})})},createCanvasElement(){Ty();const o=document.createElement("canvas");try{o.style=o.style||{}}catch{}return o},createImageElement(){return Ty(),document.createElement("img")},_isInDocument(o){for(;o=o.parentNode;)if(o==document)return!0;return!1},_urlToImage(o,t){const n=vt.createImageElement();n.onload=function(){t(n)},n.src=o},_rgbToHex(o,t,n){return((1<<24)+(o<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(o){o=o.replace(Cp,R3);const t=parseInt(o,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let o=(Math.random()*16777215<<0).toString(16);for(;o.length<6;)o=x3+o;return Cp+o},getRGB(o){let t;return o in Tp?(t=Tp[o],{r:t[0],g:t[1],b:t[2]}):o[0]===Cp?this._hexToRgb(o.substring(1)):o.substr(0,4)===M3?(t=D3.exec(o.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(o){return o=o||"black",vt._namedColorToRBA(o)||vt._hex3ColorToRGBA(o)||vt._hex4ColorToRGBA(o)||vt._hex6ColorToRGBA(o)||vt._hex8ColorToRGBA(o)||vt._rgbColorToRGBA(o)||vt._rgbaColorToRGBA(o)||vt._hslColorToRGBA(o)},_namedColorToRBA(o){const t=Tp[o.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(o){if(o.indexOf("rgb(")===0){o=o.match(/rgb\(([^)]+)\)/)[1];const t=o.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(o){if(o.indexOf("rgba(")===0){o=o.match(/rgba\(([^)]+)\)/)[1];const t=o.split(/ *, */).map((n,a)=>n.slice(-1)==="%"?a===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(o){if(o[0]==="#"&&o.length===9)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:parseInt(o.slice(7,9),16)/255}},_hex6ColorToRGBA(o){if(o[0]==="#"&&o.length===7)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:1}},_hex4ColorToRGBA(o){if(o[0]==="#"&&o.length===5)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:parseInt(o[4]+o[4],16)/255}},_hex3ColorToRGBA(o){if(o[0]==="#"&&o.length===4)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:1}},_hslColorToRGBA(o){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(o)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o),a=Number(n[0])/360,r=Number(n[1])/100,l=Number(n[2])/100;let c,d,g;if(r===0)return g=l*255,{r:Math.round(g),g:Math.round(g),b:Math.round(g),a:1};l<.5?c=l*(1+r):c=l+r-l*r;const m=2*l-c,_=[0,0,0];for(let C=0;C<3;C++)d=a+1/3*-(C-1),d<0&&d++,d>1&&d--,6*d<1?g=m+(c-m)*6*d:2*d<1?g=c:3*d<2?g=m+(c-m)*(2/3-d)*6:g=m,_[C]=g*255;return{r:Math.round(_[0]),g:Math.round(_[1]),b:Math.round(_[2]),a:1}}},haveIntersection(o,t){return!(t.x>o.x+o.width||t.x+t.width<o.x||t.y>o.y+o.height||t.y+t.height<o.y)},cloneObject(o){const t={};for(const n in o)this._isPlainObject(o[n])?t[n]=this.cloneObject(o[n]):this._isArray(o[n])?t[n]=this.cloneArray(o[n]):t[n]=o[n];return t},cloneArray(o){return o.slice(0)},degToRad(o){return o*w3},radToDeg(o){return o*O3},_degToRad(o){return vt.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),vt.degToRad(o)},_radToDeg(o){return vt.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),vt.radToDeg(o)},_getRotation(o){return Jt.angleDeg?vt.radToDeg(o):o},_capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},throw(o){throw new Error(Ay+o)},error(o){console.error(Ay+o)},warn(o){Jt.showWarnings&&console.warn(N3+o)},each(o,t){for(const n in o)t(n,o[n])},_inRange(o,t,n){return t<=o&&o<n},_getProjectionToSegment(o,t,n,a,r,l){let c,d,g;const m=(o-n)*(o-n)+(t-a)*(t-a);if(m==0)c=o,d=t,g=(r-n)*(r-n)+(l-a)*(l-a);else{const _=((r-o)*(n-o)+(l-t)*(a-t))/m;_<0?(c=o,d=t,g=(o-r)*(o-r)+(t-l)*(t-l)):_>1?(c=n,d=a,g=(n-r)*(n-r)+(a-l)*(a-l)):(c=o+_*(n-o),d=t+_*(a-t),g=(c-r)*(c-r)+(d-l)*(d-l))}return[c,d,g]},_getProjectionToLine(o,t,n){const a=vt.cloneObject(o);let r=Number.MAX_VALUE;return t.forEach(function(l,c){if(!n&&c===t.length-1)return;const d=t[(c+1)%t.length],g=vt._getProjectionToSegment(l.x,l.y,d.x,d.y,o.x,o.y),m=g[0],_=g[1],C=g[2];C<r&&(a.x=m,a.y=_,r=C)}),a},_prepareArrayForTween(o,t,n){const a=[],r=[];if(o.length>t.length){const c=t;t=o,o=c}for(let c=0;c<o.length;c+=2)a.push({x:o[c],y:o[c+1]});for(let c=0;c<t.length;c+=2)r.push({x:t[c],y:t[c+1]});const l=[];return r.forEach(function(c){const d=vt._getProjectionToLine(c,a,n);l.push(d.x),l.push(d.y)}),l},_prepareToStringify(o){let t;o.visitedByCircularReferenceRemoval=!0;for(const n in o)if(o.hasOwnProperty(n)&&o[n]&&typeof o[n]=="object"){if(t=Object.getOwnPropertyDescriptor(o,n),o[n].visitedByCircularReferenceRemoval||vt._isElement(o[n]))if(t.configurable)delete o[n];else return null;else if(vt._prepareToStringify(o[n])===null)if(t.configurable)delete o[n];else return null}return delete o.visitedByCircularReferenceRemoval,o},_assign(o,t){for(const n in t)o[n]=t[n];return o},_getFirstPointerId(o){return o.touches?o.changedTouches[0].identifier:o.pointerId||999},releaseCanvas(...o){Jt.releaseCanvasOnDestroy&&o.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(o,t,n,a){let r=t<0?t:0,l=n<0?n:0;t=Math.abs(t),n=Math.abs(n);let c=0,d=0,g=0,m=0;typeof a=="number"?c=d=g=m=Math.min(a,t/2,n/2):(c=Math.min(a[0]||0,t/2,n/2),d=Math.min(a[1]||0,t/2,n/2),m=Math.min(a[2]||0,t/2,n/2),g=Math.min(a[3]||0,t/2,n/2)),o.moveTo(r+c,l),o.lineTo(r+t-d,l),o.arc(r+t-d,l+d,d,Math.PI*3/2,0,!1),o.lineTo(r+t,l+n-m),o.arc(r+t-m,l+n-m,m,0,Math.PI/2,!1),o.lineTo(r+g,l+n),o.arc(r+g,l+n-g,g,Math.PI/2,Math.PI,!1),o.lineTo(r,l+c),o.arc(r+c,l+c,c,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(o,t,n,a,r){a=Math.abs(a);for(let l=0;l<n;l++){const c=t[(l-1+n)%n],d=t[l],g=t[(l+1)%n],m={x:d.x-c.x,y:d.y-c.y},_={x:g.x-d.x,y:g.y-d.y},C=Math.hypot(m.x,m.y),E=Math.hypot(_.x,_.y);let O;typeof r=="number"?O=r:O=l<r.length?r[l]:0,O=a*Math.cos(Math.PI/n)*Math.min(1,O/a*2);const M={x:m.x/C,y:m.y/C},z={x:_.x/E,y:_.y/E},L={x:d.x-M.x*O,y:d.y-M.y*O},D={x:d.x+z.x*O,y:d.y+z.y*O};l===0?o.moveTo(L.x,L.y):o.lineTo(L.x,L.y),o.arcTo(d.x,d.y,D.x,D.y,O)}}};function U3(o){const t=[],n=o.length,a=vt;for(let r=0;r<n;r++){let l=o[r];a._isNumber(l)?l=Math.round(l*1e3)/1e3:a._isString(l)||(l=l+""),t.push(l)}return t}const wy=",",B3="(",z3=")",L3="([",G3="])",P3=";",H3="()",I3="=",Oy=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],k3=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],q3=100;let Y0=null;function Ry(){if(Y0!==null)return Y0;try{const t=vt.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Y0=!1,!1)}catch{return Y0=!1,!1}}class wg{constructor(t){this.canvas=t,Jt.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,n){let a=this.traceArr,r=a.length,l="",c,d,g,m;for(c=0;c<r;c++)d=a[c],g=d.method,g?(m=d.args,l+=g,t?l+=H3:vt._isArray(m[0])?l+=L3+m.join(wy)+G3:(n&&(m=m.map(_=>typeof _=="number"?Math.floor(_):_)),l+=B3+m.join(wy)+z3)):(l+=d.property,t||(l+=I3+d.val)),l+=P3;return l}clearTrace(){this.traceArr=[]}_trace(t){let n=this.traceArr,a;n.push(t),a=n.length,a>=q3&&n.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const n=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(t){const n=t.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(t){const n=t.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(t){const n=t.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}_applyMiterLimit(t){const n=t.attrs.miterLimit;n!=null&&this.setAttr("miterLimit",n)}setAttr(t,n){this._context[t]=n}arc(t,n,a,r,l,c){this._context.arc(t,n,a,r,l,c)}arcTo(t,n,a,r,l){this._context.arcTo(t,n,a,r,l)}beginPath(){this._context.beginPath()}bezierCurveTo(t,n,a,r,l,c){this._context.bezierCurveTo(t,n,a,r,l,c)}clearRect(t,n,a,r){this._context.clearRect(t,n,a,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,n){const a=arguments;if(a.length===2)return this._context.createImageData(t,n);if(a.length===1)return this._context.createImageData(t)}createLinearGradient(t,n,a,r){return this._context.createLinearGradient(t,n,a,r)}createPattern(t,n){return this._context.createPattern(t,n)}createRadialGradient(t,n,a,r,l,c){return this._context.createRadialGradient(t,n,a,r,l,c)}drawImage(t,n,a,r,l,c,d,g,m){const _=arguments,C=this._context;_.length===3?C.drawImage(t,n,a):_.length===5?C.drawImage(t,n,a,r,l):_.length===9&&C.drawImage(t,n,a,r,l,c,d,g,m)}ellipse(t,n,a,r,l,c,d,g){this._context.ellipse(t,n,a,r,l,c,d,g)}isPointInPath(t,n,a,r){return a?this._context.isPointInPath(a,t,n,r):this._context.isPointInPath(t,n,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,n,a,r){this._context.fillRect(t,n,a,r)}strokeRect(t,n,a,r){this._context.strokeRect(t,n,a,r)}fillText(t,n,a,r){r?this._context.fillText(t,n,a,r):this._context.fillText(t,n,a)}measureText(t){return this._context.measureText(t)}getImageData(t,n,a,r){return this._context.getImageData(t,n,a,r)}lineTo(t,n){this._context.lineTo(t,n)}moveTo(t,n){this._context.moveTo(t,n)}rect(t,n,a,r){this._context.rect(t,n,a,r)}roundRect(t,n,a,r,l){this._context.roundRect(t,n,a,r,l)}putImageData(t,n,a){this._context.putImageData(t,n,a)}quadraticCurveTo(t,n,a,r){this._context.quadraticCurveTo(t,n,a,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,n){this._context.scale(t,n)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,n,a,r,l,c){this._context.setTransform(t,n,a,r,l,c)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,n,a,r){this._context.strokeText(t,n,a,r)}transform(t,n,a,r,l,c){this._context.transform(t,n,a,r,l,c)}translate(t,n){this._context.translate(t,n)}_enableTrace(){let t=this,n=Oy.length,a=this.setAttr,r,l;const c=function(d){let g=t[d],m;t[d]=function(){return l=U3(Array.prototype.slice.call(arguments,0)),m=g.apply(t,arguments),t._trace({method:d,args:l}),m}};for(r=0;r<n;r++)c(Oy[r]);t.setAttr=function(){a.apply(t,arguments);const d=arguments[0];let g=arguments[1];(d==="shadowOffsetX"||d==="shadowOffsetY"||d==="shadowBlur")&&(g=g/this.canvas.getPixelRatio()),t._trace({property:d,val:g})}}_applyGlobalCompositeOperation(t){const n=t.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}k3.forEach(function(o){Object.defineProperty(wg.prototype,o,{get(){return this._context[o]},set(t){this._context[o]=t}})});class V3 extends wg{constructor(t,{willReadFrequently:n=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(t){const n=t.fill();this.setAttr("fillStyle",n),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const n=t._getLinearGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fillRadialGradient(t){const n=t._getRadialGradient();n&&(this.setAttr("fillStyle",n),t._fillFunc(this))}_fill(t){const n=t.fill(),a=t.getFillPriority();if(n&&a==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&a==="pattern"){this._fillPattern(t);return}const l=t.getFillLinearGradientColorStops();if(l&&a==="linear-gradient"){this._fillLinearGradient(t);return}const c=t.getFillRadialGradientColorStops();if(c&&a==="radial-gradient"){this._fillRadialGradient(t);return}n?this._fillColor(t):r?this._fillPattern(t):l?this._fillLinearGradient(t):c&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const n=t.getStrokeLinearGradientStartPoint(),a=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),l=this.createLinearGradient(n.x,n.y,a.x,a.y);if(r){for(let c=0;c<r.length;c+=2)l.addColorStop(r[c],r[c+1]);this.setAttr("strokeStyle",l)}}_stroke(t){const n=t.dash(),a=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!a){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t),n&&t.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),a||this.restore()}}_applyShadow(t){var n,a,r;const l=(n=t.getShadowRGBA())!==null&&n!==void 0?n:"black",c=(a=t.getShadowBlur())!==null&&a!==void 0?a:5,d=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},g=t.getAbsoluteScale(),m=this.canvas.getPixelRatio(),_=g.x*m,C=g.y*m;this.setAttr("shadowColor",l),this.setAttr("shadowBlur",c*Math.min(Math.abs(_),Math.abs(C))),this.setAttr("shadowOffsetX",d.x*_),this.setAttr("shadowOffsetY",d.y*C)}}class Y3 extends wg{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const n=t.getStrokeScaleEnabled();if(!n){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t);const a=t.hitStrokeWidth(),r=a==="auto"?t.strokeWidth():a;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),n||this.restore()}}}let K0;function K3(){if(K0)return K0;const o=vt.createCanvasElement(),t=o.getContext("2d");return K0=(function(){const n=Jt._global.devicePixelRatio||1,a=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/a})(),vt.releaseCanvas(o),K0}class Wm{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const a=(t||{}).pixelRatio||Jt.pixelRatio||K3();this.pixelRatio=a,this._canvas=vt.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const n=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,n){this.setWidth(t||0),this.setHeight(n||0)}toDataURL(t,n){try{return this._canvas.toDataURL(t,n)}catch{try{return this._canvas.toDataURL()}catch(r){return vt.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class oo extends Wm{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new V3(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function xy(){const o=vt.createCanvasElement();o.width=1,o.height=1;const t=o.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data;return!(n[0]===255&&n[1]===0&&n[2]===255&&n[3]===255)}function Ny(){var o,t;return typeof navigator>"u"?!1:(t=(o=navigator.brave)===null||o===void 0?void 0:o.isBrave())!==null&&t!==void 0?t:!1}let My=!1;function Q3(){return Ny()&&xy()&&!My&&(My=!0,vt.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),Ny()&&xy()}class $m extends Wm{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Y3(this),this.setSize(t.width,t.height),Q3()}}const cn={get isDragging(){let o=!1;return cn._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(o=!0)}),o},justDragged:!1,get node(){let o;return cn._dragElements.forEach(t=>{o=t.node}),o},_dragElements:new Map,_drag(o){const t=[];cn._dragElements.forEach((n,a)=>{const{node:r}=n,l=r.getStage();l.setPointersPositions(o),n.pointerId===void 0&&(n.pointerId=vt._getFirstPointerId(o));const c=l._changedPointerPositions.find(d=>d.id===n.pointerId);if(c){if(n.dragStatus!=="dragging"){const d=r.dragDistance();if(Math.max(Math.abs(c.x-n.startPointerPos.x),Math.abs(c.y-n.startPointerPos.y))<d||(r.startDrag({evt:o}),!r.isDragging()))return}r._setDragPosition(o,n),t.push(r)}}),t.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:o},!0)})},_endDragBefore(o){const t=[];cn._dragElements.forEach(n=>{const{node:a}=n,r=a.getStage();if(o&&r.setPointersPositions(o),!r._changedPointerPositions.find(d=>d.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(cn.justDragged=!0,Jt._mouseListenClick=!1,Jt._touchListenClick=!1,Jt._pointerListenClick=!1,n.dragStatus="stopped");const c=n.node.getLayer()||n.node instanceof Jt.Stage&&n.node;c&&t.indexOf(c)===-1&&t.push(c)}),t.forEach(n=>{n.draw()})},_endDragAfter(o){cn._dragElements.forEach((t,n)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:o},!0),t.dragStatus!=="dragging"&&cn._dragElements.delete(n)})}};Jt.isBrowser&&(window.addEventListener("mouseup",cn._endDragBefore,!0),window.addEventListener("touchend",cn._endDragBefore,!0),window.addEventListener("touchcancel",cn._endDragBefore,!0),window.addEventListener("mousemove",cn._drag),window.addEventListener("touchmove",cn._drag),window.addEventListener("mouseup",cn._endDragAfter,!1),window.addEventListener("touchend",cn._endDragAfter,!1),window.addEventListener("touchcancel",cn._endDragAfter,!1));function ho(o){return vt._isString(o)?'"'+o+'"':Object.prototype.toString.call(o)==="[object Number]"||vt._isBoolean(o)?o:Object.prototype.toString.call(o)}function M2(o){return o>255?255:o<0?0:Math.round(o)}function Kt(){if(Jt.isUnminified)return function(o,t){return vt._isNumber(o)||vt.warn(ho(o)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),o}}function Og(o){if(Jt.isUnminified)return function(t,n){let a=vt._isNumber(t),r=vt._isArray(t)&&t.length==o;return!a&&!r&&vt.warn(ho(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+o+")"),t}}function tv(){if(Jt.isUnminified)return function(o,t){return vt._isNumber(o)||o==="auto"||vt.warn(ho(o)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),o}}function vu(){if(Jt.isUnminified)return function(o,t){return vt._isString(o)||vt.warn(ho(o)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),o}}function D2(){if(Jt.isUnminified)return function(o,t){const n=vt._isString(o),a=Object.prototype.toString.call(o)==="[object CanvasGradient]"||o&&o.addColorStop;return n||a||vt.warn(ho(o)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),o}}function X3(){if(Jt.isUnminified)return function(o,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&o instanceof n||(vt._isArray(o)?o.forEach(function(a){vt._isNumber(a)||vt.warn('"'+t+'" attribute has non numeric element '+a+". Make sure that all elements are numbers.")}):vt.warn(ho(o)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),o}}function Gr(){if(Jt.isUnminified)return function(o,t){return o===!0||o===!1||vt.warn(ho(o)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),o}}function F3(o){if(Jt.isUnminified)return function(t,n){return t==null||vt.isObject(t)||vt.warn(ho(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+o),t}}const Kh="get",Qh="set",st={addGetterSetter(o,t,n,a,r){st.addGetter(o,t,n),st.addSetter(o,t,a,r),st.addOverloadedGetterSetter(o,t)},addGetter(o,t,n){const a=Kh+vt._capitalize(t);o.prototype[a]=o.prototype[a]||function(){const r=this.attrs[t];return r===void 0?n:r}},addSetter(o,t,n,a){const r=Qh+vt._capitalize(t);o.prototype[r]||st.overWriteSetter(o,t,n,a)},overWriteSetter(o,t,n,a){const r=Qh+vt._capitalize(t);o.prototype[r]=function(l){return n&&l!==void 0&&l!==null&&(l=n.call(this,l,t)),this._setAttr(t,l),a&&a.call(this),this}},addComponentsGetterSetter(o,t,n,a,r){const l=n.length,c=vt._capitalize,d=Kh+c(t),g=Qh+c(t);o.prototype[d]=function(){const _={};for(let C=0;C<l;C++){const E=n[C];_[E]=this.getAttr(t+c(E))}return _};const m=F3(n);o.prototype[g]=function(_){const C=this.attrs[t];a&&(_=a.call(this,_,t)),m&&m.call(this,_,t);for(const E in _)_.hasOwnProperty(E)&&this._setAttr(t+c(E),_[E]);return _||n.forEach(E=>{this._setAttr(t+c(E),void 0)}),this._fireChangeEvent(t,C,_),r&&r.call(this),this},st.addOverloadedGetterSetter(o,t)},addOverloadedGetterSetter(o,t){const n=vt._capitalize(t),a=Qh+n,r=Kh+n;o.prototype[t]=function(){return arguments.length?(this[a](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(o,t,n,a){vt.error("Adding deprecated "+t);const r=Kh+vt._capitalize(t),l=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[r]=function(){vt.error(l);const c=this.attrs[t];return c===void 0?n:c},st.addSetter(o,t,a,function(){vt.error(l)}),st.addOverloadedGetterSetter(o,t)},backCompat(o,t){vt.each(t,function(n,a){const r=o.prototype[a],l=Kh+vt._capitalize(n),c=Qh+vt._capitalize(n);function d(){r.apply(this,arguments),vt.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+a+'" instead.')}o.prototype[n]=d,o.prototype[l]=d,o.prototype[c]=d})},afterSetFilter(){this._filterUpToDate=!1}};function J3(o){const t=/(\w+)\(([^)]+)\)/g;let n;for(;(n=t.exec(o))!==null;){const[,a,r]=n;switch(a){case"blur":{const l=parseFloat(r.replace("px",""));return function(c){this.blurRadius(l*.5);const d=Jt.Filters;d&&d.Blur&&d.Blur.call(this,c)}}case"brightness":{const l=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(c){this.brightness(l);const d=Jt.Filters;d&&d.Brightness&&d.Brightness.call(this,c)}}case"contrast":{const l=parseFloat(r);return function(c){const d=100*(Math.sqrt(l)-1);this.contrast(d);const g=Jt.Filters;g&&g.Contrast&&g.Contrast.call(this,c)}}case"grayscale":return function(l){const c=Jt.Filters;c&&c.Grayscale&&c.Grayscale.call(this,l)};case"sepia":return function(l){const c=Jt.Filters;c&&c.Sepia&&c.Sepia.call(this,l)};case"invert":return function(l){const c=Jt.Filters;c&&c.Invert&&c.Invert.call(this,l)};default:vt.warn(`CSS filter "${a}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const dg="absoluteOpacity",Q0="allEventListeners",hl="absoluteTransform",Dy="absoluteScale",lu="canvas",Z3="Change",W3="children",$3="konva",wm="listening",t5="mouseenter",e5="mouseleave",n5="pointerenter",a5="pointerleave",i5="touchenter",r5="touchleave",jy="set",Uy="Shape",gg=" ",By="stage",ro="transform",s5="Stage",Om="visible",l5=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(gg);let o5=1;class Yt{constructor(t){this._id=o5++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===ro||t===hl)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,n){let a=this._cache.get(t);return(a===void 0||(t===ro||t===hl)&&a.dirty===!0)&&(a=n.call(this),this._cache.set(t,a)),a}_calculate(t,n,a){if(!this._attachedDepsListeners.get(t)){const r=n.map(l=>l+"Change.konva").join(gg);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,a)}_getCanvasCache(){return this._cache.get(lu)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===hl&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(lu)){const{scene:t,filter:n,hit:a,buffer:r}=this._cache.get(lu);vt.releaseCanvas(t,n,a,r),this._cache.delete(lu)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const n=t||{};let a={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(a=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(n.width||a.width),l=Math.ceil(n.height||a.height),c=n.pixelRatio,d=n.x===void 0?Math.floor(a.x):n.x,g=n.y===void 0?Math.floor(a.y):n.y,m=n.offset||0,_=n.drawBorder||!1,C=n.hitCanvasPixelRatio||1;if(!r||!l){vt.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const E=Math.abs(Math.round(a.x)-d)>.5?1:0,O=Math.abs(Math.round(a.y)-g)>.5?1:0;r+=m*2+E,l+=m*2+O,d-=m,g-=m;const v=new oo({pixelRatio:c,width:r,height:l}),M=new oo({pixelRatio:c,width:0,height:0,willReadFrequently:!0}),z=new $m({pixelRatio:C,width:r,height:l}),L=v.getContext(),D=z.getContext(),N=new oo({width:v.width/v.pixelRatio+Math.abs(d),height:v.height/v.pixelRatio+Math.abs(g),pixelRatio:v.pixelRatio}),G=N.getContext();return z.isCache=!0,v.isCache=!0,this._cache.delete(lu),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,M.getContext()._context.imageSmoothingEnabled=!1),L.save(),D.save(),G.save(),L.translate(-d,-g),D.translate(-d,-g),G.translate(-d,-g),N.x=d,N.y=g,this._isUnderCache=!0,this._clearSelfAndDescendantCache(dg),this._clearSelfAndDescendantCache(Dy),this.drawScene(v,this,N),this.drawHit(z,this),this._isUnderCache=!1,L.restore(),D.restore(),_&&(L.save(),L.beginPath(),L.rect(0,0,r,l),L.closePath(),L.setAttr("strokeStyle","red"),L.setAttr("lineWidth",5),L.stroke(),L.restore()),this._cache.set(lu,{scene:v,filter:M,hit:z,buffer:N,x:d,y:g}),this._requestDraw(),this}isCached(){return this._cache.has(lu)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,n){const a=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,l=1/0,c=-1/0,d=-1/0;const g=this.getAbsoluteTransform(n);return a.forEach(function(m){const _=g.point(m);r===void 0&&(r=c=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),c=Math.max(c,_.x),d=Math.max(d,_.y)}),{x:r,y:l,width:c-r,height:d-l}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();t.translate(n.x,n.y);const a=this._getCachedSceneCanvas(),r=a.pixelRatio;t.drawImage(a._canvas,0,0,a.width/r,a.height/r),t.restore()}_drawCachedHitCanvas(t){const n=this._getCanvasCache(),a=n.hit;t.save(),t.translate(n.x,n.y),t.drawImage(a._canvas,0,0,a.width/a.pixelRatio,a.height/a.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),n=this._getCanvasCache(),a=n.scene,r=n.filter,l=r.getContext(),c,d,g,m;if(!t||t.length===0)return a;if(this._filterUpToDate)return r;let _=!0;for(let E=0;E<t.length;E++)if(typeof t[E]=="string"&&Ry(),typeof t[E]!="string"||!Ry()){_=!1;break}const C=a.pixelRatio;if(r.setSize(a.width/a.pixelRatio,a.height/a.pixelRatio),_){const E=t.join(" ");return l.save(),l.setAttr("filter",E),l.drawImage(a._canvas,0,0,a.getWidth()/C,a.getHeight()/C),l.restore(),this._filterUpToDate=!0,r}try{for(c=t.length,l.clear(),l.drawImage(a._canvas,0,0,a.getWidth()/C,a.getHeight()/C),d=l.getImageData(0,0,r.getWidth(),r.getHeight()),g=0;g<c;g++)m=t[g],typeof m=="string"&&(m=J3(m)),m.call(this,d),l.putImageData(d,0,0)}catch(E){vt.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,n){if(this._cache&&this._cache.delete(Q0),arguments.length===3)return this._delegate.apply(this,arguments);const a=t.split(gg);for(let r=0;r<a.length;r++){const c=a[r].split("."),d=c[0],g=c[1]||"";this.eventListeners[d]||(this.eventListeners[d]=[]),this.eventListeners[d].push({name:g,handler:n})}return this}off(t,n){let a=(t||"").split(gg),r=a.length,l,c,d,g,m,_;if(this._cache&&this._cache.delete(Q0),!t)for(c in this.eventListeners)this._off(c);for(l=0;l<r;l++)if(d=a[l],g=d.split("."),m=g[0],_=g[1],m)this.eventListeners[m]&&this._off(m,_,n);else for(c in this.eventListeners)this._off(c,_,n);return this}dispatchEvent(t){const n={target:this,type:t.type,evt:t};return this.fire(t.type,n),this}addEventListener(t,n){return this.on(t,function(a){n.call(this,a.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,n,a){const r=this;this.on(t,function(l){const c=l.target.findAncestors(n,!0,r);for(let d=0;d<c.length;d++)l=vt.cloneObject(l),l.currentTarget=c[d],a.call(c[d],l)})}remove(){return this.isDragging()&&this.stopDrag(),cn._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(hl),this._clearSelfAndDescendantCache(dg),this._clearSelfAndDescendantCache(Dy),this._clearSelfAndDescendantCache(By),this._clearSelfAndDescendantCache(Om),this._clearSelfAndDescendantCache(wm)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const n="get"+vt._capitalize(t);return vt._isFunction(this[n])?this[n]():this.attrs[t]}getAncestors(){let t=this.getParent(),n=[];for(;t;)n.push(t),t=t.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let n,a;if(!t)return this;for(n in t)n!==W3&&(a=jy+vt._capitalize(n),vt._isFunction(this[a])?this[a](t[n]):this._setAttr(n,t[n]))}),this}isListening(){return this._getCache(wm,this._isListening)}_isListening(t){if(!this.listening())return!1;const a=this.getParent();return a&&a!==t&&this!==t?a._isListening(t):!0}isVisible(){return this._getCache(Om,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const a=this.getParent();return a&&a!==t&&this!==t?a._isVisible(t):!0}shouldDrawHit(t,n=!1){if(t)return this._isVisible(t)&&this._isListening(t);const a=this.getLayer();let r=!1;cn._dragElements.forEach(c=>{c.dragStatus==="dragging"&&(c.node.nodeType==="Stage"||c.node.getLayer()===a)&&(r=!0)});const l=!n&&!Jt.hitOnDragEnabled&&(r||Jt.isTransforming());return this.isListening()&&this.isVisible()&&!l}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),n=this,a=0,r,l,c,d;function g(_){for(r=[],l=_.length,c=0;c<l;c++)d=_[c],a++,d.nodeType!==Uy&&(r=r.concat(d.getChildren().slice())),d._id===n._id&&(c=l);r.length>0&&r[0].getDepth()<=t&&g(r)}const m=this.getStage();return n.nodeType!==s5&&m&&g(m.getChildren()),a}getDepth(){let t=0,n=this.parent;for(;n;)t++,n=n.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ro),this._clearSelfAndDescendantCache(hl)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const n=t.getPointerPosition();if(!n)return null;const a=this.getAbsoluteTransform().copy();return a.invert(),a.point(n)}getAbsolutePosition(t){let n=!1,a=this.parent;for(;a;){if(a.isCached()){n=!0;break}a=a.parent}n&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),l=new ji,c=this.offset();return l.m=r.slice(),l.translate(c.x,c.y),l.getTranslation()}setAbsolutePosition(t){const{x:n,y:a,...r}=this._clearTransform();this.attrs.x=n,this.attrs.y=a,this._clearCache(ro);const l=this._getAbsoluteTransform().copy();return l.invert(),l.translate(t.x,t.y),t={x:this.attrs.x+l.getTranslation().x,y:this.attrs.y+l.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(ro),this._clearSelfAndDescendantCache(hl),this}_setTransform(t){let n;for(n in t)this.attrs[n]=t[n]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let n=t.x,a=t.y,r=this.x(),l=this.y();return n!==void 0&&(r+=n),a!==void 0&&(l+=a),this.setPosition({x:r,y:l}),this}_eachAncestorReverse(t,n){let a=[],r=this.getParent(),l,c;if(!(n&&n._id===this._id)){for(a.unshift(this);r&&(!n||r._id!==n._id);)a.unshift(r),r=r.parent;for(l=a.length,c=0;c<l;c++)t(a[c])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return vt.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return vt.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,n=this.parent.getChildren().length;return t<n-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return vt.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return vt.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return vt.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&vt.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(dg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(t*=n.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),n,a,r,l,c;const d={attrs:{},className:this.getClassName()};for(n in t)a=t[n],c=vt.isObject(a)&&!vt._isPlainObject(a)&&!vt._isArray(a),!c&&(r=typeof this[n]=="function"&&this[n],delete t[n],l=r?r.call(this):null,t[n]=a,l!==a&&(d.attrs[n]=a));return vt._prepareToStringify(d)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,n,a){const r=[];n&&this._isMatch(t)&&r.push(this);let l=this.parent;for(;l;){if(l===a)return r;l._isMatch(t)&&r.push(l),l=l.parent}return r}isAncestorOf(t){return!1}findAncestor(t,n,a){return this.findAncestors(t,n,a)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let n=t.replace(/ /g,"").split(","),a=n.length,r,l;for(r=0;r<a;r++)if(l=n[r],vt.isValidSelector(l)||(vt.warn('Selector "'+l+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),vt.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),vt.warn("Konva is awesome, right?")),l.charAt(0)==="#"){if(this.id()===l.slice(1))return!0}else if(l.charAt(0)==="."){if(this.hasName(l.slice(1)))return!0}else if(this.className===l||this.nodeType===l)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(By,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,n={},a){return n.target=n.target||this,a?this._fireAndBubble(t,n):this._fire(t,n),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(hl,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let n;if(t)return n=new ji,this._eachAncestorReverse(function(a){const r=a.transformsEnabled();r==="all"?n.multiply(a.getTransform()):r==="position"&&n.translate(a.x()-a.offsetX(),a.y()-a.offsetY())},t),n;{n=this._cache.get(hl)||new ji,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const a=this.transformsEnabled();if(a==="all")n.multiply(this.getTransform());else if(a==="position"){const r=this.attrs.x||0,l=this.attrs.y||0,c=this.attrs.offsetX||0,d=this.attrs.offsetY||0;n.translate(r-c,l-d)}return n.dirty=!1,n}}getAbsoluteScale(t){let n=this;for(;n;)n._isUnderCache&&(t=n),n=n.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ro,this._getTransform)}_getTransform(){var t,n;const a=this._cache.get(ro)||new ji;a.reset();const r=this.x(),l=this.y(),c=Jt.getAngle(this.rotation()),d=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,g=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,m=this.attrs.skewX||0,_=this.attrs.skewY||0,C=this.attrs.offsetX||0,E=this.attrs.offsetY||0;return(r!==0||l!==0)&&a.translate(r,l),c!==0&&a.rotate(c),(m!==0||_!==0)&&a.skew(m,_),(d!==1||g!==1)&&a.scale(d,g),(C!==0||E!==0)&&a.translate(-1*C,-1*E),a.dirty=!1,a}clone(t){let n=vt.cloneObject(this.attrs),a,r,l,c,d;for(a in t)n[a]=t[a];const g=new this.constructor(n);for(a in this.eventListeners)for(r=this.eventListeners[a],l=r.length,c=0;c<l;c++)d=r[c],d.name.indexOf($3)<0&&(g.eventListeners[a]||(g.eventListeners[a]=[]),g.eventListeners[a].push(d));return g}_toKonvaCanvas(t){t=t||{};const n=this.getClientRect(),a=this.getStage(),r=t.x!==void 0?t.x:Math.floor(n.x),l=t.y!==void 0?t.y:Math.floor(n.y),c=t.pixelRatio||1,d=new oo({width:t.width||Math.ceil(n.width)||(a?a.width():0),height:t.height||Math.ceil(n.height)||(a?a.height():0),pixelRatio:c}),g=d.getContext(),m=new oo({width:d.width/d.pixelRatio+Math.abs(r),height:d.height/d.pixelRatio+Math.abs(l),pixelRatio:d.pixelRatio});return t.imageSmoothingEnabled===!1&&(g._context.imageSmoothingEnabled=!1),g.save(),(r||l)&&g.translate(-1*r,-1*l),this.drawScene(d,void 0,m),g.restore(),d}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const n=t.mimeType||null,a=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(n,a);return t.callback&&t.callback(r),r}toImage(t){return new Promise((n,a)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,vt._urlToImage(this.toDataURL(t),function(l){n(l),r==null||r(l)})}catch(r){a(r)}})}toBlob(t){return new Promise((n,a)=>{try{const r=t==null?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(l=>{n(l),r==null||r(l)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(r){a(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Jt.dragDistance}_off(t,n,a){let r=this.eventListeners[t],l,c,d;for(l=0;l<r.length;l++)if(c=r[l].name,d=r[l].handler,(c!=="konva"||n==="konva")&&(!n||c===n)&&(!a||a===d)){if(r.splice(l,1),r.length===0){delete this.eventListeners[t];break}l--}}_fireChangeEvent(t,n,a){this._fire(t+Z3,{oldVal:n,newVal:a})}addName(t){if(!this.hasName(t)){const n=this.name(),a=n?n+" "+t:t;this.name(a)}return this}hasName(t){if(!t)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const n=(this.name()||"").split(/\s/g),a=n.indexOf(t);return a!==-1&&(n.splice(a,1),this.name(n.join(" "))),this}setAttr(t,n){const a=this[jy+vt._capitalize(t)];return vt._isFunction(a)?a.call(this,n):this._setAttr(t,n),this}_requestDraw(){if(Jt.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,n){const a=this.attrs[t];a===n&&!vt.isObject(n)||(n==null?delete this.attrs[t]:this.attrs[t]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(t,a,n),this._requestDraw())}_setComponentAttr(t,n,a){let r;a!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][n]=a,this._fireChangeEvent(t,r,a))}_fireAndBubble(t,n,a){n&&this.nodeType===Uy&&(n.target=this);const r=[t5,e5,n5,a5,i5,r5];if(!(r.indexOf(t)!==-1&&(a&&(this===a||this.isAncestorOf&&this.isAncestorOf(a))||this.nodeType==="Stage"&&!a))){this._fire(t,n);const c=r.indexOf(t)!==-1&&a&&a.isAncestorOf&&a.isAncestorOf(this)&&!a.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!c&&(a&&a.parent?this._fireAndBubble.call(this.parent,t,n,a):this._fireAndBubble.call(this.parent,t,n))}}_getProtoListeners(t){var n,a,r;const l=(n=this._cache.get(Q0))!==null&&n!==void 0?n:{};let c=l==null?void 0:l[t];if(c===void 0){c=[];let d=Object.getPrototypeOf(this);for(;d;){const g=(r=(a=d.eventListeners)===null||a===void 0?void 0:a[t])!==null&&r!==void 0?r:[];c.push(...g),d=Object.getPrototypeOf(d)}l[t]=c,this._cache.set(Q0,l)}return c}_fire(t,n){n=n||{},n.currentTarget=this,n.type=t;const a=this._getProtoListeners(t);if(a)for(let l=0;l<a.length;l++)a[l].handler.call(this,n);const r=this.eventListeners[t];if(r)for(let l=0;l<r.length;l++)r[l].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const n=t?t.pointerId:void 0,a=this.getStage(),r=this.getAbsolutePosition();if(!a)return;const l=a._getPointerById(n)||a._changedPointerPositions[0]||r;cn._dragElements.set(this._id,{node:this,startPointerPos:l,offset:{x:l.x-r.x,y:l.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(t,n=!0){cn._dragElements.has(this._id)||this._createDragElement(t);const a=cn._dragElements.get(this._id);a.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},n)}_setDragPosition(t,n){const a=this.getStage()._getPointerById(n.pointerId);if(!a)return;let r={x:a.x-n.offset.x,y:a.y-n.offset.y};const l=this.dragBoundFunc();if(l!==void 0){const c=l.call(this,r,t);c?r=c:vt.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const n=cn._dragElements.get(this._id);n&&(n.dragStatus="stopped"),cn._endDragBefore(t),cn._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=cn._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Jt.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;cn._dragElements.forEach(l=>{this.isAncestorOf(l.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=cn._dragElements.get(this._id),a=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";a?this.stopDrag():r&&cn._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const n=this.getStage();if(!n)return!1;const a={x:-t.x,y:-t.y,width:n.width()+2*t.x,height:n.height()+2*t.y};return vt.haveIntersection(a,this.getClientRect())}static create(t,n){return vt._isString(t)&&(t=JSON.parse(t)),this._createNode(t,n)}static _createNode(t,n){let a=Yt.prototype.getClassName.call(t),r=t.children,l,c,d;n&&(t.attrs.container=n),Jt[a]||(vt.warn('Can not find a node with class name "'+a+'". Fallback to "Shape".'),a="Shape");const g=Jt[a];if(l=new g(t.attrs),r)for(c=r.length,d=0;d<c;d++)l.add(Yt._createNode(r[d]));return l}}Yt.prototype.nodeType="Node";Yt.prototype._attrsAffectingSize=[];Yt.prototype.eventListeners={};Yt.prototype.on.call(Yt.prototype,l5,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ro),this._clearSelfAndDescendantCache(hl)});Yt.prototype.on.call(Yt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Om)});Yt.prototype.on.call(Yt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(wm)});Yt.prototype.on.call(Yt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(dg)});const Tn=st.addGetterSetter;Tn(Yt,"zIndex");Tn(Yt,"absolutePosition");Tn(Yt,"position");Tn(Yt,"x",0,Kt());Tn(Yt,"y",0,Kt());Tn(Yt,"globalCompositeOperation","source-over",vu());Tn(Yt,"opacity",1,Kt());Tn(Yt,"name","",vu());Tn(Yt,"id","",vu());Tn(Yt,"rotation",0,Kt());st.addComponentsGetterSetter(Yt,"scale",["x","y"]);Tn(Yt,"scaleX",1,Kt());Tn(Yt,"scaleY",1,Kt());st.addComponentsGetterSetter(Yt,"skew",["x","y"]);Tn(Yt,"skewX",0,Kt());Tn(Yt,"skewY",0,Kt());st.addComponentsGetterSetter(Yt,"offset",["x","y"]);Tn(Yt,"offsetX",0,Kt());Tn(Yt,"offsetY",0,Kt());Tn(Yt,"dragDistance",void 0,Kt());Tn(Yt,"width",0,Kt());Tn(Yt,"height",0,Kt());Tn(Yt,"listening",!0,Gr());Tn(Yt,"preventDefault",!0,Gr());Tn(Yt,"filters",void 0,function(o){return this._filterUpToDate=!1,o});Tn(Yt,"visible",!0,Gr());Tn(Yt,"transformsEnabled","all",vu());Tn(Yt,"size");Tn(Yt,"dragBoundFunc");Tn(Yt,"draggable",!1,Gr());st.backCompat(Yt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class zi extends Yt{constructor(){super(...arguments),this.children=[]}getChildren(t){const n=this.children||[];return t?n.filter(t):n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let a=0;a<t.length;a++)this.add(t[a]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const n=this._generalFind(t,!0);return n.length>0?n[0]:void 0}_generalFind(t,n){const a=[];return this._descendants(r=>{const l=r._isMatch(t);return l&&a.push(r),!!(l&&n)}),a}_descendants(t){let n=!1;const a=this.getChildren();for(const r of a){if(n=t(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(t),n))return!0}return!1}toObject(){const t=Yt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(n=>{t.children.push(n.toObject())}),t}isAncestorOf(t){let n=t.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(t){const n=Yt.prototype.clone.call(this,t);return this.getChildren().forEach(function(a){n.add(a.clone())}),n}getAllIntersections(t){const n=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(t)&&n.push(a)}),n}_clearSelfAndDescendantCache(t){var n;super._clearSelfAndDescendantCache(t),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(a){a._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(n,a){n.index=a}),this._requestDraw()}drawScene(t,n,a){const r=this.getLayer(),l=t||r&&r.getCanvas(),c=l&&l.getContext(),d=this._getCanvasCache(),g=d&&d.scene,m=l&&l.isCache;if(!this.isVisible()&&!m)return this;if(g){c.save();const _=this.getAbsoluteTransform(n).getMatrix();c.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",l,n,a);return this}drawHit(t,n){if(!this.shouldDrawHit(n))return this;const a=this.getLayer(),r=t||a&&a.hitCanvas,l=r&&r.getContext(),c=this._getCanvasCache();if(c&&c.hit){l.save();const g=this.getAbsoluteTransform(n).getMatrix();l.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(l),l.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(t,n,a,r){var l;const c=n&&n.getContext(),d=this.clipWidth(),g=this.clipHeight(),m=this.clipFunc(),_=typeof d=="number"&&typeof g=="number"||m,C=a===this;if(_){c.save();const O=this.getAbsoluteTransform(a);let v=O.getMatrix();c.transform(v[0],v[1],v[2],v[3],v[4],v[5]),c.beginPath();let M;if(m)M=m.call(this,c,this);else{const z=this.clipX(),L=this.clipY();c.rect(z||0,L||0,d,g)}c.clip.apply(c,M),v=O.copy().invert().getMatrix(),c.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const E=!C&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(c.save(),c._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(O){O[t](n,a,r)}),E&&c.restore(),_&&c.restore()}getClientRect(t={}){var n;const a=t.skipTransform,r=t.relativeTo;let l,c,d,g,m={x:1/0,y:1/0,width:0,height:0};const _=this;(n=this.children)===null||n===void 0||n.forEach(function(O){if(!O.visible())return;const v=O.getClientRect({relativeTo:_,skipShadow:t.skipShadow,skipStroke:t.skipStroke});v.width===0&&v.height===0||(l===void 0?(l=v.x,c=v.y,d=v.x+v.width,g=v.y+v.height):(l=Math.min(l,v.x),c=Math.min(c,v.y),d=Math.max(d,v.x+v.width),g=Math.max(g,v.y+v.height)))});const C=this.find("Shape");let E=!1;for(let O=0;O<C.length;O++)if(C[O]._isVisible(this)){E=!0;break}return E&&l!==void 0?m={x:l,y:c,width:d-l,height:g-c}:m={x:0,y:0,width:0,height:0},a?m:this._transformedRect(m,r)}}st.addComponentsGetterSetter(zi,"clip",["x","y","width","height"]);st.addGetterSetter(zi,"clipX",void 0,Kt());st.addGetterSetter(zi,"clipY",void 0,Kt());st.addGetterSetter(zi,"clipWidth",void 0,Kt());st.addGetterSetter(zi,"clipHeight",void 0,Kt());st.addGetterSetter(zi,"clipFunc");const fd=new Map,j2=Jt._global.PointerEvent!==void 0;function Ap(o){return fd.get(o)}function ev(o){return{evt:o,pointerId:o.pointerId}}function U2(o,t){return fd.get(o)===t}function B2(o,t){nd(o),t.getStage()&&(fd.set(o,t),j2&&t._fire("gotpointercapture",ev(new PointerEvent("gotpointercapture"))))}function nd(o,t){const n=fd.get(o);if(!n)return;const a=n.getStage();a&&a.content,fd.delete(o),j2&&n._fire("lostpointercapture",ev(new PointerEvent("lostpointercapture")))}const u5="Stage",c5="string",zy="px",f5="mouseout",z2="mouseleave",L2="mouseover",G2="mouseenter",P2="mousemove",H2="mousedown",I2="mouseup",Jh="pointermove",Zh="pointerdown",lf="pointerup",Wh="pointercancel",h5="lostpointercapture",X0="pointerout",$h="pointerleave",F0="pointerover",J0="pointerenter",Rm="contextmenu",k2="touchstart",q2="touchend",V2="touchmove",Y2="touchcancel",xm="wheel",d5=5,g5=[[G2,"_pointerenter"],[H2,"_pointerdown"],[P2,"_pointermove"],[I2,"_pointerup"],[z2,"_pointerleave"],[k2,"_pointerdown"],[V2,"_pointermove"],[q2,"_pointerup"],[Y2,"_pointercancel"],[L2,"_pointerover"],[xm,"_wheel"],[Rm,"_contextmenu"],[Zh,"_pointerdown"],[Jh,"_pointermove"],[lf,"_pointerup"],[Wh,"_pointercancel"],[$h,"_pointerleave"],[h5,"_lostpointercapture"]],wp={mouse:{[X0]:f5,[$h]:z2,[F0]:L2,[J0]:G2,[Jh]:P2,[Zh]:H2,[lf]:I2,[Wh]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[X0]:"touchout",[$h]:"touchleave",[F0]:"touchover",[J0]:"touchenter",[Jh]:V2,[Zh]:k2,[lf]:q2,[Wh]:Y2,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[X0]:X0,[$h]:$h,[F0]:F0,[J0]:J0,[Jh]:Jh,[Zh]:Zh,[lf]:lf,[Wh]:Wh,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},td=o=>o.indexOf("pointer")>=0?"pointer":o.indexOf("touch")>=0?"touch":"mouse",Qc=o=>{const t=td(o);if(t==="pointer")return Jt.pointerEventsEnabled&&wp.pointer;if(t==="touch")return wp.touch;if(t==="mouse")return wp.mouse};function Ly(o={}){return(o.clipFunc||o.clipWidth||o.clipHeight)&&vt.warn("Stage does not support clipping. Please use clip for Layers or Groups."),o}const p5="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",ad=[];let Rg=class extends zi{constructor(t){super(Ly(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),ad.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Ly(this.attrs)}),this._checkVisibility()}_validateAdd(t){const n=t.getType()==="Layer",a=t.getType()==="FastLayer";n||a||vt.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===c5){let n;if(t.charAt(0)==="."){const a=t.slice(1);t=document.getElementsByClassName(a)[0]}else t.charAt(0)!=="#"?n=t:n=t.slice(1),t=document.getElementById(n);if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,n=t.length;for(let a=0;a<n;a++)t[a].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),zi.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&vt._isInDocument(t)&&this.container().removeChild(t);const n=ad.indexOf(this);return n>-1&&ad.splice(n,1),vt.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(vt.warn(p5),null)}_getPointerById(t){return this._pointerPositions.find(n=>n.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const n=new oo({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),a=n.getContext()._context,r=this.children;return(t.x||t.y)&&a.translate(-1*t.x,-1*t.y),r.forEach(function(l){if(!l.isVisible())return;const c=l._toKonvaCanvas(t);a.drawImage(c._canvas,t.x,t.y,c.getWidth()/c.getPixelRatio(),c.getHeight()/c.getPixelRatio())}),n}getIntersection(t){if(!t)return null;const n=this.children,a=n.length,r=a-1;for(let l=r;l>=0;l--){const c=n[l].getIntersection(t);if(c)return c}return null}_resizeDOM(){const t=this.width(),n=this.height();this.content&&(this.content.style.width=t+zy,this.content.style.height=n+zy),this.bufferCanvas.setSize(t,n),this.bufferHitCanvas.setSize(t,n),this.children.forEach(a=>{a.setSize({width:t,height:n}),a.draw()})}add(t,...n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const a=this.children.length;return a>d5&&vt.warn("The stage has "+a+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Jt.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return U2(t,this)}setPointerCapture(t){B2(t,this)}releaseCapture(t){nd(t)}getLayers(){return this.children}_bindContentEvents(){Jt.isBrowser&&g5.forEach(([t,n])=>{this.content.addEventListener(t,a=>{this[n](a)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const n=Qc(t.type);n&&this._fire(n.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const n=Qc(t.type);n&&this._fire(n.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let n=this[t+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(t){const n=Qc(t.type),a=td(t.type);if(!n)return;this.setPointersPositions(t);const r=this._getTargetShape(a),l=!(Jt.isDragging()||Jt.isTransforming())||Jt.hitOnDragEnabled;r&&l?(r._fireAndBubble(n.pointerout,{evt:t}),r._fireAndBubble(n.pointerleave,{evt:t}),this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this[a+"targetShape"]=null):l&&(this._fire(n.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const n=Qc(t.type),a=td(t.type);if(!n)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(l=>{const c=this.getIntersection(l);if(cn.justDragged=!1,Jt["_"+a+"ListenClick"]=!0,!c||!c.isListening()){this[a+"ClickStartShape"]=void 0;return}Jt.capturePointerEventsEnabled&&c.setPointerCapture(l.id),this[a+"ClickStartShape"]=c,c._fireAndBubble(n.pointerdown,{evt:t,pointerId:l.id}),r=!0;const d=t.type.indexOf("touch")>=0;c.preventDefault()&&t.cancelable&&d&&t.preventDefault()}),r||this._fire(n.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const n=Qc(t.type),a=td(t.type);if(!n)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(Jt.isDragging()&&cn.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(Jt.isDragging()||Jt.isTransforming())||Jt.hitOnDragEnabled))return;const c={};let d=!1;const g=this._getTargetShape(a);this._changedPointerPositions.forEach(m=>{const _=Ap(m.id)||this.getIntersection(m),C=m.id,E={evt:t,pointerId:C},O=g!==_;if(O&&g&&(g._fireAndBubble(n.pointerout,{...E},_),g._fireAndBubble(n.pointerleave,{...E},_)),_){if(c[_._id])return;c[_._id]=!0}_&&_.isListening()?(d=!0,O&&(_._fireAndBubble(n.pointerover,{...E},g),_._fireAndBubble(n.pointerenter,{...E},g),this[a+"targetShape"]=_),_._fireAndBubble(n.pointermove,{...E})):g&&(this._fire(n.pointerover,{evt:t,target:this,currentTarget:this,pointerId:C}),this[a+"targetShape"]=null)}),d||this._fire(n.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const n=Qc(t.type),a=td(t.type);if(!n)return;this.setPointersPositions(t);const r=this[a+"ClickStartShape"],l=this[a+"ClickEndShape"],c={};let d=!1;this._changedPointerPositions.forEach(g=>{const m=Ap(g.id)||this.getIntersection(g);if(m){if(m.releaseCapture(g.id),c[m._id])return;c[m._id]=!0}const _=g.id,C={evt:t,pointerId:_};let E=!1;Jt["_"+a+"InDblClickWindow"]?(E=!0,clearTimeout(this[a+"DblTimeout"])):cn.justDragged||(Jt["_"+a+"InDblClickWindow"]=!0,clearTimeout(this[a+"DblTimeout"])),this[a+"DblTimeout"]=setTimeout(function(){Jt["_"+a+"InDblClickWindow"]=!1},Jt.dblClickWindow),m&&m.isListening()?(d=!0,this[a+"ClickEndShape"]=m,m._fireAndBubble(n.pointerup,{...C}),Jt["_"+a+"ListenClick"]&&r&&r===m&&(m._fireAndBubble(n.pointerclick,{...C}),E&&l&&l===m&&m._fireAndBubble(n.pointerdblclick,{...C}))):(this[a+"ClickEndShape"]=null,d||(this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),d=!0),Jt["_"+a+"ListenClick"]&&this._fire(n.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:_}),E&&this._fire(n.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:_}))}),d||this._fire(n.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Jt["_"+a+"ListenClick"]=!1,t.cancelable&&a!=="touch"&&a!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Rm,{evt:t}):this._fire(Rm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(xm,{evt:t}):this._fire(xm,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const n=Ap(t.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(lf,ev(t)),nd(t.pointerId)}_lostpointercapture(t){nd(t.pointerId)}setPointersPositions(t){const n=this._getContentPosition();let a=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,l=>{this._pointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,l=>{this._changedPointerPositions.push({id:l.identifier,x:(l.clientX-n.left)/n.scaleX,y:(l.clientY-n.top)/n.scaleY})})):(a=(t.clientX-n.left)/n.scaleX,r=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:a,y:r},this._pointerPositions=[{x:a,y:r,id:vt._getFirstPointerId(t)}],this._changedPointerPositions=[{x:a,y:r,id:vt._getFirstPointerId(t)}])}_setPointerPosition(t){vt.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new oo({width:this.width(),height:this.height()}),this.bufferHitCanvas=new $m({pixelRatio:1,width:this.width(),height:this.height()}),!Jt.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return vt.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Rg.prototype.nodeType=u5;Yn(Rg);st.addGetterSetter(Rg,"container");Jt.isBrowser&&document.addEventListener("visibilitychange",()=>{ad.forEach(o=>{o.batchDraw()})});const K2="hasShadow",Q2="shadowRGBA",X2="patternImage",F2="linearGradient",J2="radialGradient";let Z0;function Op(){return Z0||(Z0=vt.createCanvasElement().getContext("2d"),Z0)}const id={};function m5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function v5(o){o.stroke()}function y5(o){const t=this.attrs.fillRule;t?o.fill(t):o.fill()}function S5(o){o.stroke()}function b5(){this._clearCache(K2)}function _5(){this._clearCache(Q2)}function E5(){this._clearCache(X2)}function C5(){this._clearCache(F2)}function T5(){this._clearCache(J2)}class Gt extends Yt{constructor(t){super(t);let n;for(;n=vt.getRandomColor(),!(n&&!(n in id)););this.colorKey=n,id[n]=this}getContext(){return vt.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return vt.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(K2,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(X2,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const n=Op().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const a=new ji;a.translate(this.fillPatternX(),this.fillPatternY()),a.rotate(Jt.getAngle(this.fillPatternRotation())),a.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),a.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=a.getMatrix(),l=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(l)}return n}}_getLinearGradient(){return this._getCache(F2,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const n=Op(),a=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),l=n.createLinearGradient(a.x,a.y,r.x,r.y);for(let c=0;c<t.length;c+=2)l.addColorStop(t[c],t[c+1]);return l}}_getRadialGradient(){return this._getCache(J2,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const n=Op(),a=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),l=n.createRadialGradient(a.x,a.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let c=0;c<t.length;c+=2)l.addColorStop(t[c],t[c+1]);return l}}getShadowRGBA(){return this._getCache(Q2,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=vt.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const n=this.getStage();if(!n)return!1;const a=n.bufferHitCanvas;return a.getContext().clear(),this.drawHit(a,void 0,!0),a.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return Yt.prototype.destroy.call(this),delete id[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var n;if(!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=t||this.hasFill(),l=this.hasStroke(),c=this.getAbsoluteOpacity()!==1;if(r&&l&&c)return!0;const d=this.hasShadow(),g=this.shadowForStrokeEnabled();return!!(r&&l&&d&&g)}setStrokeHitEnabled(t){vt.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let n=!1,a=this.getParent();for(;a;){if(a.isCached()){n=!0;break}a=a.getParent()}const r=t.skipTransform,l=t.relativeTo||n&&this.getStage()||void 0,c=this.getSelfRect(),g=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,m=c.width+g,_=c.height+g,C=!t.skipShadow&&this.hasShadow(),E=C?this.shadowOffsetX():0,O=C?this.shadowOffsetY():0,v=m+Math.abs(E),M=_+Math.abs(O),z=C&&this.shadowBlur()||0,L=v+z*2,D=M+z*2,N={width:L,height:D,x:-(g/2+z)+Math.min(E,0)+c.x,y:-(g/2+z)+Math.min(O,0)+c.y};return r?N:this._transformedRect(N,l)}drawScene(t,n,a){const r=this.getLayer(),l=t||r.getCanvas(),c=l.getContext(),d=this._getCanvasCache(),g=this.getSceneFunc(),m=this.hasShadow();let _;const C=n===this;if(!this.isVisible()&&!C)return this;if(d){c.save();const E=this.getAbsoluteTransform(n).getMatrix();return c.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedSceneCanvas(c),c.restore(),this}if(!g)return this;if(c.save(),this._useBufferCanvas()){_=this.getStage();const E=a||_.bufferCanvas,O=E.getContext();O.clear(),O.save(),O._applyLineJoin(this),O._applyMiterLimit(this);const v=this.getAbsoluteTransform(n).getMatrix();O.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.call(this,O,this),O.restore();const M=E.pixelRatio;m&&c._applyShadow(this),c._applyOpacity(this),c._applyGlobalCompositeOperation(this),c.drawImage(E._canvas,E.x||0,E.y||0,E.width/M,E.height/M)}else{if(c._applyLineJoin(this),c._applyMiterLimit(this),!C){const E=this.getAbsoluteTransform(n).getMatrix();c.transform(E[0],E[1],E[2],E[3],E[4],E[5]),c._applyOpacity(this),c._applyGlobalCompositeOperation(this)}m&&c._applyShadow(this),g.call(this,c,this)}return c.restore(),this}drawHit(t,n,a=!1){if(!this.shouldDrawHit(n,a))return this;const r=this.getLayer(),l=t||r.hitCanvas,c=l&&l.getContext(),d=this.hitFunc()||this.sceneFunc(),g=this._getCanvasCache(),m=g&&g.hit;if(this.colorKey||vt.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),m){c.save();const C=this.getAbsoluteTransform(n).getMatrix();return c.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._drawCachedHitCanvas(c),c.restore(),this}if(!d)return this;if(c.save(),c._applyLineJoin(this),c._applyMiterLimit(this),!(this===n)){const C=this.getAbsoluteTransform(n).getMatrix();c.transform(C[0],C[1],C[2],C[3],C[4],C[5])}return d.call(this,c,this),c.restore(),this}drawHitFromCache(t=0){const n=this._getCanvasCache(),a=this._getCachedSceneCanvas(),r=n.hit,l=r.getContext(),c=r.getWidth(),d=r.getHeight();l.clear(),l.drawImage(a._canvas,0,0,c,d);try{const g=l.getImageData(0,0,c,d),m=g.data,_=m.length,C=vt._hexToRgb(this.colorKey);for(let E=0;E<_;E+=4)m[E+3]>t?(m[E]=C.r,m[E+1]=C.g,m[E+2]=C.b,m[E+3]=255):m[E+3]=0;l.putImageData(g,0,0)}catch(g){vt.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return U2(t,this)}setPointerCapture(t){B2(t,this)}releaseCapture(t){nd(t)}}Gt.prototype._fillFunc=m5;Gt.prototype._strokeFunc=v5;Gt.prototype._fillFuncHit=y5;Gt.prototype._strokeFuncHit=S5;Gt.prototype._centroid=!1;Gt.prototype.nodeType="Shape";Yn(Gt);Gt.prototype.eventListeners={};Gt.prototype.on.call(Gt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",b5);Gt.prototype.on.call(Gt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",C5);Gt.prototype.on.call(Gt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",T5);st.addGetterSetter(Gt,"stroke",void 0,D2());st.addGetterSetter(Gt,"strokeWidth",2,Kt());st.addGetterSetter(Gt,"fillAfterStrokeEnabled",!1);st.addGetterSetter(Gt,"hitStrokeWidth","auto",tv());st.addGetterSetter(Gt,"strokeHitEnabled",!0,Gr());st.addGetterSetter(Gt,"perfectDrawEnabled",!0,Gr());st.addGetterSetter(Gt,"shadowForStrokeEnabled",!0,Gr());st.addGetterSetter(Gt,"lineJoin");st.addGetterSetter(Gt,"lineCap");st.addGetterSetter(Gt,"miterLimit");st.addGetterSetter(Gt,"sceneFunc");st.addGetterSetter(Gt,"hitFunc");st.addGetterSetter(Gt,"dash");st.addGetterSetter(Gt,"dashOffset",0,Kt());st.addGetterSetter(Gt,"shadowColor",void 0,vu());st.addGetterSetter(Gt,"shadowBlur",0,Kt());st.addGetterSetter(Gt,"shadowOpacity",1,Kt());st.addComponentsGetterSetter(Gt,"shadowOffset",["x","y"]);st.addGetterSetter(Gt,"shadowOffsetX",0,Kt());st.addGetterSetter(Gt,"shadowOffsetY",0,Kt());st.addGetterSetter(Gt,"fillPatternImage");st.addGetterSetter(Gt,"fill",void 0,D2());st.addGetterSetter(Gt,"fillPatternX",0,Kt());st.addGetterSetter(Gt,"fillPatternY",0,Kt());st.addGetterSetter(Gt,"fillLinearGradientColorStops");st.addGetterSetter(Gt,"strokeLinearGradientColorStops");st.addGetterSetter(Gt,"fillRadialGradientStartRadius",0);st.addGetterSetter(Gt,"fillRadialGradientEndRadius",0);st.addGetterSetter(Gt,"fillRadialGradientColorStops");st.addGetterSetter(Gt,"fillPatternRepeat","repeat");st.addGetterSetter(Gt,"fillEnabled",!0);st.addGetterSetter(Gt,"strokeEnabled",!0);st.addGetterSetter(Gt,"shadowEnabled",!0);st.addGetterSetter(Gt,"dashEnabled",!0);st.addGetterSetter(Gt,"strokeScaleEnabled",!0);st.addGetterSetter(Gt,"fillPriority","color");st.addComponentsGetterSetter(Gt,"fillPatternOffset",["x","y"]);st.addGetterSetter(Gt,"fillPatternOffsetX",0,Kt());st.addGetterSetter(Gt,"fillPatternOffsetY",0,Kt());st.addComponentsGetterSetter(Gt,"fillPatternScale",["x","y"]);st.addGetterSetter(Gt,"fillPatternScaleX",1,Kt());st.addGetterSetter(Gt,"fillPatternScaleY",1,Kt());st.addComponentsGetterSetter(Gt,"fillLinearGradientStartPoint",["x","y"]);st.addComponentsGetterSetter(Gt,"strokeLinearGradientStartPoint",["x","y"]);st.addGetterSetter(Gt,"fillLinearGradientStartPointX",0);st.addGetterSetter(Gt,"strokeLinearGradientStartPointX",0);st.addGetterSetter(Gt,"fillLinearGradientStartPointY",0);st.addGetterSetter(Gt,"strokeLinearGradientStartPointY",0);st.addComponentsGetterSetter(Gt,"fillLinearGradientEndPoint",["x","y"]);st.addComponentsGetterSetter(Gt,"strokeLinearGradientEndPoint",["x","y"]);st.addGetterSetter(Gt,"fillLinearGradientEndPointX",0);st.addGetterSetter(Gt,"strokeLinearGradientEndPointX",0);st.addGetterSetter(Gt,"fillLinearGradientEndPointY",0);st.addGetterSetter(Gt,"strokeLinearGradientEndPointY",0);st.addComponentsGetterSetter(Gt,"fillRadialGradientStartPoint",["x","y"]);st.addGetterSetter(Gt,"fillRadialGradientStartPointX",0);st.addGetterSetter(Gt,"fillRadialGradientStartPointY",0);st.addComponentsGetterSetter(Gt,"fillRadialGradientEndPoint",["x","y"]);st.addGetterSetter(Gt,"fillRadialGradientEndPointX",0);st.addGetterSetter(Gt,"fillRadialGradientEndPointY",0);st.addGetterSetter(Gt,"fillPatternRotation",0);st.addGetterSetter(Gt,"fillRule",void 0,vu());st.backCompat(Gt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const A5="#",w5="beforeDraw",O5="draw",Z2=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],R5=Z2.length;let yu=class extends zi{constructor(t){super(t),this.canvas=new oo,this.hitCanvas=new $m({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),t<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[t+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Yt.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Yt.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Yt.prototype.moveDown.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Yt.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const n=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return Yt.prototype.remove.call(this),t&&t.parentNode&&vt._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:n}){return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&vt.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Yt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){vt.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){vt.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,vt.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let n=1,a=!1;for(;;){for(let r=0;r<R5;r++){const l=Z2[r],c=this._getIntersection({x:t.x+l.x*n,y:t.y+l.y*n}),d=c.shape;if(d)return d;if(a=!!c.antialiased,!c.antialiased)break}if(a)n+=1;else return null}}_getIntersection(t){const n=this.hitCanvas.pixelRatio,a=this.hitCanvas.context.getImageData(Math.round(t.x*n),Math.round(t.y*n),1,1).data,r=a[3];if(r===255){const l=vt._rgbToHex(a[0],a[1],a[2]),c=id[A5+l];return c?{shape:c}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,n,a){const r=this.getLayer(),l=t||r&&r.getCanvas();return this._fire(w5,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),zi.prototype.drawScene.call(this,l,n,a),this._fire(O5,{node:this}),this}drawHit(t,n){const a=this.getLayer(),r=t||a&&a.hitCanvas;return a&&a.clearBeforeDraw()&&a.getHitCanvas().getContext().clear(),zi.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){vt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return vt.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return vt.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};yu.prototype.nodeType="Layer";Yn(yu);st.addGetterSetter(yu,"imageSmoothingEnabled",!0);st.addGetterSetter(yu,"clearBeforeDraw",!0);st.addGetterSetter(yu,"hitGraphEnabled",!0,Gr());class nv extends yu{constructor(t){super(t),this.listening(!1),vt.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}nv.prototype.nodeType="FastLayer";Yn(nv);class uf extends zi{_validateAdd(t){const n=t.getType();n!=="Group"&&n!=="Shape"&&vt.throw("You may only add groups and shapes to groups.")}}uf.prototype.nodeType="Group";Yn(uf);const Rp=(function(){return gu.performance&&gu.performance.now?function(){return gu.performance.now()}:function(){return new Date().getTime()}})();class cr{constructor(t,n){this.id=cr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Rp(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(t){let n=[];return t&&(n=Array.isArray(t)?t:[t]),this.layers=n,this}getLayers(){return this.layers}addLayer(t){const n=this.layers,a=n.length;for(let r=0;r<a;r++)if(n[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const n=cr.animations,a=n.length;for(let r=0;r<a;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Rp(),cr._addAnimation(this),this}stop(){return cr._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const n=t.id,a=this.animations,r=a.length;for(let l=0;l<r;l++)if(a[l].id===n){this.animations.splice(l,1);break}}static _runFrames(){const t={},n=this.animations;for(let a=0;a<n.length;a++){const r=n[a],l=r.layers,c=r.func;r._updateFrameObject(Rp());const d=l.length;let g;if(c?g=c.call(r,r.frame)!==!1:g=!0,!!g)for(let m=0;m<d;m++){const _=l[m];_._id!==void 0&&(t[_._id]=_)}}for(const a in t)t.hasOwnProperty(a)&&t[a].batchDraw()}static _animationLoop(){const t=cr;t.animations.length?(t._runFrames(),vt.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,vt.requestAnimFrame(this._animationLoop))}}cr.animations=[];cr.animIdCounter=0;cr.animRunning=!1;const x5={node:1,duration:1,easing:1,onFinish:1,yoyo:1},N5=1,Gy=2,Py=3,Hy=["fill","stroke","shadowColor"];let M5=0;class D5{constructor(t,n,a,r,l,c,d){this.prop=t,this.propFunc=n,this.begin=r,this._pos=r,this.duration=c,this._change=0,this.prevPos=0,this.yoyo=d,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=a,this._change=l-this.begin,this.pause()}fire(t){const n=this[t];n&&n()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=Gy,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Py,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===Gy?this.setTime(t):this.state===Py&&this.setTime(this.duration-t)}pause(){this.state=N5,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Nn{constructor(t){const n=this,a=t.node,r=a._id,l=t.easing||rd.Linear,c=!!t.yoyo;let d,g;typeof t.duration>"u"?d=.3:t.duration===0?d=.001:d=t.duration,this.node=a,this._id=M5++;const m=a.getLayer()||(a instanceof Jt.Stage?a.getLayers():null);m||vt.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new cr(function(){n.tween.onEnterFrame()},m),this.tween=new D5(g,function(_){n._tweenFunc(_)},l,0,1,d*1e3,c),this._addListeners(),Nn.attrs[r]||(Nn.attrs[r]={}),Nn.attrs[r][this._id]||(Nn.attrs[r][this._id]={}),Nn.tweens[r]||(Nn.tweens[r]={});for(g in t)x5[g]===void 0&&this._addAttr(g,t[g]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,n){const a=this.node,r=a._id;let l,c,d,g,m;const _=Nn.tweens[r][t];_&&delete Nn.attrs[r][_][t];let C=a.getAttr(t);if(vt._isArray(n))if(l=[],c=Math.max(n.length,C.length),t==="points"&&n.length!==C.length&&(n.length>C.length?(g=C,C=vt._prepareArrayForTween(C,n,a.closed())):(d=n,n=vt._prepareArrayForTween(n,C,a.closed()))),t.indexOf("fill")===0)for(let E=0;E<c;E++)if(E%2===0)l.push(n[E]-C[E]);else{const O=vt.colorToRGBA(C[E]);m=vt.colorToRGBA(n[E]),C[E]=O,l.push({r:m.r-O.r,g:m.g-O.g,b:m.b-O.b,a:m.a-O.a})}else for(let E=0;E<c;E++)l.push(n[E]-C[E]);else Hy.indexOf(t)!==-1?(C=vt.colorToRGBA(C),m=vt.colorToRGBA(n),l={r:m.r-C.r,g:m.g-C.g,b:m.b-C.b,a:m.a-C.a}):l=n-C;Nn.attrs[r][this._id][t]={start:C,diff:l,end:n,trueEnd:d,trueStart:g},Nn.tweens[r][t]=this._id}_tweenFunc(t){const n=this.node,a=Nn.attrs[n._id][this._id];let r,l,c,d,g,m,_,C;for(r in a){if(l=a[r],c=l.start,d=l.diff,C=l.end,vt._isArray(c))if(g=[],_=Math.max(c.length,C.length),r.indexOf("fill")===0)for(m=0;m<_;m++)m%2===0?g.push((c[m]||0)+d[m]*t):g.push("rgba("+Math.round(c[m].r+d[m].r*t)+","+Math.round(c[m].g+d[m].g*t)+","+Math.round(c[m].b+d[m].b*t)+","+(c[m].a+d[m].a*t)+")");else for(m=0;m<_;m++)g.push((c[m]||0)+d[m]*t);else Hy.indexOf(r)!==-1?g="rgba("+Math.round(c.r+d.r*t)+","+Math.round(c.g+d.g*t)+","+Math.round(c.b+d.b*t)+","+(c.a+d.a*t)+")":g=c+d*t;n.setAttr(r,g)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,n=Nn.attrs[t._id][this._id];n.points&&n.points.trueEnd&&t.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,n=Nn.attrs[t._id][this._id];n.points&&n.points.trueStart&&t.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,n=this._id,a=Nn.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in a)delete Nn.tweens[t][r];delete Nn.attrs[t][n],Nn.tweens[t]&&(Object.keys(Nn.tweens[t]).length===0&&delete Nn.tweens[t],Object.keys(Nn.attrs[t]).length===0&&delete Nn.attrs[t])}}Nn.attrs={};Nn.tweens={};Yt.prototype.to=function(o){const t=o.onFinish;o.node=this,o.onFinish=function(){this.destroy(),t&&t()},new Nn(o).play()};const rd={BackEaseIn(o,t,n,a){return n*(o/=a)*o*((1.70158+1)*o-1.70158)+t},BackEaseOut(o,t,n,a){return n*((o=o/a-1)*o*((1.70158+1)*o+1.70158)+1)+t},BackEaseInOut(o,t,n,a){let r=1.70158;return(o/=a/2)<1?n/2*(o*o*(((r*=1.525)+1)*o-r))+t:n/2*((o-=2)*o*(((r*=1.525)+1)*o+r)+2)+t},ElasticEaseIn(o,t,n,a,r,l){let c=0;return o===0?t:(o/=a)===1?t+n:(l||(l=a*.3),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(o-=1))*Math.sin((o*a-c)*(2*Math.PI)/l))+t)},ElasticEaseOut(o,t,n,a,r,l){let c=0;return o===0?t:(o/=a)===1?t+n:(l||(l=a*.3),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*o)*Math.sin((o*a-c)*(2*Math.PI)/l)+n+t)},ElasticEaseInOut(o,t,n,a,r,l){let c=0;return o===0?t:(o/=a/2)===2?t+n:(l||(l=a*(.3*1.5)),!r||r<Math.abs(n)?(r=n,c=l/4):c=l/(2*Math.PI)*Math.asin(n/r),o<1?-.5*(r*Math.pow(2,10*(o-=1))*Math.sin((o*a-c)*(2*Math.PI)/l))+t:r*Math.pow(2,-10*(o-=1))*Math.sin((o*a-c)*(2*Math.PI)/l)*.5+n+t)},BounceEaseOut(o,t,n,a){return(o/=a)<1/2.75?n*(7.5625*o*o)+t:o<2/2.75?n*(7.5625*(o-=1.5/2.75)*o+.75)+t:o<2.5/2.75?n*(7.5625*(o-=2.25/2.75)*o+.9375)+t:n*(7.5625*(o-=2.625/2.75)*o+.984375)+t},BounceEaseIn(o,t,n,a){return n-rd.BounceEaseOut(a-o,0,n,a)+t},BounceEaseInOut(o,t,n,a){return o<a/2?rd.BounceEaseIn(o*2,0,n,a)*.5+t:rd.BounceEaseOut(o*2-a,0,n,a)*.5+n*.5+t},EaseIn(o,t,n,a){return n*(o/=a)*o+t},EaseOut(o,t,n,a){return-n*(o/=a)*(o-2)+t},EaseInOut(o,t,n,a){return(o/=a/2)<1?n/2*o*o+t:-n/2*(--o*(o-2)-1)+t},StrongEaseIn(o,t,n,a){return n*(o/=a)*o*o*o*o+t},StrongEaseOut(o,t,n,a){return n*((o=o/a-1)*o*o*o*o+1)+t},StrongEaseInOut(o,t,n,a){return(o/=a/2)<1?n/2*o*o*o*o*o+t:n/2*((o-=2)*o*o*o*o+2)+t},Linear(o,t,n,a){return n*o/a+t}},cf=vt._assign(Jt,{Util:vt,Transform:ji,Node:Yt,Container:zi,Stage:Rg,stages:ad,Layer:yu,FastLayer:nv,Group:uf,DD:cn,Shape:Gt,shapes:id,Animation:cr,Tween:Nn,Easings:rd,Context:wg,Canvas:Wm});class gl extends Gt{_sceneFunc(t){const n=Jt.getAngle(this.angle()),a=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,n,a),t.arc(0,0,this.innerRadius(),n,0,!a),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),n=this.outerRadius(),a=this.clockwise(),r=Jt.getAngle(a?360-this.angle():this.angle()),l=Math.cos(Math.min(r,Math.PI)),c=1,d=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),g=Math.sin(Math.min(r,Math.PI/2)),m=l*(l>0?t:n),_=c*n,C=d*(d>0?t:n),E=g*(g>0?n:t);return{x:m,y:a?-1*E:C,width:_-m,height:E-C}}}gl.prototype._centroid=!0;gl.prototype.className="Arc";gl.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];Yn(gl);st.addGetterSetter(gl,"innerRadius",0,Kt());st.addGetterSetter(gl,"outerRadius",0,Kt());st.addGetterSetter(gl,"angle",0,Kt());st.addGetterSetter(gl,"clockwise",!1,Gr());function Nm(o,t,n,a,r,l,c){const d=Math.sqrt(Math.pow(n-o,2)+Math.pow(a-t,2)),g=Math.sqrt(Math.pow(r-n,2)+Math.pow(l-a,2)),m=c*d/(d+g),_=c*g/(d+g),C=n-m*(r-o),E=a-m*(l-t),O=n+_*(r-o),v=a+_*(l-t);return[C,E,O,v]}function Iy(o,t){const n=o.length,a=[];for(let r=2;r<n-2;r+=2){const l=Nm(o[r-2],o[r-1],o[r],o[r+1],o[r+2],o[r+3],t);isNaN(l[0])||(a.push(l[0]),a.push(l[1]),a.push(o[r]),a.push(o[r+1]),a.push(l[2]),a.push(l[3]))}return a}let pl=class extends Gt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const n=this.points(),a=n.length,r=this.tension(),l=this.closed(),c=this.bezier();if(!a)return;let d=0;if(t.beginPath(),t.moveTo(n[0],n[1]),r!==0&&a>4){const g=this.getTensionPoints(),m=g.length;for(d=l?0:4,l||t.quadraticCurveTo(g[0],g[1],g[2],g[3]);d<m-2;)t.bezierCurveTo(g[d++],g[d++],g[d++],g[d++],g[d++],g[d++]);l||t.quadraticCurveTo(g[m-2],g[m-1],n[a-2],n[a-1])}else if(c)for(d=2;d<a;)t.bezierCurveTo(n[d++],n[d++],n[d++],n[d++],n[d++],n[d++]);else for(d=2;d<a;d+=2)t.lineTo(n[d],n[d+1]);l?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Iy(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),n=t.length,a=this.tension(),r=Nm(t[n-2],t[n-1],t[0],t[1],t[2],t[3],a),l=Nm(t[n-4],t[n-3],t[n-2],t[n-1],t[0],t[1],a),c=Iy(t,a);return[r[2],r[3]].concat(c).concat([l[0],l[1],t[n-2],t[n-1],l[2],l[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let n=t[0],a=t[0],r=t[1],l=t[1],c,d;for(let g=0;g<t.length/2;g++)c=t[g*2],d=t[g*2+1],n=Math.min(n,c),a=Math.max(a,c),r=Math.min(r,d),l=Math.max(l,d);return{x:n,y:r,width:a-n,height:l-r}}};pl.prototype.className="Line";pl.prototype._attrsAffectingSize=["points","bezier","tension"];Yn(pl);st.addGetterSetter(pl,"closed",!1);st.addGetterSetter(pl,"bezier",!1);st.addGetterSetter(pl,"tension",0,Kt());st.addGetterSetter(pl,"points",[],X3());const j5=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],U5=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],B5=[[1],[1,1],[1,2,1],[1,3,3,1]],ky=(o,t,n)=>{let a,r;const c=n/2;a=0;for(let d=0;d<20;d++)r=c*j5[20][d]+c,a+=U5[20][d]*z5(o,t,r);return c*a},qy=(o,t,n)=>{n===void 0&&(n=1);const a=o[0]-2*o[1]+o[2],r=t[0]-2*t[1]+t[2],l=2*o[1]-2*o[0],c=2*t[1]-2*t[0],d=4*(a*a+r*r),g=4*(a*l+r*c),m=l*l+c*c;if(d===0)return n*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(t[2]-t[0],2));const _=g/(2*d),C=m/d,E=n+_,O=C-_*_,v=E*E+O>0?Math.sqrt(E*E+O):0,M=_*_+O>0?Math.sqrt(_*_+O):0,z=_+Math.sqrt(_*_+O)!==0?O*Math.log(Math.abs((E+v)/(_+M))):0;return Math.sqrt(d)/2*(E*v-_*M+z)};function z5(o,t,n){const a=Mm(1,n,o),r=Mm(1,n,t),l=a*a+r*r;return Math.sqrt(l)}const Mm=(o,t,n)=>{const a=n.length-1;let r,l;if(a===0)return 0;if(o===0){l=0;for(let c=0;c<=a;c++)l+=B5[a][c]*Math.pow(1-t,a-c)*Math.pow(t,c)*n[c];return l}else{r=new Array(a);for(let c=0;c<a;c++)r[c]=a*(n[c+1]-n[c]);return Mm(o-1,t,r)}},Vy=(o,t,n)=>{let a=1,r=o/t,l=(o-n(r))/t,c=0;for(;a>.001;){const d=n(r+l),g=Math.abs(o-d)/t;if(g<a)a=g,r+=l;else{const m=n(r-l),_=Math.abs(o-m)/t;_<a?(a=_,r-=l):l/=2}if(c++,c>500)break}return r};class Mn extends Gt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Mn.parsePathData(this.data()),this.pathLength=Mn.getPathLength(this.dataArray)}_sceneFunc(t){const n=this.dataArray;t.beginPath();let a=!1;for(let r=0;r<n.length;r++){const l=n[r].command,c=n[r].points;switch(l){case"L":t.lineTo(c[0],c[1]);break;case"M":t.moveTo(c[0],c[1]);break;case"C":t.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":t.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":const d=c[0],g=c[1],m=c[2],_=c[3],C=c[4],E=c[5],O=c[6],v=c[7],M=m>_?m:_,z=m>_?1:m/_,L=m>_?_/m:1;t.translate(d,g),t.rotate(O),t.scale(z,L),t.arc(0,0,M,C,C+E,1-v),t.scale(1/z,1/L),t.rotate(-O),t.translate(-d,-g);break;case"z":a=!0,t.closePath();break}}!a&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(g){if(g.command==="A"){const m=g.points[4],_=g.points[5],C=g.points[4]+_;let E=Math.PI/180;if(Math.abs(m-C)<E&&(E=Math.abs(m-C)),_<0)for(let O=m-E;O>C;O-=E){const v=Mn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],O,0);t.push(v.x,v.y)}else for(let O=m+E;O<C;O+=E){const v=Mn.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],O,0);t.push(v.x,v.y)}}else if(g.command==="C")for(let m=0;m<=1;m+=.01){const _=Mn.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);t.push(_.x,_.y)}else t=t.concat(g.points)});let n=t[0],a=t[0],r=t[1],l=t[1],c,d;for(let g=0;g<t.length/2;g++)c=t[g*2],d=t[g*2+1],isNaN(c)||(n=Math.min(n,c),a=Math.max(a,c)),isNaN(d)||(r=Math.min(r,d),l=Math.max(l,d));return{x:n,y:r,width:a-n,height:l-r}}getLength(){return this.pathLength}getPointAtLength(t){return Mn.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,n,a,r){return Math.sqrt((a-t)*(a-t)+(r-n)*(r-n))}static getPathLength(t){let n=0;for(let a=0;a<t.length;++a)n+=t[a].pathLength;return n}static getPointAtLengthOfDataArray(t,n){let a,r=0,l=n.length;if(!l)return null;for(;r<l&&t>n[r].pathLength;)t-=n[r].pathLength,++r;if(r===l)return a=n[r-1].points.slice(-2),{x:a[0],y:a[1]};if(t<.01)return n[r].command==="M"?(a=n[r].points.slice(0,2),{x:a[0],y:a[1]}):{x:n[r].start.x,y:n[r].start.y};const c=n[r],d=c.points;switch(c.command){case"L":return Mn.getPointOnLine(t,c.start.x,c.start.y,d[0],d[1]);case"C":return Mn.getPointOnCubicBezier(Vy(t,Mn.getPathLength(n),M=>ky([c.start.x,d[0],d[2],d[4]],[c.start.y,d[1],d[3],d[5]],M)),c.start.x,c.start.y,d[0],d[1],d[2],d[3],d[4],d[5]);case"Q":return Mn.getPointOnQuadraticBezier(Vy(t,Mn.getPathLength(n),M=>qy([c.start.x,d[0],d[2]],[c.start.y,d[1],d[3]],M)),c.start.x,c.start.y,d[0],d[1],d[2],d[3]);case"A":const g=d[0],m=d[1],_=d[2],C=d[3],E=d[5],O=d[6];let v=d[4];return v+=E*t/c.pathLength,Mn.getPointOnEllipticalArc(g,m,_,C,v,O)}return null}static getPointOnLine(t,n,a,r,l,c,d){c=c??n,d=d??a;const g=this.getLineLength(n,a,r,l);if(g<1e-10)return{x:n,y:a};if(r===n)return{x:c,y:d+(l>a?t:-t)};const m=(l-a)/(r-n),_=Math.sqrt(t*t/(1+m*m))*(r<n?-1:1),C=m*_;if(Math.abs(d-a-m*(c-n))<1e-10)return{x:c+_,y:d+C};const E=((c-n)*(r-n)+(d-a)*(l-a))/(g*g),O=n+E*(r-n),v=a+E*(l-a),M=this.getLineLength(c,d,O,v),z=Math.sqrt(t*t-M*M),L=Math.sqrt(z*z/(1+m*m))*(r<n?-1:1),D=m*L;return{x:O+L,y:v+D}}static getPointOnCubicBezier(t,n,a,r,l,c,d,g,m){function _(z){return z*z*z}function C(z){return 3*z*z*(1-z)}function E(z){return 3*z*(1-z)*(1-z)}function O(z){return(1-z)*(1-z)*(1-z)}const v=g*_(t)+c*C(t)+r*E(t)+n*O(t),M=m*_(t)+d*C(t)+l*E(t)+a*O(t);return{x:v,y:M}}static getPointOnQuadraticBezier(t,n,a,r,l,c,d){function g(O){return O*O}function m(O){return 2*O*(1-O)}function _(O){return(1-O)*(1-O)}const C=c*g(t)+r*m(t)+n*_(t),E=d*g(t)+l*m(t)+a*_(t);return{x:C,y:E}}static getPointOnEllipticalArc(t,n,a,r,l,c){const d=Math.cos(c),g=Math.sin(c),m={x:a*Math.cos(l),y:r*Math.sin(l)};return{x:t+(m.x*d-m.y*g),y:n+(m.x*g+m.y*d)}}static parsePathData(t){if(!t)return[];let n=t;const a=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(let C=0;C<a.length;C++)n=n.replace(new RegExp(a[C],"g"),"|"+a[C]);const r=n.split("|"),l=[],c=[];let d=0,g=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let C=1;C<r.length;C++){let E=r[C],O=E.charAt(0);for(E=E.slice(1),c.length=0;_=m.exec(E);)c.push(_[0]);let v=[],M=O==="A"||O==="a"?0:-1;for(let z=0,L=c.length;z<L;z++){const D=c[z];if(D==="00"){v.push(0,0),M>=0&&(M+=2,M>=7&&(M-=7));continue}if(M>=0){if(M===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(D)){v.push(parseInt(D[0],10)),v.push(parseInt(D[1],10)),v.push(parseFloat(D.slice(2))),M+=3,M>=7&&(M-=7);continue}if(D==="11"||D==="10"||D==="01"){v.push(parseInt(D[0],10)),v.push(parseInt(D[1],10)),M+=2,M>=7&&(M-=7);continue}if(D==="0"||D==="1"){v.push(parseInt(D,10)),M+=1,M>=7&&(M-=7);continue}}else if(M===4){if(/^[01]\d+(?:\.\d+)?$/.test(D)){v.push(parseInt(D[0],10)),v.push(parseFloat(D.slice(1))),M+=2,M>=7&&(M-=7);continue}if(D==="0"||D==="1"){v.push(parseInt(D,10)),M+=1,M>=7&&(M-=7);continue}}const N=parseFloat(D);isNaN(N)?v.push(0):v.push(N),M+=1,M>=7&&(M-=7)}else{const N=parseFloat(D);isNaN(N)?v.push(0):v.push(N)}}for(;v.length>0&&!isNaN(v[0]);){let z="",L=[];const D=d,N=g;let G,R,A,T,y,B,j,P,Q,K;switch(O){case"l":d+=v.shift(),g+=v.shift(),z="L",L.push(d,g);break;case"L":d=v.shift(),g=v.shift(),L.push(d,g);break;case"m":const X=v.shift(),V=v.shift();if(d+=X,g+=V,z="M",l.length>2&&l[l.length-1].command==="z"){for(let U=l.length-2;U>=0;U--)if(l[U].command==="M"){d=l[U].points[0]+X,g=l[U].points[1]+V;break}}L.push(d,g),O="l";break;case"M":d=v.shift(),g=v.shift(),z="M",L.push(d,g),O="L";break;case"h":d+=v.shift(),z="L",L.push(d,g);break;case"H":d=v.shift(),z="L",L.push(d,g);break;case"v":g+=v.shift(),z="L",L.push(d,g);break;case"V":g=v.shift(),z="L",L.push(d,g);break;case"C":L.push(v.shift(),v.shift(),v.shift(),v.shift()),d=v.shift(),g=v.shift(),L.push(d,g);break;case"c":L.push(d+v.shift(),g+v.shift(),d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="C",L.push(d,g);break;case"S":R=d,A=g,G=l[l.length-1],G.command==="C"&&(R=d+(d-G.points[2]),A=g+(g-G.points[3])),L.push(R,A,v.shift(),v.shift()),d=v.shift(),g=v.shift(),z="C",L.push(d,g);break;case"s":R=d,A=g,G=l[l.length-1],G.command==="C"&&(R=d+(d-G.points[2]),A=g+(g-G.points[3])),L.push(R,A,d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="C",L.push(d,g);break;case"Q":L.push(v.shift(),v.shift()),d=v.shift(),g=v.shift(),L.push(d,g);break;case"q":L.push(d+v.shift(),g+v.shift()),d+=v.shift(),g+=v.shift(),z="Q",L.push(d,g);break;case"T":R=d,A=g,G=l[l.length-1],G.command==="Q"&&(R=d+(d-G.points[0]),A=g+(g-G.points[1])),d=v.shift(),g=v.shift(),z="Q",L.push(R,A,d,g);break;case"t":R=d,A=g,G=l[l.length-1],G.command==="Q"&&(R=d+(d-G.points[0]),A=g+(g-G.points[1])),d+=v.shift(),g+=v.shift(),z="Q",L.push(R,A,d,g);break;case"A":T=v.shift(),y=v.shift(),B=v.shift(),j=v.shift(),P=v.shift(),Q=d,K=g,d=v.shift(),g=v.shift(),z="A",L=this.convertEndpointToCenterParameterization(Q,K,d,g,j,P,T,y,B);break;case"a":T=v.shift(),y=v.shift(),B=v.shift(),j=v.shift(),P=v.shift(),Q=d,K=g,d+=v.shift(),g+=v.shift(),z="A",L=this.convertEndpointToCenterParameterization(Q,K,d,g,j,P,T,y,B);break}l.push({command:z||O,points:L,start:{x:D,y:N},pathLength:this.calcLength(D,N,z||O,L)})}(O==="z"||O==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(t,n,a,r){let l,c,d,g;const m=Mn;switch(a){case"L":return m.getLineLength(t,n,r[0],r[1]);case"C":return ky([t,r[0],r[2],r[4]],[n,r[1],r[3],r[5]],1);case"Q":return qy([t,r[0],r[2]],[n,r[1],r[3]],1);case"A":l=0;const _=r[4],C=r[5],E=r[4]+C;let O=Math.PI/180;if(Math.abs(_-E)<O&&(O=Math.abs(_-E)),c=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],_,0),C<0)for(g=_-O;g>E;g-=O)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),c=d;else for(g=_+O;g<E;g+=O)d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],g,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),c=d;return d=m.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],E,0),l+=m.getLineLength(c.x,c.y,d.x,d.y),l}return 0}static convertEndpointToCenterParameterization(t,n,a,r,l,c,d,g,m){const _=m*(Math.PI/180),C=Math.cos(_)*(t-a)/2+Math.sin(_)*(n-r)/2,E=-1*Math.sin(_)*(t-a)/2+Math.cos(_)*(n-r)/2,O=C*C/(d*d)+E*E/(g*g);O>1&&(d*=Math.sqrt(O),g*=Math.sqrt(O));let v=Math.sqrt((d*d*(g*g)-d*d*(E*E)-g*g*(C*C))/(d*d*(E*E)+g*g*(C*C)));l===c&&(v*=-1),isNaN(v)&&(v=0);const M=v*d*E/g,z=v*-g*C/d,L=(t+a)/2+Math.cos(_)*M-Math.sin(_)*z,D=(n+r)/2+Math.sin(_)*M+Math.cos(_)*z,N=function(j){return Math.sqrt(j[0]*j[0]+j[1]*j[1])},G=function(j,P){return(j[0]*P[0]+j[1]*P[1])/(N(j)*N(P))},R=function(j,P){return(j[0]*P[1]<j[1]*P[0]?-1:1)*Math.acos(G(j,P))},A=R([1,0],[(C-M)/d,(E-z)/g]),T=[(C-M)/d,(E-z)/g],y=[(-1*C-M)/d,(-1*E-z)/g];let B=R(T,y);return G(T,y)<=-1&&(B=Math.PI),G(T,y)>=1&&(B=0),c===0&&B>0&&(B=B-2*Math.PI),c===1&&B<0&&(B=B+2*Math.PI),[L,D,d,g,A,B,_,c]}}Mn.prototype.className="Path";Mn.prototype._attrsAffectingSize=["data"];Yn(Mn);st.addGetterSetter(Mn,"data");class Su extends pl{_sceneFunc(t){super._sceneFunc(t);const n=Math.PI*2,a=this.points();let r=a;const l=this.tension()!==0&&a.length>4;l&&(r=this.getTensionPoints());const c=this.pointerLength(),d=a.length;let g,m;if(l){const E=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],a[d-2],a[d-1]],O=Mn.calcLength(r[r.length-4],r[r.length-3],"C",E),v=Mn.getPointOnQuadraticBezier(Math.min(1,1-c/O),E[0],E[1],E[2],E[3],E[4],E[5]);g=a[d-2]-v.x,m=a[d-1]-v.y}else g=a[d-2]-a[d-4],m=a[d-1]-a[d-3];const _=(Math.atan2(m,g)+n)%n,C=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(a[d-2],a[d-1]),t.rotate(_),t.moveTo(0,0),t.lineTo(-c,C/2),t.lineTo(-c,-C/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(a[0],a[1]),l?(g=(r[0]+r[2])/2-a[0],m=(r[1]+r[3])/2-a[1]):(g=a[2]-a[0],m=a[3]-a[1]),t.rotate((Math.atan2(-m,-g)+n)%n),t.moveTo(0,0),t.lineTo(-c,C/2),t.lineTo(-c,-C/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),n=this.pointerWidth()/2;return{x:t.x,y:t.y-n,width:t.width,height:t.height+n*2}}}Su.prototype.className="Arrow";Yn(Su);st.addGetterSetter(Su,"pointerLength",10,Kt());st.addGetterSetter(Su,"pointerWidth",10,Kt());st.addGetterSetter(Su,"pointerAtBeginning",!1);st.addGetterSetter(Su,"pointerAtEnding",!0);class vf extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}vf.prototype._centroid=!0;vf.prototype.className="Circle";vf.prototype._attrsAffectingSize=["radius"];Yn(vf);st.addGetterSetter(vf,"radius",0,Kt());class go extends Gt{_sceneFunc(t){const n=this.radiusX(),a=this.radiusY();t.beginPath(),t.save(),n!==a&&t.scale(1,a/n),t.arc(0,0,n,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}go.prototype.className="Ellipse";go.prototype._centroid=!0;go.prototype._attrsAffectingSize=["radiusX","radiusY"];Yn(go);st.addComponentsGetterSetter(go,"radius",["x","y"]);st.addGetterSetter(go,"radiusX",0,Kt());st.addGetterSetter(go,"radiusY",0,Kt());let Pr=class W2 extends Gt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),n=this.hasShadow();return t&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const n=this.getWidth(),a=this.getHeight(),r=this.cornerRadius(),l=this.attrs.image;let c;if(l){const d=this.attrs.cropWidth,g=this.attrs.cropHeight;d&&g?c=[l,this.cropX(),this.cropY(),d,g,0,0,n,a]:c=[l,0,0,n,a]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?vt.drawRoundedRectPath(t,n,a,r):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)),l&&(r&&t.clip(),t.drawImage.apply(t,c))}_hitFunc(t){const n=this.width(),a=this.height(),r=this.cornerRadius();t.beginPath(),r?vt.drawRoundedRectPath(t,n,a,r):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,n,a;return(a=(t=this.attrs.width)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.width)!==null&&a!==void 0?a:0}getHeight(){var t,n,a;return(a=(t=this.attrs.height)!==null&&t!==void 0?t:(n=this.image())===null||n===void 0?void 0:n.height)!==null&&a!==void 0?a:0}static fromURL(t,n,a=null){const r=vt.createImageElement();r.onload=function(){const l=new W2({image:r});n(l)},r.onerror=a,r.crossOrigin="Anonymous",r.src=t}};Pr.prototype.className="Image";Pr.prototype._attrsAffectingSize=["image"];Yn(Pr);st.addGetterSetter(Pr,"cornerRadius",0,Og(4));st.addGetterSetter(Pr,"image");st.addComponentsGetterSetter(Pr,"crop",["x","y","width","height"]);st.addGetterSetter(Pr,"cropX",0,Kt());st.addGetterSetter(Pr,"cropY",0,Kt());st.addGetterSetter(Pr,"cropWidth",0,Kt());st.addGetterSetter(Pr,"cropHeight",0,Kt());const $2=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],L5="Change.konva",G5="none",Dm="up",jm="right",Um="down",Bm="left",P5=$2.length;class av extends uf{constructor(t){super(t),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let n=this,a;const r=function(){n._sync()};for(a=0;a<P5;a++)t.on($2[a]+L5,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),n=this.getTag(),a,r,l,c,d,g,m;if(t&&n){switch(a=t.width(),r=t.height(),l=n.pointerDirection(),c=n.pointerWidth(),m=n.pointerHeight(),d=0,g=0,l){case Dm:d=a/2,g=-1*m;break;case jm:d=a+c,g=r/2;break;case Um:d=a/2,g=r+m;break;case Bm:d=-1*c,g=r/2;break}n.setAttrs({x:-1*d,y:-1*g,width:a,height:r}),t.setAttrs({x:-1*d,y:-1*g})}}}av.prototype.className="Label";Yn(av);class bu extends Gt{_sceneFunc(t){const n=this.width(),a=this.height(),r=this.pointerDirection(),l=this.pointerWidth(),c=this.pointerHeight(),d=this.cornerRadius();let g=0,m=0,_=0,C=0;typeof d=="number"?g=m=_=C=Math.min(d,n/2,a/2):(g=Math.min(d[0]||0,n/2,a/2),m=Math.min(d[1]||0,n/2,a/2),C=Math.min(d[2]||0,n/2,a/2),_=Math.min(d[3]||0,n/2,a/2)),t.beginPath(),t.moveTo(g,0),r===Dm&&(t.lineTo((n-l)/2,0),t.lineTo(n/2,-1*c),t.lineTo((n+l)/2,0)),t.lineTo(n-m,0),t.arc(n-m,m,m,Math.PI*3/2,0,!1),r===jm&&(t.lineTo(n,(a-c)/2),t.lineTo(n+l,a/2),t.lineTo(n,(a+c)/2)),t.lineTo(n,a-C),t.arc(n-C,a-C,C,0,Math.PI/2,!1),r===Um&&(t.lineTo((n+l)/2,a),t.lineTo(n/2,a+c),t.lineTo((n-l)/2,a)),t.lineTo(_,a),t.arc(_,a-_,_,Math.PI/2,Math.PI,!1),r===Bm&&(t.lineTo(0,(a+c)/2),t.lineTo(-1*l,a/2),t.lineTo(0,(a-c)/2)),t.lineTo(0,g),t.arc(g,g,g,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,n=0,a=this.pointerWidth(),r=this.pointerHeight(),l=this.pointerDirection(),c=this.width(),d=this.height();return l===Dm?(n-=r,d+=r):l===Um?d+=r:l===Bm?(t-=a*1.5,c+=a):l===jm&&(c+=a*1.5),{x:t,y:n,width:c,height:d}}}bu.prototype.className="Tag";Yn(bu);st.addGetterSetter(bu,"pointerDirection",G5);st.addGetterSetter(bu,"pointerWidth",0,Kt());st.addGetterSetter(bu,"pointerHeight",0,Kt());st.addGetterSetter(bu,"cornerRadius",0,Og(4));class md extends Gt{_sceneFunc(t){const n=this.cornerRadius(),a=this.width(),r=this.height();t.beginPath(),n?vt.drawRoundedRectPath(t,a,r,n):t.rect(0,0,a,r),t.closePath(),t.fillStrokeShape(this)}}md.prototype.className="Rect";Yn(md);st.addGetterSetter(md,"cornerRadius",0,Og(4));class po extends Gt{_sceneFunc(t){const n=this._getPoints(),a=this.radius(),r=this.sides(),l=this.cornerRadius();if(t.beginPath(),l)vt.drawRoundedPolygonPath(t,n,r,a,l);else{t.moveTo(n[0].x,n[0].y);for(let c=1;c<n.length;c++)t.lineTo(n[c].x,n[c].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,n=this.attrs.radius||0,a=[];for(let r=0;r<t;r++)a.push({x:n*Math.sin(r*2*Math.PI/t),y:-1*n*Math.cos(r*2*Math.PI/t)});return a}getSelfRect(){const t=this._getPoints();let n=t[0].x,a=t[0].y,r=t[0].x,l=t[0].y;return t.forEach(c=>{n=Math.min(n,c.x),a=Math.max(a,c.x),r=Math.min(r,c.y),l=Math.max(l,c.y)}),{x:n,y:r,width:a-n,height:l-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}po.prototype.className="RegularPolygon";po.prototype._centroid=!0;po.prototype._attrsAffectingSize=["radius"];Yn(po);st.addGetterSetter(po,"radius",0,Kt());st.addGetterSetter(po,"sides",0,Kt());st.addGetterSetter(po,"cornerRadius",0,Og(4));const Yy=Math.PI*2;class _u extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Yy,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Yy,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}_u.prototype.className="Ring";_u.prototype._centroid=!0;_u.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Yn(_u);st.addGetterSetter(_u,"innerRadius",0,Kt());st.addGetterSetter(_u,"outerRadius",0,Kt());class vs extends Gt{constructor(t){super(t),this._updated=!0,this.anim=new cr(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const n=this.animation(),a=this.frameIndex(),r=a*4,l=this.animations()[n],c=this.frameOffsets(),d=l[r+0],g=l[r+1],m=l[r+2],_=l[r+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,m,_),t.closePath(),t.fillStrokeShape(this)),C)if(c){const E=c[n],O=a*2;t.drawImage(C,d,g,m,_,E[O+0],E[O+1],m,_)}else t.drawImage(C,d,g,m,_,0,0,m,_)}_hitFunc(t){const n=this.animation(),a=this.frameIndex(),r=a*4,l=this.animations()[n],c=this.frameOffsets(),d=l[r+2],g=l[r+3];if(t.beginPath(),c){const m=c[n],_=a*2;t.rect(m[_+0],m[_+1],d,g)}else t.rect(0,0,d,g);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),n=this.animation(),a=this.animations(),r=a[n],l=r.length/4;t<l-1?this.frameIndex(t+1):this.frameIndex(0)}}vs.prototype.className="Sprite";Yn(vs);st.addGetterSetter(vs,"animation");st.addGetterSetter(vs,"animations");st.addGetterSetter(vs,"frameOffsets");st.addGetterSetter(vs,"image");st.addGetterSetter(vs,"frameIndex",0,Kt());st.addGetterSetter(vs,"frameRate",17,Kt());st.backCompat(vs,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class mo extends Gt{_sceneFunc(t){const n=this.innerRadius(),a=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-a);for(let l=1;l<r*2;l++){const c=l%2===0?a:n,d=c*Math.sin(l*Math.PI/r),g=-1*c*Math.cos(l*Math.PI/r);t.lineTo(d,g)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}mo.prototype.className="Star";mo.prototype._centroid=!0;mo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Yn(mo);st.addGetterSetter(mo,"numPoints",5,Kt());st.addGetterSetter(mo,"innerRadius",0,Kt());st.addGetterSetter(mo,"outerRadius",0,Kt());function so(o){return[...o].reduce((t,n,a,r)=>{if(new RegExp("\\p{Emoji}","u").test(n)){const l=r[a+1];l&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(l)?(t.push(n+l),r[a+1]=""):t.push(n)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(n+(r[a+1]||""))?t.push(n+r[a+1]):a>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(n)?t[t.length-1]+=n:n&&t.push(n);return t},[])}const Xc="auto",H5="center",tS="inherit",Fc="justify",I5="Change.konva",k5="2d",Ky="-",eS="left",q5="text",V5="Text",Y5="top",K5="bottom",Qy="middle",nS="normal",Q5="px ",W0=" ",X5="right",Xy="rtl",F5="word",J5="char",Fy="none",xp="…",aS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Z5=aS.length;function W5(o){return o.split(",").map(t=>{t=t.trim();const n=t.indexOf(" ")>=0,a=t.indexOf('"')>=0||t.indexOf("'")>=0;return n&&!a&&(t=`"${t}"`),t}).join(", ")}let $0;function Np(){return $0||($0=vt.createCanvasElement().getContext(k5),$0)}function $5(o){o.fillText(this._partialText,this._partialTextX,this._partialTextY)}function t6(o){o.setAttr("miterLimit",2),o.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function e6(o){return o=o||{},!o.fillLinearGradientColorStops&&!o.fillRadialGradientColorStops&&!o.fillPatternImage&&(o.fill=o.fill||"black"),o}class Bn extends Gt{constructor(t){super(e6(t)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<Z5;n++)this.on(aS[n]+I5,this._setTextData);this._setTextData()}_sceneFunc(t){var n,a;const r=this.textArr,l=r.length;if(!this.text())return;let c=this.padding(),d=this.fontSize(),g=this.lineHeight()*d,m=this.verticalAlign(),_=this.direction(),C=0,E=this.align(),O=this.getWidth(),v=this.letterSpacing(),M=this.charRenderFunc(),z=this.fill(),L=this.textDecoration(),D=L.indexOf("underline")!==-1,N=L.indexOf("line-through")!==-1,G;_=_===tS?t.direction:_;let R=g/2,A=Qy;if(!Jt.legacyTextRendering){const T=this.measureSize("M");A="alphabetic";const y=(n=T.fontBoundingBoxAscent)!==null&&n!==void 0?n:T.actualBoundingBoxAscent,B=(a=T.fontBoundingBoxDescent)!==null&&a!==void 0?a:T.actualBoundingBoxDescent;R=(y-B)/2+g/2}for(_===Xy&&t.setAttr("direction",_),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",A),t.setAttr("textAlign",eS),m===Qy?C=(this.getHeight()-l*g-c*2)/2:m===K5&&(C=this.getHeight()-l*g-c*2),t.translate(c,C+c),G=0;G<l;G++){let T=0,y=0;const B=r[G],j=B.text,P=B.width,Q=B.lastInParagraph;if(t.save(),E===X5?T+=O-P-c*2:E===H5&&(T+=(O-P-c*2)/2),D){t.save(),t.beginPath();const K=Jt.legacyTextRendering?Math.round(d/2):Math.round(d/4),X=T,V=R+y+K;t.moveTo(X,V);const U=E===Fc&&!Q?O-c*2:P;t.lineTo(X+Math.round(U),V),t.lineWidth=d/15;const I=this._getLinearGradient();t.strokeStyle=I||z,t.stroke(),t.restore()}if(_!==Xy&&(v!==0||E===Fc||M)){const K=j.split(" ").length-1,X=so(j);for(let V=0;V<X.length;V++){const U=X[V];if(U===" "&&!Q&&E===Fc&&(T+=(O-c*2-P)/K),this._partialTextX=T,this._partialTextY=R+y,this._partialText=U,M){t.save();const F=r.slice(0,G).reduce((it,Z)=>it+so(Z.text).length,0),W=V+F;M({char:U,index:W,x:T,y:R+y,lineIndex:G,column:V,isLastInLine:Q,width:this.measureSize(U).width,context:t})}t.fillStrokeShape(this),M&&t.restore(),T+=this.measureSize(U).width+v}}else v!==0&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=T,this._partialTextY=R+y,this._partialText=j,t.fillStrokeShape(this);if(N){t.save(),t.beginPath();const K=Jt.legacyTextRendering?0:-Math.round(d/4),X=E===Fc?0:T;t.moveTo(X,R+y+K);const V=E===Fc&&!Q?O-c*2:P;t.lineTo(X+Math.round(V),R+y+K),t.lineWidth=d/15;const U=this._getLinearGradient();t.strokeStyle=U||z,t.stroke(),t.restore()}t.restore(),l>1&&(R+=g)}}_hitFunc(t){const n=this.getWidth(),a=this.getHeight();t.beginPath(),t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}setText(t){const n=vt._isString(t)?t:t==null?"":t+"";return this._setAttr(q5,n),this}getWidth(){return this.attrs.width===Xc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Xc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return vt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var n,a,r,l,c,d,g,m,_,C,E;let O=Np(),v=this.fontSize(),M;O.save(),O.font=this._getContextFont(),M=O.measureText(t),O.restore();const z=v/100;return{actualBoundingBoxAscent:(n=M.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*z,actualBoundingBoxDescent:(a=M.actualBoundingBoxDescent)!==null&&a!==void 0?a:0,actualBoundingBoxLeft:(r=M.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*z,actualBoundingBoxRight:(l=M.actualBoundingBoxRight)!==null&&l!==void 0?l:75.732421875*z,alphabeticBaseline:(c=M.alphabeticBaseline)!==null&&c!==void 0?c:0,emHeightAscent:(d=M.emHeightAscent)!==null&&d!==void 0?d:100*z,emHeightDescent:(g=M.emHeightDescent)!==null&&g!==void 0?g:-20*z,fontBoundingBoxAscent:(m=M.fontBoundingBoxAscent)!==null&&m!==void 0?m:91*z,fontBoundingBoxDescent:(_=M.fontBoundingBoxDescent)!==null&&_!==void 0?_:21*z,hangingBaseline:(C=M.hangingBaseline)!==null&&C!==void 0?C:72.80000305175781*z,ideographicBaseline:(E=M.ideographicBaseline)!==null&&E!==void 0?E:-21*z,width:M.width,height:v}}_getContextFont(){return this.fontStyle()+W0+this.fontVariant()+W0+(this.fontSize()+Q5)+W5(this.fontFamily())}_addTextLine(t){this.align()===Fc&&(t=t.trim());const a=this._getTextWidth(t);return this.textArr.push({text:t,width:a,lastInParagraph:!1})}_getTextWidth(t){const n=this.letterSpacing(),a=t.length;return Np().measureText(t).width+n*a}_setTextData(){let t=this.text().split(`
`),n=+this.fontSize(),a=0,r=this.lineHeight()*n,l=this.attrs.width,c=this.attrs.height,d=l!==Xc&&l!==void 0,g=c!==Xc&&c!==void 0,m=this.padding(),_=l-m*2,C=c-m*2,E=0,O=this.wrap(),v=O!==Fy,M=O!==J5&&v,z=this.ellipsis();this.textArr=[],Np().font=this._getContextFont();const L=z?this._getTextWidth(xp):0;for(let D=0,N=t.length;D<N;++D){let G=t[D],R=this._getTextWidth(G);if(d&&R>_)for(;G.length>0;){let A=0,T=so(G).length,y="",B=0;for(;A<T;){const j=A+T>>>1,P=so(G),Q=P.slice(0,j+1).join(""),K=this._getTextWidth(Q);(z&&g&&E+r>C?K+L:K)<=_?(A=j+1,y=Q,B=K):T=j}if(y){if(M){const Q=so(G),K=so(y),X=Q[K.length],V=X===W0||X===Ky;let U;if(V&&B<=_)U=K.length;else{const I=K.lastIndexOf(W0),F=K.lastIndexOf(Ky);U=Math.max(I,F)+1}U>0&&(A=U,y=Q.slice(0,A).join(""),B=this._getTextWidth(y))}if(y=y.trimRight(),this._addTextLine(y),a=Math.max(a,B),E+=r,this._shouldHandleEllipsis(E)){this._tryToAddEllipsisToLastLine();break}if(G=so(G).slice(A).join("").trimLeft(),G.length>0&&(R=this._getTextWidth(G),R<=_)){this._addTextLine(G),E+=r,a=Math.max(a,R);break}}else break}else this._addTextLine(G),E+=r,a=Math.max(a,R),this._shouldHandleEllipsis(E)&&D<N-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),g&&E+r>C)break}this.textHeight=n,this.textWidth=a}_shouldHandleEllipsis(t){const n=+this.fontSize(),a=this.lineHeight()*n,r=this.attrs.height,l=r!==Xc&&r!==void 0,c=this.padding(),d=r-c*2;return!(this.wrap()!==Fy)||l&&t+a>d}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,n=t!==Xc&&t!==void 0,a=this.padding(),r=t-a*2,l=this.ellipsis(),c=this.textArr[this.textArr.length-1];!c||!l||(n&&(this._getTextWidth(c.text+xp)<r||(c.text=c.text.slice(0,c.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(c.text+xp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return t&&n?!0:super._useBufferCanvas()}}Bn.prototype._fillFunc=$5;Bn.prototype._strokeFunc=t6;Bn.prototype.className=V5;Bn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Yn(Bn);st.overWriteSetter(Bn,"width",tv());st.overWriteSetter(Bn,"height",tv());st.addGetterSetter(Bn,"direction",tS);st.addGetterSetter(Bn,"fontFamily","Arial");st.addGetterSetter(Bn,"fontSize",12,Kt());st.addGetterSetter(Bn,"fontStyle",nS);st.addGetterSetter(Bn,"fontVariant",nS);st.addGetterSetter(Bn,"padding",0,Kt());st.addGetterSetter(Bn,"align",eS);st.addGetterSetter(Bn,"verticalAlign",Y5);st.addGetterSetter(Bn,"lineHeight",1,Kt());st.addGetterSetter(Bn,"wrap",F5);st.addGetterSetter(Bn,"ellipsis",!1,Gr());st.addGetterSetter(Bn,"letterSpacing",0,Kt());st.addGetterSetter(Bn,"text","",vu());st.addGetterSetter(Bn,"textDecoration","");st.addGetterSetter(Bn,"charRenderFunc",void 0);const n6="",iS="normal";function rS(o){o.fillText(this.partialText,0,0)}function sS(o){o.strokeText(this.partialText,0,0)}class _a extends Gt{constructor(t){super(t),this.dummyCanvas=vt.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Mn.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const n=this.pathLength;return t>n?null:Mn.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Mn.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const n=this.textDecoration(),a=this.fill(),r=this.fontSize(),l=this.glyphInfo,c=n.indexOf("underline")!==-1,d=n.indexOf("line-through")!==-1;c&&t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),this.partialText=l[g].text,t.fillStrokeShape(this),c&&(g===0&&t.moveTo(0,r/2+1),t.lineTo(l[g].width,r/2+1)),t.restore()}if(c&&(t.strokeStyle=a,t.lineWidth=r/20,t.stroke()),d){t.beginPath();for(let g=0;g<l.length;g++){t.save();const m=l[g].p0;t.translate(m.x,m.y),t.rotate(l[g].rotation),g===0&&t.moveTo(0,0),t.lineTo(l[g].width,0),t.restore()}t.strokeStyle=a,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const n=this.glyphInfo;if(n.length>=1){const a=n[0].p0;t.moveTo(a.x,a.y)}for(let a=0;a<n.length;a++){const r=n[a].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return vt.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Bn.prototype.setText.call(this,t)}_getContextFont(){return Bn.prototype._getContextFont.call(this)}_getTextSize(t){const a=this.dummyCanvas.getContext("2d");a.save(),a.font=this._getContextFont();const r=a.measureText(t);return a.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=so(this.text()),n=[];let a=0;for(let C=0;C<t.length;C++)n.push({char:t[C],width:this._getTextSize(t[C]).width}),a+=n[C].width;const{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=a,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const l=this.letterSpacing(),c=this.align(),d=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*l,0);let m=0;c==="center"&&(m=Math.max(0,this.pathLength/2-g/2)),c==="right"&&(m=Math.max(0,this.pathLength-g));let _=m;for(let C=0;C<n.length;C++){const E=this._getPointAtLength(_);if(!E)return;const O=n[C].char;let v=n[C].width+l;if(O===" "&&c==="justify"){const G=this.text().split(" ").length-1;v+=(this.pathLength-g)/G}const M=this._getPointAtLength(_+v);if(!M)return;const z=Mn.getLineLength(E.x,E.y,M.x,M.y);let L=0;if(d)try{L=d(n[C-1].char,O)*this.fontSize()}catch{L=0}E.x+=L,M.x+=L,this.textWidth+=L;const D=Mn.getPointOnLine(L+z/2,E.x,E.y,M.x,M.y),N=Math.atan2(M.y-E.y,M.x-E.x);this.glyphInfo.push({transposeX:D.x,transposeY:D.y,text:t[C],rotation:N,p0:E,p1:M,width:z}),_+=v}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});let n=t[0]||0,a=t[0]||0,r=t[1]||0,l=t[1]||0,c,d;for(let m=0;m<t.length/2;m++)c=t[m*2],d=t[m*2+1],n=Math.min(n,c),a=Math.max(a,c),r=Math.min(r,d),l=Math.max(l,d);const g=this.fontSize();return{x:n-g/2,y:r-g/2,width:a-n+g,height:l-r+g}}destroy(){return vt.releaseCanvas(this.dummyCanvas),super.destroy()}}_a.prototype._fillFunc=rS;_a.prototype._strokeFunc=sS;_a.prototype._fillFuncHit=rS;_a.prototype._strokeFuncHit=sS;_a.prototype.className="TextPath";_a.prototype._attrsAffectingSize=["text","fontSize","data"];Yn(_a);st.addGetterSetter(_a,"data");st.addGetterSetter(_a,"fontFamily","Arial");st.addGetterSetter(_a,"fontSize",12,Kt());st.addGetterSetter(_a,"fontStyle",iS);st.addGetterSetter(_a,"align","left");st.addGetterSetter(_a,"letterSpacing",0,Kt());st.addGetterSetter(_a,"textBaseline","middle");st.addGetterSetter(_a,"fontVariant",iS);st.addGetterSetter(_a,"text",n6);st.addGetterSetter(_a,"textDecoration","");st.addGetterSetter(_a,"kerningFunc",void 0);const lS="tr-konva",a6=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(o=>o+`.${lS}`).join(" "),Jy="nodesRect",i6=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],r6={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},s6="ontouchstart"in Jt._global;function l6(o,t,n){if(o==="rotater")return n;t+=vt.degToRad(r6[o]||0);const a=(vt.radToDeg(t)%360+360)%360;return vt._inRange(a,315+22.5,360)||vt._inRange(a,0,22.5)?"ns-resize":vt._inRange(a,45-22.5,45+22.5)?"nesw-resize":vt._inRange(a,90-22.5,90+22.5)?"ew-resize":vt._inRange(a,135-22.5,135+22.5)?"nwse-resize":vt._inRange(a,180-22.5,180+22.5)?"ns-resize":vt._inRange(a,225-22.5,225+22.5)?"nesw-resize":vt._inRange(a,270-22.5,270+22.5)?"ew-resize":vt._inRange(a,315-22.5,315+22.5)?"nwse-resize":(vt.error("Transformer has unknown angle for cursor detection: "+a),"pointer")}const pg=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function o6(o){return{x:o.x+o.width/2*Math.cos(o.rotation)+o.height/2*Math.sin(-o.rotation),y:o.y+o.height/2*Math.cos(o.rotation)+o.width/2*Math.sin(o.rotation)}}function oS(o,t,n){const a=n.x+(o.x-n.x)*Math.cos(t)-(o.y-n.y)*Math.sin(t),r=n.y+(o.x-n.x)*Math.sin(t)+(o.y-n.y)*Math.cos(t);return{...o,rotation:o.rotation+t,x:a,y:r}}function u6(o,t){const n=o6(o);return oS(o,t,n)}function c6(o,t,n){let a=t;for(let r=0;r<o.length;r++){const l=Jt.getAngle(o[r]),c=Math.abs(l-t)%(Math.PI*2);Math.min(c,Math.PI*2-c)<n&&(a=l)}return a}let zm=0;class Xe extends uf{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(a6,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return vt.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return lS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const n=t.filter(r=>r.isAncestorOf(this)?(vt.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=n,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(r._attrsAffectingSize.length){const c=r._attrsAffectingSize.map(d=>d+"Change."+this._getEventNamespace()).join(" ");r.on(c,l)}r.on(i6.map(c=>c+`.${this._getEventNamespace()}`).join(" "),l),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(r)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let n;t.on(`dragstart.${this._getEventNamespace()}`,a=>{n=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(a,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,a=>{if(!n)return;const r=t.getAbsolutePosition(),l=r.x-n.x,c=r.y-n.y;this.nodes().forEach(d=>{if(d===t||d.isDragging())return;const g=d.getAbsolutePosition();d.setAbsolutePosition({x:g.x+l,y:g.y+c}),d.startDrag(a)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Jy),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Jy,this.__getNodeRect)}__getNodeShape(t,n=this.rotation(),a){const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=t.getAbsoluteScale(a),c=t.getAbsolutePosition(a),d=r.x*l.x-t.offsetX()*l.x,g=r.y*l.y-t.offsetY()*l.y,m=(Jt.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),_={x:c.x+d*Math.cos(m)+g*Math.sin(-m),y:c.y+g*Math.cos(m)+d*Math.sin(m),width:r.width*l.x,height:r.height*l.y,rotation:m};return oS(_,-Jt.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(m=>{const _=m.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),C=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}],E=m.getAbsoluteTransform();C.forEach(function(O){const v=E.point(O);n.push(v)})});const a=new ji;a.rotate(-Jt.getAngle(this.rotation()));let r=1/0,l=1/0,c=-1/0,d=-1/0;n.forEach(function(m){const _=a.point(m);r===void 0&&(r=c=_.x,l=d=_.y),r=Math.min(r,_.x),l=Math.min(l,_.y),c=Math.max(c,_.x),d=Math.max(d,_.y)}),a.invert();const g=a.point({x:r,y:l});return{x:g.x,y:g.y,width:c-r,height:d-l,rotation:Jt.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),pg.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const n=new md({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:s6?10:"auto"}),a=this;n.on("mousedown touchstart",function(r){a._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{const r=Jt.getAngle(this.rotation()),l=this.rotateAnchorCursor(),c=l6(t,r,l);n.getStage().content&&(n.getStage().content.style.cursor=c),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const t=new Gt({name:"back",width:0,height:0,sceneFunc(n,a){const r=a.getParent(),l=r.padding();n.beginPath(),n.rect(-l,-l,a.width()+l*2,a.height()+l*2),n.moveTo(a.width()/2,-l),r.rotateEnabled()&&r.rotateLineVisible()&&n.lineTo(a.width()/2,-r.rotateAnchorOffset()*vt._sign(a.height())-l),n.fillStrokeShape(a)},hitFunc:(n,a)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();n.beginPath(),n.rect(-r,-r,a.width()+r*2,a.height()+r*2),n.fillStrokeShape(a)}});this.add(t),this._proxyDrag(t),t.on("dragstart",n=>{n.cancelBubble=!0}),t.on("dragmove",n=>{n.cancelBubble=!0}),t.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const n=this._getNodeRect(),a=n.width,r=n.height,l=Math.sqrt(Math.pow(a,2)+Math.pow(r,2));this.sin=Math.abs(r/l),this.cos=Math.abs(a/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const c=t.target.getAbsolutePosition(),d=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:d.x-c.x,y:d.y-c.y},zm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(g=>{g._fire("transformstart",{evt:t.evt,target:g})})}_handleMouseMove(t){let n,a,r;const l=this.findOne("."+this._movingAnchorName),c=l.getStage();c.setPointersPositions(t);const d=c.getPointerPosition();let g={x:d.x-this._anchorDragOffset.x,y:d.y-this._anchorDragOffset.y};const m=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(g=this.anchorDragBoundFunc()(m,g,t)),l.setAbsolutePosition(g);const _=l.getAbsolutePosition();if(m.x===_.x&&m.y===_.y)return;if(this._movingAnchorName==="rotater"){const D=this._getNodeRect();n=l.x()-D.width/2,a=-l.y()+D.height/2;let N=Math.atan2(-a,n)+Math.PI/2;D.height<0&&(N-=Math.PI);const R=Jt.getAngle(this.rotation())+N,A=Jt.getAngle(this.rotationSnapTolerance()),y=c6(this.rotationSnaps(),R,A)-D.rotation,B=u6(D,y);this._fitNodesInto(B,t);return}const C=this.shiftBehavior();let E;C==="inverted"?E=this.keepRatio()&&!t.shiftKey:C==="none"?E=this.keepRatio():E=this.keepRatio()||t.shiftKey;let O=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(E){const D=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(D.x-l.x(),2)+Math.pow(D.y-l.y(),2));const N=this.findOne(".top-left").x()>D.x?-1:1,G=this.findOne(".top-left").y()>D.y?-1:1;n=r*this.cos*N,a=r*this.sin*G,this.findOne(".top-left").x(D.x-n),this.findOne(".top-left").y(D.y-a)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(E){const D=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(l.x()-D.x,2)+Math.pow(D.y-l.y(),2));const N=this.findOne(".top-right").x()<D.x?-1:1,G=this.findOne(".top-right").y()>D.y?-1:1;n=r*this.cos*N,a=r*this.sin*G,this.findOne(".top-right").x(D.x+n),this.findOne(".top-right").y(D.y-a)}var v=l.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(E){const D=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(D.x-l.x(),2)+Math.pow(l.y()-D.y,2));const N=D.x<l.x()?-1:1,G=l.y()<D.y?-1:1;n=r*this.cos*N,a=r*this.sin*G,l.x(D.x-n),l.y(D.y+a)}v=l.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(E){const D=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(l.x()-D.x,2)+Math.pow(l.y()-D.y,2));const N=this.findOne(".bottom-right").x()<D.x?-1:1,G=this.findOne(".bottom-right").y()<D.y?-1:1;n=r*this.cos*N,a=r*this.sin*G,this.findOne(".bottom-right").x(D.x+n),this.findOne(".bottom-right").y(D.y+a)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(O=this.centeredScaling()||t.altKey,O){const D=this.findOne(".top-left"),N=this.findOne(".bottom-right"),G=D.x(),R=D.y(),A=this.getWidth()-N.x(),T=this.getHeight()-N.y();N.move({x:-G,y:-R}),D.move({x:A,y:T})}const M=this.findOne(".top-left").getAbsolutePosition();n=M.x,a=M.y;const z=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),L=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:a,width:z,height:L,rotation:Jt.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const a=this.getNode();zm--,this._fire("transformend",{evt:t,target:a}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),a&&this._nodes.forEach(r=>{var l;r._fire("transformend",{evt:t,target:r}),(l=r.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,n){const a=this._getNodeRect(),r=1;if(vt._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(vt._inRange(t.height,-this.padding()*2-r,r)){this.update();return}const l=new ji;if(l.rotate(Jt.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=l.point({x:-this.padding()*2,y:0});t.x+=E.x,t.y+=E.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=l.point({x:0,y:-this.padding()*2});t.x+=E.x,t.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(a,t);E?t=E:vt.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const c=1e7,d=new ji;d.translate(a.x,a.y),d.rotate(a.rotation),d.scale(a.width/c,a.height/c);const g=new ji,m=t.width/c,_=t.height/c;this.flipEnabled()===!1?(g.translate(t.x,t.y),g.rotate(t.rotation),g.translate(t.width<0?t.width:0,t.height<0?t.height:0),g.scale(Math.abs(m),Math.abs(_))):(g.translate(t.x,t.y),g.rotate(t.rotation),g.scale(m,_));const C=g.multiply(d.invert());this._nodes.forEach(E=>{var O;if(!E.getStage())return;const v=E.getParent().getAbsoluteTransform(),M=E.getTransform().copy();M.translate(E.offsetX(),E.offsetY());const z=new ji;z.multiply(v.copy().invert()).multiply(C).multiply(v).multiply(M);const L=z.decompose();E.setAttrs(L),(O=E.getLayer())===null||O===void 0||O.batchDraw()}),this.rotation(vt._getRotation(t.rotation)),this._nodes.forEach(E=>{this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,n){this.findOne(t).setAttrs(n)}update(){var t;const n=this._getNodeRect();this.rotation(vt._getRotation(n.rotation));const a=n.width,r=n.height,l=this.enabledAnchors(),c=this.resizeEnabled(),d=this.padding(),g=this.anchorSize(),m=this.find("._anchor");m.forEach(C=>{C.setAttrs({width:g,height:g,offsetX:g/2,offsetY:g/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:g/2+d,offsetY:g/2+d,visible:c&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:a/2,y:0,offsetY:g/2+d,visible:c&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:a,y:0,offsetX:g/2-d,offsetY:g/2+d,visible:c&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:g/2+d,visible:c&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:a,y:r/2,offsetX:g/2-d,visible:c&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:g/2+d,offsetY:g/2-d,visible:c&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:a/2,y:r,offsetY:g/2-d,visible:c&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:a,y:r,offsetX:g/2-d,offsetY:g/2-d,visible:c&&l.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:a/2,y:-this.rotateAnchorOffset()*vt._sign(r)-d,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:a,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(C=>C.draggable()),x:0,y:0});const _=this.anchorStyleFunc();_&&m.forEach(C=>{_(C)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),uf.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Yt.prototype.toObject.call(this)}clone(t){return Yt.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Xe.isTransforming=()=>zm>0;function f6(o){return o instanceof Array||vt.warn("enabledAnchors value should be an array"),o instanceof Array&&o.forEach(function(t){pg.indexOf(t)===-1&&vt.warn("Unknown anchor name: "+t+". Available names are: "+pg.join(", "))}),o||[]}Xe.prototype.className="Transformer";Yn(Xe);st.addGetterSetter(Xe,"enabledAnchors",pg,f6);st.addGetterSetter(Xe,"flipEnabled",!0,Gr());st.addGetterSetter(Xe,"resizeEnabled",!0);st.addGetterSetter(Xe,"anchorSize",10,Kt());st.addGetterSetter(Xe,"rotateEnabled",!0);st.addGetterSetter(Xe,"rotateLineVisible",!0);st.addGetterSetter(Xe,"rotationSnaps",[]);st.addGetterSetter(Xe,"rotateAnchorOffset",50,Kt());st.addGetterSetter(Xe,"rotateAnchorCursor","crosshair");st.addGetterSetter(Xe,"rotationSnapTolerance",5,Kt());st.addGetterSetter(Xe,"borderEnabled",!0);st.addGetterSetter(Xe,"anchorStroke","rgb(0, 161, 255)");st.addGetterSetter(Xe,"anchorStrokeWidth",1,Kt());st.addGetterSetter(Xe,"anchorFill","white");st.addGetterSetter(Xe,"anchorCornerRadius",0,Kt());st.addGetterSetter(Xe,"borderStroke","rgb(0, 161, 255)");st.addGetterSetter(Xe,"borderStrokeWidth",1,Kt());st.addGetterSetter(Xe,"borderDash");st.addGetterSetter(Xe,"keepRatio",!0);st.addGetterSetter(Xe,"shiftBehavior","default");st.addGetterSetter(Xe,"centeredScaling",!1);st.addGetterSetter(Xe,"ignoreStroke",!1);st.addGetterSetter(Xe,"padding",0,Kt());st.addGetterSetter(Xe,"nodes");st.addGetterSetter(Xe,"node");st.addGetterSetter(Xe,"boundBoxFunc");st.addGetterSetter(Xe,"anchorDragBoundFunc");st.addGetterSetter(Xe,"anchorStyleFunc");st.addGetterSetter(Xe,"shouldOverdrawWholeArea",!1);st.addGetterSetter(Xe,"useSingleNodeRotation",!0);st.backCompat(Xe,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class ml extends Gt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Jt.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}ml.prototype.className="Wedge";ml.prototype._centroid=!0;ml.prototype._attrsAffectingSize=["radius"];Yn(ml);st.addGetterSetter(ml,"radius",0,Kt());st.addGetterSetter(ml,"angle",0,Kt());st.addGetterSetter(ml,"clockwise",!1);st.backCompat(ml,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Zy(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const h6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],d6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function g6(o,t){const n=o.data,a=o.width,r=o.height;let l,c,d,g,m,_,C,E,O,v,M,z,L,D,N,G,R,A,T,y;const B=t+t+1,j=a-1,P=r-1,Q=t+1,K=Q*(Q+1)/2,X=new Zy,V=h6[t],U=d6[t];let I=null,F=X,W=null,it=null;for(let Z=1;Z<B;Z++)F=F.next=new Zy,Z===Q&&(I=F);F.next=X,d=c=0;for(let Z=0;Z<r;Z++){z=L=D=N=g=m=_=C=0,E=Q*(G=n[c]),O=Q*(R=n[c+1]),v=Q*(A=n[c+2]),M=Q*(T=n[c+3]),g+=K*G,m+=K*R,_+=K*A,C+=K*T,F=X;for(let rt=0;rt<Q;rt++)F.r=G,F.g=R,F.b=A,F.a=T,F=F.next;for(let rt=1;rt<Q;rt++)l=c+((j<rt?j:rt)<<2),g+=(F.r=G=n[l])*(y=Q-rt),m+=(F.g=R=n[l+1])*y,_+=(F.b=A=n[l+2])*y,C+=(F.a=T=n[l+3])*y,z+=G,L+=R,D+=A,N+=T,F=F.next;W=X,it=I;for(let rt=0;rt<a;rt++)n[c+3]=T=C*V>>U,T!==0?(T=255/T,n[c]=(g*V>>U)*T,n[c+1]=(m*V>>U)*T,n[c+2]=(_*V>>U)*T):n[c]=n[c+1]=n[c+2]=0,g-=E,m-=O,_-=v,C-=M,E-=W.r,O-=W.g,v-=W.b,M-=W.a,l=d+((l=rt+t+1)<j?l:j)<<2,z+=W.r=n[l],L+=W.g=n[l+1],D+=W.b=n[l+2],N+=W.a=n[l+3],g+=z,m+=L,_+=D,C+=N,W=W.next,E+=G=it.r,O+=R=it.g,v+=A=it.b,M+=T=it.a,z-=G,L-=R,D-=A,N-=T,it=it.next,c+=4;d+=a}for(let Z=0;Z<a;Z++){L=D=N=z=m=_=C=g=0,c=Z<<2,E=Q*(G=n[c]),O=Q*(R=n[c+1]),v=Q*(A=n[c+2]),M=Q*(T=n[c+3]),g+=K*G,m+=K*R,_+=K*A,C+=K*T,F=X;for(let at=0;at<Q;at++)F.r=G,F.g=R,F.b=A,F.a=T,F=F.next;let rt=a;for(let at=1;at<=t;at++)c=rt+Z<<2,g+=(F.r=G=n[c])*(y=Q-at),m+=(F.g=R=n[c+1])*y,_+=(F.b=A=n[c+2])*y,C+=(F.a=T=n[c+3])*y,z+=G,L+=R,D+=A,N+=T,F=F.next,at<P&&(rt+=a);c=Z,W=X,it=I;for(let at=0;at<r;at++)l=c<<2,n[l+3]=T=C*V>>U,T>0?(T=255/T,n[l]=(g*V>>U)*T,n[l+1]=(m*V>>U)*T,n[l+2]=(_*V>>U)*T):n[l]=n[l+1]=n[l+2]=0,g-=E,m-=O,_-=v,C-=M,E-=W.r,O-=W.g,v-=W.b,M-=W.a,l=Z+((l=at+Q)<P?l:P)*a<<2,g+=z+=W.r=n[l],m+=L+=W.g=n[l+1],_+=D+=W.b=n[l+2],C+=N+=W.a=n[l+3],W=W.next,E+=G=it.r,O+=R=it.g,v+=A=it.b,M+=T=it.a,z-=G,L-=R,D-=A,N-=T,it=it.next,c+=a}}const p6=function(t){const n=Math.round(this.blurRadius());n>0&&g6(t,n)};st.addGetterSetter(Yt,"blurRadius",0,Kt(),st.afterSetFilter);const m6=function(o){const t=this.brightness()*255,n=o.data,a=n.length;for(let r=0;r<a;r+=4)n[r]+=t,n[r+1]+=t,n[r+2]+=t};st.addGetterSetter(Yt,"brightness",0,Kt(),st.afterSetFilter);const v6=function(o){const t=this.brightness(),n=o.data,a=n.length;for(let r=0;r<a;r+=4)n[r]=Math.min(255,n[r]*t),n[r+1]=Math.min(255,n[r+1]*t),n[r+2]=Math.min(255,n[r+2]*t)},y6=function(o){const t=Math.pow((this.contrast()+100)/100,2),n=o.data,a=n.length;let r=150,l=150,c=150;for(let d=0;d<a;d+=4)r=n[d],l=n[d+1],c=n[d+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,l/=255,l-=.5,l*=t,l+=.5,l*=255,c/=255,c-=.5,c*=t,c+=.5,c*=255,r=r<0?0:r>255?255:r,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,n[d]=r,n[d+1]=l,n[d+2]=c};st.addGetterSetter(Yt,"contrast",0,Kt(),st.afterSetFilter);const S6=function(o){var t,n,a,r,l,c,d,g,m;const _=o.data,C=o.width,E=o.height,O=Math.min(1,Math.max(0,(n=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:.5)),v=Math.min(1,Math.max(0,(r=(a=this.embossWhiteLevel)===null||a===void 0?void 0:a.call(this))!==null&&r!==void 0?r:.5)),z=(d={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(c=(l=this.embossDirection)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0?c:"top-left"])!==null&&d!==void 0?d:315,L=!!((m=(g=this.embossBlend)===null||g===void 0?void 0:g.call(this))!==null&&m!==void 0&&m),D=O*10,N=v*255,G=z*Math.PI/180,R=Math.cos(G),A=Math.sin(G),T=128/1020*D,y=new Uint8ClampedArray(_),B=new Float32Array(C*E);for(let X=0,V=0;V<_.length;V+=4,X++)B[X]=.2126*y[V]+.7152*y[V+1]+.0722*y[V+2];const j=[-1,0,1,-2,0,2,-1,0,1],P=[-1,-2,-1,0,0,0,1,2,1],Q=[-C-1,-C,-C+1,-1,0,1,C-1,C,C+1],K=X=>X<0?0:X>255?255:X;for(let X=1;X<E-1;X++)for(let V=1;V<C-1;V++){const U=X*C+V;let I=0,F=0;I+=B[U+Q[0]]*j[0],F+=B[U+Q[0]]*P[0],I+=B[U+Q[1]]*j[1],F+=B[U+Q[1]]*P[1],I+=B[U+Q[2]]*j[2],F+=B[U+Q[2]]*P[2],I+=B[U+Q[3]]*j[3],F+=B[U+Q[3]]*P[3],I+=B[U+Q[5]]*j[5],F+=B[U+Q[5]]*P[5],I+=B[U+Q[6]]*j[6],F+=B[U+Q[6]]*P[6],I+=B[U+Q[7]]*j[7],F+=B[U+Q[7]]*P[7],I+=B[U+Q[8]]*j[8],F+=B[U+Q[8]]*P[8];const W=R*I+A*F,it=K(N+W*T),Z=U*4;if(L){const rt=it-N;_[Z]=K(y[Z]+rt),_[Z+1]=K(y[Z+1]+rt),_[Z+2]=K(y[Z+2]+rt),_[Z+3]=y[Z+3]}else _[Z]=_[Z+1]=_[Z+2]=it,_[Z+3]=y[Z+3]}for(let X=0;X<C;X++){let V=X*4,U=((E-1)*C+X)*4;_[V]=y[V],_[V+1]=y[V+1],_[V+2]=y[V+2],_[V+3]=y[V+3],_[U]=y[U],_[U+1]=y[U+1],_[U+2]=y[U+2],_[U+3]=y[U+3]}for(let X=1;X<E-1;X++){let V=X*C*4,U=(X*C+(C-1))*4;_[V]=y[V],_[V+1]=y[V+1],_[V+2]=y[V+2],_[V+3]=y[V+3],_[U]=y[U],_[U+1]=y[U+1],_[U+2]=y[U+2],_[U+3]=y[U+3]}return o};st.addGetterSetter(Yt,"embossStrength",.5,Kt(),st.afterSetFilter);st.addGetterSetter(Yt,"embossWhiteLevel",.5,Kt(),st.afterSetFilter);st.addGetterSetter(Yt,"embossDirection","top-left",void 0,st.afterSetFilter);st.addGetterSetter(Yt,"embossBlend",!1,void 0,st.afterSetFilter);function Mp(o,t,n,a,r){const l=n-t,c=r-a;if(l===0)return a+c/2;if(c===0)return a;let d=(o-t)/l;return d=c*d+a,d}const b6=function(o){const t=o.data,n=t.length;let a=t[0],r=a,l,c=t[1],d=c,g,m=t[2],_=m,C;const E=this.enhance();if(E===0)return;for(let N=0;N<n;N+=4)l=t[N+0],l<a?a=l:l>r&&(r=l),g=t[N+1],g<c?c=g:g>d&&(d=g),C=t[N+2],C<m?m=C:C>_&&(_=C);r===a&&(r=255,a=0),d===c&&(d=255,c=0),_===m&&(_=255,m=0);let O,v,M,z,L,D;if(E>0)O=r+E*(255-r),v=a-E*(a-0),M=d+E*(255-d),z=c-E*(c-0),L=_+E*(255-_),D=m-E*(m-0);else{const N=(r+a)*.5;O=r+E*(r-N),v=a+E*(a-N);const G=(d+c)*.5;M=d+E*(d-G),z=c+E*(c-G);const R=(_+m)*.5;L=_+E*(_-R),D=m+E*(m-R)}for(let N=0;N<n;N+=4)t[N+0]=Mp(t[N+0],a,r,v,O),t[N+1]=Mp(t[N+1],c,d,z,M),t[N+2]=Mp(t[N+2],m,_,D,L)};st.addGetterSetter(Yt,"enhance",0,Kt(),st.afterSetFilter);const _6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4){const r=.34*t[a]+.5*t[a+1]+.16*t[a+2];t[a]=r,t[a+1]=r,t[a+2]=r}};st.addGetterSetter(Yt,"hue",0,Kt(),st.afterSetFilter);st.addGetterSetter(Yt,"saturation",0,Kt(),st.afterSetFilter);st.addGetterSetter(Yt,"luminance",0,Kt(),st.afterSetFilter);const E6=function(o){const t=o.data,n=t.length,a=1,r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=this.luminance()*127,d=a*r*Math.cos(l*Math.PI/180),g=a*r*Math.sin(l*Math.PI/180),m=.299*a+.701*d+.167*g,_=.587*a-.587*d+.33*g,C=.114*a-.114*d-.497*g,E=.299*a-.299*d-.328*g,O=.587*a+.413*d+.035*g,v=.114*a-.114*d+.293*g,M=.299*a-.3*d+1.25*g,z=.587*a-.586*d-1.05*g,L=.114*a+.886*d-.2*g;let D,N,G,R;for(let A=0;A<n;A+=4)D=t[A+0],N=t[A+1],G=t[A+2],R=t[A+3],t[A+0]=m*D+_*N+C*G+c,t[A+1]=E*D+O*N+v*G+c,t[A+2]=M*D+z*N+L*G+c,t[A+3]=R},C6=function(o){const t=o.data,n=t.length,a=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=a*r*Math.cos(l*Math.PI/180),d=a*r*Math.sin(l*Math.PI/180),g=.299*a+.701*c+.167*d,m=.587*a-.587*c+.33*d,_=.114*a-.114*c-.497*d,C=.299*a-.299*c-.328*d,E=.587*a+.413*c+.035*d,O=.114*a-.114*c+.293*d,v=.299*a-.3*c+1.25*d,M=.587*a-.586*c-1.05*d,z=.114*a+.886*c-.2*d;for(let L=0;L<n;L+=4){const D=t[L+0],N=t[L+1],G=t[L+2],R=t[L+3];t[L+0]=g*D+m*N+_*G,t[L+1]=C*D+E*N+O*G,t[L+2]=v*D+M*N+z*G,t[L+3]=R}};st.addGetterSetter(Yt,"hue",0,Kt(),st.afterSetFilter);st.addGetterSetter(Yt,"saturation",0,Kt(),st.afterSetFilter);st.addGetterSetter(Yt,"value",0,Kt(),st.afterSetFilter);const T6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4)t[a]=255-t[a],t[a+1]=255-t[a+1],t[a+2]=255-t[a+2]},A6=function(o,t,n){const a=o.data,r=t.data,l=o.width,c=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||c/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=c-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const O=c,v=l,M=360/v*Math.PI/180;for(let z=0;z<v;z+=1){const L=Math.sin(z*M),D=Math.cos(z*M);for(let N=0;N<O;N+=1){_=Math.floor(d+m*N/O*D),C=Math.floor(g+m*N/O*L);let G=(C*l+_)*4;const R=a[G+0],A=a[G+1],T=a[G+2],y=a[G+3];G=(z+N*l)*4,r[G+0]=R,r[G+1]=A,r[G+2]=T,r[G+3]=y}}},w6=function(o,t,n){const a=o.data,r=t.data,l=o.width,c=o.height,d=n.polarCenterX||l/2,g=n.polarCenterY||c/2;let m=Math.sqrt(d*d+g*g),_=l-d,C=c-g;const E=Math.sqrt(_*_+C*C);m=E>m?E:m;const O=c,v=l,M=0;let z,L;for(_=0;_<l;_+=1)for(C=0;C<c;C+=1){const D=_-d,N=C-g,G=Math.sqrt(D*D+N*N)*O/m;let R=(Math.atan2(N,D)*180/Math.PI+360+M)%360;R=R*v/360,z=Math.floor(R),L=Math.floor(G);let A=(L*l+z)*4;const T=a[A+0],y=a[A+1],B=a[A+2],j=a[A+3];A=(C*l+_)*4,r[A+0]=T,r[A+1]=y,r[A+2]=B,r[A+3]=j}},O6=function(o){const t=o.width,n=o.height;let a,r,l,c,d,g,m,_,C,E,O=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),M=Math.floor(t*(v%360)/360);if(O<1)return;const z=vt.createCanvasElement();z.width=t,z.height=n;const L=z.getContext("2d").getImageData(0,0,t,n);vt.releaseCanvas(z),A6(o,L,{polarCenterX:t/2,polarCenterY:n/2});let D=t/Math.pow(2,O);for(;D<=8;)D=D*2,O-=1;D=Math.ceil(D);let N=D,G=0,R=N,A=1;for(M+D>t&&(G=N,R=0,A=-1),r=0;r<n;r+=1)for(a=G;a!==R;a+=A)l=Math.round(a+M)%t,C=(t*r+l)*4,d=L.data[C+0],g=L.data[C+1],m=L.data[C+2],_=L.data[C+3],E=(t*r+a)*4,L.data[E+0]=d,L.data[E+1]=g,L.data[E+2]=m,L.data[E+3]=_;for(r=0;r<n;r+=1)for(N=Math.floor(D),c=0;c<O;c+=1){for(a=0;a<N+1;a+=1)C=(t*r+a)*4,d=L.data[C+0],g=L.data[C+1],m=L.data[C+2],_=L.data[C+3],E=(t*r+N*2-a-1)*4,L.data[E+0]=d,L.data[E+1]=g,L.data[E+2]=m,L.data[E+3]=_;N*=2}w6(L,o,{})};st.addGetterSetter(Yt,"kaleidoscopePower",2,Kt(),st.afterSetFilter);st.addGetterSetter(Yt,"kaleidoscopeAngle",0,Kt(),st.afterSetFilter);function tg(o,t,n){let a=(n*o.width+t)*4;const r=[];return r.push(o.data[a++],o.data[a++],o.data[a++],o.data[a++]),r}function Xh(o,t){return Math.sqrt(Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)+Math.pow(o[2]-t[2],2))}function R6(o){const t=[0,0,0];for(let n=0;n<o.length;n++)t[0]+=o[n][0],t[1]+=o[n][1],t[2]+=o[n][2];return t[0]/=o.length,t[1]/=o.length,t[2]/=o.length,t}function x6(o,t){const n=tg(o,0,0),a=tg(o,o.width-1,0),r=tg(o,0,o.height-1),l=tg(o,o.width-1,o.height-1),c=t||10;if(Xh(n,a)<c&&Xh(a,l)<c&&Xh(l,r)<c&&Xh(r,n)<c){const d=R6([a,n,l,r]),g=[];for(let m=0;m<o.width*o.height;m++){const _=Xh(d,[o.data[m*4],o.data[m*4+1],o.data[m*4+2]]);g[m]=_<c?0:255}return g}}function N6(o,t){for(let n=0;n<o.width*o.height;n++)o.data[4*n+3]=t[n]}function M6(o,t,n){const a=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const O=d+C-l,v=g+E-l;if(O>=0&&O<n&&v>=0&&v<t){const M=O*t+v,z=a[C*r+E];_+=o[M]*z}}c[m]=_===2040?255:0}return c}function D6(o,t,n){const a=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const O=d+C-l,v=g+E-l;if(O>=0&&O<n&&v>=0&&v<t){const M=O*t+v,z=a[C*r+E];_+=o[M]*z}}c[m]=_>=1020?255:0}return c}function j6(o,t,n){const a=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(a.length)),l=Math.floor(r/2),c=[];for(let d=0;d<n;d++)for(let g=0;g<t;g++){const m=d*t+g;let _=0;for(let C=0;C<r;C++)for(let E=0;E<r;E++){const O=d+C-l,v=g+E-l;if(O>=0&&O<n&&v>=0&&v<t){const M=O*t+v,z=a[C*r+E];_+=o[M]*z}}c[m]=_}return c}const U6=function(o){const t=this.threshold();let n=x6(o,t);return n&&(n=M6(n,o.width,o.height),n=D6(n,o.width,o.height),n=j6(n,o.width,o.height),N6(o,n)),o};st.addGetterSetter(Yt,"threshold",0,Kt(),st.afterSetFilter);const B6=function(o){const t=this.noise()*255,n=o.data,a=n.length,r=t/2;for(let l=0;l<a;l+=4)n[l+0]+=r-2*r*Math.random(),n[l+1]+=r-2*r*Math.random(),n[l+2]+=r-2*r*Math.random()};st.addGetterSetter(Yt,"noise",.2,Kt(),st.afterSetFilter);const z6=function(o){let t=Math.ceil(this.pixelSize()),n=o.width,a=o.height,r=Math.ceil(n/t),l=Math.ceil(a/t),c=o.data;if(t<=0){vt.error("pixelSize value can not be <= 0");return}for(let d=0;d<r;d+=1)for(let g=0;g<l;g+=1){let m=0,_=0,C=0,E=0;const O=d*t,v=O+t,M=g*t,z=M+t;let L=0;for(let D=O;D<v;D+=1)if(!(D>=n))for(let N=M;N<z;N+=1){if(N>=a)continue;const G=(n*N+D)*4;m+=c[G+0],_+=c[G+1],C+=c[G+2],E+=c[G+3],L+=1}m=m/L,_=_/L,C=C/L,E=E/L;for(let D=O;D<v;D+=1)if(!(D>=n))for(let N=M;N<z;N+=1){if(N>=a)continue;const G=(n*N+D)*4;c[G+0]=m,c[G+1]=_,c[G+2]=C,c[G+3]=E}}};st.addGetterSetter(Yt,"pixelSize",8,Kt(),st.afterSetFilter);const L6=function(o){const t=Math.round(this.levels()*254)+1,n=o.data,a=n.length,r=255/t;for(let l=0;l<a;l+=1)n[l]=Math.floor(n[l]/r)*r};st.addGetterSetter(Yt,"levels",.5,Kt(),st.afterSetFilter);const G6=function(o){const t=o.data,n=t.length,a=this.red(),r=this.green(),l=this.blue();for(let c=0;c<n;c+=4){const d=(.34*t[c]+.5*t[c+1]+.16*t[c+2])/255;t[c]=d*a,t[c+1]=d*r,t[c+2]=d*l,t[c+3]=t[c+3]}};st.addGetterSetter(Yt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Yt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Yt,"blue",0,M2,st.afterSetFilter);const P6=function(o){const t=o.data,n=t.length,a=this.red(),r=this.green(),l=this.blue(),c=this.alpha();for(let d=0;d<n;d+=4){const g=1-c;t[d]=a*c+t[d]*g,t[d+1]=r*c+t[d+1]*g,t[d+2]=l*c+t[d+2]*g}};st.addGetterSetter(Yt,"red",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Yt,"green",0,function(o){return this._filterUpToDate=!1,o>255?255:o<0?0:Math.round(o)});st.addGetterSetter(Yt,"blue",0,M2,st.afterSetFilter);st.addGetterSetter(Yt,"alpha",1,function(o){return this._filterUpToDate=!1,o>1?1:o<0?0:o});const H6=function(o){const t=o.data,n=t.length;for(let a=0;a<n;a+=4){const r=t[a+0],l=t[a+1],c=t[a+2];t[a+0]=Math.min(255,r*.393+l*.769+c*.189),t[a+1]=Math.min(255,r*.349+l*.686+c*.168),t[a+2]=Math.min(255,r*.272+l*.534+c*.131)}},I6=function(o){const n=o.data;for(let a=0;a<n.length;a+=4){const r=n[a],l=n[a+1],c=n[a+2];.2126*r+.7152*l+.0722*c>=128&&(n[a]=255-r,n[a+1]=255-l,n[a+2]=255-c)}return o},k6=function(o){const t=this.threshold()*255,n=o.data,a=n.length;for(let r=0;r<a;r+=1)n[r]=n[r]<t?0:255};st.addGetterSetter(Yt,"threshold",.5,Kt(),st.afterSetFilter);cf.Util._assign(cf,{Arc:gl,Arrow:Su,Circle:vf,Ellipse:go,Image:Pr,Label:av,Tag:bu,Line:pl,Path:Mn,Rect:md,RegularPolygon:po,Ring:_u,Sprite:vs,Star:mo,Text:Bn,TextPath:_a,Transformer:Xe,Wedge:ml,Filters:{Blur:p6,Brightness:v6,Brighten:m6,Contrast:y6,Emboss:S6,Enhance:b6,Grayscale:_6,HSL:E6,HSV:C6,Invert:T6,Kaleidoscope:O6,Mask:U6,Noise:B6,Pixelate:z6,Posterize:L6,RGB:G6,RGBA:P6,Sepia:H6,Solarize:I6,Threshold:k6}});var Dp={exports:{}},jp={exports:{}},Up={exports:{}},Bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function q6(){return Wy||(Wy=1,(function(o){function t(U,I){var F=U.length;U.push(I);t:for(;0<F;){var W=F-1>>>1,it=U[W];if(0<r(it,I))U[W]=I,U[F]=it,F=W;else break t}}function n(U){return U.length===0?null:U[0]}function a(U){if(U.length===0)return null;var I=U[0],F=U.pop();if(F!==I){U[0]=F;t:for(var W=0,it=U.length,Z=it>>>1;W<Z;){var rt=2*(W+1)-1,at=U[rt],Y=rt+1,J=U[Y];if(0>r(at,F))Y<it&&0>r(J,at)?(U[W]=J,U[Y]=F,W=Y):(U[W]=at,U[rt]=F,W=rt);else if(Y<it&&0>r(J,F))U[W]=J,U[Y]=F,W=Y;else break t}}return I}function r(U,I){var F=U.sortIndex-I.sortIndex;return F!==0?F:U.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],_=1,C=null,E=3,O=!1,v=!1,M=!1,z=!1,L=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function G(U){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=U)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function R(U){if(M=!1,G(U),!v)if(n(g)!==null)v=!0,A||(A=!0,Q());else{var I=n(m);I!==null&&V(R,I.startTime-U)}}var A=!1,T=-1,y=5,B=-1;function j(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,A){var U=o.unstable_now();B=U;var I=!0;try{t:{v=!1,M&&(M=!1,D(T),T=-1),O=!0;var F=E;try{e:{for(G(U),C=n(g);C!==null&&!(C.expirationTime>U&&j());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=U);if(U=o.unstable_now(),typeof it=="function"){C.callback=it,G(U),I=!0;break e}C===n(g)&&a(g),G(U)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&V(R,Z.startTime-U),I=!1}}break t}finally{C=null,E=F,O=!1}I=void 0}}finally{I?Q():A=!1}}}var Q;if(typeof N=="function")Q=function(){N(P)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=P,Q=function(){X.postMessage(null)}}else Q=function(){L(P,0)};function V(U,I){T=L(function(){U(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(U){U.callback=null},o.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<U?Math.floor(1e3/U):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(U){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return U()}finally{E=F}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(U,I){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var F=E;E=U;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(U,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,U){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,U={id:_++,callback:I,priorityLevel:U,startTime:F,expirationTime:it,sortIndex:-1},F>W?(U.sortIndex=F,t(m,U),n(g)===null&&U===n(m)&&(M?(D(T),T=-1):M=!0,V(R,F-W))):(U.sortIndex=it,t(g,U),v||O||(v=!0,A||(A=!0,Q()))),U},o.unstable_shouldYield=j,o.unstable_wrapCallback=function(U){var I=E;return function(){var F=E;E=I;try{return U.apply(this,arguments)}finally{E=F}}}})(Bp)),Bp}var $y;function V6(){return $y||($y=1,Up.exports=q6()),Up.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function Y6(){return t1||(t1=1,(function(o){o.exports=function(t){function n(s,u,p,S){return new lc(s,u,p,S)}function a(){}function r(s){var u="https://react.dev/errors/"+s;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){var u=s,p=s;if(s.alternate)for(;u.return;)u=u.return;else{s=u;do u=s,(u.flags&4098)!==0&&(p=u.return),s=u.return;while(s)}return u.tag===3?p:null}function c(s){if(l(s)!==s)throw Error(r(188))}function d(s){var u=s.alternate;if(!u){if(u=l(s),u===null)throw Error(r(188));return u!==s?null:s}for(var p=s,S=u;;){var x=p.return;if(x===null)break;var H=x.alternate;if(H===null){if(S=x.return,S!==null){p=S;continue}break}if(x.child===H.child){for(H=x.child;H;){if(H===p)return c(x),s;if(H===S)return c(x),u;H=H.sibling}throw Error(r(188))}if(p.return!==S.return)p=x,S=H;else{for(var nt=!1,ut=x.child;ut;){if(ut===p){nt=!0,p=x,S=H;break}if(ut===S){nt=!0,S=x,p=H;break}ut=ut.sibling}if(!nt){for(ut=H.child;ut;){if(ut===p){nt=!0,p=H,S=x;break}if(ut===S){nt=!0,S=H,p=x;break}ut=ut.sibling}if(!nt)throw Error(r(189))}}if(p.alternate!==S)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:u}function g(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(u=g(s),u!==null)return u;s=s.sibling}return null}function m(s){var u=s.tag;if(u===5||u===26||u===27||u===6)return s;for(s=s.child;s!==null;){if(s.tag!==4&&(u=m(s),u!==null))return u;s=s.sibling}return null}function _(s){return s===null||typeof s!="object"?null:(s=Yo&&s[Yo]||s["@@iterator"],typeof s=="function"?s:null)}function C(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Ko?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case Us:return"Fragment";case ko:return"Profiler";case Bs:return"StrictMode";case _r:return"Suspense";case Er:return"SuspenseList";case es:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case Sr:return"Portal";case br:return(s.displayName||"Context")+".Provider";case qo:return(s._context.displayName||"Context")+".Consumer";case hc:var u=s.render;return s=s.displayName,s||(s=u.displayName||u.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case dc:return u=s.displayName||null,u!==null?u:C(s.type)||"Memo";case Cr:u=s._payload,s=s._init;try{return C(s(u))}catch{}}return null}function E(s){return{current:s}}function O(s){0>ks||(s.current=$o[ks],$o[ks]=null,ks--)}function v(s,u){ks++,$o[ks]=s.current,s.current=u}function M(s){return s>>>=0,s===0?32:31-(S0(s)/b0|0)|0}function z(s){var u=s&42;if(u!==0)return u;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function L(s,u,p){var S=s.pendingLanes;if(S===0)return 0;var x=0,H=s.suspendedLanes,nt=s.pingedLanes;s=s.warmLanes;var ut=S&134217727;return ut!==0?(S=ut&~H,S!==0?x=z(S):(nt&=ut,nt!==0?x=z(nt):p||(p=ut&~s,p!==0&&(x=z(p))))):(ut=S&~H,ut!==0?x=z(ut):nt!==0?x=z(nt):p||(p=S&~s,p!==0&&(x=z(p)))),x===0?0:u!==0&&u!==x&&(u&H)===0&&(H=x&-x,p=u&-u,H>=p||H===32&&(p&4194048)!==0)?u:x}function D(s,u){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&u)===0}function N(s,u){switch(s){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G(){var s=$i;return $i<<=1,($i&4194048)===0&&($i=256),s}function R(){var s=tu;return tu<<=1,(tu&62914560)===0&&(tu=4194304),s}function A(s){for(var u=[],p=0;31>p;p++)u.push(s);return u}function T(s,u){s.pendingLanes|=u,u!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function y(s,u,p,S,x,H){var nt=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ut=s.entanglements,_t=s.expirationTimes,jt=s.hiddenUpdates;for(p=nt&~p;0<p;){var Pt=31-Da(p),Zt=1<<Pt;ut[Pt]=0,_t[Pt]=-1;var Wt=jt[Pt];if(Wt!==null)for(jt[Pt]=null,Pt=0;Pt<Wt.length;Pt++){var Te=Wt[Pt];Te!==null&&(Te.lane&=-536870913)}p&=~Zt}S!==0&&B(s,S,0),H!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=H&~(nt&~u))}function B(s,u,p){s.pendingLanes|=u,s.suspendedLanes&=~u;var S=31-Da(u);s.entangledLanes|=u,s.entanglements[S]=s.entanglements[S]|1073741824|p&4194090}function j(s,u){var p=s.entangledLanes|=u;for(s=s.entanglements;p;){var S=31-Da(p),x=1<<S;x&u|s[S]&u&&(s[S]|=u),p&=~x}}function P(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Q(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function K(s){if(typeof Zn=="function"&&pa(s),Ya&&typeof Ya.setStrictMode=="function")try{Ya.setStrictMode(kl,s)}catch{}}function X(s){if(Nc===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Nc=u&&u[1]||"",wh=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nc+s+wh}function V(s,u){if(!s||qs)return"";qs=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(u){var Zt=function(){throw Error()};if(Object.defineProperty(Zt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Zt,[])}catch(Te){var Wt=Te}Reflect.construct(s,[],Zt)}else{try{Zt.call()}catch(Te){Wt=Te}s.call(Zt.prototype)}}else{try{throw Error()}catch(Te){Wt=Te}(Zt=s())&&typeof Zt.catch=="function"&&Zt.catch(function(){})}}catch(Te){if(Te&&Wt&&typeof Te.stack=="string")return[Te.stack,Wt.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var H=S.DetermineComponentFrameRoot(),nt=H[0],ut=H[1];if(nt&&ut){var _t=nt.split(`
`),jt=ut.split(`
`);for(x=S=0;S<_t.length&&!_t[S].includes("DetermineComponentFrameRoot");)S++;for(;x<jt.length&&!jt[x].includes("DetermineComponentFrameRoot");)x++;if(S===_t.length||x===jt.length)for(S=_t.length-1,x=jt.length-1;1<=S&&0<=x&&_t[S]!==jt[x];)x--;for(;1<=S&&0<=x;S--,x--)if(_t[S]!==jt[x]){if(S!==1||x!==1)do if(S--,x--,0>x||_t[S]!==jt[x]){var Pt=`
`+_t[S].replace(" at new "," at ");return s.displayName&&Pt.includes("<anonymous>")&&(Pt=Pt.replace("<anonymous>",s.displayName)),Pt}while(1<=S&&0<=x);break}}}finally{qs=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?X(p):""}function U(s){switch(s.tag){case 26:case 27:case 5:return X(s.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return V(s.type,!1);case 11:return V(s.type.render,!1);case 1:return V(s.type,!0);case 31:return X("Activity");default:return""}}function I(s){try{var u="";do u+=U(s),s=s.return;while(s);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function F(s,u){if(typeof s=="object"&&s!==null){var p=Oh.get(s);return p!==void 0?p:(u={value:s,source:u,stack:I(u)},Oh.set(s,u),u)}return{value:s,source:u,stack:I(u)}}function W(s,u){wr[Vs++]=Ys,wr[Vs++]=Mc,Mc=s,Ys=u}function it(s,u,p){Ka[oi++]=tr,Ka[oi++]=Ri,Ka[oi++]=os,os=s;var S=tr;s=Ri;var x=32-Da(S)-1;S&=~(1<<x),p+=1;var H=32-Da(u)+x;if(30<H){var nt=x-x%5;H=(S&(1<<nt)-1).toString(32),S>>=nt,x-=nt,tr=1<<32-Da(u)+x|p<<x|S,Ri=H+s}else tr=1<<H|p<<x|S,Ri=s}function Z(s){s.return!==null&&(W(s,1),it(s,1,0))}function rt(s){for(;s===Mc;)Mc=wr[--Vs],wr[Vs]=null,Ys=wr[--Vs],wr[Vs]=null;for(;s===os;)os=Ka[--oi],Ka[oi]=null,Ri=Ka[--oi],Ka[oi]=null,tr=Ka[--oi],Ka[oi]=null}function at(s,u){v(Or,u),v(Ks,s),v($n,null),s=nh(u),O($n),v($n,s)}function Y(){O($n),O(Ks),O(Or)}function J(s){s.memoizedState!==null&&v(ql,s);var u=$n.current,p=ns(u,s.type);u!==p&&(v(Ks,s),v($n,p))}function tt(s){Ks.current===s&&(O($n),O(Ks)),ql.current===s&&(O(ql),Qi?vi._currentValue=Ar:vi._currentValue2=Ar)}function et(s){var u=Error(r(418,""));throw se(F(u,s)),Ni}function gt(s,u){if(!On)throw Error(r(175));l0(s.stateNode,s.type,s.memoizedProps,u,s)||et(s)}function wt(s){for(aa=s.return;aa;)switch(aa.tag){case 5:case 13:xi=!1;return;case 27:case 3:xi=!0;return;default:aa=aa.return}}function Dt(s){if(!On||s!==aa)return!1;if(!Fe)return wt(s),Fe=!0,!1;var u=s.tag;if(Hn?u!==3&&u!==27&&(u!==5||Tc(s.type)&&!is(s.type,s.memoizedProps))&&In&&et(s):u!==3&&(u!==5||Tc(s.type)&&!is(s.type,s.memoizedProps))&&In&&et(s),wt(s),u===13){if(!On)throw Error(r(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));In=o0(s)}else In=Hn&&u===27?a0(s.type,In):aa?mh(s.stateNode):null;return!0}function Qt(){On&&(In=aa=null,Fe=!1)}function te(){var s=Rr;return s!==null&&(Aa===null?Aa=s:Aa.push.apply(Aa,s),Rr=null),s}function se(s){Rr===null?Rr=[s]:Rr.push(s)}function kt(s,u){return s===u&&(s!==0||1/s===1/u)||s!==s&&u!==u}function pe(s,u,p){Qi?(v(Dc,u._currentValue),u._currentValue=p):(v(Dc,u._currentValue2),u._currentValue2=p)}function Ee(s){var u=Dc.current;Qi?s._currentValue=u:s._currentValue2=u,O(Dc)}function Ze(s,u,p){for(;s!==null;){var S=s.alternate;if((s.childLanes&u)!==u?(s.childLanes|=u,S!==null&&(S.childLanes|=u)):S!==null&&(S.childLanes&u)!==u&&(S.childLanes|=u),s===p)break;s=s.return}}function Ve(s,u,p,S){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var H=x.dependencies;if(H!==null){var nt=x.child;H=H.firstContext;t:for(;H!==null;){var ut=H;H=x;for(var _t=0;_t<u.length;_t++)if(ut.context===u[_t]){H.lanes|=p,ut=H.alternate,ut!==null&&(ut.lanes|=p),Ze(H.return,p,s),S||(nt=null);break t}H=ut.next}}else if(x.tag===18){if(nt=x.return,nt===null)throw Error(r(341));nt.lanes|=p,H=nt.alternate,H!==null&&(H.lanes|=p),Ze(nt,p,s),nt=null}else nt=x.child;if(nt!==null)nt.return=x;else for(nt=x;nt!==null;){if(nt===s){nt=null;break}if(x=nt.sibling,x!==null){x.return=nt.return,nt=x;break}nt=nt.return}x=nt}}function tn(s,u,p,S){s=null;for(var x=u,H=!1;x!==null;){if(!H){if((x.flags&524288)!==0)H=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var nt=x.alternate;if(nt===null)throw Error(r(387));if(nt=nt.memoizedProps,nt!==null){var ut=x.type;ja(x.pendingProps.value,nt.value)||(s!==null?s.push(ut):s=[ut])}}else if(x===ql.current){if(nt=x.alternate,nt===null)throw Error(r(387));nt.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(vi):s=[vi])}x=x.return}s!==null&&Ve(u,s,p,S),u.flags|=262144}function xt(s){for(s=s.firstContext;s!==null;){var u=s.context;if(!ja(Qi?u._currentValue:u._currentValue2,s.memoizedValue))return!0;s=s.next}return!1}function Xt(s){us=s,ma=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function be(s){return me(us,s)}function ye(s,u){return us===null&&Xt(s),me(s,u)}function me(s,u){var p=Qi?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},ma===null){if(s===null)throw Error(r(308));ma=u,s.dependencies={lanes:0,firstContext:u},s.flags|=524288}else ma=ma.next=u;return p}function De(){return{controller:new Rh,data:new Map,refCount:0}}function Ye(s){s.refCount--,s.refCount===0&&C0(jc,function(){s.controller.abort()})}function Ue(s){s!==Vl&&s.next===null&&(Vl===null?fn=Vl=s:Vl=Vl.next=s),nu=!0,xh||(xh=!0,zt())}function ft(s,u){if(!Qs&&nu){Qs=!0;do for(var p=!1,S=fn;S!==null;){if(s!==0){var x=S.pendingLanes;if(x===0)var H=0;else{var nt=S.suspendedLanes,ut=S.pingedLanes;H=(1<<31-Da(42|s)+1)-1,H&=x&~(nt&~ut),H=H&201326741?H&201326741|1:H?H|2:0}H!==0&&(p=!0,Ct(S,H))}else H=Ne,H=L(S,S===hn?H:0,S.cancelPendingCommit!==null||S.timeoutHandle!==Ki),(H&3)===0||D(S,H)||(p=!0,Ct(S,H));S=S.next}while(p);Qs=!1}}function ct(){ht()}function ht(){nu=xh=!1;var s=0;ui!==0&&(ri()&&(s=ui),ui=0);for(var u=li(),p=null,S=fn;S!==null;){var x=S.next,H=Ot(S,u);H===0?(S.next=null,p===null?fn=x:p.next=x,x===null&&(Vl=p)):(p=S,(s!==0||(H&3)!==0)&&(nu=!0)),S=x}ft(s)}function Ot(s,u){for(var p=s.suspendedLanes,S=s.pingedLanes,x=s.expirationTimes,H=s.pendingLanes&-62914561;0<H;){var nt=31-Da(H),ut=1<<nt,_t=x[nt];_t===-1?((ut&p)===0||(ut&S)!==0)&&(x[nt]=N(ut,u)):_t<=u&&(s.expiredLanes|=ut),H&=~ut}if(u=hn,p=Ne,p=L(s,s===u?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==Ki),S=s.callbackNode,p===0||s===u&&(Ke===2||Ke===9)||s.cancelPendingCommit!==null)return S!==null&&S!==null&&Rc(S),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||D(s,p)){if(u=p&-p,u===s.callbackPriority)return u;switch(S!==null&&Rc(S),Q(p)){case 2:case 8:p=E0;break;case 32:p=Th;break;case 268435456:p=Ah;break;default:p=Th}return S=Vt.bind(null,s),p=eu(p,S),s.callbackPriority=u,s.callbackNode=p,u}return S!==null&&S!==null&&Rc(S),s.callbackPriority=2,s.callbackNode=null,2}function Vt(s,u){if(nn!==0&&nn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(Ns()&&s.callbackNode!==p)return null;var S=Ne;return S=L(s,s===hn?S:0,s.cancelPendingCommit!==null||s.timeoutHandle!==Ki),S===0?null:(ni(s,S,u),Ot(s,li()),s.callbackNode!=null&&s.callbackNode===p?Vt.bind(null,s):null)}function Ct(s,u){if(Ns())return null;ni(s,u,!0)}function zt(){pc?Fo(function(){(Re&6)!==0?eu(Ch,ct):ht()}):eu(Ch,ct)}function Bt(){return ui===0&&(ui=G()),ui}function Se(s,u){if(Yl===null){var p=Yl=[];Uc=0,er=Bt(),Ua={status:"pending",value:void 0,then:function(S){p.push(S)}}}return Uc++,u.then(_e,_e),u}function _e(){if(--Uc===0&&Yl!==null){Ua!==null&&(Ua.status="fulfilled");var s=Yl;Yl=null,er=0,Ua=null;for(var u=0;u<s.length;u++)(0,s[u])()}}function $t(s,u){var p=[],S={status:"pending",value:null,reason:null,then:function(x){p.push(x)}};return s.then(function(){S.status="fulfilled",S.value=u;for(var x=0;x<p.length;x++)(0,p[x])(u)},function(x){for(S.status="rejected",S.reason=x,x=0;x<p.length;x++)(0,p[x])(void 0)}),S}function He(){var s=xr.current;return s!==null?s:hn.pooledCache}function sn(s,u){u===null?v(xr,xr.current):v(xr,u.pool)}function An(){var s=He();return s===null?null:{parent:Qi?pn._currentValue:pn._currentValue2,pool:s}}function Ln(s,u){if(ja(s,u))return!0;if(typeof s!="object"||s===null||typeof u!="object"||u===null)return!1;var p=Object.keys(s),S=Object.keys(u);if(p.length!==S.length)return!1;for(S=0;S<p.length;S++){var x=p[S];if(!T0.call(u,x)||!ja(s[x],u[x]))return!1}return!0}function Ga(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Li(){}function Hr(s,u,p){switch(p=s[p],p===void 0?s.push(u):p!==u&&(u.then(Li,Li),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,vl(s),s;default:if(typeof u.status=="string")u.then(Li,Li);else{if(s=hn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=u,s.status="pending",s.then(function(S){if(u.status==="pending"){var x=u;x.status="fulfilled",x.value=S}},function(S){if(u.status==="pending"){var x=u;x.status="rejected",x.reason=S}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw s=u.reason,vl(s),s}throw Qa=u,Xs}}function Gi(){if(Qa===null)throw Error(r(459));var s=Qa;return Qa=null,s}function vl(s){if(s===Xs||s===Fs)throw Error(r(483))}function Lt(){for(var s=cs,u=Bc=cs=0;u<s;){var p=We[u];We[u++]=null;var S=We[u];We[u++]=null;var x=We[u];We[u++]=null;var H=We[u];if(We[u++]=null,S!==null&&x!==null){var nt=S.pending;nt===null?x.next=x:(x.next=nt.next,nt.next=x),S.pending=x}H!==0&&qt(p,x,H)}}function It(s,u,p,S){We[cs++]=s,We[cs++]=u,We[cs++]=p,We[cs++]=S,Bc|=S,s.lanes|=S,s=s.alternate,s!==null&&(s.lanes|=S)}function ne(s,u,p,S){return It(s,u,p,S),Be(s)}function ae(s,u){return It(s,null,null,u),Be(s)}function qt(s,u,p){s.lanes|=p;var S=s.alternate;S!==null&&(S.lanes|=p);for(var x=!1,H=s.return;H!==null;)H.childLanes|=p,S=H.alternate,S!==null&&(S.childLanes|=p),H.tag===22&&(s=H.stateNode,s===null||s._visibility&1||(x=!0)),s=H,H=H.return;return s.tag===3?(H=s.stateNode,x&&u!==null&&(x=31-Da(p),s=H.hiddenUpdates,S=s[x],S===null?s[x]=[u]:S.push(u),u.lane=p|536870912),H):null}function Be(s){if(50<lr)throw lr=0,Hc=null,Error(r(185));for(var u=s.return;u!==null;)s=u,u=s.return;return s.tag===3?s.stateNode:null}function Kn(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wn(s,u){s=s.updateQueue,u.updateQueue===s&&(u.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ut(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function je(s,u,p){var S=s.updateQueue;if(S===null)return null;if(S=S.shared,(Re&2)!==0){var x=S.pending;return x===null?u.next=u:(u.next=x.next,x.next=u),S.pending=u,u=Be(s),qt(s,null,p),u}return It(s,S,u,p),Be(s)}function en(s,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,j(s,p)}}function ze(s,u){var p=s.updateQueue,S=s.alternate;if(S!==null&&(S=S.updateQueue,p===S)){var x=null,H=null;if(p=p.firstBaseUpdate,p!==null){do{var nt={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};H===null?x=H=nt:H=H.next=nt,p=p.next}while(p!==null);H===null?x=H=u:H=H.next=u}else x=H=u;p={baseState:S.baseState,firstBaseUpdate:x,lastBaseUpdate:H,shared:S.shared,callbacks:S.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=u:s.next=u,p.lastBaseUpdate=u}function ln(){if(Mh){var s=Ua;if(s!==null)throw s}}function oa(s,u,p,S){Mh=!1;var x=s.updateQueue;_n=!1;var H=x.firstBaseUpdate,nt=x.lastBaseUpdate,ut=x.shared.pending;if(ut!==null){x.shared.pending=null;var _t=ut,jt=_t.next;_t.next=null,nt===null?H=jt:nt.next=jt,nt=_t;var Pt=s.alternate;Pt!==null&&(Pt=Pt.updateQueue,ut=Pt.lastBaseUpdate,ut!==nt&&(ut===null?Pt.firstBaseUpdate=jt:ut.next=jt,Pt.lastBaseUpdate=_t))}if(H!==null){var Zt=x.baseState;nt=0,Pt=jt=_t=null,ut=H;do{var Wt=ut.lane&-536870913,Te=Wt!==ut.lane;if(Te?(Ne&Wt)===Wt:(S&Wt)===Wt){Wt!==0&&Wt===er&&(Mh=!0),Pt!==null&&(Pt=Pt.next={lane:0,tag:ut.tag,payload:ut.payload,callback:null,next:null});t:{var fi=s,Fl=ut;Wt=u;var ds=p;switch(Fl.tag){case 1:if(fi=Fl.payload,typeof fi=="function"){Zt=fi.call(ds,Zt,Wt);break t}Zt=fi;break t;case 3:fi.flags=fi.flags&-65537|128;case 0:if(fi=Fl.payload,Wt=typeof fi=="function"?fi.call(ds,Zt,Wt):fi,Wt==null)break t;Zt=cc({},Zt,Wt);break t;case 2:_n=!0}}Wt=ut.callback,Wt!==null&&(s.flags|=64,Te&&(s.flags|=8192),Te=x.callbacks,Te===null?x.callbacks=[Wt]:Te.push(Wt))}else Te={lane:Wt,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null},Pt===null?(jt=Pt=Te,_t=Zt):Pt=Pt.next=Te,nt|=Wt;if(ut=ut.next,ut===null){if(ut=x.shared.pending,ut===null)break;Te=ut,ut=Te.next,Te.next=null,x.lastBaseUpdate=Te,x.shared.pending=null}}while(!0);Pt===null&&(_t=Zt),x.baseState=_t,x.firstBaseUpdate=jt,x.lastBaseUpdate=Pt,H===null&&(x.shared.lanes=0),za|=nt,s.lanes=nt,s.memoizedState=Zt}}function ys(s,u){if(typeof s!="function")throw Error(r(191,s));s.call(u)}function yd(s,u){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)ys(p[s],u)}function Sd(s,u){s=bi,v(ru,s),v(Js,u),bi=s|u.baseLanes}function wu(){v(ru,bi),v(Js,Js.current)}function Ss(){bi=ru.current,O(Js),O(ru)}function Dn(){throw Error(r(321))}function Ir(s,u){if(u===null)return!1;for(var p=0;p<u.length&&p<s.length;p++)if(!ja(s[p],u[p]))return!1;return!0}function kr(s,u,p,S,x,H){return $e=H,ue=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,oe.H=s===null||s.memoizedState===null?Dh:nr,Ws=!1,H=p(S,x),Ws=!1,Zs&&(H=bs(u,p,S,x)),yl(s),H}function yl(s){oe.H=va;var u=Pe!==null&&Pe.next!==null;if($e=0,kn=Pe=ue=null,su=!1,ia=0,Ca=null,u)throw Error(r(300));s===null||ta||(s=s.dependencies,s!==null&&xt(s)&&(ta=!0))}function bs(s,u,p,S){ue=s;var x=0;do{if(Zs&&(Ca=null),ia=0,Zs=!1,25<=x)throw Error(r(301));if(x+=1,kn=Pe=null,s.updateQueue!=null){var H=s.updateQueue;H.lastEffect=null,H.events=null,H.stores=null,H.memoCache!=null&&(H.memoCache.index=0)}oe.H=tl,H=u(p,S)}while(Zs);return H}function ea(){var s=oe.H,u=s.useState()[0];return u=typeof u.then=="function"?Sl(u):u,s=s.useState()[0],(Pe!==null?Pe.memoizedState:null)!==s&&(ue.flags|=1024),u}function Ou(){var s=$s!==0;return $s=0,s}function Ru(s,u,p){u.updateQueue=s.updateQueue,u.flags&=-2053,s.lanes&=~p}function fr(s){if(su){for(s=s.memoizedState;s!==null;){var u=s.queue;u!==null&&(u.pending=null),s=s.next}su=!1}$e=0,kn=Pe=ue=null,Zs=!1,ia=$s=0,Ca=null}function Wn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?ue.memoizedState=kn=s:kn=kn.next=s,kn}function Qn(){if(Pe===null){var s=ue.alternate;s=s!==null?s.memoizedState:null}else s=Pe.next;var u=kn===null?ue.memoizedState:kn.next;if(u!==null)kn=u,Pe=s;else{if(s===null)throw ue.alternate===null?Error(r(467)):Error(r(310));Pe=s,s={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},kn===null?ue.memoizedState=kn=s:kn=kn.next=s}return kn}function xu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sl(s){var u=ia;return ia+=1,Ca===null&&(Ca=[]),s=Hr(Ca,s,u),u=ue,(kn===null?u.memoizedState:kn.next)===null&&(u=u.alternate,oe.H=u===null||u.memoizedState===null?Dh:nr),s}function Nu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Sl(s);if(s.$$typeof===br)return be(s)}throw Error(r(438,String(s)))}function bl(s){var u=null,p=ue.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var S=ue.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(u={data:S.data.map(function(x){return x.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=xu(),ue.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(s),S=0;S<s;S++)p[S]=Vo;return u.index++,p}function hi(s,u){return typeof u=="function"?u(s):u}function di(s){var u=Qn();return Pa(u,Pe,s)}function Pa(s,u,p){var S=s.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=p;var x=s.baseQueue,H=S.pending;if(H!==null){if(x!==null){var nt=x.next;x.next=H.next,H.next=nt}u.baseQueue=x=H,S.pending=null}if(H=s.baseState,x===null)s.memoizedState=H;else{u=x.next;var ut=nt=null,_t=null,jt=u,Pt=!1;do{var Zt=jt.lane&-536870913;if(Zt!==jt.lane?(Ne&Zt)===Zt:($e&Zt)===Zt){var Wt=jt.revertLane;if(Wt===0)_t!==null&&(_t=_t.next={lane:0,revertLane:0,action:jt.action,hasEagerState:jt.hasEagerState,eagerState:jt.eagerState,next:null}),Zt===er&&(Pt=!0);else if(($e&Wt)===Wt){jt=jt.next,Wt===er&&(Pt=!0);continue}else Zt={lane:0,revertLane:jt.revertLane,action:jt.action,hasEagerState:jt.hasEagerState,eagerState:jt.eagerState,next:null},_t===null?(ut=_t=Zt,nt=H):_t=_t.next=Zt,ue.lanes|=Wt,za|=Wt;Zt=jt.action,Ws&&p(H,Zt),H=jt.hasEagerState?jt.eagerState:p(H,Zt)}else Wt={lane:Zt,revertLane:jt.revertLane,action:jt.action,hasEagerState:jt.hasEagerState,eagerState:jt.eagerState,next:null},_t===null?(ut=_t=Wt,nt=H):_t=_t.next=Wt,ue.lanes|=Zt,za|=Zt;jt=jt.next}while(jt!==null&&jt!==u);if(_t===null?nt=H:_t.next=ut,!ja(H,s.memoizedState)&&(ta=!0,Pt&&(p=Ua,p!==null)))throw p;s.memoizedState=H,s.baseState=nt,s.baseQueue=_t,S.lastRenderedState=H}return x===null&&(S.lanes=0),[s.memoizedState,S.dispatch]}function Mu(s){var u=Qn(),p=u.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var S=p.dispatch,x=p.pending,H=u.memoizedState;if(x!==null){p.pending=null;var nt=x=x.next;do H=s(H,nt.action),nt=nt.next;while(nt!==x);ja(H,u.memoizedState)||(ta=!0),u.memoizedState=H,u.baseQueue===null&&(u.baseState=H),p.lastRenderedState=H}return[H,S]}function bd(s,u,p){var S=ue,x=Qn(),H=Fe;if(H){if(p===void 0)throw Error(r(407));p=p()}else p=u();var nt=!ja((Pe||x).memoizedState,p);nt&&(x.memoizedState=p,ta=!0),x=x.queue;var ut=So.bind(null,S,x,s);if(Pi(2048,8,ut,[s]),x.getSnapshot!==u||nt||kn!==null&&kn.memoizedState.tag&1){if(S.flags|=2048,Ha(9,_l(),_f.bind(null,S,x,p,u),null),hn===null)throw Error(r(349));H||($e&124)!==0||Du(S,u,p)}return p}function Du(s,u,p){s.flags|=16384,s={getSnapshot:u,value:p},u=ue.updateQueue,u===null?(u=xu(),ue.updateQueue=u,u.stores=[s]):(p=u.stores,p===null?u.stores=[s]:p.push(s))}function _f(s,u,p,S){u.value=p,u.getSnapshot=S,_d(u)&&$a(s)}function So(s,u,p){return p(function(){_d(u)&&$a(s)})}function _d(s){var u=s.getSnapshot;s=s.value;try{var p=u();return!ja(s,p)}catch{return!0}}function $a(s){var u=ae(s,2);u!==null&&qa(u,s,2)}function bo(s){var u=Wn();if(typeof s=="function"){var p=s;if(s=p(),Ws){K(!0);try{p()}finally{K(!1)}}}return u.memoizedState=u.baseState=s,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:s},u}function Ef(s,u,p,S){return s.baseState=p,Pa(s,Pe,typeof S=="function"?S:hi)}function Cf(s,u,p,S,x){if(Yr(s))throw Error(r(485));if(s=u.action,s!==null){var H={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(nt){H.listeners.push(nt)}};oe.T!==null?p(!0):H.isTransition=!1,S(H),p=u.pending,p===null?(H.next=u.pending=H,_s(u,H)):(H.next=p.next,u.pending=p.next=H)}}function _s(s,u){var p=u.action,S=u.payload,x=s.state;if(u.isTransition){var H=oe.T,nt={};oe.T=nt;try{var ut=p(x,S),_t=oe.S;_t!==null&&_t(nt,ut),Tf(s,u,ut)}catch(jt){qr(s,u,jt)}finally{oe.T=H}}else try{H=p(x,S),Tf(s,u,H)}catch(jt){qr(s,u,jt)}}function Tf(s,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(S){Af(s,u,S)},function(S){return qr(s,u,S)}):Af(s,u,p)}function Af(s,u,p){u.status="fulfilled",u.value=p,Ed(u),s.state=p,u=s.pending,u!==null&&(p=u.next,p===u?s.pending=null:(p=p.next,u.next=p,_s(s,p)))}function qr(s,u,p){var S=s.pending;if(s.pending=null,S!==null){S=S.next;do u.status="rejected",u.reason=p,Ed(u),u=u.next;while(u!==S)}s.action=null}function Ed(s){s=s.listeners;for(var u=0;u<s.length;u++)(0,s[u])()}function wf(s,u){return u}function Of(s,u){if(Fe){var p=hn.formState;if(p!==null){t:{var S=ue;if(Fe){if(In){var x=e0(In,xi);if(x){In=mh(x),S=n0(x);break t}}et(S)}S=!1}S&&(u=p[0])}}p=Wn(),p.memoizedState=p.baseState=u,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wf,lastRenderedState:u},p.queue=S,p=Td.bind(null,ue,S),S.dispatch=p,S=bo(!1);var H=Ao.bind(null,ue,!1,S.queue);return S=Wn(),x={state:u,dispatch:null,action:s,pending:null},S.queue=x,p=Cf.bind(null,ue,x,H,p),x.dispatch=p,S.memoizedState=s,[u,p,!1]}function ju(s){var u=Qn();return Cd(u,Pe,s)}function Cd(s,u,p){if(u=Pa(s,u,wf)[0],s=di(hi)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var S=Sl(u)}catch(nt){throw nt===Xs?Fs:nt}else S=u;u=Qn();var x=u.queue,H=x.dispatch;return p!==u.memoizedState&&(ue.flags|=2048,Ha(9,_l(),Ug.bind(null,x,p),null)),[S,H,s]}function Ug(s,u){s.action=u}function _o(s){var u=Qn(),p=Pe;if(p!==null)return Cd(u,p,s);Qn(),u=u.memoizedState,p=Qn();var S=p.queue.dispatch;return p.memoizedState=s,[u,S,!1]}function Ha(s,u,p,S){return s={tag:s,create:p,deps:S,inst:u,next:null},u=ue.updateQueue,u===null&&(u=xu(),ue.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=s.next=s:(S=p.next,p.next=s,s.next=S,u.lastEffect=s),s}function _l(){return{destroy:void 0,resource:void 0}}function Uu(){return Qn().memoizedState}function hr(s,u,p,S){var x=Wn();S=S===void 0?null:S,ue.flags|=s,x.memoizedState=Ha(1|u,_l(),p,S)}function Pi(s,u,p,S){var x=Qn();S=S===void 0?null:S;var H=x.memoizedState.inst;Pe!==null&&S!==null&&Ir(S,Pe.memoizedState.deps)?x.memoizedState=Ha(u,H,p,S):(ue.flags|=s,x.memoizedState=Ha(1|u,H,p,S))}function Rf(s,u){hr(8390656,8,s,u)}function Bu(s,u){Pi(2048,8,s,u)}function xf(s,u){return Pi(4,2,s,u)}function El(s,u){return Pi(4,4,s,u)}function Hi(s,u){if(typeof u=="function"){s=s();var p=u(s);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return s=s(),u.current=s,function(){u.current=null}}function zu(s,u,p){p=p!=null?p.concat([s]):null,Pi(4,4,Hi.bind(null,u,s),p)}function Es(){}function dr(s,u){var p=Qn();u=u===void 0?null:u;var S=p.memoizedState;return u!==null&&Ir(u,S[1])?S[0]:(p.memoizedState=[s,u],s)}function Lu(s,u){var p=Qn();u=u===void 0?null:u;var S=p.memoizedState;if(u!==null&&Ir(u,S[1]))return S[0];if(S=s(),Ws){K(!0);try{s()}finally{K(!1)}}return p.memoizedState=[S,u],S}function Cl(s,u,p){return p===void 0||($e&1073741824)!==0?s.memoizedState=u:(s.memoizedState=p,s=ac(),ue.lanes|=s,za|=s,p)}function Nf(s,u,p,S){return ja(p,u)?p:Js.current!==null?(s=Cl(s,p,S),ja(s,u)||(ta=!0),s):($e&42)===0?(ta=!0,s.memoizedState=p):(s=ac(),ue.lanes|=s,za|=s,u)}function Eo(s,u,p,S,x){var H=Fi();Fn(H!==0&&8>H?H:8);var nt=oe.T,ut={};oe.T=ut,Ao(s,!1,u,p);try{var _t=x(),jt=oe.S;if(jt!==null&&jt(ut,_t),_t!==null&&typeof _t=="object"&&typeof _t.then=="function"){var Pt=$t(_t,S);Cs(s,u,Pt,ka(s))}else Cs(s,u,S,ka(s))}catch(Zt){Cs(s,u,{then:function(){},status:"rejected",reason:Zt},ka())}finally{Fn(H),oe.T=nt}}function Co(s){var u=s.memoizedState;if(u!==null)return u;u={memoizedState:Ar,baseState:Ar,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:Ar},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:p},next:null},s.memoizedState=u,s=s.alternate,s!==null&&(s.memoizedState=u),u}function Gu(){return be(vi)}function Oa(){return Qn().memoizedState}function Vr(){return Qn().memoizedState}function Pu(s){for(var u=s.return;u!==null;){switch(u.tag){case 24:case 3:var p=ka();s=Ut(p);var S=je(u,s,p);S!==null&&(qa(S,u,p),en(S,u,p)),u={cache:De()},s.payload=u;return}u=u.return}}function To(s,u,p){var S=ka();p={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Yr(s)?wo(u,p):(p=ne(s,u,p,S),p!==null&&(qa(p,s,S),Mf(p,u,S)))}function Td(s,u,p){var S=ka();Cs(s,u,p,S)}function Cs(s,u,p,S){var x={lane:S,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Yr(s))wo(u,x);else{var H=s.alternate;if(s.lanes===0&&(H===null||H.lanes===0)&&(H=u.lastRenderedReducer,H!==null))try{var nt=u.lastRenderedState,ut=H(nt,p);if(x.hasEagerState=!0,x.eagerState=ut,ja(ut,nt))return It(s,u,x,0),hn===null&&Lt(),!1}catch{}finally{}if(p=ne(s,u,x,S),p!==null)return qa(p,s,S),Mf(p,u,S),!0}return!1}function Ao(s,u,p,S){if(S={lane:2,revertLane:Bt(),action:S,hasEagerState:!1,eagerState:null,next:null},Yr(s)){if(u)throw Error(r(479))}else u=ne(s,p,S,2),u!==null&&qa(u,s,2)}function Yr(s){var u=s.alternate;return s===ue||u!==null&&u===ue}function wo(s,u){Zs=su=!0;var p=s.pending;p===null?u.next=u:(u.next=p.next,p.next=u),s.pending=u}function Mf(s,u,p){if((p&4194048)!==0){var S=u.lanes;S&=s.pendingLanes,p|=S,u.lanes=p,j(s,p)}}function Hu(s){var u=el;return el+=1,Xa===null&&(Xa=[]),Hr(Xa,s,u)}function Oo(s,u){u=u.props.ref,s.ref=u!==void 0?u:null}function Iu(s,u){throw u.$$typeof===js?Error(r(525)):(s=Object.prototype.toString.call(u),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":s)))}function ku(s){var u=s._init;return u(s._payload)}function Ad(s){function u(bt,pt){if(s){var Tt=bt.deletions;Tt===null?(bt.deletions=[pt],bt.flags|=16):Tt.push(pt)}}function p(bt,pt){if(!s)return null;for(;pt!==null;)u(bt,pt),pt=pt.sibling;return null}function S(bt){for(var pt=new Map;bt!==null;)bt.key!==null?pt.set(bt.key,bt):pt.set(bt.index,bt),bt=bt.sibling;return pt}function x(bt,pt){return bt=bn(bt,pt),bt.index=0,bt.sibling=null,bt}function H(bt,pt,Tt){return bt.index=Tt,s?(Tt=bt.alternate,Tt!==null?(Tt=Tt.index,Tt<pt?(bt.flags|=67108866,pt):Tt):(bt.flags|=67108866,pt)):(bt.flags|=1048576,pt)}function nt(bt){return s&&bt.alternate===null&&(bt.flags|=67108866),bt}function ut(bt,pt,Tt,Ht){return pt===null||pt.tag!==6?(pt=th(Tt,bt.mode,Ht),pt.return=bt,pt):(pt=x(pt,Tt),pt.return=bt,pt)}function _t(bt,pt,Tt,Ht){var Ft=Tt.type;return Ft===Us?Pt(bt,pt,Tt.props.children,Ht,Tt.key):pt!==null&&(pt.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===Cr&&ku(Ft)===pt.type)?(pt=x(pt,Tt.props),Oo(pt,Tt),pt.return=bt,pt):(pt=Io(Tt.type,Tt.key,Tt.props,null,bt.mode,Ht),Oo(pt,Tt),pt.return=bt,pt)}function jt(bt,pt,Tt,Ht){return pt===null||pt.tag!==4||pt.stateNode.containerInfo!==Tt.containerInfo||pt.stateNode.implementation!==Tt.implementation?(pt=eh(Tt,bt.mode,Ht),pt.return=bt,pt):(pt=x(pt,Tt.children||[]),pt.return=bt,pt)}function Pt(bt,pt,Tt,Ht,Ft){return pt===null||pt.tag!==7?(pt=Ms(Tt,bt.mode,Ht,Ft),pt.return=bt,pt):(pt=x(pt,Tt),pt.return=bt,pt)}function Zt(bt,pt,Tt){if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return pt=th(""+pt,bt.mode,Tt),pt.return=bt,pt;if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case Ll:return Tt=Io(pt.type,pt.key,pt.props,null,bt.mode,Tt),Oo(Tt,pt),Tt.return=bt,Tt;case Sr:return pt=eh(pt,bt.mode,Tt),pt.return=bt,pt;case Cr:var Ht=pt._init;return pt=Ht(pt._payload),Zt(bt,pt,Tt)}if(zs(pt)||_(pt))return pt=Ms(pt,bt.mode,Tt,null),pt.return=bt,pt;if(typeof pt.then=="function")return Zt(bt,Hu(pt),Tt);if(pt.$$typeof===br)return Zt(bt,ye(bt,pt),Tt);Iu(bt,pt)}return null}function Wt(bt,pt,Tt,Ht){var Ft=pt!==null?pt.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint")return Ft!==null?null:ut(bt,pt,""+Tt,Ht);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case Ll:return Tt.key===Ft?_t(bt,pt,Tt,Ht):null;case Sr:return Tt.key===Ft?jt(bt,pt,Tt,Ht):null;case Cr:return Ft=Tt._init,Tt=Ft(Tt._payload),Wt(bt,pt,Tt,Ht)}if(zs(Tt)||_(Tt))return Ft!==null?null:Pt(bt,pt,Tt,Ht,null);if(typeof Tt.then=="function")return Wt(bt,pt,Hu(Tt),Ht);if(Tt.$$typeof===br)return Wt(bt,pt,ye(bt,Tt),Ht);Iu(bt,Tt)}return null}function Te(bt,pt,Tt,Ht,Ft){if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number"||typeof Ht=="bigint")return bt=bt.get(Tt)||null,ut(pt,bt,""+Ht,Ft);if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case Ll:return bt=bt.get(Ht.key===null?Tt:Ht.key)||null,_t(pt,bt,Ht,Ft);case Sr:return bt=bt.get(Ht.key===null?Tt:Ht.key)||null,jt(pt,bt,Ht,Ft);case Cr:var dn=Ht._init;return Ht=dn(Ht._payload),Te(bt,pt,Tt,Ht,Ft)}if(zs(Ht)||_(Ht))return bt=bt.get(Tt)||null,Pt(pt,bt,Ht,Ft,null);if(typeof Ht.then=="function")return Te(bt,pt,Tt,Hu(Ht),Ft);if(Ht.$$typeof===br)return Te(bt,pt,Tt,ye(pt,Ht),Ft);Iu(pt,Ht)}return null}function fi(bt,pt,Tt,Ht){for(var Ft=null,dn=null,ge=pt,Qe=pt=0,sa=null;ge!==null&&Qe<Tt.length;Qe++){ge.index>Qe?(sa=ge,ge=null):sa=ge.sibling;var Je=Wt(bt,ge,Tt[Qe],Ht);if(Je===null){ge===null&&(ge=sa);break}s&&ge&&Je.alternate===null&&u(bt,ge),pt=H(Je,pt,Qe),dn===null?Ft=Je:dn.sibling=Je,dn=Je,ge=sa}if(Qe===Tt.length)return p(bt,ge),Fe&&W(bt,Qe),Ft;if(ge===null){for(;Qe<Tt.length;Qe++)ge=Zt(bt,Tt[Qe],Ht),ge!==null&&(pt=H(ge,pt,Qe),dn===null?Ft=ge:dn.sibling=ge,dn=ge);return Fe&&W(bt,Qe),Ft}for(ge=S(ge);Qe<Tt.length;Qe++)sa=Te(ge,bt,Qe,Tt[Qe],Ht),sa!==null&&(s&&sa.alternate!==null&&ge.delete(sa.key===null?Qe:sa.key),pt=H(sa,pt,Qe),dn===null?Ft=sa:dn.sibling=sa,dn=sa);return s&&ge.forEach(function(gs){return u(bt,gs)}),Fe&&W(bt,Qe),Ft}function Fl(bt,pt,Tt,Ht){if(Tt==null)throw Error(r(151));for(var Ft=null,dn=null,ge=pt,Qe=pt=0,sa=null,Je=Tt.next();ge!==null&&!Je.done;Qe++,Je=Tt.next()){ge.index>Qe?(sa=ge,ge=null):sa=ge.sibling;var gs=Wt(bt,ge,Je.value,Ht);if(gs===null){ge===null&&(ge=sa);break}s&&ge&&gs.alternate===null&&u(bt,ge),pt=H(gs,pt,Qe),dn===null?Ft=gs:dn.sibling=gs,dn=gs,ge=sa}if(Je.done)return p(bt,ge),Fe&&W(bt,Qe),Ft;if(ge===null){for(;!Je.done;Qe++,Je=Tt.next())Je=Zt(bt,Je.value,Ht),Je!==null&&(pt=H(Je,pt,Qe),dn===null?Ft=Je:dn.sibling=Je,dn=Je);return Fe&&W(bt,Qe),Ft}for(ge=S(ge);!Je.done;Qe++,Je=Tt.next())Je=Te(ge,bt,Qe,Je.value,Ht),Je!==null&&(s&&Je.alternate!==null&&ge.delete(Je.key===null?Qe:Je.key),pt=H(Je,pt,Qe),dn===null?Ft=Je:dn.sibling=Je,dn=Je);return s&&ge.forEach(function(Ic){return u(bt,Ic)}),Fe&&W(bt,Qe),Ft}function ds(bt,pt,Tt,Ht){if(typeof Tt=="object"&&Tt!==null&&Tt.type===Us&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case Ll:t:{for(var Ft=Tt.key;pt!==null;){if(pt.key===Ft){if(Ft=Tt.type,Ft===Us){if(pt.tag===7){p(bt,pt.sibling),Ht=x(pt,Tt.props.children),Ht.return=bt,bt=Ht;break t}}else if(pt.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===Cr&&ku(Ft)===pt.type){p(bt,pt.sibling),Ht=x(pt,Tt.props),Oo(Ht,Tt),Ht.return=bt,bt=Ht;break t}p(bt,pt);break}else u(bt,pt);pt=pt.sibling}Tt.type===Us?(Ht=Ms(Tt.props.children,bt.mode,Ht,Tt.key),Ht.return=bt,bt=Ht):(Ht=Io(Tt.type,Tt.key,Tt.props,null,bt.mode,Ht),Oo(Ht,Tt),Ht.return=bt,bt=Ht)}return nt(bt);case Sr:t:{for(Ft=Tt.key;pt!==null;){if(pt.key===Ft)if(pt.tag===4&&pt.stateNode.containerInfo===Tt.containerInfo&&pt.stateNode.implementation===Tt.implementation){p(bt,pt.sibling),Ht=x(pt,Tt.children||[]),Ht.return=bt,bt=Ht;break t}else{p(bt,pt);break}else u(bt,pt);pt=pt.sibling}Ht=eh(Tt,bt.mode,Ht),Ht.return=bt,bt=Ht}return nt(bt);case Cr:return Ft=Tt._init,Tt=Ft(Tt._payload),ds(bt,pt,Tt,Ht)}if(zs(Tt))return fi(bt,pt,Tt,Ht);if(_(Tt)){if(Ft=_(Tt),typeof Ft!="function")throw Error(r(150));return Tt=Ft.call(Tt),Fl(bt,pt,Tt,Ht)}if(typeof Tt.then=="function")return ds(bt,pt,Hu(Tt),Ht);if(Tt.$$typeof===br)return ds(bt,pt,ye(bt,Tt),Ht);Iu(bt,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint"?(Tt=""+Tt,pt!==null&&pt.tag===6?(p(bt,pt.sibling),Ht=x(pt,Tt),Ht.return=bt,bt=Ht):(p(bt,pt),Ht=th(Tt,bt.mode,Ht),Ht.return=bt,bt=Ht),nt(bt)):p(bt,pt)}return function(bt,pt,Tt,Ht){try{el=0;var Ft=ds(bt,pt,Tt,Ht);return Xa=null,Ft}catch(ge){if(ge===Xs||ge===Fs)throw ge;var dn=n(29,ge,null,bt.mode);return dn.lanes=Ht,dn.return=bt,dn}finally{}}}function Kr(s){var u=s.alternate;v(Un,Un.current&1),v(ci,s),Ba===null&&(u===null||Js.current!==null||u.memoizedState!==null)&&(Ba=s)}function wd(s){if(s.tag===22){if(v(Un,Un.current),v(ci,s),Ba===null){var u=s.alternate;u!==null&&u.memoizedState!==null&&(Ba=s)}}else Qr()}function Qr(){v(Un,Un.current),v(ci,ci.current)}function gr(s){O(ci),Ba===s&&(Ba=null),O(Un)}function Ro(s){for(var u=s;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||bc(p)||_c(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function Df(s,u,p,S){u=s.memoizedState,p=p(S,u),p=p==null?u:cc({},u,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}function Od(s,u,p,S,x,H,nt){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(S,H,nt):u.prototype&&u.prototype.isPureReactComponent?!Ln(p,S)||!Ln(x,H):!0}function Rd(s,u,p,S){s=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,S),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,S),u.state!==s&&nl.enqueueReplaceState(u,u.state,null)}function Ts(s,u){var p=u;if("ref"in u){p={};for(var S in u)S!=="ref"&&(p[S]=u[S])}if(s=s.defaultProps){p===u&&(p=cc({},p));for(var x in s)p[x]===void 0&&(p[x]=s[x])}return p}function Tl(s,u){try{var p=s.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(S){setTimeout(function(){throw S})}}function xd(s,u,p){try{var S=s.onCaughtError;S(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function jf(s,u,p){return p=Ut(p),p.tag=3,p.payload={element:null},p.callback=function(){Tl(s,u)},p}function Nd(s){return s=Ut(s),s.tag=3,s}function Uf(s,u,p,S){var x=p.type.getDerivedStateFromError;if(typeof x=="function"){var H=S.value;s.payload=function(){return x(H)},s.callback=function(){xd(u,p,S)}}var nt=p.stateNode;nt!==null&&typeof nt.componentDidCatch=="function"&&(s.callback=function(){xd(u,p,S),typeof x!="function"&&(Dr===null?Dr=new Set([this]):Dr.add(this));var ut=S.stack;this.componentDidCatch(S.value,{componentStack:ut!==null?ut:""})})}function Bg(s,u,p,S,x){if(p.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(u=p.alternate,u!==null&&tn(u,p,x,!0),p=ci.current,p!==null){switch(p.tag){case 13:return Ba===null?ic():p.alternate===null&&En===0&&(En=3),p.flags&=-257,p.flags|=65536,p.lanes=x,S===iu?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([S]):u.add(S),Oi(s,S,x)),!1;case 22:return p.flags|=65536,S===iu?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([S])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([S]):p.add(S)),Oi(s,S,x)),!1}throw Error(r(435,p.tag))}return Oi(s,S,x),ic(),!1}if(Fe)return u=ci.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=x,S!==Ni&&(s=Error(r(422),{cause:S}),se(F(s,p)))):(S!==Ni&&(u=Error(r(423),{cause:S}),se(F(u,p))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,S=F(S,p),x=jf(s.stateNode,S,x),ze(s,x),En!==4&&(En=2)),!1;var H=Error(r(520),{cause:S});if(H=F(H,p),rl===null?rl=[H]:rl.push(H),En!==4&&(En=2),u===null)return!0;S=F(S,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,s=x&-x,p.lanes|=s,s=jf(p.stateNode,S,s),ze(p,s),!1;case 1:if(u=p.type,H=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Dr===null||!Dr.has(H))))return p.flags|=65536,x&=-x,p.lanes|=x,x=Nd(x),Uf(x,s,p,S),ze(p,x),!1}p=p.return}while(p!==null);return!1}function ua(s,u,p,S){u.child=s===null?yi(u,null,p,S):fs(u,s.child,p,S)}function Md(s,u,p,S,x){p=p.render;var H=u.ref;if("ref"in S){var nt={};for(var ut in S)ut!=="ref"&&(nt[ut]=S[ut])}else nt=S;return Xt(u),S=kr(s,u,p,nt,H,x),ut=Ou(),s!==null&&!ta?(Ru(s,u,x),Ii(s,u,x)):(Fe&&ut&&Z(u),u.flags|=1,ua(s,u,S,x),u.child)}function Dd(s,u,p,S,x){if(s===null){var H=p.type;return typeof H=="function"&&!yr(H)&&H.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=H,jd(s,u,H,S,x)):(s=Io(p.type,null,S,u,u.mode,x),s.ref=u.ref,s.return=u,u.child=s)}if(H=s.child,!Xu(s,x)){var nt=H.memoizedProps;if(p=p.compare,p=p!==null?p:Ln,p(nt,S)&&s.ref===u.ref)return Ii(s,u,x)}return u.flags|=1,s=bn(H,S),s.ref=u.ref,s.return=u,u.child=s}function jd(s,u,p,S,x){if(s!==null){var H=s.memoizedProps;if(Ln(H,S)&&s.ref===u.ref)if(ta=!1,u.pendingProps=S=H,Xu(s,x))(s.flags&131072)!==0&&(ta=!0);else return u.lanes=s.lanes,Ii(s,u,x)}return Bf(s,u,p,S,x)}function Ud(s,u,p){var S=u.pendingProps,x=S.children,H=s!==null?s.memoizedState:null;if(S.mode==="hidden"){if((u.flags&128)!==0){if(S=H!==null?H.baseLanes|p:p,s!==null){for(x=u.child=s.child,H=0;x!==null;)H=H|x.lanes|x.childLanes,x=x.sibling;u.childLanes=H&~S}else u.childLanes=0,u.child=null;return Bd(s,u,S,p)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},s!==null&&sn(u,H!==null?H.cachePool:null),H!==null?Sd(u,H):wu(),wd(u);else return u.lanes=u.childLanes=536870912,Bd(s,u,H!==null?H.baseLanes|p:p,p)}else H!==null?(sn(u,H.cachePool),Sd(u,H),Qr(),u.memoizedState=null):(s!==null&&sn(u,null),wu(),Qr());return ua(s,u,x,p),u.child}function Bd(s,u,p,S){var x=He();return x=x===null?null:{parent:Qi?pn._currentValue:pn._currentValue2,pool:x},u.memoizedState={baseLanes:p,cachePool:x},s!==null&&sn(u,null),wu(),wd(u),s!==null&&tn(s,u,S,!0),null}function qu(s,u){var p=u.ref;if(p===null)s!==null&&s.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(u.flags|=4194816)}}function Bf(s,u,p,S,x){return Xt(u),p=kr(s,u,p,S,void 0,x),S=Ou(),s!==null&&!ta?(Ru(s,u,x),Ii(s,u,x)):(Fe&&S&&Z(u),u.flags|=1,ua(s,u,p,x),u.child)}function Vu(s,u,p,S,x,H){return Xt(u),u.updateQueue=null,p=bs(u,S,p,x),yl(s),S=Ou(),s!==null&&!ta?(Ru(s,u,H),Ii(s,u,H)):(Fe&&S&&Z(u),u.flags|=1,ua(s,u,p,H),u.child)}function Al(s,u,p,S,x){if(Xt(u),u.stateNode===null){var H=ls,nt=p.contextType;typeof nt=="object"&&nt!==null&&(H=be(nt)),H=new p(S,H),u.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,H.updater=nl,u.stateNode=H,H._reactInternals=u,H=u.stateNode,H.props=S,H.state=u.memoizedState,H.refs={},Kn(u),nt=p.contextType,H.context=typeof nt=="object"&&nt!==null?be(nt):ls,H.state=u.memoizedState,nt=p.getDerivedStateFromProps,typeof nt=="function"&&(Df(u,p,nt,S),H.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(nt=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),nt!==H.state&&nl.enqueueReplaceState(H,H.state,null),oa(u,S,H,x),ln(),H.state=u.memoizedState),typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!0}else if(s===null){H=u.stateNode;var ut=u.memoizedProps,_t=Ts(p,ut);H.props=_t;var jt=H.context,Pt=p.contextType;nt=ls,typeof Pt=="object"&&Pt!==null&&(nt=be(Pt));var Zt=p.getDerivedStateFromProps;Pt=typeof Zt=="function"||typeof H.getSnapshotBeforeUpdate=="function",ut=u.pendingProps!==ut,Pt||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ut||jt!==nt)&&Rd(u,H,S,nt),_n=!1;var Wt=u.memoizedState;H.state=Wt,oa(u,S,H,x),ln(),jt=u.memoizedState,ut||Wt!==jt||_n?(typeof Zt=="function"&&(Df(u,p,Zt,S),jt=u.memoizedState),(_t=_n||Od(u,p,_t,S,Wt,jt,nt))?(Pt||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(u.flags|=4194308)):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=S,u.memoizedState=jt),H.props=S,H.state=jt,H.context=nt,S=_t):(typeof H.componentDidMount=="function"&&(u.flags|=4194308),S=!1)}else{H=u.stateNode,wn(s,u),nt=u.memoizedProps,Pt=Ts(p,nt),H.props=Pt,Zt=u.pendingProps,Wt=H.context,jt=p.contextType,_t=ls,typeof jt=="object"&&jt!==null&&(_t=be(jt)),ut=p.getDerivedStateFromProps,(jt=typeof ut=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(nt!==Zt||Wt!==_t)&&Rd(u,H,S,_t),_n=!1,Wt=u.memoizedState,H.state=Wt,oa(u,S,H,x),ln();var Te=u.memoizedState;nt!==Zt||Wt!==Te||_n||s!==null&&s.dependencies!==null&&xt(s.dependencies)?(typeof ut=="function"&&(Df(u,p,ut,S),Te=u.memoizedState),(Pt=_n||Od(u,p,Pt,S,Wt,Te,_t)||s!==null&&s.dependencies!==null&&xt(s.dependencies))?(jt||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(S,Te,_t),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(S,Te,_t)),typeof H.componentDidUpdate=="function"&&(u.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof H.componentDidUpdate!="function"||nt===s.memoizedProps&&Wt===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||nt===s.memoizedProps&&Wt===s.memoizedState||(u.flags|=1024),u.memoizedProps=S,u.memoizedState=Te),H.props=S,H.state=Te,H.context=_t,S=Pt):(typeof H.componentDidUpdate!="function"||nt===s.memoizedProps&&Wt===s.memoizedState||(u.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||nt===s.memoizedProps&&Wt===s.memoizedState||(u.flags|=1024),S=!1)}return H=S,qu(s,u),S=(u.flags&128)!==0,H||S?(H=u.stateNode,p=S&&typeof p.getDerivedStateFromError!="function"?null:H.render(),u.flags|=1,s!==null&&S?(u.child=fs(u,s.child,null,x),u.child=fs(u,null,p,x)):ua(s,u,p,x),u.memoizedState=H.state,s=u.child):s=Ii(s,u,x),s}function zd(s,u,p,S){return Qt(),u.flags|=256,ua(s,u,p,S),u.child}function Yu(s){return{baseLanes:s,cachePool:An()}}function Ku(s,u,p){return s=s!==null?s.childLanes&~p:0,u&&(s|=ya),s}function zf(s,u,p){var S=u.pendingProps,x=!1,H=(u.flags&128)!==0,nt;if((nt=H)||(nt=s!==null&&s.memoizedState===null?!1:(Un.current&2)!==0),nt&&(x=!0,u.flags&=-129),nt=(u.flags&32)!==0,u.flags&=-33,s===null){if(Fe){if(x?Kr(u):Qr(),Fe){var ut=In,_t;(_t=ut)&&(ut=Cc(ut,xi),ut!==null?(u.memoizedState={dehydrated:ut,treeContext:os!==null?{id:tr,overflow:Ri}:null,retryLane:536870912,hydrationErrors:null},_t=n(18,null,null,0),_t.stateNode=ut,_t.return=u,u.child=_t,aa=u,In=null,_t=!0):_t=!1),_t||et(u)}if(ut=u.memoizedState,ut!==null&&(ut=ut.dehydrated,ut!==null))return _c(ut)?u.lanes=32:u.lanes=536870912,null;gr(u)}return ut=S.children,S=S.fallback,x?(Qr(),x=u.mode,ut=xo({mode:"hidden",children:ut},x),S=Ms(S,x,p,null),ut.return=u,S.return=u,ut.sibling=S,u.child=ut,x=u.child,x.memoizedState=Yu(p),x.childLanes=Ku(s,nt,p),u.memoizedState=il,S):(Kr(u),Qu(u,ut))}if(_t=s.memoizedState,_t!==null&&(ut=_t.dehydrated,ut!==null)){if(H)u.flags&256?(Kr(u),u.flags&=-257,u=Xr(s,u,p)):u.memoizedState!==null?(Qr(),u.child=s.child,u.flags|=128,u=null):(Qr(),x=S.fallback,ut=u.mode,S=xo({mode:"visible",children:S.children},ut),x=Ms(x,ut,p,null),x.flags|=2,S.return=u,x.return=u,S.sibling=x,u.child=S,fs(u,s.child,null,p),S=u.child,S.memoizedState=Yu(p),S.childLanes=Ku(s,nt,p),u.memoizedState=il,u=x);else if(Kr(u),_c(ut))nt=t0(ut).digest,S=Error(r(419)),S.stack="",S.digest=nt,se({value:S,source:null,stack:null}),u=Xr(s,u,p);else if(ta||tn(s,u,p,!1),nt=(p&s.childLanes)!==0,ta||nt){if(nt=hn,nt!==null&&(S=p&-p,S=(S&42)!==0?1:P(S),S=(S&(nt.suspendedLanes|p))!==0?0:S,S!==0&&S!==_t.retryLane))throw _t.retryLane=S,ae(s,S),qa(nt,s,S),jh;bc(ut)||ic(),u=Xr(s,u,p)}else bc(ut)?(u.flags|=192,u.child=s.child,u=null):(s=_t.treeContext,On&&(In=r0(ut),aa=u,Fe=!0,Rr=null,xi=!1,s!==null&&(Ka[oi++]=tr,Ka[oi++]=Ri,Ka[oi++]=os,tr=s.id,Ri=s.overflow,os=u)),u=Qu(u,S.children),u.flags|=4096);return u}return x?(Qr(),x=S.fallback,ut=u.mode,_t=s.child,H=_t.sibling,S=bn(_t,{mode:"hidden",children:S.children}),S.subtreeFlags=_t.subtreeFlags&65011712,H!==null?x=bn(H,x):(x=Ms(x,ut,p,null),x.flags|=2),x.return=u,S.return=u,S.sibling=x,u.child=S,S=x,x=u.child,ut=s.child.memoizedState,ut===null?ut=Yu(p):(_t=ut.cachePool,_t!==null?(H=Qi?pn._currentValue:pn._currentValue2,_t=_t.parent!==H?{parent:H,pool:H}:_t):_t=An(),ut={baseLanes:ut.baseLanes|p,cachePool:_t}),x.memoizedState=ut,x.childLanes=Ku(s,nt,p),u.memoizedState=il,S):(Kr(u),p=s.child,s=p.sibling,p=bn(p,{mode:"visible",children:S.children}),p.return=u,p.sibling=null,s!==null&&(nt=u.deletions,nt===null?(u.deletions=[s],u.flags|=16):nt.push(s)),u.child=p,u.memoizedState=null,p)}function Qu(s,u){return u=xo({mode:"visible",children:u},s.mode),u.return=s,s.child=u}function xo(s,u){return s=n(22,s,null,u),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Xr(s,u,p){return fs(u,s.child,null,p),s=Qu(u,u.pendingProps.children),s.flags|=2,u.memoizedState=null,s}function Ld(s,u,p){s.lanes|=u;var S=s.alternate;S!==null&&(S.lanes|=u),Ze(s.return,u,p)}function Lf(s,u,p,S,x){var H=s.memoizedState;H===null?s.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:S,tail:p,tailMode:x}:(H.isBackwards=u,H.rendering=null,H.renderingStartTime=0,H.last=S,H.tail=p,H.tailMode=x)}function Gd(s,u,p){var S=u.pendingProps,x=S.revealOrder,H=S.tail;if(ua(s,u,S.children,p),S=Un.current,(S&2)!==0)S=S&1|2,u.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=u.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ld(s,p,u);else if(s.tag===19)Ld(s,p,u);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===u)break t;for(;s.sibling===null;){if(s.return===null||s.return===u)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}S&=1}switch(v(Un,S),x){case"forwards":for(p=u.child,x=null;p!==null;)s=p.alternate,s!==null&&Ro(s)===null&&(x=p),p=p.sibling;p=x,p===null?(x=u.child,u.child=null):(x=p.sibling,p.sibling=null),Lf(u,!1,x,p,H);break;case"backwards":for(p=null,x=u.child,u.child=null;x!==null;){if(s=x.alternate,s!==null&&Ro(s)===null){u.child=x;break}s=x.sibling,x.sibling=p,p=x,x=s}Lf(u,!0,p,null,H);break;case"together":Lf(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Ii(s,u,p){if(s!==null&&(u.dependencies=s.dependencies),za|=u.lanes,(p&u.childLanes)===0)if(s!==null){if(tn(s,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(s!==null&&u.child!==s.child)throw Error(r(153));if(u.child!==null){for(s=u.child,p=bn(s,s.pendingProps),u.child=p,p.return=u;s.sibling!==null;)s=s.sibling,p=p.sibling=bn(s,s.pendingProps),p.return=u;p.sibling=null}return u.child}function Xu(s,u){return(s.lanes&u)!==0?!0:(s=s.dependencies,!!(s!==null&&xt(s)))}function No(s,u,p){switch(u.tag){case 3:at(u,u.stateNode.containerInfo),pe(u,pn,s.memoizedState.cache),Qt();break;case 27:case 5:J(u);break;case 4:at(u,u.stateNode.containerInfo);break;case 10:pe(u,u.type,u.memoizedProps.value);break;case 13:var S=u.memoizedState;if(S!==null)return S.dehydrated!==null?(Kr(u),u.flags|=128,null):(p&u.child.childLanes)!==0?zf(s,u,p):(Kr(u),s=Ii(s,u,p),s!==null?s.sibling:null);Kr(u);break;case 19:var x=(s.flags&128)!==0;if(S=(p&u.childLanes)!==0,S||(tn(s,u,p,!1),S=(p&u.childLanes)!==0),x){if(S)return Gd(s,u,p);u.flags|=128}if(x=u.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),v(Un,Un.current),S)break;return null;case 22:case 23:return u.lanes=0,Ud(s,u,p);case 24:pe(u,pn,s.memoizedState.cache)}return Ii(s,u,p)}function wl(s,u,p){if(s!==null)if(s.memoizedProps!==u.pendingProps)ta=!0;else{if(!Xu(s,p)&&(u.flags&128)===0)return ta=!1,No(s,u,p);ta=(s.flags&131072)!==0}else ta=!1,Fe&&(u.flags&1048576)!==0&&it(u,Ys,u.index);switch(u.lanes=0,u.tag){case 16:t:{s=u.pendingProps;var S=u.elementType,x=S._init;if(S=x(S._payload),u.type=S,typeof S=="function")yr(S)?(s=Ts(S,s),u.tag=1,u=Al(null,u,S,s,p)):(u.tag=0,u=Bf(null,u,S,s,p));else{if(S!=null){if(x=S.$$typeof,x===hc){u.tag=11,u=Md(null,u,S,s,p);break t}else if(x===dc){u.tag=14,u=Dd(null,u,S,s,p);break t}}throw u=C(S)||S,Error(r(306,u,""))}}return u;case 0:return Bf(s,u,u.type,u.pendingProps,p);case 1:return S=u.type,x=Ts(S,u.pendingProps),Al(s,u,S,x,p);case 3:t:{if(at(u,u.stateNode.containerInfo),s===null)throw Error(r(387));var H=u.pendingProps;x=u.memoizedState,S=x.element,wn(s,u),oa(u,H,null,p);var nt=u.memoizedState;if(H=nt.cache,pe(u,pn,H),H!==x.cache&&Ve(u,[pn],p,!0),ln(),H=nt.element,On&&x.isDehydrated)if(x={element:H,isDehydrated:!1,cache:nt.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=zd(s,u,H,p);break t}else if(H!==S){S=F(Error(r(424)),u),se(S),u=zd(s,u,H,p);break t}else for(On&&(In=Hg(u.stateNode.containerInfo),aa=u,Fe=!0,Rr=null,xi=!0),p=yi(u,null,H,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Qt(),H===S){u=Ii(s,u,p);break t}ua(s,u,H,p)}u=u.child}return u;case 26:if(si)return qu(s,u),s===null?(p=p0(u.type,null,u.pendingProps,null))?u.memoizedState=p:Fe||(u.stateNode=v0(u.type,u.pendingProps,Or.current,u)):u.memoizedState=p0(u.type,s.memoizedProps,u.pendingProps,s.memoizedState),null;case 27:if(Hn)return J(u),s===null&&Hn&&Fe&&(S=u.stateNode=Wo(u.type,u.pendingProps,Or.current,$n.current,!1),aa=u,xi=!0,In=Hl(u.type,S,In)),ua(s,u,u.pendingProps.children,p),qu(s,u),s===null&&(u.flags|=4194304),u.child;case 5:return s===null&&Fe&&(d0(u.type,u.pendingProps,$n.current),(x=S=In)&&(S=s0(S,u.type,u.pendingProps,xi),S!==null?(u.stateNode=S,aa=u,In=i0(S),xi=!1,x=!0):x=!1),x||et(u)),J(u),x=u.type,H=u.pendingProps,nt=s!==null?s.memoizedProps:null,S=H.children,is(x,H)?S=null:nt!==null&&is(x,nt)&&(u.flags|=32),u.memoizedState!==null&&(x=kr(s,u,ea,null,null,p),Qi?vi._currentValue=x:vi._currentValue2=x),qu(s,u),ua(s,u,S,p),u.child;case 6:return s===null&&Fe&&(g0(u.pendingProps,$n.current),(s=p=In)&&(p=Ec(p,u.pendingProps,xi),p!==null?(u.stateNode=p,aa=u,In=null,s=!0):s=!1),s||et(u)),null;case 13:return zf(s,u,p);case 4:return at(u,u.stateNode.containerInfo),S=u.pendingProps,s===null?u.child=fs(u,null,S,p):ua(s,u,S,p),u.child;case 11:return Md(s,u,u.type,u.pendingProps,p);case 7:return ua(s,u,u.pendingProps,p),u.child;case 8:return ua(s,u,u.pendingProps.children,p),u.child;case 12:return ua(s,u,u.pendingProps.children,p),u.child;case 10:return S=u.pendingProps,pe(u,u.type,S.value),ua(s,u,S.children,p),u.child;case 9:return x=u.type._context,S=u.pendingProps.children,Xt(u),x=be(x),S=S(x),u.flags|=1,ua(s,u,S,p),u.child;case 14:return Dd(s,u,u.type,u.pendingProps,p);case 15:return jd(s,u,u.type,u.pendingProps,p);case 19:return Gd(s,u,p);case 31:return S=u.pendingProps,p=u.mode,S={mode:S.mode,children:S.children},s===null?(p=xo(S,p),p.ref=u.ref,u.child=p,p.return=u,u=p):(p=bn(s.child,S),p.ref=u.ref,u.child=p,p.return=u,u=p),u;case 22:return Ud(s,u,p);case 24:return Xt(u),S=be(pn),s===null?(x=He(),x===null&&(x=hn,H=De(),x.pooledCache=H,H.refCount++,H!==null&&(x.pooledCacheLanes|=p),x=H),u.memoizedState={parent:S,cache:x},Kn(u),pe(u,pn,x)):((s.lanes&p)!==0&&(wn(s,u),oa(u,null,null,p),ln()),x=s.memoizedState,H=u.memoizedState,x.parent!==S?(x={parent:S,cache:S},u.memoizedState=x,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=x),pe(u,pn,S)):(S=H.cache,pe(u,pn,S),S!==x.cache&&Ve(u,[pn],p,!0))),ua(s,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function ti(s){s.flags|=4}function Mo(s,u){if(s!==null&&s.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(s=u.child;s!==null;){if((s.flags&13878)!==0||(s.subtreeFlags&13878)!==0)return!0;s=s.sibling}return!1}function Fu(s,u,p,S){if(na)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)Xo(s,p.stateNode);else if(!(p.tag===4||Hn&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(Xi)for(var x=u.child;x!==null;){if(x.tag===5){var H=x.stateNode;p&&S&&(H=gh(H,x.type,x.memoizedProps)),Xo(s,H)}else if(x.tag===6)H=x.stateNode,p&&S&&(H=$d(H,x.memoizedProps)),Xo(s,H);else if(x.tag!==4){if(x.tag===22&&x.memoizedState!==null)H=x.child,H!==null&&(H.return=x),Fu(s,x,!0,!0);else if(x.child!==null){x.child.return=x,x=x.child;continue}}if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return}x.sibling.return=x.return,x=x.sibling}}function Gf(s,u,p,S){var x=!1;if(Xi)for(var H=u.child;H!==null;){if(H.tag===5){var nt=H.stateNode;p&&S&&(nt=gh(nt,H.type,H.memoizedProps)),dh(s,nt)}else if(H.tag===6)nt=H.stateNode,p&&S&&(nt=$d(nt,H.memoizedProps)),dh(s,nt);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)x=H.child,x!==null&&(x.return=H),Gf(s,H,!0,!0),x=!0;else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===u)break;for(;H.sibling===null;){if(H.return===null||H.return===u)return x;H=H.return}H.sibling.return=H.return,H=H.sibling}return x}function Ju(s,u){if(Xi&&Mo(s,u)){s=u.stateNode;var p=s.containerInfo,S=hh();Gf(S,u,!1,!1),s.pendingChildren=S,ti(u),Wd(p,S)}}function Do(s,u,p,S){if(na)s.memoizedProps!==S&&ti(u);else if(Xi){var x=s.stateNode,H=s.memoizedProps;if((s=Mo(s,u))||H!==S){var nt=$n.current;H=Zd(x,p,H,S,!s,null),H===x?u.stateNode=x:(Gl(H,p,S,nt)&&ti(u),u.stateNode=H,s?Fu(H,u,!1,!1):ti(u))}else u.stateNode=x}}function Zu(s,u,p){if(gc(u,p)){if(s.flags|=16777216,!Ji(u,p))if(Ai())s.flags|=8192;else throw Qa=iu,au}else s.flags&=-16777217}function Pf(s,u){if(qg(u)){if(s.flags|=16777216,!_h(u))if(Ai())s.flags|=8192;else throw Qa=iu,au}else s.flags&=-16777217}function jo(s,u){u!==null&&(s.flags|=4),s.flags&16384&&(u=s.tag!==22?R():536870912,s.lanes|=u,Fa|=u)}function Uo(s,u){if(!Fe)switch(s.tailMode){case"hidden":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?u||s.tail===null?s.tail=null:s.tail.sibling=null:S.sibling=null}}function jn(s){var u=s.alternate!==null&&s.alternate.child===s.child,p=0,S=0;if(u)for(var x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags&65011712,S|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)p|=x.lanes|x.childLanes,S|=x.subtreeFlags,S|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=S,s.childLanes=p,u}function zg(s,u,p){var S=u.pendingProps;switch(rt(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(u),null;case 1:return jn(u),null;case 3:return p=u.stateNode,S=null,s!==null&&(S=s.memoizedState.cache),u.memoizedState.cache!==S&&(u.flags|=2048),Ee(pn),Y(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Dt(u)?ti(u):s===null||s.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,te())),Ju(s,u),jn(u),null;case 26:if(si){p=u.type;var x=u.memoizedState;return s===null?(ti(u),x!==null?(jn(u),Pf(u,x)):(jn(u),Zu(u,p,S))):x?x!==s.memoizedState?(ti(u),jn(u),Pf(u,x)):(jn(u),u.flags&=-16777217):(na?s.memoizedProps!==S&&ti(u):Do(s,u,p,S),jn(u),Zu(u,p,S)),null}case 27:if(Hn){if(tt(u),p=Or.current,x=u.type,s!==null&&u.stateNode!=null)na?s.memoizedProps!==S&&ti(u):Do(s,u,x,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return jn(u),null}s=$n.current,Dt(u)?gt(u,s):(s=Wo(x,S,p,s,!0),u.stateNode=s,ti(u))}return jn(u),null}case 5:if(tt(u),p=u.type,s!==null&&u.stateNode!=null)Do(s,u,p,S);else{if(!S){if(u.stateNode===null)throw Error(r(166));return jn(u),null}s=$n.current,Dt(u)?gt(u,s):(x=ah(p,S,Or.current,s,u),Fu(x,u,!1,!1),u.stateNode=x,Gl(x,p,S,s)&&ti(u))}return jn(u),Zu(u,u.type,u.pendingProps),null;case 6:if(s&&u.stateNode!=null)p=s.memoizedProps,na?p!==S&&ti(u):Xi&&(p!==S?(u.stateNode=ih(S,Or.current,$n.current,u),ti(u)):u.stateNode=s.stateNode);else{if(typeof S!="string"&&u.stateNode===null)throw Error(r(166));if(s=Or.current,p=$n.current,Dt(u)){if(!On)throw Error(r(176));if(s=u.stateNode,p=u.memoizedProps,S=null,x=aa,x!==null)switch(x.tag){case 27:case 5:S=x.memoizedProps}vh(s,p,u,S)||et(u)}else u.stateNode=ih(S,s,p,u)}return jn(u),null;case 13:if(S=u.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=Dt(u),S!==null&&S.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(!On)throw Error(r(344));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));Ig(x,u)}else Qt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;jn(u),x=!1}else x=te(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return u.flags&256?(gr(u),u):(gr(u),null)}if(gr(u),(u.flags&128)!==0)return u.lanes=p,u;if(p=S!==null,s=s!==null&&s.memoizedState!==null,p){S=u.child,x=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(x=S.alternate.memoizedState.cachePool.pool);var H=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(H=S.memoizedState.cachePool.pool),H!==x&&(S.flags|=2048)}return p!==s&&p&&(u.child.flags|=8192),jo(u,u.updateQueue),jn(u),null;case 4:return Y(),Ju(s,u),s===null&&rs(u.stateNode.containerInfo),jn(u),null;case 10:return Ee(u.type),jn(u),null;case 19:if(O(Un),x=u.memoizedState,x===null)return jn(u),null;if(S=(u.flags&128)!==0,H=x.rendering,H===null)if(S)Uo(x,!1);else{if(En!==0||s!==null&&(s.flags&128)!==0)for(s=u.child;s!==null;){if(H=Ro(s),H!==null){for(u.flags|=128,Uo(x,!1),s=H.updateQueue,u.updateQueue=s,jo(u,s),u.subtreeFlags=0,s=p,p=u.child;p!==null;)Ho(p,s),p=p.sibling;return v(Un,Un.current&1|2),u.child}s=s.sibling}x.tail!==null&&li()>ll&&(u.flags|=128,S=!0,Uo(x,!1),u.lanes=4194304)}else{if(!S)if(s=Ro(H),s!==null){if(u.flags|=128,S=!0,s=s.updateQueue,u.updateQueue=s,jo(u,s),Uo(x,!0),x.tail===null&&x.tailMode==="hidden"&&!H.alternate&&!Fe)return jn(u),null}else 2*li()-x.renderingStartTime>ll&&p!==536870912&&(u.flags|=128,S=!0,Uo(x,!1),u.lanes=4194304);x.isBackwards?(H.sibling=u.child,u.child=H):(s=x.last,s!==null?s.sibling=H:u.child=H,x.last=H)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=li(),u.sibling=null,s=Un.current,v(Un,S?s&1|2:s&1),u):(jn(u),null);case 22:case 23:return gr(u),Ss(),S=u.memoizedState!==null,s!==null?s.memoizedState!==null!==S&&(u.flags|=8192):S&&(u.flags|=8192),S?(p&536870912)!==0&&(u.flags&128)===0&&(jn(u),u.subtreeFlags&6&&(u.flags|=8192)):jn(u),p=u.updateQueue,p!==null&&jo(u,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),S=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(S=u.memoizedState.cachePool.pool),S!==p&&(u.flags|=2048),s!==null&&O(xr),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),Ee(pn),jn(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function Lg(s,u){switch(rt(u),u.tag){case 1:return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 3:return Ee(pn),Y(),s=u.flags,(s&65536)!==0&&(s&128)===0?(u.flags=s&-65537|128,u):null;case 26:case 27:case 5:return tt(u),null;case 13:if(gr(u),s=u.memoizedState,s!==null&&s.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Qt()}return s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 19:return O(Un),null;case 4:return Y(),null;case 10:return Ee(u.type),null;case 22:case 23:return gr(u),Ss(),s!==null&&O(xr),s=u.flags,s&65536?(u.flags=s&-65537|128,u):null;case 24:return Ee(pn),null;case 25:return null;default:return null}}function Pd(s,u){switch(rt(u),u.tag){case 3:Ee(pn),Y();break;case 26:case 27:case 5:tt(u);break;case 4:Y();break;case 13:gr(u);break;case 19:O(Un);break;case 10:Ee(u.type);break;case 22:case 23:gr(u),Ss(),s!==null&&O(xr);break;case 24:Ee(pn)}}function ca(s,u){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var x=S.next;p=x;do{if((p.tag&s)===s){S=void 0;var H=p.create,nt=p.inst;S=H(),nt.destroy=S}p=p.next}while(p!==x)}}catch(ut){Ie(u,u.return,ut)}}function gi(s,u,p){try{var S=u.updateQueue,x=S!==null?S.lastEffect:null;if(x!==null){var H=x.next;S=H;do{if((S.tag&s)===s){var nt=S.inst,ut=nt.destroy;if(ut!==void 0){nt.destroy=void 0,x=u;var _t=p,jt=ut;try{jt()}catch(Pt){Ie(x,_t,Pt)}}}S=S.next}while(S!==H)}}catch(Pt){Ie(u,u.return,Pt)}}function Hf(s){var u=s.updateQueue;if(u!==null){var p=s.stateNode;try{yd(u,p)}catch(S){Ie(s,s.return,S)}}}function If(s,u,p){p.props=Ts(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(S){Ie(s,u,S)}}function Ol(s,u){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var S=Gs(s.stateNode);break;case 30:S=s.stateNode;break;default:S=s.stateNode}typeof p=="function"?s.refCleanup=p(S):p.current=S}}catch(x){Ie(s,u,x)}}function _i(s,u){var p=s.ref,S=s.refCleanup;if(p!==null)if(typeof S=="function")try{S()}catch(x){Ie(s,u,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(x){Ie(s,u,x)}else p.current=null}function Wu(s){var u=s.type,p=s.memoizedProps,S=s.stateNode;try{Ma(S,u,p,s)}catch(x){Ie(s,s.return,x)}}function kf(s,u,p){try{Pn(s.stateNode,s.type,p,u,s)}catch(S){Ie(s,s.return,S)}}function As(s){return s.tag===5||s.tag===3||(si?s.tag===26:!1)||(Hn?s.tag===27&&Is(s.type):!1)||s.tag===4}function Bo(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||As(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(Hn&&s.tag===27&&Is(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ws(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?Jo(p,s,u):lh(p,s);else if(S!==4&&(Hn&&S===27&&Is(s.type)&&(p=s.stateNode,u=null),s=s.child,s!==null))for(ws(s,u,p),s=s.sibling;s!==null;)ws(s,u,p),s=s.sibling}function Rl(s,u,p){var S=s.tag;if(S===5||S===6)s=s.stateNode,u?mc(p,s,u):sh(p,s);else if(S!==4&&(Hn&&S===27&&Is(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(Rl(s,u,p),s=s.sibling;s!==null;)Rl(s,u,p),s=s.sibling}function qf(s,u,p){s=s.containerInfo;try{Sc(s,p)}catch(S){Ie(u,u.return,S)}}function Fr(s){var u=s.stateNode,p=s.memoizedProps;try{y0(s.type,p,u,s)}catch(S){Ie(s,s.return,S)}}function xl(s,u){for(as(s.containerInfo),ra=u;ra!==null;)if(s=ra,u=s.child,(s.subtreeFlags&1024)!==0&&u!==null)u.return=s,ra=u;else for(;ra!==null;){s=ra;var p=s.alternate;switch(u=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0;var S=s,x=p.memoizedProps;p=p.memoizedState;var H=S.stateNode;try{var nt=Ts(S.type,x,S.elementType===S.type);u=H.getSnapshotBeforeUpdate(nt,p),H.__reactInternalSnapshotBeforeUpdate=u}catch(ut){Ie(S,S.return,ut)}}break;case 3:(u&1024)!==0&&na&&Jd(s.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=s.sibling,u!==null){u.return=s.return,ra=u;break}ra=s.return}}function $u(s,u,p){var S=p.flags;switch(p.tag){case 0:case 11:case 15:ki(s,p),S&4&&ca(5,p);break;case 1:if(ki(s,p),S&4)if(s=p.stateNode,u===null)try{s.componentDidMount()}catch(nt){Ie(p,p.return,nt)}else{var x=Ts(p.type,u.memoizedProps);u=u.memoizedState;try{s.componentDidUpdate(x,u,s.__reactInternalSnapshotBeforeUpdate)}catch(nt){Ie(p,p.return,nt)}}S&64&&Hf(p),S&512&&Ol(p,p.return);break;case 3:if(ki(s,p),S&64&&(s=p.updateQueue,s!==null)){if(u=null,p.child!==null)switch(p.child.tag){case 27:case 5:u=Gs(p.child.stateNode);break;case 1:u=p.child.stateNode}try{yd(s,u)}catch(nt){Ie(p,p.return,nt)}}break;case 27:Hn&&u===null&&S&4&&Fr(p);case 26:case 5:ki(s,p),u===null&&S&4&&Wu(p),S&512&&Ol(p,p.return);break;case 12:ki(s,p);break;case 13:ki(s,p),S&4&&Yf(s,p),S&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Wf.bind(null,p),ph(s,p))));break;case 22:if(S=p.memoizedState!==null||ar,!S){u=u!==null&&u.memoizedState!==null||Rn,x=ar;var H=Rn;ar=S,(Rn=u)&&!H?Ei(s,p,(p.subtreeFlags&8772)!==0):ki(s,p),ar=x,Rn=H}break;case 30:break;default:ki(s,p)}}function Vf(s){var u=s.alternate;u!==null&&(s.alternate=null,Vf(u)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(u=s.stateNode,u!==null&&Gn(u)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function fa(s,u,p){for(p=p.child;p!==null;)tc(s,u,p),p=p.sibling}function tc(s,u,p){if(Ya&&typeof Ya.onCommitFiberUnmount=="function")try{Ya.onCommitFiberUnmount(kl,p)}catch{}switch(p.tag){case 26:if(si){Rn||_i(p,u),fa(s,u,p),p.memoizedState?Sh(p.memoizedState):p.stateNode&&bh(p.stateNode);break}case 27:if(Hn){Rn||_i(p,u);var S=ce,x=xe;Is(p.type)&&(ce=p.stateNode,xe=!1),fa(s,u,p),Eh(p.stateNode),ce=S,xe=x;break}case 5:Rn||_i(p,u);case 6:if(na){if(S=ce,x=xe,ce=null,fa(s,u,p),ce=S,xe=x,ce!==null)if(xe)try{uh(ce,p.stateNode)}catch(H){Ie(p,u,H)}else try{vc(ce,p.stateNode)}catch(H){Ie(p,u,H)}}else fa(s,u,p);break;case 18:na&&ce!==null&&(xe?h0(ce,p.stateNode):f0(ce,p.stateNode));break;case 4:na?(S=ce,x=xe,ce=p.stateNode.containerInfo,xe=!0,fa(s,u,p),ce=S,xe=x):(Xi&&qf(p.stateNode,p,hh()),fa(s,u,p));break;case 0:case 11:case 14:case 15:Rn||gi(2,p,u),Rn||gi(4,p,u),fa(s,u,p);break;case 1:Rn||(_i(p,u),S=p.stateNode,typeof S.componentWillUnmount=="function"&&If(p,u,S)),fa(s,u,p);break;case 21:fa(s,u,p);break;case 22:Rn=(S=Rn)||p.memoizedState!==null,fa(s,u,p),Rn=S;break;default:fa(s,u,p)}}function Yf(s,u){if(On&&u.memoizedState===null&&(s=u.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{c0(s)}catch(p){Ie(u,u.return,p)}}function Hd(s){switch(s.tag){case 13:case 19:var u=s.stateNode;return u===null&&(u=s.stateNode=new w0),u;case 22:return s=s.stateNode,u=s._retryCache,u===null&&(u=s._retryCache=new w0),u;default:throw Error(r(435,s.tag))}}function Kf(s,u){var p=Hd(s);u.forEach(function(S){var x=$f.bind(null,s,S);p.has(S)||(p.add(S),S.then(x,x))})}function Ra(s,u){var p=u.deletions;if(p!==null)for(var S=0;S<p.length;S++){var x=p[S],H=s,nt=u;if(na){var ut=nt;t:for(;ut!==null;){switch(ut.tag){case 27:if(Hn){if(Is(ut.type)){ce=ut.stateNode,xe=!1;break t}break}case 5:ce=ut.stateNode,xe=!1;break t;case 3:case 4:ce=ut.stateNode.containerInfo,xe=!0;break t}ut=ut.return}if(ce===null)throw Error(r(160));tc(H,nt,x),ce=null,xe=!1}else tc(H,nt,x);H=x.alternate,H!==null&&(H.return=null),x.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Id(u,s),u=u.sibling}function Id(s,u){var p=s.alternate,S=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ra(u,s),xa(s),S&4&&(gi(3,s,s.return),ca(3,s),gi(5,s,s.return));break;case 1:Ra(u,s),xa(s),S&512&&(Rn||p===null||_i(p,p.return)),S&64&&ar&&(s=s.updateQueue,s!==null&&(S=s.callbacks,S!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?S:p.concat(S))));break;case 26:if(si){var x=ve;if(Ra(u,s),xa(s),S&512&&(Rn||p===null||_i(p,p.return)),S&4){S=p!==null?p.memoizedState:null;var H=s.memoizedState;p===null?H===null?s.stateNode===null?s.stateNode=m0(x,s.type,s.memoizedProps,s):Oc(x,s.type,s.stateNode):s.stateNode=wc(x,H,s.memoizedProps):S!==H?(S===null?p.stateNode!==null&&bh(p.stateNode):Sh(S),H===null?Oc(x,s.type,s.stateNode):wc(x,H,s.memoizedProps)):H===null&&s.stateNode!==null&&kf(s,s.memoizedProps,p.memoizedProps)}break}case 27:if(Hn){Ra(u,s),xa(s),S&512&&(Rn||p===null||_i(p,p.return)),p!==null&&S&4&&kf(s,s.memoizedProps,p.memoizedProps);break}case 5:if(Ra(u,s),xa(s),S&512&&(Rn||p===null||_i(p,p.return)),na){if(s.flags&32){x=s.stateNode;try{Wi(x)}catch(Pt){Ie(s,s.return,Pt)}}S&4&&s.stateNode!=null&&(x=s.memoizedProps,kf(s,x,p!==null?p.memoizedProps:x)),S&1024&&(zc=!0)}break;case 6:if(Ra(u,s),xa(s),S&4&&na){if(s.stateNode===null)throw Error(r(162));S=s.memoizedProps,p=p!==null?p.memoizedProps:S,x=s.stateNode;try{oh(x,p,S)}catch(Pt){Ie(s,s.return,Pt)}}break;case 3:if(si?(kg(),x=ve,ve=Ac(u.containerInfo),Ra(u,s),ve=x):Ra(u,s),xa(s),S&4){if(na&&On&&p!==null&&p.memoizedState.isDehydrated)try{u0(u.containerInfo)}catch(Pt){Ie(s,s.return,Pt)}if(Xi){S=u.containerInfo,p=u.pendingChildren;try{Sc(S,p)}catch(Pt){Ie(s,s.return,Pt)}}}zc&&(zc=!1,Qf(s));break;case 4:si?(p=ve,ve=Ac(s.stateNode.containerInfo),Ra(u,s),xa(s),ve=p):(Ra(u,s),xa(s)),S&4&&Xi&&qf(s.stateNode,s,s.stateNode.pendingChildren);break;case 12:Ra(u,s),xa(s);break;case 13:Ra(u,s),xa(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(sl=li()),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Kf(s,S)));break;case 22:x=s.memoizedState!==null;var nt=p!==null&&p.memoizedState!==null,ut=ar,_t=Rn;if(ar=ut||x,Rn=_t||nt,Ra(u,s),Rn=_t,ar=ut,xa(s),S&8192&&(u=s.stateNode,u._visibility=x?u._visibility&-2:u._visibility|1,x&&(p===null||nt||ar||Rn||ha(s)),na)){t:if(p=null,na)for(u=s;;){if(u.tag===5||si&&u.tag===26){if(p===null){nt=p=u;try{H=nt.stateNode,x?yc(H):fh(nt.stateNode,nt.memoizedProps)}catch(Pt){Ie(nt,nt.return,Pt)}}}else if(u.tag===6){if(p===null){nt=u;try{var jt=nt.stateNode;x?ch(jt):Fd(jt,nt.memoizedProps)}catch(Pt){Ie(nt,nt.return,Pt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===s)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break t;for(;u.sibling===null;){if(u.return===null||u.return===s)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}S&4&&(S=s.updateQueue,S!==null&&(p=S.retryQueue,p!==null&&(S.retryQueue=null,Kf(s,p))));break;case 19:Ra(u,s),xa(s),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,Kf(s,S)));break;case 30:break;case 21:break;default:Ra(u,s),xa(s)}}function xa(s){var u=s.flags;if(u&2){try{if(na){for(var p,S=s.return;S!==null;){if(As(S)){p=S;break}S=S.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:if(Hn){var x=p.stateNode,H=Bo(s);Rl(s,H,x);break}case 5:var nt=p.stateNode;p.flags&32&&(Wi(nt),p.flags&=-33);var ut=Bo(s);Rl(s,ut,nt);break;case 3:case 4:var _t=p.stateNode.containerInfo,jt=Bo(s);ws(s,jt,_t);break;default:throw Error(r(161))}}}catch(Pt){Ie(s,s.return,Pt)}s.flags&=-3}u&4096&&(s.flags&=-4097)}function Qf(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var u=s;Qf(u),u.tag===5&&u.flags&1024&&Ps(u.stateNode),s=s.sibling}}function ki(s,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)$u(s,u.alternate,u),u=u.sibling}function ha(s){for(s=s.child;s!==null;){var u=s;switch(u.tag){case 0:case 11:case 14:case 15:gi(4,u,u.return),ha(u);break;case 1:_i(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&If(u,u.return,p),ha(u);break;case 27:Hn&&Eh(u.stateNode);case 26:case 5:_i(u,u.return),ha(u);break;case 22:u.memoizedState===null&&ha(u);break;case 30:ha(u);break;default:ha(u)}s=s.sibling}}function Ei(s,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var S=u.alternate,x=s,H=u,nt=H.flags;switch(H.tag){case 0:case 11:case 15:Ei(x,H,p),ca(4,H);break;case 1:if(Ei(x,H,p),S=H,x=S.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(jt){Ie(S,S.return,jt)}if(S=H,x=S.updateQueue,x!==null){var ut=S.stateNode;try{var _t=x.shared.hiddenCallbacks;if(_t!==null)for(x.shared.hiddenCallbacks=null,x=0;x<_t.length;x++)ys(_t[x],ut)}catch(jt){Ie(S,S.return,jt)}}p&&nt&64&&Hf(H),Ol(H,H.return);break;case 27:Hn&&Fr(H);case 26:case 5:Ei(x,H,p),p&&S===null&&nt&4&&Wu(H),Ol(H,H.return);break;case 12:Ei(x,H,p);break;case 13:Ei(x,H,p),p&&nt&4&&Yf(x,H);break;case 22:H.memoizedState===null&&Ei(x,H,p),Ol(H,H.return);break;case 30:break;default:Ei(x,H,p)}u=u.sibling}}function Ia(s,u){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(s=u.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&Ye(p))}function Jr(s,u){s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&Ye(s))}function pi(s,u,p,S){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)zo(s,u,p,S),u=u.sibling}function zo(s,u,p,S){var x=u.flags;switch(u.tag){case 0:case 11:case 15:pi(s,u,p,S),x&2048&&ca(9,u);break;case 1:pi(s,u,p,S);break;case 3:pi(s,u,p,S),x&2048&&(s=null,u.alternate!==null&&(s=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==s&&(u.refCount++,s!=null&&Ye(s)));break;case 12:if(x&2048){pi(s,u,p,S),s=u.stateNode;try{var H=u.memoizedProps,nt=H.id,ut=H.onPostCommit;typeof ut=="function"&&ut(nt,u.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(_t){Ie(u,u.return,_t)}}else pi(s,u,p,S);break;case 13:pi(s,u,p,S);break;case 23:break;case 22:H=u.stateNode,nt=u.alternate,u.memoizedState!==null?H._visibility&2?pi(s,u,p,S):Os(s,u):H._visibility&2?pi(s,u,p,S):(H._visibility|=2,pr(s,u,p,S,(u.subtreeFlags&10256)!==0)),x&2048&&Ia(nt,u);break;case 24:pi(s,u,p,S),x&2048&&Jr(u.alternate,u);break;default:pi(s,u,p,S)}}function pr(s,u,p,S,x){for(x=x&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var H=s,nt=u,ut=p,_t=S,jt=nt.flags;switch(nt.tag){case 0:case 11:case 15:pr(H,nt,ut,_t,x),ca(8,nt);break;case 23:break;case 22:var Pt=nt.stateNode;nt.memoizedState!==null?Pt._visibility&2?pr(H,nt,ut,_t,x):Os(H,nt):(Pt._visibility|=2,pr(H,nt,ut,_t,x)),x&&jt&2048&&Ia(nt.alternate,nt);break;case 24:pr(H,nt,ut,_t,x),x&&jt&2048&&Jr(nt.alternate,nt);break;default:pr(H,nt,ut,_t,x)}u=u.sibling}}function Os(s,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=s,S=u,x=S.flags;switch(S.tag){case 22:Os(p,S),x&2048&&Ia(S.alternate,S);break;case 24:Os(p,S),x&2048&&Jr(S.alternate,S);break;default:Os(p,S)}u=u.sibling}}function ei(s){if(s.subtreeFlags&Oe)for(s=s.child;s!==null;)Xf(s),s=s.sibling}function Xf(s){switch(s.tag){case 26:ei(s),s.flags&Oe&&(s.memoizedState!==null?Zo(ve,s.memoizedState,s.memoizedProps):on(s.type,s.memoizedProps));break;case 5:ei(s),s.flags&Oe&&on(s.type,s.memoizedProps);break;case 3:case 4:if(si){var u=ve;ve=Ac(s.stateNode.containerInfo),ei(s),ve=u}else ei(s);break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Oe,Oe=16777216,ei(s),Oe=u):ei(s));break;default:ei(s)}}function Lo(s){var u=s.alternate;if(u!==null&&(s=u.child,s!==null)){u.child=null;do u=s.sibling,s.sibling=null,s=u;while(s!==null)}}function qi(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];ra=S,ec(S,s)}Lo(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)kd(s),s=s.sibling}function kd(s){switch(s.tag){case 0:case 11:case 15:qi(s),s.flags&2048&&gi(9,s,s.return);break;case 3:qi(s);break;case 12:qi(s);break;case 22:var u=s.stateNode;s.memoizedState!==null&&u._visibility&2&&(s.return===null||s.return.tag!==13)?(u._visibility&=-3,Ea(s)):qi(s);break;default:qi(s)}}function Ea(s){var u=s.deletions;if((s.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var S=u[p];ra=S,ec(S,s)}Lo(s)}for(s=s.child;s!==null;){switch(u=s,u.tag){case 0:case 11:case 15:gi(8,u,u.return),Ea(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,Ea(u));break;default:Ea(u)}s=s.sibling}}function ec(s,u){for(;ra!==null;){var p=ra;switch(p.tag){case 0:case 11:case 15:gi(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var S=p.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:Ye(p.memoizedState.cache)}if(S=p.child,S!==null)S.return=p,ra=S;else t:for(p=s;ra!==null;){S=ra;var x=S.sibling,H=S.return;if(Vf(S),S===p){ra=null;break t}if(x!==null){x.return=H,ra=x;break t}ra=H}}}function Ci(s){var u=mi(s);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(r(364));return u}if(s=Gg(s),s===null)throw Error(r(362));return s.stateNode.current}function nc(s,u){var p=s.tag;switch(u.$$typeof){case Ta:if(s.type===u.value)return!0;break;case Mi:t:{for(u=u.value,s=[s,0],p=0;p<s.length;){var S=s[p++],x=S.tag,H=s[p++],nt=u[H];if(x!==5&&x!==26&&x!==27||!Hs(S)){for(;nt!=null&&nc(S,nt);)H++,nt=u[H];if(H===u.length){u=!0;break t}else for(S=S.child;S!==null;)s.push(S,H),S=S.sibling}}u=!1}return u;case Nr:if((p===5||p===26||p===27)&&Qd(s.stateNode,u.value))return!0;break;case Si:if((p===5||p===6||p===26||p===27)&&(s=rh(s),s!==null&&0<=s.indexOf(u.value)))return!0;break;case Kl:if((p===5||p===26||p===27)&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Nl(s){switch(s.$$typeof){case Ta:return"<"+(C(s.value)||"Unknown")+">";case Mi:return":has("+(Nl(s)||"")+")";case Nr:return'[role="'+s.value+'"]';case Si:return'"'+s.value+'"';case Kl:return'[data-testname="'+s.value+'"]';default:throw Error(r(365))}}function Zr(s,u){var p=[];s=[s,0];for(var S=0;S<s.length;){var x=s[S++],H=x.tag,nt=s[S++],ut=u[nt];if(H!==5&&H!==26&&H!==27||!Hs(x)){for(;ut!=null&&nc(x,ut);)nt++,ut=u[nt];if(nt===u.length)p.push(x);else for(x=x.child;x!==null;)s.push(x,nt),x=x.sibling}}return p}function Go(s,u){if(!Zi)throw Error(r(363));s=Ci(s),s=Zr(s,u),u=[],s=Array.from(s);for(var p=0;p<s.length;){var S=s[p++],x=S.tag;if(x===5||x===26||x===27)Hs(S)||u.push(S.stateNode);else for(S=S.child;S!==null;)s.push(S),S=S.sibling}return u}function ka(){if((Re&2)!==0&&Ne!==0)return Ne&-Ne;if(oe.T!==null){var s=er;return s!==0?s:Bt()}return ss()}function ac(){ya===0&&(ya=(Ne&536870912)===0||Fe?G():536870912);var s=ci.current;return s!==null&&(s.flags|=32),ya}function qa(s,u,p){(s===hn&&(Ke===2||Ke===9)||s.cancelPendingCommit!==null)&&(da(s,0),Ti(s,Ne,ya,!1)),T(s,p),((Re&2)===0||s!==hn)&&(s===hn&&((Re&2)===0&&(Cn|=p),En===4&&Ti(s,Ne,ya,!1)),Ue(s))}function ni(s,u,p){if((Re&6)!==0)throw Error(r(327));var S=!p&&(u&124)===0&&(u&s.expiredLanes)===0||D(s,u),x=S?qd(s,u):Po(s,u,!0),H=S;do{if(x===0){Mr&&!S&&Ti(s,u,0,!1);break}else{if(p=s.current.alternate,H&&!Ml(p)){x=Po(s,u,!1),H=!1;continue}if(x===2){if(H=u,s.errorRecoveryDisabledLanes&H)var nt=0;else nt=s.pendingLanes&-536870913,nt=nt!==0?nt:nt&536870912?536870912:0;if(nt!==0){u=nt;t:{var ut=s;x=rl;var _t=On&&ut.current.memoizedState.isDehydrated;if(_t&&(da(ut,nt).flags|=256),nt=Po(ut,nt,!1),nt!==2){if(Lc&&!_t){ut.errorRecoveryDisabledLanes|=H,Cn|=H,x=4;break t}H=Aa,Aa=x,H!==null&&(Aa===null?Aa=H:Aa.push.apply(Aa,H))}x=nt}if(H=!1,x!==2)continue}}if(x===1){da(s,0),Ti(s,u,0,!0);break}t:{switch(S=s,H=x,H){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:Ti(S,u,ya,!ir);break t;case 2:Aa=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(x=sl+300-li(),10<x)){if(Ti(S,u,ya,!ir),L(S,0,!0)!==0)break t;S.timeoutHandle=Kd(Rs.bind(null,S,p,Aa,wa,Gc,u,ya,Cn,Fa,ir,H,2,-0,0),x);break t}Rs(S,p,Aa,wa,Gc,u,ya,Cn,Fa,ir,H,0,-0,0)}}break}while(!0);Ue(s)}function Rs(s,u,p,S,x,H,nt,ut,_t,jt,Pt,Zt,Wt,Te){if(s.timeoutHandle=Ki,Zt=u.subtreeFlags,(Zt&8192||(Zt&16785408)===16785408)&&(Ce(),Xf(u),Zt=Jn(),Zt!==null)){s.cancelPendingCommit=Zt(vr.bind(null,s,u,H,p,S,x,nt,ut,_t,Pt,1,Wt,Te)),Ti(s,H,nt,!jt);return}vr(s,u,H,p,S,x,nt,ut,_t)}function Ml(s){for(var u=s;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var S=0;S<p.length;S++){var x=p[S],H=x.getSnapshot;x=x.value;try{if(!ja(H(),x))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Ti(s,u,p,S){u&=~rr,u&=~Cn,s.suspendedLanes|=u,s.pingedLanes&=~u,S&&(s.warmLanes|=u),S=s.expirationTimes;for(var x=u;0<x;){var H=31-Da(x),nt=1<<H;S[H]=-1,x&=~nt}p!==0&&B(s,p,u)}function Dl(){return(Re&6)===0?(ft(0),!1):!0}function Va(){if(he!==null){if(Ke===0)var s=he.return;else s=he,ma=us=null,fr(s),Xa=null,el=0,s=he;for(;s!==null;)Pd(s.alternate,s),s=s.return;he=null}}function da(s,u){var p=s.timeoutHandle;p!==Ki&&(s.timeoutHandle=Ki,Pl(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Va(),hn=s,he=p=bn(s.current,null),Ne=u,Ke=0,vn=null,ir=!1,Mr=D(s,u),Lc=!1,Fa=ya=rr=Cn=za=En=0,Aa=rl=null,Gc=!1,(u&8)!==0&&(u|=u&32);var S=s.entangledLanes;if(S!==0)for(s=s.entanglements,S&=u;0<S;){var x=31-Da(S),H=1<<x;u|=s[x],S&=~H}return bi=u,Lt(),p}function mr(s,u){ue=null,oe.H=va,u===Xs||u===Fs?(u=Gi(),Ke=3):u===au?(u=Gi(),Ke=4):Ke=u===jh?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,vn=u,he===null&&(En=1,Tl(s,F(u,s.current)))}function Ai(){var s=ci.current;return s===null?!0:(Ne&4194048)===Ne?Ba===null:(Ne&62914560)===Ne||(Ne&536870912)!==0?s===Ba:!1}function wi(){var s=oe.H;return oe.H=va,s===null?va:s}function Vi(){var s=oe.A;return oe.A=un,s}function ic(){En=4,ir||(Ne&4194048)!==Ne&&ci.current!==null||(Mr=!0),(za&134217727)===0&&(Cn&134217727)===0||hn===null||Ti(hn,Ne,ya,!1)}function Po(s,u,p){var S=Re;Re|=2;var x=wi(),H=Vi();(hn!==s||Ne!==u)&&(wa=null,da(s,u)),u=!1;var nt=En;t:do try{if(Ke!==0&&he!==null){var ut=he,_t=vn;switch(Ke){case 8:Va(),nt=6;break t;case 3:case 2:case 9:case 6:ci.current===null&&(u=!0);var jt=Ke;if(Ke=0,vn=null,ai(s,ut,_t,jt),p&&Mr){nt=0;break t}break;default:jt=Ke,Ke=0,vn=null,ai(s,ut,_t,jt)}}Ff(),nt=En;break}catch(Pt){mr(s,Pt)}while(!0);return u&&s.shellSuspendCounter++,ma=us=null,Re=S,oe.H=x,oe.A=H,he===null&&(hn=null,Ne=0,Lt()),nt}function Ff(){for(;he!==null;)gn(he)}function qd(s,u){var p=Re;Re|=2;var S=wi(),x=Vi();hn!==s||Ne!==u?(wa=null,ll=li()+500,da(s,u)):Mr=D(s,u);t:do try{if(Ke!==0&&he!==null){u=he;var H=vn;e:switch(Ke){case 1:Ke=0,vn=null,ai(s,u,H,1);break;case 2:case 9:if(Ga(H)){Ke=0,vn=null,Ge(u);break}u=function(){Ke!==2&&Ke!==9||hn!==s||(Ke=7),Ue(s)},H.then(u,u);break t;case 3:Ke=7;break t;case 4:Ke=5;break t;case 7:Ga(H)?(Ke=0,vn=null,Ge(u)):(Ke=0,vn=null,ai(s,u,H,7));break;case 5:var nt=null;switch(he.tag){case 26:nt=he.memoizedState;case 5:case 27:var ut=he,_t=ut.type,jt=ut.pendingProps;if(nt?_h(nt):Ji(_t,jt)){Ke=0,vn=null;var Pt=ut.sibling;if(Pt!==null)he=Pt;else{var Zt=ut.return;Zt!==null?(he=Zt,Na(Zt)):he=null}break e}}Ke=0,vn=null,ai(s,u,H,5);break;case 6:Ke=0,vn=null,ai(s,u,H,6);break;case 8:Va(),En=6;break t;default:throw Error(r(462))}}ga();break}catch(Wt){mr(s,Wt)}while(!0);return ma=us=null,oe.H=S,oe.A=x,Re=p,he!==null?0:(hn=null,Ne=0,Lt(),En)}function ga(){for(;he!==null&&!xc();)gn(he)}function gn(s){var u=wl(s.alternate,s,bi);s.memoizedProps=s.pendingProps,u===null?Na(s):he=u}function Ge(s){var u=s,p=u.alternate;switch(u.tag){case 15:case 0:u=Vu(p,u,u.pendingProps,u.type,void 0,Ne);break;case 11:u=Vu(p,u,u.pendingProps,u.type.render,u.ref,Ne);break;case 5:fr(u);default:Pd(p,u),u=he=Ho(u,bi),u=wl(p,u,bi)}s.memoizedProps=s.pendingProps,u===null?Na(s):he=u}function ai(s,u,p,S){ma=us=null,fr(u),Xa=null,el=0;var x=u.return;try{if(Bg(s,x,u,p,Ne)){En=1,Tl(s,F(p,s.current)),he=null;return}}catch(H){if(x!==null)throw he=x,H;En=1,Tl(s,F(p,s.current)),he=null;return}u.flags&32768?(Fe||S===1?s=!0:Mr||(Ne&536870912)!==0?s=!1:(ir=s=!0,(S===2||S===9||S===3||S===6)&&(S=ci.current,S!==null&&S.tag===13&&(S.flags|=16384))),rc(u,s)):Na(u)}function Na(s){var u=s;do{if((u.flags&32768)!==0){rc(u,ir);return}s=u.return;var p=zg(u.alternate,u,bi);if(p!==null){he=p;return}if(u=u.sibling,u!==null){he=u;return}he=u=s}while(u!==null);En===0&&(En=5)}function rc(s,u){do{var p=Lg(s.alternate,s);if(p!==null){p.flags&=32767,he=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(s=s.sibling,s!==null)){he=s;return}he=s=p}while(s!==null);En=6,he=null}function vr(s,u,p,S,x,H,nt,ut,_t){s.cancelPendingCommit=null;do Ns();while(nn!==0);if((Re&6)!==0)throw Error(r(327));if(u!==null){if(u===s.current)throw Error(r(177));if(H=u.lanes|u.childLanes,H|=Bc,y(s,p,H,nt,ut,_t),s===hn&&(he=hn=null,Ne=0),ol=u,jr=s,Ql=p,sr=H,Xl=x,Pc=S,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ul(Th,function(){return jl(),null})):(s.callbackNode=null,s.callbackPriority=0),S=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||S){S=oe.T,oe.T=null,x=Fi(),Fn(2),nt=Re,Re|=4;try{xl(s,u,p)}finally{Re=nt,Fn(x),oe.T=S}}nn=1,Jf(),Zf(),xs()}}function Jf(){if(nn===1){nn=0;var s=jr,u=ol,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=oe.T,oe.T=null;var S=Fi();Fn(2);var x=Re;Re|=4;try{Id(u,s),Qo(s.containerInfo)}finally{Re=x,Fn(S),oe.T=p}}s.current=u,nn=2}}function Zf(){if(nn===2){nn=0;var s=jr,u=ol,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=oe.T,oe.T=null;var S=Fi();Fn(2);var x=Re;Re|=4;try{$u(s,u.alternate,u)}finally{Re=x,Fn(S),oe.T=p}}nn=3}}function xs(){if(nn===4||nn===3){nn=0,_0();var s=jr,u=ol,p=Ql,S=Pc;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?nn=5:(nn=0,ol=jr=null,Wr(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(Dr=null),Q(p),u=u.stateNode,Ya&&typeof Ya.onCommitFiberRoot=="function")try{Ya.onCommitFiberRoot(kl,u,void 0,(u.current.flags&128)===128)}catch{}if(S!==null){u=oe.T,x=Fi(),Fn(2),oe.T=null;try{for(var H=s.onRecoverableError,nt=0;nt<S.length;nt++){var ut=S[nt];H(ut.value,{componentStack:ut.stack})}}finally{oe.T=u,Fn(x)}}(Ql&3)!==0&&Ns(),Ue(s),x=s.pendingLanes,(p&4194090)!==0&&(x&42)!==0?s===Hc?lr++:(lr=0,Hc=s):lr=0,ft(0)}}function Wr(s,u){(s.pooledCacheLanes&=u)===0&&(u=s.pooledCache,u!=null&&(s.pooledCache=null,Ye(u)))}function Ns(s){return Jf(),Zf(),xs(),jl()}function jl(){if(nn!==5)return!1;var s=jr,u=sr;sr=0;var p=Q(Ql),S=32>p?32:p;p=oe.T;var x=Fi();try{Fn(S),oe.T=null,S=Xl,Xl=null;var H=jr,nt=Ql;if(nn=0,ol=jr=null,Ql=0,(Re&6)!==0)throw Error(r(331));var ut=Re;if(Re|=4,kd(H.current),zo(H,H.current,nt,S),Re=ut,ft(0,!1),Ya&&typeof Ya.onPostCommitFiberRoot=="function")try{Ya.onPostCommitFiberRoot(kl,H)}catch{}return!0}finally{Fn(x),oe.T=p,Wr(s,u)}}function sc(s,u,p){u=F(p,u),u=jf(s.stateNode,u,2),s=je(s,u,2),s!==null&&(T(s,2),Ue(s))}function Ie(s,u,p){if(s.tag===3)sc(s,s,p);else for(;u!==null;){if(u.tag===3){sc(u,s,p);break}else if(u.tag===1){var S=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Dr===null||!Dr.has(S))){s=F(p,s),p=Nd(2),S=je(u,p,2),S!==null&&(Uf(p,S,u,s),T(S,2),Ue(S));break}}u=u.return}}function Oi(s,u,p){var S=s.pingCache;if(S===null){S=s.pingCache=new hs;var x=new Set;S.set(u,x)}else x=S.get(u),x===void 0&&(x=new Set,S.set(u,x));x.has(p)||(Lc=!0,x.add(p),s=$r.bind(null,s,u,p),u.then(s,s))}function $r(s,u,p){var S=s.pingCache;S!==null&&S.delete(u),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,hn===s&&(Ne&p)===p&&(En===4||En===3&&(Ne&62914560)===Ne&&300>li()-sl?(Re&2)===0&&da(s,0):rr|=p,Fa===Ne&&(Fa=0)),Ue(s)}function Yi(s,u){u===0&&(u=R()),s=ae(s,u),s!==null&&(T(s,u),Ue(s))}function Wf(s){var u=s.memoizedState,p=0;u!==null&&(p=u.retryLane),Yi(s,p)}function $f(s,u){var p=0;switch(s.tag){case 13:var S=s.stateNode,x=s.memoizedState;x!==null&&(p=x.retryLane);break;case 19:S=s.stateNode;break;case 22:S=s.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(u),Yi(s,p)}function Ul(s,u){return eu(s,u)}function lc(s,u,p,S){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function bn(s,u){var p=s.alternate;return p===null?(p=n(s.tag,u,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=u,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,u=s.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Ho(s,u){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,u=p.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),s}function Io(s,u,p,S,x,H){var nt=0;if(S=s,typeof s=="function")yr(s)&&(nt=1);else if(typeof s=="string")nt=si&&Hn?yh(s,p,$n.current)?26:Il(s)?27:5:si?yh(s,p,$n.current)?26:5:Hn&&Il(s)?27:5;else t:switch(s){case es:return s=n(31,p,u,x),s.elementType=es,s.lanes=H,s;case Us:return Ms(p.children,x,H,u);case Bs:nt=8,x|=24;break;case ko:return s=n(12,p,u,x|2),s.elementType=ko,s.lanes=H,s;case _r:return s=n(13,p,u,x),s.elementType=_r,s.lanes=H,s;case Er:return s=n(19,p,u,x),s.elementType=Er,s.lanes=H,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case fc:case br:nt=10;break t;case qo:nt=9;break t;case hc:nt=11;break t;case dc:nt=14;break t;case Cr:nt=16,S=null;break t}nt=29,p=Error(r(130,s===null?"null":typeof s,"")),S=null}return u=n(nt,p,u,x),u.elementType=s,u.type=S,u.lanes=H,u}function Ms(s,u,p,S){return s=n(7,s,S,u),s.lanes=p,s}function th(s,u,p){return s=n(6,s,null,u),s.lanes=p,s}function eh(s,u,p){return u=n(4,s.children!==null?s.children:[],s.key,u),u.lanes=p,u.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},u}function Xn(s,u,p,S,x,H,nt,ut){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ki,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=A(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=A(0),this.hiddenUpdates=A(null),this.identifierPrefix=S,this.onUncaughtError=x,this.onCaughtError=H,this.onRecoverableError=nt,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ut,this.incompleteTransitions=new Map}function oc(s,u,p,S,x,H,nt,ut,_t,jt,Pt,Zt){return s=new Xn(s,u,p,nt,ut,_t,jt,Zt),u=1,H===!0&&(u|=24),H=n(3,null,null,u),s.current=H,H.stateNode=s,u=De(),u.refCount++,s.pooledCache=u,u.refCount++,H.memoizedState={element:S,isDehydrated:p,cache:u},Kn(H),s}function Bl(s){return s?(s=ls,s):ls}function zl(s){var u=s._reactInternals;if(u===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(u),s=s!==null?g(s):null,s===null?null:Gs(s.stateNode)}function uc(s,u,p,S,x,H){x=Bl(x),S.context===null?S.context=x:S.pendingContext=x,S=Ut(u),S.payload={element:p},H=H===void 0?null:H,H!==null&&(S.callback=H),p=je(s,S,u),p!==null&&(qa(p,s,u),en(p,s,u))}function Ds(s,u){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<u?p:u}}function ts(s,u){Ds(s,u),(s=s.alternate)&&Ds(s,u)}var Le={},Vd=Eg(),ii=V6(),cc=Object.assign,js=Symbol.for("react.element"),Ll=Symbol.for("react.transitional.element"),Sr=Symbol.for("react.portal"),Us=Symbol.for("react.fragment"),Bs=Symbol.for("react.strict_mode"),ko=Symbol.for("react.profiler"),fc=Symbol.for("react.provider"),qo=Symbol.for("react.consumer"),br=Symbol.for("react.context"),hc=Symbol.for("react.forward_ref"),_r=Symbol.for("react.suspense"),Er=Symbol.for("react.suspense_list"),dc=Symbol.for("react.memo"),Cr=Symbol.for("react.lazy"),es=Symbol.for("react.activity"),Vo=Symbol.for("react.memo_cache_sentinel"),Yo=Symbol.iterator,Ko=Symbol.for("react.client.reference"),zs=Array.isArray,oe=Vd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ls=t.rendererVersion,Yd=t.rendererPackageName,Tr=t.extraDevToolsConfig,Gs=t.getPublicInstance,nh=t.getRootHostContext,ns=t.getChildHostContext,as=t.prepareForCommit,Qo=t.resetAfterCommit,ah=t.createInstance;t.cloneMutableInstance;var Xo=t.appendInitialChild,Gl=t.finalizeInitialChildren,is=t.shouldSetTextContent,ih=t.createTextInstance;t.cloneMutableTextInstance;var Kd=t.scheduleTimeout,Pl=t.cancelTimeout,Ki=t.noTimeout,Qi=t.isPrimaryRenderer;t.warnsIfNotActing;var na=t.supportsMutation,Xi=t.supportsPersistence,On=t.supportsHydration,mi=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var rs=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var Fn=t.setCurrentUpdatePriority,Fi=t.getCurrentUpdatePriority,ss=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var ri=t.shouldAttemptEagerTransition,Gn=t.detachDeletedInstance;t.requestPostPaintCallback;var gc=t.maySuspendCommit,Ji=t.preloadInstance,Ce=t.startSuspendingCommit,on=t.suspendInstance;t.suspendOnActiveViewTransition;var Jn=t.waitForCommitToBeReady,Ar=t.NotPendingTransition,vi=t.HostTransitionContext,Ps=t.resetFormInstance;t.bindToConsole;var pc=t.supportsMicrotasks,Fo=t.scheduleMicrotask,Zi=t.supportsTestSelectors,Gg=t.findFiberRoot,zn=t.getBoundingRect,rh=t.getTextContent,Hs=t.isHiddenSubtree,Qd=t.matchAccessibilityRole,Xd=t.setFocusIfFocusable,Pg=t.setupIntersectionObserver,sh=t.appendChild,lh=t.appendChildToContainer,oh=t.commitTextUpdate,Ma=t.commitMount,Pn=t.commitUpdate,mc=t.insertBefore,Jo=t.insertInContainerBefore,vc=t.removeChild,uh=t.removeChildFromContainer,Wi=t.resetTextContent,yc=t.hideInstance,ch=t.hideTextInstance,fh=t.unhideInstance,Fd=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopGestureTransition,t.getCurrentGestureOffset,t.subscribeToGestureDirection,t.createViewTransitionInstance;var Jd=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var Zd=t.cloneInstance,hh=t.createContainerChildSet,dh=t.appendChildToContainerChildSet,Wd=t.finalizeContainerChildren,Sc=t.replaceContainerChildren,gh=t.cloneHiddenInstance,$d=t.cloneHiddenTextInstance,bc=t.isSuspenseInstancePending,_c=t.isSuspenseInstanceFallback,t0=t.getSuspenseInstanceFallbackErrorDetails,ph=t.registerSuspenseInstanceRetry,e0=t.canHydrateFormStateMarker,n0=t.isFormStateMarkerMatching,mh=t.getNextHydratableSibling,a0=t.getNextHydratableSiblingAfterSingleton,i0=t.getFirstHydratableChild,Hg=t.getFirstHydratableChildWithinContainer,r0=t.getFirstHydratableChildWithinSuspenseInstance,Hl=t.getFirstHydratableChildWithinSingleton,s0=t.canHydrateInstance,Ec=t.canHydrateTextInstance,Cc=t.canHydrateSuspenseInstance,l0=t.hydrateInstance,vh=t.hydrateTextInstance,Ig=t.hydrateSuspenseInstance,o0=t.getNextHydratableInstanceAfterSuspenseInstance,u0=t.commitHydratedContainer,c0=t.commitHydratedSuspenseInstance,f0=t.clearSuspenseBoundary,h0=t.clearSuspenseBoundaryFromContainer,Tc=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var d0=t.validateHydratableInstance,g0=t.validateHydratableTextInstance,si=t.supportsResources,yh=t.isHostHoistableType,Ac=t.getHoistableRoot,p0=t.getResource,wc=t.acquireResource,Sh=t.releaseResource,m0=t.hydrateHoistable,Oc=t.mountHoistable,bh=t.unmountHoistable,v0=t.createHoistableInstance,kg=t.prepareToCommitHoistables,qg=t.mayResourceSuspendCommit,_h=t.preloadResource,Zo=t.suspendResource,Hn=t.supportsSingletons,Wo=t.resolveSingletonInstance,y0=t.acquireSingletonInstance,Eh=t.releaseSingletonInstance,Il=t.isHostSingletonType,Is=t.isSingletonScope,$o=[],ks=-1,ls={},Da=Math.clz32?Math.clz32:M,S0=Math.log,b0=Math.LN2,$i=256,tu=4194304,eu=ii.unstable_scheduleCallback,Rc=ii.unstable_cancelCallback,xc=ii.unstable_shouldYield,_0=ii.unstable_requestPaint,li=ii.unstable_now,Ch=ii.unstable_ImmediatePriority,E0=ii.unstable_UserBlockingPriority,Th=ii.unstable_NormalPriority,Ah=ii.unstable_IdlePriority,Zn=ii.log,pa=ii.unstable_setDisableYieldValue,kl=null,Ya=null,Nc,wh,qs=!1,Oh=new WeakMap,wr=[],Vs=0,Mc=null,Ys=0,Ka=[],oi=0,os=null,tr=1,Ri="",$n=E(null),Ks=E(null),Or=E(null),ql=E(null),aa=null,In=null,Fe=!1,Rr=null,xi=!1,Ni=Error(r(519)),ja=typeof Object.is=="function"?Object.is:kt,Dc=E(null),us=null,ma=null,Rh=typeof AbortController<"u"?AbortController:function(){var s=[],u=this.signal={aborted:!1,addEventListener:function(p,S){s.push(S)}};this.abort=function(){u.aborted=!0,s.forEach(function(p){return p()})}},C0=ii.unstable_scheduleCallback,jc=ii.unstable_NormalPriority,pn={$$typeof:br,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},fn=null,Vl=null,xh=!1,nu=!1,Qs=!1,ui=0,Yl=null,Uc=0,er=0,Ua=null,Nh=oe.S;oe.S=function(s,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&Se(s,u),Nh!==null&&Nh(s,u)};var xr=E(null),T0=Object.prototype.hasOwnProperty,Xs=Error(r(460)),au=Error(r(474)),Fs=Error(r(542)),iu={then:function(){}},Qa=null,We=[],cs=0,Bc=0,_n=!1,Mh=!1,Js=E(null),ru=E(0),$e=0,ue=null,Pe=null,kn=null,su=!1,Zs=!1,Ws=!1,$s=0,ia=0,Ca=null,A0=0,va={readContext:be,use:Nu,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useLayoutEffect:Dn,useInsertionEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useSyncExternalStore:Dn,useId:Dn,useHostTransitionStatus:Dn,useFormState:Dn,useActionState:Dn,useOptimistic:Dn,useMemoCache:Dn,useCacheRefresh:Dn},Dh={readContext:be,use:Nu,useCallback:function(s,u){return Wn().memoizedState=[s,u===void 0?null:u],s},useContext:be,useEffect:Rf,useImperativeHandle:function(s,u,p){p=p!=null?p.concat([s]):null,hr(4194308,4,Hi.bind(null,u,s),p)},useLayoutEffect:function(s,u){return hr(4194308,4,s,u)},useInsertionEffect:function(s,u){hr(4,2,s,u)},useMemo:function(s,u){var p=Wn();u=u===void 0?null:u;var S=s();if(Ws){K(!0);try{s()}finally{K(!1)}}return p.memoizedState=[S,u],S},useReducer:function(s,u,p){var S=Wn();if(p!==void 0){var x=p(u);if(Ws){K(!0);try{p(u)}finally{K(!1)}}}else x=u;return S.memoizedState=S.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},S.queue=s,s=s.dispatch=To.bind(null,ue,s),[S.memoizedState,s]},useRef:function(s){var u=Wn();return s={current:s},u.memoizedState=s},useState:function(s){s=bo(s);var u=s.queue,p=Td.bind(null,ue,u);return u.dispatch=p,[s.memoizedState,p]},useDebugValue:Es,useDeferredValue:function(s,u){var p=Wn();return Cl(p,s,u)},useTransition:function(){var s=bo(!1);return s=Eo.bind(null,ue,s.queue,!0,!1),Wn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,u,p){var S=ue,x=Wn();if(Fe){if(p===void 0)throw Error(r(407));p=p()}else{if(p=u(),hn===null)throw Error(r(349));(Ne&124)!==0||Du(S,u,p)}x.memoizedState=p;var H={value:p,getSnapshot:u};return x.queue=H,Rf(So.bind(null,S,H,s),[s]),S.flags|=2048,Ha(9,_l(),_f.bind(null,S,H,p,u),null),p},useId:function(){var s=Wn(),u=hn.identifierPrefix;if(Fe){var p=Ri,S=tr;p=(S&~(1<<32-Da(S)-1)).toString(32)+p,u="«"+u+"R"+p,p=$s++,0<p&&(u+="H"+p.toString(32)),u+="»"}else p=A0++,u="«"+u+"r"+p.toString(32)+"»";return s.memoizedState=u},useHostTransitionStatus:Gu,useFormState:Of,useActionState:Of,useOptimistic:function(s){var u=Wn();u.memoizedState=u.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=Ao.bind(null,ue,!0,p),p.dispatch=u,[s,u]},useMemoCache:bl,useCacheRefresh:function(){return Wn().memoizedState=Pu.bind(null,ue)}},nr={readContext:be,use:Nu,useCallback:dr,useContext:be,useEffect:Bu,useImperativeHandle:zu,useInsertionEffect:xf,useLayoutEffect:El,useMemo:Lu,useReducer:di,useRef:Uu,useState:function(){return di(hi)},useDebugValue:Es,useDeferredValue:function(s,u){var p=Qn();return Nf(p,Pe.memoizedState,s,u)},useTransition:function(){var s=di(hi)[0],u=Qn().memoizedState;return[typeof s=="boolean"?s:Sl(s),u]},useSyncExternalStore:bd,useId:Oa,useHostTransitionStatus:Gu,useFormState:ju,useActionState:ju,useOptimistic:function(s,u){var p=Qn();return Ef(p,Pe,s,u)},useMemoCache:bl,useCacheRefresh:Vr},tl={readContext:be,use:Nu,useCallback:dr,useContext:be,useEffect:Bu,useImperativeHandle:zu,useInsertionEffect:xf,useLayoutEffect:El,useMemo:Lu,useReducer:Mu,useRef:Uu,useState:function(){return Mu(hi)},useDebugValue:Es,useDeferredValue:function(s,u){var p=Qn();return Pe===null?Cl(p,s,u):Nf(p,Pe.memoizedState,s,u)},useTransition:function(){var s=Mu(hi)[0],u=Qn().memoizedState;return[typeof s=="boolean"?s:Sl(s),u]},useSyncExternalStore:bd,useId:Oa,useHostTransitionStatus:Gu,useFormState:_o,useActionState:_o,useOptimistic:function(s,u){var p=Qn();return Pe!==null?Ef(p,Pe,s,u):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:bl,useCacheRefresh:Vr},Xa=null,el=0,fs=Ad(!0),yi=Ad(!1),ci=E(null),Ba=null,Un=E(0),nl={enqueueSetState:function(s,u,p){s=s._reactInternals;var S=ka(),x=Ut(S);x.payload=u,p!=null&&(x.callback=p),u=je(s,x,S),u!==null&&(qa(u,s,S),en(u,s,S))},enqueueReplaceState:function(s,u,p){s=s._reactInternals;var S=ka(),x=Ut(S);x.tag=1,x.payload=u,p!=null&&(x.callback=p),u=je(s,x,S),u!==null&&(qa(u,s,S),en(u,s,S))},enqueueForceUpdate:function(s,u){s=s._reactInternals;var p=ka(),S=Ut(p);S.tag=2,u!=null&&(S.callback=u),u=je(s,S,p),u!==null&&(qa(u,s,p),en(u,s,p))}},al=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},jh=Error(r(461)),ta=!1,il={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},ar=!1,Rn=!1,zc=!1,w0=typeof WeakSet=="function"?WeakSet:Set,ra=null,ce=null,xe=!1,ve=null,Oe=8192,un={getCacheForType:function(s){var u=be(pn),p=u.data.get(s);return p===void 0&&(p=s(),u.data.set(s,p)),p}},Ta=0,Mi=1,Nr=2,Kl=3,Si=4;if(typeof Symbol=="function"&&Symbol.for){var mn=Symbol.for;Ta=mn("selector.component"),Mi=mn("selector.has_pseudo_class"),Nr=mn("selector.role"),Kl=mn("selector.test_id"),Si=mn("selector.text")}var hs=typeof WeakMap=="function"?WeakMap:Map,Re=0,hn=null,he=null,Ne=0,Ke=0,vn=null,ir=!1,Mr=!1,Lc=!1,bi=0,En=0,za=0,Cn=0,rr=0,ya=0,Fa=0,rl=null,Aa=null,Gc=!1,sl=0,ll=1/0,wa=null,Dr=null,nn=0,jr=null,ol=null,Ql=0,sr=0,Xl=null,Pc=null,lr=0,Hc=null;return Le.attemptContinuousHydration=function(s){if(s.tag===13){var u=ae(s,67108864);u!==null&&qa(u,s,67108864),ts(s,67108864)}},Le.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var u=ka();u=P(u);var p=ae(s,u);p!==null&&qa(p,s,u),ts(s,u)}},Le.attemptSynchronousHydration=function(s){switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var u=z(s.pendingLanes);if(u!==0){for(s.pendingLanes|=2,s.entangledLanes|=2;u;){var p=1<<31-Da(u);s.entanglements[1]|=p,u&=~p}Ue(s),(Re&6)===0&&(ll=li()+500,ft(0))}}break;case 13:u=ae(s,2),u!==null&&qa(u,s,2),Dl(),ts(s,2)}},Le.batchedUpdates=function(s,u){return s(u)},Le.createComponentSelector=function(s){return{$$typeof:Ta,value:s}},Le.createContainer=function(s,u,p,S,x,H,nt,ut,_t,jt){return oc(s,u,!1,null,p,S,H,nt,ut,_t,jt,null)},Le.createHasPseudoClassSelector=function(s){return{$$typeof:Mi,value:s}},Le.createHydrationContainer=function(s,u,p,S,x,H,nt,ut,_t,jt,Pt,Zt,Wt){return s=oc(p,S,!0,s,x,H,ut,_t,jt,Pt,Zt,Wt),s.context=Bl(null),p=s.current,S=ka(),S=P(S),x=Ut(S),x.callback=u??null,je(p,x,S),u=S,s.current.lanes=u,T(s,u),Ue(s),s},Le.createPortal=function(s,u,p){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Sr,key:S==null?null:""+S,children:s,containerInfo:u,implementation:p}},Le.createRoleSelector=function(s){return{$$typeof:Nr,value:s}},Le.createTestNameSelector=function(s){return{$$typeof:Kl,value:s}},Le.createTextSelector=function(s){return{$$typeof:Si,value:s}},Le.defaultOnCaughtError=function(s){console.error(s)},Le.defaultOnRecoverableError=function(s){al(s)},Le.defaultOnUncaughtError=function(s){al(s)},Le.deferredUpdates=function(s){var u=oe.T,p=Fi();try{return Fn(32),oe.T=null,s()}finally{Fn(p),oe.T=u}},Le.discreteUpdates=function(s,u,p,S,x){var H=oe.T,nt=Fi();try{return Fn(2),oe.T=null,s(u,p,S,x)}finally{Fn(nt),oe.T=H,Re===0&&(ll=li()+500)}},Le.findAllNodes=Go,Le.findBoundingRects=function(s,u){if(!Zi)throw Error(r(363));u=Go(s,u),s=[];for(var p=0;p<u.length;p++)s.push(zn(u[p]));for(u=s.length-1;0<u;u--){p=s[u];for(var S=p.x,x=S+p.width,H=p.y,nt=H+p.height,ut=u-1;0<=ut;ut--)if(u!==ut){var _t=s[ut],jt=_t.x,Pt=jt+_t.width,Zt=_t.y,Wt=Zt+_t.height;if(S>=jt&&H>=Zt&&x<=Pt&&nt<=Wt){s.splice(u,1);break}else if(S!==jt||p.width!==_t.width||Wt<H||Zt>nt){if(!(H!==Zt||p.height!==_t.height||Pt<S||jt>x)){jt>S&&(_t.width+=jt-S,_t.x=S),Pt<x&&(_t.width=x-jt),s.splice(u,1);break}}else{Zt>H&&(_t.height+=Zt-H,_t.y=H),Wt<nt&&(_t.height=nt-Zt),s.splice(u,1);break}}}return s},Le.findHostInstance=zl,Le.findHostInstanceWithNoPortals=function(s){return s=d(s),s=s!==null?m(s):null,s===null?null:Gs(s.stateNode)},Le.findHostInstanceWithWarning=function(s){return zl(s)},Le.flushPassiveEffects=Ns,Le.flushSyncFromReconciler=function(s){var u=Re;Re|=1;var p=oe.T,S=Fi();try{if(Fn(2),oe.T=null,s)return s()}finally{Fn(S),oe.T=p,Re=u,(Re&6)===0&&ft(0)}},Le.flushSyncWork=Dl,Le.focusWithin=function(s,u){if(!Zi)throw Error(r(363));for(s=Ci(s),u=Zr(s,u),u=Array.from(u),s=0;s<u.length;){var p=u[s++],S=p.tag;if(!Hs(p)){if((S===5||S===26||S===27)&&Xd(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},Le.getFindAllNodesFailureDescription=function(s,u){if(!Zi)throw Error(r(363));var p=0,S=[];s=[Ci(s),0];for(var x=0;x<s.length;){var H=s[x++],nt=H.tag,ut=s[x++],_t=u[ut];if((nt!==5&&nt!==26&&nt!==27||!Hs(H))&&(nc(H,_t)&&(S.push(Nl(_t)),ut++,ut>p&&(p=ut)),ut<u.length))for(H=H.child;H!==null;)s.push(H,ut),H=H.sibling}if(p<u.length){for(s=[];p<u.length;p++)s.push(Nl(u[p]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},Le.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 27:case 5:return Gs(s.child.stateNode);default:return s.child.stateNode}},Le.injectIntoDevTools=function(){var s={bundleType:0,version:Ls,rendererPackageName:Yd,currentDispatcherRef:oe,reconcilerVersion:"19.1.0"};if(Tr!==null&&(s.rendererConfig=Tr),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)s=!0;else{try{kl=u.inject(s),Ya=u}catch{}s=!!u.checkDCE}}return s},Le.isAlreadyRendering=function(){return(Re&6)!==0},Le.observeVisibleRects=function(s,u,p,S){if(!Zi)throw Error(r(363));s=Go(s,u);var x=Pg(s,p,S).disconnect;return{disconnect:function(){x()}}},Le.shouldError=function(){return null},Le.shouldSuspend=function(){return!1},Le.startHostTransition=function(s,u,p,S){if(s.tag!==5)throw Error(r(476));var x=Co(s).queue;Eo(s,x,u,Ar,p===null?a:function(){var H=Co(s).next.queue;return Cs(s,H,{},ka()),p(S)})},Le.updateContainer=function(s,u,p,S){var x=u.current,H=ka();return uc(x,H,s,u,p,S),H},Le.updateContainerSync=function(s,u,p,S){return uc(u.current,2,s,u,p,S),2},Le},o.exports.default=o.exports,Object.defineProperty(o.exports,"__esModule",{value:!0})})(jp)),jp.exports}var e1;function K6(){return e1||(e1=1,Dp.exports=Y6()),Dp.exports}var Q6=K6();const X6=df(Q6);var zp={exports:{}},cl={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function F6(){return n1||(n1=1,cl.ConcurrentRoot=1,cl.ContinuousEventPriority=8,cl.DefaultEventPriority=32,cl.DiscreteEventPriority=2,cl.IdleEventPriority=268435456,cl.LegacyRoot=0,cl.NoEventPriority=0),cl}var a1;function J6(){return a1||(a1=1,zp.exports=F6()),zp.exports}var xg=J6();const i1={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let r1=!1,s1=!1;const mg=".react-konva-event",Z6=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,W6=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,$6={};function Ng(o,t,n=$6){if(!r1&&"zIndex"in t&&(console.warn(W6),r1=!0),!s1&&t.draggable){var a=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;a&&!r&&(console.warn(Z6),s1=!0)}for(var l in n)if(!i1[l]){var c=l.slice(0,2)==="on",d=n[l]!==t[l];if(c&&d){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),o.off(g,n[l])}var m=!t.hasOwnProperty(l);m&&o.setAttr(l,void 0)}var _=t._useStrictMode,C={},E=!1;const O={};for(var l in t)if(!i1[l]){var c=l.slice(0,2)==="on",v=n[l]!==t[l];if(c&&v){var g=l.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),t[l]&&(O[g]=t[l])}!c&&(t[l]!==n[l]||_&&t[l]!==o.getAttr(l))&&(E=!0,C[l]=t[l])}E&&(o.setAttrs(C),vo(o));for(var g in O)o.off(g+mg),o.on(g+mg,O[g])}function vo(o){if(!Jt.autoDrawEnabled){var t=o.getLayer()||o.getStage();t&&t.batchDraw()}}var Lp={exports:{}},Gp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l1;function t8(){return l1||(l1=1,(function(o){function t(U,I){var F=U.length;U.push(I);t:for(;0<F;){var W=F-1>>>1,it=U[W];if(0<r(it,I))U[W]=I,U[F]=it,F=W;else break t}}function n(U){return U.length===0?null:U[0]}function a(U){if(U.length===0)return null;var I=U[0],F=U.pop();if(F!==I){U[0]=F;t:for(var W=0,it=U.length,Z=it>>>1;W<Z;){var rt=2*(W+1)-1,at=U[rt],Y=rt+1,J=U[Y];if(0>r(at,F))Y<it&&0>r(J,at)?(U[W]=J,U[Y]=F,W=Y):(U[W]=at,U[rt]=F,W=rt);else if(Y<it&&0>r(J,F))U[W]=J,U[Y]=F,W=Y;else break t}}return I}function r(U,I){var F=U.sortIndex-I.sortIndex;return F!==0?F:U.id-I.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;o.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();o.unstable_now=function(){return c.now()-d}}var g=[],m=[],_=1,C=null,E=3,O=!1,v=!1,M=!1,z=!1,L=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function G(U){for(var I=n(m);I!==null;){if(I.callback===null)a(m);else if(I.startTime<=U)a(m),I.sortIndex=I.expirationTime,t(g,I);else break;I=n(m)}}function R(U){if(M=!1,G(U),!v)if(n(g)!==null)v=!0,A||(A=!0,Q());else{var I=n(m);I!==null&&V(R,I.startTime-U)}}var A=!1,T=-1,y=5,B=-1;function j(){return z?!0:!(o.unstable_now()-B<y)}function P(){if(z=!1,A){var U=o.unstable_now();B=U;var I=!0;try{t:{v=!1,M&&(M=!1,D(T),T=-1),O=!0;var F=E;try{e:{for(G(U),C=n(g);C!==null&&!(C.expirationTime>U&&j());){var W=C.callback;if(typeof W=="function"){C.callback=null,E=C.priorityLevel;var it=W(C.expirationTime<=U);if(U=o.unstable_now(),typeof it=="function"){C.callback=it,G(U),I=!0;break e}C===n(g)&&a(g),G(U)}else a(g);C=n(g)}if(C!==null)I=!0;else{var Z=n(m);Z!==null&&V(R,Z.startTime-U),I=!1}}break t}finally{C=null,E=F,O=!1}I=void 0}}finally{I?Q():A=!1}}}var Q;if(typeof N=="function")Q=function(){N(P)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=P,Q=function(){X.postMessage(null)}}else Q=function(){L(P,0)};function V(U,I){T=L(function(){U(o.unstable_now())},I)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(U){U.callback=null},o.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<U?Math.floor(1e3/U):5},o.unstable_getCurrentPriorityLevel=function(){return E},o.unstable_next=function(U){switch(E){case 1:case 2:case 3:var I=3;break;default:I=E}var F=E;E=I;try{return U()}finally{E=F}},o.unstable_requestPaint=function(){z=!0},o.unstable_runWithPriority=function(U,I){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var F=E;E=U;try{return I()}finally{E=F}},o.unstable_scheduleCallback=function(U,I,F){var W=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,U){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=F+it,U={id:_++,callback:I,priorityLevel:U,startTime:F,expirationTime:it,sortIndex:-1},F>W?(U.sortIndex=F,t(m,U),n(g)===null&&U===n(m)&&(M?(D(T),T=-1):M=!0,V(R,F-W))):(U.sortIndex=it,t(g,U),v||O||(v=!0,A||(A=!0,Q()))),U},o.unstable_shouldYield=j,o.unstable_wrapCallback=function(U){var I=E;return function(){var F=E;E=I;try{return U.apply(this,arguments)}finally{E=F}}}})(Gp)),Gp}var o1;function e8(){return o1||(o1=1,Lp.exports=t8()),Lp.exports}var Pp=e8();const uS={},n8={};cf.Node.prototype._applyProps=Ng;let cS=xg.DefaultEventPriority;function a8(o,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}o.add(t),vo(o)}function i8(o,t,n){let a=cf[o];a||(console.error(`Konva has no node with the type ${o}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${o}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),a=cf.Group);const r={},l={};for(var c in t)if(c!=="ref"){var d=c.slice(0,2)==="on";d?l[c]=t[c]:r[c]=t[c]}const g=new a(r);return Ng(g,l),g}function r8(o,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${o}"`)}function s8(o,t,n){return!1}function l8(o){return o}function o8(){return null}function u8(){return null}function c8(o,t,n,a){return n8}function f8(){}function h8(o){}function d8(o,t){return!1}function g8(){return uS}function p8(){return uS}const m8=setTimeout,v8=clearTimeout,y8=!0,S8=o=>{o()},b8=-1;function _8(o,t){return!1}const E8=!1,C8=!1,T8=!0,A8=!1,w8=!1;function O8(o,t){t.parent===o?t.moveToTop():o.add(t),vo(o)}function R8(o,t){t.parent===o?t.moveToTop():o.add(t),vo(o)}function fS(o,t,n){t._remove(),o.add(t),t.setZIndex(n.getZIndex()),vo(o)}function x8(o,t,n){fS(o,t,n)}function N8(o,t){t.destroy(),t.off(mg),vo(o)}function M8(o,t){t.destroy(),t.off(mg),vo(o)}function D8(o,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function j8(o,t,n){}function U8(o,t,n,a){Ng(o,a,n)}function B8(o){o.hide(),vo(o)}function z8(o){}function L8(o,t){(t.visible==null||t.visible)&&o.show()}function G8(o,t){}function P8(o){}function H8(){}function I8(){return xg.DefaultEventPriority}function k8(){}function q8(){return null}function V8(o){cS=o}function Y8(){return cS}function K8(){return xg.DiscreteEventPriority}function Q8(){return!1}function X8(){}function F8(){return!1}function J8(){return!0}function Z8(){}function W8(){}function $8(){return null}const t_=null;function e_(){}const n_=Object.freeze(Object.defineProperty({__proto__:null,NotPendingTransition:t_,appendChild:O8,appendChildToContainer:R8,appendInitialChild:a8,cancelTimeout:v8,clearContainer:P8,commitMount:j8,commitTextUpdate:D8,commitUpdate:U8,createInstance:i8,createTextInstance:r8,detachDeletedInstance:H8,finalizeInitialChildren:s8,getChildHostContext:p8,getCurrentEventPriority:I8,getCurrentUpdatePriority:Y8,getInstanceFromScope:q8,getPublicInstance:l8,getRootHostContext:g8,hideInstance:B8,hideTextInstance:z8,idlePriority:Pp.unstable_IdlePriority,insertBefore:fS,insertInContainerBefore:x8,isPrimaryRenderer:E8,maySuspendCommit:F8,noTimeout:b8,now:Pp.unstable_now,preloadInstance:J8,prepareForCommit:o8,preparePortalMount:u8,prepareScopeUpdate:k8,prepareUpdate:c8,removeChild:N8,removeChildFromContainer:M8,requestPostPaintCallback:X8,resetAfterCommit:f8,resetFormInstance:e_,resetTextContent:h8,resolveUpdatePriority:K8,run:Pp.unstable_runWithPriority,scheduleMicrotask:S8,scheduleTimeout:m8,setCurrentUpdatePriority:V8,shouldAttemptEagerTransition:Q8,shouldDeprioritizeSubtree:d8,shouldSetTextContent:_8,startSuspendingCommit:Z8,supportsHydration:w8,supportsMicrotasks:y8,supportsMutation:T8,supportsPersistence:A8,suspendInstance:W8,unhideInstance:L8,unhideTextInstance:G8,waitForCommitToBeReady:$8,warnsIfNotActing:C8},Symbol.toStringTag,{value:"Module"}));function hS(o,t,n){if(!o)return;if(n(o)===!0)return o;let a=o.child;for(;a;){const r=hS(a,t,n);if(r)return r;a=a.sibling}}function dS(o){try{return Object.defineProperties(o,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return o}}const iv=dS(lt.createContext(null));class gS extends lt.Component{render(){return lt.createElement(iv.Provider,{value:this._reactInternals},this.props.children)}}function a_(){const o=lt.useContext(iv);if(o===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=lt.useId();return lt.useMemo(()=>{for(const n of[o,o==null?void 0:o.alternate]){if(!n)continue;const a=hS(n,!1,r=>{let l=r.memoizedState;for(;l;){if(l.memoizedState===t)return!0;l=l.next}});if(a)return a}},[o,t])}const i_=Symbol.for("react.context"),r_=o=>o!==null&&typeof o=="object"&&"$$typeof"in o&&o.$$typeof===i_;function s_(){const o=a_(),[t]=lt.useState(()=>new Map);t.clear();let n=o;for(;n;){const a=n.type;r_(a)&&a!==iv&&!t.has(a)&&t.set(a,lt.use(dS(a))),n=n.return}return t}function l_(){const o=s_();return lt.useMemo(()=>Array.from(o.keys()).reduce((t,n)=>a=>lt.createElement(t,null,lt.createElement(n.Provider,{...a,value:o.get(n)})),t=>lt.createElement(gS,{...t})),[o])}if(Vn.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function o_(o){const t=Vn.useRef({});return Vn.useLayoutEffect(()=>{t.current=o}),Vn.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const u_=()=>{const o=Vn.useRef(0);return Vn.useMemo(()=>{o.current++},[]),o.current>1},c_=o=>{const t=Vn.useRef(null),n=Vn.useRef(null),a=Vn.useRef(null),r=o_(o),l=l_(),c=Vn.useRef(!1),d=m=>{const{forwardedRef:_}=o;_&&(typeof _=="function"?_(m):_.current=m)},g=u_();return Vn.useLayoutEffect(()=>c.current&&g?()=>{c.current=!1,d(null),af.updateContainer(null,a.current,null),n.current.destroy()}:(c.current=!0,n.current=new cf.Stage({width:o.width,height:o.height,container:t.current}),d(n.current),a.current=af.createContainer(n.current,xg.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),af.updateContainer(Vn.createElement(l,{},o.children),a.current,null,()=>{}),()=>{g||(d(null),af.updateContainer(null,a.current,null),n.current.destroy())}),[]),Vn.useLayoutEffect(()=>{d(n.current),Ng(n.current,o,r),af.updateContainer(Vn.createElement(l,{},o.children),a.current,null)}),Vn.createElement("div",{ref:t,id:o.id,accessKey:o.accessKey,className:o.className,role:o.role,style:o.style,tabIndex:o.tabIndex,title:o.title})},Lr="Layer",fo="Line",rv="Image",af=X6(n_);af.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Vn.version,rendererPackageName:"react-konva"});const Mg=Vn.forwardRef((o,t)=>Vn.createElement(gS,{},Vn.createElement(c_,{...o,forwardedRef:t})));var Hp={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var u1;function pS(){return u1||(u1=1,(function(o,t){(function(a,r){o.exports=r()})(window,function(){return(function(n){var a={};function r(l){if(a[l])return a[l].exports;var c=a[l]={i:l,l:!1,exports:{}};return n[l].call(c.exports,c,c.exports,r),c.l=!0,c.exports}return r.m=n,r.c=a,r.d=function(l,c,d){r.o(l,c)||Object.defineProperty(l,c,{enumerable:!0,get:d})},r.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},r.t=function(l,c){if(c&1&&(l=r(l)),c&8||c&4&&typeof l=="object"&&l&&l.__esModule)return l;var d=Object.create(null);if(r.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:l}),c&2&&typeof l!="string")for(var g in l)r.d(d,g,(function(m){return l[m]}).bind(null,g));return d},r.n=function(l){var c=l&&l.__esModule?function(){return l.default}:function(){return l};return r.d(c,"a",c),c},r.o=function(l,c){return Object.prototype.hasOwnProperty.call(l,c)},r.p="",r(r.s=42)})([(function(n,a,r){r.r(a),r.d(a,"__extends",function(){return c}),r.d(a,"__assign",function(){return d}),r.d(a,"__rest",function(){return g}),r.d(a,"__decorate",function(){return m}),r.d(a,"__param",function(){return _}),r.d(a,"__metadata",function(){return C}),r.d(a,"__awaiter",function(){return E}),r.d(a,"__generator",function(){return O}),r.d(a,"__createBinding",function(){return v}),r.d(a,"__exportStar",function(){return M}),r.d(a,"__values",function(){return z}),r.d(a,"__read",function(){return L}),r.d(a,"__spread",function(){return D}),r.d(a,"__spreadArrays",function(){return N}),r.d(a,"__spreadArray",function(){return G}),r.d(a,"__await",function(){return R}),r.d(a,"__asyncGenerator",function(){return A}),r.d(a,"__asyncDelegator",function(){return T}),r.d(a,"__asyncValues",function(){return y}),r.d(a,"__makeTemplateObject",function(){return B}),r.d(a,"__importStar",function(){return P}),r.d(a,"__importDefault",function(){return Q}),r.d(a,"__classPrivateFieldGet",function(){return K}),r.d(a,"__classPrivateFieldSet",function(){return X});/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */var l=function(V,U){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var W in F)Object.prototype.hasOwnProperty.call(F,W)&&(I[W]=F[W])},l(V,U)};function c(V,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");l(V,U);function I(){this.constructor=V}V.prototype=U===null?Object.create(U):(I.prototype=U.prototype,new I)}var d=function(){return d=Object.assign||function(U){for(var I,F=1,W=arguments.length;F<W;F++){I=arguments[F];for(var it in I)Object.prototype.hasOwnProperty.call(I,it)&&(U[it]=I[it])}return U},d.apply(this,arguments)};function g(V,U){var I={};for(var F in V)Object.prototype.hasOwnProperty.call(V,F)&&U.indexOf(F)<0&&(I[F]=V[F]);if(V!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,F=Object.getOwnPropertySymbols(V);W<F.length;W++)U.indexOf(F[W])<0&&Object.prototype.propertyIsEnumerable.call(V,F[W])&&(I[F[W]]=V[F[W]]);return I}function m(V,U,I,F){var W=arguments.length,it=W<3?U:F===null?F=Object.getOwnPropertyDescriptor(U,I):F,Z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")it=Reflect.decorate(V,U,I,F);else for(var rt=V.length-1;rt>=0;rt--)(Z=V[rt])&&(it=(W<3?Z(it):W>3?Z(U,I,it):Z(U,I))||it);return W>3&&it&&Object.defineProperty(U,I,it),it}function _(V,U){return function(I,F){U(I,F,V)}}function C(V,U){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(V,U)}function E(V,U,I,F){function W(it){return it instanceof I?it:new I(function(Z){Z(it)})}return new(I||(I=Promise))(function(it,Z){function rt(J){try{Y(F.next(J))}catch(tt){Z(tt)}}function at(J){try{Y(F.throw(J))}catch(tt){Z(tt)}}function Y(J){J.done?it(J.value):W(J.value).then(rt,at)}Y((F=F.apply(V,U||[])).next())})}function O(V,U){var I={label:0,sent:function(){if(it[0]&1)throw it[1];return it[1]},trys:[],ops:[]},F,W,it,Z;return Z={next:rt(0),throw:rt(1),return:rt(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function rt(Y){return function(J){return at([Y,J])}}function at(Y){if(F)throw new TypeError("Generator is already executing.");for(;I;)try{if(F=1,W&&(it=Y[0]&2?W.return:Y[0]?W.throw||((it=W.return)&&it.call(W),0):W.next)&&!(it=it.call(W,Y[1])).done)return it;switch(W=0,it&&(Y=[Y[0]&2,it.value]),Y[0]){case 0:case 1:it=Y;break;case 4:return I.label++,{value:Y[1],done:!1};case 5:I.label++,W=Y[1],Y=[0];continue;case 7:Y=I.ops.pop(),I.trys.pop();continue;default:if(it=I.trys,!(it=it.length>0&&it[it.length-1])&&(Y[0]===6||Y[0]===2)){I=0;continue}if(Y[0]===3&&(!it||Y[1]>it[0]&&Y[1]<it[3])){I.label=Y[1];break}if(Y[0]===6&&I.label<it[1]){I.label=it[1],it=Y;break}if(it&&I.label<it[2]){I.label=it[2],I.ops.push(Y);break}it[2]&&I.ops.pop(),I.trys.pop();continue}Y=U.call(V,I)}catch(J){Y=[6,J],W=0}finally{F=it=0}if(Y[0]&5)throw Y[1];return{value:Y[0]?Y[1]:void 0,done:!0}}}var v=Object.create?(function(V,U,I,F){F===void 0&&(F=I),Object.defineProperty(V,F,{enumerable:!0,get:function(){return U[I]}})}):(function(V,U,I,F){F===void 0&&(F=I),V[F]=U[I]});function M(V,U){for(var I in V)I!=="default"&&!Object.prototype.hasOwnProperty.call(U,I)&&v(U,V,I)}function z(V){var U=typeof Symbol=="function"&&Symbol.iterator,I=U&&V[U],F=0;if(I)return I.call(V);if(V&&typeof V.length=="number")return{next:function(){return V&&F>=V.length&&(V=void 0),{value:V&&V[F++],done:!V}}};throw new TypeError(U?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(V,U){var I=typeof Symbol=="function"&&V[Symbol.iterator];if(!I)return V;var F=I.call(V),W,it=[],Z;try{for(;(U===void 0||U-- >0)&&!(W=F.next()).done;)it.push(W.value)}catch(rt){Z={error:rt}}finally{try{W&&!W.done&&(I=F.return)&&I.call(F)}finally{if(Z)throw Z.error}}return it}function D(){for(var V=[],U=0;U<arguments.length;U++)V=V.concat(L(arguments[U]));return V}function N(){for(var V=0,U=0,I=arguments.length;U<I;U++)V+=arguments[U].length;for(var F=Array(V),W=0,U=0;U<I;U++)for(var it=arguments[U],Z=0,rt=it.length;Z<rt;Z++,W++)F[W]=it[Z];return F}function G(V,U,I){if(I||arguments.length===2)for(var F=0,W=U.length,it;F<W;F++)(it||!(F in U))&&(it||(it=Array.prototype.slice.call(U,0,F)),it[F]=U[F]);return V.concat(it||Array.prototype.slice.call(U))}function R(V){return this instanceof R?(this.v=V,this):new R(V)}function A(V,U,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var F=I.apply(V,U||[]),W,it=[];return W={},Z("next"),Z("throw"),Z("return"),W[Symbol.asyncIterator]=function(){return this},W;function Z(et){F[et]&&(W[et]=function(gt){return new Promise(function(wt,Dt){it.push([et,gt,wt,Dt])>1||rt(et,gt)})})}function rt(et,gt){try{at(F[et](gt))}catch(wt){tt(it[0][3],wt)}}function at(et){et.value instanceof R?Promise.resolve(et.value.v).then(Y,J):tt(it[0][2],et)}function Y(et){rt("next",et)}function J(et){rt("throw",et)}function tt(et,gt){et(gt),it.shift(),it.length&&rt(it[0][0],it[0][1])}}function T(V){var U,I;return U={},F("next"),F("throw",function(W){throw W}),F("return"),U[Symbol.iterator]=function(){return this},U;function F(W,it){U[W]=V[W]?function(Z){return(I=!I)?{value:R(V[W](Z)),done:W==="return"}:it?it(Z):Z}:it}}function y(V){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var U=V[Symbol.asyncIterator],I;return U?U.call(V):(V=typeof z=="function"?z(V):V[Symbol.iterator](),I={},F("next"),F("throw"),F("return"),I[Symbol.asyncIterator]=function(){return this},I);function F(it){I[it]=V[it]&&function(Z){return new Promise(function(rt,at){Z=V[it](Z),W(rt,at,Z.done,Z.value)})}}function W(it,Z,rt,at){Promise.resolve(at).then(function(Y){it({value:Y,done:rt})},Z)}}function B(V,U){return Object.defineProperty?Object.defineProperty(V,"raw",{value:U}):V.raw=U,V}var j=Object.create?(function(V,U){Object.defineProperty(V,"default",{enumerable:!0,value:U})}):function(V,U){V.default=U};function P(V){if(V&&V.__esModule)return V;var U={};if(V!=null)for(var I in V)I!=="default"&&Object.prototype.hasOwnProperty.call(V,I)&&v(U,V,I);return j(U,V),U}function Q(V){return V&&V.__esModule?V:{default:V}}function K(V,U,I,F){if(I==="a"&&!F)throw new TypeError("Private accessor was defined without a getter");if(typeof U=="function"?V!==U||!F:!U.has(V))throw new TypeError("Cannot read private member from an object whose class did not declare it");return I==="m"?F:I==="a"?F.call(V):F?F.value:U.get(V)}function X(V,U,I,F,W){if(F==="m")throw new TypeError("Private method is not writable");if(F==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof U=="function"?V!==U||!W:!U.has(V))throw new TypeError("Cannot write private member to an object whose class did not declare it");return F==="a"?W.call(V,I):W?W.value=I:U.set(V,I),I}}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0}),a.allToUpperCase=a.allToLowerCase=a.encodeBody=a.decodeBody=a.Format=a.promisify=a.trim=a.arrChooseN=a.randomHexString=a.randomString=a.cheapRandStr=a.dataSizeBytes=a.inspectBody=a.inspectError=a.isErrorInfoOrPartialErrorInfo=a.now=a.parseQueryString=a.toQueryString=a.arrPopRandomElement=a.defaultPostHeaders=a.defaultGetHeaders=a.allSame=a.arrEvery=a.arrFilter=a.arrMap=a.safeArrForEach=a.arrForEach=a.forInOwnNonNullProperties=a.valuesArray=a.keysArray=a.arrWithoutValue=a.arrDeleteValue=a.arrIn=a.arrIndexOf=a.arrSubtract=a.arrIntersectOb=a.arrIntersect=a.intersect=a.containsValue=a.inherits=a.prototypicalClone=a.shallowClone=a.isEmptyArg=a.isOnlyPropIn=a.isEmpty=a.isObject=a.ensureArray=a.isArray=a.copy=a.mixin=void 0,a.arrEquals=a.toBase64=a.matchDerivedChannel=a.shallowEquals=a.getGlobalObject=a.getRetryTime=a.getJitterCoefficient=a.getBackoffCoefficient=void 0;var c=r(0),d=c.__importDefault(r(3)),g=c.__importStar(r(8)),m=c.__importDefault(r(4)),_=r(11),C=r(31);function E(ft){return Math.floor(Math.random()*ft.length)}function O(ft){for(var ct=[],ht=1;ht<arguments.length;ht++)ct[ht-1]=arguments[ht];for(var Ot=0;Ot<ct.length;Ot++){var Vt=ct[Ot];if(!Vt)break;var Ct=Object.prototype.hasOwnProperty;for(var zt in Vt)(!Ct||Ct.call(Vt,zt))&&(ft[zt]=Vt[zt])}return ft}a.mixin=O;function v(ft){return O({},ft)}a.copy=v,a.isArray=Array.isArray||function(ft){return Object.prototype.toString.call(ft)=="[object Array]"};function M(ft){return N(ft)?[]:(0,a.isArray)(ft)?ft:[ft]}a.ensureArray=M;function z(ft){return Object.prototype.toString.call(ft)=="[object Object]"}a.isObject=z;function L(ft){for(var ct in ft)return!1;return!0}a.isEmpty=L;function D(ft,ct){for(var ht in ft)if(ht!==ct)return!1;return!0}a.isOnlyPropIn=D;function N(ft){return ft==null}a.isEmptyArg=N;function G(ft){var ct=new Object;for(var ht in ft)ct[ht]=ft[ht];return ct}a.shallowClone=G;function R(ft,ct){var ht=(function(){function Vt(){}return Vt})();ht.prototype=ft;var Ot=new ht;return ct&&O(Ot,ct),Ot}a.prototypicalClone=R;var A=function(ft,ct){if(d.default.Config.inherits){d.default.Config.inherits(ft,ct);return}ft.super_=ct,ft.prototype=R(ct.prototype,{constructor:ft})};a.inherits=A;function T(ft,ct){for(var ht in ft)if(ft[ht]==ct)return!0;return!1}a.containsValue=T;function y(ft,ct){return(0,a.isArray)(ct)?B(ft,ct):j(ft,ct)}a.intersect=y;function B(ft,ct){for(var ht=[],Ot=0;Ot<ft.length;Ot++){var Vt=ft[Ot];(0,a.arrIndexOf)(ct,Vt)!=-1&&ht.push(Vt)}return ht}a.arrIntersect=B;function j(ft,ct){for(var ht=[],Ot=0;Ot<ft.length;Ot++){var Vt=ft[Ot];Vt in ct&&ht.push(Vt)}return ht}a.arrIntersectOb=j;function P(ft,ct){for(var ht=[],Ot=0;Ot<ft.length;Ot++){var Vt=ft[Ot];(0,a.arrIndexOf)(ct,Vt)==-1&&ht.push(Vt)}return ht}a.arrSubtract=P,a.arrIndexOf=Array.prototype.indexOf?function(ft,ct,ht){return ft.indexOf(ct,ht)}:function(ft,ct,ht){ht=ht||0;for(var Ot=ft.length;ht<Ot;ht++)if(ft[ht]===ct)return ht;return-1};function Q(ft,ct){return(0,a.arrIndexOf)(ft,ct)!==-1}a.arrIn=Q;function K(ft,ct){var ht=(0,a.arrIndexOf)(ft,ct),Ot=ht!=-1;return Ot&&ft.splice(ht,1),Ot}a.arrDeleteValue=K;function X(ft,ct){var ht=ft.slice();return K(ht,ct),ht}a.arrWithoutValue=X;function V(ft,ct){var ht=[];for(var Ot in ft)ct&&!Object.prototype.hasOwnProperty.call(ft,Ot)||ht.push(Ot);return ht}a.keysArray=V;function U(ft,ct){var ht=[];for(var Ot in ft)ct&&!Object.prototype.hasOwnProperty.call(ft,Ot)||ht.push(ft[Ot]);return ht}a.valuesArray=U;function I(ft,ct){for(var ht in ft)Object.prototype.hasOwnProperty.call(ft,ht)&&ft[ht]&&ct(ht)}a.forInOwnNonNullProperties=I,a.arrForEach=Array.prototype.forEach?function(ft,ct){ft.forEach(ct)}:function(ft,ct){for(var ht=ft.length,Ot=0;Ot<ht;Ot++)ct(ft[Ot],Ot,ft)};function F(ft,ct){return(0,a.arrForEach)(ft.slice(),ct)}a.safeArrForEach=F,a.arrMap=Array.prototype.map?function(ft,ct){return ft.map(ct)}:function(ft,ct){for(var ht=[],Ot=ft.length,Vt=0;Vt<Ot;Vt++)ht.push(ct(ft[Vt],Vt,ft));return ht},a.arrFilter=Array.prototype.filter?function(ft,ct){return ft.filter(ct)}:function(ft,ct){for(var ht=[],Ot=ft.length,Vt=0;Vt<Ot;Vt++)ct(ft[Vt])&&ht.push(ft[Vt]);return ht},a.arrEvery=Array.prototype.every?function(ft,ct){return ft.every(ct)}:function(ft,ct){for(var ht=ft.length,Ot=0;Ot<ht;Ot++)if(!ct(ft[Ot],Ot,ft))return!1;return!0};function W(ft,ct){if(ft.length===0)return!0;var ht=ft[0][ct];return(0,a.arrEvery)(ft,function(Ot){return Ot[ct]===ht})}a.allSame=W;var it={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function Z(ft,ct){var ht=it[ct||pe.json];return{accept:ht,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ft)}}a.defaultGetHeaders=Z;function rt(ft,ct){var ht,Ot=ht=it[ct||pe.json];return{accept:Ot,"content-type":ht,"X-Ably-Version":g.default.protocolVersion.toString(),"Ably-Agent":(0,g.getAgentString)(ft)}}a.defaultPostHeaders=rt;function at(ft){return ft.splice(E(ft),1)[0]}a.arrPopRandomElement=at;function Y(ft){var ct=[];if(ft)for(var ht in ft)ct.push(encodeURIComponent(ht)+"="+encodeURIComponent(ft[ht]));return ct.length?"?"+ct.join("&"):""}a.toQueryString=Y;function J(ft){for(var ct,ht=/([^?&=]+)=?([^&]*)/g,Ot={};ct=ht.exec(ft);)Ot[decodeURIComponent(ct[1])]=decodeURIComponent(ct[2]);return Ot}a.parseQueryString=J,a.now=Date.now||function(){return new Date().getTime()};function tt(ft){return typeof ft=="object"&&ft!==null&&(ft.constructor.name=="ErrorInfo"||ft.constructor.name=="PartialErrorInfo")}a.isErrorInfoOrPartialErrorInfo=tt;function et(ft){var ct,ht;return ft instanceof Error||((ct=ft==null?void 0:ft.constructor)===null||ct===void 0?void 0:ct.name)==="ErrorInfo"||((ht=ft==null?void 0:ft.constructor)===null||ht===void 0?void 0:ht.name)==="PartialErrorInfo"?ft.toString():d.default.Config.inspect(ft)}a.inspectError=et;function gt(ft){return d.default.BufferUtils.isBuffer(ft)?ft.toString():typeof ft=="string"?ft:d.default.Config.inspect(ft)}a.inspectBody=gt;function wt(ft){if(d.default.BufferUtils.isBuffer(ft))return d.default.BufferUtils.byteLength(ft);if(typeof ft=="string")return d.default.Config.stringByteSize(ft);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof ft)}a.dataSizeBytes=wt;function Dt(){return String(Math.random()).substr(2)}a.cheapRandStr=Dt;var Qt=function(ft){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var ct=new Uint8Array(ft);return d.default.Config.getRandomValues(ct),d.default.BufferUtils.base64Encode(ct)}for(var ht=d.default.BufferUtils.base64CharSet,Ot=Math.round(ft*4/3),Vt="",Ct=0;Ct<Ot;Ct++)Vt+=ht[E(ht)];return Vt};a.randomString=Qt;var te=function(ft){if(d.default.Config.getRandomValues&&typeof Uint8Array<"u"){var ct=new Uint8Array(ft);return d.default.Config.getRandomValues(ct),d.default.BufferUtils.hexEncode(ct)}for(var ht=d.default.BufferUtils.hexCharSet,Ot=ft*2,Vt="",Ct=0;Ct<Ot;Ct++)Vt+=ht[E(ht)];return Vt};a.randomHexString=te;function se(ft,ct){for(var ht=Math.min(ct,ft.length),Ot=ft.slice(),Vt=[],Ct=0;Ct<ht;Ct++)Vt.push(at(Ot));return Vt}a.arrChooseN=se,a.trim=String.prototype.trim?function(ft){return ft.trim()}:function(ft){return ft.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function kt(ft,ct,ht){return new Promise(function(Ot,Vt){ft[ct].apply(ft,c.__spreadArray(c.__spreadArray([],ht,!1),[function(Ct,zt){Ct?Vt(Ct):Ot(zt)}],!1))})}a.promisify=kt;var pe;(function(ft){ft.msgpack="msgpack",ft.json="json"})(pe=a.Format||(a.Format={}));function Ee(ft,ct){return ct=="msgpack"?d.default.Config.msgpack.decode(ft):JSON.parse(String(ft))}a.decodeBody=Ee;function Ze(ft,ct){return ct=="msgpack"?d.default.Config.msgpack.encode(ft,!0):JSON.stringify(ft)}a.encodeBody=Ze;function Ve(ft){return ft.map(function(ct){return ct&&ct.toLowerCase()})}a.allToLowerCase=Ve;function tn(ft){return ft.map(function(ct){return ct&&ct.toUpperCase()})}a.allToUpperCase=tn;function xt(ft){return Math.min((ft+2)/3,2)}a.getBackoffCoefficient=xt;function Xt(){return 1-Math.random()*.2}a.getJitterCoefficient=Xt;function be(ft,ct){return ft*xt(ct)*Xt()}a.getRetryTime=be;function ye(){return l||(typeof window<"u"?window:self)}a.getGlobalObject=ye;function me(ft,ct){return Object.keys(ft).every(function(ht){return ft[ht]===ct[ht]})&&Object.keys(ct).every(function(ht){return ct[ht]===ft[ht]})}a.shallowEquals=me;function De(ft){var ct=/^(\[([^?]*)(?:(.*))\])?(.+)$/,ht=ft.match(ct);if(!ht||!ht.length||ht.length<5)throw new m.default("regex match failed",400,40010);if(ht[2])throw new m.default("cannot use a derived option with a ".concat(ht[2]," channel"),400,40010);return{qualifierParam:ht[3]||"",channelName:ht[4]}}a.matchDerivedChannel=De;function Ye(ft){return d.default.Config.createHmac?Buffer.from(ft,"ascii").toString("base64"):(0,_.stringify)((0,C.parse)(ft))}a.toBase64=Ye;function Ue(ft,ct){return ft.length===ct.length&&(0,a.arrEvery)(ft,function(ht,Ot){return ht===ct[Ot]})}a.arrEquals=Ue}).call(this,r(13))}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var c=r(0),d=c.__importDefault(r(3)),g=l||(typeof window<"u"?window:self),m;(function(v){v[v.None=0]="None",v[v.Error=1]="Error",v[v.Major=2]="Major",v[v.Minor=3]="Minor",v[v.Micro=4]="Micro"})(m||(m={}));function _(v,M){return"".concat(v).padStart(M?3:2,"0")}function C(v){return d.default.Config.logTimestamps?function(M){var z=new Date;v(_(z.getHours())+":"+_(z.getMinutes())+":"+_(z.getSeconds())+"."+_(z.getMilliseconds(),1)+" "+M)}:v}var E=function(){var v,M,z,L;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((M=(v=g==null?void 0:g.console)===null||v===void 0?void 0:v.log)===null||M===void 0?void 0:M.apply)=="function"?(z=function(){for(var D=[],N=0;N<arguments.length;N++)D[N]=arguments[N];console.log.apply(console,D)},L=console.warn?function(){for(var D=[],N=0;N<arguments.length;N++)D[N]=arguments[N];console.warn.apply(console,D)}:z):g!=null&&g.console.log?z=L=function(){Function.prototype.apply.call(console.log,console,arguments)}:z=L=function(){},[z,L].map(C)},O=(function(){function v(){v.logLevel=v.LOG_DEFAULT}return v.initLogHandlers=function(){var M=E(),z=M[0],L=M[1];this.logHandler=z,this.logErrorHandler=L},v.renamedClientOption=function(M,z){v.deprecationWarning("The `".concat(M,"` client option has been renamed to `").concat(z,"`. Please update your code to use `").concat(z,"` instead. `").concat(M,"` will be removed in a future version."))},v.renamedMethod=function(M,z,L){v.deprecationWarning("`".concat(M,"`’s `").concat(z,"` method has been renamed to `").concat(L,"`. Please update your code to use `").concat(L,"` instead. `").concat(z,"` will be removed in a future version."))},v.deprecationWarning=function(M){v.shouldLog(m.Error)&&v.logErrorHandler("Ably: Deprecation warning - ".concat(M))},v.logLevel=m.Error,v.LOG_NONE=m.None,v.LOG_ERROR=m.Error,v.LOG_MAJOR=m.Major,v.LOG_MINOR=m.Minor,v.LOG_MICRO=m.Micro,v.LOG_DEFAULT=m.Error,v.LOG_DEBUG=m.Micro,v.logAction=function(M,z,L){v.shouldLog(M)&&(M===m.Error?v.logErrorHandler:v.logHandler)("Ably: "+z+": "+L)},v.deprecated=function(M,z){v.deprecationWarning("".concat(M," is deprecated and will be removed in a future version. ").concat(z))},v.shouldLog=function(M){return M<=v.logLevel},v.setLog=function(M,z){M!==void 0&&(v.logLevel=M),z!==void 0&&(v.logHandler=v.logErrorHandler=z)},v})();a.default=O}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function c(){}return c})();a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.PartialErrorInfo=void 0;var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1));function g(C){var E="["+C.constructor.name;return C.message&&(E+=": "+C.message),C.statusCode&&(E+="; statusCode="+C.statusCode),C.code&&(E+="; code="+C.code),C.cause&&(E+="; cause="+d.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(E+="; see "+C.href+" "),E+="]",E}var m=(function(C){l.__extends(E,C);function E(O,v,M,z){var L=C.call(this,O)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(L,E.prototype),L.code=v,L.statusCode=M,L.cause=z,L}return E.prototype.toString=function(){return g(this)},E.fromValues=function(O){var v=O,M=v.message,z=v.code,L=v.statusCode;if(typeof M!="string"||typeof z!="number"||typeof L!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+c.default.Config.inspect(O));var D=Object.assign(new E(M,z,L),O);return D.code&&!D.href&&(D.href="https://help.ably.io/error/"+D.code),D},E})(Error);a.default=m;var _=(function(C){l.__extends(E,C);function E(O,v,M,z){var L=C.call(this,O)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(L,E.prototype),L.code=v,L.statusCode=M,L.cause=z,L}return E.prototype.toString=function(){return g(this)},E})(Error);a.PartialErrorInfo=_}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){if(typeof ArrayBuffer=="function"){var c=l,d=c.lib,g=d.WordArray,m=g.init,_=g.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var E=C.byteLength,O=[],v=0;v<E;v++)O[v>>>2]|=C[v]<<24-v%4*8;m.call(this,O,E)}else m.apply(this,arguments)};_.prototype=g}})(),l.lib.WordArray})}),(function(n,a,r){(function(l){(function(c,d){n.exports=d()})(this,function(){var c=c||(function(d,g){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof l<"u"&&l.crypto&&(m=l.crypto),!m)try{m=r(44)}catch{}var _=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||(function(){function A(){}return function(T){var y;return A.prototype=T,y=new A,A.prototype=null,y}})(),E={},O=E.lib={},v=O.Base=(function(){return{extend:function(A){var T=C(this);return A&&T.mixIn(A),(!T.hasOwnProperty("init")||this.init===T.init)&&(T.init=function(){T.$super.init.apply(this,arguments)}),T.init.prototype=T,T.$super=this,T},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var T in A)A.hasOwnProperty(T)&&(this[T]=A[T]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),M=O.WordArray=v.extend({init:function(A,T){A=this.words=A||[],T!=g?this.sigBytes=T:this.sigBytes=A.length*4},toString:function(A){return(A||L).stringify(this)},concat:function(A){var T=this.words,y=A.words,B=this.sigBytes,j=A.sigBytes;if(this.clamp(),B%4)for(var P=0;P<j;P++){var Q=y[P>>>2]>>>24-P%4*8&255;T[B+P>>>2]|=Q<<24-(B+P)%4*8}else for(var P=0;P<j;P+=4)T[B+P>>>2]=y[P>>>2];return this.sigBytes+=j,this},clamp:function(){var A=this.words,T=this.sigBytes;A[T>>>2]&=4294967295<<32-T%4*8,A.length=d.ceil(T/4)},clone:function(){var A=v.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var T=[],y=0;y<A;y+=4)T.push(_());return new M.init(T,A)}}),z=E.enc={},L=z.Hex={stringify:function(A){for(var T=A.words,y=A.sigBytes,B=[],j=0;j<y;j++){var P=T[j>>>2]>>>24-j%4*8&255;B.push((P>>>4).toString(16)),B.push((P&15).toString(16))}return B.join("")},parse:function(A){for(var T=A.length,y=[],B=0;B<T;B+=2)y[B>>>3]|=parseInt(A.substr(B,2),16)<<24-B%8*4;return new M.init(y,T/2)}},D=z.Latin1={stringify:function(A){for(var T=A.words,y=A.sigBytes,B=[],j=0;j<y;j++){var P=T[j>>>2]>>>24-j%4*8&255;B.push(String.fromCharCode(P))}return B.join("")},parse:function(A){for(var T=A.length,y=[],B=0;B<T;B++)y[B>>>2]|=(A.charCodeAt(B)&255)<<24-B%4*8;return new M.init(y,T)}},N=z.Utf8={stringify:function(A){try{return decodeURIComponent(escape(D.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return D.parse(unescape(encodeURIComponent(A)))}},G=O.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new M.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=N.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var T,y=this._data,B=y.words,j=y.sigBytes,P=this.blockSize,Q=P*4,K=j/Q;A?K=d.ceil(K):K=d.max((K|0)-this._minBufferSize,0);var X=K*P,V=d.min(X*4,j);if(X){for(var U=0;U<X;U+=P)this._doProcessBlock(B,U);T=B.splice(0,X),y.sigBytes-=V}return new M.init(T,V)},clone:function(){var A=v.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});O.Hasher=G.extend({cfg:v.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){G.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var T=this._doFinalize();return T},blockSize:16,_createHelper:function(A){return function(T,y){return new A.init(y).finalize(T)}},_createHmacHelper:function(A){return function(T,y){return new R.HMAC.init(A,y).finalize(T)}}});var R=E.algo={};return E})(Math);return c})}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(3));function m(E,O,v){try{O.apply(E,v)}catch(M){d.default.logAction(d.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+M+"; stack = "+(M&&M.stack))}}function _(E,O,v){for(var M,z,L,D=0;D<E.length;D++)if(M=E[D],v&&(M=M[v]),c.isArray(M)){for(;(z=c.arrIndexOf(M,O))!==-1;)M.splice(z,1);v&&M.length===0&&delete E[D][v]}else if(c.isObject(M))for(L in M)Object.prototype.hasOwnProperty.call(M,L)&&c.isArray(M[L])&&_([M],O,L)}var C=(function(){function E(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return E.prototype.on=function(){for(var O=this,v=[],M=0;M<arguments.length;M++)v[M]=arguments[M];if(v.length===1){var z=v[0];if(typeof z=="function")this.any.push(z);else throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v))}if(v.length===2){var L=v[0],D=v[1];if(typeof D!="function")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));if(c.isEmptyArg(L))this.any.push(D);else if(c.isArray(L))L.forEach(function(G){O.on(G,D)});else{if(typeof L!="string")throw new Error("EventListener.on(): Invalid arguments: "+g.default.Config.inspect(v));var N=this.events[L]||(this.events[L]=[]);N.push(D)}}},E.prototype.off=function(){for(var O,v=this,M=[],z=0;z<arguments.length;z++)M[z]=arguments[z];if(M.length==0||c.isEmptyArg(M[0])&&c.isEmptyArg(M[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var L=M[0],D=M[1],N=null,G=null;if(M.length===1||!D)typeof L=="function"?N=L:G=L;else{if(typeof D!="function")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(M));O=[L,D],G=O[0],N=O[1]}if(N&&c.isEmptyArg(G)){_([this.any,this.events,this.anyOnce,this.eventsOnce],N);return}if(c.isArray(G)){G.forEach(function(R){v.off(R,N)});return}if(typeof G!="string")throw new Error("EventEmitter.off(): invalid arguments:"+g.default.Config.inspect(M));N?_([this.events,this.eventsOnce],N,G):(delete this.events[G],delete this.eventsOnce[G])},E.prototype.listeners=function(O){if(O){var v=this.events[O]||[];return this.eventsOnce[O]&&Array.prototype.push.apply(v,this.eventsOnce[O]),v.length?v:null}return this.any.length?this.any:null},E.prototype.emit=function(O){for(var v=[],M=1;M<arguments.length;M++)v[M-1]=arguments[M];var z={event:O},L=[];this.anyOnce.length&&(Array.prototype.push.apply(L,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(L,this.any);var D=this.eventsOnce[O];D&&(Array.prototype.push.apply(L,D),delete this.eventsOnce[O]);var N=this.events[O];N&&Array.prototype.push.apply(L,N),c.arrForEach(L,function(G){m(z,G,v)})},E.prototype.once=function(){for(var O=this,v=[],M=0;M<arguments.length;M++)v[M]=arguments[M];var z=v.length;if((z===0||z===1&&typeof v[0]!="function")&&g.default.Config.Promise){var L=v[0];return new g.default.Config.Promise(function(T){O.once(L,T)})}var D=v[0],N=v[1];if(v.length===1&&typeof D=="function")this.anyOnce.push(D);else if(c.isEmptyArg(D)){if(typeof N!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));this.anyOnce.push(N)}else if(c.isArray(D)){var G=this,R=function(){var T=Array.prototype.slice.call(arguments);if(c.arrForEach(D,function(y){G.off(y,R)}),typeof N!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));N.apply(this,T)};c.arrForEach(D,function(T){G.on(T,R)})}else{if(typeof D!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));var A=this.eventsOnce[D]||(this.eventsOnce[D]=[]);if(N){if(typeof N!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+g.default.Config.inspect(v));A.push(N)}}},E.prototype.whenState=function(O,v,M){for(var z=this,L=[],D=3;D<arguments.length;D++)L[D-3]=arguments[D];var N={event:O};if(typeof O!="string"||typeof v!="string")throw"whenState requires a valid event String argument";if(typeof M!="function"&&g.default.Config.Promise)return new g.default.Config.Promise(function(G){E.prototype.whenState.apply(z,[O,v,G].concat(L))});O===v?m(N,M,L):this.once(O,M)},E})();a.default=C}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.getDefaults=a.normaliseOptions=a.objectifyOptions=a.getAgentString=a.getHosts=a.getFallbackHosts=a.environmentFallbackHosts=a.getHttpScheme=a.getPort=a.getHost=void 0;var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(4)),_=r(43),C="ably-js/"+_.version,E={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:_.version,protocolVersion:2,agent:C,getHost:O,getPort:v,getHttpScheme:M,environmentFallbackHosts:z,getFallbackHosts:L,getHosts:D,checkHost:N,objectifyOptions:T,normaliseOptions:y};function O(j,P,Q){return Q?P=P==j.restHost&&j.realtimeHost||P||j.realtimeHost:P=P||j.restHost,P}a.getHost=O;function v(j,P){return P||j.tls?j.tlsPort:j.port}a.getPort=v;function M(j){return j.tls?"https://":"http://"}a.getHttpScheme=M;function z(j){return[j+"-a-fallback.ably-realtime.com",j+"-b-fallback.ably-realtime.com",j+"-c-fallback.ably-realtime.com",j+"-d-fallback.ably-realtime.com",j+"-e-fallback.ably-realtime.com"]}a.environmentFallbackHosts=z;function L(j){var P=j.fallbackHosts,Q=typeof j.httpMaxRetryCount<"u"?j.httpMaxRetryCount:E.httpMaxRetryCount;return P?d.arrChooseN(P,Q):[]}a.getFallbackHosts=L;function D(j){return[j.restHost].concat(L(j))}a.getHosts=D;function N(j){if(typeof j!="string")throw new m.default("host must be a string; was a "+typeof j,4e4,400);if(!j.length)throw new m.default("host must not be zero-length",4e4,400)}function G(j,P,Q){return j.realtimeHost?j.realtimeHost:j.restHost?(g.default.logAction(g.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+j.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+j.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),j.restHost):P?E.REALTIME_HOST:Q+"-"+E.REALTIME_HOST}function R(j){var P={};for(var Q in E.TIMEOUTS)P[Q]=j[Q]||E.TIMEOUTS[Q];return P}function A(j){var P=E.agent;if(j.agents)for(var Q in j.agents)P+=" "+Q+"/"+j.agents[Q];return P}a.getAgentString=A;function T(j){return typeof j=="string"?j.indexOf(":")==-1?{token:j}:{key:j}:j}a.objectifyOptions=T;function y(j){if(j.host&&(g.default.renamedClientOption("host","restHost"),j.restHost=j.host),j.wsHost&&(g.default.renamedClientOption("wsHost","realtimeHost"),j.realtimeHost=j.wsHost),j.queueEvents&&(g.default.renamedClientOption("queueEvents","queueMessages"),j.queueMessages=j.queueEvents),j.headers&&g.default.deprecated("the `headers` client option",""),j.fallbackHostsUseDefault){if(j.fallbackHosts){var P="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}if(j.port||j.tlsPort){var P="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions",P),new m.default(P,4e4,400)}j.environment?g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):g.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),j.fallbackHosts=E.FALLBACK_HOSTS}j.recover===!0&&(g.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),j.recover=function(at,Y){Y(!0)}),typeof j.recover=="function"&&j.closeOnUnload===!0&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),j.recover=void 0),"closeOnUnload"in j||(j.closeOnUnload=!j.recover),j.transports&&d.arrIn(j.transports,"xhr")&&(g.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),d.arrDeleteValue(j.transports,"xhr"),j.transports.push("xhr_streaming")),"queueMessages"in j||(j.queueMessages=!0);var Q=j.environment&&String(j.environment).toLowerCase()||E.ENVIRONMENT,K=!Q||Q==="production";!j.fallbackHosts&&!j.restHost&&!j.realtimeHost&&!j.port&&!j.tlsPort&&(j.fallbackHosts=K?E.FALLBACK_HOSTS:z(Q));var X=j.restHost||(K?E.REST_HOST:Q+"-"+E.REST_HOST),V=G(j,K,Q);d.arrForEach((j.fallbackHosts||[]).concat(X,V),N),j.port=j.port||E.PORT,j.tlsPort=j.tlsPort||E.TLS_PORT,"tls"in j||(j.tls=!0);var U=R(j);if("useBinaryProtocol"in j?j.useBinaryProtocol=c.default.Config.supportsBinary&&j.useBinaryProtocol:j.useBinaryProtocol=c.default.Config.preferBinary,j.clientId){var I=j.headers=j.headers||{};I["X-Ably-ClientId"]=c.default.BufferUtils.base64Encode(c.default.BufferUtils.utf8Encode(j.clientId))}"idempotentRestPublishing"in j||(j.idempotentRestPublishing=!0),j.promises&&!c.default.Config.Promise&&(g.default.logAction(g.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),j.promises=!1);var F=null,W=j.connectivityCheckUrl;if(j.connectivityCheckUrl){var it=j.connectivityCheckUrl.split("?"),Z=it[0],rt=it[1];F=rt?d.parseQueryString(rt):{},Z.indexOf("://")===-1&&(Z="https://"+Z),W=Z}return l.__assign(l.__assign({},j),{useBinaryProtocol:"useBinaryProtocol"in j?c.default.Config.supportsBinary&&j.useBinaryProtocol:c.default.Config.preferBinary,realtimeHost:V,restHost:X,maxMessageSize:j.maxMessageSize||E.maxMessageSize,timeouts:U,connectivityCheckParams:F,connectivityCheckUrl:W})}a.normaliseOptions=y,a.default=E;function B(j){return Object.assign(E,j)}a.getDefaults=B}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importDefault(r(2)),g=l.__importDefault(r(4)),m=l.__importStar(r(1));function _(v){return!v||!v.channelOptions?{channelOptions:v,plugins:{},baseEncodedPreviousPayload:void 0}:v}function C(v){if(v&&v.cipher){if(!c.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var M=c.default.Crypto.getCipher(v.cipher);return{cipher:M.cipherParams,channelCipher:M.cipher}}return v??{}}function E(v){var M=0;return v.name&&(M+=v.name.length),v.clientId&&(M+=v.clientId.length),v.extras&&(M+=JSON.stringify(v.extras).length),v.data&&(M+=m.dataSizeBytes(v.data)),M}var O=(function(){function v(){}return v.prototype.toJSON=function(){var M=this.encoding,z=this.data;return z&&c.default.BufferUtils.isBuffer(z)&&(arguments.length>0?(M=M?M+"/base64":"base64",z=c.default.BufferUtils.base64Encode(z)):z=c.default.BufferUtils.toBuffer(z)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:M,data:z}},v.prototype.toString=function(){var M="[Message";return this.name&&(M+="; name="+this.name),this.id&&(M+="; id="+this.id),this.timestamp&&(M+="; timestamp="+this.timestamp),this.clientId&&(M+="; clientId="+this.clientId),this.connectionId&&(M+="; connectionId="+this.connectionId),this.encoding&&(M+="; encoding="+this.encoding),this.extras&&(M+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?M+="; data="+this.data:c.default.BufferUtils.isBuffer(this.data)?M+="; data (buffer)="+c.default.BufferUtils.base64Encode(this.data):M+="; data (json)="+JSON.stringify(this.data)),this.extras&&(M+="; extras="+JSON.stringify(this.extras)),M+="]",M},v.encrypt=function(M,z,L){var D=M.data,N=M.encoding,G=z.channelCipher;N=N?N+"/":"",c.default.BufferUtils.isBuffer(D)||(D=c.default.BufferUtils.utf8Encode(String(D)),N=N+"utf-8/"),G.encrypt(D,function(R,A){if(R){L(R);return}M.data=A,M.encoding=N+"cipher+"+G.algorithm,L(null,M)})},v.encode=function(M,z,L){var D=M.data,N=typeof D=="string"||c.default.BufferUtils.isBuffer(D)||D===null||D===void 0;if(!N)if(m.isObject(D)||m.isArray(D))M.data=JSON.stringify(D),M.encoding=M.encoding?M.encoding+"/json":"json";else throw new g.default("Data type is unsupported",40013,400);z!=null&&z.cipher?v.encrypt(M,z,L):L(null,M)},v.encodeArray=function(M,z,L){for(var D=0,N=0;N<M.length;N++)v.encode(M[N],z,function(G){if(G){L(G);return}D++,D==M.length&&L(null,M)})},v.decode=function(M,z){var L=_(z),D=M.data,N=M.encoding;if(N){var G=N.split("/"),R=void 0,A=G.length,T=M.data,y="";try{for(;(R=A)>0;){var B=G[--A].match(/([-\w]+)(\+([\w-]+))?/);if(!B)break;switch(y=B[1],y){case"base64":T=c.default.BufferUtils.base64Decode(String(T)),R==G.length&&(D=T);continue;case"utf-8":T=c.default.BufferUtils.utf8Decode(T);continue;case"json":T=JSON.parse(T);continue;case"cipher":if(L.channelOptions!=null&&L.channelOptions.cipher&&L.channelOptions.channelCipher){var j=B[3],P=L.channelOptions.channelCipher;if(j!=P.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");T=P.decrypt(T);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!L.plugins||!L.plugins.vcdiff)throw new g.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new g.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var Q=L.baseEncodedPreviousPayload;typeof Q=="string"&&(Q=c.default.BufferUtils.utf8Encode(Q)),Q=c.default.BufferUtils.toBuffer(Q),T=c.default.BufferUtils.toBuffer(T),T=c.default.BufferUtils.typedArrayToBuffer(L.plugins.vcdiff.decode(T,Q)),D=T}catch(X){throw new g.default("Vcdiff delta decode failed with "+X,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(X){var K=X;throw new g.default("Error processing the "+y+" encoding, decoder returned ‘"+K.message+"’",K.code||40013,400)}finally{M.encoding=R<=0?null:G.slice(0,R).join("/"),M.data=T}}L.baseEncodedPreviousPayload=D},v.fromResponseBody=function(M,z,L){L&&(M=m.decodeBody(M,L));for(var D=0;D<M.length;D++){var N=M[D]=v.fromValues(M[D]);try{v.decode(N,z)}catch(G){d.default.logAction(d.default.LOG_ERROR,"Message.fromResponseBody()",G.toString())}}return M},v.fromValues=function(M){return Object.assign(new v,M)},v.fromValuesArray=function(M){for(var z=M.length,L=new Array(z),D=0;D<z;D++)L[D]=v.fromValues(M[D]);return L},v.fromEncoded=function(M,z){var L=v.fromValues(M),D=C(z??null);try{v.decode(L,D)}catch(N){d.default.logAction(d.default.LOG_ERROR,"Message.fromEncoded()",N.toString())}return L},v.fromEncodedArray=function(M,z){return M.map(function(L){return v.fromEncoded(L,z)})},v.getMessagesSize=function(M){for(var z,L=0,D=0;D<M.length;D++)z=M[D],L+=z.size||(z.size=E(z));return L},v.serialize=m.encodeBody,v})();a.default=O}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(4)),g=l.__importDefault(r(9)),m=l.__importDefault(r(16)),_={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(_).forEach(function(L){C[_[L]]=L});var E={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},O=Object.keys(E);E.MODE_ALL=E.PRESENCE|E.PUBLISH|E.SUBSCRIBE|E.PRESENCE_SUBSCRIBE;function v(L){var D=[];if(L)for(var N=0;N<L.length;N++)D.push(L[N].toString());return"[ "+D.join(", ")+" ]"}var M="id channel channelSerial connectionId count msgSerial timestamp".split(" "),z=(function(){function L(){var D=this;this.hasFlag=function(N){return(D.flags&E[N])>0}}return L.prototype.setFlag=function(D){return this.flags=this.flags|E[D]},L.prototype.getMode=function(){return this.flags&&this.flags&E.MODE_ALL},L.prototype.encodeModesToFlags=function(D){var N=this;D.forEach(function(G){return N.setFlag(G)})},L.prototype.decodeModesFromFlags=function(){var D=this,N=[];return L.channelModes.forEach(function(G){D.hasFlag(G)&&N.push(G)}),N.length>0?N:void 0},L.fromValues=function(D){return Object.assign(new L,D)},L.Action=_,L.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],L.ActionName=C,L.serialize=c.encodeBody,L.deserialize=function(D,N){var G=c.decodeBody(D,N);return L.fromDeserialized(G)},L.fromDeserialized=function(D){var N=D.error;N&&(D.error=d.default.fromValues(N));var G=D.messages;if(G)for(var R=0;R<G.length;R++)G[R]=g.default.fromValues(G[R]);var A=D.presence;if(A)for(var R=0;R<A.length;R++)A[R]=m.default.fromValues(A[R],!0);return Object.assign(new L,D)},L.stringify=function(D){var N="[ProtocolMessage";D.action!==void 0&&(N+="; action="+L.ActionName[D.action]||!1);for(var G,R=0;R<M.length;R++)G=M[R],D[G]!==void 0&&(N+="; "+G+"="+D[G]);if(D.messages&&(N+="; messages="+v(g.default.fromValuesArray(D.messages))),D.presence&&(N+="; presence="+v(m.default.fromValuesArray(D.presence))),D.error&&(N+="; error="+d.default.fromValues(D.error).toString()),D.auth&&D.auth.accessToken&&(N+="; token="+D.auth.accessToken),D.flags&&(N+="; flags="+O.filter(D.hasFlag).join(",")),D.params){var A="";c.forInOwnNonNullProperties(D.params,function(T){A.length>0&&(A+="; "),A+=T+"="+D.params[T]}),A.length>0&&(N+="; params=["+A+"]")}return N+="]",N},L})();a.default=z}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=c.enc;m.Base64={stringify:function(C){var E=C.words,O=C.sigBytes,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var M=[],z=0;z<O;z+=3)for(var L=E[z>>>2]>>>24-z%4*8&255,D=E[z+1>>>2]>>>24-(z+1)%4*8&255,N=E[z+2>>>2]>>>24-(z+2)%4*8&255,G=L<<16|D<<8|N,R=0;R<4&&z+R*.75<O;R++)M.push(v.charAt(G>>>6*(3-R)&63));var A=v.charAt(64);if(A)for(;M.length%4;)M.push(A);return M.join("")},parse:function(C){var E=C.length,O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var M=0;M<O.length;M++)v[O.charCodeAt(M)]=M}var z=O.charAt(64);if(z){var L=C.indexOf(z);L!==-1&&(E=L)}return _(C,E,v)}};function _(C,E,O){for(var v=[],M=0,z=0;z<E;z++)if(z%4){var L=O[C.charCodeAt(z-1)]<<z%4*2,D=O[C.charCodeAt(z)]>>>6-z%4*2,N=L|D;v[M>>>2]|=N<<24-M%4*8,M++}return g.create(v,M)}})(),l.enc.Base64})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(10)),g=l.__importDefault(r(26)),m=l.__importDefault(r(2)),_=l.__importDefault(r(8)),C=l.__importDefault(r(21)),E=l.__importDefault(r(18)),O=l.__importDefault(r(4)),v=l.__importDefault(r(22)),M=l.__importDefault(r(3));function z(N){var G=[80015,80017,80030];return N.code?E.default.isTokenErr(N)?!1:c.arrIn(G,N.code)?!0:N.code>=4e4&&N.code<5e4:!1}function L(N){return z(N)?[d.default.fromValues({action:d.default.Action.ERROR,error:N})]:[d.default.fromValues({action:d.default.Action.DISCONNECTED,error:N})]}var D=(function(N){l.__extends(G,N);function G(R,A,T){var y=N.call(this,R,A,T,!0)||this;return y.onAuthUpdated=function(B){y.authParams={access_token:B.token}},y.stream="stream"in T?T.stream:!0,y.sendRequest=null,y.recvRequest=null,y.pendingCallback=null,y.pendingItems=null,y}return G.prototype.connect=function(){var R=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","starting"),g.default.prototype.connect.call(this);var A=this.params,T=A.options,y=_.default.getHost(T,A.host),B=_.default.getPort(T),j=T.tls?"https://":"http://";this.baseUri=j+y+":"+B+"/comet/";var P=this.baseUri+"connect";m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","uri: "+P),this.auth.getAuthParams(function(Q,K){if(Q){R.disconnect(Q);return}if(!R.isDisposed){R.authParams=K;var X=R.params.getConnectParams(K);"stream"in X&&(R.stream=X.stream),m.default.logAction(m.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+c.toQueryString(X));var V=!1,U=R.recvRequest=R.createRequest(P,null,X,null,R.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV);U.on("data",function(I){R.recvRequest&&(V||(V=!0,R.emit("preconnect")),R.onData(I))}),U.on("complete",function(I){if(R.recvRequest||(I=I||new O.default("Request cancelled",80003,400)),R.recvRequest=null,!V&&!I&&(V=!0,R.emit("preconnect")),R.onActivity(),I){I.code?R.onData(L(I)):R.disconnect(I);return}M.default.Config.nextTick(function(){R.recv()})}),U.exec()}})},G.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},G.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},G.prototype._requestCloseOrDisconnect=function(R){var A=this,T=R?this.closeUri:this.disconnectUri;if(T){var y=this.createRequest(T,null,this.authParams,null,v.default.REQ_SEND);y.on("complete",function(B){B&&(m.default.logAction(m.default.LOG_ERROR,"CometTransport.request"+(R?"Close()":"Disconnect()"),"request returned err = "+c.inspectError(B)),A.finish("disconnected",B))}),y.exec()}},G.prototype.dispose=function(){var R=this;m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(m.default.logAction(m.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),M.default.Config.nextTick(function(){R.emit("disposed")}))},G.prototype.onConnect=function(R){var A;if(!this.isDisposed){var T=(A=R.connectionDetails)===null||A===void 0?void 0:A.connectionKey;g.default.prototype.onConnect.call(this,R);var y=this.baseUri+T;m.default.logAction(m.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+y),this.sendUri=y+"/send",this.recvUri=y+"/recv",this.closeUri=y+"/close",this.disconnectUri=y+"/disconnect"}},G.prototype.send=function(R){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(R);return}var A=this.pendingItems||[];A.push(R),this.pendingItems=null,this.sendItems(A)},G.prototype.sendAnyPending=function(){var R=this.pendingItems;R&&(this.pendingItems=null,this.sendItems(R))},G.prototype.sendItems=function(R){var A=this,T=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(R),v.default.REQ_SEND);T.on("complete",function(y,B){if(y&&m.default.logAction(m.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+c.inspectError(y)),A.sendRequest=null,y){y.code?A.onData(L(y)):A.disconnect(y);return}B&&A.onData(B),A.pendingItems&&M.default.Config.nextTick(function(){A.sendRequest||A.sendAnyPending()})}),T.exec()},G.prototype.recv=function(){var R=this;if(!this.recvRequest&&this.isConnected){var A=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?v.default.REQ_RECV_STREAM:v.default.REQ_RECV_POLL);A.on("data",function(T){R.onData(T)}),A.on("complete",function(T){if(R.recvRequest=null,R.onActivity(),T){T.code?R.onData(L(T)):R.disconnect(T);return}M.default.Config.nextTick(function(){R.recv()})}),A.exec()}},G.prototype.onData=function(R){try{var A=this.decodeResponse(R);if(A&&A.length)for(var T=0;T<A.length;T++)this.onProtocolMessage(d.default.fromDeserialized(A[T]))}catch(y){m.default.logAction(m.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+y.stack)}},G.prototype.encodeRequest=function(R){return JSON.stringify(R)},G.prototype.decodeResponse=function(R){return typeof R=="string"?JSON.parse(R):R},G})(g.default);a.default=D}),(function(n,a){var r;r=(function(){return this})();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.isSuccessCode=void 0;var l;(function(d){d[d.Success=200]="Success",d[d.NoContent=204]="NoContent",d[d.BadRequest=400]="BadRequest",d[d.Unauthorized=401]="Unauthorized",d[d.Forbidden=403]="Forbidden",d[d.RequestTimeout=408]="RequestTimeout",d[d.InternalServerError=500]="InternalServerError"})(l||(l={}));function c(d){return d>=l.Success&&d<l.BadRequest}a.isSuccessCode=c,a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(2)),m=l.__importDefault(r(18)),_=l.__importDefault(r(19)),C=r(4),E=l.__importDefault(r(14));function O(N,G,R,A,T){N.http.supportsAuthHeaders?N.auth.getAuthHeaders(function(y,B){y?A(y):T(d.mixin(B,G),R)}):N.auth.getAuthParams(function(y,B){y?A(y):T(G,d.mixin(B,R))})}function v(N,G){return function(R,A,T,y,B){if(R&&!A){N(R);return}if(B===E.default.NoContent){N(R,[],T,!0,B);return}if(!y)try{A=d.decodeBody(A,G)}catch(V){d.isErrorInfoOrPartialErrorInfo(V)?N(V):N(new C.PartialErrorInfo(d.inspectError(V),null));return}if(!A){N(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var j=A,P=j.statusCode,Q=j.response,K=j.headers;if(P===void 0){N(R,A,T,!0,B);return}if(P<200||P>=300){var X=Q&&Q.error||R;X||(X=new Error("Error in unenveloping "+A),X.statusCode=P),N(X,Q,K,!0,P);return}N(R,Q,K,!0,P)}}function M(N){var G=[];if(N)for(var R in N)G.push(R+"="+N[R]);return G.join("&")}function z(N,G){return N+(G?"?":"")+M(G)}function L(N,G,R,A){return function(T,y,B,j,P){T?g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received Error; "+z(R,A)+"; Error: "+d.inspectError(T)):g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Received; "+z(R,A)+"; Headers: "+M(B)+"; StatusCode: "+P+"; Body: "+(c.default.BufferUtils.isBuffer(y)?y.toString():y)),N&&N(T,y,B,j,P)}}var D=(function(){function N(){}return N.get=function(G,R,A,T,y,B){N.do(_.default.Get,G,R,null,A,T,y,B)},N.delete=function(G,R,A,T,y,B){N.do(_.default.Delete,G,R,null,A,T,y,B)},N.post=function(G,R,A,T,y,B,j){N.do(_.default.Post,G,R,A,T,y,B,j)},N.patch=function(G,R,A,T,y,B,j){N.do(_.default.Patch,G,R,A,T,y,B,j)},N.put=function(G,R,A,T,y,B,j){N.do(_.default.Put,G,R,A,T,y,B,j)},N.do=function(G,R,A,T,y,B,j,P){g.default.shouldLog(g.default.LOG_MICRO)&&(P=L(P,G,A,B)),j&&(P=P&&v(P,j),(B=B||{}).envelope=j);function Q(K,X){var V;if(g.default.shouldLog(g.default.LOG_MICRO)&&g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+z(A,X)),g.default.shouldLog(g.default.LOG_MICRO)){var U=T;if(((V=K["content-type"])===null||V===void 0?void 0:V.indexOf("msgpack"))>0)try{U=c.default.Config.msgpack.decode(T)}catch(I){g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending MsgPack Decoding Error: "+d.inspectError(I))}g.default.logAction(g.default.LOG_MICRO,"Resource."+G+"()","Sending; "+z(A,X)+"; Body: "+U)}R.http.do(G,R,A,K,T,X,function(I,F,W,it,Z){if(I&&m.default.isTokenErr(I)){R.auth.authorize(null,null,function(rt){if(rt){P(rt);return}O(R,K,X,P,Q)});return}P(I,F,W,it,Z)})}O(R,y,B,P,Q)},N})();a.default=D}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=l.__importDefault(r(3)),g=l.__importDefault(r(9)),m=l.__importStar(r(1));function _(E){return C.Actions.indexOf(E)}var C=(function(){function E(){}return E.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},E.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var O=this.id.split(":");return{connectionId:O[0],msgSerial:parseInt(O[1],10),index:parseInt(O[2],10)}},E.prototype.toJSON=function(){var O=this.data,v=this.encoding;return O&&d.default.BufferUtils.isBuffer(O)&&(arguments.length>0?(v=v?v+"/base64":"base64",O=d.default.BufferUtils.base64Encode(O)):O=d.default.BufferUtils.toBuffer(O)),{id:this.id,clientId:this.clientId,action:_(this.action),data:O,encoding:v,extras:this.extras}},E.prototype.toString=function(){var O="[PresenceMessage";return O+="; action="+this.action,this.id&&(O+="; id="+this.id),this.timestamp&&(O+="; timestamp="+this.timestamp),this.clientId&&(O+="; clientId="+this.clientId),this.connectionId&&(O+="; connectionId="+this.connectionId),this.encoding&&(O+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?O+="; data="+this.data:d.default.BufferUtils.isBuffer(this.data)?O+="; data (buffer)="+d.default.BufferUtils.base64Encode(this.data):O+="; data (json)="+JSON.stringify(this.data)),this.extras&&(O+="; extras="+JSON.stringify(this.extras)),O+="]",O},E.fromResponseBody=function(O,v,M){var z=[];M&&(O=m.decodeBody(O,M));for(var L=0;L<O.length;L++){var D=z[L]=E.fromValues(O[L],!0);try{E.decode(D,v)}catch(N){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",N.toString())}}return z},E.fromValues=function(O,v){return v&&(O.action=E.Actions[O.action]),Object.assign(new E,O)},E.fromValuesArray=function(O){for(var v=O.length,M=new Array(v),z=0;z<v;z++)M[z]=E.fromValues(O[z]);return M},E.fromEncoded=function(O,v){var M=E.fromValues(O,!0);try{E.decode(M,v??{})}catch(z){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromEncoded()",z.toString())}return M},E.fromEncodedArray=function(O,v){return O.map(function(M){return E.fromEncoded(M,v)})},E.fromData=function(O){return O instanceof E?O:E.fromValues({data:O})},E.Actions=["absent","present","enter","leave","update"],E.encode=g.default.encode,E.decode=g.default.decode,E.getMessagesSize=g.default.getMessagesSize,E})();a.default=C}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var c=r(0),d=c.__importStar(r(1)),g=c.__importDefault(r(7)),m=c.__importStar(r(4)),_=c.__importDefault(r(2)),C=c.__importDefault(r(8)),E=c.__importDefault(r(22)),O=c.__importDefault(r(3));function v(j,P){return d.arrIn(d.allToLowerCase(d.keysArray(P)),"x-ably-errorcode")}function M(j,P){if(v(j,P))return j.error&&m.default.fromValues(j.error)}var z=function(){},L=0,D={},N=typeof l<"u"&&l.XDomainRequest;function G(){var j=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return j&&Number(j[1])}function R(){var j;return N&&(j=G())&&j===10}function A(j,P){return j.getResponseHeader&&j.getResponseHeader(P)}function T(j){return j.getResponseHeader&&(j.getResponseHeader("transfer-encoding")||!j.getResponseHeader("content-length"))}function y(j){for(var P=d.trim(j.getAllResponseHeaders()).split(`\r
`),Q={},K=0;K<P.length;K++){var X=P[K].split(":").map(d.trim);Q[X[0].toLowerCase()]=X[1]}return Q}var B=(function(j){c.__extends(P,j);function P(Q,K,X,V,U,I,F){var W=j.call(this)||this;return X=X||{},X.rnd=d.cheapRandStr(),R()&&!X.envelope&&(X.envelope="json"),W.uri=Q+d.toQueryString(X),W.headers=K||{},W.body=V,W.method=F?F.toUpperCase():d.isEmptyArg(V)?"GET":"POST",W.requestMode=U,W.timeouts=I,W.timedOut=!1,W.requestComplete=!1,W.id=String(++L),D[W.id]=W,W}return P.createRequest=function(Q,K,X,V,U,I,F){var W=I||C.default.TIMEOUTS;return new P(Q,K,d.copy(X),V,U,W,F)},P.prototype.complete=function(Q,K,X,V,U){this.requestComplete||(this.requestComplete=!0,!Q&&K&&this.emit("data",K),this.emit("complete",Q,K,X,V,U),this.dispose())},P.prototype.abort=function(){this.dispose()},P.prototype.exec=function(){var Q=this,K=this.headers,X=this.requestMode==E.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,V=this.timer=setTimeout(function(){Q.timedOut=!0,I.abort()},X),U=this.method,I=this.xhr=new XMLHttpRequest,F=K.accept,W=this.body,it="text";if(F?F.indexOf("application/x-msgpack")===0&&(it="arraybuffer"):K.accept="application/json",W){var Z=K["content-type"]||(K["content-type"]="application/json");Z.indexOf("application/json")>-1&&typeof W!="string"&&(W=JSON.stringify(W))}I.open(U,this.uri,!0),I.responseType=it,"authorization"in K&&(I.withCredentials=!0);for(var rt in K)I.setRequestHeader(rt,K[rt]);var at=function(kt,pe,Ee,Ze){var Ve,tn=pe+" (event type: "+kt.type+")";!((Ve=Q==null?void 0:Q.xhr)===null||Ve===void 0)&&Ve.statusText&&(tn+=", current statusText is "+Q.xhr.statusText),_.default.logAction(_.default.LOG_ERROR,"Request.on"+kt.type+"()",tn),Q.complete(new m.PartialErrorInfo(tn,Ee,Ze))};I.onerror=function(kt){at(kt,"XHR error occurred",null,400)},I.onabort=function(kt){Q.timedOut?at(kt,"Request aborted due to request timeout expiring",null,408):at(kt,"Request cancelled",null,400)},I.ontimeout=function(kt){at(kt,"Request timed out",null,408)};var Y,J,tt,et=0,gt=!1,wt=function(){if(clearTimeout(V),tt=J<400,J==204){Q.complete(null,null,null,null,J);return}Y=Q.requestMode==E.default.REQ_RECV_STREAM&&tt&&T(I)},Dt=function(){var kt;try{var pe=A(I,"content-type"),Ee=pe?pe.indexOf("application/json")>=0:I.responseType=="text";if(Ee){var Ze=I.responseType==="arraybuffer"?O.default.BufferUtils.utf8Decode(I.response):String(I.responseText);Ze.length?kt=JSON.parse(Ze):kt=Ze,gt=!0}else kt=I.response;kt.response!==void 0?(J=kt.statusCode,tt=J<400,K=kt.headers,kt=kt.response):K=y(I)}catch(tn){Q.complete(new m.PartialErrorInfo("Malformed response body from server: "+tn.message,null,400));return}if(tt||d.isArray(kt)){Q.complete(null,kt,K,gt,J);return}var Ve=M(kt,K);Ve||(Ve=new m.PartialErrorInfo("Error response received from server: "+J+" body was: "+O.default.Config.inspect(kt),null,J)),Q.complete(Ve,kt,K,gt,J)};function Qt(){for(var kt=I.responseText,pe=kt.length-1,Ee,Ze;et<pe&&(Ee=kt.indexOf(`
`,et))>-1;)Ze=kt.slice(et,Ee),et=Ee+1,te(Ze)}var te=function(kt){try{kt=JSON.parse(kt)}catch(pe){Q.complete(new m.PartialErrorInfo("Malformed response body from server: "+pe.message,null,400));return}Q.emit("data",kt)},se=function(){Qt(),Q.streamComplete=!0,O.default.Config.nextTick(function(){Q.complete()})};I.onreadystatechange=function(){var kt=I.readyState;kt<3||I.status!==0&&(J===void 0&&(J=I.status,J===1223&&(J=204),wt()),kt==3&&Y?Qt():kt==4&&(Y?se():Dt()))},I.send(W)},P.prototype.dispose=function(){var Q=this.xhr;if(Q){Q.onreadystatechange=Q.onerror=Q.onabort=Q.ontimeout=z,this.xhr=null;var K=this.timer;K&&(clearTimeout(K),this.timer=null),this.requestComplete||Q.abort()}delete D[this.id]},P})(g.default);a.default=B}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=l.__importStar(r(1)),g=l.__importDefault(r(24)),m=l.__importDefault(r(4)),_=l.__importDefault(r(45)),C=r(11),E=l.__importDefault(r(19)),O=l.__importDefault(r(14)),v=l.__importDefault(r(3)),M=l.__importDefault(r(15)),z=Math.pow(2,17);function L(){}function D(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function N(X){return!!X.connection}function G(X){return d.isErrorInfoOrPartialErrorInfo(X)?(X.code||(X.statusCode===403?X.code=40300:(X.code=40170,X.statusCode=401)),X):new m.default(d.inspectError(X),X.code||40170,X.statusCode||401)}var R=function(X,V){if(v.default.Config.createHmac){var U=v.default.Config.createHmac("SHA256",V);return U.update(X),U.digest("base64")}return(0,C.stringify)((0,_.default)(X,V))};function A(X){if(!X)return"";typeof X=="string"&&(X=JSON.parse(X));var V=Object.create(null),U=d.keysArray(X,!0);if(!U)return"";U.sort();for(var I=0;I<U.length;I++)V[U[I]]=X[U[I]].sort();return JSON.stringify(V)}function T(X){if(X.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(X.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(X.key)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(X.tokenDetails)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var V="authOptions must include valid authentication parameters";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",V),new Error(V)}}function y(X){return"useTokenAuth"in X&&!X.useTokenAuth}function B(X){return X.useTokenAuth||!y(X)&&(X.authCallback||X.authUrl||X.token||X.tokenDetails)}function j(X){return!X.key&&!X.authCallback&&!X.authUrl}var P=0;function Q(){return P++}var K=(function(){function X(V,U){if(this.authOptions={},this.client=V,this.tokenParams=U.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,B(U)){if(U.key&&!R){var I="client-side token request signing not supported";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",I),new Error(I)}j(U)&&c.default.logAction(c.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(U.defaultTokenParams,U),T(this.authOptions)}else{if(!U.key){var I="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",I),new m.default(I,40160,401)}c.default.logAction(c.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(U)}}return X.prototype.authorize=function(V,U,I){var F=this,W;if(typeof V=="function"&&!I?(I=V,W=V=null):typeof U=="function"&&!I?(I=U,W=null):W=U,!I&&this.client.options.promises)return d.promisify(this,"authorize",arguments);if(W&&W.key&&this.authOptions.key!==W.key)throw new m.default("Unable to update auth options with incompatible key",40102,401);W&&"force"in W&&(c.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),d.isOnlyPropIn(W,"force")&&(W=null)),this._forceNewToken(V,W,function(it,Z){if(it){F.client.connection&&it.statusCode===O.default.Forbidden&&F.client.connection.connectionManager.actOnErrorFromAuthorize(it),I==null||I(it);return}N(F.client)?F.client.connection.connectionManager.onAuthUpdated(Z,I||L):I==null||I(null,Z)})},X.prototype.authorise=function(V,U,I){c.default.renamedMethod("Auth","authorise","authorize"),this.authorize(V,U,I)},X.prototype._forceNewToken=function(V,U,I){var F=this;this.tokenDetails=null,this._saveTokenOptions(V,U),T(this.authOptions),this._ensureValidAuthCredentials(!0,function(W,it){delete F.tokenParams.timestamp,delete F.authOptions.queryTime,I(W,it)})},X.prototype.requestToken=function(V,U,I){var F=this;if(typeof V=="function"&&!I?(I=V,U=V=null):typeof U=="function"&&!I&&(I=U,U=null),!I&&this.client.options.promises)return d.promisify(this,"requestToken",arguments);U=U||this.authOptions,V=V||d.copy(this.tokenParams);var W=I||L,it,Z=this.client;if(U.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),it=U.authCallback;else if(U.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),it=function(et,gt){var wt=d.mixin({accept:"application/json, text/plain"},U.authHeaders),Dt=U.authMethod&&U.authMethod.toLowerCase()==="post",Qt,te=U.authUrl.indexOf("?");te>-1&&(Qt=d.parseQueryString(U.authUrl.slice(te)),U.authUrl=U.authUrl.slice(0,te),Dt||(U.authParams=d.mixin(Qt,U.authParams)));var se=d.mixin({},U.authParams||{},et),kt=function(Ze,Ve,tn,xt){var Xt;if(Ze?c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+d.inspectError(Ze)):(Xt=tn["content-type"],c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+Xt+"; body: "+d.inspectBody(Ve))),Ze||xt)return gt(Ze,Ve);if(v.default.BufferUtils.isBuffer(Ve)&&(Ve=Ve.toString()),!Xt){gt(new m.default("authUrl response is missing a content-type header",40170,401));return}var be=Xt.indexOf("application/json")>-1,ye=Xt.indexOf("text/plain")>-1||Xt.indexOf("application/jwt")>-1;if(!be&&!ye){gt(new m.default("authUrl responded with unacceptable content-type "+Xt+", should be either text/plain, application/jwt or application/json",40170,401));return}if(be){if(Ve.length>z){gt(new m.default("authUrl response exceeded max permitted length",40170,401));return}try{Ve=JSON.parse(Ve)}catch(me){gt(new m.default("Unexpected error processing authURL response; err = "+me.message,40170,401));return}}gt(null,Ve,Xt)};if(c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+U.authUrl+"; Params: "+JSON.stringify(se)+"; method: "+(Dt?"POST":"GET")),Dt){var pe=wt||{};pe["content-type"]="application/x-www-form-urlencoded";var Ee=d.toQueryString(se).slice(1);F.client.http.doUri(E.default.Post,Z,U.authUrl,pe,Ee,Qt,kt)}else F.client.http.doUri(E.default.Get,Z,U.authUrl,wt||{},null,se,kt)};else if(U.key)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),it=function(et,gt){F.createTokenRequest(et,U,gt)};else{var rt="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";c.default.logAction(c.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),W(new m.default(rt,40171,403));return}"capability"in V&&(V.capability=A(V.capability));var at=function(et,gt){var wt=et.keyName,Dt="/keys/"+wt+"/requestToken",Qt=function(se){return Z.baseUri(se)+Dt},te=d.defaultPostHeaders(F.client.options);U.requestHeaders&&d.mixin(te,U.requestHeaders),c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+Dt+"; Token params: "+JSON.stringify(et)),F.client.http.do(E.default.Post,Z,Qt,te,JSON.stringify(et),null,gt)},Y=!1,J=this.client.options.timeouts.realtimeRequestTimeout,tt=setTimeout(function(){Y=!0;var et="Token request callback timed out after "+J/1e3+" seconds";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",et),W(new m.default(et,40170,401))},J);it(V,function(et,gt,wt){if(!Y){if(clearTimeout(tt),et){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+d.inspectError(et)),W(G(et));return}if(typeof gt=="string"){gt.length===0?W(new m.default("Token string is empty",40170,401)):gt.length>z?W(new m.default("Token string exceeded max permitted length (was "+gt.length+" bytes)",40170,401)):gt==="undefined"||gt==="null"?W(new m.default("Token string was literal null/undefined",40170,401)):gt[0]==="{"&&!(wt&&wt.indexOf("application/jwt")>-1)?W(new m.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):W(null,{token:gt});return}if(typeof gt!="object"){var Dt="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof gt;c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",Dt),W(new m.default(Dt,40170,401));return}var Qt=JSON.stringify(gt).length;if(Qt>z&&!U.suppressMaxLengthCheck){W(new m.default("Token request/details object exceeded max permitted stringified size (was "+Qt+" bytes)",40170,401));return}if("issued"in gt){W(null,gt);return}if(!("keyName"in gt)){var Dt="Expected token request callback to call back with a token string, token request object, or token details object";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",Dt),W(new m.default(Dt,40170,401));return}at(gt,function(te,se,kt,pe){if(te){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+d.inspectError(te)),W(G(te));return}pe||(se=JSON.parse(se)),c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","token received"),W(null,se)})}})},X.prototype.createTokenRequest=function(V,U,I){var F=this;if(typeof V=="function"&&!I?(I=V,U=V=null):typeof U=="function"&&!I&&(I=U,U=null),!I&&this.client.options.promises)return d.promisify(this,"createTokenRequest",arguments);U=U||this.authOptions,V=V||d.copy(this.tokenParams);var W=U.key;if(!W){I(new m.default("No key specified",40101,403));return}var it=W.split(":"),Z=it[0],rt=it[1];if(!rt){I(new m.default("Invalid key specified",40101,403));return}if(V.clientId===""){I(new m.default("clientId can’t be an empty string",40012,400));return}"capability"in V&&(V.capability=A(V.capability));var at=d.mixin({keyName:Z},V),Y=V.clientId||"",J=V.ttl||"",tt=V.capability||"";(function(et){if(at.timestamp){et();return}F.getTimestamp(U&&U.queryTime,function(gt,wt){if(gt){I(gt);return}at.timestamp=wt,et()})})(function(){var et=at.nonce||(at.nonce=D()),gt=at.timestamp,wt=at.keyName+`
`+J+`
`+tt+`
`+Y+`
`+gt+`
`+et+`
`;at.mac=at.mac||R(wt,rt),c.default.logAction(c.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),I(null,at)})},X.prototype.getAuthParams=function(V){this.method=="basic"?V(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(U,I){if(U){V(U);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{access_token:I.token})})},X.prototype.getAuthHeaders=function(V){this.method=="basic"?V(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(U,I){if(U){V(U);return}if(!I)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{authorization:"Bearer "+d.toBase64(I.token)})})},X.prototype.getTimestamp=function(V,U){!this.isTimeOffsetSet()&&(V||this.authOptions.queryTime)?this.client.time(U):U(null,this.getTimestampUsingOffset())},X.prototype.getTimestampUsingOffset=function(){return d.now()+(this.client.serverTimeOffset||0)},X.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},X.prototype._saveBasicOptions=function(V){this.method="basic",this.key=V.key,this.basicKey=d.toBase64(V.key),this.authOptions=V||{},"clientId"in V&&this._userSetClientId(V.clientId)},X.prototype._saveTokenOptions=function(V,U){this.method="token",V&&(this.tokenParams=V),U&&(U.token&&(U.tokenDetails=typeof U.token=="string"?{token:U.token}:U.token),U.tokenDetails&&(this.tokenDetails=U.tokenDetails),"clientId"in U&&this._userSetClientId(U.clientId),this.authOptions=U)},X.prototype._ensureValidAuthCredentials=function(V,U){var I=this,F=this.tokenDetails;if(F){if(this._tokenClientIdMismatch(F.clientId)){U(new m.default("Mismatch between clientId in token ("+F.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!F.expires||F.expires>=this.getTimestampUsingOffset()){c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+F.expires),U(null,F);return}c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=g.default.create())).push(U),!(this.currentTokenRequestId!==null&&!V)){var W=this.currentTokenRequestId=Q();this.requestToken(this.tokenParams,this.authOptions,function(it,Z){if(I.currentTokenRequestId>W){c.default.logAction(c.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}I.currentTokenRequestId=null;var rt=I.waitingForTokenRequest||L;if(I.waitingForTokenRequest=null,it){rt(it);return}rt(null,I.tokenDetails=Z)})}},X.prototype._userSetClientId=function(V){if(typeof V=="string"||V===null){if(V==="*")throw new m.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var U=this._uncheckedSetClientId(V);if(U)throw U}else throw new m.default("clientId must be either a string or null",40012,400)},X.prototype._uncheckedSetClientId=function(V){if(this._tokenClientIdMismatch(V)){var U="Unexpected clientId mismatch: client has "+this.clientId+", requested "+V,I=new m.default(U,40102,401);return c.default.logAction(c.default.LOG_ERROR,"Auth._uncheckedSetClientId()",U),I}else return this.clientId=this.tokenParams.clientId=V,null},X.prototype._tokenClientIdMismatch=function(V){return!!(this.clientId&&this.clientId!=="*"&&V&&V!=="*"&&this.clientId!==V)},X.isTokenErr=function(V){return V.code&&V.code>=40140&&V.code<40150},X.prototype.revokeTokens=function(V,U,I){if(B(this.client.options))throw new m.default("Cannot revoke tokens when using token auth",40162,401);var F=this.client.options.keyName,W;if(typeof U=="function"?(I=U,W={}):W=U??{},I===void 0){if(this.client.options.promises)return d.promisify(this,"revokeTokens",[V,W]);I=L}var it=I,Z=l.__assign({targets:V.map(function(J){return"".concat(J.type,":").concat(J.value)})},W),rt=this.client.options.useBinaryProtocol?d.Format.msgpack:d.Format.json,at=d.defaultPostHeaders(this.client.options,rt);this.client.options.headers&&d.mixin(at,this.client.options.headers);var Y=d.encodeBody(Z,rt);M.default.post(this.client,"/keys/".concat(F,"/revokeTokens"),Y,at,{newBatchResponse:"true"},null,function(J,tt,et,gt){if(J){it(J);return}var wt=gt?tt:d.decodeBody(tt,rt);it(null,wt)})},X})();a.default=K}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(c){c.Get="get",c.Delete="delete",c.Post="post",c.Put="put",c.Patch="patch"})(l||(l={})),a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.HttpPaginatedResponse=a.PaginatedResult=void 0;var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(15)),m=l.__importDefault(r(14));function _(z){var L=z.match(/^\.\/(\w+)\?(.*)$/);return L&&L[2]&&c.parseQueryString(L[2])}function C(z){typeof z=="string"&&(z=z.split(","));for(var L={},D=0;D<z.length;D++){var N=z[D].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(N){var G=_(N[1]);G&&(L[N[2]]=G)}}return L}function E(z,L,D){return!(D&&(L||typeof z.code=="number"))}var O=(function(){function z(L,D,N,G,R,A){this.rest=L,this.path=D,this.headers=N,this.envelope=G??null,this.bodyHandler=R,this.useHttpPaginatedResponse=A||!1}return z.prototype.get=function(L,D){var N=this;g.default.get(this.rest,this.path,this.headers,L,this.envelope,function(G,R,A,T,y){N.handlePage(G,R,A,T,y,D)})},z.prototype.delete=function(L,D){var N=this;g.default.delete(this.rest,this.path,this.headers,L,this.envelope,function(G,R,A,T,y){N.handlePage(G,R,A,T,y,D)})},z.prototype.post=function(L,D,N){var G=this;g.default.post(this.rest,this.path,D,this.headers,L,this.envelope,function(R,A,T,y,B){N&&G.handlePage(R,A,T,y,B,N)})},z.prototype.put=function(L,D,N){var G=this;g.default.put(this.rest,this.path,D,this.headers,L,this.envelope,function(R,A,T,y,B){N&&G.handlePage(R,A,T,y,B,N)})},z.prototype.patch=function(L,D,N){var G=this;g.default.patch(this.rest,this.path,D,this.headers,L,this.envelope,function(R,A,T,y,B){N&&G.handlePage(R,A,T,y,B,N)})},z.prototype.handlePage=function(L,D,N,G,R,A){if(L&&E(L,D,this.useHttpPaginatedResponse)){d.default.logAction(d.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+c.inspectError(L)),A==null||A(L);return}var T,y,B;try{T=R==m.default.NoContent?[]:this.bodyHandler(D,N||{},G)}catch(j){A==null||A(L||j);return}N&&(y=N.Link||N.link)&&(B=C(y)),this.useHttpPaginatedResponse?A(null,new M(this,T,N||{},R,B,L)):A(null,new v(this,T,B))},z})(),v=(function(){function z(L,D,N){var G=this;this.resource=L,this.items=D;var R=this;N&&("first"in N&&(this.first=function(A){if(!A&&R.resource.rest.options.promises)return c.promisify(R,"first",[]);R.get(N.first,A)}),"current"in N&&(this.current=function(A){if(!A&&R.resource.rest.options.promises)return c.promisify(R,"current",[]);R.get(N.current,A)}),this.next=function(A){if(!A&&R.resource.rest.options.promises)return c.promisify(R,"next",[]);"next"in N?R.get(N.next,A):A(null,null)},this.hasNext=function(){return"next"in N},this.isLast=function(){var A;return!(!((A=G.hasNext)===null||A===void 0)&&A.call(G))})}return z.prototype.get=function(L,D){var N=this.resource;g.default.get(N.rest,N.path,N.headers,L,N.envelope,function(G,R,A,T,y){N.handlePage(G,R,A,T,y,D)})},z})();a.PaginatedResult=v;var M=(function(z){l.__extends(L,z);function L(D,N,G,R,A,T){var y=z.call(this,D,N,A)||this;return y.statusCode=R,y.success=R<300&&R>=200,y.headers=G,y.errorCode=T&&T.code,y.errorMessage=T&&T.message,y}return L.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},L})(v);a.HttpPaginatedResponse=M,a.default=O}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.isRetriable=void 0;var l=r(0),c=l.__importDefault(r(4)),d={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},g={disconnected:function(){return c.default.fromValues({statusCode:400,code:d.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return c.default.fromValues({statusCode:400,code:d.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return c.default.fromValues({statusCode:400,code:d.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return c.default.fromValues({statusCode:400,code:d.CLOSING,message:"Connection closing"})},closed:function(){return c.default.fromValues({statusCode:400,code:d.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return c.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return c.default.fromValues({statusCode:500,code:d.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function m(_){return!_.statusCode||!_.code||_.statusCode>=500?!0:Object.values(d).includes(_.code)}a.isRetriable=m,a.default=g}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(c){c[c.REQ_SEND=0]="REQ_SEND",c[c.REQ_RECV=1]="REQ_RECV",c[c.REQ_RECV_POLL=2]="REQ_RECV_POLL",c[c.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(l||(l={})),a.default=l}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(l){return l})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(2)),d=(function(){function g(m){this.members=m||[]}return g.prototype.call=function(){for(var m=[],_=0;_<arguments.length;_++)m[_]=arguments[_];for(var C=0,E=this.members;C<E.length;C++){var O=E[C];if(O)try{O.apply(void 0,m)}catch(v){c.default.logAction(c.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+v+"; stack = "+v.stack)}}},g.prototype.push=function(){for(var m,_=[],C=0;C<arguments.length;C++)_[C]=arguments[C];(m=this.members).push.apply(m,_)},g.create=function(m){var _=new g(m);return Object.assign(function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];return _.call.apply(_,C)},{push:function(C){return _.push(C)}})},g})();a.default=d}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){(function(){var c=l,d=c.lib,g=d.Base,m=c.enc,_=m.Utf8,C=c.algo;C.HMAC=g.extend({init:function(E,O){E=this._hasher=new E.init,typeof O=="string"&&(O=_.parse(O));var v=E.blockSize,M=v*4;O.sigBytes>M&&(O=E.finalize(O)),O.clamp();for(var z=this._oKey=O.clone(),L=this._iKey=O.clone(),D=z.words,N=L.words,G=0;G<v;G++)D[G]^=1549556828,N[G]^=909522486;z.sigBytes=L.sigBytes=M,this.reset()},reset:function(){var E=this._hasher;E.reset(),E.update(this._iKey)},update:function(E){return this._hasher.update(E),this},finalize:function(E){var O=this._hasher,v=O.finalize(E);O.reset();var M=O.finalize(this._oKey.clone().concat(v));return M}})})()})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(21)),C=l.__importDefault(r(4)),E=l.__importDefault(r(3)),O=c.default.Action,v=c.default.fromValues({action:O.CLOSE}),M=c.default.fromValues({action:O.DISCONNECT}),z=(function(L){l.__extends(D,L);function D(N,G,R,A){var T=L.call(this)||this;return A&&(R.format=void 0,R.heartbeats=!0),T.connectionManager=N,N.registerProposedTransport(T),T.auth=G,T.params=R,T.timeouts=R.options.timeouts,T.format=R.format,T.isConnected=!1,T.isFinished=!1,T.isDisposed=!1,T.maxIdleInterval=null,T.idleTimer=null,T.lastActivity=null,T}return D.prototype.connect=function(){},D.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",_.default.closed())},D.prototype.disconnect=function(N){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",N||_.default.disconnected())},D.prototype.fail=function(N){this.isConnected&&this.requestDisconnect(),this.finish("failed",N||_.default.failed())},D.prototype.finish=function(N,G){var R;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((R=this.idleTimer)!==null&&R!==void 0?R:void 0),this.idleTimer=null,this.emit(N,G),this.dispose())},D.prototype.onProtocolMessage=function(N){switch(m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+c.default.stringify(N)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),N.action){case O.HEARTBEAT:m.default.logAction(m.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",N.id);break;case O.CONNECTED:this.onConnect(N),this.emit("connected",N.error,N.connectionId,N.connectionDetails,N);break;case O.CLOSED:this.onClose(N);break;case O.DISCONNECTED:this.onDisconnect(N);break;case O.ACK:this.emit("ack",N.msgSerial,N.count);break;case O.NACK:this.emit("nack",N.msgSerial,N.count,N.error);break;case O.SYNC:this.connectionManager.onChannelMessage(N,this);break;case O.ACTIVATE:break;case O.AUTH:this.auth.authorize(function(G){G&&m.default.logAction(m.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+d.inspectError(G))});break;case O.ERROR:if(m.default.logAction(m.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+E.default.Config.inspect(N.error)+(N.channel?", channel: "+N.channel:"")),N.channel===void 0){this.onFatalError(N);break}this.connectionManager.onChannelMessage(N,this);break;default:this.connectionManager.onChannelMessage(N,this)}},D.prototype.onConnect=function(N){if(this.isConnected=!0,!N.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var G=N.connectionDetails.maxIdleInterval;G&&(this.maxIdleInterval=G+this.timeouts.realtimeRequestTimeout,this.onActivity())},D.prototype.onDisconnect=function(N){var G=N&&N.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onDisconnect()","err = "+d.inspectError(G)),this.finish("disconnected",G)},D.prototype.onFatalError=function(N){var G=N&&N.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onFatalError()","err = "+d.inspectError(G)),this.finish("failed",G)},D.prototype.onClose=function(N){var G=N&&N.error;m.default.logAction(m.default.LOG_MINOR,"Transport.onClose()","err = "+d.inspectError(G)),this.finish("closed",G)},D.prototype.requestClose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestClose()",""),this.send(v)},D.prototype.requestDisconnect=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(M)},D.prototype.ping=function(N){var G={action:c.default.Action.HEARTBEAT};N&&(G.id=N),this.send(c.default.fromValues(G))},D.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},D.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=d.now(),this.setIdleTimer(this.maxIdleInterval+100))},D.prototype.setIdleTimer=function(N){var G=this;this.idleTimer||(this.idleTimer=setTimeout(function(){G.onIdleTimerExpire()},N))},D.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var N=d.now()-this.lastActivity,G=this.maxIdleInterval-N;if(G<=0){var R="No activity seen from realtime in "+N+"ms; assuming connection has dropped";m.default.logAction(m.default.LOG_ERROR,"Transport.onIdleTimerExpire()",R),this.disconnect(new C.default(R,80003,408))}else this.setIdleTimer(G+100)},D.tryConnect=function(N,G,R,A,T){var y=new N(G,R,A),B,j=function(Q){clearTimeout(B),T({event:this.event,error:Q})},P=G.options.timeouts.realtimeRequestTimeout;B=setTimeout(function(){y.off(["preconnect","disconnected","failed"]),y.dispose(),j.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},P),y.on(["failed","disconnected"],j),y.on("preconnect",function(){m.default.logAction(m.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+y),clearTimeout(B),y.off(["failed","disconnected"],j),T(null,y)}),y.connect()},D})(g.default);a.default=z}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(40),r(25))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.Base,m=d.WordArray,_=c.algo,C=_.MD5,E=_.EvpKDF=g.extend({cfg:g.extend({keySize:128/32,hasher:C,iterations:1}),init:function(O){this.cfg=this.cfg.extend(O)},compute:function(O,v){for(var M,z=this.cfg,L=z.hasher.create(),D=m.create(),N=D.words,G=z.keySize,R=z.iterations;N.length<G;){M&&L.update(M),M=L.update(O).finalize(v),L.reset();for(var A=1;A<R;A++)M=L.finalize(M),L.reset();D.concat(M)}return D.sigBytes=G*4,D}});c.EvpKDF=function(O,v,M){return E.create(M).compute(O,v)}})(),l.EvpKDF})}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(27))})(this,function(l){l.lib.Cipher||(function(c){var d=l,g=d.lib,m=g.Base,_=g.WordArray,C=g.BufferedBlockAlgorithm,E=d.enc;E.Utf8;var O=E.Base64,v=d.algo,M=v.EvpKDF,z=g.Cipher=C.extend({cfg:m.extend(),createEncryptor:function(K,X){return this.create(this._ENC_XFORM_MODE,K,X)},createDecryptor:function(K,X){return this.create(this._DEC_XFORM_MODE,K,X)},init:function(K,X,V){this.cfg=this.cfg.extend(V),this._xformMode=K,this._key=X,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(K){return this._append(K),this._process()},finalize:function(K){K&&this._append(K);var X=this._doFinalize();return X},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function K(X){return typeof X=="string"?Q:B}return function(X){return{encrypt:function(V,U,I){return K(U).encrypt(X,V,U,I)},decrypt:function(V,U,I){return K(U).decrypt(X,V,U,I)}}}})()});g.StreamCipher=z.extend({_doFinalize:function(){var K=this._process(!0);return K},blockSize:1});var L=d.mode={},D=g.BlockCipherMode=m.extend({createEncryptor:function(K,X){return this.Encryptor.create(K,X)},createDecryptor:function(K,X){return this.Decryptor.create(K,X)},init:function(K,X){this._cipher=K,this._iv=X}}),N=L.CBC=(function(){var K=D.extend();K.Encryptor=K.extend({processBlock:function(V,U){var I=this._cipher,F=I.blockSize;X.call(this,V,U,F),I.encryptBlock(V,U),this._prevBlock=V.slice(U,U+F)}}),K.Decryptor=K.extend({processBlock:function(V,U){var I=this._cipher,F=I.blockSize,W=V.slice(U,U+F);I.decryptBlock(V,U),X.call(this,V,U,F),this._prevBlock=W}});function X(V,U,I){var F,W=this._iv;W?(F=W,this._iv=c):F=this._prevBlock;for(var it=0;it<I;it++)V[U+it]^=F[it]}return K})(),G=d.pad={},R=G.Pkcs7={pad:function(K,X){for(var V=X*4,U=V-K.sigBytes%V,I=U<<24|U<<16|U<<8|U,F=[],W=0;W<U;W+=4)F.push(I);var it=_.create(F,U);K.concat(it)},unpad:function(K){var X=K.words[K.sigBytes-1>>>2]&255;K.sigBytes-=X}};g.BlockCipher=z.extend({cfg:z.cfg.extend({mode:N,padding:R}),reset:function(){var K;z.reset.call(this);var X=this.cfg,V=X.iv,U=X.mode;this._xformMode==this._ENC_XFORM_MODE?K=U.createEncryptor:(K=U.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==K?this._mode.init(this,V&&V.words):(this._mode=K.call(U,this,V&&V.words),this._mode.__creator=K)},_doProcessBlock:function(K,X){this._mode.processBlock(K,X)},_doFinalize:function(){var K,X=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(X.pad(this._data,this.blockSize),K=this._process(!0)):(K=this._process(!0),X.unpad(K)),K},blockSize:128/32});var A=g.CipherParams=m.extend({init:function(K){this.mixIn(K)},toString:function(K){return(K||this.formatter).stringify(this)}}),T=d.format={},y=T.OpenSSL={stringify:function(K){var X,V=K.ciphertext,U=K.salt;return U?X=_.create([1398893684,1701076831]).concat(U).concat(V):X=V,X.toString(O)},parse:function(K){var X,V=O.parse(K),U=V.words;return U[0]==1398893684&&U[1]==1701076831&&(X=_.create(U.slice(2,4)),U.splice(0,4),V.sigBytes-=16),A.create({ciphertext:V,salt:X})}},B=g.SerializableCipher=m.extend({cfg:m.extend({format:y}),encrypt:function(K,X,V,U){U=this.cfg.extend(U);var I=K.createEncryptor(V,U),F=I.finalize(X),W=I.cfg;return A.create({ciphertext:F,key:V,iv:W.iv,algorithm:K,mode:W.mode,padding:W.padding,blockSize:K.blockSize,formatter:U.format})},decrypt:function(K,X,V,U){U=this.cfg.extend(U),X=this._parse(X,U.format);var I=K.createDecryptor(V,U).finalize(X.ciphertext);return I},_parse:function(K,X){return typeof K=="string"?X.parse(K,this):K}}),j=d.kdf={},P=j.OpenSSL={execute:function(K,X,V,U){U||(U=_.random(64/8));var I=M.create({keySize:X+V}).compute(K,U),F=_.create(I.words.slice(X),V*4);return I.sigBytes=X*4,A.create({key:I,iv:F,salt:U})}},Q=g.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:P}),encrypt:function(K,X,V,U){U=this.cfg.extend(U);var I=U.kdf.execute(V,K.keySize,K.ivSize);U.iv=I.iv;var F=B.encrypt.call(this,K,X,I.key,U);return F.mixIn(I),F},decrypt:function(K,X,V,U){U=this.cfg.extend(U),X=this._parse(X,U.format);var I=U.kdf.execute(V,K.keySize,K.ivSize,X.salt);U.iv=I.iv;var F=B.decrypt.call(this,K,X,I.key,U);return F}})})()})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.Request=a.createRequest=void 0;var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(12)),g=l.__importDefault(r(3)),m=l.__importDefault(r(7)),_=r(4),C=l.__importDefault(r(8)),E=l.__importDefault(r(2)),O=l.__importDefault(r(22)),v=c.getGlobalObject(),M=function(){},z=v._ablyjs_jsonp={};z._=function(T){return z["_"+T]||M};var L=1,D="jsonp";function N(T,y,B,j,P,Q,K){return Q=Q||C.default.TIMEOUTS,new R(void 0,T,y,c.copy(B),j,P,Q,K)}a.createRequest=N;var G=(function(T){l.__extends(y,T);function y(B,j,P){var Q=T.call(this,B,j,P)||this;return Q.shortName=D,P.stream=!1,Q}return y.isAvailable=function(){return g.default.Config.jsonpSupported&&g.default.Config.allowComet},y.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},y.prototype.createRequest=function(B,j,P,Q,K,X,V){return X=(this===null||this===void 0?void 0:this.timeouts)||X||C.default.TIMEOUTS,N(B,j,P,Q,K,X,V)},y})(d.default),R=(function(T){l.__extends(y,T);function y(B,j,P,Q,K,X,V,U){var I=T.call(this)||this;return B===void 0&&(B=L++),I.id=B,I.uri=j,I.params=Q||{},I.params.rnd=c.cheapRandStr(),P&&(P["X-Ably-Version"]&&(I.params.v=P["X-Ably-Version"]),P["X-Ably-Lib"]&&(I.params.lib=P["X-Ably-Lib"])),I.body=K,I.method=U,I.requestMode=X,I.timeouts=V,I.requestComplete=!1,I}return y.prototype.exec=function(){var B=this,j=this.id,P=this.body,Q=this.method,K=this.uri,X=this.params;X.callback="_ablyjs_jsonp._("+j+")",X.envelope="jsonp",P&&(X.body=P),Q&&Q!=="get"&&(X.method=Q);var V=this.script=document.createElement("script"),U=K+c.toQueryString(X);V.src=U,V.src.split("/").slice(-1)[0]!==U.split("/").slice(-1)[0]&&E.default.logAction(E.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),V.async=!0,V.type="text/javascript",V.charset="UTF-8",V.onerror=function(W){B.complete(new _.PartialErrorInfo("JSONP script error (event: "+g.default.Config.inspect(W)+")",null,400))},z["_"+j]=function(W){if(W.statusCode){var it=W.response;if(W.statusCode==204)B.complete(null,null,null,W.statusCode);else if(!it)B.complete(new _.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(W.statusCode<400||c.isArray(it))B.complete(null,it,W.headers,W.statusCode);else{var Z=it.error||new _.PartialErrorInfo("Error response received from server",null,W.statusCode);B.complete(Z)}}else B.complete(null,W)};var I=this.requestMode==O.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),I);var F=document.getElementsByTagName("head")[0];F.insertBefore(V,F.firstChild)},y.prototype.complete=function(B,j,P,Q){if(P=P||{},!this.requestComplete){this.requestComplete=!0;var K=void 0;j&&(K=typeof j=="string"?"text/plain":"application/json",P["content-type"]=K,this.emit("data",j)),this.emit("complete",B,j,P,!0,Q),this.dispose()}},y.prototype.abort=function(){this.dispose()},y.prototype.dispose=function(){var B=this.timer;B&&(clearTimeout(B),this.timer=null);var j=this.script;j.parentNode&&j.parentNode.removeChild(j),delete z[this.id],this.emit("disposed")},y})(m.default);a.Request=R;function A(T){return v.JSONPTransport=G,G.isAvailable()&&(T.supportedTransports[D]=G),G}a.default=A}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(2)),g=l.__importDefault(r(8)),m=l.__importDefault(r(18)),_=l.__importDefault(r(46)),C=l.__importDefault(r(20)),E=l.__importDefault(r(33)),O=l.__importDefault(r(4)),v=l.__importDefault(r(49)),M=l.__importDefault(r(19)),z=l.__importDefault(r(3)),L=l.__importDefault(r(9)),D=l.__importDefault(r(16)),N=l.__importDefault(r(15)),G=function(){},R=(function(){function T(y){if(!y){var B="no options provided";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new Error(B)}var j=g.default.objectifyOptions(y);j.log?(d.default.setLog(j.log.level,j.log.handler),d.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):d.default.setLog(j.logLevel,j.logHandler),d.default.logAction(d.default.LOG_MICRO,"Rest()","initialized with clientOptions "+z.default.Config.inspect(y));var P=this.options=g.default.normaliseOptions(j);if(P.key){var Q=P.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!Q){var B="invalid key parameter";throw d.default.logAction(d.default.LOG_ERROR,"Rest()",B),new O.default(B,40400,404)}P.keyName=Q[1],P.keySecret=Q[2]}if("clientId"in P)if(typeof P.clientId=="string"||P.clientId===null){if(P.clientId==="*")throw new O.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new O.default("clientId must be either a string or null",40012,400);d.default.logAction(d.default.LOG_MINOR,"Rest()","started; version = "+g.default.version),this.baseUri=this.authority=function(K){return g.default.getHttpScheme(P)+K+":"+g.default.getPort(P,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new z.default.Http(P),this.auth=new m.default(this,P),this.channels=new A(this),this.push=new _.default(this)}return T.prototype.stats=function(y,B){if(B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.options.promises)return c.promisify(this,"stats",[y]);B=G}var j=c.defaultGetHeaders(this.options),P=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,Q=this.http.supportsLinkHeaders?void 0:P;this.options.headers&&c.mixin(j,this.options.headers),new C.default(this,"/stats",j,Q,function(K,X,V){for(var U=V?K:JSON.parse(K),I=0;I<U.length;I++)U[I]=v.default.fromValues(U[I]);return U}).get(y,B)},T.prototype.time=function(y,B){var j=this;if(B===void 0){if(typeof y=="function")B=y,y=null;else if(this.options.promises)return c.promisify(this,"time",[y])}var P=B||G,Q=c.defaultGetHeaders(this.options);this.options.headers&&c.mixin(Q,this.options.headers);var K=function(X){return j.authority(X)+"/time"};this.http.do(M.default.Get,this,K,Q,null,y,function(X,V,U,I){if(X){P(X);return}I||(V=JSON.parse(V));var F=V[0];if(!F){P(new O.default("Internal error (unexpected result type from GET /time)",5e4,500));return}j.serverTimeOffset=F-c.now(),P(null,F)})},T.prototype.request=function(y,B,j,P,Q,K){var X=this.options.useBinaryProtocol,V=X?z.default.Config.msgpack.encode:JSON.stringify,U=X?z.default.Config.msgpack.decode:JSON.parse,I=X?c.Format.msgpack:c.Format.json,F=this.http.supportsLinkHeaders?void 0:I;j=j||{};var W=y.toLowerCase(),it=W=="get"?c.defaultGetHeaders(this.options,I):c.defaultPostHeaders(this.options,I);if(K===void 0){if(this.options.promises)return c.promisify(this,"request",[y,B,j,P,Q]);K=G}typeof P!="string"&&(P=V(P)),this.options.headers&&c.mixin(it,this.options.headers),Q&&c.mixin(it,Q);var Z=new C.default(this,B,it,F,function(rt,at,Y){return c.ensureArray(Y?rt:U(rt))},!0);if(!c.arrIn(z.default.Http.methods,W))throw new O.default("Unsupported method "+W,40500,405);c.arrIn(z.default.Http.methodsWithBody,W)?Z[W](j,P,K):Z[W](j,K)},T.prototype.batchPublish=function(y,B){if(B===void 0){if(this.options.promises)return c.promisify(this,"batchPublish",[y]);B=G}var j=B,P,Q;c.isArray(y)?(P=y,Q=!1):(P=[y],Q=!0);var K=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,X=c.defaultPostHeaders(this.options,K);this.options.headers&&c.mixin(X,this.options.headers);var V=c.encodeBody(P,K);N.default.post(this,"/messages",V,X,{newBatchResponse:"true"},null,function(U,I,F,W){if(U){j(U);return}var it=W?I:c.decodeBody(I,K);Q?j(null,it[0]):j(null,it)})},T.prototype.batchPresence=function(y,B){if(B===void 0){if(this.options.promises)return c.promisify(this,"batchPresence",[y]);B=G}var j=B,P=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,Q=c.defaultPostHeaders(this.options,P);this.options.headers&&c.mixin(Q,this.options.headers);var K=y.join(",");N.default.get(this,"/presence",Q,{newBatchResponse:"true",channels:K},null,function(X,V,U,I){if(X){j(X);return}var F=I?V:c.decodeBody(V,P);j(null,F)})},T.prototype.setLog=function(y){d.default.setLog(y.level,y.handler)},T.Promise=function(y){return y=g.default.objectifyOptions(y),y.promises=!0,new T(y)},T.Callbacks=T,T.Platform=z.default,T.Message=L.default,T.PresenceMessage=D.default,T})(),A=(function(){function T(y){this.rest=y,this.all=Object.create(null)}return T.prototype.get=function(y,B){y=String(y);var j=this.all[y];return j?B&&j.setOptions(B):this.all[y]=j=new E.default(this.rest,y,B),j},T.prototype.release=function(y){delete this.all[String(y)]},T})();a.default=R}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return l.enc.Utf8})}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[],O=[];(function(){function z(G){for(var R=c.sqrt(G),A=2;A<=R;A++)if(!(G%A))return!1;return!0}function L(G){return(G-(G|0))*4294967296|0}for(var D=2,N=0;N<64;)z(D)&&(N<8&&(E[N]=L(c.pow(D,1/2))),O[N]=L(c.pow(D,1/3)),N++),D++})();var v=[],M=C.SHA256=_.extend({_doReset:function(){this._hash=new m.init(E.slice(0))},_doProcessBlock:function(z,L){for(var D=this._hash.words,N=D[0],G=D[1],R=D[2],A=D[3],T=D[4],y=D[5],B=D[6],j=D[7],P=0;P<64;P++){if(P<16)v[P]=z[L+P]|0;else{var Q=v[P-15],K=(Q<<25|Q>>>7)^(Q<<14|Q>>>18)^Q>>>3,X=v[P-2],V=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;v[P]=K+v[P-7]+V+v[P-16]}var U=T&y^~T&B,I=N&G^N&R^G&R,F=(N<<30|N>>>2)^(N<<19|N>>>13)^(N<<10|N>>>22),W=(T<<26|T>>>6)^(T<<21|T>>>11)^(T<<7|T>>>25),it=j+W+U+O[P]+v[P],Z=F+I;j=B,B=y,y=T,T=A+it|0,A=R,R=G,G=N,N=it+Z|0}D[0]=D[0]+N|0,D[1]=D[1]+G|0,D[2]=D[2]+R|0,D[3]=D[3]+A|0,D[4]=D[4]+T|0,D[5]=D[5]+y|0,D[6]=D[6]+B|0,D[7]=D[7]+j|0},_doFinalize:function(){var z=this._data,L=z.words,D=this._nDataBytes*8,N=z.sigBytes*8;return L[N>>>5]|=128<<24-N%32,L[(N+64>>>9<<4)+14]=c.floor(D/4294967296),L[(N+64>>>9<<4)+15]=D,z.sigBytes=L.length*4,this._process(),this._hash},clone:function(){var z=_.clone.call(this);return z._hash=this._hash.clone(),z}});d.SHA256=_._createHelper(M),d.HmacSHA256=_._createHmacHelper(M)})(Math),l.SHA256})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(34)),_=l.__importDefault(r(9)),C=l.__importDefault(r(4)),E=l.__importDefault(r(20)),O=l.__importDefault(r(15)),v=l.__importDefault(r(3));function M(){}var z=9;function L(G){return c.arrEvery(G,function(R){return!R.id})}function D(G){var R=G||{};if(R.cipher){if(!v.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var A=v.default.Crypto.getCipher(R.cipher);R.cipher=A.cipherParams,R.channelCipher=A.cipher}else"cipher"in R&&(R.cipher=void 0,R.channelCipher=null);return R}var N=(function(G){l.__extends(R,G);function R(A,T,y){var B=G.call(this)||this;return g.default.logAction(g.default.LOG_MINOR,"Channel()","started; name = "+T),B.rest=A,B.name=T,B.basePath="/channels/"+encodeURIComponent(T),B.presence=new m.default(B),B.channelOptions=D(y),B}return R.prototype.setOptions=function(A){this.channelOptions=D(A)},R.prototype.history=function(A,T){if(g.default.logAction(g.default.LOG_MICRO,"Channel.history()","channel = "+this.name),T===void 0)if(typeof A=="function")T=A,A=null;else{if(this.rest.options.promises)return c.promisify(this,"history",arguments);T=M}this._history(A,T)},R.prototype._history=function(A,T){var y=this.rest,B=y.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,j=this.rest.http.supportsLinkHeaders?void 0:B,P=c.defaultGetHeaders(y.options,B);y.options.headers&&c.mixin(P,y.options.headers);var Q=this.channelOptions;new E.default(y,this.basePath+"/messages",P,j,function(K,X,V){return _.default.fromResponseBody(K,Q,V?void 0:B)}).get(A,T)},R.prototype.publish=function(){var A=this,T=arguments.length,y=arguments[0],B=arguments[1],j=arguments[T-1],P,Q;if(typeof j!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);j=M}if(typeof y=="string"||y===null)P=[_.default.fromValues({name:y,data:B})],Q=arguments[2];else if(c.isObject(y))P=[_.default.fromValues(y)],Q=arguments[1];else if(c.isArray(y))P=_.default.fromValuesArray(y),Q=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof Q!="object"||!Q)&&(Q={});var K=this.rest,X=K.options,V=X.useBinaryProtocol?c.Format.msgpack:c.Format.json,U=K.options.idempotentRestPublishing,I=c.defaultPostHeaders(K.options,V);if(X.headers&&c.mixin(I,X.headers),U&&L(P)){var F=c.randomString(z);c.arrForEach(P,function(W,it){W.id=F+":"+it.toString()})}_.default.encodeArray(P,this.channelOptions,function(W){if(W){j(W);return}var it=_.default.getMessagesSize(P),Z=X.maxMessageSize;if(it>Z){j(new C.default("Maximum size of messages that can be published at once exceeded ( was "+it+" bytes; limit is "+Z+" bytes)",40009,400));return}A._publish(_.default.serialize(P,V),I,Q,j)})},R.prototype._publish=function(A,T,y,B){O.default.post(this.rest,this.basePath+"/messages",A,T,y,null,B)},R.prototype.status=function(A){if(typeof A!="function"&&this.rest.options.promises)return c.promisify(this,"status",[]);var T=this.rest.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,y=c.defaultPostHeaders(this.rest.options,T);O.default.get(this.rest,this.basePath,y,{},T,A||M)},R})(d.default);a.default=N}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(2)),m=l.__importDefault(r(20)),_=l.__importDefault(r(16));function C(){}var E=(function(O){l.__extends(v,O);function v(M){var z=O.call(this)||this;return z.channel=M,z.basePath=M.basePath+"/presence",z}return v.prototype.get=function(M,z){if(g.default.logAction(g.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),z===void 0)if(typeof M=="function")z=M,M=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"get",arguments);z=C}var L=this.channel.rest,D=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,N=this.channel.rest.http.supportsLinkHeaders?void 0:D,G=c.defaultGetHeaders(L.options,D);L.options.headers&&c.mixin(G,L.options.headers);var R=this.channel.channelOptions;new m.default(L,this.basePath,G,N,function(A,T,y){return _.default.fromResponseBody(A,R,y?void 0:D)}).get(M,z)},v.prototype.history=function(M,z){return g.default.logAction(g.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(M,z)},v.prototype._history=function(M,z){if(z===void 0)if(typeof M=="function")z=M,M=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"_history",[M]);z=C}var L=this.channel.rest,D=L.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,N=this.channel.rest.http.supportsLinkHeaders?void 0:D,G=c.defaultGetHeaders(L.options,D);L.options.headers&&c.mixin(G,L.options.headers);var R=this.channel.channelOptions;new m.default(L,this.basePath+"/history",G,N,function(A,T,y){return _.default.fromResponseBody(A,R,y?void 0:D)}).get(M,z)},v})(d.default);a.default=E}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0}),a.TransportParams=void 0;var c=r(0),d=c.__importDefault(r(10)),g=c.__importStar(r(1)),m=c.__importStar(r(52)),_=c.__importStar(r(8)),C=c.__importDefault(r(3)),E=c.__importDefault(r(7)),O=c.__importDefault(r(36)),v=c.__importDefault(r(2)),M=c.__importDefault(r(37)),z=c.__importStar(r(21)),L=c.__importStar(r(4)),D=c.__importDefault(r(18)),N=c.__importDefault(r(9)),G=c.__importDefault(r(24)),R=c.__importDefault(r(53)),A=c.__importDefault(r(26)),T=c.__importDefault(r(14)),y=function(){var rt;return typeof C.default.WebStorage<"u"&&((rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.localSupported)},B=function(){var rt;return typeof C.default.WebStorage<"u"&&((rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.sessionSupported)},j=d.default.Action,P=function(){},Q="ably-transport-preference",K="ably-connection-recovery";function X(){var rt,at;return B()&&((at=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.getSession)===null||at===void 0?void 0:at.call(rt,K))}function V(rt){var at,Y;return B()&&((Y=(at=C.default.WebStorage)===null||at===void 0?void 0:at.setSession)===null||Y===void 0?void 0:Y.call(at,K,rt))}function U(){var rt,at;return B()&&((at=(rt=C.default.WebStorage)===null||rt===void 0?void 0:rt.removeSession)===null||at===void 0?void 0:at.call(rt,K))}function I(rt,at){return g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,rt.shortName)>g.arrIndexOf(C.default.Defaults.transportPreferenceOrder,at.shortName)}function F(rt,at,Y){var J;if(rt.channel!==at.channel||(J=rt.action)!==j.PRESENCE&&J!==j.MESSAGE||J!==at.action)return!1;var tt=J===j.PRESENCE?"presence":"messages",et=rt[tt].concat(at[tt]),gt=N.default.getMessagesSize(et);return gt>Y||!g.allSame(et,"clientId")||!g.arrEvery(et,function(wt){return!wt.id})?!1:(rt[tt]=et,!0)}function W(rt){try{return JSON.parse(rt)}catch{return null}}var it=(function(){function rt(at,Y,J,tt){this.options=at,this.host=Y,this.mode=J,this.connectionKey=tt,this.format=at.useBinaryProtocol?g.Format.msgpack:g.Format.json}return rt.prototype.getConnectParams=function(at){var Y=at?g.copy(at):{},J=this.options;switch(this.mode){case"upgrade":Y.upgrade=this.connectionKey;break;case"resume":Y.resume=this.connectionKey;break;case"recover":{var tt=W(J.recover);tt&&(Y.recover=tt.connectionKey);break}}return J.clientId!==void 0&&(Y.clientId=J.clientId),J.echoMessages===!1&&(Y.echo="false"),this.format!==void 0&&(Y.format=this.format),this.stream!==void 0&&(Y.stream=this.stream),this.heartbeats!==void 0&&(Y.heartbeats=this.heartbeats),Y.v=_.default.protocolVersion,Y.agent=(0,_.getAgentString)(this.options),J.transportParams!==void 0&&g.mixin(Y,J.transportParams),Y},rt.prototype.toString=function(){var at="[mode="+this.mode;return this.host&&(at+=",host="+this.host),this.connectionKey&&(at+=",connectionKey="+this.connectionKey),this.format&&(at+=",format="+this.format),at+="]",at},rt})();a.TransportParams=it;var Z=(function(rt){c.__extends(at,rt);function at(Y,J){var tt=rt.call(this)||this;tt.disconnectedRetryCount=0,at.initTransports(),tt.realtime=Y,tt.options=J;var et=J.timeouts,gt=et.preferenceConnectTimeout+et.realtimeRequestTimeout;if(tt.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:gt,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:et.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:et.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:et.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},tt.state=tt.states.initialized,tt.errorReason=null,tt.queuedMessages=new O.default,tt.msgSerial=0,tt.connectionDetails=void 0,tt.connectionId=void 0,tt.connectionKey=void 0,tt.connectionStateTtl=et.connectionStateTtl,tt.maxIdleInterval=null,tt.transports=g.intersect(J.transports||_.default.defaultTransports,at.supportedTransports),tt.baseTransport=g.intersect(_.default.baseTransportOrder,tt.transports)[0],tt.upgradeTransports=g.intersect(tt.transports,_.default.upgradeTransports),tt.transportPreference=null,tt.httpHosts=_.default.getHosts(J),tt.activeProtocol=null,tt.proposedTransports=[],tt.pendingTransports=[],tt.host=null,tt.lastAutoReconnectAttempt=null,tt.lastActivity=null,tt.forceFallbackHost=!1,tt.connectCounter=0,v.default.logAction(v.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(J.transports||_.default.defaultTransports)+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+tt.transports+"]"),v.default.logAction(v.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+tt.httpHosts+"]"),!tt.transports.length){var wt="no requested transports available";throw v.default.logAction(v.default.LOG_ERROR,"realtime.ConnectionManager()",wt),new Error(wt)}var Dt=C.default.Config.addEventListener;return Dt&&(B()&&typeof J.recover=="function"&&Dt("beforeunload",tt.persistConnection.bind(tt)),J.closeOnUnload===!0&&Dt("beforeunload",function(){v.default.logAction(v.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),tt.requestState({state:"closing"})}),Dt("online",function(){tt.state==tt.states.disconnected||tt.state==tt.states.suspended?(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),tt.requestState({state:"connecting"})):tt.state==tt.states.connecting&&(tt.pendingTransports.forEach(function(Qt){Qt.off()}),tt.disconnectAllTransports(),tt.startConnect())}),Dt("offline",function(){tt.state==tt.states.connected&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),tt.disconnectAllTransports())})),tt}return at.initTransports=function(){(0,R.default)(at),g.arrForEach(C.default.Transports,function(Y){Y(at)})},at.prototype.createTransportParams=function(Y,J){return new it(this.options,Y,J,this.connectionKey)},at.prototype.getTransportParams=function(Y){var J=this,tt=function(et){if(J.connectionKey){et("resume");return}if(typeof J.options.recover=="string"){et("recover");return}var gt=J.options.recover,wt=X();if(wt&&typeof gt=="function"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),gt(wt,function(Dt){Dt?(J.options.recover=wt.recoveryKey,et("recover")):et("clean")});return}et("clean")};tt(function(et){var gt=J.createTransportParams(null,et);if(et==="recover"){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+J.options.recover);var wt=W(J.options.recover);wt&&(J.msgSerial=wt.msgSerial)}else v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+gt.toString());Y(gt)})},at.prototype.tryATransport=function(Y,J,tt){var et=this;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+J),A.default.tryConnect(at.supportedTransports[J],this,this.realtime.auth,Y,function(gt,wt){var Dt=et.state;if(Dt==et.states.closing||Dt==et.states.closed||Dt==et.states.failed){wt&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+Dt.state+" while we were attempting the transport; closing "+wt),wt.close()),tt(!0);return}if(gt){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+J+" "+gt.event+", err: "+gt.error.toString()),D.default.isTokenErr(gt.error)&&!(et.errorReason&&D.default.isTokenErr(et.errorReason))?(et.errorReason=gt.error,et.realtime.auth._forceNewToken(null,null,function(Qt){if(Qt){et.actOnErrorFromAuthorize(Qt);return}et.tryATransport(Y,J,tt)})):gt.event==="failed"?(et.notifyState({state:"failed",error:gt.error}),tt(!0)):gt.event==="disconnected"&&((0,z.isRetriable)(gt.error)?tt(!1):(et.notifyState({state:et.states.connecting.failState,error:gt.error}),tt(!0)));return}v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+J+"; setting pending"),et.setTransportPending(wt,Y),tt(null,wt)})},at.prototype.setTransportPending=function(Y,J){var tt=this,et=J.mode;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+Y+"; mode = "+et),g.arrDeleteValue(this.proposedTransports,Y),this.pendingTransports.push(Y);var gt=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];Y.once("connected",function(Dt,Qt,te){et=="upgrade"&&tt.activeProtocol?Y.shortName!==gt&&g.arrIn(tt.getUpgradePossibilities(),gt)&&tt.activeProtocol?setTimeout(function(){tt.scheduleTransportActivation(Dt,Y,Qt,te)},tt.options.timeouts.parallelUpgradeDelay):tt.scheduleTransportActivation(Dt,Y,Qt,te):(tt.activateTransport(Dt,Y,Qt,te),C.default.Config.nextTick(function(){tt.connectImpl(J)})),et==="recover"&&tt.options.recover&&(tt.options.recover=null,tt.unpersistConnection())});var wt=this;Y.on(["disconnected","closed","failed"],function(Dt){wt.deactivateTransport(Y,this.event,Dt)}),this.emit("transport.pending",Y)},at.prototype.scheduleTransportActivation=function(Y,J,tt,et){var gt=this,wt=this.activeProtocol&&this.activeProtocol.getTransport(),Dt=function(){J.disconnect(),g.arrDeleteValue(gt.pendingTransports,J)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),Dt();return}if(wt&&!I(J,wt)){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+" is no better than current active transport "+wt.shortName+" - abandoning upgrade"),Dt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+J);var Qt=null;if(!J.isConnected){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+J.shortName+"is no longer connected; abandoning upgrade"),Dt();return}if(this.state===this.states.connected)v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,Qt=this.activeProtocol;else if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+J.shortName),Dt();return}v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+J);var te=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+J),J.send(d.default.fromValues({action:j.ACTIVATE})),gt.activateTransport(Y,J,tt,et),gt.state===gt.states.synchronizing?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+J),gt.state=gt.states.connected):v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+gt.state.state+", so leaving unchanged"),gt.state.sendEvents&&gt.sendQueuedMessages()};Qt?Qt.onceIdle(te):te()},at.prototype.activateTransport=function(Y,J,tt,et){var gt=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+J),Y&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+Y),tt&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+tt),et&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(et)),this.persistTransportPreference(J);var wt=this.state,Dt=this.states.connected.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+wt.state),wt.state==this.states.closing.state||wt.state==this.states.closed.state||wt.state==this.states.failed.state)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),J.disconnect(),!1;if(g.arrDeleteValue(this.pendingTransports,J),!J.isConnected)return v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+J+" since it appears to no longer be connected"),!1;var Qt=this.activeProtocol;this.activeProtocol=new m.default(J),this.host=J.params.host;var te=et.connectionKey;if(te&&this.connectionKey!=te&&this.setConnection(tt,et,!!Y),this.onConnectionDetailsUpdate(et,J),C.default.Config.nextTick(function(){J.on("connected",function(kt,pe,Ee){gt.onConnectionDetailsUpdate(Ee,J),gt.emit("update",new M.default(Dt,Dt,null,kt))})}),wt.state===this.states.connected.state?Y&&(this.errorReason=this.realtime.connection.errorReason=Y,this.emit("update",new M.default(Dt,Dt,null,Y))):(this.notifyState({state:"connected",error:Y}),this.errorReason=this.realtime.connection.errorReason=Y||null),this.emit("transport.active",J),Qt)if(Qt.messageQueue.count()>0&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+Qt.transport.shortName+", new one is "+J.shortName+") finishing with "+Qt.messageQueue.count()+" messages still pending"),Qt.transport===J){var se="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",se)}else Qt.finish();return g.safeArrForEach(this.pendingTransports,function(kt){if(kt===J){var pe="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+J.shortName+"; stack = "+new Error().stack;v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()",pe),g.arrDeleteValue(gt.pendingTransports,J)}else kt.disconnect()}),g.safeArrForEach(this.proposedTransports,function(kt){kt===J?(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+J.shortName+"; stack = "+new Error().stack),g.arrDeleteValue(gt.proposedTransports,J)):kt.dispose()}),!0},at.prototype.deactivateTransport=function(Y,J,tt){var et=this.activeProtocol,gt=et&&et.getTransport()===Y,wt=g.arrDeleteValue(this.pendingTransports,Y),Dt=g.arrDeleteValue(this.proposedTransports,Y),Qt=this.noTransportsScheduledForActivation();if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+Y),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+J+(gt?"; was active":wt?"; was pending":Dt?"; was proposed":"")+(Qt?"":"; another transport is scheduled for activation")),tt&&tt.message&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+tt.message),gt&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(et.getPendingMessages()),C.default.Config.nextTick(function(){et.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",Y),gt&&Qt||gt&&J==="failed"||J==="closed"||et===null&&wt&&this.pendingTransports.length===0){if(J==="disconnected"&&tt&&tt.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:J,error:tt,retryImmediately:!0});return}var te=J==="failed"&&D.default.isTokenErr(tt)?"disconnected":J;this.notifyState({state:te,error:tt});return}gt&&J==="disconnected"&&this.state!==this.states.synchronizing&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:tt}))},at.prototype.noTransportsScheduledForActivation=function(){return g.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(Y){return!Y.isConnected})},at.prototype.setConnection=function(Y,J,tt){var et=this.connectionId,gt=et&&et!==Y,wt=!et&&tt;(gt||wt)&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==Y&&v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=Y,this.realtime.connection.key=this.connectionKey=J.connectionKey},at.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},at.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},at.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var Y=g.now()-this.lastActivity;Y>this.connectionStateTtl+this.maxIdleInterval&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+Y+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},at.prototype.persistConnection=function(){if(B()){var Y=this.createRecoveryKey();Y&&V({recoveryKey:Y,disconnectedAt:g.now(),location:l.location,clientId:this.realtime.auth.clientId})}},at.prototype.unpersistConnection=function(){U()},at.prototype.getError=function(){return this.errorReason||this.getStateError()},at.prototype.getStateError=function(){var Y,J;return(J=(Y=z.default)[this.state.state])===null||J===void 0?void 0:J.call(Y)},at.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},at.prototype.enactStateChange=function(Y){var J=Y.current==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(J,"Connection state",Y.current+(Y.reason?"; reason: "+Y.reason:"")),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+Y.current+"; reason = "+(Y.reason&&Y.reason.message));var tt=this.state=this.states[Y.current];Y.reason&&(this.errorReason=Y.reason,this.realtime.connection.errorReason=Y.reason),(tt.terminal||tt.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",Y)},at.prototype.startTransitionTimer=function(Y){var J=this;v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+Y.state),this.transitionTimer&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){J.transitionTimer&&(J.transitionTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager "+Y.state+" timer expired","requesting new state: "+Y.failState),J.notifyState({state:Y.failState}))},Y.retryDelay)},at.prototype.cancelTransitionTimer=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},at.prototype.startSuspendTimer=function(){var Y=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){Y.suspendTimer&&(Y.suspendTimer=null,v.default.logAction(v.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),Y.states.connecting.failState="suspended",Y.notifyState({state:"suspended"}))},this.connectionStateTtl))},at.prototype.checkSuspendTimer=function(Y){Y!=="disconnected"&&Y!=="suspended"&&Y!=="connecting"&&this.cancelSuspendTimer()},at.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},at.prototype.startRetryTimer=function(Y){var J=this;this.retryTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),J.retryTimer=null,J.requestState({state:"connecting"})},Y)},at.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},at.prototype.notifyState=function(Y){var J=this,tt,et,gt=Y.state,wt=gt==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||Y.retryImmediately||this.state===this.states.connecting&&Y.error&&D.default.isTokenErr(Y.error)&&!(this.errorReason&&D.default.isTokenErr(this.errorReason)));if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+gt+(wt?"; will retry connection immediately":"")),gt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(Y.state),(gt==="suspended"||gt==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var Dt=this.states[Y.state],Qt=Dt.retryDelay;Dt.state==="disconnected"&&(this.disconnectedRetryCount++,Qt=g.getRetryTime(Dt.retryDelay,this.disconnectedRetryCount));var te=new M.default(this.state.state,Dt.state,Qt,Y.error||((et=(tt=z.default)[Dt.state])===null||et===void 0?void 0:et.call(tt)));if(wt){var se=function(){J.state===J.states.disconnected&&(J.lastAutoReconnectAttempt=g.now(),J.requestState({state:"connecting"}))},kt=this.lastAutoReconnectAttempt&&g.now()-this.lastAutoReconnectAttempt+1;kt&&kt<1e3?(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+kt+"ms ago, waiting another "+(1e3-kt)+"ms before trying again"),setTimeout(se,1e3-kt)):C.default.Config.nextTick(se)}else(gt==="disconnected"||gt==="suspended")&&this.startRetryTimer(Qt);(gt==="disconnected"&&!wt||gt==="suspended"||Dt.terminal)&&C.default.Config.nextTick(function(){J.disconnectAllTransports()}),gt=="connected"&&!this.activeProtocol&&v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(te),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(gt,te.reason),this.failQueuedMessages(te.reason))}},at.prototype.requestState=function(Y){var J=this,tt,et,gt=Y.state;if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+gt+"; current state: "+this.state.state),gt!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(gt),!(gt=="connecting"&&this.state.state=="connected")&&!(gt=="closing"&&this.state.state=="closed"))){var wt=this.states[gt],Dt=new M.default(this.state.state,wt.state,null,Y.error||((et=(tt=z.default)[wt.state])===null||et===void 0?void 0:et.call(tt)));this.enactStateChange(Dt),gt=="connecting"&&C.default.Config.nextTick(function(){J.startConnect()}),gt=="closing"&&this.closeImpl()}},at.prototype.startConnect=function(){var Y=this;if(this.state!==this.states.connecting){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var J=this.realtime.auth,tt=++this.connectCounter,et=function(){Y.checkConnectionStateFreshness(),Y.getTransportParams(function(wt){if(wt.mode==="recover"&&wt.options.recover){var Dt=W(wt.options.recover);Dt&&Y.realtime.channels.recoverChannels(Dt.channelSerials)}tt===Y.connectCounter&&Y.connectImpl(wt,tt)})};if(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),J.method==="basic")et();else{var gt=function(wt){tt===Y.connectCounter&&(wt?Y.actOnErrorFromAuthorize(wt):et())};this.errorReason&&D.default.isTokenErr(this.errorReason)?J._forceNewToken(null,null,gt):J._ensureValidAuthCredentials(!1,gt)}},at.prototype.connectImpl=function(Y,J){var tt=this.state.state;tt!==this.states.connecting.state&&tt!==this.states.connected.state?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+tt):this.pendingTransports.length?v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):tt==this.states.connected.state?this.upgradeIfNeeded(Y):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(Y,J):this.connectBase(Y,J)},at.prototype.connectPreference=function(Y,J){var tt=this,et=this.getTransportPreference(),gt=!1;g.arrIn(this.transports,et)||(this.unpersistTransportPreference(),this.connectImpl(Y,J)),v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+et);var wt=setTimeout(function(){gt=!0,tt.state.state!==tt.states.connected.state&&(v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+et+" failed; clearing preference and trying from scratch"),tt.disconnectAllTransports(),tt.unpersistTransportPreference()),tt.connectImpl(Y,J)},this.options.timeouts.preferenceConnectTimeout);Y.host=this.httpHosts[0],this.tryATransport(Y,et,function(Dt,Qt){clearTimeout(wt),gt&&Qt?(Qt.off(),Qt.disconnect(),g.arrDeleteValue(tt.pendingTransports,Qt)):!Qt&&!Dt&&(tt.unpersistTransportPreference(),tt.connectImpl(Y,J))})},at.prototype.connectBase=function(Y,J){var tt=this,et=function(te){tt.notifyState({state:tt.states.connecting.failState,error:te})},gt=this.httpHosts.slice(),wt=function(te,se){J===tt.connectCounter&&!se&&!te&&Qt()};v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var Dt=gt.shift();if(!Dt){et(new L.default("Unable to connect (no available host)",80003,404));return}Y.host=Dt;var Qt=function(){if(!gt.length){et(new L.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!tt.realtime.http.checkConnectivity){et(new L.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}tt.realtime.http.checkConnectivity(function(te,se){if(J===tt.connectCounter){if(te){et(te);return}if(!se){et(new L.default("Unable to connect (network unreachable)",80003,404));return}Y.host=g.arrPopRandomElement(gt),tt.tryATransport(Y,tt.baseTransport,wt)}})};if(this.forceFallbackHost&&gt.length){this.forceFallbackHost=!1,Qt();return}this.tryATransport(Y,this.baseTransport,wt)},at.prototype.getUpgradePossibilities=function(){var Y=this.activeProtocol.getTransport().shortName,J=g.arrIndexOf(this.upgradeTransports,Y);return this.upgradeTransports.slice(J+1)},at.prototype.upgradeIfNeeded=function(Y){var J=this,tt=this.getUpgradePossibilities();v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect(tt)),tt.length&&g.arrForEach(tt,function(et){var gt=J.createTransportParams(Y.host,"upgrade");J.tryATransport(gt,et,P)})},at.prototype.closeImpl=function(){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),g.safeArrForEach(this.pendingTransports,function(Y){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+Y),Y&&Y.close()}),g.safeArrForEach(this.proposedTransports,function(Y){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+Y),Y&&Y.dispose()}),this.activeProtocol&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},at.prototype.onAuthUpdated=function(Y,J){var tt=this,et;switch(this.state.state){case"connected":{if(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var gt=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){tt.state.state==="connected"&&tt.upgradeIfNeeded(gt)})}var wt=(et=this.activeProtocol)===null||et===void 0?void 0:et.getTransport();wt&&wt.onAuthUpdated&&wt.onAuthUpdated(Y);var Dt=d.default.fromValues({action:j.AUTH,auth:{accessToken:Y.token}});this.send(Dt);var Qt=function(){tt.off(te),J(null,Y)},te=function(kt){kt.current==="failed"&&(tt.off(Qt),tt.off(te),J(kt.reason||tt.getStateError()))};this.once("connectiondetails",Qt),this.on("connectionstate",te);break}case"connecting":v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var se=function(kt){switch(kt.current){case"connected":tt.off(se),J(null,Y);break;case"failed":case"closed":case"suspended":tt.off(se),J(kt.reason||tt.getStateError());break}};this.on("connectionstate",se),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},at.prototype.disconnectAllTransports=function(Y){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(Y?" except the active transport":"")),this.connectCounter++,g.safeArrForEach(this.pendingTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+J),J&&J.disconnect()}),this.pendingTransports=[],g.safeArrForEach(this.proposedTransports,function(J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+J),J&&J.dispose()}),this.proposedTransports=[],this.activeProtocol&&!Y&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},at.prototype.send=function(Y,J,tt){tt=tt||P;var et=this.state;if(et.sendEvents){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new m.PendingMessage(Y,tt));return}var gt=J&&et.queueEvents||et.forceQueueEvents;if(!gt){var wt="rejecting event, queueEvent was "+J+", state was "+et.state;v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()",wt),tt(this.errorReason||new L.default(wt,9e4,400));return}v.default.shouldLog(v.default.LOG_MICRO)&&v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+d.default.stringify(Y)),this.queue(Y,tt)},at.prototype.sendImpl=function(Y){var J=Y.message;Y.ackRequired&&!Y.sendAttempted&&(J.msgSerial=this.msgSerial++);try{this.activeProtocol.send(Y)}catch(tt){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+tt.stack)}},at.prototype.queue=function(Y,J){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var tt=this.queuedMessages.last(),et=this.options.maxMessageSize;tt&&!tt.sendAttempted&&F(tt.message,Y,et)?(tt.merged||(tt.callback=G.default.create([tt.callback]),tt.merged=!0),tt.callback.push(J)):this.queuedMessages.push(new m.PendingMessage(Y,J))},at.prototype.sendQueuedMessages=function(){v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var Y;Y=this.queuedMessages.shift();)this.sendImpl(Y)},at.prototype.queuePendingMessages=function(Y){Y&&Y.length&&(v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+Y.length+" pending messages"),this.queuedMessages.prepend(Y))},at.prototype.failQueuedMessages=function(Y){var J=this.queuedMessages.count();J>0&&(v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+J+" queued messages, err = "+g.inspectError(Y)),this.queuedMessages.completeAllMessages(Y))},at.prototype.onChannelMessage=function(Y,J){var tt=this.activeProtocol&&J===this.activeProtocol.getTransport(),et=g.arrIn(this.pendingTransports,J)&&this.state==this.states.synchronizing;tt||et?this.realtime.channels.onChannelMessage(Y):g.arrIndexOf([j.ACK,j.NACK,j.ERROR],Y.action)>-1?this.realtime.channels.onChannelMessage(Y):v.default.logAction(v.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(Y)+"on defunct transport; discarding")},at.prototype.ping=function(Y,J){var tt=this;if(Y){v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+Y);var et=function(){Y.off("heartbeat",Dt),J(new L.default("Timeout waiting for heartbeat response",5e4,500))},gt=g.now(),wt=g.cheapRandStr(),Dt=function(pe){if(pe===wt){Y.off("heartbeat",Dt),clearTimeout(Qt);var Ee=g.now()-gt;J(null,Ee)}},Qt=setTimeout(et,this.options.timeouts.realtimeRequestTimeout);Y.on("heartbeat",Dt),Y.ping(wt);return}if(this.state.state!=="connected"){J(new L.default("Unable to ping service; not connected",4e4,400));return}var te=!1,se=function(pe,Ee){tt.off("transport.active",kt),te||(te=!0,J(pe,Ee))},kt=function(){te||(te=!0,C.default.Config.nextTick(function(){tt.ping(null,J)}))};this.on("transport.active",kt),this.ping(this.activeProtocol.getTransport(),se)},at.prototype.abort=function(Y){this.activeProtocol.getTransport().fail(Y)},at.prototype.registerProposedTransport=function(Y){this.proposedTransports.push(Y)},at.prototype.getTransportPreference=function(){var Y,J;return this.transportPreference||y()&&((J=(Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.get)===null||J===void 0?void 0:J.call(Y,Q))},at.prototype.persistTransportPreference=function(Y){var J,tt;g.arrIn(_.default.upgradeTransports,Y.shortName)&&(this.transportPreference=Y.shortName,y()&&((tt=(J=C.default.WebStorage)===null||J===void 0?void 0:J.set)===null||tt===void 0||tt.call(J,Q,Y.shortName)))},at.prototype.unpersistTransportPreference=function(){var Y,J;this.transportPreference=null,y()&&((J=(Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.remove)===null||J===void 0||J.call(Y,Q))},at.prototype.actOnErrorFromAuthorize=function(Y){if(Y.code===40171)this.notifyState({state:"failed",error:Y});else if(Y.code===40102)this.notifyState({state:"failed",error:Y});else if(Y.statusCode===T.default.Forbidden){var J="Client configured authentication provider returned 403; failing the connection";v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",J),this.notifyState({state:"failed",error:new L.default(J,80019,403,Y)})}else{var J="Client configured authentication provider request failed";v.default.logAction(v.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",J),this.notifyState({state:this.state.failState,error:new L.default(J,80019,401,Y)})}},at.prototype.onConnectionDetailsUpdate=function(Y,J){if(Y){this.connectionDetails=Y,Y.maxMessageSize&&(this.options.maxMessageSize=Y.maxMessageSize);var tt=Y.clientId;if(tt){var et=this.realtime.auth._uncheckedSetClientId(tt);if(et){v.default.logAction(v.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",et.message),J.fail(et);return}}var gt=Y.connectionStateTtl;gt&&(this.connectionStateTtl=gt),this.maxIdleInterval=Y.maxIdleInterval,this.emit("connectiondetails",Y)}},at.supportedTransports={},at})(E.default);a.default=Z}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(7)),d=l.__importDefault(r(2)),g=(function(m){l.__extends(_,m);function _(){var C=m.call(this)||this;return C.messages=[],C}return _.prototype.count=function(){return this.messages.length},_.prototype.push=function(C){this.messages.push(C)},_.prototype.shift=function(){return this.messages.shift()},_.prototype.last=function(){return this.messages[this.messages.length-1]},_.prototype.copyAll=function(){return this.messages.slice()},_.prototype.append=function(C){this.messages.push.apply(this.messages,C)},_.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},_.prototype.completeMessages=function(C,E,O){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+E),O=O||null;var v=this.messages;if(v.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var M=v[0];if(M){var z=M.message.msgSerial,L=C+E;if(L>z)for(var D=v.splice(0,L-z),N=0,G=D;N<G.length;N++){var R=G[N];R.callback(O)}v.length==0&&this.emit("idle")}},_.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},_.prototype.resetSendAttempted=function(){for(var C=0,E=this.messages;C<E.length;C++){var O=E[C];O.sendAttempted=!1}},_.prototype.clear=function(){d.default.logAction(d.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},_})(c.default);a.default=g}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function c(d,g,m,_){this.previous=d,this.current=g,m&&(this.retryIn=m),_&&(this.reason=_)}return c})();a.default=l}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(10)),d=l.__importDefault(r(7)),g=l.__importStar(r(1)),m=l.__importDefault(r(33)),_=l.__importDefault(r(2)),C=l.__importDefault(r(54)),E=l.__importDefault(r(9)),O=l.__importDefault(r(39)),v=l.__importStar(r(4)),M=l.__importDefault(r(16)),z=l.__importDefault(r(21)),L=c.default.Action,D=function(){};function N(A){if(A&&"params"in A&&!g.isObject(A.params))return new v.default("options.params must be an object",4e4,400);if(A&&"modes"in A){if(!g.isArray(A.modes))return new v.default("options.modes must be an array",4e4,400);for(var T=0;T<A.modes.length;T++){var y=A.modes[T];if(!y||typeof y!="string"||!g.arrIn(c.default.channelModes,String.prototype.toUpperCase.call(y)))return new v.default("Invalid channel mode: "+y,4e4,400)}}}var G=(function(A){l.__extends(T,A);function T(y,B,j){var P=A.call(this,y,B,j)||this;return P.retryCount=0,P.history=function(Q,K){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),K===void 0)if(typeof Q=="function")K=Q,Q=null;else{if(this.rest.options.promises)return g.promisify(this,"history",arguments);K=D}if(Q&&Q.untilAttach){if(this.state!=="attached"){K(new v.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){K(new v.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete Q.untilAttach,Q.from_serial=this.properties.attachSerial}m.default.prototype._history.call(this,Q,K)},P.whenState=(function(Q,K){return d.default.prototype.whenState.call(P,Q,P.state,K)}),_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel()","started; name = "+B),P.realtime=y,P.presence=new C.default(P),P.connectionManager=y.connection.connectionManager,P.state="initialized",P.subscriptions=new d.default,P.syncChannelSerial=void 0,P.properties={attachSerial:void 0,channelSerial:void 0},P.setOptions(j),P.errorReason=null,P._requestedFlags=null,P._mode=null,P._attachResume=!1,P._decodingContext={channelOptions:P.channelOptions,plugins:y.options.plugins||{},baseEncodedPreviousPayload:void 0},P._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},P._allChannelChanges=new d.default,P}return T.prototype.invalidStateError=function(){return new v.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},T.processListenerArgs=function(y){return y=Array.prototype.slice.call(y),typeof y[0]=="function"&&y.unshift(null),y[y.length-1]==null&&y.pop(),y},T.prototype.setOptions=function(y,B){var j=this.channelOptions;if(!B&&this.rest.options.promises)return g.promisify(this,"setOptions",arguments);var P=B||function(K){K&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+K.toString())},Q=N(y);if(Q){P(Q);return}m.default.prototype.setOptions.call(this,y),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(y,j)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(K){switch(this.event){case"update":case"attached":P==null||P(null);return;default:P==null||P(K.reason);return}})):P()},T.prototype._shouldReattachToSetOptions=function(y,B){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(y!=null&&y.params){var j=R(y.params),P=R(B.params);if(Object.keys(j).length!==Object.keys(P).length||!g.shallowEquals(P,j))return!0}return!!(y!=null&&y.modes&&(!B.modes||!g.arrEquals(y.modes,B.modes)))},T.prototype.publish=function(){for(var y=this,B=[],j=0;j<arguments.length;j++)B[j]=arguments[j];var P=B[0],Q=B.length,K=B[Q-1];if(typeof K!="function"){if(this.realtime.options.promises)return g.promisify(this,"publish",arguments);K=D,++Q}if(!this.connectionManager.activeState()){K(this.connectionManager.getError());return}if(Q==2)if(g.isObject(P))P=[E.default.fromValues(P)];else if(g.isArray(P))P=E.default.fromValuesArray(P);else throw new v.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else P=[E.default.fromValues({name:B[0],data:B[1]})];var X=this.realtime.options.maxMessageSize;E.default.encodeArray(P,this.channelOptions,function(V){if(V){K(V);return}var U=E.default.getMessagesSize(P);if(U>X){K(new v.default("Maximum size of messages that can be published at once exceeded ( was "+U+" bytes; limit is "+X+" bytes)",40009,400));return}y.__publish(P,K)})},T.prototype.__publish=function(y,B){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+y.length);var j=this.state;switch(j){case"failed":case"suspended":B(v.default.fromValues(this.invalidStateError()));break;default:{_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+j);var P=new c.default;P.action=L.MESSAGE,P.channel=this.name,P.messages=y,this.sendMessage(P,B);break}}},T.prototype.onEvent=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var B=this.subscriptions,j=0;j<y.length;j++){var P=y[j];B.emit(P.name,P)}},T.prototype.attach=function(y,B){var j;if(typeof y=="function"?(B=y,j=null):j=y,!B){if(this.realtime.options.promises)return g.promisify(this,"attach",arguments);B=function(P){P&&_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+P.toString())}}if(j)_.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=j;else if(this.state==="attached"){B(null,null);return}this._attach(!1,null,B)},T.prototype._attach=function(y,B,j){j||(j=function(Q){Q&&_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+Q.toString())});var P=this.connectionManager;if(!P.activeState()){j(P.getError());return}(this.state!=="attaching"||y)&&this.requestState("attaching",B),this.once(function(Q){switch(this.event){case"attached":j==null||j(null,Q);break;case"detached":case"suspended":case"failed":j==null||j(Q.reason||P.getError()||new v.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":j==null||j(new v.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},T.prototype.attachImpl=function(){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var y=c.default.fromValues({action:L.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?y.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&y.encodeModesToFlags(g.allToUpperCase(this.channelOptions.modes)),this._attachResume&&y.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(y.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(y,D)},T.prototype.detach=function(y){if(!y){if(this.realtime.options.promises)return g.promisify(this,"detach",arguments);y=D}var B=this.connectionManager;if(!B.activeState()){y(B.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),y();break;case"detached":y();break;case"failed":y(new v.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(j){switch(this.event){case"detached":y();break;case"attached":case"suspended":case"failed":y(j.reason||B.getError()||new v.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":y(new v.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},T.prototype.detachImpl=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var B=c.default.fromValues({action:L.DETACH,channel:this.name});this.sendMessage(B,y||D)},T.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var j=T.processListenerArgs(y),P=j[0],Q=j[1],K=j[2];if(!K&&this.realtime.options.promises)return g.promisify(this,"subscribe",[P,Q]);if(this.state==="failed"){K==null||K(v.default.fromValues(this.invalidStateError()));return}return P&&typeof P=="object"&&!Array.isArray(P)?this._subscribeFilter(P,Q):this.subscriptions.on(P,Q),this.attach(K||D)},T.prototype._subscribeFilter=function(y,B){var j=function(P){var Q,K,X,V,U,I,F={name:P.name,refTimeserial:(K=(Q=P.extras)===null||Q===void 0?void 0:Q.ref)===null||K===void 0?void 0:K.timeserial,refType:(V=(X=P.extras)===null||X===void 0?void 0:X.ref)===null||V===void 0?void 0:V.type,isRef:!!(!((I=(U=P.extras)===null||U===void 0?void 0:U.ref)===null||I===void 0)&&I.timeserial),clientId:P.clientId};Object.entries(y).find(function(W){var it=W[0],Z=W[1];return Z!==void 0?F[it]!==Z:!1})||B(P)};this._addFilteredSubscription(y,B,j),this.subscriptions.on(j)},T.prototype._addFilteredSubscription=function(y,B,j){var P;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(B)){var Q=this.filteredSubscriptions.get(B);Q.set(y,((P=Q==null?void 0:Q.get(y))===null||P===void 0?void 0:P.concat(j))||[j])}else this.filteredSubscriptions.set(B,new Map([[y,[j]]]))},T.prototype._getAndDeleteFilteredSubscriptions=function(y,B){var j=this;if(!this.filteredSubscriptions)return[];if(!B&&y)return Array.from(this.filteredSubscriptions.entries()).map(function(X){var V,U=X[0],I=X[1],F=I.get(y);return I.delete(y),I.size===0&&((V=j.filteredSubscriptions)===null||V===void 0||V.delete(U)),F}).reduce(function(X,V){var U;return V?(U=X).concat.apply(U,V):X},[]);if(!B||!this.filteredSubscriptions.has(B))return[];var P=this.filteredSubscriptions.get(B);if(!y){var Q=Array.from(P.values()).reduce(function(X,V){return X.concat.apply(X,V)},[]);return this.filteredSubscriptions.delete(B),Q}var K=P.get(y);return P.delete(y),K||[]},T.prototype.unsubscribe=function(){for(var y=this,B,j=[],P=0;P<arguments.length;P++)j[P]=arguments[P];var Q=T.processListenerArgs(j),K=Q[0],X=Q[1];if(typeof K=="object"&&!X||!((B=this.filteredSubscriptions)===null||B===void 0)&&B.has(X)){this._getAndDeleteFilteredSubscriptions(K,X).forEach(function(V){return y.subscriptions.off(V)});return}this.subscriptions.off(K,X)},T.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new v.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var y=this.connectionManager;if(!y.activeState())throw y.getError();var B=c.default.fromValues({action:L.SYNC,channel:this.name});this.syncChannelSerial&&(B.channelSerial=this.syncChannelSerial),y.send(B)},T.prototype.sendMessage=function(y,B){this.connectionManager.send(y,this.realtime.options.queueMessages,B)},T.prototype.sendPresence=function(y,B){var j=c.default.fromValues({action:L.PRESENCE,channel:this.name,presence:g.isArray(y)?M.default.fromValuesArray(y):[M.default.fromValues(y)]});this.sendMessage(j,B)},T.prototype.onMessage=function(y){(y.action===L.ATTACHED||y.action===L.MESSAGE||y.action===L.PRESENCE)&&this.setChannelSerial(y.channelSerial);var B,j=!1;switch(y.action){case L.ATTACHED:{this.properties.attachSerial=y.channelSerial,this._mode=y.getMode(),this.params=y.params||{};var P=y.decodeModesFromFlags();this.modes=P&&g.allToLowerCase(P)||void 0;var Q=y.hasFlag("RESUMED"),K=y.hasFlag("HAS_PRESENCE"),X=y.hasFlag("HAS_BACKLOG");if(this.state==="attached"){Q||this.presence.onAttached(K);var V=new O.default(this.state,this.state,Q,X,y.error);this._allChannelChanges.emit("update",V),(!Q||this.channelOptions.updateOnAttached)&&this.emit("update",V)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",y.error,Q,K,X);break}case L.DETACHED:{var U=y.error?v.default.fromValues(y.error):new v.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",U):this.state==="attaching"?this.notifyState("suspended",U):this.requestState("attaching",U);break}case L.SYNC:if(j=!0,B=this.syncChannelSerial=y.channelSerial,!y.presence)break;case L.PRESENCE:{for(var I=y.presence,F=y.id,W=y.connectionId,it=y.timestamp,Z=this.channelOptions,rt=void 0,at=0;at<I.length;at++)try{rt=I[at],M.default.decode(rt,Z),rt.connectionId||(rt.connectionId=W),rt.timestamp||(rt.timestamp=it),rt.id||(rt.id=F+":"+at)}catch(wt){_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",wt.toString())}this.presence.setPresence(I,j,B);break}case L.MESSAGE:{if(this.state!=="attached"){_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+y.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var Y=y.messages,J=Y[0],tt=Y[Y.length-1],F=y.id,W=y.connectionId,it=y.timestamp;if(J.extras&&J.extras.delta&&J.extras.delta.from!==this._lastPayload.messageId){var et='Delta message decode failure - previous message not available for message "'+y.id+'" on this channel "'+this.name+'".';_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",et),this._startDecodeFailureRecovery(new v.default(et,40018,400));break}for(var at=0;at<Y.length;at++){var et=Y[at];try{E.default.decode(et,this._decodingContext)}catch(kt){switch(_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()",kt.toString()),kt.code){case 40018:this._startDecodeFailureRecovery(kt);return;case 40019:case 40021:this.notifyState("failed",kt);return}}et.connectionId||(et.connectionId=W),et.timestamp||(et.timestamp=it),et.id||(et.id=F+":"+at)}this._lastPayload.messageId=tt.id,this._lastPayload.protocolMessageChannelSerial=y.channelSerial,this.onEvent(Y);break}case L.ERROR:{var gt=y.error;gt&&gt.code==80016?this.checkPendingState():this.notifyState("failed",v.default.fromValues(gt));break}default:_.default.logAction(_.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+y.action+")"),this.connectionManager.abort(z.default.unknownChannelErr())}},T.prototype._startDecodeFailureRecovery=function(y){var B=this;this._lastPayload.decodeFailureRecoveryInProgress||(_.default.logAction(_.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,y,function(){B._lastPayload.decodeFailureRecoveryInProgress=!1}))},T.prototype.onAttached=function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},T.prototype.notifyState=function(y,B,j,P,Q){if(_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+y),this.clearStateTimer(),g.arrIn(["detached","suspended","failed"],y)&&(this.properties.channelSerial=null),y!==this.state){this.presence.actOnChannelState(y,P,B),y==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),B&&(this.errorReason=B);var K=new O.default(this.state,y,j,Q,B),X=y==="failed"?_.default.LOG_ERROR:_.default.LOG_MAJOR;_.default.logAction(X,'Channel state for channel "'+this.name+'"',y+(B?"; reason: "+B:"")),y!=="attaching"&&y!=="suspended"&&(this.retryCount=0),y==="attached"&&this.onAttached(),y==="attached"?this._attachResume=!0:(y==="detaching"||y==="failed")&&(this._attachResume=!1),this.state=y,this._allChannelChanges.emit(y,K),this.emit(y,K)}},T.prototype.requestState=function(y,B){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+y),this.notifyState(y,B),this.checkPendingState()},T.prototype.checkPendingState=function(){var y=this.connectionManager.state;if(!(y.sendEvents||y.forceQueueEvents)){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},T.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var y=new v.default("Channel attach timed out",90007,408);this.notifyState("suspended",y);break}case"detaching":{var y=new v.default("Channel detach timed out",90007,408);this.notifyState("attached",y);break}default:this.checkPendingState();break}},T.prototype.startStateTimerIfNotRunning=function(){var y=this;this.stateTimer||(this.stateTimer=setTimeout(function(){_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),y.stateTimer=null,y.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},T.prototype.clearStateTimer=function(){var y=this.stateTimer;y&&(clearTimeout(y),this.stateTimer=null)},T.prototype.startRetryTimer=function(){var y=this;if(!this.retryTimer){this.retryCount++;var B=g.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){y.state==="suspended"&&y.connectionManager.state.sendEvents&&(y.retryTimer=null,_.default.logAction(_.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),y.requestState("attaching"))},B)}},T.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},T.prototype.getReleaseErr=function(){var y=this.state;return y==="initialized"||y==="detached"||y==="failed"?null:new v.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+y,90001,400)},T.prototype.setChannelSerial=function(y){_.default.logAction(_.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+y+"; previous = "+this.properties.channelSerial),y&&(this.properties.channelSerial=y)},T})(m.default);function R(A){var T=A||{};T.agent;var y=l.__rest(T,["agent"]);return y}a.default=G}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=(function(){function c(d,g,m,_,C){this.previous=d,this.current=g,g==="attached"&&(this.resumed=m,this.hasBacklog=_),C&&(this.reason=C)}return c})();a.default=l}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=d.Hasher,_=c.algo,C=[],E=_.SHA1=m.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(O,v){for(var M=this._hash.words,z=M[0],L=M[1],D=M[2],N=M[3],G=M[4],R=0;R<80;R++){if(R<16)C[R]=O[v+R]|0;else{var A=C[R-3]^C[R-8]^C[R-14]^C[R-16];C[R]=A<<1|A>>>31}var T=(z<<5|z>>>27)+G+C[R];R<20?T+=(L&D|~L&N)+1518500249:R<40?T+=(L^D^N)+1859775393:R<60?T+=(L&D|L&N|D&N)-1894007588:T+=(L^D^N)-899497514,G=N,N=D,D=L<<30|L>>>2,L=z,z=T}M[0]=M[0]+z|0,M[1]=M[1]+L|0,M[2]=M[2]+D|0,M[3]=M[3]+N|0,M[4]=M[4]+G|0},_doFinalize:function(){var O=this._data,v=O.words,M=this._nDataBytes*8,z=O.sigBytes*8;return v[z>>>5]|=128<<24-z%32,v[(z+64>>>9<<4)+14]=Math.floor(M/4294967296),v[(z+64>>>9<<4)+15]=M,O.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var O=m.clone.call(this);return O._hash=this._hash.clone(),O}});c.SHA1=m._createHelper(E),c.HmacSHA1=m._createHmacHelper(E)})(),l.SHA1})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});function l(R){if(R===void 0)return"undefined";var A,T;if(R instanceof ArrayBuffer?(T="ArrayBuffer",A=new DataView(R)):R instanceof DataView&&(T="DataView",A=R),!A)return JSON.stringify(R);for(var y=[],B=0;B<R.byteLength;B++){if(B>20){y.push("...");break}var j=A.getUint8(B).toString(16);j.length===1&&(j="0"+j),y.push(j)}return"<"+T+" "+y.join(" ")+">"}function c(R,A,T){for(var y=0,B=T.length;y<B;y++){var j=T.charCodeAt(y);if(j<128){R.setUint8(A++,j>>>0&127|0);continue}if(j<2048){R.setUint8(A++,j>>>6&31|192),R.setUint8(A++,j>>>0&63|128);continue}if(j<65536){R.setUint8(A++,j>>>12&15|224),R.setUint8(A++,j>>>6&63|128),R.setUint8(A++,j>>>0&63|128);continue}if(j<1114112){R.setUint8(A++,j>>>18&7|240),R.setUint8(A++,j>>>12&63|128),R.setUint8(A++,j>>>6&63|128),R.setUint8(A++,j>>>0&63|128);continue}throw new Error("bad codepoint "+j)}}function d(R,A,T){for(var y="",B=A,j=A+T;B<j;B++){var P=R.getUint8(B);if((P&128)===0){y+=String.fromCharCode(P);continue}if((P&224)===192){y+=String.fromCharCode((P&15)<<6|R.getUint8(++B)&63);continue}if((P&240)===224){y+=String.fromCharCode((P&15)<<12|(R.getUint8(++B)&63)<<6|(R.getUint8(++B)&63)<<0);continue}if((P&248)===240){y+=String.fromCharCode((P&7)<<18|(R.getUint8(++B)&63)<<12|(R.getUint8(++B)&63)<<6|(R.getUint8(++B)&63)<<0);continue}throw new Error("Invalid byte "+P.toString(16))}return y}function g(R){for(var A=0,T=0,y=R.length;T<y;T++){var B=R.charCodeAt(T);if(B<128){A+=1;continue}if(B<2048){A+=2;continue}if(B<65536){A+=3;continue}if(B<1114112){A+=4;continue}throw new Error("bad codepoint "+B)}return A}function m(R,A){var T=G(R,A);if(T!==0){var y=new ArrayBuffer(T),B=new DataView(y);return N(R,B,0,A),y}}var _=65536*65536,C=1/_;function E(R,A){return A=A||0,R.getInt32(A)*_+R.getUint32(A+4)}function O(R,A){return A=A||0,R.getUint32(A)*_+R.getUint32(A+4)}function v(R,A,T){T<9223372036854776e3?(R.setInt32(A,Math.floor(T*C)),R.setInt32(A+4,T&-1)):(R.setUint32(A,2147483647),R.setUint32(A+4,2147483647))}function M(R,A,T){T<18446744073709552e3?(R.setUint32(A,Math.floor(T*C)),R.setInt32(A+4,T&-1)):(R.setUint32(A,4294967295),R.setUint32(A+4,4294967295))}var z=(function(){function R(A,T){var y=this;this.map=function(B){for(var j={},P=0;P<B;P++){var Q=y.parse();j[Q]=y.parse()}return j},this.bin=function(B){var j=new ArrayBuffer(B);return new Uint8Array(j).set(new Uint8Array(y.view.buffer,y.offset,B),0),y.offset+=B,j},this.buf=this.bin,this.str=function(B){var j=d(y.view,y.offset,B);return y.offset+=B,j},this.array=function(B){for(var j=new Array(B),P=0;P<B;P++)j[P]=y.parse();return j},this.ext=function(B){return y.offset+=B,{type:y.view.getInt8(y.offset),data:y.buf(B)}},this.parse=function(){var B=y.view.getUint8(y.offset),j,P;if((B&128)===0)return y.offset++,B;if((B&240)===128)return P=B&15,y.offset++,y.map(P);if((B&240)===144)return P=B&15,y.offset++,y.array(P);if((B&224)===160)return P=B&31,y.offset++,y.str(P);if((B&224)===224)return j=y.view.getInt8(y.offset),y.offset++,j;switch(B){case 192:return y.offset++,null;case 193:y.offset++;return;case 194:return y.offset++,!1;case 195:return y.offset++,!0;case 196:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.bin(P);case 197:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.bin(P);case 198:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.bin(P);case 199:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.ext(P);case 200:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.ext(P);case 201:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.ext(P);case 202:return j=y.view.getFloat32(y.offset+1),y.offset+=5,j;case 203:return j=y.view.getFloat64(y.offset+1),y.offset+=9,j;case 204:return j=y.view.getUint8(y.offset+1),y.offset+=2,j;case 205:return j=y.view.getUint16(y.offset+1),y.offset+=3,j;case 206:return j=y.view.getUint32(y.offset+1),y.offset+=5,j;case 207:return j=O(y.view,y.offset+1),y.offset+=9,j;case 208:return j=y.view.getInt8(y.offset+1),y.offset+=2,j;case 209:return j=y.view.getInt16(y.offset+1),y.offset+=3,j;case 210:return j=y.view.getInt32(y.offset+1),y.offset+=5,j;case 211:return j=E(y.view,y.offset+1),y.offset+=9,j;case 212:return P=1,y.offset++,y.ext(P);case 213:return P=2,y.offset++,y.ext(P);case 214:return P=4,y.offset++,y.ext(P);case 215:return P=8,y.offset++,y.ext(P);case 216:return P=16,y.offset++,y.ext(P);case 217:return P=y.view.getUint8(y.offset+1),y.offset+=2,y.str(P);case 218:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.str(P);case 219:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.str(P);case 220:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.array(P);case 221:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.array(P);case 222:return P=y.view.getUint16(y.offset+1),y.offset+=3,y.map(P);case 223:return P=y.view.getUint32(y.offset+1),y.offset+=5,y.map(P)}throw new Error("Unknown type 0x"+B.toString(16))},this.offset=T||0,this.view=A}return R})();function L(R){var A=new DataView(R),T=new z(A),y=T.parse();if(T.offset!==R.byteLength)throw new Error(R.byteLength-T.offset+" trailing bytes");return y}function D(R,A){return Object.keys(R).filter(function(T){var y=R[T],B=typeof y;return(!A||y!=null)&&(B!=="function"||!!y.toJSON)})}function N(R,A,T,y){var B=typeof R;if(typeof R=="string"){var j=g(R);if(j<32)return A.setUint8(T,j|160),c(A,T+1,R),1+j;if(j<256)return A.setUint8(T,217),A.setUint8(T+1,j),c(A,T+2,R),2+j;if(j<65536)return A.setUint8(T,218),A.setUint16(T+1,j),c(A,T+3,R),3+j;if(j<4294967296)return A.setUint8(T,219),A.setUint32(T+1,j),c(A,T+5,R),5+j}if(ArrayBuffer.isView&&ArrayBuffer.isView(R)&&(R=R.buffer),R instanceof ArrayBuffer){var P=R.byteLength;if(P<256)return A.setUint8(T,196),A.setUint8(T+1,P),new Uint8Array(A.buffer).set(new Uint8Array(R),T+2),2+P;if(P<65536)return A.setUint8(T,197),A.setUint16(T+1,P),new Uint8Array(A.buffer).set(new Uint8Array(R),T+3),3+P;if(P<4294967296)return A.setUint8(T,198),A.setUint32(T+1,P),new Uint8Array(A.buffer).set(new Uint8Array(R),T+5),5+P}if(typeof R=="number"){if(Math.floor(R)!==R)return A.setUint8(T,203),A.setFloat64(T+1,R),9;if(R>=0){if(R<128)return A.setUint8(T,R),1;if(R<256)return A.setUint8(T,204),A.setUint8(T+1,R),2;if(R<65536)return A.setUint8(T,205),A.setUint16(T+1,R),3;if(R<4294967296)return A.setUint8(T,206),A.setUint32(T+1,R),5;if(R<18446744073709552e3)return A.setUint8(T,207),M(A,T+1,R),9;throw new Error("Number too big 0x"+R.toString(16))}if(R>=-32)return A.setInt8(T,R),1;if(R>=-128)return A.setUint8(T,208),A.setInt8(T+1,R),2;if(R>=-32768)return A.setUint8(T,209),A.setInt16(T+1,R),3;if(R>=-2147483648)return A.setUint8(T,210),A.setInt32(T+1,R),5;if(R>=-9223372036854776e3)return A.setUint8(T,211),v(A,T+1,R),9;throw new Error("Number too small -0x"+(-R).toString(16).substr(1))}if(B==="undefined")return y?0:(A.setUint8(T,212),A.setUint8(T+1,0),A.setUint8(T+2,0),3);if(R===null)return y?0:(A.setUint8(T,192),1);if(B==="boolean")return A.setUint8(T,R?195:194),1;if(typeof R.toJSON=="function")return N(R.toJSON(),A,T,y);if(B==="object"){var Q,K=0,X=void 0,V=Array.isArray(R);if(V?Q=R.length:(X=D(R,y),Q=X.length),Q<16?(A.setUint8(T,Q|(V?144:128)),K=1):Q<65536?(A.setUint8(T,V?220:222),A.setUint16(T+1,Q),K=3):Q<4294967296&&(A.setUint8(T,V?221:223),A.setUint32(T+1,Q),K=5),V)for(var U=0;U<Q;U++)K+=N(R[U],A,T+K,y);else if(X)for(var U=0;U<Q;U++){var I=X[U];K+=N(I,A,T+K),K+=N(R[I],A,T+K,y)}return K}if(B==="function")return 0;throw new Error("Unknown type "+B)}function G(R,A){var T=typeof R;if(T==="string"){var y=g(R);if(y<32)return 1+y;if(y<256)return 2+y;if(y<65536)return 3+y;if(y<4294967296)return 5+y}if(ArrayBuffer.isView&&ArrayBuffer.isView(R)&&(R=R.buffer),R instanceof ArrayBuffer){var B=R.byteLength;if(B<256)return 2+B;if(B<65536)return 3+B;if(B<4294967296)return 5+B}if(typeof R=="number"){if(Math.floor(R)!==R)return 9;if(R>=0){if(R<128)return 1;if(R<256)return 2;if(R<65536)return 3;if(R<4294967296)return 5;if(R<18446744073709552e3)return 9;throw new Error("Number too big 0x"+R.toString(16))}if(R>=-32)return 1;if(R>=-128)return 2;if(R>=-32768)return 3;if(R>=-2147483648)return 5;if(R>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+R.toString(16).substr(1))}if(T==="boolean")return 1;if(R===null)return A?0:1;if(R===void 0)return A?0:3;if(typeof R.toJSON=="function")return G(R.toJSON(),A);if(T==="object"){var j,P=0;if(Array.isArray(R)){j=R.length;for(var Q=0;Q<j;Q++)P+=G(R[Q],A)}else{var K=D(R,A);j=K.length;for(var Q=0;Q<j;Q++){var X=K[Q];P+=G(X)+G(R[X],A)}}if(j<16)return 1+P;if(j<65536)return 3+P;if(j<4294967296)return 5+P;throw new Error("Array or object too long 0x"+j.toString(16))}if(T==="function")return 0;throw new Error("Unknown type "+T)}a.default={encode:m,decode:L,inspect:l,utf8Write:c,utf8Read:d,utf8ByteCount:g}}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(30)),d=l.__importDefault(r(50)),g=l.__importDefault(r(3)),m=l.__importDefault(r(4)),_=l.__importDefault(r(55)),C=l.__importDefault(r(57)),E=l.__importDefault(r(62)),O=l.__importDefault(r(64)),v=l.__importDefault(r(68)),M=l.__importDefault(r(2)),z=r(8),L=l.__importDefault(r(65)),D=l.__importDefault(r(66)),N=l.__importDefault(r(41)),G=(0,C.default)(O.default,_.default);g.default.Crypto=G,g.default.BufferUtils=_.default,g.default.Http=E.default,g.default.Config=O.default,g.default.Transports=v.default,g.default.WebStorage=L.default,c.default.Crypto=G,d.default.Crypto=G,M.default.initLogHandlers(),g.default.Defaults=(0,z.getDefaults)(D.default),g.default.Config.agent&&(g.default.Defaults.agent+=" "+g.default.Config.agent),g.default.Config.noUpgrade&&(g.default.Defaults.upgradeTransports=[]),a.default={ErrorInfo:m.default,Rest:c.default,Realtime:d.default,msgpack:N.default}}),(function(n){n.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')}),(function(n,a){}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(32),r(25))})(this,function(l){return l.HmacSHA256})}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(47)),g=l.__importDefault(r(15)),m=l.__importDefault(r(20)),_=l.__importDefault(r(4)),C=l.__importDefault(r(48)),E=function(){},O=(function(){function L(D){this.rest=D,this.admin=new v(D)}return L})(),v=(function(){function L(D){this.rest=D,this.deviceRegistrations=new M(D),this.channelSubscriptions=new z(D)}return L.prototype.publish=function(D,N,G){var R=this.rest,A=R.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultPostHeaders(R.options,A),y={},B=c.mixin({recipient:D},N);if(typeof G!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);G=E}R.options.headers&&c.mixin(T,R.options.headers),R.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var j=c.encodeBody(B,A);g.default.post(R,"/push/publish",j,T,y,null,function(P){return G(P)})},L})(),M=(function(){function L(D){this.rest=D}return L.prototype.save=function(D,N){var G=this.rest,R=d.default.fromValues(D),A=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultPostHeaders(G.options,A),y={};if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),G.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var B=c.encodeBody(R,A);g.default.put(G,"/push/deviceRegistrations/"+encodeURIComponent(D.id),B,T,y,null,function(j,P,Q,K){N(j,j?void 0:d.default.fromResponseBody(P,K?void 0:A))})},L.prototype.get=function(D,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultGetHeaders(G.options,R),T=D.id||D;if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"get",arguments);N=E}if(typeof T!="string"||!T.length){N(new _.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&c.mixin(A,G.options.headers),g.default.get(G,"/push/deviceRegistrations/"+encodeURIComponent(T),A,{},null,function(y,B,j,P){N(y,y?void 0:d.default.fromResponseBody(B,P?void 0:R))})},L.prototype.list=function(D,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:R,T=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),new m.default(G,"/push/deviceRegistrations",T,A,function(y,B,j){return d.default.fromResponseBody(y,j?void 0:R)}).get(D,N)},L.prototype.remove=function(D,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultGetHeaders(G.options,R),T={},y=D.id||D;if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"remove",arguments);N=E}if(typeof y!="string"||!y.length){N(new _.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}G.options.headers&&c.mixin(A,G.options.headers),G.options.pushFullWait&&c.mixin(T,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations/"+encodeURIComponent(y),A,T,null,function(B){return N(B)})},L.prototype.removeWhere=function(D,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);N=E}G.options.headers&&c.mixin(A,G.options.headers),G.options.pushFullWait&&c.mixin(D,{fullWait:"true"}),g.default.delete(G,"/push/deviceRegistrations",A,D,null,function(T){return N(T)})},L})(),z=(function(){function L(D){this.remove=L.prototype.removeWhere,this.rest=D}return L.prototype.save=function(D,N){var G=this.rest,R=C.default.fromValues(D),A=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,T=c.defaultPostHeaders(G.options,A),y={};if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),G.options.pushFullWait&&c.mixin(y,{fullWait:"true"});var B=c.encodeBody(R,A);g.default.post(G,"/push/channelSubscriptions",B,T,y,null,function(j,P,Q,K){N(j,!j&&C.default.fromResponseBody(P,K?void 0:A))})},L.prototype.list=function(D,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:R,T=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),new m.default(G,"/push/channelSubscriptions",T,A,function(y,B,j){return C.default.fromResponseBody(y,j?void 0:R)}).get(D,N)},L.prototype.removeWhere=function(D,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);N=E}G.options.headers&&c.mixin(A,G.options.headers),G.options.pushFullWait&&c.mixin(D,{fullWait:"true"}),g.default.delete(G,"/push/channelSubscriptions",A,D,null,function(T){return N(T)})},L.prototype.listChannels=function(D,N){var G=this.rest,R=G.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,A=this.rest.http.supportsLinkHeaders?void 0:R,T=c.defaultGetHeaders(G.options,R);if(typeof N!="function"){if(this.rest.options.promises)return c.promisify(this,"listChannels",arguments);N=E}G.options.headers&&c.mixin(T,G.options.headers),G.options.pushFullWait&&c.mixin(D,{fullWait:"true"}),new m.default(G,"/push/channels",T,A,function(y,B,j){for(var P=!j&&R?c.decodeBody(y,R):y,Q=0;Q<P.length;Q++)P[Q]=String(P[Q]);return P}).get(D,N)},L})();a.default=O}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(4)),g;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(g||(g={}));var m;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(m||(m={}));var _=(function(){function C(){}return C.prototype.toJSON=function(){var E,O,v;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(E=this.push)===null||E===void 0?void 0:E.recipient,state:(O=this.push)===null||O===void 0?void 0:O.state,error:(v=this.push)===null||v===void 0?void 0:v.error}}},C.prototype.toString=function(){var E,O,v,M,z="[DeviceDetails";return this.id&&(z+="; id="+this.id),this.platform&&(z+="; platform="+this.platform),this.formFactor&&(z+="; formFactor="+this.formFactor),this.clientId&&(z+="; clientId="+this.clientId),this.metadata&&(z+="; metadata="+this.metadata),this.deviceIdentityToken&&(z+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((E=this.push)===null||E===void 0)&&E.recipient&&(z+="; push.recipient="+JSON.stringify(this.push.recipient)),!((O=this.push)===null||O===void 0)&&O.state&&(z+="; push.state="+this.push.state),!((v=this.push)===null||v===void 0)&&v.error&&(z+="; push.error="+JSON.stringify(this.push.error)),!((M=this.push)===null||M===void 0)&&M.metadata&&(z+="; push.metadata="+this.push.metadata),z+="]",z},C.fromResponseBody=function(E,O){return O&&(E=c.decodeBody(E,O)),c.isArray(E)?C.fromValuesArray(E):C.fromValues(E)},C.fromValues=function(E){return E.error=E.error&&d.default.fromValues(E.error),Object.assign(new C,E)},C.fromValuesArray=function(E){for(var O=E.length,v=new Array(O),M=0;M<O;M++)v[M]=C.fromValues(E[M]);return v},C.toRequestBody=c.encodeBody,C})();a.default=_}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=(function(){function g(){}return g.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},g.prototype.toString=function(){var m="[PushChannelSubscription";return this.channel&&(m+="; channel="+this.channel),this.deviceId&&(m+="; deviceId="+this.deviceId),this.clientId&&(m+="; clientId="+this.clientId),m+="]",m},g.fromResponseBody=function(m,_){return _&&(m=c.decodeBody(m,_)),c.isArray(m)?g.fromValuesArray(m):g.fromValues(m)},g.fromValues=function(m){return Object.assign(new g,m)},g.fromValuesArray=function(m){for(var _=m.length,C=new Array(_),E=0;E<_;E++)C[E]=g.fromValues(m[E]);return C},g.toRequestBody=c.encodeBody,g})();a.default=d}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=(function(){function G(R){this.count=R&&R.count||0,this.data=R&&R.data||0,this.uncompressedData=R&&R.uncompressedData||0,this.failed=R&&R.failed||0,this.refused=R&&R.refused||0}return G})(),g=(function(G){l.__extends(R,G);function R(A){var T=G.call(this,A)||this;return A&&A.category&&(T.category={},c.forInOwnNonNullProperties(A.category,function(y){T.category[y]=new d(A.category[y])})),T}return R})(d),m=(function(){function G(R){this.peak=R&&R.peak||0,this.min=R&&R.min||0,this.mean=R&&R.mean||0,this.opened=R&&R.opened||0,this.refused=R&&R.refused||0}return G})(),_=(function(){function G(R){this.succeeded=R&&R.succeeded||0,this.failed=R&&R.failed||0,this.refused=R&&R.refused||0}return G})(),C=(function(){function G(R){this.plain=new m(R&&R.plain),this.tls=new m(R&&R.tls),this.all=new m(R&&R.all)}return G})(),E=(function(){function G(R){this.messages=new g(R&&R.messages),this.presence=new g(R&&R.presence),this.all=new g(R&&R.all)}return G})(),O=(function(){function G(R){this.realtime=new E(R&&R.realtime),this.rest=new E(R&&R.rest),this.webhook=new E(R&&R.webhook),this.sharedQueue=new E(R&&R.sharedQueue),this.externalQueue=new E(R&&R.externalQueue),this.httpEvent=new E(R&&R.httpEvent),this.push=new E(R&&R.push),this.all=new E(R&&R.all)}return G})(),v=(function(){function G(R){this.all=new E(R&&R.all),this.inbound=new O(R&&R.inbound),this.outbound=new O(R&&R.outbound)}return G})(),M=(function(){function G(R){this.all=new E(R&&R.all),this.producerPaid=new v(R&&R.producerPaid),this.consumerPaid=new v(R&&R.consumerPaid)}return G})(),z=(function(){function G(R){this.messages=R&&R.messages||0;var A=R&&R.notifications;this.notifications={invalid:A&&A.invalid||0,attempted:A&&A.attempted||0,successful:A&&A.successful||0,failed:A&&A.failed||0},this.directPublishes=R&&R.directPublishes||0}return G})(),L=(function(){function G(R){this.succeeded=R&&R.succeeded||0,this.skipped=R&&R.skipped||0,this.failed=R&&R.failed||0}return G})(),D=(function(){function G(R){var A=this;this.delta=void 0,R&&R.delta&&(this.delta={},c.forInOwnNonNullProperties(R.delta,function(T){A.delta[T]=new L(R.delta[T])}))}return G})(),N=(function(G){l.__extends(R,G);function R(A){var T=G.call(this,A)||this;return T.persisted=new E(A&&A.persisted),T.connections=new C(A&&A.connections),T.channels=new m(A&&A.channels),T.apiRequests=new _(A&&A.apiRequests),T.tokenRequests=new _(A&&A.tokenRequests),T.xchgProducer=new M(A&&A.xchgProducer),T.xchgConsumer=new M(A&&A.xchgConsumer),T.push=new z(A&&A.pushStats),T.processed=new D(A&&A.processed),T.inProgress=A&&A.inProgress||void 0,T.unit=A&&A.unit||void 0,T.intervalId=A&&A.intervalId||void 0,T}return R.fromValues=function(A){return new R(A)},R})(v);a.default=N}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(30)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(51)),C=l.__importDefault(r(38)),E=l.__importDefault(r(8)),O=l.__importDefault(r(4)),v=l.__importDefault(r(10)),M=l.__importDefault(r(35)),z=l.__importDefault(r(3)),L=l.__importDefault(r(9)),D=(function(G){l.__extends(R,G);function R(A){var T=G.call(this,A)||this;return m.default.logAction(m.default.LOG_MINOR,"Realtime()",""),T.connection=new _.default(T,T.options),T.channels=new N(T),A.autoConnect!==!1&&T.connect(),T}return R.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},R.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},R.Promise=function(A){return A=E.default.objectifyOptions(A),A.promises=!0,new R(A)},R.Callbacks=R,R.Utils=c,R.ConnectionManager=M.default,R.Platform=z.default,R.ProtocolMessage=v.default,R.Message=L.default,R})(d.default),N=(function(G){l.__extends(R,G);function R(A){var T=G.call(this)||this;return T.realtime=A,T.all=Object.create(null),A.connection.connectionManager.on("transport.active",function(){T.onTransportActive()}),T}return R.prototype.channelSerials=function(){for(var A={},T=0,y=c.keysArray(this.all,!0);T<y.length;T++){var B=y[T],j=this.all[B];j.properties.channelSerial&&(A[B]=j.properties.channelSerial)}return A},R.prototype.recoverChannels=function(A){for(var T=0,y=c.keysArray(A,!0);T<y.length;T++){var B=y[T],j=this.get(B);j.properties.channelSerial=A[B]}},R.prototype.onChannelMessage=function(A){var T=A.channel;if(T===void 0){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+A.action);return}var y=this.all[T];if(!y){m.default.logAction(m.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+T);return}y.onMessage(A)},R.prototype.onTransportActive=function(){for(var A in this.all){var T=this.all[A];T.state==="attaching"||T.state==="detaching"?T.checkPendingState():T.state==="suspended"?T._attach(!1,null):T.state==="attached"&&T.requestState("attaching")}},R.prototype.propogateConnectionInterruption=function(A,T){var y={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},B=["attaching","attached","detaching","suspended"],j=y[A];for(var P in this.all){var Q=this.all[P];c.arrIn(B,Q.state)&&Q.notifyState(j,T)}},R.prototype.get=function(A,T){A=String(A);var y=this.all[A];if(!y)y=this.all[A]=new C.default(this.realtime,A,T);else if(T){if(y._shouldReattachToSetOptions(T,y.channelOptions))throw new O.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);y.setOptions(T)}return y},R.prototype.getDerived=function(A,T,y){if(T.filter){var B=c.toBase64(T.filter),j=c.matchDerivedChannel(A);A="[filter=".concat(B).concat(j.qualifierParam,"]").concat(j.channelName)}return this.get(A,y)},R.prototype.release=function(A){A=String(A);var T=this.all[A];if(T){var y=T.getReleaseErr();if(y)throw y;delete this.all[A]}},R})(g.default);a.default=D}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(7)),g=l.__importDefault(r(35)),m=l.__importDefault(r(2)),_=l.__importDefault(r(37)),C=l.__importDefault(r(3));function E(){}var O=(function(v){l.__extends(M,v);function M(z,L){var D=v.call(this)||this;return D.whenState=(function(N,G){return d.default.prototype.whenState.call(D,N,D.state,G,new _.default(void 0,N))}),D.ably=z,D.connectionManager=new g.default(z,L),D.state=D.connectionManager.state.state,D.key=void 0,D.id=void 0,D.errorReason=null,D.connectionManager.on("connectionstate",function(N){var G=D.state=N.current;C.default.Config.nextTick(function(){D.emit(G,N)})}),D.connectionManager.on("update",function(N){C.default.Config.nextTick(function(){D.emit("update",N)})}),D}return M.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},M.prototype.ping=function(z){if(m.default.logAction(m.default.LOG_MINOR,"Connection.ping()",""),!z){if(this.ably.options.promises)return c.promisify(this,"ping",arguments);z=E}this.connectionManager.ping(null,z)},M.prototype.close=function(){m.default.logAction(m.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(M.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),M.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},M})(d.default);a.default=O}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0}),a.PendingMessage=void 0;var l=r(0),c=l.__importDefault(r(10)),d=l.__importStar(r(1)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(36)),C=l.__importDefault(r(4)),E=c.default.Action,O=(function(){function M(z,L){this.message=z,this.callback=L,this.merged=!1;var D=z.action;this.sendAttempted=!1,this.ackRequired=D==E.MESSAGE||D==E.PRESENCE}return M})();a.PendingMessage=O;var v=(function(M){l.__extends(z,M);function z(L){var D=M.call(this)||this;return D.transport=L,D.messageQueue=new _.default,L.on("ack",function(N,G){D.onAck(N,G)}),L.on("nack",function(N,G,R){D.onNack(N,G,R)}),D}return z.prototype.onAck=function(L,D){m.default.logAction(m.default.LOG_MICRO,"Protocol.onAck()","serial = "+L+"; count = "+D),this.messageQueue.completeMessages(L,D)},z.prototype.onNack=function(L,D,N){m.default.logAction(m.default.LOG_ERROR,"Protocol.onNack()","serial = "+L+"; count = "+D+"; err = "+d.inspectError(N)),N||(N=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(L,D,N)},z.prototype.onceIdle=function(L){var D=this.messageQueue;if(D.count()===0){L();return}D.once("idle",L)},z.prototype.send=function(L){L.ackRequired&&this.messageQueue.push(L),m.default.shouldLog(m.default.LOG_MICRO)&&m.default.logAction(m.default.LOG_MICRO,"Protocol.send()","sending msg; "+c.default.stringify(L.message)),L.sendAttempted=!0,this.transport.send(L.message)},z.prototype.getTransport=function(){return this.transport},z.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},z.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},z.prototype.finish=function(){var L=this.transport;this.onceIdle(function(){L.disconnect()})},z})(g.default);a.default=v}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(3)),d=l.__importStar(r(1)),g=l.__importDefault(r(26)),m=l.__importDefault(r(8)),_=l.__importDefault(r(2)),C=l.__importDefault(r(10)),E=l.__importDefault(r(4)),O="web_socket";function v(L){return!!L.on}var M=(function(L){l.__extends(D,L);function D(N,G,R){var A=L.call(this,N,G,R)||this;return A.shortName=O,R.heartbeats=c.default.Config.useProtocolHeartbeats,A.wsHost=m.default.getHost(R.options,R.host,!0),A}return D.isAvailable=function(){return!!c.default.Config.WebSocket},D.prototype.createWebSocket=function(N,G){return this.uri=N+d.toQueryString(G),new c.default.Config.WebSocket(this.uri)},D.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},D.prototype.connect=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),g.default.prototype.connect.call(this);var N=this,G=this.params,R=G.options,A=R.tls?"wss://":"ws://",T=A+this.wsHost+":"+m.default.getPort(R)+"/";_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+T),this.auth.getAuthParams(function(y,B){if(!N.isDisposed){var j="";for(var P in B)j+=" "+P+": "+B[P]+";";if(_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+j+" err: "+y),y){N.disconnect(y);return}var Q=G.getConnectParams(B);try{var K=N.wsConnection=N.createWebSocket(T,Q);K.binaryType=c.default.Config.binaryType,K.onopen=function(){N.onWsOpen()},K.onclose=function(X){N.onWsClose(X)},K.onmessage=function(X){N.onWsData(X.data)},K.onerror=function(X){N.onWsError(X)},v(K)&&K.on("ping",function(){N.onActivity()})}catch(X){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(X.stack||X.message)),N.disconnect(X)}}})},D.prototype.send=function(N){var G=this.wsConnection;if(!G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{G.send(C.default.serialize(N,this.params.format))}catch(A){var R="Exception from ws connection when trying to send: "+d.inspectError(A);_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.send()",R),this.finish("disconnected",new E.default(R,5e4,500))}},D.prototype.onWsData=function(N){_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+N.length+"; type = "+typeof N);try{this.onProtocolMessage(C.default.deserialize(N,this.format))}catch(G){_.default.logAction(_.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+G.stack)}},D.prototype.onWsOpen=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},D.prototype.onWsClose=function(N){var G,R;if(typeof N=="object"?(R=N.code,G=N.wasClean||R===1e3):(R=N,G=R==1e3),delete this.wsConnection,G){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var A=new E.default("Websocket closed",80003,400);this.finish("disconnected",A)}else{var T="Unclean disconnection of WebSocket ; code = "+R,A=new E.default(T,80003,400);_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onWsClose()",T),this.finish("disconnected",A)}this.emit("disposed")},D.prototype.onWsError=function(N){var G=this;_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+N.message),c.default.Config.nextTick(function(){G.disconnect(Error(N.message))})},D.prototype.dispose=function(){_.default.logAction(_.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var N=this.wsConnection;N&&(N.onmessage=function(){},delete this.wsConnection,c.default.Config.nextTick(function(){if(_.default.logAction(_.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!N)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");N.close()}))},D})(g.default);function z(L){return M.isAvailable()&&(L.supportedTransports[O]=M),M}a.default=z}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(1)),d=l.__importDefault(r(34)),g=l.__importDefault(r(7)),m=l.__importDefault(r(2)),_=l.__importDefault(r(16)),C=l.__importStar(r(4)),E=l.__importDefault(r(38)),O=l.__importDefault(r(24)),v=l.__importDefault(r(39)),M=function(){};function z(A){return A.channel.realtime.auth.clientId}function L(A){var T=A.channel.realtime,y=T.auth.clientId;return(!y||y==="*")&&T.connection.state==="connected"}function D(A,T,y){switch(A.state){case"attached":case"suspended":y();break;case"initialized":case"detached":case"detaching":case"attaching":A.attach(function(B){B?T(B):y()});break;default:T(C.default.fromValues(A.invalidStateError()))}}function N(A,T){if(A.isSynthesized()||T.isSynthesized())return A.timestamp>=T.timestamp;var y=A.parseId(),B=T.parseId();return y.msgSerial===B.msgSerial?y.index>B.index:y.msgSerial>B.msgSerial}var G=(function(A){l.__extends(T,A);function T(y){var B=A.call(this,y)||this;return B.channel=y,B.syncComplete=!1,B.members=new R(B,function(j){return j.clientId+":"+j.connectionId}),B._myMembers=new R(B,function(j){return j.clientId}),B.subscriptions=new g.default,B.pendingPresence=[],B}return T.prototype.enter=function(y,B){if(L(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"enter",B)},T.prototype.update=function(y,B){if(L(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,y,"update",B)},T.prototype.enterClient=function(y,B,j){return this._enterOrUpdateClient(void 0,y,B,"enter",j)},T.prototype.updateClient=function(y,B,j){return this._enterOrUpdateClient(void 0,y,B,"update",j)},T.prototype._enterOrUpdateClient=function(y,B,j,P,Q){var K=this;if(!Q)if(typeof j=="function")Q=j,j=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"_enterOrUpdateClient",[y,B,j,P]);Q=M}var X=this.channel;if(!X.connectionManager.activeState()){Q(X.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence."+P+"Client()","channel = "+X.name+", id = "+y+", client = "+(B||"(implicit) "+z(this)));var V=_.default.fromData(j);V.action=P,y&&(V.id=y),B&&(V.clientId=B),_.default.encode(V,X.channelOptions,function(U){if(U){Q(U);return}switch(X.state){case"attached":X.sendPresence(V,Q);break;case"initialized":case"detached":X.attach();case"attaching":K.pendingPresence.push({presence:V,callback:Q});break;default:U=new C.PartialErrorInfo("Unable to "+P+" presence channel while in "+X.state+" state",90001),U.code=90001,Q(U)}})},T.prototype.leave=function(y,B){if(L(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,y,B)},T.prototype.leaveClient=function(y,B,j){if(!j)if(typeof B=="function")j=B,B=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"leaveClient",[y,B]);j=M}var P=this.channel;if(!P.connectionManager.activeState()){j==null||j(P.connectionManager.getError());return}m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+y);var Q=_.default.fromData(B);switch(Q.action="leave",y&&(Q.clientId=y),P.state){case"attached":P.sendPresence(Q,j);break;case"attaching":this.pendingPresence.push({presence:Q,callback:j});break;case"initialized":case"failed":{var K=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);j==null||j(K);break}default:j==null||j(P.invalidStateError())}},T.prototype.get=function(y,B){var j=this,P=Array.prototype.slice.call(arguments);P.length==1&&typeof P[0]=="function"&&P.unshift(null),y=P[0],B=P[1];var Q=!y||("waitForSync"in y?y.waitForSync:!0);if(!B){if(this.channel.realtime.options.promises)return c.promisify(this,"get",P);B=M}function K(X){B(null,y?X.list(y):X.values())}if(this.channel.state==="suspended"){Q?B(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):K(this.members);return}D(this.channel,B,function(){var X=j.members;Q?X.waitSync(function(){K(X)}):K(X)})},T.prototype.history=function(y,B){if(m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),B===void 0)if(typeof y=="function")B=y,y=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"history",arguments);B=M}y&&y.untilAttach&&(this.channel.state==="attached"?(delete y.untilAttach,y.from_serial=this.channel.properties.attachSerial):B(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),d.default.prototype._history.call(this,y,B)},T.prototype.setPresence=function(y,B,j){m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+y.length+" participants; syncChannelSerial = "+j);var P,Q,K=this.members,X=this._myMembers,V=[],U=this.channel.connectionManager.connectionId;B&&(this.members.startSync(),j&&(Q=j.match(/^[\w-]+:(.*)$/))&&(P=Q[1]));for(var I=0;I<y.length;I++){var F=_.default.fromValues(y[I]);switch(F.action){case"leave":K.remove(F)&&V.push(F),F.connectionId===U&&!F.isSynthesized()&&X.remove(F);break;case"enter":case"present":case"update":K.put(F)&&V.push(F),F.connectionId===U&&X.put(F);break}}B&&!P&&(K.endSync(),this.channel.syncChannelSerial=null);for(var I=0;I<V.length;I++){var F=V[I];this.subscriptions.emit(F.action,F)}},T.prototype.onAttached=function(y){m.default.logAction(m.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+y),y?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var B=this.pendingPresence,j=B.length;if(j){this.pendingPresence=[];var P=[],Q=O.default.create();m.default.logAction(m.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+j+" queued presence messages");for(var K=0;K<j;K++){var X=B[K];P.push(X.presence),Q.push(X.callback)}this.channel.sendPresence(P,Q)}},T.prototype.actOnChannelState=function(y,B,j){switch(y){case"attached":this.onAttached(B);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(j);break}},T.prototype.failPendingPresence=function(y){if(this.pendingPresence.length){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+c.inspectError(y));for(var B=0;B<this.pendingPresence.length;B++)try{this.pendingPresence[B].callback(y)}catch{}this.pendingPresence=[]}},T.prototype._clearMyMembers=function(){this._myMembers.clear()},T.prototype._ensureMyMembersPresent=function(){var y=this,B=this._myMembers,j=function(K){if(K){var X="Presence auto-re-enter failed: "+K.toString(),V=new C.default(X,91004,400);m.default.logAction(m.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",X);var U=new v.default(y.channel.state,y.channel.state,!0,!1,V);y.channel.emit("update",U)}};for(var P in B.map){var Q=B.map[P];m.default.logAction(m.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+Q.clientId+'" into the presence set'),this._enterOrUpdateClient(Q.id,Q.clientId,Q.data,"enter",j)}},T.prototype._synthesizeLeaves=function(y){var B=this.subscriptions;c.arrForEach(y,function(j){var P=_.default.fromValues({action:"leave",connectionId:j.connectionId,clientId:j.clientId,data:j.data,encoding:j.encoding,timestamp:c.now()});B.emit("leave",P)})},T.prototype.on=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,y)},T.prototype.off=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];m.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,y)},T.prototype.subscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var j=E.default.processListenerArgs(y),P=j[0],Q=j[1],K=j[2],X=this.channel;if(!K){if(this.channel.realtime.options.promises)return c.promisify(this,"subscribe",[P,Q]);K=M}if(X.state==="failed"){K(C.default.fromValues(X.invalidStateError()));return}this.subscriptions.on(P,Q),X.attach(K)},T.prototype.unsubscribe=function(){for(var y=[],B=0;B<arguments.length;B++)y[B]=arguments[B];var j=E.default.processListenerArgs(y),P=j[0],Q=j[1];this.subscriptions.off(P,Q)},T})(d.default),R=(function(A){l.__extends(T,A);function T(y,B){var j=A.call(this)||this;return j.presence=y,j.map=Object.create(null),j.syncInProgress=!1,j.residualMembers=null,j.memberKey=B,j}return T.prototype.get=function(y){return this.map[y]},T.prototype.getClient=function(y){var B=this.map,j=[];for(var P in B){var Q=B[P];Q.clientId==y&&Q.action!="absent"&&j.push(Q)}return j},T.prototype.list=function(y){var B=this.map,j=y&&y.clientId,P=y&&y.connectionId,Q=[];for(var K in B){var X=B[K];X.action!=="absent"&&(j&&j!=X.clientId||P&&P!=X.connectionId||Q.push(X))}return Q},T.prototype.put=function(y){(y.action==="enter"||y.action==="update")&&(y=_.default.fromValues(y),y.action="present");var B=this.map,j=this.memberKey(y);this.residualMembers&&delete this.residualMembers[j];var P=B[j];return P&&!N(y,P)?!1:(B[j]=y,!0)},T.prototype.values=function(){var y=this.map,B=[];for(var j in y){var P=y[j];P.action!="absent"&&B.push(P)}return B},T.prototype.remove=function(y){var B=this.map,j=this.memberKey(y),P=B[j];return P&&!N(y,P)?!1:(this.syncInProgress?(y=_.default.fromValues(y),y.action="absent",B[j]=y):delete B[j],!0)},T.prototype.startSync=function(){var y=this.map,B=this.syncInProgress;m.default.logAction(m.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),this.syncInProgress||(this.residualMembers=c.copy(y),this.setInProgress(!0))},T.prototype.endSync=function(){var y=this.map,B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),B){for(var j in y){var P=y[j];P.action==="absent"&&delete y[j]}this.presence._synthesizeLeaves(c.valuesArray(this.residualMembers));for(var j in this.residualMembers)delete y[j];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},T.prototype.waitSync=function(y){var B=this.syncInProgress;if(m.default.logAction(m.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+B),!B){y();return}this.once("sync",y)},T.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},T.prototype.setInProgress=function(y){m.default.logAction(m.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+y),this.syncInProgress=y,this.presence.syncComplete=!y},T})(g.default);a.default=G}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=r(56),d=r(31),g=r(11),m=l.__importDefault(r(5)),_=l.__importDefault(r(3)),C=(function(){function E(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return E.prototype.isWordArray=function(O){return O!=null&&O.sigBytes!==void 0},E.prototype.isArrayBuffer=function(O){return O!=null&&O.constructor===ArrayBuffer},E.prototype.isTypedArray=function(O){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(O)},E.prototype.uint8ViewToBase64=function(O){for(var v="",M=this.base64CharSet,z=O.byteLength,L=z%3,D=z-L,N,G,R,A,T,y=0;y<D;y=y+3)T=O[y]<<16|O[y+1]<<8|O[y+2],N=(T&16515072)>>18,G=(T&258048)>>12,R=(T&4032)>>6,A=T&63,v+=M[N]+M[G]+M[R]+M[A];return L==1?(T=O[D],N=(T&252)>>2,G=(T&3)<<4,v+=M[N]+M[G]+"=="):L==2&&(T=O[D]<<8|O[D+1],N=(T&64512)>>10,G=(T&1008)>>4,R=(T&15)<<2,v+=M[N]+M[G]+M[R]+"="),v},E.prototype.base64ToArrayBuffer=function(O){for(var v=atob==null?void 0:atob(O),M=v.length,z=new Uint8Array(M),L=0;L<M;L++){var D=v.charCodeAt(L);z[L]=D}return z.buffer},E.prototype.isBuffer=function(O){return this.isArrayBuffer(O)||this.isWordArray(O)||this.isTypedArray(O)},E.prototype.toBuffer=function(O){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(O))return new Uint8Array(O);if(this.isTypedArray(O))return new Uint8Array(O.buffer);if(this.isWordArray(O)){for(var v=new ArrayBuffer(O.sigBytes),M=new Uint8Array(v),z=0;z<O.sigBytes;z++)M[z]=O.words[z>>>2]>>>24-z%4*8&255;return M}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},E.prototype.toArrayBuffer=function(O){return this.isArrayBuffer(O)?O:this.toBuffer(O).buffer},E.prototype.toWordArray=function(O){return this.isTypedArray(O)&&(O=O.buffer),this.isWordArray(O)?O:m.default.create(O)},E.prototype.base64Encode=function(O){return this.isWordArray(O)?(0,g.stringify)(O):this.uint8ViewToBase64(this.toBuffer(O))},E.prototype.base64Decode=function(O){return ArrayBuffer&&_.default.Config.atob?this.base64ToArrayBuffer(O):(0,g.parse)(O)},E.prototype.hexEncode=function(O){return(0,c.stringify)(this.toWordArray(O))},E.prototype.hexDecode=function(O){var v=(0,c.parse)(O);return ArrayBuffer?this.toArrayBuffer(v):v},E.prototype.utf8Encode=function(O){return _.default.Config.TextEncoder?new _.default.Config.TextEncoder().encode(O).buffer:(0,d.parse)(O)},E.prototype.utf8Decode=function(O){if(!this.isBuffer(O))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(O)?new TextDecoder().decode(O):(O=this.toWordArray(O),(0,d.stringify)(O))},E.prototype.bufferCompare=function(O,v){if(!O)return-1;if(!v)return 1;var M=this.toWordArray(O),z=this.toWordArray(v);M.clamp(),z.clamp();var L=M.sigBytes-z.sigBytes;if(L!=0)return L;for(var D=M.words,N=z.words,G=0;G<D.length;G++)if(L=D[G]-N[G],L!=0)return L;return 0},E.prototype.byteLength=function(O){return this.isArrayBuffer(O)||this.isTypedArray(O)?O.byteLength:this.isWordArray(O)?O.sigBytes:-1},E.prototype.typedArrayToBuffer=function(O){return O.buffer},E})();a.default=new C}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return l.enc.Hex})}),(function(n,a,r){r.r(a);var l=r(5),c=r.n(l),d=r(11),g=r(23),m=r.n(g),_=r(2),C=r.n(_),E=r(4),O=r.n(E),v=function(M,z){var L="aes",D=256,N="cbc",G=16,R=4,A=4294967296,T=2147483648,y;if(M.getRandomWordArray)y=M.getRandomWordArray;else if(typeof Uint32Array<"u"&&M.getRandomValues){var B=new Uint32Array(R);y=function(I,F){var W=I/4,it=W==R?B:new Uint32Array(W);M.getRandomValues(it,function(Z){typeof F<"u"&&F(Z,z.toWordArray(it))})}}else y=function(I,F){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var W=I/4,it=new Array(W),Z=0;Z<W;Z++)it[Z]=Math.floor(Math.random()*A)-T;F(null,c.a.create(it))};function j(I){return I+G&-G}function P(I){if(I.algorithm==="aes"&&I.mode==="cbc"){if(I.keyLength===128||I.keyLength===256)return;throw new Error("Unsupported key length "+I.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function Q(I){return I.replace("_","/").replace("-","+")}var K=[c.a.create([269488144,269488144,269488144,269488144],16),c.a.create([16777216],1),c.a.create([33685504],2),c.a.create([50529024],3),c.a.create([67372036],4),c.a.create([84215045,83886080],5),c.a.create([101058054,101056512],6),c.a.create([117901063,117901056],7),c.a.create([134744072,134744072],8),c.a.create([151587081,151587081,150994944],9),c.a.create([168430090,168430090,168427520],10),c.a.create([185273099,185273099,185273088],11),c.a.create([202116108,202116108,202116108],12),c.a.create([218959117,218959117,218959117,218103808],13),c.a.create([235802126,235802126,235802126,235798528],14),c.a.create([252645135,252645135,252645135,252645135],15),c.a.create([269488144,269488144,269488144,269488144],16)];function X(){}function V(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}X.CipherParams=V,X.getDefaultParams=function(I){var F;if(typeof I=="function"||typeof I=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof I=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),X.generateRandomKey(function(it){I(null,X.getDefaultParams({key:it}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,X.getDefaultParams({key:I}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!I.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof I.key=="string"?F=Object(d.parse)(Q(I.key)):F=z.toWordArray(I.key);var W=new V;if(W.key=F,W.algorithm=I.algorithm||L,W.keyLength=F.words.length*32,W.mode=I.mode||N,I.keyLength&&I.keyLength!==W.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+I.keyLength+" was specified, but the key actually has length "+W.keyLength);return P(W),W},X.generateRandomKey=function(I,F){arguments.length==1&&typeof I=="function"&&(F=I,I=void 0),y((I||D)/8,function(W,it){F!==void 0&&F(W?O.a.fromValues(W):null,it)})},X.getCipher=function(I){var F=I instanceof V?I:X.getDefaultParams(I);return{cipherParams:F,cipher:new U(F,R,I.iv)}};function U(I,F,W){this.algorithm=I.algorithm+"-"+String(I.keyLength)+"-"+I.mode,this.cjsAlgorithm=I.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=z.toWordArray(I.key),W&&(this.iv=z.toWordArray(W).clone()),this.blockLengthWords=F}return U.prototype.encrypt=function(I,F){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),I=z.toWordArray(I);var W=I.sigBytes,it=j(W),Z=this,rt=function(){Z.getIv(function(at,Y){if(at){F(at);return}var J=Z.encryptCipher.process(I.concat(K[it-W])),tt=Y.concat(J);F(null,tt)})};this.encryptCipher?rt():this.iv?(this.encryptCipher=m.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),rt()):y(G,function(at,Y){if(at){F(at);return}Z.encryptCipher=m.a.algo[Z.cjsAlgorithm].createEncryptor(Z.key,{iv:Y}),Z.iv=Y,rt()})},U.prototype.decrypt=function(I){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),I=z.toWordArray(I);var F=this.blockLengthWords,W=I.words,it=c.a.create(W.slice(0,F)),Z=c.a.create(W.slice(F)),rt=m.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:it}),at=rt.process(Z),Y=rt.finalize();return rt.reset(),Y&&Y.sigBytes&&at.concat(Y),at},U.prototype.getIv=function(I){if(this.iv){var F=this.iv;this.iv=null,I(null,F);return}var W=this;y(G,function(it,Z){if(it){I(it);return}I(null,W.encryptCipher.process(Z))})},X};a.default=v}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.WordArray,m=c.enc;m.Utf16=m.Utf16BE={stringify:function(C){for(var E=C.words,O=C.sigBytes,v=[],M=0;M<O;M+=2){var z=E[M>>>2]>>>16-M%4*8&65535;v.push(String.fromCharCode(z))}return v.join("")},parse:function(C){for(var E=C.length,O=[],v=0;v<E;v++)O[v>>>1]|=C.charCodeAt(v)<<16-v%2*16;return g.create(O,E*2)}},m.Utf16LE={stringify:function(C){for(var E=C.words,O=C.sigBytes,v=[],M=0;M<O;M+=2){var z=_(E[M>>>2]>>>16-M%4*8&65535);v.push(String.fromCharCode(z))}return v.join("")},parse:function(C){for(var E=C.length,O=[],v=0;v<E;v++)O[v>>>1]|=_(C.charCodeAt(v)<<16-v%2*16);return g.create(O,E*2)}};function _(C){return C<<8&4278255360|C>>>8&16711935}})(),l.enc.Utf16})}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(28))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.CipherParams,_=d.enc,C=_.Hex,E=d.format;E.Hex={stringify:function(O){return O.ciphertext.toString(C)},parse:function(O){var v=C.parse(O);return m.create({ciphertext:v})}}})(),l.format.Hex})}),(function(n,a,r){(function(l,c){n.exports=c(r(6),r(11),r(61),r(27),r(28))})(this,function(l){return(function(){var c=l,d=c.lib,g=d.BlockCipher,m=c.algo,_=[],C=[],E=[],O=[],v=[],M=[],z=[],L=[],D=[],N=[];(function(){for(var A=[],T=0;T<256;T++)T<128?A[T]=T<<1:A[T]=T<<1^283;for(var y=0,B=0,T=0;T<256;T++){var j=B^B<<1^B<<2^B<<3^B<<4;j=j>>>8^j&255^99,_[y]=j,C[j]=y;var P=A[y],Q=A[P],K=A[Q],X=A[j]*257^j*16843008;E[y]=X<<24|X>>>8,O[y]=X<<16|X>>>16,v[y]=X<<8|X>>>24,M[y]=X;var X=K*16843009^Q*65537^P*257^y*16843008;z[j]=X<<24|X>>>8,L[j]=X<<16|X>>>16,D[j]=X<<8|X>>>24,N[j]=X,y?(y=P^A[A[A[K^P]]],B^=A[A[B]]):y=B=1}})();var G=[0,1,2,4,8,16,32,64,128,27,54],R=m.AES=g.extend({_doReset:function(){var A;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var T=this._keyPriorReset=this._key,y=T.words,B=T.sigBytes/4,j=this._nRounds=B+6,P=(j+1)*4,Q=this._keySchedule=[],K=0;K<P;K++)K<B?Q[K]=y[K]:(A=Q[K-1],K%B?B>6&&K%B==4&&(A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255]):(A=A<<8|A>>>24,A=_[A>>>24]<<24|_[A>>>16&255]<<16|_[A>>>8&255]<<8|_[A&255],A^=G[K/B|0]<<24),Q[K]=Q[K-B]^A);for(var X=this._invKeySchedule=[],V=0;V<P;V++){var K=P-V;if(V%4)var A=Q[K];else var A=Q[K-4];V<4||K<=4?X[V]=A:X[V]=z[_[A>>>24]]^L[_[A>>>16&255]]^D[_[A>>>8&255]]^N[_[A&255]]}}},encryptBlock:function(A,T){this._doCryptBlock(A,T,this._keySchedule,E,O,v,M,_)},decryptBlock:function(A,T){var y=A[T+1];A[T+1]=A[T+3],A[T+3]=y,this._doCryptBlock(A,T,this._invKeySchedule,z,L,D,N,C);var y=A[T+1];A[T+1]=A[T+3],A[T+3]=y},_doCryptBlock:function(A,T,y,B,j,P,Q,K){for(var X=this._nRounds,V=A[T]^y[0],U=A[T+1]^y[1],I=A[T+2]^y[2],F=A[T+3]^y[3],W=4,it=1;it<X;it++){var Z=B[V>>>24]^j[U>>>16&255]^P[I>>>8&255]^Q[F&255]^y[W++],rt=B[U>>>24]^j[I>>>16&255]^P[F>>>8&255]^Q[V&255]^y[W++],at=B[I>>>24]^j[F>>>16&255]^P[V>>>8&255]^Q[U&255]^y[W++],Y=B[F>>>24]^j[V>>>16&255]^P[U>>>8&255]^Q[I&255]^y[W++];V=Z,U=rt,I=at,F=Y}var Z=(K[V>>>24]<<24|K[U>>>16&255]<<16|K[I>>>8&255]<<8|K[F&255])^y[W++],rt=(K[U>>>24]<<24|K[I>>>16&255]<<16|K[F>>>8&255]<<8|K[V&255])^y[W++],at=(K[I>>>24]<<24|K[F>>>16&255]<<16|K[V>>>8&255]<<8|K[U&255])^y[W++],Y=(K[F>>>24]<<24|K[V>>>16&255]<<16|K[U>>>8&255]<<8|K[I&255])^y[W++];A[T]=Z,A[T+1]=rt,A[T+2]=at,A[T+3]=Y},keySize:256/32});c.AES=g._createHelper(R)})(),l.AES})}),(function(n,a,r){(function(l,c){n.exports=c(r(6))})(this,function(l){return(function(c){var d=l,g=d.lib,m=g.WordArray,_=g.Hasher,C=d.algo,E=[];(function(){for(var D=0;D<64;D++)E[D]=c.abs(c.sin(D+1))*4294967296|0})();var O=C.MD5=_.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(D,N){for(var G=0;G<16;G++){var R=N+G,A=D[R];D[R]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var T=this._hash.words,y=D[N+0],B=D[N+1],j=D[N+2],P=D[N+3],Q=D[N+4],K=D[N+5],X=D[N+6],V=D[N+7],U=D[N+8],I=D[N+9],F=D[N+10],W=D[N+11],it=D[N+12],Z=D[N+13],rt=D[N+14],at=D[N+15],Y=T[0],J=T[1],tt=T[2],et=T[3];Y=v(Y,J,tt,et,y,7,E[0]),et=v(et,Y,J,tt,B,12,E[1]),tt=v(tt,et,Y,J,j,17,E[2]),J=v(J,tt,et,Y,P,22,E[3]),Y=v(Y,J,tt,et,Q,7,E[4]),et=v(et,Y,J,tt,K,12,E[5]),tt=v(tt,et,Y,J,X,17,E[6]),J=v(J,tt,et,Y,V,22,E[7]),Y=v(Y,J,tt,et,U,7,E[8]),et=v(et,Y,J,tt,I,12,E[9]),tt=v(tt,et,Y,J,F,17,E[10]),J=v(J,tt,et,Y,W,22,E[11]),Y=v(Y,J,tt,et,it,7,E[12]),et=v(et,Y,J,tt,Z,12,E[13]),tt=v(tt,et,Y,J,rt,17,E[14]),J=v(J,tt,et,Y,at,22,E[15]),Y=M(Y,J,tt,et,B,5,E[16]),et=M(et,Y,J,tt,X,9,E[17]),tt=M(tt,et,Y,J,W,14,E[18]),J=M(J,tt,et,Y,y,20,E[19]),Y=M(Y,J,tt,et,K,5,E[20]),et=M(et,Y,J,tt,F,9,E[21]),tt=M(tt,et,Y,J,at,14,E[22]),J=M(J,tt,et,Y,Q,20,E[23]),Y=M(Y,J,tt,et,I,5,E[24]),et=M(et,Y,J,tt,rt,9,E[25]),tt=M(tt,et,Y,J,P,14,E[26]),J=M(J,tt,et,Y,U,20,E[27]),Y=M(Y,J,tt,et,Z,5,E[28]),et=M(et,Y,J,tt,j,9,E[29]),tt=M(tt,et,Y,J,V,14,E[30]),J=M(J,tt,et,Y,it,20,E[31]),Y=z(Y,J,tt,et,K,4,E[32]),et=z(et,Y,J,tt,U,11,E[33]),tt=z(tt,et,Y,J,W,16,E[34]),J=z(J,tt,et,Y,rt,23,E[35]),Y=z(Y,J,tt,et,B,4,E[36]),et=z(et,Y,J,tt,Q,11,E[37]),tt=z(tt,et,Y,J,V,16,E[38]),J=z(J,tt,et,Y,F,23,E[39]),Y=z(Y,J,tt,et,Z,4,E[40]),et=z(et,Y,J,tt,y,11,E[41]),tt=z(tt,et,Y,J,P,16,E[42]),J=z(J,tt,et,Y,X,23,E[43]),Y=z(Y,J,tt,et,I,4,E[44]),et=z(et,Y,J,tt,it,11,E[45]),tt=z(tt,et,Y,J,at,16,E[46]),J=z(J,tt,et,Y,j,23,E[47]),Y=L(Y,J,tt,et,y,6,E[48]),et=L(et,Y,J,tt,V,10,E[49]),tt=L(tt,et,Y,J,rt,15,E[50]),J=L(J,tt,et,Y,K,21,E[51]),Y=L(Y,J,tt,et,it,6,E[52]),et=L(et,Y,J,tt,P,10,E[53]),tt=L(tt,et,Y,J,F,15,E[54]),J=L(J,tt,et,Y,B,21,E[55]),Y=L(Y,J,tt,et,U,6,E[56]),et=L(et,Y,J,tt,at,10,E[57]),tt=L(tt,et,Y,J,X,15,E[58]),J=L(J,tt,et,Y,Z,21,E[59]),Y=L(Y,J,tt,et,Q,6,E[60]),et=L(et,Y,J,tt,W,10,E[61]),tt=L(tt,et,Y,J,j,15,E[62]),J=L(J,tt,et,Y,I,21,E[63]),T[0]=T[0]+Y|0,T[1]=T[1]+J|0,T[2]=T[2]+tt|0,T[3]=T[3]+et|0},_doFinalize:function(){var D=this._data,N=D.words,G=this._nDataBytes*8,R=D.sigBytes*8;N[R>>>5]|=128<<24-R%32;var A=c.floor(G/4294967296),T=G;N[(R+64>>>9<<4)+15]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,N[(R+64>>>9<<4)+14]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,D.sigBytes=(N.length+1)*4,this._process();for(var y=this._hash,B=y.words,j=0;j<4;j++){var P=B[j];B[j]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return y},clone:function(){var D=_.clone.call(this);return D._hash=this._hash.clone(),D}});function v(D,N,G,R,A,T,y){var B=D+(N&G|~N&R)+A+y;return(B<<T|B>>>32-T)+N}function M(D,N,G,R,A,T,y){var B=D+(N&R|G&~R)+A+y;return(B<<T|B>>>32-T)+N}function z(D,N,G,R,A,T,y){var B=D+(N^G^R)+A+y;return(B<<T|B>>>32-T)+N}function L(D,N,G,R,A,T,y){var B=D+(G^(N|~R))+A+y;return(B<<T|B>>>32-T)+N}d.MD5=_._createHelper(O),d.HmacMD5=_._createHmacHelper(O)})(Math),l.MD5})}),(function(n,a,r){var l;Object.defineProperty(a,"__esModule",{value:!0});var c=r(0),d=c.__importDefault(r(3)),g=c.__importStar(r(1)),m=c.__importDefault(r(8)),_=r(4),C=c.__importDefault(r(19)),E=c.__importDefault(r(17)),O=c.__importDefault(r(22)),v=c.__importDefault(r(2)),M=r(29),z=c.__importDefault(r(63)),L=r(14);function D(R){var A=R.statusCode;return A===408&&!R.code||A===400&&!R.code||A>=500&&A<=504}function N(R){var A=R.connection,T=A&&A.connectionManager.host;return T?[T].concat(m.default.getFallbackHosts(R.options)):m.default.getHosts(R.options)}var G=(l=(function(){function R(A){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=N,this.options=A||{};var T=this.options.connectivityCheckUrl||m.default.connectivityCheckUrl,y=this.options.connectivityCheckParams,B=!this.options.connectivityCheckUrl;d.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(j,P,Q,K,X,V,U){var I=E.default.createRequest(Q,K,X,V,O.default.REQ_SEND,P&&P.options.timeouts,j);return I.once("complete",U),I.exec(),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(j){j(null,!0)}:this.checkConnectivity=function(j){v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,y,function(P,Q,K,X,V){var U=!1;B?U=!P&&(Q==null?void 0:Q.replace(/\n/,""))=="yes":U=!P&&(0,L.isSuccessCode)(V),v.default.logAction(v.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+U),j(null,U)})}):d.default.Config.jsonpSupported?(this.Request=function(j,P,Q,K,X,V,U){var I=(0,M.createRequest)(Q,K,X,V,O.default.REQ_SEND,P&&P.options.timeouts,j);return I.once("complete",U),d.default.Config.nextTick(function(){I.exec()}),I},this.options.disableConnectivityCheck?this.checkConnectivity=function(j){j(null,!0)}:this.checkConnectivity=function(j){var P=this,Q=m.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(j);return}this.checksInProgress=[j],v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+Q);var K=new M.Request("isTheInternetUp",Q,null,null,null,O.default.REQ_SEND,m.default.TIMEOUTS);K.once("complete",function(X,V){var U=!X&&V;v.default.logAction(v.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+U);for(var I=0;I<P.checksInProgress.length;I++)P.checksInProgress[I](null,U);P.checksInProgress=null}),d.default.Config.nextTick(function(){K.exec()})}):d.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=z.default,this.checkConnectivity=function(j){v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+T),this.doUri(C.default.Get,null,T,null,null,null,function(P,Q){var K=!P&&(Q==null?void 0:Q.replace(/\n/,""))=="yes";v.default.logAction(v.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+K),j(null,K)})}):this.Request=function(j,P,Q,K,X,V,U){U(new _.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return R.prototype.do=function(A,T,y,B,j,P,Q){var K=this,X=typeof y=="function"?y:function(F){return T.baseUri(F)+y},V=T._currentFallback;if(V)if(V.validUntil>g.now()){if(!this.Request){Q==null||Q(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,T,X(V.host),B,P,j,function(F){for(var W=[],it=1;it<arguments.length;it++)W[it-1]=arguments[it];if(F&&D(F)){T._currentFallback=null,K.do(A,T,y,B,j,P,Q);return}Q==null||Q.apply(void 0,c.__spreadArray([F],W,!1))});return}else T._currentFallback=null;var U=N(T);if(U.length===1){this.doUri(A,T,X(U[0]),B,j,P,Q);return}var I=function(F,W){var it=F.shift();K.doUri(A,T,X(it),B,j,P,function(Z){for(var rt=[],at=1;at<arguments.length;at++)rt[at-1]=arguments[at];if(Z&&D(Z)&&F.length){I(F,!0);return}W&&(T._currentFallback={host:it,validUntil:g.now()+T.options.timeouts.fallbackRetryTimeout}),Q==null||Q.apply(void 0,c.__spreadArray([Z],rt,!1))})};I(U)},R.prototype.doUri=function(A,T,y,B,j,P,Q){if(!this.Request){Q(new _.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(A,T,y,B,P,j,Q)},R})(),l.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],l.methodsWithoutBody=[C.default.Get,C.default.Delete],l.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],l);a.default=G}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importStar(r(4)),d=l.__importDefault(r(3)),g=l.__importDefault(r(8)),m=l.__importStar(r(1)),_=r(1);function C(v,M){return!!M.get("x-ably-errorcode")}function E(v,M){if(C(v,M))return v.error&&c.default.fromValues(v.error)}function O(v,M,z,L,D,N,G){var R=new Headers(L||{}),A=v?v.toUpperCase():m.isEmptyArg(N)?"GET":"POST",T=new AbortController,y=setTimeout(function(){T.abort(),G(new c.PartialErrorInfo("Request timed out",null,408))},M?M.options.timeouts.httpRequestTimeout:g.default.TIMEOUTS.httpRequestTimeout),B={method:A,headers:R,body:N};d.default.Config.isWebworker||(B.credentials=R.has("authorization")?"include":"same-origin"),(0,_.getGlobalObject)().fetch(z+"?"+new URLSearchParams(D||{}),B).then(function(j){clearTimeout(y);var P=j.headers.get("Content-Type"),Q;P&&P.indexOf("application/x-msgpack")>-1?Q=j.arrayBuffer():P&&P.indexOf("application/json")>-1?Q=j.json():Q=j.text(),Q.then(function(K){var X=!!P&&P.indexOf("application/x-msgpack")===-1;if(j.ok)G(null,K,j.headers,X,j.status);else{var V=E(K,j.headers)||new c.PartialErrorInfo("Error response received from server: "+j.status+" body was: "+d.default.Config.inspect(K),null,j.status);G(V,K,j.headers,X,j.status)}})}).catch(function(j){clearTimeout(y),G(j)})}a.default=O}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(41)),d=l.__importStar(r(1)),g=d.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function m(){var O=g.location;return!g.WebSocket||!O||!O.origin||O.origin.indexOf("http")>-1}var _=g.navigator&&g.navigator.userAgent.toString(),C=g.location&&g.location.href,E={agent:"browser",logTimestamps:!0,userAgent:_,currentUrl:C,noUpgrade:_&&!!_.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:g.WebSocket,fetchSupported:!!g.fetch,xhrSupported:g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:m(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:c.default,supportsBinary:!!g.TextDecoder,preferBinary:!1,ArrayBuffer:g.ArrayBuffer,atob:g.atob,nextTick:typeof g.setImmediate<"u"?g.setImmediate.bind(g):function(O){setTimeout(O,0)},addEventListener:g.addEventListener,inspect:JSON.stringify,stringByteSize:function(O){return g.TextDecoder&&new g.TextEncoder().encode(O).length||O.length},TextEncoder:g.TextEncoder,TextDecoder:g.TextDecoder,Promise:g.Promise,getRandomValues:(function(O){if(O!==void 0)return function(v,M){O.getRandomValues(v),M&&M(null)}})(g.crypto||msCrypto)};a.default=E}),(function(n,a,r){(function(l){Object.defineProperty(a,"__esModule",{value:!0});var c=r(0),d=c.__importStar(r(1)),g="ablyjs-storage-test",m=(function(){function _(){try{l.sessionStorage.setItem(g,g),l.sessionStorage.removeItem(g),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{l.localStorage.setItem(g,g),l.localStorage.removeItem(g),this.localSupported=!0}catch{this.localSupported=!1}}return _.prototype.get=function(C){return this._get(C,!1)},_.prototype.getSession=function(C){return this._get(C,!0)},_.prototype.remove=function(C){return this._remove(C,!1)},_.prototype.removeSession=function(C){return this._remove(C,!0)},_.prototype.set=function(C,E,O){return this._set(C,E,O,!1)},_.prototype.setSession=function(C,E,O){return this._set(C,E,O,!0)},_.prototype._set=function(C,E,O,v){var M={value:E};return O&&(M.expires=d.now()+O),this.storageInterface(v).setItem(C,JSON.stringify(M))},_.prototype._get=function(C,E){if(E&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!E&&!this.localSupported)throw new Error("Local Storage not supported");var O=this.storageInterface(E).getItem(C);if(!O)return null;var v=JSON.parse(O);return v.expires&&v.expires<d.now()?(this.storageInterface(E).removeItem(C),null):v.value},_.prototype._remove=function(C,E){return this.storageInterface(E).removeItem(C)},_.prototype.storageInterface=function(C){return C?l.sessionStorage:l.localStorage},_})();a.default=new m}).call(this,r(13))}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l=r(0),c=l.__importDefault(r(67)),d={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],baseTransportOrder:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],transportPreferenceOrder:[c.default.JsonP,c.default.XhrPolling,c.default.XhrStreaming,c.default.WebSocket],upgradeTransports:[c.default.XhrStreaming,c.default.WebSocket]};a.default=d}),(function(n,a,r){Object.defineProperty(a,"__esModule",{value:!0});var l;(function(c){c.WebSocket="web_socket",c.Comet="comet",c.XhrStreaming="xhr_streaming",c.XhrPolling="xhr_polling",c.JsonP="jsonp"})(l||(l={})),a.default=l}),(function(n,a,r){r.r(a);var l=r(29),c=r.n(l),d=r(1),g=r(3),m=r.n(g),_=r(12),C=r.n(_),E=r(17),O=r.n(E),v=function(D){var N="xhr_polling";function G(R,A,T){T.stream=!1,C.a.call(this,R,A,T),this.shortName=N}return d.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(R,A,T,y,B){return O.a.createRequest(R,A,T,y,B,this.timeouts)},typeof D<"u"&&G.isAvailable()&&(D.supportedTransports[N]=G),G},M=v,z=function(D){var N="xhr_streaming";function G(R,A,T){C.a.call(this,R,A,T),this.shortName=N}return d.inherits(G,C.a),G.isAvailable=function(){return m.a.Config.xhrSupported&&m.a.Config.streamingSupported&&m.a.Config.allowComet},G.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},G.prototype.createRequest=function(R,A,T,y,B){return O.a.createRequest(R,A,T,y,B,this.timeouts)},typeof D<"u"&&G.isAvailable()&&(D.supportedTransports[N]=G),G},L=z;a.default=[c.a,M,L]})]).default})})(Hp)),Hp.exports}var mS=pS(),Lm=function(o,t){return Lm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(n[r]=a[r])},Lm(o,t)};function vS(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Lm(o,t);function n(){this.constructor=o}o.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var vg=function(){return vg=Object.assign||function(t){for(var n,a=1,r=arguments.length;a<r;a++){n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},vg.apply(this,arguments)};function yf(o,t){var n={};for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&t.indexOf(a)<0&&(n[a]=o[a]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(o);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(o,a[r])&&(n[a[r]]=o[a[r]]);return n}function yS(o,t,n,a){var r=arguments.length,l=r<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,n):a,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,t,n,a);else for(var d=o.length-1;d>=0;d--)(c=o[d])&&(l=(r<3?c(l):r>3?c(t,n,l):c(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l}function SS(o,t){return function(n,a){t(n,a,o)}}function bS(o,t,n,a,r,l){function c(L){if(L!==void 0&&typeof L!="function")throw new TypeError("Function expected");return L}for(var d=a.kind,g=d==="getter"?"get":d==="setter"?"set":"value",m=!t&&o?a.static?o:o.prototype:null,_=t||(m?Object.getOwnPropertyDescriptor(m,a.name):{}),C,E=!1,O=n.length-1;O>=0;O--){var v={};for(var M in a)v[M]=M==="access"?{}:a[M];for(var M in a.access)v.access[M]=a.access[M];v.addInitializer=function(L){if(E)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(L||null))};var z=(0,n[O])(d==="accessor"?{get:_.get,set:_.set}:_[g],v);if(d==="accessor"){if(z===void 0)continue;if(z===null||typeof z!="object")throw new TypeError("Object expected");(C=c(z.get))&&(_.get=C),(C=c(z.set))&&(_.set=C),(C=c(z.init))&&r.unshift(C)}else(C=c(z))&&(d==="field"?r.unshift(C):_[g]=C)}m&&Object.defineProperty(m,a.name,_),E=!0}function _S(o,t,n){for(var a=arguments.length>2,r=0;r<t.length;r++)n=a?t[r].call(o,n):t[r].call(o);return a?n:void 0}function ES(o){return typeof o=="symbol"?o:"".concat(o)}function CS(o,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function TS(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function re(o,t,n,a){function r(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(_){try{m(a.next(_))}catch(C){c(C)}}function g(_){try{m(a.throw(_))}catch(C){c(C)}}function m(_){_.done?l(_.value):r(_.value).then(d,g)}m((a=a.apply(o,t||[])).next())})}function AS(o,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,r,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(m){return function(_){return g([m,_])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(n=0)),n;)try{if(a=1,r&&(l=m[0]&2?r.return:m[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,m[1])).done)return l;switch(r=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(o,n)}catch(_){m=[6,_],r=0}finally{a=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Dg=Object.create?(function(o,t,n,a){a===void 0&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(o,a,r)}):(function(o,t,n,a){a===void 0&&(a=n),o[a]=t[n]});function wS(o,t){for(var n in o)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Dg(t,o,n)}function yg(o){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&o[t],a=0;if(n)return n.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&a>=o.length&&(o=void 0),{value:o&&o[a++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function sv(o,t){var n=typeof Symbol=="function"&&o[Symbol.iterator];if(!n)return o;var a=n.call(o),r,l=[],c;try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)l.push(r.value)}catch(d){c={error:d}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(c)throw c.error}}return l}function OS(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(sv(arguments[t]));return o}function RS(){for(var o=0,t=0,n=arguments.length;t<n;t++)o+=arguments[t].length;for(var a=Array(o),r=0,t=0;t<n;t++)for(var l=arguments[t],c=0,d=l.length;c<d;c++,r++)a[r]=l[c];return a}function xS(o,t,n){if(n||arguments.length===2)for(var a=0,r=t.length,l;a<r;a++)(l||!(a in t))&&(l||(l=Array.prototype.slice.call(t,0,a)),l[a]=t[a]);return o.concat(l||Array.prototype.slice.call(t))}function ff(o){return this instanceof ff?(this.v=o,this):new ff(o)}function NS(o,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n.apply(o,t||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(O){return function(v){return Promise.resolve(v).then(O,C)}}function d(O,v){a[O]&&(r[O]=function(M){return new Promise(function(z,L){l.push([O,M,z,L])>1||g(O,M)})},v&&(r[O]=v(r[O])))}function g(O,v){try{m(a[O](v))}catch(M){E(l[0][3],M)}}function m(O){O.value instanceof ff?Promise.resolve(O.value.v).then(_,C):E(l[0][2],O)}function _(O){g("next",O)}function C(O){g("throw",O)}function E(O,v){O(v),l.shift(),l.length&&g(l[0][0],l[0][1])}}function MS(o){var t,n;return t={},a("next"),a("throw",function(r){throw r}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(r,l){t[r]=o[r]?function(c){return(n=!n)?{value:ff(o[r](c)),done:!1}:l?l(c):c}:l}}function DS(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],n;return t?t.call(o):(o=typeof yg=="function"?yg(o):o[Symbol.iterator](),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(l){n[l]=o[l]&&function(c){return new Promise(function(d,g){c=o[l](c),r(d,g,c.done,c.value)})}}function r(l,c,d,g){Promise.resolve(g).then(function(m){l({value:m,done:d})},c)}}function jS(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}var f_=Object.create?(function(o,t){Object.defineProperty(o,"default",{enumerable:!0,value:t})}):function(o,t){o.default=t},Gm=function(o){return Gm=Object.getOwnPropertyNames||function(t){var n=[];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[n.length]=a);return n},Gm(o)};function US(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var n=Gm(o),a=0;a<n.length;a++)n[a]!=="default"&&Dg(t,o,n[a]);return f_(t,o),t}function BS(o){return o&&o.__esModule?o:{default:o}}function zS(o,t,n,a){if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!a:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?a:n==="a"?a.call(o):a?a.value:t.get(o)}function LS(o,t,n,a,r){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!r:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?r.call(o,n):r?r.value=n:t.set(o,n),n}function GS(o,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?t===o:o.has(t)}function PS(o,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var a,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=t[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=t[Symbol.dispose],n&&(r=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");r&&(a=function(){try{r.call(this)}catch(l){return Promise.reject(l)}}),o.stack.push({value:t,dispose:a,async:n})}else n&&o.stack.push({async:!0});return t}var h_=typeof SuppressedError=="function"?SuppressedError:function(o,t,n){var a=new Error(n);return a.name="SuppressedError",a.error=o,a.suppressed=t,a};function HS(o){function t(l){o.error=o.hasError?new h_(l,o.error,"An error was suppressed during disposal."):l,o.hasError=!0}var n,a=0;function r(){for(;n=o.stack.pop();)try{if(!n.async&&a===1)return a=0,o.stack.push(n),Promise.resolve().then(r);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return a|=2,Promise.resolve(l).then(r,function(c){return t(c),r()})}else a|=1}catch(c){t(c)}if(a===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return r()}function IS(o,t){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,a,r,l,c){return a?t?".jsx":".js":r&&(!l||!c)?n:r+l+"."+c.toLowerCase()+"js"}):o}const d_={__extends:vS,__assign:vg,__rest:yf,__decorate:yS,__param:SS,__esDecorate:bS,__runInitializers:_S,__propKey:ES,__setFunctionName:CS,__metadata:TS,__awaiter:re,__generator:AS,__createBinding:Dg,__exportStar:wS,__values:yg,__read:sv,__spread:OS,__spreadArrays:RS,__spreadArray:xS,__await:ff,__asyncGenerator:NS,__asyncDelegator:MS,__asyncValues:DS,__makeTemplateObject:jS,__importStar:US,__importDefault:BS,__classPrivateFieldGet:zS,__classPrivateFieldSet:LS,__classPrivateFieldIn:GS,__addDisposableResource:PS,__disposeResources:HS,__rewriteRelativeImportExtension:IS},g_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:PS,get __assign(){return vg},__asyncDelegator:MS,__asyncGenerator:NS,__asyncValues:DS,__await:ff,__awaiter:re,__classPrivateFieldGet:zS,__classPrivateFieldIn:GS,__classPrivateFieldSet:LS,__createBinding:Dg,__decorate:yS,__disposeResources:HS,__esDecorate:bS,__exportStar:wS,__extends:vS,__generator:AS,__importDefault:BS,__importStar:US,__makeTemplateObject:jS,__metadata:TS,__param:SS,__propKey:ES,__read:sv,__rest:yf,__rewriteRelativeImportExtension:IS,__runInitializers:_S,__setFunctionName:CS,__spread:OS,__spreadArray:xS,__spreadArrays:RS,__values:yg,default:d_},Symbol.toStringTag,{value:"Module"})),p_="modulepreload",m_=function(o){return"/"+o},c1={},Eu=function(t,n,a){let r=Promise.resolve();if(n&&n.length>0){let c=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=c(n.map(m=>{if(m=m_(m),m in c1)return;c1[m]=!0;const _=m.endsWith(".css"),C=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${C}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":p_,_||(E.as="script"),E.crossOrigin="",E.href=m,g&&E.setAttribute("nonce",g),document.head.appendChild(E),_)return new Promise((O,v)=>{E.addEventListener("load",O),E.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return r.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return t().catch(l)})},v_=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>Eu(async()=>{const{default:a}=await Promise.resolve().then(()=>Cu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)};class lv extends Error{constructor(t,n="FunctionsError",a){super(t),this.name=n,this.context=a}}class f1 extends lv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class h1 extends lv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class d1 extends lv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Pm;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Pm||(Pm={}));class y_{constructor(t,{headers:n={},customFetch:a,region:r=Pm.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=v_(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return re(this,arguments,void 0,function*(n,a={}){var r;try{const{headers:l,method:c,body:d,signal:g}=a;let m={},{region:_}=a;_||(_=this.region);const C=new URL(`${this.url}/${n}`);_&&_!=="any"&&(m["x-region"]=_,C.searchParams.set("forceFunctionRegion",_));let E;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=d):typeof d=="string"?(m["Content-Type"]="text/plain",E=d):typeof FormData<"u"&&d instanceof FormData?E=d:(m["Content-Type"]="application/json",E=JSON.stringify(d)):E=d;const O=yield this.fetch(C.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),l),body:E,signal:g}).catch(L=>{throw L.name==="AbortError"?L:new f1(L)}),v=O.headers.get("x-relay-error");if(v&&v==="true")throw new h1(O);if(!O.ok)throw new d1(O);let M=((r=O.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),z;return M==="application/json"?z=yield O.json():M==="application/octet-stream"||M==="application/pdf"?z=yield O.blob():M==="text/event-stream"?z=O:M==="multipart/form-data"?z=yield O.formData():z=yield O.text(),{data:z,error:null,response:O}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new f1(l)}:{data:null,error:l,response:l instanceof d1||l instanceof h1?l.context:void 0}}})}}var Za={};const Sf=y2(g_);var eg={},ng={},ag={},ig={},rg={},S_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},hf=S_();const b_=hf.fetch,kS=hf.fetch.bind(hf),qS=hf.Headers,__=hf.Request,E_=hf.Response,Cu=Object.freeze(Object.defineProperty({__proto__:null,Headers:qS,Request:__,Response:E_,default:kS,fetch:b_},Symbol.toStringTag,{value:"Module"})),C_=y2(Cu);var sg={},g1;function VS(){if(g1)return sg;g1=1,Object.defineProperty(sg,"__esModule",{value:!0});class o extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return sg.default=o,sg}var p1;function YS(){if(p1)return rg;p1=1,Object.defineProperty(rg,"__esModule",{value:!0});const o=Sf,t=o.__importDefault(C_),n=o.__importDefault(VS());class a{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let g=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var _,C,E,O;let v=null,M=null,z=null,L=m.status,D=m.statusText;if(m.ok){if(this.method!=="HEAD"){const A=await m.text();A===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((_=this.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?M=A:M=JSON.parse(A))}const G=(C=this.headers.get("Prefer"))===null||C===void 0?void 0:C.match(/count=(exact|planned|estimated)/),R=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");G&&R&&R.length>1&&(z=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(M)&&(M.length>1?(v={code:"PGRST116",details:`Results contain ${M.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},M=null,z=null,L=406,D="Not Acceptable"):M.length===1?M=M[0]:M=null)}else{const G=await m.text();try{v=JSON.parse(G),Array.isArray(v)&&m.status===404&&(M=[],v=null,L=200,D="OK")}catch{m.status===404&&G===""?(L=204,D="No Content"):v={message:G}}if(v&&this.isMaybeSingle&&(!((O=v==null?void 0:v.details)===null||O===void 0)&&O.includes("0 rows"))&&(v=null,L=200,D="OK"),v&&this.shouldThrowOnError)throw new n.default(v)}return{error:v,data:M,count:z,status:L,statusText:D}});return this.shouldThrowOnError||(g=g.catch(m=>{var _,C,E;return{error:{message:`${(_=m==null?void 0:m.name)!==null&&_!==void 0?_:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(C=m==null?void 0:m.stack)!==null&&C!==void 0?C:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),g.then(l,c)}returns(){return this}overrideTypes(){return this}}return rg.default=a,rg}var m1;function KS(){if(m1)return ig;m1=1,Object.defineProperty(ig,"__esModule",{value:!0});const t=Sf.__importDefault(YS());class n extends t.default{select(r){let l=!1;const c=(r??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:g=d}={}){const m=g?`${g}.order`:"order",_=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${_?`${_},`:""}${r}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${r}`),this}range(r,l,{foreignTable:c,referencedTable:d=c}={}){const g=typeof d>"u"?"offset":`${d}.offset`,m=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(g,`${r}`),this.url.searchParams.set(m,`${l-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:g=!1,format:m="text"}={}){var _;const C=[r?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${C};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return ig.default=n,ig}var v1;function ov(){if(v1)return ag;v1=1,Object.defineProperty(ag,"__esModule",{value:!0});const t=Sf.__importDefault(KS());class n extends t.default{eq(r,l){return this.url.searchParams.append(r,`eq.${l}`),this}neq(r,l){return this.url.searchParams.append(r,`neq.${l}`),this}gt(r,l){return this.url.searchParams.append(r,`gt.${l}`),this}gte(r,l){return this.url.searchParams.append(r,`gte.${l}`),this}lt(r,l){return this.url.searchParams.append(r,`lt.${l}`),this}lte(r,l){return this.url.searchParams.append(r,`lte.${l}`),this}like(r,l){return this.url.searchParams.append(r,`like.${l}`),this}likeAllOf(r,l){return this.url.searchParams.append(r,`like(all).{${l.join(",")}}`),this}likeAnyOf(r,l){return this.url.searchParams.append(r,`like(any).{${l.join(",")}}`),this}ilike(r,l){return this.url.searchParams.append(r,`ilike.${l}`),this}ilikeAllOf(r,l){return this.url.searchParams.append(r,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(r,l){return this.url.searchParams.append(r,`ilike(any).{${l.join(",")}}`),this}is(r,l){return this.url.searchParams.append(r,`is.${l}`),this}in(r,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(r,`in.(${c})`),this}contains(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cs.{${l.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(l)}`),this}containedBy(r,l){return typeof l=="string"?this.url.searchParams.append(r,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(r,`cd.{${l.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(l)}`),this}rangeGt(r,l){return this.url.searchParams.append(r,`sr.${l}`),this}rangeGte(r,l){return this.url.searchParams.append(r,`nxl.${l}`),this}rangeLt(r,l){return this.url.searchParams.append(r,`sl.${l}`),this}rangeLte(r,l){return this.url.searchParams.append(r,`nxr.${l}`),this}rangeAdjacent(r,l){return this.url.searchParams.append(r,`adj.${l}`),this}overlaps(r,l){return typeof l=="string"?this.url.searchParams.append(r,`ov.${l}`):this.url.searchParams.append(r,`ov.{${l.join(",")}}`),this}textSearch(r,l,{config:c,type:d}={}){let g="";d==="plain"?g="pl":d==="phrase"?g="ph":d==="websearch"&&(g="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(r,`${g}fts${m}.${l}`),this}match(r){return Object.entries(r).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(r,l,c){return this.url.searchParams.append(r,`not.${l}.${c}`),this}or(r,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${r})`),this}filter(r,l,c){return this.url.searchParams.append(r,`${l}.${c}`),this}}return ag.default=n,ag}var y1;function QS(){if(y1)return ng;y1=1,Object.defineProperty(ng,"__esModule",{value:!0});const t=Sf.__importDefault(ov());class n{constructor(r,{headers:l={},schema:c,fetch:d}){this.url=r,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(r,l){const{head:c=!1,count:d}=l??{},g=c?"HEAD":"GET";let m=!1;const _=(r??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",_),d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:l,defaultToNull:c=!0}={}){var d;const g="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((_,C)=>_.concat(Object.keys(C)),[]);if(m.length>0){const _=[...new Set(m)].map(C=>`"${C}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(r,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:g=!0}={}){var m;const _="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const C=r.reduce((E,O)=>E.concat(Object.keys(O)),[]);if(C.length>0){const E=[...new Set(C)].map(O=>`"${O}"`);this.url.searchParams.set("columns",E.join(","))}}return new t.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(r,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:r}={}){var l;const c="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return ng.default=n,ng}var S1;function T_(){if(S1)return eg;S1=1,Object.defineProperty(eg,"__esModule",{value:!0});const o=Sf,t=o.__importDefault(QS()),n=o.__importDefault(ov());class a{constructor(l,{headers:c={},schema:d,fetch:g}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=g}from(l){const c=new URL(`${this.url}/${l}`);return new t.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:g=!1,count:m}={}){var _;let C;const E=new URL(`${this.url}/rpc/${l}`);let O;d||g?(C=d?"HEAD":"GET",Object.entries(c).filter(([M,z])=>z!==void 0).map(([M,z])=>[M,Array.isArray(z)?`{${z.join(",")}}`:`${z}`]).forEach(([M,z])=>{E.searchParams.append(M,z)})):(C="POST",O=c);const v=new Headers(this.headers);return m&&v.set("Prefer",`count=${m}`),new n.default({method:C,url:E,headers:v,schema:this.schemaName,body:O,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}}return eg.default=a,eg}var b1;function A_(){if(b1)return Za;b1=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.PostgrestError=Za.PostgrestBuilder=Za.PostgrestTransformBuilder=Za.PostgrestFilterBuilder=Za.PostgrestQueryBuilder=Za.PostgrestClient=void 0;const o=Sf,t=o.__importDefault(T_());Za.PostgrestClient=t.default;const n=o.__importDefault(QS());Za.PostgrestQueryBuilder=n.default;const a=o.__importDefault(ov());Za.PostgrestFilterBuilder=a.default;const r=o.__importDefault(KS());Za.PostgrestTransformBuilder=r.default;const l=o.__importDefault(YS());Za.PostgrestBuilder=l.default;const c=o.__importDefault(VS());return Za.PostgrestError=c.default,Za.default={PostgrestClient:t.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:l.default,PostgrestError:c.default},Za}var w_=A_();const O_=df(w_),{PostgrestClient:R_,PostgrestQueryBuilder:UT,PostgrestFilterBuilder:BT,PostgrestTransformBuilder:zT,PostgrestBuilder:LT,PostgrestError:GT}=O_;class x_{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const a=n.node,r=parseInt(a.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const a=this.getWebSocketConstructor();return new a(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const N_="2.76.1",M_=`realtime-js/${N_}`,D_="1.0.0",Hm=1e4,j_=1e3,U_=100;var sd;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(sd||(sd={}));var Sa;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Sa||(Sa={}));var zr;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(zr||(zr={}));var Im;(function(o){o.websocket="websocket"})(Im||(Im={}));var hu;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(hu||(hu={}));class B_{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,n,a)}_decodeBroadcast(t,n,a){const r=n.getUint8(1),l=n.getUint8(2);let c=this.HEADER_LENGTH+2;const d=a.decode(t.slice(c,c+r));c=c+r;const g=a.decode(t.slice(c,c+l));c=c+l;const m=JSON.parse(a.decode(t.slice(c,t.byteLength)));return{ref:null,topic:d,event:g,payload:m}}}class XS{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var xn;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(xn||(xn={}));const _1=(o,t,n={})=>{var a;const r=(a=n.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=z_(c,o,t,r),l),{}):{}},z_=(o,t,n,a)=>{const r=t.find(d=>d.name===o),l=r==null?void 0:r.type,c=n[o];return l&&!a.includes(l)?FS(l,c):km(c)},FS=(o,t)=>{if(o.charAt(0)==="_"){const n=o.slice(1,o.length);return H_(t,n)}switch(o){case xn.bool:return L_(t);case xn.float4:case xn.float8:case xn.int2:case xn.int4:case xn.int8:case xn.numeric:case xn.oid:return G_(t);case xn.json:case xn.jsonb:return P_(t);case xn.timestamp:return I_(t);case xn.abstime:case xn.date:case xn.daterange:case xn.int4range:case xn.int8range:case xn.money:case xn.reltime:case xn.text:case xn.time:case xn.timestamptz:case xn.timetz:case xn.tsrange:case xn.tstzrange:return km(t);default:return km(t)}},km=o=>o,L_=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},G_=o=>{if(typeof o=="string"){const t=parseFloat(o);if(!Number.isNaN(t))return t}return o},P_=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(t){return console.log(`JSON parse error: ${t}`),o}return o},H_=(o,t)=>{if(typeof o!="string")return o;const n=o.length-1,a=o[n];if(o[0]==="{"&&a==="}"){let l;const c=o.slice(1,n);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>FS(t,d))}return o},I_=o=>typeof o=="string"?o.replace(" ","T"):o,JS=o=>{const t=new URL(o);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Ip{constructor(t,n,a={},r=Hm){this.channel=t,this.event=n,this.payload=a,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var a;return this._hasReceived(t)&&n((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var E1;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(E1||(E1={}));class ld{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},r=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ld.syncState(this.state,r,l,c),this.pendingDiffs.forEach(g=>{this.state=ld.syncDiff(this.state,g,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(a.diff,{},r=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=ld.syncDiff(this.state,r,l,c),d())}),this.onJoin((r,l,c)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:l,newPresences:c})}),this.onLeave((r,l,c)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,a,r){const l=this.cloneDeep(t),c=this.transformState(n),d={},g={};return this.map(l,(m,_)=>{c[m]||(g[m]=_)}),this.map(c,(m,_)=>{const C=l[m];if(C){const E=_.map(z=>z.presence_ref),O=C.map(z=>z.presence_ref),v=_.filter(z=>O.indexOf(z.presence_ref)<0),M=C.filter(z=>E.indexOf(z.presence_ref)<0);v.length>0&&(d[m]=v),M.length>0&&(g[m]=M)}else d[m]=_}),this.syncDiff(l,{joins:d,leaves:g},a,r)}static syncDiff(t,n,a,r){const{joins:l,leaves:c}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return a||(a=()=>{}),r||(r=()=>{}),this.map(l,(d,g)=>{var m;const _=(m=t[d])!==null&&m!==void 0?m:[];if(t[d]=this.cloneDeep(g),_.length>0){const C=t[d].map(O=>O.presence_ref),E=_.filter(O=>C.indexOf(O.presence_ref)<0);t[d].unshift(...E)}a(d,_,g)}),this.map(c,(d,g)=>{let m=t[d];if(!m)return;const _=g.map(C=>C.presence_ref);m=m.filter(C=>_.indexOf(C.presence_ref)<0),t[d]=m,r(d,m,g),m.length===0&&delete t[d]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(a=>n(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,a)=>{const r=t[a];return"metas"in r?n[a]=r.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[a]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var C1;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(C1||(C1={}));var od;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(od||(od={}));var dl;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(dl||(dl={}));class uv{constructor(t,n={config:{}},a){var r,l;if(this.topic=t,this.params=n,this.socket=a,this.bindings={},this.state=Sa.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Ip(this,zr.join,this.params,this.timeout),this.rejoinTimer=new XS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Sa.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Sa.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Sa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Sa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Sa.errored,this.rejoinTimer.scheduleTimeout())}),this._on(zr.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new ld(this),this.broadcastEndpointURL=JS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var a,r,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Sa.closed){const{config:{broadcast:c,presence:d,private:g}}=this.params,m=(r=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(O=>O.filter))!==null&&r!==void 0?r:[],_=!!this.bindings[od.PRESENCE]&&this.bindings[od.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,C={},E={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(C.access_token=this.socket.accessTokenValue),this._onError(O=>t==null?void 0:t(dl.CHANNEL_ERROR,O)),this._onClose(()=>t==null?void 0:t(dl.CLOSED)),this.updateJoinPayload(Object.assign({config:E},C)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:O})=>{var v;if(this.socket.setAuth(),O===void 0){t==null||t(dl.SUBSCRIBED);return}else{const M=this.bindings.postgres_changes,z=(v=M==null?void 0:M.length)!==null&&v!==void 0?v:0,L=[];for(let D=0;D<z;D++){const N=M[D],{filter:{event:G,schema:R,table:A,filter:T}}=N,y=O&&O[D];if(y&&y.event===G&&y.schema===R&&y.table===A&&y.filter===T)L.push(Object.assign(Object.assign({},N),{id:y.id}));else{this.unsubscribe(),this.state=Sa.errored,t==null||t(dl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,t&&t(dl.SUBSCRIBED);return}}).receive("error",O=>{this.state=Sa.errored,t==null||t(dl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(O).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(dl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,a){return this.state===Sa.joined&&t===od.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,a)}async httpSend(t,n,a={}){var r;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=a.timeout)!==null&&r!==void 0?r:this.timeout);if(d.status===202)return{success:!0};let g=d.statusText;try{const m=await d.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(t,n={}){var a,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);return await((r=m.body)===null||r===void 0?void 0:r.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,g;const m=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((g=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Sa.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(zr.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(r=>{a=new Ip(this,zr.leave,{},t),a.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Sa.closed,this.bindings={}}async _fetchWithTimeout(t,n,a){const r=new AbortController,l=setTimeout(()=>r.abort(),a),c=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(l),c}_push(t,n,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Ip(this,t,n,a);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>U_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,a){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,a){var r,l;const c=t.toLocaleLowerCase(),{close:d,error:g,leave:m,join:_}=zr;if(a&&[d,g,m,_].indexOf(c)>=0&&a!==this._joinRef())return;let E=this._onMessage(c,n,a);if(n&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(O=>{var v,M,z;return((v=O.filter)===null||v===void 0?void 0:v.event)==="*"||((z=(M=O.filter)===null||M===void 0?void 0:M.event)===null||z===void 0?void 0:z.toLocaleLowerCase())===c}).map(O=>O.callback(E,a)):(l=this.bindings[c])===null||l===void 0||l.filter(O=>{var v,M,z,L,D,N;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in O){const G=O.id,R=(v=O.filter)===null||v===void 0?void 0:v.event;return G&&((M=n.ids)===null||M===void 0?void 0:M.includes(G))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((z=n.data)===null||z===void 0?void 0:z.type.toLocaleLowerCase()))}else{const G=(D=(L=O==null?void 0:O.filter)===null||L===void 0?void 0:L.event)===null||D===void 0?void 0:D.toLocaleLowerCase();return G==="*"||G===((N=n==null?void 0:n.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return O.type.toLocaleLowerCase()===c}).map(O=>{if(typeof E=="object"&&"ids"in E){const v=E.data,{schema:M,table:z,commit_timestamp:L,type:D,errors:N}=v;E=Object.assign(Object.assign({},{schema:M,table:z,commit_timestamp:L,eventType:D,new:{},old:{},errors:N}),this._getPayloadRecords(v))}O.callback(E,a)})}_isClosed(){return this.state===Sa.closed}_isJoined(){return this.state===Sa.joined}_isJoining(){return this.state===Sa.joining}_isLeaving(){return this.state===Sa.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,a){const r=t.toLocaleLowerCase(),l={type:r,filter:n,callback:a};return this.bindings[r]?this.bindings[r].push(l):this.bindings[r]=[l],this}_off(t,n){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(r=>{var l;return!(((l=r.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&uv.isEqual(r.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const a in t)if(t[a]!==n[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(zr.close,{},t)}_onError(t){this._on(zr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Sa.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=_1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=_1(t.columns,t.old_record)),n}}const kp=()=>{},lg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},k_=[1e3,2e3,5e3,1e4],q_=1e4,V_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Y_{constructor(t,n){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Hm,this.transport=null,this.heartbeatIntervalMs=lg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=kp,this.ref=0,this.reconnectTimer=null,this.logger=kp,this.conn=null,this.sendBuffer=[],this.serializer=new B_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let l;return r?l=r:typeof fetch>"u"?l=(...c)=>Eu(async()=>{const{default:d}=await Promise.resolve().then(()=>Cu);return{default:d}},void 0).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((a=n==null?void 0:n.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${Im.websocket}`,this.httpEndpoint=JS(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=x_.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:D_}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,a){this.logger(t,n,a)}connectionState(){switch(this.conn&&this.conn.readyState){case sd.connecting:return hu.Connecting;case sd.open:return hu.Open;case sd.closing:return hu.Closing;default:return hu.Closed}}isConnected(){return this.connectionState()===hu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const a=`realtime:${t}`,r=this.getChannels().find(l=>l.topic===a);if(r)return r;{const l=new uv(`realtime:${t}`,n,this);return this.channels.push(l),l}}push(t){const{topic:n,event:a,payload:r,ref:l}=t,c=()=>{this.encode(t,d=>{var g;(g=this.conn)===null||g===void 0||g.send(d)})};this.log("push",`${n} ${a} (${l})`,r),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(j_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},lg.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:r,payload:l,ref:c}=n,d=c?`(${c})`:"",g=l.status||"";this.log("receive",`${g} ${a} ${r} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(a)).forEach(m=>m._trigger(r,l,c)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(zr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const a=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${a}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const a=new Blob([V_],{type:"application/javascript"});n=URL.createObjectURL(a)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(a=>{const r={access_token:n,version:M_};n&&a.updateJoinPayload(r),a.joinedOnce&&a._isJoined()&&a._push(zr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(n)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new XS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,a,r,l,c,d,g,m,_;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:Hm,this.heartbeatIntervalMs=(r=t==null?void 0:t.heartbeatIntervalMs)!==null&&r!==void 0?r:lg.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t==null?void 0:t.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=t==null?void 0:t.heartbeatCallback)!==null&&d!==void 0?d:kp,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(C=>k_[C-1]||q_),this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((C,E)=>E(JSON.stringify(C))),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class cv extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function qn(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class K_ extends cv{constructor(t,n,a){super(t),this.name="StorageApiError",this.status=n,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class qm extends cv{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const fv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>Eu(async()=>{const{default:a}=await Promise.resolve().then(()=>Cu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},Q_=()=>re(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Eu(()=>Promise.resolve().then(()=>Cu),void 0)).Response:Response}),Vm=o=>{if(Array.isArray(o))return o.map(n=>Vm(n));if(typeof o=="function"||o!==Object(o))return o;const t={};return Object.entries(o).forEach(([n,a])=>{const r=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[r]=Vm(a)}),t},X_=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},qp=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),F_=(o,t,n)=>re(void 0,void 0,void 0,function*(){const a=yield Q_();o instanceof a&&!(n!=null&&n.noResolveJson)?o.json().then(r=>{const l=o.status||500,c=(r==null?void 0:r.statusCode)||l+"";t(new K_(qp(r),l,c))}).catch(r=>{t(new qm(qp(r),r))}):t(new qm(qp(o),o))}),J_=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"||!a?r:(X_(a)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,t!=null&&t.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),n))};function vd(o,t,n,a,r,l){return re(this,void 0,void 0,function*(){return new Promise((c,d)=>{o(n,J_(t,a,r,l)).then(g=>{if(!g.ok)throw g;return a!=null&&a.noResolveJson?g:g.json()}).then(g=>c(g)).catch(g=>F_(g,d,a))})})}function hd(o,t,n,a){return re(this,void 0,void 0,function*(){return vd(o,"GET",t,n,a)})}function Br(o,t,n,a,r){return re(this,void 0,void 0,function*(){return vd(o,"POST",t,a,r,n)})}function Ym(o,t,n,a,r){return re(this,void 0,void 0,function*(){return vd(o,"PUT",t,a,r,n)})}function Z_(o,t,n,a){return re(this,void 0,void 0,function*(){return vd(o,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),a)})}function hv(o,t,n,a,r){return re(this,void 0,void 0,function*(){return vd(o,"DELETE",t,a,r,n)})}class W_{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return re(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(qn(t))return{data:null,error:t};throw t}})}}var ZS;class $_{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[ZS]="BlobDownloadBuilder",this.promise=null}asStream(){return new W_(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return re(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(qn(t))return{data:null,error:t};throw t}})}}ZS=Symbol.toStringTag;const tE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},T1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class eE{constructor(t,n={},a,r){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=a,this.fetch=fv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,a,r){return re(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},T1),r);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(c.upsert)});const g=c.metadata;typeof Blob<"u"&&a instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",this.encodeMetadata(g)),l.append("",a)):typeof FormData<"u"&&a instanceof FormData?(l=a,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",this.encodeMetadata(g))):(l=a,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,g&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),r!=null&&r.headers&&(d=Object.assign(Object.assign({},d),r.headers));const m=this._removeEmptyFolders(n),_=this._getFinalPath(m),C=yield(t=="PUT"?Ym:Br)(this.fetch,`${this.url}/object/${_}`,l,Object.assign({headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:C.Id,fullPath:C.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(qn(l))return{data:null,error:l};throw l}})}upload(t,n,a){return re(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,a)})}uploadToSignedUrl(t,n,a,r){return re(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",n);try{let g;const m=Object.assign({upsert:T1.upsert},r),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&a instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",a)):typeof FormData<"u"&&a instanceof FormData?(g=a,g.append("cacheControl",m.cacheControl)):(g=a,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType);const C=yield Ym(this.fetch,d.toString(),g,{headers:_});return{data:{path:l,fullPath:C.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(qn(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(t,n){return re(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const l=yield Br(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:r}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new cv("No token returned by API");return{data:{signedUrl:c.toString(),path:t,token:d},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(qn(a))return{data:null,error:a};throw a}})}update(t,n,a){return re(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,a)})}move(t,n,a){return re(this,void 0,void 0,function*(){try{return{data:yield Br(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(qn(r))return{data:null,error:r};throw r}})}copy(t,n,a){return re(this,void 0,void 0,function*(){try{return{data:{path:(yield Br(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(qn(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,a){return re(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),l=yield Br(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const c=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(qn(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,a){return re(this,void 0,void 0,function*(){try{const r=yield Br(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),l=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:r.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(qn(r))return{data:null,error:r};throw r}})}download(t,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),c=l?`?${l}`:"",d=this._getFinalPath(t),g=()=>hd(this.fetch,`${this.url}/${r}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new $_(g,this.shouldThrowOnError)}info(t){return re(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const a=yield hd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Vm(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(qn(a))return{data:null,error:a};throw a}})}exists(t){return re(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield Z_(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(qn(a)&&a instanceof qm){const r=a.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,n){const a=this._getFinalPath(t),r=[],l=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&r.push(l);const d=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});g!==""&&r.push(g);let m=r.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${a}${m}`)}}}remove(t){return re(this,void 0,void 0,function*(){try{return{data:yield hv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(qn(n))return{data:null,error:n};throw n}})}list(t,n,a){return re(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},tE),n),{prefix:t||""});return{data:yield Br(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},a),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(qn(r))return{data:null,error:r};throw r}})}listV2(t,n){return re(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield Br(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(qn(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const WS="2.76.1",$S={"X-Client-Info":`storage-js/${WS}`};class nE{constructor(t,n={},a,r){this.shouldThrowOnError=!1;const l=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$S),n),this.fetch=fv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return re(this,void 0,void 0,function*(){try{return{data:yield hd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(qn(t))return{data:null,error:t};throw t}})}getBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield hd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(qn(n))return{data:null,error:n};throw n}})}createBucket(t){return re(this,arguments,void 0,function*(n,a={public:!1}){try{return{data:yield Br(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(qn(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return re(this,void 0,void 0,function*(){try{return{data:yield Ym(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(qn(a))return{data:null,error:a};throw a}})}emptyBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield Br(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(qn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield hv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(qn(n))return{data:null,error:n};throw n}})}}class aE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$S),n),this.fetch=fv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield Br(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(qn(n))return{data:null,error:n};throw n}})}listBuckets(t){return re(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const a=n.toString(),r=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`,l=yield hd(this.fetch,r,{headers:this.headers});return{data:Array.isArray(l)?l.filter(d=>d.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(qn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield hv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(qn(n))return{data:null,error:n};throw n}})}}const dv={"X-Client-Info":`storage-js/${WS}`,"Content-Type":"application/json"};class tb extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Ui(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class Vp extends tb{constructor(t,n,a){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class iE extends tb{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var A1;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(A1||(A1={}));const gv=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>Eu(async()=>{const{default:a}=await Promise.resolve().then(()=>Cu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},rE=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},w1=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),sE=(o,t,n)=>re(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!(n!=null&&n.noResolveJson)){const r=o.status||500,l=o;if(typeof l.json=="function")l.json().then(c=>{const d=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||r+"";t(new Vp(w1(c),r,d))}).catch(()=>{const c=r+"",d=l.statusText||`HTTP ${r} error`;t(new Vp(d,r,c))});else{const c=r+"",d=l.statusText||`HTTP ${r} error`;t(new Vp(d,r,c))}}else t(new iE(w1(o),o))}),lE=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return a?(rE(a)?(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,Object.assign(Object.assign({},r),n)):r};function oE(o,t,n,a,r,l){return re(this,void 0,void 0,function*(){return new Promise((c,d)=>{o(n,lE(t,a,r,l)).then(g=>{if(!g.ok)throw g;if(a!=null&&a.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>c(g)).catch(g=>sE(g,d,a))})})}function Bi(o,t,n,a,r){return re(this,void 0,void 0,function*(){return oE(o,"POST",t,a,r,n)})}class uE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},dv),n),this.fetch=gv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return re(this,void 0,void 0,function*(){try{return{data:(yield Bi(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}getIndex(t,n){return re(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ui(a))return{data:null,error:a};throw a}})}listIndexes(t){return re(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return re(this,void 0,void 0,function*(){try{return{data:(yield Bi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ui(a))return{data:null,error:a};throw a}})}}class cE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},dv),n),this.fetch=gv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return re(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Bi(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}getVectors(t){return re(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}listVectors(t){return re(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Bi(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}queryVectors(t){return re(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}deleteVectors(t){return re(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Bi(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}}class fE{constructor(t,n={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},dv),n),this.fetch=gv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return re(this,void 0,void 0,function*(){try{return{data:(yield Bi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}getBucket(t){return re(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}listBuckets(){return re(this,arguments,void 0,function*(t={}){try{return{data:yield Bi(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}deleteBucket(t){return re(this,void 0,void 0,function*(){try{return{data:(yield Bi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ui(n))return{data:null,error:n};throw n}})}}class hE extends fE{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new dE(this.url,this.headers,t,this.fetch)}}class dE extends uE{constructor(t,n,a,r){super(t,n,r),this.vectorBucketName=a}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return re(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return re(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return re(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return re(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new gE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class gE extends cE{constructor(t,n,a,r,l){super(t,n,l),this.vectorBucketName=a,this.indexName=r}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return re(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return re(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return re(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return re(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return re(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class pE extends nE{constructor(t,n={},a,r){super(t,n,a,r)}from(t){return new eE(this.url,this.headers,t,this.fetch)}get vectors(){return new hE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new aE(this.url+"/iceberg",this.headers,this.fetch)}}const mE="2.76.1";let ed="";typeof Deno<"u"?ed="deno":typeof document<"u"?ed="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ed="react-native":ed="node";const vE={"X-Client-Info":`supabase-js-${ed}/${mE}`},yE={headers:vE},SE={schema:"public"},bE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_E={},EE=o=>{let t;return o?t=o:typeof fetch>"u"?t=kS:t=fetch,(...n)=>t(...n)},CE=()=>typeof Headers>"u"?qS:Headers,TE=(o,t,n)=>{const a=EE(n),r=CE();return async(l,c)=>{var d;const g=(d=await t())!==null&&d!==void 0?d:o;let m=new r(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),a(l,Object.assign(Object.assign({},c),{headers:m}))}};function AE(o){return o.endsWith("/")?o:o+"/"}function wE(o,t){var n,a;const{db:r,auth:l,realtime:c,global:d}=o,{db:g,auth:m,realtime:_,global:C}=t,E={db:Object.assign(Object.assign({},g),r),auth:Object.assign(Object.assign({},m),l),realtime:Object.assign(Object.assign({},_),c),storage:{},global:Object.assign(Object.assign(Object.assign({},C),d),{headers:Object.assign(Object.assign({},(n=C==null?void 0:C.headers)!==null&&n!==void 0?n:{}),(a=d==null?void 0:d.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return o.accessToken?E.accessToken=o.accessToken:delete E.accessToken,E}function OE(o){const t=o==null?void 0:o.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(AE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const eb="2.76.1",rf=30*1e3,Km=3,Yp=Km*rf,RE="http://localhost:9999",xE="supabase.auth.token",NE={"X-Client-Info":`gotrue-js/${eb}`},Qm="X-Supabase-Api-Version",nb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ME=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,DE=600*1e3;class dd extends Error{constructor(t,n,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=a}}function fe(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class jE extends dd{constructor(t,n,a){super(t,n,a),this.name="AuthApiError",this.status=n,this.code=a}}function UE(o){return fe(o)&&o.name==="AuthApiError"}class du extends dd{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class yo extends dd{constructor(t,n,a,r){super(t,a,r),this.name=n,this.status=a}}class lo extends yo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function BE(o){return fe(o)&&o.name==="AuthSessionMissingError"}class Jc extends yo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class og extends yo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ug extends yo{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function zE(o){return fe(o)&&o.name==="AuthImplicitGrantRedirectError"}class O1 extends yo{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Xm extends yo{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Kp(o){return fe(o)&&o.name==="AuthRetryableFetchError"}class R1 extends yo{constructor(t,n,a){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=a}}class Fm extends yo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Sg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),x1=` 	
\r=`.split(""),LE=(()=>{const o=new Array(128);for(let t=0;t<o.length;t+=1)o[t]=-1;for(let t=0;t<x1.length;t+=1)o[x1[t].charCodeAt(0)]=-2;for(let t=0;t<Sg.length;t+=1)o[Sg[t].charCodeAt(0)]=t;return o})();function N1(o,t,n){if(o!==null)for(t.queue=t.queue<<8|o,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;n(Sg[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;n(Sg[a]),t.queuedBits-=6}}function ab(o,t,n){const a=LE[o];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function M1(o){const t=[],n=c=>{t.push(String.fromCodePoint(c))},a={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},l=c=>{HE(c,a,n)};for(let c=0;c<o.length;c+=1)ab(o.charCodeAt(c),r,l);return t.join("")}function GE(o,t){if(o<=127){t(o);return}else if(o<=2047){t(192|o>>6),t(128|o&63);return}else if(o<=65535){t(224|o>>12),t(128|o>>6&63),t(128|o&63);return}else if(o<=1114111){t(240|o>>18),t(128|o>>12&63),t(128|o>>6&63),t(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function PE(o,t){for(let n=0;n<o.length;n+=1){let a=o.charCodeAt(n);if(a>55295&&a<=56319){const r=(a-55296)*1024&65535;a=(o.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}GE(a,t)}}function HE(o,t,n){if(t.utf8seq===0){if(o<=127){n(o);return}for(let a=1;a<6;a+=1)if((o>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=o&31;else if(t.utf8seq===3)t.codepoint=o&15;else if(t.utf8seq===4)t.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|o&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function of(o){const t=[],n={queue:0,queuedBits:0},a=r=>{t.push(r)};for(let r=0;r<o.length;r+=1)ab(o.charCodeAt(r),n,a);return new Uint8Array(t)}function IE(o){const t=[];return PE(o,n=>t.push(n)),new Uint8Array(t)}function pu(o){const t=[],n={queue:0,queuedBits:0},a=r=>{t.push(r)};return o.forEach(r=>N1(r,n,a)),N1(null,n,a),t.join("")}function kE(o){return Math.round(Date.now()/1e3)+o}function qE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o=="x"?t:t&3|8).toString(16)})}const Di=()=>typeof window<"u"&&typeof document<"u",ou={tested:!1,writable:!1},ib=()=>{if(!Di())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ou.tested)return ou.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ou.tested=!0,ou.writable=!0}catch{ou.tested=!0,ou.writable=!1}return ou.writable};function VE(o){const t={},n=new URL(o);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,l)=>{t[l]=r})}catch{}return n.searchParams.forEach((a,r)=>{t[r]=a}),t}const rb=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...n)=>Eu(async()=>{const{default:a}=await Promise.resolve().then(()=>Cu);return{default:a}},void 0).then(({default:a})=>a(...n)):t=fetch,(...n)=>t(...n)},YE=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",sf=async(o,t,n)=>{await o.setItem(t,JSON.stringify(n))},uu=async(o,t)=>{const n=await o.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},ao=async(o,t)=>{await o.removeItem(t)};class jg{constructor(){this.promise=new jg.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}jg.promiseConstructor=Promise;function Qp(o){const t=o.split(".");if(t.length!==3)throw new Fm("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!ME.test(t[a]))throw new Fm("JWT not in base64url format");return{header:JSON.parse(M1(t[0])),payload:JSON.parse(M1(t[1])),signature:of(t[2]),raw:{header:t[0],payload:t[1]}}}async function KE(o){return await new Promise(t=>{setTimeout(()=>t(null),o)})}function QE(o,t){return new Promise((a,r)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await o(l);if(!t(l,null,c)){a(c);return}}catch(c){if(!t(l,c)){r(c);return}}})()})}function XE(o){return("0"+o.toString(16)).substr(-2)}function FE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=n.length;let r="";for(let l=0;l<56;l++)r+=n.charAt(Math.floor(Math.random()*a));return r}return crypto.getRandomValues(t),Array.from(t,XE).join("")}async function JE(o){const n=new TextEncoder().encode(o),a=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(a);return Array.from(r).map(l=>String.fromCharCode(l)).join("")}async function ZE(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const n=await JE(o);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Zc(o,t,n=!1){const a=FE();let r=a;n&&(r+="/PASSWORD_RECOVERY"),await sf(o,`${t}-code-verifier`,r);const l=await ZE(a);return[l,a===l?"plain":"s256"]}const WE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function $E(o){const t=o.headers.get(Qm);if(!t||!t.match(WE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function tC(o){if(!o)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(o<=t)throw new Error("JWT has expired")}function eC(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const nC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wc(o){if(!nC.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xp(){const o={};return new Proxy(o,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function D1(o){return JSON.parse(JSON.stringify(o))}const fu=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),aC=[502,503,504];async function j1(o){var t;if(!YE(o))throw new Xm(fu(o),0);if(aC.includes(o.status))throw new Xm(fu(o),o.status);let n;try{n=await o.json()}catch(l){throw new du(fu(l),l)}let a;const r=$E(o);if(r&&r.getTime()>=nb["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?a=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(a=n.error_code),a){if(a==="weak_password")throw new R1(fu(n),o.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new lo}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new R1(fu(n),o.status,n.weak_password.reasons);throw new jE(fu(n),o.status||500,a)}const iC=(o,t,n,a)=>{const r={method:o,headers:(t==null?void 0:t.headers)||{}};return o==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(a),Object.assign(Object.assign({},r),n))};async function we(o,t,n,a){var r;const l=Object.assign({},a==null?void 0:a.headers);l[Qm]||(l[Qm]=nb["2024-01-01"].name),a!=null&&a.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const c=(r=a==null?void 0:a.query)!==null&&r!==void 0?r:{};a!=null&&a.redirectTo&&(c.redirect_to=a.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",g=await rC(o,t,n+d,{headers:l,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(g):{data:Object.assign({},g),error:null}}async function rC(o,t,n,a,r,l){const c=iC(t,a,r,l);let d;try{d=await o(n,Object.assign({},c))}catch(g){throw console.error(g),new Xm(fu(g),0)}if(d.ok||await j1(d),a!=null&&a.noResolveJson)return d;try{return await d.json()}catch(g){await j1(g)}}function Ur(o){var t;let n=null;oC(o)&&(n=Object.assign({},o),o.expires_at||(n.expires_at=kE(o.expires_in)));const a=(t=o.user)!==null&&t!==void 0?t:o;return{data:{session:n,user:a},error:null}}function U1(o){const t=Ur(o);return!t.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((n,a)=>n&&typeof a=="string",!0)&&(t.data.weak_password=o.weak_password),t}function uo(o){var t;return{data:{user:(t=o.user)!==null&&t!==void 0?t:o},error:null}}function sC(o){return{data:o,error:null}}function lC(o){const{action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:l}=o,c=yf(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:l},g=Object.assign({},c);return{data:{properties:d,user:g},error:null}}function B1(o){return o}function oC(o){return o.access_token&&o.refresh_token&&o.expires_in}const Fp=["global","local","others"];class uC{constructor({url:t="",headers:n={},fetch:a}){this.url=t,this.headers=n,this.fetch=rb(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Fp[0]){if(Fp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fp.join(", ")}`);try{return await we(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(fe(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,n={}){try{return await we(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:uo})}catch(a){if(fe(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:n}=t,a=yf(t,["options"]),r=Object.assign(Object.assign({},a),n);return"newEmail"in a&&(r.new_email=a==null?void 0:a.newEmail,delete r.newEmail),await we(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:lC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(fe(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await we(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:uo})}catch(n){if(fe(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,a,r,l,c,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await we(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:B1});if(_.error)throw _.error;const C=await _.json(),E=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,O=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return O.length>0&&(O.forEach(v=>{const M=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(v.split(";")[1].split("=")[1]);m[`${z}Page`]=M}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(fe(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){Wc(t);try{return await we(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:uo})}catch(n){if(fe(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Wc(t);try{return await we(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:uo})}catch(a){if(fe(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,n=!1){Wc(t);try{return await we(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:uo})}catch(a){if(fe(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Wc(t.userId);try{const{data:n,error:a}=await we(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:a}}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Wc(t.userId),Wc(t.id);try{return{data:await we(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,a,r,l,c,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await we(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",per_page:(l=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:""},xform:B1});if(_.error)throw _.error;const C=await _.json(),E=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,O=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return O.length>0&&(O.forEach(v=>{const M=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(v.split(";")[1].split("=")[1]);m[`${z}Page`]=M}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},C),m),error:null}}catch(m){if(fe(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await we(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await we(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await we(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await we(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}}function z1(o={}){return{getItem:t=>o[t]||null,setItem:(t,n)=>{o[t]=n},removeItem:t=>{delete o[t]}}}const $c={debug:!!(globalThis&&ib()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class sb extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class cC extends sb{}async function fC(o,t,n){$c.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),$c.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async r=>{if(r){$c.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,r.name);try{return await n()}finally{$c.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,r.name)}}else{if(t===0)throw $c.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new cC(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if($c.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function hC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function lb(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function dC(o){return parseInt(o,16)}function gC(o){const t=new TextEncoder().encode(o);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function pC(o){var t;const{chainId:n,domain:a,expirationTime:r,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:g,resources:m,scheme:_,uri:C,version:E}=o;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!C)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((t=o.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const O=lb(o.address),v=_?`${_}://${a}`:a,M=o.statement?`${o.statement}
`:"",z=`${v} wants you to sign in with your Ethereum account:
${O}

${M}`;let L=`URI: ${C}
Version: ${E}
Chain ID: ${n}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(r&&(L+=`
Expiration Time: ${r.toISOString()}`),d&&(L+=`
Not Before: ${d.toISOString()}`),g&&(L+=`
Request ID: ${g}`),m){let D=`
Resources:`;for(const N of m){if(!N||typeof N!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${N}`);D+=`
- ${N}`}L+=D}return`${z}
${L}`}class la extends Error{constructor({message:t,code:n,cause:a,name:r}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=r??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class bg extends la{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function mC({error:o,options:t}){var n,a,r;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new la({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new la({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new la({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new la({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new la({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new la({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new la({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new la({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const c=window.location.hostname;if(ob(c)){if(l.rp.id!==c)return new la({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new la({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new la({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new la({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new la({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function vC({error:o,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new la({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new la({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const a=window.location.hostname;if(ob(a)){if(n.rpId!==a)return new la({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new la({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new la({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new la({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class yC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const SC=new yC;function bC(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:t,user:n,excludeCredentials:a}=o,r=yf(o,["challenge","user","excludeCredentials"]),l=of(t).buffer,c=Object.assign(Object.assign({},n),{id:of(n.id).buffer}),d=Object.assign(Object.assign({},r),{challenge:l,user:c});if(a&&a.length>0){d.excludeCredentials=new Array(a.length);for(let g=0;g<a.length;g++){const m=a[g];d.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:of(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function _C(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:t,allowCredentials:n}=o,a=yf(o,["challenge","allowCredentials"]),r=of(t).buffer,l=Object.assign(Object.assign({},a),{challenge:r});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:of(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function EC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o;return{id:o.id,rawId:o.id,response:{attestationObject:pu(new Uint8Array(o.response.attestationObject)),clientDataJSON:pu(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function CC(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const n=o,a=o.getClientExtensionResults(),r=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:pu(new Uint8Array(r.authenticatorData)),clientDataJSON:pu(new Uint8Array(r.clientDataJSON)),signature:pu(new Uint8Array(r.signature)),userHandle:r.userHandle?pu(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function ob(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function L1(){var o,t;return!!(Di()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator==null?void 0:navigator.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function TC(o){try{const t=await navigator.credentials.create(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new bg("Browser returned unexpected credential type",t)}:{data:null,error:new bg("Empty credential response",t)}}catch(t){return{data:null,error:mC({error:t,options:o})}}}async function AC(o){try{const t=await navigator.credentials.get(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new bg("Browser returned unexpected credential type",t)}:{data:null,error:new bg("Empty credential response",t)}}catch(t){return{data:null,error:vC({error:t,options:o})}}}const wC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},OC={userVerification:"preferred",hints:["security-key"]};function _g(...o){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),a={};for(const r of o)if(r)for(const l in r){const c=r[l];if(c!==void 0)if(Array.isArray(c))a[l]=c;else if(n(c))a[l]=c;else if(t(c)){const d=a[l];t(d)?a[l]=_g(d,c):a[l]=_g(c)}else a[l]=c}return a}function RC(o,t){return _g(wC,o,t||{})}function xC(o,t){return _g(OC,o,t||{})}class NC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:a,signal:r},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!c)return{data:null,error:d};const g=r??SC.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${a}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=RC(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:C}=await TC({publicKey:m,signal:g});return _?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}case"request":{const m=xC(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:C}=await AC(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:C}}}}catch(c){return fe(c)?{data:null,error:c}:{data:null,error:new du("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:n,webauthn:a}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:r}},l){if(!n)return{data:null,error:new dd("rpId is required for WebAuthn authentication")};try{if(!L1())return{data:null,error:new du("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:a},signal:r},{request:l});if(!c)return{data:null,error:d};const{webauthn:g}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:g.type,rpId:n,rpOrigins:a,credential_response:g.credential_response}})}catch(c){return fe(c)?{data:null,error:c}:{data:null,error:new du("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:r},l){if(!n)return{data:null,error:new dd("rpId is required for WebAuthn registration")};try{if(!L1())return{data:null,error:new du("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(_=>{var C;return(C=_.data)===null||C===void 0?void 0:C.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===t&&E.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:d};const{data:g,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:n,rpOrigins:a},signal:r},{create:l});return g?this._verify({factorId:c.id,challengeId:g.challengeId,webauthn:{rpId:n,rpOrigins:a,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(c){return fe(c)?{data:null,error:c}:{data:null,error:new du("Unexpected error in register",c)}}}}hC();const MC={url:RE,storageKey:xE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:NE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function G1(o,t,n){return await n()}const tf={};class gd{get jwks(){var t,n;return(n=(t=tf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){tf[this.storageKey]=Object.assign(Object.assign({},tf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=tf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){tf[this.storageKey]=Object.assign(Object.assign({},tf[this.storageKey]),{cachedAt:t})}constructor(t){var n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=gd.nextInstanceID,gd.nextInstanceID+=1,this.instanceID>0&&Di()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},MC),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new uC({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=rb(r.fetch),this.lock=r.lock||G1,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Di()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=fC:this.lock=G1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new NC(this)},this.persistSession?(r.storage?this.storage=r.storage:ib()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=z1(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=z1(this.memoryStorage)),Di()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${eb}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=VE(window.location.href);let a="none";if(this._isImplicitGrantCallback(n)?a="implicit":await this._isPKCECallback(n)&&(a="pkce"),Di()&&this.detectSessionInUrl&&a!=="none"){const{data:r,error:l}=await this._getSessionFromURL(n,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),zE(l)){const g=(t=l.details)===null||t===void 0?void 0:t.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=r;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return fe(n)?{error:n}:{error:new du("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,a,r;try{const l=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ur}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const g=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(fe(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var n,a,r;try{let l;if("email"in t){const{email:_,password:C,options:E}=t;let O=null,v=null;this.flowType==="pkce"&&([O,v]=await Zc(this.storage,this.storageKey)),l=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:_,password:C,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:O,code_challenge_method:v},xform:Ur})}else if("phone"in t){const{phone:_,password:C,options:E}=t;l=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:C,data:(a=E==null?void 0:E.data)!==null&&a!==void 0?a:{},channel:(r=E==null?void 0:E.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:Ur})}else throw new og("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const g=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(l){if(fe(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:c,options:d}=t;n=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:U1})}else if("phone"in t){const{phone:l,password:c,options:d}=t;n=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:U1})}else throw new og("You must provide either an email or phone number and a password");const{data:a,error:r}=n;return r?{data:{user:null,session:null},error:r}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Jc}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:r})}catch(n){if(fe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,a,r,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,a,r,l,c,d,g,m,_,C,E;let O,v;if("message"in t)O=t.message,v=t.signature;else{const{chain:M,wallet:z,statement:L,options:D}=t;let N;if(Di())if(typeof z=="object")N=z;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")N=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof z!="object"||!(D!=null&&D.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=z}const G=new URL((n=D==null?void 0:D.url)!==null&&n!==void 0?n:window.location.href),R=await N.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=lb(R[0]);let T=(a=D==null?void 0:D.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!T){const B=await N.request({method:"eth_chainId"});T=dC(B)}const y={domain:G.host,address:A,statement:L,uri:G.href,version:"1",chainId:T,nonce:(r=D==null?void 0:D.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(c=(l=D==null?void 0:D.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=D==null?void 0:D.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(g=D==null?void 0:D.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=D==null?void 0:D.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=D==null?void 0:D.signInWithEthereum)===null||_===void 0?void 0:_.resources};O=pC(y),v=await N.request({method:"personal_sign",params:[gC(O),A]})}try{const{data:M,error:z}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:O,signature:v},!((C=t.options)===null||C===void 0)&&C.captchaToken?{gotrue_meta_security:{captcha_token:(E=t.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:Ur});if(z)throw z;return!M||!M.session||!M.user?{data:{user:null,session:null},error:new Jc}:(M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),{data:Object.assign({},M),error:z})}catch(M){if(fe(M))return{data:{user:null,session:null},error:M};throw M}}async signInWithSolana(t){var n,a,r,l,c,d,g,m,_,C,E,O;let v,M;if("message"in t)v=t.message,M=t.signature;else{const{chain:z,wallet:L,statement:D,options:N}=t;let G;if(Di())if(typeof L=="object")G=L;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))G=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=L}const R=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in G&&G.signIn){const A=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),D?{statement:D}:null));let T;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")T=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)T=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)v=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),M=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${R.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...D?["",D,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(r=(a=N==null?void 0:N.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((l=N==null?void 0:N.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((g=N==null?void 0:N.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((m=N==null?void 0:N.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((C=(_=N==null?void 0:N.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||C===void 0)&&C.length?["Resources",...N.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const A=await G.signMessage(new TextEncoder().encode(v),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");M=A}}try{const{data:z,error:L}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:pu(M)},!((E=t.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(O=t.options)===null||O===void 0?void 0:O.captchaToken}}:null),xform:Ur});if(L)throw L;return!z||!z.session||!z.user?{data:{user:null,session:null},error:new Jc}:(z.session&&(await this._saveSession(z.session),await this._notifyAllSubscribers("SIGNED_IN",z.session)),{data:Object.assign({},z),error:L})}catch(z){if(fe(z))return{data:{user:null,session:null},error:z};throw z}}async _exchangeCodeForSession(t){const n=await uu(this.storage,`${this.storageKey}-code-verifier`),[a,r]=(n??"").split("/");try{const{data:l,error:c}=await we(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:Ur});if(await ao(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Jc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:r??null}),error:c})}catch(l){if(fe(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:n,provider:a,token:r,access_token:l,nonce:c}=t,d=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:r,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ur}),{data:g,error:m}=d;return m?{data:{user:null,session:null},error:m}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Jc}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:m})}catch(n){if(fe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,a,r,l,c;try{if("email"in t){const{email:d,options:g}=t;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await Zc(this.storage,this.storageKey));const{error:C}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},create_user:(a=g==null?void 0:g.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:d,options:g}=t,{data:m,error:_}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(c=g==null?void 0:g.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_}}throw new og("You must provide either an email or phone number.")}catch(d){if(fe(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(t){var n,a;try{let r,l;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:c,error:d}=await we(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:r,xform:Ur});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const g=c.session,m=c.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:m,session:g},error:null}}catch(r){if(fe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,a,r;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await Zc(this.storage,this.storageKey)),await we(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&a!==void 0?a:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:sC})}catch(l){if(fe(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;if(a)throw a;if(!n)throw new lo;const{error:r}=await we(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(fe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:a,type:r,options:l}=t,{error:c}=await we(this.fetch,"POST",n,{headers:this.headers,body:{email:a,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in t){const{phone:a,type:r,options:l}=t,{data:c,error:d}=await we(this.fetch,"POST",n,{headers:this.headers,body:{phone:a,type:r,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new og("You must provide either an email or phone number and a type")}catch(n){if(fe(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await a,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=n();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await uu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<Yp:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const c=await uu(this.userStorage,this.storageKey+"-user");c!=null&&c.user?t.user=c.user:t.user=Xp()}if(this.storage.isServer&&t.user){let c=this.suppressGetSessionWarning;t=new Proxy(t,{get:(g,m,_)=>(!c&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,m,_))})}return{data:{session:t},error:null}}const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:uo}):await this._useSession(async n=>{var a,r,l;const{data:c,error:d}=n;if(d)throw d;return!(!((a=c.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new lo}:await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(r=c.session)===null||r===void 0?void 0:r.access_token)!==null&&l!==void 0?l:void 0,xform:uo})})}catch(n){if(fe(n))return BE(n)&&(await this._removeSession(),await ao(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async a=>{const{data:r,error:l}=a;if(l)throw l;if(!r.session)throw new lo;const c=r.session;let d=null,g=null;this.flowType==="pkce"&&t.email!=null&&([d,g]=await Zc(this.storage,this.storageKey));const{data:m,error:_}=await we(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:g}),jwt:c.access_token,xform:uo});if(_)throw _;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(a){if(fe(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new lo;const n=Date.now()/1e3;let a=n,r=!0,l=null;const{payload:c}=Qp(t.access_token);if(c.exp&&(a=c.exp,r=a<=n),r){const{data:d,error:g}=await this._callRefreshToken(t.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:g}=await this._getUser(t.access_token);if(g)throw g;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:a-n,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(n){if(fe(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var a;if(!t){const{data:c,error:d}=n;if(d)throw d;t=(a=c.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new lo;const{data:r,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(fe(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!Di())throw new ug("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ug(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new O1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ug("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new O1("No code detected.");const{data:D,error:N}=await this._exchangeCodeForSession(t.code);if(N)throw N;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:D.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:r,access_token:l,refresh_token:c,expires_in:d,expires_at:g,token_type:m}=t;if(!l||!d||!c||!m)throw new ug("No session defined in URL");const _=Math.round(Date.now()/1e3),C=parseInt(d);let E=_+C;g&&(E=parseInt(g));const O=E-_;O*1e3<=rf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${O}s, should have been closer to ${C}s`);const v=E-C;_-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,E,_):_-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,E,_);const{data:M,error:z}=await this._getUser(l);if(z)throw z;const L={provider_token:a,provider_refresh_token:r,access_token:l,expires_in:C,expires_at:E,refresh_token:c,token_type:m,user:M.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:L,redirectType:t.type},error:null}}catch(a){if(fe(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await uu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{error:l};const c=(a=r.session)===null||a===void 0?void 0:a.access_token;if(c){const{error:d}=await this.admin.signOut(c,t);if(d&&!(UE(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return t!=="others"&&(await this._removeSession(),await ao(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=qE(),a={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async n=>{var a,r;try{const{data:{session:l},error:c}=n;if(c)throw c;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let a=null,r=null;this.flowType==="pkce"&&([a,r]=await Zc(this.storage,this.storageKey,!0));try{return await we(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(fe(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:n,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:a,error:r}=await this._useSession(async l=>{var c,d,g,m,_;const{data:C,error:E}=l;if(E)throw E;const O=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=t.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await we(this.fetch,"GET",O,{headers:this.headers,jwt:(_=(m=C.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(r)throw r;return Di()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(fe(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var a;try{const{error:r,data:{session:l}}=n;if(r)throw r;const{options:c,provider:d,token:g,access_token:m,nonce:_}=t,C=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l==null?void 0:l.access_token)!==null&&a!==void 0?a:void 0,body:{provider:d,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Ur}),{data:E,error:O}=C;return O?{data:{user:null,session:null},error:O}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new Jc}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:O})}catch(r){if(fe(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var a,r;const{data:l,error:c}=n;if(c)throw c;return await we(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const a=Date.now();return await QE(async r=>(r>0&&await KE(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await we(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ur})),(r,l)=>{const c=200*Math.pow(2,r);return l&&Kp(l)&&Date.now()+c-a<rf})}catch(a){if(this._debug(n,"error",a),fe(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",a),Di()&&!n.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,n;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const r=await uu(this.storage,this.storageKey);if(r&&this.userStorage){let c=await uu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:r.user},await sf(this.userStorage,this.storageKey+"-user",c)),r.user=(t=c==null?void 0:c.user)!==null&&t!==void 0?t:Xp()}else if(r&&!r.user&&!r.user){const c=await uu(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(r.user=c.user,await ao(this.storage,this.storageKey+"-user"),await sf(this.storage,this.storageKey,r)):r.user=Xp()}if(this._debug(a,"session from storage",r),!this._isValidSession(r)){this._debug(a,"session is not valid"),r!==null&&await this._removeSession();return}const l=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Yp;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${Yp}s`),l){if(this.autoRefreshToken&&r.refresh_token){const{error:c}=await this._callRefreshToken(r.refresh_token);c&&(console.error(c),Kp(c)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(r.access_token);!d&&(c!=null&&c.user)?(r.user=c.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(a,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(a,"error",r),console.error(r);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var n,a;if(!t)throw new lo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new jg;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new lo;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(r,"error",l),fe(l)){const c={data:null,error:l};return Kp(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(c),c}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,a=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,n)}catch(g){l.push(g)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),a=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&n.user&&await sf(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const l=D1(r);await sf(this.storage,this.storageKey,l)}else{const r=D1(n);await sf(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await ao(this.storage,this.storageKey),await ao(this.storage,this.storageKey+"-code-verifier"),await ao(this.storage,this.storageKey+"-user"),this.userStorage&&await ao(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Di()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),rf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:a}}=n;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((a.expires_at*1e3-t)/rf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${rf}ms, refresh threshold is ${Km} ticks`),r<=Km&&await this._callRefreshToken(a.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof sb)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Di()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,a){const r=[`provider=${encodeURIComponent(n)}`];if(a!=null&&a.redirectTo&&r.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&r.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,c]=await Zc(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});r.push(d.toString())}if(a!=null&&a.queryParams){const l=new URLSearchParams(a.queryParams);r.push(l.toString())}return a!=null&&a.skipBrowserRedirect&&r.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;return l?{data:null,error:l}:await we(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var a,r;const{data:l,error:c}=n;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:g,error:m}=await we(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token});return m?{data:null,error:m}:(t.factorType==="totp"&&g.type==="totp"&&(!((r=g==null?void 0:g.totp)===null||r===void 0)&&r.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?EC(t.webauthn.credential_response):CC(t.webauthn.credential_response)})}:{code:t.code}),{data:d,error:g}=await we(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:g})})}catch(n){if(fe(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var a;const{data:r,error:l}=n;if(l)return{data:null,error:l};const c=await we(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=r==null?void 0:r.session)===null||a===void 0?void 0:a.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:bC(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:_C(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(fe(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:a}=await this.getUser();if(a)return{data:null,error:a};const r={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])r.all.push(l),l.status==="verified"&&r[l.factor_type].push(l);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,a;const{data:{session:r},error:l}=t;if(l)return{data:null,error:l};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=Qp(r.access_token);let d=null;c.aal&&(d=c.aal);let g=d;((a=(n=r.user.factors)===null||n===void 0?void 0:n.filter(C=>C.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(g="aal2");const _=c.amr||[];return{data:{currentLevel:d,nextLevel:g,currentAuthenticationMethods:_},error:null}}))}async fetchJwk(t,n={keys:[]}){let a=n.keys.find(d=>d.kid===t);if(a)return a;const r=Date.now();if(a=this.jwks.keys.find(d=>d.kid===t),a&&this.jwks_cached_at+DE>r)return a;const{data:l,error:c}=await we(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=r,a=l.keys.find(d=>d.kid===t),!a)?null:a}async getClaims(t,n={}){try{let a=t;if(!a){const{data:O,error:v}=await this.getSession();if(v||!O.session)return{data:null,error:v};a=O.session.access_token}const{header:r,payload:l,signature:c,raw:{header:d,payload:g}}=Qp(a);n!=null&&n.allowExpired||tC(l.exp);const m=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!m){const{error:O}=await this.getUser(a);if(O)throw O;return{data:{claims:l,header:r,signature:c},error:null}}const _=eC(r.alg),C=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,C,c,IE(`${d}.${g}`)))throw new Fm("Invalid JWT signature");return{data:{claims:l,header:r,signature:c},error:null}}catch(a){if(fe(a))return{data:null,error:a};throw a}}}gd.nextInstanceID=0;const DC=gd;class jC extends DC{constructor(t){super(t)}}class UC{constructor(t,n,a){var r,l,c;this.supabaseUrl=t,this.supabaseKey=n;const d=OE(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const g=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:SE,realtime:_E,auth:Object.assign(Object.assign({},bE),{storageKey:g}),global:yE},_=wE(a??{},m);this.storageKey=(r=_.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(l=_.global.headers)!==null&&l!==void 0?l:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(C,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=_.auth)!==null&&c!==void 0?c:{},this.headers,_.global.fetch),this.fetch=TE(n,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new R_(new URL("rest/v1",d).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new pE(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new y_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,a)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(n=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:a,storage:r,userStorage:l,storageKey:c,flowType:d,lock:g,debug:m},_,C){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jC({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),_),storageKey:c,autoRefreshToken:t,persistSession:n,detectSessionInUrl:a,storage:r,userStorage:l,flowType:d,lock:g,debug:m,fetch:C,hasCustomAuthorizationHeader:Object.keys(this.headers).some(O=>O.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Y_(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,a)=>{this._handleTokenChanged(n,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,n,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const BC=(o,t,n)=>new UC(o,t,n);function zC(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const t=o.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}zC()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const LC=void 0,GC=void 0;console.error("Missing Supabase environment variables. Please check your .env file.");const Wa=BC(LC,GC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PC=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),HC=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,a)=>a?a.toUpperCase():n.toLowerCase()),P1=o=>{const t=HC(o);return t.charAt(0).toUpperCase()+t.slice(1)},ub=(...o)=>o.filter((t,n,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===n).join(" ").trim(),IC=o=>{for(const t in o)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=lt.forwardRef(({color:o="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:l,iconNode:c,...d},g)=>lt.createElement("svg",{ref:g,...kC,width:t,height:t,stroke:o,strokeWidth:a?Number(n)*24/Number(t):n,className:ub("lucide",r),...!l&&!IC(d)&&{"aria-hidden":"true"},...d},[...c.map(([m,_])=>lt.createElement(m,_)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=(o,t)=>{const n=lt.forwardRef(({className:a,...r},l)=>lt.createElement(qC,{ref:l,iconNode:t,className:ub(`lucide-${PC(P1(o))}`,`lucide-${o}`,a),...r}));return n.displayName=P1(o),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],cb=bf("eraser",VC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]],KC=bf("feather",YC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],fb=bf("pen",QC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],hb=bf("redo",XC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],db=bf("trash-2",FC);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],gb=bf("undo",JC),fl={width:800,height:600},ZC=.65,WC=2.2,cg="studentCanvasPrefs",Jp=2,H1=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,$C=({sharedImage:o,canvasWidth:t,canvasHeight:n})=>{const[a,r]=lt.useState(null);if(lt.useEffect(()=>{if(!o){r(null);return}const O=new window.Image;O.src=o.dataUrl,O.onload=()=>{r(O)}},[o]),!o||!a)return null;const l=a.naturalWidth||a.width,c=a.naturalHeight||a.height;if(!l||!c||!t||!n)return null;const d=l/c,g=t/n;let m,_,C,E;return d>g?(m=t,_=t/d,C=0,E=(n-_)/2):(_=n,m=n*d,C=(t-m)/2,E=0),m=Math.min(m,t),_=Math.min(_,n),k.jsx(rv,{image:a,x:C,y:E,width:m,height:_,listening:!1})};function tT(){const[o]=pd(),t=mf(),n=o.get("room"),a=o.get("name"),[r,l]=lt.useState(null),[c]=lt.useState(()=>{let ct;typeof crypto<"u"&&crypto.randomUUID?ct=crypto.randomUUID():ct=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;const ht=`student-${ct.replace(/-/g,"").substring(0,12)}`;return console.log("🆕 [STUDENT LOGIN] Generated unique clientId:",ht,"for",a),ht}),[d,g]=lt.useState(!1),[m,_]=lt.useState(null),[C,E]=lt.useState(null),[O,v]=lt.useState("loading"),[M,z]=lt.useState(null),[L,D]=lt.useState([]),[N,G]=lt.useState([]),[R,A]=lt.useState(null),[T,y]=lt.useState("pen"),[B,j]=lt.useState("black"),[P,Q]=lt.useState(3),[K,X]=lt.useState(!1),[V,U]=lt.useState("stylus-only"),[I,F]=lt.useState("left"),[W,it]=lt.useState(H1());lt.useEffect(()=>{if(sessionStorage.getItem("student-logout-on-load")==="true"){sessionStorage.removeItem("student-logout-on-load"),t("/student-login");return}(!n||!a)&&t(`/student-login${n?`?room=${n}`:""}`)},[n,a,t]),lt.useEffect(()=>{if(!(typeof window>"u")){console.log("🔵 [STUDENT] Loading preferences from localStorage...");try{const ct=localStorage.getItem(cg);if(ct){const ht=JSON.parse(ct);if(console.log("🔵 [STUDENT] Found stored preferences:",ht),ht.version!==Jp){console.log("🔵 [STUDENT] Version mismatch! Expected:",Jp,"Got:",ht.version),console.log("🔵 [STUDENT] Clearing old preferences..."),localStorage.removeItem(cg);return}console.log("🔵 [STUDENT] Applying preferences..."),ht.tool&&y(ht.tool),ht.color&&j(ht.color),typeof ht.brushSize=="number"&&Q(ht.brushSize),ht.inputMode&&U(ht.inputMode),ht.toolbarPosition&&F(ht.toolbarPosition),console.log("🔵 [STUDENT] Preferences loaded successfully!")}else console.log("🔵 [STUDENT] No stored preferences found, using defaults")}catch(ct){console.warn("🔵 [STUDENT] Failed to load student prefs",ct),localStorage.removeItem(cg)}}},[]),lt.useEffect(()=>{const ct=()=>{it(H1())};return window.addEventListener("resize",ct),()=>window.removeEventListener("resize",ct)},[]),lt.useEffect(()=>{W&&(U("all"),Q(3))},[W]),lt.useEffect(()=>{if(typeof window>"u")return;if(at.current){at.current=!1,console.log("💾 [STUDENT] Skipping save on first render");return}const ct={version:Jp,tool:T,color:B,brushSize:P,inputMode:V,toolbarPosition:I};console.log("💾 [STUDENT] Saving preferences to localStorage:",ct),localStorage.setItem(cg,JSON.stringify(ct))},[T,B,P,V,I]);const Z=lt.useRef([]),rt=lt.useRef([]),at=lt.useRef(!0),Y=lt.useRef(L);lt.useEffect(()=>{Y.current=L},[L]);const J=lt.useRef(!1),tt=lt.useRef(!1),et=lt.useRef(null),gt=lt.useRef(null);lt.useEffect(()=>()=>{gt.current&&cancelAnimationFrame(gt.current)},[]),lt.useEffect(()=>{const ct=wt.current;if(!ct)return;const ht=Ct=>{const zt=Ct.target;zt.closest("button")||zt.closest(".student-toolbar")||zt.closest(".student-topbar")||Ct.preventDefault()},Ot=Ct=>{Ct.preventDefault()},Vt=Ct=>{if(K)return Ct.preventDefault(),!1};return ct.addEventListener("touchstart",ht,{passive:!1}),ct.addEventListener("touchmove",ht,{passive:!1}),ct.addEventListener("gesturestart",Ot,{passive:!1}),ct.addEventListener("gesturechange",Ot,{passive:!1}),document.addEventListener("selectstart",Vt),()=>{ct&&(ct.removeEventListener("touchstart",ht),ct.removeEventListener("touchmove",ht),ct.removeEventListener("gesturestart",Ot),ct.removeEventListener("gesturechange",Ot)),document.removeEventListener("selectstart",Vt)}},[K]);const wt=lt.useRef(null),Dt=lt.useRef(null),[Qt,te]=lt.useState(fl),se=lt.useMemo(()=>fl.width?Qt.width/fl.width:1,[Qt.width]);lt.useEffect(()=>{(async()=>{try{console.log("📝 Student validating session for room:",n);const{data:ht,error:Ot}=await Wa.from("sessions").select("*").ilike("room_code",n).order("created_at",{ascending:!1}).limit(1);if(Ot){console.error("Failed to query session:",Ot),v("ended");return}if(!ht||ht.length===0){console.log("❌ No session found for room:",n),v("ended");return}const Vt=ht[0];console.log("✅ Session found:",Vt),_(Vt.id),v(Vt.status==="active"?"active":"waiting");const{data:Ct,error:zt}=await Wa.from("participants").insert([{session_id:Vt.id,client_id:c,name:a,role:"student"}]).select().single();if(zt){console.error("Failed to create participant:",zt);return}console.log("👤 Participant created:",Ct),E(Ct.id)}catch(ht){console.error("Error initializing session:",ht),v("ended")}})()},[n,c,a]),lt.useEffect(()=>{console.log("🔵 [STUDENT INIT] Starting Ably initialization for",c,"in room",n);let ct=!1;(async()=>{try{if(ct){console.log("⚠️ [STUDENT INIT] Already cleaned up, skipping");return}const Ot=new mS.Realtime({authUrl:"/api/token",authParams:{clientId:c}});Ot.connection.on("connected",()=>{console.log("✅ [STUDENT] Connected to Ably as",c),g(!0)}),Ot.connection.on("disconnected",()=>{console.log("🔴 [STUDENT] Disconnected from Ably"),g(!1)});const Vt=Ot.channels.get(`room-${n}`);if(Vt.subscribe("student-layer",Ct=>{}),Vt.subscribe("teacher-annotation",Ct=>{Ct.data.targetStudentId===c&&(J.current=!0,G(Ct.data.annotations||[]),setTimeout(()=>{J.current=!1},100))}),Vt.subscribe("teacher-image",Ct=>{var zt,Bt,Se,_e;A({dataUrl:(zt=Ct.data)==null?void 0:zt.dataUrl,width:(Bt=Ct.data)==null?void 0:Bt.width,height:(Se=Ct.data)==null?void 0:Se.height,timestamp:(_e=Ct.data)==null?void 0:_e.timestamp})}),Vt.subscribe("teacher-template",Ct=>{var zt,Bt,Se,_e,$t;A({dataUrl:(zt=Ct.data)==null?void 0:zt.dataUrl,width:(Bt=Ct.data)==null?void 0:Bt.width,height:(Se=Ct.data)==null?void 0:Se.height,type:(_e=Ct.data)==null?void 0:_e.type,timestamp:($t=Ct.data)==null?void 0:$t.timestamp})}),Vt.subscribe("teacher-clear",Ct=>{A(null)}),Vt.subscribe("sync-question-state",Ct=>{Ct.data.targetClientId===c&&(console.log("📥 Received current question state"),A(Ct.data.content))}),Vt.subscribe("clear-all-drawings",Ct=>{var zt;console.log("📝 Clearing all drawings (teacher sent new content)"),(zt=Ct.data)!=null&&zt.questionId&&z(Ct.data.questionId),J.current=!0,D([]),G([]),setTimeout(()=>{J.current=!1},100)}),Vt.subscribe("session-started",Ct=>{console.log("🎉 Session started!"),v("active")}),Vt.subscribe("session-ended",Ct=>{var zt;console.log("🛑 Session ended:",(zt=Ct.data)==null?void 0:zt.reason),v("ended"),t("/student-login")}),console.log("📥 [STUDENT PRESENCE] Entering presence as",a,"with clientId",c),await Vt.presence.enter({name:a,isVisible:!document.hidden}),console.log("✅ [STUDENT PRESENCE] Successfully joined room",n,"as",a),ct){console.log("⚠️ [STUDENT INIT] Cleaned up during init, leaving presence"),await Vt.presence.leave(),Ot.close();return}return l(Vt),setTimeout(()=>{ct||(Vt.publish("request-current-state",{clientId:c,timestamp:Date.now()}),console.log("📞 [STUDENT] Requested current question state from teacher"))},1e3),()=>{console.log("🧹 [STUDENT CLEANUP] Starting cleanup for",c),ct=!0,Vt?Vt.presence.leave().then(()=>{console.log("👋 [STUDENT CLEANUP] Left presence as",c),Ot.close()}).catch(Ct=>{console.error("❌ [STUDENT CLEANUP] Error leaving presence:",Ct),Ot.close()}):Ot.close()}}catch(Ot){console.error("❌ [STUDENT INIT] Failed to initialize Ably:",Ot)}})()},[c,n,a]),lt.useEffect(()=>{if(!r)return;const ct=()=>{const ht=!document.hidden;console.log(`👁️ Tab visibility changed: ${ht?"visible":"hidden"}`),r.presence.update({name:a,isVisible:ht,lastVisibilityChange:Date.now()}),r.publish("student-visibility",{clientId:c,studentName:a,isVisible:ht,timestamp:Date.now()})};return document.addEventListener("visibilitychange",ct),()=>{document.removeEventListener("visibilitychange",ct)}},[r,c,a]),lt.useEffect(()=>{const ct=wt.current;if(!ct)return;const ht=()=>{if(!wt.current)return;const Vt=wt.current.getBoundingClientRect(),Ct=W?16:48,zt=Math.max(280,Vt.width-Ct),Bt=Math.max(210,Vt.height-Ct),Se=zt/fl.width,_e=Bt/fl.height,$t=Math.min(Se,_e),sn=Math.max(W?.35:ZC,Math.min(WC,$t)),An=Math.round(sn*20)/20;te({width:Math.round(fl.width*An),height:Math.round(fl.height*An)})};ht(),window.addEventListener("resize",ht);let Ot;return window.ResizeObserver&&(Ot=new ResizeObserver(()=>ht()),Ot.observe(ct)),()=>{window.removeEventListener("resize",ht),Ot&&Ot.disconnect()}},[I,W]),lt.useEffect(()=>{if(!J.current&&r){const ct=setTimeout(()=>{r.publish("student-layer",{lines:L,clientId:c,meta:{base:fl,display:Qt,scale:se}}),console.log("Published student layer:",L.length,"lines")},150);return()=>clearTimeout(ct)}},[L,r,c,Qt,se]),lt.useEffect(()=>{if(!r)return;const ct=Ot=>{console.log("🚪 [STUDENT] Page unload - cleaning up");try{r.presence.leaveClient(c)}catch(Vt){console.error("❌ [STUDENT] Error leaving presence on unload:",Vt)}return sessionStorage.setItem("student-logout-on-load","true"),Ot.preventDefault(),Ot.returnValue="Are you sure you want to leave? You will be logged out.",Ot.returnValue},ht=Ot=>{console.log("📱 [STUDENT] Page hide event - cleaning up session");try{r.presence.leaveClient(c)}catch(Vt){console.error("❌ [STUDENT] Error leaving presence on pagehide:",Vt)}sessionStorage.setItem("student-logout-on-load","true")};return window.addEventListener("beforeunload",ct),window.addEventListener("pagehide",ht),()=>{window.removeEventListener("beforeunload",ct),window.removeEventListener("pagehide",ht)}},[r,c]),lt.useEffect(()=>{if(!m||!C||!M||O!=="active")return;const ht=setInterval(async()=>{try{const{data:Ot,error:Vt}=await Wa.from("annotations").select("id").eq("question_id",M).eq("participant_id",C).maybeSingle(),Ct={session_id:m,question_id:M,participant_id:C,student_lines:Y.current};if(Vt){console.error("Failed to query annotation:",Vt);return}if(Ot){const{error:zt}=await Wa.from("annotations").update(Ct).eq("id",Ot.id);zt?console.error("Failed to update annotation:",zt):console.log("💾 Auto-saved student work")}else{const{error:zt}=await Wa.from("annotations").insert([Ct]);zt?console.error("Failed to create annotation:",zt):console.log("💾 Created new annotation")}}catch(Ot){console.error("Auto-save error:",Ot)}},1e4);return()=>clearInterval(ht)},[m,C,M,O]),lt.useEffect(()=>{if(!m||!C||!M||O!=="active")return;(async()=>{try{const{data:ht}=await Wa.from("annotations").select("id").eq("question_id",M).eq("participant_id",C).maybeSingle(),Ot={session_id:m,question_id:M,participant_id:C,student_lines:L};ht?await Wa.from("annotations").update(Ot).eq("id",ht.id):await Wa.from("annotations").insert([Ot]),console.log("💾 Saved work for new question")}catch(ht){console.error("Error saving on question change:",ht)}})()},[M]);const kt=ct=>V!=="stylus-only"?!0:(ct==null?void 0:ct.pointerType)==="pen",pe=ct=>{const ht=ct.evt;if(!kt(ht)){ht!=null&&ht.preventDefault&&ht.preventDefault();return}const Ot=ct.target.getStage();if(Ot&&ht.pointerId!==void 0){const Vt=Ot.content;if(Vt&&Vt.setPointerCapture)try{Vt.setPointerCapture(ht.pointerId)}catch{}}if(T==="pen"){X(!0);const Vt=Ot.getPointerPosition(),Ct=Vt.x/se,zt=Vt.y/se,Bt={tool:T,points:[Ct,zt],color:B,strokeWidth:P/se};et.current=Bt,Z.current.push([...L]),rt.current=[],D([...L,Bt])}else T==="eraser"&&(X(!0),tt.current=!1);ht.preventDefault&&ht.preventDefault(),ht.stopPropagation&&ht.stopPropagation()},Ee=ct=>{if(!K)return;const ht=ct.evt;if(!kt(ht)){ht!=null&&ht.preventDefault&&ht.preventDefault();return}const Vt=ct.target.getStage().getPointerPosition();if(T==="pen"){if(et.current){const Ct=Vt.x/se,zt=Vt.y/se;et.current.points=et.current.points.concat([Ct,zt]);const Bt=et.current;gt.current&&cancelAnimationFrame(gt.current),gt.current=requestAnimationFrame(()=>{Bt&&D(Se=>Se.length>0?[...Se.slice(0,-1),Bt]:Se)})}}else if(T==="eraser"){const Ct=L.length,zt=Vt.x,Bt=Vt.y,Se=20,_e=L.filter($t=>{for(let He=0;He<$t.points.length;He+=2){const sn=$t.points[He]*se,An=$t.points[He+1]*se;if(Math.sqrt(Math.pow(sn-zt,2)+Math.pow(An-Bt,2))<Se)return!1}return!0});_e.length<Ct&&!tt.current&&(Z.current.push([...L]),rt.current=[],tt.current=!0),D(_e)}ht!=null&&ht.preventDefault&&ht.preventDefault(),ht!=null&&ht.stopPropagation&&ht.stopPropagation()},Ze=ct=>{const ht=ct==null?void 0:ct.evt;if(!kt(ht)){ht!=null&&ht.preventDefault&&ht.preventDefault();return}X(!1),et.current=null},Ve=()=>{if(Z.current.length>0){const ct=Z.current.pop();rt.current.push([...L]),D(ct)}},tn=()=>{if(rt.current.length>0){const ct=rt.current.pop();Z.current.push([...L]),D(ct)}},xt=async()=>{Z.current.push([...L]),rt.current=[],D([]),r&&(await r.publish("student-layer",{lines:[],clientId:c,meta:{base:fl,display:Qt,scale:se}}),console.log("Published student clear"))},Xt=()=>{var ct;return((ct=c.split("-")[1])==null?void 0:ct.substring(0,3))||c},be=()=>{U(ct=>ct==="stylus-only"?"all":"stylus-only")},ye=()=>{F(ct=>ct==="left"?"right":"left")},me=()=>`Connected as ${a&&a!=="Anonymous"?a:Xt()}`,De=d?"Connected":"Reconnecting…",Ye=d?"online":"offline",Ue=ct=>ct.map((ht,Ot)=>ht*se),ft=ct=>(ct.strokeWidth||3)*se;return!n||!a?null:k.jsxs("div",{className:"student-canvas-page",children:[O==="loading"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-spinner"}),k.jsx("h2",{children:"Connecting to session..."}),k.jsx("p",{children:"Please wait while we verify your session"})]})}),O==="waiting"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon waiting",children:"⏳"}),k.jsx("h2",{children:"Waiting for teacher"}),k.jsx("p",{children:"Your teacher hasn't started the session yet. Please wait..."})]})}),O==="ended"&&k.jsx("div",{className:"session-overlay",children:k.jsxs("div",{className:"session-message",children:[k.jsx("div",{className:"session-icon ended",children:"✓"}),k.jsx("h2",{children:"Session ended"}),k.jsx("p",{children:"Thank you for participating! The teacher has ended this session."}),k.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",opacity:.8},children:"Redirecting to login..."})]})}),k.jsxs("div",{className:"student-canvas-container",children:[k.jsxs("div",{className:"student-status-bar",children:[k.jsxs("div",{className:"student-status-text",children:[k.jsx("h1",{children:"Student Canvas"}),k.jsx("p",{children:me()})]}),k.jsxs("div",{className:"student-status-actions",children:[!W&&k.jsxs(k.Fragment,{children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:T==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",V==="all"?"All inputs":"Stylus only"]})}),k.jsxs("div",{className:`connection-pill ${Ye}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:De})]}),k.jsxs("button",{className:"move-toolbar-btn",onClick:ye,children:["Move toolbar to ",I==="left"?"right":"left"]})]}),W&&k.jsxs("div",{className:`connection-pill ${Ye}`,"aria-live":"polite",children:[k.jsx("span",{className:"connection-indicator-dot"}),k.jsx("span",{children:De})]})]})]}),k.jsxs("div",{className:`student-workspace ${I==="right"?"toolbar-right":""} ${W?"mobile-view":""}`,children:[W?k.jsxs("div",{className:"mobile-toolbar",children:[k.jsxs("div",{className:"mobile-colors",children:[k.jsx("button",{onClick:()=>j("black"),className:`mobile-color-button ${B==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>j("#0066FF"),className:`mobile-color-button ${B==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>j("#00AA00"),className:`mobile-color-button ${B==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>y("pen"),className:`mobile-tool-button ${T==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(fb,{size:20})}),k.jsx("button",{onClick:()=>y("eraser"),className:`mobile-tool-button ${T==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(cb,{size:20})}),k.jsx("button",{onClick:Ve,className:"mobile-tool-button",disabled:Z.current.length===0,"aria-label":"Undo",children:k.jsx(gb,{size:20})}),k.jsx("button",{onClick:tn,className:"mobile-tool-button",disabled:rt.current.length===0,"aria-label":"Redo",children:k.jsx(hb,{size:20})}),k.jsx("button",{onClick:xt,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(db,{size:20})})]})]}):k.jsxs("div",{className:"student-sidebar",children:[k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsxs("div",{className:"color-buttons",children:[k.jsx("button",{onClick:()=>j("black"),className:`color-button ${B==="black"?"active":""}`,style:{background:"black"},"aria-label":"Black"}),k.jsx("button",{onClick:()=>j("#0066FF"),className:`color-button ${B==="#0066FF"?"active":""}`,style:{background:"#0066FF"},"aria-label":"Blue"}),k.jsx("button",{onClick:()=>j("#00AA00"),className:`color-button ${B==="#00AA00"?"active":""}`,style:{background:"#00AA00"},"aria-label":"Green"})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>y("pen"),className:`tool-icon-button ${T==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>y("eraser"),className:`tool-icon-button ${T==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsx("div",{className:"brush-size-control",children:k.jsxs("div",{className:"brush-slider-container",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:P,onChange:ct=>Q(parseInt(ct.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:P})]})})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${V==="all"?"all-inputs":""}`,onClick:be,children:V==="stylus-only"?"Stylus mode (pen only)":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:Ve,className:"history-button",disabled:Z.current.length===0,children:"Undo"}),k.jsx("button",{onClick:tn,className:"history-button",disabled:rt.current.length===0,children:"Redo"}),k.jsx("button",{onClick:xt,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"student-canvas-panel",ref:wt,children:k.jsx("div",{className:"student-canvas-frame",children:k.jsx("div",{className:"student-canvas-surface",style:{width:`${Qt.width}px`,height:`${Qt.height}px`},children:k.jsxs(Mg,{ref:Dt,width:Qt.width,height:Qt.height,onPointerDown:pe,onPointerMove:Ee,onPointerUp:Ze,onPointerLeave:Ze,onTouchStart:ct=>{var ht,Ot;(Ot=(ht=ct.evt)==null?void 0:ht.preventDefault)==null||Ot.call(ht)},onTouchMove:ct=>{var ht,Ot;(Ot=(ht=ct.evt)==null?void 0:ht.preventDefault)==null||Ot.call(ht)},onTouchEnd:ct=>{var ht,Ot;(Ot=(ht=ct.evt)==null?void 0:ht.preventDefault)==null||Ot.call(ht)},className:"canvas-stage",style:{touchAction:"none"},perfectDrawEnabled:!1,children:[k.jsx(Lr,{listening:!1,children:k.jsx($C,{sharedImage:R,canvasWidth:Qt.width,canvasHeight:Qt.height})}),k.jsx(Lr,{children:L.map((ct,ht)=>k.jsx(fo,{points:Ue(ct.points),stroke:ct.color,strokeWidth:ft(ct),tension:.5,lineCap:"round",lineJoin:"round"},`student-${ht}`))}),k.jsx(Lr,{listening:!1,children:N.map((ct,ht)=>k.jsx(fo,{points:Ue(ct.points),stroke:ct.color,strokeWidth:ft(ct),tension:.5,lineCap:"round",lineJoin:"round"},`teacher-${ht}`))})]})})})})]})]})]})}const I1="Feather_username";function eT(){const[o]=pd(),t=mf(),[n,a]=lt.useState(""),[r,l]=lt.useState((o.get("room")||"").toUpperCase()),[c,d]=lt.useState(""),[g,m]=lt.useState(!1);lt.useEffect(()=>{const C=localStorage.getItem(I1);C&&a(C)},[]);const _=async C=>{if(C.preventDefault(),!n.trim()){d("Please enter your name");return}if(!r.trim()){d("Please enter a session code");return}m(!0),d("");try{console.log("🔍 [STUDENT LOGIN] Pinging teacher channel:",r.trim().toUpperCase());const E=(await Eu(async()=>{const{default:L}=await Promise.resolve().then(()=>iT);return{default:L}},void 0)).default,O=new E.Realtime({authUrl:"/api/token",authParams:{clientId:`ping-${Date.now()}`}});await new Promise((L,D)=>{const N=setTimeout(()=>{D(new Error("Connection timeout"))},1e4);O.connection.once("connected",()=>{clearTimeout(N),L()}),O.connection.once("failed",()=>{clearTimeout(N),D(new Error("Connection failed"))})});const M=await O.channels.get(`room-${r.trim().toUpperCase()}`).presence.get();console.log("👥 [STUDENT LOGIN] Found",M.length,"members in channel");const z=M.some(L=>L.clientId.startsWith("teacher-"));if(O.close(),!z){d("No active teacher found. Please check your session code or ask your teacher to start the session."),m(!1);return}console.log("✅ [STUDENT LOGIN] Teacher is present, allowing login"),localStorage.setItem(I1,n.trim()),t(`/student?room=${r.trim().toUpperCase()}&name=${encodeURIComponent(n.trim())}`)}catch(E){console.error("❌ [STUDENT LOGIN] Error checking teacher presence:",E),d("Failed to connect to session. Please check your internet connection and try again."),m(!1)}};return k.jsx("div",{className:"student-login-page",children:k.jsxs("div",{className:"student-login-card",children:[k.jsx("h1",{children:"Student Login"}),k.jsx("p",{className:"login-subtitle",children:"Join your classroom session to start drawing."}),k.jsxs("form",{onSubmit:_,children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"name",children:"Name"}),k.jsx("input",{id:"name",type:"text",placeholder:"Your name",value:n,onChange:C=>{a(C.target.value),d("")},autoFocus:!0,maxLength:50})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{htmlFor:"sessionCode",children:"Session code"}),k.jsx("input",{id:"sessionCode",type:"text",placeholder:"SESSION CODE (E.G., ABC123)",value:r,onChange:C=>{l(C.target.value.toUpperCase()),d("")},maxLength:10})]}),c&&k.jsx("div",{className:"login-error",children:c}),k.jsx("button",{type:"submit",className:"join-button",disabled:g,children:g?"Checking session...":"Join Session"})]})]})})}var Zp,k1;function nT(){if(k1)return Zp;k1=1;function o(l){return typeof l=="string"&&(l=l.indexOf(":")==-1?{token:l}:{key:l}),l.promises=!0,l}var t=pS(),n=function(l,c,d,g){return new t.ErrorInfo(l,c,d,g)},a=function(l){return new t.Rest(o(l))};Object.assign(a,t.Rest);var r=function(l){return new t.Realtime(o(l))};return Object.assign(r,t.Realtime),Zp={ErrorInfo:n,Rest:a,Realtime:r},Zp}var aT=nT();const pv=df(aT),iT=Object.freeze(Object.defineProperty({__proto__:null,default:pv},Symbol.toStringTag,{value:"Module"}));var ef={},Wp,q1;function rT(){return q1||(q1=1,Wp=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Wp}var $p={},io={},V1;function Tu(){if(V1)return io;V1=1;let o;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return io.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17},io.getSymbolTotalCodewords=function(a){return t[a]},io.getBCHDigit=function(n){let a=0;for(;n!==0;)a++,n>>>=1;return a},io.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');o=a},io.isKanjiModeEnabled=function(){return typeof o<"u"},io.toSJIS=function(a){return o(a)},io}var tm={},Y1;function mv(){return Y1||(Y1=1,(function(o){o.L={bit:1},o.M={bit:0},o.Q={bit:3},o.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return o.L;case"m":case"medium":return o.M;case"q":case"quartile":return o.Q;case"h":case"high":return o.H;default:throw new Error("Unknown EC Level: "+n)}}o.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},o.from=function(a,r){if(o.isValid(a))return a;try{return t(a)}catch{return r}}})(tm)),tm}var em,K1;function sT(){if(K1)return em;K1=1;function o(){this.buffer=[],this.length=0}return o.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let a=0;a<n;a++)this.putBit((t>>>n-a-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},em=o,em}var nm,Q1;function lT(){if(Q1)return nm;Q1=1;function o(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return o.prototype.set=function(t,n,a,r){const l=t*this.size+n;this.data[l]=a,r&&(this.reservedBit[l]=!0)},o.prototype.get=function(t,n){return this.data[t*this.size+n]},o.prototype.xor=function(t,n,a){this.data[t*this.size+n]^=a},o.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},nm=o,nm}var am={},X1;function oT(){return X1||(X1=1,(function(o){const t=Tu().getSymbolSize;o.getRowColCoords=function(a){if(a===1)return[];const r=Math.floor(a/7)+2,l=t(a),c=l===145?26:Math.ceil((l-13)/(2*r-2))*2,d=[l-7];for(let g=1;g<r-1;g++)d[g]=d[g-1]-c;return d.push(6),d.reverse()},o.getPositions=function(a){const r=[],l=o.getRowColCoords(a),c=l.length;for(let d=0;d<c;d++)for(let g=0;g<c;g++)d===0&&g===0||d===0&&g===c-1||d===c-1&&g===0||r.push([l[d],l[g]]);return r}})(am)),am}var im={},F1;function uT(){if(F1)return im;F1=1;const o=Tu().getSymbolSize,t=7;return im.getPositions=function(a){const r=o(a);return[[0,0],[r-t,0],[0,r-t]]},im}var rm={},J1;function cT(){return J1||(J1=1,(function(o){o.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};o.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},o.from=function(r){return o.isValid(r)?parseInt(r,10):void 0},o.getPenaltyN1=function(r){const l=r.size;let c=0,d=0,g=0,m=null,_=null;for(let C=0;C<l;C++){d=g=0,m=_=null;for(let E=0;E<l;E++){let O=r.get(C,E);O===m?d++:(d>=5&&(c+=t.N1+(d-5)),m=O,d=1),O=r.get(E,C),O===_?g++:(g>=5&&(c+=t.N1+(g-5)),_=O,g=1)}d>=5&&(c+=t.N1+(d-5)),g>=5&&(c+=t.N1+(g-5))}return c},o.getPenaltyN2=function(r){const l=r.size;let c=0;for(let d=0;d<l-1;d++)for(let g=0;g<l-1;g++){const m=r.get(d,g)+r.get(d,g+1)+r.get(d+1,g)+r.get(d+1,g+1);(m===4||m===0)&&c++}return c*t.N2},o.getPenaltyN3=function(r){const l=r.size;let c=0,d=0,g=0;for(let m=0;m<l;m++){d=g=0;for(let _=0;_<l;_++)d=d<<1&2047|r.get(m,_),_>=10&&(d===1488||d===93)&&c++,g=g<<1&2047|r.get(_,m),_>=10&&(g===1488||g===93)&&c++}return c*t.N3},o.getPenaltyN4=function(r){let l=0;const c=r.data.length;for(let g=0;g<c;g++)l+=r.data[g];return Math.abs(Math.ceil(l*100/c/5)-10)*t.N4};function n(a,r,l){switch(a){case o.Patterns.PATTERN000:return(r+l)%2===0;case o.Patterns.PATTERN001:return r%2===0;case o.Patterns.PATTERN010:return l%3===0;case o.Patterns.PATTERN011:return(r+l)%3===0;case o.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(l/3))%2===0;case o.Patterns.PATTERN101:return r*l%2+r*l%3===0;case o.Patterns.PATTERN110:return(r*l%2+r*l%3)%2===0;case o.Patterns.PATTERN111:return(r*l%3+(r+l)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}o.applyMask=function(r,l){const c=l.size;for(let d=0;d<c;d++)for(let g=0;g<c;g++)l.isReserved(g,d)||l.xor(g,d,n(r,g,d))},o.getBestMask=function(r,l){const c=Object.keys(o.Patterns).length;let d=0,g=1/0;for(let m=0;m<c;m++){l(m),o.applyMask(m,r);const _=o.getPenaltyN1(r)+o.getPenaltyN2(r)+o.getPenaltyN3(r)+o.getPenaltyN4(r);o.applyMask(m,r),_<g&&(g=_,d=m)}return d}})(rm)),rm}var fg={},Z1;function pb(){if(Z1)return fg;Z1=1;const o=mv(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return fg.getBlocksCount=function(r,l){switch(l){case o.L:return t[(r-1)*4+0];case o.M:return t[(r-1)*4+1];case o.Q:return t[(r-1)*4+2];case o.H:return t[(r-1)*4+3];default:return}},fg.getTotalCodewordsCount=function(r,l){switch(l){case o.L:return n[(r-1)*4+0];case o.M:return n[(r-1)*4+1];case o.Q:return n[(r-1)*4+2];case o.H:return n[(r-1)*4+3];default:return}},fg}var sm={},Fh={},W1;function fT(){if(W1)return Fh;W1=1;const o=new Uint8Array(512),t=new Uint8Array(256);return(function(){let a=1;for(let r=0;r<255;r++)o[r]=a,t[a]=r,a<<=1,a&256&&(a^=285);for(let r=255;r<512;r++)o[r]=o[r-255]})(),Fh.log=function(a){if(a<1)throw new Error("log("+a+")");return t[a]},Fh.exp=function(a){return o[a]},Fh.mul=function(a,r){return a===0||r===0?0:o[t[a]+t[r]]},Fh}var $1;function hT(){return $1||($1=1,(function(o){const t=fT();o.mul=function(a,r){const l=new Uint8Array(a.length+r.length-1);for(let c=0;c<a.length;c++)for(let d=0;d<r.length;d++)l[c+d]^=t.mul(a[c],r[d]);return l},o.mod=function(a,r){let l=new Uint8Array(a);for(;l.length-r.length>=0;){const c=l[0];for(let g=0;g<r.length;g++)l[g]^=t.mul(r[g],c);let d=0;for(;d<l.length&&l[d]===0;)d++;l=l.slice(d)}return l},o.generateECPolynomial=function(a){let r=new Uint8Array([1]);for(let l=0;l<a;l++)r=o.mul(r,new Uint8Array([1,t.exp(l)]));return r}})(sm)),sm}var lm,t2;function dT(){if(t2)return lm;t2=1;const o=hT();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(a){this.degree=a,this.genPoly=o.generateECPolynomial(this.degree)},t.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(a.length+this.degree);r.set(a);const l=o.mod(r,this.genPoly),c=this.degree-l.length;if(c>0){const d=new Uint8Array(this.degree);return d.set(l,c),d}return l},lm=t,lm}var om={},um={},cm={},e2;function mb(){return e2||(e2=1,cm.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),cm}var ms={},n2;function vb(){if(n2)return ms;n2=1;const o="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;ms.KANJI=new RegExp(n,"g"),ms.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),ms.BYTE=new RegExp(a,"g"),ms.NUMERIC=new RegExp(o,"g"),ms.ALPHANUMERIC=new RegExp(t,"g");const r=new RegExp("^"+n+"$"),l=new RegExp("^"+o+"$"),c=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return ms.testKanji=function(g){return r.test(g)},ms.testNumeric=function(g){return l.test(g)},ms.testAlphanumeric=function(g){return c.test(g)},ms}var a2;function Au(){return a2||(a2=1,(function(o){const t=mb(),n=vb();o.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},o.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},o.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},o.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},o.MIXED={bit:-1},o.getCharCountIndicator=function(l,c){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!t.isValid(c))throw new Error("Invalid version: "+c);return c>=1&&c<10?l.ccBits[0]:c<27?l.ccBits[1]:l.ccBits[2]},o.getBestModeForData=function(l){return n.testNumeric(l)?o.NUMERIC:n.testAlphanumeric(l)?o.ALPHANUMERIC:n.testKanji(l)?o.KANJI:o.BYTE},o.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},o.isValid=function(l){return l&&l.bit&&l.ccBits};function a(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return o.NUMERIC;case"alphanumeric":return o.ALPHANUMERIC;case"kanji":return o.KANJI;case"byte":return o.BYTE;default:throw new Error("Unknown mode: "+r)}}o.from=function(l,c){if(o.isValid(l))return l;try{return a(l)}catch{return c}}})(um)),um}var i2;function gT(){return i2||(i2=1,(function(o){const t=Tu(),n=pb(),a=mv(),r=Au(),l=mb(),c=7973,d=t.getBCHDigit(c);function g(E,O,v){for(let M=1;M<=40;M++)if(O<=o.getCapacity(M,v,E))return M}function m(E,O){return r.getCharCountIndicator(E,O)+4}function _(E,O){let v=0;return E.forEach(function(M){const z=m(M.mode,O);v+=z+M.getBitsLength()}),v}function C(E,O){for(let v=1;v<=40;v++)if(_(E,v)<=o.getCapacity(v,O,r.MIXED))return v}o.from=function(O,v){return l.isValid(O)?parseInt(O,10):v},o.getCapacity=function(O,v,M){if(!l.isValid(O))throw new Error("Invalid QR Code version");typeof M>"u"&&(M=r.BYTE);const z=t.getSymbolTotalCodewords(O),L=n.getTotalCodewordsCount(O,v),D=(z-L)*8;if(M===r.MIXED)return D;const N=D-m(M,O);switch(M){case r.NUMERIC:return Math.floor(N/10*3);case r.ALPHANUMERIC:return Math.floor(N/11*2);case r.KANJI:return Math.floor(N/13);case r.BYTE:default:return Math.floor(N/8)}},o.getBestVersionForData=function(O,v){let M;const z=a.from(v,a.M);if(Array.isArray(O)){if(O.length>1)return C(O,z);if(O.length===0)return 1;M=O[0]}else M=O;return g(M.mode,M.getLength(),z)},o.getEncodedBits=function(O){if(!l.isValid(O)||O<7)throw new Error("Invalid QR Code version");let v=O<<12;for(;t.getBCHDigit(v)-d>=0;)v^=c<<t.getBCHDigit(v)-d;return O<<12|v}})(om)),om}var fm={},r2;function pT(){if(r2)return fm;r2=1;const o=Tu(),t=1335,n=21522,a=o.getBCHDigit(t);return fm.getEncodedBits=function(l,c){const d=l.bit<<3|c;let g=d<<10;for(;o.getBCHDigit(g)-a>=0;)g^=t<<o.getBCHDigit(g)-a;return(d<<10|g)^n},fm}var hm={},dm,s2;function mT(){if(s2)return dm;s2=1;const o=Au();function t(n){this.mode=o.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(a){let r,l,c;for(r=0;r+3<=this.data.length;r+=3)l=this.data.substr(r,3),c=parseInt(l,10),a.put(c,10);const d=this.data.length-r;d>0&&(l=this.data.substr(r),c=parseInt(l,10),a.put(c,d*3+1))},dm=t,dm}var gm,l2;function vT(){if(l2)return gm;l2=1;const o=Au(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(a){this.mode=o.ALPHANUMERIC,this.data=a}return n.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let l;for(l=0;l+2<=this.data.length;l+=2){let c=t.indexOf(this.data[l])*45;c+=t.indexOf(this.data[l+1]),r.put(c,11)}this.data.length%2&&r.put(t.indexOf(this.data[l]),6)},gm=n,gm}var pm,o2;function yT(){if(o2)return pm;o2=1;const o=Au();function t(n){this.mode=o.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(a){return a*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let a=0,r=this.data.length;a<r;a++)n.put(this.data[a],8)},pm=t,pm}var mm,u2;function ST(){if(u2)return mm;u2=1;const o=Au(),t=Tu();function n(a){this.mode=o.KANJI,this.data=a}return n.getBitsLength=function(r){return r*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(a){let r;for(r=0;r<this.data.length;r++){let l=t.toSJIS(this.data[r]);if(l>=33088&&l<=40956)l-=33088;else if(l>=57408&&l<=60351)l-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);l=(l>>>8&255)*192+(l&255),a.put(l,13)}},mm=n,mm}var vm={exports:{}},c2;function bT(){return c2||(c2=1,(function(o){var t={single_source_shortest_paths:function(n,a,r){var l={},c={};c[a]=0;var d=t.PriorityQueue.make();d.push(a,0);for(var g,m,_,C,E,O,v,M,z;!d.empty();){g=d.pop(),m=g.value,C=g.cost,E=n[m]||{};for(_ in E)E.hasOwnProperty(_)&&(O=E[_],v=C+O,M=c[_],z=typeof c[_]>"u",(z||M>v)&&(c[_]=v,d.push(_,v),l[_]=m))}if(typeof r<"u"&&typeof c[r]>"u"){var L=["Could not find a path from ",a," to ",r,"."].join("");throw new Error(L)}return l},extract_shortest_path_from_predecessor_list:function(n,a){for(var r=[],l=a;l;)r.push(l),n[l],l=n[l];return r.reverse(),r},find_path:function(n,a,r){var l=t.single_source_shortest_paths(n,a,r);return t.extract_shortest_path_from_predecessor_list(l,r)},PriorityQueue:{make:function(n){var a=t.PriorityQueue,r={},l;n=n||{};for(l in a)a.hasOwnProperty(l)&&(r[l]=a[l]);return r.queue=[],r.sorter=n.sorter||a.default_sorter,r},default_sorter:function(n,a){return n.cost-a.cost},push:function(n,a){var r={value:n,cost:a};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};o.exports=t})(vm)),vm.exports}var f2;function _T(){return f2||(f2=1,(function(o){const t=Au(),n=mT(),a=vT(),r=yT(),l=ST(),c=vb(),d=Tu(),g=bT();function m(L){return unescape(encodeURIComponent(L)).length}function _(L,D,N){const G=[];let R;for(;(R=L.exec(N))!==null;)G.push({data:R[0],index:R.index,mode:D,length:R[0].length});return G}function C(L){const D=_(c.NUMERIC,t.NUMERIC,L),N=_(c.ALPHANUMERIC,t.ALPHANUMERIC,L);let G,R;return d.isKanjiModeEnabled()?(G=_(c.BYTE,t.BYTE,L),R=_(c.KANJI,t.KANJI,L)):(G=_(c.BYTE_KANJI,t.BYTE,L),R=[]),D.concat(N,G,R).sort(function(T,y){return T.index-y.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function E(L,D){switch(D){case t.NUMERIC:return n.getBitsLength(L);case t.ALPHANUMERIC:return a.getBitsLength(L);case t.KANJI:return l.getBitsLength(L);case t.BYTE:return r.getBitsLength(L)}}function O(L){return L.reduce(function(D,N){const G=D.length-1>=0?D[D.length-1]:null;return G&&G.mode===N.mode?(D[D.length-1].data+=N.data,D):(D.push(N),D)},[])}function v(L){const D=[];for(let N=0;N<L.length;N++){const G=L[N];switch(G.mode){case t.NUMERIC:D.push([G,{data:G.data,mode:t.ALPHANUMERIC,length:G.length},{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.ALPHANUMERIC:D.push([G,{data:G.data,mode:t.BYTE,length:G.length}]);break;case t.KANJI:D.push([G,{data:G.data,mode:t.BYTE,length:m(G.data)}]);break;case t.BYTE:D.push([{data:G.data,mode:t.BYTE,length:m(G.data)}])}}return D}function M(L,D){const N={},G={start:{}};let R=["start"];for(let A=0;A<L.length;A++){const T=L[A],y=[];for(let B=0;B<T.length;B++){const j=T[B],P=""+A+B;y.push(P),N[P]={node:j,lastCount:0},G[P]={};for(let Q=0;Q<R.length;Q++){const K=R[Q];N[K]&&N[K].node.mode===j.mode?(G[K][P]=E(N[K].lastCount+j.length,j.mode)-E(N[K].lastCount,j.mode),N[K].lastCount+=j.length):(N[K]&&(N[K].lastCount=j.length),G[K][P]=E(j.length,j.mode)+4+t.getCharCountIndicator(j.mode,D))}}R=y}for(let A=0;A<R.length;A++)G[R[A]].end=0;return{map:G,table:N}}function z(L,D){let N;const G=t.getBestModeForData(L);if(N=t.from(D,G),N!==t.BYTE&&N.bit<G.bit)throw new Error('"'+L+'" cannot be encoded with mode '+t.toString(N)+`.
 Suggested mode is: `+t.toString(G));switch(N===t.KANJI&&!d.isKanjiModeEnabled()&&(N=t.BYTE),N){case t.NUMERIC:return new n(L);case t.ALPHANUMERIC:return new a(L);case t.KANJI:return new l(L);case t.BYTE:return new r(L)}}o.fromArray=function(D){return D.reduce(function(N,G){return typeof G=="string"?N.push(z(G,null)):G.data&&N.push(z(G.data,G.mode)),N},[])},o.fromString=function(D,N){const G=C(D,d.isKanjiModeEnabled()),R=v(G),A=M(R,N),T=g.find_path(A.map,"start","end"),y=[];for(let B=1;B<T.length-1;B++)y.push(A.table[T[B]].node);return o.fromArray(O(y))},o.rawSplit=function(D){return o.fromArray(C(D,d.isKanjiModeEnabled()))}})(hm)),hm}var h2;function ET(){if(h2)return $p;h2=1;const o=Tu(),t=mv(),n=sT(),a=lT(),r=oT(),l=uT(),c=cT(),d=pb(),g=dT(),m=gT(),_=pT(),C=Au(),E=_T();function O(A,T){const y=A.size,B=l.getPositions(T);for(let j=0;j<B.length;j++){const P=B[j][0],Q=B[j][1];for(let K=-1;K<=7;K++)if(!(P+K<=-1||y<=P+K))for(let X=-1;X<=7;X++)Q+X<=-1||y<=Q+X||(K>=0&&K<=6&&(X===0||X===6)||X>=0&&X<=6&&(K===0||K===6)||K>=2&&K<=4&&X>=2&&X<=4?A.set(P+K,Q+X,!0,!0):A.set(P+K,Q+X,!1,!0))}}function v(A){const T=A.size;for(let y=8;y<T-8;y++){const B=y%2===0;A.set(y,6,B,!0),A.set(6,y,B,!0)}}function M(A,T){const y=r.getPositions(T);for(let B=0;B<y.length;B++){const j=y[B][0],P=y[B][1];for(let Q=-2;Q<=2;Q++)for(let K=-2;K<=2;K++)Q===-2||Q===2||K===-2||K===2||Q===0&&K===0?A.set(j+Q,P+K,!0,!0):A.set(j+Q,P+K,!1,!0)}}function z(A,T){const y=A.size,B=m.getEncodedBits(T);let j,P,Q;for(let K=0;K<18;K++)j=Math.floor(K/3),P=K%3+y-8-3,Q=(B>>K&1)===1,A.set(j,P,Q,!0),A.set(P,j,Q,!0)}function L(A,T,y){const B=A.size,j=_.getEncodedBits(T,y);let P,Q;for(P=0;P<15;P++)Q=(j>>P&1)===1,P<6?A.set(P,8,Q,!0):P<8?A.set(P+1,8,Q,!0):A.set(B-15+P,8,Q,!0),P<8?A.set(8,B-P-1,Q,!0):P<9?A.set(8,15-P-1+1,Q,!0):A.set(8,15-P-1,Q,!0);A.set(B-8,8,1,!0)}function D(A,T){const y=A.size;let B=-1,j=y-1,P=7,Q=0;for(let K=y-1;K>0;K-=2)for(K===6&&K--;;){for(let X=0;X<2;X++)if(!A.isReserved(j,K-X)){let V=!1;Q<T.length&&(V=(T[Q]>>>P&1)===1),A.set(j,K-X,V),P--,P===-1&&(Q++,P=7)}if(j+=B,j<0||y<=j){j-=B,B=-B;break}}}function N(A,T,y){const B=new n;y.forEach(function(X){B.put(X.mode.bit,4),B.put(X.getLength(),C.getCharCountIndicator(X.mode,A)),X.write(B)});const j=o.getSymbolTotalCodewords(A),P=d.getTotalCodewordsCount(A,T),Q=(j-P)*8;for(B.getLengthInBits()+4<=Q&&B.put(0,4);B.getLengthInBits()%8!==0;)B.putBit(0);const K=(Q-B.getLengthInBits())/8;for(let X=0;X<K;X++)B.put(X%2?17:236,8);return G(B,A,T)}function G(A,T,y){const B=o.getSymbolTotalCodewords(T),j=d.getTotalCodewordsCount(T,y),P=B-j,Q=d.getBlocksCount(T,y),K=B%Q,X=Q-K,V=Math.floor(B/Q),U=Math.floor(P/Q),I=U+1,F=V-U,W=new g(F);let it=0;const Z=new Array(Q),rt=new Array(Q);let at=0;const Y=new Uint8Array(A.buffer);for(let wt=0;wt<Q;wt++){const Dt=wt<X?U:I;Z[wt]=Y.slice(it,it+Dt),rt[wt]=W.encode(Z[wt]),it+=Dt,at=Math.max(at,Dt)}const J=new Uint8Array(B);let tt=0,et,gt;for(et=0;et<at;et++)for(gt=0;gt<Q;gt++)et<Z[gt].length&&(J[tt++]=Z[gt][et]);for(et=0;et<F;et++)for(gt=0;gt<Q;gt++)J[tt++]=rt[gt][et];return J}function R(A,T,y,B){let j;if(Array.isArray(A))j=E.fromArray(A);else if(typeof A=="string"){let V=T;if(!V){const U=E.rawSplit(A);V=m.getBestVersionForData(U,y)}j=E.fromString(A,V||40)}else throw new Error("Invalid data");const P=m.getBestVersionForData(j,y);if(!P)throw new Error("The amount of data is too big to be stored in a QR Code");if(!T)T=P;else if(T<P)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+P+`.
`);const Q=N(T,y,j),K=o.getSymbolSize(T),X=new a(K);return O(X,T),v(X),M(X,T),L(X,y,0),T>=7&&z(X,T),D(X,Q),isNaN(B)&&(B=c.getBestMask(X,L.bind(null,X,y))),c.applyMask(B,X),L(X,y,B),{modules:X,version:T,errorCorrectionLevel:y,maskPattern:B,segments:j}}return $p.create=function(T,y){if(typeof T>"u"||T==="")throw new Error("No input text");let B=t.M,j,P;return typeof y<"u"&&(B=t.from(y.errorCorrectionLevel,t.M),j=m.from(y.version),P=c.from(y.maskPattern),y.toSJISFunc&&o.setToSJISFunction(y.toSJISFunc)),R(T,j,B,P)},$p}var ym={},Sm={},d2;function yb(){return d2||(d2=1,(function(o){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let a=n.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+n);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(l){return[l,l]}))),a.length===6&&a.push("F","F");const r=parseInt(a.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+a.slice(0,6).join("")}}o.getOptions=function(a){a||(a={}),a.color||(a.color={});const r=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,l=a.width&&a.width>=21?a.width:void 0,c=a.scale||4;return{width:l,scale:l?4:c,margin:r,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},o.getScale=function(a,r){return r.width&&r.width>=a+r.margin*2?r.width/(a+r.margin*2):r.scale},o.getImageWidth=function(a,r){const l=o.getScale(a,r);return Math.floor((a+r.margin*2)*l)},o.qrToImageData=function(a,r,l){const c=r.modules.size,d=r.modules.data,g=o.getScale(c,l),m=Math.floor((c+l.margin*2)*g),_=l.margin*g,C=[l.color.light,l.color.dark];for(let E=0;E<m;E++)for(let O=0;O<m;O++){let v=(E*m+O)*4,M=l.color.light;if(E>=_&&O>=_&&E<m-_&&O<m-_){const z=Math.floor((E-_)/g),L=Math.floor((O-_)/g);M=C[d[z*c+L]?1:0]}a[v++]=M.r,a[v++]=M.g,a[v++]=M.b,a[v]=M.a}}})(Sm)),Sm}var g2;function CT(){return g2||(g2=1,(function(o){const t=yb();function n(r,l,c){r.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=c,l.width=c,l.style.height=c+"px",l.style.width=c+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}o.render=function(l,c,d){let g=d,m=c;typeof g>"u"&&(!c||!c.getContext)&&(g=c,c=void 0),c||(m=a()),g=t.getOptions(g);const _=t.getImageWidth(l.modules.size,g),C=m.getContext("2d"),E=C.createImageData(_,_);return t.qrToImageData(E.data,l,g),n(C,m,_),C.putImageData(E,0,0),m},o.renderToDataURL=function(l,c,d){let g=d;typeof g>"u"&&(!c||!c.getContext)&&(g=c,c=void 0),g||(g={});const m=o.render(l,c,g),_=g.type||"image/png",C=g.rendererOpts||{};return m.toDataURL(_,C.quality)}})(ym)),ym}var bm={},p2;function TT(){if(p2)return bm;p2=1;const o=yb();function t(r,l){const c=r.a/255,d=l+'="'+r.hex+'"';return c<1?d+" "+l+'-opacity="'+c.toFixed(2).slice(1)+'"':d}function n(r,l,c){let d=r+l;return typeof c<"u"&&(d+=" "+c),d}function a(r,l,c){let d="",g=0,m=!1,_=0;for(let C=0;C<r.length;C++){const E=Math.floor(C%l),O=Math.floor(C/l);!E&&!m&&(m=!0),r[C]?(_++,C>0&&E>0&&r[C-1]||(d+=m?n("M",E+c,.5+O+c):n("m",g,0),g=0,m=!1),E+1<l&&r[C+1]||(d+=n("h",_),_=0)):g++}return d}return bm.render=function(l,c,d){const g=o.getOptions(c),m=l.modules.size,_=l.modules.data,C=m+g.margin*2,E=g.color.light.a?"<path "+t(g.color.light,"fill")+' d="M0 0h'+C+"v"+C+'H0z"/>':"",O="<path "+t(g.color.dark,"stroke")+' d="'+a(_,m,g.margin)+'"/>',v='viewBox="0 0 '+C+" "+C+'"',z='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+v+' shape-rendering="crispEdges">'+E+O+`</svg>
`;return typeof d=="function"&&d(null,z),z},bm}var m2;function AT(){if(m2)return ef;m2=1;const o=rT(),t=ET(),n=CT(),a=TT();function r(l,c,d,g,m){const _=[].slice.call(arguments,1),C=_.length,E=typeof _[C-1]=="function";if(!E&&!o())throw new Error("Callback required as last argument");if(E){if(C<2)throw new Error("Too few arguments provided");C===2?(m=d,d=c,c=g=void 0):C===3&&(c.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=d,d=c,c=void 0))}else{if(C<1)throw new Error("Too few arguments provided");return C===1?(d=c,c=g=void 0):C===2&&!c.getContext&&(g=d,d=c,c=void 0),new Promise(function(O,v){try{const M=t.create(d,g);O(l(M,c,g))}catch(M){v(M)}})}try{const O=t.create(d,g);m(null,l(O,c,g))}catch(O){m(O)}}return ef.create=t.create,ef.toCanvas=r.bind(null,n.render),ef.toDataURL=r.bind(null,n.renderToDataURL),ef.toString=r.bind(null,function(l,c,d){return a.render(l,d)}),ef}var wT=AT();const Sb=df(wT),bb=({active:o=!1,size:t=20})=>{const n=o?"#ff4d4f":"#b8c1cc",a=o?"#ff4d4f":"transparent";return k.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[k.jsx("path",{d:"M5 2.5V17.5",stroke:n,strokeWidth:"1.6",strokeLinecap:"round"}),k.jsx("path",{d:"M5 3h10l-2 3 2 3H5V3Z",fill:a,stroke:n,strokeWidth:"1.4",strokeLinejoin:"round"})]})},_b=({student:o,onClick:t,onToggleFlag:n,teacherAnnotations:a=[],sharedImage:r,hideNames:l=!1})=>{var G,R,A,T;const c=lt.useRef(null),d=lt.useRef(null),[g,m]=lt.useState(null),[_,C]=lt.useState(300);lt.useEffect(()=>{if(!r){m(null);return}const y=new window.Image;y.src=r.dataUrl,y.onload=()=>{m(y)}},[r]),lt.useEffect(()=>{if(!d.current)return;const y=()=>{d.current&&C(d.current.clientWidth)};y();const B=new ResizeObserver(y);return B.observe(d.current),()=>B.disconnect()},[]);const E=()=>{if(o!=null&&o.name)return o.name;if(!(o!=null&&o.clientId))return"Unknown Student";const y=o.clientId.match(/student-(\d+)/);return y?`Student ${y[1]}`:o.clientId},O=()=>{if(!o.lastUpdate)return"Just joined";const y=Math.floor((Date.now()-o.lastUpdate)/1e3);return y<5?"Just now":y<60?`${y}s ago`:`${Math.floor(y/60)}m ago`},v=((R=(G=o.meta)==null?void 0:G.base)==null?void 0:R.width)||800,M=((T=(A=o.meta)==null?void 0:A.base)==null?void 0:T.height)||600,z=_/v,L=y=>{y.stopPropagation(),n&&n(o.clientId)},N=(()=>{if(!r||!g)return null;const y=r.width/r.height,B=v/M;let j,P,Q,K;return y>B?(j=v,P=v/y,Q=0,K=(M-P)/2):(P=M,j=M*y,Q=(v-j)/2,K=0),{x:Q,y:K,width:j,height:P}})();return k.jsxs("div",{className:`student-card ${o.isActive?"active":"inactive"}`,onClick:()=>t(o),children:[k.jsxs("div",{className:"student-card-header",children:[k.jsxs("div",{className:"student-name",children:[k.jsx("span",{className:"student-icon",children:"👤"}),l?"•••":E()]}),k.jsxs("div",{className:"student-header-actions",children:[k.jsx("button",{className:`flag-button ${o.isFlagged?"active":""}`,onClick:L,"aria-label":o.isFlagged?"Remove flag":"Flag student",title:o.isFlagged?"Remove flag":"Flag student",children:k.jsx(bb,{active:o.isFlagged,size:18})}),k.jsxs("div",{className:"student-status",children:[k.jsx("span",{className:`status-dot ${o.isActive?"online":"offline"}`}),o.isVisible===!1&&o.isActive&&k.jsx("span",{className:"visibility-indicator away",title:"Student is distracted (switched away from tab)",children:"⚠️"})]})]})]}),k.jsxs("div",{className:"student-card-canvas",ref:d,children:[k.jsxs(Mg,{ref:c,width:v,height:M,scaleX:z,scaleY:z,style:{transformOrigin:"top left",width:"100%",height:"100%"},children:[N&&k.jsx(Lr,{listening:!1,children:k.jsx(rv,{image:g,x:N.x,y:N.y,width:N.width,height:N.height})}),k.jsx(Lr,{children:o.lines&&o.lines.map((y,B)=>k.jsx(fo,{points:y.points,stroke:y.color||"black",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`preview-${o.clientId}-${B}`))}),k.jsx(Lr,{children:a.map((y,B)=>k.jsx(fo,{points:y.points,stroke:y.color||"#FF0000",strokeWidth:y.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${o.clientId}-${B}`))})]}),(!o.lines||o.lines.length===0)&&k.jsxs("div",{className:"no-drawing",children:[k.jsx("span",{children:"✏️"}),k.jsx("p",{children:"No drawing yet"})]}),o.lines&&o.lines.length>0&&k.jsxs("div",{className:"stroke-count",children:[o.lines.length," stroke",o.lines.length!==1?"s":""]})]}),k.jsxs("div",{className:"student-card-footer",children:[k.jsx("span",{className:"last-update",children:O()}),k.jsx("span",{className:"click-hint",children:"Click to annotate →"})]})]})},nf={width:800,height:600},hg="teacherAnnotationPrefs",_m=2,Em=[{label:"Red",value:"#FF3B30"},{label:"Purple",value:"#7C3AED"},{label:"Teal",value:"#0EA5E9"}],Eb=({student:o,isOpen:t,onClose:n,onAnnotate:a,existingAnnotations:r=[],isFlagged:l=!1,onToggleFlag:c,sharedImage:d})=>{const[g,m]=lt.useState("pen"),[_,C]=lt.useState(Em[0].value),[E,O]=lt.useState(3),[v,M]=lt.useState(!1),[z,L]=lt.useState([]),[D,N]=lt.useState("stylus-only"),[G,R]=lt.useState("left"),[A,T]=lt.useState(null),[y,B]=lt.useState(!1),j=lt.useRef([]),P=lt.useRef([]),Q=lt.useRef(!1),K=lt.useRef(null),X=lt.useRef(!0),V=lt.useRef(null),U=lt.useRef(null);lt.useEffect(()=>{if(!d){T(null);return}const xt=new window.Image;xt.src=d.dataUrl,xt.onload=()=>{T(xt)}},[d]);const I=lt.useRef(null),F=lt.useRef(null),[W,it]=lt.useState({width:960,height:720}),Z=lt.useMemo(()=>({x:W.width/nf.width,y:W.height/nf.height}),[W]);lt.useEffect(()=>{const xt=()=>{B(window.innerWidth<=768)};return xt(),window.addEventListener("resize",xt),()=>window.removeEventListener("resize",xt)},[]),lt.useEffect(()=>{if(!(typeof window>"u")){console.log("🟣 [TEACHER ANNOTATION] Loading preferences from localStorage...");try{const xt=localStorage.getItem(hg);if(xt){const Xt=JSON.parse(xt);if(console.log("🟣 [TEACHER ANNOTATION] Found stored preferences:",Xt),Xt.version!==_m){console.log("🟣 [TEACHER ANNOTATION] Version mismatch! Expected:",_m,"Got:",Xt.version),console.log("🟣 [TEACHER ANNOTATION] Clearing old preferences..."),localStorage.removeItem(hg);return}console.log("🟣 [TEACHER ANNOTATION] Applying preferences..."),Xt.tool&&m(Xt.tool),Xt.color&&C(Xt.color),typeof Xt.brushSize=="number"&&O(Xt.brushSize),Xt.inputMode&&N(Xt.inputMode),Xt.toolbarPosition&&R(Xt.toolbarPosition),console.log("🟣 [TEACHER ANNOTATION] Preferences loaded successfully!")}else console.log("🟣 [TEACHER ANNOTATION] No stored preferences found, using defaults")}catch(xt){console.warn("🟣 [TEACHER ANNOTATION] Failed to load teacher annotation prefs",xt),localStorage.removeItem(hg)}}},[]),lt.useEffect(()=>{if(typeof window>"u")return;if(X.current){X.current=!1,console.log("💾 [TEACHER ANNOTATION] Skipping save on first render");return}const xt={version:_m,tool:g,color:_,brushSize:E,inputMode:D,toolbarPosition:G};console.log("💾 [TEACHER ANNOTATION] Saving preferences to localStorage:",xt),localStorage.setItem(hg,JSON.stringify(xt))},[g,_,E,D,G]),lt.useEffect(()=>{t&&o&&o.clientId!==K.current&&(K.current=o.clientId,L(r),j.current=[],P.current=[])},[t,o,r]),lt.useEffect(()=>{t&&o&&L(r)},[r,t,o]),lt.useEffect(()=>()=>{U.current&&cancelAnimationFrame(U.current)},[]),lt.useEffect(()=>{if(t){const xt=document.body.style.overflow,Xt=document.body.style.position,be=document.body.style.touchAction;document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.touchAction="none";const ye=I.current;if(!ye)return;const me=Ue=>{const ft=Ue.target;ft.closest("button")||ft.closest(".annotation-sidebar")||ft.closest(".annotation-status-actions")||Ue.preventDefault()},De=Ue=>{Ue.preventDefault()},Ye=Ue=>{if(v)return Ue.preventDefault(),!1};return ye.addEventListener("touchstart",me,{passive:!1}),ye.addEventListener("touchmove",me,{passive:!1}),ye.addEventListener("gesturestart",De,{passive:!1}),ye.addEventListener("gesturechange",De,{passive:!1}),document.addEventListener("selectstart",Ye),()=>{document.body.style.overflow=xt,document.body.style.position=Xt,document.body.style.touchAction=be,ye&&(ye.removeEventListener("touchstart",me),ye.removeEventListener("touchmove",me),ye.removeEventListener("gesturestart",De),ye.removeEventListener("gesturechange",De)),document.removeEventListener("selectstart",Ye)}}},[t,v]),lt.useEffect(()=>{if(!t)return;const xt=()=>{if(!I.current)return;const Xt=I.current.getBoundingClientRect(),me=24+4,De=Math.max(320,Xt.width-me),Ye=Math.max(240,Xt.height-me),Ue=De/nf.width,ft=Ye/nf.height,ct=Math.min(Ue,ft);it({width:Math.round(nf.width*ct),height:Math.round(nf.height*ct)})};return xt(),window.addEventListener("resize",xt),()=>window.removeEventListener("resize",xt)},[G,t]);const rt=()=>{if(!d||!A)return null;const xt=d.width/d.height,Xt=W.width/W.height;let be,ye,me,De;return xt>Xt?(be=W.width,ye=W.width/xt,me=0,De=(W.height-ye)/2):(ye=W.height,be=W.height*xt,me=(W.width-be)/2,De=0),{x:me,y:De,width:be,height:ye}};if(!t||!o)return null;const at=rt(),Y=()=>{if(o.name)return o.name;const xt=o.clientId.match(/student-(\d+)/)||o.clientId.match(/load-test-student-(\d+)/);return xt?`Student ${xt[1]}`:o.clientId},J=xt=>D!=="stylus-only"?!0:(xt==null?void 0:xt.pointerType)==="pen",tt=(xt=[])=>xt.map((Xt,be)=>be%2===0?Xt*Z.x:Xt*Z.y),et=xt=>({x:xt.x/Z.x,y:xt.y/Z.y}),gt=xt=>(xt.strokeWidth||3)*Z.x,wt=xt=>{const Xt=xt.evt;if(Xt!=null&&Xt.preventDefault&&Xt.preventDefault(),Xt!=null&&Xt.stopPropagation&&Xt.stopPropagation(),!J(Xt))return;const be=xt.target.getStage();if(be&&Xt.pointerId!==void 0){const ye=be.content;if(ye&&ye.setPointerCapture)try{ye.setPointerCapture(Xt.pointerId)}catch{}}if(g==="pen"){M(!0);const ye=be.getPointerPosition(),{x:me,y:De}=et(ye),Ye={tool:"pen",points:[me,De],color:_,strokeWidth:E};j.current.push([...z]),P.current=[],V.current=Ye,L([...z,Ye])}else g==="eraser"&&(M(!0),Q.current=!1)},Dt=xt=>{const Xt=xt.evt;if(Xt!=null&&Xt.preventDefault&&Xt.preventDefault(),Xt!=null&&Xt.stopPropagation&&Xt.stopPropagation(),!v||!J(Xt))return;const ye=xt.target.getStage().getPointerPosition();if(g==="pen"){if(V.current){const{x:me,y:De}=et(ye);V.current.points=V.current.points.concat([me,De]);const Ye=V.current;U.current&&cancelAnimationFrame(U.current),U.current=requestAnimationFrame(()=>{Ye&&L(Ue=>Ue.length===0?Ue:[...Ue.slice(0,-1),Ye])})}}else if(g==="eraser"){const me=z.length,De=20,Ye=z.filter(Ue=>{for(let ft=0;ft<Ue.points.length;ft+=2){const ct=Ue.points[ft]*Z.x,ht=Ue.points[ft+1]*Z.y;if(Math.sqrt(Math.pow(ct-ye.x,2)+Math.pow(ht-ye.y,2))<De)return!1}return!0});Ye.length<me&&!Q.current&&(j.current.push([...z]),P.current=[],Q.current=!0),L(Ye)}},Qt=xt=>{const Xt=xt==null?void 0:xt.evt;if(!J(Xt)){Xt!=null&&Xt.preventDefault&&Xt.preventDefault();return}if(M(!1),U.current&&(cancelAnimationFrame(U.current),U.current=null),V.current&&g==="pen"){const be=V.current;L(ye=>{if(ye.length===0)return ye;const me=[...ye.slice(0,-1),be];return setTimeout(()=>a(me),0),me}),V.current=null}else setTimeout(()=>a(z),0)},te=()=>{if(j.current.length>0){const xt=j.current.pop();P.current.push([...z]),L(xt),a(xt)}},se=()=>{if(P.current.length>0){const xt=P.current.pop();j.current.push([...z]),L(xt),a(xt)}},kt=()=>{j.current.push([...z]),P.current=[];const xt=[];L(xt),a(xt)},pe=()=>{c&&c(o.clientId)},Ee=()=>{M(!1),n()},Ze=()=>{N(xt=>xt==="stylus-only"?"all":"stylus-only")},Ve=()=>{R(xt=>xt==="left"?"right":"left")},tn=xt=>{xt.preventDefault(),xt.stopPropagation()};return k.jsx("div",{className:"annotation-modal-overlay",onTouchMove:tn,onTouchStart:tn,children:k.jsx("div",{className:"annotation-modal student-console",children:k.jsxs("div",{className:"annotation-console",children:[k.jsxs("div",{className:"annotation-status-bar",children:[k.jsxs("div",{className:"annotation-status-text",children:[k.jsx("h1",{children:"Annotate Student"}),k.jsx("p",{children:Y()})]}),k.jsxs("div",{className:"annotation-status-actions",children:[k.jsx("div",{className:"tool-status-indicator",children:k.jsxs("span",{className:"tool-status-text",children:[k.jsx("i",{className:g==="pen"?"pi pi-pencil":"pi pi-eraser"})," ",D==="all"?"All inputs":"Stylus only"]})}),k.jsxs("button",{className:`flag-pill ${l?"active":""}`,onClick:pe,children:[k.jsx(bb,{active:l,size:16}),l?"Flagged":"Flag"]}),k.jsxs("button",{className:"status-badge",onClick:Ve,children:["Move toolbar to ",G==="left"?"right":"left"]}),k.jsx("button",{className:"status-badge danger",onClick:Ee,children:"✕ Close"})]})]}),k.jsxs("div",{className:`annotation-workspace ${G==="right"?"toolbar-right":""} ${y?"mobile-view":""}`,children:[y?k.jsxs("div",{className:"mobile-annotation-toolbar",children:[k.jsx("div",{className:"mobile-colors",children:Em.map(xt=>k.jsx("button",{onClick:()=>C(xt.value),className:`mobile-color-button ${_===xt.value?"active":""}`,style:{background:xt.value},"aria-label":xt.label},xt.value))}),k.jsxs("div",{className:"mobile-tools",children:[k.jsx("button",{onClick:()=>m("pen"),className:`mobile-tool-button ${g==="pen"?"active":""}`,"aria-label":"Pen",children:k.jsx(fb,{size:20})}),k.jsx("button",{onClick:()=>m("eraser"),className:`mobile-tool-button ${g==="eraser"?"active":""}`,"aria-label":"Eraser",children:k.jsx(cb,{size:20})}),k.jsx("button",{onClick:te,className:"mobile-tool-button",disabled:j.current.length===0,"aria-label":"Undo",children:k.jsx(gb,{size:20})}),k.jsx("button",{onClick:se,className:"mobile-tool-button",disabled:P.current.length===0,"aria-label":"Redo",children:k.jsx(hb,{size:20})}),k.jsx("button",{onClick:kt,className:"mobile-tool-button danger","aria-label":"Clear",children:k.jsx(db,{size:20})})]})]}):k.jsxs("div",{className:"annotation-sidebar",children:[k.jsxs("div",{className:"sidebar-header",children:[k.jsx("h2",{children:"Annotation Console"}),k.jsx("p",{children:"Mirror of student workspace"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"COLORS"}),k.jsx("div",{className:"color-row",children:Em.map(xt=>k.jsx("button",{className:`color-button ${_===xt.value?"active":""}`,style:{background:xt.value},onClick:()=>C(xt.value),"aria-label":xt.label},xt.value))})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"TOOLS"}),k.jsxs("div",{className:"tool-buttons tool-icon-buttons",children:[k.jsxs("button",{onClick:()=>m("pen"),className:`tool-icon-button ${g==="pen"?"active":""}`,title:"Pen",children:[k.jsx("i",{className:"pi pi-pencil tool-icon"}),k.jsx("span",{className:"tool-label",children:"Pen"})]}),k.jsxs("button",{onClick:()=>m("eraser"),className:`tool-icon-button ${g==="eraser"?"active":""}`,title:"Eraser",children:[k.jsx("i",{className:"pi pi-eraser tool-icon"}),k.jsx("span",{className:"tool-label",children:"Eraser"})]})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"BRUSH SIZE"}),k.jsxs("div",{className:"brush-size-control",children:[k.jsx("input",{type:"range",min:"1",max:"10",value:E,onChange:xt=>O(parseInt(xt.target.value)),className:"brush-slider"}),k.jsx("span",{className:"brush-value",children:E})]})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"INPUT MODE"}),k.jsx("button",{className:`input-mode-toggle ${D==="all"?"all":""}`,onClick:Ze,children:D==="stylus-only"?"Stylus only":"All inputs"})]}),k.jsxs("div",{className:"sidebar-section",children:[k.jsx("h3",{className:"sidebar-label",children:"HISTORY"}),k.jsxs("div",{className:"history-buttons",children:[k.jsx("button",{onClick:te,className:"history-button",disabled:j.current.length===0,children:"Undo"}),k.jsx("button",{onClick:se,className:"history-button",disabled:P.current.length===0,children:"Redo"}),k.jsx("button",{onClick:kt,className:"history-button danger",children:"Clear"})]})]})]}),k.jsx("div",{className:"annotation-canvas-panel",children:k.jsx("div",{className:"annotation-canvas-frame",ref:I,onTouchMove:xt=>xt.preventDefault(),onTouchStart:xt=>xt.preventDefault(),children:k.jsxs(Mg,{ref:F,width:W.width,height:W.height,onPointerDown:wt,onPointerMove:Dt,onPointerUp:Qt,onPointerLeave:Qt,onTouchStart:xt=>xt.preventDefault(),onTouchMove:xt=>xt.preventDefault(),onTouchEnd:xt=>xt.preventDefault(),className:"annotation-stage",perfectDrawEnabled:!1,children:[at&&k.jsx(Lr,{listening:!1,children:k.jsx(rv,{image:A,x:at.x,y:at.y,width:at.width,height:at.height})}),k.jsx(Lr,{listening:!1,children:o.lines&&o.lines.map((xt,Xt)=>k.jsx(fo,{points:tt(xt.points),stroke:xt.color||"black",strokeWidth:(xt.strokeWidth||3)*Z.x,tension:.5,lineCap:"round",lineJoin:"round"},`student-${Xt}`))}),k.jsx(Lr,{children:z.map((xt,Xt)=>k.jsx(fo,{points:tt(xt.points),stroke:xt.color,strokeWidth:gt(xt),tension:.5,lineCap:"round",lineJoin:"round"},`annotation-${Xt}`))})]})})})]})]})})})},Cb=async(o,t=800,n=600,a=.7)=>{console.log("📸 Processing image:",o.name,o.type,o.size,"bytes");let r,l,c;if(typeof createImageBitmap=="function")try{console.log("📸 Using createImageBitmap");const v=await createImageBitmap(o);l=v.width,c=v.height,r=v}catch(v){console.warn("📸 createImageBitmap failed, using fallback:",v),r=null}r||(console.log("📸 Using Image() fallback for iOS/Safari"),r=await new Promise((v,M)=>{const z=new Image,L=URL.createObjectURL(o);z.onload=()=>{URL.revokeObjectURL(L),v(z)},z.onerror=()=>{URL.revokeObjectURL(L),M(new Error("Failed to load image"))},z.src=L}),l=r.naturalWidth||r.width,c=r.naturalHeight||r.height);const d=Math.min(t/l,n/c,1),g=Math.round(l*d),m=Math.round(c*d);console.log("📸 Resizing:",l,"x",c,"→",g,"x",m);const _=document.createElement("canvas");_.width=g,_.height=m;const C=_.getContext("2d");C.fillStyle="#FFFFFF",C.fillRect(0,0,g,m),C.drawImage(r,0,0,g,m);const E=await new Promise((v,M)=>{_.toBlob(z=>{z?(console.log("📸 Compressed to:",z.size,"bytes"),v(z)):M(new Error("Failed to compress image"))},"image/jpeg",a)}),O=await new Promise((v,M)=>{const z=new FileReader;z.onload=()=>{console.log("📸 Data URL created, length:",z.result.length),v(z.result)},z.onerror=()=>{console.error("📸 Failed to create data URL"),M(z.error)},z.readAsDataURL(E)});return console.log("📸 ✅ Image processing complete"),{blob:E,dataUrl:O,width:g,height:m,size:E.size}},OT=()=>{const[o,t]=pd(),n=mf(),a=()=>{const Lt="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let It="";for(let ne=0;ne<6;ne++)It+=Lt.charAt(Math.floor(Math.random()*Lt.length));return It},r=()=>{const Lt=o.get("room");if(Lt)return Lt.toUpperCase();const It=a();return t({room:It}),It},[l]=Vn.useState(r),[c,d]=lt.useState(null),[g,m]=lt.useState(null),[_,C]=lt.useState(null),[E,O]=lt.useState(0),[v,M]=lt.useState("created"),[z,L]=lt.useState(null),[D,N]=lt.useState(null),[G,R]=lt.useState(!1),[A]=lt.useState(`teacher-${Math.random().toString(36).substring(7)}`),[T,y]=lt.useState(()=>{const Lt=parseInt(o.get("bot"))||0,It={};if(Lt>0)for(let ne=1;ne<=Lt;ne++){const ae=`bot-${ne}`;It[ae]={clientId:ae,name:`Bot ${ne}`,lines:[],lastUpdate:Date.now()-ne*1e3,isActive:!0,isFlagged:!1}}return It}),[B,j]=lt.useState(null),[P,Q]=lt.useState({}),[K,X]=lt.useState(""),[V,U]=lt.useState("all"),[I,F]=lt.useState("all"),[W,it]=lt.useState(()=>{const Lt=localStorage.getItem("teacherDashboardHideNames");return Lt?JSON.parse(Lt):!1}),[Z,rt]=lt.useState(()=>{const Lt=localStorage.getItem("teacherDashboardCardsPerRow");return Lt?parseInt(Lt):3}),[at,Y]=lt.useState("blank"),[J,tt]=lt.useState(null),[et,gt]=lt.useState(null),[wt,Dt]=lt.useState(""),[Qt,te]=lt.useState(!1),[se,kt]=lt.useState(null),pe=lt.useRef(null),Ee=lt.useRef(null),Ze=lt.useRef(null),[Ve,tn]=lt.useState(!1),[xt,Xt]=lt.useState(""),[be,ye]=lt.useState([]),me=lt.useRef(!1);lt.useEffect(()=>{pe.current=se},[se]);const De=(Lt,It="info")=>{const ne=Date.now();ye(ae=>[...ae,{id:ne,message:Lt,type:It}]),setTimeout(()=>{ye(ae=>ae.filter(qt=>qt.id!==ne))},4e3)};lt.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(W))},[W]),lt.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",Z.toString())},[Z]),lt.useEffect(()=>{(async()=>{try{console.log("📝 Initializing session in Supabase with room code:",l);const{data:It,error:ne}=await Wa.from("sessions").select("*").ilike("room_code",l).order("created_at",{ascending:!1}).limit(1);if(ne){console.error("Failed to query sessions:",ne);return}let ae=null;if(It&&It.length>0){const qt=It[0];if(qt.status==="ended"){console.log("⏸️ Found ended session, resetting to created status");const{data:Be,error:Kn}=await Wa.from("sessions").update({status:"created",started_at:null,ended_at:null}).eq("id",qt.id).select().single();if(Kn){console.error("Failed to update session:",Kn);return}ae=Be,console.log("✅ Session reset to created:",ae)}else console.log("♻️ Reusing existing session:",qt),ae=qt}else{console.log("🆕 No existing session found, creating new one");const{data:qt,error:Be}=await Wa.from("sessions").insert([{room_code:l,status:"created"}]).select().single();if(Be){console.error("Failed to create session:",Be);return}ae=qt,console.log("✅ Session created:",ae)}if(ae){d(ae.id),M(ae.status);const{data:qt,error:Be}=await Wa.from("participants").insert([{session_id:ae.id,client_id:A,name:"Teacher",role:"teacher"}]).select().single();Be?console.error("Failed to create teacher participant:",Be):(console.log("👤 Teacher participant created:",qt),m(qt.id))}}catch(It){console.error("Error initializing session:",It)}})()},[l]),lt.useEffect(()=>(c&&(async()=>{try{const It=`/api/token?clientId=${A}`,ae=await(await fetch(It)).json(),qt=new pv.Realtime({authCallback:async(Ut,je)=>{je(null,ae)},clientId:A});qt.connection.on("connected",()=>{console.log("Connected to Ably"),R(!0)}),qt.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),R(!1)}),L(qt);const Be=qt.channels.get(`room-${l}`);Be.subscribe("student-layer",Ut=>{console.log("📥 Teacher received student layer from",Ut.clientId),me.current=!0,y(je=>{var en,ze,ln;return{...je,[Ut.clientId]:{...je[Ut.clientId]||{},clientId:Ut.clientId,name:((en=je[Ut.clientId])==null?void 0:en.name)||Ye(Ut.clientId),lines:Ut.data.lines||[],meta:Ut.data.meta||((ze=je[Ut.clientId])==null?void 0:ze.meta)||null,lastUpdate:Date.now(),isActive:!0,isFlagged:((ln=je[Ut.clientId])==null?void 0:ln.isFlagged)||!1}}}),setTimeout(()=>{me.current=!1},100)}),Be.presence.subscribe("enter",Ut=>{var je;if(Ut.clientId!==A&&Ut.clientId.includes("student")){const en=((je=Ut.data)==null?void 0:je.name)||Ye(Ut.clientId);console.log("🟢 [PRESENCE ENTER]",Ut.clientId,"Name:",en),y(ze=>{var ln,oa;return ze[Ut.clientId]?(console.log("⚠️ [DUPLICATE ENTER] Student already exists:",Ut.clientId),{...ze,[Ut.clientId]:{...ze[Ut.clientId],isActive:!0,isVisible:((ln=Ut.data)==null?void 0:ln.isVisible)!==!1,lastUpdate:Date.now()}}):(console.log("✅ [NEW STUDENT] Adding:",Ut.clientId),De(`${en} joined`,"success"),{...ze,[Ut.clientId]:{clientId:Ut.clientId,name:en,isActive:!0,isVisible:((oa=Ut.data)==null?void 0:oa.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:!1,lines:[]}})}),setTimeout(()=>{pe.current&&(Be.publish("sync-question-state",{targetClientId:Ut.clientId,content:pe.current,timestamp:Date.now()}),console.log("📤 Sent current question state to",Ut.clientId))},500)}}),Be.presence.subscribe("leave",Ut=>{Ut.clientId!==A&&Ut.clientId.includes("student")&&(console.log("🔴 [PRESENCE LEAVE]",Ut.clientId),y(je=>{if(!je[Ut.clientId])return console.log("⚠️ [DUPLICATE LEAVE] Student not found:",Ut.clientId),je;const en=je[Ut.clientId],ze=(en==null?void 0:en.name)||Ye(Ut.clientId);console.log("✅ [REMOVE STUDENT]",Ut.clientId,"Name:",ze),De(`${ze} left`,"info");const{[Ut.clientId]:ln,...oa}=je;return oa}))}),Be.subscribe("student-visibility",Ut=>{const{clientId:je,studentName:en,isVisible:ze}=Ut.data;console.log(`👁️ Student visibility event: ${en} - ${ze?"visible":"hidden"}`),y(ln=>{var ys;const oa=((ys=ln[je])==null?void 0:ys.isVisible)===!1;return ze?oa&&De(`✓ ${en} returned`,"success"):De(`⚠️ ${en} switched away`,"warning"),{...ln,[je]:{...ln[je]||{},isVisible:ze,lastVisibilityChange:Date.now()}}})}),Be.subscribe("teacher-image",Ut=>{console.log("📸 Teacher dashboard received shared image"),kt(Ut.data)}),Be.subscribe("request-current-state",Ut=>{console.log("📞 Student requesting current state:",Ut.clientId),setTimeout(()=>{pe.current?(Be.publish("sync-question-state",{targetClientId:Ut.clientId,content:pe.current,timestamp:Date.now()}),console.log("📤 Sent current question state to",Ut.clientId)):console.log("📭 No question state to send (blank canvas)")},100)}),await Be.presence.enter({role:"teacher",timestamp:Date.now()}),console.log("✅ [TEACHER] Entered presence in room",l);const Kn=await Be.presence.get();console.log(`📋 [INIT] Found ${Kn.length} presence members`);const wn={};if(Object.keys(T).forEach(Ut=>{Ut.startsWith("bot-")&&(console.log("🤖 [INIT] Preserving bot:",Ut),wn[Ut]=T[Ut])}),Kn.forEach(Ut=>{var je,en;if(Ut.clientId!==A&&Ut.clientId.includes("student")){const ze=((je=Ut.data)==null?void 0:je.name)||Ye(Ut.clientId);console.log("📥 [INIT] Loading student:",Ut.clientId,"Name:",ze),wn[Ut.clientId]={clientId:Ut.clientId,name:ze,isActive:!0,isVisible:((en=Ut.data)==null?void 0:en.isVisible)!==!1,lastUpdate:Date.now(),isFlagged:!1,lines:[]}}}),console.log(`✅ [INIT] Setting ${Object.keys(wn).length} students`),y(wn),N(Be),c)try{const{data:Ut,error:je}=await Wa.from("participants").insert([{session_id:c,client_id:A,role:"teacher"}]).select().single();je?console.error("Failed to create teacher participant:",je):(console.log("✅ Teacher participant created:",Ut),m(Ut.id))}catch(Ut){console.error("Error creating teacher participant:",Ut)}}catch(It){console.error("Failed to connect to Ably:",It)}})(),()=>{z&&z.close()}),[l,A,c]),lt.useEffect(()=>{const Lt=ne=>{if((v==="active"||v==="created")&&(ne.preventDefault(),ne.returnValue="This will end the session for all students. Are you sure?",c&&D))try{D.publish("session-ended",{timestamp:Date.now(),reason:"teacher_refresh"});const ae=`${window.location.origin}/api/end-session`,qt=JSON.stringify({sessionId:c});navigator.sendBeacon(ae,qt)}catch(ae){console.error("Error ending session on unload:",ae)}},It=()=>{if(console.log("📱 Teacher page hide - ending session"),(v==="active"||v==="created")&&c&&D)try{D.publish("session-ended",{timestamp:Date.now(),reason:"teacher_refresh"})}catch(ne){console.error("Error ending session on pagehide:",ne)}};return window.addEventListener("beforeunload",Lt),window.addEventListener("pagehide",It),()=>{window.removeEventListener("beforeunload",Lt),window.removeEventListener("pagehide",It)}},[v,c,D]);const Ye=Lt=>{const It=Lt.match(/student-(\d+)/)||Lt.match(/student-([\w]+)/);return It?`Student ${It[1]}`:Lt},Ue=Lt=>{j(T[Lt.clientId]||Lt)},ft=()=>{j(null)},ct=Lt=>{if(!B||!D)return;const It=B.clientId;Q(ne=>({...ne,[It]:Lt})),D.publish("teacher-annotation",{targetStudentId:It,annotations:Lt,teacherId:A,timestamp:Date.now()}),console.log("📤 Published annotations for",It)},ht=Lt=>{y(It=>{const ne=It[Lt];return ne?{...It,[Lt]:{...ne,isFlagged:!ne.isFlagged}}:It}),j(It=>It&&It.clientId===Lt?{...It,isFlagged:!It.isFlagged}:It)},Ot=()=>{Ee.current&&(Ee.current.value="",Ee.current.click())},Vt=async Lt=>{var ne;const It=(ne=Lt.target.files)==null?void 0:ne[0];if(!It){Dt("No file selected.");return}console.log("📤 [TEACHER] Uploading image:",It.name,It.type,It.size),te(!0),Dt("Processing image...");try{const{dataUrl:ae,width:qt,height:Be,size:Kn}=await Cb(It),wn={dataUrl:ae,width:qt,height:Be,filename:It.name,timestamp:Date.now()};gt(wn),console.log("✅ [TEACHER] Image ready:",qt,"x",Be,"Final size:",Kn),Dt(`Image ready (${qt}×${Be}, ${Math.round(Kn/1024)}KB)`)}catch(ae){console.error("❌ [TEACHER] Image upload failed:",ae),Dt(`Upload failed: ${ae.message||"Unknown error"}. Try a different image.`),De("Image upload failed","error")}finally{te(!1)}},Ct=()=>{gt(null),Dt(""),Ee.current&&(Ee.current.value="")},zt=Lt=>{const It=document.createElement("canvas"),ne=800,ae=600;It.width=ne,It.height=ae;const qt=It.getContext("2d");if(qt.fillStyle="#FFFFFF",qt.fillRect(0,0,ne,ae),Lt==="hanzi"){const wn=(ne-450)/2,Ut=(ae-450)/2;qt.strokeStyle="#0F9D83",qt.lineWidth=4,qt.strokeRect(wn,Ut,450,450),qt.strokeStyle="#B0E8D8",qt.lineWidth=2,qt.setLineDash([8,8]),qt.beginPath(),qt.moveTo(ne/2,Ut),qt.lineTo(ne/2,Ut+450),qt.stroke(),qt.beginPath(),qt.moveTo(wn,ae/2),qt.lineTo(wn+450,ae/2),qt.stroke()}else if(Lt==="graph-corner"){qt.strokeStyle="#E0E0E0",qt.lineWidth=1,qt.setLineDash([]);for(let Ut=80;Ut<=ne-80;Ut+=40)qt.beginPath(),qt.moveTo(Ut,80),qt.lineTo(Ut,ae-80),qt.stroke();for(let Ut=80;Ut<=ae-80;Ut+=40)qt.beginPath(),qt.moveTo(80,Ut),qt.lineTo(ne-80,Ut),qt.stroke();qt.strokeStyle="#5B9BD5",qt.lineWidth=3,qt.beginPath(),qt.moveTo(80,ae-80),qt.lineTo(ne-80,ae-80),qt.stroke(),qt.beginPath(),qt.moveTo(80,80),qt.lineTo(80,ae-80),qt.stroke()}else if(Lt==="graph-cross"){qt.strokeStyle="#E0E0E0",qt.lineWidth=1,qt.setLineDash([]);for(let Ut=80;Ut<=ne-80;Ut+=40)qt.beginPath(),qt.moveTo(Ut,80),qt.lineTo(Ut,ae-80),qt.stroke();for(let Ut=80;Ut<=ae-80;Ut+=40)qt.beginPath(),qt.moveTo(80,Ut),qt.lineTo(ne-80,Ut),qt.stroke();qt.strokeStyle="#5B9BD5",qt.lineWidth=3,qt.beginPath(),qt.moveTo(80,ae/2),qt.lineTo(ne-80,ae/2),qt.stroke(),qt.beginPath(),qt.moveTo(ne/2,80),qt.lineTo(ne/2,ae-80),qt.stroke()}const Be=It.toDataURL("image/png");return{type:Lt,dataUrl:Be,width:ne,height:ae,timestamp:Date.now()}},Bt=Lt=>{const It=zt(Lt);tt(It),Dt(`Template ready: ${Lt}`)},Se=async()=>{if(!D||!c){console.error("Cannot send: channel or sessionId missing",{channel:!!D,sessionId:c}),Dt("Error: Not connected properly. Please refresh the page."),De("Failed to send: Connection issue","error");return}try{if(v==="created"){console.log("🎬 Starting session...");const{error:wn}=await Wa.from("sessions").update({status:"active",started_at:new Date().toISOString()}).eq("id",c);if(wn){console.error("Failed to start session:",wn),Dt("Failed to start session. Please try again.");return}M("active"),await D.publish("session-started",{timestamp:Date.now(),sessionId:c}),console.log("✅ Session started!")}const It=E+1;O(It);let ne="blank",ae=null,qt=null;at==="templates"&&J?(ne="template",ae=J.type,qt={dataUrl:J.dataUrl,width:J.width,height:J.height}):at==="image"&&et&&(ne="image",qt={dataUrl:et.dataUrl,width:et.width,height:et.height,filename:et.filename});const{data:Be,error:Kn}=await Wa.from("questions").insert([{session_id:c,question_number:It,content_type:ne,template_type:ae,image_data:qt}]).select().single();if(Kn){console.error("Failed to create question:",Kn),Dt("Failed to save question. Please try again.");return}console.log("✅ Question created:",Be),C(Be.id),await D.publish("clear-all-drawings",{timestamp:Date.now(),questionId:Be.id}),y(wn=>{const Ut={};return Object.keys(wn).forEach(je=>{Ut[je]={...wn[je],lines:[]}}),Ut}),Q({}),at==="blank"?(await D.publish("teacher-clear",{timestamp:Date.now()}),kt(null),tt(null),Dt(`Question ${It}: Blank canvas sent to all students.`),De(`Question ${It} sent!`,"success")):at==="templates"&&J?(await D.publish("teacher-template",J),kt(J),Dt(`Question ${It}: Template sent to all students.`),De(`Question ${It} sent!`,"success")):at==="image"&&et&&(await D.publish("teacher-image",et),kt(et),Dt(`Question ${It}: Image sent to all students.`),De(`Question ${It} sent!`,"success"))}catch(Lt){console.error("Failed to send to class:",Lt),Dt("Failed to send. Please try again."),De("Failed to send question","error")}},_e=async(Lt="teacher_ended")=>{if(c&&(v==="active"||v==="created"))try{return await Wa.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",c),D&&await D.publish("session-ended",{timestamp:Date.now(),reason:Lt}),console.log("✅ Session ended:",Lt),!0}catch(It){return console.error("Error ending session:",It),!1}return!1},$t=async()=>{window.confirm(`Are you sure you want to end this session?

All students will be logged out and the session will be closed.`)&&(await _e("teacher_ended"),z&&z.close(),n("/"))},He=async()=>{const Lt=`${window.location.origin}/student?room=${l}`;try{const It=await Sb.toDataURL(Lt,{width:300,margin:2,color:{dark:"#0F172A",light:"#FFFFFF"}});Xt(It),tn(!0)}catch(It){console.error("Failed to generate QR code:",It)}},sn=async()=>{const Lt=`${window.location.origin}/student?room=${l}`;if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(Lt),alert("Link copied to clipboard!");return}catch(It){console.error("Clipboard API failed:",It)}try{const It=Ze.current;if(It)if(It.select(),It.setSelectionRange(0,99999),document.execCommand("copy"))alert("Link copied to clipboard!"),window.getSelection().removeAllRanges();else throw new Error("execCommand failed");else throw new Error("Input ref not available")}catch(It){console.error("Fallback copy failed:",It),Ze.current&&Ze.current.select(),alert("Please copy the selected link manually (Ctrl+C or Cmd+C)")}},An=()=>Object.values(T).sort((Lt,It)=>{const ne=(Lt.name||Lt.clientId||"").toLowerCase(),ae=(It.name||It.clientId||"").toLowerCase();return ne.localeCompare(ae)}),Ln=()=>{const Lt=An(),It=K.trim().toLowerCase();return Lt.filter(ne=>{const ae=It?(ne.name||ne.clientId).toLowerCase().includes(It):!0,qt=V==="all"||V==="flagged"&&ne.isFlagged,Be=I==="all"||I==="distracted"&&ne.isVisible===!1&&ne.isActive;return ae&&qt&&Be})},Ga=An(),Li=Ln(),Hr=Ga.filter(Lt=>Lt.isActive).length,Gi=B?T[B.clientId]||B:null,vl=wt?!/fail|no file/i.test(wt):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:be.map(Lt=>k.jsxs("div",{className:`toast toast-${Lt.type}`,children:[Lt.type==="success"&&k.jsx("span",{className:"toast-icon",children:"✓"}),Lt.type==="info"&&k.jsx("span",{className:"toast-icon",children:"ℹ"}),Lt.type==="error"&&k.jsx("span",{className:"toast-icon",children:"✕"}),k.jsx("span",{className:"toast-message",children:Lt.message})]},Lt.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsxs("div",{className:"feather-branding",children:[k.jsx(KC,{size:32,strokeWidth:2}),k.jsx("span",{className:"feather-text",children:"Feather"})]}),k.jsx("section",{className:"hero-card glass-panel",children:k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"Teacher dashboard"}),k.jsx("h1",{children:"Monitor and annotate student canvases live"}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code to invite students. Their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:He,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:l})]}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Session live"}),k.jsx("span",{className:`status-pill connection-pill ${G?"online":"offline"}`,children:G?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:Hr}),k.jsx("span",{children:"online"})]})]}),k.jsx("button",{className:"end-session-btn",onClick:$t,title:"End session and logout all students",children:"End Session"})]})]})}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),J&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",J.type==="hanzi"?"Hanzi":J.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:Se,disabled:at==="image"&&!et,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${at==="blank"?"active":""}`,onClick:()=>{Y("blank"),tt(null),gt(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${at==="templates"?"active":""}`,onClick:()=>{Y("templates"),gt(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${at==="image"?"active":""} ${et?"ready":""}`,onClick:()=>{Y("image"),tt(null)},disabled:Qt,children:Qt?"Uploading…":"Send image"})]}),k.jsx("input",{ref:Ee,type:"file",accept:"image/*",onChange:Vt,style:{display:"none"}}),at==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(J==null?void 0:J.type)==="hanzi"?"active":""}`,onClick:()=>Bt("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(J==null?void 0:J.type)==="graph-corner"?"active":""}`,onClick:()=>Bt("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(J==null?void 0:J.type)==="graph-cross"?"active":""}`,onClick:()=>Bt("graph-cross"),children:"Graph (cross)"})]}),J&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:J.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),at==="image"&&k.jsx(k.Fragment,{children:et?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:et.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:et.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:et.width&&et.height?`${Math.round(et.width)} × ${Math.round(et.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:Ot,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:Ct,children:"Clear"})]}),wt&&k.jsx("span",{className:`image-message ${vl?"success":"error"}`,children:wt})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:Ot,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),wt&&k.jsx("span",{className:`image-message ${vl?"success":"error"}`,children:wt})]})}),at==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"controls-section glass-panel",children:k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:"🔍"}),k.jsx("input",{type:"text",placeholder:"Filter students",value:K,onChange:Lt=>X(Lt.target.value),className:"search-input"}),K&&k.jsx("button",{className:"clear-search-btn",onClick:()=>X(""),title:"Clear search",children:"✕"})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:W,onChange:Lt=>it(Lt.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${V==="flagged"?"active":""}`,onClick:()=>U(Lt=>Lt==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${I==="distracted"?"active":""}`,onClick:()=>F(Lt=>Lt==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:"⚠️ Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:Z,onChange:Lt=>rt(Number(Lt.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:Ga.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),k.jsx("h2",{children:"Waiting for students to join…"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):Li.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:"🔍"}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',K,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>X(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${Z}, 1fr)`},children:Li.filter(Lt=>Lt&&Lt.clientId).map(Lt=>k.jsx(_b,{student:Lt,onClick:Ue,onToggleFlag:ht,teacherAnnotations:P[Lt.clientId]||[],sharedImage:se,hideNames:W},Lt.clientId))})})})]}),k.jsx(Eb,{student:Gi,isOpen:!!Gi,isFlagged:Gi==null?void 0:Gi.isFlagged,onToggleFlag:ht,onClose:ft,onAnnotate:ct,existingAnnotations:Gi?P[Gi.clientId]||[]:[],sharedImage:se}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:["💡 ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),Ve&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>tn(!1),children:k.jsxs("div",{className:"qr-modal",onClick:Lt=>Lt.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",l]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>tn(!1),children:"✕"})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:xt&&k.jsx("img",{src:xt,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:Ze,type:"text",value:`${window.location.origin}/student?room=${l}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:sn,children:"Copy Link"})]})]})]})]})})]})},v2={width:800,height:600};function RT(){const[o]=pd(),t=o.get("room")||"load-test",n=o.get("name")||`TestStudent-${Date.now()}`,[a,r]=lt.useState(null),[l]=lt.useState(`test-student-${Math.random().toString(36).substr(2,9)}`),[c,d]=lt.useState(!1),[g,m]=lt.useState([]),[_,C]=lt.useState([]),[E,O]=lt.useState("pen"),[v,M]=lt.useState(!1),z=lt.useRef(!1);lt.useEffect(()=>{(async()=>{try{const A=new mS.Realtime({authUrl:"/api/token",authParams:{clientId:l}});A.connection.on("connected",()=>{console.log("Connected to Ably"),d(!0)}),A.connection.on("disconnected",()=>{console.log("Disconnected from Ably"),d(!1)});const T=A.channels.get(`room-${t}`);await new Promise((B,j)=>{T.once("attached",B),T.once("failed",j),T.attach()}),console.log("✅ Test Student channel attached");const y={name:n,role:"student",testMode:!0};console.log("📍 Entering presence with data:",y),await T.presence.enter(y),console.log("✅ Test Student entered presence as:",n),T.subscribe("student-layer",B=>{z.current=!0;const j=B.data;j.action==="clear"?m([]):j.lines&&m(P=>[...P,...j.lines]),setTimeout(()=>{z.current=!1},0)}),T.subscribe("teacher-layer",B=>{const j=B.data;j.action==="clear"?C([]):j.lines&&C(P=>[...P,...j.lines])}),r(T)}catch(A){console.error("Failed to initialize Ably:",A)}})()},[l,t,n]);const L=R=>{const A=R.target.getStage().getPointerPosition();if(!A)return;M(!0);const T={tool:E,points:[A.x,A.y],color:"black",strokeWidth:3};m([...g,T])},D=R=>{if(!v)return;const T=R.target.getStage().getPointerPosition();if(!T)return;const y=g[g.length-1];y&&(y.points=y.points.concat([T.x,T.y]),m([...g.slice(0,-1),y]))},N=()=>{if(!v||!a){M(!1);return}M(!1);const R=g[g.length-1];R&&R.points.length>=4&&a.publish("student-layer",{lines:[R]})},G=()=>{m([]),a&&a.publish("student-layer",{action:"clear"})};return k.jsxs("div",{className:"student-container",children:[k.jsxs("div",{className:"student-header",children:[k.jsxs("div",{className:"student-info",children:[k.jsx("span",{className:"student-name",children:n}),k.jsxs("span",{className:"room-code",children:["Room: ",t]}),k.jsx("span",{className:`connection-status ${c?"connected":"disconnected"}`,children:c?"● Connected":"○ Disconnected"})]}),k.jsx("div",{className:"test-badge",children:"TEST MODE"})]}),k.jsxs("div",{className:"toolbar",children:[k.jsx("button",{className:`tool-btn ${E==="pen"?"active":""}`,onClick:()=>O("pen"),title:"Pen",children:"✏️ Pen"}),k.jsx("button",{className:`tool-btn ${E==="eraser"?"active":""}`,onClick:()=>O("eraser"),title:"Eraser",children:"🧹 Eraser"}),k.jsx("button",{className:"tool-btn",onClick:G,title:"Clear Canvas",children:"🗑️ Clear"})]}),k.jsx("div",{className:"canvas-container",children:k.jsxs(Mg,{width:v2.width,height:v2.height,onMouseDown:L,onMousemove:D,onMouseup:N,onTouchStart:L,onTouchMove:D,onTouchEnd:N,className:"konva-stage",children:[k.jsx(Lr,{children:g.map((R,A)=>k.jsx(fo,{points:R.points,stroke:R.tool==="eraser"?"white":R.color,strokeWidth:R.tool==="eraser"?20:R.strokeWidth,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:R.tool==="eraser"?"destination-out":"source-over"},`student-${A}`))}),k.jsx(Lr,{listening:!1,children:_.map((R,A)=>k.jsx(fo,{points:R.points,stroke:"red",strokeWidth:R.strokeWidth||3,tension:.5,lineCap:"round",lineJoin:"round",opacity:.7},`teacher-${A}`))})]})}),k.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",background:"#f0f0f0",padding:"10px",borderRadius:"8px",fontSize:"12px"},children:[k.jsx("div",{children:k.jsx("strong",{children:"Test Mode Instructions:"})}),k.jsx("div",{children:"• No login required"}),k.jsx("div",{children:"• Draw on canvas to test"}),k.jsx("div",{children:"• Red lines are from teacher"})]})]})}const xT=()=>{const[o]=pd(),t=mf(),n=()=>{const Ct=o.get("room");return Ct?Ct.toUpperCase():"load-test".toUpperCase()},[a]=Vn.useState(n),[r,l]=lt.useState(null),[c,d]=lt.useState(null),[g,m]=lt.useState(!1),[_]=lt.useState(`test-teacher-${Math.random().toString(36).substring(7)}`),[C,E]=lt.useState({}),[O,v]=lt.useState(null),[M,z]=lt.useState({}),[L,D]=lt.useState(""),[N,G]=lt.useState("all"),[R,A]=lt.useState("all"),[T,y]=lt.useState(()=>{const Ct=localStorage.getItem("teacherDashboardHideNames");return Ct?JSON.parse(Ct):!1}),[B,j]=lt.useState(()=>{const Ct=localStorage.getItem("teacherDashboardCardsPerRow");return Ct?parseInt(Ct):3}),[P,Q]=lt.useState("blank"),[K,X]=lt.useState(null),[V,U]=lt.useState(null),[I,F]=lt.useState(""),[W,it]=lt.useState(!1),[Z,rt]=lt.useState(null),at=lt.useRef(null),Y=lt.useRef(null),J=lt.useRef(null),[tt,et]=lt.useState(!1),[gt,wt]=lt.useState(""),[Dt,Qt]=lt.useState([]);lt.useRef(!1),lt.useEffect(()=>{at.current=Z},[Z]);const te=(Ct,zt="info")=>{const Bt=Date.now();Qt(Se=>[...Se,{id:Bt,message:Ct,type:zt}]),setTimeout(()=>{Qt(Se=>Se.filter(_e=>_e.id!==Bt))},4e3)};lt.useEffect(()=>{localStorage.setItem("teacherDashboardHideNames",JSON.stringify(T))},[T]),lt.useEffect(()=>{localStorage.setItem("teacherDashboardCardsPerRow",B.toString())},[B]),lt.useEffect(()=>((async()=>{try{const zt=new pv.Realtime({authUrl:"/api/token",authParams:{clientId:_}});zt.connection.on("connected",()=>{console.log("✅ Test Teacher connected to Ably"),m(!0)}),zt.connection.on("disconnected",()=>{console.log("❌ Test Teacher disconnected"),m(!1)});const Bt=zt.channels.get(`room-${a}`);await new Promise(($t,He)=>{Bt.once("attached",$t),Bt.once("failed",He),Bt.attach()}),console.log("✅ Channel attached"),Bt.presence.subscribe("enter",$t=>{var He,sn;console.log("👤 Member entered:",$t.clientId,"Role:",(He=$t.data)==null?void 0:He.role,"Data:",$t.data),((sn=$t.data)==null?void 0:sn.role)==="student"&&(console.log("✅ Adding student to dashboard:",$t.data.name||$t.clientId),E(An=>({...An,[$t.clientId]:{clientId:$t.clientId,name:$t.data.name||$t.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,testMode:$t.data.testMode||!1,meta:{base:{width:800,height:600}}}})))}),Bt.presence.subscribe("leave",$t=>{console.log("👋 Student left:",$t.clientId),E(He=>{const sn={...He};return sn[$t.clientId]&&(sn[$t.clientId].isActive=!1),sn})}),Bt.presence.subscribe("update",$t=>{var He;((He=$t.data)==null?void 0:He.isVisible)!==void 0&&E(sn=>{const An={...sn};return An[$t.clientId]&&(An[$t.clientId].isVisible=$t.data.isVisible),An})});const Se=await Bt.presence.get();console.log(`📋 Found ${Se.length} members in presence`);const _e={};Se.forEach($t=>{var He,sn,An,Ln,Ga;console.log("  - Member:",$t.clientId,"Role:",(He=$t.data)==null?void 0:He.role,"Name:",(sn=$t.data)==null?void 0:sn.name),((An=$t.data)==null?void 0:An.role)==="student"&&(console.log("    ✅ Adding existing student:",$t.data.name||$t.clientId),_e[$t.clientId]={clientId:$t.clientId,name:$t.data.name||$t.clientId,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:((Ln=$t.data)==null?void 0:Ln.isVisible)!==!1,testMode:((Ga=$t.data)==null?void 0:Ga.testMode)||!1,meta:{base:{width:800,height:600}}})}),console.log(`✅ Initialized with ${Object.keys(_e).length} students`),E(_e),Bt.subscribe("student-layer",$t=>{const{clientId:He}=$t,sn=$t.data;E(An=>{const Ln={...An};return Ln[He]||(Ln[He]={clientId:He,name:He,lines:[],lastUpdate:Date.now(),isActive:!0,isFlagged:!1,isVisible:!0,meta:{base:{width:800,height:600}}}),sn.action==="clear"?Ln[He].lines=[]:sn.lines&&(Ln[He].lines=[...Ln[He].lines,...sn.lines]),Ln[He].lastUpdate=Date.now(),Ln})}),await Bt.presence.enter({role:"teacher",name:"Test Teacher",testMode:!0}),l(zt),d(Bt)}catch(zt){console.error("Failed to connect to Ably:",zt)}})(),()=>{c&&c.presence.leave(),r&&r.close()}),[a,_]),lt.useEffect(()=>{if(tt){const Ct=`${window.location.origin}/test/student?room=${a}`;Sb.toDataURL(Ct,{width:300,margin:2}).then(zt=>wt(zt)).catch(zt=>console.error("Failed to generate QR code:",zt))}},[tt,a]);const se=()=>{t("/")},kt=()=>{et(!0)},pe=()=>{c&&(c.publish("session-ended",{timestamp:Date.now(),reason:"teacher_ended"}),te("Session ended","success"))},Ee=Ct=>{v(C[Ct.clientId]||Ct)},Ze=()=>{v(null)},Ve=Ct=>{if(!O||!c)return;const zt=O.clientId;z(Bt=>({...Bt,[zt]:Ct})),c.publish("teacher-annotation",{targetStudentId:zt,annotations:Ct,teacherId:_,timestamp:Date.now()}),console.log("📤 Published annotations for",zt)},tn=Ct=>{E(zt=>{const Bt=zt[Ct];return Bt?{...zt,[Ct]:{...Bt,isFlagged:!Bt.isFlagged}}:zt}),v(zt=>zt&&zt.clientId===Ct?{...zt,isFlagged:!zt.isFlagged}:zt)},xt=Ct=>{const zt=document.createElement("canvas");zt.width=800,zt.height=600;const Bt=zt.getContext("2d");if(Bt.fillStyle="white",Bt.fillRect(0,0,800,600),Bt.strokeStyle="#ddd",Bt.lineWidth=1,Ct==="hanzi")Bt.strokeRect(250,150,300,300),Bt.beginPath(),Bt.moveTo(400,150),Bt.lineTo(400,450),Bt.moveTo(250,300),Bt.lineTo(550,300),Bt.stroke();else if(Ct==="graph-corner"){Bt.beginPath(),Bt.moveTo(100,500),Bt.lineTo(100,100),Bt.lineTo(700,100),Bt.stroke();for(let _e=1;_e<10;_e++){const $t=100+_e*60;Bt.beginPath(),Bt.moveTo($t,100),Bt.lineTo($t,500),Bt.stroke()}for(let _e=1;_e<8;_e++){const $t=100+_e*50;Bt.beginPath(),Bt.moveTo(100,$t),Bt.lineTo(700,$t),Bt.stroke()}}else if(Ct==="graph-cross"){Bt.beginPath(),Bt.moveTo(50,300),Bt.lineTo(750,300),Bt.moveTo(400,50),Bt.lineTo(400,550),Bt.stroke();for(let _e=-6;_e<=6;_e++){if(_e===0)continue;const $t=400+_e*50;Bt.beginPath(),Bt.moveTo($t,50),Bt.lineTo($t,550),Bt.stroke()}for(let _e=-5;_e<=5;_e++){if(_e===0)continue;const $t=300+_e*50;Bt.beginPath(),Bt.moveTo(50,$t),Bt.lineTo(750,$t),Bt.stroke()}}const Se=zt.toDataURL("image/png");X({type:Ct,dataUrl:Se,width:800,height:600})},Xt=()=>{Y.current&&(Y.current.value="",Y.current.click())},be=async Ct=>{var Bt;const zt=(Bt=Ct.target.files)==null?void 0:Bt[0];if(!zt){F("No file selected.");return}it(!0),F("");try{const{dataUrl:Se,width:_e,height:$t}=await Cb(zt),He={dataUrl:Se,width:_e,height:$t,filename:zt.name,timestamp:Date.now()};U(He),F("Image ready to send.")}catch(Se){console.error("Failed to upload image:",Se),F("Upload failed. Please try again.")}finally{it(!1)}},ye=()=>{U(null),F("")},me=()=>{if(!c)return;let Ct=null;P==="templates"&&K?Ct=K:P==="image"&&V&&(Ct=V),c.publish("teacher-action",{action:"send-blank-canvas",questionNumber:1,sharedImage:Ct,timestamp:Date.now()}),rt(Ct||null),te("Sent to all students","success"),console.log("📄 Sent to class:",P)},De=async()=>{const Ct=`${window.location.origin}/test/student?room=${a}`;try{await navigator.clipboard.writeText(Ct),te("Link copied to clipboard","success")}catch(zt){console.error("Clipboard API failed:",zt);try{J.current&&(J.current.select(),document.execCommand("copy"),te("Link copied to clipboard","success"))}catch(Bt){console.error("Fallback copy failed:",Bt),J.current&&J.current.select(),alert("Please copy the selected link manually")}}},Ye=()=>Object.values(C).sort((Ct,zt)=>Ct.isActive&&!zt.isActive?-1:!Ct.isActive&&zt.isActive?1:(zt.lastUpdate||0)-(Ct.lastUpdate||0)),Ue=()=>{const Ct=Ye(),zt=L.trim().toLowerCase();return Ct.filter(Bt=>{const Se=zt?(Bt.name||Bt.clientId).toLowerCase().includes(zt):!0,_e=N==="all"||N==="flagged"&&Bt.isFlagged,$t=R==="all"||R==="distracted"&&Bt.isVisible===!1&&Bt.isActive;return Se&&_e&&$t})},ft=Ye(),ct=Ue(),ht=ft.filter(Ct=>Ct.isActive).length,Ot=O?C[O.clientId]||O:null,Vt=I?!/fail|no file/i.test(I):!1;return k.jsxs("div",{className:"teacher-dashboard",children:[k.jsx("div",{className:"toast-container",children:Dt.map(Ct=>k.jsxs("div",{className:`toast toast-${Ct.type}`,children:[Ct.type==="success"&&k.jsx("span",{className:"toast-icon",children:"✓"}),Ct.type==="info"&&k.jsx("span",{className:"toast-icon",children:"ℹ"}),Ct.type==="error"&&k.jsx("span",{className:"toast-icon",children:"✕"}),k.jsx("span",{className:"toast-message",children:Ct.message})]},Ct.id))}),k.jsxs("div",{className:"dashboard-shell",children:[k.jsx("button",{className:"back-link",onClick:se,children:"← Exit class"}),k.jsxs("section",{className:"hero-card glass-panel",children:[k.jsxs("div",{className:"hero-top",children:[k.jsxs("div",{className:"hero-copy",children:[k.jsx("p",{className:"eyebrow",children:"🧪 Test Teacher dashboard"}),k.jsx("h1",{children:"Monitor every student's canvas and annotate live with the shared toolbar."}),k.jsx("p",{className:"hero-subtitle",children:"Share the session code below to invite students. You'll see their canvases appear in real time as they connect."})]}),k.jsxs("div",{className:"session-info",children:[k.jsxs("div",{className:"session-code-pill clickable",onClick:kt,style:{cursor:"pointer"},children:[k.jsx("span",{className:"pill-label",children:"Session code"}),k.jsx("span",{className:"pill-value",children:a})]}),k.jsx("button",{className:"end-session-btn",onClick:pe,title:"End session and logout all students",children:"End Session"}),k.jsxs("div",{className:"status-group",children:[k.jsx("span",{className:"status-pill session-pill",children:"Test mode"}),k.jsx("span",{className:`status-pill connection-pill ${g?"online":"offline"}`,children:g?"Connected":"Disconnected"}),k.jsxs("span",{className:"status-pill count-pill",children:[k.jsx("strong",{children:ht}),k.jsx("span",{children:"online"})]})]})]})]}),k.jsxs("div",{className:"hero-controls",children:[k.jsxs("div",{className:"search-input-wrapper",children:[k.jsx("span",{className:"search-icon",children:"🔍"}),k.jsx("input",{type:"text",placeholder:"Filter students",value:L,onChange:Ct=>D(Ct.target.value),className:"search-input"}),L&&k.jsx("button",{className:"clear-search-btn",onClick:()=>D(""),title:"Clear search",children:"✕"})]}),k.jsxs("div",{className:"control-set",children:[k.jsxs("label",{className:"hide-names-checkbox",children:[k.jsx("input",{type:"checkbox",checked:T,onChange:Ct=>y(Ct.target.checked)}),k.jsx("span",{children:"Hide names"})]}),k.jsx("button",{type:"button",className:`chip-button ${N==="flagged"?"active":""}`,onClick:()=>G(Ct=>Ct==="flagged"?"all":"flagged"),children:"Flagged only"}),k.jsx("button",{type:"button",className:`chip-button ${R==="distracted"?"active":""}`,onClick:()=>A(Ct=>Ct==="distracted"?"all":"distracted"),title:"Show only distracted students (switched away from tab)",children:"⚠️ Distracted only"}),k.jsxs("div",{className:"cards-select",children:[k.jsx("span",{children:"Cards/row"}),k.jsxs("select",{value:B,onChange:Ct=>j(Number(Ct.target.value)),children:[k.jsx("option",{value:2,children:"2"}),k.jsx("option",{value:3,children:"3"}),k.jsx("option",{value:4,children:"4"})]})]})]})]})]}),k.jsxs("section",{className:"prep-card glass-panel",children:[k.jsxs("div",{className:"prep-header",children:[k.jsxs("div",{children:[k.jsx("p",{className:"eyebrow",children:"Prepare next question"}),K&&k.jsxs("div",{style:{display:"inline-block",marginLeft:"12px",padding:"4px 12px",background:"#5B9BD5",color:"white",borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:["Staged: ",K.type==="hanzi"?"Hanzi":K.type==="graph-corner"?"Graph (corner)":"Graph (cross)"]}),k.jsx("h3",{children:"Stage an image or prompt before sending it to every student."})]}),k.jsx("button",{className:"send-to-class-btn",onClick:me,disabled:P==="image"&&!V,children:"Send to class"})]}),k.jsxs("div",{className:"prep-controls",children:[k.jsxs("div",{className:"prep-tabs",children:[k.jsx("button",{type:"button",className:`prep-tab ${P==="blank"?"active":""}`,onClick:()=>{Q("blank"),X(null),U(null)},children:"Blank canvas"}),k.jsx("button",{type:"button",className:`prep-tab ${P==="templates"?"active":""}`,onClick:()=>{Q("templates"),U(null)},children:"Templates"}),k.jsx("button",{type:"button",className:`prep-tab ${P==="image"?"active":""} ${V?"ready":""}`,onClick:()=>{Q("image"),X(null)},disabled:W,children:W?"Uploading…":"Send image"})]}),k.jsx("input",{ref:Y,type:"file",accept:"image/*",onChange:be,style:{display:"none"}}),P==="templates"&&k.jsxs("div",{className:"template-selector",children:[k.jsxs("div",{className:"template-buttons",children:[k.jsx("button",{type:"button",className:`template-btn ${(K==null?void 0:K.type)==="hanzi"?"active":""}`,onClick:()=>xt("hanzi"),children:"Hanzi box"}),k.jsx("button",{type:"button",className:`template-btn ${(K==null?void 0:K.type)==="graph-corner"?"active":""}`,onClick:()=>xt("graph-corner"),children:"Graph (corner)"}),k.jsx("button",{type:"button",className:`template-btn ${(K==null?void 0:K.type)==="graph-cross"?"active":""}`,onClick:()=>xt("graph-cross"),children:"Graph (cross)"})]}),K&&k.jsxs("div",{className:"template-preview",children:[k.jsx("img",{src:K.dataUrl,alt:"Template preview",style:{maxWidth:"300px",maxHeight:"250px",border:"2px solid #0F9D83",borderRadius:"8px"}}),k.jsx("p",{style:{marginTop:"8px",color:"#999",fontSize:"14px"},children:"Tiny preview (local only)"})]})]}),P==="image"&&k.jsx(k.Fragment,{children:V?k.jsxs("div",{className:"image-preview-surface",children:[k.jsx("img",{src:V.dataUrl,alt:"Preview",className:"image-preview-thumbnail"}),k.jsxs("div",{className:"preview-meta",children:[k.jsx("p",{className:"preview-title",children:V.filename||"Prepared image"}),k.jsx("p",{className:"preview-subtitle",children:V.width&&V.height?`${Math.round(V.width)} × ${Math.round(V.height)} px`:"Ready to send"}),k.jsxs("div",{className:"image-actions",children:[k.jsx("button",{className:"ghost-btn",onClick:Xt,children:"Choose another"}),k.jsx("button",{className:"ghost-btn",onClick:ye,children:"Clear"})]}),I&&k.jsx("span",{className:`image-message ${Vt?"success":"error"}`,children:I})]})]}):k.jsxs("button",{type:"button",className:"image-dropzone",onClick:Xt,children:[k.jsx("div",{className:"dropzone-icon","aria-hidden":"true",children:"🖼️"}),k.jsx("p",{children:"Bring an illustration or worksheet to share with the class."}),k.jsx("span",{children:"Click to upload an image"}),I&&k.jsx("span",{className:`image-message ${Vt?"success":"error"}`,children:I})]})}),P==="blank"&&k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:k.jsx("p",{children:`Click "Send to class" to clear all students' canvases.`})})]})]}),k.jsx("section",{className:"students-panel",children:k.jsx("div",{className:"students-surface glass-panel",children:ft.length===0?k.jsxs("div",{className:"waiting-card",children:[k.jsx("div",{className:"waiting-icon","aria-hidden":"true",children:"👥"}),k.jsx("h2",{children:"Waiting for students to join…"}),k.jsxs("p",{children:["Share the ",k.jsx("span",{className:"inline-pill",children:"session code"})," shown above. Students will appear here once they connect."]})]}):ct.length===0?k.jsxs("div",{className:"no-results",children:[k.jsx("div",{className:"no-results-icon",children:"🔍"}),k.jsx("h3",{children:"No students found"}),k.jsxs("p",{children:['No students match "',L,'"']}),k.jsx("button",{className:"clear-filter-btn",onClick:()=>D(""),children:"Clear filter"})]}):k.jsx("div",{className:"students-grid",style:{gridTemplateColumns:`repeat(${B}, 1fr)`},children:ct.filter(Ct=>Ct&&Ct.clientId).map(Ct=>k.jsx(_b,{student:Ct,onClick:Ee,onToggleFlag:tn,teacherAnnotations:M[Ct.clientId]||[],sharedImage:Z,hideNames:T},Ct.clientId))})})})]}),k.jsx(Eb,{student:Ot,isOpen:!!Ot,isFlagged:Ot==null?void 0:Ot.isFlagged,onToggleFlag:tn,onClose:Ze,onAnnotate:Ve,existingAnnotations:Ot?M[Ot.clientId]||[]:[],sharedImage:Z}),k.jsx("div",{className:"dashboard-footer",children:k.jsxs("p",{children:["💡 ",k.jsx("strong",{children:"Tip:"})," Click on any student card to view their work and add annotations"]})}),tt&&k.jsx("div",{className:"qr-modal-overlay",onClick:()=>et(!1),children:k.jsxs("div",{className:"qr-modal",onClick:Ct=>Ct.stopPropagation(),children:[k.jsxs("div",{className:"qr-modal-header",children:[k.jsxs("h2",{children:["Join Session: ",a]}),k.jsx("button",{className:"qr-close-btn",onClick:()=>et(!1),children:"✕"})]}),k.jsxs("div",{className:"qr-modal-content",children:[k.jsx("div",{className:"qr-code-container",children:gt&&k.jsx("img",{src:gt,alt:"QR Code",className:"qr-code-image"})}),k.jsxs("div",{className:"qr-instructions",children:[k.jsxs("p",{className:"qr-instruction-text",children:[k.jsx("strong",{children:"Students can scan this QR code"})," or use the link below to join the session"]}),k.jsxs("div",{className:"qr-link-box",children:[k.jsx("input",{ref:J,type:"text",value:`${window.location.origin}/test/student?room=${a}`,readOnly:!0,className:"qr-link-input"}),k.jsx("button",{className:"qr-copy-btn",onClick:De,children:"Copy Link"})]})]})]})]})})]})};function NT(){return k.jsx(v3,{children:k.jsxs(d3,{children:[k.jsx(cu,{path:"/",element:k.jsx(y3,{})}),k.jsx(cu,{path:"/student-login",element:k.jsx(eT,{})}),k.jsx(cu,{path:"/student",element:k.jsx(tT,{})}),k.jsx(cu,{path:"/teacher",element:k.jsx(OT,{})}),k.jsx(cu,{path:"/test/student",element:k.jsx(RT,{})}),k.jsx(cu,{path:"/test/teacher",element:k.jsx(xT,{})})]})})}_4.createRoot(document.getElementById("root")).render(k.jsx(Vn.StrictMode,{children:k.jsx(NT,{})}));
